<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head>
<meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1"/>
<meta name="keywords" content="LLVM,Low Level Virtual Machine,C++,doxygen,API,documentation"/>
<meta name="description" content="C++ source code API documentation for LLVM."/>
<title>LLVM: X86DisassemblerDecoder.c Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head><body>
<p class="title">LLVM API Documentation</p>
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('X86DisassemblerDecoder_8c_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">X86DisassemblerDecoder.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="X86DisassemblerDecoder_8c.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*===-- X86DisassemblerDecoder.c - Disassembler decoder ------------*- C -*-===*</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> *                     The LLVM Compiler Infrastructure</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> * This file is distributed under the University of Illinois Open Source</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> * License. See LICENSE.TXT for details.</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> *===----------------------------------------------------------------------===*</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> * This file is part of the X86 Disassembler.</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> * It contains the implementation of the instruction decoder.</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> * Documentation for the disassembler can be found in X86Disassembler.h.</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> *===----------------------------------------------------------------------===*/</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &lt;stdarg.h&gt;</span>   <span class="comment">/* for va_*()       */</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &lt;stdio.h&gt;</span>    <span class="comment">/* for vsnprintf()  */</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &lt;stdlib.h&gt;</span>   <span class="comment">/* for exit()       */</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &lt;string.h&gt;</span>   <span class="comment">/* for memset()     */</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="X86DisassemblerDecoder_8h.html">X86DisassemblerDecoder.h</a>&quot;</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;X86GenDisassemblerTables.inc&quot;</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;</div><div class="line"><a name="l00025"></a><span class="lineno"><a class="line" href="X86DisassemblerDecoder_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">   25</a></span>&#160;<span class="preprocessor">#define TRUE  1</span></div><div class="line"><a name="l00026"></a><span class="lineno"><a class="line" href="X86DisassemblerDecoder_8c.html#aa93f0eb578d23995850d61f7d61c55c1">   26</a></span>&#160;<span class="preprocessor">#define FALSE 0</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#ifndef NDEBUG</span></div><div class="line"><a name="l00029"></a><span class="lineno"><a class="line" href="X86DisassemblerDecoder_8c.html#ae0228f36529f75f692753ef96d725012">   29</a></span>&#160;<span class="preprocessor">#define debug(s) do { x86DisassemblerDebug(__FILE__, __LINE__, s); } while (0)</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#define debug(s) do { } while (0)</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment"> * contextForAttrs - Client for the instruction context table.  Takes a set of</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment"> *   attributes and returns the appropriate decode context.</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment"> * @param attrMask  - Attributes, from the enumeration attributeBits.</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment"> * @return          - The InstructionContext to use when looking up an</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment"> *                    an instruction with these attributes.</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00043"></a><span class="lineno"><a class="line" href="X86DisassemblerDecoder_8c.html#a35319d994370e141dced971952e7e6f5">   43</a></span>&#160;<span class="keyword">static</span> <a class="code" href="X86DisassemblerDecoderCommon_8h.html#a8ee4ef62ace14145044f3ab99fa2a8fa">InstructionContext</a> <a class="code" href="X86DisassemblerDecoder_8c.html#a35319d994370e141dced971952e7e6f5">contextForAttrs</a>(uint8_t attrMask) {</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="X86DisassemblerDecoderCommon_8h.html#a5289563c2fd129668b3dfc2bcb36f1a9">CONTEXTS_SYM</a>[attrMask];</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;}</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment"> * modRMRequired - Reads the appropriate instruction table to determine whether</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment"> *   the ModR/M byte is required to decode a particular instruction.</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment"> * @param type        - The opcode type (i.e., how many bytes it has).</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment"> * @param insnContext - The context for the instruction, as returned by</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment"> *                      contextForAttrs.</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment"> * @param opcode      - The last byte of the instruction&#39;s opcode, not counting</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment"> *                      ModR/M extensions and escapes.</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment"> * @return            - TRUE if the ModR/M byte is required, FALSE otherwise.</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00058"></a><span class="lineno"><a class="line" href="X86DisassemblerDecoder_8c.html#a17aad449cab97040952f09d23f56cac7">   58</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="X86DisassemblerDecoder_8c.html#a17aad449cab97040952f09d23f56cac7">modRMRequired</a>(<a class="code" href="X86DisassemblerDecoderCommon_8h.html#a5cc171c21d0532e0f6353e972f1ff621">OpcodeType</a> <a class="code" href="Target_2LLVMBuild_8txt.html#ac6653103ff5a7ab01c54613c5a0e5b2d">type</a>,</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;                         <a class="code" href="X86DisassemblerDecoderCommon_8h.html#a8ee4ef62ace14145044f3ab99fa2a8fa">InstructionContext</a> insnContext,</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;                         uint8_t opcode) {</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structContextDecision.html">ContextDecision</a>* decision = 0;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  <span class="keywordflow">switch</span> (type) {</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="X86DisassemblerDecoderCommon_8h.html#a5cc171c21d0532e0f6353e972f1ff621a703a4841d8c5722f1f7b0c887beca64e">ONEBYTE</a>:</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    decision = &amp;<a class="code" href="X86DisassemblerDecoderCommon_8h.html#ae053f9e80d644f47a6ee19185739162b">ONEBYTE_SYM</a>;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="X86DisassemblerDecoderCommon_8h.html#a5cc171c21d0532e0f6353e972f1ff621a339165d45a0200fd88efae325ac01b10">TWOBYTE</a>:</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    decision = &amp;<a class="code" href="X86DisassemblerDecoderCommon_8h.html#a0bfb472dc63adf5ea8919f054d4450e2">TWOBYTE_SYM</a>;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="X86DisassemblerDecoderCommon_8h.html#a5cc171c21d0532e0f6353e972f1ff621a6666ce07b725a97b298534bba4549531">THREEBYTE_38</a>:</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    decision = &amp;<a class="code" href="X86DisassemblerDecoderCommon_8h.html#a892daf9647ea098765cb833eb8596234">THREEBYTE38_SYM</a>;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="X86DisassemblerDecoderCommon_8h.html#a5cc171c21d0532e0f6353e972f1ff621ac673abd123c1e32fa09f13b8d89af428">THREEBYTE_3A</a>:</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    decision = &amp;<a class="code" href="X86DisassemblerDecoderCommon_8h.html#a6a9bb5a76c1dd6a02bb96ef407a6cb7d">THREEBYTE3A_SYM</a>;</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="X86DisassemblerDecoderCommon_8h.html#a5cc171c21d0532e0f6353e972f1ff621a26952e7ac04ca61b0c1029cb7a656518">THREEBYTE_A6</a>:</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    decision = &amp;<a class="code" href="X86DisassemblerDecoderCommon_8h.html#ab447e6c9b537c8221e0bd18f6d980b29">THREEBYTEA6_SYM</a>;</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="X86DisassemblerDecoderCommon_8h.html#a5cc171c21d0532e0f6353e972f1ff621a47fe68a9ef1b2de8d7f18109579354c3">THREEBYTE_A7</a>:</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    decision = &amp;<a class="code" href="X86DisassemblerDecoderCommon_8h.html#a248490f08a4ffb48599b9d03dcbe50c1">THREEBYTEA7_SYM</a>;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="X86DisassemblerDecoderCommon_8h.html#a5cc171c21d0532e0f6353e972f1ff621a6383f0e83ff34dfa506e53e9b7b3edcd">XOP8_MAP</a>:</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    decision = &amp;<a class="code" href="X86DisassemblerDecoderCommon_8h.html#a73a6f64aec6a805d641a17c87a9d00b9">XOP8_MAP_SYM</a>;</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="X86DisassemblerDecoderCommon_8h.html#a5cc171c21d0532e0f6353e972f1ff621a208f2badc53ec65f21dbe280dfab63c5">XOP9_MAP</a>:</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    decision = &amp;<a class="code" href="X86DisassemblerDecoderCommon_8h.html#a349d73e2f39af064d9999d7780f9897d">XOP9_MAP_SYM</a>;</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="X86DisassemblerDecoderCommon_8h.html#a5cc171c21d0532e0f6353e972f1ff621ae7d385e3466556921813f6ec2505e3ae">XOPA_MAP</a>:</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    decision = &amp;<a class="code" href="X86DisassemblerDecoderCommon_8h.html#a9df14d49cac592bc2e51794ad434e9b2">XOPA_MAP_SYM</a>;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  }</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  <span class="keywordflow">return</span> decision-&gt;<a class="code" href="structContextDecision.html#a00eb4e91ed308eebd1667b5dce7c4b8b">opcodeDecisions</a>[insnContext].<a class="code" href="structOpcodeDecision.html#a0cb23951ba8df6cb979bbbb35d4a83f1">modRMDecisions</a>[opcode].</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    modrm_type != MODRM_ONEENTRY;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;}</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment"> * decode - Reads the appropriate instruction table to obtain the unique ID of</span></div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment"> *   an instruction.</span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment"> * @param type        - See modRMRequired().</span></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment"> * @param insnContext - See modRMRequired().</span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment"> * @param opcode      - See modRMRequired().</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment"> * @param modRM       - The ModR/M byte if required, or any value if not.</span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment"> * @return            - The UID of the instruction, or 0 on failure.</span></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00107"></a><span class="lineno"><a class="line" href="X86DisassemblerDecoder_8c.html#ab3686bdd912c0d40035aa66dcffb36da">  107</a></span>&#160;<span class="keyword">static</span> <a class="code" href="X86DisassemblerDecoderCommon_8h.html#a9f0bb90ee924a8b71c6514c8eb6064a1">InstrUID</a> <a class="code" href="X86DisassemblerDecoder_8c.html#ab3686bdd912c0d40035aa66dcffb36da">decode</a>(<a class="code" href="X86DisassemblerDecoderCommon_8h.html#a5cc171c21d0532e0f6353e972f1ff621">OpcodeType</a> <a class="code" href="Target_2LLVMBuild_8txt.html#ac6653103ff5a7ab01c54613c5a0e5b2d">type</a>,</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                       <a class="code" href="X86DisassemblerDecoderCommon_8h.html#a8ee4ef62ace14145044f3ab99fa2a8fa">InstructionContext</a> insnContext,</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;                       uint8_t opcode,</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;                       uint8_t modRM) {</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structModRMDecision.html">ModRMDecision</a>* dec = 0;</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <span class="keywordflow">switch</span> (type) {</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="X86DisassemblerDecoderCommon_8h.html#a5cc171c21d0532e0f6353e972f1ff621a703a4841d8c5722f1f7b0c887beca64e">ONEBYTE</a>:</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    dec = &amp;<a class="code" href="X86DisassemblerDecoderCommon_8h.html#ae053f9e80d644f47a6ee19185739162b">ONEBYTE_SYM</a>.opcodeDecisions[insnContext].modRMDecisions[opcode];</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="X86DisassemblerDecoderCommon_8h.html#a5cc171c21d0532e0f6353e972f1ff621a339165d45a0200fd88efae325ac01b10">TWOBYTE</a>:</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    dec = &amp;<a class="code" href="X86DisassemblerDecoderCommon_8h.html#a0bfb472dc63adf5ea8919f054d4450e2">TWOBYTE_SYM</a>.opcodeDecisions[insnContext].modRMDecisions[opcode];</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="X86DisassemblerDecoderCommon_8h.html#a5cc171c21d0532e0f6353e972f1ff621a6666ce07b725a97b298534bba4549531">THREEBYTE_38</a>:</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    dec = &amp;<a class="code" href="X86DisassemblerDecoderCommon_8h.html#a892daf9647ea098765cb833eb8596234">THREEBYTE38_SYM</a>.opcodeDecisions[insnContext].modRMDecisions[opcode];</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="X86DisassemblerDecoderCommon_8h.html#a5cc171c21d0532e0f6353e972f1ff621ac673abd123c1e32fa09f13b8d89af428">THREEBYTE_3A</a>:</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    dec = &amp;<a class="code" href="X86DisassemblerDecoderCommon_8h.html#a6a9bb5a76c1dd6a02bb96ef407a6cb7d">THREEBYTE3A_SYM</a>.opcodeDecisions[insnContext].modRMDecisions[opcode];</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="X86DisassemblerDecoderCommon_8h.html#a5cc171c21d0532e0f6353e972f1ff621a26952e7ac04ca61b0c1029cb7a656518">THREEBYTE_A6</a>:</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    dec = &amp;<a class="code" href="X86DisassemblerDecoderCommon_8h.html#ab447e6c9b537c8221e0bd18f6d980b29">THREEBYTEA6_SYM</a>.opcodeDecisions[insnContext].modRMDecisions[opcode];</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="X86DisassemblerDecoderCommon_8h.html#a5cc171c21d0532e0f6353e972f1ff621a47fe68a9ef1b2de8d7f18109579354c3">THREEBYTE_A7</a>:</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    dec = &amp;<a class="code" href="X86DisassemblerDecoderCommon_8h.html#a248490f08a4ffb48599b9d03dcbe50c1">THREEBYTEA7_SYM</a>.opcodeDecisions[insnContext].modRMDecisions[opcode];</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="X86DisassemblerDecoderCommon_8h.html#a5cc171c21d0532e0f6353e972f1ff621a6383f0e83ff34dfa506e53e9b7b3edcd">XOP8_MAP</a>:</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    dec = &amp;<a class="code" href="X86DisassemblerDecoderCommon_8h.html#a73a6f64aec6a805d641a17c87a9d00b9">XOP8_MAP_SYM</a>.opcodeDecisions[insnContext].modRMDecisions[opcode];</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="X86DisassemblerDecoderCommon_8h.html#a5cc171c21d0532e0f6353e972f1ff621a208f2badc53ec65f21dbe280dfab63c5">XOP9_MAP</a>:</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    dec = &amp;<a class="code" href="X86DisassemblerDecoderCommon_8h.html#a349d73e2f39af064d9999d7780f9897d">XOP9_MAP_SYM</a>.opcodeDecisions[insnContext].modRMDecisions[opcode];</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="X86DisassemblerDecoderCommon_8h.html#a5cc171c21d0532e0f6353e972f1ff621ae7d385e3466556921813f6ec2505e3ae">XOPA_MAP</a>:</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    dec = &amp;<a class="code" href="X86DisassemblerDecoderCommon_8h.html#a9df14d49cac592bc2e51794ad434e9b2">XOPA_MAP_SYM</a>.opcodeDecisions[insnContext].modRMDecisions[opcode];</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  }</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  <span class="keywordflow">switch</span> (dec-&gt;<a class="code" href="structModRMDecision.html#a6c4ec8014e5927c67c5a0c9f0b9315aa">modrm_type</a>) {</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  <span class="keywordflow">default</span>:</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <a class="code" href="X86DisassemblerDecoder_8c.html#ae0228f36529f75f692753ef96d725012">debug</a>(<span class="stringliteral">&quot;Corrupt table!  Unknown modrm_type&quot;</span>);</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  <span class="keywordflow">case</span> MODRM_ONEENTRY:</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="keywordflow">return</span> modRMTable[dec-&gt;instructionIDs];</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  <span class="keywordflow">case</span> MODRM_SPLITRM:</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="X86DisassemblerDecoder_8h.html#a4bce531c2ed18d569a316029616e82f0">modFromModRM</a>(modRM) == 0<a class="code" href="README-SSE_8txt.html#a11ca92463dc5dfc09bbe2ba2f3ea0c96">x3</a>)</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;      <span class="keywordflow">return</span> modRMTable[dec-&gt;instructionIDs+1];</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <span class="keywordflow">return</span> modRMTable[dec-&gt;instructionIDs];</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  <span class="keywordflow">case</span> MODRM_SPLITREG:</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="X86DisassemblerDecoder_8h.html#a4bce531c2ed18d569a316029616e82f0">modFromModRM</a>(modRM) == 0<a class="code" href="README-SSE_8txt.html#a11ca92463dc5dfc09bbe2ba2f3ea0c96">x3</a>)</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;      <span class="keywordflow">return</span> modRMTable[dec-&gt;instructionIDs+((modRM &amp; 0x38) &gt;&gt; 3)+8];</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="keywordflow">return</span> modRMTable[dec-&gt;instructionIDs+((modRM &amp; 0x38) &gt;&gt; 3)];</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  <span class="keywordflow">case</span> MODRM_SPLITMISC:</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="X86DisassemblerDecoder_8h.html#a4bce531c2ed18d569a316029616e82f0">modFromModRM</a>(modRM) == 0x3)</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;      <span class="keywordflow">return</span> modRMTable[dec-&gt;instructionIDs+(modRM &amp; 0x3f)+8];</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <span class="keywordflow">return</span> modRMTable[dec-&gt;instructionIDs+((modRM &amp; 0x38) &gt;&gt; 3)];</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  <span class="keywordflow">case</span> MODRM_FULL:</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="keywordflow">return</span> modRMTable[dec-&gt;instructionIDs+modRM];</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  }</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;}</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="comment"> * specifierForUID - Given a UID, returns the name and operand specification for</span></div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="comment"> *   that instruction.</span></div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="comment"> * @param uid - The unique ID for the instruction.  This should be returned by</span></div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment"> *              decode(); specifierForUID will not check bounds.</span></div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment"> * @return    - A pointer to the specification for that instruction.</span></div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00174"></a><span class="lineno"><a class="line" href="X86DisassemblerDecoder_8c.html#a553631909c27b5f8a94d65ebb13e73ae">  174</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structInstructionSpecifier.html">InstructionSpecifier</a> *<a class="code" href="X86DisassemblerDecoder_8c.html#a553631909c27b5f8a94d65ebb13e73ae">specifierForUID</a>(<a class="code" href="X86DisassemblerDecoderCommon_8h.html#a9f0bb90ee924a8b71c6514c8eb6064a1">InstrUID</a> uid) {</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  <span class="keywordflow">return</span> &amp;<a class="code" href="X86DisassemblerDecoderCommon_8h.html#a62a3fc430e98f080dc7e39325d2b9e54">INSTRUCTIONS_SYM</a>[uid];</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;}</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="comment"> * consumeByte - Uses the reader function provided by the user to consume one</span></div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="comment"> *   byte from the instruction&#39;s memory and advance the cursor.</span></div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="comment"> * @param insn  - The instruction with the reader function to use.  The cursor</span></div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="comment"> *                for this instruction is advanced.</span></div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="comment"> * @param byte  - A pointer to a pre-allocated memory buffer to be populated</span></div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="comment"> *                with the data read.</span></div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment"> * @return      - 0 if the read was successful; nonzero otherwise.</span></div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00188"></a><span class="lineno"><a class="line" href="X86DisassemblerDecoder_8c.html#a1c693d3ea8868f36b5b192d0315cac04">  188</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="X86DisassemblerDecoder_8c.html#a1c693d3ea8868f36b5b192d0315cac04">consumeByte</a>(<span class="keyword">struct</span> <a class="code" href="structInternalInstruction.html">InternalInstruction</a>* insn, uint8_t* <a class="code" href="README-SSE_8txt.html#ab25ce1a76d8c2513a49fc46d6edab095">byte</a>) {</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="Target_2X86_2README_8txt.html#a8ef54f27fddd11cc461b2b231fc2d23c">ret</a> = insn-&gt;<a class="code" href="structInternalInstruction.html#abb52adf9696c6d65eb3ac1f202b7b0a3">reader</a>(insn-&gt;<a class="code" href="structInternalInstruction.html#a54cc2f9d67046f0014ebd3347dff0515">readerArg</a>, byte, insn-&gt;<a class="code" href="structInternalInstruction.html#ab255c3e1663cdfbdebbe1b199140a950">readerCursor</a>);</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  <span class="keywordflow">if</span> (!ret)</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    ++(insn-&gt;<a class="code" href="structInternalInstruction.html#ab255c3e1663cdfbdebbe1b199140a950">readerCursor</a>);</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="Target_2X86_2README_8txt.html#a8ef54f27fddd11cc461b2b231fc2d23c">ret</a>;</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;}</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment"> * lookAtByte - Like consumeByte, but does not advance the cursor.</span></div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment"> * @param insn  - See consumeByte().</span></div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment"> * @param byte  - See consumeByte().</span></div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment"> * @return      - See consumeByte().</span></div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00204"></a><span class="lineno"><a class="line" href="X86DisassemblerDecoder_8c.html#aa1d795a5171179078bfc2b8a6114f82f">  204</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="X86DisassemblerDecoder_8c.html#aa1d795a5171179078bfc2b8a6114f82f">lookAtByte</a>(<span class="keyword">struct</span> <a class="code" href="structInternalInstruction.html">InternalInstruction</a>* insn, uint8_t* <a class="code" href="README-SSE_8txt.html#ab25ce1a76d8c2513a49fc46d6edab095">byte</a>) {</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  <span class="keywordflow">return</span> insn-&gt;<a class="code" href="structInternalInstruction.html#abb52adf9696c6d65eb3ac1f202b7b0a3">reader</a>(insn-&gt;<a class="code" href="structInternalInstruction.html#a54cc2f9d67046f0014ebd3347dff0515">readerArg</a>, byte, insn-&gt;<a class="code" href="structInternalInstruction.html#ab255c3e1663cdfbdebbe1b199140a950">readerCursor</a>);</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;}</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;</div><div class="line"><a name="l00208"></a><span class="lineno"><a class="line" href="X86DisassemblerDecoder_8c.html#a76aa63a8eadc46ca3124cc907e841dbb">  208</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="X86DisassemblerDecoder_8c.html#a76aa63a8eadc46ca3124cc907e841dbb">unconsumeByte</a>(<span class="keyword">struct</span> <a class="code" href="structInternalInstruction.html">InternalInstruction</a>* insn) {</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  insn-&gt;<a class="code" href="structInternalInstruction.html#ab255c3e1663cdfbdebbe1b199140a950">readerCursor</a>--;</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;}</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;</div><div class="line"><a name="l00212"></a><span class="lineno"><a class="line" href="X86DisassemblerDecoder_8c.html#a17dc51543779f7fc430239599234d9cf">  212</a></span>&#160;<span class="preprocessor">#define CONSUME_FUNC(name, type)                                  \</span></div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="preprocessor">  static int name(struct InternalInstruction* insn, type* ptr) {  \</span></div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="preprocessor">    type combined = 0;                                            \</span></div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="preprocessor">    unsigned offset;                                              \</span></div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="preprocessor">    for (offset = 0; offset &lt; sizeof(type); ++offset) {           \</span></div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="preprocessor">      uint8_t byte;                                               \</span></div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="preprocessor">      int ret = insn-&gt;reader(insn-&gt;readerArg,                     \</span></div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="preprocessor">                             &amp;byte,                               \</span></div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="preprocessor">                             insn-&gt;readerCursor + offset);        \</span></div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="preprocessor">      if (ret)                                                    \</span></div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="preprocessor">        return ret;                                               \</span></div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="preprocessor">      combined = combined | ((uint64_t)byte &lt;&lt; (offset * 8));     \</span></div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="preprocessor">    }                                                             \</span></div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="preprocessor">    *ptr = combined;                                              \</span></div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="preprocessor">    insn-&gt;readerCursor += sizeof(type);                           \</span></div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="preprocessor">    return 0;                                                     \</span></div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="preprocessor">  }</span></div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="comment"> * consume* - Use the reader function provided by the user to consume data</span></div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="comment"> *   values of various sizes from the instruction&#39;s memory and advance the</span></div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="comment"> *   cursor appropriately.  These readers perform endian conversion.</span></div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="comment"> * @param insn    - See consumeByte().</span></div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="comment"> * @param ptr     - A pointer to a pre-allocated memory of appropriate size to</span></div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="comment"> *                  be populated with the data read.</span></div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="comment"> * @return        - See consumeByte().</span></div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<a class="code" href="X86DisassemblerDecoder_8c.html#a17dc51543779f7fc430239599234d9cf">CONSUME_FUNC</a>(consumeInt8, int8_t)</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<a class="code" href="X86DisassemblerDecoder_8c.html#a17dc51543779f7fc430239599234d9cf">CONSUME_FUNC</a>(consumeInt16, int16_t)</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<a class="code" href="X86DisassemblerDecoder_8c.html#a17dc51543779f7fc430239599234d9cf">CONSUME_FUNC</a>(consumeInt32, int32_t)</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<a class="code" href="X86DisassemblerDecoder_8c.html#a17dc51543779f7fc430239599234d9cf">CONSUME_FUNC</a>(consumeUInt16, uint16_t)</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<a class="code" href="X86DisassemblerDecoder_8c.html#a17dc51543779f7fc430239599234d9cf">CONSUME_FUNC</a>(consumeUInt32, uint32_t)</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<a class="code" href="X86DisassemblerDecoder_8c.html#a17dc51543779f7fc430239599234d9cf">CONSUME_FUNC</a>(consumeUInt64, uint64_t)</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="comment"> * dbgprintf - Uses the logging function provided by the user to log a single</span></div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="comment"> *   message, typically without a carriage-return.</span></div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="comment"> * @param insn    - The instruction containing the logging function.</span></div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="comment"> * @param format  - See printf().</span></div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="comment"> * @param ...     - See printf().</span></div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00255"></a><span class="lineno"><a class="line" href="X86DisassemblerDecoder_8c.html#ac92411447d53b3ccecf5a40f736650cc">  255</a></span>&#160;static <span class="keywordtype">void</span> <a class="code" href="X86DisassemblerDecoder_8c.html#ac92411447d53b3ccecf5a40f736650cc">dbgprintf</a>(struct <a class="code" href="structInternalInstruction.html">InternalInstruction</a>* insn,</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;                      const <span class="keywordtype">char</span>* <a class="code" href="namespacellvm.html#a69dc1b119f8cb95b7e36f586c5aeb372">format</a>,</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;                      ...) {</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;  <span class="keywordtype">char</span> buffer[256];</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;  va_list ap;</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;  <span class="keywordflow">if</span> (!insn-&gt;dlog)</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;  va_start(ap, format);</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;  (void)<a class="code" href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fa889127ff256afb5d8130cabd90aadd4b">vsnprintf</a>(buffer, <span class="keyword">sizeof</span>(buffer), <a class="code" href="namespacellvm.html#a69dc1b119f8cb95b7e36f586c5aeb372">format</a>, ap);</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;  va_end(ap);</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;  insn-&gt;dlog(insn-&gt;dlogArg, buffer);</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  <span class="keywordflow">return</span>;</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;}</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="comment"> * setPrefixPresent - Marks that a particular prefix is present at a particular</span></div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="comment"> *   location.</span></div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="comment"> * @param insn      - The instruction to be marked as having the prefix.</span></div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="comment"> * @param prefix    - The prefix that is present.</span></div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="comment"> * @param location  - The location where the prefix is located (in the address</span></div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="comment"> *                    space of the instruction&#39;s reader).</span></div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00282"></a><span class="lineno"><a class="line" href="X86DisassemblerDecoder_8c.html#a54c7d02e2f8a7db2f0025c5bcaef3a76">  282</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="X86DisassemblerDecoder_8c.html#a54c7d02e2f8a7db2f0025c5bcaef3a76">setPrefixPresent</a>(<span class="keyword">struct</span> <a class="code" href="structInternalInstruction.html">InternalInstruction</a>* insn,</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;                                    uint8_t prefix,</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;                                    uint64_t <a class="code" href="namespacellvm_1_1cl.html#aed47e4757f3240146f8ad40c2cdbf2d1">location</a>)</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;{</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  insn-&gt;<a class="code" href="structInternalInstruction.html#a0cde7d21e5b2cd6fb19a76ec86bbd92e">prefixPresent</a>[prefix] = 1;</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;  insn-&gt;<a class="code" href="structInternalInstruction.html#a7a1a3cdc79e40949b4466ad8af9608cf">prefixLocations</a>[prefix] = <a class="code" href="namespacellvm_1_1cl.html#aed47e4757f3240146f8ad40c2cdbf2d1">location</a>;</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;}</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="comment"> * isPrefixAtLocation - Queries an instruction to determine whether a prefix is</span></div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="comment"> *   present at a given location.</span></div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="comment"> * @param insn      - The instruction to be queried.</span></div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="comment"> * @param prefix    - The prefix.</span></div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment"> * @param location  - The location to query.</span></div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="comment"> * @return          - Whether the prefix is at that location.</span></div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00299"></a><span class="lineno"><a class="line" href="X86DisassemblerDecoder_8c.html#a64e2c61de541dbe1de34d17fab03c656">  299</a></span>&#160;<span class="keyword">static</span> <a class="code" href="X86DisassemblerDecoder_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a> <a class="code" href="X86DisassemblerDecoder_8c.html#a64e2c61de541dbe1de34d17fab03c656">isPrefixAtLocation</a>(<span class="keyword">struct</span> <a class="code" href="structInternalInstruction.html">InternalInstruction</a>* insn,</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;                               uint8_t prefix,</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;                               uint64_t <a class="code" href="namespacellvm_1_1cl.html#aed47e4757f3240146f8ad40c2cdbf2d1">location</a>)</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;{</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;  <span class="keywordflow">if</span> (insn-&gt;<a class="code" href="structInternalInstruction.html#a0cde7d21e5b2cd6fb19a76ec86bbd92e">prefixPresent</a>[prefix] == 1 &amp;&amp;</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;     insn-&gt;<a class="code" href="structInternalInstruction.html#a7a1a3cdc79e40949b4466ad8af9608cf">prefixLocations</a>[prefix] == location)</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="X86DisassemblerDecoder_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="X86DisassemblerDecoder_8c.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;}</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="comment"> * readPrefixes - Consumes all of an instruction&#39;s prefix bytes, and marks the</span></div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="comment"> *   instruction as having them.  Also sets the instruction&#39;s default operand,</span></div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="comment"> *   address, and other relevant data sizes to report operands correctly.</span></div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="comment"> * @param insn  - The instruction whose prefixes are to be read.</span></div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="comment"> * @return      - 0 if the instruction could be read until the end of the prefix</span></div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment"> *                bytes, and no prefixes conflicted; nonzero otherwise.</span></div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00319"></a><span class="lineno"><a class="line" href="X86DisassemblerDecoder_8c.html#aef1a8136ca4df8d11829c1aa2b708f5d">  319</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="X86DisassemblerDecoder_8c.html#aef1a8136ca4df8d11829c1aa2b708f5d">readPrefixes</a>(<span class="keyword">struct</span> <a class="code" href="structInternalInstruction.html">InternalInstruction</a>* insn) {</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;  <a class="code" href="X86DisassemblerDecoder_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a> isPrefix = <a class="code" href="X86DisassemblerDecoder_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;  <a class="code" href="X86DisassemblerDecoder_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a> prefixGroups[4] = { <a class="code" href="X86DisassemblerDecoder_8c.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a> };</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;  uint64_t prefixLocation;</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  uint8_t <a class="code" href="README-SSE_8txt.html#ab25ce1a76d8c2513a49fc46d6edab095">byte</a> = 0;</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;  uint8_t nextByte;</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;  <a class="code" href="X86DisassemblerDecoder_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a> hasAdSize = <a class="code" href="X86DisassemblerDecoder_8c.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;  <a class="code" href="X86DisassemblerDecoder_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a> hasOpSize = <a class="code" href="X86DisassemblerDecoder_8c.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  <a class="code" href="X86DisassemblerDecoder_8c.html#ac92411447d53b3ccecf5a40f736650cc">dbgprintf</a>(insn, <span class="stringliteral">&quot;readPrefixes()&quot;</span>);</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  <span class="keywordflow">while</span> (isPrefix) {</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    prefixLocation = insn-&gt;<a class="code" href="structInternalInstruction.html#ab255c3e1663cdfbdebbe1b199140a950">readerCursor</a>;</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    <span class="comment">/* If we fail reading prefixes, just stop here and let the opcode reader deal with it */</span></div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="X86DisassemblerDecoder_8c.html#a1c693d3ea8868f36b5b192d0315cac04">consumeByte</a>(insn, &amp;byte))</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    <span class="comment">/*</span></div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="comment">     * If the byte is a LOCK/REP/REPNE prefix and not a part of the opcode, then</span></div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="comment">     * break and let it be disassembled as a normal &quot;instruction&quot;.</span></div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="comment">     */</span></div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <span class="keywordflow">if</span> (insn-&gt;<a class="code" href="structInternalInstruction.html#ab255c3e1663cdfbdebbe1b199140a950">readerCursor</a> - 1 == insn-&gt;<a class="code" href="structInternalInstruction.html#a3a55e24e218c4bff1f03ef64da4c3725">startLocation</a> &amp;&amp; byte == 0xf0)</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    <span class="keywordflow">if</span> (insn-&gt;<a class="code" href="structInternalInstruction.html#ab255c3e1663cdfbdebbe1b199140a950">readerCursor</a> - 1 == insn-&gt;<a class="code" href="structInternalInstruction.html#a3a55e24e218c4bff1f03ef64da4c3725">startLocation</a></div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;        &amp;&amp; (byte == 0xf2 || byte == 0xf3)</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;        &amp;&amp; !<a class="code" href="X86DisassemblerDecoder_8c.html#aa1d795a5171179078bfc2b8a6114f82f">lookAtByte</a>(insn, &amp;nextByte))</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    {</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="comment">       * If the byte is 0xf2 or 0xf3, and any of the following conditions are</span></div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="comment">       * met:</span></div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="comment">       * - it is followed by a LOCK (0xf0) prefix</span></div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="comment">       * - it is followed by an xchg instruction</span></div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="comment">       * then it should be disassembled as a xacquire/xrelease not repne/rep.</span></div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;      <span class="keywordflow">if</span> ((byte == 0xf2 || byte == 0xf3) &amp;&amp;</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;          ((nextByte == 0xf0) |</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;          ((nextByte &amp; 0xfe) == 0<a class="code" href="Target_2README_8txt.html#a2352e45658fc7292aa209a94baa095e9">x86</a> || (nextByte &amp; 0xf8) == 0x90)))</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;        insn-&gt;<a class="code" href="structInternalInstruction.html#ad8cbe37cf206026716c7b05a5ea06ba5">xAcquireRelease</a> = <a class="code" href="X86DisassemblerDecoder_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="comment">       * Also if the byte is 0xf3, and the following condition is met:</span></div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="comment">       * - it is followed by a &quot;mov mem, reg&quot; (opcode 0x88/0x89) or</span></div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="comment">       *                       &quot;mov mem, imm&quot; (opcode 0xc6/0xc7) instructions.</span></div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="comment">       * then it should be disassembled as an xrelease not rep.</span></div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;      <span class="keywordflow">if</span> (byte == 0xf3 &amp;&amp;</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;          (nextByte == 0x88 || nextByte == 0x89 ||</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;           nextByte == 0xc6 || nextByte == 0xc7))</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;        insn-&gt;<a class="code" href="structInternalInstruction.html#ad8cbe37cf206026716c7b05a5ea06ba5">xAcquireRelease</a> = <a class="code" href="X86DisassemblerDecoder_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;      <span class="keywordflow">if</span> (insn-&gt;<a class="code" href="structInternalInstruction.html#a960c71a88602e7284b7a53a43c0d5c04">mode</a> == <a class="code" href="X86DisassemblerDecoderCommon_8h.html#a549ce06ad85d0726a93b2768ae7c7da7aeaebd8c1fe2b71a386838da0280c211c">MODE_64BIT</a> &amp;&amp; (nextByte &amp; 0xf0) == 0x40) {</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="X86DisassemblerDecoder_8c.html#a1c693d3ea8868f36b5b192d0315cac04">consumeByte</a>(insn, &amp;nextByte))</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;          <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="X86DisassemblerDecoder_8c.html#aa1d795a5171179078bfc2b8a6114f82f">lookAtByte</a>(insn, &amp;nextByte))</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;          <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        <a class="code" href="X86DisassemblerDecoder_8c.html#a76aa63a8eadc46ca3124cc907e841dbb">unconsumeByte</a>(insn);</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;      }</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;      <span class="keywordflow">if</span> (nextByte != 0x0f &amp;&amp; nextByte != 0x90)</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    }</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    <span class="keywordflow">switch</span> (byte) {</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <span class="keywordflow">case</span> 0xf0:  <span class="comment">/* LOCK */</span></div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    <span class="keywordflow">case</span> 0xf2:  <span class="comment">/* REPNE/REPNZ */</span></div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <span class="keywordflow">case</span> 0xf3:  <span class="comment">/* REP or REPE/REPZ */</span></div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;      <span class="keywordflow">if</span> (prefixGroups[0])</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;        <a class="code" href="X86DisassemblerDecoder_8c.html#ac92411447d53b3ccecf5a40f736650cc">dbgprintf</a>(insn, <span class="stringliteral">&quot;Redundant Group 1 prefix&quot;</span>);</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;      prefixGroups[0] = <a class="code" href="X86DisassemblerDecoder_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;      <a class="code" href="X86DisassemblerDecoder_8c.html#a54c7d02e2f8a7db2f0025c5bcaef3a76">setPrefixPresent</a>(insn, byte, prefixLocation);</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    <span class="keywordflow">case</span> 0x2e:  <span class="comment">/* CS segment override -OR- Branch not taken */</span></div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    <span class="keywordflow">case</span> 0x36:  <span class="comment">/* SS segment override -OR- Branch taken */</span></div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    <span class="keywordflow">case</span> 0x3e:  <span class="comment">/* DS segment override */</span></div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    <span class="keywordflow">case</span> 0x26:  <span class="comment">/* ES segment override */</span></div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    <span class="keywordflow">case</span> 0x64:  <span class="comment">/* FS segment override */</span></div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    <span class="keywordflow">case</span> 0x65:  <span class="comment">/* GS segment override */</span></div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;      <span class="keywordflow">switch</span> (byte) {</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;      <span class="keywordflow">case</span> 0x2e:</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;        insn-&gt;<a class="code" href="structInternalInstruction.html#afe0d37da2b3ba81a20c6c2b40b58e6e3">segmentOverride</a> = <a class="code" href="X86DisassemblerDecoder_8h.html#a678cc792a7ece4943c203fd18e57ad46a7ae1d102e8d3480f4ea83cc393fa2c76">SEG_OVERRIDE_CS</a>;</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;      <span class="keywordflow">case</span> 0x36:</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;        insn-&gt;<a class="code" href="structInternalInstruction.html#afe0d37da2b3ba81a20c6c2b40b58e6e3">segmentOverride</a> = <a class="code" href="X86DisassemblerDecoder_8h.html#a678cc792a7ece4943c203fd18e57ad46aa625e0d1316f604a7d38d4ca46a54ceb">SEG_OVERRIDE_SS</a>;</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;      <span class="keywordflow">case</span> 0x3e:</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;        insn-&gt;<a class="code" href="structInternalInstruction.html#afe0d37da2b3ba81a20c6c2b40b58e6e3">segmentOverride</a> = <a class="code" href="X86DisassemblerDecoder_8h.html#a678cc792a7ece4943c203fd18e57ad46ad4367053bdbbe0a470b5459337ce77b2">SEG_OVERRIDE_DS</a>;</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;      <span class="keywordflow">case</span> 0x26:</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;        insn-&gt;<a class="code" href="structInternalInstruction.html#afe0d37da2b3ba81a20c6c2b40b58e6e3">segmentOverride</a> = <a class="code" href="X86DisassemblerDecoder_8h.html#a678cc792a7ece4943c203fd18e57ad46a72c5f3c25f3f4d5e1f9fb70f122103b2">SEG_OVERRIDE_ES</a>;</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;      <span class="keywordflow">case</span> 0x64:</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;        insn-&gt;<a class="code" href="structInternalInstruction.html#afe0d37da2b3ba81a20c6c2b40b58e6e3">segmentOverride</a> = <a class="code" href="X86DisassemblerDecoder_8h.html#a678cc792a7ece4943c203fd18e57ad46ac748043f7a0a000924982b9d1864e4fe">SEG_OVERRIDE_FS</a>;</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;      <span class="keywordflow">case</span> 0x65:</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;        insn-&gt;<a class="code" href="structInternalInstruction.html#afe0d37da2b3ba81a20c6c2b40b58e6e3">segmentOverride</a> = <a class="code" href="X86DisassemblerDecoder_8h.html#a678cc792a7ece4943c203fd18e57ad46a975c840f7f5d04685ac87840b9f66429">SEG_OVERRIDE_GS</a>;</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;      <span class="keywordflow">default</span>:</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;        <a class="code" href="X86DisassemblerDecoder_8c.html#ae0228f36529f75f692753ef96d725012">debug</a>(<span class="stringliteral">&quot;Unhandled override&quot;</span>);</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;        <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;      }</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;      <span class="keywordflow">if</span> (prefixGroups[1])</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;        <a class="code" href="X86DisassemblerDecoder_8c.html#ac92411447d53b3ccecf5a40f736650cc">dbgprintf</a>(insn, <span class="stringliteral">&quot;Redundant Group 2 prefix&quot;</span>);</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;      prefixGroups[1] = <a class="code" href="X86DisassemblerDecoder_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;      <a class="code" href="X86DisassemblerDecoder_8c.html#a54c7d02e2f8a7db2f0025c5bcaef3a76">setPrefixPresent</a>(insn, byte, prefixLocation);</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <span class="keywordflow">case</span> 0x66:  <span class="comment">/* Operand-size override */</span></div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;      <span class="keywordflow">if</span> (prefixGroups[2])</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;        <a class="code" href="X86DisassemblerDecoder_8c.html#ac92411447d53b3ccecf5a40f736650cc">dbgprintf</a>(insn, <span class="stringliteral">&quot;Redundant Group 3 prefix&quot;</span>);</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;      prefixGroups[2] = <a class="code" href="X86DisassemblerDecoder_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;      hasOpSize = <a class="code" href="X86DisassemblerDecoder_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;      <a class="code" href="X86DisassemblerDecoder_8c.html#a54c7d02e2f8a7db2f0025c5bcaef3a76">setPrefixPresent</a>(insn, byte, prefixLocation);</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    <span class="keywordflow">case</span> 0x67:  <span class="comment">/* Address-size override */</span></div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;      <span class="keywordflow">if</span> (prefixGroups[3])</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;        <a class="code" href="X86DisassemblerDecoder_8c.html#ac92411447d53b3ccecf5a40f736650cc">dbgprintf</a>(insn, <span class="stringliteral">&quot;Redundant Group 4 prefix&quot;</span>);</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;      prefixGroups[3] = <a class="code" href="X86DisassemblerDecoder_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;      hasAdSize = <a class="code" href="X86DisassemblerDecoder_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;      <a class="code" href="X86DisassemblerDecoder_8c.html#a54c7d02e2f8a7db2f0025c5bcaef3a76">setPrefixPresent</a>(insn, byte, prefixLocation);</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    <span class="keywordflow">default</span>:    <span class="comment">/* Not a prefix byte */</span></div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;      isPrefix = <a class="code" href="X86DisassemblerDecoder_8c.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    }</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    <span class="keywordflow">if</span> (isPrefix)</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;      <a class="code" href="X86DisassemblerDecoder_8c.html#ac92411447d53b3ccecf5a40f736650cc">dbgprintf</a>(insn, <span class="stringliteral">&quot;Found prefix 0x%hhx&quot;</span>, byte);</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;  }</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;  insn-&gt;<a class="code" href="structInternalInstruction.html#aa97e986ba10ca73e59e7fc87805e45d6">vexXopType</a> = <a class="code" href="X86DisassemblerDecoder_8h.html#ad0acf3022faa5f882e157cc76eca34d9af4477fd3be2db8d439904dd794ce6883">TYPE_NO_VEX_XOP</a>;</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;  <span class="keywordflow">if</span> (byte == 0xc4) {</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    uint8_t byte1;</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="X86DisassemblerDecoder_8c.html#aa1d795a5171179078bfc2b8a6114f82f">lookAtByte</a>(insn, &amp;byte1)) {</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;      <a class="code" href="X86DisassemblerDecoder_8c.html#ac92411447d53b3ccecf5a40f736650cc">dbgprintf</a>(insn, <span class="stringliteral">&quot;Couldn&#39;t read second byte of VEX&quot;</span>);</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    }</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    <span class="keywordflow">if</span> (insn-&gt;<a class="code" href="structInternalInstruction.html#a960c71a88602e7284b7a53a43c0d5c04">mode</a> == <a class="code" href="X86DisassemblerDecoderCommon_8h.html#a549ce06ad85d0726a93b2768ae7c7da7aeaebd8c1fe2b71a386838da0280c211c">MODE_64BIT</a> || (byte1 &amp; 0xc0) == 0xc0) {</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;      insn-&gt;<a class="code" href="structInternalInstruction.html#aa97e986ba10ca73e59e7fc87805e45d6">vexXopType</a> = <a class="code" href="X86DisassemblerDecoder_8h.html#ad0acf3022faa5f882e157cc76eca34d9ac814987998f8ea9c90b2e66907ffdbf3">TYPE_VEX_3B</a>;</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;      insn-&gt;<a class="code" href="structInternalInstruction.html#a4ea0269d818e5d2f9405045b254a46fc">necessaryPrefixLocation</a> = insn-&gt;<a class="code" href="structInternalInstruction.html#ab255c3e1663cdfbdebbe1b199140a950">readerCursor</a> - 1;</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    }</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    <span class="keywordflow">else</span> {</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;      <a class="code" href="X86DisassemblerDecoder_8c.html#a76aa63a8eadc46ca3124cc907e841dbb">unconsumeByte</a>(insn);</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;      insn-&gt;<a class="code" href="structInternalInstruction.html#a4ea0269d818e5d2f9405045b254a46fc">necessaryPrefixLocation</a> = insn-&gt;<a class="code" href="structInternalInstruction.html#ab255c3e1663cdfbdebbe1b199140a950">readerCursor</a> - 1;</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    }</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    <span class="keywordflow">if</span> (insn-&gt;<a class="code" href="structInternalInstruction.html#aa97e986ba10ca73e59e7fc87805e45d6">vexXopType</a> == <a class="code" href="X86DisassemblerDecoder_8h.html#ad0acf3022faa5f882e157cc76eca34d9ac814987998f8ea9c90b2e66907ffdbf3">TYPE_VEX_3B</a>) {</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;      insn-&gt;<a class="code" href="structInternalInstruction.html#aef370f198e4d28dfd3db762a7edb7c31">vexXopPrefix</a>[0] = <a class="code" href="README-SSE_8txt.html#ab25ce1a76d8c2513a49fc46d6edab095">byte</a>;</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;      <a class="code" href="X86DisassemblerDecoder_8c.html#a1c693d3ea8868f36b5b192d0315cac04">consumeByte</a>(insn, &amp;insn-&gt;<a class="code" href="structInternalInstruction.html#aef370f198e4d28dfd3db762a7edb7c31">vexXopPrefix</a>[1]);</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;      <a class="code" href="X86DisassemblerDecoder_8c.html#a1c693d3ea8868f36b5b192d0315cac04">consumeByte</a>(insn, &amp;insn-&gt;<a class="code" href="structInternalInstruction.html#aef370f198e4d28dfd3db762a7edb7c31">vexXopPrefix</a>[2]);</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;      <span class="comment">/* We simulate the REX prefix for simplicity&#39;s sake */</span></div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;      <span class="keywordflow">if</span> (insn-&gt;<a class="code" href="structInternalInstruction.html#a960c71a88602e7284b7a53a43c0d5c04">mode</a> == <a class="code" href="X86DisassemblerDecoderCommon_8h.html#a549ce06ad85d0726a93b2768ae7c7da7aeaebd8c1fe2b71a386838da0280c211c">MODE_64BIT</a>) {</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;        insn-&gt;<a class="code" href="structInternalInstruction.html#a11653bcdad44439ab25047cc6dd589cf">rexPrefix</a> = 0x40</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;                        | (<a class="code" href="X86DisassemblerDecoder_8h.html#ab11339ee1e5b8aaa4a706693c51041ae">wFromVEX3of3</a>(insn-&gt;<a class="code" href="structInternalInstruction.html#aef370f198e4d28dfd3db762a7edb7c31">vexXopPrefix</a>[2]) &lt;&lt; 3)</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;                        | (<a class="code" href="X86DisassemblerDecoder_8h.html#a0eb17652126644a237528e0153ee96b1">rFromVEX2of3</a>(insn-&gt;<a class="code" href="structInternalInstruction.html#aef370f198e4d28dfd3db762a7edb7c31">vexXopPrefix</a>[1]) &lt;&lt; 2)</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;                        | (<a class="code" href="X86DisassemblerDecoder_8h.html#a2702d55c4b2a40989bd2b9cc8a71596e">xFromVEX2of3</a>(insn-&gt;<a class="code" href="structInternalInstruction.html#aef370f198e4d28dfd3db762a7edb7c31">vexXopPrefix</a>[1]) &lt;&lt; 1)</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;                        | (<a class="code" href="X86DisassemblerDecoder_8h.html#aabfc6f7a66e0c44fd2145dddeaa88497">bFromVEX2of3</a>(insn-&gt;<a class="code" href="structInternalInstruction.html#aef370f198e4d28dfd3db762a7edb7c31">vexXopPrefix</a>[1]) &lt;&lt; 0);</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;      }</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;      <span class="keywordflow">switch</span> (<a class="code" href="X86DisassemblerDecoder_8h.html#ac85472ee64d389babbd2c32deef16d89">ppFromVEX3of3</a>(insn-&gt;<a class="code" href="structInternalInstruction.html#aef370f198e4d28dfd3db762a7edb7c31">vexXopPrefix</a>[2]))</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;      {</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;      <span class="keywordflow">default</span>:</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="X86DisassemblerDecoder_8h.html#a27161ac001e2359fe24d92fc981e35a8a5f3db606eb177e16ca6cfcb1f5ae0e65">VEX_PREFIX_66</a>:</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;        hasOpSize = <a class="code" href="X86DisassemblerDecoder_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;      }</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;      <a class="code" href="X86DisassemblerDecoder_8c.html#ac92411447d53b3ccecf5a40f736650cc">dbgprintf</a>(insn, <span class="stringliteral">&quot;Found VEX prefix 0x%hhx 0x%hhx 0x%hhx&quot;</span>,</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;                insn-&gt;<a class="code" href="structInternalInstruction.html#aef370f198e4d28dfd3db762a7edb7c31">vexXopPrefix</a>[0], insn-&gt;<a class="code" href="structInternalInstruction.html#aef370f198e4d28dfd3db762a7edb7c31">vexXopPrefix</a>[1],</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;                insn-&gt;<a class="code" href="structInternalInstruction.html#aef370f198e4d28dfd3db762a7edb7c31">vexXopPrefix</a>[2]);</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    }</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;  }</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (byte == 0xc5) {</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    uint8_t byte1;</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="X86DisassemblerDecoder_8c.html#aa1d795a5171179078bfc2b8a6114f82f">lookAtByte</a>(insn, &amp;byte1)) {</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;      <a class="code" href="X86DisassemblerDecoder_8c.html#ac92411447d53b3ccecf5a40f736650cc">dbgprintf</a>(insn, <span class="stringliteral">&quot;Couldn&#39;t read second byte of VEX&quot;</span>);</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    }</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    <span class="keywordflow">if</span> (insn-&gt;<a class="code" href="structInternalInstruction.html#a960c71a88602e7284b7a53a43c0d5c04">mode</a> == <a class="code" href="X86DisassemblerDecoderCommon_8h.html#a549ce06ad85d0726a93b2768ae7c7da7aeaebd8c1fe2b71a386838da0280c211c">MODE_64BIT</a> || (byte1 &amp; 0xc0) == 0xc0) {</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;      insn-&gt;<a class="code" href="structInternalInstruction.html#aa97e986ba10ca73e59e7fc87805e45d6">vexXopType</a> = <a class="code" href="X86DisassemblerDecoder_8h.html#ad0acf3022faa5f882e157cc76eca34d9a443a28cde1bf0566e40b6a38887bb6df">TYPE_VEX_2B</a>;</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    }</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    <span class="keywordflow">else</span> {</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;      <a class="code" href="X86DisassemblerDecoder_8c.html#a76aa63a8eadc46ca3124cc907e841dbb">unconsumeByte</a>(insn);</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    }</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    <span class="keywordflow">if</span> (insn-&gt;<a class="code" href="structInternalInstruction.html#aa97e986ba10ca73e59e7fc87805e45d6">vexXopType</a> == <a class="code" href="X86DisassemblerDecoder_8h.html#ad0acf3022faa5f882e157cc76eca34d9a443a28cde1bf0566e40b6a38887bb6df">TYPE_VEX_2B</a>) {</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;      insn-&gt;<a class="code" href="structInternalInstruction.html#aef370f198e4d28dfd3db762a7edb7c31">vexXopPrefix</a>[0] = <a class="code" href="README-SSE_8txt.html#ab25ce1a76d8c2513a49fc46d6edab095">byte</a>;</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;      <a class="code" href="X86DisassemblerDecoder_8c.html#a1c693d3ea8868f36b5b192d0315cac04">consumeByte</a>(insn, &amp;insn-&gt;<a class="code" href="structInternalInstruction.html#aef370f198e4d28dfd3db762a7edb7c31">vexXopPrefix</a>[1]);</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;      <span class="keywordflow">if</span> (insn-&gt;<a class="code" href="structInternalInstruction.html#a960c71a88602e7284b7a53a43c0d5c04">mode</a> == <a class="code" href="X86DisassemblerDecoderCommon_8h.html#a549ce06ad85d0726a93b2768ae7c7da7aeaebd8c1fe2b71a386838da0280c211c">MODE_64BIT</a>) {</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;        insn-&gt;<a class="code" href="structInternalInstruction.html#a11653bcdad44439ab25047cc6dd589cf">rexPrefix</a> = 0x40</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;                        | (<a class="code" href="X86DisassemblerDecoder_8h.html#a4543a64655e2abfbf25bc206c9219150">rFromVEX2of2</a>(insn-&gt;<a class="code" href="structInternalInstruction.html#aef370f198e4d28dfd3db762a7edb7c31">vexXopPrefix</a>[1]) &lt;&lt; 2);</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;      }</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;      <span class="keywordflow">switch</span> (<a class="code" href="X86DisassemblerDecoder_8h.html#adba38d038bb20114ef792961068aebd9">ppFromVEX2of2</a>(insn-&gt;<a class="code" href="structInternalInstruction.html#aef370f198e4d28dfd3db762a7edb7c31">vexXopPrefix</a>[1]))</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;      {</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;      <span class="keywordflow">default</span>:</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="X86DisassemblerDecoder_8h.html#a27161ac001e2359fe24d92fc981e35a8a5f3db606eb177e16ca6cfcb1f5ae0e65">VEX_PREFIX_66</a>:</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;        hasOpSize = <a class="code" href="X86DisassemblerDecoder_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;      }</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;      <a class="code" href="X86DisassemblerDecoder_8c.html#ac92411447d53b3ccecf5a40f736650cc">dbgprintf</a>(insn, <span class="stringliteral">&quot;Found VEX prefix 0x%hhx 0x%hhx&quot;</span>, insn-&gt;<a class="code" href="structInternalInstruction.html#aef370f198e4d28dfd3db762a7edb7c31">vexXopPrefix</a>[0], insn-&gt;<a class="code" href="structInternalInstruction.html#aef370f198e4d28dfd3db762a7edb7c31">vexXopPrefix</a>[1]);</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    }</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;  }</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (byte == 0x8f) {</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    uint8_t byte1;</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="X86DisassemblerDecoder_8c.html#aa1d795a5171179078bfc2b8a6114f82f">lookAtByte</a>(insn, &amp;byte1)) {</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;      <a class="code" href="X86DisassemblerDecoder_8c.html#ac92411447d53b3ccecf5a40f736650cc">dbgprintf</a>(insn, <span class="stringliteral">&quot;Couldn&#39;t read second byte of XOP&quot;</span>);</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    }</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    <span class="keywordflow">if</span> ((byte1 &amp; 0x38) != 0x0) { <span class="comment">/* 0 in these 3 bits is a POP instruction. */</span></div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;      insn-&gt;<a class="code" href="structInternalInstruction.html#aa97e986ba10ca73e59e7fc87805e45d6">vexXopType</a> = <a class="code" href="X86DisassemblerDecoder_8h.html#ad0acf3022faa5f882e157cc76eca34d9a7b6ca8597d8e43fd94666f6d722d6c43">TYPE_XOP</a>;</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;      insn-&gt;<a class="code" href="structInternalInstruction.html#a4ea0269d818e5d2f9405045b254a46fc">necessaryPrefixLocation</a> = insn-&gt;<a class="code" href="structInternalInstruction.html#ab255c3e1663cdfbdebbe1b199140a950">readerCursor</a> - 1;</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    }</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    <span class="keywordflow">else</span> {</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;      <a class="code" href="X86DisassemblerDecoder_8c.html#a76aa63a8eadc46ca3124cc907e841dbb">unconsumeByte</a>(insn);</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;      insn-&gt;<a class="code" href="structInternalInstruction.html#a4ea0269d818e5d2f9405045b254a46fc">necessaryPrefixLocation</a> = insn-&gt;<a class="code" href="structInternalInstruction.html#ab255c3e1663cdfbdebbe1b199140a950">readerCursor</a> - 1;</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    }</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    <span class="keywordflow">if</span> (insn-&gt;<a class="code" href="structInternalInstruction.html#aa97e986ba10ca73e59e7fc87805e45d6">vexXopType</a> == <a class="code" href="X86DisassemblerDecoder_8h.html#ad0acf3022faa5f882e157cc76eca34d9a7b6ca8597d8e43fd94666f6d722d6c43">TYPE_XOP</a>) {</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;      insn-&gt;<a class="code" href="structInternalInstruction.html#aef370f198e4d28dfd3db762a7edb7c31">vexXopPrefix</a>[0] = <a class="code" href="README-SSE_8txt.html#ab25ce1a76d8c2513a49fc46d6edab095">byte</a>;</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;      <a class="code" href="X86DisassemblerDecoder_8c.html#a1c693d3ea8868f36b5b192d0315cac04">consumeByte</a>(insn, &amp;insn-&gt;<a class="code" href="structInternalInstruction.html#aef370f198e4d28dfd3db762a7edb7c31">vexXopPrefix</a>[1]);</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;      <a class="code" href="X86DisassemblerDecoder_8c.html#a1c693d3ea8868f36b5b192d0315cac04">consumeByte</a>(insn, &amp;insn-&gt;<a class="code" href="structInternalInstruction.html#aef370f198e4d28dfd3db762a7edb7c31">vexXopPrefix</a>[2]);</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;      <span class="comment">/* We simulate the REX prefix for simplicity&#39;s sake */</span></div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;      <span class="keywordflow">if</span> (insn-&gt;<a class="code" href="structInternalInstruction.html#a960c71a88602e7284b7a53a43c0d5c04">mode</a> == <a class="code" href="X86DisassemblerDecoderCommon_8h.html#a549ce06ad85d0726a93b2768ae7c7da7aeaebd8c1fe2b71a386838da0280c211c">MODE_64BIT</a>) {</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;        insn-&gt;<a class="code" href="structInternalInstruction.html#a11653bcdad44439ab25047cc6dd589cf">rexPrefix</a> = 0x40</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;                        | (<a class="code" href="X86DisassemblerDecoder_8h.html#aea420e27120dd9f790849c9090b42256">wFromXOP3of3</a>(insn-&gt;<a class="code" href="structInternalInstruction.html#aef370f198e4d28dfd3db762a7edb7c31">vexXopPrefix</a>[2]) &lt;&lt; 3)</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;                        | (<a class="code" href="X86DisassemblerDecoder_8h.html#a5297b8410eeadfd658404a6cf3958c07">rFromXOP2of3</a>(insn-&gt;<a class="code" href="structInternalInstruction.html#aef370f198e4d28dfd3db762a7edb7c31">vexXopPrefix</a>[1]) &lt;&lt; 2)</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;                        | (<a class="code" href="X86DisassemblerDecoder_8h.html#aa76783b724faa5f93e249184af820b9e">xFromXOP2of3</a>(insn-&gt;<a class="code" href="structInternalInstruction.html#aef370f198e4d28dfd3db762a7edb7c31">vexXopPrefix</a>[1]) &lt;&lt; 1)</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;                        | (<a class="code" href="X86DisassemblerDecoder_8h.html#a215ec2d9ebe8a9be78a3cd8eabaeed71">bFromXOP2of3</a>(insn-&gt;<a class="code" href="structInternalInstruction.html#aef370f198e4d28dfd3db762a7edb7c31">vexXopPrefix</a>[1]) &lt;&lt; 0);</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;      }</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;      <span class="keywordflow">switch</span> (<a class="code" href="X86DisassemblerDecoder_8h.html#a91bdeef85650fa60106450fb24d9c500">ppFromXOP3of3</a>(insn-&gt;<a class="code" href="structInternalInstruction.html#aef370f198e4d28dfd3db762a7edb7c31">vexXopPrefix</a>[2]))</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;      {</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;      <span class="keywordflow">default</span>:</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="X86DisassemblerDecoder_8h.html#a27161ac001e2359fe24d92fc981e35a8a5f3db606eb177e16ca6cfcb1f5ae0e65">VEX_PREFIX_66</a>:</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;        hasOpSize = <a class="code" href="X86DisassemblerDecoder_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;      }</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;      <a class="code" href="X86DisassemblerDecoder_8c.html#ac92411447d53b3ccecf5a40f736650cc">dbgprintf</a>(insn, <span class="stringliteral">&quot;Found XOP prefix 0x%hhx 0x%hhx 0x%hhx&quot;</span>,</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;                insn-&gt;<a class="code" href="structInternalInstruction.html#aef370f198e4d28dfd3db762a7edb7c31">vexXopPrefix</a>[0], insn-&gt;<a class="code" href="structInternalInstruction.html#aef370f198e4d28dfd3db762a7edb7c31">vexXopPrefix</a>[1],</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;                insn-&gt;<a class="code" href="structInternalInstruction.html#aef370f198e4d28dfd3db762a7edb7c31">vexXopPrefix</a>[2]);</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    }</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;  }</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;  <span class="keywordflow">else</span> {</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    <span class="keywordflow">if</span> (insn-&gt;<a class="code" href="structInternalInstruction.html#a960c71a88602e7284b7a53a43c0d5c04">mode</a> == <a class="code" href="X86DisassemblerDecoderCommon_8h.html#a549ce06ad85d0726a93b2768ae7c7da7aeaebd8c1fe2b71a386838da0280c211c">MODE_64BIT</a>) {</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;      <span class="keywordflow">if</span> ((byte &amp; 0xf0) == 0x40) {</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;        uint8_t opcodeByte;</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="X86DisassemblerDecoder_8c.html#aa1d795a5171179078bfc2b8a6114f82f">lookAtByte</a>(insn, &amp;opcodeByte) || ((opcodeByte &amp; 0xf0) == 0x40)) {</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;          <a class="code" href="X86DisassemblerDecoder_8c.html#ac92411447d53b3ccecf5a40f736650cc">dbgprintf</a>(insn, <span class="stringliteral">&quot;Redundant REX prefix&quot;</span>);</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;          <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;        }</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;        insn-&gt;<a class="code" href="structInternalInstruction.html#a11653bcdad44439ab25047cc6dd589cf">rexPrefix</a> = <a class="code" href="README-SSE_8txt.html#ab25ce1a76d8c2513a49fc46d6edab095">byte</a>;</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;        insn-&gt;<a class="code" href="structInternalInstruction.html#a4ea0269d818e5d2f9405045b254a46fc">necessaryPrefixLocation</a> = insn-&gt;<a class="code" href="structInternalInstruction.html#ab255c3e1663cdfbdebbe1b199140a950">readerCursor</a> - 2;</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;        <a class="code" href="X86DisassemblerDecoder_8c.html#ac92411447d53b3ccecf5a40f736650cc">dbgprintf</a>(insn, <span class="stringliteral">&quot;Found REX prefix 0x%hhx&quot;</span>, byte);</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;        <a class="code" href="X86DisassemblerDecoder_8c.html#a76aa63a8eadc46ca3124cc907e841dbb">unconsumeByte</a>(insn);</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;        insn-&gt;<a class="code" href="structInternalInstruction.html#a4ea0269d818e5d2f9405045b254a46fc">necessaryPrefixLocation</a> = insn-&gt;<a class="code" href="structInternalInstruction.html#ab255c3e1663cdfbdebbe1b199140a950">readerCursor</a> - 1;</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;      }</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;      <a class="code" href="X86DisassemblerDecoder_8c.html#a76aa63a8eadc46ca3124cc907e841dbb">unconsumeByte</a>(insn);</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;      insn-&gt;<a class="code" href="structInternalInstruction.html#a4ea0269d818e5d2f9405045b254a46fc">necessaryPrefixLocation</a> = insn-&gt;<a class="code" href="structInternalInstruction.html#ab255c3e1663cdfbdebbe1b199140a950">readerCursor</a> - 1;</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;    }</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;  }</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;  <span class="keywordflow">if</span> (insn-&gt;<a class="code" href="structInternalInstruction.html#a960c71a88602e7284b7a53a43c0d5c04">mode</a> == <a class="code" href="X86DisassemblerDecoderCommon_8h.html#a549ce06ad85d0726a93b2768ae7c7da7a53fbe3659b7806422318b014a19e66c3">MODE_16BIT</a>) {</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;    insn-&gt;<a class="code" href="structInternalInstruction.html#a8dd784f4a8eed89e5918a0abf254ed68">registerSize</a>       = (hasOpSize ? 4 : 2);</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;    insn-&gt;<a class="code" href="structInternalInstruction.html#a401714e4eb9715146c94275270515ba9">addressSize</a>        = (hasAdSize ? 4 : 2);</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;    insn-&gt;<a class="code" href="structInternalInstruction.html#a5b5e7cd9bb41153cfa4b6ea81e0d1b09">displacementSize</a>   = (hasAdSize ? 4 : 2);</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    insn-&gt;<a class="code" href="structInternalInstruction.html#a3bbafa345f93ec20312858606ce8983a">immediateSize</a>      = (hasOpSize ? 4 : 2);</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (insn-&gt;<a class="code" href="structInternalInstruction.html#a960c71a88602e7284b7a53a43c0d5c04">mode</a> == <a class="code" href="X86DisassemblerDecoderCommon_8h.html#a549ce06ad85d0726a93b2768ae7c7da7a43026c766e3f6ed1988064019cf4aa39">MODE_32BIT</a>) {</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    insn-&gt;<a class="code" href="structInternalInstruction.html#a8dd784f4a8eed89e5918a0abf254ed68">registerSize</a>       = (hasOpSize ? 2 : 4);</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;    insn-&gt;<a class="code" href="structInternalInstruction.html#a401714e4eb9715146c94275270515ba9">addressSize</a>        = (hasAdSize ? 2 : 4);</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;    insn-&gt;<a class="code" href="structInternalInstruction.html#a5b5e7cd9bb41153cfa4b6ea81e0d1b09">displacementSize</a>   = (hasAdSize ? 2 : 4);</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    insn-&gt;<a class="code" href="structInternalInstruction.html#a3bbafa345f93ec20312858606ce8983a">immediateSize</a>      = (hasOpSize ? 2 : 4);</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (insn-&gt;<a class="code" href="structInternalInstruction.html#a960c71a88602e7284b7a53a43c0d5c04">mode</a> == <a class="code" href="X86DisassemblerDecoderCommon_8h.html#a549ce06ad85d0726a93b2768ae7c7da7aeaebd8c1fe2b71a386838da0280c211c">MODE_64BIT</a>) {</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;    <span class="keywordflow">if</span> (insn-&gt;<a class="code" href="structInternalInstruction.html#a11653bcdad44439ab25047cc6dd589cf">rexPrefix</a> &amp;&amp; <a class="code" href="X86DisassemblerDecoder_8h.html#a567f29a688d316f9d1e149753d4d77da">wFromREX</a>(insn-&gt;<a class="code" href="structInternalInstruction.html#a11653bcdad44439ab25047cc6dd589cf">rexPrefix</a>)) {</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;      insn-&gt;<a class="code" href="structInternalInstruction.html#a8dd784f4a8eed89e5918a0abf254ed68">registerSize</a>       = 8;</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;      insn-&gt;<a class="code" href="structInternalInstruction.html#a401714e4eb9715146c94275270515ba9">addressSize</a>        = (hasAdSize ? 4 : 8);</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;      insn-&gt;<a class="code" href="structInternalInstruction.html#a5b5e7cd9bb41153cfa4b6ea81e0d1b09">displacementSize</a>   = 4;</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;      insn-&gt;<a class="code" href="structInternalInstruction.html#a3bbafa345f93ec20312858606ce8983a">immediateSize</a>      = 4;</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (insn-&gt;<a class="code" href="structInternalInstruction.html#a11653bcdad44439ab25047cc6dd589cf">rexPrefix</a>) {</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;      insn-&gt;<a class="code" href="structInternalInstruction.html#a8dd784f4a8eed89e5918a0abf254ed68">registerSize</a>       = (hasOpSize ? 2 : 4);</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;      insn-&gt;<a class="code" href="structInternalInstruction.html#a401714e4eb9715146c94275270515ba9">addressSize</a>        = (hasAdSize ? 4 : 8);</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;      insn-&gt;<a class="code" href="structInternalInstruction.html#a5b5e7cd9bb41153cfa4b6ea81e0d1b09">displacementSize</a>   = (hasOpSize ? 2 : 4);</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;      insn-&gt;<a class="code" href="structInternalInstruction.html#a3bbafa345f93ec20312858606ce8983a">immediateSize</a>      = (hasOpSize ? 2 : 4);</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;      insn-&gt;<a class="code" href="structInternalInstruction.html#a8dd784f4a8eed89e5918a0abf254ed68">registerSize</a>       = (hasOpSize ? 2 : 4);</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;      insn-&gt;<a class="code" href="structInternalInstruction.html#a401714e4eb9715146c94275270515ba9">addressSize</a>        = (hasAdSize ? 4 : 8);</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;      insn-&gt;<a class="code" href="structInternalInstruction.html#a5b5e7cd9bb41153cfa4b6ea81e0d1b09">displacementSize</a>   = (hasOpSize ? 2 : 4);</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;      insn-&gt;<a class="code" href="structInternalInstruction.html#a3bbafa345f93ec20312858606ce8983a">immediateSize</a>      = (hasOpSize ? 2 : 4);</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    }</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;  }</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;}</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;<span class="comment"> * readOpcode - Reads the opcode (excepting the ModR/M byte in the case of</span></div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;<span class="comment"> *   extended or escape opcodes).</span></div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;<span class="comment"> * @param insn  - The instruction whose opcode is to be read.</span></div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;<span class="comment"> * @return      - 0 if the opcode could be read successfully; nonzero otherwise.</span></div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00640"></a><span class="lineno"><a class="line" href="X86DisassemblerDecoder_8c.html#a0a006bbcf8e6c2fb5ab33c0066467e56">  640</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="X86DisassemblerDecoder_8c.html#a0a006bbcf8e6c2fb5ab33c0066467e56">readOpcode</a>(<span class="keyword">struct</span> <a class="code" href="structInternalInstruction.html">InternalInstruction</a>* insn) {</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;  <span class="comment">/* Determine the length of the primary opcode */</span></div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;  uint8_t current;</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;  <a class="code" href="X86DisassemblerDecoder_8c.html#ac92411447d53b3ccecf5a40f736650cc">dbgprintf</a>(insn, <span class="stringliteral">&quot;readOpcode()&quot;</span>);</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;  insn-&gt;<a class="code" href="structInternalInstruction.html#a0e7bbab87ac33b62bb1d9cad65c77a68">opcodeType</a> = <a class="code" href="X86DisassemblerDecoderCommon_8h.html#a5cc171c21d0532e0f6353e972f1ff621a703a4841d8c5722f1f7b0c887beca64e">ONEBYTE</a>;</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;  <span class="keywordflow">if</span> (insn-&gt;<a class="code" href="structInternalInstruction.html#aa97e986ba10ca73e59e7fc87805e45d6">vexXopType</a> == <a class="code" href="X86DisassemblerDecoder_8h.html#ad0acf3022faa5f882e157cc76eca34d9ac814987998f8ea9c90b2e66907ffdbf3">TYPE_VEX_3B</a>)</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;  {</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;    <span class="keywordflow">switch</span> (<a class="code" href="X86DisassemblerDecoder_8h.html#a30e003e4461758b6dba2c70f339ed6c3">mmmmmFromVEX2of3</a>(insn-&gt;<a class="code" href="structInternalInstruction.html#aef370f198e4d28dfd3db762a7edb7c31">vexXopPrefix</a>[1]))</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    {</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;    <span class="keywordflow">default</span>:</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;      <a class="code" href="X86DisassemblerDecoder_8c.html#ac92411447d53b3ccecf5a40f736650cc">dbgprintf</a>(insn, <span class="stringliteral">&quot;Unhandled m-mmmm field for instruction (0x%hhx)&quot;</span>,</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;                <a class="code" href="X86DisassemblerDecoder_8h.html#a30e003e4461758b6dba2c70f339ed6c3">mmmmmFromVEX2of3</a>(insn-&gt;<a class="code" href="structInternalInstruction.html#aef370f198e4d28dfd3db762a7edb7c31">vexXopPrefix</a>[1]));</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="X86DisassemblerDecoder_8h.html#ad686b7233351c632a5403bb8880b2879a9a40a4486721b709051aa03918e50241">VEX_LOB_0F</a>:</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;      insn-&gt;<a class="code" href="structInternalInstruction.html#a0e7bbab87ac33b62bb1d9cad65c77a68">opcodeType</a> = <a class="code" href="X86DisassemblerDecoderCommon_8h.html#a5cc171c21d0532e0f6353e972f1ff621a339165d45a0200fd88efae325ac01b10">TWOBYTE</a>;</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="X86DisassemblerDecoder_8c.html#a1c693d3ea8868f36b5b192d0315cac04">consumeByte</a>(insn, &amp;insn-&gt;<a class="code" href="structInternalInstruction.html#a0106234d00ddfeb8e9e29dadfca758ee">opcode</a>);</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="X86DisassemblerDecoder_8h.html#ad686b7233351c632a5403bb8880b2879af71a9e484b7632521ba492c4027978b4">VEX_LOB_0F38</a>:</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;      insn-&gt;<a class="code" href="structInternalInstruction.html#a0e7bbab87ac33b62bb1d9cad65c77a68">opcodeType</a> = <a class="code" href="X86DisassemblerDecoderCommon_8h.html#a5cc171c21d0532e0f6353e972f1ff621a6666ce07b725a97b298534bba4549531">THREEBYTE_38</a>;</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="X86DisassemblerDecoder_8c.html#a1c693d3ea8868f36b5b192d0315cac04">consumeByte</a>(insn, &amp;insn-&gt;<a class="code" href="structInternalInstruction.html#a0106234d00ddfeb8e9e29dadfca758ee">opcode</a>);</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="X86DisassemblerDecoder_8h.html#ad686b7233351c632a5403bb8880b2879a18e6eac10bc946b39abd1f7baa070f70">VEX_LOB_0F3A</a>:</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;      insn-&gt;<a class="code" href="structInternalInstruction.html#a0e7bbab87ac33b62bb1d9cad65c77a68">opcodeType</a> = <a class="code" href="X86DisassemblerDecoderCommon_8h.html#a5cc171c21d0532e0f6353e972f1ff621ac673abd123c1e32fa09f13b8d89af428">THREEBYTE_3A</a>;</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="X86DisassemblerDecoder_8c.html#a1c693d3ea8868f36b5b192d0315cac04">consumeByte</a>(insn, &amp;insn-&gt;<a class="code" href="structInternalInstruction.html#a0106234d00ddfeb8e9e29dadfca758ee">opcode</a>);</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;    }</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;  }</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (insn-&gt;<a class="code" href="structInternalInstruction.html#aa97e986ba10ca73e59e7fc87805e45d6">vexXopType</a> == <a class="code" href="X86DisassemblerDecoder_8h.html#ad0acf3022faa5f882e157cc76eca34d9a443a28cde1bf0566e40b6a38887bb6df">TYPE_VEX_2B</a>)</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;  {</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;    insn-&gt;<a class="code" href="structInternalInstruction.html#a0e7bbab87ac33b62bb1d9cad65c77a68">opcodeType</a> = <a class="code" href="X86DisassemblerDecoderCommon_8h.html#a5cc171c21d0532e0f6353e972f1ff621a339165d45a0200fd88efae325ac01b10">TWOBYTE</a>;</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="X86DisassemblerDecoder_8c.html#a1c693d3ea8868f36b5b192d0315cac04">consumeByte</a>(insn, &amp;insn-&gt;<a class="code" href="structInternalInstruction.html#a0106234d00ddfeb8e9e29dadfca758ee">opcode</a>);</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;  }</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (insn-&gt;<a class="code" href="structInternalInstruction.html#aa97e986ba10ca73e59e7fc87805e45d6">vexXopType</a> == <a class="code" href="X86DisassemblerDecoder_8h.html#ad0acf3022faa5f882e157cc76eca34d9a7b6ca8597d8e43fd94666f6d722d6c43">TYPE_XOP</a>)</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;  {</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;    <span class="keywordflow">switch</span> (<a class="code" href="X86DisassemblerDecoder_8h.html#abbed9da0e0dde67954fe9e97f6befcc5">mmmmmFromXOP2of3</a>(insn-&gt;<a class="code" href="structInternalInstruction.html#aef370f198e4d28dfd3db762a7edb7c31">vexXopPrefix</a>[1]))</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    {</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    <span class="keywordflow">default</span>:</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;      <a class="code" href="X86DisassemblerDecoder_8c.html#ac92411447d53b3ccecf5a40f736650cc">dbgprintf</a>(insn, <span class="stringliteral">&quot;Unhandled m-mmmm field for instruction (0x%hhx)&quot;</span>,</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;                <a class="code" href="X86DisassemblerDecoder_8h.html#a30e003e4461758b6dba2c70f339ed6c3">mmmmmFromVEX2of3</a>(insn-&gt;<a class="code" href="structInternalInstruction.html#aef370f198e4d28dfd3db762a7edb7c31">vexXopPrefix</a>[1]));</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="X86DisassemblerDecoder_8h.html#a9f49754c886a53ae214267b3ec3ca263a8416fd22a95920c95067eabe698579f2">XOP_MAP_SELECT_8</a>:</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;      insn-&gt;<a class="code" href="structInternalInstruction.html#a0e7bbab87ac33b62bb1d9cad65c77a68">opcodeType</a> = <a class="code" href="X86DisassemblerDecoderCommon_8h.html#a5cc171c21d0532e0f6353e972f1ff621a6383f0e83ff34dfa506e53e9b7b3edcd">XOP8_MAP</a>;</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="X86DisassemblerDecoder_8c.html#a1c693d3ea8868f36b5b192d0315cac04">consumeByte</a>(insn, &amp;insn-&gt;<a class="code" href="structInternalInstruction.html#a0106234d00ddfeb8e9e29dadfca758ee">opcode</a>);</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="X86DisassemblerDecoder_8h.html#a9f49754c886a53ae214267b3ec3ca263a4fda3836b35318bcdc0456e39a344dfc">XOP_MAP_SELECT_9</a>:</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;      insn-&gt;<a class="code" href="structInternalInstruction.html#a0e7bbab87ac33b62bb1d9cad65c77a68">opcodeType</a> = <a class="code" href="X86DisassemblerDecoderCommon_8h.html#a5cc171c21d0532e0f6353e972f1ff621a208f2badc53ec65f21dbe280dfab63c5">XOP9_MAP</a>;</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="X86DisassemblerDecoder_8c.html#a1c693d3ea8868f36b5b192d0315cac04">consumeByte</a>(insn, &amp;insn-&gt;<a class="code" href="structInternalInstruction.html#a0106234d00ddfeb8e9e29dadfca758ee">opcode</a>);</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="X86DisassemblerDecoder_8h.html#a9f49754c886a53ae214267b3ec3ca263a5a96f045828489ae6d49bf72d90225b7">XOP_MAP_SELECT_A</a>:</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;      insn-&gt;<a class="code" href="structInternalInstruction.html#a0e7bbab87ac33b62bb1d9cad65c77a68">opcodeType</a> = <a class="code" href="X86DisassemblerDecoderCommon_8h.html#a5cc171c21d0532e0f6353e972f1ff621ae7d385e3466556921813f6ec2505e3ae">XOPA_MAP</a>;</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="X86DisassemblerDecoder_8c.html#a1c693d3ea8868f36b5b192d0315cac04">consumeByte</a>(insn, &amp;insn-&gt;<a class="code" href="structInternalInstruction.html#a0106234d00ddfeb8e9e29dadfca758ee">opcode</a>);</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;    }</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;  }</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="X86DisassemblerDecoder_8c.html#a1c693d3ea8868f36b5b192d0315cac04">consumeByte</a>(insn, &amp;current))</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;  <span class="keywordflow">if</span> (current == 0x0f) {</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;    <a class="code" href="X86DisassemblerDecoder_8c.html#ac92411447d53b3ccecf5a40f736650cc">dbgprintf</a>(insn, <span class="stringliteral">&quot;Found a two-byte escape prefix (0x%hhx)&quot;</span>, current);</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="X86DisassemblerDecoder_8c.html#a1c693d3ea8868f36b5b192d0315cac04">consumeByte</a>(insn, &amp;current))</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;    <span class="keywordflow">if</span> (current == 0x38) {</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;      <a class="code" href="X86DisassemblerDecoder_8c.html#ac92411447d53b3ccecf5a40f736650cc">dbgprintf</a>(insn, <span class="stringliteral">&quot;Found a three-byte escape prefix (0x%hhx)&quot;</span>, current);</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="X86DisassemblerDecoder_8c.html#a1c693d3ea8868f36b5b192d0315cac04">consumeByte</a>(insn, &amp;current))</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;        <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;      insn-&gt;<a class="code" href="structInternalInstruction.html#a0e7bbab87ac33b62bb1d9cad65c77a68">opcodeType</a> = <a class="code" href="X86DisassemblerDecoderCommon_8h.html#a5cc171c21d0532e0f6353e972f1ff621a6666ce07b725a97b298534bba4549531">THREEBYTE_38</a>;</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (current == 0x3a) {</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;      <a class="code" href="X86DisassemblerDecoder_8c.html#ac92411447d53b3ccecf5a40f736650cc">dbgprintf</a>(insn, <span class="stringliteral">&quot;Found a three-byte escape prefix (0x%hhx)&quot;</span>, current);</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="X86DisassemblerDecoder_8c.html#a1c693d3ea8868f36b5b192d0315cac04">consumeByte</a>(insn, &amp;current))</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;        <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;      insn-&gt;<a class="code" href="structInternalInstruction.html#a0e7bbab87ac33b62bb1d9cad65c77a68">opcodeType</a> = <a class="code" href="X86DisassemblerDecoderCommon_8h.html#a5cc171c21d0532e0f6353e972f1ff621ac673abd123c1e32fa09f13b8d89af428">THREEBYTE_3A</a>;</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (current == 0xa6) {</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;      <a class="code" href="X86DisassemblerDecoder_8c.html#ac92411447d53b3ccecf5a40f736650cc">dbgprintf</a>(insn, <span class="stringliteral">&quot;Found a three-byte escape prefix (0x%hhx)&quot;</span>, current);</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="X86DisassemblerDecoder_8c.html#a1c693d3ea8868f36b5b192d0315cac04">consumeByte</a>(insn, &amp;current))</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;        <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;      insn-&gt;<a class="code" href="structInternalInstruction.html#a0e7bbab87ac33b62bb1d9cad65c77a68">opcodeType</a> = <a class="code" href="X86DisassemblerDecoderCommon_8h.html#a5cc171c21d0532e0f6353e972f1ff621a26952e7ac04ca61b0c1029cb7a656518">THREEBYTE_A6</a>;</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (current == 0xa7) {</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;      <a class="code" href="X86DisassemblerDecoder_8c.html#ac92411447d53b3ccecf5a40f736650cc">dbgprintf</a>(insn, <span class="stringliteral">&quot;Found a three-byte escape prefix (0x%hhx)&quot;</span>, current);</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="X86DisassemblerDecoder_8c.html#a1c693d3ea8868f36b5b192d0315cac04">consumeByte</a>(insn, &amp;current))</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;        <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;      insn-&gt;<a class="code" href="structInternalInstruction.html#a0e7bbab87ac33b62bb1d9cad65c77a68">opcodeType</a> = <a class="code" href="X86DisassemblerDecoderCommon_8h.html#a5cc171c21d0532e0f6353e972f1ff621a47fe68a9ef1b2de8d7f18109579354c3">THREEBYTE_A7</a>;</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;      <a class="code" href="X86DisassemblerDecoder_8c.html#ac92411447d53b3ccecf5a40f736650cc">dbgprintf</a>(insn, <span class="stringliteral">&quot;Didn&#39;t find a three-byte escape prefix&quot;</span>);</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;      insn-&gt;<a class="code" href="structInternalInstruction.html#a0e7bbab87ac33b62bb1d9cad65c77a68">opcodeType</a> = <a class="code" href="X86DisassemblerDecoderCommon_8h.html#a5cc171c21d0532e0f6353e972f1ff621a339165d45a0200fd88efae325ac01b10">TWOBYTE</a>;</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;    }</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;  }</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;  <span class="comment">/*</span></div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;<span class="comment">   * At this point we have consumed the full opcode.</span></div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;<span class="comment">   * Anything we consume from here on must be unconsumed.</span></div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;<span class="comment">   */</span></div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;  insn-&gt;<a class="code" href="structInternalInstruction.html#a0106234d00ddfeb8e9e29dadfca758ee">opcode</a> = current;</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;}</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="X86DisassemblerDecoder_8c.html#ae354b93b59d4f78cddbb50869bd5ef6b">readModRM</a>(<span class="keyword">struct</span> <a class="code" href="structInternalInstruction.html">InternalInstruction</a>* insn);</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;<span class="comment"> * getIDWithAttrMask - Determines the ID of an instruction, consuming</span></div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;<span class="comment"> *   the ModR/M byte as appropriate for extended and escape opcodes,</span></div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;<span class="comment"> *   and using a supplied attribute mask.</span></div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;<span class="comment"> * @param instructionID - A pointer whose target is filled in with the ID of the</span></div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;<span class="comment"> *                        instruction.</span></div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;<span class="comment"> * @param insn          - The instruction whose ID is to be determined.</span></div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;<span class="comment"> * @param attrMask      - The attribute mask to search.</span></div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;<span class="comment"> * @return              - 0 if the ModR/M could be read when needed or was not</span></div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;<span class="comment"> *                        needed; nonzero otherwise.</span></div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00761"></a><span class="lineno"><a class="line" href="X86DisassemblerDecoder_8c.html#a9bf76a53657a663a17a3df12a4293d99">  761</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="X86DisassemblerDecoder_8c.html#a9bf76a53657a663a17a3df12a4293d99">getIDWithAttrMask</a>(uint16_t* instructionID,</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;                             <span class="keyword">struct</span> <a class="code" href="structInternalInstruction.html">InternalInstruction</a>* insn,</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;                             uint8_t attrMask) {</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;  <a class="code" href="X86DisassemblerDecoder_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a> hasModRMExtension;</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;  uint8_t instructionClass;</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;  instructionClass = <a class="code" href="X86DisassemblerDecoder_8c.html#a35319d994370e141dced971952e7e6f5">contextForAttrs</a>(attrMask);</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;  hasModRMExtension = <a class="code" href="X86DisassemblerDecoder_8c.html#a17aad449cab97040952f09d23f56cac7">modRMRequired</a>(insn-&gt;<a class="code" href="structInternalInstruction.html#a0e7bbab87ac33b62bb1d9cad65c77a68">opcodeType</a>,</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;                                    instructionClass,</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;                                    insn-&gt;<a class="code" href="structInternalInstruction.html#a0106234d00ddfeb8e9e29dadfca758ee">opcode</a>);</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;  <span class="keywordflow">if</span> (hasModRMExtension) {</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="X86DisassemblerDecoder_8c.html#ae354b93b59d4f78cddbb50869bd5ef6b">readModRM</a>(insn))</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;    *instructionID = <a class="code" href="X86DisassemblerDecoder_8c.html#ab3686bdd912c0d40035aa66dcffb36da">decode</a>(insn-&gt;<a class="code" href="structInternalInstruction.html#a0e7bbab87ac33b62bb1d9cad65c77a68">opcodeType</a>,</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;                            instructionClass,</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;                            insn-&gt;<a class="code" href="structInternalInstruction.html#a0106234d00ddfeb8e9e29dadfca758ee">opcode</a>,</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;                            insn-&gt;<a class="code" href="structInternalInstruction.html#a4e8995824272b3ea6083c73aaf39e00d">modRM</a>);</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;    *instructionID = <a class="code" href="X86DisassemblerDecoder_8c.html#ab3686bdd912c0d40035aa66dcffb36da">decode</a>(insn-&gt;<a class="code" href="structInternalInstruction.html#a0e7bbab87ac33b62bb1d9cad65c77a68">opcodeType</a>,</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;                            instructionClass,</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;                            insn-&gt;<a class="code" href="structInternalInstruction.html#a0106234d00ddfeb8e9e29dadfca758ee">opcode</a>,</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;                            0);</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;  }</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;}</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;<span class="comment"> * is16BitEquivalent - Determines whether two instruction names refer to</span></div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;<span class="comment"> * equivalent instructions but one is 16-bit whereas the other is not.</span></div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;<span class="comment"> * @param orig  - The instruction that is not 16-bit</span></div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;<span class="comment"> * @param equiv - The instruction that is 16-bit</span></div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00799"></a><span class="lineno"><a class="line" href="X86DisassemblerDecoder_8c.html#a6c7cca3d994492926e7a3108baddbad6">  799</a></span>&#160;<span class="keyword">static</span> <a class="code" href="X86DisassemblerDecoder_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a> <a class="code" href="X86DisassemblerDecoder_8c.html#a6c7cca3d994492926e7a3108baddbad6">is16BitEquivalent</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* orig, <span class="keyword">const</span> <span class="keywordtype">char</span>* equiv) {</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;  off_t <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;  <span class="keywordflow">for</span> (i = 0;; i++) {</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;    <span class="keywordflow">if</span> (orig[i] == <span class="charliteral">&#39;\0&#39;</span> &amp;&amp; equiv[i] == <span class="charliteral">&#39;\0&#39;</span>)</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="X86DisassemblerDecoder_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;    <span class="keywordflow">if</span> (orig[i] == <span class="charliteral">&#39;\0&#39;</span> || equiv[i] == <span class="charliteral">&#39;\0&#39;</span>)</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="X86DisassemblerDecoder_8c.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;    <span class="keywordflow">if</span> (orig[i] != equiv[i]) {</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;      <span class="keywordflow">if</span> ((orig[i] == <span class="charliteral">&#39;Q&#39;</span> || orig[i] == <span class="charliteral">&#39;L&#39;</span>) &amp;&amp; equiv[i] == <span class="charliteral">&#39;W&#39;</span>)</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;      <span class="keywordflow">if</span> ((orig[i] == <span class="charliteral">&#39;6&#39;</span> || orig[i] == <span class="charliteral">&#39;3&#39;</span>) &amp;&amp; equiv[i] == <span class="charliteral">&#39;1&#39;</span>)</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;      <span class="keywordflow">if</span> ((orig[i] == <span class="charliteral">&#39;4&#39;</span> || orig[i] == <span class="charliteral">&#39;2&#39;</span>) &amp;&amp; equiv[i] == <span class="charliteral">&#39;6&#39;</span>)</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="X86DisassemblerDecoder_8c.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;    }</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;  }</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;}</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;<span class="comment"> * getID - Determines the ID of an instruction, consuming the ModR/M byte as</span></div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;<span class="comment"> *   appropriate for extended and escape opcodes.  Determines the attributes and</span></div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;<span class="comment"> *   context for the instruction before doing so.</span></div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;<span class="comment"> * @param insn  - The instruction whose ID is to be determined.</span></div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;<span class="comment"> * @return      - 0 if the ModR/M could be read when needed or was not needed;</span></div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;<span class="comment"> *                nonzero otherwise.</span></div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00828"></a><span class="lineno"><a class="line" href="X86DisassemblerDecoder_8c.html#a3940644102a488fdce81b36d054bbee3">  828</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="X86DisassemblerDecoder_8c.html#a3940644102a488fdce81b36d054bbee3">getID</a>(<span class="keyword">struct</span> <a class="code" href="structInternalInstruction.html">InternalInstruction</a>* insn, <span class="keyword">const</span> <span class="keywordtype">void</span> *miiArg) {</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;  uint8_t attrMask;</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;  uint16_t instructionID;</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;  <a class="code" href="X86DisassemblerDecoder_8c.html#ac92411447d53b3ccecf5a40f736650cc">dbgprintf</a>(insn, <span class="stringliteral">&quot;getID()&quot;</span>);</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;  attrMask = ATTR_NONE;</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;  <span class="keywordflow">if</span> (insn-&gt;<a class="code" href="structInternalInstruction.html#a960c71a88602e7284b7a53a43c0d5c04">mode</a> == <a class="code" href="X86DisassemblerDecoderCommon_8h.html#a549ce06ad85d0726a93b2768ae7c7da7aeaebd8c1fe2b71a386838da0280c211c">MODE_64BIT</a>)</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;    attrMask |= ATTR_64BIT;</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;  <span class="keywordflow">if</span> (insn-&gt;<a class="code" href="structInternalInstruction.html#aa97e986ba10ca73e59e7fc87805e45d6">vexXopType</a> != <a class="code" href="X86DisassemblerDecoder_8h.html#ad0acf3022faa5f882e157cc76eca34d9af4477fd3be2db8d439904dd794ce6883">TYPE_NO_VEX_XOP</a>) {</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;    attrMask |= ATTR_VEX;</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;    <span class="keywordflow">if</span> (insn-&gt;<a class="code" href="structInternalInstruction.html#aa97e986ba10ca73e59e7fc87805e45d6">vexXopType</a> == <a class="code" href="X86DisassemblerDecoder_8h.html#ad0acf3022faa5f882e157cc76eca34d9ac814987998f8ea9c90b2e66907ffdbf3">TYPE_VEX_3B</a>) {</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;      <span class="keywordflow">switch</span> (<a class="code" href="X86DisassemblerDecoder_8h.html#ac85472ee64d389babbd2c32deef16d89">ppFromVEX3of3</a>(insn-&gt;<a class="code" href="structInternalInstruction.html#aef370f198e4d28dfd3db762a7edb7c31">vexXopPrefix</a>[2])) {</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="X86DisassemblerDecoder_8h.html#a27161ac001e2359fe24d92fc981e35a8a5f3db606eb177e16ca6cfcb1f5ae0e65">VEX_PREFIX_66</a>:</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;        attrMask |= ATTR_OPSIZE;</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="X86DisassemblerDecoder_8h.html#a27161ac001e2359fe24d92fc981e35a8a8a536cd1595533eb4dba530aa5571f29">VEX_PREFIX_F3</a>:</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;        attrMask |= ATTR_XS;</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="X86DisassemblerDecoder_8h.html#a27161ac001e2359fe24d92fc981e35a8a901c8f1034e86a24a18818ebb74d7733">VEX_PREFIX_F2</a>:</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;        attrMask |= ATTR_XD;</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;      }</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="X86DisassemblerDecoder_8h.html#abf2fe87228fa8c1419f2a5f86baaa597">lFromVEX3of3</a>(insn-&gt;<a class="code" href="structInternalInstruction.html#aef370f198e4d28dfd3db762a7edb7c31">vexXopPrefix</a>[2]))</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;        attrMask |= ATTR_VEXL;</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;    }</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (insn-&gt;<a class="code" href="structInternalInstruction.html#aa97e986ba10ca73e59e7fc87805e45d6">vexXopType</a> == <a class="code" href="X86DisassemblerDecoder_8h.html#ad0acf3022faa5f882e157cc76eca34d9a443a28cde1bf0566e40b6a38887bb6df">TYPE_VEX_2B</a>) {</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;      <span class="keywordflow">switch</span> (<a class="code" href="X86DisassemblerDecoder_8h.html#adba38d038bb20114ef792961068aebd9">ppFromVEX2of2</a>(insn-&gt;<a class="code" href="structInternalInstruction.html#aef370f198e4d28dfd3db762a7edb7c31">vexXopPrefix</a>[1])) {</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="X86DisassemblerDecoder_8h.html#a27161ac001e2359fe24d92fc981e35a8a5f3db606eb177e16ca6cfcb1f5ae0e65">VEX_PREFIX_66</a>:</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;        attrMask |= ATTR_OPSIZE;</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="X86DisassemblerDecoder_8h.html#a27161ac001e2359fe24d92fc981e35a8a8a536cd1595533eb4dba530aa5571f29">VEX_PREFIX_F3</a>:</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;        attrMask |= ATTR_XS;</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="X86DisassemblerDecoder_8h.html#a27161ac001e2359fe24d92fc981e35a8a901c8f1034e86a24a18818ebb74d7733">VEX_PREFIX_F2</a>:</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;        attrMask |= ATTR_XD;</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;      }</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="X86DisassemblerDecoder_8h.html#a6886436df5f38bbed7d036a5d8cb44bf">lFromVEX2of2</a>(insn-&gt;<a class="code" href="structInternalInstruction.html#aef370f198e4d28dfd3db762a7edb7c31">vexXopPrefix</a>[1]))</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;        attrMask |= ATTR_VEXL;</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;    }</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (insn-&gt;<a class="code" href="structInternalInstruction.html#aa97e986ba10ca73e59e7fc87805e45d6">vexXopType</a> == <a class="code" href="X86DisassemblerDecoder_8h.html#ad0acf3022faa5f882e157cc76eca34d9a7b6ca8597d8e43fd94666f6d722d6c43">TYPE_XOP</a>) {</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;      <span class="keywordflow">switch</span> (<a class="code" href="X86DisassemblerDecoder_8h.html#a91bdeef85650fa60106450fb24d9c500">ppFromXOP3of3</a>(insn-&gt;<a class="code" href="structInternalInstruction.html#aef370f198e4d28dfd3db762a7edb7c31">vexXopPrefix</a>[2])) {</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="X86DisassemblerDecoder_8h.html#a27161ac001e2359fe24d92fc981e35a8a5f3db606eb177e16ca6cfcb1f5ae0e65">VEX_PREFIX_66</a>:</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;        attrMask |= ATTR_OPSIZE;</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="X86DisassemblerDecoder_8h.html#a27161ac001e2359fe24d92fc981e35a8a8a536cd1595533eb4dba530aa5571f29">VEX_PREFIX_F3</a>:</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;        attrMask |= ATTR_XS;</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="X86DisassemblerDecoder_8h.html#a27161ac001e2359fe24d92fc981e35a8a901c8f1034e86a24a18818ebb74d7733">VEX_PREFIX_F2</a>:</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;        attrMask |= ATTR_XD;</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;      }</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="X86DisassemblerDecoder_8h.html#a63266a63baf54bef487061a728d12908">lFromXOP3of3</a>(insn-&gt;<a class="code" href="structInternalInstruction.html#aef370f198e4d28dfd3db762a7edb7c31">vexXopPrefix</a>[2]))</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;        attrMask |= ATTR_VEXL;</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;    }</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;    <span class="keywordflow">else</span> {</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;    }</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;  }</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;  <span class="keywordflow">else</span> {</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="X86DisassemblerDecoder_8c.html#a64e2c61de541dbe1de34d17fab03c656">isPrefixAtLocation</a>(insn, 0x66, insn-&gt;<a class="code" href="structInternalInstruction.html#a4ea0269d818e5d2f9405045b254a46fc">necessaryPrefixLocation</a>))</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;      attrMask |= ATTR_OPSIZE;</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="X86DisassemblerDecoder_8c.html#a64e2c61de541dbe1de34d17fab03c656">isPrefixAtLocation</a>(insn, 0x67, insn-&gt;<a class="code" href="structInternalInstruction.html#a4ea0269d818e5d2f9405045b254a46fc">necessaryPrefixLocation</a>))</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;      attrMask |= ATTR_ADSIZE;</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="X86DisassemblerDecoder_8c.html#a64e2c61de541dbe1de34d17fab03c656">isPrefixAtLocation</a>(insn, 0xf3, insn-&gt;<a class="code" href="structInternalInstruction.html#a4ea0269d818e5d2f9405045b254a46fc">necessaryPrefixLocation</a>))</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;      attrMask |= ATTR_XS;</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="X86DisassemblerDecoder_8c.html#a64e2c61de541dbe1de34d17fab03c656">isPrefixAtLocation</a>(insn, 0xf2, insn-&gt;<a class="code" href="structInternalInstruction.html#a4ea0269d818e5d2f9405045b254a46fc">necessaryPrefixLocation</a>))</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;      attrMask |= ATTR_XD;</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;  }</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;  <span class="keywordflow">if</span> (insn-&gt;<a class="code" href="structInternalInstruction.html#a11653bcdad44439ab25047cc6dd589cf">rexPrefix</a> &amp; 0x08)</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;    attrMask |= ATTR_REXW;</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="X86DisassemblerDecoder_8c.html#a9bf76a53657a663a17a3df12a4293d99">getIDWithAttrMask</a>(&amp;instructionID, insn, attrMask))</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;  <span class="comment">/* The following clauses compensate for limitations of the tables. */</span></div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;  <span class="keywordflow">if</span> (insn-&gt;<a class="code" href="structInternalInstruction.html#a0cde7d21e5b2cd6fb19a76ec86bbd92e">prefixPresent</a>[0x66] &amp;&amp; !(attrMask &amp; ATTR_OPSIZE)) {</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;    <span class="comment">/*</span></div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;<span class="comment">     * The instruction tables make no distinction between instructions that</span></div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;<span class="comment">     * allow OpSize anywhere (i.e., 16-bit operations) and that need it in a</span></div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;<span class="comment">     * particular spot (i.e., many MMX operations).  In general we&#39;re</span></div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;<span class="comment">     * conservative, but in the specific case where OpSize is present but not</span></div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;<span class="comment">     * in the right place we check if there&#39;s a 16-bit operation.</span></div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;<span class="comment">     */</span></div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;    <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structInstructionSpecifier.html">InstructionSpecifier</a> *spec;</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;    uint16_t instructionIDWithOpsize;</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *specName, *specWithOpSizeName;</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;    spec = <a class="code" href="X86DisassemblerDecoder_8c.html#a553631909c27b5f8a94d65ebb13e73ae">specifierForUID</a>(instructionID);</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="X86DisassemblerDecoder_8c.html#a9bf76a53657a663a17a3df12a4293d99">getIDWithAttrMask</a>(&amp;instructionIDWithOpsize,</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;                          insn,</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;                          attrMask | ATTR_OPSIZE)) {</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;<span class="comment">       * ModRM required with OpSize but not present; give up and return version</span></div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;<span class="comment">       * without OpSize set</span></div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;      insn-&gt;<a class="code" href="structInternalInstruction.html#a2c614fda371a4b9cd14cf06154458364">instructionID</a> = instructionID;</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;      insn-&gt;<a class="code" href="structInternalInstruction.html#a1d85c98f4456ef539774d603d4e15e0d">spec</a> = spec;</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;    }</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;    specName = <a class="code" href="X86Disassembler_8cpp.html#ab989dba004fc91ca37606095e0a98b54">x86DisassemblerGetInstrName</a>(instructionID, miiArg);</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;    specWithOpSizeName =</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;      <a class="code" href="X86Disassembler_8cpp.html#ab989dba004fc91ca37606095e0a98b54">x86DisassemblerGetInstrName</a>(instructionIDWithOpsize, miiArg);</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="X86DisassemblerDecoder_8c.html#a6c7cca3d994492926e7a3108baddbad6">is16BitEquivalent</a>(specName, specWithOpSizeName)) {</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;      insn-&gt;<a class="code" href="structInternalInstruction.html#a2c614fda371a4b9cd14cf06154458364">instructionID</a> = instructionIDWithOpsize;</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;      insn-&gt;<a class="code" href="structInternalInstruction.html#a1d85c98f4456ef539774d603d4e15e0d">spec</a> = <a class="code" href="X86DisassemblerDecoder_8c.html#a553631909c27b5f8a94d65ebb13e73ae">specifierForUID</a>(instructionIDWithOpsize);</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;      insn-&gt;<a class="code" href="structInternalInstruction.html#a2c614fda371a4b9cd14cf06154458364">instructionID</a> = instructionID;</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;      insn-&gt;<a class="code" href="structInternalInstruction.html#a1d85c98f4456ef539774d603d4e15e0d">spec</a> = spec;</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;    }</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;  }</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;  <span class="keywordflow">if</span> (insn-&gt;<a class="code" href="structInternalInstruction.html#a0e7bbab87ac33b62bb1d9cad65c77a68">opcodeType</a> == <a class="code" href="X86DisassemblerDecoderCommon_8h.html#a5cc171c21d0532e0f6353e972f1ff621a703a4841d8c5722f1f7b0c887beca64e">ONEBYTE</a> &amp;&amp; insn-&gt;<a class="code" href="structInternalInstruction.html#a0106234d00ddfeb8e9e29dadfca758ee">opcode</a> == 0x90 &amp;&amp;</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;      insn-&gt;<a class="code" href="structInternalInstruction.html#a11653bcdad44439ab25047cc6dd589cf">rexPrefix</a> &amp; 0x01) {</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;    <span class="comment">/*</span></div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;<span class="comment">     * NOOP shouldn&#39;t decode as NOOP if REX.b is set. Instead</span></div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;<span class="comment">     * it should decode as XCHG %r8, %eax.</span></div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;<span class="comment">     */</span></div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;    <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structInstructionSpecifier.html">InstructionSpecifier</a> *spec;</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;    uint16_t instructionIDWithNewOpcode;</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;    <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structInstructionSpecifier.html">InstructionSpecifier</a> *specWithNewOpcode;</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;    spec = <a class="code" href="X86DisassemblerDecoder_8c.html#a553631909c27b5f8a94d65ebb13e73ae">specifierForUID</a>(instructionID);</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;    <span class="comment">/* Borrow opcode from one of the other XCHGar opcodes */</span></div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;    insn-&gt;<a class="code" href="structInternalInstruction.html#a0106234d00ddfeb8e9e29dadfca758ee">opcode</a> = 0x91;</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="X86DisassemblerDecoder_8c.html#a9bf76a53657a663a17a3df12a4293d99">getIDWithAttrMask</a>(&amp;instructionIDWithNewOpcode,</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;                          insn,</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;                          attrMask)) {</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;      insn-&gt;<a class="code" href="structInternalInstruction.html#a0106234d00ddfeb8e9e29dadfca758ee">opcode</a> = 0x90;</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;      insn-&gt;<a class="code" href="structInternalInstruction.html#a2c614fda371a4b9cd14cf06154458364">instructionID</a> = instructionID;</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;      insn-&gt;<a class="code" href="structInternalInstruction.html#a1d85c98f4456ef539774d603d4e15e0d">spec</a> = spec;</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;    }</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;    specWithNewOpcode = <a class="code" href="X86DisassemblerDecoder_8c.html#a553631909c27b5f8a94d65ebb13e73ae">specifierForUID</a>(instructionIDWithNewOpcode);</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;    <span class="comment">/* Change back */</span></div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;    insn-&gt;<a class="code" href="structInternalInstruction.html#a0106234d00ddfeb8e9e29dadfca758ee">opcode</a> = 0x90;</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;    insn-&gt;<a class="code" href="structInternalInstruction.html#a2c614fda371a4b9cd14cf06154458364">instructionID</a> = instructionIDWithNewOpcode;</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;    insn-&gt;<a class="code" href="structInternalInstruction.html#a1d85c98f4456ef539774d603d4e15e0d">spec</a> = specWithNewOpcode;</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;  }</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;  insn-&gt;<a class="code" href="structInternalInstruction.html#a2c614fda371a4b9cd14cf06154458364">instructionID</a> = instructionID;</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;  insn-&gt;<a class="code" href="structInternalInstruction.html#a1d85c98f4456ef539774d603d4e15e0d">spec</a> = <a class="code" href="X86DisassemblerDecoder_8c.html#a553631909c27b5f8a94d65ebb13e73ae">specifierForUID</a>(insn-&gt;<a class="code" href="structInternalInstruction.html#a2c614fda371a4b9cd14cf06154458364">instructionID</a>);</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;}</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;<span class="comment"> * readSIB - Consumes the SIB byte to determine addressing information for an</span></div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;<span class="comment"> *   instruction.</span></div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;<span class="comment"> * @param insn  - The instruction whose SIB byte is to be read.</span></div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;<span class="comment"> * @return      - 0 if the SIB byte was successfully read; nonzero otherwise.</span></div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l01005"></a><span class="lineno"><a class="line" href="X86DisassemblerDecoder_8c.html#a7d9a3ce3081e918d80b9770b584009a3"> 1005</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="X86DisassemblerDecoder_8c.html#a7d9a3ce3081e918d80b9770b584009a3">readSIB</a>(<span class="keyword">struct</span> <a class="code" href="structInternalInstruction.html">InternalInstruction</a>* insn) {</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;  <a class="code" href="X86DisassemblerDecoder_8h.html#a2af8cf971611d096b00b34eece806adb">SIBIndex</a> sibIndexBase = 0;</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;  <a class="code" href="X86DisassemblerDecoder_8h.html#a7cb9f08e12fcda158bbe0cee76ef61f7">SIBBase</a> sibBaseBase = 0;</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;  uint8_t <a class="code" href="README__ALTIVEC_8txt.html#a98586ea01a32ff5046b0868b036a1849">index</a>, <a class="code" href="Target_2SystemZ_2README_8txt.html#aab103049890481bd3a194048b45f5fce">base</a>;</div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;  <a class="code" href="X86DisassemblerDecoder_8c.html#ac92411447d53b3ccecf5a40f736650cc">dbgprintf</a>(insn, <span class="stringliteral">&quot;readSIB()&quot;</span>);</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;  <span class="keywordflow">if</span> (insn-&gt;<a class="code" href="structInternalInstruction.html#aa680516683d15d3cb14c7073488ddf99">consumedSIB</a>)</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;  insn-&gt;<a class="code" href="structInternalInstruction.html#aa680516683d15d3cb14c7073488ddf99">consumedSIB</a> = <a class="code" href="X86DisassemblerDecoder_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;  <span class="keywordflow">switch</span> (insn-&gt;<a class="code" href="structInternalInstruction.html#a401714e4eb9715146c94275270515ba9">addressSize</a>) {</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;  <span class="keywordflow">case</span> 2:</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;    <a class="code" href="X86DisassemblerDecoder_8c.html#ac92411447d53b3ccecf5a40f736650cc">dbgprintf</a>(insn, <span class="stringliteral">&quot;SIB-based addressing doesn&#39;t work in 16-bit mode&quot;</span>);</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;  <span class="keywordflow">case</span> 4:</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;    sibIndexBase = SIB_INDEX_EAX;</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;    sibBaseBase = SIB_BASE_EAX;</div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;  <span class="keywordflow">case</span> 8:</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;    sibIndexBase = SIB_INDEX_RAX;</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;    sibBaseBase = SIB_BASE_RAX;</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;  }</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="X86DisassemblerDecoder_8c.html#a1c693d3ea8868f36b5b192d0315cac04">consumeByte</a>(insn, &amp;insn-&gt;<a class="code" href="structInternalInstruction.html#adea08d2cf5dc0695277abe942a9d4367">sib</a>))</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;  index = <a class="code" href="X86DisassemblerDecoder_8h.html#adc11bcb515676078c7c25441c03bddbc">indexFromSIB</a>(insn-&gt;<a class="code" href="structInternalInstruction.html#adea08d2cf5dc0695277abe942a9d4367">sib</a>) | (<a class="code" href="X86DisassemblerDecoder_8h.html#af00d764f04a2d7143d9de59ea213f148">xFromREX</a>(insn-&gt;<a class="code" href="structInternalInstruction.html#a11653bcdad44439ab25047cc6dd589cf">rexPrefix</a>) &lt;&lt; 3);</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;  <span class="keywordflow">switch</span> (index) {</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;  <span class="keywordflow">case</span> 0x4:</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;    insn-&gt;<a class="code" href="structInternalInstruction.html#a0688805de40e76e7694ce3b026f9f41f">sibIndex</a> = <a class="code" href="X86DisassemblerDecoder_8h.html#a2af8cf971611d096b00b34eece806adba3d035927a65ed81a8869a3f64f669bd0">SIB_INDEX_NONE</a>;</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;  <span class="keywordflow">default</span>:</div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;    insn-&gt;<a class="code" href="structInternalInstruction.html#a0688805de40e76e7694ce3b026f9f41f">sibIndex</a> = (<a class="code" href="X86DisassemblerDecoder_8h.html#a2af8cf971611d096b00b34eece806adb">SIBIndex</a>)(sibIndexBase + index);</div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;    <span class="keywordflow">if</span> (insn-&gt;<a class="code" href="structInternalInstruction.html#a0688805de40e76e7694ce3b026f9f41f">sibIndex</a> == SIB_INDEX_sib ||</div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;        insn-&gt;<a class="code" href="structInternalInstruction.html#a0688805de40e76e7694ce3b026f9f41f">sibIndex</a> == SIB_INDEX_sib64)</div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;      insn-&gt;<a class="code" href="structInternalInstruction.html#a0688805de40e76e7694ce3b026f9f41f">sibIndex</a> = <a class="code" href="X86DisassemblerDecoder_8h.html#a2af8cf971611d096b00b34eece806adba3d035927a65ed81a8869a3f64f669bd0">SIB_INDEX_NONE</a>;</div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;  }</div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;</div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;  <span class="keywordflow">switch</span> (<a class="code" href="X86DisassemblerDecoder_8h.html#a7b5f49eafdca9d6be0464fccb94a4f33">scaleFromSIB</a>(insn-&gt;<a class="code" href="structInternalInstruction.html#adea08d2cf5dc0695277abe942a9d4367">sib</a>)) {</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;  <span class="keywordflow">case</span> 0:</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;    insn-&gt;<a class="code" href="structInternalInstruction.html#aa88adec45f0f554d53e34401e24cde8d">sibScale</a> = 1;</div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;  <span class="keywordflow">case</span> 1:</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;    insn-&gt;<a class="code" href="structInternalInstruction.html#aa88adec45f0f554d53e34401e24cde8d">sibScale</a> = 2;</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;  <span class="keywordflow">case</span> 2:</div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;    insn-&gt;<a class="code" href="structInternalInstruction.html#aa88adec45f0f554d53e34401e24cde8d">sibScale</a> = 4;</div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;  <span class="keywordflow">case</span> 3:</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;    insn-&gt;<a class="code" href="structInternalInstruction.html#aa88adec45f0f554d53e34401e24cde8d">sibScale</a> = 8;</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;  }</div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;</div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;  base = <a class="code" href="X86DisassemblerDecoder_8h.html#a439f21b8d5ea58ea5fe17d11d1547986">baseFromSIB</a>(insn-&gt;<a class="code" href="structInternalInstruction.html#adea08d2cf5dc0695277abe942a9d4367">sib</a>) | (<a class="code" href="X86DisassemblerDecoder_8h.html#af112ae874f4cca98ba15a30f5743e5e1">bFromREX</a>(insn-&gt;<a class="code" href="structInternalInstruction.html#a11653bcdad44439ab25047cc6dd589cf">rexPrefix</a>) &lt;&lt; 3);</div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;</div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;  <span class="keywordflow">switch</span> (base) {</div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;  <span class="keywordflow">case</span> 0x5:</div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;    <span class="keywordflow">switch</span> (<a class="code" href="X86DisassemblerDecoder_8h.html#a4bce531c2ed18d569a316029616e82f0">modFromModRM</a>(insn-&gt;<a class="code" href="structInternalInstruction.html#a4e8995824272b3ea6083c73aaf39e00d">modRM</a>)) {</div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;    <span class="keywordflow">case</span> 0x0:</div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;      insn-&gt;<a class="code" href="structInternalInstruction.html#a15f66c4fc5e09ff60f592a643f68eab3">eaDisplacement</a> = <a class="code" href="X86DisassemblerDecoder_8h.html#a86b3ea534df3a598db89d7d5ff581112a40fd53a41ecdbdf2d79b963fc45aacf8">EA_DISP_32</a>;</div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;      insn-&gt;<a class="code" href="structInternalInstruction.html#aecf82cd305a89d85270619af42a0b81e">sibBase</a> = <a class="code" href="X86DisassemblerDecoder_8h.html#a7cb9f08e12fcda158bbe0cee76ef61f7a28642d84aadee3992f08c36ca08b16a5">SIB_BASE_NONE</a>;</div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;    <span class="keywordflow">case</span> 0x1:</div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;      insn-&gt;<a class="code" href="structInternalInstruction.html#a15f66c4fc5e09ff60f592a643f68eab3">eaDisplacement</a> = <a class="code" href="X86DisassemblerDecoder_8h.html#a86b3ea534df3a598db89d7d5ff581112a8c6d89c83a80d627b41123cb4efd3959">EA_DISP_8</a>;</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;      insn-&gt;<a class="code" href="structInternalInstruction.html#aecf82cd305a89d85270619af42a0b81e">sibBase</a> = (insn-&gt;<a class="code" href="structInternalInstruction.html#a401714e4eb9715146c94275270515ba9">addressSize</a> == 4 ?</div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;                       SIB_BASE_EBP : SIB_BASE_RBP);</div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;    <span class="keywordflow">case</span> 0x2:</div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;      insn-&gt;<a class="code" href="structInternalInstruction.html#a15f66c4fc5e09ff60f592a643f68eab3">eaDisplacement</a> = <a class="code" href="X86DisassemblerDecoder_8h.html#a86b3ea534df3a598db89d7d5ff581112a40fd53a41ecdbdf2d79b963fc45aacf8">EA_DISP_32</a>;</div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;      insn-&gt;<a class="code" href="structInternalInstruction.html#aecf82cd305a89d85270619af42a0b81e">sibBase</a> = (insn-&gt;<a class="code" href="structInternalInstruction.html#a401714e4eb9715146c94275270515ba9">addressSize</a> == 4 ?</div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;                       SIB_BASE_EBP : SIB_BASE_RBP);</div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;    <span class="keywordflow">case</span> 0x3:</div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;      <a class="code" href="X86DisassemblerDecoder_8c.html#ae0228f36529f75f692753ef96d725012">debug</a>(<span class="stringliteral">&quot;Cannot have Mod = 0b11 and a SIB byte&quot;</span>);</div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;    }</div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;  <span class="keywordflow">default</span>:</div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;    insn-&gt;<a class="code" href="structInternalInstruction.html#aecf82cd305a89d85270619af42a0b81e">sibBase</a> = (<a class="code" href="X86DisassemblerDecoder_8h.html#a7cb9f08e12fcda158bbe0cee76ef61f7">SIBBase</a>)(sibBaseBase + base);</div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;  }</div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;</div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;}</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;<span class="comment"> * readDisplacement - Consumes the displacement of an instruction.</span></div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;<span class="comment"> * @param insn  - The instruction whose displacement is to be read.</span></div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;<span class="comment"> * @return      - 0 if the displacement byte was successfully read; nonzero</span></div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;<span class="comment"> *                otherwise.</span></div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l01103"></a><span class="lineno"><a class="line" href="X86DisassemblerDecoder_8c.html#abe4017d5eac03b4caf08ca7a36ba2723"> 1103</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="X86DisassemblerDecoder_8c.html#abe4017d5eac03b4caf08ca7a36ba2723">readDisplacement</a>(<span class="keyword">struct</span> <a class="code" href="structInternalInstruction.html">InternalInstruction</a>* insn) {</div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;  int8_t d8;</div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;  int16_t d16;</div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;  int32_t d32;</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;</div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;  <a class="code" href="X86DisassemblerDecoder_8c.html#ac92411447d53b3ccecf5a40f736650cc">dbgprintf</a>(insn, <span class="stringliteral">&quot;readDisplacement()&quot;</span>);</div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;</div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;  <span class="keywordflow">if</span> (insn-&gt;<a class="code" href="structInternalInstruction.html#a6eae0ad2e530d2c0d65b4d50c951ba63">consumedDisplacement</a>)</div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;</div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;  insn-&gt;<a class="code" href="structInternalInstruction.html#a6eae0ad2e530d2c0d65b4d50c951ba63">consumedDisplacement</a> = <a class="code" href="X86DisassemblerDecoder_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;  insn-&gt;<a class="code" href="structInternalInstruction.html#ac235f78a50feb97426e7f8149591a08c">displacementOffset</a> = insn-&gt;<a class="code" href="structInternalInstruction.html#ab255c3e1663cdfbdebbe1b199140a950">readerCursor</a> - insn-&gt;<a class="code" href="structInternalInstruction.html#a3a55e24e218c4bff1f03ef64da4c3725">startLocation</a>;</div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;</div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;  <span class="keywordflow">switch</span> (insn-&gt;<a class="code" href="structInternalInstruction.html#a15f66c4fc5e09ff60f592a643f68eab3">eaDisplacement</a>) {</div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="X86DisassemblerDecoder_8h.html#a86b3ea534df3a598db89d7d5ff581112a377f7990be2aed8d7547befd58ba4bfc">EA_DISP_NONE</a>:</div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;    insn-&gt;<a class="code" href="structInternalInstruction.html#a6eae0ad2e530d2c0d65b4d50c951ba63">consumedDisplacement</a> = <a class="code" href="X86DisassemblerDecoder_8c.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="X86DisassemblerDecoder_8h.html#a86b3ea534df3a598db89d7d5ff581112a8c6d89c83a80d627b41123cb4efd3959">EA_DISP_8</a>:</div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;    <span class="keywordflow">if</span> (consumeInt8(insn, &amp;d8))</div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;    insn-&gt;<a class="code" href="structInternalInstruction.html#a309eb7e0aad285e543bf18e55948bb5e">displacement</a> = d8;</div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="X86DisassemblerDecoder_8h.html#a86b3ea534df3a598db89d7d5ff581112a35eccd80af0540628e1fc528312392ac">EA_DISP_16</a>:</div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;    <span class="keywordflow">if</span> (consumeInt16(insn, &amp;d16))</div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;    insn-&gt;<a class="code" href="structInternalInstruction.html#a309eb7e0aad285e543bf18e55948bb5e">displacement</a> = d16;</div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="X86DisassemblerDecoder_8h.html#a86b3ea534df3a598db89d7d5ff581112a40fd53a41ecdbdf2d79b963fc45aacf8">EA_DISP_32</a>:</div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;    <span class="keywordflow">if</span> (consumeInt32(insn, &amp;d32))</div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;    insn-&gt;<a class="code" href="structInternalInstruction.html#a309eb7e0aad285e543bf18e55948bb5e">displacement</a> = d32;</div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;  }</div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;</div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;  insn-&gt;<a class="code" href="structInternalInstruction.html#a6eae0ad2e530d2c0d65b4d50c951ba63">consumedDisplacement</a> = <a class="code" href="X86DisassemblerDecoder_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;}</div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;</div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;<span class="comment"> * readModRM - Consumes all addressing information (ModR/M byte, SIB byte, and</span></div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;<span class="comment"> *   displacement) for an instruction and interprets it.</span></div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;<span class="comment"> * @param insn  - The instruction whose addressing information is to be read.</span></div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;<span class="comment"> * @return      - 0 if the information was successfully read; nonzero otherwise.</span></div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l01148"></a><span class="lineno"><a class="line" href="X86DisassemblerDecoder_8c.html#ae354b93b59d4f78cddbb50869bd5ef6b"> 1148</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="X86DisassemblerDecoder_8c.html#ae354b93b59d4f78cddbb50869bd5ef6b">readModRM</a>(<span class="keyword">struct</span> <a class="code" href="structInternalInstruction.html">InternalInstruction</a>* insn) {</div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;  uint8_t mod, rm, reg;</div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;</div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;  <a class="code" href="X86DisassemblerDecoder_8c.html#ac92411447d53b3ccecf5a40f736650cc">dbgprintf</a>(insn, <span class="stringliteral">&quot;readModRM()&quot;</span>);</div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;</div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;  <span class="keywordflow">if</span> (insn-&gt;<a class="code" href="structInternalInstruction.html#afdde304bf92d215347b53a72665a25de">consumedModRM</a>)</div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;</div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="X86DisassemblerDecoder_8c.html#a1c693d3ea8868f36b5b192d0315cac04">consumeByte</a>(insn, &amp;insn-&gt;<a class="code" href="structInternalInstruction.html#a4e8995824272b3ea6083c73aaf39e00d">modRM</a>))</div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;  insn-&gt;<a class="code" href="structInternalInstruction.html#afdde304bf92d215347b53a72665a25de">consumedModRM</a> = <a class="code" href="X86DisassemblerDecoder_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;</div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;  mod     = <a class="code" href="X86DisassemblerDecoder_8h.html#a4bce531c2ed18d569a316029616e82f0">modFromModRM</a>(insn-&gt;<a class="code" href="structInternalInstruction.html#a4e8995824272b3ea6083c73aaf39e00d">modRM</a>);</div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;  rm      = <a class="code" href="X86DisassemblerDecoder_8h.html#a384089e78b51b1b5773e879ed1d4e672">rmFromModRM</a>(insn-&gt;<a class="code" href="structInternalInstruction.html#a4e8995824272b3ea6083c73aaf39e00d">modRM</a>);</div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;  reg     = <a class="code" href="X86DisassemblerDecoder_8h.html#a8386ddf05ce05f470ca10679a78973bd">regFromModRM</a>(insn-&gt;<a class="code" href="structInternalInstruction.html#a4e8995824272b3ea6083c73aaf39e00d">modRM</a>);</div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;</div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;  <span class="comment">/*</span></div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;<span class="comment">   * This goes by insn-&gt;registerSize to pick the correct register, which messes</span></div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;<span class="comment">   * up if we&#39;re using (say) XMM or 8-bit register operands.  That gets fixed in</span></div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;<span class="comment">   * fixupReg().</span></div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;<span class="comment">   */</span></div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;  <span class="keywordflow">switch</span> (insn-&gt;<a class="code" href="structInternalInstruction.html#a8dd784f4a8eed89e5918a0abf254ed68">registerSize</a>) {</div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;  <span class="keywordflow">case</span> 2:</div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;    insn-&gt;<a class="code" href="structInternalInstruction.html#a11c5dae84e030fe6bbc3586122af7d44">regBase</a> = MODRM_REG_AX;</div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;    insn-&gt;<a class="code" href="structInternalInstruction.html#a5d37fbfabfbb9dcb1cb7e72adc593478">eaRegBase</a> = EA_REG_AX;</div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;  <span class="keywordflow">case</span> 4:</div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;    insn-&gt;<a class="code" href="structInternalInstruction.html#a11c5dae84e030fe6bbc3586122af7d44">regBase</a> = MODRM_REG_EAX;</div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;    insn-&gt;<a class="code" href="structInternalInstruction.html#a5d37fbfabfbb9dcb1cb7e72adc593478">eaRegBase</a> = EA_REG_EAX;</div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;  <span class="keywordflow">case</span> 8:</div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;    insn-&gt;<a class="code" href="structInternalInstruction.html#a11c5dae84e030fe6bbc3586122af7d44">regBase</a> = MODRM_REG_RAX;</div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;    insn-&gt;<a class="code" href="structInternalInstruction.html#a5d37fbfabfbb9dcb1cb7e72adc593478">eaRegBase</a> = EA_REG_RAX;</div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;  }</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;</div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;  reg |= <a class="code" href="X86DisassemblerDecoder_8h.html#a1c2e931225f964b581ab025f86a39872">rFromREX</a>(insn-&gt;<a class="code" href="structInternalInstruction.html#a11653bcdad44439ab25047cc6dd589cf">rexPrefix</a>) &lt;&lt; 3;</div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;  rm  |= <a class="code" href="X86DisassemblerDecoder_8h.html#af112ae874f4cca98ba15a30f5743e5e1">bFromREX</a>(insn-&gt;<a class="code" href="structInternalInstruction.html#a11653bcdad44439ab25047cc6dd589cf">rexPrefix</a>) &lt;&lt; 3;</div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;  insn-&gt;<a class="code" href="structInternalInstruction.html#a04cb5db41677eb5617f830ad43744861">reg</a> = (<a class="code" href="X86DisassemblerDecoder_8h.html#a546839a5c4bcf9f9450967155f48de41">Reg</a>)(insn-&gt;<a class="code" href="structInternalInstruction.html#a11c5dae84e030fe6bbc3586122af7d44">regBase</a> + reg);</div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;</div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;  <span class="keywordflow">switch</span> (insn-&gt;<a class="code" href="structInternalInstruction.html#a401714e4eb9715146c94275270515ba9">addressSize</a>) {</div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;  <span class="keywordflow">case</span> 2:</div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;    insn-&gt;<a class="code" href="structInternalInstruction.html#ad30e8e15786fa9fc4fe7d50c950a3e17">eaBaseBase</a> = EA_BASE_BX_SI;</div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;</div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;    <span class="keywordflow">switch</span> (mod) {</div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;    <span class="keywordflow">case</span> 0x0:</div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;      <span class="keywordflow">if</span> (rm == 0x6) {</div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;        insn-&gt;<a class="code" href="structInternalInstruction.html#abe6c3d2f697137970d48ad392ec9d26d">eaBase</a> = <a class="code" href="X86DisassemblerDecoder_8h.html#afc689603f1848ec33ddbac69b8aa1e95a546e3bf7a78bafabd50fbf842b0e87c5">EA_BASE_NONE</a>;</div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;        insn-&gt;<a class="code" href="structInternalInstruction.html#a15f66c4fc5e09ff60f592a643f68eab3">eaDisplacement</a> = <a class="code" href="X86DisassemblerDecoder_8h.html#a86b3ea534df3a598db89d7d5ff581112a35eccd80af0540628e1fc528312392ac">EA_DISP_16</a>;</div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="X86DisassemblerDecoder_8c.html#abe4017d5eac03b4caf08ca7a36ba2723">readDisplacement</a>(insn))</div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;          <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;        insn-&gt;<a class="code" href="structInternalInstruction.html#abe6c3d2f697137970d48ad392ec9d26d">eaBase</a> = (<a class="code" href="X86DisassemblerDecoder_8h.html#afc689603f1848ec33ddbac69b8aa1e95">EABase</a>)(insn-&gt;<a class="code" href="structInternalInstruction.html#ad30e8e15786fa9fc4fe7d50c950a3e17">eaBaseBase</a> + rm);</div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;        insn-&gt;<a class="code" href="structInternalInstruction.html#a15f66c4fc5e09ff60f592a643f68eab3">eaDisplacement</a> = <a class="code" href="X86DisassemblerDecoder_8h.html#a86b3ea534df3a598db89d7d5ff581112a377f7990be2aed8d7547befd58ba4bfc">EA_DISP_NONE</a>;</div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;      }</div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;    <span class="keywordflow">case</span> 0x1:</div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;      insn-&gt;<a class="code" href="structInternalInstruction.html#abe6c3d2f697137970d48ad392ec9d26d">eaBase</a> = (<a class="code" href="X86DisassemblerDecoder_8h.html#afc689603f1848ec33ddbac69b8aa1e95">EABase</a>)(insn-&gt;<a class="code" href="structInternalInstruction.html#ad30e8e15786fa9fc4fe7d50c950a3e17">eaBaseBase</a> + rm);</div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;      insn-&gt;<a class="code" href="structInternalInstruction.html#a15f66c4fc5e09ff60f592a643f68eab3">eaDisplacement</a> = <a class="code" href="X86DisassemblerDecoder_8h.html#a86b3ea534df3a598db89d7d5ff581112a8c6d89c83a80d627b41123cb4efd3959">EA_DISP_8</a>;</div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="X86DisassemblerDecoder_8c.html#abe4017d5eac03b4caf08ca7a36ba2723">readDisplacement</a>(insn))</div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;        <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;    <span class="keywordflow">case</span> 0x2:</div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;      insn-&gt;<a class="code" href="structInternalInstruction.html#abe6c3d2f697137970d48ad392ec9d26d">eaBase</a> = (<a class="code" href="X86DisassemblerDecoder_8h.html#afc689603f1848ec33ddbac69b8aa1e95">EABase</a>)(insn-&gt;<a class="code" href="structInternalInstruction.html#ad30e8e15786fa9fc4fe7d50c950a3e17">eaBaseBase</a> + rm);</div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;      insn-&gt;<a class="code" href="structInternalInstruction.html#a15f66c4fc5e09ff60f592a643f68eab3">eaDisplacement</a> = <a class="code" href="X86DisassemblerDecoder_8h.html#a86b3ea534df3a598db89d7d5ff581112a35eccd80af0540628e1fc528312392ac">EA_DISP_16</a>;</div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="X86DisassemblerDecoder_8c.html#abe4017d5eac03b4caf08ca7a36ba2723">readDisplacement</a>(insn))</div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;        <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;    <span class="keywordflow">case</span> 0x3:</div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;      insn-&gt;<a class="code" href="structInternalInstruction.html#abe6c3d2f697137970d48ad392ec9d26d">eaBase</a> = (<a class="code" href="X86DisassemblerDecoder_8h.html#afc689603f1848ec33ddbac69b8aa1e95">EABase</a>)(insn-&gt;<a class="code" href="structInternalInstruction.html#a5d37fbfabfbb9dcb1cb7e72adc593478">eaRegBase</a> + rm);</div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="X86DisassemblerDecoder_8c.html#abe4017d5eac03b4caf08ca7a36ba2723">readDisplacement</a>(insn))</div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;        <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;    }</div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;  <span class="keywordflow">case</span> 4:</div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;  <span class="keywordflow">case</span> 8:</div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;    insn-&gt;<a class="code" href="structInternalInstruction.html#ad30e8e15786fa9fc4fe7d50c950a3e17">eaBaseBase</a> = (insn-&gt;<a class="code" href="structInternalInstruction.html#a401714e4eb9715146c94275270515ba9">addressSize</a> == 4 ? EA_BASE_EAX : EA_BASE_RAX);</div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;</div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;    <span class="keywordflow">switch</span> (mod) {</div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;    <span class="keywordflow">case</span> 0x0:</div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;      insn-&gt;<a class="code" href="structInternalInstruction.html#a15f66c4fc5e09ff60f592a643f68eab3">eaDisplacement</a> = <a class="code" href="X86DisassemblerDecoder_8h.html#a86b3ea534df3a598db89d7d5ff581112a377f7990be2aed8d7547befd58ba4bfc">EA_DISP_NONE</a>; <span class="comment">/* readSIB may override this */</span></div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;      <span class="keywordflow">switch</span> (rm) {</div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;      <span class="keywordflow">case</span> 0x4:</div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;      <span class="keywordflow">case</span> 0xc:   <span class="comment">/* in case REXW.b is set */</span></div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;        insn-&gt;<a class="code" href="structInternalInstruction.html#abe6c3d2f697137970d48ad392ec9d26d">eaBase</a> = (insn-&gt;<a class="code" href="structInternalInstruction.html#a401714e4eb9715146c94275270515ba9">addressSize</a> == 4 ?</div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;                        EA_BASE_sib : EA_BASE_sib64);</div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;        <a class="code" href="X86DisassemblerDecoder_8c.html#a7d9a3ce3081e918d80b9770b584009a3">readSIB</a>(insn);</div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="X86DisassemblerDecoder_8c.html#abe4017d5eac03b4caf08ca7a36ba2723">readDisplacement</a>(insn))</div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;          <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;      <span class="keywordflow">case</span> 0x5:</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;        insn-&gt;<a class="code" href="structInternalInstruction.html#abe6c3d2f697137970d48ad392ec9d26d">eaBase</a> = <a class="code" href="X86DisassemblerDecoder_8h.html#afc689603f1848ec33ddbac69b8aa1e95a546e3bf7a78bafabd50fbf842b0e87c5">EA_BASE_NONE</a>;</div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;        insn-&gt;<a class="code" href="structInternalInstruction.html#a15f66c4fc5e09ff60f592a643f68eab3">eaDisplacement</a> = <a class="code" href="X86DisassemblerDecoder_8h.html#a86b3ea534df3a598db89d7d5ff581112a40fd53a41ecdbdf2d79b963fc45aacf8">EA_DISP_32</a>;</div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="X86DisassemblerDecoder_8c.html#abe4017d5eac03b4caf08ca7a36ba2723">readDisplacement</a>(insn))</div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;          <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;      <span class="keywordflow">default</span>:</div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;        insn-&gt;<a class="code" href="structInternalInstruction.html#abe6c3d2f697137970d48ad392ec9d26d">eaBase</a> = (<a class="code" href="X86DisassemblerDecoder_8h.html#afc689603f1848ec33ddbac69b8aa1e95">EABase</a>)(insn-&gt;<a class="code" href="structInternalInstruction.html#ad30e8e15786fa9fc4fe7d50c950a3e17">eaBaseBase</a> + rm);</div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;      }</div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;    <span class="keywordflow">case</span> 0x1:</div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;    <span class="keywordflow">case</span> 0x2:</div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;      insn-&gt;<a class="code" href="structInternalInstruction.html#a15f66c4fc5e09ff60f592a643f68eab3">eaDisplacement</a> = (mod == 0x1 ? <a class="code" href="X86DisassemblerDecoder_8h.html#a86b3ea534df3a598db89d7d5ff581112a8c6d89c83a80d627b41123cb4efd3959">EA_DISP_8</a> : <a class="code" href="X86DisassemblerDecoder_8h.html#a86b3ea534df3a598db89d7d5ff581112a40fd53a41ecdbdf2d79b963fc45aacf8">EA_DISP_32</a>);</div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;      <span class="keywordflow">switch</span> (rm) {</div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;      <span class="keywordflow">case</span> 0x4:</div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;      <span class="keywordflow">case</span> 0xc:   <span class="comment">/* in case REXW.b is set */</span></div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;        insn-&gt;<a class="code" href="structInternalInstruction.html#abe6c3d2f697137970d48ad392ec9d26d">eaBase</a> = EA_BASE_sib;</div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;        <a class="code" href="X86DisassemblerDecoder_8c.html#a7d9a3ce3081e918d80b9770b584009a3">readSIB</a>(insn);</div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="X86DisassemblerDecoder_8c.html#abe4017d5eac03b4caf08ca7a36ba2723">readDisplacement</a>(insn))</div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;          <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;      <span class="keywordflow">default</span>:</div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;        insn-&gt;<a class="code" href="structInternalInstruction.html#abe6c3d2f697137970d48ad392ec9d26d">eaBase</a> = (<a class="code" href="X86DisassemblerDecoder_8h.html#afc689603f1848ec33ddbac69b8aa1e95">EABase</a>)(insn-&gt;<a class="code" href="structInternalInstruction.html#ad30e8e15786fa9fc4fe7d50c950a3e17">eaBaseBase</a> + rm);</div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="X86DisassemblerDecoder_8c.html#abe4017d5eac03b4caf08ca7a36ba2723">readDisplacement</a>(insn))</div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;          <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;      }</div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;    <span class="keywordflow">case</span> 0x3:</div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;      insn-&gt;<a class="code" href="structInternalInstruction.html#a15f66c4fc5e09ff60f592a643f68eab3">eaDisplacement</a> = <a class="code" href="X86DisassemblerDecoder_8h.html#a86b3ea534df3a598db89d7d5ff581112a377f7990be2aed8d7547befd58ba4bfc">EA_DISP_NONE</a>;</div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;      insn-&gt;<a class="code" href="structInternalInstruction.html#abe6c3d2f697137970d48ad392ec9d26d">eaBase</a> = (<a class="code" href="X86DisassemblerDecoder_8h.html#afc689603f1848ec33ddbac69b8aa1e95">EABase</a>)(insn-&gt;<a class="code" href="structInternalInstruction.html#a5d37fbfabfbb9dcb1cb7e72adc593478">eaRegBase</a> + rm);</div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;    }</div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;  } <span class="comment">/* switch (insn-&gt;addressSize) */</span></div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;</div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;}</div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;</div><div class="line"><a name="l01280"></a><span class="lineno"><a class="line" href="X86DisassemblerDecoder_8c.html#a9a556ad6d7ad3eb7fe546bb644b2ba41"> 1280</a></span>&#160;<span class="preprocessor">#define GENERIC_FIXUP_FUNC(name, base, prefix)            \</span></div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;<span class="preprocessor">  static uint8_t name(struct InternalInstruction *insn,   \</span></div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;<span class="preprocessor">                      OperandType type,                   \</span></div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;<span class="preprocessor">                      uint8_t index,                      \</span></div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;<span class="preprocessor">                      uint8_t *valid) {                   \</span></div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;<span class="preprocessor">    *valid = 1;                                           \</span></div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;<span class="preprocessor">    switch (type) {                                       \</span></div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;<span class="preprocessor">    default:                                              \</span></div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;<span class="preprocessor">      debug(&quot;Unhandled register type&quot;);                   \</span></div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;<span class="preprocessor">      *valid = 0;                                         \</span></div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;<span class="preprocessor">      return 0;                                           \</span></div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;<span class="preprocessor">    case TYPE_Rv:                                         \</span></div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;<span class="preprocessor">      return base + index;                                \</span></div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;<span class="preprocessor">    case TYPE_R8:                                         \</span></div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;<span class="preprocessor">      if (insn-&gt;rexPrefix &amp;&amp;                              \</span></div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;<span class="preprocessor">         index &gt;= 4 &amp;&amp; index &lt;= 7) {                      \</span></div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;<span class="preprocessor">        return prefix##_SPL + (index - 4);                \</span></div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;<span class="preprocessor">      } else {                                            \</span></div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;<span class="preprocessor">        return prefix##_AL + index;                       \</span></div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;<span class="preprocessor">      }                                                   \</span></div><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;<span class="preprocessor">    case TYPE_R16:                                        \</span></div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;<span class="preprocessor">      return prefix##_AX + index;                         \</span></div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;<span class="preprocessor">    case TYPE_R32:                                        \</span></div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;<span class="preprocessor">      return prefix##_EAX + index;                        \</span></div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;<span class="preprocessor">    case TYPE_R64:                                        \</span></div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;<span class="preprocessor">      return prefix##_RAX + index;                        \</span></div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;<span class="preprocessor">    case TYPE_XMM512:                                     \</span></div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;<span class="preprocessor">      return prefix##_ZMM0 + index;                       \</span></div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;<span class="preprocessor">    case TYPE_XMM256:                                     \</span></div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;<span class="preprocessor">      return prefix##_YMM0 + index;                       \</span></div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;<span class="preprocessor">    case TYPE_XMM128:                                     \</span></div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;<span class="preprocessor">    case TYPE_XMM64:                                      \</span></div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;<span class="preprocessor">    case TYPE_XMM32:                                      \</span></div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;<span class="preprocessor">    case TYPE_XMM:                                        \</span></div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;<span class="preprocessor">      return prefix##_XMM0 + index;                       \</span></div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;<span class="preprocessor">    case TYPE_MM64:                                       \</span></div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;<span class="preprocessor">    case TYPE_MM32:                                       \</span></div><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;<span class="preprocessor">    case TYPE_MM:                                         \</span></div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;<span class="preprocessor">      if (index &gt; 7)                                      \</span></div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;<span class="preprocessor">        *valid = 0;                                       \</span></div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;<span class="preprocessor">      return prefix##_MM0 + index;                        \</span></div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;<span class="preprocessor">    case TYPE_SEGMENTREG:                                 \</span></div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;<span class="preprocessor">      if (index &gt; 5)                                      \</span></div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;<span class="preprocessor">        *valid = 0;                                       \</span></div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;<span class="preprocessor">      return prefix##_ES + index;                         \</span></div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;<span class="preprocessor">    case TYPE_DEBUGREG:                                   \</span></div><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;<span class="preprocessor">      if (index &gt; 7)                                      \</span></div><div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;<span class="preprocessor">        *valid = 0;                                       \</span></div><div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;<span class="preprocessor">      return prefix##_DR0 + index;                        \</span></div><div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;<span class="preprocessor">    case TYPE_CONTROLREG:                                 \</span></div><div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;<span class="preprocessor">      if (index &gt; 8)                                      \</span></div><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;<span class="preprocessor">        *valid = 0;                                       \</span></div><div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;<span class="preprocessor">      return prefix##_CR0 + index;                        \</span></div><div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;<span class="preprocessor">    }                                                     \</span></div><div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;<span class="preprocessor">  }</span></div><div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;</div><div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;<span class="comment"> * fixup*Value - Consults an operand type to determine the meaning of the</span></div><div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;<span class="comment"> *   reg or R/M field.  If the operand is an XMM operand, for example, an</span></div><div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;<span class="comment"> *   operand would be XMM0 instead of AX, which readModRM() would otherwise</span></div><div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;<span class="comment"> *   misinterpret it as.</span></div><div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;<span class="comment"> * @param insn  - The instruction containing the operand.</span></div><div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;<span class="comment"> * @param type  - The operand type.</span></div><div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;<span class="comment"> * @param index - The existing value of the field as reported by readModRM().</span></div><div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;<span class="comment"> * @param valid - The address of a uint8_t.  The target is set to 1 if the</span></div><div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;<span class="comment"> *                field is valid for the register class; 0 if not.</span></div><div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;<span class="comment"> * @return      - The proper value.</span></div><div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;<a class="code" href="X86DisassemblerDecoder_8c.html#a9a556ad6d7ad3eb7fe546bb644b2ba41">GENERIC_FIXUP_FUNC</a>(fixupRegValue, insn-&gt;<a class="code" href="structInternalInstruction.html#a11c5dae84e030fe6bbc3586122af7d44">regBase</a>,    MODRM_REG)</div><div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;<a class="code" href="X86DisassemblerDecoder_8c.html#a9a556ad6d7ad3eb7fe546bb644b2ba41">GENERIC_FIXUP_FUNC</a>(fixupRMValue,  insn-&gt;eaRegBase,  EA_REG)</div><div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;</div><div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;<span class="comment"> * fixupReg - Consults an operand specifier to determine which of the</span></div><div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;<span class="comment"> *   fixup*Value functions to use in correcting readModRM()&#39;ss interpretation.</span></div><div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;<span class="comment"> * @param insn  - See fixup*Value().</span></div><div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;<span class="comment"> * @param op    - The operand specifier.</span></div><div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;<span class="comment"> * @return      - 0 if fixup was successful; -1 if the register returned was</span></div><div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;<span class="comment"> *                invalid for its class.</span></div><div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l01361"></a><span class="lineno"><a class="line" href="X86DisassemblerDecoder_8c.html#adb1fcba65d61d145b053ee0217b3dee7"> 1361</a></span>&#160;static <span class="keywordtype">int</span> <a class="code" href="X86DisassemblerDecoder_8c.html#adb1fcba65d61d145b053ee0217b3dee7">fixupReg</a>(struct <a class="code" href="structInternalInstruction.html">InternalInstruction</a> *insn,</div><div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;                    const struct <a class="code" href="structOperandSpecifier.html">OperandSpecifier</a> *op) {</div><div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;  uint8_t valid;</div><div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;</div><div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;  <a class="code" href="X86DisassemblerDecoder_8c.html#ac92411447d53b3ccecf5a40f736650cc">dbgprintf</a>(insn, <span class="stringliteral">&quot;fixupReg()&quot;</span>);</div><div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;</div><div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;  <span class="keywordflow">switch</span> ((<a class="code" href="X86DisassemblerDecoderCommon_8h.html#a7c612b4ed63c0ad7096e01f593879d58">OperandEncoding</a>)op-&gt;encoding) {</div><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;  <span class="keywordflow">default</span>:</div><div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;    <a class="code" href="X86DisassemblerDecoder_8c.html#ae0228f36529f75f692753ef96d725012">debug</a>(<span class="stringliteral">&quot;Expected a REG or R/M encoding in fixupReg&quot;</span>);</div><div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;  <span class="keywordflow">case</span> ENCODING_VVVV:</div><div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;    insn-&gt;vvvv = (<a class="code" href="X86DisassemblerDecoder_8h.html#a546839a5c4bcf9f9450967155f48de41">Reg</a>)fixupRegValue(insn,</div><div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;                                    (<a class="code" href="X86DisassemblerDecoderCommon_8h.html#aa4b9b8291a90b1a586c468110fb346a4">OperandType</a>)op-&gt;type,</div><div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;                                    insn-&gt;vvvv,</div><div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;                                    &amp;valid);</div><div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;    <span class="keywordflow">if</span> (!valid)</div><div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;  <span class="keywordflow">case</span> ENCODING_REG:</div><div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;    insn-&gt;reg = (<a class="code" href="X86DisassemblerDecoder_8h.html#a546839a5c4bcf9f9450967155f48de41">Reg</a>)fixupRegValue(insn,</div><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;                                   (<a class="code" href="X86DisassemblerDecoderCommon_8h.html#aa4b9b8291a90b1a586c468110fb346a4">OperandType</a>)op-&gt;type,</div><div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;                                   insn-&gt;reg - insn-&gt;regBase,</div><div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;                                   &amp;valid);</div><div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;    <span class="keywordflow">if</span> (!valid)</div><div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;  <span class="keywordflow">case</span> ENCODING_RM:</div><div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;    <span class="keywordflow">if</span> (insn-&gt;eaBase &gt;= insn-&gt;eaRegBase) {</div><div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;      insn-&gt;eaBase = (<a class="code" href="X86DisassemblerDecoder_8h.html#afc689603f1848ec33ddbac69b8aa1e95">EABase</a>)fixupRMValue(insn,</div><div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;                                          (<a class="code" href="X86DisassemblerDecoderCommon_8h.html#aa4b9b8291a90b1a586c468110fb346a4">OperandType</a>)op-&gt;type,</div><div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;                                          insn-&gt;eaBase - insn-&gt;eaRegBase,</div><div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;                                          &amp;valid);</div><div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;      <span class="keywordflow">if</span> (!valid)</div><div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;        <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;    }</div><div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;  }</div><div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;</div><div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;}</div><div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;</div><div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;<span class="comment"> * readOpcodeModifier - Reads an operand from the opcode field of an</span></div><div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;<span class="comment"> *   instruction.  Handles AddRegFrm instructions.</span></div><div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;<span class="comment"> * @param insn    - The instruction whose opcode field is to be read.</span></div><div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;<span class="comment"> * @param inModRM - Indicates that the opcode field is to be read from the</span></div><div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;<span class="comment"> *                  ModR/M extension; useful for escape opcodes</span></div><div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;<span class="comment"> * @return        - 0 on success; nonzero otherwise.</span></div><div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l01411"></a><span class="lineno"><a class="line" href="X86DisassemblerDecoder_8c.html#a2eb1d47fec594e1eadf21c835a0ce517"> 1411</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="X86DisassemblerDecoder_8c.html#a2eb1d47fec594e1eadf21c835a0ce517">readOpcodeModifier</a>(<span class="keyword">struct</span> <a class="code" href="structInternalInstruction.html">InternalInstruction</a>* insn) {</div><div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;  <a class="code" href="X86DisassemblerDecoder_8c.html#ac92411447d53b3ccecf5a40f736650cc">dbgprintf</a>(insn, <span class="stringliteral">&quot;readOpcodeModifier()&quot;</span>);</div><div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;</div><div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;  <span class="keywordflow">if</span> (insn-&gt;<a class="code" href="structInternalInstruction.html#ab7d16d61c8c8e94d58ef50be40479b75">consumedOpcodeModifier</a>)</div><div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;</div><div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;  insn-&gt;<a class="code" href="structInternalInstruction.html#ab7d16d61c8c8e94d58ef50be40479b75">consumedOpcodeModifier</a> = <a class="code" href="X86DisassemblerDecoder_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;</div><div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;  <span class="keywordflow">switch</span> (insn-&gt;<a class="code" href="structInternalInstruction.html#a1d85c98f4456ef539774d603d4e15e0d">spec</a>-&gt;<a class="code" href="structInstructionSpecifier.html#a57b4276f710b106cc8b5bc27d0096fac">modifierType</a>) {</div><div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;  <span class="keywordflow">default</span>:</div><div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;    <a class="code" href="X86DisassemblerDecoder_8c.html#ae0228f36529f75f692753ef96d725012">debug</a>(<span class="stringliteral">&quot;Unknown modifier type.&quot;</span>);</div><div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;  <span class="keywordflow">case</span> MODIFIER_NONE:</div><div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;    <a class="code" href="X86DisassemblerDecoder_8c.html#ae0228f36529f75f692753ef96d725012">debug</a>(<span class="stringliteral">&quot;No modifier but an operand expects one.&quot;</span>);</div><div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;  <span class="keywordflow">case</span> MODIFIER_OPCODE:</div><div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;    insn-&gt;<a class="code" href="structInternalInstruction.html#ae69f63a63b1294cc7f67388b7afd93cd">opcodeModifier</a> = insn-&gt;<a class="code" href="structInternalInstruction.html#a0106234d00ddfeb8e9e29dadfca758ee">opcode</a> - insn-&gt;<a class="code" href="structInternalInstruction.html#a1d85c98f4456ef539774d603d4e15e0d">spec</a>-&gt;<a class="code" href="structInstructionSpecifier.html#a118cd668b413e8d794ff37f7539e8303">modifierBase</a>;</div><div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;  <span class="keywordflow">case</span> MODIFIER_MODRM:</div><div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;    insn-&gt;<a class="code" href="structInternalInstruction.html#ae69f63a63b1294cc7f67388b7afd93cd">opcodeModifier</a> = insn-&gt;<a class="code" href="structInternalInstruction.html#a4e8995824272b3ea6083c73aaf39e00d">modRM</a> - insn-&gt;<a class="code" href="structInternalInstruction.html#a1d85c98f4456ef539774d603d4e15e0d">spec</a>-&gt;<a class="code" href="structInstructionSpecifier.html#a118cd668b413e8d794ff37f7539e8303">modifierBase</a>;</div><div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;  }</div><div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;}</div><div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;</div><div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;<span class="comment"> * readOpcodeRegister - Reads an operand from the opcode field of an</span></div><div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;<span class="comment"> *   instruction and interprets it appropriately given the operand width.</span></div><div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;<span class="comment"> *   Handles AddRegFrm instructions.</span></div><div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;<span class="comment"> * @param insn  - See readOpcodeModifier().</span></div><div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;<span class="comment"> * @param size  - The width (in bytes) of the register being specified.</span></div><div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;<span class="comment"> *                1 means AL and friends, 2 means AX, 4 means EAX, and 8 means</span></div><div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;<span class="comment"> *                RAX.</span></div><div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;<span class="comment"> * @return      - 0 on success; nonzero otherwise.</span></div><div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l01446"></a><span class="lineno"><a class="line" href="X86DisassemblerDecoder_8c.html#ab536506d0058cd6baa803890e9d648dd"> 1446</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="X86DisassemblerDecoder_8c.html#ab536506d0058cd6baa803890e9d648dd">readOpcodeRegister</a>(<span class="keyword">struct</span> <a class="code" href="structInternalInstruction.html">InternalInstruction</a>* insn, uint8_t <a class="code" href="Target_2README_8txt.html#a02def7c594e9f19ff247ed0bf33d1c30">size</a>) {</div><div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;  <a class="code" href="X86DisassemblerDecoder_8c.html#ac92411447d53b3ccecf5a40f736650cc">dbgprintf</a>(insn, <span class="stringliteral">&quot;readOpcodeRegister()&quot;</span>);</div><div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;</div><div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="X86DisassemblerDecoder_8c.html#a2eb1d47fec594e1eadf21c835a0ce517">readOpcodeModifier</a>(insn))</div><div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;</div><div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;  <span class="keywordflow">if</span> (size == 0)</div><div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;    size = insn-&gt;<a class="code" href="structInternalInstruction.html#a8dd784f4a8eed89e5918a0abf254ed68">registerSize</a>;</div><div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;</div><div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;  <span class="keywordflow">switch</span> (size) {</div><div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;  <span class="keywordflow">case</span> 1:</div><div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;    insn-&gt;<a class="code" href="structInternalInstruction.html#a2353992733d9d87cede9036141b49003">opcodeRegister</a> = (<a class="code" href="X86DisassemblerDecoder_8h.html#a546839a5c4bcf9f9450967155f48de41">Reg</a>)(MODRM_REG_AL + ((<a class="code" href="X86DisassemblerDecoder_8h.html#af112ae874f4cca98ba15a30f5743e5e1">bFromREX</a>(insn-&gt;<a class="code" href="structInternalInstruction.html#a11653bcdad44439ab25047cc6dd589cf">rexPrefix</a>) &lt;&lt; 3)</div><div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;                                                  | insn-&gt;<a class="code" href="structInternalInstruction.html#ae69f63a63b1294cc7f67388b7afd93cd">opcodeModifier</a>));</div><div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;    <span class="keywordflow">if</span> (insn-&gt;<a class="code" href="structInternalInstruction.html#a11653bcdad44439ab25047cc6dd589cf">rexPrefix</a> &amp;&amp;</div><div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;        insn-&gt;<a class="code" href="structInternalInstruction.html#a2353992733d9d87cede9036141b49003">opcodeRegister</a> &gt;= MODRM_REG_AL + 0x4 &amp;&amp;</div><div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;        insn-&gt;<a class="code" href="structInternalInstruction.html#a2353992733d9d87cede9036141b49003">opcodeRegister</a> &lt; MODRM_REG_AL + 0x8) {</div><div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;      insn-&gt;<a class="code" href="structInternalInstruction.html#a2353992733d9d87cede9036141b49003">opcodeRegister</a> = (<a class="code" href="X86DisassemblerDecoder_8h.html#a546839a5c4bcf9f9450967155f48de41">Reg</a>)(MODRM_REG_SPL</div><div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;                                   + (insn-&gt;<a class="code" href="structInternalInstruction.html#a2353992733d9d87cede9036141b49003">opcodeRegister</a> - MODRM_REG_AL - 4));</div><div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;    }</div><div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;</div><div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;  <span class="keywordflow">case</span> 2:</div><div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;    insn-&gt;<a class="code" href="structInternalInstruction.html#a2353992733d9d87cede9036141b49003">opcodeRegister</a> = (<a class="code" href="X86DisassemblerDecoder_8h.html#a546839a5c4bcf9f9450967155f48de41">Reg</a>)(MODRM_REG_AX</div><div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;                                 + ((<a class="code" href="X86DisassemblerDecoder_8h.html#af112ae874f4cca98ba15a30f5743e5e1">bFromREX</a>(insn-&gt;<a class="code" href="structInternalInstruction.html#a11653bcdad44439ab25047cc6dd589cf">rexPrefix</a>) &lt;&lt; 3)</div><div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;                                    | insn-&gt;<a class="code" href="structInternalInstruction.html#ae69f63a63b1294cc7f67388b7afd93cd">opcodeModifier</a>));</div><div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;  <span class="keywordflow">case</span> 4:</div><div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;    insn-&gt;<a class="code" href="structInternalInstruction.html#a2353992733d9d87cede9036141b49003">opcodeRegister</a> = (<a class="code" href="X86DisassemblerDecoder_8h.html#a546839a5c4bcf9f9450967155f48de41">Reg</a>)(MODRM_REG_EAX</div><div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;                                 + ((<a class="code" href="X86DisassemblerDecoder_8h.html#af112ae874f4cca98ba15a30f5743e5e1">bFromREX</a>(insn-&gt;<a class="code" href="structInternalInstruction.html#a11653bcdad44439ab25047cc6dd589cf">rexPrefix</a>) &lt;&lt; 3)</div><div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;                                    | insn-&gt;<a class="code" href="structInternalInstruction.html#ae69f63a63b1294cc7f67388b7afd93cd">opcodeModifier</a>));</div><div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;  <span class="keywordflow">case</span> 8:</div><div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;    insn-&gt;<a class="code" href="structInternalInstruction.html#a2353992733d9d87cede9036141b49003">opcodeRegister</a> = (<a class="code" href="X86DisassemblerDecoder_8h.html#a546839a5c4bcf9f9450967155f48de41">Reg</a>)(MODRM_REG_RAX</div><div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;                                 + ((<a class="code" href="X86DisassemblerDecoder_8h.html#af112ae874f4cca98ba15a30f5743e5e1">bFromREX</a>(insn-&gt;<a class="code" href="structInternalInstruction.html#a11653bcdad44439ab25047cc6dd589cf">rexPrefix</a>) &lt;&lt; 3)</div><div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;                                    | insn-&gt;<a class="code" href="structInternalInstruction.html#ae69f63a63b1294cc7f67388b7afd93cd">opcodeModifier</a>));</div><div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;  }</div><div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;</div><div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;}</div><div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;</div><div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;<span class="comment"> * readImmediate - Consumes an immediate operand from an instruction, given the</span></div><div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;<span class="comment"> *   desired operand size.</span></div><div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;<span class="comment"> * @param insn  - The instruction whose operand is to be read.</span></div><div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;<span class="comment"> * @param size  - The width (in bytes) of the operand.</span></div><div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;<span class="comment"> * @return      - 0 if the immediate was successfully consumed; nonzero</span></div><div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;<span class="comment"> *                otherwise.</span></div><div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l01496"></a><span class="lineno"><a class="line" href="X86DisassemblerDecoder_8c.html#a771c0394a5e25fb07aaca2764eff8370"> 1496</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="X86DisassemblerDecoder_8c.html#a771c0394a5e25fb07aaca2764eff8370">readImmediate</a>(<span class="keyword">struct</span> <a class="code" href="structInternalInstruction.html">InternalInstruction</a>* insn, uint8_t <a class="code" href="Target_2README_8txt.html#a02def7c594e9f19ff247ed0bf33d1c30">size</a>) {</div><div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;  uint8_t imm8;</div><div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;  uint16_t imm16;</div><div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;  uint32_t imm32;</div><div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;  uint64_t imm64;</div><div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;</div><div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;  <a class="code" href="X86DisassemblerDecoder_8c.html#ac92411447d53b3ccecf5a40f736650cc">dbgprintf</a>(insn, <span class="stringliteral">&quot;readImmediate()&quot;</span>);</div><div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;</div><div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;  <span class="keywordflow">if</span> (insn-&gt;<a class="code" href="structInternalInstruction.html#a309659fcf361a7ecf358ce2e879c82ee">numImmediatesConsumed</a> == 2) {</div><div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;    <a class="code" href="X86DisassemblerDecoder_8c.html#ae0228f36529f75f692753ef96d725012">debug</a>(<span class="stringliteral">&quot;Already consumed two immediates&quot;</span>);</div><div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;  }</div><div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;</div><div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;  <span class="keywordflow">if</span> (size == 0)</div><div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;    size = insn-&gt;<a class="code" href="structInternalInstruction.html#a3bbafa345f93ec20312858606ce8983a">immediateSize</a>;</div><div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;    insn-&gt;<a class="code" href="structInternalInstruction.html#a3bbafa345f93ec20312858606ce8983a">immediateSize</a> = <a class="code" href="Target_2README_8txt.html#a02def7c594e9f19ff247ed0bf33d1c30">size</a>;</div><div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;  insn-&gt;<a class="code" href="structInternalInstruction.html#a5d8adf5f8eca4b73382be0133e570460">immediateOffset</a> = insn-&gt;<a class="code" href="structInternalInstruction.html#ab255c3e1663cdfbdebbe1b199140a950">readerCursor</a> - insn-&gt;<a class="code" href="structInternalInstruction.html#a3a55e24e218c4bff1f03ef64da4c3725">startLocation</a>;</div><div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;</div><div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;  <span class="keywordflow">switch</span> (size) {</div><div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;  <span class="keywordflow">case</span> 1:</div><div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="X86DisassemblerDecoder_8c.html#a1c693d3ea8868f36b5b192d0315cac04">consumeByte</a>(insn, &amp;imm8))</div><div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;    insn-&gt;<a class="code" href="structInternalInstruction.html#ab5314a93238a56e68a1c9d79bec379fd">immediates</a>[insn-&gt;<a class="code" href="structInternalInstruction.html#a309659fcf361a7ecf358ce2e879c82ee">numImmediatesConsumed</a>] = imm8;</div><div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;  <span class="keywordflow">case</span> 2:</div><div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;    <span class="keywordflow">if</span> (consumeUInt16(insn, &amp;imm16))</div><div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;    insn-&gt;<a class="code" href="structInternalInstruction.html#ab5314a93238a56e68a1c9d79bec379fd">immediates</a>[insn-&gt;<a class="code" href="structInternalInstruction.html#a309659fcf361a7ecf358ce2e879c82ee">numImmediatesConsumed</a>] = imm16;</div><div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;  <span class="keywordflow">case</span> 4:</div><div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;    <span class="keywordflow">if</span> (consumeUInt32(insn, &amp;imm32))</div><div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;    insn-&gt;<a class="code" href="structInternalInstruction.html#ab5314a93238a56e68a1c9d79bec379fd">immediates</a>[insn-&gt;<a class="code" href="structInternalInstruction.html#a309659fcf361a7ecf358ce2e879c82ee">numImmediatesConsumed</a>] = imm32;</div><div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;  <span class="keywordflow">case</span> 8:</div><div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;    <span class="keywordflow">if</span> (consumeUInt64(insn, &amp;imm64))</div><div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;    insn-&gt;<a class="code" href="structInternalInstruction.html#ab5314a93238a56e68a1c9d79bec379fd">immediates</a>[insn-&gt;<a class="code" href="structInternalInstruction.html#a309659fcf361a7ecf358ce2e879c82ee">numImmediatesConsumed</a>] = imm64;</div><div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;  }</div><div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;</div><div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;  insn-&gt;<a class="code" href="structInternalInstruction.html#a309659fcf361a7ecf358ce2e879c82ee">numImmediatesConsumed</a>++;</div><div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;</div><div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;}</div><div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;</div><div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;<span class="comment"> * readVVVV - Consumes vvvv from an instruction if it has a VEX prefix.</span></div><div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;<span class="comment"> * @param insn  - The instruction whose operand is to be read.</span></div><div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;<span class="comment"> * @return      - 0 if the vvvv was successfully consumed; nonzero</span></div><div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;<span class="comment"> *                otherwise.</span></div><div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l01550"></a><span class="lineno"><a class="line" href="X86DisassemblerDecoder_8c.html#a8514fc80a87b940b85536ef125c05350"> 1550</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="X86DisassemblerDecoder_8c.html#a8514fc80a87b940b85536ef125c05350">readVVVV</a>(<span class="keyword">struct</span> <a class="code" href="structInternalInstruction.html">InternalInstruction</a>* insn) {</div><div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;  <a class="code" href="X86DisassemblerDecoder_8c.html#ac92411447d53b3ccecf5a40f736650cc">dbgprintf</a>(insn, <span class="stringliteral">&quot;readVVVV()&quot;</span>);</div><div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;</div><div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;  <span class="keywordflow">if</span> (insn-&gt;<a class="code" href="structInternalInstruction.html#aa97e986ba10ca73e59e7fc87805e45d6">vexXopType</a> == <a class="code" href="X86DisassemblerDecoder_8h.html#ad0acf3022faa5f882e157cc76eca34d9ac814987998f8ea9c90b2e66907ffdbf3">TYPE_VEX_3B</a>)</div><div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;    insn-&gt;<a class="code" href="structInternalInstruction.html#a0f0d4f1135621b45a79af03c3ad02bf4">vvvv</a> = <a class="code" href="X86DisassemblerDecoder_8h.html#a9b5608175fb4bc57fd5e6bcd7f5efed2">vvvvFromVEX3of3</a>(insn-&gt;<a class="code" href="structInternalInstruction.html#aef370f198e4d28dfd3db762a7edb7c31">vexXopPrefix</a>[2]);</div><div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (insn-&gt;<a class="code" href="structInternalInstruction.html#aa97e986ba10ca73e59e7fc87805e45d6">vexXopType</a> == <a class="code" href="X86DisassemblerDecoder_8h.html#ad0acf3022faa5f882e157cc76eca34d9a443a28cde1bf0566e40b6a38887bb6df">TYPE_VEX_2B</a>)</div><div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;    insn-&gt;<a class="code" href="structInternalInstruction.html#a0f0d4f1135621b45a79af03c3ad02bf4">vvvv</a> = <a class="code" href="X86DisassemblerDecoder_8h.html#a8dc9745657ce1382ca803e1e3e62a049">vvvvFromVEX2of2</a>(insn-&gt;<a class="code" href="structInternalInstruction.html#aef370f198e4d28dfd3db762a7edb7c31">vexXopPrefix</a>[1]);</div><div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (insn-&gt;<a class="code" href="structInternalInstruction.html#aa97e986ba10ca73e59e7fc87805e45d6">vexXopType</a> == <a class="code" href="X86DisassemblerDecoder_8h.html#ad0acf3022faa5f882e157cc76eca34d9a7b6ca8597d8e43fd94666f6d722d6c43">TYPE_XOP</a>)</div><div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;    insn-&gt;<a class="code" href="structInternalInstruction.html#a0f0d4f1135621b45a79af03c3ad02bf4">vvvv</a> = <a class="code" href="X86DisassemblerDecoder_8h.html#ad6634f7f956dec873ecc606847a660cc">vvvvFromXOP3of3</a>(insn-&gt;<a class="code" href="structInternalInstruction.html#aef370f198e4d28dfd3db762a7edb7c31">vexXopPrefix</a>[2]);</div><div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;</div><div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;  <span class="keywordflow">if</span> (insn-&gt;<a class="code" href="structInternalInstruction.html#a960c71a88602e7284b7a53a43c0d5c04">mode</a> != <a class="code" href="X86DisassemblerDecoderCommon_8h.html#a549ce06ad85d0726a93b2768ae7c7da7aeaebd8c1fe2b71a386838da0280c211c">MODE_64BIT</a>)</div><div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;    insn-&gt;<a class="code" href="structInternalInstruction.html#a0f0d4f1135621b45a79af03c3ad02bf4">vvvv</a> &amp;= 0x7;</div><div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;</div><div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;}</div><div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;</div><div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;<span class="comment"> * readOperands - Consults the specifier for an instruction and consumes all</span></div><div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;<span class="comment"> *   operands for that instruction, interpreting them as it goes.</span></div><div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;<span class="comment"> * @param insn  - The instruction whose operands are to be read and interpreted.</span></div><div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;<span class="comment"> * @return      - 0 if all operands could be read; nonzero otherwise.</span></div><div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l01575"></a><span class="lineno"><a class="line" href="X86DisassemblerDecoder_8c.html#a42be988af3ae0e352befa7189bd50936"> 1575</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="X86DisassemblerDecoder_8c.html#a42be988af3ae0e352befa7189bd50936">readOperands</a>(<span class="keyword">struct</span> <a class="code" href="structInternalInstruction.html">InternalInstruction</a>* insn) {</div><div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="README__ALTIVEC_8txt.html#a98586ea01a32ff5046b0868b036a1849">index</a>;</div><div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;  <span class="keywordtype">int</span> hasVVVV, needVVVV;</div><div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;  <span class="keywordtype">int</span> sawRegImm = 0;</div><div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;</div><div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;  <a class="code" href="X86DisassemblerDecoder_8c.html#ac92411447d53b3ccecf5a40f736650cc">dbgprintf</a>(insn, <span class="stringliteral">&quot;readOperands()&quot;</span>);</div><div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;</div><div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;  <span class="comment">/* If non-zero vvvv specified, need to make sure one of the operands</span></div><div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;<span class="comment">     uses it. */</span></div><div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;  hasVVVV = !<a class="code" href="X86DisassemblerDecoder_8c.html#a8514fc80a87b940b85536ef125c05350">readVVVV</a>(insn);</div><div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;  needVVVV = hasVVVV &amp;&amp; (insn-&gt;<a class="code" href="structInternalInstruction.html#a0f0d4f1135621b45a79af03c3ad02bf4">vvvv</a> != 0);</div><div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;</div><div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;  <span class="keywordflow">for</span> (index = 0; index &lt; <a class="code" href="X86DisassemblerDecoderCommon_8h.html#a5f403e1e45149893b0ea54d8796cc921">X86_MAX_OPERANDS</a>; ++<a class="code" href="README__ALTIVEC_8txt.html#a98586ea01a32ff5046b0868b036a1849">index</a>) {</div><div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;    <span class="keywordflow">switch</span> (x86OperandSets[insn-&gt;<a class="code" href="structInternalInstruction.html#a1d85c98f4456ef539774d603d4e15e0d">spec</a>-&gt;operands][index].encoding) {</div><div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;    <span class="keywordflow">case</span> ENCODING_NONE:</div><div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;    <span class="keywordflow">case</span> ENCODING_REG:</div><div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;    <span class="keywordflow">case</span> ENCODING_RM:</div><div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="X86DisassemblerDecoder_8c.html#ae354b93b59d4f78cddbb50869bd5ef6b">readModRM</a>(insn))</div><div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;        <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="X86DisassemblerDecoder_8c.html#adb1fcba65d61d145b053ee0217b3dee7">fixupReg</a>(insn, &amp;x86OperandSets[insn-&gt;<a class="code" href="structInternalInstruction.html#a1d85c98f4456ef539774d603d4e15e0d">spec</a>-&gt;operands][index]))</div><div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;        <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;    <span class="keywordflow">case</span> ENCODING_CB:</div><div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;    <span class="keywordflow">case</span> ENCODING_CW:</div><div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;    <span class="keywordflow">case</span> ENCODING_CD:</div><div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;    <span class="keywordflow">case</span> ENCODING_CP:</div><div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;    <span class="keywordflow">case</span> ENCODING_CO:</div><div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;    <span class="keywordflow">case</span> ENCODING_CT:</div><div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;      <a class="code" href="X86DisassemblerDecoder_8c.html#ac92411447d53b3ccecf5a40f736650cc">dbgprintf</a>(insn, <span class="stringliteral">&quot;We currently don&#39;t hande code-offset encodings&quot;</span>);</div><div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;    <span class="keywordflow">case</span> ENCODING_IB:</div><div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;      <span class="keywordflow">if</span> (sawRegImm) {</div><div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;        <span class="comment">/* Saw a register immediate so don&#39;t read again and instead split the</span></div><div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;<span class="comment">           previous immediate.  FIXME: This is a hack. */</span></div><div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;        insn-&gt;<a class="code" href="structInternalInstruction.html#ab5314a93238a56e68a1c9d79bec379fd">immediates</a>[insn-&gt;<a class="code" href="structInternalInstruction.html#a309659fcf361a7ecf358ce2e879c82ee">numImmediatesConsumed</a>] =</div><div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;          insn-&gt;<a class="code" href="structInternalInstruction.html#ab5314a93238a56e68a1c9d79bec379fd">immediates</a>[insn-&gt;<a class="code" href="structInternalInstruction.html#a309659fcf361a7ecf358ce2e879c82ee">numImmediatesConsumed</a> - 1] &amp; 0xf;</div><div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;        ++insn-&gt;<a class="code" href="structInternalInstruction.html#a309659fcf361a7ecf358ce2e879c82ee">numImmediatesConsumed</a>;</div><div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;      }</div><div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="X86DisassemblerDecoder_8c.html#a771c0394a5e25fb07aaca2764eff8370">readImmediate</a>(insn, 1))</div><div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;        <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;      <span class="keywordflow">if</span> (x86OperandSets[insn-&gt;<a class="code" href="structInternalInstruction.html#a1d85c98f4456ef539774d603d4e15e0d">spec</a>-&gt;operands][index].type == TYPE_IMM3 &amp;&amp;</div><div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;          insn-&gt;<a class="code" href="structInternalInstruction.html#ab5314a93238a56e68a1c9d79bec379fd">immediates</a>[insn-&gt;<a class="code" href="structInternalInstruction.html#a309659fcf361a7ecf358ce2e879c82ee">numImmediatesConsumed</a> - 1] &gt; 7)</div><div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;        <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;      <span class="keywordflow">if</span> (x86OperandSets[insn-&gt;<a class="code" href="structInternalInstruction.html#a1d85c98f4456ef539774d603d4e15e0d">spec</a>-&gt;operands][index].type == TYPE_IMM5 &amp;&amp;</div><div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;          insn-&gt;<a class="code" href="structInternalInstruction.html#ab5314a93238a56e68a1c9d79bec379fd">immediates</a>[insn-&gt;<a class="code" href="structInternalInstruction.html#a309659fcf361a7ecf358ce2e879c82ee">numImmediatesConsumed</a> - 1] &gt; 31)</div><div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;        <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;      <span class="keywordflow">if</span> (x86OperandSets[insn-&gt;<a class="code" href="structInternalInstruction.html#a1d85c98f4456ef539774d603d4e15e0d">spec</a>-&gt;operands][index].type == TYPE_XMM128 ||</div><div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;          x86OperandSets[insn-&gt;<a class="code" href="structInternalInstruction.html#a1d85c98f4456ef539774d603d4e15e0d">spec</a>-&gt;operands][index].type == TYPE_XMM256)</div><div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;        sawRegImm = 1;</div><div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;    <span class="keywordflow">case</span> ENCODING_IW:</div><div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="X86DisassemblerDecoder_8c.html#a771c0394a5e25fb07aaca2764eff8370">readImmediate</a>(insn, 2))</div><div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;        <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;    <span class="keywordflow">case</span> ENCODING_ID:</div><div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="X86DisassemblerDecoder_8c.html#a771c0394a5e25fb07aaca2764eff8370">readImmediate</a>(insn, 4))</div><div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;        <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;    <span class="keywordflow">case</span> ENCODING_IO:</div><div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="X86DisassemblerDecoder_8c.html#a771c0394a5e25fb07aaca2764eff8370">readImmediate</a>(insn, 8))</div><div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;        <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;    <span class="keywordflow">case</span> ENCODING_Iv:</div><div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="X86DisassemblerDecoder_8c.html#a771c0394a5e25fb07aaca2764eff8370">readImmediate</a>(insn, insn-&gt;<a class="code" href="structInternalInstruction.html#a3bbafa345f93ec20312858606ce8983a">immediateSize</a>))</div><div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;        <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;    <span class="keywordflow">case</span> ENCODING_Ia:</div><div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="X86DisassemblerDecoder_8c.html#a771c0394a5e25fb07aaca2764eff8370">readImmediate</a>(insn, insn-&gt;<a class="code" href="structInternalInstruction.html#a401714e4eb9715146c94275270515ba9">addressSize</a>))</div><div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;        <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;    <span class="keywordflow">case</span> ENCODING_RB:</div><div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="X86DisassemblerDecoder_8c.html#ab536506d0058cd6baa803890e9d648dd">readOpcodeRegister</a>(insn, 1))</div><div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;        <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;    <span class="keywordflow">case</span> ENCODING_RW:</div><div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="X86DisassemblerDecoder_8c.html#ab536506d0058cd6baa803890e9d648dd">readOpcodeRegister</a>(insn, 2))</div><div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;        <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;    <span class="keywordflow">case</span> ENCODING_RD:</div><div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="X86DisassemblerDecoder_8c.html#ab536506d0058cd6baa803890e9d648dd">readOpcodeRegister</a>(insn, 4))</div><div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;        <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;    <span class="keywordflow">case</span> ENCODING_RO:</div><div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="X86DisassemblerDecoder_8c.html#ab536506d0058cd6baa803890e9d648dd">readOpcodeRegister</a>(insn, 8))</div><div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;        <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;    <span class="keywordflow">case</span> ENCODING_Rv:</div><div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="X86DisassemblerDecoder_8c.html#ab536506d0058cd6baa803890e9d648dd">readOpcodeRegister</a>(insn, 0))</div><div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;        <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;    <span class="keywordflow">case</span> ENCODING_I:</div><div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="X86DisassemblerDecoder_8c.html#a2eb1d47fec594e1eadf21c835a0ce517">readOpcodeModifier</a>(insn))</div><div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;        <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;    <span class="keywordflow">case</span> ENCODING_VVVV:</div><div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;      needVVVV = 0; <span class="comment">/* Mark that we have found a VVVV operand. */</span></div><div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;      <span class="keywordflow">if</span> (!hasVVVV)</div><div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;        <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="X86DisassemblerDecoder_8c.html#adb1fcba65d61d145b053ee0217b3dee7">fixupReg</a>(insn, &amp;x86OperandSets[insn-&gt;<a class="code" href="structInternalInstruction.html#a1d85c98f4456ef539774d603d4e15e0d">spec</a>-&gt;operands][index]))</div><div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;        <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;    <span class="keywordflow">case</span> ENCODING_DUP:</div><div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;    <span class="keywordflow">default</span>:</div><div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;      <a class="code" href="X86DisassemblerDecoder_8c.html#ac92411447d53b3ccecf5a40f736650cc">dbgprintf</a>(insn, <span class="stringliteral">&quot;Encountered an operand with an unknown encoding.&quot;</span>);</div><div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;    }</div><div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;  }</div><div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;</div><div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;  <span class="comment">/* If we didn&#39;t find ENCODING_VVVV operand, but non-zero vvvv present, fail */</span></div><div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;  <span class="keywordflow">if</span> (needVVVV) <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;</div><div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;}</div><div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;</div><div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;<span class="comment"> * decodeInstruction - Reads and interprets a full instruction provided by the</span></div><div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;<span class="comment"> *   user.</span></div><div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;<span class="comment"> * @param insn      - A pointer to the instruction to be populated.  Must be</span></div><div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;<span class="comment"> *                    pre-allocated.</span></div><div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;<span class="comment"> * @param reader    - The function to be used to read the instruction&#39;s bytes.</span></div><div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;<span class="comment"> * @param readerArg - A generic argument to be passed to the reader to store</span></div><div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;<span class="comment"> *                    any internal state.</span></div><div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;<span class="comment"> * @param logger    - If non-NULL, the function to be used to write log messages</span></div><div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;<span class="comment"> *                    and warnings.</span></div><div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;<span class="comment"> * @param loggerArg - A generic argument to be passed to the logger to store</span></div><div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;<span class="comment"> *                    any internal state.</span></div><div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;<span class="comment"> * @param startLoc  - The address (in the reader&#39;s address space) of the first</span></div><div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;<span class="comment"> *                    byte in the instruction.</span></div><div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;<span class="comment"> * @param mode      - The mode (real mode, IA-32e, or IA-32e in 64-bit mode) to</span></div><div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;<span class="comment"> *                    decode the instruction in.</span></div><div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;<span class="comment"> * @return          - 0 if the instruction&#39;s memory could be read; nonzero if</span></div><div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;<span class="comment"> *                    not.</span></div><div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l01712"></a><span class="lineno"><a class="line" href="X86DisassemblerDecoder_8h.html#a6c71d4e276f8fe7ce11b7a8456821d7c"> 1712</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="X86DisassemblerDecoder_8c.html#a6c71d4e276f8fe7ce11b7a8456821d7c">decodeInstruction</a>(<span class="keyword">struct</span> <a class="code" href="structInternalInstruction.html">InternalInstruction</a>* insn,</div><div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;                      <a class="code" href="X86DisassemblerDecoder_8h.html#af2f124e52f3f6bce2b0f09160b3a62bf">byteReader_t</a> reader,</div><div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;                      <span class="keyword">const</span> <span class="keywordtype">void</span>* readerArg,</div><div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;                      <a class="code" href="X86DisassemblerDecoder_8h.html#a7de47001df3a0b4540540594eb3ccfff">dlog_t</a> <a class="code" href="X86Disassembler_8cpp.html#a8b039b49b0328a216cb2e7704d330873">logger</a>,</div><div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;                      <span class="keywordtype">void</span>* loggerArg,</div><div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;                      <span class="keyword">const</span> <span class="keywordtype">void</span>* miiArg,</div><div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;                      uint64_t startLoc,</div><div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;                      <a class="code" href="X86DisassemblerDecoderCommon_8h.html#a549ce06ad85d0726a93b2768ae7c7da7">DisassemblerMode</a> <a class="code" href="README-Thumb_8txt.html#ad7bf7cc723b97ab4a518502c217ddbd7">mode</a>) {</div><div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;  <a class="code" href="namespacellvm_1_1Intrinsic.html#a73349916f7e54a6b988a3646c7a02e90ae857cbc5cf8c5a980f0bd245ad5ec61a">memset</a>(insn, 0, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structInternalInstruction.html">InternalInstruction</a>));</div><div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;</div><div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;  insn-&gt;<a class="code" href="structInternalInstruction.html#abb52adf9696c6d65eb3ac1f202b7b0a3">reader</a> = reader;</div><div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;  insn-&gt;<a class="code" href="structInternalInstruction.html#a54cc2f9d67046f0014ebd3347dff0515">readerArg</a> = readerArg;</div><div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;  insn-&gt;<a class="code" href="structInternalInstruction.html#a8453ecd76a6e0ab31a8c2218a1ba110b">dlog</a> = <a class="code" href="X86Disassembler_8cpp.html#a8b039b49b0328a216cb2e7704d330873">logger</a>;</div><div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;  insn-&gt;<a class="code" href="structInternalInstruction.html#a3f995b5b0184a27404119e0038c515ab">dlogArg</a> = loggerArg;</div><div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;  insn-&gt;<a class="code" href="structInternalInstruction.html#a3a55e24e218c4bff1f03ef64da4c3725">startLocation</a> = startLoc;</div><div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;  insn-&gt;<a class="code" href="structInternalInstruction.html#ab255c3e1663cdfbdebbe1b199140a950">readerCursor</a> = startLoc;</div><div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;  insn-&gt;<a class="code" href="structInternalInstruction.html#a960c71a88602e7284b7a53a43c0d5c04">mode</a> = <a class="code" href="README-Thumb_8txt.html#ad7bf7cc723b97ab4a518502c217ddbd7">mode</a>;</div><div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;  insn-&gt;<a class="code" href="structInternalInstruction.html#a309659fcf361a7ecf358ce2e879c82ee">numImmediatesConsumed</a> = 0;</div><div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;</div><div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="X86DisassemblerDecoder_8c.html#aef1a8136ca4df8d11829c1aa2b708f5d">readPrefixes</a>(insn)       ||</div><div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;      <a class="code" href="X86DisassemblerDecoder_8c.html#a0a006bbcf8e6c2fb5ab33c0066467e56">readOpcode</a>(insn)         ||</div><div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;      <a class="code" href="X86DisassemblerDecoder_8c.html#a3940644102a488fdce81b36d054bbee3">getID</a>(insn, miiArg)      ||</div><div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;      insn-&gt;<a class="code" href="structInternalInstruction.html#a2c614fda371a4b9cd14cf06154458364">instructionID</a> == 0 ||</div><div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;      <a class="code" href="X86DisassemblerDecoder_8c.html#a42be988af3ae0e352befa7189bd50936">readOperands</a>(insn))</div><div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;</div><div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;  insn-&gt;<a class="code" href="structInternalInstruction.html#aed6c81f3fa45d9098d16fca6a75334b6">operands</a> = &amp;x86OperandSets[insn-&gt;<a class="code" href="structInternalInstruction.html#a1d85c98f4456ef539774d603d4e15e0d">spec</a>-&gt;operands][0];</div><div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;</div><div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;  insn-&gt;<a class="code" href="structInternalInstruction.html#aa21169901ecfa8cafe99dc89f912f775">length</a> = insn-&gt;<a class="code" href="structInternalInstruction.html#ab255c3e1663cdfbdebbe1b199140a950">readerCursor</a> - insn-&gt;<a class="code" href="structInternalInstruction.html#a3a55e24e218c4bff1f03ef64da4c3725">startLocation</a>;</div><div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;</div><div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;  <a class="code" href="X86DisassemblerDecoder_8c.html#ac92411447d53b3ccecf5a40f736650cc">dbgprintf</a>(insn, <span class="stringliteral">&quot;Read from 0x%llx to 0x%llx: length %zu&quot;</span>,</div><div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;            startLoc, insn-&gt;<a class="code" href="structInternalInstruction.html#ab255c3e1663cdfbdebbe1b199140a950">readerCursor</a>, insn-&gt;<a class="code" href="structInternalInstruction.html#aa21169901ecfa8cafe99dc89f912f775">length</a>);</div><div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;</div><div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;  <span class="keywordflow">if</span> (insn-&gt;<a class="code" href="structInternalInstruction.html#aa21169901ecfa8cafe99dc89f912f775">length</a> &gt; 15)</div><div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;    <a class="code" href="X86DisassemblerDecoder_8c.html#ac92411447d53b3ccecf5a40f736650cc">dbgprintf</a>(insn, <span class="stringliteral">&quot;Instruction exceeds 15-byte limit&quot;</span>);</div><div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;</div><div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;}</div><div class="ttc" id="X86DisassemblerDecoderCommon_8h_html_a5cc171c21d0532e0f6353e972f1ff621a6666ce07b725a97b298534bba4549531"><div class="ttname"><a href="X86DisassemblerDecoderCommon_8h.html#a5cc171c21d0532e0f6353e972f1ff621a6666ce07b725a97b298534bba4549531">THREEBYTE_38</a></div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoderCommon_8h_source.html#l00288">X86DisassemblerDecoderCommon.h:288</a></div></div>
<div class="ttc" id="structInternalInstruction_html_a5d8adf5f8eca4b73382be0133e570460"><div class="ttname"><a href="structInternalInstruction.html#a5d8adf5f8eca4b73382be0133e570460">InternalInstruction::immediateOffset</a></div><div class="ttdeci">uint8_t immediateOffset</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00562">X86DisassemblerDecoder.h:562</a></div></div>
<div class="ttc" id="X86DisassemblerDecoder_8h_html_a678cc792a7ece4943c203fd18e57ad46ad4367053bdbbe0a470b5459337ce77b2"><div class="ttname"><a href="X86DisassemblerDecoder_8h.html#a678cc792a7ece4943c203fd18e57ad46ad4367053bdbbe0a470b5459337ce77b2">SEG_OVERRIDE_DS</a></div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00442">X86DisassemblerDecoder.h:442</a></div></div>
<div class="ttc" id="X86DisassemblerDecoder_8h_html_a9f49754c886a53ae214267b3ec3ca263a5a96f045828489ae6d49bf72d90225b7"><div class="ttname"><a href="X86DisassemblerDecoder_8h.html#a9f49754c886a53ae214267b3ec3ca263a5a96f045828489ae6d49bf72d90225b7">XOP_MAP_SELECT_A</a></div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00462">X86DisassemblerDecoder.h:462</a></div></div>
<div class="ttc" id="structInternalInstruction_html_adea08d2cf5dc0695277abe942a9d4367"><div class="ttname"><a href="structInternalInstruction.html#adea08d2cf5dc0695277abe942a9d4367">InternalInstruction::sib</a></div><div class="ttdeci">uint8_t sib</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00595">X86DisassemblerDecoder.h:595</a></div></div>
<div class="ttc" id="X86DisassemblerDecoder_8h_html_a7cb9f08e12fcda158bbe0cee76ef61f7a28642d84aadee3992f08c36ca08b16a5"><div class="ttname"><a href="X86DisassemblerDecoder_8h.html#a7cb9f08e12fcda158bbe0cee76ef61f7a28642d84aadee3992f08c36ca08b16a5">SIB_BASE_NONE</a></div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00407">X86DisassemblerDecoder.h:407</a></div></div>
<div class="ttc" id="structInternalInstruction_html_a04cb5db41677eb5617f830ad43744861"><div class="ttname"><a href="structInternalInstruction.html#a04cb5db41677eb5617f830ad43744861">InternalInstruction::reg</a></div><div class="ttdeci">Reg reg</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00624">X86DisassemblerDecoder.h:624</a></div></div>
<div class="ttc" id="X86DisassemblerDecoder_8h_html_a678cc792a7ece4943c203fd18e57ad46a72c5f3c25f3f4d5e1f9fb70f122103b2"><div class="ttname"><a href="X86DisassemblerDecoder_8h.html#a678cc792a7ece4943c203fd18e57ad46a72c5f3c25f3f4d5e1f9fb70f122103b2">SEG_OVERRIDE_ES</a></div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00443">X86DisassemblerDecoder.h:443</a></div></div>
<div class="ttc" id="X86DisassemblerDecoderCommon_8h_html_ab447e6c9b537c8221e0bd18f6d980b29"><div class="ttname"><a href="X86DisassemblerDecoderCommon_8h.html#ab447e6c9b537c8221e0bd18f6d980b29">THREEBYTEA6_SYM</a></div><div class="ttdeci">#define THREEBYTEA6_SYM</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoderCommon_8h_source.html#l00033">X86DisassemblerDecoderCommon.h:33</a></div></div>
<div class="ttc" id="X86DisassemblerDecoder_8h_html_a1c2e931225f964b581ab025f86a39872"><div class="ttname"><a href="X86DisassemblerDecoder_8h.html#a1c2e931225f964b581ab025f86a39872">rFromREX</a></div><div class="ttdeci">#define rFromREX(rex)</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00044">X86DisassemblerDecoder.h:44</a></div></div>
<div class="ttc" id="X86DisassemblerDecoder_8h_html_a7de47001df3a0b4540540594eb3ccfff"><div class="ttname"><a href="X86DisassemblerDecoder_8h.html#a7de47001df3a0b4540540594eb3ccfff">dlog_t</a></div><div class="ttdeci">void(* dlog_t)(void *arg, const char *log)</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00506">X86DisassemblerDecoder.h:506</a></div></div>
<div class="ttc" id="X86DisassemblerDecoder_8h_html_af2f124e52f3f6bce2b0f09160b3a62bf"><div class="ttname"><a href="X86DisassemblerDecoder_8h.html#af2f124e52f3f6bce2b0f09160b3a62bf">byteReader_t</a></div><div class="ttdeci">int(* byteReader_t)(const void *arg, uint8_t *byte, uint64_t address)</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00496">X86DisassemblerDecoder.h:496</a></div></div>
<div class="ttc" id="X86DisassemblerDecoderCommon_8h_html_a549ce06ad85d0726a93b2768ae7c7da7a53fbe3659b7806422318b014a19e66c3"><div class="ttname"><a href="X86DisassemblerDecoderCommon_8h.html#a549ce06ad85d0726a93b2768ae7c7da7a53fbe3659b7806422318b014a19e66c3">MODE_16BIT</a></div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoderCommon_8h_source.html#l00552">X86DisassemblerDecoderCommon.h:552</a></div></div>
<div class="ttc" id="X86DisassemblerDecoderCommon_8h_html_a349d73e2f39af064d9999d7780f9897d"><div class="ttname"><a href="X86DisassemblerDecoderCommon_8h.html#a349d73e2f39af064d9999d7780f9897d">XOP9_MAP_SYM</a></div><div class="ttdeci">#define XOP9_MAP_SYM</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoderCommon_8h_source.html#l00036">X86DisassemblerDecoderCommon.h:36</a></div></div>
<div class="ttc" id="X86DisassemblerDecoder_8c_html_a7d9a3ce3081e918d80b9770b584009a3"><div class="ttname"><a href="X86DisassemblerDecoder_8c.html#a7d9a3ce3081e918d80b9770b584009a3">readSIB</a></div><div class="ttdeci">static int readSIB(struct InternalInstruction *insn)</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8c_source.html#l01005">X86DisassemblerDecoder.c:1005</a></div></div>
<div class="ttc" id="X86DisassemblerDecoder_8h_html_ad0acf3022faa5f882e157cc76eca34d9af4477fd3be2db8d439904dd794ce6883"><div class="ttname"><a href="X86DisassemblerDecoder_8h.html#ad0acf3022faa5f882e157cc76eca34d9af4477fd3be2db8d439904dd794ce6883">TYPE_NO_VEX_XOP</a></div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00477">X86DisassemblerDecoder.h:477</a></div></div>
<div class="ttc" id="X86DisassemblerDecoder_8h_html_ad0acf3022faa5f882e157cc76eca34d9a443a28cde1bf0566e40b6a38887bb6df"><div class="ttname"><a href="X86DisassemblerDecoder_8h.html#ad0acf3022faa5f882e157cc76eca34d9a443a28cde1bf0566e40b6a38887bb6df">TYPE_VEX_2B</a></div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00478">X86DisassemblerDecoder.h:478</a></div></div>
<div class="ttc" id="X86DisassemblerDecoder_8c_html_a9bf76a53657a663a17a3df12a4293d99"><div class="ttname"><a href="X86DisassemblerDecoder_8c.html#a9bf76a53657a663a17a3df12a4293d99">getIDWithAttrMask</a></div><div class="ttdeci">static int getIDWithAttrMask(uint16_t *instructionID, struct InternalInstruction *insn, uint8_t attrMask)</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8c_source.html#l00761">X86DisassemblerDecoder.c:761</a></div></div>
<div class="ttc" id="Target_2README_8txt_html_a02def7c594e9f19ff247ed0bf33d1c30"><div class="ttname"><a href="Target_2README_8txt.html#a02def7c594e9f19ff247ed0bf33d1c30">size</a></div><div class="ttdeci">i&lt; reg-&gt; size</div><div class="ttdef"><b>Definition:</b> <a href="Target_2README_8txt_source.html#l00204">Target/README.txt:204</a></div></div>
<div class="ttc" id="X86DisassemblerDecoder_8h_html_aabfc6f7a66e0c44fd2145dddeaa88497"><div class="ttname"><a href="X86DisassemblerDecoder_8h.html#aabfc6f7a66e0c44fd2145dddeaa88497">bFromVEX2of3</a></div><div class="ttdeci">#define bFromVEX2of3(vex)</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00050">X86DisassemblerDecoder.h:50</a></div></div>
<div class="ttc" id="structInternalInstruction_html_a6eae0ad2e530d2c0d65b4d50c951ba63"><div class="ttname"><a href="structInternalInstruction.html#a6eae0ad2e530d2c0d65b4d50c951ba63">InternalInstruction::consumedDisplacement</a></div><div class="ttdeci">BOOL consumedDisplacement</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00598">X86DisassemblerDecoder.h:598</a></div></div>
<div class="ttc" id="structInternalInstruction_html_ad30e8e15786fa9fc4fe7d50c950a3e17"><div class="ttname"><a href="structInternalInstruction.html#ad30e8e15786fa9fc4fe7d50c950a3e17">InternalInstruction::eaBaseBase</a></div><div class="ttdeci">EABase eaBaseBase</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00615">X86DisassemblerDecoder.h:615</a></div></div>
<div class="ttc" id="structInternalInstruction_html_aa680516683d15d3cb14c7073488ddf99"><div class="ttname"><a href="structInternalInstruction.html#aa680516683d15d3cb14c7073488ddf99">InternalInstruction::consumedSIB</a></div><div class="ttdeci">BOOL consumedSIB</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00594">X86DisassemblerDecoder.h:594</a></div></div>
<div class="ttc" id="X86DisassemblerDecoder_8h_html_a384089e78b51b1b5773e879ed1d4e672"><div class="ttname"><a href="X86DisassemblerDecoder_8h.html#a384089e78b51b1b5773e879ed1d4e672">rmFromModRM</a></div><div class="ttdeci">#define rmFromModRM(modRM)</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00039">X86DisassemblerDecoder.h:39</a></div></div>
<div class="ttc" id="Target_2SystemZ_2README_8txt_html_aab103049890481bd3a194048b45f5fce"><div class="ttname"><a href="Target_2SystemZ_2README_8txt.html#aab103049890481bd3a194048b45f5fce">base</a></div><div class="ttdeci">therefore end up llgh r3 lr r0 br r14 but truncating the load would lh r3 br r14 Functions ret i64 and ought to be implemented ngr r0 br r14 but two address optimisations reverse the order of the AND and ngr r2 lgr r0 br r14 CodeGen SystemZ and ll has several examples of this Out of range displacements are usually handled by loading the full address into a register In many cases it would be better to create an anchor point instead E g i64 base</div><div class="ttdef"><b>Definition:</b> <a href="Target_2SystemZ_2README_8txt_source.html#l00147">Target/SystemZ/README.txt:147</a></div></div>
<div class="ttc" id="structInternalInstruction_html_a0106234d00ddfeb8e9e29dadfca758ee"><div class="ttname"><a href="structInternalInstruction.html#a0106234d00ddfeb8e9e29dadfca758ee">InternalInstruction::opcode</a></div><div class="ttdeci">uint8_t opcode</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00567">X86DisassemblerDecoder.h:567</a></div></div>
<div class="ttc" id="structInternalInstruction_html_ad8cbe37cf206026716c7b05a5ea06ba5"><div class="ttname"><a href="structInternalInstruction.html#ad8cbe37cf206026716c7b05a5ea06ba5">InternalInstruction::xAcquireRelease</a></div><div class="ttdeci">BOOL xAcquireRelease</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00551">X86DisassemblerDecoder.h:551</a></div></div>
<div class="ttc" id="X86DisassemblerDecoder_8h_html_ad0acf3022faa5f882e157cc76eca34d9ac814987998f8ea9c90b2e66907ffdbf3"><div class="ttname"><a href="X86DisassemblerDecoder_8h.html#ad0acf3022faa5f882e157cc76eca34d9ac814987998f8ea9c90b2e66907ffdbf3">TYPE_VEX_3B</a></div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00479">X86DisassemblerDecoder.h:479</a></div></div>
<div class="ttc" id="X86DisassemblerDecoderCommon_8h_html_a7c612b4ed63c0ad7096e01f593879d58"><div class="ttname"><a href="X86DisassemblerDecoderCommon_8h.html#a7c612b4ed63c0ad7096e01f593879d58">OperandEncoding</a></div><div class="ttdeci">OperandEncoding</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoderCommon_8h_source.html#l00409">X86DisassemblerDecoderCommon.h:409</a></div></div>
<div class="ttc" id="structInternalInstruction_html_aef370f198e4d28dfd3db762a7edb7c31"><div class="ttname"><a href="structInternalInstruction.html#aef370f198e4d28dfd3db762a7edb7c31">InternalInstruction::vexXopPrefix</a></div><div class="ttdeci">uint8_t vexXopPrefix[3]</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00540">X86DisassemblerDecoder.h:540</a></div></div>
<div class="ttc" id="structInternalInstruction_html_ac235f78a50feb97426e7f8149591a08c"><div class="ttname"><a href="structInternalInstruction.html#ac235f78a50feb97426e7f8149591a08c">InternalInstruction::displacementOffset</a></div><div class="ttdeci">uint8_t displacementOffset</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00561">X86DisassemblerDecoder.h:561</a></div></div>
<div class="ttc" id="structInternalInstruction_html_a3a55e24e218c4bff1f03ef64da4c3725"><div class="ttname"><a href="structInternalInstruction.html#a3a55e24e218c4bff1f03ef64da4c3725">InternalInstruction::startLocation</a></div><div class="ttdeci">uint64_t startLocation</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00529">X86DisassemblerDecoder.h:529</a></div></div>
<div class="ttc" id="X86DisassemblerDecoder_8c_html_a8514fc80a87b940b85536ef125c05350"><div class="ttname"><a href="X86DisassemblerDecoder_8c.html#a8514fc80a87b940b85536ef125c05350">readVVVV</a></div><div class="ttdeci">static int readVVVV(struct InternalInstruction *insn)</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8c_source.html#l01550">X86DisassemblerDecoder.c:1550</a></div></div>
<div class="ttc" id="X86DisassemblerDecoder_8h_html_a8dc9745657ce1382ca803e1e3e62a049"><div class="ttname"><a href="X86DisassemblerDecoder_8h.html#a8dc9745657ce1382ca803e1e3e62a049">vvvvFromVEX2of2</a></div><div class="ttdeci">#define vvvvFromVEX2of2(vex)</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00058">X86DisassemblerDecoder.h:58</a></div></div>
<div class="ttc" id="X86DisassemblerDecoderCommon_8h_html_a549ce06ad85d0726a93b2768ae7c7da7a43026c766e3f6ed1988064019cf4aa39"><div class="ttname"><a href="X86DisassemblerDecoderCommon_8h.html#a549ce06ad85d0726a93b2768ae7c7da7a43026c766e3f6ed1988064019cf4aa39">MODE_32BIT</a></div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoderCommon_8h_source.html#l00553">X86DisassemblerDecoderCommon.h:553</a></div></div>
<div class="ttc" id="structInternalInstruction_html_a54cc2f9d67046f0014ebd3347dff0515"><div class="ttname"><a href="structInternalInstruction.html#a54cc2f9d67046f0014ebd3347dff0515">InternalInstruction::readerArg</a></div><div class="ttdeci">const void * readerArg</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00515">X86DisassemblerDecoder.h:515</a></div></div>
<div class="ttc" id="X86DisassemblerDecoder_8h_html_a9f49754c886a53ae214267b3ec3ca263a4fda3836b35318bcdc0456e39a344dfc"><div class="ttname"><a href="X86DisassemblerDecoder_8h.html#a9f49754c886a53ae214267b3ec3ca263a4fda3836b35318bcdc0456e39a344dfc">XOP_MAP_SELECT_9</a></div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00461">X86DisassemblerDecoder.h:461</a></div></div>
<div class="ttc" id="structInternalInstruction_html_afdde304bf92d215347b53a72665a25de"><div class="ttname"><a href="structInternalInstruction.html#afdde304bf92d215347b53a72665a25de">InternalInstruction::consumedModRM</a></div><div class="ttdeci">BOOL consumedModRM</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00590">X86DisassemblerDecoder.h:590</a></div></div>
<div class="ttc" id="structInternalInstruction_html_a2c614fda371a4b9cd14cf06154458364"><div class="ttname"><a href="structInternalInstruction.html#a2c614fda371a4b9cd14cf06154458364">InternalInstruction::instructionID</a></div><div class="ttdeci">uint16_t instructionID</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00576">X86DisassemblerDecoder.h:576</a></div></div>
<div class="ttc" id="structInternalInstruction_html_a401714e4eb9715146c94275270515ba9"><div class="ttname"><a href="structInternalInstruction.html#a401714e4eb9715146c94275270515ba9">InternalInstruction::addressSize</a></div><div class="ttdeci">uint8_t addressSize</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00555">X86DisassemblerDecoder.h:555</a></div></div>
<div class="ttc" id="X86DisassemblerDecoder_8c_html_a553631909c27b5f8a94d65ebb13e73ae"><div class="ttname"><a href="X86DisassemblerDecoder_8c.html#a553631909c27b5f8a94d65ebb13e73ae">specifierForUID</a></div><div class="ttdeci">static const struct InstructionSpecifier * specifierForUID(InstrUID uid)</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8c_source.html#l00174">X86DisassemblerDecoder.c:174</a></div></div>
<div class="ttc" id="structInternalInstruction_html_a11653bcdad44439ab25047cc6dd589cf"><div class="ttname"><a href="structInternalInstruction.html#a11653bcdad44439ab25047cc6dd589cf">InternalInstruction::rexPrefix</a></div><div class="ttdeci">uint8_t rexPrefix</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00544">X86DisassemblerDecoder.h:544</a></div></div>
<div class="ttc" id="X86DisassemblerDecoder_8h_html_a546839a5c4bcf9f9450967155f48de41"><div class="ttname"><a href="X86DisassemblerDecoder_8h.html#a546839a5c4bcf9f9450967155f48de41">Reg</a></div><div class="ttdeci">Reg</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00428">X86DisassemblerDecoder.h:428</a></div></div>
<div class="ttc" id="structInternalInstruction_html_a7a1a3cdc79e40949b4466ad8af9608cf"><div class="ttname"><a href="structInternalInstruction.html#a7a1a3cdc79e40949b4466ad8af9608cf">InternalInstruction::prefixLocations</a></div><div class="ttdeci">uint64_t prefixLocations[0x100]</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00538">X86DisassemblerDecoder.h:538</a></div></div>
<div class="ttc" id="structInternalInstruction_html_a1d85c98f4456ef539774d603d4e15e0d"><div class="ttname"><a href="structInternalInstruction.html#a1d85c98f4456ef539774d603d4e15e0d">InternalInstruction::spec</a></div><div class="ttdeci">const struct InstructionSpecifier * spec</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00578">X86DisassemblerDecoder.h:578</a></div></div>
<div class="ttc" id="X86DisassemblerDecoderCommon_8h_html_a5f403e1e45149893b0ea54d8796cc921"><div class="ttname"><a href="X86DisassemblerDecoderCommon_8h.html#a5f403e1e45149893b0ea54d8796cc921">X86_MAX_OPERANDS</a></div><div class="ttdeci">#define X86_MAX_OPERANDS</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoderCommon_8h_source.html#l00532">X86DisassemblerDecoderCommon.h:532</a></div></div>
<div class="ttc" id="X86DisassemblerDecoder_8h_html"><div class="ttname"><a href="X86DisassemblerDecoder_8h.html">X86DisassemblerDecoder.h</a></div></div>
<div class="ttc" id="structContextDecision_html_a00eb4e91ed308eebd1667b5dce7c4b8b"><div class="ttname"><a href="structContextDecision.html#a00eb4e91ed308eebd1667b5dce7c4b8b">ContextDecision::opcodeDecisions</a></div><div class="ttdeci">struct OpcodeDecision opcodeDecisions[IC_max]</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoderCommon_8h_source.html#l00370">X86DisassemblerDecoderCommon.h:370</a></div></div>
<div class="ttc" id="structInternalInstruction_html_a0cde7d21e5b2cd6fb19a76ec86bbd92e"><div class="ttname"><a href="structInternalInstruction.html#a0cde7d21e5b2cd6fb19a76ec86bbd92e">InternalInstruction::prefixPresent</a></div><div class="ttdeci">uint8_t prefixPresent[0x100]</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00536">X86DisassemblerDecoder.h:536</a></div></div>
<div class="ttc" id="X86DisassemblerDecoder_8h_html_a27161ac001e2359fe24d92fc981e35a8a8a536cd1595533eb4dba530aa5571f29"><div class="ttname"><a href="X86DisassemblerDecoder_8h.html#a27161ac001e2359fe24d92fc981e35a8a8a536cd1595533eb4dba530aa5571f29">VEX_PREFIX_F3</a></div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00472">X86DisassemblerDecoder.h:472</a></div></div>
<div class="ttc" id="structInternalInstruction_html_a5b5e7cd9bb41153cfa4b6ea81e0d1b09"><div class="ttname"><a href="structInternalInstruction.html#a5b5e7cd9bb41153cfa4b6ea81e0d1b09">InternalInstruction::displacementSize</a></div><div class="ttdeci">uint8_t displacementSize</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00556">X86DisassemblerDecoder.h:556</a></div></div>
<div class="ttc" id="X86DisassemblerDecoder_8h_html_a4543a64655e2abfbf25bc206c9219150"><div class="ttname"><a href="X86DisassemblerDecoder_8h.html#a4543a64655e2abfbf25bc206c9219150">rFromVEX2of2</a></div><div class="ttdeci">#define rFromVEX2of2(vex)</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00057">X86DisassemblerDecoder.h:57</a></div></div>
<div class="ttc" id="X86DisassemblerDecoder_8c_html_ae354b93b59d4f78cddbb50869bd5ef6b"><div class="ttname"><a href="X86DisassemblerDecoder_8c.html#ae354b93b59d4f78cddbb50869bd5ef6b">readModRM</a></div><div class="ttdeci">static int readModRM(struct InternalInstruction *insn)</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8c_source.html#l01148">X86DisassemblerDecoder.c:1148</a></div></div>
<div class="ttc" id="X86DisassemblerDecoder_8c_html_a64e2c61de541dbe1de34d17fab03c656"><div class="ttname"><a href="X86DisassemblerDecoder_8c.html#a64e2c61de541dbe1de34d17fab03c656">isPrefixAtLocation</a></div><div class="ttdeci">static BOOL isPrefixAtLocation(struct InternalInstruction *insn, uint8_t prefix, uint64_t location)</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8c_source.html#l00299">X86DisassemblerDecoder.c:299</a></div></div>
<div class="ttc" id="structInternalInstruction_html_a3f995b5b0184a27404119e0038c515ab"><div class="ttname"><a href="structInternalInstruction.html#a3f995b5b0184a27404119e0038c515ab">InternalInstruction::dlogArg</a></div><div class="ttdeci">void * dlogArg</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00522">X86DisassemblerDecoder.h:522</a></div></div>
<div class="ttc" id="X86DisassemblerDecoder_8h_html_a6886436df5f38bbed7d036a5d8cb44bf"><div class="ttname"><a href="X86DisassemblerDecoder_8h.html#a6886436df5f38bbed7d036a5d8cb44bf">lFromVEX2of2</a></div><div class="ttdeci">#define lFromVEX2of2(vex)</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00059">X86DisassemblerDecoder.h:59</a></div></div>
<div class="ttc" id="X86DisassemblerDecoder_8c_html_a9a556ad6d7ad3eb7fe546bb644b2ba41"><div class="ttname"><a href="X86DisassemblerDecoder_8c.html#a9a556ad6d7ad3eb7fe546bb644b2ba41">GENERIC_FIXUP_FUNC</a></div><div class="ttdeci">#define GENERIC_FIXUP_FUNC(name, base, prefix)</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8c_source.html#l01280">X86DisassemblerDecoder.c:1280</a></div></div>
<div class="ttc" id="structOperandSpecifier_html"><div class="ttname"><a href="structOperandSpecifier.html">OperandSpecifier</a></div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoderCommon_8h_source.html#l00510">X86DisassemblerDecoderCommon.h:510</a></div></div>
<div class="ttc" id="X86DisassemblerDecoderCommon_8h_html_a549ce06ad85d0726a93b2768ae7c7da7"><div class="ttname"><a href="X86DisassemblerDecoderCommon_8h.html#a549ce06ad85d0726a93b2768ae7c7da7">DisassemblerMode</a></div><div class="ttdeci">DisassemblerMode</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoderCommon_8h_source.html#l00551">X86DisassemblerDecoderCommon.h:551</a></div></div>
<div class="ttc" id="structInternalInstruction_html_a4e8995824272b3ea6083c73aaf39e00d"><div class="ttname"><a href="structInternalInstruction.html#a4e8995824272b3ea6083c73aaf39e00d">InternalInstruction::modRM</a></div><div class="ttdeci">uint8_t modRM</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00591">X86DisassemblerDecoder.h:591</a></div></div>
<div class="ttc" id="X86DisassemblerDecoder_8c_html_aef1a8136ca4df8d11829c1aa2b708f5d"><div class="ttname"><a href="X86DisassemblerDecoder_8c.html#aef1a8136ca4df8d11829c1aa2b708f5d">readPrefixes</a></div><div class="ttdeci">static int readPrefixes(struct InternalInstruction *insn)</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8c_source.html#l00319">X86DisassemblerDecoder.c:319</a></div></div>
<div class="ttc" id="X86DisassemblerDecoder_8c_html_a17aad449cab97040952f09d23f56cac7"><div class="ttname"><a href="X86DisassemblerDecoder_8c.html#a17aad449cab97040952f09d23f56cac7">modRMRequired</a></div><div class="ttdeci">static int modRMRequired(OpcodeType type, InstructionContext insnContext, uint8_t opcode)</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8c_source.html#l00058">X86DisassemblerDecoder.c:58</a></div></div>
<div class="ttc" id="X86DisassemblerDecoder_8h_html_aa76783b724faa5f93e249184af820b9e"><div class="ttname"><a href="X86DisassemblerDecoder_8h.html#aa76783b724faa5f93e249184af820b9e">xFromXOP2of3</a></div><div class="ttdeci">#define xFromXOP2of3(xop)</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00063">X86DisassemblerDecoder.h:63</a></div></div>
<div class="ttc" id="namespacellvm_html_a69dc1b119f8cb95b7e36f586c5aeb372"><div class="ttname"><a href="namespacellvm.html#a69dc1b119f8cb95b7e36f586c5aeb372">llvm::format</a></div><div class="ttdeci">format_object1&lt; T &gt; format(const char *Fmt, const T &amp;Val)</div><div class="ttdef"><b>Definition:</b> <a href="Format_8h_source.html#l00180">Format.h:180</a></div></div>
<div class="ttc" id="X86DisassemblerDecoder_8c_html_a17dc51543779f7fc430239599234d9cf"><div class="ttname"><a href="X86DisassemblerDecoder_8c.html#a17dc51543779f7fc430239599234d9cf">CONSUME_FUNC</a></div><div class="ttdeci">#define CONSUME_FUNC(name, type)</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8c_source.html#l00212">X86DisassemblerDecoder.c:212</a></div></div>
<div class="ttc" id="structInternalInstruction_html_a309659fcf361a7ecf358ce2e879c82ee"><div class="ttname"><a href="structInternalInstruction.html#a309659fcf361a7ecf358ce2e879c82ee">InternalInstruction::numImmediatesConsumed</a></div><div class="ttdeci">uint8_t numImmediatesConsumed</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00602">X86DisassemblerDecoder.h:602</a></div></div>
<div class="ttc" id="X86DisassemblerDecoder_8c_html_a54c7d02e2f8a7db2f0025c5bcaef3a76"><div class="ttname"><a href="X86DisassemblerDecoder_8c.html#a54c7d02e2f8a7db2f0025c5bcaef3a76">setPrefixPresent</a></div><div class="ttdeci">static void setPrefixPresent(struct InternalInstruction *insn, uint8_t prefix, uint64_t location)</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8c_source.html#l00282">X86DisassemblerDecoder.c:282</a></div></div>
<div class="ttc" id="X86DisassemblerDecoder_8h_html_ad686b7233351c632a5403bb8880b2879a18e6eac10bc946b39abd1f7baa070f70"><div class="ttname"><a href="X86DisassemblerDecoder_8h.html#ad686b7233351c632a5403bb8880b2879a18e6eac10bc946b39abd1f7baa070f70">VEX_LOB_0F3A</a></div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00456">X86DisassemblerDecoder.h:456</a></div></div>
<div class="ttc" id="X86DisassemblerDecoderCommon_8h_html_a549ce06ad85d0726a93b2768ae7c7da7aeaebd8c1fe2b71a386838da0280c211c"><div class="ttname"><a href="X86DisassemblerDecoderCommon_8h.html#a549ce06ad85d0726a93b2768ae7c7da7aeaebd8c1fe2b71a386838da0280c211c">MODE_64BIT</a></div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoderCommon_8h_source.html#l00554">X86DisassemblerDecoderCommon.h:554</a></div></div>
<div class="ttc" id="namespacellvm_1_1Intrinsic_html_a73349916f7e54a6b988a3646c7a02e90ae857cbc5cf8c5a980f0bd245ad5ec61a"><div class="ttname"><a href="namespacellvm_1_1Intrinsic.html#a73349916f7e54a6b988a3646c7a02e90ae857cbc5cf8c5a980f0bd245ad5ec61a">llvm::Intrinsic::memset</a></div><div class="ttdef"><b>Definition:</b> <a href="Intrinsics_8h_source.html#l01262">Intrinsics.h:1262</a></div></div>
<div class="ttc" id="X86DisassemblerDecoder_8h_html_a86b3ea534df3a598db89d7d5ff581112a35eccd80af0540628e1fc528312392ac"><div class="ttname"><a href="X86DisassemblerDecoder_8h.html#a86b3ea534df3a598db89d7d5ff581112a35eccd80af0540628e1fc528312392ac">EA_DISP_16</a></div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00421">X86DisassemblerDecoder.h:421</a></div></div>
<div class="ttc" id="X86DisassemblerDecoder_8h_html_a9f49754c886a53ae214267b3ec3ca263a8416fd22a95920c95067eabe698579f2"><div class="ttname"><a href="X86DisassemblerDecoder_8h.html#a9f49754c886a53ae214267b3ec3ca263a8416fd22a95920c95067eabe698579f2">XOP_MAP_SELECT_8</a></div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00460">X86DisassemblerDecoder.h:460</a></div></div>
<div class="ttc" id="X86DisassemblerDecoder_8h_html_ac85472ee64d389babbd2c32deef16d89"><div class="ttname"><a href="X86DisassemblerDecoder_8h.html#ac85472ee64d389babbd2c32deef16d89">ppFromVEX3of3</a></div><div class="ttdeci">#define ppFromVEX3of3(vex)</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00055">X86DisassemblerDecoder.h:55</a></div></div>
<div class="ttc" id="README-SSE_8txt_html_ab25ce1a76d8c2513a49fc46d6edab095"><div class="ttname"><a href="README-SSE_8txt.html#ab25ce1a76d8c2513a49fc46d6edab095">byte</a></div><div class="ttdeci">SSE Variable shift can be custom lowered to something like which uses a small table unaligned load shuffle instead of going through memory byte</div><div class="ttdef"><b>Definition:</b> <a href="README-SSE_8txt_source.html#l00007">README-SSE.txt:7</a></div></div>
<div class="ttc" id="structInternalInstruction_html_a2353992733d9d87cede9036141b49003"><div class="ttname"><a href="structInternalInstruction.html#a2353992733d9d87cede9036141b49003">InternalInstruction::opcodeRegister</a></div><div class="ttdeci">Reg opcodeRegister</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00609">X86DisassemblerDecoder.h:609</a></div></div>
<div class="ttc" id="X86DisassemblerDecoder_8h_html_afc689603f1848ec33ddbac69b8aa1e95a546e3bf7a78bafabd50fbf842b0e87c5"><div class="ttname"><a href="X86DisassemblerDecoder_8h.html#afc689603f1848ec33ddbac69b8aa1e95a546e3bf7a78bafabd50fbf842b0e87c5">EA_BASE_NONE</a></div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00376">X86DisassemblerDecoder.h:376</a></div></div>
<div class="ttc" id="X86DisassemblerDecoder_8h_html_abbed9da0e0dde67954fe9e97f6befcc5"><div class="ttname"><a href="X86DisassemblerDecoder_8h.html#abbed9da0e0dde67954fe9e97f6befcc5">mmmmmFromXOP2of3</a></div><div class="ttdeci">#define mmmmmFromXOP2of3(xop)</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00065">X86DisassemblerDecoder.h:65</a></div></div>
<div class="ttc" id="structInternalInstruction_html_a8dd784f4a8eed89e5918a0abf254ed68"><div class="ttname"><a href="structInternalInstruction.html#a8dd784f4a8eed89e5918a0abf254ed68">InternalInstruction::registerSize</a></div><div class="ttdeci">uint8_t registerSize</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00554">X86DisassemblerDecoder.h:554</a></div></div>
<div class="ttc" id="X86DisassemblerDecoder_8h_html_a9b5608175fb4bc57fd5e6bcd7f5efed2"><div class="ttname"><a href="X86DisassemblerDecoder_8h.html#a9b5608175fb4bc57fd5e6bcd7f5efed2">vvvvFromVEX3of3</a></div><div class="ttdeci">#define vvvvFromVEX3of3(vex)</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00053">X86DisassemblerDecoder.h:53</a></div></div>
<div class="ttc" id="structInternalInstruction_html_aa97e986ba10ca73e59e7fc87805e45d6"><div class="ttname"><a href="structInternalInstruction.html#aa97e986ba10ca73e59e7fc87805e45d6">InternalInstruction::vexXopType</a></div><div class="ttdeci">VEXXOPType vexXopType</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00542">X86DisassemblerDecoder.h:542</a></div></div>
<div class="ttc" id="structInternalInstruction_html_aa88adec45f0f554d53e34401e24cde8d"><div class="ttname"><a href="structInternalInstruction.html#aa88adec45f0f554d53e34401e24cde8d">InternalInstruction::sibScale</a></div><div class="ttdeci">uint8_t sibScale</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00628">X86DisassemblerDecoder.h:628</a></div></div>
<div class="ttc" id="structInternalInstruction_html_a0f0d4f1135621b45a79af03c3ad02bf4"><div class="ttname"><a href="structInternalInstruction.html#a0f0d4f1135621b45a79af03c3ad02bf4">InternalInstruction::vvvv</a></div><div class="ttdeci">Reg vvvv</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00586">X86DisassemblerDecoder.h:586</a></div></div>
<div class="ttc" id="Target_2README_8txt_html_a2352e45658fc7292aa209a94baa095e9"><div class="ttname"><a href="Target_2README_8txt.html#a2352e45658fc7292aa209a94baa095e9">x86</a></div><div class="ttdeci">Note that only the low bits of effective_addr2 are used On bit we don t eliminate the computation of the top half of effective_addr2 because we don t have whole function selection dags On x86</div><div class="ttdef"><b>Definition:</b> <a href="Target_2README_8txt_source.html#l00354">Target/README.txt:354</a></div></div>
<div class="ttc" id="README-SSE_8txt_html_a11ca92463dc5dfc09bbe2ba2f3ea0c96"><div class="ttname"><a href="README-SSE_8txt.html#a11ca92463dc5dfc09bbe2ba2f3ea0c96">x3</a></div><div class="ttdeci">In x86 we generate this spiffy xmm0 xmm0 ret in x86 we generate this which could be xmm1 movss xmm1 xmm0 ret In sse4 we could use insertps to make both better Here s another testcase that could use x3</div><div class="ttdef"><b>Definition:</b> <a href="README-SSE_8txt_source.html#l00562">README-SSE.txt:562</a></div></div>
<div class="ttc" id="X86DisassemblerDecoder_8h_html_a2af8cf971611d096b00b34eece806adba3d035927a65ed81a8869a3f64f669bd0"><div class="ttname"><a href="X86DisassemblerDecoder_8h.html#a2af8cf971611d096b00b34eece806adba3d035927a65ed81a8869a3f64f669bd0">SIB_INDEX_NONE</a></div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00393">X86DisassemblerDecoder.h:393</a></div></div>
<div class="ttc" id="Target_2X86_2README_8txt_html_a8ef54f27fddd11cc461b2b231fc2d23c"><div class="ttname"><a href="Target_2X86_2README_8txt.html#a8ef54f27fddd11cc461b2b231fc2d23c">ret</a></div><div class="ttdeci">to esp esp setne al movzbw ax esp setg cl movzbw cx cmove cx cl jne LBB1_2 esp ret(also really horrible code on ppc).This is due to the expand code for 64-bit compares.GCC produces multiple branches</div></div>
<div class="ttc" id="X86DisassemblerDecoder_8h_html_a86b3ea534df3a598db89d7d5ff581112a8c6d89c83a80d627b41123cb4efd3959"><div class="ttname"><a href="X86DisassemblerDecoder_8h.html#a86b3ea534df3a598db89d7d5ff581112a8c6d89c83a80d627b41123cb4efd3959">EA_DISP_8</a></div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00420">X86DisassemblerDecoder.h:420</a></div></div>
<div class="ttc" id="structModRMDecision_html_a6c4ec8014e5927c67c5a0c9f0b9315aa"><div class="ttname"><a href="structModRMDecision.html#a6c4ec8014e5927c67c5a0c9f0b9315aa">ModRMDecision::modrm_type</a></div><div class="ttdeci">uint8_t modrm_type</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoderCommon_8h_source.html#l00348">X86DisassemblerDecoderCommon.h:348</a></div></div>
<div class="ttc" id="X86DisassemblerDecoder_8h_html_a2af8cf971611d096b00b34eece806adb"><div class="ttname"><a href="X86DisassemblerDecoder_8h.html#a2af8cf971611d096b00b34eece806adb">SIBIndex</a></div><div class="ttdeci">SIBIndex</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00392">X86DisassemblerDecoder.h:392</a></div></div>
<div class="ttc" id="X86DisassemblerDecoder_8c_html_a771c0394a5e25fb07aaca2764eff8370"><div class="ttname"><a href="X86DisassemblerDecoder_8c.html#a771c0394a5e25fb07aaca2764eff8370">readImmediate</a></div><div class="ttdeci">static int readImmediate(struct InternalInstruction *insn, uint8_t size)</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8c_source.html#l01496">X86DisassemblerDecoder.c:1496</a></div></div>
<div class="ttc" id="namespacellvm_1_1LibFunc_html_abf8f6830387f338fed0bce2e65108c6fa889127ff256afb5d8130cabd90aadd4b"><div class="ttname"><a href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fa889127ff256afb5d8130cabd90aadd4b">llvm::LibFunc::vsnprintf</a></div><div class="ttdoc">int vsnprintf(char *s, size_t n, const char *format, va_list ap); </div><div class="ttdef"><b>Definition:</b> <a href="TargetLibraryInfo_8h_source.html#l00642">TargetLibraryInfo.h:642</a></div></div>
<div class="ttc" id="README-Thumb_8txt_html_ad7bf7cc723b97ab4a518502c217ddbd7"><div class="ttname"><a href="README-Thumb_8txt.html#ad7bf7cc723b97ab4a518502c217ddbd7">mode</a></div><div class="ttdeci">*Add support for compiling functions in both ARM and Thumb mode</div><div class="ttdef"><b>Definition:</b> <a href="README-Thumb_8txt_source.html#l00005">README-Thumb.txt:5</a></div></div>
<div class="ttc" id="X86DisassemblerDecoder_8h_html_ad2f8ed01c1733d4eab0932d970abaa4c"><div class="ttname"><a href="X86DisassemblerDecoder_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a></div><div class="ttdeci">uint8_t BOOL</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00483">X86DisassemblerDecoder.h:483</a></div></div>
<div class="ttc" id="X86DisassemblerDecoder_8c_html_a6c7cca3d994492926e7a3108baddbad6"><div class="ttname"><a href="X86DisassemblerDecoder_8c.html#a6c7cca3d994492926e7a3108baddbad6">is16BitEquivalent</a></div><div class="ttdeci">static BOOL is16BitEquivalent(const char *orig, const char *equiv)</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8c_source.html#l00799">X86DisassemblerDecoder.c:799</a></div></div>
<div class="ttc" id="X86DisassemblerDecoder_8c_html_ac92411447d53b3ccecf5a40f736650cc"><div class="ttname"><a href="X86DisassemblerDecoder_8c.html#ac92411447d53b3ccecf5a40f736650cc">dbgprintf</a></div><div class="ttdeci">static void dbgprintf(struct InternalInstruction *insn, const char *format,...)</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8c_source.html#l00255">X86DisassemblerDecoder.c:255</a></div></div>
<div class="ttc" id="X86DisassemblerDecoder_8h_html_ad686b7233351c632a5403bb8880b2879a9a40a4486721b709051aa03918e50241"><div class="ttname"><a href="X86DisassemblerDecoder_8h.html#ad686b7233351c632a5403bb8880b2879a9a40a4486721b709051aa03918e50241">VEX_LOB_0F</a></div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00454">X86DisassemblerDecoder.h:454</a></div></div>
<div class="ttc" id="X86DisassemblerDecoder_8c_html_a1c693d3ea8868f36b5b192d0315cac04"><div class="ttname"><a href="X86DisassemblerDecoder_8c.html#a1c693d3ea8868f36b5b192d0315cac04">consumeByte</a></div><div class="ttdeci">static int consumeByte(struct InternalInstruction *insn, uint8_t *byte)</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8c_source.html#l00188">X86DisassemblerDecoder.c:188</a></div></div>
<div class="ttc" id="structInternalInstruction_html_aed6c81f3fa45d9098d16fca6a75334b6"><div class="ttname"><a href="structInternalInstruction.html#aed6c81f3fa45d9098d16fca6a75334b6">InternalInstruction::operands</a></div><div class="ttdeci">const struct OperandSpecifier * operands</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00631">X86DisassemblerDecoder.h:631</a></div></div>
<div class="ttc" id="structInternalInstruction_html_a0e7bbab87ac33b62bb1d9cad65c77a68"><div class="ttname"><a href="structInternalInstruction.html#a0e7bbab87ac33b62bb1d9cad65c77a68">InternalInstruction::opcodeType</a></div><div class="ttdeci">OpcodeType opcodeType</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00574">X86DisassemblerDecoder.h:574</a></div></div>
<div class="ttc" id="X86DisassemblerDecoder_8h_html_a215ec2d9ebe8a9be78a3cd8eabaeed71"><div class="ttname"><a href="X86DisassemblerDecoder_8h.html#a215ec2d9ebe8a9be78a3cd8eabaeed71">bFromXOP2of3</a></div><div class="ttdeci">#define bFromXOP2of3(xop)</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00064">X86DisassemblerDecoder.h:64</a></div></div>
<div class="ttc" id="X86DisassemblerDecoder_8h_html_a439f21b8d5ea58ea5fe17d11d1547986"><div class="ttname"><a href="X86DisassemblerDecoder_8h.html#a439f21b8d5ea58ea5fe17d11d1547986">baseFromSIB</a></div><div class="ttdeci">#define baseFromSIB(sib)</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00042">X86DisassemblerDecoder.h:42</a></div></div>
<div class="ttc" id="structInstructionSpecifier_html"><div class="ttname"><a href="structInstructionSpecifier.html">InstructionSpecifier</a></div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoderCommon_8h_source.html#l00538">X86DisassemblerDecoderCommon.h:538</a></div></div>
<div class="ttc" id="X86DisassemblerDecoder_8h_html_a678cc792a7ece4943c203fd18e57ad46a975c840f7f5d04685ac87840b9f66429"><div class="ttname"><a href="X86DisassemblerDecoder_8h.html#a678cc792a7ece4943c203fd18e57ad46a975c840f7f5d04685ac87840b9f66429">SEG_OVERRIDE_GS</a></div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00445">X86DisassemblerDecoder.h:445</a></div></div>
<div class="ttc" id="structInstructionSpecifier_html_a57b4276f710b106cc8b5bc27d0096fac"><div class="ttname"><a href="structInstructionSpecifier.html#a57b4276f710b106cc8b5bc27d0096fac">InstructionSpecifier::modifierType</a></div><div class="ttdeci">uint8_t modifierType</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoderCommon_8h_source.html#l00539">X86DisassemblerDecoderCommon.h:539</a></div></div>
<div class="ttc" id="X86DisassemblerDecoder_8c_html_a35319d994370e141dced971952e7e6f5"><div class="ttname"><a href="X86DisassemblerDecoder_8c.html#a35319d994370e141dced971952e7e6f5">contextForAttrs</a></div><div class="ttdeci">static InstructionContext contextForAttrs(uint8_t attrMask)</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8c_source.html#l00043">X86DisassemblerDecoder.c:43</a></div></div>
<div class="ttc" id="X86DisassemblerDecoder_8h_html_a567f29a688d316f9d1e149753d4d77da"><div class="ttname"><a href="X86DisassemblerDecoder_8h.html#a567f29a688d316f9d1e149753d4d77da">wFromREX</a></div><div class="ttdeci">#define wFromREX(rex)</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00043">X86DisassemblerDecoder.h:43</a></div></div>
<div class="ttc" id="X86DisassemblerDecoder_8c_html_ab536506d0058cd6baa803890e9d648dd"><div class="ttname"><a href="X86DisassemblerDecoder_8c.html#ab536506d0058cd6baa803890e9d648dd">readOpcodeRegister</a></div><div class="ttdeci">static int readOpcodeRegister(struct InternalInstruction *insn, uint8_t size)</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8c_source.html#l01446">X86DisassemblerDecoder.c:1446</a></div></div>
<div class="ttc" id="X86DisassemblerDecoder_8h_html_ad0acf3022faa5f882e157cc76eca34d9a7b6ca8597d8e43fd94666f6d722d6c43"><div class="ttname"><a href="X86DisassemblerDecoder_8h.html#ad0acf3022faa5f882e157cc76eca34d9a7b6ca8597d8e43fd94666f6d722d6c43">TYPE_XOP</a></div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00480">X86DisassemblerDecoder.h:480</a></div></div>
<div class="ttc" id="structInternalInstruction_html_abb52adf9696c6d65eb3ac1f202b7b0a3"><div class="ttname"><a href="structInternalInstruction.html#abb52adf9696c6d65eb3ac1f202b7b0a3">InternalInstruction::reader</a></div><div class="ttdeci">byteReader_t reader</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00513">X86DisassemblerDecoder.h:513</a></div></div>
<div class="ttc" id="X86DisassemblerDecoder_8h_html_abf2fe87228fa8c1419f2a5f86baaa597"><div class="ttname"><a href="X86DisassemblerDecoder_8h.html#abf2fe87228fa8c1419f2a5f86baaa597">lFromVEX3of3</a></div><div class="ttdeci">#define lFromVEX3of3(vex)</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00054">X86DisassemblerDecoder.h:54</a></div></div>
<div class="ttc" id="X86DisassemblerDecoder_8h_html_adba38d038bb20114ef792961068aebd9"><div class="ttname"><a href="X86DisassemblerDecoder_8h.html#adba38d038bb20114ef792961068aebd9">ppFromVEX2of2</a></div><div class="ttdeci">#define ppFromVEX2of2(vex)</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00060">X86DisassemblerDecoder.h:60</a></div></div>
<div class="ttc" id="Target_2LLVMBuild_8txt_html_ac6653103ff5a7ab01c54613c5a0e5b2d"><div class="ttname"><a href="Target_2LLVMBuild_8txt.html#ac6653103ff5a7ab01c54613c5a0e5b2d">type</a></div><div class="ttdeci">with the configured native if any[component_1] type</div><div class="ttdef"><b>Definition:</b> <a href="Target_2LLVMBuild_8txt_source.html#l00032">Target/LLVMBuild.txt:32</a></div></div>
<div class="ttc" id="README__ALTIVEC_8txt_html_a98586ea01a32ff5046b0868b036a1849"><div class="ttname"><a href="README__ALTIVEC_8txt.html#a98586ea01a32ff5046b0868b036a1849">index</a></div><div class="ttdeci">splat index</div><div class="ttdef"><b>Definition:</b> <a href="README__ALTIVEC_8txt_source.html#l00186">README_ALTIVEC.txt:186</a></div></div>
<div class="ttc" id="structInternalInstruction_html_a5d37fbfabfbb9dcb1cb7e72adc593478"><div class="ttname"><a href="structInternalInstruction.html#a5d37fbfabfbb9dcb1cb7e72adc593478">InternalInstruction::eaRegBase</a></div><div class="ttdeci">EABase eaRegBase</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00616">X86DisassemblerDecoder.h:616</a></div></div>
<div class="ttc" id="structInternalInstruction_html_a309eb7e0aad285e543bf18e55948bb5e"><div class="ttname"><a href="structInternalInstruction.html#a309eb7e0aad285e543bf18e55948bb5e">InternalInstruction::displacement</a></div><div class="ttdeci">int32_t displacement</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00599">X86DisassemblerDecoder.h:599</a></div></div>
<div class="ttc" id="X86DisassemblerDecoderCommon_8h_html_a6a9bb5a76c1dd6a02bb96ef407a6cb7d"><div class="ttname"><a href="X86DisassemblerDecoderCommon_8h.html#a6a9bb5a76c1dd6a02bb96ef407a6cb7d">THREEBYTE3A_SYM</a></div><div class="ttdeci">#define THREEBYTE3A_SYM</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoderCommon_8h_source.html#l00032">X86DisassemblerDecoderCommon.h:32</a></div></div>
<div class="ttc" id="X86DisassemblerDecoder_8h_html_afc689603f1848ec33ddbac69b8aa1e95"><div class="ttname"><a href="X86DisassemblerDecoder_8h.html#afc689603f1848ec33ddbac69b8aa1e95">EABase</a></div><div class="ttdeci">EABase</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00375">X86DisassemblerDecoder.h:375</a></div></div>
<div class="ttc" id="X86DisassemblerDecoder_8c_html_a42be988af3ae0e352befa7189bd50936"><div class="ttname"><a href="X86DisassemblerDecoder_8c.html#a42be988af3ae0e352befa7189bd50936">readOperands</a></div><div class="ttdeci">static int readOperands(struct InternalInstruction *insn)</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8c_source.html#l01575">X86DisassemblerDecoder.c:1575</a></div></div>
<div class="ttc" id="X86DisassemblerDecoderCommon_8h_html_a5cc171c21d0532e0f6353e972f1ff621a6383f0e83ff34dfa506e53e9b7b3edcd"><div class="ttname"><a href="X86DisassemblerDecoderCommon_8h.html#a5cc171c21d0532e0f6353e972f1ff621a6383f0e83ff34dfa506e53e9b7b3edcd">XOP8_MAP</a></div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoderCommon_8h_source.html#l00292">X86DisassemblerDecoderCommon.h:292</a></div></div>
<div class="ttc" id="X86DisassemblerDecoderCommon_8h_html_ae053f9e80d644f47a6ee19185739162b"><div class="ttname"><a href="X86DisassemblerDecoderCommon_8h.html#ae053f9e80d644f47a6ee19185739162b">ONEBYTE_SYM</a></div><div class="ttdeci">#define ONEBYTE_SYM</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoderCommon_8h_source.html#l00029">X86DisassemblerDecoderCommon.h:29</a></div></div>
<div class="ttc" id="X86DisassemblerDecoder_8h_html_a63266a63baf54bef487061a728d12908"><div class="ttname"><a href="X86DisassemblerDecoder_8h.html#a63266a63baf54bef487061a728d12908">lFromXOP3of3</a></div><div class="ttdeci">#define lFromXOP3of3(xop)</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00068">X86DisassemblerDecoder.h:68</a></div></div>
<div class="ttc" id="X86DisassemblerDecoderCommon_8h_html_a248490f08a4ffb48599b9d03dcbe50c1"><div class="ttname"><a href="X86DisassemblerDecoderCommon_8h.html#a248490f08a4ffb48599b9d03dcbe50c1">THREEBYTEA7_SYM</a></div><div class="ttdeci">#define THREEBYTEA7_SYM</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoderCommon_8h_source.html#l00034">X86DisassemblerDecoderCommon.h:34</a></div></div>
<div class="ttc" id="X86DisassemblerDecoderCommon_8h_html_a5cc171c21d0532e0f6353e972f1ff621a339165d45a0200fd88efae325ac01b10"><div class="ttname"><a href="X86DisassemblerDecoderCommon_8h.html#a5cc171c21d0532e0f6353e972f1ff621a339165d45a0200fd88efae325ac01b10">TWOBYTE</a></div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoderCommon_8h_source.html#l00287">X86DisassemblerDecoderCommon.h:287</a></div></div>
<div class="ttc" id="X86DisassemblerDecoder_8h_html_af112ae874f4cca98ba15a30f5743e5e1"><div class="ttname"><a href="X86DisassemblerDecoder_8h.html#af112ae874f4cca98ba15a30f5743e5e1">bFromREX</a></div><div class="ttdeci">#define bFromREX(rex)</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00046">X86DisassemblerDecoder.h:46</a></div></div>
<div class="ttc" id="X86DisassemblerDecoder_8h_html_a30e003e4461758b6dba2c70f339ed6c3"><div class="ttname"><a href="X86DisassemblerDecoder_8h.html#a30e003e4461758b6dba2c70f339ed6c3">mmmmmFromVEX2of3</a></div><div class="ttdeci">#define mmmmmFromVEX2of3(vex)</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00051">X86DisassemblerDecoder.h:51</a></div></div>
<div class="ttc" id="X86DisassemblerDecoder_8c_html_a2eb1d47fec594e1eadf21c835a0ce517"><div class="ttname"><a href="X86DisassemblerDecoder_8c.html#a2eb1d47fec594e1eadf21c835a0ce517">readOpcodeModifier</a></div><div class="ttdeci">static int readOpcodeModifier(struct InternalInstruction *insn)</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8c_source.html#l01411">X86DisassemblerDecoder.c:1411</a></div></div>
<div class="ttc" id="X86DisassemblerDecoder_8h_html_a7b5f49eafdca9d6be0464fccb94a4f33"><div class="ttname"><a href="X86DisassemblerDecoder_8h.html#a7b5f49eafdca9d6be0464fccb94a4f33">scaleFromSIB</a></div><div class="ttdeci">#define scaleFromSIB(sib)</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00040">X86DisassemblerDecoder.h:40</a></div></div>
<div class="ttc" id="Target_2README_8txt_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">i</div><div class="ttdef"><b>Definition:</b> <a href="Target_2README_8txt_source.html#l00029">Target/README.txt:29</a></div></div>
<div class="ttc" id="X86DisassemblerDecoder_8h_html_ad686b7233351c632a5403bb8880b2879af71a9e484b7632521ba492c4027978b4"><div class="ttname"><a href="X86DisassemblerDecoder_8h.html#ad686b7233351c632a5403bb8880b2879af71a9e484b7632521ba492c4027978b4">VEX_LOB_0F38</a></div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00455">X86DisassemblerDecoder.h:455</a></div></div>
<div class="ttc" id="X86DisassemblerDecoder_8h_html_a2702d55c4b2a40989bd2b9cc8a71596e"><div class="ttname"><a href="X86DisassemblerDecoder_8h.html#a2702d55c4b2a40989bd2b9cc8a71596e">xFromVEX2of3</a></div><div class="ttdeci">#define xFromVEX2of3(vex)</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00049">X86DisassemblerDecoder.h:49</a></div></div>
<div class="ttc" id="X86DisassemblerDecoder_8h_html_a5297b8410eeadfd658404a6cf3958c07"><div class="ttname"><a href="X86DisassemblerDecoder_8h.html#a5297b8410eeadfd658404a6cf3958c07">rFromXOP2of3</a></div><div class="ttdeci">#define rFromXOP2of3(xop)</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00062">X86DisassemblerDecoder.h:62</a></div></div>
<div class="ttc" id="X86DisassemblerDecoderCommon_8h_html_a5cc171c21d0532e0f6353e972f1ff621a26952e7ac04ca61b0c1029cb7a656518"><div class="ttname"><a href="X86DisassemblerDecoderCommon_8h.html#a5cc171c21d0532e0f6353e972f1ff621a26952e7ac04ca61b0c1029cb7a656518">THREEBYTE_A6</a></div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoderCommon_8h_source.html#l00290">X86DisassemblerDecoderCommon.h:290</a></div></div>
<div class="ttc" id="X86DisassemblerDecoder_8c_html_a3940644102a488fdce81b36d054bbee3"><div class="ttname"><a href="X86DisassemblerDecoder_8c.html#a3940644102a488fdce81b36d054bbee3">getID</a></div><div class="ttdeci">static int getID(struct InternalInstruction *insn, const void *miiArg)</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8c_source.html#l00828">X86DisassemblerDecoder.c:828</a></div></div>
<div class="ttc" id="X86DisassemblerDecoderCommon_8h_html_aa4b9b8291a90b1a586c468110fb346a4"><div class="ttname"><a href="X86DisassemblerDecoderCommon_8h.html#aa4b9b8291a90b1a586c468110fb346a4">OperandType</a></div><div class="ttdeci">OperandType</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoderCommon_8h_source.html#l00500">X86DisassemblerDecoderCommon.h:500</a></div></div>
<div class="ttc" id="X86DisassemblerDecoderCommon_8h_html_a62a3fc430e98f080dc7e39325d2b9e54"><div class="ttname"><a href="X86DisassemblerDecoderCommon_8h.html#a62a3fc430e98f080dc7e39325d2b9e54">INSTRUCTIONS_SYM</a></div><div class="ttdeci">#define INSTRUCTIONS_SYM</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoderCommon_8h_source.html#l00027">X86DisassemblerDecoderCommon.h:27</a></div></div>
<div class="ttc" id="X86DisassemblerDecoderCommon_8h_html_a892daf9647ea098765cb833eb8596234"><div class="ttname"><a href="X86DisassemblerDecoderCommon_8h.html#a892daf9647ea098765cb833eb8596234">THREEBYTE38_SYM</a></div><div class="ttdeci">#define THREEBYTE38_SYM</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoderCommon_8h_source.html#l00031">X86DisassemblerDecoderCommon.h:31</a></div></div>
<div class="ttc" id="X86DisassemblerDecoderCommon_8h_html_a0bfb472dc63adf5ea8919f054d4450e2"><div class="ttname"><a href="X86DisassemblerDecoderCommon_8h.html#a0bfb472dc63adf5ea8919f054d4450e2">TWOBYTE_SYM</a></div><div class="ttdeci">#define TWOBYTE_SYM</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoderCommon_8h_source.html#l00030">X86DisassemblerDecoderCommon.h:30</a></div></div>
<div class="ttc" id="structOpcodeDecision_html_a0cb23951ba8df6cb979bbbb35d4a83f1"><div class="ttname"><a href="structOpcodeDecision.html#a0cb23951ba8df6cb979bbbb35d4a83f1">OpcodeDecision::modRMDecisions</a></div><div class="ttdeci">struct ModRMDecision modRMDecisions[256]</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoderCommon_8h_source.html#l00359">X86DisassemblerDecoderCommon.h:359</a></div></div>
<div class="ttc" id="X86DisassemblerDecoder_8h_html_a27161ac001e2359fe24d92fc981e35a8a5f3db606eb177e16ca6cfcb1f5ae0e65"><div class="ttname"><a href="X86DisassemblerDecoder_8h.html#a27161ac001e2359fe24d92fc981e35a8a5f3db606eb177e16ca6cfcb1f5ae0e65">VEX_PREFIX_66</a></div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00471">X86DisassemblerDecoder.h:471</a></div></div>
<div class="ttc" id="X86DisassemblerDecoder_8c_html_ae0228f36529f75f692753ef96d725012"><div class="ttname"><a href="X86DisassemblerDecoder_8c.html#ae0228f36529f75f692753ef96d725012">debug</a></div><div class="ttdeci">#define debug(s)</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8c_source.html#l00029">X86DisassemblerDecoder.c:29</a></div></div>
<div class="ttc" id="structInternalInstruction_html"><div class="ttname"><a href="structInternalInstruction.html">InternalInstruction</a></div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00511">X86DisassemblerDecoder.h:511</a></div></div>
<div class="ttc" id="structInternalInstruction_html_ab5314a93238a56e68a1c9d79bec379fd"><div class="ttname"><a href="structInternalInstruction.html#ab5314a93238a56e68a1c9d79bec379fd">InternalInstruction::immediates</a></div><div class="ttdeci">uint64_t immediates[2]</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00604">X86DisassemblerDecoder.h:604</a></div></div>
<div class="ttc" id="X86DisassemblerDecoder_8h_html_a678cc792a7ece4943c203fd18e57ad46a7ae1d102e8d3480f4ea83cc393fa2c76"><div class="ttname"><a href="X86DisassemblerDecoder_8h.html#a678cc792a7ece4943c203fd18e57ad46a7ae1d102e8d3480f4ea83cc393fa2c76">SEG_OVERRIDE_CS</a></div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00440">X86DisassemblerDecoder.h:440</a></div></div>
<div class="ttc" id="X86DisassemblerDecoder_8c_html_a76aa63a8eadc46ca3124cc907e841dbb"><div class="ttname"><a href="X86DisassemblerDecoder_8c.html#a76aa63a8eadc46ca3124cc907e841dbb">unconsumeByte</a></div><div class="ttdeci">static void unconsumeByte(struct InternalInstruction *insn)</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8c_source.html#l00208">X86DisassemblerDecoder.c:208</a></div></div>
<div class="ttc" id="structInstructionSpecifier_html_a118cd668b413e8d794ff37f7539e8303"><div class="ttname"><a href="structInstructionSpecifier.html#a118cd668b413e8d794ff37f7539e8303">InstructionSpecifier::modifierBase</a></div><div class="ttdeci">uint8_t modifierBase</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoderCommon_8h_source.html#l00540">X86DisassemblerDecoderCommon.h:540</a></div></div>
<div class="ttc" id="X86DisassemblerDecoder_8c_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="X86DisassemblerDecoder_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8c_source.html#l00025">X86DisassemblerDecoder.c:25</a></div></div>
<div class="ttc" id="X86DisassemblerDecoder_8c_html_ab3686bdd912c0d40035aa66dcffb36da"><div class="ttname"><a href="X86DisassemblerDecoder_8c.html#ab3686bdd912c0d40035aa66dcffb36da">decode</a></div><div class="ttdeci">static InstrUID decode(OpcodeType type, InstructionContext insnContext, uint8_t opcode, uint8_t modRM)</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8c_source.html#l00107">X86DisassemblerDecoder.c:107</a></div></div>
<div class="ttc" id="X86DisassemblerDecoderCommon_8h_html_a5cc171c21d0532e0f6353e972f1ff621a703a4841d8c5722f1f7b0c887beca64e"><div class="ttname"><a href="X86DisassemblerDecoderCommon_8h.html#a5cc171c21d0532e0f6353e972f1ff621a703a4841d8c5722f1f7b0c887beca64e">ONEBYTE</a></div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoderCommon_8h_source.html#l00286">X86DisassemblerDecoderCommon.h:286</a></div></div>
<div class="ttc" id="X86DisassemblerDecoder_8h_html_a678cc792a7ece4943c203fd18e57ad46aa625e0d1316f604a7d38d4ca46a54ceb"><div class="ttname"><a href="X86DisassemblerDecoder_8h.html#a678cc792a7ece4943c203fd18e57ad46aa625e0d1316f604a7d38d4ca46a54ceb">SEG_OVERRIDE_SS</a></div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00441">X86DisassemblerDecoder.h:441</a></div></div>
<div class="ttc" id="X86DisassemblerDecoder_8h_html_a27161ac001e2359fe24d92fc981e35a8a901c8f1034e86a24a18818ebb74d7733"><div class="ttname"><a href="X86DisassemblerDecoder_8h.html#a27161ac001e2359fe24d92fc981e35a8a901c8f1034e86a24a18818ebb74d7733">VEX_PREFIX_F2</a></div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00473">X86DisassemblerDecoder.h:473</a></div></div>
<div class="ttc" id="X86DisassemblerDecoder_8h_html_a678cc792a7ece4943c203fd18e57ad46ac748043f7a0a000924982b9d1864e4fe"><div class="ttname"><a href="X86DisassemblerDecoder_8h.html#a678cc792a7ece4943c203fd18e57ad46ac748043f7a0a000924982b9d1864e4fe">SEG_OVERRIDE_FS</a></div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00444">X86DisassemblerDecoder.h:444</a></div></div>
<div class="ttc" id="structInternalInstruction_html_a8453ecd76a6e0ab31a8c2218a1ba110b"><div class="ttname"><a href="structInternalInstruction.html#a8453ecd76a6e0ab31a8c2218a1ba110b">InternalInstruction::dlog</a></div><div class="ttdeci">dlog_t dlog</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00520">X86DisassemblerDecoder.h:520</a></div></div>
<div class="ttc" id="X86DisassemblerDecoder_8h_html_ab11339ee1e5b8aaa4a706693c51041ae"><div class="ttname"><a href="X86DisassemblerDecoder_8h.html#ab11339ee1e5b8aaa4a706693c51041ae">wFromVEX3of3</a></div><div class="ttdeci">#define wFromVEX3of3(vex)</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00052">X86DisassemblerDecoder.h:52</a></div></div>
<div class="ttc" id="X86DisassemblerDecoder_8h_html_aea420e27120dd9f790849c9090b42256"><div class="ttname"><a href="X86DisassemblerDecoder_8h.html#aea420e27120dd9f790849c9090b42256">wFromXOP3of3</a></div><div class="ttdeci">#define wFromXOP3of3(xop)</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00066">X86DisassemblerDecoder.h:66</a></div></div>
<div class="ttc" id="X86DisassemblerDecoderCommon_8h_html_a5cc171c21d0532e0f6353e972f1ff621ac673abd123c1e32fa09f13b8d89af428"><div class="ttname"><a href="X86DisassemblerDecoderCommon_8h.html#a5cc171c21d0532e0f6353e972f1ff621ac673abd123c1e32fa09f13b8d89af428">THREEBYTE_3A</a></div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoderCommon_8h_source.html#l00289">X86DisassemblerDecoderCommon.h:289</a></div></div>
<div class="ttc" id="X86DisassemblerDecoderCommon_8h_html_a8ee4ef62ace14145044f3ab99fa2a8fa"><div class="ttname"><a href="X86DisassemblerDecoderCommon_8h.html#a8ee4ef62ace14145044f3ab99fa2a8fa">InstructionContext</a></div><div class="ttdeci">InstructionContext</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoderCommon_8h_source.html#l00275">X86DisassemblerDecoderCommon.h:275</a></div></div>
<div class="ttc" id="structInternalInstruction_html_a3bbafa345f93ec20312858606ce8983a"><div class="ttname"><a href="structInternalInstruction.html#a3bbafa345f93ec20312858606ce8983a">InternalInstruction::immediateSize</a></div><div class="ttdeci">uint8_t immediateSize</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00557">X86DisassemblerDecoder.h:557</a></div></div>
<div class="ttc" id="structInternalInstruction_html_aecf82cd305a89d85270619af42a0b81e"><div class="ttname"><a href="structInternalInstruction.html#aecf82cd305a89d85270619af42a0b81e">InternalInstruction::sibBase</a></div><div class="ttdeci">SIBBase sibBase</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00629">X86DisassemblerDecoder.h:629</a></div></div>
<div class="ttc" id="structInternalInstruction_html_a15f66c4fc5e09ff60f592a643f68eab3"><div class="ttname"><a href="structInternalInstruction.html#a15f66c4fc5e09ff60f592a643f68eab3">InternalInstruction::eaDisplacement</a></div><div class="ttdeci">EADisplacement eaDisplacement</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00622">X86DisassemblerDecoder.h:622</a></div></div>
<div class="ttc" id="X86DisassemblerDecoderCommon_8h_html_a5cc171c21d0532e0f6353e972f1ff621"><div class="ttname"><a href="X86DisassemblerDecoderCommon_8h.html#a5cc171c21d0532e0f6353e972f1ff621">OpcodeType</a></div><div class="ttdeci">OpcodeType</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoderCommon_8h_source.html#l00285">X86DisassemblerDecoderCommon.h:285</a></div></div>
<div class="ttc" id="X86DisassemblerDecoder_8h_html_af00d764f04a2d7143d9de59ea213f148"><div class="ttname"><a href="X86DisassemblerDecoder_8h.html#af00d764f04a2d7143d9de59ea213f148">xFromREX</a></div><div class="ttdeci">#define xFromREX(rex)</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00045">X86DisassemblerDecoder.h:45</a></div></div>
<div class="ttc" id="X86DisassemblerDecoder_8h_html_adc11bcb515676078c7c25441c03bddbc"><div class="ttname"><a href="X86DisassemblerDecoder_8h.html#adc11bcb515676078c7c25441c03bddbc">indexFromSIB</a></div><div class="ttdeci">#define indexFromSIB(sib)</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00041">X86DisassemblerDecoder.h:41</a></div></div>
<div class="ttc" id="structInternalInstruction_html_a960c71a88602e7284b7a53a43c0d5c04"><div class="ttname"><a href="structInternalInstruction.html#a960c71a88602e7284b7a53a43c0d5c04">InternalInstruction::mode</a></div><div class="ttdeci">DisassemblerMode mode</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00527">X86DisassemblerDecoder.h:527</a></div></div>
<div class="ttc" id="X86DisassemblerDecoder_8c_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="X86DisassemblerDecoder_8c.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8c_source.html#l00026">X86DisassemblerDecoder.c:26</a></div></div>
<div class="ttc" id="X86DisassemblerDecoder_8c_html_abe4017d5eac03b4caf08ca7a36ba2723"><div class="ttname"><a href="X86DisassemblerDecoder_8c.html#abe4017d5eac03b4caf08ca7a36ba2723">readDisplacement</a></div><div class="ttdeci">static int readDisplacement(struct InternalInstruction *insn)</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8c_source.html#l01103">X86DisassemblerDecoder.c:1103</a></div></div>
<div class="ttc" id="structInternalInstruction_html_ab255c3e1663cdfbdebbe1b199140a950"><div class="ttname"><a href="structInternalInstruction.html#ab255c3e1663cdfbdebbe1b199140a950">InternalInstruction::readerCursor</a></div><div class="ttdeci">uint64_t readerCursor</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00517">X86DisassemblerDecoder.h:517</a></div></div>
<div class="ttc" id="X86Disassembler_8cpp_html_a8b039b49b0328a216cb2e7704d330873"><div class="ttname"><a href="X86Disassembler_8cpp.html#a8b039b49b0328a216cb2e7704d330873">logger</a></div><div class="ttdeci">static void logger(void *arg, const char *log)</div><div class="ttdef"><b>Definition:</b> <a href="X86Disassembler_8cpp_source.html#l00102">X86Disassembler.cpp:102</a></div></div>
<div class="ttc" id="X86DisassemblerDecoder_8h_html_a7cb9f08e12fcda158bbe0cee76ef61f7"><div class="ttname"><a href="X86DisassemblerDecoder_8h.html#a7cb9f08e12fcda158bbe0cee76ef61f7">SIBBase</a></div><div class="ttdeci">SIBBase</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00406">X86DisassemblerDecoder.h:406</a></div></div>
<div class="ttc" id="X86DisassemblerDecoderCommon_8h_html_a73a6f64aec6a805d641a17c87a9d00b9"><div class="ttname"><a href="X86DisassemblerDecoderCommon_8h.html#a73a6f64aec6a805d641a17c87a9d00b9">XOP8_MAP_SYM</a></div><div class="ttdeci">#define XOP8_MAP_SYM</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoderCommon_8h_source.html#l00035">X86DisassemblerDecoderCommon.h:35</a></div></div>
<div class="ttc" id="X86DisassemblerDecoder_8h_html_a0eb17652126644a237528e0153ee96b1"><div class="ttname"><a href="X86DisassemblerDecoder_8h.html#a0eb17652126644a237528e0153ee96b1">rFromVEX2of3</a></div><div class="ttdeci">#define rFromVEX2of3(vex)</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00048">X86DisassemblerDecoder.h:48</a></div></div>
<div class="ttc" id="structContextDecision_html"><div class="ttname"><a href="structContextDecision.html">ContextDecision</a></div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoderCommon_8h_source.html#l00369">X86DisassemblerDecoderCommon.h:369</a></div></div>
<div class="ttc" id="X86DisassemblerDecoder_8h_html_a8386ddf05ce05f470ca10679a78973bd"><div class="ttname"><a href="X86DisassemblerDecoder_8h.html#a8386ddf05ce05f470ca10679a78973bd">regFromModRM</a></div><div class="ttdeci">#define regFromModRM(modRM)</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00038">X86DisassemblerDecoder.h:38</a></div></div>
<div class="ttc" id="X86DisassemblerDecoder_8h_html_a4bce531c2ed18d569a316029616e82f0"><div class="ttname"><a href="X86DisassemblerDecoder_8h.html#a4bce531c2ed18d569a316029616e82f0">modFromModRM</a></div><div class="ttdeci">#define modFromModRM(modRM)</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00037">X86DisassemblerDecoder.h:37</a></div></div>
<div class="ttc" id="structInternalInstruction_html_abe6c3d2f697137970d48ad392ec9d26d"><div class="ttname"><a href="structInternalInstruction.html#abe6c3d2f697137970d48ad392ec9d26d">InternalInstruction::eaBase</a></div><div class="ttdeci">EABase eaBase</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00621">X86DisassemblerDecoder.h:621</a></div></div>
<div class="ttc" id="X86DisassemblerDecoder_8c_html_adb1fcba65d61d145b053ee0217b3dee7"><div class="ttname"><a href="X86DisassemblerDecoder_8c.html#adb1fcba65d61d145b053ee0217b3dee7">fixupReg</a></div><div class="ttdeci">static int fixupReg(struct InternalInstruction *insn, const struct OperandSpecifier *op)</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8c_source.html#l01361">X86DisassemblerDecoder.c:1361</a></div></div>
<div class="ttc" id="X86Disassembler_8cpp_html_ab989dba004fc91ca37606095e0a98b54"><div class="ttname"><a href="X86Disassembler_8cpp.html#ab989dba004fc91ca37606095e0a98b54">x86DisassemblerGetInstrName</a></div><div class="ttdeci">const char * x86DisassemblerGetInstrName(unsigned Opcode, const void *mii)</div><div class="ttdef"><b>Definition:</b> <a href="X86Disassembler_8cpp_source.html#l00044">X86Disassembler.cpp:44</a></div></div>
<div class="ttc" id="structInternalInstruction_html_a11c5dae84e030fe6bbc3586122af7d44"><div class="ttname"><a href="structInternalInstruction.html#a11c5dae84e030fe6bbc3586122af7d44">InternalInstruction::regBase</a></div><div class="ttdeci">Reg regBase</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00617">X86DisassemblerDecoder.h:617</a></div></div>
<div class="ttc" id="structInternalInstruction_html_a0688805de40e76e7694ce3b026f9f41f"><div class="ttname"><a href="structInternalInstruction.html#a0688805de40e76e7694ce3b026f9f41f">InternalInstruction::sibIndex</a></div><div class="ttdeci">SIBIndex sibIndex</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00627">X86DisassemblerDecoder.h:627</a></div></div>
<div class="ttc" id="X86DisassemblerDecoderCommon_8h_html_a5cc171c21d0532e0f6353e972f1ff621a208f2badc53ec65f21dbe280dfab63c5"><div class="ttname"><a href="X86DisassemblerDecoderCommon_8h.html#a5cc171c21d0532e0f6353e972f1ff621a208f2badc53ec65f21dbe280dfab63c5">XOP9_MAP</a></div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoderCommon_8h_source.html#l00293">X86DisassemblerDecoderCommon.h:293</a></div></div>
<div class="ttc" id="X86DisassemblerDecoder_8c_html_a0a006bbcf8e6c2fb5ab33c0066467e56"><div class="ttname"><a href="X86DisassemblerDecoder_8c.html#a0a006bbcf8e6c2fb5ab33c0066467e56">readOpcode</a></div><div class="ttdeci">static int readOpcode(struct InternalInstruction *insn)</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8c_source.html#l00640">X86DisassemblerDecoder.c:640</a></div></div>
<div class="ttc" id="X86DisassemblerDecoderCommon_8h_html_a9f0bb90ee924a8b71c6514c8eb6064a1"><div class="ttname"><a href="X86DisassemblerDecoderCommon_8h.html#a9f0bb90ee924a8b71c6514c8eb6064a1">InstrUID</a></div><div class="ttdeci">uint16_t InstrUID</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoderCommon_8h_source.html#l00307">X86DisassemblerDecoderCommon.h:307</a></div></div>
<div class="ttc" id="structInternalInstruction_html_a4ea0269d818e5d2f9405045b254a46fc"><div class="ttname"><a href="structInternalInstruction.html#a4ea0269d818e5d2f9405045b254a46fc">InternalInstruction::necessaryPrefixLocation</a></div><div class="ttdeci">uint64_t necessaryPrefixLocation</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00547">X86DisassemblerDecoder.h:547</a></div></div>
<div class="ttc" id="X86DisassemblerDecoder_8h_html_a86b3ea534df3a598db89d7d5ff581112a377f7990be2aed8d7547befd58ba4bfc"><div class="ttname"><a href="X86DisassemblerDecoder_8h.html#a86b3ea534df3a598db89d7d5ff581112a377f7990be2aed8d7547befd58ba4bfc">EA_DISP_NONE</a></div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00419">X86DisassemblerDecoder.h:419</a></div></div>
<div class="ttc" id="X86DisassemblerDecoderCommon_8h_html_a9df14d49cac592bc2e51794ad434e9b2"><div class="ttname"><a href="X86DisassemblerDecoderCommon_8h.html#a9df14d49cac592bc2e51794ad434e9b2">XOPA_MAP_SYM</a></div><div class="ttdeci">#define XOPA_MAP_SYM</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoderCommon_8h_source.html#l00037">X86DisassemblerDecoderCommon.h:37</a></div></div>
<div class="ttc" id="X86DisassemblerDecoder_8h_html_a86b3ea534df3a598db89d7d5ff581112a40fd53a41ecdbdf2d79b963fc45aacf8"><div class="ttname"><a href="X86DisassemblerDecoder_8h.html#a86b3ea534df3a598db89d7d5ff581112a40fd53a41ecdbdf2d79b963fc45aacf8">EA_DISP_32</a></div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00422">X86DisassemblerDecoder.h:422</a></div></div>
<div class="ttc" id="X86DisassemblerDecoderCommon_8h_html_a5289563c2fd129668b3dfc2bcb36f1a9"><div class="ttname"><a href="X86DisassemblerDecoderCommon_8h.html#a5289563c2fd129668b3dfc2bcb36f1a9">CONTEXTS_SYM</a></div><div class="ttdeci">#define CONTEXTS_SYM</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoderCommon_8h_source.html#l00028">X86DisassemblerDecoderCommon.h:28</a></div></div>
<div class="ttc" id="X86DisassemblerDecoder_8h_html_ad6634f7f956dec873ecc606847a660cc"><div class="ttname"><a href="X86DisassemblerDecoder_8h.html#ad6634f7f956dec873ecc606847a660cc">vvvvFromXOP3of3</a></div><div class="ttdeci">#define vvvvFromXOP3of3(vex)</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00067">X86DisassemblerDecoder.h:67</a></div></div>
<div class="ttc" id="X86DisassemblerDecoderCommon_8h_html_a5cc171c21d0532e0f6353e972f1ff621a47fe68a9ef1b2de8d7f18109579354c3"><div class="ttname"><a href="X86DisassemblerDecoderCommon_8h.html#a5cc171c21d0532e0f6353e972f1ff621a47fe68a9ef1b2de8d7f18109579354c3">THREEBYTE_A7</a></div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoderCommon_8h_source.html#l00291">X86DisassemblerDecoderCommon.h:291</a></div></div>
<div class="ttc" id="structInternalInstruction_html_aa21169901ecfa8cafe99dc89f912f775"><div class="ttname"><a href="structInternalInstruction.html#aa21169901ecfa8cafe99dc89f912f775">InternalInstruction::length</a></div><div class="ttdeci">size_t length</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00531">X86DisassemblerDecoder.h:531</a></div></div>
<div class="ttc" id="X86DisassemblerDecoder_8c_html_aa1d795a5171179078bfc2b8a6114f82f"><div class="ttname"><a href="X86DisassemblerDecoder_8c.html#aa1d795a5171179078bfc2b8a6114f82f">lookAtByte</a></div><div class="ttdeci">static int lookAtByte(struct InternalInstruction *insn, uint8_t *byte)</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8c_source.html#l00204">X86DisassemblerDecoder.c:204</a></div></div>
<div class="ttc" id="X86DisassemblerDecoderCommon_8h_html_a5cc171c21d0532e0f6353e972f1ff621ae7d385e3466556921813f6ec2505e3ae"><div class="ttname"><a href="X86DisassemblerDecoderCommon_8h.html#a5cc171c21d0532e0f6353e972f1ff621ae7d385e3466556921813f6ec2505e3ae">XOPA_MAP</a></div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoderCommon_8h_source.html#l00294">X86DisassemblerDecoderCommon.h:294</a></div></div>
<div class="ttc" id="namespacellvm_1_1cl_html_aed47e4757f3240146f8ad40c2cdbf2d1"><div class="ttname"><a href="namespacellvm_1_1cl.html#aed47e4757f3240146f8ad40c2cdbf2d1">llvm::cl::location</a></div><div class="ttdeci">LocationClass&lt; Ty &gt; location(Ty &amp;L)</div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l00333">CommandLine.h:333</a></div></div>
<div class="ttc" id="X86DisassemblerDecoder_8h_html_a91bdeef85650fa60106450fb24d9c500"><div class="ttname"><a href="X86DisassemblerDecoder_8h.html#a91bdeef85650fa60106450fb24d9c500">ppFromXOP3of3</a></div><div class="ttdeci">#define ppFromXOP3of3(xop)</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00069">X86DisassemblerDecoder.h:69</a></div></div>
<div class="ttc" id="structInternalInstruction_html_afe0d37da2b3ba81a20c6c2b40b58e6e3"><div class="ttname"><a href="structInternalInstruction.html#afe0d37da2b3ba81a20c6c2b40b58e6e3">InternalInstruction::segmentOverride</a></div><div class="ttdeci">SegmentOverride segmentOverride</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00549">X86DisassemblerDecoder.h:549</a></div></div>
<div class="ttc" id="structInternalInstruction_html_ae69f63a63b1294cc7f67388b7afd93cd"><div class="ttname"><a href="structInternalInstruction.html#ae69f63a63b1294cc7f67388b7afd93cd">InternalInstruction::opcodeModifier</a></div><div class="ttdeci">uint8_t opcodeModifier</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00608">X86DisassemblerDecoder.h:608</a></div></div>
<div class="ttc" id="structInternalInstruction_html_ab7d16d61c8c8e94d58ef50be40479b75"><div class="ttname"><a href="structInternalInstruction.html#ab7d16d61c8c8e94d58ef50be40479b75">InternalInstruction::consumedOpcodeModifier</a></div><div class="ttdeci">BOOL consumedOpcodeModifier</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00607">X86DisassemblerDecoder.h:607</a></div></div>
<div class="ttc" id="structModRMDecision_html"><div class="ttname"><a href="structModRMDecision.html">ModRMDecision</a></div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoderCommon_8h_source.html#l00347">X86DisassemblerDecoderCommon.h:347</a></div></div>
<div class="ttc" id="X86DisassemblerDecoder_8c_html_a6c71d4e276f8fe7ce11b7a8456821d7c"><div class="ttname"><a href="X86DisassemblerDecoder_8c.html#a6c71d4e276f8fe7ce11b7a8456821d7c">decodeInstruction</a></div><div class="ttdeci">int decodeInstruction(struct InternalInstruction *insn, byteReader_t reader, const void *readerArg, dlog_t logger, void *loggerArg, const void *miiArg, uint64_t startLoc, DisassemblerMode mode)</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8c_source.html#l01712">X86DisassemblerDecoder.c:1712</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<hr>
<p class="footer">
Generated on Sat Nov 10 2018 23:03:09 for <a href="http://llvm.org/">LLVM</a> by
<a href="http://www.doxygen.org"><img src="doxygen.png" alt="Doxygen"
align="middle" border="0"/>1.8.11</a><br>
Copyright &copy; 2003-2013 University of Illinois at Urbana-Champaign.
All Rights Reserved.</p>
<hr>
<!--#include virtual="/attrib.incl" -->
</body>
</html>
