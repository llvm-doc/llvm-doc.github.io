<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head>
<meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1"/>
<meta name="keywords" content="LLVM,Low Level Virtual Machine,C++,doxygen,API,documentation"/>
<meta name="description" content="C++ source code API documentation for LLVM."/>
<title>LLVM: SLPVectorizer.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head><body>
<p class="title">LLVM API Documentation</p>
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('SLPVectorizer_8cpp_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">SLPVectorizer.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="SLPVectorizer_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//===- SLPVectorizer.cpp - A bottom up SLP Vectorizer ---------------------===//</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">//                     The LLVM Compiler Infrastructure</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// This file is distributed under the University of Illinois Open Source</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">// License. See LICENSE.TXT for details.</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">// This pass implements the Bottom Up SLP vectorizer. It detects consecutive</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">// stores that can be put together into vector-stores. Next, it attempts to</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">// construct vectorizable tree using the use-def chains. If a profitable tree</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">// was found, the SLP vectorizer performs vectorization on the tree.</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">// The pass is inspired by the work described in the paper:</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">//  &quot;Loop-Aware SLP in GCC&quot; by Ira Rosen, Dorit Nuzman, Ayal Zaks.</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div><div class="line"><a name="l00018"></a><span class="lineno"><a class="line" href="SLPVectorizer_8cpp.html#a274654b7f5932cae6a71a113322481be">   18</a></span>&#160;<span class="preprocessor">#define SV_NAME &quot;slp-vectorizer&quot;</span></div><div class="line"><a name="l00019"></a><span class="lineno"><a class="line" href="SLPVectorizer_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">   19</a></span>&#160;<span class="preprocessor">#define DEBUG_TYPE &quot;SLP&quot;</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Transforms_2Vectorize_8h.html">llvm/Transforms/Vectorize.h</a>&quot;</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="MapVector_8h.html">llvm/ADT/MapVector.h</a>&quot;</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="PostOrderIterator_8h.html">llvm/ADT/PostOrderIterator.h</a>&quot;</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="SetVector_8h.html">llvm/ADT/SetVector.h</a>&quot;</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="AliasAnalysis_8h.html">llvm/Analysis/AliasAnalysis.h</a>&quot;</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ScalarEvolution_8h.html">llvm/Analysis/ScalarEvolution.h</a>&quot;</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ScalarEvolutionExpressions_8h.html">llvm/Analysis/ScalarEvolutionExpressions.h</a>&quot;</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TargetTransformInfo_8h.html">llvm/Analysis/TargetTransformInfo.h</a>&quot;</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ValueTracking_8h.html">llvm/Analysis/ValueTracking.h</a>&quot;</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Verifier_8h.html">llvm/Analysis/Verifier.h</a>&quot;</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="LoopInfo_8h.html">llvm/Analysis/LoopInfo.h</a>&quot;</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="DataLayout_8h.html">llvm/IR/DataLayout.h</a>&quot;</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Instructions_8h.html">llvm/IR/Instructions.h</a>&quot;</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="IntrinsicInst_8h.html">llvm/IR/IntrinsicInst.h</a>&quot;</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="IRBuilder_8h.html">llvm/IR/IRBuilder.h</a>&quot;</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Module_8h.html">llvm/IR/Module.h</a>&quot;</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Type_8h.html">llvm/IR/Type.h</a>&quot;</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Value_8h.html">llvm/IR/Value.h</a>&quot;</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Pass_8h.html">llvm/Pass.h</a>&quot;</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="CommandLine_8h.html">llvm/Support/CommandLine.h</a>&quot;</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Debug_8h.html">llvm/Support/Debug.h</a>&quot;</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="raw__ostream_8h.html">llvm/Support/raw_ostream.h</a>&quot;</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor">#include &lt;algorithm&gt;</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#include &lt;map&gt;</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespacellvm.html">llvm</a>;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;int&gt;</a></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <a class="code" href="SLPVectorizer_8cpp.html#a6f911c7c687cf91f4f1c42b45d501448">SLPCostThreshold</a>(<span class="stringliteral">&quot;slp-threshold&quot;</span>, <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(0), <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>,</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;                     <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Only vectorize if you gain more than this &quot;</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;                              <span class="stringliteral">&quot;number &quot;</span>));</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;bool&gt;</a></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<a class="code" href="SLPVectorizer_8cpp.html#a4dc630bcb416d59c7a164a214cbf9872">ShouldVectorizeHor</a>(<span class="stringliteral">&quot;slp-vectorize-hor&quot;</span>, <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(<span class="keyword">false</span>), <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>,</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;                   <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Attempt to vectorize horizontal reductions&quot;</span>));</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;bool&gt;</a> <a class="code" href="SLPVectorizer_8cpp.html#a261a64ee0c17cb0a8b61985e1836a32c">ShouldStartVectorizeHorAtStore</a>(</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <span class="stringliteral">&quot;slp-vectorize-hor-store&quot;</span>, <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(<span class="keyword">false</span>), <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>,</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        <span class="stringliteral">&quot;Attempt to vectorize horizontal reductions feeding into a store&quot;</span>));</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="keyword">namespace </span>{</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> MinVecRegSize = 128;</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> RecursionMaxDepth = 12;</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">/// A helper class for numbering instructions in multiple blocks.</span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">/// Numbers start at zero for each basic block.</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment"></span><span class="keyword">struct </span>BlockNumbering {</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  BlockNumbering(<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *Bb) : <a class="code" href="CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>(Bb), Valid(<a class="code" href="namespacefalse.html">false</a>) {}</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  BlockNumbering() : <a class="code" href="CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>(0), Valid(<a class="code" href="namespacefalse.html">false</a>) {}</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <span class="keywordtype">void</span> numberInstructions() {</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <span class="keywordtype">unsigned</span> Loc = 0;</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    InstrIdx.clear();</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    InstrVec.clear();</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <span class="comment">// Number the instructions in the block.</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1ilist__iterator.html">BasicBlock::iterator</a> <a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a> = <a class="code" href="CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>-&gt;begin(), e = <a class="code" href="CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>-&gt;end(); <a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a> != e; ++<a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a>) {</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;      InstrIdx[<a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a>] = Loc++;</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;      InstrVec.push_back(<a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a>);</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;      assert(InstrVec[InstrIdx[<a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a>]] == <a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a> &amp;&amp; <span class="stringliteral">&quot;Invalid allocation&quot;</span>);</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    }</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    Valid = <span class="keyword">true</span>;</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  }</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <span class="keywordtype">int</span> getIndex(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    assert(I-&gt;<a class="code" href="classllvm_1_1Instruction.html#a9cd49851904f15060edb782ef4dd1b2d">getParent</a>() == <a class="code" href="CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> &amp;&amp; <span class="stringliteral">&quot;Invalid instruction&quot;</span>);</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="keywordflow">if</span> (!Valid)</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;      numberInstructions();</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    assert(InstrIdx.count(I) &amp;&amp; <span class="stringliteral">&quot;Unknown instruction&quot;</span>);</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="keywordflow">return</span> InstrIdx[<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>];</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  }</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *getInstruction(<span class="keywordtype">unsigned</span> loc) {</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="keywordflow">if</span> (!Valid)</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;      numberInstructions();</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    assert(InstrVec.size() &gt; loc &amp;&amp; <span class="stringliteral">&quot;Invalid Index&quot;</span>);</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <span class="keywordflow">return</span> InstrVec[loc];</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  }</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  <span class="keywordtype">void</span> forget() { Valid = <span class="keyword">false</span>; }</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="keyword">private</span>:<span class="comment"></span></div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment">  /// The block we are numbering.</span></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>;<span class="comment"></span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment">  /// Is the block numbered.</span></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> Valid;<span class="comment"></span></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment">  /// Maps instructions to numbers and back.</span></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1SmallDenseMap.html">SmallDenseMap&lt;Instruction *, int&gt;</a> InstrIdx;<span class="comment"></span></div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment">  /// Maps integers to Instructions.</span></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Instruction *, 32&gt;</a> InstrVec;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;};</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment">/// \returns the parent basic block if all of the instructions in \p VL</span></div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment">/// are in the same block or null otherwise.</span></div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment"></span><span class="keyword">static</span> <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *getSameBlock(<a class="code" href="classllvm_1_1ArrayRef.html">ArrayRef&lt;Value *&gt;</a> VL) {</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *I0 = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1Instruction.html">Instruction</a>&gt;(VL[0]);</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  <span class="keywordflow">if</span> (!I0)</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> = I0-&gt;<a class="code" href="classllvm_1_1Instruction.html#a9cd49851904f15060edb782ef4dd1b2d">getParent</a>();</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 1, e = VL.<a class="code" href="classllvm_1_1ArrayRef.html#a76878250107ee24ef7339870bdda4bcf">size</a>(); <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; e; <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *I = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1Instruction.html">Instruction</a>&gt;(VL[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="keywordflow">if</span> (!I)</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="keywordflow">if</span> (BB != I-&gt;<a class="code" href="classllvm_1_1Instruction.html#a9cd49851904f15060edb782ef4dd1b2d">getParent</a>())</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  }</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;}</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment">/// \returns True if all of the values in \p VL are constants.</span></div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">bool</span> allConstant(<a class="code" href="classllvm_1_1ArrayRef.html">ArrayRef&lt;Value *&gt;</a> VL) {</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0, e = VL.<a class="code" href="classllvm_1_1ArrayRef.html#a76878250107ee24ef7339870bdda4bcf">size</a>(); <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; e; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="keywordflow">if</span> (!isa&lt;Constant&gt;(VL[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>]))</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;}</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment">/// \returns True if all of the values in \p VL are identical.</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">bool</span> isSplat(<a class="code" href="classllvm_1_1ArrayRef.html">ArrayRef&lt;Value *&gt;</a> VL) {</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 1, e = VL.<a class="code" href="classllvm_1_1ArrayRef.html#a76878250107ee24ef7339870bdda4bcf">size</a>(); <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; e; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="keywordflow">if</span> (VL[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>] != VL[0])</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;}</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment">/// \returns The opcode if all of the Instructions in \p VL have the same</span></div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment">/// opcode, or zero.</span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">unsigned</span> getSameOpcode(<a class="code" href="classllvm_1_1ArrayRef.html">ArrayRef&lt;Value *&gt;</a> VL) {</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *I0 = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1Instruction.html">Instruction</a>&gt;(VL[0]);</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  <span class="keywordflow">if</span> (!I0)</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  <span class="keywordtype">unsigned</span> Opcode = I0-&gt;<a class="code" href="classllvm_1_1Instruction.html#a021bb7c9aad6003fe8089f6327356c6c">getOpcode</a>();</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 1, e = VL.<a class="code" href="classllvm_1_1ArrayRef.html#a76878250107ee24ef7339870bdda4bcf">size</a>(); <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; e; <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *I = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1Instruction.html">Instruction</a>&gt;(VL[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <span class="keywordflow">if</span> (!I || Opcode != I-&gt;<a class="code" href="classllvm_1_1Instruction.html#a021bb7c9aad6003fe8089f6327356c6c">getOpcode</a>())</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  }</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  <span class="keywordflow">return</span> Opcode;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;}</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment">/// \returns \p I after propagating metadata from \p VL.</span></div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="comment"></span><span class="keyword">static</span> <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *propagateMetadata(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *I, <a class="code" href="classllvm_1_1ArrayRef.html">ArrayRef&lt;Value *&gt;</a> VL) {</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *I0 = cast&lt;Instruction&gt;(VL[0]);</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;std::pair&lt;unsigned, MDNode *&gt;</a>, 4&gt; Metadata;</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  I0-&gt;<a class="code" href="classllvm_1_1Instruction.html#afdbf7fbdf8b6e61904c6f718436b1f7b">getAllMetadataOtherThanDebugLoc</a>(Metadata);</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0, <a class="code" href="Target_2README_8txt.html#ab335e668fd33542ea14a2c7b527e64d3">n</a> = Metadata.size(); <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != <a class="code" href="Target_2README_8txt.html#ab335e668fd33542ea14a2c7b527e64d3">n</a>; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <span class="keywordtype">unsigned</span> <a class="code" href="namespacellvm_1_1EngineKind.html#a9df47239a42cd9621ac26d9ecbd57441">Kind</a> = Metadata[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>].first;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <a class="code" href="classllvm_1_1MDNode.html">MDNode</a> *MD = Metadata[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>].second;</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 1, e = VL.<a class="code" href="classllvm_1_1ArrayRef.html#a76878250107ee24ef7339870bdda4bcf">size</a>(); MD &amp;&amp; <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != e; <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;      <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *I = cast&lt;Instruction&gt;(VL[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;      <a class="code" href="classllvm_1_1MDNode.html">MDNode</a> *IMD = I-&gt;<a class="code" href="classllvm_1_1Instruction.html#aafa29112cbe02e4adc9b36752c771991">getMetadata</a>(Kind);</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;      <span class="keywordflow">switch</span> (Kind) {</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;      <span class="keywordflow">default</span>:</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        MD = 0; <span class="comment">// Remove unknown metadata</span></div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="classllvm_1_1LLVMContext.html#a0869c4dfee48696ce863fcd367eba52da66682b7e33233c8e51196bbf274726a2">LLVMContext::MD_tbaa</a>:</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        MD = <a class="code" href="classllvm_1_1MDNode.html#a3c210e8905029a012df3384a7eeb63ad">MDNode::getMostGenericTBAA</a>(MD, IMD);</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="classllvm_1_1LLVMContext.html#a0869c4dfee48696ce863fcd367eba52da1b73df7e27f0fa94e338ffc4fac9daf3">LLVMContext::MD_fpmath</a>:</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        MD = <a class="code" href="classllvm_1_1MDNode.html#a9d9f2d817781a31c771406d1f0acc9fb">MDNode::getMostGenericFPMath</a>(MD, IMD);</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;      }</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    }</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    I-&gt;<a class="code" href="classllvm_1_1Instruction.html#a9247a212ea89acc9573fa7e7f557eaba">setMetadata</a>(Kind, MD);</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  }</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>;</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;}</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment">/// \returns The type that all of the values in \p VL have or null if there</span></div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment">/// are different types.</span></div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment"></span><span class="keyword">static</span> <a class="code" href="classllvm_1_1Type.html">Type</a>* getSameType(<a class="code" href="classllvm_1_1ArrayRef.html">ArrayRef&lt;Value *&gt;</a> VL) {</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *Ty = VL[0]-&gt;getType();</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 1, e = VL.<a class="code" href="classllvm_1_1ArrayRef.html#a76878250107ee24ef7339870bdda4bcf">size</a>(); <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; e; <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="keywordflow">if</span> (VL[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;<a class="code" href="namespacellvm_1_1Intrinsic.html#ac015f68d60ea67a2e31bc10bc720d3e8">getType</a>() != Ty)</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  <span class="keywordflow">return</span> Ty;</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;}</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment">/// \returns True if the ExtractElement instructions in VL can be vectorized</span></div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment">/// to use the original vector.</span></div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">bool</span> CanReuseExtract(<a class="code" href="classllvm_1_1ArrayRef.html">ArrayRef&lt;Value *&gt;</a> VL) {</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  assert(<a class="code" href="InstCombineCompares_8cpp.html#aa5ab8c7b55d8bc7cab66be444daa70a1">Instruction::ExtractElement</a> == getSameOpcode(VL) &amp;&amp; <span class="stringliteral">&quot;Invalid opcode&quot;</span>);</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  <span class="comment">// Check if all of the extracts come from the same vector and from the</span></div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  <span class="comment">// correct offset.</span></div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *VL0 = VL[0];</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  <a class="code" href="classllvm_1_1ExtractElementInst.html">ExtractElementInst</a> *E0 = cast&lt;ExtractElementInst&gt;(VL0);</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Vec = E0-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0);</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;  <span class="comment">// We have to extract from the same vector type.</span></div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  <span class="keywordtype">unsigned</span> NElts = Vec-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#ad8f27f0b94a56abcd296b8461737a3af">getVectorNumElements</a>();</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  <span class="keywordflow">if</span> (NElts != VL.<a class="code" href="classllvm_1_1ArrayRef.html#a76878250107ee24ef7339870bdda4bcf">size</a>())</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  <span class="comment">// Check that all of the indices extract from the correct offset.</span></div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;  <a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *CI = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a>&gt;(E0-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(1));</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;  <span class="keywordflow">if</span> (!CI || CI-&gt;<a class="code" href="classllvm_1_1ConstantInt.html#a6edd823ba5e4e1effc8280ca8a1194ef">getZExtValue</a>())</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 1, e = VL.<a class="code" href="classllvm_1_1ArrayRef.html#a76878250107ee24ef7339870bdda4bcf">size</a>(); <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; e; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <a class="code" href="classllvm_1_1ExtractElementInst.html">ExtractElementInst</a> *E = cast&lt;ExtractElementInst&gt;(VL[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *CI = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a>&gt;(E-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(1));</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <span class="keywordflow">if</span> (!CI || CI-&gt;getZExtValue() != <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> || E-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0) != Vec)</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  }</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;}</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> reorderInputsAccordingToOpcode(<a class="code" href="classllvm_1_1ArrayRef.html">ArrayRef&lt;Value *&gt;</a> VL,</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;                                           <a class="code" href="classllvm_1_1SmallVectorImpl.html">SmallVectorImpl&lt;Value *&gt;</a> &amp;Left,</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;                                           <a class="code" href="classllvm_1_1SmallVectorImpl.html">SmallVectorImpl&lt;Value *&gt;</a> &amp;Right) {</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Value *, 16&gt;</a> OrigLeft, OrigRight;</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  <span class="keywordtype">bool</span> AllSameOpcodeLeft = <span class="keyword">true</span>;</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  <span class="keywordtype">bool</span> AllSameOpcodeRight = <span class="keyword">true</span>;</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0, e = VL.<a class="code" href="classllvm_1_1ArrayRef.html#a76878250107ee24ef7339870bdda4bcf">size</a>(); <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != e; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *I = cast&lt;Instruction&gt;(VL[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *V0 = I-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0);</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *V1 = I-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(1);</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    OrigLeft.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(V0);</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    OrigRight.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(V1);</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *I0 = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1Instruction.html">Instruction</a>&gt;(V0);</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *I1 = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1Instruction.html">Instruction</a>&gt;(V1);</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <span class="comment">// Check whether all operands on one side have the same opcode. In this case</span></div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <span class="comment">// we want to preserve the original order and not make things worse by</span></div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <span class="comment">// reordering.</span></div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    AllSameOpcodeLeft = I0;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    AllSameOpcodeRight = I1;</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> &amp;&amp; AllSameOpcodeLeft) {</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *P0 = dyn_cast&lt;Instruction&gt;(OrigLeft[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>-1])) {</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        <span class="keywordflow">if</span>(P0-&gt;getOpcode() != I0-&gt;<a class="code" href="classllvm_1_1Instruction.html#a021bb7c9aad6003fe8089f6327356c6c">getOpcode</a>())</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;          AllSameOpcodeLeft = <span class="keyword">false</span>;</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;      } <span class="keywordflow">else</span></div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        AllSameOpcodeLeft = <span class="keyword">false</span>;</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    }</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> &amp;&amp; AllSameOpcodeRight) {</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *P1 = dyn_cast&lt;Instruction&gt;(OrigRight[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>-1])) {</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        <span class="keywordflow">if</span>(P1-&gt;getOpcode() != I1-&gt;getOpcode())</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;          AllSameOpcodeRight = <span class="keyword">false</span>;</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;      } <span class="keywordflow">else</span></div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        AllSameOpcodeRight = <span class="keyword">false</span>;</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    }</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    <span class="comment">// Sort two opcodes. In the code below we try to preserve the ability to use</span></div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    <span class="comment">// broadcast of values instead of individual inserts.</span></div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <span class="comment">// vl1 = load</span></div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <span class="comment">// vl2 = phi</span></div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <span class="comment">// vr1 = load</span></div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <span class="comment">// vr2 = vr2</span></div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <span class="comment">//    = vl1 x vr1</span></div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="comment">//    = vl2 x vr2</span></div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <span class="comment">// If we just sorted according to opcode we would leave the first line in</span></div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <span class="comment">// tact but we would swap vl2 with vr2 because opcode(phi) &gt; opcode(load).</span></div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <span class="comment">//    = vl1 x vr1</span></div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <span class="comment">//    = vr2 x vl2</span></div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <span class="comment">// Because vr2 and vr1 are from the same load we loose the opportunity of a</span></div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="comment">// broadcast for the packed right side in the backend: we have [vr1, vl2]</span></div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <span class="comment">// instead of [vr1, vr2=vr1].</span></div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <span class="keywordflow">if</span> (I0 &amp;&amp; I1) {</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;       <span class="keywordflow">if</span>(!<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> &amp;&amp; I0-&gt;<a class="code" href="classllvm_1_1Instruction.html#a021bb7c9aad6003fe8089f6327356c6c">getOpcode</a>() &gt; I1-&gt;getOpcode()) {</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;         Left.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(I1);</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;         Right.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(I0);</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> &amp;&amp; I0-&gt;<a class="code" href="classllvm_1_1Instruction.html#a021bb7c9aad6003fe8089f6327356c6c">getOpcode</a>() &gt; I1-&gt;getOpcode() &amp;&amp; Right[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>-1] != I1) {</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;         <span class="comment">// Try not to destroy a broad cast for no apparent benefit.</span></div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;         Left.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(I1);</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;         Right.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(I0);</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> &amp;&amp; I0-&gt;<a class="code" href="classllvm_1_1Instruction.html#a021bb7c9aad6003fe8089f6327356c6c">getOpcode</a>() == I1-&gt;getOpcode() &amp;&amp; Right[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>-1] ==  I0) {</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;         <span class="comment">// Try preserve broadcasts.</span></div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;         Left.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(I1);</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;         Right.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(I0);</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> &amp;&amp; I0-&gt;<a class="code" href="classllvm_1_1Instruction.html#a021bb7c9aad6003fe8089f6327356c6c">getOpcode</a>() == I1-&gt;getOpcode() &amp;&amp; Left[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>-1] == I1) {</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;         <span class="comment">// Try preserve broadcasts.</span></div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;         Left.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(I1);</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;         Right.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(I0);</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;       } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;         Left.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(I0);</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;         Right.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(I1);</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;       }</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;       <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    }</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    <span class="comment">// One opcode, put the instruction on the right.</span></div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    <span class="keywordflow">if</span> (I0) {</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;      Left.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(V1);</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;      Right.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(I0);</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    }</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    Left.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(V0);</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    Right.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(V1);</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;  }</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;  <span class="keywordtype">bool</span> LeftBroadcast = isSplat(Left);</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;  <span class="keywordtype">bool</span> RightBroadcast = isSplat(Right);</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  <span class="comment">// Don&#39;t reorder if the operands where good to begin with.</span></div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  <span class="keywordflow">if</span> (!(LeftBroadcast || RightBroadcast) &amp;&amp;</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;      (AllSameOpcodeRight || AllSameOpcodeLeft)) {</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    Left = OrigLeft;</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    Right = OrigRight;</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;  }</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;}</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="comment">/// Bottom Up SLP Vectorizer.</span></div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="comment"></span><span class="keyword">class </span>BoUpSLP {</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;  <span class="keyword">typedef</span> <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Value *, 8&gt;</a> ValueList;</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;  <span class="keyword">typedef</span> <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Instruction *, 16&gt;</a> InstrList;</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;  <span class="keyword">typedef</span> <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;Value *, 16&gt;</a> ValueSet;</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;  <span class="keyword">typedef</span> <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;StoreInst *, 8&gt;</a> StoreList;</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;  BoUpSLP(<a class="code" href="classllvm_1_1Function.html">Function</a> *<a class="code" href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6f">Func</a>, <a class="code" href="classllvm_1_1ScalarEvolution.html">ScalarEvolution</a> *Se, <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> *Dl,</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;          <a class="code" href="classllvm_1_1TargetTransformInfo.html">TargetTransformInfo</a> *Tti, <a class="code" href="classllvm_1_1AliasAnalysis.html">AliasAnalysis</a> *Aa, <a class="code" href="classllvm_1_1LoopInfo.html">LoopInfo</a> *Li,</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;          <a class="code" href="classllvm_1_1DominatorTree.html">DominatorTree</a> *Dt) :</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    <a class="code" href="LLParser_8cpp.html#a33ece1ef8074506a15d7f86eb76dbae6">F</a>(Func), SE(Se), DL(Dl), TTI(Tti), AA(Aa), LI(Li), DT(Dt),</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    Builder(Se-&gt;getContext()) {</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;      <span class="comment">// Setup the block numbering utility for all of the blocks in the</span></div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;      <span class="comment">// function.</span></div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1ilist__iterator.html">Function::iterator</a> <a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a> = <a class="code" href="LLParser_8cpp.html#a33ece1ef8074506a15d7f86eb76dbae6">F</a>-&gt;begin(), e = <a class="code" href="LLParser_8cpp.html#a33ece1ef8074506a15d7f86eb76dbae6">F</a>-&gt;end(); <a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a> != e; ++<a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a>) {</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;        <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *BB = <a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a>;</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;        BlocksNumbers[<a class="code" href="CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>] = BlockNumbering(BB);</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;      }</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    }</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="comment">  /// \brief Vectorize the tree that starts with the elements in \p VL.</span></div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="comment">  /// Returns the vectorized root.</span></div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1Value.html">Value</a> *vectorizeTree();</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="comment">  /// \returns the vectorization cost of the subtree that starts at \p VL.</span></div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="comment">  /// A negative number means that this is profitable.</span></div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="comment"></span>  <span class="keywordtype">int</span> getTreeCost();</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="comment">  /// Construct a vectorizable tree that starts at \p Roots and is possibly</span></div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="comment">  /// used by a reduction of \p RdxOps.</span></div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> buildTree(<a class="code" href="classllvm_1_1ArrayRef.html">ArrayRef&lt;Value *&gt;</a> Roots, ValueSet *RdxOps = 0);</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="comment">  /// Clear the internal data structures that are created by &#39;buildTree&#39;.</span></div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> deleteTree() {</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    RdxOps = 0;</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    VectorizableTree.clear();</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    ScalarToTreeEntry.clear();</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    MustGather.clear();</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    ExternalUses.clear();</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    MemBarrierIgnoreList.clear();</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;  }</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;<span class="comment">  /// \returns true if the memory operations A and B are consecutive.</span></div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> isConsecutiveAccess(<a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>, <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="Target_2ARM_2README_8txt.html#a90cca76dd78688687e0d697679dbc799">B</a>);</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;<span class="comment">  /// \brief Perform LICM and CSE on the newly generated gather sequences.</span></div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> optimizeGatherSequence();</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="keyword">private</span>:</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;  <span class="keyword">struct </span>TreeEntry;</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="comment">  /// \returns the cost of the vectorizable entry.</span></div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="comment"></span>  <span class="keywordtype">int</span> getEntryCost(TreeEntry *E);</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="comment">  /// This is the recursive part of buildTree.</span></div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> buildTree_rec(<a class="code" href="classllvm_1_1ArrayRef.html">ArrayRef&lt;Value *&gt;</a> Roots, <span class="keywordtype">unsigned</span> Depth);</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="comment">  /// Vectorize a single entry in the tree.</span></div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1Value.html">Value</a> *vectorizeTree(TreeEntry *E);</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="comment">  /// Vectorize a single entry in the tree, starting in \p VL.</span></div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1Value.html">Value</a> *vectorizeTree(<a class="code" href="classllvm_1_1ArrayRef.html">ArrayRef&lt;Value *&gt;</a> VL);</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="comment">  /// \returns the pointer to the vectorized value if \p VL is already</span></div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="comment">  /// vectorized, or NULL. They may happen in cycles.</span></div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1Value.html">Value</a> *alreadyVectorized(<a class="code" href="classllvm_1_1ArrayRef.html">ArrayRef&lt;Value *&gt;</a> VL) <span class="keyword">const</span>;</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;<span class="comment">  /// \brief Take the pointer operand from the Load/Store instruction.</span></div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;<span class="comment">  /// \returns NULL if this is not a valid Load/Store instruction.</span></div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="comment"></span>  <span class="keyword">static</span> <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="Delinearization_8cpp.html#a67193aea0752a127930d6f762e685eef">getPointerOperand</a>(<a class="code" href="classllvm_1_1Value.html">Value</a> *I);</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="comment">  /// \brief Take the address space operand from the Load/Store instruction.</span></div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<span class="comment">  /// \returns -1 if this is not a valid Load/Store instruction.</span></div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;<span class="comment"></span>  <span class="keyword">static</span> <span class="keywordtype">unsigned</span> getAddressSpaceOperand(<a class="code" href="classllvm_1_1Value.html">Value</a> *I);</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;<span class="comment">  /// \returns the scalarization cost for this type. Scalarization in this</span></div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="comment">  /// context means the creation of vectors from a group of scalars.</span></div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;<span class="comment"></span>  <span class="keywordtype">int</span> getGatherCost(<a class="code" href="classllvm_1_1Type.html">Type</a> *Ty);</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="comment">  /// \returns the scalarization cost for this list of values. Assuming that</span></div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="comment">  /// this subtree gets vectorized, we may need to extract the values from the</span></div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="comment">  /// roots. This method calculates the cost of extracting the values.</span></div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;<span class="comment"></span>  <span class="keywordtype">int</span> getGatherCost(<a class="code" href="classllvm_1_1ArrayRef.html">ArrayRef&lt;Value *&gt;</a> VL);</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="comment">  /// \returns the AA location that is being access by the instruction.</span></div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="comment"></span>  <a class="code" href="structllvm_1_1AliasAnalysis_1_1Location.html">AliasAnalysis::Location</a> getLocation(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *I);</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="comment">  /// \brief Checks if it is possible to sink an instruction from</span></div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="comment">  /// \p Src to \p Dst.</span></div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="comment">  /// \returns the pointer to the barrier instruction if we can&#39;t sink.</span></div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1Value.html">Value</a> *getSinkBarrier(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *Src, <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *Dst);</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<span class="comment">  /// \returns the index of the last instruction in the BB from \p VL.</span></div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="comment"></span>  <span class="keywordtype">int</span> getLastIndex(<a class="code" href="classllvm_1_1ArrayRef.html">ArrayRef&lt;Value *&gt;</a> VL);</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;<span class="comment">  /// \returns the Instruction in the bundle \p VL.</span></div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *getLastInstruction(<a class="code" href="classllvm_1_1ArrayRef.html">ArrayRef&lt;Value *&gt;</a> VL);</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;<span class="comment">  /// \brief Set the Builder insert point to one after the last instruction in</span></div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="comment">  /// the bundle</span></div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> setInsertPointAfterBundle(<a class="code" href="classllvm_1_1ArrayRef.html">ArrayRef&lt;Value *&gt;</a> VL);</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;<span class="comment">  /// \returns a vector from a collection of scalars in \p VL.</span></div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1Value.html">Value</a> *Gather(<a class="code" href="classllvm_1_1ArrayRef.html">ArrayRef&lt;Value *&gt;</a> VL, <a class="code" href="classllvm_1_1VectorType.html">VectorType</a> *Ty);</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="comment">  /// \returns whether the VectorizableTree is fully vectoriable and will</span></div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<span class="comment">  /// be beneficial even the tree height is tiny.</span></div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> isFullyVectorizableTinyTree(); </div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;  <span class="keyword">struct </span>TreeEntry {</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    TreeEntry() : Scalars(), VectorizedValue(0), LastScalarIndex(0),</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    NeedToGather(0) {}</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;<span class="comment">    /// \returns true if the scalars in VL are equal to this entry.</span></div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;<span class="comment"></span>    <span class="keywordtype">bool</span> isSame(<a class="code" href="classllvm_1_1ArrayRef.html">ArrayRef&lt;Value *&gt;</a> VL)<span class="keyword"> const </span>{</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;      assert(VL.<a class="code" href="classllvm_1_1ArrayRef.html#a76878250107ee24ef7339870bdda4bcf">size</a>() == Scalars.size() &amp;&amp; <span class="stringliteral">&quot;Invalid size&quot;</span>);</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1lltok.html#af353621f14cb4b4b3af5ffaff84076b1abf5ba3ee47e95dae362eb24b6d4f48e5">std::equal</a>(VL.<a class="code" href="classllvm_1_1ArrayRef.html#a836367b39ed630bf14db99923c22740e">begin</a>(), VL.<a class="code" href="classllvm_1_1ArrayRef.html#a38ed8cc3c342ad6910e8c869d3e2b9cf">end</a>(), Scalars.begin());</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    }</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;<span class="comment">    /// A vector of scalars.</span></div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;<span class="comment"></span>    ValueList Scalars;</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;<span class="comment">    /// The Scalars are vectorized into this value. It is initialized to Null.</span></div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;<span class="comment"></span>    <a class="code" href="classllvm_1_1Value.html">Value</a> *VectorizedValue;</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;<span class="comment">    /// The index in the basic block of the last scalar.</span></div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="comment"></span>    <span class="keywordtype">int</span> LastScalarIndex;</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;<span class="comment">    /// Do we need to gather this sequence ?</span></div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;<span class="comment"></span>    <span class="keywordtype">bool</span> NeedToGather;</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;  };</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;<span class="comment">  /// Create a new VectorizableTree entry.</span></div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;<span class="comment"></span>  TreeEntry *newTreeEntry(<a class="code" href="classllvm_1_1ArrayRef.html">ArrayRef&lt;Value *&gt;</a> VL, <span class="keywordtype">bool</span> Vectorized) {</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    VectorizableTree.push_back(TreeEntry());</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    <span class="keywordtype">int</span> idx = VectorizableTree.size() - 1;</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    TreeEntry *Last = &amp;VectorizableTree[idx];</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    Last-&gt;Scalars.insert(Last-&gt;Scalars.begin(), VL.<a class="code" href="classllvm_1_1ArrayRef.html#a836367b39ed630bf14db99923c22740e">begin</a>(), VL.<a class="code" href="classllvm_1_1ArrayRef.html#a38ed8cc3c342ad6910e8c869d3e2b9cf">end</a>());</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    Last-&gt;NeedToGather = !Vectorized;</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    <span class="keywordflow">if</span> (Vectorized) {</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;      Last-&gt;LastScalarIndex = getLastIndex(VL);</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0, e = VL.<a class="code" href="classllvm_1_1ArrayRef.html#a76878250107ee24ef7339870bdda4bcf">size</a>(); <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != e; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;        assert(!ScalarToTreeEntry.count(VL[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>]) &amp;&amp; <span class="stringliteral">&quot;Scalar already in tree!&quot;</span>);</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;        ScalarToTreeEntry[VL[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>]] = idx;</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;      }</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;      Last-&gt;LastScalarIndex = 0;</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;      MustGather.insert(VL.<a class="code" href="classllvm_1_1ArrayRef.html#a836367b39ed630bf14db99923c22740e">begin</a>(), VL.<a class="code" href="classllvm_1_1ArrayRef.html#a38ed8cc3c342ad6910e8c869d3e2b9cf">end</a>());</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    }</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    <span class="keywordflow">return</span> Last;</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;  }</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;<span class="comment">  /// -- Vectorization State --</span></div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;<span class="comment">  /// Holds all of the tree entries.</span></div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;<span class="comment"></span>  std::vector&lt;TreeEntry&gt; VectorizableTree;</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;<span class="comment">  /// Maps a specific scalar to its tree entry.</span></div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1SmallDenseMap.html">SmallDenseMap&lt;Value*, int&gt;</a> ScalarToTreeEntry;</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;<span class="comment">  /// A list of scalars that we found that we need to keep as scalars.</span></div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;<span class="comment"></span>  ValueSet MustGather;</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;<span class="comment">  /// This POD struct describes one external user in the vectorized tree.</span></div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;<span class="comment"></span>  <span class="keyword">struct </span>ExternalUser {</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    ExternalUser (<a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>, <a class="code" href="classllvm_1_1User.html">llvm::User</a> *U, <span class="keywordtype">int</span> L) :</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;      <a class="code" href="namespacellvm_1_1NVPTX_1_1PTXLdStInstCode.html#a91119cbee2be000c528a690252aee07ca09c68d67f7dbfa6cc77eaf73aa535217">Scalar</a>(S), <a class="code" href="classllvm_1_1User.html">User</a>(U), Lane(L){};</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    <span class="comment">// Which scalar in our function.</span></div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1NVPTX_1_1PTXLdStInstCode.html#a91119cbee2be000c528a690252aee07ca09c68d67f7dbfa6cc77eaf73aa535217">Scalar</a>;</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    <span class="comment">// Which user that uses the scalar.</span></div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    <a class="code" href="classllvm_1_1User.html">llvm::User</a> *<a class="code" href="classllvm_1_1User.html">User</a>;</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    <span class="comment">// Which lane does the scalar belong to.</span></div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    <span class="keywordtype">int</span> Lane;</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;  };</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;  <span class="keyword">typedef</span> <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;ExternalUser, 16&gt;</a> UserList;</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;<span class="comment">  /// A list of values that need to extracted out of the tree.</span></div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;<span class="comment">  /// This list holds pairs of (Internal Scalar : External User).</span></div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;<span class="comment"></span>  UserList ExternalUses;</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<span class="comment">  /// A list of instructions to ignore while sinking</span></div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<span class="comment">  /// memory instructions. This map must be reset between runs of getCost.</span></div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;<span class="comment"></span>  ValueSet MemBarrierIgnoreList;</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;<span class="comment">  /// Holds all of the instructions that we gathered.</span></div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1SetVector.html">SetVector&lt;Instruction *&gt;</a> GatherSeq;<span class="comment"></span></div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;<span class="comment">  /// A list of blocks that we are going to CSE.</span></div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1SmallSet.html">SmallSet&lt;BasicBlock *, 8&gt;</a> CSEBlocks;</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;<span class="comment">  /// Numbers instructions in different blocks.</span></div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;BasicBlock *, BlockNumbering&gt;</a> BlocksNumbers;</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;<span class="comment">  /// Reduction operators.</span></div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;<span class="comment"></span>  ValueSet *RdxOps;</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;  <span class="comment">// Analysis and block reference.</span></div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;  <a class="code" href="classllvm_1_1Function.html">Function</a> *<a class="code" href="LLParser_8cpp.html#a33ece1ef8074506a15d7f86eb76dbae6">F</a>;</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;  <a class="code" href="classllvm_1_1ScalarEvolution.html">ScalarEvolution</a> *SE;</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;  <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> *DL;</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;  <a class="code" href="classllvm_1_1TargetTransformInfo.html">TargetTransformInfo</a> *TTI;</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;  <a class="code" href="classllvm_1_1AliasAnalysis.html">AliasAnalysis</a> *AA;</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;  <a class="code" href="classllvm_1_1LoopInfo.html">LoopInfo</a> *LI;</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;  <a class="code" href="classllvm_1_1DominatorTree.html">DominatorTree</a> *DT;<span class="comment"></span></div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;<span class="comment">  /// Instruction builder to construct the vectorized tree.</span></div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> Builder;</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;};</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;<span class="keywordtype">void</span> BoUpSLP::buildTree(<a class="code" href="classllvm_1_1ArrayRef.html">ArrayRef&lt;Value *&gt;</a> Roots, ValueSet *Rdx) {</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;  deleteTree();</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;  RdxOps = Rdx;</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;  <span class="keywordflow">if</span> (!getSameType(Roots))</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;  buildTree_rec(Roots, 0);</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;  <span class="comment">// Collect the values that we need to extract from the tree.</span></div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> EIdx = 0, EE = VectorizableTree.size(); EIdx &lt; EE; ++EIdx) {</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    TreeEntry *Entry = &amp;VectorizableTree[EIdx];</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    <span class="comment">// For each lane:</span></div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> Lane = 0, <a class="code" href="namespacellvm_1_1A64CC.html#af5804bc0518be9568f73db566e4d6f46a98d7f1cf15bd78fd7c7c68e6543a9588">LE</a> = Entry-&gt;Scalars.size(); Lane != <a class="code" href="namespacellvm_1_1A64CC.html#af5804bc0518be9568f73db566e4d6f46a98d7f1cf15bd78fd7c7c68e6543a9588">LE</a>; ++Lane) {</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1NVPTX_1_1PTXLdStInstCode.html#a91119cbee2be000c528a690252aee07ca09c68d67f7dbfa6cc77eaf73aa535217">Scalar</a> = Entry-&gt;Scalars[Lane];</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;      <span class="comment">// No need to handle users of gathered values.</span></div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;      <span class="keywordflow">if</span> (Entry-&gt;NeedToGather)</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1value__use__iterator.html">Value::use_iterator</a> <a class="code" href="classllvm_1_1User.html">User</a> = Scalar-&gt;<a class="code" href="classllvm_1_1Value.html#a413abcab8dbc3900fc2fde96a5d8fca6">use_begin</a>(),</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;           UE = Scalar-&gt;<a class="code" href="classllvm_1_1Value.html#ad86469939d2a8bdd4169be9403b89f5a">use_end</a>(); <a class="code" href="classllvm_1_1User.html">User</a> != UE; ++<a class="code" href="classllvm_1_1User.html">User</a>) {</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;        <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;SLP: Checking user:&quot;</span> &lt;&lt; **<a class="code" href="classllvm_1_1User.html">User</a> &lt;&lt; <span class="stringliteral">&quot;.\n&quot;</span>);</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;        <span class="comment">// Skip in-tree scalars that become vectors.</span></div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;        <span class="keywordflow">if</span> (ScalarToTreeEntry.count(*<a class="code" href="classllvm_1_1User.html">User</a>)) {</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;          <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;SLP: \tInternal user will be removed:&quot;</span> &lt;&lt;</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;                **<a class="code" href="classllvm_1_1User.html">User</a> &lt;&lt; <span class="stringliteral">&quot;.\n&quot;</span>);</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;          <span class="keywordtype">int</span> Idx = ScalarToTreeEntry[*<a class="code" href="classllvm_1_1User.html">User</a>]; (void) Idx;</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;          assert(!VectorizableTree[Idx].NeedToGather &amp;&amp; <span class="stringliteral">&quot;Bad state&quot;</span>);</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;          <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;        }</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;        <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *UserInst = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1Instruction.html">Instruction</a>&gt;(*User);</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;        <span class="keywordflow">if</span> (!UserInst)</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;          <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;        <span class="comment">// Ignore uses that are part of the reduction.</span></div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;        <span class="keywordflow">if</span> (Rdx &amp;&amp; std::find(Rdx-&gt;begin(), Rdx-&gt;end(), UserInst) != Rdx-&gt;end())</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;          <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;        <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;SLP: Need to extract:&quot;</span> &lt;&lt; **User &lt;&lt; <span class="stringliteral">&quot; from lane &quot;</span> &lt;&lt;</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;              Lane &lt;&lt; <span class="stringliteral">&quot; from &quot;</span> &lt;&lt; *Scalar &lt;&lt; <span class="stringliteral">&quot;.\n&quot;</span>);</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;        ExternalUses.push_back(ExternalUser(Scalar, *User, Lane));</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;      }</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    }</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;  }</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;}</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;<span class="keywordtype">void</span> BoUpSLP::buildTree_rec(<a class="code" href="classllvm_1_1ArrayRef.html">ArrayRef&lt;Value *&gt;</a> VL, <span class="keywordtype">unsigned</span> Depth) {</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;  <span class="keywordtype">bool</span> SameTy = getSameType(VL); (void)SameTy;</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;  assert(SameTy &amp;&amp; <span class="stringliteral">&quot;Invalid types!&quot;</span>);</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;  <span class="keywordflow">if</span> (Depth == RecursionMaxDepth) {</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;SLP: Gathering due to max recursion depth.\n&quot;</span>);</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;    newTreeEntry(VL, <span class="keyword">false</span>);</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;  }</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;  <span class="comment">// Don&#39;t handle vectors.</span></div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;  <span class="keywordflow">if</span> (VL[0]-&gt;<a class="code" href="namespacellvm_1_1Intrinsic.html#ac015f68d60ea67a2e31bc10bc720d3e8">getType</a>()-&gt;isVectorTy()) {</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;    <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;SLP: Gathering due to vector type.\n&quot;</span>);</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    newTreeEntry(VL, <span class="keyword">false</span>);</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;  }</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1StoreInst.html">StoreInst</a> *SI = dyn_cast&lt;StoreInst&gt;(VL[0]))</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    <span class="keywordflow">if</span> (SI-&gt;getValueOperand()-&gt;getType()-&gt;isVectorTy()) {</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;      <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;SLP: Gathering due to store vector type.\n&quot;</span>);</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;      newTreeEntry(VL, <span class="keyword">false</span>);</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    }</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;  <span class="comment">// If all of the operands are identical or constant we have a simple solution.</span></div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;  <span class="keywordflow">if</span> (allConstant(VL) || isSplat(VL) || !getSameBlock(VL) ||</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;      !getSameOpcode(VL)) {</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;    <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;SLP: Gathering due to C,S,B,O. \n&quot;</span>);</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;    newTreeEntry(VL, <span class="keyword">false</span>);</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;  }</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;  <span class="comment">// We now know that this is a vector of instructions of the same type from</span></div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;  <span class="comment">// the same block.</span></div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;  <span class="comment">// Check if this is a duplicate of another entry.</span></div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;  <span class="keywordflow">if</span> (ScalarToTreeEntry.count(VL[0])) {</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    <span class="keywordtype">int</span> Idx = ScalarToTreeEntry[VL[0]];</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    TreeEntry *E = &amp;VectorizableTree[Idx];</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0, e = VL.size(); <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != e; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;      <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;SLP: \tChecking bundle: &quot;</span> &lt;&lt; *VL[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>] &lt;&lt; <span class="stringliteral">&quot;.\n&quot;</span>);</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;      <span class="keywordflow">if</span> (E-&gt;Scalars[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>] != VL[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>]) {</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;        <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;SLP: Gathering due to partial overlap.\n&quot;</span>);</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;        newTreeEntry(VL, <span class="keyword">false</span>);</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;      }</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    }</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;    <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;SLP: Perfect diamond merge at &quot;</span> &lt;&lt; *VL[0] &lt;&lt; <span class="stringliteral">&quot;.\n&quot;</span>);</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;  }</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;  <span class="comment">// Check that none of the instructions in the bundle are already in the tree.</span></div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0, e = VL.size(); i != e; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    <span class="keywordflow">if</span> (ScalarToTreeEntry.count(VL[i])) {</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;      <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;SLP: The instruction (&quot;</span> &lt;&lt; *VL[i] &lt;&lt;</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;            <span class="stringliteral">&quot;) is already in tree.\n&quot;</span>);</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;      newTreeEntry(VL, <span class="keyword">false</span>);</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;    }</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;  }</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;  <span class="comment">// If any of the scalars appears in the table OR it is marked as a value that</span></div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;  <span class="comment">// needs to stat scalar then we need to gather the scalars.</span></div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0, e = VL.size(); i != e; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;    <span class="keywordflow">if</span> (ScalarToTreeEntry.count(VL[i]) || MustGather.count(VL[i])) {</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;      <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;SLP: Gathering due to gathered scalar. \n&quot;</span>);</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;      newTreeEntry(VL, <span class="keyword">false</span>);</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    }</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;  }</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;  <span class="comment">// Check that all of the users of the scalars that we want to vectorize are</span></div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;  <span class="comment">// schedulable.</span></div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *VL0 = cast&lt;Instruction&gt;(VL[0]);</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;  <span class="keywordtype">int</span> MyLastIndex = getLastIndex(VL);</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *BB = cast&lt;Instruction&gt;(VL0)-&gt;<a class="code" href="BasicAliasAnalysis_8cpp.html#a2675de1d8479c7b00387979714da43f7">getParent</a>();</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0, e = VL.size(); i != e; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *Scalar = cast&lt;Instruction&gt;(VL[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;SLP: Checking users of  &quot;</span> &lt;&lt; *Scalar &lt;&lt; <span class="stringliteral">&quot;. \n&quot;</span>);</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1value__use__iterator.html">Value::use_iterator</a> U = Scalar-&gt;<a class="code" href="classllvm_1_1Value.html#a413abcab8dbc3900fc2fde96a5d8fca6">use_begin</a>(), UE = Scalar-&gt;<a class="code" href="classllvm_1_1Value.html#ad86469939d2a8bdd4169be9403b89f5a">use_end</a>();</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;         U != UE; ++U) {</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;      <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;SLP: \tUser &quot;</span> &lt;&lt; **U &lt;&lt; <span class="stringliteral">&quot;. \n&quot;</span>);</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;      <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *User = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1Instruction.html">Instruction</a>&gt;(*U);</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;      <span class="keywordflow">if</span> (!User) {</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;        <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;SLP: Gathering due unknown user. \n&quot;</span>);</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;        newTreeEntry(VL, <span class="keyword">false</span>);</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;      }</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;      <span class="comment">// We don&#39;t care if the user is in a different basic block.</span></div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;      <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *UserBlock = User-&gt;<a class="code" href="classllvm_1_1Instruction.html#a9cd49851904f15060edb782ef4dd1b2d">getParent</a>();</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;      <span class="keywordflow">if</span> (UserBlock != BB) {</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;        <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;SLP: User from a different basic block &quot;</span></div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;              &lt;&lt; *User &lt;&lt; <span class="stringliteral">&quot;. \n&quot;</span>);</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;      }</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;      <span class="comment">// If this is a PHINode within this basic block then we can place the</span></div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;      <span class="comment">// extract wherever we want.</span></div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;      <span class="keywordflow">if</span> (isa&lt;PHINode&gt;(*User)) {</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;        <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;SLP: \tWe can schedule PHIs:&quot;</span> &lt;&lt; *User &lt;&lt; <span class="stringliteral">&quot;. \n&quot;</span>);</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;      }</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;      <span class="comment">// Check if this is a safe in-tree user.</span></div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;      <span class="keywordflow">if</span> (ScalarToTreeEntry.count(User)) {</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;        <span class="keywordtype">int</span> Idx = ScalarToTreeEntry[User];</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;        <span class="keywordtype">int</span> VecLocation = VectorizableTree[Idx].LastScalarIndex;</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;        <span class="keywordflow">if</span> (VecLocation &lt;= MyLastIndex) {</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;          <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;SLP: Gathering due to unschedulable vector. \n&quot;</span>);</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;          newTreeEntry(VL, <span class="keyword">false</span>);</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;          <span class="keywordflow">return</span>;</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;        }</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;        <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;SLP: In-tree user (&quot;</span> &lt;&lt; *User &lt;&lt; <span class="stringliteral">&quot;) at #&quot;</span> &lt;&lt;</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;              VecLocation &lt;&lt; <span class="stringliteral">&quot; vector value (&quot;</span> &lt;&lt; *Scalar &lt;&lt; <span class="stringliteral">&quot;) at #&quot;</span></div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;              &lt;&lt; MyLastIndex &lt;&lt; <span class="stringliteral">&quot;.\n&quot;</span>);</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;      }</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;      <span class="comment">// This user is part of the reduction.</span></div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;      <span class="keywordflow">if</span> (RdxOps &amp;&amp; RdxOps-&gt;count(User))</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;      <span class="comment">// Make sure that we can schedule this unknown user.</span></div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;      BlockNumbering &amp;BN = BlocksNumbers[<a class="code" href="CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>];</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;      <span class="keywordtype">int</span> UserIndex = BN.getIndex(User);</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;      <span class="keywordflow">if</span> (UserIndex &lt; MyLastIndex) {</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;        <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;SLP: Can&#39;t schedule extractelement for &quot;</span></div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;              &lt;&lt; *User &lt;&lt; <span class="stringliteral">&quot;. \n&quot;</span>);</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;        newTreeEntry(VL, <span class="keyword">false</span>);</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;      }</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;    }</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;  }</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;  <span class="comment">// Check that every instructions appears once in this bundle.</span></div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0, e = VL.size(); i &lt; e; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a> = i+1; <a class="code" href="Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a> &lt; e; ++<a class="code" href="Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a>)</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;      <span class="keywordflow">if</span> (VL[i] == VL[<a class="code" href="Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a>]) {</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;        <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;SLP: Scalar used twice in bundle.\n&quot;</span>);</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;        newTreeEntry(VL, <span class="keyword">false</span>);</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;      }</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;  <span class="comment">// Check that instructions in this bundle don&#39;t reference other instructions.</span></div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;  <span class="comment">// The runtime of this check is O(N * N-1 * uses(N)) and a typical N is 4.</span></div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0, e = VL.size(); i &lt; e; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1value__use__iterator.html">Value::use_iterator</a> U = VL[i]-&gt;use_begin(), UE = VL[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;use_end();</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;         U != UE; ++U) {</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = 0; j &lt; e; ++<a class="code" href="Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a>) {</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;        <span class="keywordflow">if</span> (i != j &amp;&amp; *U == VL[j]) {</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;          <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;SLP: Intra-bundle dependencies!&quot;</span> &lt;&lt; **U &lt;&lt; <span class="stringliteral">&quot;. \n&quot;</span>);</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;          newTreeEntry(VL, <span class="keyword">false</span>);</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;          <span class="keywordflow">return</span>;</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;        }</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;      }</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;    }</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;  }</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;  <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;SLP: We are able to schedule this bundle.\n&quot;</span>);</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;  <span class="keywordtype">unsigned</span> Opcode = getSameOpcode(VL);</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;  <span class="comment">// Check if it is safe to sink the loads or the stores.</span></div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;  <span class="keywordflow">if</span> (Opcode == <a class="code" href="namespacellvm_1_1SPII.html#a11e9b8fca4a074643a6a21f444e51406a5069619ca8fdce305534f3fe85091a0f">Instruction::Load</a> || Opcode == <a class="code" href="namespacellvm_1_1SPII.html#a11e9b8fca4a074643a6a21f444e51406a36b3dd3b84fde3f8494a9b18af131856">Instruction::Store</a>) {</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *Last = getLastInstruction(VL);</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0, e = VL.size(); i &lt; e; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;      <span class="keywordflow">if</span> (VL[i] == Last)</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1MCID.html#a8035044d40d3758eb45b65dce69dc90ba24b6e620b18edd37201fb9c0897835a8">Barrier</a> = getSinkBarrier(cast&lt;Instruction&gt;(VL[i]), Last);</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;      <span class="keywordflow">if</span> (Barrier) {</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;        <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;SLP: Can&#39;t sink &quot;</span> &lt;&lt; *VL[i] &lt;&lt; <span class="stringliteral">&quot;\n down to &quot;</span> &lt;&lt; *Last</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;\n because of &quot;</span> &lt;&lt; *Barrier &lt;&lt; <span class="stringliteral">&quot;.  Gathering.\n&quot;</span>);</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;        newTreeEntry(VL, <span class="keyword">false</span>);</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;      }</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;    }</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;  }</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;  <span class="keywordflow">switch</span> (Opcode) {</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1TargetOpcode.html#a348d4259b5fa6a8ecfe94e7ae512e1a8ae41f9ca68ba5e8b9613cea03652ebd72">Instruction::PHI</a>: {</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;      <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *PH = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1PHINode.html">PHINode</a>&gt;(VL0);</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;      <span class="comment">// Check for terminator values (e.g. invoke).</span></div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = 0; j &lt; VL.size(); ++<a class="code" href="Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a>)</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0, e = PH-&gt;<a class="code" href="classllvm_1_1PHINode.html#aa45f6c0433576e3858a6209a43750ad4">getNumIncomingValues</a>(); i &lt; e; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;          <a class="code" href="classllvm_1_1TerminatorInst.html">TerminatorInst</a> *Term = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1TerminatorInst.html">TerminatorInst</a>&gt;(cast&lt;PHINode&gt;(VL[<a class="code" href="Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a>])-&gt;getIncomingValue(i));</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;          <span class="keywordflow">if</span> (Term) {</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;            <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;SLP: Need to swizzle PHINodes (TerminatorInst use).\n&quot;</span>);</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;            newTreeEntry(VL, <span class="keyword">false</span>);</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;            <span class="keywordflow">return</span>;</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;          }</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;        }</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;      newTreeEntry(VL, <span class="keyword">true</span>);</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;      <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;SLP: added a vector of PHINodes.\n&quot;</span>);</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0, e = PH-&gt;<a class="code" href="classllvm_1_1PHINode.html#aa45f6c0433576e3858a6209a43750ad4">getNumIncomingValues</a>(); i &lt; e; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;        ValueList Operands;</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;        <span class="comment">// Prepare the operand vector.</span></div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = 0; j &lt; VL.size(); ++<a class="code" href="Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a>)</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;          Operands.push_back(cast&lt;PHINode&gt;(VL[j])-&gt;getIncomingValue(i));</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;        buildTree_rec(Operands, Depth + 1);</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;      }</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;    }</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="InstCombineCompares_8cpp.html#aa5ab8c7b55d8bc7cab66be444daa70a1">Instruction::ExtractElement</a>: {</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;      <span class="keywordtype">bool</span> Reuse = CanReuseExtract(VL);</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;      <span class="keywordflow">if</span> (Reuse) {</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;        <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;SLP: Reusing extract sequence.\n&quot;</span>);</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;      }</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;      newTreeEntry(VL, Reuse);</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;    }</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1SPII.html#a11e9b8fca4a074643a6a21f444e51406a5069619ca8fdce305534f3fe85091a0f">Instruction::Load</a>: {</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;      <span class="comment">// Check if the loads are consecutive or of we need to swizzle them.</span></div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0, e = VL.size() - 1; i &lt; e; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;        <a class="code" href="classllvm_1_1LoadInst.html">LoadInst</a> *L = cast&lt;LoadInst&gt;(VL[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;        <span class="keywordflow">if</span> (!L-&gt;<a class="code" href="classllvm_1_1LoadInst.html#a156c478ee8e7d1602143cdbad4bd5385">isSimple</a>() || !isConsecutiveAccess(VL[i], VL[i + 1])) {</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;          newTreeEntry(VL, <span class="keyword">false</span>);</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;          <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;SLP: Need to swizzle loads.\n&quot;</span>);</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;          <span class="keywordflow">return</span>;</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;        }</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;      }</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;      newTreeEntry(VL, <span class="keyword">true</span>);</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;      <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;SLP: added a vector of loads.\n&quot;</span>);</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;    }</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;    <span class="keywordflow">case</span> Instruction::ZExt:</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;    <span class="keywordflow">case</span> Instruction::SExt:</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;    <span class="keywordflow">case</span> Instruction::FPToUI:</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;    <span class="keywordflow">case</span> Instruction::FPToSI:</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;    <span class="keywordflow">case</span> Instruction::FPExt:</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;    <span class="keywordflow">case</span> Instruction::PtrToInt:</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;    <span class="keywordflow">case</span> Instruction::IntToPtr:</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;    <span class="keywordflow">case</span> Instruction::SIToFP:</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;    <span class="keywordflow">case</span> Instruction::UIToFP:</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;    <span class="keywordflow">case</span> Instruction::Trunc:</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;    <span class="keywordflow">case</span> Instruction::FPTrunc:</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;    <span class="keywordflow">case</span> Instruction::BitCast: {</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;      <a class="code" href="classllvm_1_1Type.html">Type</a> *SrcTy = VL0-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0)-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>();</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; VL.size(); ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;        <a class="code" href="classllvm_1_1Type.html">Type</a> *Ty = cast&lt;Instruction&gt;(VL[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>])-&gt;getOperand(0)-&gt;getType();</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;        <span class="keywordflow">if</span> (Ty != SrcTy || Ty-&gt;<a class="code" href="classllvm_1_1Type.html#a0a32c2cb0342323dc78f6aa31d7e581e">isAggregateType</a>() || Ty-&gt;<a class="code" href="classllvm_1_1Type.html#a6f725580f7834e2ca90762965866dad4">isVectorTy</a>()) {</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;          newTreeEntry(VL, <span class="keyword">false</span>);</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;          <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;SLP: Gathering casts with different src types.\n&quot;</span>);</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;          <span class="keywordflow">return</span>;</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;        }</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;      }</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;      newTreeEntry(VL, <span class="keyword">true</span>);</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;      <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;SLP: added a vector of casts.\n&quot;</span>);</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0, e = VL0-&gt;<a class="code" href="classllvm_1_1User.html#a2f81e0c1fc6554df7ad2eafabf5fc5a5">getNumOperands</a>(); i &lt; e; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;        ValueList Operands;</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;        <span class="comment">// Prepare the operand vector.</span></div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = 0; j &lt; VL.size(); ++<a class="code" href="Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a>)</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;          Operands.push_back(cast&lt;Instruction&gt;(VL[j])-&gt;getOperand(i));</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;        buildTree_rec(Operands, Depth+1);</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;      }</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;    }</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;    <span class="keywordflow">case</span> Instruction::ICmp:</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;    <span class="keywordflow">case</span> Instruction::FCmp: {</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;      <span class="comment">// Check that all of the compares have the same predicate.</span></div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;      <a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05">CmpInst::Predicate</a> P0 = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1CmpInst.html">CmpInst</a>&gt;(VL0)-&gt;getPredicate();</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;      <a class="code" href="classllvm_1_1Type.html">Type</a> *ComparedTy = cast&lt;Instruction&gt;(VL[0])-&gt;getOperand(0)-&gt;getType();</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 1, e = VL.size(); i &lt; e; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;        <a class="code" href="classllvm_1_1CmpInst.html">CmpInst</a> *Cmp = cast&lt;CmpInst&gt;(VL[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;        <span class="keywordflow">if</span> (Cmp-&gt;<a class="code" href="classllvm_1_1CmpInst.html#a8afd4995fae596b2c86eeed85b3d388b">getPredicate</a>() != P0 ||</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;            Cmp-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0)-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>() != ComparedTy) {</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;          newTreeEntry(VL, <span class="keyword">false</span>);</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;          <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;SLP: Gathering cmp with different predicate.\n&quot;</span>);</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;          <span class="keywordflow">return</span>;</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;        }</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;      }</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;      newTreeEntry(VL, <span class="keyword">true</span>);</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;      <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;SLP: added a vector of compares.\n&quot;</span>);</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0, e = VL0-&gt;<a class="code" href="classllvm_1_1User.html#a2f81e0c1fc6554df7ad2eafabf5fc5a5">getNumOperands</a>(); i &lt; e; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;        ValueList Operands;</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;        <span class="comment">// Prepare the operand vector.</span></div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = 0; j &lt; VL.size(); ++<a class="code" href="Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a>)</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;          Operands.push_back(cast&lt;Instruction&gt;(VL[j])-&gt;getOperand(i));</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;        buildTree_rec(Operands, Depth+1);</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;      }</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;    }</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1MCID.html#a8035044d40d3758eb45b65dce69dc90ba32dbd2c72a98eaee90e3ad5ef7b5af16">Instruction::Select</a>:</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;    <span class="keywordflow">case</span> Instruction::Add:</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;    <span class="keywordflow">case</span> Instruction::FAdd:</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;    <span class="keywordflow">case</span> Instruction::Sub:</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;    <span class="keywordflow">case</span> Instruction::FSub:</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;    <span class="keywordflow">case</span> Instruction::Mul:</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;    <span class="keywordflow">case</span> Instruction::FMul:</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;    <span class="keywordflow">case</span> Instruction::UDiv:</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;    <span class="keywordflow">case</span> Instruction::SDiv:</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;    <span class="keywordflow">case</span> Instruction::FDiv:</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;    <span class="keywordflow">case</span> Instruction::URem:</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;    <span class="keywordflow">case</span> Instruction::SRem:</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;    <span class="keywordflow">case</span> Instruction::FRem:</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;    <span class="keywordflow">case</span> Instruction::Shl:</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;    <span class="keywordflow">case</span> Instruction::LShr:</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;    <span class="keywordflow">case</span> Instruction::AShr:</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1APIntOps.html#a684cfe02c582e8d75cd6d457e63e6c25">Instruction::And</a>:</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1APIntOps.html#a22f056804d2b9882f74adc905872bc39">Instruction::Or</a>:</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1APIntOps.html#afc7c4d88d09cba0c5e920f8a3a3ace55">Instruction::Xor</a>: {</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;      newTreeEntry(VL, <span class="keyword">true</span>);</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;      <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;SLP: added a vector of bin op.\n&quot;</span>);</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;      <span class="comment">// Sort operands of the instructions so that each side is more likely to</span></div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;      <span class="comment">// have the same opcode.</span></div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;      <span class="keywordflow">if</span> (isa&lt;BinaryOperator&gt;(VL0) &amp;&amp; VL0-&gt;<a class="code" href="classllvm_1_1Instruction.html#a1c2048f254df730c4de1643ec791ddf9">isCommutative</a>()) {</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;        ValueList Left, Right;</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;        reorderInputsAccordingToOpcode(VL, Left, Right);</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;        buildTree_rec(Left, Depth + 1);</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;        buildTree_rec(Right, Depth + 1);</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;      }</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0, e = VL0-&gt;<a class="code" href="classllvm_1_1User.html#a2f81e0c1fc6554df7ad2eafabf5fc5a5">getNumOperands</a>(); i &lt; e; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;        ValueList Operands;</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;        <span class="comment">// Prepare the operand vector.</span></div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = 0; j &lt; VL.size(); ++<a class="code" href="Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a>)</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;          Operands.push_back(cast&lt;Instruction&gt;(VL[j])-&gt;getOperand(i));</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;        buildTree_rec(Operands, Depth+1);</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;      }</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;    }</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1SPII.html#a11e9b8fca4a074643a6a21f444e51406a36b3dd3b84fde3f8494a9b18af131856">Instruction::Store</a>: {</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;      <span class="comment">// Check if the stores are consecutive or of we need to swizzle them.</span></div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0, e = VL.size() - 1; i &lt; e; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;        <span class="keywordflow">if</span> (!isConsecutiveAccess(VL[i], VL[i + 1])) {</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;          newTreeEntry(VL, <span class="keyword">false</span>);</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;          <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;SLP: Non consecutive store.\n&quot;</span>);</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;          <span class="keywordflow">return</span>;</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;        }</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;      newTreeEntry(VL, <span class="keyword">true</span>);</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;      <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;SLP: added a vector of stores.\n&quot;</span>);</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;      ValueList Operands;</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = 0; j &lt; VL.size(); ++<a class="code" href="Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a>)</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;        Operands.push_back(cast&lt;Instruction&gt;(VL[j])-&gt;getOperand(0));</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;      <span class="comment">// We can ignore these values because we are sinking them down.</span></div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;      MemBarrierIgnoreList.insert(VL.begin(), VL.end());</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;      buildTree_rec(Operands, Depth + 1);</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;    }</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;    <span class="keywordflow">default</span>:</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;      newTreeEntry(VL, <span class="keyword">false</span>);</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;      <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;SLP: Gathering unknown instruction.\n&quot;</span>);</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;  }</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;}</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;<span class="keywordtype">int</span> BoUpSLP::getEntryCost(TreeEntry *E) {</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;  <a class="code" href="classllvm_1_1ArrayRef.html">ArrayRef&lt;Value*&gt;</a> VL = E-&gt;Scalars;</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *ScalarTy = VL[0]-&gt;getType();</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1StoreInst.html">StoreInst</a> *SI = dyn_cast&lt;StoreInst&gt;(VL[0]))</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;    ScalarTy = SI-&gt;getValueOperand()-&gt;getType();</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;  <a class="code" href="classllvm_1_1VectorType.html">VectorType</a> *VecTy = <a class="code" href="classllvm_1_1VectorType.html#ab43657ed1abe2e2ed3a6a394f233ebd0">VectorType::get</a>(ScalarTy, VL.<a class="code" href="classllvm_1_1ArrayRef.html#a76878250107ee24ef7339870bdda4bcf">size</a>());</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;  <span class="keywordflow">if</span> (E-&gt;NeedToGather) {</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;    <span class="keywordflow">if</span> (allConstant(VL))</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;    <span class="keywordflow">if</span> (isSplat(VL)) {</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;      <span class="keywordflow">return</span> TTI-&gt;getShuffleCost(<a class="code" href="classllvm_1_1TargetTransformInfo.html#af46433d0e36d3f80afc3a8c67b5c53ecab1ac8982cdb119f39a5fe74610a46796">TargetTransformInfo::SK_Broadcast</a>, VecTy, 0);</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;    }</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;    <span class="keywordflow">return</span> getGatherCost(E-&gt;Scalars);</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;  }</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;  assert(getSameOpcode(VL) &amp;&amp; getSameType(VL) &amp;&amp; getSameBlock(VL) &amp;&amp;</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;         <span class="stringliteral">&quot;Invalid VL&quot;</span>);</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *VL0 = cast&lt;Instruction&gt;(VL[0]);</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;  <span class="keywordtype">unsigned</span> Opcode = VL0-&gt;<a class="code" href="classllvm_1_1Instruction.html#a021bb7c9aad6003fe8089f6327356c6c">getOpcode</a>();</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;  <span class="keywordflow">switch</span> (Opcode) {</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1TargetOpcode.html#a348d4259b5fa6a8ecfe94e7ae512e1a8ae41f9ca68ba5e8b9613cea03652ebd72">Instruction::PHI</a>: {</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;    }</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="InstCombineCompares_8cpp.html#aa5ab8c7b55d8bc7cab66be444daa70a1">Instruction::ExtractElement</a>: {</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;      <span class="keywordflow">if</span> (CanReuseExtract(VL))</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;        <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;      <span class="keywordflow">return</span> getGatherCost(VecTy);</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;    }</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;    <span class="keywordflow">case</span> Instruction::ZExt:</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;    <span class="keywordflow">case</span> Instruction::SExt:</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;    <span class="keywordflow">case</span> Instruction::FPToUI:</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;    <span class="keywordflow">case</span> Instruction::FPToSI:</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;    <span class="keywordflow">case</span> Instruction::FPExt:</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;    <span class="keywordflow">case</span> Instruction::PtrToInt:</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;    <span class="keywordflow">case</span> Instruction::IntToPtr:</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;    <span class="keywordflow">case</span> Instruction::SIToFP:</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;    <span class="keywordflow">case</span> Instruction::UIToFP:</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;    <span class="keywordflow">case</span> Instruction::Trunc:</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;    <span class="keywordflow">case</span> Instruction::FPTrunc:</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;    <span class="keywordflow">case</span> Instruction::BitCast: {</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;      <a class="code" href="classllvm_1_1Type.html">Type</a> *SrcTy = VL0-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0)-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>();</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;      <span class="comment">// Calculate the cost of this instruction.</span></div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;      <span class="keywordtype">int</span> ScalarCost = VL.<a class="code" href="classllvm_1_1ArrayRef.html#a76878250107ee24ef7339870bdda4bcf">size</a>() * TTI-&gt;getCastInstrCost(VL0-&gt;<a class="code" href="classllvm_1_1Instruction.html#a021bb7c9aad6003fe8089f6327356c6c">getOpcode</a>(),</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;                                                         VL0-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>(), SrcTy);</div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;      <a class="code" href="classllvm_1_1VectorType.html">VectorType</a> *SrcVecTy = <a class="code" href="classllvm_1_1VectorType.html#ab43657ed1abe2e2ed3a6a394f233ebd0">VectorType::get</a>(SrcTy, VL.<a class="code" href="classllvm_1_1ArrayRef.html#a76878250107ee24ef7339870bdda4bcf">size</a>());</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;      <span class="keywordtype">int</span> VecCost = TTI-&gt;getCastInstrCost(VL0-&gt;<a class="code" href="classllvm_1_1Instruction.html#a021bb7c9aad6003fe8089f6327356c6c">getOpcode</a>(), VecTy, SrcVecTy);</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;      <span class="keywordflow">return</span> VecCost - ScalarCost;</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;    }</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;    <span class="keywordflow">case</span> Instruction::FCmp:</div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;    <span class="keywordflow">case</span> Instruction::ICmp:</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1MCID.html#a8035044d40d3758eb45b65dce69dc90ba32dbd2c72a98eaee90e3ad5ef7b5af16">Instruction::Select</a>:</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;    <span class="keywordflow">case</span> Instruction::Add:</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;    <span class="keywordflow">case</span> Instruction::FAdd:</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;    <span class="keywordflow">case</span> Instruction::Sub:</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;    <span class="keywordflow">case</span> Instruction::FSub:</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;    <span class="keywordflow">case</span> Instruction::Mul:</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;    <span class="keywordflow">case</span> Instruction::FMul:</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;    <span class="keywordflow">case</span> Instruction::UDiv:</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;    <span class="keywordflow">case</span> Instruction::SDiv:</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;    <span class="keywordflow">case</span> Instruction::FDiv:</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;    <span class="keywordflow">case</span> Instruction::URem:</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;    <span class="keywordflow">case</span> Instruction::SRem:</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;    <span class="keywordflow">case</span> Instruction::FRem:</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;    <span class="keywordflow">case</span> Instruction::Shl:</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;    <span class="keywordflow">case</span> Instruction::LShr:</div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;    <span class="keywordflow">case</span> Instruction::AShr:</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1APIntOps.html#a684cfe02c582e8d75cd6d457e63e6c25">Instruction::And</a>:</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1APIntOps.html#a22f056804d2b9882f74adc905872bc39">Instruction::Or</a>:</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1APIntOps.html#afc7c4d88d09cba0c5e920f8a3a3ace55">Instruction::Xor</a>: {</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;      <span class="comment">// Calculate the cost of this instruction.</span></div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;      <span class="keywordtype">int</span> ScalarCost = 0;</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;      <span class="keywordtype">int</span> VecCost = 0;</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;      <span class="keywordflow">if</span> (Opcode == Instruction::FCmp || Opcode == Instruction::ICmp ||</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;          Opcode == <a class="code" href="namespacellvm_1_1MCID.html#a8035044d40d3758eb45b65dce69dc90ba32dbd2c72a98eaee90e3ad5ef7b5af16">Instruction::Select</a>) {</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;        <a class="code" href="classllvm_1_1VectorType.html">VectorType</a> *MaskTy = <a class="code" href="classllvm_1_1VectorType.html#ab43657ed1abe2e2ed3a6a394f233ebd0">VectorType::get</a>(Builder.getInt1Ty(), VL.<a class="code" href="classllvm_1_1ArrayRef.html#a76878250107ee24ef7339870bdda4bcf">size</a>());</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;        ScalarCost = VecTy-&gt;<a class="code" href="classllvm_1_1VectorType.html#a580510fa692dccfb26d0e967d8f164e7">getNumElements</a>() *</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;        TTI-&gt;getCmpSelInstrCost(Opcode, ScalarTy, Builder.<a class="code" href="classllvm_1_1Type.html#aa75984a442f2379de0c66018201fa628">getInt1Ty</a>());</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;        VecCost = TTI-&gt;getCmpSelInstrCost(Opcode, VecTy, MaskTy);</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;        <span class="comment">// Certain instructions can be cheaper to vectorize if they have a</span></div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;        <span class="comment">// constant second vector operand.</span></div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;        <a class="code" href="classllvm_1_1TargetTransformInfo.html#afa38851d75434d1476444ac93f94cb4c">TargetTransformInfo::OperandValueKind</a> Op1VK =</div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;            <a class="code" href="classllvm_1_1TargetTransformInfo.html#afa38851d75434d1476444ac93f94cb4ca9c0eecea29e9fa58e4dac7ee32b9b2ac">TargetTransformInfo::OK_AnyValue</a>;</div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;        <a class="code" href="classllvm_1_1TargetTransformInfo.html#afa38851d75434d1476444ac93f94cb4c">TargetTransformInfo::OperandValueKind</a> Op2VK =</div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;            <a class="code" href="classllvm_1_1TargetTransformInfo.html#afa38851d75434d1476444ac93f94cb4ca76d8855d96b8e66b9411ed74737ca8f7">TargetTransformInfo::OK_UniformConstantValue</a>;</div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;</div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;        <span class="comment">// Check whether all second operands are constant.</span></div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; VL.<a class="code" href="classllvm_1_1ArrayRef.html#a76878250107ee24ef7339870bdda4bcf">size</a>(); ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;          <span class="keywordflow">if</span> (!isa&lt;ConstantInt&gt;(cast&lt;Instruction&gt;(VL[i])-&gt;getOperand(1))) {</div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;            Op2VK = <a class="code" href="classllvm_1_1TargetTransformInfo.html#afa38851d75434d1476444ac93f94cb4ca9c0eecea29e9fa58e4dac7ee32b9b2ac">TargetTransformInfo::OK_AnyValue</a>;</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;          }</div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;        ScalarCost =</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;            VecTy-&gt;<a class="code" href="classllvm_1_1VectorType.html#a580510fa692dccfb26d0e967d8f164e7">getNumElements</a>() *</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;            TTI-&gt;getArithmeticInstrCost(Opcode, ScalarTy, Op1VK, Op2VK);</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;        VecCost = TTI-&gt;getArithmeticInstrCost(Opcode, VecTy, Op1VK, Op2VK);</div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;      }</div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;      <span class="keywordflow">return</span> VecCost - ScalarCost;</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;    }</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1SPII.html#a11e9b8fca4a074643a6a21f444e51406a5069619ca8fdce305534f3fe85091a0f">Instruction::Load</a>: {</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;      <span class="comment">// Cost of wide load - cost of scalar loads.</span></div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;      <span class="keywordtype">int</span> ScalarLdCost = VecTy-&gt;<a class="code" href="classllvm_1_1VectorType.html#a580510fa692dccfb26d0e967d8f164e7">getNumElements</a>() *</div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;      TTI-&gt;getMemoryOpCost(<a class="code" href="namespacellvm_1_1SPII.html#a11e9b8fca4a074643a6a21f444e51406a5069619ca8fdce305534f3fe85091a0f">Instruction::Load</a>, ScalarTy, 1, 0);</div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;      <span class="keywordtype">int</span> VecLdCost = TTI-&gt;getMemoryOpCost(<a class="code" href="namespacellvm_1_1SPII.html#a11e9b8fca4a074643a6a21f444e51406a5069619ca8fdce305534f3fe85091a0f">Instruction::Load</a>, VecTy, 1, 0);</div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;      <span class="keywordflow">return</span> VecLdCost - ScalarLdCost;</div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;    }</div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1SPII.html#a11e9b8fca4a074643a6a21f444e51406a36b3dd3b84fde3f8494a9b18af131856">Instruction::Store</a>: {</div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;      <span class="comment">// We know that we can merge the stores. Calculate the cost.</span></div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;      <span class="keywordtype">int</span> ScalarStCost = VecTy-&gt;<a class="code" href="classllvm_1_1VectorType.html#a580510fa692dccfb26d0e967d8f164e7">getNumElements</a>() *</div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;      TTI-&gt;getMemoryOpCost(<a class="code" href="namespacellvm_1_1SPII.html#a11e9b8fca4a074643a6a21f444e51406a36b3dd3b84fde3f8494a9b18af131856">Instruction::Store</a>, ScalarTy, 1, 0);</div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;      <span class="keywordtype">int</span> VecStCost = TTI-&gt;getMemoryOpCost(<a class="code" href="namespacellvm_1_1SPII.html#a11e9b8fca4a074643a6a21f444e51406a36b3dd3b84fde3f8494a9b18af131856">Instruction::Store</a>, VecTy, 1, 0);</div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;      <span class="keywordflow">return</span> VecStCost - ScalarStCost;</div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;    }</div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;    <span class="keywordflow">default</span>:</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;      <a class="code" href="ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a>(<span class="stringliteral">&quot;Unknown instruction&quot;</span>);</div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;  }</div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;}</div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;</div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;<span class="keywordtype">bool</span> BoUpSLP::isFullyVectorizableTinyTree() {</div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;  <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;SLP: Check whether the tree with height &quot;</span> &lt;&lt;</div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;        VectorizableTree.size() &lt;&lt; <span class="stringliteral">&quot; is fully vectorizable .\n&quot;</span>);</div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;  <span class="comment">// We only handle trees of height 2.</span></div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;  <span class="keywordflow">if</span> (VectorizableTree.size() != 2)</div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;</div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;  <span class="comment">// Gathering cost would be too much for tiny trees.</span></div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;  <span class="keywordflow">if</span> (VectorizableTree[0].NeedToGather || VectorizableTree[1].NeedToGather) </div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>; </div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;</div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>; </div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;}</div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;</div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;<span class="keywordtype">int</span> BoUpSLP::getTreeCost() {</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;  <span class="keywordtype">int</span> Cost = 0;</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;  <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;SLP: Calculating cost for tree of size &quot;</span> &lt;&lt;</div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;        VectorizableTree.size() &lt;&lt; <span class="stringliteral">&quot;.\n&quot;</span>);</div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;</div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;  <span class="comment">// We only vectorize tiny trees if it is fully vectorizable.</span></div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;  <span class="keywordflow">if</span> (VectorizableTree.size() &lt; 3 &amp;&amp; !isFullyVectorizableTinyTree()) {</div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;    <span class="keywordflow">if</span> (!VectorizableTree.size()) {</div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;      assert(!ExternalUses.size() &amp;&amp; <span class="stringliteral">&quot;We should not have any external users&quot;</span>);</div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;    }</div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;    <span class="keywordflow">return</span> INT_MAX;</div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;  }</div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;  <span class="keywordtype">unsigned</span> BundleWidth = VectorizableTree[0].Scalars.size();</div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;</div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0, e = VectorizableTree.size(); i != e; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = getEntryCost(&amp;VectorizableTree[i]);</div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;    <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;SLP: Adding cost &quot;</span> &lt;&lt; C &lt;&lt; <span class="stringliteral">&quot; for bundle that starts with &quot;</span></div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;          &lt;&lt; *VectorizableTree[i].Scalars[0] &lt;&lt; <span class="stringliteral">&quot; .\n&quot;</span>);</div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;    Cost += <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>;</div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;  }</div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;</div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;  <span class="keywordtype">int</span> ExtractCost = 0;</div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;  <span class="keywordflow">for</span> (UserList::iterator I = ExternalUses.begin(), E = ExternalUses.end();</div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;       I != E; ++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;</div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;    <a class="code" href="classllvm_1_1VectorType.html">VectorType</a> *VecTy = <a class="code" href="classllvm_1_1VectorType.html#ab43657ed1abe2e2ed3a6a394f233ebd0">VectorType::get</a>(I-&gt;Scalar-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>(), BundleWidth);</div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;    ExtractCost += TTI-&gt;getVectorInstrCost(<a class="code" href="InstCombineCompares_8cpp.html#aa5ab8c7b55d8bc7cab66be444daa70a1">Instruction::ExtractElement</a>, VecTy,</div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;                                           I-&gt;Lane);</div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;  }</div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;</div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;</div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;  <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;SLP: Total Cost &quot;</span> &lt;&lt; Cost + ExtractCost&lt;&lt; <span class="stringliteral">&quot;.\n&quot;</span>);</div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;  <span class="keywordflow">return</span>  Cost + ExtractCost;</div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;}</div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;</div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;<span class="keywordtype">int</span> BoUpSLP::getGatherCost(<a class="code" href="classllvm_1_1Type.html">Type</a> *Ty) {</div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;  <span class="keywordtype">int</span> Cost = 0;</div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0, e = cast&lt;VectorType&gt;(Ty)-&gt;getNumElements(); i &lt; e; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;    Cost += TTI-&gt;getVectorInstrCost(Instruction::InsertElement, Ty, i);</div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;  <span class="keywordflow">return</span> Cost;</div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;}</div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;</div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;<span class="keywordtype">int</span> BoUpSLP::getGatherCost(<a class="code" href="classllvm_1_1ArrayRef.html">ArrayRef&lt;Value *&gt;</a> VL) {</div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;  <span class="comment">// Find the type of the operands in VL.</span></div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *ScalarTy = VL[0]-&gt;getType();</div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1StoreInst.html">StoreInst</a> *SI = dyn_cast&lt;StoreInst&gt;(VL[0]))</div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;    ScalarTy = SI-&gt;getValueOperand()-&gt;getType();</div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;  <a class="code" href="classllvm_1_1VectorType.html">VectorType</a> *VecTy = <a class="code" href="classllvm_1_1VectorType.html#ab43657ed1abe2e2ed3a6a394f233ebd0">VectorType::get</a>(ScalarTy, VL.<a class="code" href="classllvm_1_1ArrayRef.html#a76878250107ee24ef7339870bdda4bcf">size</a>());</div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;  <span class="comment">// Find the cost of inserting/extracting values from the vector.</span></div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;  <span class="keywordflow">return</span> getGatherCost(VecTy);</div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;}</div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;</div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;<a class="code" href="structllvm_1_1AliasAnalysis_1_1Location.html">AliasAnalysis::Location</a> BoUpSLP::getLocation(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *I) {</div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1StoreInst.html">StoreInst</a> *SI = dyn_cast&lt;StoreInst&gt;(I))</div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;    <span class="keywordflow">return</span> AA-&gt;getLocation(SI);</div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1LoadInst.html">LoadInst</a> *LI = dyn_cast&lt;LoadInst&gt;(I))</div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;    <span class="keywordflow">return</span> AA-&gt;getLocation(LI);</div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="structllvm_1_1AliasAnalysis_1_1Location.html">AliasAnalysis::Location</a>();</div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;}</div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;</div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="Delinearization_8cpp.html#a67193aea0752a127930d6f762e685eef">BoUpSLP::getPointerOperand</a>(<a class="code" href="classllvm_1_1Value.html">Value</a> *I) {</div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1LoadInst.html">LoadInst</a> *LI = dyn_cast&lt;LoadInst&gt;(I))</div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;    <span class="keywordflow">return</span> LI-&gt;getPointerOperand();</div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1StoreInst.html">StoreInst</a> *SI = dyn_cast&lt;StoreInst&gt;(I))</div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;    <span class="keywordflow">return</span> SI-&gt;getPointerOperand();</div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;}</div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;</div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;<span class="keywordtype">unsigned</span> BoUpSLP::getAddressSpaceOperand(<a class="code" href="classllvm_1_1Value.html">Value</a> *I) {</div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1LoadInst.html">LoadInst</a> *L = dyn_cast&lt;LoadInst&gt;(I))</div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;    <span class="keywordflow">return</span> L-&gt;<a class="code" href="classllvm_1_1LoadInst.html#a2efd55778217d045b121de696c4f6452">getPointerAddressSpace</a>();</div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1StoreInst.html">StoreInst</a> *<a class="code" href="Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a> = dyn_cast&lt;StoreInst&gt;(I))</div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>-&gt;getPointerAddressSpace();</div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;  <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;}</div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;</div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;<span class="keywordtype">bool</span> BoUpSLP::isConsecutiveAccess(<a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>, <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="Target_2ARM_2README_8txt.html#a90cca76dd78688687e0d697679dbc799">B</a>) {</div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *PtrA = <a class="code" href="Delinearization_8cpp.html#a67193aea0752a127930d6f762e685eef">getPointerOperand</a>(A);</div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *PtrB = <a class="code" href="Delinearization_8cpp.html#a67193aea0752a127930d6f762e685eef">getPointerOperand</a>(B);</div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;  <span class="keywordtype">unsigned</span> ASA = getAddressSpaceOperand(A);</div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;  <span class="keywordtype">unsigned</span> ASB = getAddressSpaceOperand(B);</div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;</div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;  <span class="comment">// Check that the address spaces match and that the pointers are valid.</span></div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;  <span class="keywordflow">if</span> (!PtrA || !PtrB || (ASA != ASB))</div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;</div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;  <span class="comment">// Make sure that A and B are different pointers of the same type.</span></div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;  <span class="keywordflow">if</span> (PtrA == PtrB || PtrA-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>() != PtrB-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>())</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;</div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;  <span class="keywordtype">unsigned</span> PtrBitWidth = DL-&gt;getPointerSizeInBits(ASA);</div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *Ty = cast&lt;PointerType&gt;(PtrA-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>())-&gt;getElementType();</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;  <a class="code" href="classllvm_1_1APInt.html">APInt</a> Size(PtrBitWidth, DL-&gt;getTypeStoreSize(Ty));</div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;</div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;  <a class="code" href="classllvm_1_1APInt.html">APInt</a> OffsetA(PtrBitWidth, 0), OffsetB(PtrBitWidth, 0);</div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;  PtrA = PtrA-&gt;<a class="code" href="classllvm_1_1Value.html#a8624010a95fb91d34d1757461fce0ed9">stripAndAccumulateInBoundsConstantOffsets</a>(*DL, OffsetA);</div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;  PtrB = PtrB-&gt;<a class="code" href="classllvm_1_1Value.html#a8624010a95fb91d34d1757461fce0ed9">stripAndAccumulateInBoundsConstantOffsets</a>(*DL, OffsetB);</div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;</div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;  <a class="code" href="classllvm_1_1APInt.html">APInt</a> OffsetDelta = OffsetB - OffsetA;</div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;</div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;  <span class="comment">// Check if they are based on the same pointer. That makes the offsets</span></div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;  <span class="comment">// sufficient.</span></div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;  <span class="keywordflow">if</span> (PtrA == PtrB)</div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;    <span class="keywordflow">return</span> OffsetDelta == Size;</div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;</div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;  <span class="comment">// Compute the necessary base pointer delta to have the necessary final delta</span></div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;  <span class="comment">// equal to the size.</span></div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;  <a class="code" href="classllvm_1_1APInt.html">APInt</a> BaseDelta = Size - OffsetDelta;</div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;</div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;  <span class="comment">// Otherwise compute the distance with SCEV between the base pointers.</span></div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *PtrSCEVA = SE-&gt;getSCEV(PtrA);</div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *PtrSCEVB = SE-&gt;getSCEV(PtrB);</div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *C = SE-&gt;getConstant(BaseDelta);</div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *<a class="code" href="namespacellvm.html#a6569d00d31a5d74e563e2f39f82271ab">X</a> = SE-&gt;getAddExpr(PtrSCEVA, C);</div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;  <span class="keywordflow">return</span> X == PtrSCEVB;</div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;}</div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;</div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *BoUpSLP::getSinkBarrier(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *Src, <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *Dst) {</div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;  assert(Src-&gt;<a class="code" href="classllvm_1_1Instruction.html#a9cd49851904f15060edb782ef4dd1b2d">getParent</a>() == Dst-&gt;<a class="code" href="classllvm_1_1Instruction.html#a9cd49851904f15060edb782ef4dd1b2d">getParent</a>() &amp;&amp; <span class="stringliteral">&quot;Not the same BB&quot;</span>);</div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;  <a class="code" href="classllvm_1_1ilist__iterator.html">BasicBlock::iterator</a> I = Src, E = Dst;<span class="comment"></span></div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;<span class="comment">  /// Scan all of the instruction from SRC to DST and check if</span></div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;<span class="comment">  /// the source may alias.</span></div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;<span class="comment"></span>  <span class="keywordflow">for</span> (++I; I != E; ++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;    <span class="comment">// Ignore store instructions that are marked as &#39;ignore&#39;.</span></div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;    <span class="keywordflow">if</span> (MemBarrierIgnoreList.count(I))</div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;    <span class="keywordflow">if</span> (Src-&gt;<a class="code" href="classllvm_1_1Instruction.html#aa26de3d6e38997b9041e824ea558c770">mayWriteToMemory</a>()) <span class="comment">/* Write */</span> {</div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;      <span class="keywordflow">if</span> (!I-&gt;mayReadOrWriteMemory())</div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;    } <span class="keywordflow">else</span> <span class="comment">/* Read */</span> {</div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;      <span class="keywordflow">if</span> (!I-&gt;mayWriteToMemory())</div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;    }</div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;    <a class="code" href="structllvm_1_1AliasAnalysis_1_1Location.html">AliasAnalysis::Location</a> A = getLocation(&amp;*I);</div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;    <a class="code" href="structllvm_1_1AliasAnalysis_1_1Location.html">AliasAnalysis::Location</a> B = getLocation(Src);</div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;</div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;    <span class="keywordflow">if</span> (!A.<a class="code" href="structllvm_1_1AliasAnalysis_1_1Location.html#a24197872686f605dcfd25b6e5d3cc7fa">Ptr</a> || !B.<a class="code" href="structllvm_1_1AliasAnalysis_1_1Location.html#a24197872686f605dcfd25b6e5d3cc7fa">Ptr</a> || AA-&gt;alias(A, B))</div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;      <span class="keywordflow">return</span> I;</div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;  }</div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;}</div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;</div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;<span class="keywordtype">int</span> BoUpSLP::getLastIndex(<a class="code" href="classllvm_1_1ArrayRef.html">ArrayRef&lt;Value *&gt;</a> VL) {</div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *BB = cast&lt;Instruction&gt;(VL[0])-&gt;<a class="code" href="BasicAliasAnalysis_8cpp.html#a2675de1d8479c7b00387979714da43f7">getParent</a>();</div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;  assert(BB == getSameBlock(VL) &amp;&amp; BlocksNumbers.count(BB) &amp;&amp; <span class="stringliteral">&quot;Invalid block&quot;</span>);</div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;  BlockNumbering &amp;BN = BlocksNumbers[<a class="code" href="CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>];</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;</div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;  <span class="keywordtype">int</span> MaxIdx = BN.getIndex(BB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a0e73f4e09745bb69fdd7b15232c45428">getFirstNonPHI</a>());</div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0, e = VL.<a class="code" href="classllvm_1_1ArrayRef.html#a76878250107ee24ef7339870bdda4bcf">size</a>(); i &lt; e; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;    MaxIdx = std::max(MaxIdx, BN.getIndex(cast&lt;Instruction&gt;(VL[i])));</div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;  <span class="keywordflow">return</span> MaxIdx;</div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;}</div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;</div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *BoUpSLP::getLastInstruction(<a class="code" href="classllvm_1_1ArrayRef.html">ArrayRef&lt;Value *&gt;</a> VL) {</div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *BB = cast&lt;Instruction&gt;(VL[0])-&gt;<a class="code" href="BasicAliasAnalysis_8cpp.html#a2675de1d8479c7b00387979714da43f7">getParent</a>();</div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;  assert(BB == getSameBlock(VL) &amp;&amp; BlocksNumbers.count(BB) &amp;&amp; <span class="stringliteral">&quot;Invalid block&quot;</span>);</div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;  BlockNumbering &amp;BN = BlocksNumbers[<a class="code" href="CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>];</div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;</div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;  <span class="keywordtype">int</span> MaxIdx = BN.getIndex(cast&lt;Instruction&gt;(VL[0]));</div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 1, e = VL.<a class="code" href="classllvm_1_1ArrayRef.html#a76878250107ee24ef7339870bdda4bcf">size</a>(); i &lt; e; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;    MaxIdx = std::max(MaxIdx, BN.getIndex(cast&lt;Instruction&gt;(VL[i])));</div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *I = BN.getInstruction(MaxIdx);</div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;  assert(I &amp;&amp; <span class="stringliteral">&quot;bad location&quot;</span>);</div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>;</div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;}</div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;</div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;<span class="keywordtype">void</span> BoUpSLP::setInsertPointAfterBundle(<a class="code" href="classllvm_1_1ArrayRef.html">ArrayRef&lt;Value *&gt;</a> VL) {</div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *VL0 = cast&lt;Instruction&gt;(VL[0]);</div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *LastInst = getLastInstruction(VL);</div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;  <a class="code" href="classllvm_1_1ilist__iterator.html">BasicBlock::iterator</a> NextInst = LastInst;</div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;  ++NextInst;</div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;  Builder.SetInsertPoint(VL0-&gt;<a class="code" href="classllvm_1_1Instruction.html#a9cd49851904f15060edb782ef4dd1b2d">getParent</a>(), NextInst);</div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;  Builder.SetCurrentDebugLocation(VL0-&gt;<a class="code" href="classllvm_1_1Instruction.html#aab8e16a35183ce39aad394714087bcff">getDebugLoc</a>());</div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;}</div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;</div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *BoUpSLP::Gather(<a class="code" href="classllvm_1_1ArrayRef.html">ArrayRef&lt;Value *&gt;</a> VL, <a class="code" href="classllvm_1_1VectorType.html">VectorType</a> *Ty) {</div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Vec = <a class="code" href="classllvm_1_1UndefValue.html#a4ae5ff22b700a42bcc5d889233721335">UndefValue::get</a>(Ty);</div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;  <span class="comment">// Generate the &#39;InsertElement&#39; instruction.</span></div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; Ty-&gt;<a class="code" href="classllvm_1_1VectorType.html#a580510fa692dccfb26d0e967d8f164e7">getNumElements</a>(); ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;    Vec = Builder.CreateInsertElement(Vec, VL[i], Builder.getInt32(i));</div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *Insrt = dyn_cast&lt;Instruction&gt;(Vec)) {</div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;      GatherSeq.insert(Insrt);</div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;      CSEBlocks.insert(Insrt-&gt;getParent());</div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;</div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;      <span class="comment">// Add to our &#39;need-to-extract&#39; list.</span></div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;      <span class="keywordflow">if</span> (ScalarToTreeEntry.count(VL[i])) {</div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;        <span class="keywordtype">int</span> Idx = ScalarToTreeEntry[VL[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>]];</div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;        TreeEntry *E = &amp;VectorizableTree[Idx];</div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;        <span class="comment">// Find which lane we need to extract.</span></div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;        <span class="keywordtype">int</span> FoundLane = -1;</div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> Lane = 0, <a class="code" href="namespacellvm_1_1A64CC.html#af5804bc0518be9568f73db566e4d6f46a98d7f1cf15bd78fd7c7c68e6543a9588">LE</a> = VL.size(); Lane != <a class="code" href="namespacellvm_1_1A64CC.html#af5804bc0518be9568f73db566e4d6f46a98d7f1cf15bd78fd7c7c68e6543a9588">LE</a>; ++Lane) {</div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;          <span class="comment">// Is this the lane of the scalar that we are looking for ?</span></div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;          <span class="keywordflow">if</span> (E-&gt;Scalars[Lane] == VL[i]) {</div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;            FoundLane = Lane;</div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;          }</div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;        }</div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;        assert(FoundLane &gt;= 0 &amp;&amp; <span class="stringliteral">&quot;Could not find the correct lane&quot;</span>);</div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;        ExternalUses.push_back(ExternalUser(VL[i], Insrt, FoundLane));</div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;      }</div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;    }</div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;  }</div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;</div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;  <span class="keywordflow">return</span> Vec;</div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;}</div><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;</div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *BoUpSLP::alreadyVectorized(<a class="code" href="classllvm_1_1ArrayRef.html">ArrayRef&lt;Value *&gt;</a> VL)<span class="keyword"> const </span>{</div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;  <a class="code" href="classllvm_1_1SmallDenseMap.html">SmallDenseMap&lt;Value*, int&gt;::const_iterator</a> Entry</div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;    = ScalarToTreeEntry.find(VL[0]);</div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;  <span class="keywordflow">if</span> (Entry != ScalarToTreeEntry.<a class="code" href="classllvm_1_1DenseMapBase.html#a321e37d79af8b4287f8a1dcf9aff9c01">end</a>()) {</div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;    <span class="keywordtype">int</span> Idx = Entry-&gt;second;</div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;    <span class="keyword">const</span> TreeEntry *En = &amp;VectorizableTree[Idx];</div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;    <span class="keywordflow">if</span> (En-&gt;isSame(VL) &amp;&amp; En-&gt;VectorizedValue)</div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;      <span class="keywordflow">return</span> En-&gt;VectorizedValue;</div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;  }</div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;}</div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;</div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *BoUpSLP::vectorizeTree(<a class="code" href="classllvm_1_1ArrayRef.html">ArrayRef&lt;Value *&gt;</a> VL) {</div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;  <span class="keywordflow">if</span> (ScalarToTreeEntry.count(VL[0])) {</div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;    <span class="keywordtype">int</span> Idx = ScalarToTreeEntry[VL[0]];</div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;    TreeEntry *E = &amp;VectorizableTree[Idx];</div><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;    <span class="keywordflow">if</span> (E-&gt;isSame(VL))</div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;      <span class="keywordflow">return</span> vectorizeTree(E);</div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;  }</div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;</div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *ScalarTy = VL[0]-&gt;getType();</div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1StoreInst.html">StoreInst</a> *SI = dyn_cast&lt;StoreInst&gt;(VL[0]))</div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;    ScalarTy = SI-&gt;getValueOperand()-&gt;getType();</div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;  <a class="code" href="classllvm_1_1VectorType.html">VectorType</a> *VecTy = <a class="code" href="classllvm_1_1VectorType.html#ab43657ed1abe2e2ed3a6a394f233ebd0">VectorType::get</a>(ScalarTy, VL.size());</div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;</div><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;  <span class="keywordflow">return</span> Gather(VL, VecTy);</div><div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;}</div><div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;</div><div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *BoUpSLP::vectorizeTree(TreeEntry *E) {</div><div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;  <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;::InsertPointGuard</a> Guard(Builder);</div><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;</div><div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;  <span class="keywordflow">if</span> (E-&gt;VectorizedValue) {</div><div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;    <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;SLP: Diamond merged for &quot;</span> &lt;&lt; *E-&gt;Scalars[0] &lt;&lt; <span class="stringliteral">&quot;.\n&quot;</span>);</div><div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;    <span class="keywordflow">return</span> E-&gt;VectorizedValue;</div><div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;  }</div><div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;</div><div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *VL0 = cast&lt;Instruction&gt;(E-&gt;Scalars[0]);</div><div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *ScalarTy = VL0-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>();</div><div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1StoreInst.html">StoreInst</a> *SI = dyn_cast&lt;StoreInst&gt;(VL0))</div><div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;    ScalarTy = SI-&gt;getValueOperand()-&gt;getType();</div><div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;  <a class="code" href="classllvm_1_1VectorType.html">VectorType</a> *VecTy = <a class="code" href="classllvm_1_1VectorType.html#ab43657ed1abe2e2ed3a6a394f233ebd0">VectorType::get</a>(ScalarTy, E-&gt;Scalars.size());</div><div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;</div><div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;  <span class="keywordflow">if</span> (E-&gt;NeedToGather) {</div><div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;    setInsertPointAfterBundle(E-&gt;Scalars);</div><div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;    <span class="keywordflow">return</span> Gather(E-&gt;Scalars, VecTy);</div><div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;  }</div><div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;</div><div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;  <span class="keywordtype">unsigned</span> Opcode = VL0-&gt;<a class="code" href="classllvm_1_1Instruction.html#a021bb7c9aad6003fe8089f6327356c6c">getOpcode</a>();</div><div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;  assert(Opcode == getSameOpcode(E-&gt;Scalars) &amp;&amp; <span class="stringliteral">&quot;Invalid opcode&quot;</span>);</div><div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;</div><div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;  <span class="keywordflow">switch</span> (Opcode) {</div><div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1TargetOpcode.html#a348d4259b5fa6a8ecfe94e7ae512e1a8ae41f9ca68ba5e8b9613cea03652ebd72">Instruction::PHI</a>: {</div><div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;      <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *PH = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1PHINode.html">PHINode</a>&gt;(VL0);</div><div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;      Builder.SetInsertPoint(PH-&gt;<a class="code" href="classllvm_1_1Instruction.html#a9cd49851904f15060edb782ef4dd1b2d">getParent</a>()-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a0e73f4e09745bb69fdd7b15232c45428">getFirstNonPHI</a>());</div><div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;      Builder.SetCurrentDebugLocation(PH-&gt;<a class="code" href="classllvm_1_1Instruction.html#aab8e16a35183ce39aad394714087bcff">getDebugLoc</a>());</div><div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;      <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *NewPhi = Builder.CreatePHI(VecTy, PH-&gt;<a class="code" href="classllvm_1_1PHINode.html#aa45f6c0433576e3858a6209a43750ad4">getNumIncomingValues</a>());</div><div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;      E-&gt;VectorizedValue = NewPhi;</div><div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;</div><div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;      <span class="comment">// PHINodes may have multiple entries from the same block. We want to</span></div><div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;      <span class="comment">// visit every block once.</span></div><div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;      <a class="code" href="classllvm_1_1SmallSet.html">SmallSet&lt;BasicBlock*, 4&gt;</a> VisitedBBs;</div><div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;</div><div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0, e = PH-&gt;<a class="code" href="classllvm_1_1PHINode.html#aa45f6c0433576e3858a6209a43750ad4">getNumIncomingValues</a>(); i &lt; e; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;        ValueList Operands;</div><div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;        <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *IBB = PH-&gt;<a class="code" href="classllvm_1_1PHINode.html#a4c25b6c00c4867281779c81ab64d2081">getIncomingBlock</a>(i);</div><div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;</div><div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;        <span class="keywordflow">if</span> (!VisitedBBs.<a class="code" href="classllvm_1_1SmallSet.html#a8d8348060ccdeeba13fb8bc651dfbf82">insert</a>(IBB)) {</div><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;          NewPhi-&gt;<a class="code" href="classllvm_1_1PHINode.html#a089cccb6f231efee72abc76d0f9c695f">addIncoming</a>(NewPhi-&gt;<a class="code" href="classllvm_1_1PHINode.html#a21960167f529265a1cb02ac1e8ad10f6">getIncomingValueForBlock</a>(IBB), IBB);</div><div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;          <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;        }</div><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;</div><div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;        <span class="comment">// Prepare the operand vector.</span></div><div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = 0; j &lt; E-&gt;Scalars.size(); ++<a class="code" href="Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a>)</div><div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;          Operands.push_back(cast&lt;PHINode&gt;(E-&gt;Scalars[j])-&gt;</div><div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;                             getIncomingValueForBlock(IBB));</div><div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;</div><div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;        Builder.SetInsertPoint(IBB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a5cb76a65b6524dba1493dd2b9dc3abbe">getTerminator</a>());</div><div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;        Builder.SetCurrentDebugLocation(PH-&gt;<a class="code" href="classllvm_1_1Instruction.html#aab8e16a35183ce39aad394714087bcff">getDebugLoc</a>());</div><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;        <a class="code" href="classllvm_1_1Value.html">Value</a> *Vec = vectorizeTree(Operands);</div><div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;        NewPhi-&gt;<a class="code" href="classllvm_1_1PHINode.html#a089cccb6f231efee72abc76d0f9c695f">addIncoming</a>(Vec, IBB);</div><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;      }</div><div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;</div><div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;      assert(NewPhi-&gt;<a class="code" href="classllvm_1_1PHINode.html#aa45f6c0433576e3858a6209a43750ad4">getNumIncomingValues</a>() == PH-&gt;<a class="code" href="classllvm_1_1PHINode.html#aa45f6c0433576e3858a6209a43750ad4">getNumIncomingValues</a>() &amp;&amp;</div><div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;             <span class="stringliteral">&quot;Invalid number of incoming values&quot;</span>);</div><div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;      <span class="keywordflow">return</span> NewPhi;</div><div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;    }</div><div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;</div><div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="InstCombineCompares_8cpp.html#aa5ab8c7b55d8bc7cab66be444daa70a1">Instruction::ExtractElement</a>: {</div><div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;      <span class="keywordflow">if</span> (CanReuseExtract(E-&gt;Scalars)) {</div><div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;        <a class="code" href="classllvm_1_1Value.html">Value</a> *V = VL0-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0);</div><div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;        E-&gt;VectorizedValue = V;</div><div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;        <span class="keywordflow">return</span> V;</div><div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;      }</div><div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;      <span class="keywordflow">return</span> Gather(E-&gt;Scalars, VecTy);</div><div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;    }</div><div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;    <span class="keywordflow">case</span> Instruction::ZExt:</div><div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;    <span class="keywordflow">case</span> Instruction::SExt:</div><div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;    <span class="keywordflow">case</span> Instruction::FPToUI:</div><div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;    <span class="keywordflow">case</span> Instruction::FPToSI:</div><div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;    <span class="keywordflow">case</span> Instruction::FPExt:</div><div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;    <span class="keywordflow">case</span> Instruction::PtrToInt:</div><div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;    <span class="keywordflow">case</span> Instruction::IntToPtr:</div><div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;    <span class="keywordflow">case</span> Instruction::SIToFP:</div><div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;    <span class="keywordflow">case</span> Instruction::UIToFP:</div><div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;    <span class="keywordflow">case</span> Instruction::Trunc:</div><div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;    <span class="keywordflow">case</span> Instruction::FPTrunc:</div><div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;    <span class="keywordflow">case</span> Instruction::BitCast: {</div><div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;      ValueList INVL;</div><div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0, e = E-&gt;Scalars.size(); i &lt; e; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div><div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;        INVL.push_back(cast&lt;Instruction&gt;(E-&gt;Scalars[i])-&gt;getOperand(0));</div><div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;</div><div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;      setInsertPointAfterBundle(E-&gt;Scalars);</div><div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;</div><div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *InVec = vectorizeTree(INVL);</div><div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;</div><div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *V = alreadyVectorized(E-&gt;Scalars))</div><div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;        <span class="keywordflow">return</span> V;</div><div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;</div><div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;      <a class="code" href="classllvm_1_1CastInst.html">CastInst</a> *CI = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1CastInst.html">CastInst</a>&gt;(VL0);</div><div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *V = Builder.CreateCast(CI-&gt;<a class="code" href="classllvm_1_1CastInst.html#adc3489e61d5f37a0e4c5589859fbccc2">getOpcode</a>(), InVec, VecTy);</div><div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;      E-&gt;VectorizedValue = V;</div><div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;      <span class="keywordflow">return</span> V;</div><div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;    }</div><div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;    <span class="keywordflow">case</span> Instruction::FCmp:</div><div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;    <span class="keywordflow">case</span> Instruction::ICmp: {</div><div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;      ValueList LHSV, RHSV;</div><div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0, e = E-&gt;Scalars.size(); i &lt; e; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;        LHSV.push_back(cast&lt;Instruction&gt;(E-&gt;Scalars[i])-&gt;getOperand(0));</div><div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;        RHSV.push_back(cast&lt;Instruction&gt;(E-&gt;Scalars[i])-&gt;getOperand(1));</div><div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;      }</div><div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;</div><div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;      setInsertPointAfterBundle(E-&gt;Scalars);</div><div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;</div><div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *L = vectorizeTree(LHSV);</div><div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *R = vectorizeTree(RHSV);</div><div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;</div><div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *V = alreadyVectorized(E-&gt;Scalars))</div><div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;        <span class="keywordflow">return</span> V;</div><div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;</div><div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;      <a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05">CmpInst::Predicate</a> P0 = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1CmpInst.html">CmpInst</a>&gt;(VL0)-&gt;getPredicate();</div><div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *V;</div><div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;      <span class="keywordflow">if</span> (Opcode == Instruction::FCmp)</div><div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;        V = Builder.CreateFCmp(P0, L, R);</div><div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;        V = Builder.CreateICmp(P0, L, R);</div><div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;</div><div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;      E-&gt;VectorizedValue = V;</div><div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;      <span class="keywordflow">return</span> V;</div><div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;    }</div><div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1MCID.html#a8035044d40d3758eb45b65dce69dc90ba32dbd2c72a98eaee90e3ad5ef7b5af16">Instruction::Select</a>: {</div><div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;      ValueList TrueVec, FalseVec, CondVec;</div><div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0, e = E-&gt;Scalars.size(); i &lt; e; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;        CondVec.push_back(cast&lt;Instruction&gt;(E-&gt;Scalars[i])-&gt;getOperand(0));</div><div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;        TrueVec.push_back(cast&lt;Instruction&gt;(E-&gt;Scalars[i])-&gt;getOperand(1));</div><div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;        FalseVec.push_back(cast&lt;Instruction&gt;(E-&gt;Scalars[i])-&gt;getOperand(2));</div><div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;      }</div><div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;</div><div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;      setInsertPointAfterBundle(E-&gt;Scalars);</div><div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;</div><div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *Cond = vectorizeTree(CondVec);</div><div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *True = vectorizeTree(TrueVec);</div><div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *False = vectorizeTree(FalseVec);</div><div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;</div><div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *V = alreadyVectorized(E-&gt;Scalars))</div><div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;        <span class="keywordflow">return</span> V;</div><div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;</div><div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *V = Builder.CreateSelect(Cond, True, False);</div><div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;      E-&gt;VectorizedValue = V;</div><div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;      <span class="keywordflow">return</span> V;</div><div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;    }</div><div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;    <span class="keywordflow">case</span> Instruction::Add:</div><div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;    <span class="keywordflow">case</span> Instruction::FAdd:</div><div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;    <span class="keywordflow">case</span> Instruction::Sub:</div><div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;    <span class="keywordflow">case</span> Instruction::FSub:</div><div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;    <span class="keywordflow">case</span> Instruction::Mul:</div><div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;    <span class="keywordflow">case</span> Instruction::FMul:</div><div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;    <span class="keywordflow">case</span> Instruction::UDiv:</div><div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;    <span class="keywordflow">case</span> Instruction::SDiv:</div><div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;    <span class="keywordflow">case</span> Instruction::FDiv:</div><div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;    <span class="keywordflow">case</span> Instruction::URem:</div><div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;    <span class="keywordflow">case</span> Instruction::SRem:</div><div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;    <span class="keywordflow">case</span> Instruction::FRem:</div><div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;    <span class="keywordflow">case</span> Instruction::Shl:</div><div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;    <span class="keywordflow">case</span> Instruction::LShr:</div><div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;    <span class="keywordflow">case</span> Instruction::AShr:</div><div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1APIntOps.html#a684cfe02c582e8d75cd6d457e63e6c25">Instruction::And</a>:</div><div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1APIntOps.html#a22f056804d2b9882f74adc905872bc39">Instruction::Or</a>:</div><div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1APIntOps.html#afc7c4d88d09cba0c5e920f8a3a3ace55">Instruction::Xor</a>: {</div><div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;      ValueList LHSVL, RHSVL;</div><div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;      <span class="keywordflow">if</span> (isa&lt;BinaryOperator&gt;(VL0) &amp;&amp; VL0-&gt;<a class="code" href="classllvm_1_1Instruction.html#a1c2048f254df730c4de1643ec791ddf9">isCommutative</a>())</div><div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;        reorderInputsAccordingToOpcode(E-&gt;Scalars, LHSVL, RHSVL);</div><div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0, e = E-&gt;Scalars.size(); i &lt; e; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;          LHSVL.push_back(cast&lt;Instruction&gt;(E-&gt;Scalars[i])-&gt;getOperand(0));</div><div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;          RHSVL.push_back(cast&lt;Instruction&gt;(E-&gt;Scalars[i])-&gt;getOperand(1));</div><div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;        }</div><div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;</div><div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;      setInsertPointAfterBundle(E-&gt;Scalars);</div><div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;</div><div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *LHS = vectorizeTree(LHSVL);</div><div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *RHS = vectorizeTree(RHSVL);</div><div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;</div><div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;      <span class="keywordflow">if</span> (LHS == RHS &amp;&amp; isa&lt;Instruction&gt;(LHS)) {</div><div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;        assert((VL0-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0) == VL0-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(1)) &amp;&amp; <span class="stringliteral">&quot;Invalid order&quot;</span>);</div><div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;      }</div><div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;</div><div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *V = alreadyVectorized(E-&gt;Scalars))</div><div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;        <span class="keywordflow">return</span> V;</div><div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;</div><div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;      <a class="code" href="classllvm_1_1BinaryOperator.html">BinaryOperator</a> *BinOp = cast&lt;BinaryOperator&gt;(VL0);</div><div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *V = Builder.CreateBinOp(BinOp-&gt;<a class="code" href="classllvm_1_1BinaryOperator.html#a88505baf41407782678a5df1702d2d31">getOpcode</a>(), LHS, RHS);</div><div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;      E-&gt;VectorizedValue = V;</div><div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;</div><div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *I = dyn_cast&lt;Instruction&gt;(V))</div><div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;        <span class="keywordflow">return</span> propagateMetadata(I, E-&gt;Scalars);</div><div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;</div><div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;      <span class="keywordflow">return</span> V;</div><div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;    }</div><div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1SPII.html#a11e9b8fca4a074643a6a21f444e51406a5069619ca8fdce305534f3fe85091a0f">Instruction::Load</a>: {</div><div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;      <span class="comment">// Loads are inserted at the head of the tree because we don&#39;t want to</span></div><div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;      <span class="comment">// sink them all the way down past store instructions.</span></div><div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;      setInsertPointAfterBundle(E-&gt;Scalars);</div><div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;</div><div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;      <a class="code" href="classllvm_1_1LoadInst.html">LoadInst</a> *LI = cast&lt;LoadInst&gt;(VL0);</div><div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;      <span class="keywordtype">unsigned</span> AS = LI-&gt;<a class="code" href="classllvm_1_1LoadInst.html#a2efd55778217d045b121de696c4f6452">getPointerAddressSpace</a>();</div><div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;</div><div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *VecPtr = Builder.CreateBitCast(LI-&gt;<a class="code" href="classllvm_1_1LoadInst.html#ad47eefa1d094f60494b6b927061ca001">getPointerOperand</a>(),</div><div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;                                            VecTy-&gt;<a class="code" href="classllvm_1_1Type.html#ab6cc070c37c59589af100aab6f48ef4f">getPointerTo</a>(AS));</div><div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;      <span class="keywordtype">unsigned</span> Alignment = LI-&gt;<a class="code" href="classllvm_1_1LoadInst.html#ad1168fc42bcba1b71217a4969483671a">getAlignment</a>();</div><div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;      LI = Builder.CreateLoad(VecPtr);</div><div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;      LI-&gt;<a class="code" href="classllvm_1_1LoadInst.html#a218ef27c964707a907f12db0f9b002ba">setAlignment</a>(Alignment);</div><div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;      E-&gt;VectorizedValue = LI;</div><div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;      <span class="keywordflow">return</span> propagateMetadata(LI, E-&gt;Scalars);</div><div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;    }</div><div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1SPII.html#a11e9b8fca4a074643a6a21f444e51406a36b3dd3b84fde3f8494a9b18af131856">Instruction::Store</a>: {</div><div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;      <a class="code" href="classllvm_1_1StoreInst.html">StoreInst</a> *SI = cast&lt;StoreInst&gt;(VL0);</div><div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;      <span class="keywordtype">unsigned</span> Alignment = SI-&gt;<a class="code" href="classllvm_1_1StoreInst.html#a3084f1dd69d67e1965fd1fe721a69f2e">getAlignment</a>();</div><div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;      <span class="keywordtype">unsigned</span> AS = SI-&gt;<a class="code" href="classllvm_1_1StoreInst.html#a6cac341b1b354174d0e0a81a2e7a9109">getPointerAddressSpace</a>();</div><div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;</div><div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;      ValueList ValueOp;</div><div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0, e = E-&gt;Scalars.size(); i &lt; e; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div><div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;        ValueOp.push_back(cast&lt;StoreInst&gt;(E-&gt;Scalars[i])-&gt;getValueOperand());</div><div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;</div><div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;      setInsertPointAfterBundle(E-&gt;Scalars);</div><div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;</div><div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *VecValue = vectorizeTree(ValueOp);</div><div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *VecPtr = Builder.CreateBitCast(SI-&gt;<a class="code" href="classllvm_1_1StoreInst.html#ac03c1c093059ea000216af8dd6f2dbf4">getPointerOperand</a>(),</div><div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;                                            VecTy-&gt;<a class="code" href="classllvm_1_1Type.html#ab6cc070c37c59589af100aab6f48ef4f">getPointerTo</a>(AS));</div><div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;      <a class="code" href="classllvm_1_1StoreInst.html">StoreInst</a> *<a class="code" href="Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a> = Builder.CreateStore(VecValue, VecPtr);</div><div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;      S-&gt;<a class="code" href="classllvm_1_1StoreInst.html#a50d3891cd26db1308e81540f468de8c8">setAlignment</a>(Alignment);</div><div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;      E-&gt;VectorizedValue = <a class="code" href="Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>;</div><div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;      <span class="keywordflow">return</span> propagateMetadata(S, E-&gt;Scalars);</div><div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;    }</div><div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;    <span class="keywordflow">default</span>:</div><div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;    <a class="code" href="ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a>(<span class="stringliteral">&quot;unknown inst&quot;</span>);</div><div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;  }</div><div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;}</div><div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;</div><div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *BoUpSLP::vectorizeTree() {</div><div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;  Builder.SetInsertPoint(<a class="code" href="LLParser_8cpp.html#a33ece1ef8074506a15d7f86eb76dbae6">F</a>-&gt;getEntryBlock().begin());</div><div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;  vectorizeTree(&amp;VectorizableTree[0]);</div><div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;</div><div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;  <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;SLP: Extracting &quot;</span> &lt;&lt; ExternalUses.size() &lt;&lt; <span class="stringliteral">&quot; values .\n&quot;</span>);</div><div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;</div><div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;  <span class="comment">// Extract all of the elements with the external uses.</span></div><div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;  <span class="keywordflow">for</span> (UserList::iterator <a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a> = ExternalUses.begin(), e = ExternalUses.end();</div><div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;       <a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a> != e; ++<a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a>) {</div><div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *Scalar = <a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a>-&gt;Scalar;</div><div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;    <a class="code" href="classllvm_1_1User.html">llvm::User</a> *User = <a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a>-&gt;User;</div><div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;</div><div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;    <span class="comment">// Skip users that we already RAUW. This happens when one instruction</span></div><div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;    <span class="comment">// has multiple uses of the same value.</span></div><div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;    <span class="keywordflow">if</span> (std::find(Scalar-&gt;<a class="code" href="classllvm_1_1Value.html#a413abcab8dbc3900fc2fde96a5d8fca6">use_begin</a>(), Scalar-&gt;<a class="code" href="classllvm_1_1Value.html#ad86469939d2a8bdd4169be9403b89f5a">use_end</a>(), User) ==</div><div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;        Scalar-&gt;<a class="code" href="classllvm_1_1Value.html#ad86469939d2a8bdd4169be9403b89f5a">use_end</a>())</div><div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;    assert(ScalarToTreeEntry.count(Scalar) &amp;&amp; <span class="stringliteral">&quot;Invalid scalar&quot;</span>);</div><div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;</div><div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;    <span class="keywordtype">int</span> Idx = ScalarToTreeEntry[<a class="code" href="namespacellvm_1_1NVPTX_1_1PTXLdStInstCode.html#a91119cbee2be000c528a690252aee07ca09c68d67f7dbfa6cc77eaf73aa535217">Scalar</a>];</div><div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;    TreeEntry *E = &amp;VectorizableTree[Idx];</div><div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;    assert(!E-&gt;NeedToGather &amp;&amp; <span class="stringliteral">&quot;Extracting from a gather list&quot;</span>);</div><div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;</div><div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *Vec = E-&gt;VectorizedValue;</div><div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;    assert(Vec &amp;&amp; <span class="stringliteral">&quot;Can&#39;t find vectorizable value&quot;</span>);</div><div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;</div><div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *Lane = Builder.getInt32(<a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a>-&gt;Lane);</div><div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;    <span class="comment">// Generate extracts for out-of-tree users.</span></div><div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;    <span class="comment">// Find the insertion point for the extractelement lane.</span></div><div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *PN = dyn_cast&lt;PHINode&gt;(Vec)) {</div><div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;      Builder.SetInsertPoint(PN-&gt;getParent()-&gt;getFirstInsertionPt());</div><div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *Ex = Builder.CreateExtractElement(Vec, Lane);</div><div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;      CSEBlocks.insert(PN-&gt;getParent());</div><div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;      User-&gt;<a class="code" href="classllvm_1_1User.html#a1f0b9358936e3e00c42a460abbfb2868">replaceUsesOfWith</a>(Scalar, Ex);</div><div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (isa&lt;Instruction&gt;(Vec)){</div><div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *PH = dyn_cast&lt;PHINode&gt;(User)) {</div><div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0, e = PH-&gt;<a class="code" href="classllvm_1_1PHINode.html#aa45f6c0433576e3858a6209a43750ad4">getNumIncomingValues</a>(); i != e; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;          <span class="keywordflow">if</span> (PH-&gt;<a class="code" href="classllvm_1_1PHINode.html#aba6a4cc4ed6d6fef3664b8d65ef04820">getIncomingValue</a>(i) == <a class="code" href="namespacellvm_1_1NVPTX_1_1PTXLdStInstCode.html#a91119cbee2be000c528a690252aee07ca09c68d67f7dbfa6cc77eaf73aa535217">Scalar</a>) {</div><div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;            Builder.SetInsertPoint(PH-&gt;<a class="code" href="classllvm_1_1PHINode.html#a4c25b6c00c4867281779c81ab64d2081">getIncomingBlock</a>(i)-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a5cb76a65b6524dba1493dd2b9dc3abbe">getTerminator</a>());</div><div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;            <a class="code" href="classllvm_1_1Value.html">Value</a> *Ex = Builder.CreateExtractElement(Vec, Lane);</div><div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;            CSEBlocks.insert(PH-&gt;<a class="code" href="classllvm_1_1PHINode.html#a4c25b6c00c4867281779c81ab64d2081">getIncomingBlock</a>(i));</div><div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;            PH-&gt;<a class="code" href="classllvm_1_1User.html#a5fa9b8e1842b354f64c1ba6be0a4a17f">setOperand</a>(i, Ex);</div><div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;          }</div><div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;        }</div><div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;        Builder.SetInsertPoint(cast&lt;Instruction&gt;(User));</div><div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;        <a class="code" href="classllvm_1_1Value.html">Value</a> *Ex = Builder.CreateExtractElement(Vec, Lane);</div><div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;        CSEBlocks.insert(cast&lt;Instruction&gt;(User)-&gt;<a class="code" href="BasicAliasAnalysis_8cpp.html#a2675de1d8479c7b00387979714da43f7">getParent</a>());</div><div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;        User-&gt;<a class="code" href="classllvm_1_1User.html#a1f0b9358936e3e00c42a460abbfb2868">replaceUsesOfWith</a>(Scalar, Ex);</div><div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;     }</div><div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;      Builder.SetInsertPoint(<a class="code" href="LLParser_8cpp.html#a33ece1ef8074506a15d7f86eb76dbae6">F</a>-&gt;getEntryBlock().begin());</div><div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *Ex = Builder.CreateExtractElement(Vec, Lane);</div><div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;      CSEBlocks.insert(&amp;<a class="code" href="LLParser_8cpp.html#a33ece1ef8074506a15d7f86eb76dbae6">F</a>-&gt;getEntryBlock());</div><div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;      User-&gt;<a class="code" href="classllvm_1_1User.html#a1f0b9358936e3e00c42a460abbfb2868">replaceUsesOfWith</a>(Scalar, Ex);</div><div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;    }</div><div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;</div><div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;    <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;SLP: Replaced:&quot;</span> &lt;&lt; *User &lt;&lt; <span class="stringliteral">&quot;.\n&quot;</span>);</div><div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;  }</div><div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;</div><div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;  <span class="comment">// For each vectorized value:</span></div><div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> EIdx = 0, EE = VectorizableTree.size(); EIdx &lt; EE; ++EIdx) {</div><div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;    TreeEntry *Entry = &amp;VectorizableTree[EIdx];</div><div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;</div><div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;    <span class="comment">// For each lane:</span></div><div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> Lane = 0, <a class="code" href="namespacellvm_1_1A64CC.html#af5804bc0518be9568f73db566e4d6f46a98d7f1cf15bd78fd7c7c68e6543a9588">LE</a> = Entry-&gt;Scalars.size(); Lane != <a class="code" href="namespacellvm_1_1A64CC.html#af5804bc0518be9568f73db566e4d6f46a98d7f1cf15bd78fd7c7c68e6543a9588">LE</a>; ++Lane) {</div><div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *Scalar = Entry-&gt;Scalars[Lane];</div><div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;</div><div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;      <span class="comment">// No need to handle users of gathered values.</span></div><div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;      <span class="keywordflow">if</span> (Entry-&gt;NeedToGather)</div><div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;</div><div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;      assert(Entry-&gt;VectorizedValue &amp;&amp; <span class="stringliteral">&quot;Can&#39;t find vectorizable value&quot;</span>);</div><div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;</div><div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;      <a class="code" href="classllvm_1_1Type.html">Type</a> *Ty = Scalar-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>();</div><div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;      <span class="keywordflow">if</span> (!Ty-&gt;<a class="code" href="classllvm_1_1Type.html#af5c7041df3ad5edffe5da17b5264c1fc">isVoidTy</a>()) {</div><div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1value__use__iterator.html">Value::use_iterator</a> User = Scalar-&gt;<a class="code" href="classllvm_1_1Value.html#a413abcab8dbc3900fc2fde96a5d8fca6">use_begin</a>(),</div><div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;             UE = Scalar-&gt;<a class="code" href="classllvm_1_1Value.html#ad86469939d2a8bdd4169be9403b89f5a">use_end</a>(); User != UE; ++User) {</div><div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;          <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;SLP: \tvalidating user:&quot;</span> &lt;&lt; **User &lt;&lt; <span class="stringliteral">&quot;.\n&quot;</span>);</div><div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;</div><div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;          assert((ScalarToTreeEntry.count(*User) ||</div><div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;                  <span class="comment">// It is legal to replace the reduction users by undef.</span></div><div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;                  (RdxOps &amp;&amp; RdxOps-&gt;count(*User))) &amp;&amp;</div><div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;                 <span class="stringliteral">&quot;Replacing out-of-tree value with undef&quot;</span>);</div><div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;        }</div><div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;        <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1RegState.html#a079b254e749130fbe5d740f314ca92daab502f975742e9bff6d6dd7b49439b806">Undef</a> = <a class="code" href="classllvm_1_1UndefValue.html#a4ae5ff22b700a42bcc5d889233721335">UndefValue::get</a>(Ty);</div><div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;        Scalar-&gt;<a class="code" href="classllvm_1_1Value.html#a3ab5fc45117b450e8bb04e564cb6e5f2">replaceAllUsesWith</a>(Undef);</div><div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;      }</div><div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;      <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;SLP: \tErasing scalar:&quot;</span> &lt;&lt; *Scalar &lt;&lt; <span class="stringliteral">&quot;.\n&quot;</span>);</div><div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;      cast&lt;Instruction&gt;(<a class="code" href="namespacellvm_1_1NVPTX_1_1PTXLdStInstCode.html#a91119cbee2be000c528a690252aee07ca09c68d67f7dbfa6cc77eaf73aa535217">Scalar</a>)-&gt;eraseFromParent();</div><div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;    }</div><div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;  }</div><div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;</div><div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1ilist__iterator.html">Function::iterator</a> <a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a> = <a class="code" href="LLParser_8cpp.html#a33ece1ef8074506a15d7f86eb76dbae6">F</a>-&gt;begin(), e = <a class="code" href="LLParser_8cpp.html#a33ece1ef8074506a15d7f86eb76dbae6">F</a>-&gt;end(); <a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a> != e; ++<a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a>) {</div><div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;    BlocksNumbers[<a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a>].forget();</div><div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;  }</div><div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;  Builder.ClearInsertionPoint();</div><div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;</div><div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;  <span class="keywordflow">return</span> VectorizableTree[0].VectorizedValue;</div><div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;}</div><div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;</div><div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;<span class="keyword">class </span>DTCmp {</div><div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1DominatorTree.html">DominatorTree</a> *DT;</div><div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;</div><div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;  DTCmp(<span class="keyword">const</span> <a class="code" href="classllvm_1_1DominatorTree.html">DominatorTree</a> *DT) : DT(DT) {}</div><div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;  <span class="keywordtype">bool</span> operator()(<span class="keyword">const</span> <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *A, <span class="keyword">const</span> <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *B)<span class="keyword"> const </span>{</div><div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;    <span class="keywordflow">return</span> DT-&gt;<a class="code" href="classllvm_1_1DominatorTree.html#aa094180f7ac0ef9d4b8e1c78f850edd8">properlyDominates</a>(A, B);</div><div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;  }</div><div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;};</div><div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;</div><div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;<span class="keywordtype">void</span> BoUpSLP::optimizeGatherSequence() {</div><div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;  <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;SLP: Optimizing &quot;</span> &lt;&lt; GatherSeq.size()</div><div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;        &lt;&lt; <span class="stringliteral">&quot; gather sequences instructions.\n&quot;</span>);</div><div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;  <span class="comment">// LICM InsertElementInst sequences.</span></div><div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1SetVector.html#a9ceb97666ed8de600fb9520a563ff95d">SetVector&lt;Instruction *&gt;::iterator</a> <a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a> = GatherSeq.begin(),</div><div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;       e = GatherSeq.end(); <a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a> != e; ++<a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a>) {</div><div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;    <a class="code" href="classllvm_1_1InsertElementInst.html">InsertElementInst</a> *Insert = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1InsertElementInst.html">InsertElementInst</a>&gt;(*it);</div><div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;</div><div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;    <span class="keywordflow">if</span> (!Insert)</div><div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;</div><div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;    <span class="comment">// Check if this block is inside a loop.</span></div><div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;    <a class="code" href="classllvm_1_1Loop.html">Loop</a> *L = LI-&gt;getLoopFor(Insert-&gt;<a class="code" href="classllvm_1_1Instruction.html#a9cd49851904f15060edb782ef4dd1b2d">getParent</a>());</div><div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;    <span class="keywordflow">if</span> (!L)</div><div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;</div><div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;    <span class="comment">// Check if it has a preheader.</span></div><div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;    <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *PreHeader = L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a1bc74c76b876ad387293ecde0f21ed45">getLoopPreheader</a>();</div><div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;    <span class="keywordflow">if</span> (!PreHeader)</div><div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;</div><div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;    <span class="comment">// If the vector or the element that we insert into it are</span></div><div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;    <span class="comment">// instructions that are defined in this basic block then we can&#39;t</span></div><div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;    <span class="comment">// hoist this instruction.</span></div><div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *CurrVec = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1Instruction.html">Instruction</a>&gt;(Insert-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0));</div><div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *NewElem = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1Instruction.html">Instruction</a>&gt;(Insert-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(1));</div><div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;    <span class="keywordflow">if</span> (CurrVec &amp;&amp; L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a92a38e2e3412bde7fd2b71db212b61aa">contains</a>(CurrVec))</div><div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;    <span class="keywordflow">if</span> (NewElem &amp;&amp; L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a92a38e2e3412bde7fd2b71db212b61aa">contains</a>(NewElem))</div><div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;</div><div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;    <span class="comment">// We can hoist this instruction. Move it to the pre-header.</span></div><div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;    Insert-&gt;<a class="code" href="classllvm_1_1Instruction.html#af67d1f3a518964d80a109bb3d9d5cf1e">moveBefore</a>(PreHeader-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a5cb76a65b6524dba1493dd2b9dc3abbe">getTerminator</a>());</div><div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;  }</div><div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;</div><div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;  <span class="comment">// Sort blocks by domination. This ensures we visit a block after all blocks</span></div><div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;  <span class="comment">// dominating it are visited.</span></div><div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;BasicBlock *, 8&gt;</a> CSEWorkList(CSEBlocks.begin(), CSEBlocks.end());</div><div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;  std::stable_sort(CSEWorkList.begin(), CSEWorkList.end(), DTCmp(DT));</div><div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;</div><div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;  <span class="comment">// Perform O(N^2) search over the gather sequences and merge identical</span></div><div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;  <span class="comment">// instructions. TODO: We can further optimize this scan if we split the</span></div><div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;  <span class="comment">// instructions into different buckets based on the insert lane.</span></div><div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Instruction *, 16&gt;</a> Visited;</div><div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classT.html">SmallVectorImpl&lt;BasicBlock *&gt;::iterator</a> I = CSEWorkList.begin(),</div><div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;                                               E = CSEWorkList.end();</div><div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;       I != E; ++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div><div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;    assert((I == CSEWorkList.begin() || !DT-&gt;<a class="code" href="classllvm_1_1DominatorTree.html#a6fe9272dc67fe2ff4cafc33b895c4a6c">dominates</a>(*I, *<a class="code" href="namespacellvm.html#a7923e3e207de8bc1d0d6a5091316ddde">llvm::prior</a>(I))) &amp;&amp;</div><div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;           <span class="stringliteral">&quot;Worklist not sorted properly!&quot;</span>);</div><div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;    <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *BB = *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>;</div><div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;    <span class="comment">// For all instructions in blocks containing gather sequences:</span></div><div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1ilist__iterator.html">BasicBlock::iterator</a> it = BB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a0ed5f3ab3c2e4196ee0cffffa080c062">begin</a>(), e = BB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a0b4e7bee9b8575cc7db73329f1a561bd">end</a>(); it != e;) {</div><div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;      <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5a5fa7b4069ef3bd1ceb9f2caa315cf5ac">In</a> = it++;</div><div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;      <span class="keywordflow">if</span> (!isa&lt;InsertElementInst&gt;(In) &amp;&amp; !isa&lt;ExtractElementInst&gt;(<a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5a5fa7b4069ef3bd1ceb9f2caa315cf5ac">In</a>))</div><div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;</div><div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;      <span class="comment">// Check if we can replace this instruction with any of the</span></div><div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;      <span class="comment">// visited instructions.</span></div><div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classT.html">SmallVectorImpl&lt;Instruction *&gt;::iterator</a> v = Visited.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#a8a045d250952c0867382a9840ee18fdf">begin</a>(),</div><div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;                                                    ve = Visited.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#a075e34e98605d0e7c289763a104869ac">end</a>();</div><div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;           v != ve; ++v) {</div><div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;        <span class="keywordflow">if</span> (In-&gt;<a class="code" href="classllvm_1_1Instruction.html#ac72e0be80ec7138a1ec42c798b249981">isIdenticalTo</a>(*v) &amp;&amp;</div><div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;            DT-&gt;<a class="code" href="classllvm_1_1DominatorTree.html#a6fe9272dc67fe2ff4cafc33b895c4a6c">dominates</a>((*v)-&gt;getParent(), In-&gt;<a class="code" href="classllvm_1_1Instruction.html#a9cd49851904f15060edb782ef4dd1b2d">getParent</a>())) {</div><div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;          In-&gt;<a class="code" href="classllvm_1_1Value.html#a3ab5fc45117b450e8bb04e564cb6e5f2">replaceAllUsesWith</a>(*v);</div><div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;          In-&gt;<a class="code" href="classllvm_1_1Instruction.html#a6fe2f06b8a4b2c3d6308afb223a0238a">eraseFromParent</a>();</div><div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;          In = 0;</div><div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;          <span class="keywordflow">break</span>;</div><div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;        }</div><div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;      }</div><div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;      <span class="keywordflow">if</span> (In) {</div><div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;        assert(std::find(Visited.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#a8a045d250952c0867382a9840ee18fdf">begin</a>(), Visited.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#a075e34e98605d0e7c289763a104869ac">end</a>(), <a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5a5fa7b4069ef3bd1ceb9f2caa315cf5ac">In</a>) == Visited.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#a075e34e98605d0e7c289763a104869ac">end</a>());</div><div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;        Visited.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(In);</div><div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;      }</div><div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;    }</div><div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;  }</div><div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;  CSEBlocks.clear();</div><div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;  GatherSeq.clear();</div><div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;}</div><div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;<span class="comment">/// The SLPVectorizer Pass.</span></div><div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;<span class="comment"></span><span class="keyword">struct </span>SLPVectorizer : <span class="keyword">public</span> <a class="code" href="classllvm_1_1FunctionPass.html">FunctionPass</a> {</div><div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;  <span class="keyword">typedef</span> <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;StoreInst *, 8&gt;</a> StoreList;</div><div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;  <span class="keyword">typedef</span> <a class="code" href="classllvm_1_1MapVector.html">MapVector&lt;Value *, StoreList&gt;</a> StoreListMap;</div><div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;<span class="comment">  /// Pass identification, replacement for typeid</span></div><div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;<span class="comment"></span>  <span class="keyword">static</span> <span class="keywordtype">char</span> <a class="code" href="namespacellvm_1_1CallingConv.html#a4f861731fc6dbfdccc05af5968d98974">ID</a>;</div><div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;</div><div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;  <span class="keyword">explicit</span> SLPVectorizer() : <a class="code" href="classllvm_1_1FunctionPass.html">FunctionPass</a>(ID) {</div><div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;    <a class="code" href="namespacellvm.html#ad17df6f711037aaee99496571558475c">initializeSLPVectorizerPass</a>(*<a class="code" href="classllvm_1_1PassRegistry.html#a05a729900b76c89e808c6c3094921b2f">PassRegistry::getPassRegistry</a>());</div><div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;  }</div><div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;</div><div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;  <a class="code" href="classllvm_1_1ScalarEvolution.html">ScalarEvolution</a> *SE;</div><div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;  <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> *DL;</div><div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;  <a class="code" href="classllvm_1_1TargetTransformInfo.html">TargetTransformInfo</a> *TTI;</div><div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;  <a class="code" href="classllvm_1_1AliasAnalysis.html">AliasAnalysis</a> *AA;</div><div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;  <a class="code" href="classllvm_1_1LoopInfo.html">LoopInfo</a> *LI;</div><div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;  <a class="code" href="classllvm_1_1DominatorTree.html">DominatorTree</a> *DT;</div><div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;</div><div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">bool</span> runOnFunction(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="LLParser_8cpp.html#a33ece1ef8074506a15d7f86eb76dbae6">F</a>) {</div><div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;    SE = &amp;getAnalysis&lt;ScalarEvolution&gt;();</div><div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;    DL = getAnalysisIfAvailable&lt;DataLayout&gt;();</div><div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;    TTI = &amp;getAnalysis&lt;TargetTransformInfo&gt;();</div><div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;    AA = &amp;getAnalysis&lt;AliasAnalysis&gt;();</div><div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;    LI = &amp;getAnalysis&lt;LoopInfo&gt;();</div><div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;    DT = &amp;getAnalysis&lt;DominatorTree&gt;();</div><div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;</div><div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;    StoreRefs.clear();</div><div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;    <span class="keywordtype">bool</span> Changed = <span class="keyword">false</span>;</div><div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;</div><div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;    <span class="comment">// If the target claims to have no vector registers don&#39;t attempt</span></div><div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;    <span class="comment">// vectorization.</span></div><div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;    <span class="keywordflow">if</span> (!TTI-&gt;getNumberOfRegisters(<span class="keyword">true</span>))</div><div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;</div><div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;    <span class="comment">// Must have DataLayout. We can&#39;t require it because some tests run w/o</span></div><div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;    <span class="comment">// triple.</span></div><div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;    <span class="keywordflow">if</span> (!DL)</div><div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;</div><div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;    <span class="comment">// Don&#39;t vectorize when the attribute NoImplicitFloat is used.</span></div><div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;    <span class="keywordflow">if</span> (F.<a class="code" href="classllvm_1_1Function.html#a603f8f8d2c9d8de6762092830cf82b13">hasFnAttribute</a>(<a class="code" href="classllvm_1_1Attribute.html#aab7ee4b8fd1d3e7e4cea87868855e60ea9e330fa070dd4bb79cbc6c74b41958a4">Attribute::NoImplicitFloat</a>))</div><div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;</div><div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;    <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;SLP: Analyzing blocks in &quot;</span> &lt;&lt; F.<a class="code" href="classllvm_1_1Value.html#ad452febc1ac0b394876e640ec03ffa38">getName</a>() &lt;&lt; <span class="stringliteral">&quot;.\n&quot;</span>);</div><div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;</div><div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;    <span class="comment">// Use the bollom up slp vectorizer to construct chains that start with</span></div><div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;    <span class="comment">// he store instructions.</span></div><div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;    BoUpSLP R(&amp;F, SE, DL, TTI, AA, LI, DT);</div><div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;</div><div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;    <span class="comment">// Scan the blocks in the function in post order.</span></div><div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1po__iterator.html">po_iterator&lt;BasicBlock*&gt;</a> it = <a class="code" href="namespacellvm.html#a8a736f0023b19d73f205d93fec7094a8">po_begin</a>(&amp;F.<a class="code" href="classllvm_1_1Function.html#a30f2c362631e3728d2f47a8203071ade">getEntryBlock</a>()),</div><div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;         e = <a class="code" href="namespacellvm.html#a31c465b4d456accd132c6dc332316b92">po_end</a>(&amp;F.<a class="code" href="classllvm_1_1Function.html#a30f2c362631e3728d2f47a8203071ade">getEntryBlock</a>()); it != e; ++<a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a>) {</div><div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;      <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *BB = *<a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a>;</div><div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;</div><div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;      <span class="comment">// Vectorize trees that end at stores.</span></div><div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;      <span class="keywordflow">if</span> (<span class="keywordtype">unsigned</span> count = collectStores(BB, R)) {</div><div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;        (void)count;</div><div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;        <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;SLP: Found &quot;</span> &lt;&lt; count &lt;&lt; <span class="stringliteral">&quot; stores to vectorize.\n&quot;</span>);</div><div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;        Changed |= vectorizeStoreChains(R);</div><div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;      }</div><div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;</div><div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;      <span class="comment">// Vectorize trees that end at reductions.</span></div><div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;      Changed |= vectorizeChainsInBlock(BB, R);</div><div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;    }</div><div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;</div><div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;    <span class="keywordflow">if</span> (Changed) {</div><div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;      R.optimizeGatherSequence();</div><div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;      <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;SLP: vectorized \&quot;&quot;</span> &lt;&lt; F.<a class="code" href="classllvm_1_1Value.html#ad452febc1ac0b394876e640ec03ffa38">getName</a>() &lt;&lt; <span class="stringliteral">&quot;\&quot;\n&quot;</span>);</div><div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;      <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a36798313569555c6f79b4ac8cc0bf63d">verifyFunction</a>(F));</div><div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;    }</div><div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;    <span class="keywordflow">return</span> Changed;</div><div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;  }</div><div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;</div><div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span> getAnalysisUsage(<a class="code" href="classllvm_1_1AnalysisUsage.html">AnalysisUsage</a> &amp;AU)<span class="keyword"> const </span>{</div><div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;    <a class="code" href="classllvm_1_1Pass.html#a048082a5be9ae0d8901ea64de59e5c8f">FunctionPass::getAnalysisUsage</a>(AU);</div><div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;    AU.<a class="code" href="classllvm_1_1AnalysisUsage.html#ae5c60fd282ee894c87ea02c3f0fcb6d0">addRequired</a>&lt;<a class="code" href="classllvm_1_1ScalarEvolution.html">ScalarEvolution</a>&gt;();</div><div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;    AU.<a class="code" href="classllvm_1_1AnalysisUsage.html#ae5c60fd282ee894c87ea02c3f0fcb6d0">addRequired</a>&lt;<a class="code" href="classllvm_1_1AliasAnalysis.html">AliasAnalysis</a>&gt;();</div><div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;    AU.<a class="code" href="classllvm_1_1AnalysisUsage.html#ae5c60fd282ee894c87ea02c3f0fcb6d0">addRequired</a>&lt;<a class="code" href="classllvm_1_1TargetTransformInfo.html">TargetTransformInfo</a>&gt;();</div><div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;    AU.<a class="code" href="classllvm_1_1AnalysisUsage.html#ae5c60fd282ee894c87ea02c3f0fcb6d0">addRequired</a>&lt;<a class="code" href="classllvm_1_1LoopInfo.html">LoopInfo</a>&gt;();</div><div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;    AU.<a class="code" href="classllvm_1_1AnalysisUsage.html#ae5c60fd282ee894c87ea02c3f0fcb6d0">addRequired</a>&lt;<a class="code" href="classllvm_1_1DominatorTree.html">DominatorTree</a>&gt;();</div><div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;    AU.<a class="code" href="classllvm_1_1AnalysisUsage.html#a884f90190bca4bd354f2d5c91c264028">addPreserved</a>&lt;<a class="code" href="classllvm_1_1LoopInfo.html">LoopInfo</a>&gt;();</div><div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;    AU.<a class="code" href="classllvm_1_1AnalysisUsage.html#a884f90190bca4bd354f2d5c91c264028">addPreserved</a>&lt;<a class="code" href="classllvm_1_1DominatorTree.html">DominatorTree</a>&gt;();</div><div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;    AU.<a class="code" href="classllvm_1_1AnalysisUsage.html#af11a6ebf7ab3c388234cb6d5378439a3">setPreservesCFG</a>();</div><div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;  }</div><div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;</div><div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;<span class="keyword">private</span>:</div><div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;<span class="comment">  /// \brief Collect memory references and sort them according to their base</span></div><div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;<span class="comment">  /// object. We sort the stores to their base objects to reduce the cost of the</span></div><div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;<span class="comment">  /// quadratic search on the stores. TODO: We can further reduce this cost</span></div><div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;<span class="comment">  /// if we flush the chain creation every time we run into a memory barrier.</span></div><div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;<span class="comment"></span>  <span class="keywordtype">unsigned</span> collectStores(<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *BB, BoUpSLP &amp;R);</div><div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;<span class="comment">  /// \brief Try to vectorize a chain that starts at two arithmetic instrs.</span></div><div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> tryToVectorizePair(<a class="code" href="classllvm_1_1Value.html">Value</a> *A, <a class="code" href="classllvm_1_1Value.html">Value</a> *B, BoUpSLP &amp;R);</div><div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;<span class="comment">  /// \brief Try to vectorize a list of operands.</span></div><div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;<span class="comment">  /// \returns true if a value was vectorized.</span></div><div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> tryToVectorizeList(<a class="code" href="classllvm_1_1ArrayRef.html">ArrayRef&lt;Value *&gt;</a> VL, BoUpSLP &amp;R);</div><div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;<span class="comment">  /// \brief Try to vectorize a chain that may start at the operands of \V;</span></div><div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> tryToVectorize(<a class="code" href="classllvm_1_1BinaryOperator.html">BinaryOperator</a> *V, BoUpSLP &amp;R);</div><div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;<span class="comment">  /// \brief Vectorize the stores that were collected in StoreRefs.</span></div><div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> vectorizeStoreChains(BoUpSLP &amp;R);</div><div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;<span class="comment">  /// \brief Scan the basic block and look for patterns that are likely to start</span></div><div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;<span class="comment">  /// a vectorization chain.</span></div><div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> vectorizeChainsInBlock(<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *BB, BoUpSLP &amp;R);</div><div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;</div><div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;  <span class="keywordtype">bool</span> vectorizeStoreChain(<a class="code" href="classllvm_1_1ArrayRef.html">ArrayRef&lt;Value *&gt;</a> Chain, <span class="keywordtype">int</span> CostThreshold,</div><div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;                           BoUpSLP &amp;R);</div><div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;</div><div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;  <span class="keywordtype">bool</span> vectorizeStores(<a class="code" href="classllvm_1_1ArrayRef.html">ArrayRef&lt;StoreInst *&gt;</a> Stores, <span class="keywordtype">int</span> costThreshold,</div><div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;                       BoUpSLP &amp;R);</div><div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;<span class="keyword">private</span>:</div><div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;  StoreListMap StoreRefs;</div><div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;};</div><div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;<span class="comment">/// \brief Check that the Values in the slice in VL array are still existant in</span></div><div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;<span class="comment">/// the WeakVH array.</span></div><div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;<span class="comment">/// Vectorization of part of the VL array may cause later values in the VL array</span></div><div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;<span class="comment">/// to become invalid. We track when this has happened in the WeakVH array.</span></div><div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">bool</span> hasValueBeenRAUWed(<a class="code" href="classllvm_1_1ArrayRef.html">ArrayRef&lt;Value *&gt;</a> &amp;VL,</div><div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;                               <a class="code" href="classllvm_1_1SmallVectorImpl.html">SmallVectorImpl&lt;WeakVH&gt;</a> &amp;VH,</div><div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;                               <span class="keywordtype">unsigned</span> SliceBegin,</div><div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;                               <span class="keywordtype">unsigned</span> SliceSize) {</div><div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = SliceBegin; i &lt; SliceBegin + SliceSize; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div><div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;    <span class="keywordflow">if</span> (VH[i] != VL[i])</div><div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;</div><div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;}</div><div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;</div><div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;<span class="keywordtype">bool</span> SLPVectorizer::vectorizeStoreChain(<a class="code" href="classllvm_1_1ArrayRef.html">ArrayRef&lt;Value *&gt;</a> Chain,</div><div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;                                          <span class="keywordtype">int</span> CostThreshold, BoUpSLP &amp;R) {</div><div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;  <span class="keywordtype">unsigned</span> ChainLen = Chain.<a class="code" href="classllvm_1_1ArrayRef.html#a76878250107ee24ef7339870bdda4bcf">size</a>();</div><div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;  <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;SLP: Analyzing a store chain of length &quot;</span> &lt;&lt; ChainLen</div><div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *StoreTy = cast&lt;StoreInst&gt;(Chain[0])-&gt;getValueOperand()-&gt;getType();</div><div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;  <span class="keywordtype">unsigned</span> Sz = DL-&gt;getTypeSizeInBits(StoreTy);</div><div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;  <span class="keywordtype">unsigned</span> VF = MinVecRegSize / Sz;</div><div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;</div><div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm.html#af4d1a918800291e75b01ce1447be0e83">isPowerOf2_32</a>(Sz) || VF &lt; 2)</div><div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;</div><div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;  <span class="comment">// Keep track of values that were delete by vectorizing in the loop below.</span></div><div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;WeakVH, 8&gt;</a> TrackValues(Chain.<a class="code" href="classllvm_1_1ArrayRef.html#a836367b39ed630bf14db99923c22740e">begin</a>(), Chain.<a class="code" href="classllvm_1_1ArrayRef.html#a38ed8cc3c342ad6910e8c869d3e2b9cf">end</a>());</div><div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;</div><div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;  <span class="keywordtype">bool</span> Changed = <span class="keyword">false</span>;</div><div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;  <span class="comment">// Look for profitable vectorizable trees at all offsets, starting at zero.</span></div><div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0, e = ChainLen; i &lt; e; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;    <span class="keywordflow">if</span> (i + VF &gt; e)</div><div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;</div><div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;    <span class="comment">// Check that a previous iteration of this loop did not delete the Value.</span></div><div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;    <span class="keywordflow">if</span> (hasValueBeenRAUWed(Chain, TrackValues, i, VF))</div><div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;</div><div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;    <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;SLP: Analyzing &quot;</span> &lt;&lt; VF &lt;&lt; <span class="stringliteral">&quot; stores at offset &quot;</span> &lt;&lt; i</div><div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;    <a class="code" href="classllvm_1_1ArrayRef.html">ArrayRef&lt;Value *&gt;</a> Operands = Chain.<a class="code" href="classllvm_1_1ArrayRef.html#a8a4a04e719ab242a67a91dbfd17e16b0">slice</a>(i, VF);</div><div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;</div><div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;    R.buildTree(Operands);</div><div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;</div><div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;    <span class="keywordtype">int</span> Cost = R.getTreeCost();</div><div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;</div><div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;    <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;SLP: Found cost=&quot;</span> &lt;&lt; Cost &lt;&lt; <span class="stringliteral">&quot; for VF=&quot;</span> &lt;&lt; VF &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;    <span class="keywordflow">if</span> (Cost &lt; CostThreshold) {</div><div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;      <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;SLP: Decided to vectorize cost=&quot;</span> &lt;&lt; Cost &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;      R.vectorizeTree();</div><div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;</div><div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;      <span class="comment">// Move to the next bundle.</span></div><div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;      i += VF - 1;</div><div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;      Changed = <span class="keyword">true</span>;</div><div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;    }</div><div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;  }</div><div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;</div><div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;  <span class="keywordflow">return</span> Changed;</div><div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;}</div><div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;</div><div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;<span class="keywordtype">bool</span> SLPVectorizer::vectorizeStores(<a class="code" href="classllvm_1_1ArrayRef.html">ArrayRef&lt;StoreInst *&gt;</a> Stores,</div><div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;                                    <span class="keywordtype">int</span> costThreshold, BoUpSLP &amp;R) {</div><div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;  <a class="code" href="classllvm_1_1SetVector.html">SetVector&lt;Value *&gt;</a> Heads, Tails;</div><div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;  <a class="code" href="classllvm_1_1SmallDenseMap.html">SmallDenseMap&lt;Value *, Value *&gt;</a> ConsecutiveChain;</div><div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;</div><div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;  <span class="comment">// We may run into multiple chains that merge into a single chain. We mark the</span></div><div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;  <span class="comment">// stores that we vectorized so that we don&#39;t visit the same store twice.</span></div><div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;  <a class="code" href="classllvm_1_1SmallPtrSet.html">BoUpSLP::ValueSet</a> VectorizedStores;</div><div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;  <span class="keywordtype">bool</span> Changed = <span class="keyword">false</span>;</div><div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;</div><div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;  <span class="comment">// Do a quadratic search on all of the given stores and find</span></div><div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;  <span class="comment">// all of the pairs of stores that follow each other.</span></div><div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0, e = Stores.<a class="code" href="classllvm_1_1ArrayRef.html#a76878250107ee24ef7339870bdda4bcf">size</a>(); i &lt; e; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = 0; j &lt; e; ++<a class="code" href="Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a>) {</div><div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;      <span class="keywordflow">if</span> (i == j)</div><div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;</div><div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;      <span class="keywordflow">if</span> (R.isConsecutiveAccess(Stores[i], Stores[j])) {</div><div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;        Tails.<a class="code" href="classllvm_1_1SetVector.html#a72d928b7fc2c5f2d56c6ac0265fd9c6e">insert</a>(Stores[j]);</div><div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;        Heads.<a class="code" href="classllvm_1_1SetVector.html#a72d928b7fc2c5f2d56c6ac0265fd9c6e">insert</a>(Stores[i]);</div><div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;        ConsecutiveChain[Stores[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>]] = Stores[<a class="code" href="Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a>];</div><div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;      }</div><div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;    }</div><div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;  }</div><div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;</div><div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;  <span class="comment">// For stores that start but don&#39;t end a link in the chain:</span></div><div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1SetVector.html#a9ceb97666ed8de600fb9520a563ff95d">SetVector&lt;Value *&gt;::iterator</a> it = Heads.<a class="code" href="classllvm_1_1SetVector.html#adb13793b98ab59209a5309d26f831850">begin</a>(), e = Heads.<a class="code" href="classllvm_1_1SetVector.html#affac0dc3d407ef3dee29b8bc9a4836bc">end</a>();</div><div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;       it != e; ++<a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a>) {</div><div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;    <span class="keywordflow">if</span> (Tails.<a class="code" href="classllvm_1_1SetVector.html#a0fd2953d62c1b1cabb87e420be5177c4">count</a>(*it))</div><div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;</div><div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;    <span class="comment">// We found a store instr that starts a chain. Now follow the chain and try</span></div><div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;    <span class="comment">// to vectorize it.</span></div><div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;    <a class="code" href="classllvm_1_1SmallVector.html">BoUpSLP::ValueList</a> Operands;</div><div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *I = *<a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a>;</div><div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;    <span class="comment">// Collect the chain into a list.</span></div><div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;    <span class="keywordflow">while</span> (Tails.<a class="code" href="classllvm_1_1SetVector.html#a0fd2953d62c1b1cabb87e420be5177c4">count</a>(I) || Heads.<a class="code" href="classllvm_1_1SetVector.html#a0fd2953d62c1b1cabb87e420be5177c4">count</a>(I)) {</div><div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;      <span class="keywordflow">if</span> (VectorizedStores.<a class="code" href="classllvm_1_1SmallPtrSet.html#a2ced6343b8ad006a757059554bbf9f37">count</a>(I))</div><div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;      Operands.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(I);</div><div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;      <span class="comment">// Move to the next value in the chain.</span></div><div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;      I = ConsecutiveChain[<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>];</div><div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;    }</div><div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;</div><div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;    <span class="keywordtype">bool</span> Vectorized = vectorizeStoreChain(Operands, costThreshold, R);</div><div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;</div><div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;    <span class="comment">// Mark the vectorized stores so that we don&#39;t vectorize them again.</span></div><div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;    <span class="keywordflow">if</span> (Vectorized)</div><div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;      VectorizedStores.<a class="code" href="classllvm_1_1SmallPtrSet.html#a9b6dd0fc7a648a939e571246045b673e">insert</a>(Operands.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#a8a045d250952c0867382a9840ee18fdf">begin</a>(), Operands.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#a075e34e98605d0e7c289763a104869ac">end</a>());</div><div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;    Changed |= Vectorized;</div><div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;  }</div><div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;</div><div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;  <span class="keywordflow">return</span> Changed;</div><div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;}</div><div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;</div><div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;</div><div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;<span class="keywordtype">unsigned</span> SLPVectorizer::collectStores(<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *BB, BoUpSLP &amp;R) {</div><div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;  <span class="keywordtype">unsigned</span> count = 0;</div><div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;  StoreRefs.clear();</div><div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1ilist__iterator.html">BasicBlock::iterator</a> it = BB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a0ed5f3ab3c2e4196ee0cffffa080c062">begin</a>(), e = BB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a0b4e7bee9b8575cc7db73329f1a561bd">end</a>(); it != e; ++<a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a>) {</div><div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;    <a class="code" href="classllvm_1_1StoreInst.html">StoreInst</a> *SI = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1StoreInst.html">StoreInst</a>&gt;(<a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a>);</div><div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;    <span class="keywordflow">if</span> (!SI)</div><div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;</div><div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;    <span class="comment">// Don&#39;t touch volatile stores.</span></div><div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;    <span class="keywordflow">if</span> (!SI-&gt;<a class="code" href="classllvm_1_1StoreInst.html#a1149c7eeefca671ac2685bca13843568">isSimple</a>())</div><div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;</div><div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;    <span class="comment">// Check that the pointer points to scalars.</span></div><div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;    <a class="code" href="classllvm_1_1Type.html">Type</a> *Ty = SI-&gt;<a class="code" href="classllvm_1_1StoreInst.html#a14298313bdf734e2db5a921cc6e861a0">getValueOperand</a>()-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>();</div><div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;    <span class="keywordflow">if</span> (Ty-&gt;<a class="code" href="classllvm_1_1Type.html#a0a32c2cb0342323dc78f6aa31d7e581e">isAggregateType</a>() || Ty-&gt;<a class="code" href="classllvm_1_1Type.html#a6f725580f7834e2ca90762965866dad4">isVectorTy</a>())</div><div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;</div><div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;    <span class="comment">// Find the base pointer.</span></div><div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *Ptr = <a class="code" href="namespacellvm.html#ace6c957db39858291c6ce01c38e78480">GetUnderlyingObject</a>(SI-&gt;<a class="code" href="classllvm_1_1StoreInst.html#ac03c1c093059ea000216af8dd6f2dbf4">getPointerOperand</a>(), DL);</div><div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;</div><div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;    <span class="comment">// Save the store locations.</span></div><div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;    StoreRefs[Ptr].push_back(SI);</div><div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;    count++;</div><div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;  }</div><div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;  <span class="keywordflow">return</span> count;</div><div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;}</div><div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;</div><div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;<span class="keywordtype">bool</span> SLPVectorizer::tryToVectorizePair(<a class="code" href="classllvm_1_1Value.html">Value</a> *A, <a class="code" href="classllvm_1_1Value.html">Value</a> *B, BoUpSLP &amp;R) {</div><div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;  <span class="keywordflow">if</span> (!A || !B)</div><div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *VL[] = { <a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>, B };</div><div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;  <span class="keywordflow">return</span> tryToVectorizeList(VL, R);</div><div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;}</div><div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;</div><div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;<span class="keywordtype">bool</span> SLPVectorizer::tryToVectorizeList(<a class="code" href="classllvm_1_1ArrayRef.html">ArrayRef&lt;Value *&gt;</a> VL, BoUpSLP &amp;R) {</div><div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;  <span class="keywordflow">if</span> (VL.<a class="code" href="classllvm_1_1ArrayRef.html#a76878250107ee24ef7339870bdda4bcf">size</a>() &lt; 2)</div><div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;</div><div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;  <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;SLP: Vectorizing a list of length = &quot;</span> &lt;&lt; VL.<a class="code" href="classllvm_1_1ArrayRef.html#a76878250107ee24ef7339870bdda4bcf">size</a>() &lt;&lt; <span class="stringliteral">&quot;.\n&quot;</span>);</div><div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;</div><div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;  <span class="comment">// Check that all of the parts are scalar instructions of the same type.</span></div><div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *I0 = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1Instruction.html">Instruction</a>&gt;(VL[0]);</div><div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;  <span class="keywordflow">if</span> (!I0)</div><div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;</div><div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;  <span class="keywordtype">unsigned</span> Opcode0 = I0-&gt;<a class="code" href="classllvm_1_1Instruction.html#a021bb7c9aad6003fe8089f6327356c6c">getOpcode</a>();</div><div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;</div><div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *Ty0 = I0-&gt;getType();</div><div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;  <span class="keywordtype">unsigned</span> Sz = DL-&gt;getTypeSizeInBits(Ty0);</div><div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;  <span class="keywordtype">unsigned</span> VF = MinVecRegSize / Sz;</div><div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;</div><div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0, e = VL.<a class="code" href="classllvm_1_1ArrayRef.html#a76878250107ee24ef7339870bdda4bcf">size</a>(); i &lt; e; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;    <a class="code" href="classllvm_1_1Type.html">Type</a> *Ty = VL[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;getType();</div><div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;    <span class="keywordflow">if</span> (Ty-&gt;<a class="code" href="classllvm_1_1Type.html#a0a32c2cb0342323dc78f6aa31d7e581e">isAggregateType</a>() || Ty-&gt;<a class="code" href="classllvm_1_1Type.html#a6f725580f7834e2ca90762965866dad4">isVectorTy</a>())</div><div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *Inst = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1Instruction.html">Instruction</a>&gt;(VL[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div><div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;    <span class="keywordflow">if</span> (!Inst || Inst-&gt;<a class="code" href="classllvm_1_1Instruction.html#a021bb7c9aad6003fe8089f6327356c6c">getOpcode</a>() != Opcode0)</div><div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;  }</div><div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;</div><div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;  <span class="keywordtype">bool</span> Changed = <span class="keyword">false</span>;</div><div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;</div><div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;  <span class="comment">// Keep track of values that were delete by vectorizing in the loop below.</span></div><div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;WeakVH, 8&gt;</a> TrackValues(VL.<a class="code" href="classllvm_1_1ArrayRef.html#a836367b39ed630bf14db99923c22740e">begin</a>(), VL.<a class="code" href="classllvm_1_1ArrayRef.html#a38ed8cc3c342ad6910e8c869d3e2b9cf">end</a>());</div><div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;</div><div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0, e = VL.<a class="code" href="classllvm_1_1ArrayRef.html#a76878250107ee24ef7339870bdda4bcf">size</a>(); i &lt; e; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;    <span class="keywordtype">unsigned</span> OpsWidth = 0;</div><div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;</div><div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;    <span class="keywordflow">if</span> (i + VF &gt; e)</div><div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;      OpsWidth = e - <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div><div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;      OpsWidth = VF;</div><div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;</div><div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm.html#af4d1a918800291e75b01ce1447be0e83">isPowerOf2_32</a>(OpsWidth) || OpsWidth &lt; 2)</div><div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;</div><div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;    <span class="comment">// Check that a previous iteration of this loop did not delete the Value.</span></div><div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;    <span class="keywordflow">if</span> (hasValueBeenRAUWed(VL, TrackValues, i, OpsWidth))</div><div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;</div><div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;    <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;SLP: Analyzing &quot;</span> &lt;&lt; OpsWidth &lt;&lt; <span class="stringliteral">&quot; operations &quot;</span></div><div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;    <a class="code" href="classllvm_1_1ArrayRef.html">ArrayRef&lt;Value *&gt;</a> Ops = VL.<a class="code" href="classllvm_1_1ArrayRef.html#a8a4a04e719ab242a67a91dbfd17e16b0">slice</a>(i, OpsWidth);</div><div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;</div><div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;    R.buildTree(Ops);</div><div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;    <span class="keywordtype">int</span> Cost = R.getTreeCost();</div><div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;</div><div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;    <span class="keywordflow">if</span> (Cost &lt; -<a class="code" href="SLPVectorizer_8cpp.html#a6f911c7c687cf91f4f1c42b45d501448">SLPCostThreshold</a>) {</div><div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;      <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;SLP: Vectorizing pair at cost:&quot;</span> &lt;&lt; Cost &lt;&lt; <span class="stringliteral">&quot;.\n&quot;</span>);</div><div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;      R.vectorizeTree();</div><div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;</div><div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;      <span class="comment">// Move to the next bundle.</span></div><div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;      i += VF - 1;</div><div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;      Changed = <span class="keyword">true</span>;</div><div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;    }</div><div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;  }</div><div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;</div><div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;  <span class="keywordflow">return</span> Changed;</div><div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;}</div><div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;</div><div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;<span class="keywordtype">bool</span> SLPVectorizer::tryToVectorize(<a class="code" href="classllvm_1_1BinaryOperator.html">BinaryOperator</a> *V, BoUpSLP &amp;R) {</div><div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;  <span class="keywordflow">if</span> (!V)</div><div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;</div><div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;  <span class="comment">// Try to vectorize V.</span></div><div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;  <span class="keywordflow">if</span> (tryToVectorizePair(V-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0), V-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(1), R))</div><div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;</div><div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;  <a class="code" href="classllvm_1_1BinaryOperator.html">BinaryOperator</a> *A = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1BinaryOperator.html">BinaryOperator</a>&gt;(V-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0));</div><div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;  <a class="code" href="classllvm_1_1BinaryOperator.html">BinaryOperator</a> *B = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1BinaryOperator.html">BinaryOperator</a>&gt;(V-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(1));</div><div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;  <span class="comment">// Try to skip B.</span></div><div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;  <span class="keywordflow">if</span> (B &amp;&amp; B-&gt;hasOneUse()) {</div><div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;    <a class="code" href="classllvm_1_1BinaryOperator.html">BinaryOperator</a> *B0 = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1BinaryOperator.html">BinaryOperator</a>&gt;(B-&gt;getOperand(0));</div><div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;    <a class="code" href="classllvm_1_1BinaryOperator.html">BinaryOperator</a> *B1 = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1BinaryOperator.html">BinaryOperator</a>&gt;(B-&gt;getOperand(1));</div><div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;    <span class="keywordflow">if</span> (tryToVectorizePair(A, B0, R)) {</div><div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;      B-&gt;<a class="code" href="classllvm_1_1Instruction.html#af67d1f3a518964d80a109bb3d9d5cf1e">moveBefore</a>(V);</div><div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;    }</div><div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;    <span class="keywordflow">if</span> (tryToVectorizePair(A, B1, R)) {</div><div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;      B-&gt;moveBefore(V);</div><div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;    }</div><div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;  }</div><div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;</div><div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;  <span class="comment">// Try to skip A.</span></div><div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;  <span class="keywordflow">if</span> (A &amp;&amp; A-&gt;<a class="code" href="classllvm_1_1Value.html#a085b82f074c28030fb8e194377ed2d0c">hasOneUse</a>()) {</div><div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;    <a class="code" href="classllvm_1_1BinaryOperator.html">BinaryOperator</a> *A0 = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1BinaryOperator.html">BinaryOperator</a>&gt;(A-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0));</div><div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;    <a class="code" href="classllvm_1_1BinaryOperator.html">BinaryOperator</a> *A1 = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1BinaryOperator.html">BinaryOperator</a>&gt;(A-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(1));</div><div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;    <span class="keywordflow">if</span> (tryToVectorizePair(A0, B, R)) {</div><div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;      A-&gt;<a class="code" href="classllvm_1_1Instruction.html#af67d1f3a518964d80a109bb3d9d5cf1e">moveBefore</a>(V);</div><div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;    }</div><div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;    <span class="keywordflow">if</span> (tryToVectorizePair(A1, B, R)) {</div><div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;      A-&gt;<a class="code" href="classllvm_1_1Instruction.html#af67d1f3a518964d80a109bb3d9d5cf1e">moveBefore</a>(V);</div><div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;    }</div><div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;  }</div><div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;}</div><div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;<span class="comment">/// \brief Generate a shuffle mask to be used in a reduction tree.</span></div><div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;<span class="comment">/// \param VecLen The length of the vector to be reduced.</span></div><div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;<span class="comment">/// \param NumEltsToRdx The number of elements that should be reduced in the</span></div><div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;<span class="comment">///        vector.</span></div><div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;<span class="comment">/// \param IsPairwise Whether the reduction is a pairwise or splitting</span></div><div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;<span class="comment">///        reduction. A pairwise reduction will generate a mask of </span></div><div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;<span class="comment">///        &lt;0,2,...&gt; or &lt;1,3,..&gt; while a splitting reduction will generate</span></div><div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;<span class="comment">///        &lt;2,3, undef,undef&gt; for a vector of 4 and NumElts = 2.</span></div><div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;<span class="comment">/// \param IsLeft True will generate a mask of even elements, odd otherwise.</span></div><div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;<span class="comment"></span><span class="keyword">static</span> <a class="code" href="classllvm_1_1Value.html">Value</a> *createRdxShuffleMask(<span class="keywordtype">unsigned</span> VecLen, <span class="keywordtype">unsigned</span> NumEltsToRdx,</div><div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;                                   <span class="keywordtype">bool</span> IsPairwise, <span class="keywordtype">bool</span> IsLeft,</div><div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;                                   <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> &amp;Builder) {</div><div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;  assert((IsPairwise || !IsLeft) &amp;&amp; <span class="stringliteral">&quot;Don&#39;t support a &lt;0,1,undef,...&gt; mask&quot;</span>);</div><div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;</div><div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Constant *, 32&gt;</a> ShuffleMask(</div><div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;      VecLen, <a class="code" href="classllvm_1_1UndefValue.html#a4ae5ff22b700a42bcc5d889233721335">UndefValue::get</a>(Builder.<a class="code" href="classllvm_1_1IRBuilderBase.html#a6ee1d1e7a13072ef579558d64b208d3c">getInt32Ty</a>()));</div><div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;</div><div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;  <span class="keywordflow">if</span> (IsPairwise)</div><div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;    <span class="comment">// Build a mask of 0, 2, ... (left) or 1, 3, ... (right).</span></div><div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i != NumEltsToRdx; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div><div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;      ShuffleMask[i] = Builder.<a class="code" href="classllvm_1_1IRBuilderBase.html#ac0e8c554bf1c1e117a74d51df89c137d">getInt32</a>(2 * i + !IsLeft);</div><div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;    <span class="comment">// Move the upper half of the vector to the lower half.</span></div><div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i != NumEltsToRdx; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div><div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;      ShuffleMask[i] = Builder.<a class="code" href="classllvm_1_1IRBuilderBase.html#ac0e8c554bf1c1e117a74d51df89c137d">getInt32</a>(NumEltsToRdx + i);</div><div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;</div><div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1ConstantVector.html#ade9fa017ca3aa82f7694a47090547bc1">ConstantVector::get</a>(ShuffleMask);</div><div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;}</div><div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;</div><div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;<span class="comment">/// Model horizontal reductions.</span></div><div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;<span class="comment">/// A horizontal reduction is a tree of reduction operations (currently add and</span></div><div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;<span class="comment">/// fadd) that has operations that can be put into a vector as its leaf.</span></div><div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;<span class="comment">/// For example, this tree:</span></div><div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;<span class="comment">/// mul mul mul mul</span></div><div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;<span class="comment">///  \  /    \  /</span></div><div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;<span class="comment">///   +       +</span></div><div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;<span class="comment">///    \     /</span></div><div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;<span class="comment">///       +</span></div><div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;<span class="comment">/// This tree has &quot;mul&quot; as its reduced values and &quot;+&quot; as its reduction</span></div><div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;<span class="comment">/// operations. A reduction might be feeding into a store or a binary operation</span></div><div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;<span class="comment">/// feeding a phi.</span></div><div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;<span class="comment">///    ...</span></div><div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;<span class="comment">///    \  /</span></div><div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;<span class="comment">///     +</span></div><div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;<span class="comment">///     |</span></div><div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;<span class="comment">///  phi +=</span></div><div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;<span class="comment">///  Or:</span></div><div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;<span class="comment">///    ...</span></div><div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;<span class="comment">///    \  /</span></div><div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;<span class="comment">///     +</span></div><div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;<span class="comment">///     |</span></div><div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;<span class="comment">///   *p =</span></div><div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;<span class="comment"></span><span class="keyword">class </span>HorizontalReduction {</div><div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;  <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;Value *, 16&gt;</a> ReductionOps;</div><div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Value *, 32&gt;</a> ReducedVals;</div><div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;</div><div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;  <a class="code" href="classllvm_1_1BinaryOperator.html">BinaryOperator</a> *ReductionRoot;</div><div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;  <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *ReductionPHI;</div><div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;<span class="comment">  /// The opcode of the reduction.</span></div><div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;<span class="comment"></span>  <span class="keywordtype">unsigned</span> ReductionOpcode;<span class="comment"></span></div><div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;<span class="comment">  /// The opcode of the values we perform a reduction on.</span></div><div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;<span class="comment"></span>  <span class="keywordtype">unsigned</span> ReducedValueOpcode;<span class="comment"></span></div><div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;<span class="comment">  /// The width of one full horizontal reduction operation.</span></div><div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;<span class="comment"></span>  <span class="keywordtype">unsigned</span> ReduxWidth;<span class="comment"></span></div><div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;<span class="comment">  /// Should we model this reduction as a pairwise reduction tree or a tree that</span></div><div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;<span class="comment">  /// splits the vector in halves and adds those halves.</span></div><div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> IsPairwiseReduction;</div><div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;</div><div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;  HorizontalReduction()</div><div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;    : ReductionRoot(0), ReductionPHI(0), ReductionOpcode(0),</div><div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;    ReducedValueOpcode(0), ReduxWidth(0), IsPairwiseReduction(<a class="code" href="namespacefalse.html">false</a>) {}</div><div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;<span class="comment">  /// \brief Try to find a reduction tree.</span></div><div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> matchAssociativeReduction(<a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *Phi, <a class="code" href="classllvm_1_1BinaryOperator.html">BinaryOperator</a> *B,</div><div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;                                 <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> *DL) {</div><div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;    assert((!Phi ||</div><div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;            std::find(Phi-&gt;<a class="code" href="classllvm_1_1User.html#a2eeb1c7ed1cfe403f2ae0470e36c07e2">op_begin</a>(), Phi-&gt;<a class="code" href="classllvm_1_1User.html#af41f58e730804d10b91fcff39b035f74">op_end</a>(), <a class="code" href="Target_2ARM_2README_8txt.html#a90cca76dd78688687e0d697679dbc799">B</a>) != Phi-&gt;<a class="code" href="classllvm_1_1User.html#af41f58e730804d10b91fcff39b035f74">op_end</a>()) &amp;&amp;</div><div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;           <span class="stringliteral">&quot;Thi phi needs to use the binary operator&quot;</span>);</div><div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;</div><div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;    <span class="comment">// We could have a initial reductions that is not an add.</span></div><div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;    <span class="comment">//  r *= v1 + v2 + v3 + v4</span></div><div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;    <span class="comment">// In such a case start looking for a tree rooted in the first &#39;+&#39;.</span></div><div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;    <span class="keywordflow">if</span> (Phi) {</div><div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;      <span class="keywordflow">if</span> (B-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0) == Phi) {</div><div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;        Phi = 0;</div><div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;        B = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1BinaryOperator.html">BinaryOperator</a>&gt;(B-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(1));</div><div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (B-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(1) == Phi) {</div><div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;        Phi = 0;</div><div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;        B = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1BinaryOperator.html">BinaryOperator</a>&gt;(B-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0));</div><div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;      }</div><div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;    }</div><div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;</div><div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;    <span class="keywordflow">if</span> (!B)</div><div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;</div><div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;    <a class="code" href="classllvm_1_1Type.html">Type</a> *Ty = B-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>();</div><div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;    <span class="keywordflow">if</span> (Ty-&gt;<a class="code" href="classllvm_1_1Type.html#a6f725580f7834e2ca90762965866dad4">isVectorTy</a>())</div><div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;</div><div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;    ReductionOpcode = B-&gt;<a class="code" href="classllvm_1_1BinaryOperator.html#a88505baf41407782678a5df1702d2d31">getOpcode</a>();</div><div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;    ReducedValueOpcode = 0;</div><div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;    ReduxWidth = MinVecRegSize / DL-&gt;<a class="code" href="classllvm_1_1DataLayout.html#add914112e0b2935dda06ad5dfd3a31db">getTypeSizeInBits</a>(Ty);</div><div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;    ReductionRoot = <a class="code" href="Target_2ARM_2README_8txt.html#a90cca76dd78688687e0d697679dbc799">B</a>;</div><div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;    ReductionPHI = Phi;</div><div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;</div><div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;    <span class="keywordflow">if</span> (ReduxWidth &lt; 4)</div><div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;</div><div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;    <span class="comment">// We currently only support adds.</span></div><div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;    <span class="keywordflow">if</span> (ReductionOpcode != Instruction::Add &amp;&amp;</div><div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;        ReductionOpcode != Instruction::FAdd)</div><div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;</div><div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;    <span class="comment">// Post order traverse the reduction tree starting at B. We only handle true</span></div><div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;    <span class="comment">// trees containing only binary operators.</span></div><div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;    <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;std::pair&lt;BinaryOperator *, unsigned&gt;</a>, 32&gt; Stack;</div><div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;    Stack.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(std::make_pair(B, 0));</div><div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;    <span class="keywordflow">while</span> (!Stack.<a class="code" href="classllvm_1_1SmallVectorBase.html#a8a8df4d85555c7954a95f86080cd3b64">empty</a>()) {</div><div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;      <a class="code" href="classllvm_1_1BinaryOperator.html">BinaryOperator</a> *TreeN = Stack.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#acd9e771a3296c6b24146955754620557">back</a>().first;</div><div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;      <span class="keywordtype">unsigned</span> EdgeToVist = Stack.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#acd9e771a3296c6b24146955754620557">back</a>().second++;</div><div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;      <span class="keywordtype">bool</span> IsReducedValue = TreeN-&gt;<a class="code" href="classllvm_1_1BinaryOperator.html#a88505baf41407782678a5df1702d2d31">getOpcode</a>() != ReductionOpcode;</div><div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;</div><div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;      <span class="comment">// Only handle trees in the current basic block.</span></div><div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;      <span class="keywordflow">if</span> (TreeN-&gt;<a class="code" href="classllvm_1_1Instruction.html#a9cd49851904f15060edb782ef4dd1b2d">getParent</a>() != B-&gt;<a class="code" href="classllvm_1_1Instruction.html#a9cd49851904f15060edb782ef4dd1b2d">getParent</a>())</div><div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;</div><div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;      <span class="comment">// Each tree node needs to have one user except for the ultimate</span></div><div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;      <span class="comment">// reduction.</span></div><div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;      <span class="keywordflow">if</span> (!TreeN-&gt;<a class="code" href="classllvm_1_1Value.html#a085b82f074c28030fb8e194377ed2d0c">hasOneUse</a>() &amp;&amp; TreeN != <a class="code" href="Target_2ARM_2README_8txt.html#a90cca76dd78688687e0d697679dbc799">B</a>)</div><div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;</div><div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;      <span class="comment">// Postorder vist.</span></div><div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;      <span class="keywordflow">if</span> (EdgeToVist == 2 || IsReducedValue) {</div><div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;        <span class="keywordflow">if</span> (IsReducedValue) {</div><div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;          <span class="comment">// Make sure that the opcodes of the operations that we are going to</span></div><div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;          <span class="comment">// reduce match.</span></div><div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;          <span class="keywordflow">if</span> (!ReducedValueOpcode)</div><div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;            ReducedValueOpcode = TreeN-&gt;<a class="code" href="classllvm_1_1BinaryOperator.html#a88505baf41407782678a5df1702d2d31">getOpcode</a>();</div><div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ReducedValueOpcode != TreeN-&gt;<a class="code" href="classllvm_1_1BinaryOperator.html#a88505baf41407782678a5df1702d2d31">getOpcode</a>())</div><div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;          ReducedVals.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(TreeN);</div><div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;          <span class="comment">// We need to be able to reassociate the adds.</span></div><div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;          <span class="keywordflow">if</span> (!TreeN-&gt;<a class="code" href="classllvm_1_1Instruction.html#aa113b8a9ef3de9c2f075a046ad658717">isAssociative</a>())</div><div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;          ReductionOps.<a class="code" href="classllvm_1_1SmallPtrSet.html#a9b6dd0fc7a648a939e571246045b673e">insert</a>(TreeN);</div><div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;        }</div><div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;        <span class="comment">// Retract.</span></div><div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;        Stack.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#a1f2303df9bbee2233c11d61c2f6f7930">pop_back</a>();</div><div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;      }</div><div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;</div><div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;      <span class="comment">// Visit left or right.</span></div><div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *NextV = TreeN-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(EdgeToVist);</div><div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;      <a class="code" href="classllvm_1_1BinaryOperator.html">BinaryOperator</a> *Next = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1BinaryOperator.html">BinaryOperator</a>&gt;(NextV);</div><div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;      <span class="keywordflow">if</span> (Next)</div><div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;        Stack.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(std::make_pair(Next, 0));</div><div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (NextV != Phi)</div><div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;    }</div><div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;  }</div><div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;<span class="comment">  /// \brief Attempt to vectorize the tree found by</span></div><div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;<span class="comment">  /// matchAssociativeReduction.</span></div><div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> tryToReduce(BoUpSLP &amp;V, <a class="code" href="classllvm_1_1TargetTransformInfo.html">TargetTransformInfo</a> *TTI) {</div><div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;    <span class="keywordflow">if</span> (ReducedVals.<a class="code" href="classllvm_1_1SmallVectorBase.html#a8a8df4d85555c7954a95f86080cd3b64">empty</a>())</div><div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;</div><div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;    <span class="keywordtype">unsigned</span> NumReducedVals = ReducedVals.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#a22a311dfe4c28a897de8a9365a4f0a84">size</a>();</div><div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;    <span class="keywordflow">if</span> (NumReducedVals &lt; ReduxWidth)</div><div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;</div><div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *VectorizedTree = 0;</div><div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;    <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> Builder(ReductionRoot);</div><div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;    <a class="code" href="classllvm_1_1FastMathFlags.html">FastMathFlags</a> Unsafe;</div><div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;    Unsafe.<a class="code" href="classllvm_1_1FastMathFlags.html#a056f6222d38bebe1ed7c885738d24606">setUnsafeAlgebra</a>();</div><div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;    Builder.<a class="code" href="classllvm_1_1IRBuilderBase.html#af1854d7c68b31127dbca0f80dd2bdf6d">SetFastMathFlags</a>(Unsafe);</div><div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;    <span class="keywordtype">unsigned</span> i = 0;</div><div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;</div><div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;    <span class="keywordflow">for</span> (; i &lt; NumReducedVals - ReduxWidth + 1; i += ReduxWidth) {</div><div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;      <a class="code" href="classllvm_1_1ArrayRef.html">ArrayRef&lt;Value *&gt;</a> ValsToReduce(&amp;ReducedVals[i], ReduxWidth);</div><div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;      V.buildTree(ValsToReduce, &amp;ReductionOps);</div><div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;</div><div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;      <span class="comment">// Estimate cost.</span></div><div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;      <span class="keywordtype">int</span> Cost = V.getTreeCost() + getReductionCost(TTI, ReducedVals[i]);</div><div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;      <span class="keywordflow">if</span> (Cost &gt;= -<a class="code" href="SLPVectorizer_8cpp.html#a6f911c7c687cf91f4f1c42b45d501448">SLPCostThreshold</a>)</div><div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;</div><div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;      <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;SLP: Vectorizing horizontal reduction at cost:&quot;</span> &lt;&lt; Cost</div><div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot;. (HorRdx)\n&quot;</span>);</div><div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;</div><div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;      <span class="comment">// Vectorize a tree.</span></div><div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;      <a class="code" href="classllvm_1_1DebugLoc.html">DebugLoc</a> Loc = cast&lt;Instruction&gt;(ReducedVals[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>])-&gt;getDebugLoc();</div><div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *VectorizedRoot = V.vectorizeTree();</div><div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;</div><div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;      <span class="comment">// Emit a reduction.</span></div><div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *ReducedSubTree = emitReduction(VectorizedRoot, Builder);</div><div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;      <span class="keywordflow">if</span> (VectorizedTree) {</div><div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;        Builder.<a class="code" href="classllvm_1_1IRBuilderBase.html#a571ae7ebae7038da7f6073efc65aaa50">SetCurrentDebugLocation</a>(Loc);</div><div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;        VectorizedTree = createBinOp(Builder, ReductionOpcode, VectorizedTree,</div><div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;                                     ReducedSubTree, <span class="stringliteral">&quot;bin.rdx&quot;</span>);</div><div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;      } <span class="keywordflow">else</span></div><div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;        VectorizedTree = ReducedSubTree;</div><div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;    }</div><div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;</div><div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;    <span class="keywordflow">if</span> (VectorizedTree) {</div><div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;      <span class="comment">// Finish the reduction.</span></div><div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;      <span class="keywordflow">for</span> (; i &lt; NumReducedVals; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;        Builder.<a class="code" href="classllvm_1_1IRBuilderBase.html#a571ae7ebae7038da7f6073efc65aaa50">SetCurrentDebugLocation</a>(</div><div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;          cast&lt;Instruction&gt;(ReducedVals[i])-&gt;getDebugLoc());</div><div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;        VectorizedTree = createBinOp(Builder, ReductionOpcode, VectorizedTree,</div><div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;                                     ReducedVals[i]);</div><div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;      }</div><div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;      <span class="comment">// Update users.</span></div><div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;      <span class="keywordflow">if</span> (ReductionPHI) {</div><div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;        assert(ReductionRoot != NULL &amp;&amp; <span class="stringliteral">&quot;Need a reduction operation&quot;</span>);</div><div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;        ReductionRoot-&gt;<a class="code" href="classllvm_1_1User.html#a5fa9b8e1842b354f64c1ba6be0a4a17f">setOperand</a>(0, VectorizedTree);</div><div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;        ReductionRoot-&gt;<a class="code" href="classllvm_1_1User.html#a5fa9b8e1842b354f64c1ba6be0a4a17f">setOperand</a>(1, ReductionPHI);</div><div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;      } <span class="keywordflow">else</span></div><div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;        ReductionRoot-&gt;<a class="code" href="classllvm_1_1Value.html#a3ab5fc45117b450e8bb04e564cb6e5f2">replaceAllUsesWith</a>(VectorizedTree);</div><div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;    }</div><div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;    <span class="keywordflow">return</span> VectorizedTree != 0;</div><div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;  }</div><div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;</div><div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;<span class="keyword">private</span>:</div><div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;<span class="comment">  /// \brief Calcuate the cost of a reduction.</span></div><div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;<span class="comment"></span>  <span class="keywordtype">int</span> getReductionCost(<a class="code" href="classllvm_1_1TargetTransformInfo.html">TargetTransformInfo</a> *TTI, <a class="code" href="classllvm_1_1Value.html">Value</a> *FirstReducedVal) {</div><div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;    <a class="code" href="classllvm_1_1Type.html">Type</a> *ScalarTy = FirstReducedVal-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>();</div><div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;    <a class="code" href="classllvm_1_1Type.html">Type</a> *VecTy = <a class="code" href="classllvm_1_1VectorType.html#ab43657ed1abe2e2ed3a6a394f233ebd0">VectorType::get</a>(ScalarTy, ReduxWidth);</div><div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;</div><div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;    <span class="keywordtype">int</span> PairwiseRdxCost = TTI-&gt;<a class="code" href="classllvm_1_1TargetTransformInfo.html#a58c65bee90b0fead29b2293c4ed69f88">getReductionCost</a>(ReductionOpcode, VecTy, <span class="keyword">true</span>);</div><div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;    <span class="keywordtype">int</span> SplittingRdxCost = TTI-&gt;<a class="code" href="classllvm_1_1TargetTransformInfo.html#a58c65bee90b0fead29b2293c4ed69f88">getReductionCost</a>(ReductionOpcode, VecTy, <span class="keyword">false</span>);</div><div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;</div><div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;    IsPairwiseReduction = PairwiseRdxCost &lt; SplittingRdxCost;</div><div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;    <span class="keywordtype">int</span> VecReduxCost = IsPairwiseReduction ? PairwiseRdxCost : SplittingRdxCost;</div><div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;</div><div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;    <span class="keywordtype">int</span> ScalarReduxCost =</div><div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;        ReduxWidth * TTI-&gt;<a class="code" href="classllvm_1_1TargetTransformInfo.html#ae6a7e3b0f332156aa068e2c78efbf73a">getArithmeticInstrCost</a>(ReductionOpcode, VecTy);</div><div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;</div><div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;    <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;SLP: Adding cost &quot;</span> &lt;&lt; VecReduxCost - ScalarReduxCost</div><div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot; for reduction that starts with &quot;</span> &lt;&lt; *FirstReducedVal</div><div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot; (It is a &quot;</span></div><div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;                 &lt;&lt; (IsPairwiseReduction ? <span class="stringliteral">&quot;pairwise&quot;</span> : <span class="stringliteral">&quot;splitting&quot;</span>)</div><div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot; reduction)\n&quot;</span>);</div><div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;</div><div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;    <span class="keywordflow">return</span> VecReduxCost - ScalarReduxCost;</div><div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;  }</div><div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;</div><div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;  <span class="keyword">static</span> <a class="code" href="classllvm_1_1Value.html">Value</a> *createBinOp(<a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> &amp;Builder, <span class="keywordtype">unsigned</span> Opcode, <a class="code" href="classllvm_1_1Value.html">Value</a> *L,</div><div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;                            <a class="code" href="classllvm_1_1Value.html">Value</a> *R, <span class="keyword">const</span> <a class="code" href="classllvm_1_1Twine.html">Twine</a> &amp;<a class="code" href="namespacellvm_1_1GraphProgram.html#a0ad4685976f8c4d4a697a53fbe05d10b">Name</a> = <span class="stringliteral">&quot;&quot;</span>) {</div><div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;    <span class="keywordflow">if</span> (Opcode == Instruction::FAdd)</div><div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;      <span class="keywordflow">return</span> Builder.<a class="code" href="classllvm_1_1IRBuilder.html#a784fde3d9d71fd049f681eba20cc7e13">CreateFAdd</a>(L, R, <a class="code" href="namespacellvm_1_1GraphProgram.html#a0ad4685976f8c4d4a697a53fbe05d10b">Name</a>);</div><div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;    <span class="keywordflow">return</span> Builder.<a class="code" href="classllvm_1_1IRBuilder.html#a2bd8d3ea479e99434bac72362a59f078">CreateBinOp</a>((<a class="code" href="classllvm_1_1Instruction.html#ac26154a24f393f523c87cc5f8239f36c">Instruction::BinaryOps</a>)Opcode, L, R, <a class="code" href="namespacellvm_1_1GraphProgram.html#a0ad4685976f8c4d4a697a53fbe05d10b">Name</a>);</div><div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;  }</div><div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;<span class="comment">  /// \brief Emit a horizontal reduction of the vectorized value.</span></div><div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1Value.html">Value</a> *emitReduction(<a class="code" href="classllvm_1_1Value.html">Value</a> *VectorizedValue, <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> &amp;Builder) {</div><div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;    assert(VectorizedValue &amp;&amp; <span class="stringliteral">&quot;Need to have a vectorized tree node&quot;</span>);</div><div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *ValToReduce = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1Instruction.html">Instruction</a>&gt;(VectorizedValue);</div><div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;    assert(<a class="code" href="namespacellvm.html#af4d1a918800291e75b01ce1447be0e83">isPowerOf2_32</a>(ReduxWidth) &amp;&amp;</div><div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;           <span class="stringliteral">&quot;We only handle power-of-two reductions for now&quot;</span>);</div><div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;</div><div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *TmpVec = ValToReduce;</div><div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = ReduxWidth / 2; i != 0; i &gt;&gt;= 1) {</div><div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;      <span class="keywordflow">if</span> (IsPairwiseReduction) {</div><div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;        <a class="code" href="classllvm_1_1Value.html">Value</a> *LeftMask =</div><div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;          createRdxShuffleMask(ReduxWidth, i, <span class="keyword">true</span>, <span class="keyword">true</span>, Builder);</div><div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;        <a class="code" href="classllvm_1_1Value.html">Value</a> *RightMask =</div><div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;          createRdxShuffleMask(ReduxWidth, i, <span class="keyword">true</span>, <span class="keyword">false</span>, Builder);</div><div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;</div><div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;        <a class="code" href="classllvm_1_1Value.html">Value</a> *LeftShuf = Builder.<a class="code" href="classllvm_1_1IRBuilder.html#a20e69ff70507e1def78e42a44a532c87">CreateShuffleVector</a>(</div><div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;          TmpVec, <a class="code" href="classllvm_1_1UndefValue.html#a4ae5ff22b700a42bcc5d889233721335">UndefValue::get</a>(TmpVec-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>()), LeftMask, <span class="stringliteral">&quot;rdx.shuf.l&quot;</span>);</div><div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;        <a class="code" href="classllvm_1_1Value.html">Value</a> *RightShuf = Builder.<a class="code" href="classllvm_1_1IRBuilder.html#a20e69ff70507e1def78e42a44a532c87">CreateShuffleVector</a>(</div><div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;          TmpVec, <a class="code" href="classllvm_1_1UndefValue.html#a4ae5ff22b700a42bcc5d889233721335">UndefValue::get</a>(TmpVec-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>()), (RightMask),</div><div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;          <span class="stringliteral">&quot;rdx.shuf.r&quot;</span>);</div><div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;        TmpVec = createBinOp(Builder, ReductionOpcode, LeftShuf, RightShuf,</div><div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;                             <span class="stringliteral">&quot;bin.rdx&quot;</span>);</div><div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;        <a class="code" href="classllvm_1_1Value.html">Value</a> *UpperHalf =</div><div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;          createRdxShuffleMask(ReduxWidth, i, <span class="keyword">false</span>, <span class="keyword">false</span>, Builder);</div><div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;        <a class="code" href="classllvm_1_1Value.html">Value</a> *Shuf = Builder.<a class="code" href="classllvm_1_1IRBuilder.html#a20e69ff70507e1def78e42a44a532c87">CreateShuffleVector</a>(</div><div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;          TmpVec, <a class="code" href="classllvm_1_1UndefValue.html#a4ae5ff22b700a42bcc5d889233721335">UndefValue::get</a>(TmpVec-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>()), UpperHalf, <span class="stringliteral">&quot;rdx.shuf&quot;</span>);</div><div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;        TmpVec = createBinOp(Builder, ReductionOpcode, TmpVec, Shuf, <span class="stringliteral">&quot;bin.rdx&quot;</span>);</div><div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;      }</div><div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;    }</div><div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;</div><div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;    <span class="comment">// The result is in the first element of the vector.</span></div><div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;    <span class="keywordflow">return</span> Builder.<a class="code" href="classllvm_1_1IRBuilder.html#ad0affa936bea7c530da1597e9bb60bbd">CreateExtractElement</a>(TmpVec, Builder.<a class="code" href="classllvm_1_1IRBuilderBase.html#ac0e8c554bf1c1e117a74d51df89c137d">getInt32</a>(0));</div><div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;  }</div><div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;};</div><div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;<span class="comment">/// \brief Recognize construction of vectors like</span></div><div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;<span class="comment">///  %ra = insertelement &lt;4 x float&gt; undef, float %s0, i32 0</span></div><div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;<span class="comment">///  %rb = insertelement &lt;4 x float&gt; %ra, float %s1, i32 1</span></div><div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;<span class="comment">///  %rc = insertelement &lt;4 x float&gt; %rb, float %s2, i32 2</span></div><div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;<span class="comment">///  %rd = insertelement &lt;4 x float&gt; %rc, float %s3, i32 3</span></div><div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;<span class="comment">/// Returns true if it matches</span></div><div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">bool</span> findBuildVector(<a class="code" href="classllvm_1_1InsertElementInst.html">InsertElementInst</a> *<a class="code" href="namespacellvm_1_1ARM__PROC.html#a1add7850fad3f66c140ecee871460ea4ae9d798593a4a6b5cc48486a453a59e5e">IE</a>,</div><div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;                            <a class="code" href="classllvm_1_1SmallVectorImpl.html">SmallVectorImpl&lt;Value *&gt;</a> &amp;Ops) {</div><div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;  <span class="keywordflow">if</span> (!isa&lt;UndefValue&gt;(IE-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0)))</div><div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;</div><div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;  <span class="keywordflow">while</span> (<span class="keyword">true</span>) {</div><div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;    Ops.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(IE-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(1));</div><div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;</div><div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;    <span class="keywordflow">if</span> (IE-&gt;<a class="code" href="classllvm_1_1Value.html#ac38c53f76ef532f91f1666c8a87370e9">use_empty</a>())</div><div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;</div><div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;    <a class="code" href="classllvm_1_1InsertElementInst.html">InsertElementInst</a> *NextUse = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1InsertElementInst.html">InsertElementInst</a>&gt;(IE-&gt;<a class="code" href="classllvm_1_1Instruction.html#a5ac211f24970dea81fa9a7118a8ce36b">use_back</a>());</div><div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;    <span class="keywordflow">if</span> (!NextUse)</div><div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;</div><div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;    <span class="comment">// If this isn&#39;t the final use, make sure the next insertelement is the only</span></div><div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;    <span class="comment">// use. It&#39;s OK if the final constructed vector is used multiple times</span></div><div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;    <span class="keywordflow">if</span> (!IE-&gt;<a class="code" href="classllvm_1_1Value.html#a085b82f074c28030fb8e194377ed2d0c">hasOneUse</a>())</div><div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;</div><div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;    IE = NextUse;</div><div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;  }</div><div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;</div><div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;}</div><div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;</div><div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> PhiTypeSorterFunc(<a class="code" href="classllvm_1_1Value.html">Value</a> *V, <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1NVPTX_1_1PTXLdStInstCode.html#a91119cbee2be000c528a690252aee07ca24244a27b634ef3e256ab3c64c6fecd4">V2</a>) {</div><div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;  <span class="keywordflow">return</span> V-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>() &lt; V2-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>();</div><div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;}</div><div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;</div><div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;<span class="keywordtype">bool</span> SLPVectorizer::vectorizeChainsInBlock(<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *BB, BoUpSLP &amp;R) {</div><div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;  <span class="keywordtype">bool</span> Changed = <span class="keyword">false</span>;</div><div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Value *, 4&gt;</a> Incoming;</div><div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;  <a class="code" href="classllvm_1_1SmallSet.html">SmallSet&lt;Value *, 16&gt;</a> VisitedInstrs;</div><div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;</div><div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;  <span class="keywordtype">bool</span> HaveVectorizedPhiNodes = <span class="keyword">true</span>;</div><div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;  <span class="keywordflow">while</span> (HaveVectorizedPhiNodes) {</div><div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;    HaveVectorizedPhiNodes = <span class="keyword">false</span>;</div><div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;</div><div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;    <span class="comment">// Collect the incoming values from the PHIs.</span></div><div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;    Incoming.<a class="code" href="classllvm_1_1SmallVectorImpl.html#aac0ea55010b7b1a301e65a0baea057aa">clear</a>();</div><div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1ilist__iterator.html">BasicBlock::iterator</a> instr = BB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a0ed5f3ab3c2e4196ee0cffffa080c062">begin</a>(), ie = BB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a0b4e7bee9b8575cc7db73329f1a561bd">end</a>(); instr != ie;</div><div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;         ++instr) {</div><div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;      <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a> = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1PHINode.html">PHINode</a>&gt;(instr);</div><div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;      <span class="keywordflow">if</span> (!P)</div><div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;</div><div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;      <span class="keywordflow">if</span> (!VisitedInstrs.<a class="code" href="classllvm_1_1SmallSet.html#ab28aa342862f6d16361be514fd98c22e">count</a>(P))</div><div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;        Incoming.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(P);</div><div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;    }</div><div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;</div><div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;    <span class="comment">// Sort by type.</span></div><div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;    std::stable_sort(Incoming.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#a8a045d250952c0867382a9840ee18fdf">begin</a>(), Incoming.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#a075e34e98605d0e7c289763a104869ac">end</a>(), PhiTypeSorterFunc);</div><div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;</div><div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;    <span class="comment">// Try to vectorize elements base on their type.</span></div><div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Value *, 4&gt;::iterator</a> IncIt = Incoming.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#a8a045d250952c0867382a9840ee18fdf">begin</a>(),</div><div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;                                           E = Incoming.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#a075e34e98605d0e7c289763a104869ac">end</a>();</div><div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;         IncIt != E;) {</div><div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;</div><div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;      <span class="comment">// Look for the next elements with the same type.</span></div><div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;      <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Value *, 4&gt;::iterator</a> SameTypeIt = IncIt;</div><div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;      <span class="keywordflow">while</span> (SameTypeIt != E &amp;&amp;</div><div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;             (*SameTypeIt)-&gt;getType() == (*IncIt)-&gt;getType()) {</div><div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;        VisitedInstrs.<a class="code" href="classllvm_1_1SmallSet.html#a8d8348060ccdeeba13fb8bc651dfbf82">insert</a>(*SameTypeIt);</div><div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;        ++SameTypeIt;</div><div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;      }</div><div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;</div><div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;      <span class="comment">// Try to vectorize them.</span></div><div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;      <span class="keywordtype">unsigned</span> NumElts = (SameTypeIt - IncIt);</div><div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;      <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#ab8e34eca3b0817ef7a127913fbf6d9e4">errs</a>() &lt;&lt; <span class="stringliteral">&quot;SLP: Trying to vectorize starting at PHIs (&quot;</span> &lt;&lt; NumElts &lt;&lt; <span class="stringliteral">&quot;)\n&quot;</span>);</div><div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;      <span class="keywordflow">if</span> (NumElts &gt; 1 &amp;&amp;</div><div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;          tryToVectorizeList(<a class="code" href="classllvm_1_1ArrayRef.html">ArrayRef&lt;Value *&gt;</a>(IncIt, NumElts), R)) {</div><div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;        <span class="comment">// Success start over because instructions might have been changed.</span></div><div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;        HaveVectorizedPhiNodes = <span class="keyword">true</span>;</div><div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;        Changed = <span class="keyword">true</span>;</div><div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;      }</div><div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;</div><div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;      <span class="comment">// Start over at the next instruction of a differnt type (or the end).</span></div><div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;      IncIt = SameTypeIt;</div><div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;    }</div><div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;  }</div><div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;</div><div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;  VisitedInstrs.<a class="code" href="classllvm_1_1SmallSet.html#a76b3fc7c102561fb5210d5151531e409">clear</a>();</div><div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;</div><div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1ilist__iterator.html">BasicBlock::iterator</a> it = BB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a0ed5f3ab3c2e4196ee0cffffa080c062">begin</a>(), e = BB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a0b4e7bee9b8575cc7db73329f1a561bd">end</a>(); it != e; it++) {</div><div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;    <span class="comment">// We may go through BB multiple times so skip the one we have checked.</span></div><div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;    <span class="keywordflow">if</span> (!VisitedInstrs.<a class="code" href="classllvm_1_1SmallSet.html#a8d8348060ccdeeba13fb8bc651dfbf82">insert</a>(it))</div><div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;</div><div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;    <span class="keywordflow">if</span> (isa&lt;DbgInfoIntrinsic&gt;(it))</div><div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;</div><div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;    <span class="comment">// Try to vectorize reductions that use PHINodes.</span></div><div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *P = dyn_cast&lt;PHINode&gt;(it)) {</div><div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;      <span class="comment">// Check that the PHI is a reduction PHI.</span></div><div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;      <span class="keywordflow">if</span> (P-&gt;<a class="code" href="classllvm_1_1PHINode.html#aa45f6c0433576e3858a6209a43750ad4">getNumIncomingValues</a>() != 2)</div><div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;        <span class="keywordflow">return</span> Changed;</div><div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *Rdx =</div><div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;          (P-&gt;<a class="code" href="classllvm_1_1PHINode.html#a4c25b6c00c4867281779c81ab64d2081">getIncomingBlock</a>(0) == BB</div><div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;               ? (P-&gt;<a class="code" href="classllvm_1_1PHINode.html#aba6a4cc4ed6d6fef3664b8d65ef04820">getIncomingValue</a>(0))</div><div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;               : (P-&gt;<a class="code" href="classllvm_1_1PHINode.html#a4c25b6c00c4867281779c81ab64d2081">getIncomingBlock</a>(1) == BB ? P-&gt;<a class="code" href="classllvm_1_1PHINode.html#aba6a4cc4ed6d6fef3664b8d65ef04820">getIncomingValue</a>(1) : 0));</div><div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;      <span class="comment">// Check if this is a Binary Operator.</span></div><div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;      <a class="code" href="classllvm_1_1BinaryOperator.html">BinaryOperator</a> *BI = dyn_cast_or_null&lt;BinaryOperator&gt;(Rdx);</div><div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;      <span class="keywordflow">if</span> (!BI)</div><div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;</div><div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;      <span class="comment">// Try to match and vectorize a horizontal reduction.</span></div><div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;      HorizontalReduction HorRdx;</div><div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="SLPVectorizer_8cpp.html#a4dc630bcb416d59c7a164a214cbf9872">ShouldVectorizeHor</a> &amp;&amp;</div><div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;          HorRdx.matchAssociativeReduction(P, BI, DL) &amp;&amp;</div><div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;          HorRdx.tryToReduce(R, TTI)) {</div><div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;        Changed = <span class="keyword">true</span>;</div><div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;        it = BB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a0ed5f3ab3c2e4196ee0cffffa080c062">begin</a>();</div><div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;        e = BB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a0b4e7bee9b8575cc7db73329f1a561bd">end</a>();</div><div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;      }</div><div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;</div><div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;     <a class="code" href="classllvm_1_1Value.html">Value</a> *Inst = BI-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0);</div><div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;      <span class="keywordflow">if</span> (Inst == P)</div><div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;        Inst = BI-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(1);</div><div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;</div><div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;      <span class="keywordflow">if</span> (tryToVectorize(dyn_cast&lt;BinaryOperator&gt;(Inst), R)) {</div><div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;        <span class="comment">// We would like to start over since some instructions are deleted</span></div><div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;        <span class="comment">// and the iterator may become invalid value.</span></div><div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;        Changed = <span class="keyword">true</span>;</div><div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;        it = BB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a0ed5f3ab3c2e4196ee0cffffa080c062">begin</a>();</div><div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;        e = BB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a0b4e7bee9b8575cc7db73329f1a561bd">end</a>();</div><div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;      }</div><div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;</div><div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;    }</div><div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;</div><div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;    <span class="comment">// Try to vectorize horizontal reductions feeding into a store.</span></div><div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="SLPVectorizer_8cpp.html#a261a64ee0c17cb0a8b61985e1836a32c">ShouldStartVectorizeHorAtStore</a>)</div><div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1StoreInst.html">StoreInst</a> *SI = dyn_cast&lt;StoreInst&gt;(it))</div><div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1BinaryOperator.html">BinaryOperator</a> *BinOp =</div><div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;                dyn_cast&lt;BinaryOperator&gt;(SI-&gt;<a class="code" href="classllvm_1_1StoreInst.html#a14298313bdf734e2db5a921cc6e861a0">getValueOperand</a>())) {</div><div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;          HorizontalReduction HorRdx;</div><div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;          <span class="keywordflow">if</span> (((HorRdx.matchAssociativeReduction(0, BinOp, DL) &amp;&amp;</div><div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;                HorRdx.tryToReduce(R, TTI)) ||</div><div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;               tryToVectorize(BinOp, R))) {</div><div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;            Changed = <span class="keyword">true</span>;</div><div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;            it = BB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a0ed5f3ab3c2e4196ee0cffffa080c062">begin</a>();</div><div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;            e = BB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a0b4e7bee9b8575cc7db73329f1a561bd">end</a>();</div><div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;          }</div><div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;        }</div><div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;</div><div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;    <span class="comment">// Try to vectorize trees that start at compare instructions.</span></div><div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1CmpInst.html">CmpInst</a> *CI = dyn_cast&lt;CmpInst&gt;(it)) {</div><div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;      <span class="keywordflow">if</span> (tryToVectorizePair(CI-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0), CI-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(1), R)) {</div><div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;        Changed = <span class="keyword">true</span>;</div><div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;        <span class="comment">// We would like to start over since some instructions are deleted</span></div><div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;        <span class="comment">// and the iterator may become invalid value.</span></div><div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;        it = BB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a0ed5f3ab3c2e4196ee0cffffa080c062">begin</a>();</div><div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;        e = BB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a0b4e7bee9b8575cc7db73329f1a561bd">end</a>();</div><div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;      }</div><div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;</div><div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 2; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1BinaryOperator.html">BinaryOperator</a> *BI = dyn_cast&lt;BinaryOperator&gt;(CI-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(i))) {</div><div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;            <span class="keywordflow">if</span> (tryToVectorizePair(BI-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0), BI-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(1), R)) {</div><div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;              Changed = <span class="keyword">true</span>;</div><div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;              <span class="comment">// We would like to start over since some instructions are deleted</span></div><div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;              <span class="comment">// and the iterator may become invalid value.</span></div><div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;              it = BB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a0ed5f3ab3c2e4196ee0cffffa080c062">begin</a>();</div><div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;              e = BB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a0b4e7bee9b8575cc7db73329f1a561bd">end</a>();</div><div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;            }</div><div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;         }</div><div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;      }</div><div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;    }</div><div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;</div><div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;    <span class="comment">// Try to vectorize trees that start at insertelement instructions.</span></div><div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1InsertElementInst.html">InsertElementInst</a> *IE = dyn_cast&lt;InsertElementInst&gt;(it)) {</div><div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;      <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Value *, 8&gt;</a> Ops;</div><div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;      <span class="keywordflow">if</span> (!findBuildVector(IE, Ops))</div><div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;</div><div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;      <span class="keywordflow">if</span> (tryToVectorizeList(Ops, R)) {</div><div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;        Changed = <span class="keyword">true</span>;</div><div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;        it = BB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a0ed5f3ab3c2e4196ee0cffffa080c062">begin</a>();</div><div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;        e = BB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a0b4e7bee9b8575cc7db73329f1a561bd">end</a>();</div><div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;      }</div><div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;</div><div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;    }</div><div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;  }</div><div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;</div><div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;  <span class="keywordflow">return</span> Changed;</div><div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;}</div><div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;</div><div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;<span class="keywordtype">bool</span> SLPVectorizer::vectorizeStoreChains(BoUpSLP &amp;R) {</div><div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;  <span class="keywordtype">bool</span> Changed = <span class="keyword">false</span>;</div><div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;  <span class="comment">// Attempt to sort and vectorize each of the store-groups.</span></div><div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;  <span class="keywordflow">for</span> (StoreListMap::iterator it = StoreRefs.begin(), e = StoreRefs.end();</div><div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;       it != e; ++<a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a>) {</div><div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;    <span class="keywordflow">if</span> (it-&gt;second.size() &lt; 2)</div><div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160;</div><div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;    <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;SLP: Analyzing a store chain of length &quot;</span></div><div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160;          &lt;&lt; it-&gt;second.size() &lt;&lt; <span class="stringliteral">&quot;.\n&quot;</span>);</div><div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160;</div><div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;    <span class="comment">// Process the stores in chunks of 16.</span></div><div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> CI = 0, CE = it-&gt;second.size(); CI &lt; CE; CI+=16) {</div><div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;      <span class="keywordtype">unsigned</span> Len = std::min&lt;unsigned&gt;(CE - CI, 16);</div><div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;      <a class="code" href="classllvm_1_1ArrayRef.html">ArrayRef&lt;StoreInst *&gt;</a> Chunk(&amp;it-&gt;second[CI], Len);</div><div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;      Changed |= vectorizeStores(Chunk, -<a class="code" href="SLPVectorizer_8cpp.html#a6f911c7c687cf91f4f1c42b45d501448">SLPCostThreshold</a>, R);</div><div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;    }</div><div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;  }</div><div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;  <span class="keywordflow">return</span> Changed;</div><div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;}</div><div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;</div><div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;} <span class="comment">// end anonymous namespace</span></div><div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;</div><div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;<span class="keywordtype">char</span> <a class="code" href="namespacellvm_1_1CallingConv.html#a4f861731fc6dbfdccc05af5968d98974">SLPVectorizer::ID</a> = 0;</div><div class="line"><a name="l02655"></a><span class="lineno"><a class="line" href="SLPVectorizer_8cpp.html#a5ce679c74f9d5aa21d8ea3d1a798f0a9"> 2655</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="SLPVectorizer_8cpp.html#a5ce679c74f9d5aa21d8ea3d1a798f0a9">lv_name</a>[] = <span class="stringliteral">&quot;SLP Vectorizer&quot;</span>;</div><div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;<a class="code" href="PassSupport_8h.html#aaa970fc931c1c63037a8182e028d04b1">INITIALIZE_PASS_BEGIN</a>(SLPVectorizer, <a class="code" href="SLPVectorizer_8cpp.html#a274654b7f5932cae6a71a113322481be">SV_NAME</a>, lv_name, <span class="keyword">false</span>, <span class="keyword">false</span>)</div><div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;<a class="code" href="PassSupport_8h.html#af0564bcdde2dd4400c670ca278c6035f">INITIALIZE_AG_DEPENDENCY</a>(<a class="code" href="classllvm_1_1AliasAnalysis.html">AliasAnalysis</a>)</div><div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;<a class="code" href="PassSupport_8h.html#af0564bcdde2dd4400c670ca278c6035f">INITIALIZE_AG_DEPENDENCY</a>(<a class="code" href="classllvm_1_1TargetTransformInfo.html">TargetTransformInfo</a>)</div><div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;<a class="code" href="PassSupport_8h.html#a14724f1ccf528e73bb29bc9230737967">INITIALIZE_PASS_DEPENDENCY</a>(<a class="code" href="classllvm_1_1ScalarEvolution.html">ScalarEvolution</a>)</div><div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;<a class="code" href="PassSupport_8h.html#a14724f1ccf528e73bb29bc9230737967">INITIALIZE_PASS_DEPENDENCY</a>(LoopSimplify)</div><div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;<a class="code" href="PassSupport_8h.html#a74ce8276b89067e806f67c45a6d92575">INITIALIZE_PASS_END</a>(SLPVectorizer, <a class="code" href="SLPVectorizer_8cpp.html#a274654b7f5932cae6a71a113322481be">SV_NAME</a>, lv_name, <a class="code" href="namespacefalse.html">false</a>, false)</div><div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;</div><div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;namespace <a class="code" href="namespacellvm.html">llvm</a> {</div><div class="line"><a name="l02664"></a><span class="lineno"><a class="line" href="namespacellvm.html#a6a84483f8f0bece492d8083c524db5c0"> 2664</a></span>&#160;<a class="code" href="classllvm_1_1Pass.html">Pass</a> *<a class="code" href="namespacellvm.html#a6a84483f8f0bece492d8083c524db5c0">createSLPVectorizerPass</a>() { <span class="keywordflow">return</span> <span class="keyword">new</span> SLPVectorizer(); }</div><div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;}</div><div class="ttc" id="classllvm_1_1Pass_html"><div class="ttname"><a href="classllvm_1_1Pass.html">llvm::Pass</a></div><div class="ttdef"><b>Definition:</b> <a href="Pass_8h_source.html#l00082">Pass.h:82</a></div></div>
<div class="ttc" id="classllvm_1_1SmallVectorTemplateCommon_html_a075e34e98605d0e7c289763a104869ac"><div class="ttname"><a href="classllvm_1_1SmallVectorTemplateCommon.html#a075e34e98605d0e7c289763a104869ac">llvm::SmallVectorTemplateCommon&lt; T &gt;::end</a></div><div class="ttdeci">iterator end()</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00114">SmallVector.h:114</a></div></div>
<div class="ttc" id="classllvm_1_1SmallVectorTemplateCommon_html_a22a311dfe4c28a897de8a9365a4f0a84"><div class="ttname"><a href="classllvm_1_1SmallVectorTemplateCommon.html#a22a311dfe4c28a897de8a9365a4f0a84">llvm::SmallVectorTemplateCommon&lt; T &gt;::size</a></div><div class="ttdeci">size_type size() const</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00127">SmallVector.h:127</a></div></div>
<div class="ttc" id="classllvm_1_1StoreInst_html_a14298313bdf734e2db5a921cc6e861a0"><div class="ttname"><a href="classllvm_1_1StoreInst.html#a14298313bdf734e2db5a921cc6e861a0">llvm::StoreInst::getValueOperand</a></div><div class="ttdeci">Value * getValueOperand()</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00343">Instructions.h:343</a></div></div>
<div class="ttc" id="MapVector_8h_html"><div class="ttname"><a href="MapVector_8h.html">MapVector.h</a></div></div>
<div class="ttc" id="classllvm_1_1SmallVectorTemplateBase_html_ae1a10b90f22c0478960fb5798ff73916"><div class="ttname"><a href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">llvm::SmallVectorTemplateBase&lt; T, isPodLike&lt; T &gt;::value &gt;::push_back</a></div><div class="ttdeci">void push_back(const T &amp;Elt)</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00236">SmallVector.h:236</a></div></div>
<div class="ttc" id="classllvm_1_1Value_html_ad86469939d2a8bdd4169be9403b89f5a"><div class="ttname"><a href="classllvm_1_1Value.html#ad86469939d2a8bdd4169be9403b89f5a">llvm::Value::use_end</a></div><div class="ttdeci">use_iterator use_end()</div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00152">Value.h:152</a></div></div>
<div class="ttc" id="classllvm_1_1DataLayout_html"><div class="ttname"><a href="classllvm_1_1DataLayout.html">llvm::DataLayout</a></div><div class="ttdef"><b>Definition:</b> <a href="DataLayout_8h_source.html#l00098">DataLayout.h:98</a></div></div>
<div class="ttc" id="classllvm_1_1CastInst_html_adc3489e61d5f37a0e4c5589859fbccc2"><div class="ttname"><a href="classllvm_1_1CastInst.html#adc3489e61d5f37a0e4c5589859fbccc2">llvm::CastInst::getOpcode</a></div><div class="ttdeci">Instruction::CastOps getOpcode() const </div><div class="ttdoc">Return the opcode of this CastInst. </div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00603">InstrTypes.h:603</a></div></div>
<div class="ttc" id="classllvm_1_1SmallDenseMap_html"><div class="ttname"><a href="classllvm_1_1SmallDenseMap.html">llvm::SmallDenseMap</a></div><div class="ttdef"><b>Definition:</b> <a href="DenseMap_8h_source.html#l00690">DenseMap.h:690</a></div></div>
<div class="ttc" id="classllvm_1_1CmpInst_html"><div class="ttname"><a href="classllvm_1_1CmpInst.html">llvm::CmpInst</a></div><div class="ttdoc">Abstract base class of comparison instructions. </div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00633">InstrTypes.h:633</a></div></div>
<div class="ttc" id="namespacellvm_1_1ARM__PROC_html_aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5"><div class="ttname"><a href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">llvm::ARM_PROC::A</a></div><div class="ttdef"><b>Definition:</b> <a href="ARMBaseInfo_8h_source.html#l00098">ARMBaseInfo.h:98</a></div></div>
<div class="ttc" id="namespacellvm_1_1tgtok_html_abbc5259d649363016626e2529fabe0c5a5fa7b4069ef3bd1ceb9f2caa315cf5ac"><div class="ttname"><a href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5a5fa7b4069ef3bd1ceb9f2caa315cf5ac">llvm::tgtok::In</a></div><div class="ttdef"><b>Definition:</b> <a href="TGLexer_8h_source.html#l00046">TGLexer.h:46</a></div></div>
<div class="ttc" id="classllvm_1_1AnalysisUsage_html_a884f90190bca4bd354f2d5c91c264028"><div class="ttname"><a href="classllvm_1_1AnalysisUsage.html#a884f90190bca4bd354f2d5c91c264028">llvm::AnalysisUsage::addPreserved</a></div><div class="ttdeci">AnalysisUsage &amp; addPreserved()</div><div class="ttdef"><b>Definition:</b> <a href="PassAnalysisSupport_8h_source.html#l00081">PassAnalysisSupport.h:81</a></div></div>
<div class="ttc" id="namespacellvm_html_ab8e34eca3b0817ef7a127913fbf6d9e4"><div class="ttname"><a href="namespacellvm.html#ab8e34eca3b0817ef7a127913fbf6d9e4">llvm::errs</a></div><div class="ttdeci">raw_ostream &amp; errs()</div><div class="ttdef"><b>Definition:</b> <a href="raw__ostream_8cpp_source.html#l00664">raw_ostream.cpp:664</a></div></div>
<div class="ttc" id="classllvm_1_1Type_html_aa75984a442f2379de0c66018201fa628"><div class="ttname"><a href="classllvm_1_1Type.html#aa75984a442f2379de0c66018201fa628">llvm::Type::getInt1Ty</a></div><div class="ttdeci">static IntegerType * getInt1Ty(LLVMContext &amp;C)</div><div class="ttdef"><b>Definition:</b> <a href="Type_8cpp_source.html#l00238">Type.cpp:238</a></div></div>
<div class="ttc" id="namespacellvm_1_1A64CC_html_af5804bc0518be9568f73db566e4d6f46a98d7f1cf15bd78fd7c7c68e6543a9588"><div class="ttname"><a href="namespacellvm_1_1A64CC.html#af5804bc0518be9568f73db566e4d6f46a98d7f1cf15bd78fd7c7c68e6543a9588">llvm::A64CC::LE</a></div><div class="ttdef"><b>Definition:</b> <a href="AArch64BaseInfo_8h_source.html#l00044">AArch64BaseInfo.h:44</a></div></div>
<div class="ttc" id="classllvm_1_1IRBuilder_html_a784fde3d9d71fd049f681eba20cc7e13"><div class="ttname"><a href="classllvm_1_1IRBuilder.html#a784fde3d9d71fd049f681eba20cc7e13">llvm::IRBuilder::CreateFAdd</a></div><div class="ttdeci">Value * CreateFAdd(Value *LHS, Value *RHS, const Twine &amp;Name=&quot;&quot;, MDNode *FPMathTag=0)</div><div class="ttdef"><b>Definition:</b> <a href="IRBuilder_8h_source.html#l00629">IRBuilder.h:629</a></div></div>
<div class="ttc" id="classllvm_1_1PHINode_html_a089cccb6f231efee72abc76d0f9c695f"><div class="ttname"><a href="classllvm_1_1PHINode.html#a089cccb6f231efee72abc76d0f9c695f">llvm::PHINode::addIncoming</a></div><div class="ttdeci">void addIncoming(Value *V, BasicBlock *BB)</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02100">Instructions.h:2100</a></div></div>
<div class="ttc" id="classllvm_1_1PassRegistry_html_a05a729900b76c89e808c6c3094921b2f"><div class="ttname"><a href="classllvm_1_1PassRegistry.html#a05a729900b76c89e808c6c3094921b2f">llvm::PassRegistry::getPassRegistry</a></div><div class="ttdeci">static PassRegistry * getPassRegistry()</div><div class="ttdef"><b>Definition:</b> <a href="PassRegistry_8cpp_source.html#l00035">PassRegistry.cpp:35</a></div></div>
<div class="ttc" id="namespacellvm_1_1SPII_html_a11e9b8fca4a074643a6a21f444e51406a5069619ca8fdce305534f3fe85091a0f"><div class="ttname"><a href="namespacellvm_1_1SPII.html#a11e9b8fca4a074643a6a21f444e51406a5069619ca8fdce305534f3fe85091a0f">llvm::SPII::Load</a></div><div class="ttdef"><b>Definition:</b> <a href="SparcInstrInfo_8h_source.html#l00031">SparcInstrInfo.h:31</a></div></div>
<div class="ttc" id="classllvm_1_1Instruction_html_a6fe2f06b8a4b2c3d6308afb223a0238a"><div class="ttname"><a href="classllvm_1_1Instruction.html#a6fe2f06b8a4b2c3d6308afb223a0238a">llvm::Instruction::eraseFromParent</a></div><div class="ttdeci">void eraseFromParent()</div><div class="ttdef"><b>Definition:</b> <a href="Instruction_8cpp_source.html#l00072">Instruction.cpp:72</a></div></div>
<div class="ttc" id="classllvm_1_1IRBuilderBase_html_a571ae7ebae7038da7f6073efc65aaa50"><div class="ttname"><a href="classllvm_1_1IRBuilderBase.html#a571ae7ebae7038da7f6073efc65aaa50">llvm::IRBuilderBase::SetCurrentDebugLocation</a></div><div class="ttdeci">void SetCurrentDebugLocation(const DebugLoc &amp;L)</div><div class="ttdoc">Set location information used by debugging information. </div><div class="ttdef"><b>Definition:</b> <a href="IRBuilder_8h_source.html#l00118">IRBuilder.h:118</a></div></div>
<div class="ttc" id="Instructions_8h_html"><div class="ttname"><a href="Instructions_8h.html">Instructions.h</a></div></div>
<div class="ttc" id="classllvm_1_1TargetTransformInfo_html_afa38851d75434d1476444ac93f94cb4ca9c0eecea29e9fa58e4dac7ee32b9b2ac"><div class="ttname"><a href="classllvm_1_1TargetTransformInfo.html#afa38851d75434d1476444ac93f94cb4ca9c0eecea29e9fa58e4dac7ee32b9b2ac">llvm::TargetTransformInfo::OK_AnyValue</a></div><div class="ttdef"><b>Definition:</b> <a href="TargetTransformInfo_8h_source.html#l00319">TargetTransformInfo.h:319</a></div></div>
<div class="ttc" id="namespacellvm_html"><div class="ttname"><a href="namespacellvm.html">llvm</a></div><div class="ttdoc">List of target independent CodeGen pass IDs. </div><div class="ttdef"><b>Definition:</b> <a href="APFloat_8h_source.html#l00022">APFloat.h:22</a></div></div>
<div class="ttc" id="Type_8h_html"><div class="ttname"><a href="Type_8h.html">Type.h</a></div></div>
<div class="ttc" id="IntrinsicInst_8h_html"><div class="ttname"><a href="IntrinsicInst_8h.html">IntrinsicInst.h</a></div></div>
<div class="ttc" id="namespacellvm_html_a3f2f98c2a67c9e79f58aad9150a62e42"><div class="ttname"><a href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">llvm::dyn_cast</a></div><div class="ttdeci">enable_if_c&lt;!is_simple_type&lt; Y &gt;::value, typename cast_retty&lt; X, const Y &gt;::ret_type &gt;::type dyn_cast(const Y &amp;Val)</div><div class="ttdef"><b>Definition:</b> <a href="Casting_8h_source.html#l00266">Casting.h:266</a></div></div>
<div class="ttc" id="classllvm_1_1User_html_a2f81e0c1fc6554df7ad2eafabf5fc5a5"><div class="ttname"><a href="classllvm_1_1User.html#a2f81e0c1fc6554df7ad2eafabf5fc5a5">llvm::User::getNumOperands</a></div><div class="ttdeci">unsigned getNumOperands() const </div><div class="ttdef"><b>Definition:</b> <a href="User_8h_source.html#l00108">User.h:108</a></div></div>
<div class="ttc" id="namespacellvm_1_1NVPTX_1_1PTXLdStInstCode_html_a91119cbee2be000c528a690252aee07ca24244a27b634ef3e256ab3c64c6fecd4"><div class="ttname"><a href="namespacellvm_1_1NVPTX_1_1PTXLdStInstCode.html#a91119cbee2be000c528a690252aee07ca24244a27b634ef3e256ab3c64c6fecd4">llvm::NVPTX::PTXLdStInstCode::V2</a></div><div class="ttdef"><b>Definition:</b> <a href="NVPTX_8h_source.html#l00127">NVPTX.h:127</a></div></div>
<div class="ttc" id="DataLayout_8h_html"><div class="ttname"><a href="DataLayout_8h.html">DataLayout.h</a></div></div>
<div class="ttc" id="classllvm_1_1ScalarEvolution_html"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html">llvm::ScalarEvolution</a></div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8h_source.html#l00172">ScalarEvolution.h:172</a></div></div>
<div class="ttc" id="classllvm_1_1DenseMap_html"><div class="ttname"><a href="classllvm_1_1DenseMap.html">llvm::DenseMap</a></div><div class="ttdef"><b>Definition:</b> <a href="DenseMap_8h_source.html#l00534">DenseMap.h:534</a></div></div>
<div class="ttc" id="classllvm_1_1ArrayRef_html_a38ed8cc3c342ad6910e8c869d3e2b9cf"><div class="ttname"><a href="classllvm_1_1ArrayRef.html#a38ed8cc3c342ad6910e8c869d3e2b9cf">llvm::ArrayRef::end</a></div><div class="ttdeci">iterator end() const </div><div class="ttdef"><b>Definition:</b> <a href="ArrayRef_8h_source.html#l00098">ArrayRef.h:98</a></div></div>
<div class="ttc" id="classllvm_1_1StoreInst_html_a1149c7eeefca671ac2685bca13843568"><div class="ttname"><a href="classllvm_1_1StoreInst.html#a1149c7eeefca671ac2685bca13843568">llvm::StoreInst::isSimple</a></div><div class="ttdeci">bool isSimple() const </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00338">Instructions.h:338</a></div></div>
<div class="ttc" id="README-SSE_8txt_html_a63d206a063eefcdf8c318ded97b65020"><div class="ttname"><a href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a></div><div class="ttdeci">This currently compiles esp xmm0 movsd esp eax eax esp ret We should use not the dag combiner This is because dagcombine2 needs to be able to see through the X86ISD::Wrapper which DAGCombine can t really do The code for turning x load into a single vector load is target independent and should be moved to the dag combiner The code for turning x load into a vector load can only handle a direct load from a global or a direct load from the stack It should be generalized to handle any load from P</div><div class="ttdef"><b>Definition:</b> <a href="README-SSE_8txt_source.html#l00427">README-SSE.txt:427</a></div></div>
<div class="ttc" id="classllvm_1_1Pass_html_a048082a5be9ae0d8901ea64de59e5c8f"><div class="ttname"><a href="classllvm_1_1Pass.html#a048082a5be9ae0d8901ea64de59e5c8f">llvm::Pass::getAnalysisUsage</a></div><div class="ttdeci">virtual void getAnalysisUsage(AnalysisUsage &amp;) const </div><div class="ttdef"><b>Definition:</b> <a href="Pass_8cpp_source.html#l00075">Pass.cpp:75</a></div></div>
<div class="ttc" id="classllvm_1_1PHINode_html"><div class="ttname"><a href="classllvm_1_1PHINode.html">llvm::PHINode</a></div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l01978">Instructions.h:1978</a></div></div>
<div class="ttc" id="Debug_8h_html"><div class="ttname"><a href="Debug_8h.html">Debug.h</a></div></div>
<div class="ttc" id="Target_2README_8txt_html_a3a76669632041022e6976766a22bd2b0"><div class="ttname"><a href="Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a></div><div class="ttdeci">return j(j&lt;&lt; 16)</div></div>
<div class="ttc" id="classllvm_1_1po__iterator_html"><div class="ttname"><a href="classllvm_1_1po__iterator.html">llvm::po_iterator</a></div><div class="ttdef"><b>Definition:</b> <a href="PostOrderIterator_8h_source.html#l00091">PostOrderIterator.h:91</a></div></div>
<div class="ttc" id="classllvm_1_1SmallPtrSet_html_a9b6dd0fc7a648a939e571246045b673e"><div class="ttname"><a href="classllvm_1_1SmallPtrSet.html#a9b6dd0fc7a648a939e571246045b673e">llvm::SmallPtrSet::insert</a></div><div class="ttdeci">bool insert(PtrType Ptr)</div><div class="ttdef"><b>Definition:</b> <a href="SmallPtrSet_8h_source.html#l00253">SmallPtrSet.h:253</a></div></div>
<div class="ttc" id="classllvm_1_1DominatorTree_html_aa094180f7ac0ef9d4b8e1c78f850edd8"><div class="ttname"><a href="classllvm_1_1DominatorTree.html#aa094180f7ac0ef9d4b8e1c78f850edd8">llvm::DominatorTree::properlyDominates</a></div><div class="ttdeci">bool properlyDominates(const DomTreeNode *A, const DomTreeNode *B) const </div><div class="ttdef"><b>Definition:</b> <a href="Dominators_8h_source.html#l00818">Dominators.h:818</a></div></div>
<div class="ttc" id="SLPVectorizer_8cpp_html_a6f911c7c687cf91f4f1c42b45d501448"><div class="ttname"><a href="SLPVectorizer_8cpp.html#a6f911c7c687cf91f4f1c42b45d501448">SLPCostThreshold</a></div><div class="ttdeci">static cl::opt&lt; int &gt; SLPCostThreshold(&quot;slp-threshold&quot;, cl::init(0), cl::Hidden, cl::desc(&quot;Only vectorize if you gain more than this &quot;&quot;number &quot;))</div></div>
<div class="ttc" id="namespacellvm_1_1NVPTX_1_1PTXLdStInstCode_html_a91119cbee2be000c528a690252aee07ca09c68d67f7dbfa6cc77eaf73aa535217"><div class="ttname"><a href="namespacellvm_1_1NVPTX_1_1PTXLdStInstCode.html#a91119cbee2be000c528a690252aee07ca09c68d67f7dbfa6cc77eaf73aa535217">llvm::NVPTX::PTXLdStInstCode::Scalar</a></div><div class="ttdef"><b>Definition:</b> <a href="NVPTX_8h_source.html#l00126">NVPTX.h:126</a></div></div>
<div class="ttc" id="classllvm_1_1MapVector_html"><div class="ttname"><a href="classllvm_1_1MapVector.html">llvm::MapVector</a></div><div class="ttdef"><b>Definition:</b> <a href="MapVector_8h_source.html#l00033">MapVector.h:33</a></div></div>
<div class="ttc" id="Transforms_2Vectorize_8h_html"><div class="ttname"><a href="Transforms_2Vectorize_8h.html">Vectorize.h</a></div></div>
<div class="ttc" id="classllvm_1_1DebugLoc_html"><div class="ttname"><a href="classllvm_1_1DebugLoc.html">llvm::DebugLoc</a></div><div class="ttdef"><b>Definition:</b> <a href="DebugLoc_8h_source.html#l00028">DebugLoc.h:28</a></div></div>
<div class="ttc" id="classllvm_1_1MDNode_html"><div class="ttname"><a href="classllvm_1_1MDNode.html">llvm::MDNode</a></div><div class="ttdoc">MDNode - a tuple of other values. </div><div class="ttdef"><b>Definition:</b> <a href="Metadata_8h_source.html#l00073">Metadata.h:73</a></div></div>
<div class="ttc" id="LLParser_8cpp_html_a33ece1ef8074506a15d7f86eb76dbae6"><div class="ttname"><a href="LLParser_8cpp.html#a33ece1ef8074506a15d7f86eb76dbae6">F</a></div><div class="ttdeci">F(f)</div></div>
<div class="ttc" id="classllvm_1_1Function_html"><div class="ttname"><a href="classllvm_1_1Function.html">llvm::Function</a></div><div class="ttdef"><b>Definition:</b> <a href="Function_8h_source.html#l00070">Function.h:70</a></div></div>
<div class="ttc" id="classllvm_1_1LoadInst_html"><div class="ttname"><a href="classllvm_1_1LoadInst.html">llvm::LoadInst</a></div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00136">Instructions.h:136</a></div></div>
<div class="ttc" id="namespacellvm_1_1Intrinsic_html_ac015f68d60ea67a2e31bc10bc720d3e8"><div class="ttname"><a href="namespacellvm_1_1Intrinsic.html#ac015f68d60ea67a2e31bc10bc720d3e8">llvm::Intrinsic::getType</a></div><div class="ttdeci">FunctionType * getType(LLVMContext &amp;Context, ID id, ArrayRef&lt; Type * &gt; Tys=None)</div><div class="ttdef"><b>Definition:</b> <a href="Function_8cpp_source.html#l00657">Function.cpp:657</a></div></div>
<div class="ttc" id="classllvm_1_1User_html"><div class="ttname"><a href="classllvm_1_1User.html">llvm::User</a></div><div class="ttdef"><b>Definition:</b> <a href="User_8h_source.html#l00033">User.h:33</a></div></div>
<div class="ttc" id="classllvm_1_1IRBuilder_html_a20e69ff70507e1def78e42a44a532c87"><div class="ttname"><a href="classllvm_1_1IRBuilder.html#a20e69ff70507e1def78e42a44a532c87">llvm::IRBuilder::CreateShuffleVector</a></div><div class="ttdeci">Value * CreateShuffleVector(Value *V1, Value *V2, Value *Mask, const Twine &amp;Name=&quot;&quot;)</div><div class="ttdef"><b>Definition:</b> <a href="IRBuilder_8h_source.html#l01366">IRBuilder.h:1366</a></div></div>
<div class="ttc" id="classllvm_1_1LoadInst_html_a156c478ee8e7d1602143cdbad4bd5385"><div class="ttname"><a href="classllvm_1_1LoadInst.html#a156c478ee8e7d1602143cdbad4bd5385">llvm::LoadInst::isSimple</a></div><div class="ttdeci">bool isSimple() const </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00218">Instructions.h:218</a></div></div>
<div class="ttc" id="classllvm_1_1SetVector_html_affac0dc3d407ef3dee29b8bc9a4836bc"><div class="ttname"><a href="classllvm_1_1SetVector.html#affac0dc3d407ef3dee29b8bc9a4836bc">llvm::SetVector::end</a></div><div class="ttdeci">iterator end()</div><div class="ttdoc">Get an iterator to the end of the SetVector. </div><div class="ttdef"><b>Definition:</b> <a href="SetVector_8h_source.html#l00079">SetVector.h:79</a></div></div>
<div class="ttc" id="classllvm_1_1User_html_a2eeb1c7ed1cfe403f2ae0470e36c07e2"><div class="ttname"><a href="classllvm_1_1User.html#a2eeb1c7ed1cfe403f2ae0470e36c07e2">llvm::User::op_begin</a></div><div class="ttdeci">op_iterator op_begin()</div><div class="ttdef"><b>Definition:</b> <a href="User_8h_source.html#l00116">User.h:116</a></div></div>
<div class="ttc" id="namespacellvm_1_1ARM__PROC_html_a1add7850fad3f66c140ecee871460ea4ae9d798593a4a6b5cc48486a453a59e5e"><div class="ttname"><a href="namespacellvm_1_1ARM__PROC.html#a1add7850fad3f66c140ecee871460ea4ae9d798593a4a6b5cc48486a453a59e5e">llvm::ARM_PROC::IE</a></div><div class="ttdef"><b>Definition:</b> <a href="ARMBaseInfo_8h_source.html#l00091">ARMBaseInfo.h:91</a></div></div>
<div class="ttc" id="namespacellvm_1_1cl_html_a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6"><div class="ttname"><a href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">llvm::cl::Hidden</a></div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l00109">CommandLine.h:109</a></div></div>
<div class="ttc" id="classllvm_1_1Value_html_ad452febc1ac0b394876e640ec03ffa38"><div class="ttname"><a href="classllvm_1_1Value.html#ad452febc1ac0b394876e640ec03ffa38">llvm::Value::getName</a></div><div class="ttdeci">StringRef getName() const </div><div class="ttdef"><b>Definition:</b> <a href="Value_8cpp_source.html#l00167">Value.cpp:167</a></div></div>
<div class="ttc" id="classllvm_1_1Instruction_html_afdbf7fbdf8b6e61904c6f718436b1f7b"><div class="ttname"><a href="classllvm_1_1Instruction.html#afdbf7fbdf8b6e61904c6f718436b1f7b">llvm::Instruction::getAllMetadataOtherThanDebugLoc</a></div><div class="ttdeci">void getAllMetadataOtherThanDebugLoc(SmallVectorImpl&lt; std::pair&lt; unsigned, MDNode * &gt; &gt; &amp;MDs) const </div><div class="ttdef"><b>Definition:</b> <a href="Instruction_8h_source.html#l00162">Instruction.h:162</a></div></div>
<div class="ttc" id="classllvm_1_1BasicBlock_html_a0ed5f3ab3c2e4196ee0cffffa080c062"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a0ed5f3ab3c2e4196ee0cffffa080c062">llvm::BasicBlock::begin</a></div><div class="ttdeci">iterator begin()</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00193">BasicBlock.h:193</a></div></div>
<div class="ttc" id="classllvm_1_1IRBuilderBase_html_a6ee1d1e7a13072ef579558d64b208d3c"><div class="ttname"><a href="classllvm_1_1IRBuilderBase.html#a6ee1d1e7a13072ef579558d64b208d3c">llvm::IRBuilderBase::getInt32Ty</a></div><div class="ttdeci">IntegerType * getInt32Ty()</div><div class="ttdoc">Fetch the type representing a 32-bit integer. </div><div class="ttdef"><b>Definition:</b> <a href="IRBuilder_8h_source.html#l00310">IRBuilder.h:310</a></div></div>
<div class="ttc" id="namespacellvm_1_1MCID_html_a8035044d40d3758eb45b65dce69dc90ba32dbd2c72a98eaee90e3ad5ef7b5af16"><div class="ttname"><a href="namespacellvm_1_1MCID.html#a8035044d40d3758eb45b65dce69dc90ba32dbd2c72a98eaee90e3ad5ef7b5af16">llvm::MCID::Select</a></div><div class="ttdef"><b>Definition:</b> <a href="MCInstrDesc_8h_source.html#l00113">MCInstrDesc.h:113</a></div></div>
<div class="ttc" id="namespacellvm_html_ace6c957db39858291c6ce01c38e78480"><div class="ttname"><a href="namespacellvm.html#ace6c957db39858291c6ce01c38e78480">llvm::GetUnderlyingObject</a></div><div class="ttdeci">Value * GetUnderlyingObject(Value *V, const DataLayout *TD=0, unsigned MaxLookup=6)</div><div class="ttdef"><b>Definition:</b> <a href="ValueTracking_8cpp_source.html#l01899">ValueTracking.cpp:1899</a></div></div>
<div class="ttc" id="classllvm_1_1AnalysisUsage_html_ae5c60fd282ee894c87ea02c3f0fcb6d0"><div class="ttname"><a href="classllvm_1_1AnalysisUsage.html#ae5c60fd282ee894c87ea02c3f0fcb6d0">llvm::AnalysisUsage::addRequired</a></div><div class="ttdeci">AnalysisUsage &amp; addRequired()</div><div class="ttdef"><b>Definition:</b> <a href="PassAnalysisSupport_8h_source.html#l00055">PassAnalysisSupport.h:55</a></div></div>
<div class="ttc" id="namespacellvm_1_1GraphProgram_html_a0ad4685976f8c4d4a697a53fbe05d10b"><div class="ttname"><a href="namespacellvm_1_1GraphProgram.html#a0ad4685976f8c4d4a697a53fbe05d10b">llvm::GraphProgram::Name</a></div><div class="ttdeci">Name</div><div class="ttdef"><b>Definition:</b> <a href="GraphWriter_8h_source.html#l00044">GraphWriter.h:44</a></div></div>
<div class="ttc" id="PassSupport_8h_html_a14724f1ccf528e73bb29bc9230737967"><div class="ttname"><a href="PassSupport_8h.html#a14724f1ccf528e73bb29bc9230737967">INITIALIZE_PASS_DEPENDENCY</a></div><div class="ttdeci">#define INITIALIZE_PASS_DEPENDENCY(depName)</div><div class="ttdef"><b>Definition:</b> <a href="PassSupport_8h_source.html#l00167">PassSupport.h:167</a></div></div>
<div class="ttc" id="namespacellvm_1_1RegState_html_a079b254e749130fbe5d740f314ca92daab502f975742e9bff6d6dd7b49439b806"><div class="ttname"><a href="namespacellvm_1_1RegState.html#a079b254e749130fbe5d740f314ca92daab502f975742e9bff6d6dd7b49439b806">llvm::RegState::Undef</a></div><div class="ttdef"><b>Definition:</b> <a href="MachineInstrBuilder_8h_source.html#l00035">MachineInstrBuilder.h:35</a></div></div>
<div class="ttc" id="Delinearization_8cpp_html_a67193aea0752a127930d6f762e685eef"><div class="ttname"><a href="Delinearization_8cpp.html#a67193aea0752a127930d6f762e685eef">getPointerOperand</a></div><div class="ttdeci">static Value * getPointerOperand(Instruction &amp;Inst)</div><div class="ttdef"><b>Definition:</b> <a href="Delinearization_8cpp_source.html#l00072">Delinearization.cpp:72</a></div></div>
<div class="ttc" id="classllvm_1_1value__use__iterator_html"><div class="ttname"><a href="classllvm_1_1value__use__iterator.html">llvm::value_use_iterator</a></div><div class="ttdef"><b>Definition:</b> <a href="Use_8h_source.html#l00168">Use.h:168</a></div></div>
<div class="ttc" id="classllvm_1_1Instruction_html_ac72e0be80ec7138a1ec42c798b249981"><div class="ttname"><a href="classllvm_1_1Instruction.html#ac72e0be80ec7138a1ec42c798b249981">llvm::Instruction::isIdenticalTo</a></div><div class="ttdeci">bool isIdenticalTo(const Instruction *I) const </div><div class="ttdef"><b>Definition:</b> <a href="Instruction_8cpp_source.html#l00264">Instruction.cpp:264</a></div></div>
<div class="ttc" id="classllvm_1_1Twine_html"><div class="ttname"><a href="classllvm_1_1Twine.html">llvm::Twine</a></div><div class="ttdef"><b>Definition:</b> <a href="Twine_8h_source.html#l00081">Twine.h:81</a></div></div>
<div class="ttc" id="classllvm_1_1CastInst_html"><div class="ttname"><a href="classllvm_1_1CastInst.html">llvm::CastInst</a></div><div class="ttdoc">Base class of casting instructions. </div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00387">InstrTypes.h:387</a></div></div>
<div class="ttc" id="LoopInfo_8h_html"><div class="ttname"><a href="LoopInfo_8h.html">LoopInfo.h</a></div></div>
<div class="ttc" id="ErrorHandling_8h_html_ace243f5c25697a1107cce46626b3dc94"><div class="ttname"><a href="ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a></div><div class="ttdeci">#define llvm_unreachable(msg)</div><div class="ttdef"><b>Definition:</b> <a href="ErrorHandling_8h_source.html#l00103">ErrorHandling.h:103</a></div></div>
<div class="ttc" id="PassSupport_8h_html_a74ce8276b89067e806f67c45a6d92575"><div class="ttname"><a href="PassSupport_8h.html#a74ce8276b89067e806f67c45a6d92575">INITIALIZE_PASS_END</a></div><div class="ttdeci">#define INITIALIZE_PASS_END(passName, arg, name, cfg, analysis)</div><div class="ttdef"><b>Definition:</b> <a href="PassSupport_8h_source.html#l00172">PassSupport.h:172</a></div></div>
<div class="ttc" id="classllvm_1_1SmallVectorImpl_html"><div class="ttname"><a href="classllvm_1_1SmallVectorImpl.html">llvm::SmallVectorImpl</a></div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l00035">APInt.h:35</a></div></div>
<div class="ttc" id="classllvm_1_1BasicBlock_html_a0e73f4e09745bb69fdd7b15232c45428"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a0e73f4e09745bb69fdd7b15232c45428">llvm::BasicBlock::getFirstNonPHI</a></div><div class="ttdeci">Instruction * getFirstNonPHI()</div><div class="ttdoc">Returns a pointer to the first instruction in this block that is not a PHINode instruction. </div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8cpp_source.html#l00130">BasicBlock.cpp:130</a></div></div>
<div class="ttc" id="classllvm_1_1ConstantVector_html_ade9fa017ca3aa82f7694a47090547bc1"><div class="ttname"><a href="classllvm_1_1ConstantVector.html#ade9fa017ca3aa82f7694a47090547bc1">llvm::ConstantVector::get</a></div><div class="ttdeci">static Constant * get(ArrayRef&lt; Constant * &gt; V)</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l00923">Constants.cpp:923</a></div></div>
<div class="ttc" id="classllvm_1_1IRBuilder_html"><div class="ttname"><a href="classllvm_1_1IRBuilder.html">llvm::IRBuilder</a></div><div class="ttdoc">This provides a uniform API for creating instructions and inserting them into a basic block: either a...</div><div class="ttdef"><b>Definition:</b> <a href="IRBuilder_8h_source.html#l00421">IRBuilder.h:421</a></div></div>
<div class="ttc" id="classllvm_1_1AliasAnalysis_html"><div class="ttname"><a href="classllvm_1_1AliasAnalysis.html">llvm::AliasAnalysis</a></div><div class="ttdef"><b>Definition:</b> <a href="AliasAnalysis_8h_source.html#l00056">AliasAnalysis.h:56</a></div></div>
<div class="ttc" id="namespacellvm_html_a8a736f0023b19d73f205d93fec7094a8"><div class="ttname"><a href="namespacellvm.html#a8a736f0023b19d73f205d93fec7094a8">llvm::po_begin</a></div><div class="ttdeci">po_iterator&lt; T &gt; po_begin(T G)</div><div class="ttdef"><b>Definition:</b> <a href="PostOrderIterator_8h_source.html#l00175">PostOrderIterator.h:175</a></div></div>
<div class="ttc" id="namespacefalse_html"><div class="ttname"><a href="namespacefalse.html">false</a></div><div class="ttdef"><b>Definition:</b> <a href="StackSlotColoring_8cpp_source.html#l00126">StackSlotColoring.cpp:126</a></div></div>
<div class="ttc" id="InstCombineCompares_8cpp_html_aa5ab8c7b55d8bc7cab66be444daa70a1"><div class="ttname"><a href="InstCombineCompares_8cpp.html#aa5ab8c7b55d8bc7cab66be444daa70a1">ExtractElement</a></div><div class="ttdeci">static ConstantInt * ExtractElement(Constant *V, Constant *Idx)</div><div class="ttdef"><b>Definition:</b> <a href="InstCombineCompares_8cpp_source.html#l00040">InstCombineCompares.cpp:40</a></div></div>
<div class="ttc" id="namespacellvm_1_1CallingConv_html_a4f861731fc6dbfdccc05af5968d98974"><div class="ttname"><a href="namespacellvm_1_1CallingConv.html#a4f861731fc6dbfdccc05af5968d98974">llvm::CallingConv::ID</a></div><div class="ttdeci">ID</div><div class="ttdoc">LLVM Calling Convention Representation. </div><div class="ttdef"><b>Definition:</b> <a href="CallingConv_8h_source.html#l00026">CallingConv.h:26</a></div></div>
<div class="ttc" id="classllvm_1_1Value_html_a8624010a95fb91d34d1757461fce0ed9"><div class="ttname"><a href="classllvm_1_1Value.html#a8624010a95fb91d34d1757461fce0ed9">llvm::Value::stripAndAccumulateInBoundsConstantOffsets</a></div><div class="ttdeci">Value * stripAndAccumulateInBoundsConstantOffsets(const DataLayout &amp;DL, APInt &amp;Offset)</div><div class="ttdoc">Strips like stripInBoundsConstantOffsets but also accumulates the constant offset stripped...</div><div class="ttdef"><b>Definition:</b> <a href="Value_8cpp_source.html#l00397">Value.cpp:397</a></div></div>
<div class="ttc" id="classllvm_1_1Instruction_html"><div class="ttname"><a href="classllvm_1_1Instruction.html">llvm::Instruction</a></div><div class="ttdef"><b>Definition:</b> <a href="Instruction_8h_source.html#l00031">Instruction.h:31</a></div></div>
<div class="ttc" id="classllvm_1_1ConstantInt_html_a6edd823ba5e4e1effc8280ca8a1194ef"><div class="ttname"><a href="classllvm_1_1ConstantInt.html#a6edd823ba5e4e1effc8280ca8a1194ef">llvm::ConstantInt::getZExtValue</a></div><div class="ttdeci">uint64_t getZExtValue() const </div><div class="ttdoc">Return the zero extended value. </div><div class="ttdef"><b>Definition:</b> <a href="Constants_8h_source.html#l00116">Constants.h:116</a></div></div>
<div class="ttc" id="classllvm_1_1StoreInst_html_a6cac341b1b354174d0e0a81a2e7a9109"><div class="ttname"><a href="classllvm_1_1StoreInst.html#a6cac341b1b354174d0e0a81a2e7a9109">llvm::StoreInst::getPointerAddressSpace</a></div><div class="ttdeci">unsigned getPointerAddressSpace() const </div><div class="ttdoc">Returns the address space of the pointer operand. </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00351">Instructions.h:351</a></div></div>
<div class="ttc" id="classllvm_1_1SetVector_html_a72d928b7fc2c5f2d56c6ac0265fd9c6e"><div class="ttname"><a href="classllvm_1_1SetVector.html#a72d928b7fc2c5f2d56c6ac0265fd9c6e">llvm::SetVector::insert</a></div><div class="ttdeci">bool insert(const value_type &amp;X)</div><div class="ttdoc">Insert a new element into the SetVector. </div><div class="ttdef"><b>Definition:</b> <a href="SetVector_8h_source.html#l00102">SetVector.h:102</a></div></div>
<div class="ttc" id="classllvm_1_1SmallSet_html_a76b3fc7c102561fb5210d5151531e409"><div class="ttname"><a href="classllvm_1_1SmallSet.html#a76b3fc7c102561fb5210d5151531e409">llvm::SmallSet::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdef"><b>Definition:</b> <a href="SmallSet_8h_source.html#l00097">SmallSet.h:97</a></div></div>
<div class="ttc" id="classllvm_1_1SmallPtrSet_html_a2ced6343b8ad006a757059554bbf9f37"><div class="ttname"><a href="classllvm_1_1SmallPtrSet.html#a2ced6343b8ad006a757059554bbf9f37">llvm::SmallPtrSet::count</a></div><div class="ttdeci">bool count(PtrType Ptr) const </div><div class="ttdoc">count - Return true if the specified pointer is in the set. </div><div class="ttdef"><b>Definition:</b> <a href="SmallPtrSet_8h_source.html#l00264">SmallPtrSet.h:264</a></div></div>
<div class="ttc" id="classllvm_1_1IRBuilderBase_html_af1854d7c68b31127dbca0f80dd2bdf6d"><div class="ttname"><a href="classllvm_1_1IRBuilderBase.html#af1854d7c68b31127dbca0f80dd2bdf6d">llvm::IRBuilderBase::SetFastMathFlags</a></div><div class="ttdeci">void SetFastMathFlags(FastMathFlags NewFMF)</div><div class="ttdoc">Set the fast-math flags to be used with generated fp-math operators. </div><div class="ttdef"><b>Definition:</b> <a href="IRBuilder_8h_source.html#l00189">IRBuilder.h:189</a></div></div>
<div class="ttc" id="classllvm_1_1SmallVectorBase_html_a8a8df4d85555c7954a95f86080cd3b64"><div class="ttname"><a href="classllvm_1_1SmallVectorBase.html#a8a8df4d85555c7954a95f86080cd3b64">llvm::SmallVectorBase::empty</a></div><div class="ttdeci">bool LLVM_ATTRIBUTE_UNUSED_RESULT empty() const </div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00056">SmallVector.h:56</a></div></div>
<div class="ttc" id="classllvm_1_1Instruction_html_ac26154a24f393f523c87cc5f8239f36c"><div class="ttname"><a href="classllvm_1_1Instruction.html#ac26154a24f393f523c87cc5f8239f36c">llvm::Instruction::BinaryOps</a></div><div class="ttdeci">BinaryOps</div><div class="ttdef"><b>Definition:</b> <a href="Instruction_8h_source.html#l00387">Instruction.h:387</a></div></div>
<div class="ttc" id="classllvm_1_1Instruction_html_aa113b8a9ef3de9c2f075a046ad658717"><div class="ttname"><a href="classllvm_1_1Instruction.html#aa113b8a9ef3de9c2f075a046ad658717">llvm::Instruction::isAssociative</a></div><div class="ttdeci">bool isAssociative() const </div><div class="ttdef"><b>Definition:</b> <a href="Instruction_8cpp_source.html#l00482">Instruction.cpp:482</a></div></div>
<div class="ttc" id="classllvm_1_1ArrayRef_html_a8a4a04e719ab242a67a91dbfd17e16b0"><div class="ttname"><a href="classllvm_1_1ArrayRef.html#a8a4a04e719ab242a67a91dbfd17e16b0">llvm::ArrayRef::slice</a></div><div class="ttdeci">ArrayRef&lt; T &gt; slice(unsigned N) const </div><div class="ttdoc">slice(n) - Chop off the first N elements of the array. </div><div class="ttdef"><b>Definition:</b> <a href="ArrayRef_8h_source.html#l00134">ArrayRef.h:134</a></div></div>
<div class="ttc" id="classllvm_1_1SetVector_html_adb13793b98ab59209a5309d26f831850"><div class="ttname"><a href="classllvm_1_1SetVector.html#adb13793b98ab59209a5309d26f831850">llvm::SetVector::begin</a></div><div class="ttdeci">iterator begin()</div><div class="ttdoc">Get an iterator to the beginning of the SetVector. </div><div class="ttdef"><b>Definition:</b> <a href="SetVector_8h_source.html#l00069">SetVector.h:69</a></div></div>
<div class="ttc" id="classllvm_1_1ArrayRef_html"><div class="ttname"><a href="classllvm_1_1ArrayRef.html">llvm::ArrayRef</a></div><div class="ttdef"><b>Definition:</b> <a href="ArrayRef_8h_source.html#l00031">ArrayRef.h:31</a></div></div>
<div class="ttc" id="classllvm_1_1SmallSet_html_a8d8348060ccdeeba13fb8bc651dfbf82"><div class="ttname"><a href="classllvm_1_1SmallSet.html#a8d8348060ccdeeba13fb8bc651dfbf82">llvm::SmallSet::insert</a></div><div class="ttdeci">bool insert(const T &amp;V)</div><div class="ttdef"><b>Definition:</b> <a href="SmallSet_8h_source.html#l00059">SmallSet.h:59</a></div></div>
<div class="ttc" id="classllvm_1_1StoreInst_html"><div class="ttname"><a href="classllvm_1_1StoreInst.html">llvm::StoreInst</a></div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00255">Instructions.h:255</a></div></div>
<div class="ttc" id="classllvm_1_1Value_html_a3ab5fc45117b450e8bb04e564cb6e5f2"><div class="ttname"><a href="classllvm_1_1Value.html#a3ab5fc45117b450e8bb04e564cb6e5f2">llvm::Value::replaceAllUsesWith</a></div><div class="ttdeci">void replaceAllUsesWith(Value *V)</div><div class="ttdef"><b>Definition:</b> <a href="Value_8cpp_source.html#l00303">Value.cpp:303</a></div></div>
<div class="ttc" id="classllvm_1_1VectorType_html_a580510fa692dccfb26d0e967d8f164e7"><div class="ttname"><a href="classllvm_1_1VectorType.html#a580510fa692dccfb26d0e967d8f164e7">llvm::VectorType::getNumElements</a></div><div class="ttdeci">unsigned getNumElements() const </div><div class="ttdoc">Return the number of elements in the Vector type. </div><div class="ttdef"><b>Definition:</b> <a href="DerivedTypes_8h_source.html#l00408">DerivedTypes.h:408</a></div></div>
<div class="ttc" id="classllvm_1_1DominatorTree_html"><div class="ttname"><a href="classllvm_1_1DominatorTree.html">llvm::DominatorTree</a></div><div class="ttdef"><b>Definition:</b> <a href="Dominators_8h_source.html#l00740">Dominators.h:740</a></div></div>
<div class="ttc" id="classllvm_1_1ArrayRef_html_a76878250107ee24ef7339870bdda4bcf"><div class="ttname"><a href="classllvm_1_1ArrayRef.html#a76878250107ee24ef7339870bdda4bcf">llvm::ArrayRef::size</a></div><div class="ttdeci">size_t size() const </div><div class="ttdoc">size - Get the array size. </div><div class="ttdef"><b>Definition:</b> <a href="ArrayRef_8h_source.html#l00109">ArrayRef.h:109</a></div></div>
<div class="ttc" id="classllvm_1_1PHINode_html_aa45f6c0433576e3858a6209a43750ad4"><div class="ttname"><a href="classllvm_1_1PHINode.html#aa45f6c0433576e3858a6209a43750ad4">llvm::PHINode::getNumIncomingValues</a></div><div class="ttdeci">unsigned getNumIncomingValues() const </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02055">Instructions.h:2055</a></div></div>
<div class="ttc" id="classllvm_1_1User_html_a1f0b9358936e3e00c42a460abbfb2868"><div class="ttname"><a href="classllvm_1_1User.html#a1f0b9358936e3e00c42a460abbfb2868">llvm::User::replaceUsesOfWith</a></div><div class="ttdeci">void replaceUsesOfWith(Value *From, Value *To)</div><div class="ttdef"><b>Definition:</b> <a href="User_8cpp_source.html#l00026">User.cpp:26</a></div></div>
<div class="ttc" id="classllvm_1_1LLVMContext_html_a0869c4dfee48696ce863fcd367eba52da1b73df7e27f0fa94e338ffc4fac9daf3"><div class="ttname"><a href="classllvm_1_1LLVMContext.html#a0869c4dfee48696ce863fcd367eba52da1b73df7e27f0fa94e338ffc4fac9daf3">llvm::LLVMContext::MD_fpmath</a></div><div class="ttdef"><b>Definition:</b> <a href="LLVMContext_8h_source.html#l00049">LLVMContext.h:49</a></div></div>
<div class="ttc" id="README__ALTIVEC_8txt_html_a9aacd9146afe44bf656cd664e2a88c8c"><div class="ttname"><a href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a></div><div class="ttdeci">(vector float) vec_cmpeq(*A,*B) C</div><div class="ttdef"><b>Definition:</b> <a href="README__ALTIVEC_8txt_source.html#l00091">README_ALTIVEC.txt:91</a></div></div>
<div class="ttc" id="CommandLine_8h_html"><div class="ttname"><a href="CommandLine_8h.html">CommandLine.h</a></div></div>
<div class="ttc" id="namespacellvm_1_1cl_html_a10a041239ae1870cfcc064bfaa79fb65"><div class="ttname"><a href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">llvm::cl::init</a></div><div class="ttdeci">initializer&lt; Ty &gt; init(const Ty &amp;Val)</div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l00314">CommandLine.h:314</a></div></div>
<div class="ttc" id="classllvm_1_1InsertElementInst_html"><div class="ttname"><a href="classllvm_1_1InsertElementInst.html">llvm::InsertElementInst</a></div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l01602">Instructions.h:1602</a></div></div>
<div class="ttc" id="SLPVectorizer_8cpp_html_a4dc630bcb416d59c7a164a214cbf9872"><div class="ttname"><a href="SLPVectorizer_8cpp.html#a4dc630bcb416d59c7a164a214cbf9872">ShouldVectorizeHor</a></div><div class="ttdeci">static cl::opt&lt; bool &gt; ShouldVectorizeHor(&quot;slp-vectorize-hor&quot;, cl::init(false), cl::Hidden, cl::desc(&quot;Attempt to vectorize horizontal reductions&quot;))</div></div>
<div class="ttc" id="classllvm_1_1IRBuilder_html_a2bd8d3ea479e99434bac72362a59f078"><div class="ttname"><a href="classllvm_1_1IRBuilder.html#a2bd8d3ea479e99434bac72362a59f078">llvm::IRBuilder::CreateBinOp</a></div><div class="ttdeci">Value * CreateBinOp(Instruction::BinaryOps Opc, Value *LHS, Value *RHS, const Twine &amp;Name=&quot;&quot;)</div><div class="ttdef"><b>Definition:</b> <a href="IRBuilder_8h_source.html#l00834">IRBuilder.h:834</a></div></div>
<div class="ttc" id="classllvm_1_1StoreInst_html_a3084f1dd69d67e1965fd1fe721a69f2e"><div class="ttname"><a href="classllvm_1_1StoreInst.html#a3084f1dd69d67e1965fd1fe721a69f2e">llvm::StoreInst::getAlignment</a></div><div class="ttdeci">unsigned getAlignment() const </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00301">Instructions.h:301</a></div></div>
<div class="ttc" id="classllvm_1_1TerminatorInst_html"><div class="ttname"><a href="classllvm_1_1TerminatorInst.html">llvm::TerminatorInst</a></div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00035">InstrTypes.h:35</a></div></div>
<div class="ttc" id="SLPVectorizer_8cpp_html_a261a64ee0c17cb0a8b61985e1836a32c"><div class="ttname"><a href="SLPVectorizer_8cpp.html#a261a64ee0c17cb0a8b61985e1836a32c">ShouldStartVectorizeHorAtStore</a></div><div class="ttdeci">static cl::opt&lt; bool &gt; ShouldStartVectorizeHorAtStore(&quot;slp-vectorize-hor-store&quot;, cl::init(false), cl::Hidden, cl::desc(&quot;Attempt to vectorize horizontal reductions feeding into a store&quot;))</div></div>
<div class="ttc" id="classllvm_1_1LoopBase_html_a1bc74c76b876ad387293ecde0f21ed45"><div class="ttname"><a href="classllvm_1_1LoopBase.html#a1bc74c76b876ad387293ecde0f21ed45">llvm::LoopBase::getLoopPreheader</a></div><div class="ttdeci">BlockT * getLoopPreheader() const </div><div class="ttdef"><b>Definition:</b> <a href="LoopInfoImpl_8h_source.html#l00106">LoopInfoImpl.h:106</a></div></div>
<div class="ttc" id="classllvm_1_1SmallVectorTemplateCommon_html_acd9e771a3296c6b24146955754620557"><div class="ttname"><a href="classllvm_1_1SmallVectorTemplateCommon.html#acd9e771a3296c6b24146955754620557">llvm::SmallVectorTemplateCommon&lt; T &gt;::back</a></div><div class="ttdeci">reference back()</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00157">SmallVector.h:157</a></div></div>
<div class="ttc" id="classllvm_1_1SmallVectorImpl_html_aac0ea55010b7b1a301e65a0baea057aa"><div class="ttname"><a href="classllvm_1_1SmallVectorImpl.html#aac0ea55010b7b1a301e65a0baea057aa">llvm::SmallVectorImpl::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00396">SmallVector.h:396</a></div></div>
<div class="ttc" id="classllvm_1_1BasicBlock_html"><div class="ttname"><a href="classllvm_1_1BasicBlock.html">llvm::BasicBlock</a></div><div class="ttdoc">LLVM Basic Block Representation. </div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00072">BasicBlock.h:72</a></div></div>
<div class="ttc" id="classllvm_1_1Type_html"><div class="ttname"><a href="classllvm_1_1Type.html">llvm::Type</a></div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00044">Type.h:44</a></div></div>
<div class="ttc" id="classllvm_1_1Type_html_a6f725580f7834e2ca90762965866dad4"><div class="ttname"><a href="classllvm_1_1Type.html#a6f725580f7834e2ca90762965866dad4">llvm::Type::isVectorTy</a></div><div class="ttdeci">bool isVectorTy() const </div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00229">Type.h:229</a></div></div>
<div class="ttc" id="ScalarEvolutionExpressions_8h_html"><div class="ttname"><a href="ScalarEvolutionExpressions_8h.html">ScalarEvolutionExpressions.h</a></div></div>
<div class="ttc" id="classllvm_1_1SmallSet_html"><div class="ttname"><a href="classllvm_1_1SmallSet.html">llvm::SmallSet</a></div><div class="ttdef"><b>Definition:</b> <a href="SmallSet_8h_source.html#l00031">SmallSet.h:31</a></div></div>
<div class="ttc" id="namespacellvm_1_1APIntOps_html_a22f056804d2b9882f74adc905872bc39"><div class="ttname"><a href="namespacellvm_1_1APIntOps.html#a22f056804d2b9882f74adc905872bc39">llvm::APIntOps::Or</a></div><div class="ttdeci">APInt Or(const APInt &amp;LHS, const APInt &amp;RHS)</div><div class="ttdoc">Bitwise OR function for APInt. </div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l01845">APInt.h:1845</a></div></div>
<div class="ttc" id="structllvm_1_1cl_1_1desc_html"><div class="ttname"><a href="structllvm_1_1cl_1_1desc.html">llvm::cl::desc</a></div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l00286">CommandLine.h:286</a></div></div>
<div class="ttc" id="namespacellvm_1_1APIntOps_html_afc7c4d88d09cba0c5e920f8a3a3ace55"><div class="ttname"><a href="namespacellvm_1_1APIntOps.html#afc7c4d88d09cba0c5e920f8a3a3ace55">llvm::APIntOps::Xor</a></div><div class="ttdeci">APInt Xor(const APInt &amp;LHS, const APInt &amp;RHS)</div><div class="ttdoc">Bitwise XOR function for APInt. </div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l01850">APInt.h:1850</a></div></div>
<div class="ttc" id="classllvm_1_1Instruction_html_aab8e16a35183ce39aad394714087bcff"><div class="ttname"><a href="classllvm_1_1Instruction.html#aab8e16a35183ce39aad394714087bcff">llvm::Instruction::getDebugLoc</a></div><div class="ttdeci">const DebugLoc &amp; getDebugLoc() const </div><div class="ttdoc">getDebugLoc - Return the debug location for this node as a DebugLoc. </div><div class="ttdef"><b>Definition:</b> <a href="Instruction_8h_source.html#l00178">Instruction.h:178</a></div></div>
<div class="ttc" id="classllvm_1_1FastMathFlags_html_a056f6222d38bebe1ed7c885738d24606"><div class="ttname"><a href="classllvm_1_1FastMathFlags.html#a056f6222d38bebe1ed7c885738d24606">llvm::FastMathFlags::setUnsafeAlgebra</a></div><div class="ttdeci">void setUnsafeAlgebra()</div><div class="ttdef"><b>Definition:</b> <a href="Operator_8h_source.html#l00206">Operator.h:206</a></div></div>
<div class="ttc" id="classllvm_1_1AnalysisUsage_html"><div class="ttname"><a href="classllvm_1_1AnalysisUsage.html">llvm::AnalysisUsage</a></div><div class="ttdef"><b>Definition:</b> <a href="PassAnalysisSupport_8h_source.html#l00037">PassAnalysisSupport.h:37</a></div></div>
<div class="ttc" id="classllvm_1_1User_html_af41f58e730804d10b91fcff39b035f74"><div class="ttname"><a href="classllvm_1_1User.html#af41f58e730804d10b91fcff39b035f74">llvm::User::op_end</a></div><div class="ttdeci">op_iterator op_end()</div><div class="ttdef"><b>Definition:</b> <a href="User_8h_source.html#l00118">User.h:118</a></div></div>
<div class="ttc" id="namespacellvm_html_a36798313569555c6f79b4ac8cc0bf63d"><div class="ttname"><a href="namespacellvm.html#a36798313569555c6f79b4ac8cc0bf63d">llvm::verifyFunction</a></div><div class="ttdeci">bool verifyFunction(const Function &amp;F, VerifierFailureAction action=AbortProcessAction)</div><div class="ttdef"><b>Definition:</b> <a href="Verifier_8cpp_source.html#l02417">Verifier.cpp:2417</a></div></div>
<div class="ttc" id="classllvm_1_1PHINode_html_a4c25b6c00c4867281779c81ab64d2081"><div class="ttname"><a href="classllvm_1_1PHINode.html#a4c25b6c00c4867281779c81ab64d2081">llvm::PHINode::getIncomingBlock</a></div><div class="ttdeci">BasicBlock * getIncomingBlock(unsigned i) const </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02074">Instructions.h:2074</a></div></div>
<div class="ttc" id="classllvm_1_1CmpInst_html_a283f9a5d4d843d20c40bb4d3e364bb05"><div class="ttname"><a href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05">llvm::CmpInst::Predicate</a></div><div class="ttdeci">Predicate</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00651">InstrTypes.h:651</a></div></div>
<div class="ttc" id="classllvm_1_1ArrayRef_html_a836367b39ed630bf14db99923c22740e"><div class="ttname"><a href="classllvm_1_1ArrayRef.html#a836367b39ed630bf14db99923c22740e">llvm::ArrayRef::begin</a></div><div class="ttdeci">iterator begin() const </div><div class="ttdef"><b>Definition:</b> <a href="ArrayRef_8h_source.html#l00097">ArrayRef.h:97</a></div></div>
<div class="ttc" id="classllvm_1_1FunctionPass_html"><div class="ttname"><a href="classllvm_1_1FunctionPass.html">llvm::FunctionPass</a></div><div class="ttdef"><b>Definition:</b> <a href="Pass_8h_source.html#l00293">Pass.h:293</a></div></div>
<div class="ttc" id="classllvm_1_1DenseMapBase_html_a321e37d79af8b4287f8a1dcf9aff9c01"><div class="ttname"><a href="classllvm_1_1DenseMapBase.html#a321e37d79af8b4287f8a1dcf9aff9c01">llvm::DenseMapBase&lt; SmallDenseMap&lt; KeyT, ValueT, InlineBuckets, KeyInfoT &gt;, KeyT, ValueT, KeyInfoT &gt;::end</a></div><div class="ttdeci">iterator end()</div><div class="ttdef"><b>Definition:</b> <a href="DenseMap_8h_source.html#l00057">DenseMap.h:57</a></div></div>
<div class="ttc" id="classllvm_1_1User_html_a997ff6a1758bf732b9b263fc61011644"><div class="ttname"><a href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">llvm::User::getOperand</a></div><div class="ttdeci">Value * getOperand(unsigned i) const </div><div class="ttdef"><b>Definition:</b> <a href="User_8h_source.html#l00088">User.h:88</a></div></div>
<div class="ttc" id="classllvm_1_1LoadInst_html_ad47eefa1d094f60494b6b927061ca001"><div class="ttname"><a href="classllvm_1_1LoadInst.html#ad47eefa1d094f60494b6b927061ca001">llvm::LoadInst::getPointerOperand</a></div><div class="ttdeci">Value * getPointerOperand()</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00223">Instructions.h:223</a></div></div>
<div class="ttc" id="classllvm_1_1Instruction_html_a1c2048f254df730c4de1643ec791ddf9"><div class="ttname"><a href="classllvm_1_1Instruction.html#a1c2048f254df730c4de1643ec791ddf9">llvm::Instruction::isCommutative</a></div><div class="ttdeci">bool isCommutative() const </div><div class="ttdef"><b>Definition:</b> <a href="Instruction_8h_source.html#l00269">Instruction.h:269</a></div></div>
<div class="ttc" id="classllvm_1_1LoopBase_html_a92a38e2e3412bde7fd2b71db212b61aa"><div class="ttname"><a href="classllvm_1_1LoopBase.html#a92a38e2e3412bde7fd2b71db212b61aa">llvm::LoopBase::contains</a></div><div class="ttdeci">bool contains(const LoopT *L) const </div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l00104">LoopInfo.h:104</a></div></div>
<div class="ttc" id="classllvm_1_1LLVMContext_html_a0869c4dfee48696ce863fcd367eba52da66682b7e33233c8e51196bbf274726a2"><div class="ttname"><a href="classllvm_1_1LLVMContext.html#a0869c4dfee48696ce863fcd367eba52da66682b7e33233c8e51196bbf274726a2">llvm::LLVMContext::MD_tbaa</a></div><div class="ttdef"><b>Definition:</b> <a href="LLVMContext_8h_source.html#l00047">LLVMContext.h:47</a></div></div>
<div class="ttc" id="namespacellvm_1_1MCID_html_a8035044d40d3758eb45b65dce69dc90ba24b6e620b18edd37201fb9c0897835a8"><div class="ttname"><a href="namespacellvm_1_1MCID.html#a8035044d40d3758eb45b65dce69dc90ba24b6e620b18edd37201fb9c0897835a8">llvm::MCID::Barrier</a></div><div class="ttdef"><b>Definition:</b> <a href="MCInstrDesc_8h_source.html#l00106">MCInstrDesc.h:106</a></div></div>
<div class="ttc" id="classllvm_1_1CmpInst_html_a8afd4995fae596b2c86eeed85b3d388b"><div class="ttname"><a href="classllvm_1_1CmpInst.html#a8afd4995fae596b2c86eeed85b3d388b">llvm::CmpInst::getPredicate</a></div><div class="ttdeci">Predicate getPredicate() const </div><div class="ttdoc">Return the predicate for this instruction. </div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00714">InstrTypes.h:714</a></div></div>
<div class="ttc" id="namespacellvm_1_1LibFunc_html_abf8f6830387f338fed0bce2e65108c6f"><div class="ttname"><a href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6f">llvm::LibFunc::Func</a></div><div class="ttdeci">Func</div><div class="ttdef"><b>Definition:</b> <a href="TargetLibraryInfo_8h_source.html#l00020">TargetLibraryInfo.h:20</a></div></div>
<div class="ttc" id="structllvm_1_1AliasAnalysis_1_1Location_html"><div class="ttname"><a href="structllvm_1_1AliasAnalysis_1_1Location.html">llvm::AliasAnalysis::Location</a></div><div class="ttdoc">Location - A description of a memory location. </div><div class="ttdef"><b>Definition:</b> <a href="AliasAnalysis_8h_source.html#l00106">AliasAnalysis.h:106</a></div></div>
<div class="ttc" id="classllvm_1_1LoadInst_html_a218ef27c964707a907f12db0f9b002ba"><div class="ttname"><a href="classllvm_1_1LoadInst.html#a218ef27c964707a907f12db0f9b002ba">llvm::LoadInst::setAlignment</a></div><div class="ttdeci">void setAlignment(unsigned Align)</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8cpp_source.html#l01065">Instructions.cpp:1065</a></div></div>
<div class="ttc" id="classllvm_1_1DominatorTree_html_a6fe9272dc67fe2ff4cafc33b895c4a6c"><div class="ttname"><a href="classllvm_1_1DominatorTree.html#a6fe9272dc67fe2ff4cafc33b895c4a6c">llvm::DominatorTree::dominates</a></div><div class="ttdeci">bool dominates(const DomTreeNode *A, const DomTreeNode *B) const </div><div class="ttdef"><b>Definition:</b> <a href="Dominators_8h_source.html#l00801">Dominators.h:801</a></div></div>
<div class="ttc" id="PassSupport_8h_html_af0564bcdde2dd4400c670ca278c6035f"><div class="ttname"><a href="PassSupport_8h.html#af0564bcdde2dd4400c670ca278c6035f">INITIALIZE_AG_DEPENDENCY</a></div><div class="ttdeci">#define INITIALIZE_AG_DEPENDENCY(depName)</div><div class="ttdef"><b>Definition:</b> <a href="PassSupport_8h_source.html#l00169">PassSupport.h:169</a></div></div>
<div class="ttc" id="classllvm_1_1MDNode_html_a3c210e8905029a012df3384a7eeb63ad"><div class="ttname"><a href="classllvm_1_1MDNode.html#a3c210e8905029a012df3384a7eeb63ad">llvm::MDNode::getMostGenericTBAA</a></div><div class="ttdeci">static MDNode * getMostGenericTBAA(MDNode *A, MDNode *B)</div><div class="ttdoc">Methods for metadata merging. </div><div class="ttdef"><b>Definition:</b> <a href="TypeBasedAliasAnalysis_8cpp_source.html#l00556">TypeBasedAliasAnalysis.cpp:556</a></div></div>
<div class="ttc" id="classllvm_1_1UndefValue_html_a4ae5ff22b700a42bcc5d889233721335"><div class="ttname"><a href="classllvm_1_1UndefValue.html#a4ae5ff22b700a42bcc5d889233721335">llvm::UndefValue::get</a></div><div class="ttdeci">static UndefValue * get(Type *T)</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l01334">Constants.cpp:1334</a></div></div>
<div class="ttc" id="classT_html"><div class="ttname"><a href="classT.html">T</a></div></div>
<div class="ttc" id="classllvm_1_1Type_html_ab6cc070c37c59589af100aab6f48ef4f"><div class="ttname"><a href="classllvm_1_1Type.html#ab6cc070c37c59589af100aab6f48ef4f">llvm::Type::getPointerTo</a></div><div class="ttdeci">PointerType * getPointerTo(unsigned AddrSpace=0)</div><div class="ttdef"><b>Definition:</b> <a href="Type_8cpp_source.html#l00756">Type.cpp:756</a></div></div>
<div class="ttc" id="classllvm_1_1Instruction_html_a9247a212ea89acc9573fa7e7f557eaba"><div class="ttname"><a href="classllvm_1_1Instruction.html#a9247a212ea89acc9573fa7e7f557eaba">llvm::Instruction::setMetadata</a></div><div class="ttdeci">void setMetadata(unsigned KindID, MDNode *Node)</div><div class="ttdef"><b>Definition:</b> <a href="Metadata_8cpp_source.html#l00589">Metadata.cpp:589</a></div></div>
<div class="ttc" id="Target_2README_8txt_html_ab335e668fd33542ea14a2c7b527e64d3"><div class="ttname"><a href="Target_2README_8txt.html#ab335e668fd33542ea14a2c7b527e64d3">n</a></div><div class="ttdeci">The same transformation can work with an even modulo with the addition of a and shrink the compare RHS by the same amount Unless the target supports that transformation probably isn t worthwhile The transformation can also easily be made to work with non zero equality for n</div><div class="ttdef"><b>Definition:</b> <a href="Target_2README_8txt_source.html#l00723">Target/README.txt:723</a></div></div>
<div class="ttc" id="classllvm_1_1Instruction_html_aa26de3d6e38997b9041e824ea558c770"><div class="ttname"><a href="classllvm_1_1Instruction.html#aa26de3d6e38997b9041e824ea558c770">llvm::Instruction::mayWriteToMemory</a></div><div class="ttdeci">bool mayWriteToMemory() const </div><div class="ttdef"><b>Definition:</b> <a href="Instruction_8cpp_source.html#l00441">Instruction.cpp:441</a></div></div>
<div class="ttc" id="SLPVectorizer_8cpp_html_a274654b7f5932cae6a71a113322481be"><div class="ttname"><a href="SLPVectorizer_8cpp.html#a274654b7f5932cae6a71a113322481be">SV_NAME</a></div><div class="ttdeci">#define SV_NAME</div><div class="ttdef"><b>Definition:</b> <a href="SLPVectorizer_8cpp_source.html#l00018">SLPVectorizer.cpp:18</a></div></div>
<div class="ttc" id="classllvm_1_1BinaryOperator_html_a88505baf41407782678a5df1702d2d31"><div class="ttname"><a href="classllvm_1_1BinaryOperator.html#a88505baf41407782678a5df1702d2d31">llvm::BinaryOperator::getOpcode</a></div><div class="ttdeci">BinaryOps getOpcode() const </div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00326">InstrTypes.h:326</a></div></div>
<div class="ttc" id="namespacellvm_1_1TargetOpcode_html_a348d4259b5fa6a8ecfe94e7ae512e1a8ae41f9ca68ba5e8b9613cea03652ebd72"><div class="ttname"><a href="namespacellvm_1_1TargetOpcode.html#a348d4259b5fa6a8ecfe94e7ae512e1a8ae41f9ca68ba5e8b9613cea03652ebd72">llvm::TargetOpcode::PHI</a></div><div class="ttdef"><b>Definition:</b> <a href="TargetOpcodes_8h_source.html#l00026">TargetOpcodes.h:26</a></div></div>
<div class="ttc" id="classllvm_1_1ilist__iterator_html"><div class="ttname"><a href="classllvm_1_1ilist__iterator.html">llvm::ilist_iterator</a></div><div class="ttdef"><b>Definition:</b> <a href="ilist_8h_source.html#l00050">ilist.h:50</a></div></div>
<div class="ttc" id="Target_2ARM_2README_8txt_html_a1b45f45820a60c09244a87eb59824aec"><div class="ttname"><a href="Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a></div><div class="ttdeci">add sub stmia L5 ldr r0 bl L_printf $stub Instead of a and a wouldn t it be better to do three moves *Return an aggregate type is even return S</div><div class="ttdef"><b>Definition:</b> <a href="Target_2ARM_2README_8txt_source.html#l00197">Target/ARM/README.txt:197</a></div></div>
<div class="ttc" id="classllvm_1_1SmallPtrSet_html"><div class="ttname"><a href="classllvm_1_1SmallPtrSet.html">llvm::SmallPtrSet</a></div><div class="ttdef"><b>Definition:</b> <a href="SmallPtrSet_8h_source.html#l00236">SmallPtrSet.h:236</a></div></div>
<div class="ttc" id="classllvm_1_1ConstantInt_html"><div class="ttname"><a href="classllvm_1_1ConstantInt.html">llvm::ConstantInt</a></div><div class="ttdoc">Class for constant integers. </div><div class="ttdef"><b>Definition:</b> <a href="Constants_8h_source.html#l00051">Constants.h:51</a></div></div>
<div class="ttc" id="classllvm_1_1IRBuilder_html_ad0affa936bea7c530da1597e9bb60bbd"><div class="ttname"><a href="classllvm_1_1IRBuilder.html#ad0affa936bea7c530da1597e9bb60bbd">llvm::IRBuilder::CreateExtractElement</a></div><div class="ttdeci">Value * CreateExtractElement(Value *Vec, Value *Idx, const Twine &amp;Name=&quot;&quot;)</div><div class="ttdef"><b>Definition:</b> <a href="IRBuilder_8h_source.html#l01349">IRBuilder.h:1349</a></div></div>
<div class="ttc" id="classllvm_1_1TargetTransformInfo_html"><div class="ttname"><a href="classllvm_1_1TargetTransformInfo.html">llvm::TargetTransformInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="TargetTransformInfo_8h_source.html#l00039">TargetTransformInfo.h:39</a></div></div>
<div class="ttc" id="classllvm_1_1PHINode_html_aba6a4cc4ed6d6fef3664b8d65ef04820"><div class="ttname"><a href="classllvm_1_1PHINode.html#aba6a4cc4ed6d6fef3664b8d65ef04820">llvm::PHINode::getIncomingValue</a></div><div class="ttdeci">Value * getIncomingValue(unsigned i) const </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02059">Instructions.h:2059</a></div></div>
<div class="ttc" id="classllvm_1_1Type_html_ad8f27f0b94a56abcd296b8461737a3af"><div class="ttname"><a href="classllvm_1_1Type.html#ad8f27f0b94a56abcd296b8461737a3af">llvm::Type::getVectorNumElements</a></div><div class="ttdeci">unsigned getVectorNumElements() const </div><div class="ttdef"><b>Definition:</b> <a href="Type_8cpp_source.html#l00214">Type.cpp:214</a></div></div>
<div class="ttc" id="Target_2README_8txt_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">i</div><div class="ttdef"><b>Definition:</b> <a href="Target_2README_8txt_source.html#l00029">Target/README.txt:29</a></div></div>
<div class="ttc" id="classllvm_1_1BasicBlock_html_a0b4e7bee9b8575cc7db73329f1a561bd"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a0b4e7bee9b8575cc7db73329f1a561bd">llvm::BasicBlock::end</a></div><div class="ttdeci">iterator end()</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00195">BasicBlock.h:195</a></div></div>
<div class="ttc" id="namespacellvm_1_1EngineKind_html_a9df47239a42cd9621ac26d9ecbd57441"><div class="ttname"><a href="namespacellvm_1_1EngineKind.html#a9df47239a42cd9621ac26d9ecbd57441">llvm::EngineKind::Kind</a></div><div class="ttdeci">Kind</div><div class="ttdef"><b>Definition:</b> <a href="ExecutionEngine_2ExecutionEngine_8h_source.html#l00499">ExecutionEngine/ExecutionEngine.h:499</a></div></div>
<div class="ttc" id="classllvm_1_1SmallVector_html"><div class="ttname"><a href="classllvm_1_1SmallVector.html">llvm::SmallVector</a></div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00880">SmallVector.h:880</a></div></div>
<div class="ttc" id="Module_8h_html"><div class="ttname"><a href="Module_8h.html">Module.h</a></div></div>
<div class="ttc" id="classllvm_1_1Value_html_a0cf3748dba54f931bb1241ae4adc76bc"><div class="ttname"><a href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">llvm::Value::getType</a></div><div class="ttdeci">Type * getType() const </div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00111">Value.h:111</a></div></div>
<div class="ttc" id="classllvm_1_1Instruction_html_aafa29112cbe02e4adc9b36752c771991"><div class="ttname"><a href="classllvm_1_1Instruction.html#aafa29112cbe02e4adc9b36752c771991">llvm::Instruction::getMetadata</a></div><div class="ttdeci">MDNode * getMetadata(unsigned KindID) const </div><div class="ttdef"><b>Definition:</b> <a href="Instruction_8h_source.html#l00140">Instruction.h:140</a></div></div>
<div class="ttc" id="classllvm_1_1LoopInfo_html"><div class="ttname"><a href="classllvm_1_1LoopInfo.html">llvm::LoopInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l00589">LoopInfo.h:589</a></div></div>
<div class="ttc" id="classllvm_1_1BinaryOperator_html"><div class="ttname"><a href="classllvm_1_1BinaryOperator.html">llvm::BinaryOperator</a></div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00138">InstrTypes.h:138</a></div></div>
<div class="ttc" id="PassSupport_8h_html_aaa970fc931c1c63037a8182e028d04b1"><div class="ttname"><a href="PassSupport_8h.html#aaa970fc931c1c63037a8182e028d04b1">INITIALIZE_PASS_BEGIN</a></div><div class="ttdeci">#define INITIALIZE_PASS_BEGIN(passName, arg, name, cfg, analysis)</div><div class="ttdef"><b>Definition:</b> <a href="PassSupport_8h_source.html#l00164">PassSupport.h:164</a></div></div>
<div class="ttc" id="classllvm_1_1IRBuilderBase_html_ac0e8c554bf1c1e117a74d51df89c137d"><div class="ttname"><a href="classllvm_1_1IRBuilderBase.html#ac0e8c554bf1c1e117a74d51df89c137d">llvm::IRBuilderBase::getInt32</a></div><div class="ttdeci">ConstantInt * getInt32(uint32_t C)</div><div class="ttdoc">Get a constant 32-bit value. </div><div class="ttdef"><b>Definition:</b> <a href="IRBuilder_8h_source.html#l00276">IRBuilder.h:276</a></div></div>
<div class="ttc" id="Verifier_8h_html"><div class="ttname"><a href="Verifier_8h.html">Verifier.h</a></div></div>
<div class="ttc" id="classllvm_1_1AnalysisUsage_html_af11a6ebf7ab3c388234cb6d5378439a3"><div class="ttname"><a href="classllvm_1_1AnalysisUsage.html#af11a6ebf7ab3c388234cb6d5378439a3">llvm::AnalysisUsage::setPreservesCFG</a></div><div class="ttdeci">void setPreservesCFG()</div><div class="ttdef"><b>Definition:</b> <a href="Pass_8cpp_source.html#l00249">Pass.cpp:249</a></div></div>
<div class="ttc" id="classllvm_1_1Function_html_a30f2c362631e3728d2f47a8203071ade"><div class="ttname"><a href="classllvm_1_1Function.html#a30f2c362631e3728d2f47a8203071ade">llvm::Function::getEntryBlock</a></div><div class="ttdeci">const BasicBlock &amp; getEntryBlock() const </div><div class="ttdef"><b>Definition:</b> <a href="Function_8h_source.html#l00380">Function.h:380</a></div></div>
<div class="ttc" id="classllvm_1_1LoadInst_html_a2efd55778217d045b121de696c4f6452"><div class="ttname"><a href="classllvm_1_1LoadInst.html#a2efd55778217d045b121de696c4f6452">llvm::LoadInst::getPointerAddressSpace</a></div><div class="ttdeci">unsigned getPointerAddressSpace() const </div><div class="ttdoc">Returns the address space of the pointer operand. </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00228">Instructions.h:228</a></div></div>
<div class="ttc" id="classllvm_1_1User_html_a5fa9b8e1842b354f64c1ba6be0a4a17f"><div class="ttname"><a href="classllvm_1_1User.html#a5fa9b8e1842b354f64c1ba6be0a4a17f">llvm::User::setOperand</a></div><div class="ttdeci">void setOperand(unsigned i, Value *Val)</div><div class="ttdef"><b>Definition:</b> <a href="User_8h_source.html#l00092">User.h:92</a></div></div>
<div class="ttc" id="namespacellvm_html_a7c46c742c31be54870e2038048e6b391"><div class="ttname"><a href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">llvm::dbgs</a></div><div class="ttdeci">raw_ostream &amp; dbgs()</div><div class="ttdoc">dbgs - Return a circular-buffered debug stream. </div><div class="ttdef"><b>Definition:</b> <a href="Debug_8cpp_source.html#l00101">Debug.cpp:101</a></div></div>
<div class="ttc" id="classllvm_1_1VectorType_html"><div class="ttname"><a href="classllvm_1_1VectorType.html">llvm::VectorType</a></div><div class="ttdef"><b>Definition:</b> <a href="DerivedTypes_8h_source.html#l00358">DerivedTypes.h:358</a></div></div>
<div class="ttc" id="classllvm_1_1APInt_html"><div class="ttname"><a href="classllvm_1_1APInt.html">llvm::APInt</a></div><div class="ttdoc">Class for arbitrary precision integers. </div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l00075">APInt.h:75</a></div></div>
<div class="ttc" id="ScalarEvolution_8h_html"><div class="ttname"><a href="ScalarEvolution_8h.html">ScalarEvolution.h</a></div></div>
<div class="ttc" id="CodeGen_2README_8txt_html_a09776db24cf586ec9f1e18f3bae14099"><div class="ttname"><a href="CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a></div><div class="ttdeci">Common register allocation spilling lr str ldr sxth r3 ldr mla r4 can lr mov lr str ldr sxth r3 mla r4 and then merge mul and lr str ldr sxth r3 mla r4 It also increase the likelihood the store may become dead bb27 Successors according to LLVM BB</div><div class="ttdef"><b>Definition:</b> <a href="CodeGen_2README_8txt_source.html#l00036">CodeGen/README.txt:36</a></div></div>
<div class="ttc" id="classllvm_1_1PHINode_html_a21960167f529265a1cb02ac1e8ad10f6"><div class="ttname"><a href="classllvm_1_1PHINode.html#a21960167f529265a1cb02ac1e8ad10f6">llvm::PHINode::getIncomingValueForBlock</a></div><div class="ttdeci">Value * getIncomingValueForBlock(const BasicBlock *BB) const </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02139">Instructions.h:2139</a></div></div>
<div class="ttc" id="Pass_8h_html"><div class="ttname"><a href="Pass_8h.html">Pass.h</a></div></div>
<div class="ttc" id="classllvm_1_1Instruction_html_a5ac211f24970dea81fa9a7118a8ce36b"><div class="ttname"><a href="classllvm_1_1Instruction.html#a5ac211f24970dea81fa9a7118a8ce36b">llvm::Instruction::use_back</a></div><div class="ttdeci">Instruction * use_back()</div><div class="ttdef"><b>Definition:</b> <a href="Instruction_8h_source.html#l00049">Instruction.h:49</a></div></div>
<div class="ttc" id="namespacellvm_1_1APIntOps_html_a684cfe02c582e8d75cd6d457e63e6c25"><div class="ttname"><a href="namespacellvm_1_1APIntOps.html#a684cfe02c582e8d75cd6d457e63e6c25">llvm::APIntOps::And</a></div><div class="ttdeci">APInt And(const APInt &amp;LHS, const APInt &amp;RHS)</div><div class="ttdoc">Bitwise AND function for APInt. </div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l01840">APInt.h:1840</a></div></div>
<div class="ttc" id="classllvm_1_1SmallVectorTemplateCommon_html_a8a045d250952c0867382a9840ee18fdf"><div class="ttname"><a href="classllvm_1_1SmallVectorTemplateCommon.html#a8a045d250952c0867382a9840ee18fdf">llvm::SmallVectorTemplateCommon&lt; T &gt;::begin</a></div><div class="ttdeci">iterator begin()</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00112">SmallVector.h:112</a></div></div>
<div class="ttc" id="classllvm_1_1SmallSet_html_ab28aa342862f6d16361be514fd98c22e"><div class="ttname"><a href="classllvm_1_1SmallSet.html#ab28aa342862f6d16361be514fd98c22e">llvm::SmallSet::count</a></div><div class="ttdeci">bool count(const T &amp;V) const </div><div class="ttdoc">count - Return true if the element is in the set. </div><div class="ttdef"><b>Definition:</b> <a href="SmallSet_8h_source.html#l00048">SmallSet.h:48</a></div></div>
<div class="ttc" id="classllvm_1_1Value_html_a413abcab8dbc3900fc2fde96a5d8fca6"><div class="ttname"><a href="classllvm_1_1Value.html#a413abcab8dbc3900fc2fde96a5d8fca6">llvm::Value::use_begin</a></div><div class="ttdeci">use_iterator use_begin()</div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00150">Value.h:150</a></div></div>
<div class="ttc" id="AliasAnalysis_8h_html"><div class="ttname"><a href="AliasAnalysis_8h.html">AliasAnalysis.h</a></div></div>
<div class="ttc" id="classllvm_1_1cl_1_1opt_html"><div class="ttname"><a href="classllvm_1_1cl_1_1opt.html">llvm::cl::opt</a></div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l01149">CommandLine.h:1149</a></div></div>
<div class="ttc" id="namespacellvm_html_ad17df6f711037aaee99496571558475c"><div class="ttname"><a href="namespacellvm.html#ad17df6f711037aaee99496571558475c">llvm::initializeSLPVectorizerPass</a></div><div class="ttdeci">void initializeSLPVectorizerPass(PassRegistry &amp;)</div></div>
<div class="ttc" id="classllvm_1_1SetVector_html_a0fd2953d62c1b1cabb87e420be5177c4"><div class="ttname"><a href="classllvm_1_1SetVector.html#a0fd2953d62c1b1cabb87e420be5177c4">llvm::SetVector::count</a></div><div class="ttdeci">size_type count(const key_type &amp;key) const </div><div class="ttdoc">Count the number of elements of a given key in the SetVector. </div><div class="ttdef"><b>Definition:</b> <a href="SetVector_8h_source.html#l00156">SetVector.h:156</a></div></div>
<div class="ttc" id="classllvm_1_1Function_html_a603f8f8d2c9d8de6762092830cf82b13"><div class="ttname"><a href="classllvm_1_1Function.html#a603f8f8d2c9d8de6762092830cf82b13">llvm::Function::hasFnAttribute</a></div><div class="ttdeci">bool hasFnAttribute(Attribute::AttrKind Kind) const </div><div class="ttdoc">Return true if the function has the attribute. </div><div class="ttdef"><b>Definition:</b> <a href="Function_8h_source.html#l00200">Function.h:200</a></div></div>
<div class="ttc" id="classllvm_1_1Type_html_a0a32c2cb0342323dc78f6aa31d7e581e"><div class="ttname"><a href="classllvm_1_1Type.html#a0a32c2cb0342323dc78f6aa31d7e581e">llvm::Type::isAggregateType</a></div><div class="ttdeci">bool isAggregateType() const </div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00270">Type.h:270</a></div></div>
<div class="ttc" id="classllvm_1_1SCEV_html"><div class="ttname"><a href="classllvm_1_1SCEV.html">llvm::SCEV</a></div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8h_source.html#l00057">ScalarEvolution.h:57</a></div></div>
<div class="ttc" id="Value_8h_html"><div class="ttname"><a href="Value_8h.html">Value.h</a></div></div>
<div class="ttc" id="namespacellvm_html_a31c465b4d456accd132c6dc332316b92"><div class="ttname"><a href="namespacellvm.html#a31c465b4d456accd132c6dc332316b92">llvm::po_end</a></div><div class="ttdeci">po_iterator&lt; T &gt; po_end(T G)</div><div class="ttdef"><b>Definition:</b> <a href="PostOrderIterator_8h_source.html#l00177">PostOrderIterator.h:177</a></div></div>
<div class="ttc" id="classllvm_1_1Loop_html"><div class="ttname"><a href="classllvm_1_1Loop.html">llvm::Loop</a></div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l00338">LoopInfo.h:338</a></div></div>
<div class="ttc" id="classllvm_1_1LoadInst_html_ad1168fc42bcba1b71217a4969483671a"><div class="ttname"><a href="classllvm_1_1LoadInst.html#ad1168fc42bcba1b71217a4969483671a">llvm::LoadInst::getAlignment</a></div><div class="ttdeci">unsigned getAlignment() const </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00181">Instructions.h:181</a></div></div>
<div class="ttc" id="classllvm_1_1TargetTransformInfo_html_a58c65bee90b0fead29b2293c4ed69f88"><div class="ttname"><a href="classllvm_1_1TargetTransformInfo.html#a58c65bee90b0fead29b2293c4ed69f88">llvm::TargetTransformInfo::getReductionCost</a></div><div class="ttdeci">virtual unsigned getReductionCost(unsigned Opcode, Type *Ty, bool IsPairwiseForm) const </div><div class="ttdoc">Calculate the cost of performing a vector reduction. </div><div class="ttdef"><b>Definition:</b> <a href="TargetTransformInfo_8cpp_source.html#l00227">TargetTransformInfo.cpp:227</a></div></div>
<div class="ttc" id="MD5_8cpp_html_ac0eafdc9ee161b71e7af98af736952fd"><div class="ttname"><a href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a></div><div class="ttdeci">#define I(x, y, z)</div><div class="ttdef"><b>Definition:</b> <a href="MD5_8cpp_source.html#l00054">MD5.cpp:54</a></div></div>
<div class="ttc" id="classllvm_1_1BasicBlock_html_a5cb76a65b6524dba1493dd2b9dc3abbe"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a5cb76a65b6524dba1493dd2b9dc3abbe">llvm::BasicBlock::getTerminator</a></div><div class="ttdeci">TerminatorInst * getTerminator()</div><div class="ttdoc">Returns the terminator instruction if the block is well formed or null if the block is not well forme...</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8cpp_source.html#l00120">BasicBlock.cpp:120</a></div></div>
<div class="ttc" id="classllvm_1_1Value_html_a085b82f074c28030fb8e194377ed2d0c"><div class="ttname"><a href="classllvm_1_1Value.html#a085b82f074c28030fb8e194377ed2d0c">llvm::Value::hasOneUse</a></div><div class="ttdeci">bool hasOneUse() const </div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00161">Value.h:161</a></div></div>
<div class="ttc" id="structllvm_1_1AliasAnalysis_1_1Location_html_a24197872686f605dcfd25b6e5d3cc7fa"><div class="ttname"><a href="structllvm_1_1AliasAnalysis_1_1Location.html#a24197872686f605dcfd25b6e5d3cc7fa">llvm::AliasAnalysis::Location::Ptr</a></div><div class="ttdeci">const Value * Ptr</div><div class="ttdoc">Ptr - The address of the start of the location. </div><div class="ttdef"><b>Definition:</b> <a href="AliasAnalysis_8h_source.html#l00108">AliasAnalysis.h:108</a></div></div>
<div class="ttc" id="classllvm_1_1ExtractElementInst_html"><div class="ttname"><a href="classllvm_1_1ExtractElementInst.html">llvm::ExtractElementInst</a></div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l01542">Instructions.h:1542</a></div></div>
<div class="ttc" id="classllvm_1_1SmallVectorTemplateBase_html_a1f2303df9bbee2233c11d61c2f6f7930"><div class="ttname"><a href="classllvm_1_1SmallVectorTemplateBase.html#a1f2303df9bbee2233c11d61c2f6f7930">llvm::SmallVectorTemplateBase&lt; T, isPodLike&lt; T &gt;::value &gt;::pop_back</a></div><div class="ttdeci">void pop_back()</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00260">SmallVector.h:260</a></div></div>
<div class="ttc" id="ValueTracking_8h_html"><div class="ttname"><a href="ValueTracking_8h.html">ValueTracking.h</a></div></div>
<div class="ttc" id="classllvm_1_1TargetTransformInfo_html_afa38851d75434d1476444ac93f94cb4ca76d8855d96b8e66b9411ed74737ca8f7"><div class="ttname"><a href="classllvm_1_1TargetTransformInfo.html#afa38851d75434d1476444ac93f94cb4ca76d8855d96b8e66b9411ed74737ca8f7">llvm::TargetTransformInfo::OK_UniformConstantValue</a></div><div class="ttdef"><b>Definition:</b> <a href="TargetTransformInfo_8h_source.html#l00321">TargetTransformInfo.h:321</a></div></div>
<div class="ttc" id="namespacellvm_html_a6a84483f8f0bece492d8083c524db5c0"><div class="ttname"><a href="namespacellvm.html#a6a84483f8f0bece492d8083c524db5c0">llvm::createSLPVectorizerPass</a></div><div class="ttdeci">Pass * createSLPVectorizerPass()</div><div class="ttdef"><b>Definition:</b> <a href="SLPVectorizer_8cpp_source.html#l02664">SLPVectorizer.cpp:2664</a></div></div>
<div class="ttc" id="IRBuilder_8h_html"><div class="ttname"><a href="IRBuilder_8h.html">IRBuilder.h</a></div></div>
<div class="ttc" id="SetVector_8h_html"><div class="ttname"><a href="SetVector_8h.html">SetVector.h</a></div></div>
<div class="ttc" id="classllvm_1_1Value_html_ac38c53f76ef532f91f1666c8a87370e9"><div class="ttname"><a href="classllvm_1_1Value.html#ac38c53f76ef532f91f1666c8a87370e9">llvm::Value::use_empty</a></div><div class="ttdeci">bool use_empty() const </div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00149">Value.h:149</a></div></div>
<div class="ttc" id="SLPVectorizer_8cpp_html_a5ce679c74f9d5aa21d8ea3d1a798f0a9"><div class="ttname"><a href="SLPVectorizer_8cpp.html#a5ce679c74f9d5aa21d8ea3d1a798f0a9">lv_name</a></div><div class="ttdeci">static const char lv_name[]</div><div class="ttdef"><b>Definition:</b> <a href="SLPVectorizer_8cpp_source.html#l02655">SLPVectorizer.cpp:2655</a></div></div>
<div class="ttc" id="classllvm_1_1Value_html"><div class="ttname"><a href="classllvm_1_1Value.html">llvm::Value</a></div><div class="ttdoc">LLVM Value Representation. </div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00066">Value.h:66</a></div></div>
<div class="ttc" id="classllvm_1_1StoreInst_html_a50d3891cd26db1308e81540f468de8c8"><div class="ttname"><a href="classllvm_1_1StoreInst.html#a50d3891cd26db1308e81540f468de8c8">llvm::StoreInst::setAlignment</a></div><div class="ttdeci">void setAlignment(unsigned Align)</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8cpp_source.html#l01204">Instructions.cpp:1204</a></div></div>
<div class="ttc" id="classllvm_1_1SetVector_html_a9ceb97666ed8de600fb9520a563ff95d"><div class="ttname"><a href="classllvm_1_1SetVector.html#a9ceb97666ed8de600fb9520a563ff95d">llvm::SetVector::iterator</a></div><div class="ttdeci">vector_type::const_iterator iterator</div><div class="ttdef"><b>Definition:</b> <a href="SetVector_8h_source.html#l00045">SetVector.h:45</a></div></div>
<div class="ttc" id="classllvm_1_1Instruction_html_a021bb7c9aad6003fe8089f6327356c6c"><div class="ttname"><a href="classllvm_1_1Instruction.html#a021bb7c9aad6003fe8089f6327356c6c">llvm::Instruction::getOpcode</a></div><div class="ttdeci">unsigned getOpcode() const </div><div class="ttdoc">getOpcode() returns a member of one of the enums like Instruction::Add. </div><div class="ttdef"><b>Definition:</b> <a href="Instruction_8h_source.html#l00083">Instruction.h:83</a></div></div>
<div class="ttc" id="PostOrderIterator_8h_html"><div class="ttname"><a href="PostOrderIterator_8h.html">PostOrderIterator.h</a></div></div>
<div class="ttc" id="classllvm_1_1SetVector_html"><div class="ttname"><a href="classllvm_1_1SetVector.html">llvm::SetVector</a></div><div class="ttdoc">A vector that has set insertion semantics. </div><div class="ttdef"><b>Definition:</b> <a href="SetVector_8h_source.html#l00037">SetVector.h:37</a></div></div>
<div class="ttc" id="classllvm_1_1VectorType_html_ab43657ed1abe2e2ed3a6a394f233ebd0"><div class="ttname"><a href="classllvm_1_1VectorType.html#ab43657ed1abe2e2ed3a6a394f233ebd0">llvm::VectorType::get</a></div><div class="ttdeci">static VectorType * get(Type *ElementType, unsigned NumElements)</div><div class="ttdef"><b>Definition:</b> <a href="Type_8cpp_source.html#l00706">Type.cpp:706</a></div></div>
<div class="ttc" id="classllvm_1_1Attribute_html_aab7ee4b8fd1d3e7e4cea87868855e60ea9e330fa070dd4bb79cbc6c74b41958a4"><div class="ttname"><a href="classllvm_1_1Attribute.html#aab7ee4b8fd1d3e7e4cea87868855e60ea9e330fa070dd4bb79cbc6c74b41958a4">llvm::Attribute::NoImplicitFloat</a></div><div class="ttdoc">Disable implicit floating point insts. </div><div class="ttdef"><b>Definition:</b> <a href="Attributes_8h_source.html#l00084">Attributes.h:84</a></div></div>
<div class="ttc" id="BasicAliasAnalysis_8cpp_html_a2675de1d8479c7b00387979714da43f7"><div class="ttname"><a href="BasicAliasAnalysis_8cpp.html#a2675de1d8479c7b00387979714da43f7">getParent</a></div><div class="ttdeci">static const Function * getParent(const Value *V)</div><div class="ttdef"><b>Definition:</b> <a href="BasicAliasAnalysis_8cpp_source.html#l00447">BasicAliasAnalysis.cpp:447</a></div></div>
<div class="ttc" id="classllvm_1_1Instruction_html_af67d1f3a518964d80a109bb3d9d5cf1e"><div class="ttname"><a href="classllvm_1_1Instruction.html#af67d1f3a518964d80a109bb3d9d5cf1e">llvm::Instruction::moveBefore</a></div><div class="ttdeci">void moveBefore(Instruction *MovePos)</div><div class="ttdef"><b>Definition:</b> <a href="Instruction_8cpp_source.html#l00091">Instruction.cpp:91</a></div></div>
<div class="ttc" id="classllvm_1_1TargetTransformInfo_html_af46433d0e36d3f80afc3a8c67b5c53ecab1ac8982cdb119f39a5fe74610a46796"><div class="ttname"><a href="classllvm_1_1TargetTransformInfo.html#af46433d0e36d3f80afc3a8c67b5c53ecab1ac8982cdb119f39a5fe74610a46796">llvm::TargetTransformInfo::SK_Broadcast</a></div><div class="ttdoc">Broadcast element 0 to all other elements. </div><div class="ttdef"><b>Definition:</b> <a href="TargetTransformInfo_8h_source.html#l00311">TargetTransformInfo.h:311</a></div></div>
<div class="ttc" id="classllvm_1_1DataLayout_html_add914112e0b2935dda06ad5dfd3a31db"><div class="ttname"><a href="classllvm_1_1DataLayout.html#add914112e0b2935dda06ad5dfd3a31db">llvm::DataLayout::getTypeSizeInBits</a></div><div class="ttdeci">uint64_t getTypeSizeInBits(Type *Ty) const </div><div class="ttdef"><b>Definition:</b> <a href="DataLayout_8h_source.html#l00459">DataLayout.h:459</a></div></div>
<div class="ttc" id="namespacellvm_html_a7923e3e207de8bc1d0d6a5091316ddde"><div class="ttname"><a href="namespacellvm.html#a7923e3e207de8bc1d0d6a5091316ddde">llvm::prior</a></div><div class="ttdeci">ItTy prior(ItTy it, Dist n)</div><div class="ttdef"><b>Definition:</b> <a href="STLExtras_8h_source.html#l00167">STLExtras.h:167</a></div></div>
<div class="ttc" id="Debug_8h_html_aef41e8aaf4c60819b30faf396cdf4978"><div class="ttname"><a href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a></div><div class="ttdeci">#define DEBUG(X)</div><div class="ttdef"><b>Definition:</b> <a href="Debug_8h_source.html#l00097">Debug.h:97</a></div></div>
<div class="ttc" id="namespacellvm_html_af4d1a918800291e75b01ce1447be0e83"><div class="ttname"><a href="namespacellvm.html#af4d1a918800291e75b01ce1447be0e83">llvm::isPowerOf2_32</a></div><div class="ttdeci">bool isPowerOf2_32(uint32_t Value)</div><div class="ttdef"><b>Definition:</b> <a href="MathExtras_8h_source.html#l00354">MathExtras.h:354</a></div></div>
<div class="ttc" id="classllvm_1_1FastMathFlags_html"><div class="ttname"><a href="classllvm_1_1FastMathFlags.html">llvm::FastMathFlags</a></div><div class="ttdoc">Convenience struct for specifying and reasoning about fast-math flags. </div><div class="ttdef"><b>Definition:</b> <a href="Operator_8h_source.html#l00170">Operator.h:170</a></div></div>
<div class="ttc" id="classllvm_1_1TargetTransformInfo_html_afa38851d75434d1476444ac93f94cb4c"><div class="ttname"><a href="classllvm_1_1TargetTransformInfo.html#afa38851d75434d1476444ac93f94cb4c">llvm::TargetTransformInfo::OperandValueKind</a></div><div class="ttdeci">OperandValueKind</div><div class="ttdoc">Additional information about an operand&amp;#39;s possible values. </div><div class="ttdef"><b>Definition:</b> <a href="TargetTransformInfo_8h_source.html#l00318">TargetTransformInfo.h:318</a></div></div>
<div class="ttc" id="raw__ostream_8h_html"><div class="ttname"><a href="raw__ostream_8h.html">raw_ostream.h</a></div></div>
<div class="ttc" id="TargetTransformInfo_8h_html"><div class="ttname"><a href="TargetTransformInfo_8h.html">TargetTransformInfo.h</a></div></div>
<div class="ttc" id="namespacellvm_1_1lltok_html_af353621f14cb4b4b3af5ffaff84076b1abf5ba3ee47e95dae362eb24b6d4f48e5"><div class="ttname"><a href="namespacellvm_1_1lltok.html#af353621f14cb4b4b3af5ffaff84076b1abf5ba3ee47e95dae362eb24b6d4f48e5">llvm::lltok::equal</a></div><div class="ttdef"><b>Definition:</b> <a href="LLToken_8h_source.html#l00025">LLToken.h:25</a></div></div>
<div class="ttc" id="namespacellvm_1_1SPII_html_a11e9b8fca4a074643a6a21f444e51406a36b3dd3b84fde3f8494a9b18af131856"><div class="ttname"><a href="namespacellvm_1_1SPII.html#a11e9b8fca4a074643a6a21f444e51406a36b3dd3b84fde3f8494a9b18af131856">llvm::SPII::Store</a></div><div class="ttdef"><b>Definition:</b> <a href="SparcInstrInfo_8h_source.html#l00032">SparcInstrInfo.h:32</a></div></div>
<div class="ttc" id="classllvm_1_1TargetTransformInfo_html_ae6a7e3b0f332156aa068e2c78efbf73a"><div class="ttname"><a href="classllvm_1_1TargetTransformInfo.html#ae6a7e3b0f332156aa068e2c78efbf73a">llvm::TargetTransformInfo::getArithmeticInstrCost</a></div><div class="ttdeci">virtual unsigned getArithmeticInstrCost(unsigned Opcode, Type *Ty, OperandValueKind Opd1Info=OK_AnyValue, OperandValueKind Opd2Info=OK_AnyValue) const </div><div class="ttdef"><b>Definition:</b> <a href="TargetTransformInfo_8cpp_source.html#l00173">TargetTransformInfo.cpp:173</a></div></div>
<div class="ttc" id="classllvm_1_1MDNode_html_a9d9f2d817781a31c771406d1f0acc9fb"><div class="ttname"><a href="classllvm_1_1MDNode.html#a9d9f2d817781a31c771406d1f0acc9fb">llvm::MDNode::getMostGenericFPMath</a></div><div class="ttdeci">static MDNode * getMostGenericFPMath(MDNode *A, MDNode *B)</div><div class="ttdef"><b>Definition:</b> <a href="Metadata_8cpp_source.html#l00408">Metadata.cpp:408</a></div></div>
<div class="ttc" id="Target_2ARM_2README_8txt_html_a90cca76dd78688687e0d697679dbc799"><div class="ttname"><a href="Target_2ARM_2README_8txt.html#a90cca76dd78688687e0d697679dbc799">B</a></div><div class="ttdeci">compiles ldr LCPI1_0 ldr ldr mov lsr tst moveq r1 ldr LCPI1_1 and r0 bx lr It would be better to do something like to fold the shift into the conditional ldr LCPI1_0 ldr ldr tst movne lsr ldr LCPI1_1 and r0 bx lr it saves an instruction and a register It might be profitable to cse MOVi16 if there are lots of bit immediates with the same bottom half Robert Muth started working on an alternate jump table implementation that does not put the tables in line in the text This is more like the llvm default jump table implementation This might be useful sometime Several revisions of patches are on the mailing beginning while CMP sets them like a subtract Therefore to be able to use CMN for comparisons other than the Z we ll need additional logic to reverse the conditionals associated with the comparison Perhaps a pseudo instruction for the with a post codegen pass to clean up and handle the condition codes See PR5694 for testcase Given the following on int B</div><div class="ttdef"><b>Definition:</b> <a href="Target_2ARM_2README_8txt_source.html#l00592">Target/ARM/README.txt:592</a></div></div>
<div class="ttc" id="classllvm_1_1StoreInst_html_ac03c1c093059ea000216af8dd6f2dbf4"><div class="ttname"><a href="classllvm_1_1StoreInst.html#ac03c1c093059ea000216af8dd6f2dbf4">llvm::StoreInst::getPointerOperand</a></div><div class="ttdeci">Value * getPointerOperand()</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00346">Instructions.h:346</a></div></div>
<div class="ttc" id="namespacellvm_html_a6569d00d31a5d74e563e2f39f82271ab"><div class="ttname"><a href="namespacellvm.html#a6569d00d31a5d74e563e2f39f82271ab">llvm::X</a></div><div class="ttdeci">static RegisterPass&lt; NVPTXAllocaHoisting &gt; X(&quot;alloca-hoisting&quot;,&quot;Hoisting alloca instructions in non-entry &quot;&quot;blocks to the entry block&quot;)</div></div>
<div class="ttc" id="classllvm_1_1Instruction_html_a9cd49851904f15060edb782ef4dd1b2d"><div class="ttname"><a href="classllvm_1_1Instruction.html#a9cd49851904f15060edb782ef4dd1b2d">llvm::Instruction::getParent</a></div><div class="ttdeci">const BasicBlock * getParent() const </div><div class="ttdef"><b>Definition:</b> <a href="Instruction_8h_source.html#l00052">Instruction.h:52</a></div></div>
<div class="ttc" id="README-SSE_8txt_html_abb4ce3bc3096a12d4b93460bf78bcf95"><div class="ttname"><a href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a></div><div class="ttdeci">into xmm2 addss xmm2 xmm1 xmm3 addss xmm3 movaps xmm0 unpcklps xmm0 ret seems silly when it could just be one addps Expand libm rounding functions main should enable SSE DAZ mode and other fast SSE modes Think about doing i64 math in SSE regs on x86 This testcase should have no SSE instructions in it</div><div class="ttdef"><b>Definition:</b> <a href="README-SSE_8txt_source.html#l00053">README-SSE.txt:53</a></div></div>
<div class="ttc" id="classllvm_1_1Type_html_af5c7041df3ad5edffe5da17b5264c1fc"><div class="ttname"><a href="classllvm_1_1Type.html#af5c7041df3ad5edffe5da17b5264c1fc">llvm::Type::isVoidTy</a></div><div class="ttdeci">bool isVoidTy() const </div><div class="ttdoc">isVoidTy - Return true if this is &amp;#39;void&amp;#39;. </div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00140">Type.h:140</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<hr>
<p class="footer">
Generated on Sat Nov 10 2018 23:02:14 for <a href="http://llvm.org/">LLVM</a> by
<a href="http://www.doxygen.org"><img src="doxygen.png" alt="Doxygen"
align="middle" border="0"/>1.8.11</a><br>
Copyright &copy; 2003-2013 University of Illinois at Urbana-Champaign.
All Rights Reserved.</p>
<hr>
<!--#include virtual="/attrib.incl" -->
</body>
</html>
