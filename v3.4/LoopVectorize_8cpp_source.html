<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head>
<meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1"/>
<meta name="keywords" content="LLVM,Low Level Virtual Machine,C++,doxygen,API,documentation"/>
<meta name="description" content="C++ source code API documentation for LLVM."/>
<title>LLVM: LoopVectorize.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head><body>
<p class="title">LLVM API Documentation</p>
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('LoopVectorize_8cpp_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">LoopVectorize.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="LoopVectorize_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//===- LoopVectorize.cpp - A Loop Vectorizer ------------------------------===//</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">//                     The LLVM Compiler Infrastructure</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// This file is distributed under the University of Illinois Open Source</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">// License. See LICENSE.TXT for details.</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">// This is the LLVM loop vectorizer. This pass modifies &#39;vectorizable&#39; loops</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">// and generates target-independent LLVM-IR.</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">// The vectorizer uses the TargetTransformInfo analysis to estimate the costs</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">// of instructions in order to estimate the profitability of vectorization.</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">// The loop vectorizer combines consecutive loop iterations into a single</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">// &#39;wide&#39; iteration. After this transformation the index is incremented</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">// by the SIMD vector width, and not by one.</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">// This pass has three parts:</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">// 1. The main loop pass that drives the different parts.</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">// 2. LoopVectorizationLegality - A unit that checks for the legality</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">//    of the vectorization.</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">// 3. InnerLoopVectorizer - A unit that performs the actual</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">//    widening of instructions.</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">// 4. LoopVectorizationCostModel - A unit that checks for the profitability</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">//    of vectorization. It decides on the optimal vector width, which</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">//    can be one, if vectorization is not profitable.</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">// The reduction-variable vectorization is based on the paper:</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">//  D. Nuzman and R. Henderson. Multi-platform Auto-vectorization.</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">// Variable uniformity checks are inspired by:</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">//  Karrenberg, R. and Hack, S. Whole Function Vectorization.</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">// Other ideas/concepts are from:</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">//  A. Zaks and D. Nuzman. Autovectorization in GCC-two years later.</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">//  S. Maleki, Y. Gao, M. Garzaran, T. Wong and D. Padua.  An Evaluation of</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">//  Vectorizing Compilers.</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;</div><div class="line"><a name="l00045"></a><span class="lineno"><a class="line" href="LoopVectorize_8cpp.html#a0eff4a8bccb143ae91e197e6a59d4692">   45</a></span>&#160;<span class="preprocessor">#define LV_NAME &quot;loop-vectorize&quot;</span></div><div class="line"><a name="l00046"></a><span class="lineno"><a class="line" href="LoopVectorize_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">   46</a></span>&#160;<span class="preprocessor">#define DEBUG_TYPE LV_NAME</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Transforms_2Vectorize_8h.html">llvm/Transforms/Vectorize.h</a>&quot;</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="DenseMap_8h.html">llvm/ADT/DenseMap.h</a>&quot;</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="EquivalenceClasses_8h.html">llvm/ADT/EquivalenceClasses.h</a>&quot;</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Hashing_8h.html">llvm/ADT/Hashing.h</a>&quot;</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="MapVector_8h.html">llvm/ADT/MapVector.h</a>&quot;</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="SetVector_8h.html">llvm/ADT/SetVector.h</a>&quot;</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="SmallPtrSet_8h.html">llvm/ADT/SmallPtrSet.h</a>&quot;</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="SmallSet_8h.html">llvm/ADT/SmallSet.h</a>&quot;</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="SmallVector_8h.html">llvm/ADT/SmallVector.h</a>&quot;</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="StringExtras_8h.html">llvm/ADT/StringExtras.h</a>&quot;</span></div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="AliasAnalysis_8h.html">llvm/Analysis/AliasAnalysis.h</a>&quot;</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Dominators_8h.html">llvm/Analysis/Dominators.h</a>&quot;</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="LoopInfo_8h.html">llvm/Analysis/LoopInfo.h</a>&quot;</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="LoopIterator_8h.html">llvm/Analysis/LoopIterator.h</a>&quot;</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="LoopPass_8h.html">llvm/Analysis/LoopPass.h</a>&quot;</span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ScalarEvolution_8h.html">llvm/Analysis/ScalarEvolution.h</a>&quot;</span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ScalarEvolutionExpander_8h.html">llvm/Analysis/ScalarEvolutionExpander.h</a>&quot;</span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ScalarEvolutionExpressions_8h.html">llvm/Analysis/ScalarEvolutionExpressions.h</a>&quot;</span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TargetTransformInfo_8h.html">llvm/Analysis/TargetTransformInfo.h</a>&quot;</span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ValueTracking_8h.html">llvm/Analysis/ValueTracking.h</a>&quot;</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Verifier_8h.html">llvm/Analysis/Verifier.h</a>&quot;</span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Constants_8h.html">llvm/IR/Constants.h</a>&quot;</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="DataLayout_8h.html">llvm/IR/DataLayout.h</a>&quot;</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="DerivedTypes_8h.html">llvm/IR/DerivedTypes.h</a>&quot;</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Function_8h.html">llvm/IR/Function.h</a>&quot;</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="IRBuilder_8h.html">llvm/IR/IRBuilder.h</a>&quot;</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Instructions_8h.html">llvm/IR/Instructions.h</a>&quot;</span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="IntrinsicInst_8h.html">llvm/IR/IntrinsicInst.h</a>&quot;</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="LLVMContext_8h.html">llvm/IR/LLVMContext.h</a>&quot;</span></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Module_8h.html">llvm/IR/Module.h</a>&quot;</span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Type_8h.html">llvm/IR/Type.h</a>&quot;</span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Value_8h.html">llvm/IR/Value.h</a>&quot;</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Pass_8h.html">llvm/Pass.h</a>&quot;</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="CommandLine_8h.html">llvm/Support/CommandLine.h</a>&quot;</span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Debug_8h.html">llvm/Support/Debug.h</a>&quot;</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="PatternMatch_8h.html">llvm/Support/PatternMatch.h</a>&quot;</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="raw__ostream_8h.html">llvm/Support/raw_ostream.h</a>&quot;</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ValueHandle_8h.html">llvm/Support/ValueHandle.h</a>&quot;</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TargetLibraryInfo_8h.html">llvm/Target/TargetLibraryInfo.h</a>&quot;</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Transforms_2Scalar_8h.html">llvm/Transforms/Scalar.h</a>&quot;</span></div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="BasicBlockUtils_8h.html">llvm/Transforms/Utils/BasicBlockUtils.h</a>&quot;</span></div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Local_8h.html">llvm/Transforms/Utils/Local.h</a>&quot;</span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="preprocessor">#include &lt;algorithm&gt;</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="preprocessor">#include &lt;map&gt;</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespacellvm.html">llvm</a>;</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespacellvm_1_1PatternMatch.html">llvm::PatternMatch</a>;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;unsigned&gt;</a></div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<a class="code" href="LoopVectorize_8cpp.html#a7db5de6d612f2730abd7aa99a724615a">VectorizationFactor</a>(<span class="stringliteral">&quot;force-vector-width&quot;</span>, <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(0), <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>,</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;                    <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Sets the SIMD width. Zero is autoselect.&quot;</span>));</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;unsigned&gt;</a></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<a class="code" href="LoopVectorize_8cpp.html#af303907f5edd23d696cb2af21c6fec66">VectorizationUnroll</a>(<span class="stringliteral">&quot;force-vector-unroll&quot;</span>, <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(0), <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>,</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                    <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Sets the vectorization unroll count. &quot;</span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;                             <span class="stringliteral">&quot;Zero is autoselect.&quot;</span>));</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;bool&gt;</a></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<a class="code" href="LoopVectorize_8cpp.html#ab10ac4a80fce310e0fa7c74066153ebc">EnableIfConversion</a>(<span class="stringliteral">&quot;enable-if-conversion&quot;</span>, <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(<span class="keyword">true</span>), <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>,</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;                   <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Enable if-conversion during vectorization.&quot;</span>));</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment">/// We don&#39;t vectorize loops with a known constant trip count below this number.</span></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment"></span><span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;unsigned&gt;</a></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<a class="code" href="LoopVectorize_8cpp.html#a5318ba92781fc5fa3e26483f058b470a">TinyTripCountVectorThreshold</a>(<span class="stringliteral">&quot;vectorizer-min-trip-count&quot;</span>, <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(16),</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;                             <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>,</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;                             <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Don&#39;t vectorize loops with a constant &quot;</span></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;                                      <span class="stringliteral">&quot;trip count that is smaller than this &quot;</span></div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                                      <span class="stringliteral">&quot;value.&quot;</span>));</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment">/// We don&#39;t unroll loops with a known constant trip count below this number.</span></div><div class="line"><a name="l00118"></a><span class="lineno"><a class="line" href="LoopVectorize_8cpp.html#ad06e389b36de2016de0913f2d112954d">  118</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <a class="code" href="LoopVectorize_8cpp.html#ad06e389b36de2016de0913f2d112954d">TinyTripCountUnrollThreshold</a> = 128;</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment">/// When performing memory disambiguation checks at runtime do not make more</span></div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment">/// than this number of comparisons.</span></div><div class="line"><a name="l00122"></a><span class="lineno"><a class="line" href="LoopVectorize_8cpp.html#a952c05caf05575f974ed5bf7c1cf305f">  122</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <a class="code" href="LoopVectorize_8cpp.html#a952c05caf05575f974ed5bf7c1cf305f">RuntimeMemoryCheckThreshold</a> = 8;</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment">/// Maximum simd width.</span></div><div class="line"><a name="l00125"></a><span class="lineno"><a class="line" href="LoopVectorize_8cpp.html#aa197dfdac853372e44c5dc91ffab03ea">  125</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <a class="code" href="LoopVectorize_8cpp.html#aa197dfdac853372e44c5dc91ffab03ea">MaxVectorWidth</a> = 64;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment">/// Maximum vectorization unroll count.</span></div><div class="line"><a name="l00128"></a><span class="lineno"><a class="line" href="LoopVectorize_8cpp.html#a3ef9112c12dac5ab9f2ca94868eed479">  128</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <a class="code" href="LoopVectorize_8cpp.html#a3ef9112c12dac5ab9f2ca94868eed479">MaxUnrollFactor</a> = 16;</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment">/// The cost of a loop that is considered &#39;small&#39; by the unroller.</span></div><div class="line"><a name="l00131"></a><span class="lineno"><a class="line" href="LoopVectorize_8cpp.html#a4888997ffd62d30edefde5170b33f854">  131</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <a class="code" href="LoopVectorize_8cpp.html#a4888997ffd62d30edefde5170b33f854">SmallLoopCost</a> = 20;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="keyword">namespace </span>{</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment">// Forward declarations.</span></div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="keyword">class </span>LoopVectorizationLegality;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="keyword">class </span>LoopVectorizationCostModel;</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment">/// InnerLoopVectorizer vectorizes loops which contain only one basic</span></div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment">/// block to a specified vectorization factor (VF).</span></div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment">/// This class performs the widening of scalars into vectors, or multiple</span></div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment">/// scalars. This class also implements the following features:</span></div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment">/// * It inserts an epilogue loop for handling loops that don&#39;t have iteration</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment">///   counts that are known to be a multiple of the vectorization factor.</span></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment">/// * It handles the code generation for reduction variables.</span></div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment">/// * Scalarization (implementation using scalars) of un-vectorizable</span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment">///   instructions.</span></div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment">/// InnerLoopVectorizer does not perform any vectorization-legality</span></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment">/// checks, and relies on the caller to check for the different legality</span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment">/// aspects. The InnerLoopVectorizer relies on the</span></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment">/// LoopVectorizationLegality class to provide information about the induction</span></div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment">/// and reduction variables that were found to a given vectorization factor.</span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment"></span><span class="keyword">class </span>InnerLoopVectorizer {</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  InnerLoopVectorizer(<a class="code" href="classllvm_1_1Loop.html">Loop</a> *OrigLoop, <a class="code" href="classllvm_1_1ScalarEvolution.html">ScalarEvolution</a> *SE, <a class="code" href="classllvm_1_1LoopInfo.html">LoopInfo</a> *LI,</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                      <a class="code" href="classllvm_1_1DominatorTree.html">DominatorTree</a> *DT, <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> *DL,</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                      <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetLibraryInfo.html">TargetLibraryInfo</a> *TLI, <span class="keywordtype">unsigned</span> VecWidth,</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                      <span class="keywordtype">unsigned</span> UnrollFactor)</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;      : OrigLoop(OrigLoop), SE(SE), LI(LI), DT(DT), DL(DL), TLI(TLI),</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        VF(VecWidth), UF(UnrollFactor), Builder(SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#aa89f44fd7549e81b02f2be1be894f098">getContext</a>()), Induction(0),</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        OldInduction(0), WidenMap(UnrollFactor) {}</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  <span class="comment">// Perform the actual loop widening (vectorization).</span></div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  <span class="keywordtype">void</span> vectorize(LoopVectorizationLegality *Legal) {</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="comment">// Create a new empty loop. Unlink the old loop and connect the new one.</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    createEmptyLoop(Legal);</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="comment">// Widen each instruction in the old loop to a new one in the new loop.</span></div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="comment">// Use the Legality module to find the induction and reduction variables.</span></div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    vectorizeLoop(Legal);</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="comment">// Register the new loop and update the analysis passes.</span></div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    updateAnalysis();</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  }</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  <span class="keyword">virtual</span> ~InnerLoopVectorizer() {}</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="keyword">protected</span>:<span class="comment"></span></div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment">  /// A small list of PHINodes.</span></div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment"></span>  <span class="keyword">typedef</span> <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;PHINode*, 4&gt;</a> PhiVector;<span class="comment"></span></div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="comment">  /// When we unroll loops we have multiple vector values for each scalar.</span></div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="comment">  /// This data structure holds the unrolled and vectorized values that</span></div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="comment">  /// originated from one scalar instruction.</span></div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="comment"></span>  <span class="keyword">typedef</span> <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Value*, 2&gt;</a> VectorParts;</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  <span class="comment">// When we if-convert we need create edge masks. We have to cache values so</span></div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  <span class="comment">// that we don&#39;t end up with exponential recursion/IR.</span></div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  <span class="keyword">typedef</span> <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;std::pair&lt;BasicBlock*, BasicBlock*&gt;</a>,</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;                   VectorParts&gt; EdgeMaskCache;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="comment">  /// Add code that checks at runtime if the accessed arrays overlap.</span></div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment">  /// Returns the comparator value or NULL if no check is needed.</span></div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *addRuntimeCheck(LoopVectorizationLegality *Legal,</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;                               <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *Loc);<span class="comment"></span></div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment">  /// Create an empty loop, based on the loop ranges of the old loop.</span></div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> createEmptyLoop(LoopVectorizationLegality *Legal);<span class="comment"></span></div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="comment">  /// Copy and widen the instructions from the old loop.</span></div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment"></span>  <span class="keyword">virtual</span> <span class="keywordtype">void</span> vectorizeLoop(LoopVectorizationLegality *Legal);</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment">  /// \brief The Loop exit block may have single value PHI nodes where the</span></div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment">  /// incoming value is &#39;Undef&#39;. While vectorizing we only handled real values</span></div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment">  /// that were defined inside the loop. Here we fix the &#39;undef case&#39;.</span></div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment">  /// See PR14725.</span></div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> fixLCSSAPHIs();</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment">  /// A helper function that computes the predicate of the block BB, assuming</span></div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="comment">  /// that the header block of the loop is set to True. It returns the *entry*</span></div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="comment">  /// mask for the block BB.</span></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment"></span>  VectorParts createBlockInMask(<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>);<span class="comment"></span></div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment">  /// A helper function that computes the predicate of the edge between SRC</span></div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment">  /// and DST.</span></div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment"></span>  VectorParts createEdgeMask(<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *Src, <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *Dst);</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="comment">  /// A helper function to vectorize a single BB within the innermost loop.</span></div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> vectorizeBlockInLoop(LoopVectorizationLegality *Legal, <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *BB,</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                            PhiVector *PV);</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="comment">  /// Vectorize a single PHINode in a block. This method handles the induction</span></div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="comment">  /// variable canonicalization. It supports both VF = 1 for unrolled loops and</span></div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="comment">  /// arbitrary length vectors.</span></div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> widenPHIInstruction(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *PN, VectorParts &amp;Entry,</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                           LoopVectorizationLegality *Legal,</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                           <span class="keywordtype">unsigned</span> UF, <span class="keywordtype">unsigned</span> VF, PhiVector *PV);</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="comment">  /// Insert the new loop to the loop hierarchy and pass manager</span></div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="comment">  /// and update the analysis passes.</span></div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> updateAnalysis();</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="comment">  /// This instruction is un-vectorizable. Implement it as a sequence</span></div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="comment">  /// of scalars.</span></div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment"></span>  <span class="keyword">virtual</span> <span class="keywordtype">void</span> scalarizeInstruction(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *Instr);</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="comment">  /// Vectorize Load and Store instructions,</span></div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="comment"></span>  <span class="keyword">virtual</span> <span class="keywordtype">void</span> vectorizeMemoryInstruction(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *Instr,</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;                                  LoopVectorizationLegality *Legal);</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="comment">  /// Create a broadcast instruction. This method generates a broadcast</span></div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="comment">  /// instruction (shuffle) for loop invariant values and for the induction</span></div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="comment">  /// value. If this is the induction variable then we extend it to N, N+1, ...</span></div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="comment">  /// this is needed because each iteration in the loop corresponds to a SIMD</span></div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="comment">  /// element.</span></div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="comment"></span>  <span class="keyword">virtual</span> <a class="code" href="classllvm_1_1Value.html">Value</a> *getBroadcastInstrs(<a class="code" href="classllvm_1_1Value.html">Value</a> *V);</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="comment">  /// This function adds 0, 1, 2 ... to each vector element, starting at zero.</span></div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="comment">  /// If Negate is set then negative numbers are added e.g. (0, -1, -2, ...).</span></div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="comment">  /// The sequence starts at StartIndex.</span></div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="comment"></span>  <span class="keyword">virtual</span> <a class="code" href="classllvm_1_1Value.html">Value</a> *getConsecutiveVector(<a class="code" href="classllvm_1_1Value.html">Value</a>* Val, <span class="keywordtype">int</span> StartIdx, <span class="keywordtype">bool</span> Negate);</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="comment">  /// When we go over instructions in the basic block we rely on previous</span></div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="comment">  /// values within the current basic block or on loop invariant values.</span></div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="comment">  /// When we widen (vectorize) values we place them in the map. If the values</span></div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="comment">  /// are not within the map, they have to be loop invariant, so we simply</span></div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="comment">  /// broadcast them into a vector.</span></div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="comment"></span>  VectorParts &amp;getVectorValue(<a class="code" href="classllvm_1_1Value.html">Value</a> *V);</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="comment">  /// Generate a shuffle sequence that will reverse the vector Vec.</span></div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="comment"></span>  <span class="keyword">virtual</span> <a class="code" href="classllvm_1_1Value.html">Value</a> *reverseVector(<a class="code" href="classllvm_1_1Value.html">Value</a> *Vec);</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="comment">  /// This is a helper class that holds the vectorizer state. It maps scalar</span></div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="comment">  /// instructions to vector instructions. When the code is &#39;unrolled&#39; then</span></div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment">  /// then a single scalar value is mapped to multiple vector parts. The parts</span></div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment">  /// are stored in the VectorPart type.</span></div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment"></span>  <span class="keyword">struct </span><a class="code" href="classllvm_1_1ValueMap.html">ValueMap</a> {<span class="comment"></span></div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="comment">    /// C&#39;tor.  UnrollFactor controls the number of vectors (&#39;parts&#39;) that</span></div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="comment">    /// are mapped.</span></div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment"></span>    <a class="code" href="classllvm_1_1ValueMap.html">ValueMap</a>(<span class="keywordtype">unsigned</span> UnrollFactor) : UF(UnrollFactor) {}</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment">    /// \return True if &#39;Key&#39; is saved in the Value Map.</span></div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="comment"></span>    <span class="keywordtype">bool</span> has(<a class="code" href="classllvm_1_1Value.html">Value</a> *Key)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> MapStorage.count(Key); }</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="comment">    /// Initializes a new entry in the map. Sets all of the vector parts to the</span></div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="comment">    /// save value in &#39;Val&#39;.</span></div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="comment">    /// \return A reference to a vector with splat values.</span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="comment"></span>    VectorParts &amp;splat(<a class="code" href="classllvm_1_1Value.html">Value</a> *Key, <a class="code" href="classllvm_1_1Value.html">Value</a> *Val) {</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;      VectorParts &amp;Entry = MapStorage[Key];</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;      Entry.assign(UF, Val);</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;      <span class="keywordflow">return</span> Entry;</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    }</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="comment">    ///\return A reference to the value that is stored at &#39;Key&#39;.</span></div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="comment"></span>    VectorParts &amp;<span class="keyword">get</span>(<a class="code" href="classllvm_1_1Value.html">Value</a> *Key) {</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;      VectorParts &amp;Entry = MapStorage[Key];</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;      <span class="keywordflow">if</span> (Entry.empty())</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        Entry.resize(UF);</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;      assert(Entry.size() == UF);</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;      <span class="keywordflow">return</span> Entry;</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    }</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;  <span class="keyword">private</span>:<span class="comment"></span></div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="comment">    /// The unroll factor. Each entry in the map stores this number of vector</span></div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="comment">    /// elements.</span></div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="comment"></span>    <span class="keywordtype">unsigned</span> UF;</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="comment">    /// Map storage. We use std::map and not DenseMap because insertions to a</span></div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="comment">    /// dense map invalidates its iterators.</span></div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="comment"></span>    std::map&lt;Value *, VectorParts&gt; MapStorage;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  };</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="comment">  /// The original loop.</span></div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1Loop.html">Loop</a> *OrigLoop;<span class="comment"></span></div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment">  /// Scev analysis to use.</span></div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1ScalarEvolution.html">ScalarEvolution</a> *SE;<span class="comment"></span></div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="comment">  /// Loop Info.</span></div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1LoopInfo.html">LoopInfo</a> *LI;<span class="comment"></span></div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="comment">  /// Dominator Tree.</span></div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1DominatorTree.html">DominatorTree</a> *DT;<span class="comment"></span></div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="comment">  /// Data Layout.</span></div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> *DL;<span class="comment"></span></div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="comment">  /// Target Library Info.</span></div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="comment"></span>  <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetLibraryInfo.html">TargetLibraryInfo</a> *TLI;</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="comment">  /// The vectorization SIMD factor to use. Each vector will have this many</span></div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="comment">  /// vector elements.</span></div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="comment"></span>  <span class="keywordtype">unsigned</span> VF;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="keyword">protected</span>:<span class="comment"></span></div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="comment">  /// The vectorization unroll factor to use. Each scalar is vectorized to this</span></div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="comment">  /// many different vector instructions.</span></div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment"></span>  <span class="keywordtype">unsigned</span> UF;</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="comment">  /// The builder that we use</span></div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> Builder;</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;  <span class="comment">// --- Vectorization state ---</span></div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="comment">  /// The vector-loop preheader.</span></div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *LoopVectorPreHeader;<span class="comment"></span></div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="comment">  /// The scalar-loop preheader.</span></div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *LoopScalarPreHeader;<span class="comment"></span></div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="comment">  /// Middle Block between the vector and the scalar.</span></div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *LoopMiddleBlock;<span class="comment"></span></div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="comment">  ///The ExitBlock of the scalar loop.</span></div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *LoopExitBlock;<span class="comment"></span></div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="comment">  ///The vector loop body.</span></div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *LoopVectorBody;<span class="comment"></span></div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment">  ///The scalar loop body.</span></div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *LoopScalarBody;<span class="comment"></span></div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="comment">  /// A list of all bypass blocks. The first block is the entry of the loop.</span></div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;BasicBlock *, 4&gt;</a> LoopBypassBlocks;</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="comment">  /// The new Induction variable which was added to the new block.</span></div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *Induction;<span class="comment"></span></div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="comment">  /// The induction variable of the old basic block.</span></div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *OldInduction;<span class="comment"></span></div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="comment">  /// Holds the extended (to the widest induction type) start index.</span></div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1Value.html">Value</a> *ExtendedIdx;<span class="comment"></span></div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="comment">  /// Maps scalars to widened vectors.</span></div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1ValueMap.html">ValueMap</a> WidenMap;</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;  EdgeMaskCache MaskCache;</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;};</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="keyword">class </span>InnerLoopUnroller : <span class="keyword">public</span> InnerLoopVectorizer {</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;  InnerLoopUnroller(<a class="code" href="classllvm_1_1Loop.html">Loop</a> *OrigLoop, <a class="code" href="classllvm_1_1ScalarEvolution.html">ScalarEvolution</a> *SE, <a class="code" href="classllvm_1_1LoopInfo.html">LoopInfo</a> *LI,</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;                    <a class="code" href="classllvm_1_1DominatorTree.html">DominatorTree</a> *DT, <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> *DL,</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;                    <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetLibraryInfo.html">TargetLibraryInfo</a> *TLI, <span class="keywordtype">unsigned</span> UnrollFactor) :</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    InnerLoopVectorizer(OrigLoop, SE, LI, DT, DL, TLI, 1, UnrollFactor) { }</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="keyword">private</span>:</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span> scalarizeInstruction(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *Instr);</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span> vectorizeMemoryInstruction(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *Instr,</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;                                          LoopVectorizationLegality *Legal);</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;  <span class="keyword">virtual</span> <a class="code" href="classllvm_1_1Value.html">Value</a> *getBroadcastInstrs(<a class="code" href="classllvm_1_1Value.html">Value</a> *V);</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;  <span class="keyword">virtual</span> <a class="code" href="classllvm_1_1Value.html">Value</a> *getConsecutiveVector(<a class="code" href="classllvm_1_1Value.html">Value</a>* Val, <span class="keywordtype">int</span> StartIdx, <span class="keywordtype">bool</span> Negate);</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;  <span class="keyword">virtual</span> <a class="code" href="classllvm_1_1Value.html">Value</a> *reverseVector(<a class="code" href="classllvm_1_1Value.html">Value</a> *Vec);</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;};</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="comment">/// \brief Look for a meaningful debug location on the instruction or it&#39;s</span></div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="comment">/// operands.</span></div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="comment"></span><span class="keyword">static</span> <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *getDebugLocFromInstOrOperands(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;  <span class="keywordflow">if</span> (!I)</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>;</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;  <a class="code" href="classllvm_1_1DebugLoc.html">DebugLoc</a> Empty;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;  <span class="keywordflow">if</span> (I-&gt;<a class="code" href="classllvm_1_1Instruction.html#aab8e16a35183ce39aad394714087bcff">getDebugLoc</a>() != Empty)</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    <span class="keywordflow">return</span> I;</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Use.html">User::op_iterator</a> OI = I-&gt;<a class="code" href="classllvm_1_1User.html#a2eeb1c7ed1cfe403f2ae0470e36c07e2">op_begin</a>(), OE = I-&gt;<a class="code" href="classllvm_1_1User.html#af41f58e730804d10b91fcff39b035f74">op_end</a>(); OI != OE; ++OI) {</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *OpInst = dyn_cast&lt;Instruction&gt;(*OI))</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;      <span class="keywordflow">if</span> (OpInst-&gt;getDebugLoc() != Empty)</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;        <span class="keywordflow">return</span> OpInst;</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;  }</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>;</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;}</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="comment">/// \brief Set the debug location in the builder using the debug location in the</span></div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="comment">/// instruction.</span></div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">void</span> setDebugLocFromInst(<a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> &amp;<a class="code" href="Target_2ARM_2README_8txt.html#a90cca76dd78688687e0d697679dbc799">B</a>, <span class="keyword">const</span> <a class="code" href="classllvm_1_1Value.html">Value</a> *Ptr) {</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">const</span> <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *Inst = dyn_cast_or_null&lt;Instruction&gt;(Ptr))</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    B.<a class="code" href="classllvm_1_1IRBuilderBase.html#a571ae7ebae7038da7f6073efc65aaa50">SetCurrentDebugLocation</a>(Inst-&gt;getDebugLoc());</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    B.<a class="code" href="classllvm_1_1IRBuilderBase.html#a571ae7ebae7038da7f6073efc65aaa50">SetCurrentDebugLocation</a>(<a class="code" href="classllvm_1_1DebugLoc.html">DebugLoc</a>());</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;}</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="comment">/// LoopVectorizationLegality checks if it is legal to vectorize a loop, and</span></div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="comment">/// to what vectorization factor.</span></div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="comment">/// This class does not look at the profitability of vectorization, only the</span></div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;<span class="comment">/// legality. This class has two main kinds of checks:</span></div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="comment">/// * Memory checks - The code in canVectorizeMemory checks if vectorization</span></div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<span class="comment">///   will change the order of memory accesses in a way that will change the</span></div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="comment">///   correctness of the program.</span></div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="comment">/// * Scalars checks - The code in canVectorizeInstrs and canVectorizeMemory</span></div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="comment">/// checks for a number of different conditions, such as the availability of a</span></div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;<span class="comment">/// single induction variable, that all types are supported and vectorize-able,</span></div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;<span class="comment">/// etc. This code reflects the capabilities of InnerLoopVectorizer.</span></div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;<span class="comment">/// This class is also used by InnerLoopVectorizer for identifying</span></div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;<span class="comment">/// induction variable and the different reduction variables.</span></div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="comment"></span><span class="keyword">class </span>LoopVectorizationLegality {</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;  LoopVectorizationLegality(<a class="code" href="classllvm_1_1Loop.html">Loop</a> *L, <a class="code" href="classllvm_1_1ScalarEvolution.html">ScalarEvolution</a> *SE, <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> *DL,</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;                            <a class="code" href="classllvm_1_1DominatorTree.html">DominatorTree</a> *DT, <a class="code" href="classllvm_1_1TargetLibraryInfo.html">TargetLibraryInfo</a> *TLI)</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;      : TheLoop(L), SE(SE), DL(DL), DT(DT), TLI(TLI),</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;        Induction(0), WidestIndTy(0), HasFunNoNaNAttr(<span class="keyword">false</span>),</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;        MaxSafeDepDistBytes(-1U) {}</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;<span class="comment">  /// This enum represents the kinds of reductions that we support.</span></div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;<span class="comment"></span>  <span class="keyword">enum</span> ReductionKind {</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    RK_NoReduction, <span class="comment">///&lt; Not a reduction.</span></div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="comment"></span>    RK_IntegerAdd,  <span class="comment">///&lt; Sum of integers.</span></div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="comment"></span>    RK_IntegerMult, <span class="comment">///&lt; Product of integers.</span></div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;<span class="comment"></span>    RK_IntegerOr,   <span class="comment">///&lt; Bitwise or logical OR of numbers.</span></div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;<span class="comment"></span>    RK_IntegerAnd,  <span class="comment">///&lt; Bitwise or logical AND of numbers.</span></div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="comment"></span>    RK_IntegerXor,  <span class="comment">///&lt; Bitwise or logical XOR of numbers.</span></div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="comment"></span>    RK_IntegerMinMax, <span class="comment">///&lt; Min/max implemented in terms of select(cmp()).</span></div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="comment"></span>    RK_FloatAdd,    <span class="comment">///&lt; Sum of floats.</span></div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="comment"></span>    RK_FloatMult,   <span class="comment">///&lt; Product of floats.</span></div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="comment"></span>    RK_FloatMinMax  <span class="comment">///&lt; Min/max implemented in terms of select(cmp()).</span></div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="comment"></span>  };</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="comment">  /// This enum represents the kinds of inductions that we support.</span></div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<span class="comment"></span>  <span class="keyword">enum</span> InductionKind {</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    IK_NoInduction,         <span class="comment">///&lt; Not an induction variable.</span></div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;<span class="comment"></span>    IK_IntInduction,        <span class="comment">///&lt; Integer induction variable. Step = 1.</span></div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;<span class="comment"></span>    IK_ReverseIntInduction, <span class="comment">///&lt; Reverse int induction variable. Step = -1.</span></div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;<span class="comment"></span>    IK_PtrInduction,        <span class="comment">///&lt; Pointer induction var. Step = sizeof(elem).</span></div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;<span class="comment"></span>    IK_ReversePtrInduction  <span class="comment">///&lt; Reverse ptr indvar. Step = - sizeof(elem).</span></div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;<span class="comment"></span>  };</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;  <span class="comment">// This enum represents the kind of minmax reduction.</span></div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;  <span class="keyword">enum</span> MinMaxReductionKind {</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    MRK_Invalid,</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    MRK_UIntMin,</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    MRK_UIntMax,</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    MRK_SIntMin,</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    MRK_SIntMax,</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    MRK_FloatMin,</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    MRK_FloatMax</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;  };</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;<span class="comment">  /// This struct holds information about reduction variables.</span></div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="comment"></span>  <span class="keyword">struct </span>ReductionDescriptor {</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    ReductionDescriptor() : StartValue(0), LoopExitInstr(0),</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;      <a class="code" href="namespacellvm_1_1EngineKind.html#a9df47239a42cd9621ac26d9ecbd57441">Kind</a>(RK_NoReduction), MinMaxKind(MRK_Invalid) {}</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    ReductionDescriptor(<a class="code" href="classllvm_1_1Value.html">Value</a> *Start, <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *Exit, ReductionKind K,</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;                        MinMaxReductionKind MK)</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;        : StartValue(Start), LoopExitInstr(Exit), <a class="code" href="namespacellvm_1_1EngineKind.html#a9df47239a42cd9621ac26d9ecbd57441">Kind</a>(K), MinMaxKind(MK) {}</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    <span class="comment">// The starting value of the reduction.</span></div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    <span class="comment">// It does not have to be zero!</span></div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    <a class="code" href="classllvm_1_1TrackingVH.html">TrackingVH&lt;Value&gt;</a> StartValue;</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    <span class="comment">// The instruction who&#39;s value is used outside the loop.</span></div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *LoopExitInstr;</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    <span class="comment">// The kind of the reduction.</span></div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    ReductionKind <a class="code" href="namespacellvm_1_1EngineKind.html#a9df47239a42cd9621ac26d9ecbd57441">Kind</a>;</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    <span class="comment">// If this a min/max reduction the kind of reduction.</span></div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    MinMaxReductionKind MinMaxKind;</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;  };</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="comment">  /// This POD struct holds information about a potential reduction operation.</span></div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;<span class="comment"></span>  <span class="keyword">struct </span>ReductionInstDesc {</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    ReductionInstDesc(<span class="keywordtype">bool</span> IsRedux, <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *I) :</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;      IsReduction(IsRedux), PatternLastInst(I), MinMaxKind(MRK_Invalid) {}</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    ReductionInstDesc(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *I, MinMaxReductionKind K) :</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;      IsReduction(<span class="keyword">true</span>), PatternLastInst(I), MinMaxKind(K) {}</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    <span class="comment">// Is this instruction a reduction candidate.</span></div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    <span class="keywordtype">bool</span> IsReduction;</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    <span class="comment">// The last instruction in a min/max pattern (select of the select(icmp())</span></div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    <span class="comment">// pattern), or the current reduction instruction otherwise.</span></div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *PatternLastInst;</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    <span class="comment">// If this is a min/max pattern the comparison predicate.</span></div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    MinMaxReductionKind MinMaxKind;</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;  };</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;<span class="comment">  /// This struct holds information about the memory runtime legality</span></div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;<span class="comment">  /// check that a group of pointers do not overlap.</span></div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;<span class="comment"></span>  <span class="keyword">struct </span>RuntimePointerCheck {</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    RuntimePointerCheck() : Need(<span class="keyword">false</span>) {}</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;<span class="comment">    /// Reset the state of the pointer runtime information.</span></div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> reset() {</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;      Need = <span class="keyword">false</span>;</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;      Pointers.clear();</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;      Starts.clear();</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;      Ends.clear();</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;      IsWritePtr.clear();</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;      DependencySetId.clear();</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    }</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;<span class="comment">    /// Insert a pointer and calculate the start and end SCEVs.</span></div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> insert(<a class="code" href="classllvm_1_1ScalarEvolution.html">ScalarEvolution</a> *SE, <a class="code" href="classllvm_1_1Loop.html">Loop</a> *Lp, <a class="code" href="classllvm_1_1Value.html">Value</a> *Ptr, <span class="keywordtype">bool</span> WritePtr,</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;                <span class="keywordtype">unsigned</span> DepSetId);</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;<span class="comment">    /// This flag indicates if we need to add the runtime check.</span></div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;<span class="comment"></span>    <span class="keywordtype">bool</span> Need;<span class="comment"></span></div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;<span class="comment">    /// Holds the pointers that we need to check.</span></div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;<span class="comment"></span>    <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;TrackingVH&lt;Value&gt;</a>, 2&gt; Pointers;<span class="comment"></span></div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;<span class="comment">    /// Holds the pointer value at the beginning of the loop.</span></div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;<span class="comment"></span>    <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;const SCEV*, 2&gt;</a> Starts;<span class="comment"></span></div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;<span class="comment">    /// Holds the pointer value at the end of the loop.</span></div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;<span class="comment"></span>    <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;const SCEV*, 2&gt;</a> Ends;<span class="comment"></span></div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;<span class="comment">    /// Holds the information if this pointer is used for writing to memory.</span></div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;<span class="comment"></span>    <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;bool, 2&gt;</a> IsWritePtr;<span class="comment"></span></div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;<span class="comment">    /// Holds the id of the set of pointers that could be dependent because of a</span></div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;<span class="comment">    /// shared underlying object.</span></div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<span class="comment"></span>    <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;unsigned, 2&gt;</a> DependencySetId;</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;  };</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;<span class="comment">  /// A struct for saving information about induction variables.</span></div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;<span class="comment"></span>  <span class="keyword">struct </span>InductionInfo {</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    InductionInfo(<a class="code" href="classllvm_1_1Value.html">Value</a> *Start, InductionKind K) : StartValue(Start), IK(K) {}</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    InductionInfo() : StartValue(0), IK(IK_NoInduction) {}<span class="comment"></span></div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;<span class="comment">    /// Start value.</span></div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;<span class="comment"></span>    <a class="code" href="classllvm_1_1TrackingVH.html">TrackingVH&lt;Value&gt;</a> StartValue;<span class="comment"></span></div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;<span class="comment">    /// Induction kind.</span></div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;<span class="comment"></span>    InductionKind IK;</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;  };</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;<span class="comment">  /// ReductionList contains the reduction descriptors for all</span></div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;<span class="comment">  /// of the reductions that were found in the loop.</span></div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;<span class="comment"></span>  <span class="keyword">typedef</span> <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;PHINode*, ReductionDescriptor&gt;</a> ReductionList;</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;<span class="comment">  /// InductionList saves induction variables and maps them to the</span></div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;<span class="comment">  /// induction descriptor.</span></div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;<span class="comment"></span>  <span class="keyword">typedef</span> <a class="code" href="classllvm_1_1MapVector.html">MapVector&lt;PHINode*, InductionInfo&gt;</a> InductionList;</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;<span class="comment">  /// Returns true if it is legal to vectorize this loop.</span></div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;<span class="comment">  /// This does not mean that it is profitable to vectorize this</span></div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;<span class="comment">  /// loop, only that it is legal to do so.</span></div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> canVectorize();</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;<span class="comment">  /// Returns the Induction variable.</span></div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *getInduction() { <span class="keywordflow">return</span> Induction; }</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;<span class="comment">  /// Returns the reduction variables found in the loop.</span></div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;<span class="comment"></span>  ReductionList *getReductionVars() { <span class="keywordflow">return</span> &amp;Reductions; }</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;<span class="comment">  /// Returns the induction variables found in the loop.</span></div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;<span class="comment"></span>  InductionList *getInductionVars() { <span class="keywordflow">return</span> &amp;Inductions; }</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;<span class="comment">  /// Returns the widest induction type.</span></div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1Type.html">Type</a> *getWidestInductionType() { <span class="keywordflow">return</span> WidestIndTy; }</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;<span class="comment">  /// Returns True if V is an induction variable in this loop.</span></div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> isInductionVariable(<span class="keyword">const</span> <a class="code" href="classllvm_1_1Value.html">Value</a> *V);</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;<span class="comment">  /// Return true if the block BB needs to be predicated in order for the loop</span></div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;<span class="comment">  /// to be vectorized.</span></div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> blockNeedsPredication(<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>);</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;<span class="comment">  /// Check if this  pointer is consecutive when vectorizing. This happens</span></div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;<span class="comment">  /// when the last index of the GEP is the induction variable, or that the</span></div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;<span class="comment">  /// pointer itself is an induction variable.</span></div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;<span class="comment">  /// This check allows us to vectorize A[idx] into a wide load/store.</span></div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;<span class="comment">  /// Returns:</span></div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;<span class="comment">  /// 0 - Stride is unknown or non consecutive.</span></div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;<span class="comment">  /// 1 - Address is consecutive.</span></div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;<span class="comment">  /// -1 - Address is consecutive, and decreasing.</span></div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;<span class="comment"></span>  <span class="keywordtype">int</span> isConsecutivePtr(<a class="code" href="classllvm_1_1Value.html">Value</a> *Ptr);</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;<span class="comment">  /// Returns true if the value V is uniform within the loop.</span></div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> isUniform(<a class="code" href="classllvm_1_1Value.html">Value</a> *V);</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;<span class="comment">  /// Returns true if this instruction will remain scalar after vectorization.</span></div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> isUniformAfterVectorization(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a>* I) { <span class="keywordflow">return</span> Uniforms.count(I); }</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;<span class="comment">  /// Returns the information that we collected about runtime memory check.</span></div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;<span class="comment"></span>  RuntimePointerCheck *getRuntimePointerCheck() { <span class="keywordflow">return</span> &amp;PtrRtCheck; }</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;<span class="comment">  /// This function returns the identity element (or neutral element) for</span></div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;<span class="comment">  /// the operation K.</span></div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;<span class="comment"></span>  <span class="keyword">static</span> <a class="code" href="classllvm_1_1Constant.html">Constant</a> *getReductionIdentity(ReductionKind K, <a class="code" href="classllvm_1_1Type.html">Type</a> *Tp);</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;  <span class="keywordtype">unsigned</span> getMaxSafeDepDistBytes() { <span class="keywordflow">return</span> MaxSafeDepDistBytes; }</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;<span class="keyword">private</span>:<span class="comment"></span></div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;<span class="comment">  /// Check if a single basic block loop is vectorizable.</span></div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;<span class="comment">  /// At this point we know that this is a loop with a constant trip count</span></div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;<span class="comment">  /// and we only need to check individual instructions.</span></div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> canVectorizeInstrs();</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;<span class="comment">  /// When we vectorize loops we may change the order in which</span></div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;<span class="comment">  /// we read and write from memory. This method checks if it is</span></div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;<span class="comment">  /// legal to vectorize the code, considering only memory constrains.</span></div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;<span class="comment">  /// Returns true if the loop is vectorizable</span></div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> canVectorizeMemory();</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;<span class="comment">  /// Return true if we can vectorize this loop using the IF-conversion</span></div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;<span class="comment">  /// transformation.</span></div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> canVectorizeWithIfConvert();</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;<span class="comment">  /// Collect the variables that need to stay uniform after vectorization.</span></div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> collectLoopUniforms();</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;<span class="comment">  /// Return true if all of the instructions in the block can be speculatively</span></div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;<span class="comment">  /// executed. \p SafePtrs is a list of addresses that are known to be legal</span></div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;<span class="comment">  /// and we know that we can read from them without segfault.</span></div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> blockCanBePredicated(<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *BB, <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;Value *, 8&gt;</a>&amp; SafePtrs);</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;<span class="comment">  /// Returns True, if &#39;Phi&#39; is the kind of reduction variable for type</span></div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;<span class="comment">  /// &#39;Kind&#39;. If this is a reduction variable, it adds it to ReductionList.</span></div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> AddReductionVar(<a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *Phi, ReductionKind <a class="code" href="namespacellvm_1_1EngineKind.html#a9df47239a42cd9621ac26d9ecbd57441">Kind</a>);<span class="comment"></span></div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;<span class="comment">  /// Returns a struct describing if the instruction &#39;I&#39; can be a reduction</span></div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;<span class="comment">  /// variable of type &#39;Kind&#39;. If the reduction is a min/max pattern of</span></div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;<span class="comment">  /// select(icmp()) this function advances the instruction pointer &#39;I&#39; from the</span></div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;<span class="comment">  /// compare instruction to the select instruction and stores this pointer in</span></div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;<span class="comment">  /// &#39;PatternLastInst&#39; member of the returned struct.</span></div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;<span class="comment"></span>  ReductionInstDesc isReductionInstr(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *I, ReductionKind Kind,</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;                                     ReductionInstDesc &amp;Desc);<span class="comment"></span></div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;<span class="comment">  /// Returns true if the instruction is a Select(ICmp(X, Y), X, Y) instruction</span></div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;<span class="comment">  /// pattern corresponding to a min(X, Y) or max(X, Y).</span></div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;<span class="comment"></span>  <span class="keyword">static</span> ReductionInstDesc isMinMaxSelectCmpPattern(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *I,</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;                                                    ReductionInstDesc &amp;Prev);<span class="comment"></span></div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;<span class="comment">  /// Returns the induction kind of Phi. This function may return NoInduction</span></div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;<span class="comment">  /// if the PHI is not an induction variable.</span></div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;<span class="comment"></span>  InductionKind isInductionVariable(<a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *Phi);</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;<span class="comment">  /// The loop that we evaluate.</span></div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1Loop.html">Loop</a> *TheLoop;<span class="comment"></span></div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;<span class="comment">  /// Scev analysis.</span></div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1ScalarEvolution.html">ScalarEvolution</a> *SE;<span class="comment"></span></div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;<span class="comment">  /// DataLayout analysis.</span></div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> *DL;<span class="comment"></span></div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;<span class="comment">  /// Dominators.</span></div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1DominatorTree.html">DominatorTree</a> *DT;<span class="comment"></span></div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;<span class="comment">  /// Target Library Info.</span></div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1TargetLibraryInfo.html">TargetLibraryInfo</a> *TLI;</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;  <span class="comment">//  ---  vectorization state --- //</span></div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;<span class="comment">  /// Holds the integer induction variable. This is the counter of the</span></div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;<span class="comment">  /// loop.</span></div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *Induction;<span class="comment"></span></div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;<span class="comment">  /// Holds the reduction variables.</span></div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;<span class="comment"></span>  ReductionList Reductions;<span class="comment"></span></div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;<span class="comment">  /// Holds all of the induction variables that we found in the loop.</span></div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;<span class="comment">  /// Notice that inductions don&#39;t need to start at zero and that induction</span></div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;<span class="comment">  /// variables can be pointers.</span></div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;<span class="comment"></span>  InductionList Inductions;<span class="comment"></span></div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;<span class="comment">  /// Holds the widest induction type encountered.</span></div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1Type.html">Type</a> *WidestIndTy;</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;<span class="comment">  /// Allowed outside users. This holds the reduction</span></div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;<span class="comment">  /// vars which can be accessed from outside the loop.</span></div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;Value*, 4&gt;</a> AllowedExit;<span class="comment"></span></div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;<span class="comment">  /// This set holds the variables which are known to be uniform after</span></div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;<span class="comment">  /// vectorization.</span></div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;Instruction*, 4&gt;</a> Uniforms;<span class="comment"></span></div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;<span class="comment">  /// We need to check that all of the pointers in this list are disjoint</span></div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;<span class="comment">  /// at runtime.</span></div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;<span class="comment"></span>  RuntimePointerCheck PtrRtCheck;<span class="comment"></span></div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;<span class="comment">  /// Can we assume the absence of NaNs.</span></div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> HasFunNoNaNAttr;</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;  <span class="keywordtype">unsigned</span> MaxSafeDepDistBytes;</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;};</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;<span class="comment">/// LoopVectorizationCostModel - estimates the expected speedups due to</span></div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;<span class="comment">/// vectorization.</span></div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;<span class="comment">/// In many cases vectorization is not profitable. This can happen because of</span></div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;<span class="comment">/// a number of reasons. In this class we mainly attempt to predict the</span></div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;<span class="comment">/// expected speedup/slowdowns due to the supported instruction set. We use the</span></div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;<span class="comment">/// TargetTransformInfo to query the different backends for the cost of</span></div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;<span class="comment">/// different operations.</span></div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;<span class="comment"></span><span class="keyword">class </span>LoopVectorizationCostModel {</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;  LoopVectorizationCostModel(<a class="code" href="classllvm_1_1Loop.html">Loop</a> *L, <a class="code" href="classllvm_1_1ScalarEvolution.html">ScalarEvolution</a> *SE, <a class="code" href="classllvm_1_1LoopInfo.html">LoopInfo</a> *LI,</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;                             LoopVectorizationLegality *Legal,</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;                             <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetTransformInfo.html">TargetTransformInfo</a> &amp;TTI,</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;                             <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> *DL, <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetLibraryInfo.html">TargetLibraryInfo</a> *TLI)</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;      : TheLoop(L), SE(SE), LI(LI), Legal(Legal), TTI(TTI), DL(DL), TLI(TLI) {}</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;<span class="comment">  /// Information about vectorization costs</span></div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;<span class="comment"></span>  <span class="keyword">struct </span><a class="code" href="LoopVectorize_8cpp.html#a7db5de6d612f2730abd7aa99a724615a">VectorizationFactor</a> {</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;    <span class="keywordtype">unsigned</span> Width; <span class="comment">// Vector width with best cost</span></div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    <span class="keywordtype">unsigned</span> Cost; <span class="comment">// Cost of the loop with that width</span></div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;  };<span class="comment"></span></div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;<span class="comment">  /// \return The most profitable vectorization factor and the cost of that VF.</span></div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;<span class="comment">  /// This method checks every power of two up to VF. If UserVF is not ZERO</span></div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;<span class="comment">  /// then this vectorization factor will be selected if vectorization is</span></div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;<span class="comment">  /// possible.</span></div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;<span class="comment"></span>  <a class="code" href="LoopVectorize_8cpp.html#a7db5de6d612f2730abd7aa99a724615a">VectorizationFactor</a> selectVectorizationFactor(<span class="keywordtype">bool</span> OptForSize,</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;                                                <span class="keywordtype">unsigned</span> UserVF);</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;<span class="comment">  /// \return The size (in bits) of the widest type in the code that</span></div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;<span class="comment">  /// needs to be vectorized. We ignore values that remain scalar such as</span></div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;<span class="comment">  /// 64 bit loop indices.</span></div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;<span class="comment"></span>  <span class="keywordtype">unsigned</span> getWidestType();</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;<span class="comment">  /// \return The most profitable unroll factor.</span></div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;<span class="comment">  /// If UserUF is non-zero then this method finds the best unroll-factor</span></div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;<span class="comment">  /// based on register pressure and other parameters.</span></div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;<span class="comment">  /// VF and LoopCost are the selected vectorization factor and the cost of the</span></div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;<span class="comment">  /// selected VF.</span></div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;<span class="comment"></span>  <span class="keywordtype">unsigned</span> selectUnrollFactor(<span class="keywordtype">bool</span> OptForSize, <span class="keywordtype">unsigned</span> UserUF, <span class="keywordtype">unsigned</span> VF,</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;                              <span class="keywordtype">unsigned</span> LoopCost);</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;<span class="comment">  /// \brief A struct that represents some properties of the register usage</span></div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;<span class="comment">  /// of a loop.</span></div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;<span class="comment"></span>  <span class="keyword">struct </span>RegisterUsage {<span class="comment"></span></div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;<span class="comment">    /// Holds the number of loop invariant values that are used in the loop.</span></div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;<span class="comment"></span>    <span class="keywordtype">unsigned</span> LoopInvariantRegs;<span class="comment"></span></div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;<span class="comment">    /// Holds the maximum number of concurrent live intervals in the loop.</span></div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;<span class="comment"></span>    <span class="keywordtype">unsigned</span> MaxLocalUsers;<span class="comment"></span></div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;<span class="comment">    /// Holds the number of instructions in the loop.</span></div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;<span class="comment"></span>    <span class="keywordtype">unsigned</span> NumInstructions;</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;  };</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;<span class="comment">  /// \return  information about the register usage of the loop.</span></div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;<span class="comment"></span>  RegisterUsage calculateRegisterUsage();</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;<span class="keyword">private</span>:<span class="comment"></span></div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;<span class="comment">  /// Returns the expected execution cost. The unit of the cost does</span></div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;<span class="comment">  /// not matter because we use the &#39;cost&#39; units to compare different</span></div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;<span class="comment">  /// vector widths. The cost that is returned is *not* normalized by</span></div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;<span class="comment">  /// the factor width.</span></div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;<span class="comment"></span>  <span class="keywordtype">unsigned</span> expectedCost(<span class="keywordtype">unsigned</span> VF);</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;<span class="comment">  /// Returns the execution time cost of an instruction for a given vector</span></div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;<span class="comment">  /// width. Vector width of one means scalar.</span></div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;<span class="comment"></span>  <span class="keywordtype">unsigned</span> getInstructionCost(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *I, <span class="keywordtype">unsigned</span> VF);</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;<span class="comment">  /// A helper function for converting Scalar types to vector types.</span></div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;<span class="comment">  /// If the incoming type is void, we return void. If the VF is 1, we return</span></div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;<span class="comment">  /// the scalar type.</span></div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;<span class="comment"></span>  <span class="keyword">static</span> <a class="code" href="classllvm_1_1Type.html">Type</a>* ToVectorTy(<a class="code" href="classllvm_1_1Type.html">Type</a> *<a class="code" href="namespacellvm_1_1NVPTX_1_1PTXLdStInstCode.html#a91119cbee2be000c528a690252aee07ca09c68d67f7dbfa6cc77eaf73aa535217">Scalar</a>, <span class="keywordtype">unsigned</span> VF);</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;<span class="comment">  /// Returns whether the instruction is a load or store and will be a emitted</span></div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;<span class="comment">  /// as a vector operation.</span></div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> isConsecutiveLoadOrStore(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *I);</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;<span class="comment">  /// The loop that we evaluate.</span></div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1Loop.html">Loop</a> *TheLoop;<span class="comment"></span></div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;<span class="comment">  /// Scev analysis.</span></div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1ScalarEvolution.html">ScalarEvolution</a> *SE;<span class="comment"></span></div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;<span class="comment">  /// Loop Info analysis.</span></div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1LoopInfo.html">LoopInfo</a> *LI;<span class="comment"></span></div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;<span class="comment">  /// Vectorization legality.</span></div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;<span class="comment"></span>  LoopVectorizationLegality *Legal;<span class="comment"></span></div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;<span class="comment">  /// Vector target information.</span></div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;<span class="comment"></span>  <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetTransformInfo.html">TargetTransformInfo</a> &amp;TTI;<span class="comment"></span></div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;<span class="comment">  /// Target data layout information.</span></div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> *DL;<span class="comment"></span></div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;<span class="comment">  /// Target Library Info.</span></div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;<span class="comment"></span>  <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetLibraryInfo.html">TargetLibraryInfo</a> *TLI;</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;};</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;<span class="comment">/// Utility class for getting and setting loop vectorizer hints in the form</span></div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;<span class="comment">/// of loop metadata.</span></div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;<span class="comment"></span><span class="keyword">struct </span>LoopVectorizeHints {<span class="comment"></span></div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;<span class="comment">  /// Vectorization width.</span></div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;<span class="comment"></span>  <span class="keywordtype">unsigned</span> Width;<span class="comment"></span></div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;<span class="comment">  /// Vectorization unroll factor.</span></div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;<span class="comment"></span>  <span class="keywordtype">unsigned</span> Unroll;</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;  LoopVectorizeHints(<span class="keyword">const</span> <a class="code" href="classllvm_1_1Loop.html">Loop</a> *L, <span class="keywordtype">bool</span> DisableUnrolling)</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;  : Width(<a class="code" href="LoopVectorize_8cpp.html#a7db5de6d612f2730abd7aa99a724615a">VectorizationFactor</a>)</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;  , Unroll(DisableUnrolling ? 1 : <a class="code" href="LoopVectorize_8cpp.html#af303907f5edd23d696cb2af21c6fec66">VectorizationUnroll</a>)</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;  , LoopID(L-&gt;<a class="code" href="classllvm_1_1Loop.html#aeb9e1c66dbe5a07f65e833f86008ae14">getLoopID</a>()) {</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;    getHints(L);</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;    <span class="comment">// The command line options override any loop metadata except for when</span></div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;    <span class="comment">// width == 1 which is used to indicate the loop is already vectorized.</span></div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="LoopVectorize_8cpp.html#a7db5de6d612f2730abd7aa99a724615a">VectorizationFactor</a>.getNumOccurrences() &gt; 0 &amp;&amp; Width != 1)</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;      Width = <a class="code" href="LoopVectorize_8cpp.html#a7db5de6d612f2730abd7aa99a724615a">VectorizationFactor</a>;</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;    <span class="keywordflow">if</span> (VectorizationUnroll.getNumOccurrences() &gt; 0)</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;      Unroll = VectorizationUnroll;</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;    <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<span class="keywordflow">if</span> (DisableUnrolling &amp;&amp; Unroll == 1)</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;            <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;LV: Unrolling disabled by the pass manager\n&quot;</span>);</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;  }</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;<span class="comment">  /// Return the loop vectorizer metadata prefix.</span></div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;<span class="comment"></span>  <span class="keyword">static</span> <a class="code" href="classllvm_1_1StringRef.html">StringRef</a> <a class="code" href="namespacellvm_1_1cl.html#afcbd4ecc474e2d218391d6d3027b086aa7861ef1db44eac8ea7a373cd7c53a7c5">Prefix</a>() { <span class="keywordflow">return</span> <span class="stringliteral">&quot;llvm.vectorizer.&quot;</span>; }</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;  <a class="code" href="classllvm_1_1MDNode.html">MDNode</a> *createHint(<a class="code" href="classllvm_1_1LLVMContext.html">LLVMContext</a> &amp;Context, <a class="code" href="classllvm_1_1StringRef.html">StringRef</a> <a class="code" href="namespacellvm_1_1GraphProgram.html#a0ad4685976f8c4d4a697a53fbe05d10b">Name</a>, <span class="keywordtype">unsigned</span> V) {</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;    <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Value*, 2&gt;</a> Vals;</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;    Vals.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(<a class="code" href="classllvm_1_1MDString.html#affbb7e2e9ad8d18114816f2443d672b9">MDString::get</a>(Context, Name));</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;    Vals.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(<a class="code" href="classllvm_1_1ConstantInt.html#a9105541412dab869e18b3cceebfff07d">ConstantInt::get</a>(<a class="code" href="classllvm_1_1Type.html#a30dd396c5b40cd86c1591872e574ccdf">Type::getInt32Ty</a>(Context), V));</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1MDNode.html#ad66ceb4f77078b084e527a19baab19d6">MDNode::get</a>(Context, Vals);</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;  }</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;<span class="comment">  /// Mark the loop L as already vectorized by setting the width to 1.</span></div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> setAlreadyVectorized(<a class="code" href="classllvm_1_1Loop.html">Loop</a> *L) {</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;    <a class="code" href="classllvm_1_1LLVMContext.html">LLVMContext</a> &amp;Context = L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#ac4f141a355e5898255f2cbc57c5b54c3">getHeader</a>()-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#ad652423d9d91271ba153eb86482b2f55">getContext</a>();</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;    Width = 1;</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;    <span class="comment">// Create a new loop id with one more operand for the already_vectorized</span></div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;    <span class="comment">// hint. If the loop already has a loop id then copy the existing operands.</span></div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;    <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Value*, 4&gt;</a> Vals(1);</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;    <span class="keywordflow">if</span> (LoopID)</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 1, ie = LoopID-&gt;getNumOperands(); <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; ie; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;        Vals.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(LoopID-&gt;getOperand(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>));</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;    Vals.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(createHint(Context, <a class="code" href="classllvm_1_1Twine.html">Twine</a>(<a class="code" href="namespacellvm_1_1cl.html#afcbd4ecc474e2d218391d6d3027b086aa7861ef1db44eac8ea7a373cd7c53a7c5">Prefix</a>(), <span class="stringliteral">&quot;width&quot;</span>).str(), Width));</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;    Vals.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(createHint(Context, <a class="code" href="classllvm_1_1Twine.html">Twine</a>(<a class="code" href="namespacellvm_1_1cl.html#afcbd4ecc474e2d218391d6d3027b086aa7861ef1db44eac8ea7a373cd7c53a7c5">Prefix</a>(), <span class="stringliteral">&quot;unroll&quot;</span>).str(), 1));</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;    <a class="code" href="classllvm_1_1MDNode.html">MDNode</a> *NewLoopID = <a class="code" href="classllvm_1_1MDNode.html#ad66ceb4f77078b084e527a19baab19d6">MDNode::get</a>(Context, Vals);</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;    <span class="comment">// Set operand 0 to refer to the loop id itself.</span></div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;    NewLoopID-&gt;<a class="code" href="classllvm_1_1MDNode.html#a0bd8a5b0a6ce390d0064c025ad58e946">replaceOperandWith</a>(0, NewLoopID);</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;    L-&gt;<a class="code" href="classllvm_1_1Loop.html#a59e5d5a53c39c2508ef67c0c04d23f7c">setLoopID</a>(NewLoopID);</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;    <span class="keywordflow">if</span> (LoopID)</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;      LoopID-&gt;replaceAllUsesWith(NewLoopID);</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;    LoopID = NewLoopID;</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;  }</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;<span class="keyword">private</span>:</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;  <a class="code" href="classllvm_1_1MDNode.html">MDNode</a> *LoopID;</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;<span class="comment">  /// Find hints specified in the loop metadata.</span></div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> getHints(<span class="keyword">const</span> <a class="code" href="classllvm_1_1Loop.html">Loop</a> *L) {</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;    <span class="keywordflow">if</span> (!LoopID)</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;    <span class="comment">// First operand should refer to the loop id itself.</span></div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;    assert(LoopID-&gt;<a class="code" href="classllvm_1_1MDNode.html#ade17b50e4f0b835cd9eb58dffe12a90d">getNumOperands</a>() &gt; 0 &amp;&amp; <span class="stringliteral">&quot;requires at least one operand&quot;</span>);</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;    assert(LoopID-&gt;<a class="code" href="classllvm_1_1MDNode.html#adb91929f939ff02dbee552d32afaf4e6">getOperand</a>(0) == LoopID &amp;&amp; <span class="stringliteral">&quot;invalid loop id&quot;</span>);</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 1, ie = LoopID-&gt;<a class="code" href="classllvm_1_1MDNode.html#ade17b50e4f0b835cd9eb58dffe12a90d">getNumOperands</a>(); <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; ie; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;      <span class="keyword">const</span> <a class="code" href="classllvm_1_1MDString.html">MDString</a> *<a class="code" href="Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a> = 0;</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;      <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Value*, 4&gt;</a> Args;</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;      <span class="comment">// The expected hint is either a MDString or a MDNode with the first</span></div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;      <span class="comment">// operand a MDString.</span></div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">const</span> <a class="code" href="classllvm_1_1MDNode.html">MDNode</a> *MD = dyn_cast&lt;MDNode&gt;(LoopID-&gt;<a class="code" href="classllvm_1_1MDNode.html#adb91929f939ff02dbee552d32afaf4e6">getOperand</a>(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>))) {</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;        <span class="keywordflow">if</span> (!MD || MD-&gt;getNumOperands() == 0)</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;          <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;        S = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1MDString.html">MDString</a>&gt;(MD-&gt;getOperand(0));</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 1, ie = MD-&gt;getNumOperands(); <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; ie; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;          Args.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(MD-&gt;getOperand(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>));</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;        S = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1MDString.html">MDString</a>&gt;(LoopID-&gt;<a class="code" href="classllvm_1_1MDNode.html#adb91929f939ff02dbee552d32afaf4e6">getOperand</a>(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>));</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;        assert(Args.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#a22a311dfe4c28a897de8a9365a4f0a84">size</a>() == 0 &amp;&amp; <span class="stringliteral">&quot;too many arguments for MDString&quot;</span>);</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;      }</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;      <span class="keywordflow">if</span> (!S)</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;      <span class="comment">// Check if the hint starts with the vectorizer prefix.</span></div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;      <a class="code" href="classllvm_1_1StringRef.html">StringRef</a> Hint = S-&gt;<a class="code" href="classllvm_1_1MDString.html#a1313e7e5d3792f0d96f2b485d3ca6a70">getString</a>();</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;      <span class="keywordflow">if</span> (!Hint.<a class="code" href="classllvm_1_1StringRef.html#a1a7bc4930b0396a67c30081f7cb30542">startswith</a>(<a class="code" href="namespacellvm_1_1cl.html#afcbd4ecc474e2d218391d6d3027b086aa7861ef1db44eac8ea7a373cd7c53a7c5">Prefix</a>()))</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;      <span class="comment">// Remove the prefix.</span></div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;      Hint = Hint.<a class="code" href="classllvm_1_1StringRef.html#a3d0712956e53687d1894ba17b84aeffa">substr</a>(<a class="code" href="namespacellvm_1_1cl.html#afcbd4ecc474e2d218391d6d3027b086aa7861ef1db44eac8ea7a373cd7c53a7c5">Prefix</a>().<a class="code" href="Target_2README_8txt.html#a02def7c594e9f19ff247ed0bf33d1c30">size</a>(), <a class="code" href="classllvm_1_1StringRef.html#a7414af479a1a88b0631120a4fc681e20">StringRef::npos</a>);</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;      <span class="keywordflow">if</span> (Args.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#a22a311dfe4c28a897de8a9365a4f0a84">size</a>() == 1)</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;        getHint(Hint, Args[0]);</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;    }</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;  }</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;  <span class="comment">// Check string hint with one operand.</span></div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;  <span class="keywordtype">void</span> getHint(<a class="code" href="classllvm_1_1StringRef.html">StringRef</a> Hint, <a class="code" href="classllvm_1_1Value.html">Value</a> *Arg) {</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a>&gt;(Arg);</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;    <span class="keywordflow">if</span> (!C) <span class="keywordflow">return</span>;</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;    <span class="keywordtype">unsigned</span> Val = C-&gt;<a class="code" href="classllvm_1_1ConstantInt.html#a6edd823ba5e4e1effc8280ca8a1194ef">getZExtValue</a>();</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;    <span class="keywordflow">if</span> (Hint == <span class="stringliteral">&quot;width&quot;</span>) {</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#af4d1a918800291e75b01ce1447be0e83">isPowerOf2_32</a>(Val) &amp;&amp; Val &lt;= MaxVectorWidth)</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;        Width = Val;</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;        <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;LV: ignoring invalid width hint metadata\n&quot;</span>);</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Hint == <span class="stringliteral">&quot;unroll&quot;</span>) {</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#af4d1a918800291e75b01ce1447be0e83">isPowerOf2_32</a>(Val) &amp;&amp; Val &lt;= MaxUnrollFactor)</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;        Unroll = Val;</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;        <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;LV: ignoring invalid unroll hint metadata\n&quot;</span>);</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;      <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;LV: ignoring unknown hint &quot;</span> &lt;&lt; Hint &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>);</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;    }</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;  }</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;};</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;<span class="comment">/// The LoopVectorize Pass.</span></div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;<span class="comment"></span><span class="keyword">struct </span>LoopVectorize : <span class="keyword">public</span> <a class="code" href="classllvm_1_1LoopPass.html">LoopPass</a> {<span class="comment"></span></div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;<span class="comment">  /// Pass identification, replacement for typeid</span></div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;<span class="comment"></span>  <span class="keyword">static</span> <span class="keywordtype">char</span> <a class="code" href="namespacellvm_1_1CallingConv.html#a4f861731fc6dbfdccc05af5968d98974">ID</a>;</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;  <span class="keyword">explicit</span> LoopVectorize(<span class="keywordtype">bool</span> NoUnrolling = <span class="keyword">false</span>)</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;    : <a class="code" href="classllvm_1_1LoopPass.html">LoopPass</a>(ID), DisableUnrolling(NoUnrolling) {</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;    <a class="code" href="namespacellvm.html#a6feec53bc62dc3b5677f0b7c066535d3">initializeLoopVectorizePass</a>(*<a class="code" href="classllvm_1_1PassRegistry.html#a05a729900b76c89e808c6c3094921b2f">PassRegistry::getPassRegistry</a>());</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;  }</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;  <a class="code" href="classllvm_1_1ScalarEvolution.html">ScalarEvolution</a> *SE;</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;  <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> *DL;</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;  <a class="code" href="classllvm_1_1LoopInfo.html">LoopInfo</a> *LI;</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;  <a class="code" href="classllvm_1_1TargetTransformInfo.html">TargetTransformInfo</a> *TTI;</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;  <a class="code" href="classllvm_1_1DominatorTree.html">DominatorTree</a> *DT;</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;  <a class="code" href="classllvm_1_1TargetLibraryInfo.html">TargetLibraryInfo</a> *TLI;</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;  <span class="keywordtype">bool</span> DisableUnrolling;</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">bool</span> runOnLoop(<a class="code" href="classllvm_1_1Loop.html">Loop</a> *L, <a class="code" href="classllvm_1_1LPPassManager.html">LPPassManager</a> &amp;LPM) {</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;    <span class="comment">// We only vectorize innermost loops.</span></div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;    <span class="keywordflow">if</span> (!L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#ab191396dd1d8556d8e0a057f7fd2aaab">empty</a>())</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;    SE = &amp;getAnalysis&lt;ScalarEvolution&gt;();</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;    DL = getAnalysisIfAvailable&lt;DataLayout&gt;();</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;    LI = &amp;getAnalysis&lt;LoopInfo&gt;();</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;    TTI = &amp;getAnalysis&lt;TargetTransformInfo&gt;();</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;    DT = &amp;getAnalysis&lt;DominatorTree&gt;();</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;    TLI = getAnalysisIfAvailable&lt;TargetLibraryInfo&gt;();</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;    <span class="comment">// If the target claims to have no vector registers don&#39;t attempt</span></div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;    <span class="comment">// vectorization.</span></div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;    <span class="keywordflow">if</span> (!TTI-&gt;getNumberOfRegisters(<span class="keyword">true</span>))</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;    <span class="keywordflow">if</span> (DL == NULL) {</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;      <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;LV: Not vectorizing because of missing data layout\n&quot;</span>);</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;    }</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;    <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;LV: Checking a loop in \&quot;&quot;</span> &lt;&lt;</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;          L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#ac4f141a355e5898255f2cbc57c5b54c3">getHeader</a>()-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#aca229503e4f5c83a187a6a921c625fa8">getParent</a>()-&gt;<a class="code" href="classllvm_1_1Value.html#ad452febc1ac0b394876e640ec03ffa38">getName</a>() &lt;&lt; <span class="stringliteral">&quot;\&quot;\n&quot;</span>);</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;    LoopVectorizeHints Hints(L, DisableUnrolling);</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;    <span class="keywordflow">if</span> (Hints.Width == 1 &amp;&amp; Hints.Unroll == 1) {</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;      <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;LV: Not vectorizing.\n&quot;</span>);</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;    }</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;    <span class="comment">// Check if it is legal to vectorize the loop.</span></div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;    LoopVectorizationLegality LVL(L, SE, DL, DT, TLI);</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;    <span class="keywordflow">if</span> (!LVL.canVectorize()) {</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;      <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;LV: Not vectorizing.\n&quot;</span>);</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;    }</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;    <span class="comment">// Use the cost model.</span></div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;    LoopVectorizationCostModel CM(L, SE, LI, &amp;LVL, *TTI, DL, TLI);</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;    <span class="comment">// Check the function attributes to find out if this function should be</span></div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;    <span class="comment">// optimized for size.</span></div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;    <a class="code" href="classllvm_1_1Function.html">Function</a> *<a class="code" href="LLParser_8cpp.html#a33ece1ef8074506a15d7f86eb76dbae6">F</a> = L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#ac4f141a355e5898255f2cbc57c5b54c3">getHeader</a>()-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#aca229503e4f5c83a187a6a921c625fa8">getParent</a>();</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;    <a class="code" href="classllvm_1_1Attribute.html#aab7ee4b8fd1d3e7e4cea87868855e60e">Attribute::AttrKind</a> SzAttr = <a class="code" href="classllvm_1_1Attribute.html#aab7ee4b8fd1d3e7e4cea87868855e60ea2ac83e0612ce8f8d69651cd529061feb">Attribute::OptimizeForSize</a>;</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;    <a class="code" href="classllvm_1_1Attribute.html#aab7ee4b8fd1d3e7e4cea87868855e60e">Attribute::AttrKind</a> FlAttr = <a class="code" href="classllvm_1_1Attribute.html#aab7ee4b8fd1d3e7e4cea87868855e60ea9e330fa070dd4bb79cbc6c74b41958a4">Attribute::NoImplicitFloat</a>;</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;    <span class="keywordtype">unsigned</span> FnIndex = AttributeSet::FunctionIndex;</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;    <span class="keywordtype">bool</span> OptForSize = F-&gt;<a class="code" href="classllvm_1_1Function.html#a72873ed64b7be01507a2248b8e756ec8">getAttributes</a>().<a class="code" href="classllvm_1_1AttributeSet.html#a54abbe67d4a53c92652f1666dc19281f">hasAttribute</a>(FnIndex, SzAttr);</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;    <span class="keywordtype">bool</span> NoFloat = F-&gt;<a class="code" href="classllvm_1_1Function.html#a72873ed64b7be01507a2248b8e756ec8">getAttributes</a>().<a class="code" href="classllvm_1_1AttributeSet.html#a54abbe67d4a53c92652f1666dc19281f">hasAttribute</a>(FnIndex, FlAttr);</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;    <span class="keywordflow">if</span> (NoFloat) {</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;      <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;LV: Can&#39;t vectorize when the NoImplicitFloat&quot;</span></div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;            <span class="stringliteral">&quot;attribute is used.\n&quot;</span>);</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;    }</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;    <span class="comment">// Select the optimal vectorization factor.</span></div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;    <a class="code" href="LoopVectorize_8cpp.html#a7db5de6d612f2730abd7aa99a724615a">LoopVectorizationCostModel::VectorizationFactor</a> VF;</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;    VF = CM.selectVectorizationFactor(OptForSize, Hints.Width);</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;    <span class="comment">// Select the unroll factor.</span></div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;    <span class="keywordtype">unsigned</span> UF = CM.selectUnrollFactor(OptForSize, Hints.Unroll, VF.Width,</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;                                        VF.Cost);</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;    <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;LV: Found a vectorizable loop (&quot;</span>&lt;&lt; VF.Width &lt;&lt; <span class="stringliteral">&quot;) in &quot;</span>&lt;&lt;</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;          F-&gt;<a class="code" href="classllvm_1_1GlobalValue.html#a9e1fc23a17e97d2d1732e753ae9251ac">getParent</a>()-&gt;<a class="code" href="classllvm_1_1Module.html#a339f163decf5f2c881937600d1e953fa">getModuleIdentifier</a>() &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>);</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;    <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;LV: Unroll Factor is &quot;</span> &lt;&lt; UF &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>);</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;    <span class="keywordflow">if</span> (VF.Width == 1) {</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;      <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;LV: Vectorization is possible but not beneficial.\n&quot;</span>);</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;      <span class="keywordflow">if</span> (UF == 1)</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;      <span class="comment">// We decided not to vectorize, but we may want to unroll.</span></div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;      InnerLoopUnroller Unroller(L, SE, LI, DT, DL, TLI, UF);</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;      Unroller.vectorize(&amp;LVL);</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;      <span class="comment">// If we decided that it is *legal* to vectorize the loop then do it.</span></div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;      InnerLoopVectorizer LB(L, SE, LI, DT, DL, TLI, VF.Width, UF);</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;      LB.vectorize(&amp;LVL);</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;    }</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;    <span class="comment">// Mark the loop as already vectorized to avoid vectorizing again.</span></div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;    Hints.setAlreadyVectorized(L);</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;    <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a36798313569555c6f79b4ac8cc0bf63d">verifyFunction</a>(*L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#ac4f141a355e5898255f2cbc57c5b54c3">getHeader</a>()-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#aca229503e4f5c83a187a6a921c625fa8">getParent</a>()));</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;  }</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span> getAnalysisUsage(<a class="code" href="classllvm_1_1AnalysisUsage.html">AnalysisUsage</a> &amp;AU)<span class="keyword"> const </span>{</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;    <a class="code" href="classllvm_1_1Pass.html#a048082a5be9ae0d8901ea64de59e5c8f">LoopPass::getAnalysisUsage</a>(AU);</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;    AU.<a class="code" href="classllvm_1_1AnalysisUsage.html#a053677ebc731b47a534f841b11b5cf0c">addRequiredID</a>(<a class="code" href="namespacellvm.html#a472515fc67a5fb572afeb00aa2609cca">LoopSimplifyID</a>);</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;    AU.<a class="code" href="classllvm_1_1AnalysisUsage.html#a053677ebc731b47a534f841b11b5cf0c">addRequiredID</a>(<a class="code" href="namespacellvm.html#a3e3d3c6d4e33a4f5ca579ee7939f0349">LCSSAID</a>);</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;    AU.<a class="code" href="classllvm_1_1AnalysisUsage.html#ae5c60fd282ee894c87ea02c3f0fcb6d0">addRequired</a>&lt;<a class="code" href="classllvm_1_1DominatorTree.html">DominatorTree</a>&gt;();</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;    AU.<a class="code" href="classllvm_1_1AnalysisUsage.html#ae5c60fd282ee894c87ea02c3f0fcb6d0">addRequired</a>&lt;<a class="code" href="classllvm_1_1LoopInfo.html">LoopInfo</a>&gt;();</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;    AU.<a class="code" href="classllvm_1_1AnalysisUsage.html#ae5c60fd282ee894c87ea02c3f0fcb6d0">addRequired</a>&lt;<a class="code" href="classllvm_1_1ScalarEvolution.html">ScalarEvolution</a>&gt;();</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;    AU.<a class="code" href="classllvm_1_1AnalysisUsage.html#ae5c60fd282ee894c87ea02c3f0fcb6d0">addRequired</a>&lt;<a class="code" href="classllvm_1_1TargetTransformInfo.html">TargetTransformInfo</a>&gt;();</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;    AU.<a class="code" href="classllvm_1_1AnalysisUsage.html#a884f90190bca4bd354f2d5c91c264028">addPreserved</a>&lt;<a class="code" href="classllvm_1_1LoopInfo.html">LoopInfo</a>&gt;();</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;    AU.<a class="code" href="classllvm_1_1AnalysisUsage.html#a884f90190bca4bd354f2d5c91c264028">addPreserved</a>&lt;<a class="code" href="classllvm_1_1DominatorTree.html">DominatorTree</a>&gt;();</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;  }</div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;};</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;} <span class="comment">// end anonymous namespace</span></div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;<span class="comment">// Implementation of LoopVectorizationLegality, InnerLoopVectorizer and</span></div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;<span class="comment">// LoopVectorizationCostModel.</span></div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;LoopVectorizationLegality::RuntimePointerCheck::insert(<a class="code" href="classllvm_1_1ScalarEvolution.html">ScalarEvolution</a> *SE,</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;                                                       <a class="code" href="classllvm_1_1Loop.html">Loop</a> *Lp, <a class="code" href="classllvm_1_1Value.html">Value</a> *Ptr,</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;                                                       <span class="keywordtype">bool</span> WritePtr,</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;                                                       <span class="keywordtype">unsigned</span> DepSetId) {</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *Sc = SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a30bd18ac905eacf3601bc6a553a9ff49">getSCEV</a>(Ptr);</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEVAddRecExpr.html">SCEVAddRecExpr</a> *AR = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1SCEVAddRecExpr.html">SCEVAddRecExpr</a>&gt;(Sc);</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;  assert(AR &amp;&amp; <span class="stringliteral">&quot;Invalid addrec expression&quot;</span>);</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *Ex = SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#aecd7aba4460358813feef37d71d5024e">getBackedgeTakenCount</a>(Lp);</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *ScEnd = AR-&gt;<a class="code" href="classllvm_1_1SCEVAddRecExpr.html#a11bb31f99854303d2a934765469c5c2c">evaluateAtIteration</a>(Ex, *SE);</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;  Pointers.push_back(Ptr);</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;  Starts.push_back(AR-&gt;<a class="code" href="classllvm_1_1SCEVAddRecExpr.html#a0d53a749bd858b270d322b34b8d7e1e5">getStart</a>());</div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;  Ends.push_back(ScEnd);</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;  IsWritePtr.push_back(WritePtr);</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;  DependencySetId.push_back(DepSetId);</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;}</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *InnerLoopVectorizer::getBroadcastInstrs(<a class="code" href="classllvm_1_1Value.html">Value</a> *V) {</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;  <span class="comment">// We need to place the broadcast of invariant variables outside the loop.</span></div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *Instr = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1Instruction.html">Instruction</a>&gt;(V);</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;  <span class="keywordtype">bool</span> NewInstr = (Instr &amp;&amp; Instr-&gt;<a class="code" href="classllvm_1_1Instruction.html#a9cd49851904f15060edb782ef4dd1b2d">getParent</a>() == LoopVectorBody);</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;  <span class="keywordtype">bool</span> Invariant = OrigLoop-&gt;isLoopInvariant(V) &amp;&amp; !NewInstr;</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;  <span class="comment">// Place the code for broadcasting invariant variables in the new preheader.</span></div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;  <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;::InsertPointGuard</a> Guard(Builder);</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;  <span class="keywordflow">if</span> (Invariant)</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;    Builder.SetInsertPoint(LoopVectorPreHeader-&gt;getTerminator());</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;</div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;  <span class="comment">// Broadcast the scalar into all locations in the vector.</span></div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Shuf = Builder.CreateVectorSplat(VF, V, <span class="stringliteral">&quot;broadcast&quot;</span>);</div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;</div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;  <span class="keywordflow">return</span> Shuf;</div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;}</div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;</div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *InnerLoopVectorizer::getConsecutiveVector(<a class="code" href="classllvm_1_1Value.html">Value</a>* Val, <span class="keywordtype">int</span> StartIdx,</div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;                                                 <span class="keywordtype">bool</span> Negate) {</div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;  assert(Val-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a6f725580f7834e2ca90762965866dad4">isVectorTy</a>() &amp;&amp; <span class="stringliteral">&quot;Must be a vector&quot;</span>);</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;  assert(Val-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a8eafa71cf399da8f21b2af5549f3f9e7">getScalarType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a6e328feb83afa5cf1c966d6704e43fc1">isIntegerTy</a>() &amp;&amp;</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;         <span class="stringliteral">&quot;Elem must be an integer&quot;</span>);</div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;  <span class="comment">// Create the types.</span></div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *ITy = Val-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a8eafa71cf399da8f21b2af5549f3f9e7">getScalarType</a>();</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;  <a class="code" href="classllvm_1_1VectorType.html">VectorType</a> *Ty = cast&lt;VectorType&gt;(Val-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>());</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;  <span class="keywordtype">int</span> VLen = Ty-&gt;<a class="code" href="classllvm_1_1VectorType.html#a580510fa692dccfb26d0e967d8f164e7">getNumElements</a>();</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Constant*, 8&gt;</a> Indices;</div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;</div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;  <span class="comment">// Create a vector of consecutive numbers from zero to VF.</span></div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; VLen; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;    int64_t Idx = Negate ? (-<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) : <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;    Indices.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(<a class="code" href="classllvm_1_1ConstantInt.html#a9105541412dab869e18b3cceebfff07d">ConstantInt::get</a>(ITy, StartIdx + Idx, Negate));</div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;  }</div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;</div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;  <span class="comment">// Add the consecutive indices to the vector value.</span></div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;  <a class="code" href="classllvm_1_1Constant.html">Constant</a> *Cv = <a class="code" href="classllvm_1_1ConstantVector.html#ade9fa017ca3aa82f7694a47090547bc1">ConstantVector::get</a>(Indices);</div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;  assert(Cv-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>() == Val-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>() &amp;&amp; <span class="stringliteral">&quot;Invalid consecutive vec&quot;</span>);</div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;  <span class="keywordflow">return</span> Builder.CreateAdd(Val, Cv, <span class="stringliteral">&quot;induction&quot;</span>);</div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;}</div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;<span class="comment">/// \brief Find the operand of the GEP that should be checked for consecutive</span></div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;<span class="comment">/// stores. This ignores trailing indices that have no effect on the final</span></div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;<span class="comment">/// pointer.</span></div><div class="line"><a name="l01073"></a><span class="lineno"><a class="line" href="LoopVectorize_8cpp.html#a9934327154d90155e54840cdf84df6a0"> 1073</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">unsigned</span> <a class="code" href="LoopVectorize_8cpp.html#a9934327154d90155e54840cdf84df6a0">getGEPInductionOperand</a>(<a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> *DL,</div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;                                       <span class="keyword">const</span> <a class="code" href="classllvm_1_1GetElementPtrInst.html">GetElementPtrInst</a> *Gep) {</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;  <span class="keywordtype">unsigned</span> LastOperand = Gep-&gt;<a class="code" href="classllvm_1_1User.html#a2f81e0c1fc6554df7ad2eafabf5fc5a5">getNumOperands</a>() - 1;</div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;  <span class="keywordtype">unsigned</span> GEPAllocSize = DL-&gt;<a class="code" href="classllvm_1_1DataLayout.html#a1d6fcc02e91ba24510aba42660c90e29">getTypeAllocSize</a>(</div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;      cast&lt;PointerType&gt;(Gep-&gt;<a class="code" href="classllvm_1_1GetElementPtrInst.html#abfc8f5fb56fb06e32a26f28ba7ec1c0b">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a8eafa71cf399da8f21b2af5549f3f9e7">getScalarType</a>())-&gt;getElementType());</div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;</div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;  <span class="comment">// Walk backwards and try to peel off zeros.</span></div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;  <span class="keywordflow">while</span> (LastOperand &gt; 1 &amp;&amp; <a class="code" href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">match</a>(Gep-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(LastOperand), <a class="code" href="namespacellvm_1_1PatternMatch.html#ab3b5beca3a0dedd21adac813123a2ae6">m_Zero</a>())) {</div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;    <span class="comment">// Find the type we&#39;re currently indexing into.</span></div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;    <a class="code" href="classllvm_1_1generic__gep__type__iterator.html">gep_type_iterator</a> GEPTI = <a class="code" href="namespacellvm.html#ac828b9b52935f87659a4adf237f820a3">gep_type_begin</a>(Gep);</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;    <a class="code" href="namespacellvm_1_1object.html#a63a8f680ecd1aa68ae0efdd3b5c4f4a7">std::advance</a>(GEPTI, LastOperand - 1);</div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;</div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;    <span class="comment">// If it&#39;s a type with the same allocation size as the result of the GEP we</span></div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;    <span class="comment">// can peel off the zero index.</span></div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;    <span class="keywordflow">if</span> (DL-&gt;<a class="code" href="classllvm_1_1DataLayout.html#a1d6fcc02e91ba24510aba42660c90e29">getTypeAllocSize</a>(*GEPTI) != GEPAllocSize)</div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;    --LastOperand;</div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;  }</div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;</div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;  <span class="keywordflow">return</span> LastOperand;</div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;}</div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;<span class="keywordtype">int</span> LoopVectorizationLegality::isConsecutivePtr(<a class="code" href="classllvm_1_1Value.html">Value</a> *Ptr) {</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;  assert(Ptr-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a2eba483f5cc876e824aa6c085736086b">isPointerTy</a>() &amp;&amp; <span class="stringliteral">&quot;Unexpected non ptr&quot;</span>);</div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;  <span class="comment">// Make sure that the pointer does not point to structs.</span></div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;  <span class="keywordflow">if</span> (Ptr-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a5c09d927a0079ad16e8367271efe9bc2">getPointerElementType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a0a32c2cb0342323dc78f6aa31d7e581e">isAggregateType</a>())</div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;</div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;  <span class="comment">// If this value is a pointer induction variable we know it is consecutive.</span></div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;  <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *Phi = dyn_cast_or_null&lt;PHINode&gt;(Ptr);</div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;  <span class="keywordflow">if</span> (Phi &amp;&amp; Inductions.count(Phi)) {</div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;    InductionInfo II = Inductions[Phi];</div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;    <span class="keywordflow">if</span> (IK_PtrInduction == II.IK)</div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;      <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (IK_ReversePtrInduction == II.IK)</div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;  }</div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;</div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;  <a class="code" href="classllvm_1_1GetElementPtrInst.html">GetElementPtrInst</a> *Gep = dyn_cast_or_null&lt;GetElementPtrInst&gt;(Ptr);</div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;  <span class="keywordflow">if</span> (!Gep)</div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;</div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;  <span class="keywordtype">unsigned</span> NumOperands = Gep-&gt;<a class="code" href="classllvm_1_1User.html#a2f81e0c1fc6554df7ad2eafabf5fc5a5">getNumOperands</a>();</div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *GpPtr = Gep-&gt;<a class="code" href="classllvm_1_1GetElementPtrInst.html#ad200825f26189cd43f3b80728649c4a9">getPointerOperand</a>();</div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;  <span class="comment">// If this GEP value is a consecutive pointer induction variable and all of</span></div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;  <span class="comment">// the indices are constant then we know it is consecutive. We can</span></div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;  Phi = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1PHINode.html">PHINode</a>&gt;(GpPtr);</div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;  <span class="keywordflow">if</span> (Phi &amp;&amp; Inductions.count(Phi)) {</div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;</div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;    <span class="comment">// Make sure that the pointer does not point to structs.</span></div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;    <a class="code" href="classllvm_1_1PointerType.html">PointerType</a> *GepPtrType = cast&lt;PointerType&gt;(GpPtr-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>());</div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;    <span class="keywordflow">if</span> (GepPtrType-&gt;<a class="code" href="classllvm_1_1SequentialType.html#a39f2c3a62f293faf11ac28b15bc53359">getElementType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a0a32c2cb0342323dc78f6aa31d7e581e">isAggregateType</a>())</div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;</div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;    <span class="comment">// Make sure that all of the index operands are loop invariant.</span></div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 1; <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; NumOperands; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;      <span class="keywordflow">if</span> (!SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a5a19768af81df7e5fe571bc08dcd48b3">isLoopInvariant</a>(SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a30bd18ac905eacf3601bc6a553a9ff49">getSCEV</a>(Gep-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>)), TheLoop))</div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;        <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;</div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;    InductionInfo II = Inductions[Phi];</div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;    <span class="keywordflow">if</span> (IK_PtrInduction == II.IK)</div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;      <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (IK_ReversePtrInduction == II.IK)</div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;  }</div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;</div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;  <span class="keywordtype">unsigned</span> InductionOperand = <a class="code" href="LoopVectorize_8cpp.html#a9934327154d90155e54840cdf84df6a0">getGEPInductionOperand</a>(DL, Gep);</div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;</div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;  <span class="comment">// Check that all of the gep indices are uniform except for our induction</span></div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;  <span class="comment">// operand.</span></div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != NumOperands; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != InductionOperand &amp;&amp;</div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;        !SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a5a19768af81df7e5fe571bc08dcd48b3">isLoopInvariant</a>(SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a30bd18ac905eacf3601bc6a553a9ff49">getSCEV</a>(Gep-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>)), TheLoop))</div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;</div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;  <span class="comment">// We can emit wide load/stores only if the last non-zero index is the</span></div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;  <span class="comment">// induction variable.</span></div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *Last = SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a30bd18ac905eacf3601bc6a553a9ff49">getSCEV</a>(Gep-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(InductionOperand));</div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEVAddRecExpr.html">SCEVAddRecExpr</a> *AR = dyn_cast&lt;SCEVAddRecExpr&gt;(Last)) {</div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *Step = AR-&gt;getStepRecurrence(*SE);</div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;</div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;    <span class="comment">// The memory is consecutive because the last index is consecutive</span></div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;    <span class="comment">// and all other indices are loop invariant.</span></div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;    <span class="keywordflow">if</span> (Step-&gt;<a class="code" href="classllvm_1_1SCEV.html#a3935a9de0ebdf3dc625cfb28e35bd009">isOne</a>())</div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;      <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;    <span class="keywordflow">if</span> (Step-&gt;<a class="code" href="classllvm_1_1SCEV.html#a6e915d0a915541a818ab88b1fac7cbd1">isAllOnesValue</a>())</div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;  }</div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;</div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;}</div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;</div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;<span class="keywordtype">bool</span> LoopVectorizationLegality::isUniform(<a class="code" href="classllvm_1_1Value.html">Value</a> *V) {</div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;  <span class="keywordflow">return</span> (SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a5a19768af81df7e5fe571bc08dcd48b3">isLoopInvariant</a>(SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a30bd18ac905eacf3601bc6a553a9ff49">getSCEV</a>(V), TheLoop));</div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;}</div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;</div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;<a class="code" href="classllvm_1_1SmallVector.html">InnerLoopVectorizer::VectorParts</a>&amp;</div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;InnerLoopVectorizer::getVectorValue(<a class="code" href="classllvm_1_1Value.html">Value</a> *V) {</div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;  assert(V != Induction &amp;&amp; <span class="stringliteral">&quot;The new induction variable should not be used.&quot;</span>);</div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;  assert(!V-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a6f725580f7834e2ca90762965866dad4">isVectorTy</a>() &amp;&amp; <span class="stringliteral">&quot;Can&#39;t widen a vector&quot;</span>);</div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;</div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;  <span class="comment">// If we have this scalar in the map, return it.</span></div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;  <span class="keywordflow">if</span> (WidenMap.has(V))</div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;    <span class="keywordflow">return</span> WidenMap.get(V);</div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;</div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;  <span class="comment">// If this scalar is unknown, assume that it is a constant or that it is</span></div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;  <span class="comment">// loop invariant. Broadcast V and save the value for future uses.</span></div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="Target_2ARM_2README_8txt.html#a90cca76dd78688687e0d697679dbc799">B</a> = getBroadcastInstrs(V);</div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;  <span class="keywordflow">return</span> WidenMap.splat(V, B);</div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;}</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;</div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *InnerLoopVectorizer::reverseVector(<a class="code" href="classllvm_1_1Value.html">Value</a> *Vec) {</div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;  assert(Vec-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a6f725580f7834e2ca90762965866dad4">isVectorTy</a>() &amp;&amp; <span class="stringliteral">&quot;Invalid type&quot;</span>);</div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Constant*, 8&gt;</a> ShuffleMask;</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; VF; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;    ShuffleMask.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(Builder.getInt32(VF - <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> - 1));</div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;</div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;  <span class="keywordflow">return</span> Builder.CreateShuffleVector(Vec, <a class="code" href="classllvm_1_1UndefValue.html#a4ae5ff22b700a42bcc5d889233721335">UndefValue::get</a>(Vec-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>()),</div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;                                     <a class="code" href="classllvm_1_1ConstantVector.html#ade9fa017ca3aa82f7694a47090547bc1">ConstantVector::get</a>(ShuffleMask),</div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;                                     <span class="stringliteral">&quot;reverse&quot;</span>);</div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;}</div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;</div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;</div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;<span class="keywordtype">void</span> InnerLoopVectorizer::vectorizeMemoryInstruction(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *Instr,</div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;                                             LoopVectorizationLegality *Legal) {</div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;  <span class="comment">// Attempt to issue a wide load.</span></div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;  <a class="code" href="classllvm_1_1LoadInst.html">LoadInst</a> *LI = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1LoadInst.html">LoadInst</a>&gt;(Instr);</div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;  <a class="code" href="classllvm_1_1StoreInst.html">StoreInst</a> *SI = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1StoreInst.html">StoreInst</a>&gt;(Instr);</div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;</div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;  assert((LI || SI) &amp;&amp; <span class="stringliteral">&quot;Invalid Load/Store instruction&quot;</span>);</div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;</div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *ScalarDataTy = LI ? LI-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>() : SI-&gt;getValueOperand()-&gt;getType();</div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *DataTy = <a class="code" href="classllvm_1_1VectorType.html#ab43657ed1abe2e2ed3a6a394f233ebd0">VectorType::get</a>(ScalarDataTy, VF);</div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Ptr = LI ? LI-&gt;<a class="code" href="classllvm_1_1LoadInst.html#ad47eefa1d094f60494b6b927061ca001">getPointerOperand</a>() : SI-&gt;getPointerOperand();</div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;  <span class="keywordtype">unsigned</span> Alignment = LI ? LI-&gt;<a class="code" href="classllvm_1_1LoadInst.html#ad1168fc42bcba1b71217a4969483671a">getAlignment</a>() : SI-&gt;getAlignment();</div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;  <span class="comment">// An alignment of 0 means target abi alignment. We need to use the scalar&#39;s</span></div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;  <span class="comment">// target abi alignment in such a case.</span></div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;  <span class="keywordflow">if</span> (!Alignment)</div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;    Alignment = DL-&gt;getABITypeAlignment(ScalarDataTy);</div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;  <span class="keywordtype">unsigned</span> <a class="code" href="namespacellvm.html#a2c3c18bffdc25d969233c5448bdfe7eb">AddressSpace</a> = Ptr-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a33f9fa1a7cb21319a30836fce847c3c4">getPointerAddressSpace</a>();</div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;  <span class="keywordtype">unsigned</span> ScalarAllocatedSize = DL-&gt;getTypeAllocSize(ScalarDataTy);</div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;  <span class="keywordtype">unsigned</span> VectorElementSize = DL-&gt;getTypeStoreSize(DataTy)/VF;</div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;</div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;  <span class="keywordflow">if</span> (ScalarAllocatedSize != VectorElementSize)</div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;    <span class="keywordflow">return</span> scalarizeInstruction(Instr);</div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;</div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;  <span class="comment">// If the pointer is loop invariant or if it is non consecutive,</span></div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;  <span class="comment">// scalarize the load.</span></div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;  <span class="keywordtype">int</span> ConsecutiveStride = Legal-&gt;isConsecutivePtr(Ptr);</div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;  <span class="keywordtype">bool</span> Reverse = ConsecutiveStride &lt; 0;</div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;  <span class="keywordtype">bool</span> UniformLoad = LI &amp;&amp; Legal-&gt;isUniform(Ptr);</div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;  <span class="keywordflow">if</span> (!ConsecutiveStride || UniformLoad)</div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;    <span class="keywordflow">return</span> scalarizeInstruction(Instr);</div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;</div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;  <a class="code" href="classllvm_1_1Constant.html">Constant</a> *Zero = Builder.getInt32(0);</div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;  VectorParts &amp;Entry = WidenMap.get(Instr);</div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;</div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;  <span class="comment">// Handle consecutive loads/stores.</span></div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;  <a class="code" href="classllvm_1_1GetElementPtrInst.html">GetElementPtrInst</a> *Gep = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1GetElementPtrInst.html">GetElementPtrInst</a>&gt;(Ptr);</div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;  <span class="keywordflow">if</span> (Gep &amp;&amp; Legal-&gt;isInductionVariable(Gep-&gt;<a class="code" href="classllvm_1_1GetElementPtrInst.html#ad200825f26189cd43f3b80728649c4a9">getPointerOperand</a>())) {</div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;    setDebugLocFromInst(Builder, Gep);</div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *PtrOperand = Gep-&gt;<a class="code" href="classllvm_1_1GetElementPtrInst.html#ad200825f26189cd43f3b80728649c4a9">getPointerOperand</a>();</div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *FirstBasePtr = getVectorValue(PtrOperand)[0];</div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;    FirstBasePtr = Builder.CreateExtractElement(FirstBasePtr, Zero);</div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;</div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;    <span class="comment">// Create the new GEP with the new induction variable.</span></div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;    <a class="code" href="classllvm_1_1GetElementPtrInst.html">GetElementPtrInst</a> *Gep2 = cast&lt;GetElementPtrInst&gt;(Gep-&gt;<a class="code" href="classllvm_1_1Instruction.html#af6aad0c9ba7b8720130235c9621b55b5">clone</a>());</div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;    Gep2-&gt;<a class="code" href="classllvm_1_1User.html#a5fa9b8e1842b354f64c1ba6be0a4a17f">setOperand</a>(0, FirstBasePtr);</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;    Gep2-&gt;<a class="code" href="classllvm_1_1Value.html#a35ee267850af7c235474a8c46c7ac5af">setName</a>(<span class="stringliteral">&quot;gep.indvar.base&quot;</span>);</div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;    Ptr = Builder.Insert(Gep2);</div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Gep) {</div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;    setDebugLocFromInst(Builder, Gep);</div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;    assert(SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a5a19768af81df7e5fe571bc08dcd48b3">isLoopInvariant</a>(SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a30bd18ac905eacf3601bc6a553a9ff49">getSCEV</a>(Gep-&gt;<a class="code" href="classllvm_1_1GetElementPtrInst.html#ad200825f26189cd43f3b80728649c4a9">getPointerOperand</a>()),</div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;                               OrigLoop) &amp;&amp; <span class="stringliteral">&quot;Base ptr must be invariant&quot;</span>);</div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;</div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;    <span class="comment">// The last index does not have to be the induction. It can be</span></div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;    <span class="comment">// consecutive and be a function of the index. For example A[I+1];</span></div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;    <span class="keywordtype">unsigned</span> NumOperands = Gep-&gt;<a class="code" href="classllvm_1_1User.html#a2f81e0c1fc6554df7ad2eafabf5fc5a5">getNumOperands</a>();</div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;    <span class="keywordtype">unsigned</span> InductionOperand = <a class="code" href="LoopVectorize_8cpp.html#a9934327154d90155e54840cdf84df6a0">getGEPInductionOperand</a>(DL, Gep);</div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;    <span class="comment">// Create the new GEP with the new induction variable.</span></div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;    <a class="code" href="classllvm_1_1GetElementPtrInst.html">GetElementPtrInst</a> *Gep2 = cast&lt;GetElementPtrInst&gt;(Gep-&gt;<a class="code" href="classllvm_1_1Instruction.html#af6aad0c9ba7b8720130235c9621b55b5">clone</a>());</div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;</div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; NumOperands; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *GepOperand = Gep-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;      <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *GepOperandInst = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1Instruction.html">Instruction</a>&gt;(GepOperand);</div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;</div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;      <span class="comment">// Update last index or loop invariant instruction anchored in loop.</span></div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> == InductionOperand ||</div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;          (GepOperandInst &amp;&amp; OrigLoop-&gt;contains(GepOperandInst))) {</div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;        assert((<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> == InductionOperand ||</div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;               SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a5a19768af81df7e5fe571bc08dcd48b3">isLoopInvariant</a>(SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a30bd18ac905eacf3601bc6a553a9ff49">getSCEV</a>(GepOperandInst), OrigLoop)) &amp;&amp;</div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;               <span class="stringliteral">&quot;Must be last index or loop invariant&quot;</span>);</div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;</div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;        VectorParts &amp;GEPParts = getVectorValue(GepOperand);</div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;        <a class="code" href="classllvm_1_1Value.html">Value</a> *Index = GEPParts[0];</div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;        Index = Builder.CreateExtractElement(Index, Zero);</div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;        Gep2-&gt;<a class="code" href="classllvm_1_1User.html#a5fa9b8e1842b354f64c1ba6be0a4a17f">setOperand</a>(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>, Index);</div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;        Gep2-&gt;<a class="code" href="classllvm_1_1Value.html#a35ee267850af7c235474a8c46c7ac5af">setName</a>(<span class="stringliteral">&quot;gep.indvar.idx&quot;</span>);</div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;      }</div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;    }</div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;    Ptr = Builder.Insert(Gep2);</div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;    <span class="comment">// Use the induction element ptr.</span></div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;    assert(isa&lt;PHINode&gt;(Ptr) &amp;&amp; <span class="stringliteral">&quot;Invalid induction ptr&quot;</span>);</div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;    setDebugLocFromInst(Builder, Ptr);</div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;    VectorParts &amp;PtrVal = getVectorValue(Ptr);</div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;    Ptr = Builder.CreateExtractElement(PtrVal[0], Zero);</div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;  }</div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;</div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;  <span class="comment">// Handle Stores:</span></div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;  <span class="keywordflow">if</span> (SI) {</div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;    assert(!Legal-&gt;isUniform(SI-&gt;getPointerOperand()) &amp;&amp;</div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;           <span class="stringliteral">&quot;We do not allow storing to uniform addresses&quot;</span>);</div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;    setDebugLocFromInst(Builder, SI);</div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;    <span class="comment">// We don&#39;t want to update the value in the map as it might be used in</span></div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;    <span class="comment">// another expression. So don&#39;t use a reference type for &quot;StoredVal&quot;.</span></div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;    VectorParts StoredVal = getVectorValue(SI-&gt;getValueOperand());</div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;</div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> Part = 0; Part &lt; UF; ++Part) {</div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;      <span class="comment">// Calculate the pointer for the specific unroll-part.</span></div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *PartPtr = Builder.CreateGEP(Ptr, Builder.getInt32(Part * VF));</div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;</div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;      <span class="keywordflow">if</span> (Reverse) {</div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;        <span class="comment">// If we store to reverse consecutive memory locations then we need</span></div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;        <span class="comment">// to reverse the order of elements in the stored value.</span></div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;        StoredVal[Part] = reverseVector(StoredVal[Part]);</div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;        <span class="comment">// If the address is consecutive but reversed, then the</span></div><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;        <span class="comment">// wide store needs to start at the last vector element.</span></div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;        PartPtr = Builder.CreateGEP(Ptr, Builder.getInt32(-Part * VF));</div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;        PartPtr = Builder.CreateGEP(PartPtr, Builder.getInt32(1 - VF));</div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;      }</div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;</div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *VecPtr = Builder.CreateBitCast(PartPtr,</div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;                                            DataTy-&gt;<a class="code" href="classllvm_1_1Type.html#ab6cc070c37c59589af100aab6f48ef4f">getPointerTo</a>(AddressSpace));</div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;      Builder.CreateStore(StoredVal[Part], VecPtr)-&gt;setAlignment(Alignment);</div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;    }</div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;  }</div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;</div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;  <span class="comment">// Handle loads.</span></div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;  assert(LI &amp;&amp; <span class="stringliteral">&quot;Must have a load instruction&quot;</span>);</div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;  setDebugLocFromInst(Builder, LI);</div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> Part = 0; Part &lt; UF; ++Part) {</div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;    <span class="comment">// Calculate the pointer for the specific unroll-part.</span></div><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *PartPtr = Builder.CreateGEP(Ptr, Builder.getInt32(Part * VF));</div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;</div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;    <span class="keywordflow">if</span> (Reverse) {</div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;      <span class="comment">// If the address is consecutive but reversed, then the</span></div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;      <span class="comment">// wide store needs to start at the last vector element.</span></div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;      PartPtr = Builder.CreateGEP(Ptr, Builder.getInt32(-Part * VF));</div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;      PartPtr = Builder.CreateGEP(PartPtr, Builder.getInt32(1 - VF));</div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;    }</div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;</div><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *VecPtr = Builder.CreateBitCast(PartPtr,</div><div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;                                          DataTy-&gt;<a class="code" href="classllvm_1_1Type.html#ab6cc070c37c59589af100aab6f48ef4f">getPointerTo</a>(AddressSpace));</div><div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *LI = Builder.CreateLoad(VecPtr, <span class="stringliteral">&quot;wide.load&quot;</span>);</div><div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;    cast&lt;LoadInst&gt;(LI)-&gt;setAlignment(Alignment);</div><div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;    Entry[Part] = Reverse ? reverseVector(LI) :  LI;</div><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;  }</div><div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;}</div><div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;</div><div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;<span class="keywordtype">void</span> InnerLoopVectorizer::scalarizeInstruction(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *Instr) {</div><div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;  assert(!Instr-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a0a32c2cb0342323dc78f6aa31d7e581e">isAggregateType</a>() &amp;&amp; <span class="stringliteral">&quot;Can&#39;t handle vectors&quot;</span>);</div><div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;  <span class="comment">// Holds vector parameters or scalars, in case of uniform vals.</span></div><div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;VectorParts, 4&gt;</a> Params;</div><div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;</div><div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;  setDebugLocFromInst(Builder, Instr);</div><div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;</div><div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;  <span class="comment">// Find all of the vectorized parameters.</span></div><div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> op = 0, e = Instr-&gt;<a class="code" href="classllvm_1_1User.html#a2f81e0c1fc6554df7ad2eafabf5fc5a5">getNumOperands</a>(); op != e; ++op) {</div><div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *SrcOp = Instr-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(op);</div><div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;</div><div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;    <span class="comment">// If we are accessing the old induction variable, use the new one.</span></div><div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;    <span class="keywordflow">if</span> (SrcOp == OldInduction) {</div><div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;      Params.push_back(getVectorValue(SrcOp));</div><div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;    }</div><div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;</div><div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;    <span class="comment">// Try using previously calculated values.</span></div><div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *SrcInst = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1Instruction.html">Instruction</a>&gt;(SrcOp);</div><div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;</div><div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;    <span class="comment">// If the src is an instruction that appeared earlier in the basic block</span></div><div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;    <span class="comment">// then it should already be vectorized.</span></div><div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;    <span class="keywordflow">if</span> (SrcInst &amp;&amp; OrigLoop-&gt;contains(SrcInst)) {</div><div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;      assert(WidenMap.has(SrcInst) &amp;&amp; <span class="stringliteral">&quot;Source operand is unavailable&quot;</span>);</div><div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;      <span class="comment">// The parameter is a vector value from earlier.</span></div><div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;      Params.push_back(WidenMap.get(SrcInst));</div><div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;      <span class="comment">// The parameter is a scalar from outside the loop. Maybe even a constant.</span></div><div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;      VectorParts Scalars;</div><div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;      Scalars.append(UF, SrcOp);</div><div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;      Params.push_back(Scalars);</div><div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;    }</div><div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;  }</div><div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;</div><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;  assert(Params.size() == Instr-&gt;<a class="code" href="classllvm_1_1User.html#a2f81e0c1fc6554df7ad2eafabf5fc5a5">getNumOperands</a>() &amp;&amp;</div><div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;         <span class="stringliteral">&quot;Invalid number of operands&quot;</span>);</div><div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;</div><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;  <span class="comment">// Does this instruction return a value ?</span></div><div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;  <span class="keywordtype">bool</span> IsVoidRetTy = Instr-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#af5c7041df3ad5edffe5da17b5264c1fc">isVoidTy</a>();</div><div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;</div><div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *UndefVec = IsVoidRetTy ? 0 :</div><div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;    <a class="code" href="classllvm_1_1UndefValue.html#a4ae5ff22b700a42bcc5d889233721335">UndefValue::get</a>(<a class="code" href="classllvm_1_1VectorType.html#ab43657ed1abe2e2ed3a6a394f233ebd0">VectorType::get</a>(Instr-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>(), VF));</div><div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;  <span class="comment">// Create a new entry in the WidenMap and initialize it to Undef or Null.</span></div><div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;  VectorParts &amp;VecResults = WidenMap.splat(Instr, UndefVec);</div><div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;</div><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;  <span class="comment">// For each vector unroll &#39;part&#39;:</span></div><div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> Part = 0; Part &lt; UF; ++Part) {</div><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;    <span class="comment">// For each scalar that we create:</span></div><div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> Width = 0; Width &lt; VF; ++Width) {</div><div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;      <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *Cloned = Instr-&gt;<a class="code" href="classllvm_1_1Instruction.html#af6aad0c9ba7b8720130235c9621b55b5">clone</a>();</div><div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;      <span class="keywordflow">if</span> (!IsVoidRetTy)</div><div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;        Cloned-&gt;<a class="code" href="classllvm_1_1Value.html#a35ee267850af7c235474a8c46c7ac5af">setName</a>(Instr-&gt;<a class="code" href="classllvm_1_1Value.html#ad452febc1ac0b394876e640ec03ffa38">getName</a>() + <span class="stringliteral">&quot;.cloned&quot;</span>);</div><div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;      <span class="comment">// Replace the operands of the cloned instructions with extracted scalars.</span></div><div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> op = 0, e = Instr-&gt;<a class="code" href="classllvm_1_1User.html#a2f81e0c1fc6554df7ad2eafabf5fc5a5">getNumOperands</a>(); op != e; ++op) {</div><div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;        <a class="code" href="classllvm_1_1Value.html">Value</a> *Op = Params[op][Part];</div><div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;        <span class="comment">// Param is a vector. Need to extract the right lane.</span></div><div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;        <span class="keywordflow">if</span> (Op-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a6f725580f7834e2ca90762965866dad4">isVectorTy</a>())</div><div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;          Op = Builder.CreateExtractElement(Op, Builder.getInt32(Width));</div><div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;        Cloned-&gt;<a class="code" href="classllvm_1_1User.html#a5fa9b8e1842b354f64c1ba6be0a4a17f">setOperand</a>(op, Op);</div><div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;      }</div><div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;</div><div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;      <span class="comment">// Place the cloned scalar in the new loop.</span></div><div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;      Builder.Insert(Cloned);</div><div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;</div><div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;      <span class="comment">// If the original scalar returns a value we need to place it in a vector</span></div><div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;      <span class="comment">// so that future users will be able to use it.</span></div><div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;      <span class="keywordflow">if</span> (!IsVoidRetTy)</div><div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;        VecResults[Part] = Builder.CreateInsertElement(VecResults[Part], Cloned,</div><div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;                                                       Builder.getInt32(Width));</div><div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;    }</div><div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;  }</div><div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;}</div><div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;</div><div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *</div><div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;InnerLoopVectorizer::addRuntimeCheck(LoopVectorizationLegality *Legal,</div><div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;                                     <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *Loc) {</div><div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;  LoopVectorizationLegality::RuntimePointerCheck *PtrRtCheck =</div><div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;  Legal-&gt;getRuntimePointerCheck();</div><div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;</div><div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;  <span class="keywordflow">if</span> (!PtrRtCheck-&gt;Need)</div><div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;    <span class="keywordflow">return</span> NULL;</div><div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;</div><div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;  <span class="keywordtype">unsigned</span> NumPointers = PtrRtCheck-&gt;Pointers.size();</div><div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;TrackingVH&lt;Value&gt;</a> , 2&gt; Starts;</div><div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;TrackingVH&lt;Value&gt;</a> , 2&gt; Ends;</div><div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;</div><div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;  <a class="code" href="classllvm_1_1LLVMContext.html">LLVMContext</a> &amp;Ctx = Loc-&gt;<a class="code" href="classllvm_1_1Value.html#af85a4828b6b5a8de7fc0a55cc0e5b52f">getContext</a>();</div><div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;  <a class="code" href="classllvm_1_1SCEVExpander.html">SCEVExpander</a> Exp(*SE, <span class="stringliteral">&quot;induction&quot;</span>);</div><div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;</div><div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; NumPointers; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *Ptr = PtrRtCheck-&gt;Pointers[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div><div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *Sc = SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a30bd18ac905eacf3601bc6a553a9ff49">getSCEV</a>(Ptr);</div><div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;</div><div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;    <span class="keywordflow">if</span> (SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a5a19768af81df7e5fe571bc08dcd48b3">isLoopInvariant</a>(Sc, OrigLoop)) {</div><div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;      <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;LV: Adding RT check for a loop invariant ptr:&quot;</span> &lt;&lt;</div><div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;            *Ptr &lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;      Starts.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(Ptr);</div><div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;      Ends.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(Ptr);</div><div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;      <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;LV: Adding RT check for range:&quot;</span> &lt;&lt; *Ptr &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>);</div><div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;      <span class="keywordtype">unsigned</span> AS = Ptr-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a33f9fa1a7cb21319a30836fce847c3c4">getPointerAddressSpace</a>();</div><div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;</div><div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;      <span class="comment">// Use this type for pointer arithmetic.</span></div><div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;      <a class="code" href="classllvm_1_1Type.html">Type</a> *PtrArithTy = <a class="code" href="classllvm_1_1Type.html#a7fe9ccd4893f4e2caa826126c09545ea">Type::getInt8PtrTy</a>(Ctx, AS);</div><div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;</div><div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *Start = Exp.<a class="code" href="classllvm_1_1SCEVExpander.html#a583d3ca95f83216d632a4d1ae0330dd0">expandCodeFor</a>(PtrRtCheck-&gt;Starts[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>], PtrArithTy, Loc);</div><div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *End = Exp.<a class="code" href="classllvm_1_1SCEVExpander.html#a583d3ca95f83216d632a4d1ae0330dd0">expandCodeFor</a>(PtrRtCheck-&gt;Ends[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>], PtrArithTy, Loc);</div><div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;      Starts.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(Start);</div><div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;      Ends.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(End);</div><div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;    }</div><div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;  }</div><div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;</div><div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;  <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> ChkBuilder(Loc);</div><div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;  <span class="comment">// Our instructions might fold to a constant.</span></div><div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *MemoryRuntimeCheck = 0;</div><div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; NumPointers; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a> = <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>+1; <a class="code" href="Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a> &lt; NumPointers; ++<a class="code" href="Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a>) {</div><div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;      <span class="comment">// No need to check if two readonly pointers intersect.</span></div><div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;      <span class="keywordflow">if</span> (!PtrRtCheck-&gt;IsWritePtr[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>] &amp;&amp; !PtrRtCheck-&gt;IsWritePtr[<a class="code" href="Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a>])</div><div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;</div><div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;      <span class="comment">// Only need to check pointers between two different dependency sets.</span></div><div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;      <span class="keywordflow">if</span> (PtrRtCheck-&gt;DependencySetId[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>] == PtrRtCheck-&gt;DependencySetId[<a class="code" href="Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a>])</div><div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;       <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;</div><div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;      <span class="keywordtype">unsigned</span> AS0 = Starts[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;getType()-&gt;getPointerAddressSpace();</div><div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;      <span class="keywordtype">unsigned</span> AS1 = Starts[<a class="code" href="Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a>]-&gt;getType()-&gt;getPointerAddressSpace();</div><div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;</div><div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;      assert((AS0 == Ends[<a class="code" href="Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a>]-&gt;<a class="code" href="namespacellvm_1_1Intrinsic.html#ac015f68d60ea67a2e31bc10bc720d3e8">getType</a>()-&gt;getPointerAddressSpace()) &amp;&amp;</div><div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;             (AS1 == Ends[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;<a class="code" href="namespacellvm_1_1Intrinsic.html#ac015f68d60ea67a2e31bc10bc720d3e8">getType</a>()-&gt;getPointerAddressSpace()) &amp;&amp;</div><div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;             <span class="stringliteral">&quot;Trying to bounds check pointers with different address spaces&quot;</span>);</div><div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;</div><div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;      <a class="code" href="classllvm_1_1Type.html">Type</a> *PtrArithTy0 = <a class="code" href="classllvm_1_1Type.html#a7fe9ccd4893f4e2caa826126c09545ea">Type::getInt8PtrTy</a>(Ctx, AS0);</div><div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;      <a class="code" href="classllvm_1_1Type.html">Type</a> *PtrArithTy1 = <a class="code" href="classllvm_1_1Type.html#a7fe9ccd4893f4e2caa826126c09545ea">Type::getInt8PtrTy</a>(Ctx, AS1);</div><div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;</div><div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *Start0 = ChkBuilder.<a class="code" href="classllvm_1_1IRBuilder.html#a87b363b9dad9f5040ea7e29ea9e60ff5">CreateBitCast</a>(Starts[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>], PtrArithTy0, <span class="stringliteral">&quot;bc&quot;</span>);</div><div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *Start1 = ChkBuilder.<a class="code" href="classllvm_1_1IRBuilder.html#a87b363b9dad9f5040ea7e29ea9e60ff5">CreateBitCast</a>(Starts[<a class="code" href="Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a>], PtrArithTy1, <span class="stringliteral">&quot;bc&quot;</span>);</div><div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *End0 =   ChkBuilder.<a class="code" href="classllvm_1_1IRBuilder.html#a87b363b9dad9f5040ea7e29ea9e60ff5">CreateBitCast</a>(Ends[i],   PtrArithTy1, <span class="stringliteral">&quot;bc&quot;</span>);</div><div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *End1 =   ChkBuilder.<a class="code" href="classllvm_1_1IRBuilder.html#a87b363b9dad9f5040ea7e29ea9e60ff5">CreateBitCast</a>(Ends[j],   PtrArithTy0, <span class="stringliteral">&quot;bc&quot;</span>);</div><div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;</div><div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *Cmp0 = ChkBuilder.<a class="code" href="classllvm_1_1IRBuilder.html#afce46232afe3b97b1a586eb762f307a4">CreateICmpULE</a>(Start0, End1, <span class="stringliteral">&quot;bound0&quot;</span>);</div><div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *Cmp1 = ChkBuilder.<a class="code" href="classllvm_1_1IRBuilder.html#afce46232afe3b97b1a586eb762f307a4">CreateICmpULE</a>(Start1, End0, <span class="stringliteral">&quot;bound1&quot;</span>);</div><div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *IsConflict = ChkBuilder.<a class="code" href="classllvm_1_1IRBuilder.html#a197d5dd77cad4560a082900962a830aa">CreateAnd</a>(Cmp0, Cmp1, <span class="stringliteral">&quot;found.conflict&quot;</span>);</div><div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;      <span class="keywordflow">if</span> (MemoryRuntimeCheck)</div><div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;        IsConflict = ChkBuilder.<a class="code" href="classllvm_1_1IRBuilder.html#a8f55dd4237be6778517ddd752ca8b76a">CreateOr</a>(MemoryRuntimeCheck, IsConflict,</div><div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;                                         <span class="stringliteral">&quot;conflict.rdx&quot;</span>);</div><div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;      MemoryRuntimeCheck = IsConflict;</div><div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;    }</div><div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;  }</div><div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;</div><div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;  <span class="comment">// We have to do this trickery because the IRBuilder might fold the check to a</span></div><div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;  <span class="comment">// constant expression in which case there is no Instruction anchored in a</span></div><div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;  <span class="comment">// the block.</span></div><div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="AArch64Disassembler_8cpp.html#a5d37f23ec6bf93da60e38fda41e9a83d">Check</a> = BinaryOperator::CreateAnd(MemoryRuntimeCheck,</div><div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;                                                 <a class="code" href="classllvm_1_1ConstantInt.html#a82dbbd8e3688b0bc1eedb338864d0d0c">ConstantInt::getTrue</a>(Ctx));</div><div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;  ChkBuilder.<a class="code" href="classllvm_1_1IRBuilder.html#abd3da4c9a7bdee3fb759a06410095f75">Insert</a>(Check, <span class="stringliteral">&quot;memcheck.conflict&quot;</span>);</div><div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="AArch64Disassembler_8cpp.html#a5d37f23ec6bf93da60e38fda41e9a83d">Check</a>;</div><div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;}</div><div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;</div><div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;InnerLoopVectorizer::createEmptyLoop(LoopVectorizationLegality *Legal) {</div><div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;  <span class="comment">/*</span></div><div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;<span class="comment">   In this function we generate a new loop. The new loop will contain</span></div><div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;<span class="comment">   the vectorized instructions while the old loop will continue to run the</span></div><div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;<span class="comment">   scalar remainder.</span></div><div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;<span class="comment">       [ ] &lt;-- vector loop bypass (may consist of multiple blocks).</span></div><div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;<span class="comment">     /  |</span></div><div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;<span class="comment">    /   v</span></div><div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;<span class="comment">   |   [ ]     &lt;-- vector pre header.</span></div><div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;<span class="comment">   |    |</span></div><div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;<span class="comment">   |    v</span></div><div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;<span class="comment">   |   [  ] \</span></div><div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;<span class="comment">   |   [  ]_|   &lt;-- vector loop.</span></div><div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;<span class="comment">   |    |</span></div><div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;<span class="comment">    \   v</span></div><div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;<span class="comment">      &gt;[ ]   &lt;--- middle-block.</span></div><div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;<span class="comment">     /  |</span></div><div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;<span class="comment">    /   v</span></div><div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;<span class="comment">   |   [ ]     &lt;--- new preheader.</span></div><div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;<span class="comment">   |    |</span></div><div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;<span class="comment">   |    v</span></div><div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;<span class="comment">   |   [ ] \</span></div><div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;<span class="comment">   |   [ ]_|   &lt;-- old scalar loop to handle remainder.</span></div><div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;<span class="comment">    \   |</span></div><div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;<span class="comment">     \  v</span></div><div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;<span class="comment">      &gt;[ ]     &lt;-- exit block.</span></div><div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;<span class="comment">   ...</span></div><div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;<span class="comment">   */</span></div><div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;</div><div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *OldBasicBlock = OrigLoop-&gt;getHeader();</div><div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *BypassBlock = OrigLoop-&gt;getLoopPreheader();</div><div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *ExitBlock = OrigLoop-&gt;getExitBlock();</div><div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;  assert(ExitBlock &amp;&amp; <span class="stringliteral">&quot;Must have an exit block&quot;</span>);</div><div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;</div><div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;  <span class="comment">// Some loops have a single integer induction variable, while other loops</span></div><div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;  <span class="comment">// don&#39;t. One example is c++ iterators that often have multiple pointer</span></div><div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;  <span class="comment">// induction variables. In the code below we also support a case where we</span></div><div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;  <span class="comment">// don&#39;t have a single induction variable.</span></div><div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;  OldInduction = Legal-&gt;getInduction();</div><div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *IdxTy = Legal-&gt;getWidestInductionType();</div><div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;</div><div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;  <span class="comment">// Find the loop boundaries.</span></div><div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *ExitCount = SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#aecd7aba4460358813feef37d71d5024e">getBackedgeTakenCount</a>(OrigLoop);</div><div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;  assert(ExitCount != SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#aaa9b9055fd9c69fe14eb20f0d18d53d5">getCouldNotCompute</a>() &amp;&amp; <span class="stringliteral">&quot;Invalid loop count&quot;</span>);</div><div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;</div><div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;  <span class="comment">// The exit count might have the type of i64 while the phi is i32. This can</span></div><div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;  <span class="comment">// happen if we have an induction variable that is sign extended before the</span></div><div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;  <span class="comment">// compare. The only way that we get a backedge taken count is that the</span></div><div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;  <span class="comment">// induction variable was signed and as such will not overflow. In such a case</span></div><div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;  <span class="comment">// truncation is legal.</span></div><div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;  <span class="keywordflow">if</span> (ExitCount-&gt;<a class="code" href="classllvm_1_1SCEV.html#a9a16f1241255a605fc8debc1e26eaa4c">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a5a7cfa245af120b44ac8a86143bb9e57">getPrimitiveSizeInBits</a>() &gt;</div><div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;      IdxTy-&gt;<a class="code" href="classllvm_1_1Type.html#a5a7cfa245af120b44ac8a86143bb9e57">getPrimitiveSizeInBits</a>())</div><div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;    ExitCount = SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a426976cfd81411f49f7e5fe77ee4e3a4">getTruncateOrNoop</a>(ExitCount, IdxTy);</div><div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;</div><div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;  ExitCount = SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a933eb87303a6ce51c8894e431fbc389b">getNoopOrZeroExtend</a>(ExitCount, IdxTy);</div><div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;  <span class="comment">// Get the total trip count from the count by adding 1.</span></div><div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;  ExitCount = SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a23541ecba66207184eaf2279a70c5b12">getAddExpr</a>(ExitCount,</div><div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;                             SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a2eb94d079d8416118f4aaed865ab05d7">getConstant</a>(ExitCount-&gt;<a class="code" href="classllvm_1_1SCEV.html#a9a16f1241255a605fc8debc1e26eaa4c">getType</a>(), 1));</div><div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;</div><div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;  <span class="comment">// Expand the trip count and place the new instructions in the preheader.</span></div><div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;  <span class="comment">// Notice that the pre-header does not change, only the loop body.</span></div><div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;  <a class="code" href="classllvm_1_1SCEVExpander.html">SCEVExpander</a> Exp(*SE, <span class="stringliteral">&quot;induction&quot;</span>);</div><div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;</div><div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;  <span class="comment">// Count holds the overall loop count (N).</span></div><div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Count = Exp.<a class="code" href="classllvm_1_1SCEVExpander.html#a583d3ca95f83216d632a4d1ae0330dd0">expandCodeFor</a>(ExitCount, ExitCount-&gt;<a class="code" href="classllvm_1_1SCEV.html#a9a16f1241255a605fc8debc1e26eaa4c">getType</a>(),</div><div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;                                   BypassBlock-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a5cb76a65b6524dba1493dd2b9dc3abbe">getTerminator</a>());</div><div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;</div><div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;  <span class="comment">// The loop index does not have to start at Zero. Find the original start</span></div><div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;  <span class="comment">// value from the induction PHI node. If we don&#39;t have an induction variable</span></div><div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;  <span class="comment">// then we know that it starts at zero.</span></div><div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;  Builder.SetInsertPoint(BypassBlock-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a5cb76a65b6524dba1493dd2b9dc3abbe">getTerminator</a>());</div><div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *StartIdx = ExtendedIdx = OldInduction ?</div><div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;    Builder.CreateZExt(OldInduction-&gt;getIncomingValueForBlock(BypassBlock),</div><div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;                       IdxTy):</div><div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;    <a class="code" href="classllvm_1_1ConstantInt.html#a9105541412dab869e18b3cceebfff07d">ConstantInt::get</a>(IdxTy, 0);</div><div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;</div><div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;  assert(BypassBlock &amp;&amp; <span class="stringliteral">&quot;Invalid loop structure&quot;</span>);</div><div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;  LoopBypassBlocks.push_back(BypassBlock);</div><div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;</div><div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;  <span class="comment">// Split the single block loop into the two loop structure described above.</span></div><div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *VectorPH =</div><div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;  BypassBlock-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a19445f836d9e1ecb32cba27ec4338fff">splitBasicBlock</a>(BypassBlock-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a5cb76a65b6524dba1493dd2b9dc3abbe">getTerminator</a>(), <span class="stringliteral">&quot;vector.ph&quot;</span>);</div><div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *VecBody =</div><div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;  VectorPH-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a19445f836d9e1ecb32cba27ec4338fff">splitBasicBlock</a>(VectorPH-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a5cb76a65b6524dba1493dd2b9dc3abbe">getTerminator</a>(), <span class="stringliteral">&quot;vector.body&quot;</span>);</div><div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *MiddleBlock =</div><div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;  VecBody-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a19445f836d9e1ecb32cba27ec4338fff">splitBasicBlock</a>(VecBody-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a5cb76a65b6524dba1493dd2b9dc3abbe">getTerminator</a>(), <span class="stringliteral">&quot;middle.block&quot;</span>);</div><div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *ScalarPH =</div><div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;  MiddleBlock-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a19445f836d9e1ecb32cba27ec4338fff">splitBasicBlock</a>(MiddleBlock-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a5cb76a65b6524dba1493dd2b9dc3abbe">getTerminator</a>(), <span class="stringliteral">&quot;scalar.ph&quot;</span>);</div><div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;</div><div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;  <span class="comment">// Create and register the new vector loop.</span></div><div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;  <a class="code" href="classllvm_1_1Loop.html">Loop</a>* Lp = <span class="keyword">new</span> <a class="code" href="namespacellvm_1_1GC.html#a5f606a2b04c809f789a574660cd25213a960eba6a93af558b44d3d14e8393d324">Loop</a>();</div><div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;  <a class="code" href="classllvm_1_1Loop.html">Loop</a> *ParentLoop = OrigLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a1431766de798501f107d9031821f311e">getParentLoop</a>();</div><div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;</div><div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;  <span class="comment">// Insert the new loop into the loop nest and register the new basic blocks</span></div><div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;  <span class="comment">// before calling any utilities such as SCEV that require valid LoopInfo.</span></div><div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;  <span class="keywordflow">if</span> (ParentLoop) {</div><div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;    ParentLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a990a86b0de7a84a9f489d2034878e330">addChildLoop</a>(Lp);</div><div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;    ParentLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a63f099d3bf7cf97eb3ae2d630e3d1afc">addBasicBlockToLoop</a>(ScalarPH, LI-&gt;getBase());</div><div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;    ParentLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a63f099d3bf7cf97eb3ae2d630e3d1afc">addBasicBlockToLoop</a>(VectorPH, LI-&gt;getBase());</div><div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;    ParentLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a63f099d3bf7cf97eb3ae2d630e3d1afc">addBasicBlockToLoop</a>(MiddleBlock, LI-&gt;getBase());</div><div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;    LI-&gt;addTopLevelLoop(Lp);</div><div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;  }</div><div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;  Lp-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a63f099d3bf7cf97eb3ae2d630e3d1afc">addBasicBlockToLoop</a>(VecBody, LI-&gt;getBase());</div><div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;</div><div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;  <span class="comment">// Use this IR builder to create the loop instructions (Phi, Br, Cmp)</span></div><div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;  <span class="comment">// inside the loop.</span></div><div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;  Builder.SetInsertPoint(VecBody-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a0e73f4e09745bb69fdd7b15232c45428">getFirstNonPHI</a>());</div><div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;</div><div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;  <span class="comment">// Generate the induction variable.</span></div><div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;  setDebugLocFromInst(Builder, getDebugLocFromInstOrOperands(OldInduction));</div><div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;  Induction = Builder.CreatePHI(IdxTy, 2, <span class="stringliteral">&quot;index&quot;</span>);</div><div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;  <span class="comment">// The loop step is equal to the vectorization factor (num of SIMD elements)</span></div><div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;  <span class="comment">// times the unroll factor (num of SIMD instructions).</span></div><div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;  <a class="code" href="classllvm_1_1Constant.html">Constant</a> *Step = <a class="code" href="classllvm_1_1ConstantInt.html#a9105541412dab869e18b3cceebfff07d">ConstantInt::get</a>(IdxTy, VF * UF);</div><div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;</div><div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;  <span class="comment">// This is the IR builder that we use to add all of the logic for bypassing</span></div><div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;  <span class="comment">// the new vector loop.</span></div><div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;  <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> BypassBuilder(BypassBlock-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a5cb76a65b6524dba1493dd2b9dc3abbe">getTerminator</a>());</div><div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;  setDebugLocFromInst(BypassBuilder,</div><div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;                      getDebugLocFromInstOrOperands(OldInduction));</div><div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;</div><div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;  <span class="comment">// We may need to extend the index in case there is a type mismatch.</span></div><div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;  <span class="comment">// We know that the count starts at zero and does not overflow.</span></div><div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;  <span class="keywordflow">if</span> (Count-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>() != IdxTy) {</div><div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;    <span class="comment">// The exit count can be of pointer type. Convert it to the correct</span></div><div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;    <span class="comment">// integer type.</span></div><div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;    <span class="keywordflow">if</span> (ExitCount-&gt;<a class="code" href="classllvm_1_1SCEV.html#a9a16f1241255a605fc8debc1e26eaa4c">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a2eba483f5cc876e824aa6c085736086b">isPointerTy</a>())</div><div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;      Count = BypassBuilder.CreatePointerCast(Count, IdxTy, <span class="stringliteral">&quot;ptrcnt.to.int&quot;</span>);</div><div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;      Count = BypassBuilder.CreateZExtOrTrunc(Count, IdxTy, <span class="stringliteral">&quot;cnt.cast&quot;</span>);</div><div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;  }</div><div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;</div><div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;  <span class="comment">// Add the start index to the loop count to get the new end index.</span></div><div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *IdxEnd = BypassBuilder.CreateAdd(Count, StartIdx, <span class="stringliteral">&quot;end.idx&quot;</span>);</div><div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;</div><div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;  <span class="comment">// Now we need to generate the expression for N - (N % VF), which is</span></div><div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;  <span class="comment">// the part that the vectorized body will execute.</span></div><div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *R = BypassBuilder.CreateURem(Count, Step, <span class="stringliteral">&quot;n.mod.vf&quot;</span>);</div><div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *CountRoundDown = BypassBuilder.CreateSub(Count, R, <span class="stringliteral">&quot;n.vec&quot;</span>);</div><div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *IdxEndRoundDown = BypassBuilder.CreateAdd(CountRoundDown, StartIdx,</div><div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;                                                     <span class="stringliteral">&quot;end.idx.rnd.down&quot;</span>);</div><div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;</div><div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;  <span class="comment">// Now, compare the new count to zero. If it is zero skip the vector loop and</span></div><div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;  <span class="comment">// jump to the scalar loop.</span></div><div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Cmp = BypassBuilder.CreateICmpEQ(IdxEndRoundDown, StartIdx,</div><div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;                                          <span class="stringliteral">&quot;cmp.zero&quot;</span>);</div><div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;</div><div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *LastBypassBlock = BypassBlock;</div><div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;</div><div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;  <span class="comment">// Generate the code that checks in runtime if arrays overlap. We put the</span></div><div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;  <span class="comment">// checks into a separate block to make the more common case of few elements</span></div><div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;  <span class="comment">// faster.</span></div><div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *MemRuntimeCheck = addRuntimeCheck(Legal,</div><div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;                                                 BypassBlock-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a5cb76a65b6524dba1493dd2b9dc3abbe">getTerminator</a>());</div><div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;  <span class="keywordflow">if</span> (MemRuntimeCheck) {</div><div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;    <span class="comment">// Create a new block containing the memory check.</span></div><div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;    <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *CheckBlock = BypassBlock-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a19445f836d9e1ecb32cba27ec4338fff">splitBasicBlock</a>(MemRuntimeCheck,</div><div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;                                                          <span class="stringliteral">&quot;vector.memcheck&quot;</span>);</div><div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;    <span class="keywordflow">if</span> (ParentLoop)</div><div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;      ParentLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a63f099d3bf7cf97eb3ae2d630e3d1afc">addBasicBlockToLoop</a>(CheckBlock, LI-&gt;getBase());</div><div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;    LoopBypassBlocks.push_back(CheckBlock);</div><div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;</div><div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;    <span class="comment">// Replace the branch into the memory check block with a conditional branch</span></div><div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;    <span class="comment">// for the &quot;few elements case&quot;.</span></div><div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *OldTerm = BypassBlock-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a5cb76a65b6524dba1493dd2b9dc3abbe">getTerminator</a>();</div><div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;    <a class="code" href="classllvm_1_1BranchInst.html#ae9cbc599309fd2da33ec1c61df01ce1f">BranchInst::Create</a>(MiddleBlock, CheckBlock, Cmp, OldTerm);</div><div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;    OldTerm-&gt;<a class="code" href="classllvm_1_1Instruction.html#a6fe2f06b8a4b2c3d6308afb223a0238a">eraseFromParent</a>();</div><div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;</div><div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;    Cmp = MemRuntimeCheck;</div><div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;    LastBypassBlock = CheckBlock;</div><div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;  }</div><div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;</div><div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;  LastBypassBlock-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a5cb76a65b6524dba1493dd2b9dc3abbe">getTerminator</a>()-&gt;<a class="code" href="classllvm_1_1Instruction.html#a6fe2f06b8a4b2c3d6308afb223a0238a">eraseFromParent</a>();</div><div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;  <a class="code" href="classllvm_1_1BranchInst.html#ae9cbc599309fd2da33ec1c61df01ce1f">BranchInst::Create</a>(MiddleBlock, VectorPH, Cmp,</div><div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;                     LastBypassBlock);</div><div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;</div><div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;  <span class="comment">// We are going to resume the execution of the scalar loop.</span></div><div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;  <span class="comment">// Go over all of the induction variables that we found and fix the</span></div><div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;  <span class="comment">// PHIs that are left in the scalar version of the loop.</span></div><div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;  <span class="comment">// The starting values of PHI nodes depend on the counter of the last</span></div><div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;  <span class="comment">// iteration in the vectorized loop.</span></div><div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;  <span class="comment">// If we come from a bypass edge then we need to start from the original</span></div><div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;  <span class="comment">// start value.</span></div><div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;</div><div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;  <span class="comment">// This variable saves the new starting index for the scalar loop.</span></div><div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;  <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *ResumeIndex = 0;</div><div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;  <a class="code" href="classllvm_1_1MapVector.html#a63222e22bd798c7db94246adbb9cf2be">LoopVectorizationLegality::InductionList::iterator</a> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, E;</div><div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;  <a class="code" href="classllvm_1_1MapVector.html">LoopVectorizationLegality::InductionList</a> *<a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5afef9bccea014fbcc9d61070cb7dbb5ff">List</a> = Legal-&gt;getInductionVars();</div><div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;  <span class="comment">// Set builder to point to last bypass block.</span></div><div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;  BypassBuilder.SetInsertPoint(LoopBypassBlocks.back()-&gt;getTerminator());</div><div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;  <span class="keywordflow">for</span> (I = List-&gt;<a class="code" href="classllvm_1_1MapVector.html#aa610cab7ee61e36a6d1d122fc252c278">begin</a>(), E = List-&gt;<a class="code" href="classllvm_1_1MapVector.html#a0881334358ff6ff7ff8cea5562c7988e">end</a>(); I != E; ++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div><div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;    <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *OrigPhi = I-&gt;first;</div><div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;    LoopVectorizationLegality::InductionInfo II = I-&gt;second;</div><div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;</div><div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;    <a class="code" href="classllvm_1_1Type.html">Type</a> *ResumeValTy = (OrigPhi == OldInduction) ? IdxTy : OrigPhi-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>();</div><div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;    <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *ResumeVal = <a class="code" href="classllvm_1_1PHINode.html#afb5e83bf5123ff7c51058eb0ebebcdc6">PHINode::Create</a>(ResumeValTy, 2, <span class="stringliteral">&quot;resume.val&quot;</span>,</div><div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;                                         MiddleBlock-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a5cb76a65b6524dba1493dd2b9dc3abbe">getTerminator</a>());</div><div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;    <span class="comment">// We might have extended the type of the induction variable but we need a</span></div><div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;    <span class="comment">// truncated version for the scalar loop.</span></div><div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;    <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *TruncResumeVal = (OrigPhi == OldInduction) ?</div><div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;      <a class="code" href="classllvm_1_1PHINode.html#afb5e83bf5123ff7c51058eb0ebebcdc6">PHINode::Create</a>(OrigPhi-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>(), 2, <span class="stringliteral">&quot;trunc.resume.val&quot;</span>,</div><div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;                      MiddleBlock-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a5cb76a65b6524dba1493dd2b9dc3abbe">getTerminator</a>()) : 0;</div><div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;</div><div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *EndValue = 0;</div><div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;    <span class="keywordflow">switch</span> (II.IK) {</div><div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;    <span class="keywordflow">case</span> LoopVectorizationLegality::IK_NoInduction:</div><div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;      <a class="code" href="ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a>(<span class="stringliteral">&quot;Unknown induction&quot;</span>);</div><div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;    <span class="keywordflow">case</span> LoopVectorizationLegality::IK_IntInduction: {</div><div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;      <span class="comment">// Handle the integer induction counter.</span></div><div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;      assert(OrigPhi-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a6e328feb83afa5cf1c966d6704e43fc1">isIntegerTy</a>() &amp;&amp; <span class="stringliteral">&quot;Invalid type&quot;</span>);</div><div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;</div><div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;      <span class="comment">// We have the canonical induction variable.</span></div><div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;      <span class="keywordflow">if</span> (OrigPhi == OldInduction) {</div><div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;        <span class="comment">// Create a truncated version of the resume value for the scalar loop,</span></div><div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;        <span class="comment">// we might have promoted the type to a larger width.</span></div><div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;        EndValue =</div><div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;          BypassBuilder.CreateTrunc(IdxEndRoundDown, OrigPhi-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>());</div><div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;        <span class="comment">// The new PHI merges the original incoming value, in case of a bypass,</span></div><div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;        <span class="comment">// or the value at the end of the vectorized loop.</span></div><div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> I = 0, E = LoopBypassBlocks.size(); I != E; ++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)</div><div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;          TruncResumeVal-&gt;addIncoming(II.StartValue, LoopBypassBlocks[I]);</div><div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;        TruncResumeVal-&gt;addIncoming(EndValue, VecBody);</div><div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;</div><div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;        <span class="comment">// We know what the end value is.</span></div><div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;        EndValue = IdxEndRoundDown;</div><div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;        <span class="comment">// We also know which PHI node holds it.</span></div><div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;        ResumeIndex = ResumeVal;</div><div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;      }</div><div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;</div><div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;      <span class="comment">// Not the canonical induction variable - add the vector loop count to the</span></div><div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;      <span class="comment">// start value.</span></div><div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *CRD = BypassBuilder.CreateSExtOrTrunc(CountRoundDown,</div><div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;                                                   II.StartValue-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>(),</div><div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;                                                   <span class="stringliteral">&quot;cast.crd&quot;</span>);</div><div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;      EndValue = BypassBuilder.CreateAdd(CRD, II.StartValue , <span class="stringliteral">&quot;ind.end&quot;</span>);</div><div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;    }</div><div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;    <span class="keywordflow">case</span> LoopVectorizationLegality::IK_ReverseIntInduction: {</div><div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;      <span class="comment">// Convert the CountRoundDown variable to the PHI size.</span></div><div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *CRD = BypassBuilder.CreateSExtOrTrunc(CountRoundDown,</div><div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;                                                   II.StartValue-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>(),</div><div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;                                                   <span class="stringliteral">&quot;cast.crd&quot;</span>);</div><div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;      <span class="comment">// Handle reverse integer induction counter.</span></div><div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;      EndValue = BypassBuilder.CreateSub(II.StartValue, CRD, <span class="stringliteral">&quot;rev.ind.end&quot;</span>);</div><div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;    }</div><div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;    <span class="keywordflow">case</span> LoopVectorizationLegality::IK_PtrInduction: {</div><div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;      <span class="comment">// For pointer induction variables, calculate the offset using</span></div><div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;      <span class="comment">// the end index.</span></div><div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;      EndValue = BypassBuilder.CreateGEP(II.StartValue, CountRoundDown,</div><div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;                                         <span class="stringliteral">&quot;ptr.ind.end&quot;</span>);</div><div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;    }</div><div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;    <span class="keywordflow">case</span> LoopVectorizationLegality::IK_ReversePtrInduction: {</div><div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;      <span class="comment">// The value at the end of the loop for the reverse pointer is calculated</span></div><div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;      <span class="comment">// by creating a GEP with a negative index starting from the start value.</span></div><div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *Zero = <a class="code" href="classllvm_1_1ConstantInt.html#a9105541412dab869e18b3cceebfff07d">ConstantInt::get</a>(CountRoundDown-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>(), 0);</div><div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *NegIdx = BypassBuilder.CreateSub(Zero, CountRoundDown,</div><div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;                                              <span class="stringliteral">&quot;rev.ind.end&quot;</span>);</div><div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;      EndValue = BypassBuilder.CreateGEP(II.StartValue, NegIdx,</div><div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;                                         <span class="stringliteral">&quot;rev.ptr.ind.end&quot;</span>);</div><div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;    }</div><div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;    }<span class="comment">// end of case</span></div><div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;</div><div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;    <span class="comment">// The new PHI merges the original incoming value, in case of a bypass,</span></div><div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;    <span class="comment">// or the value at the end of the vectorized loop.</span></div><div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> I = 0, E = LoopBypassBlocks.size(); I != E; ++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div><div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;      <span class="keywordflow">if</span> (OrigPhi == OldInduction)</div><div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;        ResumeVal-&gt;<a class="code" href="classllvm_1_1PHINode.html#a089cccb6f231efee72abc76d0f9c695f">addIncoming</a>(StartIdx, LoopBypassBlocks[I]);</div><div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;        ResumeVal-&gt;<a class="code" href="classllvm_1_1PHINode.html#a089cccb6f231efee72abc76d0f9c695f">addIncoming</a>(II.StartValue, LoopBypassBlocks[I]);</div><div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;    }</div><div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;    ResumeVal-&gt;<a class="code" href="classllvm_1_1PHINode.html#a089cccb6f231efee72abc76d0f9c695f">addIncoming</a>(EndValue, VecBody);</div><div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;</div><div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;    <span class="comment">// Fix the scalar body counter (PHI node).</span></div><div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;    <span class="keywordtype">unsigned</span> BlockIdx = OrigPhi-&gt;<a class="code" href="classllvm_1_1PHINode.html#a5c2b7d7f19aac93b27b845858a7eb73e">getBasicBlockIndex</a>(ScalarPH);</div><div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;    <span class="comment">// The old inductions phi node in the scalar body needs the truncated value.</span></div><div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;    <span class="keywordflow">if</span> (OrigPhi == OldInduction)</div><div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;      OrigPhi-&gt;<a class="code" href="classllvm_1_1PHINode.html#a88cdefb709309eddc6e5daca0be6a7b4">setIncomingValue</a>(BlockIdx, TruncResumeVal);</div><div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;      OrigPhi-&gt;<a class="code" href="classllvm_1_1PHINode.html#a88cdefb709309eddc6e5daca0be6a7b4">setIncomingValue</a>(BlockIdx, ResumeVal);</div><div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;  }</div><div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;</div><div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;  <span class="comment">// If we are generating a new induction variable then we also need to</span></div><div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;  <span class="comment">// generate the code that calculates the exit value. This value is not</span></div><div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;  <span class="comment">// simply the end of the counter because we may skip the vectorized body</span></div><div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;  <span class="comment">// in case of a runtime check.</span></div><div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;  <span class="keywordflow">if</span> (!OldInduction){</div><div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;    assert(!ResumeIndex &amp;&amp; <span class="stringliteral">&quot;Unexpected resume value found&quot;</span>);</div><div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;    ResumeIndex = <a class="code" href="classllvm_1_1PHINode.html#afb5e83bf5123ff7c51058eb0ebebcdc6">PHINode::Create</a>(IdxTy, 2, <span class="stringliteral">&quot;new.indc.resume.val&quot;</span>,</div><div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;                                  MiddleBlock-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a5cb76a65b6524dba1493dd2b9dc3abbe">getTerminator</a>());</div><div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> I = 0, E = LoopBypassBlocks.size(); I != E; ++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)</div><div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;      ResumeIndex-&gt;<a class="code" href="classllvm_1_1PHINode.html#a089cccb6f231efee72abc76d0f9c695f">addIncoming</a>(StartIdx, LoopBypassBlocks[I]);</div><div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;    ResumeIndex-&gt;<a class="code" href="classllvm_1_1PHINode.html#a089cccb6f231efee72abc76d0f9c695f">addIncoming</a>(IdxEndRoundDown, VecBody);</div><div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;  }</div><div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;</div><div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;  <span class="comment">// Make sure that we found the index where scalar loop needs to continue.</span></div><div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;  assert(ResumeIndex &amp;&amp; ResumeIndex-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a6e328feb83afa5cf1c966d6704e43fc1">isIntegerTy</a>() &amp;&amp;</div><div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;         <span class="stringliteral">&quot;Invalid resume Index&quot;</span>);</div><div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;</div><div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;  <span class="comment">// Add a check in the middle block to see if we have completed</span></div><div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;  <span class="comment">// all of the iterations in the first vector loop.</span></div><div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;  <span class="comment">// If (N - N%VF) == N, then we *don&#39;t* need to run the remainder.</span></div><div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *CmpN = <a class="code" href="classllvm_1_1CmpInst.html#a4cd12603c3c76eb84d050733f6ddc8b7">CmpInst::Create</a>(Instruction::ICmp, <a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05aa719225e2de4059f93fd3209e1f48218">CmpInst::ICMP_EQ</a>, IdxEnd,</div><div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;                                ResumeIndex, <span class="stringliteral">&quot;cmp.n&quot;</span>,</div><div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;                                MiddleBlock-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a5cb76a65b6524dba1493dd2b9dc3abbe">getTerminator</a>());</div><div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;</div><div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;  <a class="code" href="classllvm_1_1BranchInst.html#ae9cbc599309fd2da33ec1c61df01ce1f">BranchInst::Create</a>(ExitBlock, ScalarPH, CmpN, MiddleBlock-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a5cb76a65b6524dba1493dd2b9dc3abbe">getTerminator</a>());</div><div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;  <span class="comment">// Remove the old terminator.</span></div><div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;  MiddleBlock-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a5cb76a65b6524dba1493dd2b9dc3abbe">getTerminator</a>()-&gt;<a class="code" href="classllvm_1_1Instruction.html#a6fe2f06b8a4b2c3d6308afb223a0238a">eraseFromParent</a>();</div><div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;</div><div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;  <span class="comment">// Create i+1 and fill the PHINode.</span></div><div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *NextIdx = Builder.CreateAdd(Induction, Step, <span class="stringliteral">&quot;index.next&quot;</span>);</div><div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;  Induction-&gt;addIncoming(StartIdx, VectorPH);</div><div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;  Induction-&gt;addIncoming(NextIdx, VecBody);</div><div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;  <span class="comment">// Create the compare.</span></div><div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *ICmp = Builder.CreateICmpEQ(NextIdx, IdxEndRoundDown);</div><div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;  Builder.CreateCondBr(ICmp, MiddleBlock, VecBody);</div><div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;</div><div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;  <span class="comment">// Now we have two terminators. Remove the old one from the block.</span></div><div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;  VecBody-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a5cb76a65b6524dba1493dd2b9dc3abbe">getTerminator</a>()-&gt;<a class="code" href="classllvm_1_1Instruction.html#a6fe2f06b8a4b2c3d6308afb223a0238a">eraseFromParent</a>();</div><div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;</div><div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;  <span class="comment">// Get ready to start creating new instructions into the vectorized body.</span></div><div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;  Builder.SetInsertPoint(VecBody-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#ab1cd5a3713b93a33f89a2086d473cf6e">getFirstInsertionPt</a>());</div><div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;</div><div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;  <span class="comment">// Save the state.</span></div><div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;  LoopVectorPreHeader = VectorPH;</div><div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;  LoopScalarPreHeader = ScalarPH;</div><div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;  LoopMiddleBlock = MiddleBlock;</div><div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;  LoopExitBlock = ExitBlock;</div><div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;  LoopVectorBody = VecBody;</div><div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;  LoopScalarBody = OldBasicBlock;</div><div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;</div><div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;  LoopVectorizeHints Hints(Lp, <span class="keyword">true</span>);</div><div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;  Hints.setAlreadyVectorized(Lp);</div><div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;}</div><div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;<span class="comment">/// This function returns the identity element (or neutral element) for</span></div><div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;<span class="comment">/// the operation K.</span></div><div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;<span class="comment"></span><a class="code" href="classllvm_1_1Constant.html">Constant</a>*</div><div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;LoopVectorizationLegality::getReductionIdentity(ReductionKind K, <a class="code" href="classllvm_1_1Type.html">Type</a> *Tp) {</div><div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;  <span class="keywordflow">switch</span> (K) {</div><div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;  <span class="keywordflow">case</span> RK_IntegerXor:</div><div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;  <span class="keywordflow">case</span> RK_IntegerAdd:</div><div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;  <span class="keywordflow">case</span> RK_IntegerOr:</div><div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;    <span class="comment">// Adding, Xoring, Oring zero to a number does not change it.</span></div><div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1ConstantInt.html#a9105541412dab869e18b3cceebfff07d">ConstantInt::get</a>(Tp, 0);</div><div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;  <span class="keywordflow">case</span> RK_IntegerMult:</div><div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;    <span class="comment">// Multiplying a number by 1 does not change it.</span></div><div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1ConstantInt.html#a9105541412dab869e18b3cceebfff07d">ConstantInt::get</a>(Tp, 1);</div><div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;  <span class="keywordflow">case</span> RK_IntegerAnd:</div><div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;    <span class="comment">// AND-ing a number with an all-1 value does not change it.</span></div><div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1ConstantInt.html#a9105541412dab869e18b3cceebfff07d">ConstantInt::get</a>(Tp, -1, <span class="keyword">true</span>);</div><div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;  <span class="keywordflow">case</span>  RK_FloatMult:</div><div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;    <span class="comment">// Multiplying a number by 1 does not change it.</span></div><div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1ConstantFP.html#a5eb8f7a5d3cfdd127ad9db2e425e14eb">ConstantFP::get</a>(Tp, 1.0L);</div><div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;  <span class="keywordflow">case</span>  RK_FloatAdd:</div><div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;    <span class="comment">// Adding zero to a number does not change it.</span></div><div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1ConstantFP.html#a5eb8f7a5d3cfdd127ad9db2e425e14eb">ConstantFP::get</a>(Tp, 0.0L);</div><div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;  <span class="keywordflow">default</span>:</div><div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;    <a class="code" href="ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a>(<span class="stringliteral">&quot;Unknown reduction kind&quot;</span>);</div><div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;  }</div><div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;}</div><div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;</div><div class="line"><a name="l01862"></a><span class="lineno"><a class="line" href="LoopVectorize_8cpp.html#abdb1bd0a614004fa8015e9c449670b42"> 1862</a></span>&#160;<span class="keyword">static</span> <a class="code" href="namespacellvm_1_1Intrinsic.html#a73349916f7e54a6b988a3646c7a02e90">Intrinsic::ID</a> <a class="code" href="LoopVectorize_8cpp.html#abdb1bd0a614004fa8015e9c449670b42">checkUnaryFloatSignature</a>(<span class="keyword">const</span> <a class="code" href="classllvm_1_1CallInst.html">CallInst</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>,</div><div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;                                              <a class="code" href="namespacellvm_1_1Intrinsic.html#a73349916f7e54a6b988a3646c7a02e90">Intrinsic::ID</a> ValidIntrinsicID) {</div><div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;  <span class="keywordflow">if</span> (I.<a class="code" href="classllvm_1_1CallInst.html#ac88b95273e6c753188f6a54d65548579">getNumArgOperands</a>() != 1 ||</div><div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;      !I.<a class="code" href="classllvm_1_1CallInst.html#a150b33ecedbc8c7803c2db8040fbe3f8">getArgOperand</a>(0)-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a40113570b0c52a18c34cabed8359e2c8">isFloatingPointTy</a>() ||</div><div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;      I.<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>() != I.<a class="code" href="classllvm_1_1CallInst.html#a150b33ecedbc8c7803c2db8040fbe3f8">getArgOperand</a>(0)-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>() ||</div><div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;      !I.<a class="code" href="classllvm_1_1CallInst.html#adfa58cca12e39889c36ca2aa668e68b2">onlyReadsMemory</a>())</div><div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1Intrinsic.html#a73349916f7e54a6b988a3646c7a02e90aab5fb650050f184fa7c19c26abde5226">Intrinsic::not_intrinsic</a>;</div><div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;</div><div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;  <span class="keywordflow">return</span> ValidIntrinsicID;</div><div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;}</div><div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;</div><div class="line"><a name="l01873"></a><span class="lineno"><a class="line" href="LoopVectorize_8cpp.html#a040f109a39db8077a2dd926dd8fb4206"> 1873</a></span>&#160;<span class="keyword">static</span> <a class="code" href="namespacellvm_1_1Intrinsic.html#a73349916f7e54a6b988a3646c7a02e90">Intrinsic::ID</a> <a class="code" href="LoopVectorize_8cpp.html#a040f109a39db8077a2dd926dd8fb4206">checkBinaryFloatSignature</a>(<span class="keyword">const</span> <a class="code" href="classllvm_1_1CallInst.html">CallInst</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>,</div><div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;                                               <a class="code" href="namespacellvm_1_1Intrinsic.html#a73349916f7e54a6b988a3646c7a02e90">Intrinsic::ID</a> ValidIntrinsicID) {</div><div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;  <span class="keywordflow">if</span> (I.<a class="code" href="classllvm_1_1CallInst.html#ac88b95273e6c753188f6a54d65548579">getNumArgOperands</a>() != 2 ||</div><div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;      !I.<a class="code" href="classllvm_1_1CallInst.html#a150b33ecedbc8c7803c2db8040fbe3f8">getArgOperand</a>(0)-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a40113570b0c52a18c34cabed8359e2c8">isFloatingPointTy</a>() ||</div><div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;      !I.<a class="code" href="classllvm_1_1CallInst.html#a150b33ecedbc8c7803c2db8040fbe3f8">getArgOperand</a>(1)-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a40113570b0c52a18c34cabed8359e2c8">isFloatingPointTy</a>() ||</div><div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;      I.<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>() != I.<a class="code" href="classllvm_1_1CallInst.html#a150b33ecedbc8c7803c2db8040fbe3f8">getArgOperand</a>(0)-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>() ||</div><div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;      I.<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>() != I.<a class="code" href="classllvm_1_1CallInst.html#a150b33ecedbc8c7803c2db8040fbe3f8">getArgOperand</a>(1)-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>() ||</div><div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;      !I.<a class="code" href="classllvm_1_1CallInst.html#adfa58cca12e39889c36ca2aa668e68b2">onlyReadsMemory</a>())</div><div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1Intrinsic.html#a73349916f7e54a6b988a3646c7a02e90aab5fb650050f184fa7c19c26abde5226">Intrinsic::not_intrinsic</a>;</div><div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;</div><div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;  <span class="keywordflow">return</span> ValidIntrinsicID;</div><div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;}</div><div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;</div><div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;</div><div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;<span class="keyword">static</span> <a class="code" href="namespacellvm_1_1Intrinsic.html#a73349916f7e54a6b988a3646c7a02e90">Intrinsic::ID</a></div><div class="line"><a name="l01888"></a><span class="lineno"><a class="line" href="LoopVectorize_8cpp.html#a417c0c66aeccfcbee14042ec89bab074"> 1888</a></span>&#160;<a class="code" href="LoopVectorize_8cpp.html#a417c0c66aeccfcbee14042ec89bab074">getIntrinsicIDForCall</a>(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI, <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetLibraryInfo.html">TargetLibraryInfo</a> *TLI) {</div><div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;  <span class="comment">// If we have an intrinsic call, check if it is trivially vectorizable.</span></div><div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1IntrinsicInst.html">IntrinsicInst</a> *II = dyn_cast&lt;IntrinsicInst&gt;(CI)) {</div><div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;    <span class="keywordflow">switch</span> (II-&gt;getIntrinsicID()) {</div><div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1Intrinsic.html#a73349916f7e54a6b988a3646c7a02e90a2282198fc9635210d0f678fd0b92e5ce">Intrinsic::sqrt</a>:</div><div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1Intrinsic.html#a73349916f7e54a6b988a3646c7a02e90afcac7d7dd4a11e3e7fa5c08757f2db40">Intrinsic::sin</a>:</div><div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1Intrinsic.html#a73349916f7e54a6b988a3646c7a02e90a8acf62dbfb8a84e6e5edd4a0be9c3e4c">Intrinsic::cos</a>:</div><div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1Intrinsic.html#a73349916f7e54a6b988a3646c7a02e90aa3d4911fd70a787382c691646d119ff4">Intrinsic::exp</a>:</div><div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1Intrinsic.html#a73349916f7e54a6b988a3646c7a02e90a7a35a0c20884a2a1b608229116ff92b1">Intrinsic::exp2</a>:</div><div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1Intrinsic.html#a73349916f7e54a6b988a3646c7a02e90ae8381623b66af7d8e29f051b8d03ea93">Intrinsic::log</a>:</div><div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1Intrinsic.html#a73349916f7e54a6b988a3646c7a02e90a9435bd14da4637e66589624ea43fa758">Intrinsic::log10</a>:</div><div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1Intrinsic.html#a73349916f7e54a6b988a3646c7a02e90af7d48287addfbfdc4bcd296efbc44e4e">Intrinsic::log2</a>:</div><div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1Intrinsic.html#a73349916f7e54a6b988a3646c7a02e90ae5cfc8e1a94b46b64a26f1a6cb4e6ba0">Intrinsic::fabs</a>:</div><div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1Intrinsic.html#a73349916f7e54a6b988a3646c7a02e90a11ad781c8e6b52fd3c123f7cf2f43db0">Intrinsic::copysign</a>:</div><div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1Intrinsic.html#a73349916f7e54a6b988a3646c7a02e90aa5e3272cd3a1252dab94b777ec25e949">Intrinsic::floor</a>:</div><div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1Intrinsic.html#a73349916f7e54a6b988a3646c7a02e90a2107ef535957e9ea31e1fc60f5716e03">Intrinsic::ceil</a>:</div><div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1Intrinsic.html#a73349916f7e54a6b988a3646c7a02e90afcf978f83f97f765943aa6b0b679eb1d">Intrinsic::trunc</a>:</div><div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1Intrinsic.html#a73349916f7e54a6b988a3646c7a02e90a42b08bce2f24e45c11b2afeef6db32d4">Intrinsic::rint</a>:</div><div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1Intrinsic.html#a73349916f7e54a6b988a3646c7a02e90a3f406d8b74c8f3009ee1fee5172b1415">Intrinsic::nearbyint</a>:</div><div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1Intrinsic.html#a73349916f7e54a6b988a3646c7a02e90a731d303bf0e4c2bf8bfe546590cd8352">Intrinsic::round</a>:</div><div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1Intrinsic.html#a73349916f7e54a6b988a3646c7a02e90af387c9295462cb7394f13fc3b9276dc0">Intrinsic::pow</a>:</div><div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1Intrinsic.html#a73349916f7e54a6b988a3646c7a02e90ab4c5fed3774fc563c9b252d3483f56d2">Intrinsic::fma</a>:</div><div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1Intrinsic.html#a73349916f7e54a6b988a3646c7a02e90a6956cc565c902dea387b502b54fa9f18">Intrinsic::fmuladd</a>:</div><div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1Intrinsic.html#a73349916f7e54a6b988a3646c7a02e90ae365354e47542c51f9bd46e329e3323e">Intrinsic::lifetime_start</a>:</div><div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1Intrinsic.html#a73349916f7e54a6b988a3646c7a02e90aa332b90dd5e4ebf4bbbcc0964220d373">Intrinsic::lifetime_end</a>:</div><div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;      <span class="keywordflow">return</span> II-&gt;getIntrinsicID();</div><div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;    <span class="keywordflow">default</span>:</div><div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1Intrinsic.html#a73349916f7e54a6b988a3646c7a02e90aab5fb650050f184fa7c19c26abde5226">Intrinsic::not_intrinsic</a>;</div><div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;    }</div><div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;  }</div><div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;</div><div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;  <span class="keywordflow">if</span> (!TLI)</div><div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1Intrinsic.html#a73349916f7e54a6b988a3646c7a02e90aab5fb650050f184fa7c19c26abde5226">Intrinsic::not_intrinsic</a>;</div><div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;</div><div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;  <a class="code" href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6f">LibFunc::Func</a> <a class="code" href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6f">Func</a>;</div><div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;  <a class="code" href="classllvm_1_1Function.html">Function</a> *<a class="code" href="LLParser_8cpp.html#a33ece1ef8074506a15d7f86eb76dbae6">F</a> = CI-&gt;<a class="code" href="classllvm_1_1CallInst.html#a0bcd4131e1a1d92215f5385b4e16cd2e">getCalledFunction</a>();</div><div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;  <span class="comment">// We&#39;re going to make assumptions on the semantics of the functions, check</span></div><div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;  <span class="comment">// that the target knows that it&#39;s available in this environment and it does</span></div><div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;  <span class="comment">// not have local linkage.</span></div><div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;  <span class="keywordflow">if</span> (!F || F-&gt;<a class="code" href="classllvm_1_1GlobalValue.html#abefc2d8baa67d6f9e49c95912cfde480">hasLocalLinkage</a>() || !TLI-&gt;<a class="code" href="classllvm_1_1TargetLibraryInfo.html#a2e29ccd61341a821011294b733173fda">getLibFunc</a>(F-&gt;<a class="code" href="classllvm_1_1Value.html#ad452febc1ac0b394876e640ec03ffa38">getName</a>(), <a class="code" href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6f">Func</a>))</div><div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1Intrinsic.html#a73349916f7e54a6b988a3646c7a02e90aab5fb650050f184fa7c19c26abde5226">Intrinsic::not_intrinsic</a>;</div><div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;</div><div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;  <span class="comment">// Otherwise check if we have a call to a function that can be turned into a</span></div><div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;  <span class="comment">// vector intrinsic.</span></div><div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;  <span class="keywordflow">switch</span> (Func) {</div><div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;  <span class="keywordflow">default</span>:</div><div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fa7187926b06529564381106c98bd3a1b7">LibFunc::sin</a>:</div><div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fa57aee1773b8300e2ad207948eaffd566">LibFunc::sinf</a>:</div><div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fa3e0dfbf297df565a836b7263a922146a">LibFunc::sinl</a>:</div><div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="LoopVectorize_8cpp.html#abdb1bd0a614004fa8015e9c449670b42">checkUnaryFloatSignature</a>(*CI, <a class="code" href="namespacellvm_1_1Intrinsic.html#a73349916f7e54a6b988a3646c7a02e90afcac7d7dd4a11e3e7fa5c08757f2db40">Intrinsic::sin</a>);</div><div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fab5ad1d91e85f029b6fa7ee26cbb9e122">LibFunc::cos</a>:</div><div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6facbe67d9e2920bce533f6874be1fe34c5">LibFunc::cosf</a>:</div><div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fae21b44ea5af90d5a8682f5f7242146e7">LibFunc::cosl</a>:</div><div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="LoopVectorize_8cpp.html#abdb1bd0a614004fa8015e9c449670b42">checkUnaryFloatSignature</a>(*CI, <a class="code" href="namespacellvm_1_1Intrinsic.html#a73349916f7e54a6b988a3646c7a02e90a8acf62dbfb8a84e6e5edd4a0be9c3e4c">Intrinsic::cos</a>);</div><div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fa29e412513f719e77341b9a59c0ec4efd">LibFunc::exp</a>:</div><div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fa961ece50208c300ef05a2a3d0f727545">LibFunc::expf</a>:</div><div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fadb44221ce904c9dc8c7763a11576edd8">LibFunc::expl</a>:</div><div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="LoopVectorize_8cpp.html#abdb1bd0a614004fa8015e9c449670b42">checkUnaryFloatSignature</a>(*CI, <a class="code" href="namespacellvm_1_1Intrinsic.html#a73349916f7e54a6b988a3646c7a02e90aa3d4911fd70a787382c691646d119ff4">Intrinsic::exp</a>);</div><div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fa1e752b4eaa4c9db56a2bbcef82f934b9">LibFunc::exp2</a>:</div><div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fa05508f8c6ed5aa858e634f44bebeabf9">LibFunc::exp2f</a>:</div><div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fa59bb423c84bc9293df624f68bad35332">LibFunc::exp2l</a>:</div><div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="LoopVectorize_8cpp.html#abdb1bd0a614004fa8015e9c449670b42">checkUnaryFloatSignature</a>(*CI, <a class="code" href="namespacellvm_1_1Intrinsic.html#a73349916f7e54a6b988a3646c7a02e90a7a35a0c20884a2a1b608229116ff92b1">Intrinsic::exp2</a>);</div><div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fafa3f73bf84a733da4c5652bd21b378a9">LibFunc::log</a>:</div><div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fa3c97ccd58dc11bb1fcb8f3864db3c5ee">LibFunc::logf</a>:</div><div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fa2b4d1af9a93856b794d542815d091176">LibFunc::logl</a>:</div><div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="LoopVectorize_8cpp.html#abdb1bd0a614004fa8015e9c449670b42">checkUnaryFloatSignature</a>(*CI, <a class="code" href="namespacellvm_1_1Intrinsic.html#a73349916f7e54a6b988a3646c7a02e90ae8381623b66af7d8e29f051b8d03ea93">Intrinsic::log</a>);</div><div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fa59df814479e1f13712ebb50a1159bd19">LibFunc::log10</a>:</div><div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fa44e103850c4472c7e43280c5252cde20">LibFunc::log10f</a>:</div><div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fa646f887eab0ba44958ccc8092b0d9199">LibFunc::log10l</a>:</div><div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="LoopVectorize_8cpp.html#abdb1bd0a614004fa8015e9c449670b42">checkUnaryFloatSignature</a>(*CI, <a class="code" href="namespacellvm_1_1Intrinsic.html#a73349916f7e54a6b988a3646c7a02e90a9435bd14da4637e66589624ea43fa758">Intrinsic::log10</a>);</div><div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fa881ba9a89b3bc1f75154c0b3e4abea7a">LibFunc::log2</a>:</div><div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fa4bd06237ec73d9b75b468fb61e75431f">LibFunc::log2f</a>:</div><div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fa7297eb46d831890d559d86805c768ac7">LibFunc::log2l</a>:</div><div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="LoopVectorize_8cpp.html#abdb1bd0a614004fa8015e9c449670b42">checkUnaryFloatSignature</a>(*CI, <a class="code" href="namespacellvm_1_1Intrinsic.html#a73349916f7e54a6b988a3646c7a02e90af7d48287addfbfdc4bcd296efbc44e4e">Intrinsic::log2</a>);</div><div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6faf3a65ea3339861d41948aa2de71ba2e4">LibFunc::fabs</a>:</div><div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6faf017b93d43a8de0d5fe5680131ec14d6">LibFunc::fabsf</a>:</div><div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fa311d355a7612d8ed79a9d1f8c3f734fa">LibFunc::fabsl</a>:</div><div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="LoopVectorize_8cpp.html#abdb1bd0a614004fa8015e9c449670b42">checkUnaryFloatSignature</a>(*CI, <a class="code" href="namespacellvm_1_1Intrinsic.html#a73349916f7e54a6b988a3646c7a02e90ae5cfc8e1a94b46b64a26f1a6cb4e6ba0">Intrinsic::fabs</a>);</div><div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6faa5f74d0f4796907f9845103b1f6a61db">LibFunc::copysign</a>:</div><div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fa6ec6b6b12fc6ba736e06a66d72311cd8">LibFunc::copysignf</a>:</div><div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6faa32cd0d3fa29f9018cfc2fd19bc9c8a2">LibFunc::copysignl</a>:</div><div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="LoopVectorize_8cpp.html#a040f109a39db8077a2dd926dd8fb4206">checkBinaryFloatSignature</a>(*CI, <a class="code" href="namespacellvm_1_1Intrinsic.html#a73349916f7e54a6b988a3646c7a02e90a11ad781c8e6b52fd3c123f7cf2f43db0">Intrinsic::copysign</a>);</div><div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fa56063a1f5d567e59c1b1dbdd82307afc">LibFunc::floor</a>:</div><div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fa20f8ff9bd73cb5ab622f77719667f70e">LibFunc::floorf</a>:</div><div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fa0a95274b8e56005845287ff568140a9c">LibFunc::floorl</a>:</div><div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="LoopVectorize_8cpp.html#abdb1bd0a614004fa8015e9c449670b42">checkUnaryFloatSignature</a>(*CI, <a class="code" href="namespacellvm_1_1Intrinsic.html#a73349916f7e54a6b988a3646c7a02e90aa5e3272cd3a1252dab94b777ec25e949">Intrinsic::floor</a>);</div><div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6faa782c4e760a1f85a047f0f445fe9a166">LibFunc::ceil</a>:</div><div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fabeff2268736aa278b16443193ca13ba5">LibFunc::ceilf</a>:</div><div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fa16fd74479c27fa3280666ad302ab4a5a">LibFunc::ceill</a>:</div><div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="LoopVectorize_8cpp.html#abdb1bd0a614004fa8015e9c449670b42">checkUnaryFloatSignature</a>(*CI, <a class="code" href="namespacellvm_1_1Intrinsic.html#a73349916f7e54a6b988a3646c7a02e90a2107ef535957e9ea31e1fc60f5716e03">Intrinsic::ceil</a>);</div><div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fad0a09e2728a769f54ffea5bb54747daa">LibFunc::trunc</a>:</div><div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fa782a4bc8f1f44e735a02061b84af3ae0">LibFunc::truncf</a>:</div><div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fa726f30bb43659dee0803fffe6f883133">LibFunc::truncl</a>:</div><div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="LoopVectorize_8cpp.html#abdb1bd0a614004fa8015e9c449670b42">checkUnaryFloatSignature</a>(*CI, <a class="code" href="namespacellvm_1_1Intrinsic.html#a73349916f7e54a6b988a3646c7a02e90afcf978f83f97f765943aa6b0b679eb1d">Intrinsic::trunc</a>);</div><div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fa7d3fc30f043c58272273d77c908d5db8">LibFunc::rint</a>:</div><div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fa1a6ee879e869cf6071a4db1631239795">LibFunc::rintf</a>:</div><div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fa80047f1595abe8bc418ead050262f341">LibFunc::rintl</a>:</div><div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="LoopVectorize_8cpp.html#abdb1bd0a614004fa8015e9c449670b42">checkUnaryFloatSignature</a>(*CI, <a class="code" href="namespacellvm_1_1Intrinsic.html#a73349916f7e54a6b988a3646c7a02e90a42b08bce2f24e45c11b2afeef6db32d4">Intrinsic::rint</a>);</div><div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fa7b4b4719f17bfc590fe1f8726d049e30">LibFunc::nearbyint</a>:</div><div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fa067808435d99404a97c5be8b8790a639">LibFunc::nearbyintf</a>:</div><div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fa91ad52fe1d8397138fc997534a2e3297">LibFunc::nearbyintl</a>:</div><div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="LoopVectorize_8cpp.html#abdb1bd0a614004fa8015e9c449670b42">checkUnaryFloatSignature</a>(*CI, <a class="code" href="namespacellvm_1_1Intrinsic.html#a73349916f7e54a6b988a3646c7a02e90a3f406d8b74c8f3009ee1fee5172b1415">Intrinsic::nearbyint</a>);</div><div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fac87ea230161f1f2247a5f72da886a23d">LibFunc::round</a>:</div><div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fa617cf64238cf2b7352a32bcc1babedf0">LibFunc::roundf</a>:</div><div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fa1f784d198f8bfe8a27ebc1f72d739161">LibFunc::roundl</a>:</div><div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="LoopVectorize_8cpp.html#abdb1bd0a614004fa8015e9c449670b42">checkUnaryFloatSignature</a>(*CI, <a class="code" href="namespacellvm_1_1Intrinsic.html#a73349916f7e54a6b988a3646c7a02e90a731d303bf0e4c2bf8bfe546590cd8352">Intrinsic::round</a>);</div><div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fa3f6287461c2cfdc3ad7b2c9a67ee27fd">LibFunc::pow</a>:</div><div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fa62c8dfa59caa8250b9c988b6d49fc18c">LibFunc::powf</a>:</div><div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fa859af3ad03ff3b3116d2158c652fbab9">LibFunc::powl</a>:</div><div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="LoopVectorize_8cpp.html#a040f109a39db8077a2dd926dd8fb4206">checkBinaryFloatSignature</a>(*CI, <a class="code" href="namespacellvm_1_1Intrinsic.html#a73349916f7e54a6b988a3646c7a02e90af387c9295462cb7394f13fc3b9276dc0">Intrinsic::pow</a>);</div><div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;  }</div><div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;</div><div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1Intrinsic.html#a73349916f7e54a6b988a3646c7a02e90aab5fb650050f184fa7c19c26abde5226">Intrinsic::not_intrinsic</a>;</div><div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;}</div><div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;<span class="comment">/// This function translates the reduction kind to an LLVM binary operator.</span></div><div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">unsigned</span></div><div class="line"><a name="l02006"></a><span class="lineno"><a class="line" href="LoopVectorize_8cpp.html#a71e2ca53c4dead6e5f91af3320e40499"> 2006</a></span>&#160;<a class="code" href="LoopVectorize_8cpp.html#a71e2ca53c4dead6e5f91af3320e40499">getReductionBinOp</a>(LoopVectorizationLegality::ReductionKind <a class="code" href="namespacellvm_1_1EngineKind.html#a9df47239a42cd9621ac26d9ecbd57441">Kind</a>) {</div><div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;  <span class="keywordflow">switch</span> (Kind) {</div><div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;    <span class="keywordflow">case</span> LoopVectorizationLegality::RK_IntegerAdd:</div><div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;      <span class="keywordflow">return</span> Instruction::Add;</div><div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;    <span class="keywordflow">case</span> LoopVectorizationLegality::RK_IntegerMult:</div><div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;      <span class="keywordflow">return</span> Instruction::Mul;</div><div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;    <span class="keywordflow">case</span> LoopVectorizationLegality::RK_IntegerOr:</div><div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1APIntOps.html#a22f056804d2b9882f74adc905872bc39">Instruction::Or</a>;</div><div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;    <span class="keywordflow">case</span> LoopVectorizationLegality::RK_IntegerAnd:</div><div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1APIntOps.html#a684cfe02c582e8d75cd6d457e63e6c25">Instruction::And</a>;</div><div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;    <span class="keywordflow">case</span> LoopVectorizationLegality::RK_IntegerXor:</div><div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1APIntOps.html#afc7c4d88d09cba0c5e920f8a3a3ace55">Instruction::Xor</a>;</div><div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;    <span class="keywordflow">case</span> LoopVectorizationLegality::RK_FloatMult:</div><div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;      <span class="keywordflow">return</span> Instruction::FMul;</div><div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;    <span class="keywordflow">case</span> LoopVectorizationLegality::RK_FloatAdd:</div><div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;      <span class="keywordflow">return</span> Instruction::FAdd;</div><div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;    <span class="keywordflow">case</span> LoopVectorizationLegality::RK_IntegerMinMax:</div><div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;      <span class="keywordflow">return</span> Instruction::ICmp;</div><div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;    <span class="keywordflow">case</span> LoopVectorizationLegality::RK_FloatMinMax:</div><div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;      <span class="keywordflow">return</span> Instruction::FCmp;</div><div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;    <span class="keywordflow">default</span>:</div><div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;      <a class="code" href="ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a>(<span class="stringliteral">&quot;Unknown reduction operation&quot;</span>);</div><div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;  }</div><div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;}</div><div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;</div><div class="line"><a name="l02031"></a><span class="lineno"><a class="line" href="LoopVectorize_8cpp.html#a07903be1ff7f0dbad4df2f2f19b8703d"> 2031</a></span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="LoopVectorize_8cpp.html#a07903be1ff7f0dbad4df2f2f19b8703d">createMinMaxOp</a>(<a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> &amp;Builder,</div><div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;                      LoopVectorizationLegality::MinMaxReductionKind RK,</div><div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;                      <a class="code" href="classllvm_1_1Value.html">Value</a> *Left,</div><div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;                      <a class="code" href="classllvm_1_1Value.html">Value</a> *Right) {</div><div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;  <a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05">CmpInst::Predicate</a> <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a> = <a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05ac17897ebf2f6a6986280fc3bdf28a30a">CmpInst::ICMP_NE</a>;</div><div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;  <span class="keywordflow">switch</span> (RK) {</div><div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;  <span class="keywordflow">default</span>:</div><div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;    <a class="code" href="ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a>(<span class="stringliteral">&quot;Unknown min/max reduction kind&quot;</span>);</div><div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;  <span class="keywordflow">case</span> LoopVectorizationLegality::MRK_UIntMin:</div><div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;    P = <a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05a91d86a4753c8bd7624e01bf565d87f8e">CmpInst::ICMP_ULT</a>;</div><div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;  <span class="keywordflow">case</span> LoopVectorizationLegality::MRK_UIntMax:</div><div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;    P = <a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05a607cecdc5172814382033e001ed11fad">CmpInst::ICMP_UGT</a>;</div><div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;  <span class="keywordflow">case</span> LoopVectorizationLegality::MRK_SIntMin:</div><div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;    P = <a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05a15ae464950ac676919c2f0c7aafc706c">CmpInst::ICMP_SLT</a>;</div><div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;  <span class="keywordflow">case</span> LoopVectorizationLegality::MRK_SIntMax:</div><div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;    P = <a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05a720a42e85f7e981afd61e28473b0000a">CmpInst::ICMP_SGT</a>;</div><div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;  <span class="keywordflow">case</span> LoopVectorizationLegality::MRK_FloatMin:</div><div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;    P = <a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05a326bee0a4a424cef21c1cf8adb8b8dd8">CmpInst::FCMP_OLT</a>;</div><div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;  <span class="keywordflow">case</span> LoopVectorizationLegality::MRK_FloatMax:</div><div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;    P = <a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05a4c399f525bbcf03d72af4b303e6eeca8">CmpInst::FCMP_OGT</a>;</div><div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;  }</div><div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;</div><div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Cmp;</div><div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;  <span class="keywordflow">if</span> (RK == LoopVectorizationLegality::MRK_FloatMin ||</div><div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;      RK == LoopVectorizationLegality::MRK_FloatMax)</div><div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;    Cmp = Builder.<a class="code" href="classllvm_1_1IRBuilder.html#a88cc5a48bb4170aa6541c7c6364e03b5">CreateFCmp</a>(P, Left, Right, <span class="stringliteral">&quot;rdx.minmax.cmp&quot;</span>);</div><div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;    Cmp = Builder.<a class="code" href="classllvm_1_1IRBuilder.html#a495d91fb3d2662acbffd0162c56153ed">CreateICmp</a>(P, Left, Right, <span class="stringliteral">&quot;rdx.minmax.cmp&quot;</span>);</div><div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;</div><div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1MCID.html#a8035044d40d3758eb45b65dce69dc90ba32dbd2c72a98eaee90e3ad5ef7b5af16">Select</a> = Builder.<a class="code" href="classllvm_1_1IRBuilder.html#ae19d9d49f39d404703b42161ce788954">CreateSelect</a>(Cmp, Left, Right, <span class="stringliteral">&quot;rdx.minmax.select&quot;</span>);</div><div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1MCID.html#a8035044d40d3758eb45b65dce69dc90ba32dbd2c72a98eaee90e3ad5ef7b5af16">Select</a>;</div><div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;}</div><div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;</div><div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;<span class="keyword">namespace </span>{</div><div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;<span class="keyword">struct </span>CSEDenseMapInfo {</div><div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">bool</span> canHandle(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div><div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;    <span class="keywordflow">return</span> isa&lt;InsertElementInst&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) || isa&lt;ExtractElementInst&gt;(I) ||</div><div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;           isa&lt;ShuffleVectorInst&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) || isa&lt;GetElementPtrInst&gt;(I);</div><div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;  }</div><div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;  <span class="keyword">static</span> <span class="keyword">inline</span> <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *getEmptyKey() {</div><div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="structllvm_1_1DenseMapInfo.html">DenseMapInfo&lt;Instruction *&gt;::getEmptyKey</a>();</div><div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;  }</div><div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;  <span class="keyword">static</span> <span class="keyword">inline</span> <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *getTombstoneKey() {</div><div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="structllvm_1_1DenseMapInfo.html">DenseMapInfo&lt;Instruction *&gt;::getTombstoneKey</a>();</div><div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;  }</div><div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">unsigned</span> getHashValue(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *I) {</div><div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;    assert(canHandle(I) &amp;&amp; <span class="stringliteral">&quot;Unknown instruction!&quot;</span>);</div><div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#a2b33f2166f38124ec3081c2fd59672f7">hash_combine</a>(I-&gt;<a class="code" href="classllvm_1_1Instruction.html#a021bb7c9aad6003fe8089f6327356c6c">getOpcode</a>(), <a class="code" href="namespacellvm.html#af80edfc5e42059e045aa7bf7fe42bee3">hash_combine_range</a>(I-&gt;<a class="code" href="classllvm_1_1User.html#ad93396a26f6fd589ed400bb280319836">value_op_begin</a>(),</div><div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;                                                           I-&gt;<a class="code" href="classllvm_1_1User.html#a5d1730a173d0a69624b80e1e22e6d225">value_op_end</a>()));</div><div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;  }</div><div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">bool</span> isEqual(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *LHS, <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *RHS) {</div><div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;    <span class="keywordflow">if</span> (LHS == getEmptyKey() || RHS == getEmptyKey() ||</div><div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;        LHS == getTombstoneKey() || RHS == getTombstoneKey())</div><div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;      <span class="keywordflow">return</span> LHS == RHS;</div><div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;    <span class="keywordflow">return</span> LHS-&gt;<a class="code" href="classllvm_1_1Instruction.html#ac72e0be80ec7138a1ec42c798b249981">isIdenticalTo</a>(RHS);</div><div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;  }</div><div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;};</div><div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;}</div><div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;<span class="comment">///\brief Perform cse of induction variable instructions.</span></div><div class="line"><a name="l02097"></a><span class="lineno"><a class="line" href="LoopVectorize_8cpp.html#acc13ee8b8985399901ac09b51822e21a"> 2097</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="LoopVectorize_8cpp.html#acc13ee8b8985399901ac09b51822e21a">cse</a>(<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>) {</div><div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;  <span class="comment">// Perform simple cse.</span></div><div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;  <a class="code" href="classllvm_1_1SmallDenseMap.html">SmallDenseMap&lt;Instruction *, Instruction *, 4, CSEDenseMapInfo&gt;</a> CSEMap;</div><div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1ilist__iterator.html">BasicBlock::iterator</a> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = BB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a0ed5f3ab3c2e4196ee0cffffa080c062">begin</a>(), E = BB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a0b4e7bee9b8575cc7db73329f1a561bd">end</a>(); <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> != E;) {</div><div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5a5fa7b4069ef3bd1ceb9f2caa315cf5ac">In</a> = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>++;</div><div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;</div><div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;    <span class="keywordflow">if</span> (!CSEDenseMapInfo::canHandle(In))</div><div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;</div><div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;    <span class="comment">// Check if we can replace this instruction with any of the</span></div><div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;    <span class="comment">// visited instructions.</span></div><div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *V = CSEMap.<a class="code" href="classllvm_1_1DenseMapBase.html#acfd7cc74125222a81c02b4097ed5166c">lookup</a>(In)) {</div><div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;      In-&gt;<a class="code" href="classllvm_1_1Value.html#a3ab5fc45117b450e8bb04e564cb6e5f2">replaceAllUsesWith</a>(V);</div><div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;      In-&gt;<a class="code" href="classllvm_1_1Instruction.html#a6fe2f06b8a4b2c3d6308afb223a0238a">eraseFromParent</a>();</div><div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;    }</div><div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;</div><div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;    CSEMap[<a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5a5fa7b4069ef3bd1ceb9f2caa315cf5ac">In</a>] = <a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5a5fa7b4069ef3bd1ceb9f2caa315cf5ac">In</a>;</div><div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;  }</div><div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;}</div><div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;</div><div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;InnerLoopVectorizer::vectorizeLoop(LoopVectorizationLegality *Legal) {</div><div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;  <span class="comment">//===------------------------------------------------===//</span></div><div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;  <span class="comment">//</span></div><div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;  <span class="comment">// Notice: any optimization or new instruction that go</span></div><div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;  <span class="comment">// into the code below should be also be implemented in</span></div><div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;  <span class="comment">// the cost-model.</span></div><div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;  <span class="comment">//</span></div><div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;  <span class="comment">//===------------------------------------------------===//</span></div><div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;  <a class="code" href="classllvm_1_1Constant.html">Constant</a> *Zero = Builder.getInt32(0);</div><div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;</div><div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;  <span class="comment">// In order to support reduction variables we need to be able to vectorize</span></div><div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;  <span class="comment">// Phi nodes. Phi nodes have cycles, so we need to vectorize them in two</span></div><div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;  <span class="comment">// stages. First, we create a new vector PHI node with no incoming edges.</span></div><div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;  <span class="comment">// We use this value when we vectorize all of the instructions that use the</span></div><div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;  <span class="comment">// PHI. Next, after all of the instructions in the block are complete we</span></div><div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;  <span class="comment">// add the new incoming edges to the PHI. At this point all of the</span></div><div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;  <span class="comment">// instructions in the basic block are vectorized, so we can use them to</span></div><div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;  <span class="comment">// construct the PHI.</span></div><div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;  PhiVector RdxPHIsToFix;</div><div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;</div><div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;  <span class="comment">// Scan the loop in a topological order to ensure that defs are vectorized</span></div><div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;  <span class="comment">// before users.</span></div><div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;  <a class="code" href="classllvm_1_1LoopBlocksDFS.html">LoopBlocksDFS</a> DFS(OrigLoop);</div><div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;  DFS.<a class="code" href="classllvm_1_1LoopBlocksDFS.html#ab38fc97602eaec1838f2b86624001ae1">perform</a>(LI);</div><div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;</div><div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;  <span class="comment">// Vectorize all of the blocks in the original loop.</span></div><div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1LoopBlocksDFS.html#a0c1bb1134650f3f69f5921d57fb50b78">LoopBlocksDFS::RPOIterator</a> <a class="code" href="Target_2X86_2README_8txt.html#ac9423a63151469d95755528cceb322fb">bb</a> = DFS.<a class="code" href="classllvm_1_1LoopBlocksDFS.html#a68caba9c5912b27ddbf05e2541ec4aaf">beginRPO</a>(),</div><div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;       <a class="code" href="CodeGen_2README_8txt.html#aa0629dbc89f0868f62da8cbcb681b2be">be</a> = DFS.<a class="code" href="classllvm_1_1LoopBlocksDFS.html#a7d9c121f1346f2c68017838acb57c7e8">endRPO</a>(); <a class="code" href="Target_2X86_2README_8txt.html#ac9423a63151469d95755528cceb322fb">bb</a> != <a class="code" href="CodeGen_2README_8txt.html#aa0629dbc89f0868f62da8cbcb681b2be">be</a>; ++<a class="code" href="Target_2X86_2README_8txt.html#ac9423a63151469d95755528cceb322fb">bb</a>)</div><div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;    vectorizeBlockInLoop(Legal, *<a class="code" href="Target_2X86_2README_8txt.html#ac9423a63151469d95755528cceb322fb">bb</a>, &amp;RdxPHIsToFix);</div><div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;</div><div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;  <span class="comment">// At this point every instruction in the original loop is widened to</span></div><div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;  <span class="comment">// a vector form. We are almost done. Now, we need to fix the PHI nodes</span></div><div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;  <span class="comment">// that we vectorized. The PHI nodes are currently empty because we did</span></div><div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;  <span class="comment">// not want to introduce cycles. Notice that the remaining PHI nodes</span></div><div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;  <span class="comment">// that we need to fix are reduction variables.</span></div><div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;</div><div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;  <span class="comment">// Create the &#39;reduced&#39; values for each of the induction vars.</span></div><div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;  <span class="comment">// The reduced values are the vector values that we scalarize and combine</span></div><div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;  <span class="comment">// after the loop is finished.</span></div><div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;  <span class="keywordflow">for</span> (PhiVector::iterator <a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a> = RdxPHIsToFix.begin(), e = RdxPHIsToFix.end();</div><div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;       <a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a> != e; ++<a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a>) {</div><div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;    <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *RdxPhi = *<a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a>;</div><div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;    assert(RdxPhi &amp;&amp; <span class="stringliteral">&quot;Unable to recover vectorized PHI&quot;</span>);</div><div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;</div><div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;    <span class="comment">// Find the reduction variable descriptor.</span></div><div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;    assert(Legal-&gt;getReductionVars()-&gt;count(RdxPhi) &amp;&amp;</div><div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;           <span class="stringliteral">&quot;Unable to find the reduction variable&quot;</span>);</div><div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;    LoopVectorizationLegality::ReductionDescriptor RdxDesc =</div><div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;    (*Legal-&gt;getReductionVars())[RdxPhi];</div><div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;</div><div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;    setDebugLocFromInst(Builder, RdxDesc.StartValue);</div><div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;</div><div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;    <span class="comment">// We need to generate a reduction vector from the incoming scalar.</span></div><div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;    <span class="comment">// To do so, we need to generate the &#39;identity&#39; vector and overide</span></div><div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;    <span class="comment">// one of the elements with the incoming scalar reduction. We need</span></div><div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;    <span class="comment">// to do it in the vector-loop preheader.</span></div><div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;    Builder.SetInsertPoint(LoopBypassBlocks.front()-&gt;getTerminator());</div><div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;</div><div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;    <span class="comment">// This is the vector-clone of the value that leaves the loop.</span></div><div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;    VectorParts &amp;VectorExit = getVectorValue(RdxDesc.LoopExitInstr);</div><div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;    <a class="code" href="classllvm_1_1Type.html">Type</a> *VecTy = VectorExit[0]-&gt;getType();</div><div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;</div><div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;    <span class="comment">// Find the reduction identity variable. Zero for addition, or, xor,</span></div><div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;    <span class="comment">// one for multiplication, -1 for And.</span></div><div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *Identity;</div><div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *VectorStart;</div><div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;    <span class="keywordflow">if</span> (RdxDesc.Kind == LoopVectorizationLegality::RK_IntegerMinMax ||</div><div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;        RdxDesc.Kind == LoopVectorizationLegality::RK_FloatMinMax) {</div><div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;      <span class="comment">// MinMax reduction have the start value as their identify.</span></div><div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;      <span class="keywordflow">if</span> (VF == 1) {</div><div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;        VectorStart = Identity = RdxDesc.StartValue;</div><div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;        VectorStart = Identity = Builder.CreateVectorSplat(VF,</div><div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;                                                           RdxDesc.StartValue,</div><div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;                                                           <span class="stringliteral">&quot;minmax.ident&quot;</span>);</div><div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;      }</div><div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;      <span class="comment">// Handle other reduction kinds:</span></div><div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;      <a class="code" href="classllvm_1_1Constant.html">Constant</a> *Iden =</div><div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;      LoopVectorizationLegality::getReductionIdentity(RdxDesc.Kind,</div><div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;                                                      VecTy-&gt;<a class="code" href="classllvm_1_1Type.html#a8eafa71cf399da8f21b2af5549f3f9e7">getScalarType</a>());</div><div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;      <span class="keywordflow">if</span> (VF == 1) {</div><div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;        Identity = Iden;</div><div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;        <span class="comment">// This vector is the Identity vector where the first element is the</span></div><div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;        <span class="comment">// incoming scalar reduction.</span></div><div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;        VectorStart = RdxDesc.StartValue;</div><div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;        Identity = <a class="code" href="classllvm_1_1ConstantVector.html#a5ce0c10fc8f570a6411da209203a1c6e">ConstantVector::getSplat</a>(VF, Iden);</div><div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;</div><div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;        <span class="comment">// This vector is the Identity vector where the first element is the</span></div><div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;        <span class="comment">// incoming scalar reduction.</span></div><div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;        VectorStart = Builder.CreateInsertElement(Identity,</div><div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;                                                  RdxDesc.StartValue, Zero);</div><div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;      }</div><div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;    }</div><div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;</div><div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;    <span class="comment">// Fix the vector-loop phi.</span></div><div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;    <span class="comment">// We created the induction variable so we know that the</span></div><div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;    <span class="comment">// preheader is the first entry.</span></div><div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;    <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *VecPreheader = Induction-&gt;getIncomingBlock(0);</div><div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;</div><div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;    <span class="comment">// Reductions do not have to start at zero. They can start with</span></div><div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;    <span class="comment">// any loop invariant values.</span></div><div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;    VectorParts &amp;VecRdxPhi = WidenMap.get(RdxPhi);</div><div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;    <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *Latch = OrigLoop-&gt;getLoopLatch();</div><div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *LoopVal = RdxPhi-&gt;<a class="code" href="classllvm_1_1PHINode.html#a21960167f529265a1cb02ac1e8ad10f6">getIncomingValueForBlock</a>(Latch);</div><div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;    VectorParts &amp;Val = getVectorValue(LoopVal);</div><div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> part = 0; part &lt; UF; ++part) {</div><div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;      <span class="comment">// Make sure to add the reduction stat value only to the</span></div><div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;      <span class="comment">// first unroll part.</span></div><div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *StartVal = (part == 0) ? VectorStart : Identity;</div><div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;      cast&lt;PHINode&gt;(VecRdxPhi[part])-&gt;addIncoming(StartVal, VecPreheader);</div><div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;      cast&lt;PHINode&gt;(VecRdxPhi[part])-&gt;addIncoming(Val[part], LoopVectorBody);</div><div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;    }</div><div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;</div><div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;    <span class="comment">// Before each round, move the insertion point right between</span></div><div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;    <span class="comment">// the PHIs and the values we are going to write.</span></div><div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;    <span class="comment">// This allows us to write both PHINodes and the extractelement</span></div><div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;    <span class="comment">// instructions.</span></div><div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;    Builder.SetInsertPoint(LoopMiddleBlock-&gt;getFirstInsertionPt());</div><div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;</div><div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;    VectorParts RdxParts;</div><div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;    setDebugLocFromInst(Builder, RdxDesc.LoopExitInstr);</div><div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> part = 0; part &lt; UF; ++part) {</div><div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;      <span class="comment">// This PHINode contains the vectorized reduction variable, or</span></div><div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;      <span class="comment">// the initial value vector, if we bypass the vector loop.</span></div><div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;      VectorParts &amp;RdxExitVal = getVectorValue(RdxDesc.LoopExitInstr);</div><div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;      <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *NewPhi = Builder.CreatePHI(VecTy, 2, <span class="stringliteral">&quot;rdx.vec.exit.phi&quot;</span>);</div><div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *StartVal = (part == 0) ? VectorStart : Identity;</div><div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = 0, E = LoopBypassBlocks.size(); <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> != E; ++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)</div><div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;        NewPhi-&gt;<a class="code" href="classllvm_1_1PHINode.html#a089cccb6f231efee72abc76d0f9c695f">addIncoming</a>(StartVal, LoopBypassBlocks[<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>]);</div><div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;      NewPhi-&gt;<a class="code" href="classllvm_1_1PHINode.html#a089cccb6f231efee72abc76d0f9c695f">addIncoming</a>(RdxExitVal[part], LoopVectorBody);</div><div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;      RdxParts.push_back(NewPhi);</div><div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;    }</div><div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;</div><div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;    <span class="comment">// Reduce all of the unrolled parts into a single vector.</span></div><div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *ReducedPartRdx = RdxParts[0];</div><div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;    <span class="keywordtype">unsigned</span> Op = <a class="code" href="LoopVectorize_8cpp.html#a71e2ca53c4dead6e5f91af3320e40499">getReductionBinOp</a>(RdxDesc.Kind);</div><div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;    setDebugLocFromInst(Builder, ReducedPartRdx);</div><div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> part = 1; part &lt; UF; ++part) {</div><div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;      <span class="keywordflow">if</span> (Op != Instruction::ICmp &amp;&amp; Op != Instruction::FCmp)</div><div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;        ReducedPartRdx = Builder.CreateBinOp((<a class="code" href="classllvm_1_1Instruction.html#ac26154a24f393f523c87cc5f8239f36c">Instruction::BinaryOps</a>)Op,</div><div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;                                             RdxParts[part], ReducedPartRdx,</div><div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;                                             <span class="stringliteral">&quot;bin.rdx&quot;</span>);</div><div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;        ReducedPartRdx = <a class="code" href="LoopVectorize_8cpp.html#a07903be1ff7f0dbad4df2f2f19b8703d">createMinMaxOp</a>(Builder, RdxDesc.MinMaxKind,</div><div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;                                        ReducedPartRdx, RdxParts[part]);</div><div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;    }</div><div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;</div><div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;    <span class="keywordflow">if</span> (VF &gt; 1) {</div><div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;      <span class="comment">// VF is a power of 2 so we can emit the reduction using log2(VF) shuffles</span></div><div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;      <span class="comment">// and vector ops, reducing the set of values being computed by half each</span></div><div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;      <span class="comment">// round.</span></div><div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;      assert(<a class="code" href="namespacellvm.html#af4d1a918800291e75b01ce1447be0e83">isPowerOf2_32</a>(VF) &amp;&amp;</div><div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;             <span class="stringliteral">&quot;Reduction emission only supported for pow2 vectors!&quot;</span>);</div><div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *TmpVec = ReducedPartRdx;</div><div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;      <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Constant*, 32&gt;</a> ShuffleMask(VF, 0);</div><div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = VF; <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != 1; <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> &gt;&gt;= 1) {</div><div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;        <span class="comment">// Move the upper half of the vector to the lower half.</span></div><div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a> = 0; <a class="code" href="Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a> != <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>/2; ++<a class="code" href="Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a>)</div><div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;          ShuffleMask[<a class="code" href="Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a>] = Builder.getInt32(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>/2 + <a class="code" href="Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a>);</div><div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;</div><div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;        <span class="comment">// Fill the rest of the mask with undef.</span></div><div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;        std::fill(&amp;ShuffleMask[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>/2], ShuffleMask.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#a075e34e98605d0e7c289763a104869ac">end</a>(),</div><div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;                  <a class="code" href="classllvm_1_1UndefValue.html#a4ae5ff22b700a42bcc5d889233721335">UndefValue::get</a>(Builder.getInt32Ty()));</div><div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;</div><div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;        <a class="code" href="classllvm_1_1Value.html">Value</a> *Shuf =</div><div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;        Builder.CreateShuffleVector(TmpVec,</div><div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;                                    <a class="code" href="classllvm_1_1UndefValue.html#a4ae5ff22b700a42bcc5d889233721335">UndefValue::get</a>(TmpVec-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>()),</div><div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;                                    <a class="code" href="classllvm_1_1ConstantVector.html#ade9fa017ca3aa82f7694a47090547bc1">ConstantVector::get</a>(ShuffleMask),</div><div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;                                    <span class="stringliteral">&quot;rdx.shuf&quot;</span>);</div><div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;</div><div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;        <span class="keywordflow">if</span> (Op != Instruction::ICmp &amp;&amp; Op != Instruction::FCmp)</div><div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;          TmpVec = Builder.CreateBinOp((<a class="code" href="classllvm_1_1Instruction.html#ac26154a24f393f523c87cc5f8239f36c">Instruction::BinaryOps</a>)Op, TmpVec, Shuf,</div><div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;                                       <span class="stringliteral">&quot;bin.rdx&quot;</span>);</div><div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;          TmpVec = <a class="code" href="LoopVectorize_8cpp.html#a07903be1ff7f0dbad4df2f2f19b8703d">createMinMaxOp</a>(Builder, RdxDesc.MinMaxKind, TmpVec, Shuf);</div><div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;      }</div><div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;</div><div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;      <span class="comment">// The result is in the first element of the vector.</span></div><div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;      ReducedPartRdx = Builder.CreateExtractElement(TmpVec,</div><div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;                                                    Builder.getInt32(0));</div><div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;    }</div><div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;</div><div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;    <span class="comment">// Now, we need to fix the users of the reduction variable</span></div><div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;    <span class="comment">// inside and outside of the scalar remainder loop.</span></div><div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;    <span class="comment">// We know that the loop is in LCSSA form. We need to update the</span></div><div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;    <span class="comment">// PHI nodes in the exit blocks.</span></div><div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1ilist__iterator.html">BasicBlock::iterator</a> LEI = LoopExitBlock-&gt;begin(),</div><div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;         LEE = LoopExitBlock-&gt;end(); LEI != LEE; ++LEI) {</div><div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;      <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *LCSSAPhi = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1PHINode.html">PHINode</a>&gt;(LEI);</div><div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;      <span class="keywordflow">if</span> (!LCSSAPhi) <span class="keywordflow">break</span>;</div><div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;</div><div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;      <span class="comment">// All PHINodes need to have a single entry edge, or two if</span></div><div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;      <span class="comment">// we already fixed them.</span></div><div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;      assert(LCSSAPhi-&gt;<a class="code" href="classllvm_1_1PHINode.html#aa45f6c0433576e3858a6209a43750ad4">getNumIncomingValues</a>() &lt; 3 &amp;&amp; <span class="stringliteral">&quot;Invalid LCSSA PHI&quot;</span>);</div><div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;</div><div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;      <span class="comment">// We found our reduction value exit-PHI. Update it with the</span></div><div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;      <span class="comment">// incoming bypass edge.</span></div><div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;      <span class="keywordflow">if</span> (LCSSAPhi-&gt;<a class="code" href="classllvm_1_1PHINode.html#aba6a4cc4ed6d6fef3664b8d65ef04820">getIncomingValue</a>(0) == RdxDesc.LoopExitInstr) {</div><div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;        <span class="comment">// Add an edge coming from the bypass.</span></div><div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;        LCSSAPhi-&gt;<a class="code" href="classllvm_1_1PHINode.html#a089cccb6f231efee72abc76d0f9c695f">addIncoming</a>(ReducedPartRdx, LoopMiddleBlock);</div><div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;      }</div><div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;    }<span class="comment">// end of the LCSSA phi scan.</span></div><div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;</div><div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;    <span class="comment">// Fix the scalar loop reduction variable with the incoming reduction sum</span></div><div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;    <span class="comment">// from the vector body and from the backedge value.</span></div><div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;    <span class="keywordtype">int</span> IncomingEdgeBlockIdx =</div><div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;    (RdxPhi)-&gt;getBasicBlockIndex(OrigLoop-&gt;getLoopLatch());</div><div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;    assert(IncomingEdgeBlockIdx &gt;= 0 &amp;&amp; <span class="stringliteral">&quot;Invalid block index&quot;</span>);</div><div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;    <span class="comment">// Pick the other block.</span></div><div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;    <span class="keywordtype">int</span> SelfEdgeBlockIdx = (IncomingEdgeBlockIdx ? 0 : 1);</div><div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;    (RdxPhi)-&gt;setIncomingValue(SelfEdgeBlockIdx, ReducedPartRdx);</div><div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;    (RdxPhi)-&gt;setIncomingValue(IncomingEdgeBlockIdx, RdxDesc.LoopExitInstr);</div><div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;  }<span class="comment">// end of for each redux variable.</span></div><div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;</div><div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;  fixLCSSAPHIs();</div><div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;</div><div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;  <span class="comment">// Remove redundant induction instructions.</span></div><div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;  <a class="code" href="LoopVectorize_8cpp.html#acc13ee8b8985399901ac09b51822e21a">cse</a>(LoopVectorBody);</div><div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;}</div><div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;</div><div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;<span class="keywordtype">void</span> InnerLoopVectorizer::fixLCSSAPHIs() {</div><div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1ilist__iterator.html">BasicBlock::iterator</a> LEI = LoopExitBlock-&gt;begin(),</div><div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;       LEE = LoopExitBlock-&gt;end(); LEI != LEE; ++LEI) {</div><div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;    <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *LCSSAPhi = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1PHINode.html">PHINode</a>&gt;(LEI);</div><div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;    <span class="keywordflow">if</span> (!LCSSAPhi) <span class="keywordflow">break</span>;</div><div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;    <span class="keywordflow">if</span> (LCSSAPhi-&gt;<a class="code" href="classllvm_1_1PHINode.html#aa45f6c0433576e3858a6209a43750ad4">getNumIncomingValues</a>() == 1)</div><div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;      LCSSAPhi-&gt;<a class="code" href="classllvm_1_1PHINode.html#a089cccb6f231efee72abc76d0f9c695f">addIncoming</a>(<a class="code" href="classllvm_1_1UndefValue.html#a4ae5ff22b700a42bcc5d889233721335">UndefValue::get</a>(LCSSAPhi-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>()),</div><div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;                            LoopMiddleBlock);</div><div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;  }</div><div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;} </div><div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;</div><div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;<a class="code" href="classllvm_1_1SmallVector.html">InnerLoopVectorizer::VectorParts</a></div><div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;InnerLoopVectorizer::createEdgeMask(<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *Src, <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *Dst) {</div><div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;  assert(std::find(<a class="code" href="namespacellvm.html#a7e108932dc3da5294aed99a353aac9c4">pred_begin</a>(Dst), <a class="code" href="namespacellvm.html#a5eeaf08e96168c2cac8960f87f0ef360">pred_end</a>(Dst), Src) != <a class="code" href="namespacellvm.html#a5eeaf08e96168c2cac8960f87f0ef360">pred_end</a>(Dst) &amp;&amp;</div><div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;         <span class="stringliteral">&quot;Invalid edge&quot;</span>);</div><div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;</div><div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;  <span class="comment">// Look for cached value.</span></div><div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;  std::pair&lt;BasicBlock*, BasicBlock*&gt; Edge(Src, Dst);</div><div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;  EdgeMaskCache::iterator ECEntryIt = MaskCache.find(Edge);</div><div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;  <span class="keywordflow">if</span> (ECEntryIt != MaskCache.end())</div><div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;    <span class="keywordflow">return</span> ECEntryIt-&gt;second;</div><div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;</div><div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;  VectorParts SrcMask = createBlockInMask(Src);</div><div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;</div><div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;  <span class="comment">// The terminator has to be a branch inst!</span></div><div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;  <a class="code" href="classllvm_1_1BranchInst.html">BranchInst</a> *BI = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1BranchInst.html">BranchInst</a>&gt;(Src-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a5cb76a65b6524dba1493dd2b9dc3abbe">getTerminator</a>());</div><div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;  assert(BI &amp;&amp; <span class="stringliteral">&quot;Unexpected terminator found&quot;</span>);</div><div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;</div><div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;  <span class="keywordflow">if</span> (BI-&gt;<a class="code" href="classllvm_1_1BranchInst.html#a03cc0dff22b31447f43af97acb76b1a2">isConditional</a>()) {</div><div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;    VectorParts EdgeMask = getVectorValue(BI-&gt;<a class="code" href="classllvm_1_1BranchInst.html#a84309bb8c34c8bc5694ec5d48dd8668f">getCondition</a>());</div><div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;</div><div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;    <span class="keywordflow">if</span> (BI-&gt;<a class="code" href="classllvm_1_1BranchInst.html#a74e70ecbb79defbbfa6f6c87f76155bf">getSuccessor</a>(0) != Dst)</div><div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> part = 0; part &lt; UF; ++part)</div><div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;        EdgeMask[part] = Builder.CreateNot(EdgeMask[part]);</div><div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;</div><div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> part = 0; part &lt; UF; ++part)</div><div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;      EdgeMask[part] = Builder.CreateAnd(EdgeMask[part], SrcMask[part]);</div><div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;</div><div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;    MaskCache[Edge] = EdgeMask;</div><div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;    <span class="keywordflow">return</span> EdgeMask;</div><div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;  }</div><div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;</div><div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;  MaskCache[Edge] = SrcMask;</div><div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;  <span class="keywordflow">return</span> SrcMask;</div><div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;}</div><div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;</div><div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;<a class="code" href="classllvm_1_1SmallVector.html">InnerLoopVectorizer::VectorParts</a></div><div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;InnerLoopVectorizer::createBlockInMask(<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>) {</div><div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;  assert(OrigLoop-&gt;contains(BB) &amp;&amp; <span class="stringliteral">&quot;Block is not a part of a loop&quot;</span>);</div><div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;</div><div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;  <span class="comment">// Loop incoming mask is all-one.</span></div><div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;  <span class="keywordflow">if</span> (OrigLoop-&gt;getHeader() == <a class="code" href="CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>) {</div><div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = <a class="code" href="classllvm_1_1ConstantInt.html#a9105541412dab869e18b3cceebfff07d">ConstantInt::get</a>(<a class="code" href="classllvm_1_1Type.html#aa75984a442f2379de0c66018201fa628">IntegerType::getInt1Ty</a>(BB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#ad652423d9d91271ba153eb86482b2f55">getContext</a>()), 1);</div><div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;    <span class="keywordflow">return</span> getVectorValue(C);</div><div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;  }</div><div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;</div><div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;  <span class="comment">// This is the block mask. We OR all incoming edges, and with zero.</span></div><div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Zero = <a class="code" href="classllvm_1_1ConstantInt.html#a9105541412dab869e18b3cceebfff07d">ConstantInt::get</a>(<a class="code" href="classllvm_1_1Type.html#aa75984a442f2379de0c66018201fa628">IntegerType::getInt1Ty</a>(BB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#ad652423d9d91271ba153eb86482b2f55">getContext</a>()), 0);</div><div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;  VectorParts BlockMask = getVectorValue(Zero);</div><div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;</div><div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;  <span class="comment">// For each pred:</span></div><div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1PredIterator.html">pred_iterator</a> <a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a> = <a class="code" href="namespacellvm.html#a7e108932dc3da5294aed99a353aac9c4">pred_begin</a>(BB), e = <a class="code" href="namespacellvm.html#a5eeaf08e96168c2cac8960f87f0ef360">pred_end</a>(BB); <a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a> != e; ++<a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a>) {</div><div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;    VectorParts EM = createEdgeMask(*<a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a>, BB);</div><div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> part = 0; part &lt; UF; ++part)</div><div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;      BlockMask[part] = Builder.CreateOr(BlockMask[part], EM[part]);</div><div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;  }</div><div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;</div><div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;  <span class="keywordflow">return</span> BlockMask;</div><div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;}</div><div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;</div><div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;<span class="keywordtype">void</span> InnerLoopVectorizer::widenPHIInstruction(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *PN,</div><div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;                                              <a class="code" href="classllvm_1_1SmallVector.html">InnerLoopVectorizer::VectorParts</a> &amp;Entry,</div><div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;                                              LoopVectorizationLegality *Legal,</div><div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;                                              <span class="keywordtype">unsigned</span> UF, <span class="keywordtype">unsigned</span> VF, PhiVector *PV) {</div><div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;  <a class="code" href="classllvm_1_1PHINode.html">PHINode</a>* <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a> = cast&lt;PHINode&gt;(PN);</div><div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;  <span class="comment">// Handle reduction variables:</span></div><div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;  <span class="keywordflow">if</span> (Legal-&gt;getReductionVars()-&gt;count(P)) {</div><div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> part = 0; part &lt; UF; ++part) {</div><div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;      <span class="comment">// This is phase one of vectorizing PHIs.</span></div><div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;      <a class="code" href="classllvm_1_1Type.html">Type</a> *VecTy = (VF == 1) ? PN-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>() :</div><div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;      <a class="code" href="classllvm_1_1VectorType.html#ab43657ed1abe2e2ed3a6a394f233ebd0">VectorType::get</a>(PN-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>(), VF);</div><div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;      Entry[part] = <a class="code" href="classllvm_1_1PHINode.html#afb5e83bf5123ff7c51058eb0ebebcdc6">PHINode::Create</a>(VecTy, 2, <span class="stringliteral">&quot;vec.phi&quot;</span>,</div><div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;                                    LoopVectorBody-&gt; getFirstInsertionPt());</div><div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;    }</div><div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;    PV-&gt;push_back(P);</div><div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;  }</div><div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;</div><div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;  setDebugLocFromInst(Builder, P);</div><div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;  <span class="comment">// Check for PHI nodes that are lowered to vector selects.</span></div><div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;  <span class="keywordflow">if</span> (P-&gt;<a class="code" href="classllvm_1_1Instruction.html#a9cd49851904f15060edb782ef4dd1b2d">getParent</a>() != OrigLoop-&gt;getHeader()) {</div><div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;    <span class="comment">// We know that all PHIs in non header blocks are converted into</span></div><div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;    <span class="comment">// selects, so we don&#39;t have to worry about the insertion order and we</span></div><div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;    <span class="comment">// can just use the builder.</span></div><div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;    <span class="comment">// At this point we generate the predication tree. There may be</span></div><div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;    <span class="comment">// duplications since this is a simple recursive scan, but future</span></div><div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;    <span class="comment">// optimizations will clean it up.</span></div><div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;</div><div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;    <span class="keywordtype">unsigned</span> NumIncoming = P-&gt;<a class="code" href="classllvm_1_1PHINode.html#aa45f6c0433576e3858a6209a43750ad4">getNumIncomingValues</a>();</div><div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;</div><div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;    <span class="comment">// Generate a sequence of selects of the form:</span></div><div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;    <span class="comment">// SELECT(Mask3, In3,</span></div><div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;    <span class="comment">//      SELECT(Mask2, In2,</span></div><div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;    <span class="comment">//                   ( ...)))</span></div><div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5a5fa7b4069ef3bd1ceb9f2caa315cf5ac">In</a> = 0; <a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5a5fa7b4069ef3bd1ceb9f2caa315cf5ac">In</a> &lt; NumIncoming; <a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5a5fa7b4069ef3bd1ceb9f2caa315cf5ac">In</a>++) {</div><div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;      VectorParts Cond = createEdgeMask(P-&gt;<a class="code" href="classllvm_1_1PHINode.html#a4c25b6c00c4867281779c81ab64d2081">getIncomingBlock</a>(<a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5a5fa7b4069ef3bd1ceb9f2caa315cf5ac">In</a>),</div><div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;                                        P-&gt;<a class="code" href="classllvm_1_1Instruction.html#a9cd49851904f15060edb782ef4dd1b2d">getParent</a>());</div><div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;      VectorParts &amp;In0 = getVectorValue(P-&gt;<a class="code" href="classllvm_1_1PHINode.html#aba6a4cc4ed6d6fef3664b8d65ef04820">getIncomingValue</a>(<a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5a5fa7b4069ef3bd1ceb9f2caa315cf5ac">In</a>));</div><div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;</div><div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> part = 0; part &lt; UF; ++part) {</div><div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;        <span class="comment">// We might have single edge PHIs (blocks) - use an identity</span></div><div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;        <span class="comment">// &#39;select&#39; for the first PHI operand.</span></div><div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5a5fa7b4069ef3bd1ceb9f2caa315cf5ac">In</a> == 0)</div><div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;          Entry[part] = Builder.CreateSelect(Cond[part], In0[part],</div><div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;                                             In0[part]);</div><div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;          <span class="comment">// Select between the current value and the previous incoming edge</span></div><div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;          <span class="comment">// based on the incoming mask.</span></div><div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;          Entry[part] = Builder.CreateSelect(Cond[part], In0[part],</div><div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;                                             Entry[part], <span class="stringliteral">&quot;predphi&quot;</span>);</div><div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;      }</div><div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;    }</div><div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;  }</div><div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;</div><div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;  <span class="comment">// This PHINode must be an induction variable.</span></div><div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;  <span class="comment">// Make sure that we know about it.</span></div><div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;  assert(Legal-&gt;getInductionVars()-&gt;count(P) &amp;&amp;</div><div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;         <span class="stringliteral">&quot;Not an induction variable&quot;</span>);</div><div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;</div><div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;  LoopVectorizationLegality::InductionInfo II =</div><div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;  Legal-&gt;getInductionVars()-&gt;lookup(P);</div><div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;</div><div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;  <span class="keywordflow">switch</span> (II.IK) {</div><div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;    <span class="keywordflow">case</span> LoopVectorizationLegality::IK_NoInduction:</div><div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;      <a class="code" href="ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a>(<span class="stringliteral">&quot;Unknown induction&quot;</span>);</div><div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;    <span class="keywordflow">case</span> LoopVectorizationLegality::IK_IntInduction: {</div><div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;      assert(P-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>() == II.StartValue-&gt;getType() &amp;&amp; <span class="stringliteral">&quot;Types must match&quot;</span>);</div><div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;      <a class="code" href="classllvm_1_1Type.html">Type</a> *PhiTy = P-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>();</div><div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *Broadcasted;</div><div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;      <span class="keywordflow">if</span> (P == OldInduction) {</div><div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;        <span class="comment">// Handle the canonical induction variable. We might have had to</span></div><div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;        <span class="comment">// extend the type.</span></div><div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;        Broadcasted = Builder.CreateTrunc(Induction, PhiTy);</div><div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;        <span class="comment">// Handle other induction variables that are now based on the</span></div><div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;        <span class="comment">// canonical one.</span></div><div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;        <a class="code" href="classllvm_1_1Value.html">Value</a> *NormalizedIdx = Builder.CreateSub(Induction, ExtendedIdx,</div><div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;                                                 <span class="stringliteral">&quot;normalized.idx&quot;</span>);</div><div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;        NormalizedIdx = Builder.CreateSExtOrTrunc(NormalizedIdx, PhiTy);</div><div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;        Broadcasted = Builder.CreateAdd(II.StartValue, NormalizedIdx,</div><div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;                                        <span class="stringliteral">&quot;offset.idx&quot;</span>);</div><div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;      }</div><div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;      Broadcasted = getBroadcastInstrs(Broadcasted);</div><div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;      <span class="comment">// After broadcasting the induction variable we need to make the vector</span></div><div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;      <span class="comment">// consecutive by adding 0, 1, 2, etc.</span></div><div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> part = 0; part &lt; UF; ++part)</div><div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;        Entry[part] = getConsecutiveVector(Broadcasted, VF * part, <span class="keyword">false</span>);</div><div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;    }</div><div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;    <span class="keywordflow">case</span> LoopVectorizationLegality::IK_ReverseIntInduction:</div><div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;    <span class="keywordflow">case</span> LoopVectorizationLegality::IK_PtrInduction:</div><div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;    <span class="keywordflow">case</span> LoopVectorizationLegality::IK_ReversePtrInduction:</div><div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;      <span class="comment">// Handle reverse integer and pointer inductions.</span></div><div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *StartIdx = ExtendedIdx;</div><div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;      <span class="comment">// This is the normalized GEP that starts counting at zero.</span></div><div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *NormalizedIdx = Builder.CreateSub(Induction, StartIdx,</div><div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;                                               <span class="stringliteral">&quot;normalized.idx&quot;</span>);</div><div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;</div><div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;      <span class="comment">// Handle the reverse integer induction variable case.</span></div><div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;      <span class="keywordflow">if</span> (LoopVectorizationLegality::IK_ReverseIntInduction == II.IK) {</div><div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;        <a class="code" href="classllvm_1_1IntegerType.html">IntegerType</a> *DstTy = cast&lt;IntegerType&gt;(II.StartValue-&gt;getType());</div><div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;        <a class="code" href="classllvm_1_1Value.html">Value</a> *CNI = Builder.CreateSExtOrTrunc(NormalizedIdx, DstTy,</div><div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;                                               <span class="stringliteral">&quot;resize.norm.idx&quot;</span>);</div><div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;        <a class="code" href="classllvm_1_1Value.html">Value</a> *ReverseInd  = Builder.CreateSub(II.StartValue, CNI,</div><div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;                                               <span class="stringliteral">&quot;reverse.idx&quot;</span>);</div><div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;</div><div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;        <span class="comment">// This is a new value so do not hoist it out.</span></div><div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;        <a class="code" href="classllvm_1_1Value.html">Value</a> *Broadcasted = getBroadcastInstrs(ReverseInd);</div><div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;        <span class="comment">// After broadcasting the induction variable we need to make the</span></div><div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;        <span class="comment">// vector consecutive by adding  ... -3, -2, -1, 0.</span></div><div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> part = 0; part &lt; UF; ++part)</div><div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;          Entry[part] = getConsecutiveVector(Broadcasted, -(<span class="keywordtype">int</span>)VF * part,</div><div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;                                             <span class="keyword">true</span>);</div><div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;      }</div><div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;</div><div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;      <span class="comment">// Handle the pointer induction variable case.</span></div><div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;      assert(P-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a2eba483f5cc876e824aa6c085736086b">isPointerTy</a>() &amp;&amp; <span class="stringliteral">&quot;Unexpected type.&quot;</span>);</div><div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;</div><div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;      <span class="comment">// Is this a reverse induction ptr or a consecutive induction ptr.</span></div><div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;      <span class="keywordtype">bool</span> Reverse = (LoopVectorizationLegality::IK_ReversePtrInduction ==</div><div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;                      II.IK);</div><div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;</div><div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;      <span class="comment">// This is the vector of results. Notice that we don&#39;t generate</span></div><div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;      <span class="comment">// vector geps because scalar geps result in better code.</span></div><div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> part = 0; part &lt; UF; ++part) {</div><div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;        <span class="keywordflow">if</span> (VF == 1) {</div><div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;          <span class="keywordtype">int</span> EltIndex = (part) * (Reverse ? -1 : 1);</div><div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;          <a class="code" href="classllvm_1_1Constant.html">Constant</a> *Idx = <a class="code" href="classllvm_1_1ConstantInt.html#a9105541412dab869e18b3cceebfff07d">ConstantInt::get</a>(Induction-&gt;getType(), EltIndex);</div><div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;          <a class="code" href="classllvm_1_1Value.html">Value</a> *GlobalIdx;</div><div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;          <span class="keywordflow">if</span> (Reverse)</div><div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;            GlobalIdx = Builder.CreateSub(Idx, NormalizedIdx, <span class="stringliteral">&quot;gep.ridx&quot;</span>);</div><div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;          <span class="keywordflow">else</span></div><div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;            GlobalIdx = Builder.CreateAdd(NormalizedIdx, Idx, <span class="stringliteral">&quot;gep.idx&quot;</span>);</div><div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;</div><div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;          <a class="code" href="classllvm_1_1Value.html">Value</a> *SclrGep = Builder.CreateGEP(II.StartValue, GlobalIdx,</div><div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;                                             <span class="stringliteral">&quot;next.gep&quot;</span>);</div><div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;          Entry[part] = SclrGep;</div><div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;          <span class="keywordflow">continue</span>;</div><div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;        }</div><div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;</div><div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;        <a class="code" href="classllvm_1_1Value.html">Value</a> *VecVal = <a class="code" href="classllvm_1_1UndefValue.html#a4ae5ff22b700a42bcc5d889233721335">UndefValue::get</a>(<a class="code" href="classllvm_1_1VectorType.html#ab43657ed1abe2e2ed3a6a394f233ebd0">VectorType::get</a>(P-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>(), VF));</div><div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; VF; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;          <span class="keywordtype">int</span> EltIndex = (<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> + part * VF) * (Reverse ? -1 : 1);</div><div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;          <a class="code" href="classllvm_1_1Constant.html">Constant</a> *Idx = <a class="code" href="classllvm_1_1ConstantInt.html#a9105541412dab869e18b3cceebfff07d">ConstantInt::get</a>(Induction-&gt;getType(), EltIndex);</div><div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;          <a class="code" href="classllvm_1_1Value.html">Value</a> *GlobalIdx;</div><div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;          <span class="keywordflow">if</span> (!Reverse)</div><div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;            GlobalIdx = Builder.CreateAdd(NormalizedIdx, Idx, <span class="stringliteral">&quot;gep.idx&quot;</span>);</div><div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;          <span class="keywordflow">else</span></div><div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;            GlobalIdx = Builder.CreateSub(Idx, NormalizedIdx, <span class="stringliteral">&quot;gep.ridx&quot;</span>);</div><div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;</div><div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;          <a class="code" href="classllvm_1_1Value.html">Value</a> *SclrGep = Builder.CreateGEP(II.StartValue, GlobalIdx,</div><div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;                                             <span class="stringliteral">&quot;next.gep&quot;</span>);</div><div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;          VecVal = Builder.CreateInsertElement(VecVal, SclrGep,</div><div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;                                               Builder.getInt32(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>),</div><div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;                                               <span class="stringliteral">&quot;insert.gep&quot;</span>);</div><div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;        }</div><div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;        Entry[part] = VecVal;</div><div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;      }</div><div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;  }</div><div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;}</div><div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;</div><div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;InnerLoopVectorizer::vectorizeBlockInLoop(LoopVectorizationLegality *Legal,</div><div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;                                          <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *BB, PhiVector *PV) {</div><div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;  <span class="comment">// For each instruction in the old loop.</span></div><div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1ilist__iterator.html">BasicBlock::iterator</a> <a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a> = BB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a0ed5f3ab3c2e4196ee0cffffa080c062">begin</a>(), e = BB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a0b4e7bee9b8575cc7db73329f1a561bd">end</a>(); <a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a> != e; ++<a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a>) {</div><div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;    VectorParts &amp;Entry = WidenMap.get(<a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a>);</div><div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;    <span class="keywordflow">switch</span> (<a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a>-&gt;getOpcode()) {</div><div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;    <span class="keywordflow">case</span> Instruction::Br:</div><div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;      <span class="comment">// Nothing to do for PHIs and BR, since we already took care of the</span></div><div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;      <span class="comment">// loop control flow instructions.</span></div><div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1TargetOpcode.html#a348d4259b5fa6a8ecfe94e7ae512e1a8ae41f9ca68ba5e8b9613cea03652ebd72">Instruction::PHI</a>:{</div><div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;      <span class="comment">// Vectorize PHINodes.</span></div><div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;      widenPHIInstruction(<a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a>, Entry, Legal, UF, VF, PV);</div><div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;    }<span class="comment">// End of PHI.</span></div><div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;</div><div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;    <span class="keywordflow">case</span> Instruction::Add:</div><div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;    <span class="keywordflow">case</span> Instruction::FAdd:</div><div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;    <span class="keywordflow">case</span> Instruction::Sub:</div><div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;    <span class="keywordflow">case</span> Instruction::FSub:</div><div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;    <span class="keywordflow">case</span> Instruction::Mul:</div><div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;    <span class="keywordflow">case</span> Instruction::FMul:</div><div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;    <span class="keywordflow">case</span> Instruction::UDiv:</div><div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;    <span class="keywordflow">case</span> Instruction::SDiv:</div><div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;    <span class="keywordflow">case</span> Instruction::FDiv:</div><div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;    <span class="keywordflow">case</span> Instruction::URem:</div><div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;    <span class="keywordflow">case</span> Instruction::SRem:</div><div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;    <span class="keywordflow">case</span> Instruction::FRem:</div><div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;    <span class="keywordflow">case</span> Instruction::Shl:</div><div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;    <span class="keywordflow">case</span> Instruction::LShr:</div><div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;    <span class="keywordflow">case</span> Instruction::AShr:</div><div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1APIntOps.html#a684cfe02c582e8d75cd6d457e63e6c25">Instruction::And</a>:</div><div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1APIntOps.html#a22f056804d2b9882f74adc905872bc39">Instruction::Or</a>:</div><div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1APIntOps.html#afc7c4d88d09cba0c5e920f8a3a3ace55">Instruction::Xor</a>: {</div><div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;      <span class="comment">// Just widen binops.</span></div><div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;      <a class="code" href="classllvm_1_1BinaryOperator.html">BinaryOperator</a> *BinOp = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1BinaryOperator.html">BinaryOperator</a>&gt;(<a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a>);</div><div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;      setDebugLocFromInst(Builder, BinOp);</div><div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;      VectorParts &amp;<a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a> = getVectorValue(<a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a>-&gt;getOperand(0));</div><div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;      VectorParts &amp;<a class="code" href="Target_2ARM_2README_8txt.html#a90cca76dd78688687e0d697679dbc799">B</a> = getVectorValue(<a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a>-&gt;getOperand(1));</div><div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;</div><div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;      <span class="comment">// Use this vector value for all users of the original instruction.</span></div><div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> Part = 0; Part &lt; UF; ++Part) {</div><div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;        <a class="code" href="classllvm_1_1Value.html">Value</a> *V = Builder.CreateBinOp(BinOp-&gt;<a class="code" href="classllvm_1_1BinaryOperator.html#a88505baf41407782678a5df1702d2d31">getOpcode</a>(), A[Part], B[Part]);</div><div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;</div><div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;        <span class="comment">// Update the NSW, NUW and Exact flags. Notice: V can be an Undef.</span></div><div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;        <a class="code" href="classllvm_1_1BinaryOperator.html">BinaryOperator</a> *VecOp = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1BinaryOperator.html">BinaryOperator</a>&gt;(V);</div><div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;        <span class="keywordflow">if</span> (VecOp &amp;&amp; isa&lt;OverflowingBinaryOperator&gt;(BinOp)) {</div><div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;          VecOp-&gt;<a class="code" href="classllvm_1_1BinaryOperator.html#a21ce697328893029ae2c63974061a294">setHasNoSignedWrap</a>(BinOp-&gt;<a class="code" href="classllvm_1_1BinaryOperator.html#a07783e6f39803037259a1ebe376c2b1e">hasNoSignedWrap</a>());</div><div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;          VecOp-&gt;<a class="code" href="classllvm_1_1BinaryOperator.html#aaa9083a85e23c9c5ee366920d90ae51e">setHasNoUnsignedWrap</a>(BinOp-&gt;<a class="code" href="classllvm_1_1BinaryOperator.html#a5b6cd6c043f54b40899aff62e6e40488">hasNoUnsignedWrap</a>());</div><div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;        }</div><div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;        <span class="keywordflow">if</span> (VecOp &amp;&amp; isa&lt;PossiblyExactOperator&gt;(VecOp))</div><div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;          VecOp-&gt;<a class="code" href="classllvm_1_1BinaryOperator.html#aac502d7d65e2996cf6b819b14e17499c">setIsExact</a>(BinOp-&gt;<a class="code" href="classllvm_1_1BinaryOperator.html#a0f67e7208255f5088f0d515185109174">isExact</a>());</div><div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;</div><div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;        Entry[Part] = V;</div><div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;      }</div><div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;    }</div><div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1MCID.html#a8035044d40d3758eb45b65dce69dc90ba32dbd2c72a98eaee90e3ad5ef7b5af16">Instruction::Select</a>: {</div><div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;      <span class="comment">// Widen selects.</span></div><div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;      <span class="comment">// If the selector is loop invariant we can create a select</span></div><div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;      <span class="comment">// instruction with a scalar condition. Otherwise, use vector-select.</span></div><div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160;      <span class="keywordtype">bool</span> InvariantCond = SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a5a19768af81df7e5fe571bc08dcd48b3">isLoopInvariant</a>(SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a30bd18ac905eacf3601bc6a553a9ff49">getSCEV</a>(<a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a>-&gt;getOperand(0)),</div><div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;                                               OrigLoop);</div><div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160;      setDebugLocFromInst(Builder, <a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a>);</div><div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160;</div><div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;      <span class="comment">// The condition can be loop invariant  but still defined inside the</span></div><div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160;      <span class="comment">// loop. This means that we can&#39;t just use the original &#39;cond&#39; value.</span></div><div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;      <span class="comment">// We have to take the &#39;vectorized&#39; value and pick the first lane.</span></div><div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;      <span class="comment">// Instcombine will make this a no-op.</span></div><div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;      VectorParts &amp;Cond = getVectorValue(<a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a>-&gt;getOperand(0));</div><div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;      VectorParts &amp;Op0  = getVectorValue(<a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a>-&gt;getOperand(1));</div><div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;      VectorParts &amp;Op1  = getVectorValue(<a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a>-&gt;getOperand(2));</div><div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;</div><div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *ScalarCond = (VF == 1) ? Cond[0] :</div><div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;        Builder.CreateExtractElement(Cond[0], Builder.getInt32(0));</div><div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;</div><div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> Part = 0; Part &lt; UF; ++Part) {</div><div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;        Entry[Part] = Builder.CreateSelect(</div><div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;          InvariantCond ? ScalarCond : Cond[Part],</div><div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;          Op0[Part],</div><div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;          Op1[Part]);</div><div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;      }</div><div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;    }</div><div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;</div><div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;    <span class="keywordflow">case</span> Instruction::ICmp:</div><div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;    <span class="keywordflow">case</span> Instruction::FCmp: {</div><div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;      <span class="comment">// Widen compares. Generate vector compares.</span></div><div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;      <span class="keywordtype">bool</span> FCmp = (<a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a>-&gt;getOpcode() == Instruction::FCmp);</div><div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;      <a class="code" href="classllvm_1_1CmpInst.html">CmpInst</a> *Cmp = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1CmpInst.html">CmpInst</a>&gt;(<a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a>);</div><div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;      setDebugLocFromInst(Builder, <a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a>);</div><div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;      VectorParts &amp;<a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a> = getVectorValue(<a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a>-&gt;getOperand(0));</div><div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;      VectorParts &amp;<a class="code" href="Target_2ARM_2README_8txt.html#a90cca76dd78688687e0d697679dbc799">B</a> = getVectorValue(<a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a>-&gt;getOperand(1));</div><div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> Part = 0; Part &lt; UF; ++Part) {</div><div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;        <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = 0;</div><div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;        <span class="keywordflow">if</span> (FCmp)</div><div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;          C = Builder.CreateFCmp(Cmp-&gt;<a class="code" href="classllvm_1_1CmpInst.html#a8afd4995fae596b2c86eeed85b3d388b">getPredicate</a>(), A[Part], B[Part]);</div><div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;          C = Builder.CreateICmp(Cmp-&gt;<a class="code" href="classllvm_1_1CmpInst.html#a8afd4995fae596b2c86eeed85b3d388b">getPredicate</a>(), A[Part], B[Part]);</div><div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160;        Entry[Part] = <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>;</div><div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;      }</div><div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;    }</div><div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;</div><div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1SPII.html#a11e9b8fca4a074643a6a21f444e51406a36b3dd3b84fde3f8494a9b18af131856">Instruction::Store</a>:</div><div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1SPII.html#a11e9b8fca4a074643a6a21f444e51406a5069619ca8fdce305534f3fe85091a0f">Instruction::Load</a>:</div><div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;        vectorizeMemoryInstruction(<a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a>, Legal);</div><div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160;    <span class="keywordflow">case</span> Instruction::ZExt:</div><div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160;    <span class="keywordflow">case</span> Instruction::SExt:</div><div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;    <span class="keywordflow">case</span> Instruction::FPToUI:</div><div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;    <span class="keywordflow">case</span> Instruction::FPToSI:</div><div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;    <span class="keywordflow">case</span> Instruction::FPExt:</div><div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;    <span class="keywordflow">case</span> Instruction::PtrToInt:</div><div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160;    <span class="keywordflow">case</span> Instruction::IntToPtr:</div><div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160;    <span class="keywordflow">case</span> Instruction::SIToFP:</div><div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160;    <span class="keywordflow">case</span> Instruction::UIToFP:</div><div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;    <span class="keywordflow">case</span> Instruction::Trunc:</div><div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;    <span class="keywordflow">case</span> Instruction::FPTrunc:</div><div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;    <span class="keywordflow">case</span> Instruction::BitCast: {</div><div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;      <a class="code" href="classllvm_1_1CastInst.html">CastInst</a> *CI = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1CastInst.html">CastInst</a>&gt;(<a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a>);</div><div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;      setDebugLocFromInst(Builder, <a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a>);<span class="comment"></span></div><div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;<span class="comment">      /// Optimize the special case where the source is the induction</span></div><div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;<span class="comment">      /// variable. Notice that we can only optimize the &#39;trunc&#39; case</span></div><div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160;<span class="comment">      /// because: a. FP conversions lose precision, b. sext/zext may wrap,</span></div><div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160;<span class="comment">      /// c. other casts depend on pointer size.</span></div><div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;<span class="comment"></span>      <span class="keywordflow">if</span> (CI-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0) == OldInduction &amp;&amp;</div><div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160;          <a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a>-&gt;getOpcode() == Instruction::Trunc) {</div><div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160;        <a class="code" href="classllvm_1_1Value.html">Value</a> *ScalarCast = Builder.CreateCast(CI-&gt;<a class="code" href="classllvm_1_1CastInst.html#adc3489e61d5f37a0e4c5589859fbccc2">getOpcode</a>(), Induction,</div><div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;                                               CI-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>());</div><div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160;        <a class="code" href="classllvm_1_1Value.html">Value</a> *Broadcasted = getBroadcastInstrs(ScalarCast);</div><div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> Part = 0; Part &lt; UF; ++Part)</div><div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;          Entry[Part] = getConsecutiveVector(Broadcasted, VF * Part, <span class="keyword">false</span>);</div><div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;      }<span class="comment"></span></div><div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;<span class="comment">      /// Vectorize casts.</span></div><div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;<span class="comment"></span>      <a class="code" href="classllvm_1_1Type.html">Type</a> *DestTy = (VF == 1) ? CI-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>() :</div><div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;                                 <a class="code" href="classllvm_1_1VectorType.html#ab43657ed1abe2e2ed3a6a394f233ebd0">VectorType::get</a>(CI-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>(), VF);</div><div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;</div><div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;      VectorParts &amp;<a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a> = getVectorValue(<a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a>-&gt;getOperand(0));</div><div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> Part = 0; Part &lt; UF; ++Part)</div><div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;        Entry[Part] = Builder.CreateCast(CI-&gt;<a class="code" href="classllvm_1_1CastInst.html#adc3489e61d5f37a0e4c5589859fbccc2">getOpcode</a>(), A[Part], DestTy);</div><div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;    }</div><div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;</div><div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacellvm.html#af6d6a791770bad2303c4399986979e3eae411369b2f0d8f484fec62c3291b1b51">Instruction::Call</a>: {</div><div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;      <span class="comment">// Ignore dbg intrinsics.</span></div><div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;      <span class="keywordflow">if</span> (isa&lt;DbgInfoIntrinsic&gt;(<a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a>))</div><div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160;      setDebugLocFromInst(Builder, <a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a>);</div><div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;</div><div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;      <a class="code" href="classllvm_1_1Module.html">Module</a> *<a class="code" href="Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a> = BB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#aca229503e4f5c83a187a6a921c625fa8">getParent</a>()-&gt;<a class="code" href="classllvm_1_1GlobalValue.html#a9e1fc23a17e97d2d1732e753ae9251ac">getParent</a>();</div><div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160;      <a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI = cast&lt;CallInst&gt;(<a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a>);</div><div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;      <a class="code" href="namespacellvm_1_1Intrinsic.html#a73349916f7e54a6b988a3646c7a02e90">Intrinsic::ID</a> <a class="code" href="namespacellvm_1_1CallingConv.html#a4f861731fc6dbfdccc05af5968d98974">ID</a> = <a class="code" href="LoopVectorize_8cpp.html#a417c0c66aeccfcbee14042ec89bab074">getIntrinsicIDForCall</a>(CI, TLI);</div><div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;      assert(ID &amp;&amp; <span class="stringliteral">&quot;Not an intrinsic call!&quot;</span>);</div><div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160;      <span class="keywordflow">switch</span> (ID) {</div><div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1Intrinsic.html#a73349916f7e54a6b988a3646c7a02e90aa332b90dd5e4ebf4bbbcc0964220d373">Intrinsic::lifetime_end</a>:</div><div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1Intrinsic.html#a73349916f7e54a6b988a3646c7a02e90ae365354e47542c51f9bd46e329e3323e">Intrinsic::lifetime_start</a>:</div><div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160;        scalarizeInstruction(<a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a>);</div><div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160;      <span class="keywordflow">default</span>:</div><div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> Part = 0; Part &lt; UF; ++Part) {</div><div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;          <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Value *, 4&gt;</a> Args;</div><div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0, ie = CI-&gt;<a class="code" href="classllvm_1_1CallInst.html#ac88b95273e6c753188f6a54d65548579">getNumArgOperands</a>(); <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != ie; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160;            VectorParts &amp;Arg = getVectorValue(CI-&gt;<a class="code" href="classllvm_1_1CallInst.html#a150b33ecedbc8c7803c2db8040fbe3f8">getArgOperand</a>(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>));</div><div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;            Args.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(Arg[Part]);</div><div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;          }</div><div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;          <a class="code" href="classllvm_1_1Type.html">Type</a> *Tys[] = {CI-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>()};</div><div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;          <span class="keywordflow">if</span> (VF &gt; 1)</div><div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;            Tys[0] = <a class="code" href="classllvm_1_1VectorType.html#ab43657ed1abe2e2ed3a6a394f233ebd0">VectorType::get</a>(CI-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a8eafa71cf399da8f21b2af5549f3f9e7">getScalarType</a>(), VF);</div><div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160;</div><div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;          <a class="code" href="classllvm_1_1Function.html">Function</a> *<a class="code" href="LLParser_8cpp.html#a33ece1ef8074506a15d7f86eb76dbae6">F</a> = <a class="code" href="namespacellvm_1_1Intrinsic.html#a842176a2c8c60a94bc788454b0828ea2">Intrinsic::getDeclaration</a>(M, ID, Tys);</div><div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160;          Entry[Part] = Builder.CreateCall(F, Args);</div><div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;        }</div><div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;      }</div><div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160;    }</div><div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;</div><div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;    <span class="keywordflow">default</span>:</div><div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;      <span class="comment">// All other instructions are unsupported. Scalarize them.</span></div><div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;      scalarizeInstruction(<a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a>);</div><div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;    }<span class="comment">// end of switch.</span></div><div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160;  }<span class="comment">// end of for_each instr.</span></div><div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;}</div><div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;</div><div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;<span class="keywordtype">void</span> InnerLoopVectorizer::updateAnalysis() {</div><div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;  <span class="comment">// Forget the original basic block.</span></div><div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;  SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a592bdd7731b14ff4ff5d646f6f399900">forgetLoop</a>(OrigLoop);</div><div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;</div><div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;  <span class="comment">// Update the dominator tree information.</span></div><div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;  assert(DT-&gt;properlyDominates(LoopBypassBlocks.front(), LoopExitBlock) &amp;&amp;</div><div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;         <span class="stringliteral">&quot;Entry does not dominate exit.&quot;</span>);</div><div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;</div><div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = 1, E = LoopBypassBlocks.size(); <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> != E; ++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)</div><div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160;    DT-&gt;addNewBlock(LoopBypassBlocks[<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>], LoopBypassBlocks[I-1]);</div><div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;  DT-&gt;addNewBlock(LoopVectorPreHeader, LoopBypassBlocks.back());</div><div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;  DT-&gt;addNewBlock(LoopVectorBody, LoopVectorPreHeader);</div><div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160;  DT-&gt;addNewBlock(LoopMiddleBlock, LoopBypassBlocks.front());</div><div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160;  DT-&gt;addNewBlock(LoopScalarPreHeader, LoopMiddleBlock);</div><div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;  DT-&gt;changeImmediateDominator(LoopScalarBody, LoopScalarPreHeader);</div><div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;  DT-&gt;changeImmediateDominator(LoopExitBlock, LoopMiddleBlock);</div><div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;</div><div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;  <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(DT-&gt;verifyAnalysis());</div><div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;}</div><div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160;<span class="comment">/// \brief Check whether it is safe to if-convert this phi node.</span></div><div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;<span class="comment">/// Phi nodes with constant expressions that can trap are not safe to if</span></div><div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;<span class="comment">/// convert.</span></div><div class="line"><a name="l02788"></a><span class="lineno"><a class="line" href="LoopVectorize_8cpp.html#ad0837b25464367550b8d67a5607c0149"> 2788</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="LoopVectorize_8cpp.html#ad0837b25464367550b8d67a5607c0149">canIfConvertPHINodes</a>(<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *BB) {</div><div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1ilist__iterator.html">BasicBlock::iterator</a> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = BB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a0ed5f3ab3c2e4196ee0cffffa080c062">begin</a>(), E = BB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a0b4e7bee9b8575cc7db73329f1a561bd">end</a>(); <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> != E; ++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div><div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160;    <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *Phi = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1PHINode.html">PHINode</a>&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div><div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160;    <span class="keywordflow">if</span> (!Phi)</div><div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2ARM_2README_8txt.html#a38e79c83dad9b9a5f38c9693371a8709">p</a> = 0, e = Phi-&gt;<a class="code" href="classllvm_1_1PHINode.html#aa45f6c0433576e3858a6209a43750ad4">getNumIncomingValues</a>(); <a class="code" href="Target_2ARM_2README_8txt.html#a38e79c83dad9b9a5f38c9693371a8709">p</a> != e; ++<a class="code" href="Target_2ARM_2README_8txt.html#a38e79c83dad9b9a5f38c9693371a8709">p</a>)</div><div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Constant.html">Constant</a> *<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = dyn_cast&lt;Constant&gt;(Phi-&gt;<a class="code" href="classllvm_1_1PHINode.html#aba6a4cc4ed6d6fef3664b8d65ef04820">getIncomingValue</a>(<a class="code" href="Target_2ARM_2README_8txt.html#a38e79c83dad9b9a5f38c9693371a8709">p</a>)))</div><div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>-&gt;canTrap())</div><div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160;  }</div><div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;}</div><div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;</div><div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;<span class="keywordtype">bool</span> LoopVectorizationLegality::canVectorizeWithIfConvert() {</div><div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="LoopVectorize_8cpp.html#ab10ac4a80fce310e0fa7c74066153ebc">EnableIfConversion</a>)</div><div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;</div><div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;  assert(TheLoop-&gt;getNumBlocks() &gt; 1 &amp;&amp; <span class="stringliteral">&quot;Single block loops are vectorizable&quot;</span>);</div><div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;</div><div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;  <span class="comment">// A list of pointers that we can safely read and write to.</span></div><div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;  <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;Value *, 8&gt;</a> SafePointes;</div><div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160;</div><div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;  <span class="comment">// Collect safe addresses.</span></div><div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1LoopBase.html#ab39f9623eaa8cd22213aa716c6fb9994">Loop::block_iterator</a> BI = TheLoop-&gt;block_begin(),</div><div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;         BE = TheLoop-&gt;block_end(); BI != BE; ++BI) {</div><div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160;    <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *BB = *BI;</div><div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160;</div><div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;    <span class="keywordflow">if</span> (blockNeedsPredication(BB))</div><div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160;</div><div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1ilist__iterator.html">BasicBlock::iterator</a> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = BB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a0ed5f3ab3c2e4196ee0cffffa080c062">begin</a>(), E = BB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a0b4e7bee9b8575cc7db73329f1a561bd">end</a>(); <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> != E; ++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div><div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1LoadInst.html">LoadInst</a> *LI = dyn_cast&lt;LoadInst&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>))</div><div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160;        SafePointes.insert(LI-&gt;getPointerOperand());</div><div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1StoreInst.html">StoreInst</a> *SI = dyn_cast&lt;StoreInst&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>))</div><div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;        SafePointes.insert(SI-&gt;getPointerOperand());</div><div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;    }</div><div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160;  }</div><div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;</div><div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;  <span class="comment">// Collect the blocks that need predication.</span></div><div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *Header = TheLoop-&gt;getHeader();</div><div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1LoopBase.html#ab39f9623eaa8cd22213aa716c6fb9994">Loop::block_iterator</a> BI = TheLoop-&gt;block_begin(),</div><div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160;         BE = TheLoop-&gt;block_end(); BI != BE; ++BI) {</div><div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160;    <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *BB = *BI;</div><div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160;</div><div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160;    <span class="comment">// We don&#39;t support switch statements inside loops.</span></div><div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160;    <span class="keywordflow">if</span> (!isa&lt;BranchInst&gt;(BB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a5cb76a65b6524dba1493dd2b9dc3abbe">getTerminator</a>()))</div><div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160;</div><div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160;    <span class="comment">// We must be able to predicate all blocks that need to be predicated.</span></div><div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160;    <span class="keywordflow">if</span> (blockNeedsPredication(BB)) {</div><div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160;      <span class="keywordflow">if</span> (!blockCanBePredicated(BB, SafePointes))</div><div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (BB != Header &amp;&amp; !<a class="code" href="LoopVectorize_8cpp.html#ad0837b25464367550b8d67a5607c0149">canIfConvertPHINodes</a>(BB))</div><div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160;</div><div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;  }</div><div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160;</div><div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160;  <span class="comment">// We can if-convert this loop.</span></div><div class="line"><a name="l02846"></a><span class="lineno"> 2846</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l02847"></a><span class="lineno"> 2847</span>&#160;}</div><div class="line"><a name="l02848"></a><span class="lineno"> 2848</span>&#160;</div><div class="line"><a name="l02849"></a><span class="lineno"> 2849</span>&#160;<span class="keywordtype">bool</span> LoopVectorizationLegality::canVectorize() {</div><div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160;  <span class="comment">// We must have a loop in canonical form. Loops with indirectbr in them cannot</span></div><div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160;  <span class="comment">// be canonicalized.</span></div><div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160;  <span class="keywordflow">if</span> (!TheLoop-&gt;getLoopPreheader())</div><div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160;</div><div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160;  <span class="comment">// We can only vectorize innermost loops.</span></div><div class="line"><a name="l02856"></a><span class="lineno"> 2856</span>&#160;  <span class="keywordflow">if</span> (TheLoop-&gt;getSubLoopsVector().size())</div><div class="line"><a name="l02857"></a><span class="lineno"> 2857</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l02858"></a><span class="lineno"> 2858</span>&#160;</div><div class="line"><a name="l02859"></a><span class="lineno"> 2859</span>&#160;  <span class="comment">// We must have a single backedge.</span></div><div class="line"><a name="l02860"></a><span class="lineno"> 2860</span>&#160;  <span class="keywordflow">if</span> (TheLoop-&gt;getNumBackEdges() != 1)</div><div class="line"><a name="l02861"></a><span class="lineno"> 2861</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l02862"></a><span class="lineno"> 2862</span>&#160;</div><div class="line"><a name="l02863"></a><span class="lineno"> 2863</span>&#160;  <span class="comment">// We must have a single exiting block.</span></div><div class="line"><a name="l02864"></a><span class="lineno"> 2864</span>&#160;  <span class="keywordflow">if</span> (!TheLoop-&gt;getExitingBlock())</div><div class="line"><a name="l02865"></a><span class="lineno"> 2865</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l02866"></a><span class="lineno"> 2866</span>&#160;</div><div class="line"><a name="l02867"></a><span class="lineno"> 2867</span>&#160;  <span class="comment">// We need to have a loop header.</span></div><div class="line"><a name="l02868"></a><span class="lineno"> 2868</span>&#160;  <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;LV: Found a loop: &quot;</span> &lt;&lt;</div><div class="line"><a name="l02869"></a><span class="lineno"> 2869</span>&#160;        TheLoop-&gt;getHeader()-&gt;getName() &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>);</div><div class="line"><a name="l02870"></a><span class="lineno"> 2870</span>&#160;</div><div class="line"><a name="l02871"></a><span class="lineno"> 2871</span>&#160;  <span class="comment">// Check if we can if-convert non single-bb loops.</span></div><div class="line"><a name="l02872"></a><span class="lineno"> 2872</span>&#160;  <span class="keywordtype">unsigned</span> NumBlocks = TheLoop-&gt;getNumBlocks();</div><div class="line"><a name="l02873"></a><span class="lineno"> 2873</span>&#160;  <span class="keywordflow">if</span> (NumBlocks != 1 &amp;&amp; !canVectorizeWithIfConvert()) {</div><div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160;    <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;LV: Can&#39;t if-convert the loop.\n&quot;</span>);</div><div class="line"><a name="l02875"></a><span class="lineno"> 2875</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l02876"></a><span class="lineno"> 2876</span>&#160;  }</div><div class="line"><a name="l02877"></a><span class="lineno"> 2877</span>&#160;</div><div class="line"><a name="l02878"></a><span class="lineno"> 2878</span>&#160;  <span class="comment">// ScalarEvolution needs to be able to find the exit count.</span></div><div class="line"><a name="l02879"></a><span class="lineno"> 2879</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *ExitCount = SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#aecd7aba4460358813feef37d71d5024e">getBackedgeTakenCount</a>(TheLoop);</div><div class="line"><a name="l02880"></a><span class="lineno"> 2880</span>&#160;  <span class="keywordflow">if</span> (ExitCount == SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#aaa9b9055fd9c69fe14eb20f0d18d53d5">getCouldNotCompute</a>()) {</div><div class="line"><a name="l02881"></a><span class="lineno"> 2881</span>&#160;    <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;LV: SCEV could not compute the loop exit count.\n&quot;</span>);</div><div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160;  }</div><div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160;</div><div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160;  <span class="comment">// Do not loop-vectorize loops with a tiny trip count.</span></div><div class="line"><a name="l02886"></a><span class="lineno"> 2886</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *Latch = TheLoop-&gt;getLoopLatch();</div><div class="line"><a name="l02887"></a><span class="lineno"> 2887</span>&#160;  <span class="keywordtype">unsigned</span> TC = SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a5984e47d0885332478dc9232634d82e8">getSmallConstantTripCount</a>(TheLoop, Latch);</div><div class="line"><a name="l02888"></a><span class="lineno"> 2888</span>&#160;  <span class="keywordflow">if</span> (TC &gt; 0u &amp;&amp; TC &lt; <a class="code" href="LoopVectorize_8cpp.html#a5318ba92781fc5fa3e26483f058b470a">TinyTripCountVectorThreshold</a>) {</div><div class="line"><a name="l02889"></a><span class="lineno"> 2889</span>&#160;    <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;LV: Found a loop with a very small trip count. &quot;</span> &lt;&lt;</div><div class="line"><a name="l02890"></a><span class="lineno"> 2890</span>&#160;          <span class="stringliteral">&quot;This loop is not worth vectorizing.\n&quot;</span>);</div><div class="line"><a name="l02891"></a><span class="lineno"> 2891</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l02892"></a><span class="lineno"> 2892</span>&#160;  }</div><div class="line"><a name="l02893"></a><span class="lineno"> 2893</span>&#160;</div><div class="line"><a name="l02894"></a><span class="lineno"> 2894</span>&#160;  <span class="comment">// Check if we can vectorize the instructions and CFG in this loop.</span></div><div class="line"><a name="l02895"></a><span class="lineno"> 2895</span>&#160;  <span class="keywordflow">if</span> (!canVectorizeInstrs()) {</div><div class="line"><a name="l02896"></a><span class="lineno"> 2896</span>&#160;    <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;LV: Can&#39;t vectorize the instructions or CFG\n&quot;</span>);</div><div class="line"><a name="l02897"></a><span class="lineno"> 2897</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l02898"></a><span class="lineno"> 2898</span>&#160;  }</div><div class="line"><a name="l02899"></a><span class="lineno"> 2899</span>&#160;</div><div class="line"><a name="l02900"></a><span class="lineno"> 2900</span>&#160;  <span class="comment">// Go over each instruction and look at memory deps.</span></div><div class="line"><a name="l02901"></a><span class="lineno"> 2901</span>&#160;  <span class="keywordflow">if</span> (!canVectorizeMemory()) {</div><div class="line"><a name="l02902"></a><span class="lineno"> 2902</span>&#160;    <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;LV: Can&#39;t vectorize due to memory conflicts\n&quot;</span>);</div><div class="line"><a name="l02903"></a><span class="lineno"> 2903</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l02904"></a><span class="lineno"> 2904</span>&#160;  }</div><div class="line"><a name="l02905"></a><span class="lineno"> 2905</span>&#160;</div><div class="line"><a name="l02906"></a><span class="lineno"> 2906</span>&#160;  <span class="comment">// Collect all of the variables that remain uniform after vectorization.</span></div><div class="line"><a name="l02907"></a><span class="lineno"> 2907</span>&#160;  collectLoopUniforms();</div><div class="line"><a name="l02908"></a><span class="lineno"> 2908</span>&#160;</div><div class="line"><a name="l02909"></a><span class="lineno"> 2909</span>&#160;  <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;LV: We can vectorize this loop&quot;</span> &lt;&lt;</div><div class="line"><a name="l02910"></a><span class="lineno"> 2910</span>&#160;        (PtrRtCheck.Need ? <span class="stringliteral">&quot; (with a runtime bound check)&quot;</span> : <span class="stringliteral">&quot;&quot;</span>)</div><div class="line"><a name="l02911"></a><span class="lineno"> 2911</span>&#160;        &lt;&lt;<span class="stringliteral">&quot;!\n&quot;</span>);</div><div class="line"><a name="l02912"></a><span class="lineno"> 2912</span>&#160;</div><div class="line"><a name="l02913"></a><span class="lineno"> 2913</span>&#160;  <span class="comment">// Okay! We can vectorize. At this point we don&#39;t have any other mem analysis</span></div><div class="line"><a name="l02914"></a><span class="lineno"> 2914</span>&#160;  <span class="comment">// which may limit our maximum vectorization factor, so just return true with</span></div><div class="line"><a name="l02915"></a><span class="lineno"> 2915</span>&#160;  <span class="comment">// no restrictions.</span></div><div class="line"><a name="l02916"></a><span class="lineno"> 2916</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l02917"></a><span class="lineno"> 2917</span>&#160;}</div><div class="line"><a name="l02918"></a><span class="lineno"> 2918</span>&#160;</div><div class="line"><a name="l02919"></a><span class="lineno"><a class="line" href="LoopVectorize_8cpp.html#ab46314da66bb0ae8d7651f1909e1fa15"> 2919</a></span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1Type.html">Type</a> *<a class="code" href="LoopVectorize_8cpp.html#ab46314da66bb0ae8d7651f1909e1fa15">convertPointerToIntegerType</a>(<a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> &amp;DL, <a class="code" href="classllvm_1_1Type.html">Type</a> *Ty) {</div><div class="line"><a name="l02920"></a><span class="lineno"> 2920</span>&#160;  <span class="keywordflow">if</span> (Ty-&gt;<a class="code" href="classllvm_1_1Type.html#a2eba483f5cc876e824aa6c085736086b">isPointerTy</a>())</div><div class="line"><a name="l02921"></a><span class="lineno"> 2921</span>&#160;    <span class="keywordflow">return</span> DL.<a class="code" href="classllvm_1_1DataLayout.html#ae84bb2408dfffa4e8b5fe2ce0714a3bd">getIntPtrType</a>(Ty);</div><div class="line"><a name="l02922"></a><span class="lineno"> 2922</span>&#160;</div><div class="line"><a name="l02923"></a><span class="lineno"> 2923</span>&#160;  <span class="comment">// It is possible that char&#39;s or short&#39;s overflow when we ask for the loop&#39;s</span></div><div class="line"><a name="l02924"></a><span class="lineno"> 2924</span>&#160;  <span class="comment">// trip count, work around this by changing the type size.</span></div><div class="line"><a name="l02925"></a><span class="lineno"> 2925</span>&#160;  <span class="keywordflow">if</span> (Ty-&gt;<a class="code" href="classllvm_1_1Type.html#ad979b3c1bc975ee23810e3018ffe951b">getScalarSizeInBits</a>() &lt; 32)</div><div class="line"><a name="l02926"></a><span class="lineno"> 2926</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1Type.html#a30dd396c5b40cd86c1591872e574ccdf">Type::getInt32Ty</a>(Ty-&gt;<a class="code" href="classllvm_1_1Type.html#af348d5ea83429d08ba891ca3dd0e92b2">getContext</a>());</div><div class="line"><a name="l02927"></a><span class="lineno"> 2927</span>&#160;</div><div class="line"><a name="l02928"></a><span class="lineno"> 2928</span>&#160;  <span class="keywordflow">return</span> Ty;</div><div class="line"><a name="l02929"></a><span class="lineno"> 2929</span>&#160;}</div><div class="line"><a name="l02930"></a><span class="lineno"> 2930</span>&#160;</div><div class="line"><a name="l02931"></a><span class="lineno"><a class="line" href="LoopVectorize_8cpp.html#a2d7f676d7d60f9dd4f812eb55ee07aed"> 2931</a></span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1Type.html">Type</a>* <a class="code" href="LoopVectorize_8cpp.html#a2d7f676d7d60f9dd4f812eb55ee07aed">getWiderType</a>(<a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> &amp;DL, <a class="code" href="classllvm_1_1Type.html">Type</a> *Ty0, <a class="code" href="classllvm_1_1Type.html">Type</a> *Ty1) {</div><div class="line"><a name="l02932"></a><span class="lineno"> 2932</span>&#160;  Ty0 = <a class="code" href="LoopVectorize_8cpp.html#ab46314da66bb0ae8d7651f1909e1fa15">convertPointerToIntegerType</a>(DL, Ty0);</div><div class="line"><a name="l02933"></a><span class="lineno"> 2933</span>&#160;  Ty1 = <a class="code" href="LoopVectorize_8cpp.html#ab46314da66bb0ae8d7651f1909e1fa15">convertPointerToIntegerType</a>(DL, Ty1);</div><div class="line"><a name="l02934"></a><span class="lineno"> 2934</span>&#160;  <span class="keywordflow">if</span> (Ty0-&gt;<a class="code" href="classllvm_1_1Type.html#ad979b3c1bc975ee23810e3018ffe951b">getScalarSizeInBits</a>() &gt; Ty1-&gt;<a class="code" href="classllvm_1_1Type.html#ad979b3c1bc975ee23810e3018ffe951b">getScalarSizeInBits</a>())</div><div class="line"><a name="l02935"></a><span class="lineno"> 2935</span>&#160;    <span class="keywordflow">return</span> Ty0;</div><div class="line"><a name="l02936"></a><span class="lineno"> 2936</span>&#160;  <span class="keywordflow">return</span> Ty1;</div><div class="line"><a name="l02937"></a><span class="lineno"> 2937</span>&#160;}</div><div class="line"><a name="l02938"></a><span class="lineno"> 2938</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02939"></a><span class="lineno"> 2939</span>&#160;<span class="comment">/// \brief Check that the instruction has outside loop users and is not an</span></div><div class="line"><a name="l02940"></a><span class="lineno"> 2940</span>&#160;<span class="comment">/// identified reduction variable.</span></div><div class="line"><a name="l02941"></a><span class="lineno"><a class="line" href="LoopVectorize_8cpp.html#aaf182c357feddb2f076f2c7e0d7edcea"> 2941</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="LoopVectorize_8cpp.html#aaf182c357feddb2f076f2c7e0d7edcea">hasOutsideLoopUser</a>(<span class="keyword">const</span> <a class="code" href="classllvm_1_1Loop.html">Loop</a> *TheLoop, <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *Inst,</div><div class="line"><a name="l02942"></a><span class="lineno"> 2942</span>&#160;                               <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;Value *, 4&gt;</a> &amp;Reductions) {</div><div class="line"><a name="l02943"></a><span class="lineno"> 2943</span>&#160;  <span class="comment">// Reduction instructions are allowed to have exit users. All other</span></div><div class="line"><a name="l02944"></a><span class="lineno"> 2944</span>&#160;  <span class="comment">// instructions must not have external users.</span></div><div class="line"><a name="l02945"></a><span class="lineno"> 2945</span>&#160;  <span class="keywordflow">if</span> (!Reductions.<a class="code" href="classllvm_1_1SmallPtrSet.html#a2ced6343b8ad006a757059554bbf9f37">count</a>(Inst))</div><div class="line"><a name="l02946"></a><span class="lineno"> 2946</span>&#160;    <span class="comment">//Check that all of the users of the loop are inside the BB.</span></div><div class="line"><a name="l02947"></a><span class="lineno"> 2947</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1value__use__iterator.html">Value::use_iterator</a> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = Inst-&gt;<a class="code" href="classllvm_1_1Value.html#a413abcab8dbc3900fc2fde96a5d8fca6">use_begin</a>(), E = Inst-&gt;<a class="code" href="classllvm_1_1Value.html#ad86469939d2a8bdd4169be9403b89f5a">use_end</a>();</div><div class="line"><a name="l02948"></a><span class="lineno"> 2948</span>&#160;         <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> != E; ++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div><div class="line"><a name="l02949"></a><span class="lineno"> 2949</span>&#160;      <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *U = cast&lt;Instruction&gt;(*I);</div><div class="line"><a name="l02950"></a><span class="lineno"> 2950</span>&#160;      <span class="comment">// This user may be a reduction exit value.</span></div><div class="line"><a name="l02951"></a><span class="lineno"> 2951</span>&#160;      <span class="keywordflow">if</span> (!TheLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a92a38e2e3412bde7fd2b71db212b61aa">contains</a>(U)) {</div><div class="line"><a name="l02952"></a><span class="lineno"> 2952</span>&#160;        <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;LV: Found an outside user for : &quot;</span> &lt;&lt; *U &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>);</div><div class="line"><a name="l02953"></a><span class="lineno"> 2953</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l02954"></a><span class="lineno"> 2954</span>&#160;      }</div><div class="line"><a name="l02955"></a><span class="lineno"> 2955</span>&#160;    }</div><div class="line"><a name="l02956"></a><span class="lineno"> 2956</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l02957"></a><span class="lineno"> 2957</span>&#160;}</div><div class="line"><a name="l02958"></a><span class="lineno"> 2958</span>&#160;</div><div class="line"><a name="l02959"></a><span class="lineno"> 2959</span>&#160;<span class="keywordtype">bool</span> LoopVectorizationLegality::canVectorizeInstrs() {</div><div class="line"><a name="l02960"></a><span class="lineno"> 2960</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *PreHeader = TheLoop-&gt;getLoopPreheader();</div><div class="line"><a name="l02961"></a><span class="lineno"> 2961</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *Header = TheLoop-&gt;getHeader();</div><div class="line"><a name="l02962"></a><span class="lineno"> 2962</span>&#160;</div><div class="line"><a name="l02963"></a><span class="lineno"> 2963</span>&#160;  <span class="comment">// Look for the attribute signaling the absence of NaNs.</span></div><div class="line"><a name="l02964"></a><span class="lineno"> 2964</span>&#160;  <a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="LLParser_8cpp.html#a33ece1ef8074506a15d7f86eb76dbae6">F</a> = *Header-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#aca229503e4f5c83a187a6a921c625fa8">getParent</a>();</div><div class="line"><a name="l02965"></a><span class="lineno"> 2965</span>&#160;  <span class="keywordflow">if</span> (F.<a class="code" href="classllvm_1_1Function.html#a603f8f8d2c9d8de6762092830cf82b13">hasFnAttribute</a>(<span class="stringliteral">&quot;no-nans-fp-math&quot;</span>))</div><div class="line"><a name="l02966"></a><span class="lineno"> 2966</span>&#160;    HasFunNoNaNAttr = F.<a class="code" href="classllvm_1_1Function.html#a72873ed64b7be01507a2248b8e756ec8">getAttributes</a>().<a class="code" href="classllvm_1_1AttributeSet.html#a9a03295702933e2d98be92202fe403f9">getAttribute</a>(</div><div class="line"><a name="l02967"></a><span class="lineno"> 2967</span>&#160;      AttributeSet::FunctionIndex,</div><div class="line"><a name="l02968"></a><span class="lineno"> 2968</span>&#160;      <span class="stringliteral">&quot;no-nans-fp-math&quot;</span>).<a class="code" href="classllvm_1_1Attribute.html#ade69a27a314332bc6e8f36d72a05d0aa">getValueAsString</a>() == <span class="stringliteral">&quot;true&quot;</span>;</div><div class="line"><a name="l02969"></a><span class="lineno"> 2969</span>&#160;</div><div class="line"><a name="l02970"></a><span class="lineno"> 2970</span>&#160;  <span class="comment">// For each block in the loop.</span></div><div class="line"><a name="l02971"></a><span class="lineno"> 2971</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1LoopBase.html#ab39f9623eaa8cd22213aa716c6fb9994">Loop::block_iterator</a> <a class="code" href="Target_2X86_2README_8txt.html#ac9423a63151469d95755528cceb322fb">bb</a> = TheLoop-&gt;block_begin(),</div><div class="line"><a name="l02972"></a><span class="lineno"> 2972</span>&#160;       <a class="code" href="CodeGen_2README_8txt.html#aa0629dbc89f0868f62da8cbcb681b2be">be</a> = TheLoop-&gt;block_end(); <a class="code" href="Target_2X86_2README_8txt.html#ac9423a63151469d95755528cceb322fb">bb</a> != <a class="code" href="CodeGen_2README_8txt.html#aa0629dbc89f0868f62da8cbcb681b2be">be</a>; ++<a class="code" href="Target_2X86_2README_8txt.html#ac9423a63151469d95755528cceb322fb">bb</a>) {</div><div class="line"><a name="l02973"></a><span class="lineno"> 2973</span>&#160;</div><div class="line"><a name="l02974"></a><span class="lineno"> 2974</span>&#160;    <span class="comment">// Scan the instructions in the block and look for hazards.</span></div><div class="line"><a name="l02975"></a><span class="lineno"> 2975</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1ilist__iterator.html">BasicBlock::iterator</a> <a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a> = (*bb)-&gt;begin(), e = (*bb)-&gt;end(); <a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a> != e;</div><div class="line"><a name="l02976"></a><span class="lineno"> 2976</span>&#160;         ++<a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a>) {</div><div class="line"><a name="l02977"></a><span class="lineno"> 2977</span>&#160;</div><div class="line"><a name="l02978"></a><span class="lineno"> 2978</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *Phi = dyn_cast&lt;PHINode&gt;(<a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a>)) {</div><div class="line"><a name="l02979"></a><span class="lineno"> 2979</span>&#160;        <a class="code" href="classllvm_1_1Type.html">Type</a> *PhiTy = Phi-&gt;getType();</div><div class="line"><a name="l02980"></a><span class="lineno"> 2980</span>&#160;        <span class="comment">// Check that this PHI type is allowed.</span></div><div class="line"><a name="l02981"></a><span class="lineno"> 2981</span>&#160;        <span class="keywordflow">if</span> (!PhiTy-&gt;<a class="code" href="classllvm_1_1Type.html#a6e328feb83afa5cf1c966d6704e43fc1">isIntegerTy</a>() &amp;&amp;</div><div class="line"><a name="l02982"></a><span class="lineno"> 2982</span>&#160;            !PhiTy-&gt;<a class="code" href="classllvm_1_1Type.html#a40113570b0c52a18c34cabed8359e2c8">isFloatingPointTy</a>() &amp;&amp;</div><div class="line"><a name="l02983"></a><span class="lineno"> 2983</span>&#160;            !PhiTy-&gt;<a class="code" href="classllvm_1_1Type.html#a2eba483f5cc876e824aa6c085736086b">isPointerTy</a>()) {</div><div class="line"><a name="l02984"></a><span class="lineno"> 2984</span>&#160;          <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;LV: Found an non-int non-pointer PHI.\n&quot;</span>);</div><div class="line"><a name="l02985"></a><span class="lineno"> 2985</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l02986"></a><span class="lineno"> 2986</span>&#160;        }</div><div class="line"><a name="l02987"></a><span class="lineno"> 2987</span>&#160;</div><div class="line"><a name="l02988"></a><span class="lineno"> 2988</span>&#160;        <span class="comment">// If this PHINode is not in the header block, then we know that we</span></div><div class="line"><a name="l02989"></a><span class="lineno"> 2989</span>&#160;        <span class="comment">// can convert it to select during if-conversion. No need to check if</span></div><div class="line"><a name="l02990"></a><span class="lineno"> 2990</span>&#160;        <span class="comment">// the PHIs in this block are induction or reduction variables.</span></div><div class="line"><a name="l02991"></a><span class="lineno"> 2991</span>&#160;        <span class="keywordflow">if</span> (*<a class="code" href="Target_2X86_2README_8txt.html#ac9423a63151469d95755528cceb322fb">bb</a> != Header) {</div><div class="line"><a name="l02992"></a><span class="lineno"> 2992</span>&#160;          <span class="comment">// Check that this instruction has no outside users or is an</span></div><div class="line"><a name="l02993"></a><span class="lineno"> 2993</span>&#160;          <span class="comment">// identified reduction value with an outside user.</span></div><div class="line"><a name="l02994"></a><span class="lineno"> 2994</span>&#160;          <span class="keywordflow">if</span>(!<a class="code" href="LoopVectorize_8cpp.html#aaf182c357feddb2f076f2c7e0d7edcea">hasOutsideLoopUser</a>(TheLoop, <a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a>, AllowedExit))</div><div class="line"><a name="l02995"></a><span class="lineno"> 2995</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l02996"></a><span class="lineno"> 2996</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l02997"></a><span class="lineno"> 2997</span>&#160;        }</div><div class="line"><a name="l02998"></a><span class="lineno"> 2998</span>&#160;</div><div class="line"><a name="l02999"></a><span class="lineno"> 2999</span>&#160;        <span class="comment">// We only allow if-converted PHIs with more than two incoming values.</span></div><div class="line"><a name="l03000"></a><span class="lineno"> 3000</span>&#160;        <span class="keywordflow">if</span> (Phi-&gt;getNumIncomingValues() != 2) {</div><div class="line"><a name="l03001"></a><span class="lineno"> 3001</span>&#160;          <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;LV: Found an invalid PHI.\n&quot;</span>);</div><div class="line"><a name="l03002"></a><span class="lineno"> 3002</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l03003"></a><span class="lineno"> 3003</span>&#160;        }</div><div class="line"><a name="l03004"></a><span class="lineno"> 3004</span>&#160;</div><div class="line"><a name="l03005"></a><span class="lineno"> 3005</span>&#160;        <span class="comment">// This is the value coming from the preheader.</span></div><div class="line"><a name="l03006"></a><span class="lineno"> 3006</span>&#160;        <a class="code" href="classllvm_1_1Value.html">Value</a> *StartValue = Phi-&gt;getIncomingValueForBlock(PreHeader);</div><div class="line"><a name="l03007"></a><span class="lineno"> 3007</span>&#160;        <span class="comment">// Check if this is an induction variable.</span></div><div class="line"><a name="l03008"></a><span class="lineno"> 3008</span>&#160;        InductionKind IK = isInductionVariable(Phi);</div><div class="line"><a name="l03009"></a><span class="lineno"> 3009</span>&#160;</div><div class="line"><a name="l03010"></a><span class="lineno"> 3010</span>&#160;        <span class="keywordflow">if</span> (IK_NoInduction != IK) {</div><div class="line"><a name="l03011"></a><span class="lineno"> 3011</span>&#160;          <span class="comment">// Get the widest type.</span></div><div class="line"><a name="l03012"></a><span class="lineno"> 3012</span>&#160;          <span class="keywordflow">if</span> (!WidestIndTy)</div><div class="line"><a name="l03013"></a><span class="lineno"> 3013</span>&#160;            WidestIndTy = <a class="code" href="LoopVectorize_8cpp.html#ab46314da66bb0ae8d7651f1909e1fa15">convertPointerToIntegerType</a>(*DL, PhiTy);</div><div class="line"><a name="l03014"></a><span class="lineno"> 3014</span>&#160;          <span class="keywordflow">else</span></div><div class="line"><a name="l03015"></a><span class="lineno"> 3015</span>&#160;            WidestIndTy = <a class="code" href="LoopVectorize_8cpp.html#a2d7f676d7d60f9dd4f812eb55ee07aed">getWiderType</a>(*DL, PhiTy, WidestIndTy);</div><div class="line"><a name="l03016"></a><span class="lineno"> 3016</span>&#160;</div><div class="line"><a name="l03017"></a><span class="lineno"> 3017</span>&#160;          <span class="comment">// Int inductions are special because we only allow one IV.</span></div><div class="line"><a name="l03018"></a><span class="lineno"> 3018</span>&#160;          <span class="keywordflow">if</span> (IK == IK_IntInduction) {</div><div class="line"><a name="l03019"></a><span class="lineno"> 3019</span>&#160;            <span class="comment">// Use the phi node with the widest type as induction. Use the last</span></div><div class="line"><a name="l03020"></a><span class="lineno"> 3020</span>&#160;            <span class="comment">// one if there are multiple (no good reason for doing this other</span></div><div class="line"><a name="l03021"></a><span class="lineno"> 3021</span>&#160;            <span class="comment">// than it is expedient).</span></div><div class="line"><a name="l03022"></a><span class="lineno"> 3022</span>&#160;            <span class="keywordflow">if</span> (!Induction || PhiTy == WidestIndTy)</div><div class="line"><a name="l03023"></a><span class="lineno"> 3023</span>&#160;              Induction = Phi;</div><div class="line"><a name="l03024"></a><span class="lineno"> 3024</span>&#160;          }</div><div class="line"><a name="l03025"></a><span class="lineno"> 3025</span>&#160;</div><div class="line"><a name="l03026"></a><span class="lineno"> 3026</span>&#160;          <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;LV: Found an induction variable.\n&quot;</span>);</div><div class="line"><a name="l03027"></a><span class="lineno"> 3027</span>&#160;          Inductions[Phi] = InductionInfo(StartValue, IK);</div><div class="line"><a name="l03028"></a><span class="lineno"> 3028</span>&#160;</div><div class="line"><a name="l03029"></a><span class="lineno"> 3029</span>&#160;          <span class="comment">// Until we explicitly handle the case of an induction variable with</span></div><div class="line"><a name="l03030"></a><span class="lineno"> 3030</span>&#160;          <span class="comment">// an outside loop user we have to give up vectorizing this loop.</span></div><div class="line"><a name="l03031"></a><span class="lineno"> 3031</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="LoopVectorize_8cpp.html#aaf182c357feddb2f076f2c7e0d7edcea">hasOutsideLoopUser</a>(TheLoop, <a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a>, AllowedExit))</div><div class="line"><a name="l03032"></a><span class="lineno"> 3032</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l03033"></a><span class="lineno"> 3033</span>&#160;</div><div class="line"><a name="l03034"></a><span class="lineno"> 3034</span>&#160;          <span class="keywordflow">continue</span>;</div><div class="line"><a name="l03035"></a><span class="lineno"> 3035</span>&#160;        }</div><div class="line"><a name="l03036"></a><span class="lineno"> 3036</span>&#160;</div><div class="line"><a name="l03037"></a><span class="lineno"> 3037</span>&#160;        <span class="keywordflow">if</span> (AddReductionVar(Phi, RK_IntegerAdd)) {</div><div class="line"><a name="l03038"></a><span class="lineno"> 3038</span>&#160;          <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;LV: Found an ADD reduction PHI.&quot;</span>&lt;&lt; *Phi &lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line"><a name="l03039"></a><span class="lineno"> 3039</span>&#160;          <span class="keywordflow">continue</span>;</div><div class="line"><a name="l03040"></a><span class="lineno"> 3040</span>&#160;        }</div><div class="line"><a name="l03041"></a><span class="lineno"> 3041</span>&#160;        <span class="keywordflow">if</span> (AddReductionVar(Phi, RK_IntegerMult)) {</div><div class="line"><a name="l03042"></a><span class="lineno"> 3042</span>&#160;          <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;LV: Found a MUL reduction PHI.&quot;</span>&lt;&lt; *Phi &lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line"><a name="l03043"></a><span class="lineno"> 3043</span>&#160;          <span class="keywordflow">continue</span>;</div><div class="line"><a name="l03044"></a><span class="lineno"> 3044</span>&#160;        }</div><div class="line"><a name="l03045"></a><span class="lineno"> 3045</span>&#160;        <span class="keywordflow">if</span> (AddReductionVar(Phi, RK_IntegerOr)) {</div><div class="line"><a name="l03046"></a><span class="lineno"> 3046</span>&#160;          <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;LV: Found an OR reduction PHI.&quot;</span>&lt;&lt; *Phi &lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line"><a name="l03047"></a><span class="lineno"> 3047</span>&#160;          <span class="keywordflow">continue</span>;</div><div class="line"><a name="l03048"></a><span class="lineno"> 3048</span>&#160;        }</div><div class="line"><a name="l03049"></a><span class="lineno"> 3049</span>&#160;        <span class="keywordflow">if</span> (AddReductionVar(Phi, RK_IntegerAnd)) {</div><div class="line"><a name="l03050"></a><span class="lineno"> 3050</span>&#160;          <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;LV: Found an AND reduction PHI.&quot;</span>&lt;&lt; *Phi &lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line"><a name="l03051"></a><span class="lineno"> 3051</span>&#160;          <span class="keywordflow">continue</span>;</div><div class="line"><a name="l03052"></a><span class="lineno"> 3052</span>&#160;        }</div><div class="line"><a name="l03053"></a><span class="lineno"> 3053</span>&#160;        <span class="keywordflow">if</span> (AddReductionVar(Phi, RK_IntegerXor)) {</div><div class="line"><a name="l03054"></a><span class="lineno"> 3054</span>&#160;          <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;LV: Found a XOR reduction PHI.&quot;</span>&lt;&lt; *Phi &lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line"><a name="l03055"></a><span class="lineno"> 3055</span>&#160;          <span class="keywordflow">continue</span>;</div><div class="line"><a name="l03056"></a><span class="lineno"> 3056</span>&#160;        }</div><div class="line"><a name="l03057"></a><span class="lineno"> 3057</span>&#160;        <span class="keywordflow">if</span> (AddReductionVar(Phi, RK_IntegerMinMax)) {</div><div class="line"><a name="l03058"></a><span class="lineno"> 3058</span>&#160;          <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;LV: Found a MINMAX reduction PHI.&quot;</span>&lt;&lt; *Phi &lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line"><a name="l03059"></a><span class="lineno"> 3059</span>&#160;          <span class="keywordflow">continue</span>;</div><div class="line"><a name="l03060"></a><span class="lineno"> 3060</span>&#160;        }</div><div class="line"><a name="l03061"></a><span class="lineno"> 3061</span>&#160;        <span class="keywordflow">if</span> (AddReductionVar(Phi, RK_FloatMult)) {</div><div class="line"><a name="l03062"></a><span class="lineno"> 3062</span>&#160;          <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;LV: Found an FMult reduction PHI.&quot;</span>&lt;&lt; *Phi &lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line"><a name="l03063"></a><span class="lineno"> 3063</span>&#160;          <span class="keywordflow">continue</span>;</div><div class="line"><a name="l03064"></a><span class="lineno"> 3064</span>&#160;        }</div><div class="line"><a name="l03065"></a><span class="lineno"> 3065</span>&#160;        <span class="keywordflow">if</span> (AddReductionVar(Phi, RK_FloatAdd)) {</div><div class="line"><a name="l03066"></a><span class="lineno"> 3066</span>&#160;          <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;LV: Found an FAdd reduction PHI.&quot;</span>&lt;&lt; *Phi &lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line"><a name="l03067"></a><span class="lineno"> 3067</span>&#160;          <span class="keywordflow">continue</span>;</div><div class="line"><a name="l03068"></a><span class="lineno"> 3068</span>&#160;        }</div><div class="line"><a name="l03069"></a><span class="lineno"> 3069</span>&#160;        <span class="keywordflow">if</span> (AddReductionVar(Phi, RK_FloatMinMax)) {</div><div class="line"><a name="l03070"></a><span class="lineno"> 3070</span>&#160;          <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;LV: Found an float MINMAX reduction PHI.&quot;</span>&lt;&lt; *Phi &lt;&lt;</div><div class="line"><a name="l03071"></a><span class="lineno"> 3071</span>&#160;                <span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line"><a name="l03072"></a><span class="lineno"> 3072</span>&#160;          <span class="keywordflow">continue</span>;</div><div class="line"><a name="l03073"></a><span class="lineno"> 3073</span>&#160;        }</div><div class="line"><a name="l03074"></a><span class="lineno"> 3074</span>&#160;</div><div class="line"><a name="l03075"></a><span class="lineno"> 3075</span>&#160;        <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;LV: Found an unidentified PHI.&quot;</span>&lt;&lt; *Phi &lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line"><a name="l03076"></a><span class="lineno"> 3076</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l03077"></a><span class="lineno"> 3077</span>&#160;      }<span class="comment">// end of PHI handling</span></div><div class="line"><a name="l03078"></a><span class="lineno"> 3078</span>&#160;</div><div class="line"><a name="l03079"></a><span class="lineno"> 3079</span>&#160;      <span class="comment">// We still don&#39;t handle functions. However, we can ignore dbg intrinsic</span></div><div class="line"><a name="l03080"></a><span class="lineno"> 3080</span>&#160;      <span class="comment">// calls and we do handle certain intrinsic and libm functions.</span></div><div class="line"><a name="l03081"></a><span class="lineno"> 3081</span>&#160;      <a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1CallInst.html">CallInst</a>&gt;(<a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a>);</div><div class="line"><a name="l03082"></a><span class="lineno"> 3082</span>&#160;      <span class="keywordflow">if</span> (CI &amp;&amp; !<a class="code" href="LoopVectorize_8cpp.html#a417c0c66aeccfcbee14042ec89bab074">getIntrinsicIDForCall</a>(CI, TLI) &amp;&amp; !isa&lt;DbgInfoIntrinsic&gt;(CI)) {</div><div class="line"><a name="l03083"></a><span class="lineno"> 3083</span>&#160;        <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;LV: Found a call site.\n&quot;</span>);</div><div class="line"><a name="l03084"></a><span class="lineno"> 3084</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l03085"></a><span class="lineno"> 3085</span>&#160;      }</div><div class="line"><a name="l03086"></a><span class="lineno"> 3086</span>&#160;</div><div class="line"><a name="l03087"></a><span class="lineno"> 3087</span>&#160;      <span class="comment">// Check that the instruction return type is vectorizable.</span></div><div class="line"><a name="l03088"></a><span class="lineno"> 3088</span>&#160;      <span class="comment">// Also, we can&#39;t vectorize extractelement instructions.</span></div><div class="line"><a name="l03089"></a><span class="lineno"> 3089</span>&#160;      <span class="keywordflow">if</span> ((!<a class="code" href="classllvm_1_1VectorType.html#a071e25c5c6eae5299b1cdc3350c6d55c">VectorType::isValidElementType</a>(<a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a>-&gt;getType()) &amp;&amp;</div><div class="line"><a name="l03090"></a><span class="lineno"> 3090</span>&#160;           !<a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a>-&gt;getType()-&gt;isVoidTy()) || isa&lt;ExtractElementInst&gt;(<a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a>)) {</div><div class="line"><a name="l03091"></a><span class="lineno"> 3091</span>&#160;        <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;LV: Found unvectorizable type.\n&quot;</span>);</div><div class="line"><a name="l03092"></a><span class="lineno"> 3092</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l03093"></a><span class="lineno"> 3093</span>&#160;      }</div><div class="line"><a name="l03094"></a><span class="lineno"> 3094</span>&#160;</div><div class="line"><a name="l03095"></a><span class="lineno"> 3095</span>&#160;      <span class="comment">// Check that the stored type is vectorizable.</span></div><div class="line"><a name="l03096"></a><span class="lineno"> 3096</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1StoreInst.html">StoreInst</a> *<a class="code" href="namespacellvm_1_1A64DB.html#a6fce8157775f3ec93f326b52b0f1e0f5a4916e736d6b7cc68359b39d5eb50f6db">ST</a> = dyn_cast&lt;StoreInst&gt;(<a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a>)) {</div><div class="line"><a name="l03097"></a><span class="lineno"> 3097</span>&#160;        <a class="code" href="classllvm_1_1Type.html">Type</a> *<a class="code" href="classT.html">T</a> = <a class="code" href="namespacellvm_1_1A64DB.html#a6fce8157775f3ec93f326b52b0f1e0f5a4916e736d6b7cc68359b39d5eb50f6db">ST</a>-&gt;getValueOperand()-&gt;getType();</div><div class="line"><a name="l03098"></a><span class="lineno"> 3098</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="classllvm_1_1VectorType.html#a071e25c5c6eae5299b1cdc3350c6d55c">VectorType::isValidElementType</a>(T))</div><div class="line"><a name="l03099"></a><span class="lineno"> 3099</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l03100"></a><span class="lineno"> 3100</span>&#160;      }</div><div class="line"><a name="l03101"></a><span class="lineno"> 3101</span>&#160;</div><div class="line"><a name="l03102"></a><span class="lineno"> 3102</span>&#160;      <span class="comment">// Reduction instructions are allowed to have exit users.</span></div><div class="line"><a name="l03103"></a><span class="lineno"> 3103</span>&#160;      <span class="comment">// All other instructions must not have external users.</span></div><div class="line"><a name="l03104"></a><span class="lineno"> 3104</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="LoopVectorize_8cpp.html#aaf182c357feddb2f076f2c7e0d7edcea">hasOutsideLoopUser</a>(TheLoop, <a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a>, AllowedExit))</div><div class="line"><a name="l03105"></a><span class="lineno"> 3105</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l03106"></a><span class="lineno"> 3106</span>&#160;</div><div class="line"><a name="l03107"></a><span class="lineno"> 3107</span>&#160;    } <span class="comment">// next instr.</span></div><div class="line"><a name="l03108"></a><span class="lineno"> 3108</span>&#160;</div><div class="line"><a name="l03109"></a><span class="lineno"> 3109</span>&#160;  }</div><div class="line"><a name="l03110"></a><span class="lineno"> 3110</span>&#160;</div><div class="line"><a name="l03111"></a><span class="lineno"> 3111</span>&#160;  <span class="keywordflow">if</span> (!Induction) {</div><div class="line"><a name="l03112"></a><span class="lineno"> 3112</span>&#160;    <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;LV: Did not find one integer induction var.\n&quot;</span>);</div><div class="line"><a name="l03113"></a><span class="lineno"> 3113</span>&#160;    <span class="keywordflow">if</span> (Inductions.empty())</div><div class="line"><a name="l03114"></a><span class="lineno"> 3114</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l03115"></a><span class="lineno"> 3115</span>&#160;  }</div><div class="line"><a name="l03116"></a><span class="lineno"> 3116</span>&#160;</div><div class="line"><a name="l03117"></a><span class="lineno"> 3117</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l03118"></a><span class="lineno"> 3118</span>&#160;}</div><div class="line"><a name="l03119"></a><span class="lineno"> 3119</span>&#160;</div><div class="line"><a name="l03120"></a><span class="lineno"> 3120</span>&#160;<span class="keywordtype">void</span> LoopVectorizationLegality::collectLoopUniforms() {</div><div class="line"><a name="l03121"></a><span class="lineno"> 3121</span>&#160;  <span class="comment">// We now know that the loop is vectorizable!</span></div><div class="line"><a name="l03122"></a><span class="lineno"> 3122</span>&#160;  <span class="comment">// Collect variables that will remain uniform after vectorization.</span></div><div class="line"><a name="l03123"></a><span class="lineno"> 3123</span>&#160;  std::vector&lt;Value*&gt; Worklist;</div><div class="line"><a name="l03124"></a><span class="lineno"> 3124</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *Latch = TheLoop-&gt;getLoopLatch();</div><div class="line"><a name="l03125"></a><span class="lineno"> 3125</span>&#160;</div><div class="line"><a name="l03126"></a><span class="lineno"> 3126</span>&#160;  <span class="comment">// Start with the conditional branch and walk up the block.</span></div><div class="line"><a name="l03127"></a><span class="lineno"> 3127</span>&#160;  Worklist.push_back(Latch-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a5cb76a65b6524dba1493dd2b9dc3abbe">getTerminator</a>()-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0));</div><div class="line"><a name="l03128"></a><span class="lineno"> 3128</span>&#160;</div><div class="line"><a name="l03129"></a><span class="lineno"> 3129</span>&#160;  <span class="keywordflow">while</span> (Worklist.size()) {</div><div class="line"><a name="l03130"></a><span class="lineno"> 3130</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1Instruction.html">Instruction</a>&gt;(Worklist.back());</div><div class="line"><a name="l03131"></a><span class="lineno"> 3131</span>&#160;    Worklist.pop_back();</div><div class="line"><a name="l03132"></a><span class="lineno"> 3132</span>&#160;</div><div class="line"><a name="l03133"></a><span class="lineno"> 3133</span>&#160;    <span class="comment">// Look at instructions inside this loop.</span></div><div class="line"><a name="l03134"></a><span class="lineno"> 3134</span>&#160;    <span class="comment">// Stop when reaching PHI nodes.</span></div><div class="line"><a name="l03135"></a><span class="lineno"> 3135</span>&#160;    <span class="comment">// TODO: we need to follow values all over the loop, not only in this block.</span></div><div class="line"><a name="l03136"></a><span class="lineno"> 3136</span>&#160;    <span class="keywordflow">if</span> (!I || !TheLoop-&gt;contains(I) || isa&lt;PHINode&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>))</div><div class="line"><a name="l03137"></a><span class="lineno"> 3137</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l03138"></a><span class="lineno"> 3138</span>&#160;</div><div class="line"><a name="l03139"></a><span class="lineno"> 3139</span>&#160;    <span class="comment">// This is a known uniform.</span></div><div class="line"><a name="l03140"></a><span class="lineno"> 3140</span>&#160;    Uniforms.insert(I);</div><div class="line"><a name="l03141"></a><span class="lineno"> 3141</span>&#160;</div><div class="line"><a name="l03142"></a><span class="lineno"> 3142</span>&#160;    <span class="comment">// Insert all operands.</span></div><div class="line"><a name="l03143"></a><span class="lineno"> 3143</span>&#160;    Worklist.insert(Worklist.end(), I-&gt;<a class="code" href="classllvm_1_1User.html#a2eeb1c7ed1cfe403f2ae0470e36c07e2">op_begin</a>(), I-&gt;<a class="code" href="classllvm_1_1User.html#af41f58e730804d10b91fcff39b035f74">op_end</a>());</div><div class="line"><a name="l03144"></a><span class="lineno"> 3144</span>&#160;  }</div><div class="line"><a name="l03145"></a><span class="lineno"> 3145</span>&#160;}</div><div class="line"><a name="l03146"></a><span class="lineno"> 3146</span>&#160;</div><div class="line"><a name="l03147"></a><span class="lineno"> 3147</span>&#160;<span class="keyword">namespace </span>{<span class="comment"></span></div><div class="line"><a name="l03148"></a><span class="lineno"> 3148</span>&#160;<span class="comment">/// \brief Analyses memory accesses in a loop.</span></div><div class="line"><a name="l03149"></a><span class="lineno"> 3149</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l03150"></a><span class="lineno"> 3150</span>&#160;<span class="comment">/// Checks whether run time pointer checks are needed and builds sets for data</span></div><div class="line"><a name="l03151"></a><span class="lineno"> 3151</span>&#160;<span class="comment">/// dependence checking.</span></div><div class="line"><a name="l03152"></a><span class="lineno"> 3152</span>&#160;<span class="comment"></span><span class="keyword">class </span>AccessAnalysis {</div><div class="line"><a name="l03153"></a><span class="lineno"> 3153</span>&#160;<span class="keyword">public</span>:<span class="comment"></span></div><div class="line"><a name="l03154"></a><span class="lineno"> 3154</span>&#160;<span class="comment">  /// \brief Read or write access location.</span></div><div class="line"><a name="l03155"></a><span class="lineno"> 3155</span>&#160;<span class="comment"></span>  <span class="keyword">typedef</span> <a class="code" href="classllvm_1_1PointerIntPair.html">PointerIntPair&lt;Value *, 1, bool&gt;</a> MemAccessInfo;</div><div class="line"><a name="l03156"></a><span class="lineno"> 3156</span>&#160;  <span class="keyword">typedef</span> <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;MemAccessInfo, 8&gt;</a> MemAccessInfoSet;</div><div class="line"><a name="l03157"></a><span class="lineno"> 3157</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03158"></a><span class="lineno"> 3158</span>&#160;<span class="comment">  /// \brief Set of potential dependent memory accesses.</span></div><div class="line"><a name="l03159"></a><span class="lineno"> 3159</span>&#160;<span class="comment"></span>  <span class="keyword">typedef</span> <a class="code" href="classllvm_1_1EquivalenceClasses.html">EquivalenceClasses&lt;MemAccessInfo&gt;</a> DepCandidates;</div><div class="line"><a name="l03160"></a><span class="lineno"> 3160</span>&#160;</div><div class="line"><a name="l03161"></a><span class="lineno"> 3161</span>&#160;  AccessAnalysis(<a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> *Dl, DepCandidates &amp;<a class="code" href="namespacellvm_1_1X86II.html#a97dc14052814702ba0e2b14fb14dd02da4e7ea93eb7bffafeed5db26fe5e9a179">DA</a>) :</div><div class="line"><a name="l03162"></a><span class="lineno"> 3162</span>&#160;    DL(Dl), DepCands(DA), AreAllWritesIdentified(<span class="keyword">true</span>),</div><div class="line"><a name="l03163"></a><span class="lineno"> 3163</span>&#160;    AreAllReadsIdentified(<span class="keyword">true</span>), IsRTCheckNeeded(<span class="keyword">false</span>) {}</div><div class="line"><a name="l03164"></a><span class="lineno"> 3164</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03165"></a><span class="lineno"> 3165</span>&#160;<span class="comment">  /// \brief Register a load  and whether it is only read from.</span></div><div class="line"><a name="l03166"></a><span class="lineno"> 3166</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> addLoad(<a class="code" href="classllvm_1_1Value.html">Value</a> *Ptr, <span class="keywordtype">bool</span> IsReadOnly) {</div><div class="line"><a name="l03167"></a><span class="lineno"> 3167</span>&#160;    Accesses.insert(MemAccessInfo(Ptr, <span class="keyword">false</span>));</div><div class="line"><a name="l03168"></a><span class="lineno"> 3168</span>&#160;    <span class="keywordflow">if</span> (IsReadOnly)</div><div class="line"><a name="l03169"></a><span class="lineno"> 3169</span>&#160;      ReadOnlyPtr.insert(Ptr);</div><div class="line"><a name="l03170"></a><span class="lineno"> 3170</span>&#160;  }</div><div class="line"><a name="l03171"></a><span class="lineno"> 3171</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03172"></a><span class="lineno"> 3172</span>&#160;<span class="comment">  /// \brief Register a store.</span></div><div class="line"><a name="l03173"></a><span class="lineno"> 3173</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> addStore(<a class="code" href="classllvm_1_1Value.html">Value</a> *Ptr) {</div><div class="line"><a name="l03174"></a><span class="lineno"> 3174</span>&#160;    Accesses.insert(MemAccessInfo(Ptr, <span class="keyword">true</span>));</div><div class="line"><a name="l03175"></a><span class="lineno"> 3175</span>&#160;  }</div><div class="line"><a name="l03176"></a><span class="lineno"> 3176</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03177"></a><span class="lineno"> 3177</span>&#160;<span class="comment">  /// \brief Check whether we can check the pointers at runtime for</span></div><div class="line"><a name="l03178"></a><span class="lineno"> 3178</span>&#160;<span class="comment">  /// non-intersection.</span></div><div class="line"><a name="l03179"></a><span class="lineno"> 3179</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> canCheckPtrAtRT(LoopVectorizationLegality::RuntimePointerCheck &amp;RtCheck,</div><div class="line"><a name="l03180"></a><span class="lineno"> 3180</span>&#160;                       <span class="keywordtype">unsigned</span> &amp;NumComparisons, <a class="code" href="classllvm_1_1ScalarEvolution.html">ScalarEvolution</a> *SE,</div><div class="line"><a name="l03181"></a><span class="lineno"> 3181</span>&#160;                       <a class="code" href="classllvm_1_1Loop.html">Loop</a> *TheLoop, <span class="keywordtype">bool</span> ShouldCheckStride = <span class="keyword">false</span>);</div><div class="line"><a name="l03182"></a><span class="lineno"> 3182</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03183"></a><span class="lineno"> 3183</span>&#160;<span class="comment">  /// \brief Goes over all memory accesses, checks whether a RT check is needed</span></div><div class="line"><a name="l03184"></a><span class="lineno"> 3184</span>&#160;<span class="comment">  /// and builds sets of dependent accesses.</span></div><div class="line"><a name="l03185"></a><span class="lineno"> 3185</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> buildDependenceSets() {</div><div class="line"><a name="l03186"></a><span class="lineno"> 3186</span>&#160;    <span class="comment">// Process read-write pointers first.</span></div><div class="line"><a name="l03187"></a><span class="lineno"> 3187</span>&#160;    processMemAccesses(<span class="keyword">false</span>);</div><div class="line"><a name="l03188"></a><span class="lineno"> 3188</span>&#160;    <span class="comment">// Next, process read pointers.</span></div><div class="line"><a name="l03189"></a><span class="lineno"> 3189</span>&#160;    processMemAccesses(<span class="keyword">true</span>);</div><div class="line"><a name="l03190"></a><span class="lineno"> 3190</span>&#160;  }</div><div class="line"><a name="l03191"></a><span class="lineno"> 3191</span>&#160;</div><div class="line"><a name="l03192"></a><span class="lineno"> 3192</span>&#160;  <span class="keywordtype">bool</span> isRTCheckNeeded() { <span class="keywordflow">return</span> IsRTCheckNeeded; }</div><div class="line"><a name="l03193"></a><span class="lineno"> 3193</span>&#160;</div><div class="line"><a name="l03194"></a><span class="lineno"> 3194</span>&#160;  <span class="keywordtype">bool</span> isDependencyCheckNeeded() { <span class="keywordflow">return</span> !CheckDeps.empty(); }</div><div class="line"><a name="l03195"></a><span class="lineno"> 3195</span>&#160;  <span class="keywordtype">void</span> resetDepChecks() { CheckDeps.clear(); }</div><div class="line"><a name="l03196"></a><span class="lineno"> 3196</span>&#160;</div><div class="line"><a name="l03197"></a><span class="lineno"> 3197</span>&#160;  MemAccessInfoSet &amp;getDependenciesToCheck() { <span class="keywordflow">return</span> CheckDeps; }</div><div class="line"><a name="l03198"></a><span class="lineno"> 3198</span>&#160;</div><div class="line"><a name="l03199"></a><span class="lineno"> 3199</span>&#160;<span class="keyword">private</span>:</div><div class="line"><a name="l03200"></a><span class="lineno"> 3200</span>&#160;  <span class="keyword">typedef</span> <a class="code" href="classllvm_1_1SetVector.html">SetVector&lt;MemAccessInfo&gt;</a> PtrAccessSet;</div><div class="line"><a name="l03201"></a><span class="lineno"> 3201</span>&#160;  <span class="keyword">typedef</span> <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;Value*, MemAccessInfo&gt;</a> UnderlyingObjToAccessMap;</div><div class="line"><a name="l03202"></a><span class="lineno"> 3202</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03203"></a><span class="lineno"> 3203</span>&#160;<span class="comment">  /// \brief Go over all memory access or only the deferred ones if</span></div><div class="line"><a name="l03204"></a><span class="lineno"> 3204</span>&#160;<span class="comment">  /// \p UseDeferred is true and check whether runtime pointer checks are needed</span></div><div class="line"><a name="l03205"></a><span class="lineno"> 3205</span>&#160;<span class="comment">  /// and build sets of dependency check candidates.</span></div><div class="line"><a name="l03206"></a><span class="lineno"> 3206</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> processMemAccesses(<span class="keywordtype">bool</span> UseDeferred);</div><div class="line"><a name="l03207"></a><span class="lineno"> 3207</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03208"></a><span class="lineno"> 3208</span>&#160;<span class="comment">  /// Set of all accesses.</span></div><div class="line"><a name="l03209"></a><span class="lineno"> 3209</span>&#160;<span class="comment"></span>  PtrAccessSet Accesses;</div><div class="line"><a name="l03210"></a><span class="lineno"> 3210</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03211"></a><span class="lineno"> 3211</span>&#160;<span class="comment">  /// Set of access to check after all writes have been processed.</span></div><div class="line"><a name="l03212"></a><span class="lineno"> 3212</span>&#160;<span class="comment"></span>  PtrAccessSet DeferredAccesses;</div><div class="line"><a name="l03213"></a><span class="lineno"> 3213</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03214"></a><span class="lineno"> 3214</span>&#160;<span class="comment">  /// Map of pointers to last access encountered.</span></div><div class="line"><a name="l03215"></a><span class="lineno"> 3215</span>&#160;<span class="comment"></span>  UnderlyingObjToAccessMap ObjToLastAccess;</div><div class="line"><a name="l03216"></a><span class="lineno"> 3216</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03217"></a><span class="lineno"> 3217</span>&#160;<span class="comment">  /// Set of accesses that need a further dependence check.</span></div><div class="line"><a name="l03218"></a><span class="lineno"> 3218</span>&#160;<span class="comment"></span>  MemAccessInfoSet CheckDeps;</div><div class="line"><a name="l03219"></a><span class="lineno"> 3219</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03220"></a><span class="lineno"> 3220</span>&#160;<span class="comment">  /// Set of pointers that are read only.</span></div><div class="line"><a name="l03221"></a><span class="lineno"> 3221</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;Value*, 16&gt;</a> ReadOnlyPtr;</div><div class="line"><a name="l03222"></a><span class="lineno"> 3222</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03223"></a><span class="lineno"> 3223</span>&#160;<span class="comment">  /// Set of underlying objects already written to.</span></div><div class="line"><a name="l03224"></a><span class="lineno"> 3224</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;Value*, 16&gt;</a> WriteObjects;</div><div class="line"><a name="l03225"></a><span class="lineno"> 3225</span>&#160;</div><div class="line"><a name="l03226"></a><span class="lineno"> 3226</span>&#160;  <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> *DL;</div><div class="line"><a name="l03227"></a><span class="lineno"> 3227</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03228"></a><span class="lineno"> 3228</span>&#160;<span class="comment">  /// Sets of potentially dependent accesses - members of one set share an</span></div><div class="line"><a name="l03229"></a><span class="lineno"> 3229</span>&#160;<span class="comment">  /// underlying pointer. The set &quot;CheckDeps&quot; identfies which sets really need a</span></div><div class="line"><a name="l03230"></a><span class="lineno"> 3230</span>&#160;<span class="comment">  /// dependence check.</span></div><div class="line"><a name="l03231"></a><span class="lineno"> 3231</span>&#160;<span class="comment"></span>  DepCandidates &amp;DepCands;</div><div class="line"><a name="l03232"></a><span class="lineno"> 3232</span>&#160;</div><div class="line"><a name="l03233"></a><span class="lineno"> 3233</span>&#160;  <span class="keywordtype">bool</span> AreAllWritesIdentified;</div><div class="line"><a name="l03234"></a><span class="lineno"> 3234</span>&#160;  <span class="keywordtype">bool</span> AreAllReadsIdentified;</div><div class="line"><a name="l03235"></a><span class="lineno"> 3235</span>&#160;  <span class="keywordtype">bool</span> IsRTCheckNeeded;</div><div class="line"><a name="l03236"></a><span class="lineno"> 3236</span>&#160;};</div><div class="line"><a name="l03237"></a><span class="lineno"> 3237</span>&#160;</div><div class="line"><a name="l03238"></a><span class="lineno"> 3238</span>&#160;} <span class="comment">// end anonymous namespace</span></div><div class="line"><a name="l03239"></a><span class="lineno"> 3239</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03240"></a><span class="lineno"> 3240</span>&#160;<span class="comment">/// \brief Check whether a pointer can participate in a runtime bounds check.</span></div><div class="line"><a name="l03241"></a><span class="lineno"><a class="line" href="LoopVectorize_8cpp.html#afe0ea5914ce503bf3a5bb91bd84f3ba6"> 3241</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="LoopVectorize_8cpp.html#afe0ea5914ce503bf3a5bb91bd84f3ba6">hasComputableBounds</a>(<a class="code" href="classllvm_1_1ScalarEvolution.html">ScalarEvolution</a> *SE, <a class="code" href="classllvm_1_1Value.html">Value</a> *Ptr) {</div><div class="line"><a name="l03242"></a><span class="lineno"> 3242</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *PtrScev = SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a30bd18ac905eacf3601bc6a553a9ff49">getSCEV</a>(Ptr);</div><div class="line"><a name="l03243"></a><span class="lineno"> 3243</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEVAddRecExpr.html">SCEVAddRecExpr</a> *AR = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1SCEVAddRecExpr.html">SCEVAddRecExpr</a>&gt;(PtrScev);</div><div class="line"><a name="l03244"></a><span class="lineno"> 3244</span>&#160;  <span class="keywordflow">if</span> (!AR)</div><div class="line"><a name="l03245"></a><span class="lineno"> 3245</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l03246"></a><span class="lineno"> 3246</span>&#160;</div><div class="line"><a name="l03247"></a><span class="lineno"> 3247</span>&#160;  <span class="keywordflow">return</span> AR-&gt;<a class="code" href="classllvm_1_1SCEVAddRecExpr.html#a88f514461ddb0af0fc59ac4639f644bc">isAffine</a>();</div><div class="line"><a name="l03248"></a><span class="lineno"> 3248</span>&#160;}</div><div class="line"><a name="l03249"></a><span class="lineno"> 3249</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03250"></a><span class="lineno"> 3250</span>&#160;<span class="comment">/// \brief Check the stride of the pointer and ensure that it does not wrap in</span></div><div class="line"><a name="l03251"></a><span class="lineno"> 3251</span>&#160;<span class="comment">/// the address space.</span></div><div class="line"><a name="l03252"></a><span class="lineno"> 3252</span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="LoopVectorize_8cpp.html#ae0635a013d9930362a412c26d0978739">isStridedPtr</a>(<a class="code" href="classllvm_1_1ScalarEvolution.html">ScalarEvolution</a> *SE, <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> *DL, <a class="code" href="classllvm_1_1Value.html">Value</a> *Ptr,</div><div class="line"><a name="l03253"></a><span class="lineno"> 3253</span>&#160;                        <span class="keyword">const</span> <a class="code" href="classllvm_1_1Loop.html">Loop</a> *Lp);</div><div class="line"><a name="l03254"></a><span class="lineno"> 3254</span>&#160;</div><div class="line"><a name="l03255"></a><span class="lineno"> 3255</span>&#160;<span class="keywordtype">bool</span> AccessAnalysis::canCheckPtrAtRT(</div><div class="line"><a name="l03256"></a><span class="lineno"> 3256</span>&#160;                       LoopVectorizationLegality::RuntimePointerCheck &amp;RtCheck,</div><div class="line"><a name="l03257"></a><span class="lineno"> 3257</span>&#160;                        <span class="keywordtype">unsigned</span> &amp;NumComparisons, <a class="code" href="classllvm_1_1ScalarEvolution.html">ScalarEvolution</a> *SE,</div><div class="line"><a name="l03258"></a><span class="lineno"> 3258</span>&#160;                        <a class="code" href="classllvm_1_1Loop.html">Loop</a> *TheLoop, <span class="keywordtype">bool</span> ShouldCheckStride) {</div><div class="line"><a name="l03259"></a><span class="lineno"> 3259</span>&#160;  <span class="comment">// Find pointers with computable bounds. We are going to use this information</span></div><div class="line"><a name="l03260"></a><span class="lineno"> 3260</span>&#160;  <span class="comment">// to place a runtime bound check.</span></div><div class="line"><a name="l03261"></a><span class="lineno"> 3261</span>&#160;  <span class="keywordtype">unsigned</span> NumReadPtrChecks = 0;</div><div class="line"><a name="l03262"></a><span class="lineno"> 3262</span>&#160;  <span class="keywordtype">unsigned</span> NumWritePtrChecks = 0;</div><div class="line"><a name="l03263"></a><span class="lineno"> 3263</span>&#160;  <span class="keywordtype">bool</span> CanDoRT = <span class="keyword">true</span>;</div><div class="line"><a name="l03264"></a><span class="lineno"> 3264</span>&#160;</div><div class="line"><a name="l03265"></a><span class="lineno"> 3265</span>&#160;  <span class="keywordtype">bool</span> IsDepCheckNeeded = isDependencyCheckNeeded();</div><div class="line"><a name="l03266"></a><span class="lineno"> 3266</span>&#160;  <span class="comment">// We assign consecutive id to access from different dependence sets.</span></div><div class="line"><a name="l03267"></a><span class="lineno"> 3267</span>&#160;  <span class="comment">// Accesses within the same set don&#39;t need a runtime check.</span></div><div class="line"><a name="l03268"></a><span class="lineno"> 3268</span>&#160;  <span class="keywordtype">unsigned</span> RunningDepId = 1;</div><div class="line"><a name="l03269"></a><span class="lineno"> 3269</span>&#160;  <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;Value *, unsigned&gt;</a> DepSetId;</div><div class="line"><a name="l03270"></a><span class="lineno"> 3270</span>&#160;</div><div class="line"><a name="l03271"></a><span class="lineno"> 3271</span>&#160;  <span class="keywordflow">for</span> (PtrAccessSet::iterator AI = Accesses.begin(), AE = Accesses.end();</div><div class="line"><a name="l03272"></a><span class="lineno"> 3272</span>&#160;       AI != AE; ++AI) {</div><div class="line"><a name="l03273"></a><span class="lineno"> 3273</span>&#160;    <span class="keyword">const</span> MemAccessInfo &amp;Access = *AI;</div><div class="line"><a name="l03274"></a><span class="lineno"> 3274</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *Ptr = Access.getPointer();</div><div class="line"><a name="l03275"></a><span class="lineno"> 3275</span>&#160;    <span class="keywordtype">bool</span> IsWrite = Access.getInt();</div><div class="line"><a name="l03276"></a><span class="lineno"> 3276</span>&#160;</div><div class="line"><a name="l03277"></a><span class="lineno"> 3277</span>&#160;    <span class="comment">// Just add write checks if we have both.</span></div><div class="line"><a name="l03278"></a><span class="lineno"> 3278</span>&#160;    <span class="keywordflow">if</span> (!IsWrite &amp;&amp; Accesses.count(MemAccessInfo(Ptr, <span class="keyword">true</span>)))</div><div class="line"><a name="l03279"></a><span class="lineno"> 3279</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l03280"></a><span class="lineno"> 3280</span>&#160;</div><div class="line"><a name="l03281"></a><span class="lineno"> 3281</span>&#160;    <span class="keywordflow">if</span> (IsWrite)</div><div class="line"><a name="l03282"></a><span class="lineno"> 3282</span>&#160;      ++NumWritePtrChecks;</div><div class="line"><a name="l03283"></a><span class="lineno"> 3283</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l03284"></a><span class="lineno"> 3284</span>&#160;      ++NumReadPtrChecks;</div><div class="line"><a name="l03285"></a><span class="lineno"> 3285</span>&#160;</div><div class="line"><a name="l03286"></a><span class="lineno"> 3286</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="LoopVectorize_8cpp.html#afe0ea5914ce503bf3a5bb91bd84f3ba6">hasComputableBounds</a>(SE, Ptr) &amp;&amp;</div><div class="line"><a name="l03287"></a><span class="lineno"> 3287</span>&#160;        <span class="comment">// When we run after a failing dependency check we have to make sure we</span></div><div class="line"><a name="l03288"></a><span class="lineno"> 3288</span>&#160;        <span class="comment">// don&#39;t have wrapping pointers.</span></div><div class="line"><a name="l03289"></a><span class="lineno"> 3289</span>&#160;        (!ShouldCheckStride || <a class="code" href="LoopVectorize_8cpp.html#ae0635a013d9930362a412c26d0978739">isStridedPtr</a>(SE, DL, Ptr, TheLoop) == 1)) {</div><div class="line"><a name="l03290"></a><span class="lineno"> 3290</span>&#160;      <span class="comment">// The id of the dependence set.</span></div><div class="line"><a name="l03291"></a><span class="lineno"> 3291</span>&#160;      <span class="keywordtype">unsigned</span> DepId;</div><div class="line"><a name="l03292"></a><span class="lineno"> 3292</span>&#160;</div><div class="line"><a name="l03293"></a><span class="lineno"> 3293</span>&#160;      <span class="keywordflow">if</span> (IsDepCheckNeeded) {</div><div class="line"><a name="l03294"></a><span class="lineno"> 3294</span>&#160;        <a class="code" href="classllvm_1_1Value.html">Value</a> *Leader = DepCands.getLeaderValue(Access).getPointer();</div><div class="line"><a name="l03295"></a><span class="lineno"> 3295</span>&#160;        <span class="keywordtype">unsigned</span> &amp;LeaderId = DepSetId[Leader];</div><div class="line"><a name="l03296"></a><span class="lineno"> 3296</span>&#160;        <span class="keywordflow">if</span> (!LeaderId)</div><div class="line"><a name="l03297"></a><span class="lineno"> 3297</span>&#160;          LeaderId = RunningDepId++;</div><div class="line"><a name="l03298"></a><span class="lineno"> 3298</span>&#160;        DepId = LeaderId;</div><div class="line"><a name="l03299"></a><span class="lineno"> 3299</span>&#160;      } <span class="keywordflow">else</span></div><div class="line"><a name="l03300"></a><span class="lineno"> 3300</span>&#160;        <span class="comment">// Each access has its own dependence set.</span></div><div class="line"><a name="l03301"></a><span class="lineno"> 3301</span>&#160;        DepId = RunningDepId++;</div><div class="line"><a name="l03302"></a><span class="lineno"> 3302</span>&#160;</div><div class="line"><a name="l03303"></a><span class="lineno"> 3303</span>&#160;      RtCheck.<a class="code" href="classllvm_1_1DenseMapBase.html#a699a66e504b48fdeff124e82f6c61917">insert</a>(SE, TheLoop, Ptr, IsWrite, DepId);</div><div class="line"><a name="l03304"></a><span class="lineno"> 3304</span>&#160;</div><div class="line"><a name="l03305"></a><span class="lineno"> 3305</span>&#160;      <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;LV: Found a runtime check ptr:&quot;</span> &lt;&lt; *Ptr &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>);</div><div class="line"><a name="l03306"></a><span class="lineno"> 3306</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l03307"></a><span class="lineno"> 3307</span>&#160;      CanDoRT = <span class="keyword">false</span>;</div><div class="line"><a name="l03308"></a><span class="lineno"> 3308</span>&#160;    }</div><div class="line"><a name="l03309"></a><span class="lineno"> 3309</span>&#160;  }</div><div class="line"><a name="l03310"></a><span class="lineno"> 3310</span>&#160;</div><div class="line"><a name="l03311"></a><span class="lineno"> 3311</span>&#160;  <span class="keywordflow">if</span> (IsDepCheckNeeded &amp;&amp; CanDoRT &amp;&amp; RunningDepId == 2)</div><div class="line"><a name="l03312"></a><span class="lineno"> 3312</span>&#160;    NumComparisons = 0; <span class="comment">// Only one dependence set.</span></div><div class="line"><a name="l03313"></a><span class="lineno"> 3313</span>&#160;  <span class="keywordflow">else</span> {</div><div class="line"><a name="l03314"></a><span class="lineno"> 3314</span>&#160;    NumComparisons = (NumWritePtrChecks * (NumReadPtrChecks +</div><div class="line"><a name="l03315"></a><span class="lineno"> 3315</span>&#160;                                           NumWritePtrChecks - 1));</div><div class="line"><a name="l03316"></a><span class="lineno"> 3316</span>&#160;  }</div><div class="line"><a name="l03317"></a><span class="lineno"> 3317</span>&#160;</div><div class="line"><a name="l03318"></a><span class="lineno"> 3318</span>&#160;  <span class="comment">// If the pointers that we would use for the bounds comparison have different</span></div><div class="line"><a name="l03319"></a><span class="lineno"> 3319</span>&#160;  <span class="comment">// address spaces, assume the values aren&#39;t directly comparable, so we can&#39;t</span></div><div class="line"><a name="l03320"></a><span class="lineno"> 3320</span>&#160;  <span class="comment">// use them for the runtime check. We also have to assume they could</span></div><div class="line"><a name="l03321"></a><span class="lineno"> 3321</span>&#160;  <span class="comment">// overlap. In the future there should be metadata for whether address spaces</span></div><div class="line"><a name="l03322"></a><span class="lineno"> 3322</span>&#160;  <span class="comment">// are disjoint.</span></div><div class="line"><a name="l03323"></a><span class="lineno"> 3323</span>&#160;  <span class="keywordtype">unsigned</span> NumPointers = RtCheck.Pointers.size();</div><div class="line"><a name="l03324"></a><span class="lineno"> 3324</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; NumPointers; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l03325"></a><span class="lineno"> 3325</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a> = <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> + 1; <a class="code" href="Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a> &lt; NumPointers; ++<a class="code" href="Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a>) {</div><div class="line"><a name="l03326"></a><span class="lineno"> 3326</span>&#160;      <span class="comment">// Only need to check pointers between two different dependency sets.</span></div><div class="line"><a name="l03327"></a><span class="lineno"> 3327</span>&#160;      <span class="keywordflow">if</span> (RtCheck.DependencySetId[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>] == RtCheck.DependencySetId[<a class="code" href="Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a>])</div><div class="line"><a name="l03328"></a><span class="lineno"> 3328</span>&#160;       <span class="keywordflow">continue</span>;</div><div class="line"><a name="l03329"></a><span class="lineno"> 3329</span>&#160;</div><div class="line"><a name="l03330"></a><span class="lineno"> 3330</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *PtrI = RtCheck.Pointers[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div><div class="line"><a name="l03331"></a><span class="lineno"> 3331</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *PtrJ = RtCheck.Pointers[<a class="code" href="Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a>];</div><div class="line"><a name="l03332"></a><span class="lineno"> 3332</span>&#160;</div><div class="line"><a name="l03333"></a><span class="lineno"> 3333</span>&#160;      <span class="keywordtype">unsigned</span> ASi = PtrI-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a33f9fa1a7cb21319a30836fce847c3c4">getPointerAddressSpace</a>();</div><div class="line"><a name="l03334"></a><span class="lineno"> 3334</span>&#160;      <span class="keywordtype">unsigned</span> ASj = PtrJ-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a33f9fa1a7cb21319a30836fce847c3c4">getPointerAddressSpace</a>();</div><div class="line"><a name="l03335"></a><span class="lineno"> 3335</span>&#160;      <span class="keywordflow">if</span> (ASi != ASj) {</div><div class="line"><a name="l03336"></a><span class="lineno"> 3336</span>&#160;        <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;LV: Runtime check would require comparison between&quot;</span></div><div class="line"><a name="l03337"></a><span class="lineno"> 3337</span>&#160;                       <span class="stringliteral">&quot; different address spaces\n&quot;</span>);</div><div class="line"><a name="l03338"></a><span class="lineno"> 3338</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l03339"></a><span class="lineno"> 3339</span>&#160;      }</div><div class="line"><a name="l03340"></a><span class="lineno"> 3340</span>&#160;    }</div><div class="line"><a name="l03341"></a><span class="lineno"> 3341</span>&#160;  }</div><div class="line"><a name="l03342"></a><span class="lineno"> 3342</span>&#160;</div><div class="line"><a name="l03343"></a><span class="lineno"> 3343</span>&#160;  <span class="keywordflow">return</span> CanDoRT;</div><div class="line"><a name="l03344"></a><span class="lineno"> 3344</span>&#160;}</div><div class="line"><a name="l03345"></a><span class="lineno"> 3345</span>&#160;</div><div class="line"><a name="l03346"></a><span class="lineno"><a class="line" href="LoopVectorize_8cpp.html#ac0a7f10a4ddc8820c772795c63cb5c83"> 3346</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="LoopVectorize_8cpp.html#ac0a7f10a4ddc8820c772795c63cb5c83">isFunctionScopeIdentifiedObject</a>(<a class="code" href="classllvm_1_1Value.html">Value</a> *Ptr) {</div><div class="line"><a name="l03347"></a><span class="lineno"> 3347</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#a691b42b1b319ffdde8a8394c38627c63">isNoAliasArgument</a>(Ptr) || <a class="code" href="namespacellvm.html#a433468826ef20b5ddb53704fc38363fc">isNoAliasCall</a>(Ptr) || isa&lt;AllocaInst&gt;(Ptr);</div><div class="line"><a name="l03348"></a><span class="lineno"> 3348</span>&#160;}</div><div class="line"><a name="l03349"></a><span class="lineno"> 3349</span>&#160;</div><div class="line"><a name="l03350"></a><span class="lineno"> 3350</span>&#160;<span class="keywordtype">void</span> AccessAnalysis::processMemAccesses(<span class="keywordtype">bool</span> UseDeferred) {</div><div class="line"><a name="l03351"></a><span class="lineno"> 3351</span>&#160;  <span class="comment">// We process the set twice: first we process read-write pointers, last we</span></div><div class="line"><a name="l03352"></a><span class="lineno"> 3352</span>&#160;  <span class="comment">// process read-only pointers. This allows us to skip dependence tests for</span></div><div class="line"><a name="l03353"></a><span class="lineno"> 3353</span>&#160;  <span class="comment">// read-only pointers.</span></div><div class="line"><a name="l03354"></a><span class="lineno"> 3354</span>&#160;</div><div class="line"><a name="l03355"></a><span class="lineno"> 3355</span>&#160;  PtrAccessSet &amp;<a class="code" href="Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a> = UseDeferred ? DeferredAccesses : Accesses;</div><div class="line"><a name="l03356"></a><span class="lineno"> 3356</span>&#160;  <span class="keywordflow">for</span> (PtrAccessSet::iterator AI = S.begin(), AE = S.end(); AI != AE; ++AI) {</div><div class="line"><a name="l03357"></a><span class="lineno"> 3357</span>&#160;    <span class="keyword">const</span> MemAccessInfo &amp;Access = *AI;</div><div class="line"><a name="l03358"></a><span class="lineno"> 3358</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *Ptr = Access.getPointer();</div><div class="line"><a name="l03359"></a><span class="lineno"> 3359</span>&#160;    <span class="keywordtype">bool</span> IsWrite = Access.getInt();</div><div class="line"><a name="l03360"></a><span class="lineno"> 3360</span>&#160;</div><div class="line"><a name="l03361"></a><span class="lineno"> 3361</span>&#160;    DepCands.insert(Access);</div><div class="line"><a name="l03362"></a><span class="lineno"> 3362</span>&#160;</div><div class="line"><a name="l03363"></a><span class="lineno"> 3363</span>&#160;    <span class="comment">// Memorize read-only pointers for later processing and skip them in the</span></div><div class="line"><a name="l03364"></a><span class="lineno"> 3364</span>&#160;    <span class="comment">// first round (they need to be checked after we have seen all write</span></div><div class="line"><a name="l03365"></a><span class="lineno"> 3365</span>&#160;    <span class="comment">// pointers). Note: we also mark pointer that are not consecutive as</span></div><div class="line"><a name="l03366"></a><span class="lineno"> 3366</span>&#160;    <span class="comment">// &quot;read-only&quot; pointers (so that we check &quot;a[b[i]] +=&quot;). Hence, we need the</span></div><div class="line"><a name="l03367"></a><span class="lineno"> 3367</span>&#160;    <span class="comment">// second check for &quot;!IsWrite&quot;.</span></div><div class="line"><a name="l03368"></a><span class="lineno"> 3368</span>&#160;    <span class="keywordtype">bool</span> IsReadOnlyPtr = ReadOnlyPtr.count(Ptr) &amp;&amp; !IsWrite;</div><div class="line"><a name="l03369"></a><span class="lineno"> 3369</span>&#160;    <span class="keywordflow">if</span> (!UseDeferred &amp;&amp; IsReadOnlyPtr) {</div><div class="line"><a name="l03370"></a><span class="lineno"> 3370</span>&#160;      DeferredAccesses.insert(Access);</div><div class="line"><a name="l03371"></a><span class="lineno"> 3371</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l03372"></a><span class="lineno"> 3372</span>&#160;    }</div><div class="line"><a name="l03373"></a><span class="lineno"> 3373</span>&#160;</div><div class="line"><a name="l03374"></a><span class="lineno"> 3374</span>&#160;    <span class="keywordtype">bool</span> NeedDepCheck = <span class="keyword">false</span>;</div><div class="line"><a name="l03375"></a><span class="lineno"> 3375</span>&#160;    <span class="comment">// Check whether there is the possiblity of dependency because of underlying</span></div><div class="line"><a name="l03376"></a><span class="lineno"> 3376</span>&#160;    <span class="comment">// objects being the same.</span></div><div class="line"><a name="l03377"></a><span class="lineno"> 3377</span>&#160;    <span class="keyword">typedef</span> <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Value*, 16&gt;</a> ValueVector;</div><div class="line"><a name="l03378"></a><span class="lineno"> 3378</span>&#160;    ValueVector TempObjects;</div><div class="line"><a name="l03379"></a><span class="lineno"> 3379</span>&#160;    <a class="code" href="namespacellvm.html#ae7484b83e7c2b58ffd67422a919aba40">GetUnderlyingObjects</a>(Ptr, TempObjects, DL);</div><div class="line"><a name="l03380"></a><span class="lineno"> 3380</span>&#160;    <span class="keywordflow">for</span> (ValueVector::iterator UI = TempObjects.begin(), UE = TempObjects.end();</div><div class="line"><a name="l03381"></a><span class="lineno"> 3381</span>&#160;         UI != UE; ++UI) {</div><div class="line"><a name="l03382"></a><span class="lineno"> 3382</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *UnderlyingObj = *UI;</div><div class="line"><a name="l03383"></a><span class="lineno"> 3383</span>&#160;</div><div class="line"><a name="l03384"></a><span class="lineno"> 3384</span>&#160;      <span class="comment">// If this is a write then it needs to be an identified object.  If this a</span></div><div class="line"><a name="l03385"></a><span class="lineno"> 3385</span>&#160;      <span class="comment">// read and all writes (so far) are identified function scope objects we</span></div><div class="line"><a name="l03386"></a><span class="lineno"> 3386</span>&#160;      <span class="comment">// don&#39;t need an identified underlying object but only an Argument (the</span></div><div class="line"><a name="l03387"></a><span class="lineno"> 3387</span>&#160;      <span class="comment">// next write is going to invalidate this assumption if it is</span></div><div class="line"><a name="l03388"></a><span class="lineno"> 3388</span>&#160;      <span class="comment">// unidentified).</span></div><div class="line"><a name="l03389"></a><span class="lineno"> 3389</span>&#160;      <span class="comment">// This is a micro-optimization for the case where all writes are</span></div><div class="line"><a name="l03390"></a><span class="lineno"> 3390</span>&#160;      <span class="comment">// identified and we have one argument pointer.</span></div><div class="line"><a name="l03391"></a><span class="lineno"> 3391</span>&#160;      <span class="comment">// Otherwise, we do need a runtime check.</span></div><div class="line"><a name="l03392"></a><span class="lineno"> 3392</span>&#160;      <span class="keywordflow">if</span> ((IsWrite &amp;&amp; !<a class="code" href="LoopVectorize_8cpp.html#ac0a7f10a4ddc8820c772795c63cb5c83">isFunctionScopeIdentifiedObject</a>(UnderlyingObj)) ||</div><div class="line"><a name="l03393"></a><span class="lineno"> 3393</span>&#160;          (!IsWrite &amp;&amp; (!AreAllWritesIdentified ||</div><div class="line"><a name="l03394"></a><span class="lineno"> 3394</span>&#160;                        !isa&lt;Argument&gt;(UnderlyingObj)) &amp;&amp;</div><div class="line"><a name="l03395"></a><span class="lineno"> 3395</span>&#160;           !<a class="code" href="namespacellvm.html#aed2c5dd2a303159f87771db83f54352b">isIdentifiedObject</a>(UnderlyingObj))) {</div><div class="line"><a name="l03396"></a><span class="lineno"> 3396</span>&#160;        <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;LV: Found an unidentified &quot;</span> &lt;&lt;</div><div class="line"><a name="l03397"></a><span class="lineno"> 3397</span>&#160;              (IsWrite ?  <span class="stringliteral">&quot;write&quot;</span> : <span class="stringliteral">&quot;read&quot;</span> ) &lt;&lt; <span class="stringliteral">&quot; ptr: &quot;</span> &lt;&lt; *UnderlyingObj &lt;&lt;</div><div class="line"><a name="l03398"></a><span class="lineno"> 3398</span>&#160;              <span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line"><a name="l03399"></a><span class="lineno"> 3399</span>&#160;        IsRTCheckNeeded = (IsRTCheckNeeded ||</div><div class="line"><a name="l03400"></a><span class="lineno"> 3400</span>&#160;                           !<a class="code" href="namespacellvm.html#aed2c5dd2a303159f87771db83f54352b">isIdentifiedObject</a>(UnderlyingObj) ||</div><div class="line"><a name="l03401"></a><span class="lineno"> 3401</span>&#160;                           !AreAllReadsIdentified);</div><div class="line"><a name="l03402"></a><span class="lineno"> 3402</span>&#160;</div><div class="line"><a name="l03403"></a><span class="lineno"> 3403</span>&#160;        <span class="keywordflow">if</span> (IsWrite)</div><div class="line"><a name="l03404"></a><span class="lineno"> 3404</span>&#160;          AreAllWritesIdentified = <span class="keyword">false</span>;</div><div class="line"><a name="l03405"></a><span class="lineno"> 3405</span>&#160;        <span class="keywordflow">if</span> (!IsWrite)</div><div class="line"><a name="l03406"></a><span class="lineno"> 3406</span>&#160;          AreAllReadsIdentified = <span class="keyword">false</span>;</div><div class="line"><a name="l03407"></a><span class="lineno"> 3407</span>&#160;      }</div><div class="line"><a name="l03408"></a><span class="lineno"> 3408</span>&#160;</div><div class="line"><a name="l03409"></a><span class="lineno"> 3409</span>&#160;      <span class="comment">// If this is a write - check other reads and writes for conflicts.  If</span></div><div class="line"><a name="l03410"></a><span class="lineno"> 3410</span>&#160;      <span class="comment">// this is a read only check other writes for conflicts (but only if there</span></div><div class="line"><a name="l03411"></a><span class="lineno"> 3411</span>&#160;      <span class="comment">// is no other write to the ptr - this is an optimization to catch &quot;a[i] =</span></div><div class="line"><a name="l03412"></a><span class="lineno"> 3412</span>&#160;      <span class="comment">// a[i] + &quot; without having to do a dependence check).</span></div><div class="line"><a name="l03413"></a><span class="lineno"> 3413</span>&#160;      <span class="keywordflow">if</span> ((IsWrite || IsReadOnlyPtr) &amp;&amp; WriteObjects.count(UnderlyingObj))</div><div class="line"><a name="l03414"></a><span class="lineno"> 3414</span>&#160;        NeedDepCheck = <span class="keyword">true</span>;</div><div class="line"><a name="l03415"></a><span class="lineno"> 3415</span>&#160;</div><div class="line"><a name="l03416"></a><span class="lineno"> 3416</span>&#160;      <span class="keywordflow">if</span> (IsWrite)</div><div class="line"><a name="l03417"></a><span class="lineno"> 3417</span>&#160;        WriteObjects.insert(UnderlyingObj);</div><div class="line"><a name="l03418"></a><span class="lineno"> 3418</span>&#160;</div><div class="line"><a name="l03419"></a><span class="lineno"> 3419</span>&#160;      <span class="comment">// Create sets of pointers connected by shared underlying objects.</span></div><div class="line"><a name="l03420"></a><span class="lineno"> 3420</span>&#160;      UnderlyingObjToAccessMap::iterator Prev =</div><div class="line"><a name="l03421"></a><span class="lineno"> 3421</span>&#160;        ObjToLastAccess.find(UnderlyingObj);</div><div class="line"><a name="l03422"></a><span class="lineno"> 3422</span>&#160;      <span class="keywordflow">if</span> (Prev != ObjToLastAccess.end())</div><div class="line"><a name="l03423"></a><span class="lineno"> 3423</span>&#160;        DepCands.unionSets(Access, Prev-&gt;second);</div><div class="line"><a name="l03424"></a><span class="lineno"> 3424</span>&#160;</div><div class="line"><a name="l03425"></a><span class="lineno"> 3425</span>&#160;      ObjToLastAccess[UnderlyingObj] = Access;</div><div class="line"><a name="l03426"></a><span class="lineno"> 3426</span>&#160;    }</div><div class="line"><a name="l03427"></a><span class="lineno"> 3427</span>&#160;</div><div class="line"><a name="l03428"></a><span class="lineno"> 3428</span>&#160;    <span class="keywordflow">if</span> (NeedDepCheck)</div><div class="line"><a name="l03429"></a><span class="lineno"> 3429</span>&#160;      CheckDeps.insert(Access);</div><div class="line"><a name="l03430"></a><span class="lineno"> 3430</span>&#160;  }</div><div class="line"><a name="l03431"></a><span class="lineno"> 3431</span>&#160;}</div><div class="line"><a name="l03432"></a><span class="lineno"> 3432</span>&#160;</div><div class="line"><a name="l03433"></a><span class="lineno"> 3433</span>&#160;<span class="keyword">namespace </span>{<span class="comment"></span></div><div class="line"><a name="l03434"></a><span class="lineno"> 3434</span>&#160;<span class="comment">/// \brief Checks memory dependences among accesses to the same underlying</span></div><div class="line"><a name="l03435"></a><span class="lineno"> 3435</span>&#160;<span class="comment">/// object to determine whether there vectorization is legal or not (and at</span></div><div class="line"><a name="l03436"></a><span class="lineno"> 3436</span>&#160;<span class="comment">/// which vectorization factor).</span></div><div class="line"><a name="l03437"></a><span class="lineno"> 3437</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l03438"></a><span class="lineno"> 3438</span>&#160;<span class="comment">/// This class works under the assumption that we already checked that memory</span></div><div class="line"><a name="l03439"></a><span class="lineno"> 3439</span>&#160;<span class="comment">/// locations with different underlying pointers are &quot;must-not alias&quot;.</span></div><div class="line"><a name="l03440"></a><span class="lineno"> 3440</span>&#160;<span class="comment">/// We use the ScalarEvolution framework to symbolically evalutate access</span></div><div class="line"><a name="l03441"></a><span class="lineno"> 3441</span>&#160;<span class="comment">/// functions pairs. Since we currently don&#39;t restructure the loop we can rely</span></div><div class="line"><a name="l03442"></a><span class="lineno"> 3442</span>&#160;<span class="comment">/// on the program order of memory accesses to determine their safety.</span></div><div class="line"><a name="l03443"></a><span class="lineno"> 3443</span>&#160;<span class="comment">/// At the moment we will only deem accesses as safe for:</span></div><div class="line"><a name="l03444"></a><span class="lineno"> 3444</span>&#160;<span class="comment">///  * A negative constant distance assuming program order.</span></div><div class="line"><a name="l03445"></a><span class="lineno"> 3445</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l03446"></a><span class="lineno"> 3446</span>&#160;<span class="comment">///      Safe: tmp = a[i + 1];     OR     a[i + 1] = x;</span></div><div class="line"><a name="l03447"></a><span class="lineno"> 3447</span>&#160;<span class="comment">///            a[i] = tmp;                y = a[i];</span></div><div class="line"><a name="l03448"></a><span class="lineno"> 3448</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l03449"></a><span class="lineno"> 3449</span>&#160;<span class="comment">///   The latter case is safe because later checks guarantuee that there can&#39;t</span></div><div class="line"><a name="l03450"></a><span class="lineno"> 3450</span>&#160;<span class="comment">///   be a cycle through a phi node (that is, we check that &quot;x&quot; and &quot;y&quot; is not</span></div><div class="line"><a name="l03451"></a><span class="lineno"> 3451</span>&#160;<span class="comment">///   the same variable: a header phi can only be an induction or a reduction, a</span></div><div class="line"><a name="l03452"></a><span class="lineno"> 3452</span>&#160;<span class="comment">///   reduction can&#39;t have a memory sink, an induction can&#39;t have a memory</span></div><div class="line"><a name="l03453"></a><span class="lineno"> 3453</span>&#160;<span class="comment">///   source). This is important and must not be violated (or we have to</span></div><div class="line"><a name="l03454"></a><span class="lineno"> 3454</span>&#160;<span class="comment">///   resort to checking for cycles through memory).</span></div><div class="line"><a name="l03455"></a><span class="lineno"> 3455</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l03456"></a><span class="lineno"> 3456</span>&#160;<span class="comment">///  * A positive constant distance assuming program order that is bigger</span></div><div class="line"><a name="l03457"></a><span class="lineno"> 3457</span>&#160;<span class="comment">///    than the biggest memory access.</span></div><div class="line"><a name="l03458"></a><span class="lineno"> 3458</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l03459"></a><span class="lineno"> 3459</span>&#160;<span class="comment">///     tmp = a[i]        OR              b[i] = x</span></div><div class="line"><a name="l03460"></a><span class="lineno"> 3460</span>&#160;<span class="comment">///     a[i+2] = tmp                      y = b[i+2];</span></div><div class="line"><a name="l03461"></a><span class="lineno"> 3461</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l03462"></a><span class="lineno"> 3462</span>&#160;<span class="comment">///     Safe distance: 2 x sizeof(a[0]), and 2 x sizeof(b[0]), respectively.</span></div><div class="line"><a name="l03463"></a><span class="lineno"> 3463</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l03464"></a><span class="lineno"> 3464</span>&#160;<span class="comment">///  * Zero distances and all accesses have the same size.</span></div><div class="line"><a name="l03465"></a><span class="lineno"> 3465</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l03466"></a><span class="lineno"> 3466</span>&#160;<span class="comment"></span><span class="keyword">class </span>MemoryDepChecker {</div><div class="line"><a name="l03467"></a><span class="lineno"> 3467</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l03468"></a><span class="lineno"> 3468</span>&#160;  <span class="keyword">typedef</span> <a class="code" href="classllvm_1_1PointerIntPair.html">PointerIntPair&lt;Value *, 1, bool&gt;</a> MemAccessInfo;</div><div class="line"><a name="l03469"></a><span class="lineno"> 3469</span>&#160;  <span class="keyword">typedef</span> <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;MemAccessInfo, 8&gt;</a> MemAccessInfoSet;</div><div class="line"><a name="l03470"></a><span class="lineno"> 3470</span>&#160;</div><div class="line"><a name="l03471"></a><span class="lineno"> 3471</span>&#160;  MemoryDepChecker(<a class="code" href="classllvm_1_1ScalarEvolution.html">ScalarEvolution</a> *Se, <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> *Dl, <span class="keyword">const</span> <a class="code" href="classllvm_1_1Loop.html">Loop</a> *L)</div><div class="line"><a name="l03472"></a><span class="lineno"> 3472</span>&#160;      : SE(Se), DL(Dl), InnermostLoop(L), AccessIdx(0),</div><div class="line"><a name="l03473"></a><span class="lineno"> 3473</span>&#160;        ShouldRetryWithRuntimeCheck(<span class="keyword">false</span>) {}</div><div class="line"><a name="l03474"></a><span class="lineno"> 3474</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03475"></a><span class="lineno"> 3475</span>&#160;<span class="comment">  /// \brief Register the location (instructions are given increasing numbers)</span></div><div class="line"><a name="l03476"></a><span class="lineno"> 3476</span>&#160;<span class="comment">  /// of a write access.</span></div><div class="line"><a name="l03477"></a><span class="lineno"> 3477</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> addAccess(<a class="code" href="classllvm_1_1StoreInst.html">StoreInst</a> *SI) {</div><div class="line"><a name="l03478"></a><span class="lineno"> 3478</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *Ptr = SI-&gt;<a class="code" href="classllvm_1_1StoreInst.html#ac03c1c093059ea000216af8dd6f2dbf4">getPointerOperand</a>();</div><div class="line"><a name="l03479"></a><span class="lineno"> 3479</span>&#160;    Accesses[MemAccessInfo(Ptr, <span class="keyword">true</span>)].push_back(AccessIdx);</div><div class="line"><a name="l03480"></a><span class="lineno"> 3480</span>&#160;    InstMap.push_back(SI);</div><div class="line"><a name="l03481"></a><span class="lineno"> 3481</span>&#160;    ++AccessIdx;</div><div class="line"><a name="l03482"></a><span class="lineno"> 3482</span>&#160;  }</div><div class="line"><a name="l03483"></a><span class="lineno"> 3483</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03484"></a><span class="lineno"> 3484</span>&#160;<span class="comment">  /// \brief Register the location (instructions are given increasing numbers)</span></div><div class="line"><a name="l03485"></a><span class="lineno"> 3485</span>&#160;<span class="comment">  /// of a write access.</span></div><div class="line"><a name="l03486"></a><span class="lineno"> 3486</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> addAccess(<a class="code" href="classllvm_1_1LoadInst.html">LoadInst</a> *LI) {</div><div class="line"><a name="l03487"></a><span class="lineno"> 3487</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *Ptr = LI-&gt;<a class="code" href="classllvm_1_1LoadInst.html#ad47eefa1d094f60494b6b927061ca001">getPointerOperand</a>();</div><div class="line"><a name="l03488"></a><span class="lineno"> 3488</span>&#160;    Accesses[MemAccessInfo(Ptr, <span class="keyword">false</span>)].push_back(AccessIdx);</div><div class="line"><a name="l03489"></a><span class="lineno"> 3489</span>&#160;    InstMap.push_back(LI);</div><div class="line"><a name="l03490"></a><span class="lineno"> 3490</span>&#160;    ++AccessIdx;</div><div class="line"><a name="l03491"></a><span class="lineno"> 3491</span>&#160;  }</div><div class="line"><a name="l03492"></a><span class="lineno"> 3492</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03493"></a><span class="lineno"> 3493</span>&#160;<span class="comment">  /// \brief Check whether the dependencies between the accesses are safe.</span></div><div class="line"><a name="l03494"></a><span class="lineno"> 3494</span>&#160;<span class="comment">  ///</span></div><div class="line"><a name="l03495"></a><span class="lineno"> 3495</span>&#160;<span class="comment">  /// Only checks sets with elements in \p CheckDeps.</span></div><div class="line"><a name="l03496"></a><span class="lineno"> 3496</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> areDepsSafe(<a class="code" href="classllvm_1_1EquivalenceClasses.html">AccessAnalysis::DepCandidates</a> &amp;AccessSets,</div><div class="line"><a name="l03497"></a><span class="lineno"> 3497</span>&#160;                   MemAccessInfoSet &amp;CheckDeps);</div><div class="line"><a name="l03498"></a><span class="lineno"> 3498</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03499"></a><span class="lineno"> 3499</span>&#160;<span class="comment">  /// \brief The maximum number of bytes of a vector register we can vectorize</span></div><div class="line"><a name="l03500"></a><span class="lineno"> 3500</span>&#160;<span class="comment">  /// the accesses safely with.</span></div><div class="line"><a name="l03501"></a><span class="lineno"> 3501</span>&#160;<span class="comment"></span>  <span class="keywordtype">unsigned</span> getMaxSafeDepDistBytes() { <span class="keywordflow">return</span> MaxSafeDepDistBytes; }</div><div class="line"><a name="l03502"></a><span class="lineno"> 3502</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03503"></a><span class="lineno"> 3503</span>&#160;<span class="comment">  /// \brief In same cases when the dependency check fails we can still</span></div><div class="line"><a name="l03504"></a><span class="lineno"> 3504</span>&#160;<span class="comment">  /// vectorize the loop with a dynamic array access check.</span></div><div class="line"><a name="l03505"></a><span class="lineno"> 3505</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> shouldRetryWithRuntimeCheck() { <span class="keywordflow">return</span> ShouldRetryWithRuntimeCheck; }</div><div class="line"><a name="l03506"></a><span class="lineno"> 3506</span>&#160;</div><div class="line"><a name="l03507"></a><span class="lineno"> 3507</span>&#160;<span class="keyword">private</span>:</div><div class="line"><a name="l03508"></a><span class="lineno"> 3508</span>&#160;  <a class="code" href="classllvm_1_1ScalarEvolution.html">ScalarEvolution</a> *SE;</div><div class="line"><a name="l03509"></a><span class="lineno"> 3509</span>&#160;  <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> *DL;</div><div class="line"><a name="l03510"></a><span class="lineno"> 3510</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1Loop.html">Loop</a> *InnermostLoop;</div><div class="line"><a name="l03511"></a><span class="lineno"> 3511</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03512"></a><span class="lineno"> 3512</span>&#160;<span class="comment">  /// \brief Maps access locations (ptr, read/write) to program order.</span></div><div class="line"><a name="l03513"></a><span class="lineno"> 3513</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;MemAccessInfo, std::vector&lt;unsigned&gt;</a> &gt; Accesses;</div><div class="line"><a name="l03514"></a><span class="lineno"> 3514</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03515"></a><span class="lineno"> 3515</span>&#160;<span class="comment">  /// \brief Memory access instructions in program order.</span></div><div class="line"><a name="l03516"></a><span class="lineno"> 3516</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Instruction *, 16&gt;</a> InstMap;</div><div class="line"><a name="l03517"></a><span class="lineno"> 3517</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03518"></a><span class="lineno"> 3518</span>&#160;<span class="comment">  /// \brief The program order index to be used for the next instruction.</span></div><div class="line"><a name="l03519"></a><span class="lineno"> 3519</span>&#160;<span class="comment"></span>  <span class="keywordtype">unsigned</span> AccessIdx;</div><div class="line"><a name="l03520"></a><span class="lineno"> 3520</span>&#160;</div><div class="line"><a name="l03521"></a><span class="lineno"> 3521</span>&#160;  <span class="comment">// We can access this many bytes in parallel safely.</span></div><div class="line"><a name="l03522"></a><span class="lineno"> 3522</span>&#160;  <span class="keywordtype">unsigned</span> MaxSafeDepDistBytes;</div><div class="line"><a name="l03523"></a><span class="lineno"> 3523</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03524"></a><span class="lineno"> 3524</span>&#160;<span class="comment">  /// \brief If we see a non constant dependence distance we can still try to</span></div><div class="line"><a name="l03525"></a><span class="lineno"> 3525</span>&#160;<span class="comment">  /// vectorize this loop with runtime checks.</span></div><div class="line"><a name="l03526"></a><span class="lineno"> 3526</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> ShouldRetryWithRuntimeCheck;</div><div class="line"><a name="l03527"></a><span class="lineno"> 3527</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03528"></a><span class="lineno"> 3528</span>&#160;<span class="comment">  /// \brief Check whether there is a plausible dependence between the two</span></div><div class="line"><a name="l03529"></a><span class="lineno"> 3529</span>&#160;<span class="comment">  /// accesses.</span></div><div class="line"><a name="l03530"></a><span class="lineno"> 3530</span>&#160;<span class="comment">  ///</span></div><div class="line"><a name="l03531"></a><span class="lineno"> 3531</span>&#160;<span class="comment">  /// Access \p A must happen before \p B in program order. The two indices</span></div><div class="line"><a name="l03532"></a><span class="lineno"> 3532</span>&#160;<span class="comment">  /// identify the index into the program order map.</span></div><div class="line"><a name="l03533"></a><span class="lineno"> 3533</span>&#160;<span class="comment">  ///</span></div><div class="line"><a name="l03534"></a><span class="lineno"> 3534</span>&#160;<span class="comment">  /// This function checks  whether there is a plausible dependence (or the</span></div><div class="line"><a name="l03535"></a><span class="lineno"> 3535</span>&#160;<span class="comment">  /// absence of such can&#39;t be proved) between the two accesses. If there is a</span></div><div class="line"><a name="l03536"></a><span class="lineno"> 3536</span>&#160;<span class="comment">  /// plausible dependence but the dependence distance is bigger than one</span></div><div class="line"><a name="l03537"></a><span class="lineno"> 3537</span>&#160;<span class="comment">  /// element access it records this distance in \p MaxSafeDepDistBytes (if this</span></div><div class="line"><a name="l03538"></a><span class="lineno"> 3538</span>&#160;<span class="comment">  /// distance is smaller than any other distance encountered so far).</span></div><div class="line"><a name="l03539"></a><span class="lineno"> 3539</span>&#160;<span class="comment">  /// Otherwise, this function returns true signaling a possible dependence.</span></div><div class="line"><a name="l03540"></a><span class="lineno"> 3540</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> isDependent(<span class="keyword">const</span> MemAccessInfo &amp;<a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>, <span class="keywordtype">unsigned</span> AIdx,</div><div class="line"><a name="l03541"></a><span class="lineno"> 3541</span>&#160;                   <span class="keyword">const</span> MemAccessInfo &amp;<a class="code" href="Target_2ARM_2README_8txt.html#a90cca76dd78688687e0d697679dbc799">B</a>, <span class="keywordtype">unsigned</span> BIdx);</div><div class="line"><a name="l03542"></a><span class="lineno"> 3542</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03543"></a><span class="lineno"> 3543</span>&#160;<span class="comment">  /// \brief Check whether the data dependence could prevent store-load</span></div><div class="line"><a name="l03544"></a><span class="lineno"> 3544</span>&#160;<span class="comment">  /// forwarding.</span></div><div class="line"><a name="l03545"></a><span class="lineno"> 3545</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> couldPreventStoreLoadForward(<span class="keywordtype">unsigned</span> Distance, <span class="keywordtype">unsigned</span> TypeByteSize);</div><div class="line"><a name="l03546"></a><span class="lineno"> 3546</span>&#160;};</div><div class="line"><a name="l03547"></a><span class="lineno"> 3547</span>&#160;</div><div class="line"><a name="l03548"></a><span class="lineno"> 3548</span>&#160;} <span class="comment">// end anonymous namespace</span></div><div class="line"><a name="l03549"></a><span class="lineno"> 3549</span>&#160;</div><div class="line"><a name="l03550"></a><span class="lineno"><a class="line" href="LoopVectorize_8cpp.html#abe6d015febd4845fa107ab9c87c031c0"> 3550</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="LoopVectorize_8cpp.html#abe6d015febd4845fa107ab9c87c031c0">isInBoundsGep</a>(<a class="code" href="classllvm_1_1Value.html">Value</a> *Ptr) {</div><div class="line"><a name="l03551"></a><span class="lineno"> 3551</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1GetElementPtrInst.html">GetElementPtrInst</a> *GEP = dyn_cast&lt;GetElementPtrInst&gt;(Ptr))</div><div class="line"><a name="l03552"></a><span class="lineno"> 3552</span>&#160;    <span class="keywordflow">return</span> GEP-&gt;isInBounds();</div><div class="line"><a name="l03553"></a><span class="lineno"> 3553</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l03554"></a><span class="lineno"> 3554</span>&#160;}</div><div class="line"><a name="l03555"></a><span class="lineno"> 3555</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03556"></a><span class="lineno"> 3556</span>&#160;<span class="comment">/// \brief Check whether the access through \p Ptr has a constant stride.</span></div><div class="line"><a name="l03557"></a><span class="lineno"><a class="line" href="LoopVectorize_8cpp.html#ae0635a013d9930362a412c26d0978739"> 3557</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="LoopVectorize_8cpp.html#ae0635a013d9930362a412c26d0978739">isStridedPtr</a>(<a class="code" href="classllvm_1_1ScalarEvolution.html">ScalarEvolution</a> *SE, <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> *DL, <a class="code" href="classllvm_1_1Value.html">Value</a> *Ptr,</div><div class="line"><a name="l03558"></a><span class="lineno"> 3558</span>&#160;                        <span class="keyword">const</span> <a class="code" href="classllvm_1_1Loop.html">Loop</a> *Lp) {</div><div class="line"><a name="l03559"></a><span class="lineno"> 3559</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1Type.html">Type</a> *Ty = Ptr-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>();</div><div class="line"><a name="l03560"></a><span class="lineno"> 3560</span>&#160;  assert(Ty-&gt;<a class="code" href="classllvm_1_1Type.html#a2eba483f5cc876e824aa6c085736086b">isPointerTy</a>() &amp;&amp; <span class="stringliteral">&quot;Unexpected non ptr&quot;</span>);</div><div class="line"><a name="l03561"></a><span class="lineno"> 3561</span>&#160;</div><div class="line"><a name="l03562"></a><span class="lineno"> 3562</span>&#160;  <span class="comment">// Make sure that the pointer does not point to aggregate types.</span></div><div class="line"><a name="l03563"></a><span class="lineno"> 3563</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1PointerType.html">PointerType</a> *PtrTy = cast&lt;PointerType&gt;(Ty);</div><div class="line"><a name="l03564"></a><span class="lineno"> 3564</span>&#160;  <span class="keywordflow">if</span> (PtrTy-&gt;getElementType()-&gt;isAggregateType()) {</div><div class="line"><a name="l03565"></a><span class="lineno"> 3565</span>&#160;    <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;LV: Bad stride - Not a pointer to a scalar type&quot;</span> &lt;&lt; *Ptr &lt;&lt;</div><div class="line"><a name="l03566"></a><span class="lineno"> 3566</span>&#160;          <span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line"><a name="l03567"></a><span class="lineno"> 3567</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l03568"></a><span class="lineno"> 3568</span>&#160;  }</div><div class="line"><a name="l03569"></a><span class="lineno"> 3569</span>&#160;</div><div class="line"><a name="l03570"></a><span class="lineno"> 3570</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *PtrScev = SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a30bd18ac905eacf3601bc6a553a9ff49">getSCEV</a>(Ptr);</div><div class="line"><a name="l03571"></a><span class="lineno"> 3571</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEVAddRecExpr.html">SCEVAddRecExpr</a> *AR = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1SCEVAddRecExpr.html">SCEVAddRecExpr</a>&gt;(PtrScev);</div><div class="line"><a name="l03572"></a><span class="lineno"> 3572</span>&#160;  <span class="keywordflow">if</span> (!AR) {</div><div class="line"><a name="l03573"></a><span class="lineno"> 3573</span>&#160;    <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;LV: Bad stride - Not an AddRecExpr pointer &quot;</span></div><div class="line"><a name="l03574"></a><span class="lineno"> 3574</span>&#160;          &lt;&lt; *Ptr &lt;&lt; <span class="stringliteral">&quot; SCEV: &quot;</span> &lt;&lt; *PtrScev &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line"><a name="l03575"></a><span class="lineno"> 3575</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l03576"></a><span class="lineno"> 3576</span>&#160;  }</div><div class="line"><a name="l03577"></a><span class="lineno"> 3577</span>&#160;</div><div class="line"><a name="l03578"></a><span class="lineno"> 3578</span>&#160;  <span class="comment">// The accesss function must stride over the innermost loop.</span></div><div class="line"><a name="l03579"></a><span class="lineno"> 3579</span>&#160;  <span class="keywordflow">if</span> (Lp != AR-&gt;<a class="code" href="classllvm_1_1SCEVAddRecExpr.html#a7fcbbc51eef313e675a2442bb2053ae9">getLoop</a>()) {</div><div class="line"><a name="l03580"></a><span class="lineno"> 3580</span>&#160;    <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;LV: Bad stride - Not striding over innermost loop &quot;</span> &lt;&lt;</div><div class="line"><a name="l03581"></a><span class="lineno"> 3581</span>&#160;          *Ptr &lt;&lt; <span class="stringliteral">&quot; SCEV: &quot;</span> &lt;&lt; *PtrScev &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line"><a name="l03582"></a><span class="lineno"> 3582</span>&#160;  }</div><div class="line"><a name="l03583"></a><span class="lineno"> 3583</span>&#160;</div><div class="line"><a name="l03584"></a><span class="lineno"> 3584</span>&#160;  <span class="comment">// The address calculation must not wrap. Otherwise, a dependence could be</span></div><div class="line"><a name="l03585"></a><span class="lineno"> 3585</span>&#160;  <span class="comment">// inverted.</span></div><div class="line"><a name="l03586"></a><span class="lineno"> 3586</span>&#160;  <span class="comment">// An inbounds getelementptr that is a AddRec with a unit stride</span></div><div class="line"><a name="l03587"></a><span class="lineno"> 3587</span>&#160;  <span class="comment">// cannot wrap per definition. The unit stride requirement is checked later.</span></div><div class="line"><a name="l03588"></a><span class="lineno"> 3588</span>&#160;  <span class="comment">// An getelementptr without an inbounds attribute and unit stride would have</span></div><div class="line"><a name="l03589"></a><span class="lineno"> 3589</span>&#160;  <span class="comment">// to access the pointer value &quot;0&quot; which is undefined behavior in address</span></div><div class="line"><a name="l03590"></a><span class="lineno"> 3590</span>&#160;  <span class="comment">// space 0, therefore we can also vectorize this case.</span></div><div class="line"><a name="l03591"></a><span class="lineno"> 3591</span>&#160;  <span class="keywordtype">bool</span> IsInBoundsGEP = <a class="code" href="LoopVectorize_8cpp.html#abe6d015febd4845fa107ab9c87c031c0">isInBoundsGep</a>(Ptr);</div><div class="line"><a name="l03592"></a><span class="lineno"> 3592</span>&#160;  <span class="keywordtype">bool</span> IsNoWrapAddRec = AR-&gt;<a class="code" href="classllvm_1_1SCEVNAryExpr.html#aaca141c03630036930698325f423cb49">getNoWrapFlags</a>(<a class="code" href="classllvm_1_1SCEV.html#af43000d4dcb7d6d63cb6e36933ed3f6fae022582ed4b56bdb108b4488809e11e6">SCEV::NoWrapMask</a>);</div><div class="line"><a name="l03593"></a><span class="lineno"> 3593</span>&#160;  <span class="keywordtype">bool</span> IsInAddressSpaceZero = PtrTy-&gt;getAddressSpace() == 0;</div><div class="line"><a name="l03594"></a><span class="lineno"> 3594</span>&#160;  <span class="keywordflow">if</span> (!IsNoWrapAddRec &amp;&amp; !IsInBoundsGEP &amp;&amp; !IsInAddressSpaceZero) {</div><div class="line"><a name="l03595"></a><span class="lineno"> 3595</span>&#160;    <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;LV: Bad stride - Pointer may wrap in the address space &quot;</span></div><div class="line"><a name="l03596"></a><span class="lineno"> 3596</span>&#160;          &lt;&lt; *Ptr &lt;&lt; <span class="stringliteral">&quot; SCEV: &quot;</span> &lt;&lt; *PtrScev &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line"><a name="l03597"></a><span class="lineno"> 3597</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l03598"></a><span class="lineno"> 3598</span>&#160;  }</div><div class="line"><a name="l03599"></a><span class="lineno"> 3599</span>&#160;</div><div class="line"><a name="l03600"></a><span class="lineno"> 3600</span>&#160;  <span class="comment">// Check the step is constant.</span></div><div class="line"><a name="l03601"></a><span class="lineno"> 3601</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *Step = AR-&gt;<a class="code" href="classllvm_1_1SCEVAddRecExpr.html#a443e9130cd9f3e3baaa1b566e6aa5060">getStepRecurrence</a>(*SE);</div><div class="line"><a name="l03602"></a><span class="lineno"> 3602</span>&#160;</div><div class="line"><a name="l03603"></a><span class="lineno"> 3603</span>&#160;  <span class="comment">// Calculate the pointer stride and check if it is consecutive.</span></div><div class="line"><a name="l03604"></a><span class="lineno"> 3604</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEVConstant.html">SCEVConstant</a> *<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1SCEVConstant.html">SCEVConstant</a>&gt;(Step);</div><div class="line"><a name="l03605"></a><span class="lineno"> 3605</span>&#160;  <span class="keywordflow">if</span> (!C) {</div><div class="line"><a name="l03606"></a><span class="lineno"> 3606</span>&#160;    <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;LV: Bad stride - Not a constant strided &quot;</span> &lt;&lt; *Ptr &lt;&lt;</div><div class="line"><a name="l03607"></a><span class="lineno"> 3607</span>&#160;          <span class="stringliteral">&quot; SCEV: &quot;</span> &lt;&lt; *PtrScev &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line"><a name="l03608"></a><span class="lineno"> 3608</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l03609"></a><span class="lineno"> 3609</span>&#160;  }</div><div class="line"><a name="l03610"></a><span class="lineno"> 3610</span>&#160;</div><div class="line"><a name="l03611"></a><span class="lineno"> 3611</span>&#160;  int64_t Size = DL-&gt;<a class="code" href="classllvm_1_1DataLayout.html#a1d6fcc02e91ba24510aba42660c90e29">getTypeAllocSize</a>(PtrTy-&gt;getElementType());</div><div class="line"><a name="l03612"></a><span class="lineno"> 3612</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1APInt.html">APInt</a> &amp;APStepVal = C-&gt;<a class="code" href="classllvm_1_1SCEVConstant.html#a64f0133adf37f9513005465580a19a66">getValue</a>()-&gt;<a class="code" href="classllvm_1_1ConstantInt.html#af8dde13a97efce293a7b04daf1e208fb">getValue</a>();</div><div class="line"><a name="l03613"></a><span class="lineno"> 3613</span>&#160;</div><div class="line"><a name="l03614"></a><span class="lineno"> 3614</span>&#160;  <span class="comment">// Huge step value - give up.</span></div><div class="line"><a name="l03615"></a><span class="lineno"> 3615</span>&#160;  <span class="keywordflow">if</span> (APStepVal.<a class="code" href="classllvm_1_1APInt.html#ad081689e23a8f5dea78dedd623d6a8f8">getBitWidth</a>() &gt; 64)</div><div class="line"><a name="l03616"></a><span class="lineno"> 3616</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l03617"></a><span class="lineno"> 3617</span>&#160;</div><div class="line"><a name="l03618"></a><span class="lineno"> 3618</span>&#160;  int64_t StepVal = APStepVal.<a class="code" href="classllvm_1_1APInt.html#a7189a37206963029447c31d57771b997">getSExtValue</a>();</div><div class="line"><a name="l03619"></a><span class="lineno"> 3619</span>&#160;</div><div class="line"><a name="l03620"></a><span class="lineno"> 3620</span>&#160;  <span class="comment">// Strided access.</span></div><div class="line"><a name="l03621"></a><span class="lineno"> 3621</span>&#160;  int64_t Stride = StepVal / Size;</div><div class="line"><a name="l03622"></a><span class="lineno"> 3622</span>&#160;  int64_t Rem = StepVal % Size;</div><div class="line"><a name="l03623"></a><span class="lineno"> 3623</span>&#160;  <span class="keywordflow">if</span> (Rem)</div><div class="line"><a name="l03624"></a><span class="lineno"> 3624</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l03625"></a><span class="lineno"> 3625</span>&#160;</div><div class="line"><a name="l03626"></a><span class="lineno"> 3626</span>&#160;  <span class="comment">// If the SCEV could wrap but we have an inbounds gep with a unit stride we</span></div><div class="line"><a name="l03627"></a><span class="lineno"> 3627</span>&#160;  <span class="comment">// know we can&#39;t &quot;wrap around the address space&quot;. In case of address space</span></div><div class="line"><a name="l03628"></a><span class="lineno"> 3628</span>&#160;  <span class="comment">// zero we know that this won&#39;t happen without triggering undefined behavior.</span></div><div class="line"><a name="l03629"></a><span class="lineno"> 3629</span>&#160;  <span class="keywordflow">if</span> (!IsNoWrapAddRec &amp;&amp; (IsInBoundsGEP || IsInAddressSpaceZero) &amp;&amp;</div><div class="line"><a name="l03630"></a><span class="lineno"> 3630</span>&#160;      Stride != 1 &amp;&amp; Stride != -1)</div><div class="line"><a name="l03631"></a><span class="lineno"> 3631</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l03632"></a><span class="lineno"> 3632</span>&#160;</div><div class="line"><a name="l03633"></a><span class="lineno"> 3633</span>&#160;  <span class="keywordflow">return</span> Stride;</div><div class="line"><a name="l03634"></a><span class="lineno"> 3634</span>&#160;}</div><div class="line"><a name="l03635"></a><span class="lineno"> 3635</span>&#160;</div><div class="line"><a name="l03636"></a><span class="lineno"> 3636</span>&#160;<span class="keywordtype">bool</span> MemoryDepChecker::couldPreventStoreLoadForward(<span class="keywordtype">unsigned</span> Distance,</div><div class="line"><a name="l03637"></a><span class="lineno"> 3637</span>&#160;                                                    <span class="keywordtype">unsigned</span> TypeByteSize) {</div><div class="line"><a name="l03638"></a><span class="lineno"> 3638</span>&#160;  <span class="comment">// If loads occur at a distance that is not a multiple of a feasible vector</span></div><div class="line"><a name="l03639"></a><span class="lineno"> 3639</span>&#160;  <span class="comment">// factor store-load forwarding does not take place.</span></div><div class="line"><a name="l03640"></a><span class="lineno"> 3640</span>&#160;  <span class="comment">// Positive dependences might cause troubles because vectorizing them might</span></div><div class="line"><a name="l03641"></a><span class="lineno"> 3641</span>&#160;  <span class="comment">// prevent store-load forwarding making vectorized code run a lot slower.</span></div><div class="line"><a name="l03642"></a><span class="lineno"> 3642</span>&#160;  <span class="comment">//   a[i] = a[i-3] ^ a[i-8];</span></div><div class="line"><a name="l03643"></a><span class="lineno"> 3643</span>&#160;  <span class="comment">//   The stores to a[i:i+1] don&#39;t align with the stores to a[i-3:i-2] and</span></div><div class="line"><a name="l03644"></a><span class="lineno"> 3644</span>&#160;  <span class="comment">//   hence on your typical architecture store-load forwarding does not take</span></div><div class="line"><a name="l03645"></a><span class="lineno"> 3645</span>&#160;  <span class="comment">//   place. Vectorizing in such cases does not make sense.</span></div><div class="line"><a name="l03646"></a><span class="lineno"> 3646</span>&#160;  <span class="comment">// Store-load forwarding distance.</span></div><div class="line"><a name="l03647"></a><span class="lineno"> 3647</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> NumCyclesForStoreLoadThroughMemory = 8*TypeByteSize;</div><div class="line"><a name="l03648"></a><span class="lineno"> 3648</span>&#160;  <span class="comment">// Maximum vector factor.</span></div><div class="line"><a name="l03649"></a><span class="lineno"> 3649</span>&#160;  <span class="keywordtype">unsigned</span> MaxVFWithoutSLForwardIssues = MaxVectorWidth*TypeByteSize;</div><div class="line"><a name="l03650"></a><span class="lineno"> 3650</span>&#160;  <span class="keywordflow">if</span>(MaxSafeDepDistBytes &lt; MaxVFWithoutSLForwardIssues)</div><div class="line"><a name="l03651"></a><span class="lineno"> 3651</span>&#160;    MaxVFWithoutSLForwardIssues = MaxSafeDepDistBytes;</div><div class="line"><a name="l03652"></a><span class="lineno"> 3652</span>&#160;</div><div class="line"><a name="l03653"></a><span class="lineno"> 3653</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> vf = 2*TypeByteSize; vf &lt;= MaxVFWithoutSLForwardIssues;</div><div class="line"><a name="l03654"></a><span class="lineno"> 3654</span>&#160;       vf *= 2) {</div><div class="line"><a name="l03655"></a><span class="lineno"> 3655</span>&#160;    <span class="keywordflow">if</span> (Distance % vf &amp;&amp; Distance / vf &lt; NumCyclesForStoreLoadThroughMemory) {</div><div class="line"><a name="l03656"></a><span class="lineno"> 3656</span>&#160;      MaxVFWithoutSLForwardIssues = (vf &gt;&gt;=1);</div><div class="line"><a name="l03657"></a><span class="lineno"> 3657</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l03658"></a><span class="lineno"> 3658</span>&#160;    }</div><div class="line"><a name="l03659"></a><span class="lineno"> 3659</span>&#160;  }</div><div class="line"><a name="l03660"></a><span class="lineno"> 3660</span>&#160;</div><div class="line"><a name="l03661"></a><span class="lineno"> 3661</span>&#160;  <span class="keywordflow">if</span> (MaxVFWithoutSLForwardIssues&lt; 2*TypeByteSize) {</div><div class="line"><a name="l03662"></a><span class="lineno"> 3662</span>&#160;    <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;LV: Distance &quot;</span> &lt;&lt; Distance &lt;&lt;</div><div class="line"><a name="l03663"></a><span class="lineno"> 3663</span>&#160;          <span class="stringliteral">&quot; that could cause a store-load forwarding conflict\n&quot;</span>);</div><div class="line"><a name="l03664"></a><span class="lineno"> 3664</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l03665"></a><span class="lineno"> 3665</span>&#160;  }</div><div class="line"><a name="l03666"></a><span class="lineno"> 3666</span>&#160;</div><div class="line"><a name="l03667"></a><span class="lineno"> 3667</span>&#160;  <span class="keywordflow">if</span> (MaxVFWithoutSLForwardIssues &lt; MaxSafeDepDistBytes &amp;&amp;</div><div class="line"><a name="l03668"></a><span class="lineno"> 3668</span>&#160;      MaxVFWithoutSLForwardIssues != MaxVectorWidth*TypeByteSize)</div><div class="line"><a name="l03669"></a><span class="lineno"> 3669</span>&#160;    MaxSafeDepDistBytes = MaxVFWithoutSLForwardIssues;</div><div class="line"><a name="l03670"></a><span class="lineno"> 3670</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l03671"></a><span class="lineno"> 3671</span>&#160;}</div><div class="line"><a name="l03672"></a><span class="lineno"> 3672</span>&#160;</div><div class="line"><a name="l03673"></a><span class="lineno"> 3673</span>&#160;<span class="keywordtype">bool</span> MemoryDepChecker::isDependent(<span class="keyword">const</span> MemAccessInfo &amp;<a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>, <span class="keywordtype">unsigned</span> AIdx,</div><div class="line"><a name="l03674"></a><span class="lineno"> 3674</span>&#160;                                   <span class="keyword">const</span> MemAccessInfo &amp;<a class="code" href="Target_2ARM_2README_8txt.html#a90cca76dd78688687e0d697679dbc799">B</a>, <span class="keywordtype">unsigned</span> BIdx) {</div><div class="line"><a name="l03675"></a><span class="lineno"> 3675</span>&#160;  assert (AIdx &lt; BIdx &amp;&amp; <span class="stringliteral">&quot;Must pass arguments in program order&quot;</span>);</div><div class="line"><a name="l03676"></a><span class="lineno"> 3676</span>&#160;</div><div class="line"><a name="l03677"></a><span class="lineno"> 3677</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *APtr = A.getPointer();</div><div class="line"><a name="l03678"></a><span class="lineno"> 3678</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *BPtr = B.getPointer();</div><div class="line"><a name="l03679"></a><span class="lineno"> 3679</span>&#160;  <span class="keywordtype">bool</span> AIsWrite = A.getInt();</div><div class="line"><a name="l03680"></a><span class="lineno"> 3680</span>&#160;  <span class="keywordtype">bool</span> BIsWrite = B.getInt();</div><div class="line"><a name="l03681"></a><span class="lineno"> 3681</span>&#160;</div><div class="line"><a name="l03682"></a><span class="lineno"> 3682</span>&#160;  <span class="comment">// Two reads are independent.</span></div><div class="line"><a name="l03683"></a><span class="lineno"> 3683</span>&#160;  <span class="keywordflow">if</span> (!AIsWrite &amp;&amp; !BIsWrite)</div><div class="line"><a name="l03684"></a><span class="lineno"> 3684</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l03685"></a><span class="lineno"> 3685</span>&#160;</div><div class="line"><a name="l03686"></a><span class="lineno"> 3686</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *AScev = SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a30bd18ac905eacf3601bc6a553a9ff49">getSCEV</a>(APtr);</div><div class="line"><a name="l03687"></a><span class="lineno"> 3687</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *BScev = SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a30bd18ac905eacf3601bc6a553a9ff49">getSCEV</a>(BPtr);</div><div class="line"><a name="l03688"></a><span class="lineno"> 3688</span>&#160;</div><div class="line"><a name="l03689"></a><span class="lineno"> 3689</span>&#160;  <span class="keywordtype">int</span> StrideAPtr = <a class="code" href="LoopVectorize_8cpp.html#ae0635a013d9930362a412c26d0978739">isStridedPtr</a>(SE, DL, APtr, InnermostLoop);</div><div class="line"><a name="l03690"></a><span class="lineno"> 3690</span>&#160;  <span class="keywordtype">int</span> StrideBPtr = <a class="code" href="LoopVectorize_8cpp.html#ae0635a013d9930362a412c26d0978739">isStridedPtr</a>(SE, DL, BPtr, InnermostLoop);</div><div class="line"><a name="l03691"></a><span class="lineno"> 3691</span>&#160;</div><div class="line"><a name="l03692"></a><span class="lineno"> 3692</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *Src = AScev;</div><div class="line"><a name="l03693"></a><span class="lineno"> 3693</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *<a class="code" href="namespacellvm_1_1cl.html#ac96f30ba8b117dbd380b88ab8a03732ba1e82b710efc2f25cc275e53b3833e6fa">Sink</a> = BScev;</div><div class="line"><a name="l03694"></a><span class="lineno"> 3694</span>&#160;</div><div class="line"><a name="l03695"></a><span class="lineno"> 3695</span>&#160;  <span class="comment">// If the induction step is negative we have to invert source and sink of the</span></div><div class="line"><a name="l03696"></a><span class="lineno"> 3696</span>&#160;  <span class="comment">// dependence.</span></div><div class="line"><a name="l03697"></a><span class="lineno"> 3697</span>&#160;  <span class="keywordflow">if</span> (StrideAPtr &lt; 0) {</div><div class="line"><a name="l03698"></a><span class="lineno"> 3698</span>&#160;    <span class="comment">//Src = BScev;</span></div><div class="line"><a name="l03699"></a><span class="lineno"> 3699</span>&#160;    <span class="comment">//Sink = AScev;</span></div><div class="line"><a name="l03700"></a><span class="lineno"> 3700</span>&#160;    <a class="code" href="namespacestd.html#ab8424022895aee3e366fb9a32f2883cb">std::swap</a>(APtr, BPtr);</div><div class="line"><a name="l03701"></a><span class="lineno"> 3701</span>&#160;    <a class="code" href="namespacestd.html#ab8424022895aee3e366fb9a32f2883cb">std::swap</a>(Src, Sink);</div><div class="line"><a name="l03702"></a><span class="lineno"> 3702</span>&#160;    <a class="code" href="namespacestd.html#ab8424022895aee3e366fb9a32f2883cb">std::swap</a>(AIsWrite, BIsWrite);</div><div class="line"><a name="l03703"></a><span class="lineno"> 3703</span>&#160;    <a class="code" href="namespacestd.html#ab8424022895aee3e366fb9a32f2883cb">std::swap</a>(AIdx, BIdx);</div><div class="line"><a name="l03704"></a><span class="lineno"> 3704</span>&#160;    <a class="code" href="namespacestd.html#ab8424022895aee3e366fb9a32f2883cb">std::swap</a>(StrideAPtr, StrideBPtr);</div><div class="line"><a name="l03705"></a><span class="lineno"> 3705</span>&#160;  }</div><div class="line"><a name="l03706"></a><span class="lineno"> 3706</span>&#160;</div><div class="line"><a name="l03707"></a><span class="lineno"> 3707</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *Dist = SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#aa888e3661c809163273aca85ded4d846">getMinusSCEV</a>(Sink, Src);</div><div class="line"><a name="l03708"></a><span class="lineno"> 3708</span>&#160;</div><div class="line"><a name="l03709"></a><span class="lineno"> 3709</span>&#160;  <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;LV: Src Scev: &quot;</span> &lt;&lt; *Src &lt;&lt; <span class="stringliteral">&quot;Sink Scev: &quot;</span> &lt;&lt; *Sink</div><div class="line"><a name="l03710"></a><span class="lineno"> 3710</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;(Induction step: &quot;</span> &lt;&lt; StrideAPtr &lt;&lt;  <span class="stringliteral">&quot;)\n&quot;</span>);</div><div class="line"><a name="l03711"></a><span class="lineno"> 3711</span>&#160;  <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;LV: Distance for &quot;</span> &lt;&lt; *InstMap[AIdx] &lt;&lt; <span class="stringliteral">&quot; to &quot;</span></div><div class="line"><a name="l03712"></a><span class="lineno"> 3712</span>&#160;        &lt;&lt; *InstMap[BIdx] &lt;&lt; <span class="stringliteral">&quot;: &quot;</span> &lt;&lt; *Dist &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line"><a name="l03713"></a><span class="lineno"> 3713</span>&#160;</div><div class="line"><a name="l03714"></a><span class="lineno"> 3714</span>&#160;  <span class="comment">// Need consecutive accesses. We don&#39;t want to vectorize</span></div><div class="line"><a name="l03715"></a><span class="lineno"> 3715</span>&#160;  <span class="comment">// &quot;A[B[i]] += ...&quot; and similar code or pointer arithmetic that could wrap in</span></div><div class="line"><a name="l03716"></a><span class="lineno"> 3716</span>&#160;  <span class="comment">// the address space.</span></div><div class="line"><a name="l03717"></a><span class="lineno"> 3717</span>&#160;  <span class="keywordflow">if</span> (!StrideAPtr || !StrideBPtr || StrideAPtr != StrideBPtr){</div><div class="line"><a name="l03718"></a><span class="lineno"> 3718</span>&#160;    <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Non-consecutive pointer access\n&quot;</span>);</div><div class="line"><a name="l03719"></a><span class="lineno"> 3719</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l03720"></a><span class="lineno"> 3720</span>&#160;  }</div><div class="line"><a name="l03721"></a><span class="lineno"> 3721</span>&#160;</div><div class="line"><a name="l03722"></a><span class="lineno"> 3722</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEVConstant.html">SCEVConstant</a> *<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1SCEVConstant.html">SCEVConstant</a>&gt;(Dist);</div><div class="line"><a name="l03723"></a><span class="lineno"> 3723</span>&#160;  <span class="keywordflow">if</span> (!C) {</div><div class="line"><a name="l03724"></a><span class="lineno"> 3724</span>&#160;    <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;LV: Dependence because of non constant distance\n&quot;</span>);</div><div class="line"><a name="l03725"></a><span class="lineno"> 3725</span>&#160;    ShouldRetryWithRuntimeCheck = <span class="keyword">true</span>;</div><div class="line"><a name="l03726"></a><span class="lineno"> 3726</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l03727"></a><span class="lineno"> 3727</span>&#160;  }</div><div class="line"><a name="l03728"></a><span class="lineno"> 3728</span>&#160;</div><div class="line"><a name="l03729"></a><span class="lineno"> 3729</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *ATy = APtr-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a5c09d927a0079ad16e8367271efe9bc2">getPointerElementType</a>();</div><div class="line"><a name="l03730"></a><span class="lineno"> 3730</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *BTy = BPtr-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a5c09d927a0079ad16e8367271efe9bc2">getPointerElementType</a>();</div><div class="line"><a name="l03731"></a><span class="lineno"> 3731</span>&#160;  <span class="keywordtype">unsigned</span> TypeByteSize = DL-&gt;<a class="code" href="classllvm_1_1DataLayout.html#a1d6fcc02e91ba24510aba42660c90e29">getTypeAllocSize</a>(ATy);</div><div class="line"><a name="l03732"></a><span class="lineno"> 3732</span>&#160;</div><div class="line"><a name="l03733"></a><span class="lineno"> 3733</span>&#160;  <span class="comment">// Negative distances are not plausible dependencies.</span></div><div class="line"><a name="l03734"></a><span class="lineno"> 3734</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1APInt.html">APInt</a> &amp;Val = C-&gt;<a class="code" href="classllvm_1_1SCEVConstant.html#a64f0133adf37f9513005465580a19a66">getValue</a>()-&gt;<a class="code" href="classllvm_1_1ConstantInt.html#af8dde13a97efce293a7b04daf1e208fb">getValue</a>();</div><div class="line"><a name="l03735"></a><span class="lineno"> 3735</span>&#160;  <span class="keywordflow">if</span> (Val.<a class="code" href="classllvm_1_1APInt.html#a0e9a2d7ec903d191ef029589ec647cb6">isNegative</a>()) {</div><div class="line"><a name="l03736"></a><span class="lineno"> 3736</span>&#160;    <span class="keywordtype">bool</span> IsTrueDataDependence = (AIsWrite &amp;&amp; !BIsWrite);</div><div class="line"><a name="l03737"></a><span class="lineno"> 3737</span>&#160;    <span class="keywordflow">if</span> (IsTrueDataDependence &amp;&amp;</div><div class="line"><a name="l03738"></a><span class="lineno"> 3738</span>&#160;        (couldPreventStoreLoadForward(Val.<a class="code" href="classllvm_1_1APInt.html#ae130d109fdba9ebb976e4fe2621b374a">abs</a>().<a class="code" href="classllvm_1_1APInt.html#a7dc983ebf0eb2d255fa90a67063c72e2">getZExtValue</a>(), TypeByteSize) ||</div><div class="line"><a name="l03739"></a><span class="lineno"> 3739</span>&#160;         ATy != BTy))</div><div class="line"><a name="l03740"></a><span class="lineno"> 3740</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l03741"></a><span class="lineno"> 3741</span>&#160;</div><div class="line"><a name="l03742"></a><span class="lineno"> 3742</span>&#160;    <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;LV: Dependence is negative: NoDep\n&quot;</span>);</div><div class="line"><a name="l03743"></a><span class="lineno"> 3743</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l03744"></a><span class="lineno"> 3744</span>&#160;  }</div><div class="line"><a name="l03745"></a><span class="lineno"> 3745</span>&#160;</div><div class="line"><a name="l03746"></a><span class="lineno"> 3746</span>&#160;  <span class="comment">// Write to the same location with the same size.</span></div><div class="line"><a name="l03747"></a><span class="lineno"> 3747</span>&#160;  <span class="comment">// Could be improved to assert type sizes are the same (i32 == float, etc).</span></div><div class="line"><a name="l03748"></a><span class="lineno"> 3748</span>&#160;  <span class="keywordflow">if</span> (Val == 0) {</div><div class="line"><a name="l03749"></a><span class="lineno"> 3749</span>&#160;    <span class="keywordflow">if</span> (ATy == BTy)</div><div class="line"><a name="l03750"></a><span class="lineno"> 3750</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l03751"></a><span class="lineno"> 3751</span>&#160;    <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;LV: Zero dependence difference but different types\n&quot;</span>);</div><div class="line"><a name="l03752"></a><span class="lineno"> 3752</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l03753"></a><span class="lineno"> 3753</span>&#160;  }</div><div class="line"><a name="l03754"></a><span class="lineno"> 3754</span>&#160;</div><div class="line"><a name="l03755"></a><span class="lineno"> 3755</span>&#160;  assert(Val.<a class="code" href="classllvm_1_1APInt.html#aeebb29dd5a7aaf9b4546fec69c43653b">isStrictlyPositive</a>() &amp;&amp; <span class="stringliteral">&quot;Expect a positive value&quot;</span>);</div><div class="line"><a name="l03756"></a><span class="lineno"> 3756</span>&#160;</div><div class="line"><a name="l03757"></a><span class="lineno"> 3757</span>&#160;  <span class="comment">// Positive distance bigger than max vectorization factor.</span></div><div class="line"><a name="l03758"></a><span class="lineno"> 3758</span>&#160;  <span class="keywordflow">if</span> (ATy != BTy) {</div><div class="line"><a name="l03759"></a><span class="lineno"> 3759</span>&#160;    <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt;</div><div class="line"><a name="l03760"></a><span class="lineno"> 3760</span>&#160;          <span class="stringliteral">&quot;LV: ReadWrite-Write positive dependency with different types\n&quot;</span>);</div><div class="line"><a name="l03761"></a><span class="lineno"> 3761</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l03762"></a><span class="lineno"> 3762</span>&#160;  }</div><div class="line"><a name="l03763"></a><span class="lineno"> 3763</span>&#160;</div><div class="line"><a name="l03764"></a><span class="lineno"> 3764</span>&#160;  <span class="keywordtype">unsigned</span> Distance = (unsigned) Val.<a class="code" href="classllvm_1_1APInt.html#a7dc983ebf0eb2d255fa90a67063c72e2">getZExtValue</a>();</div><div class="line"><a name="l03765"></a><span class="lineno"> 3765</span>&#160;</div><div class="line"><a name="l03766"></a><span class="lineno"> 3766</span>&#160;  <span class="comment">// Bail out early if passed-in parameters make vectorization not feasible.</span></div><div class="line"><a name="l03767"></a><span class="lineno"> 3767</span>&#160;  <span class="keywordtype">unsigned</span> ForcedFactor = <a class="code" href="LoopVectorize_8cpp.html#a7db5de6d612f2730abd7aa99a724615a">VectorizationFactor</a> ? <a class="code" href="LoopVectorize_8cpp.html#a7db5de6d612f2730abd7aa99a724615a">VectorizationFactor</a> : 1;</div><div class="line"><a name="l03768"></a><span class="lineno"> 3768</span>&#160;  <span class="keywordtype">unsigned</span> ForcedUnroll = <a class="code" href="LoopVectorize_8cpp.html#af303907f5edd23d696cb2af21c6fec66">VectorizationUnroll</a> ? <a class="code" href="LoopVectorize_8cpp.html#af303907f5edd23d696cb2af21c6fec66">VectorizationUnroll</a> : 1;</div><div class="line"><a name="l03769"></a><span class="lineno"> 3769</span>&#160;</div><div class="line"><a name="l03770"></a><span class="lineno"> 3770</span>&#160;  <span class="comment">// The distance must be bigger than the size needed for a vectorized version</span></div><div class="line"><a name="l03771"></a><span class="lineno"> 3771</span>&#160;  <span class="comment">// of the operation and the size of the vectorized operation must not be</span></div><div class="line"><a name="l03772"></a><span class="lineno"> 3772</span>&#160;  <span class="comment">// bigger than the currrent maximum size.</span></div><div class="line"><a name="l03773"></a><span class="lineno"> 3773</span>&#160;  <span class="keywordflow">if</span> (Distance &lt; 2*TypeByteSize ||</div><div class="line"><a name="l03774"></a><span class="lineno"> 3774</span>&#160;      2*TypeByteSize &gt; MaxSafeDepDistBytes ||</div><div class="line"><a name="l03775"></a><span class="lineno"> 3775</span>&#160;      Distance &lt; TypeByteSize * ForcedUnroll * ForcedFactor) {</div><div class="line"><a name="l03776"></a><span class="lineno"> 3776</span>&#160;    <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;LV: Failure because of Positive distance &quot;</span></div><div class="line"><a name="l03777"></a><span class="lineno"> 3777</span>&#160;        &lt;&lt; Val.<a class="code" href="classllvm_1_1APInt.html#a7189a37206963029447c31d57771b997">getSExtValue</a>() &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>);</div><div class="line"><a name="l03778"></a><span class="lineno"> 3778</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l03779"></a><span class="lineno"> 3779</span>&#160;  }</div><div class="line"><a name="l03780"></a><span class="lineno"> 3780</span>&#160;</div><div class="line"><a name="l03781"></a><span class="lineno"> 3781</span>&#160;  MaxSafeDepDistBytes = Distance &lt; MaxSafeDepDistBytes ?</div><div class="line"><a name="l03782"></a><span class="lineno"> 3782</span>&#160;    Distance : MaxSafeDepDistBytes;</div><div class="line"><a name="l03783"></a><span class="lineno"> 3783</span>&#160;</div><div class="line"><a name="l03784"></a><span class="lineno"> 3784</span>&#160;  <span class="keywordtype">bool</span> IsTrueDataDependence = (!AIsWrite &amp;&amp; BIsWrite);</div><div class="line"><a name="l03785"></a><span class="lineno"> 3785</span>&#160;  <span class="keywordflow">if</span> (IsTrueDataDependence &amp;&amp;</div><div class="line"><a name="l03786"></a><span class="lineno"> 3786</span>&#160;      couldPreventStoreLoadForward(Distance, TypeByteSize))</div><div class="line"><a name="l03787"></a><span class="lineno"> 3787</span>&#160;     <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l03788"></a><span class="lineno"> 3788</span>&#160;</div><div class="line"><a name="l03789"></a><span class="lineno"> 3789</span>&#160;  <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;LV: Positive distance &quot;</span> &lt;&lt; Val.<a class="code" href="classllvm_1_1APInt.html#a7189a37206963029447c31d57771b997">getSExtValue</a>() &lt;&lt;</div><div class="line"><a name="l03790"></a><span class="lineno"> 3790</span>&#160;        <span class="stringliteral">&quot; with max VF = &quot;</span> &lt;&lt; MaxSafeDepDistBytes / TypeByteSize &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>);</div><div class="line"><a name="l03791"></a><span class="lineno"> 3791</span>&#160;</div><div class="line"><a name="l03792"></a><span class="lineno"> 3792</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l03793"></a><span class="lineno"> 3793</span>&#160;}</div><div class="line"><a name="l03794"></a><span class="lineno"> 3794</span>&#160;</div><div class="line"><a name="l03795"></a><span class="lineno"> 3795</span>&#160;<span class="keywordtype">bool</span></div><div class="line"><a name="l03796"></a><span class="lineno"> 3796</span>&#160;MemoryDepChecker::areDepsSafe(<a class="code" href="classllvm_1_1EquivalenceClasses.html">AccessAnalysis::DepCandidates</a> &amp;AccessSets,</div><div class="line"><a name="l03797"></a><span class="lineno"> 3797</span>&#160;                              MemAccessInfoSet &amp;CheckDeps) {</div><div class="line"><a name="l03798"></a><span class="lineno"> 3798</span>&#160;</div><div class="line"><a name="l03799"></a><span class="lineno"> 3799</span>&#160;  MaxSafeDepDistBytes = -1U;</div><div class="line"><a name="l03800"></a><span class="lineno"> 3800</span>&#160;  <span class="keywordflow">while</span> (!CheckDeps.empty()) {</div><div class="line"><a name="l03801"></a><span class="lineno"> 3801</span>&#160;    MemAccessInfo CurAccess = *CheckDeps.begin();</div><div class="line"><a name="l03802"></a><span class="lineno"> 3802</span>&#160;</div><div class="line"><a name="l03803"></a><span class="lineno"> 3803</span>&#160;    <span class="comment">// Get the relevant memory access set.</span></div><div class="line"><a name="l03804"></a><span class="lineno"> 3804</span>&#160;    <a class="code" href="classllvm_1_1EquivalenceClasses.html#a7a49b8e8780b3ebfd805c613fb8626e2">EquivalenceClasses&lt;MemAccessInfo&gt;::iterator</a> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> =</div><div class="line"><a name="l03805"></a><span class="lineno"> 3805</span>&#160;      AccessSets.<a class="code" href="classllvm_1_1EquivalenceClasses.html#ab32ed10f483db713155827b70a046410">findValue</a>(AccessSets.<a class="code" href="classllvm_1_1EquivalenceClasses.html#aa00be6d847dfe5d62c7aa570d4a70584">getLeaderValue</a>(CurAccess));</div><div class="line"><a name="l03806"></a><span class="lineno"> 3806</span>&#160;</div><div class="line"><a name="l03807"></a><span class="lineno"> 3807</span>&#160;    <span class="comment">// Check accesses within this set.</span></div><div class="line"><a name="l03808"></a><span class="lineno"> 3808</span>&#160;    <a class="code" href="classllvm_1_1EquivalenceClasses_1_1member__iterator.html">EquivalenceClasses&lt;MemAccessInfo&gt;::member_iterator</a> AI, AE;</div><div class="line"><a name="l03809"></a><span class="lineno"> 3809</span>&#160;    AI = AccessSets.<a class="code" href="classllvm_1_1EquivalenceClasses.html#aae2c0f52f973c407654c6f0bea9c95e8">member_begin</a>(I), AE = AccessSets.<a class="code" href="classllvm_1_1EquivalenceClasses.html#aebaeeb87ebb6d56f063c394d160ead3e">member_end</a>();</div><div class="line"><a name="l03810"></a><span class="lineno"> 3810</span>&#160;</div><div class="line"><a name="l03811"></a><span class="lineno"> 3811</span>&#160;    <span class="comment">// Check every access pair.</span></div><div class="line"><a name="l03812"></a><span class="lineno"> 3812</span>&#160;    <span class="keywordflow">while</span> (AI != AE) {</div><div class="line"><a name="l03813"></a><span class="lineno"> 3813</span>&#160;      CheckDeps.erase(*AI);</div><div class="line"><a name="l03814"></a><span class="lineno"> 3814</span>&#160;      <a class="code" href="classllvm_1_1EquivalenceClasses_1_1member__iterator.html">EquivalenceClasses&lt;MemAccessInfo&gt;::member_iterator</a> OI = <a class="code" href="namespacellvm.html#aa1704159f75e6eacd595962ea6d93ffe">llvm::next</a>(AI);</div><div class="line"><a name="l03815"></a><span class="lineno"> 3815</span>&#160;      <span class="keywordflow">while</span> (OI != AE) {</div><div class="line"><a name="l03816"></a><span class="lineno"> 3816</span>&#160;        <span class="comment">// Check every accessing instruction pair in program order.</span></div><div class="line"><a name="l03817"></a><span class="lineno"> 3817</span>&#160;        <span class="keywordflow">for</span> (std::vector&lt;unsigned&gt;::iterator I1 = Accesses[*AI].<a class="code" href="namespacellvm_1_1sys_1_1path.html#a33706aab89e700b8f79e1fa6f4f0e3ee">begin</a>(),</div><div class="line"><a name="l03818"></a><span class="lineno"> 3818</span>&#160;             I1E = Accesses[*AI].<a class="code" href="namespacellvm_1_1sys_1_1path.html#a214ec2f04ffd92636ed4bd2717607a1d">end</a>(); I1 != I1E; ++I1)</div><div class="line"><a name="l03819"></a><span class="lineno"> 3819</span>&#160;          <span class="keywordflow">for</span> (std::vector&lt;unsigned&gt;::iterator I2 = Accesses[*OI].<a class="code" href="namespacellvm_1_1sys_1_1path.html#a33706aab89e700b8f79e1fa6f4f0e3ee">begin</a>(),</div><div class="line"><a name="l03820"></a><span class="lineno"> 3820</span>&#160;               I2E = Accesses[*OI].<a class="code" href="namespacellvm_1_1sys_1_1path.html#a214ec2f04ffd92636ed4bd2717607a1d">end</a>(); I2 != I2E; ++I2) {</div><div class="line"><a name="l03821"></a><span class="lineno"> 3821</span>&#160;            <span class="keywordflow">if</span> (*I1 &lt; *I2 &amp;&amp; isDependent(*AI, *I1, *OI, *I2))</div><div class="line"><a name="l03822"></a><span class="lineno"> 3822</span>&#160;              <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l03823"></a><span class="lineno"> 3823</span>&#160;            <span class="keywordflow">if</span> (*I2 &lt; *I1 &amp;&amp; isDependent(*OI, *I2, *AI, *I1))</div><div class="line"><a name="l03824"></a><span class="lineno"> 3824</span>&#160;              <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l03825"></a><span class="lineno"> 3825</span>&#160;          }</div><div class="line"><a name="l03826"></a><span class="lineno"> 3826</span>&#160;        ++OI;</div><div class="line"><a name="l03827"></a><span class="lineno"> 3827</span>&#160;      }</div><div class="line"><a name="l03828"></a><span class="lineno"> 3828</span>&#160;      AI++;</div><div class="line"><a name="l03829"></a><span class="lineno"> 3829</span>&#160;    }</div><div class="line"><a name="l03830"></a><span class="lineno"> 3830</span>&#160;  }</div><div class="line"><a name="l03831"></a><span class="lineno"> 3831</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l03832"></a><span class="lineno"> 3832</span>&#160;}</div><div class="line"><a name="l03833"></a><span class="lineno"> 3833</span>&#160;</div><div class="line"><a name="l03834"></a><span class="lineno"> 3834</span>&#160;<span class="keywordtype">bool</span> LoopVectorizationLegality::canVectorizeMemory() {</div><div class="line"><a name="l03835"></a><span class="lineno"> 3835</span>&#160;</div><div class="line"><a name="l03836"></a><span class="lineno"> 3836</span>&#160;  <span class="keyword">typedef</span> <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Value*, 16&gt;</a> ValueVector;</div><div class="line"><a name="l03837"></a><span class="lineno"> 3837</span>&#160;  <span class="keyword">typedef</span> <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;Value*, 16&gt;</a> ValueSet;</div><div class="line"><a name="l03838"></a><span class="lineno"> 3838</span>&#160;</div><div class="line"><a name="l03839"></a><span class="lineno"> 3839</span>&#160;  <span class="comment">// Holds the Load and Store *instructions*.</span></div><div class="line"><a name="l03840"></a><span class="lineno"> 3840</span>&#160;  ValueVector Loads;</div><div class="line"><a name="l03841"></a><span class="lineno"> 3841</span>&#160;  ValueVector Stores;</div><div class="line"><a name="l03842"></a><span class="lineno"> 3842</span>&#160;</div><div class="line"><a name="l03843"></a><span class="lineno"> 3843</span>&#160;  <span class="comment">// Holds all the different accesses in the loop.</span></div><div class="line"><a name="l03844"></a><span class="lineno"> 3844</span>&#160;  <span class="keywordtype">unsigned</span> NumReads = 0;</div><div class="line"><a name="l03845"></a><span class="lineno"> 3845</span>&#160;  <span class="keywordtype">unsigned</span> NumReadWrites = 0;</div><div class="line"><a name="l03846"></a><span class="lineno"> 3846</span>&#160;</div><div class="line"><a name="l03847"></a><span class="lineno"> 3847</span>&#160;  PtrRtCheck.Pointers.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#aa72472422d95c7052d62432ec279ff85">clear</a>();</div><div class="line"><a name="l03848"></a><span class="lineno"> 3848</span>&#160;  PtrRtCheck.Need = <span class="keyword">false</span>;</div><div class="line"><a name="l03849"></a><span class="lineno"> 3849</span>&#160;</div><div class="line"><a name="l03850"></a><span class="lineno"> 3850</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> IsAnnotatedParallel = TheLoop-&gt;<a class="code" href="classllvm_1_1Loop.html#a9a528e07e493ebddf91f2e1762d013e7">isAnnotatedParallel</a>();</div><div class="line"><a name="l03851"></a><span class="lineno"> 3851</span>&#160;  MemoryDepChecker DepChecker(SE, DL, TheLoop);</div><div class="line"><a name="l03852"></a><span class="lineno"> 3852</span>&#160;</div><div class="line"><a name="l03853"></a><span class="lineno"> 3853</span>&#160;  <span class="comment">// For each block.</span></div><div class="line"><a name="l03854"></a><span class="lineno"> 3854</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1LoopBase.html#ab39f9623eaa8cd22213aa716c6fb9994">Loop::block_iterator</a> <a class="code" href="Target_2X86_2README_8txt.html#ac9423a63151469d95755528cceb322fb">bb</a> = TheLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a3df1c508a7b1c89247367cab269076e2">block_begin</a>(),</div><div class="line"><a name="l03855"></a><span class="lineno"> 3855</span>&#160;       <a class="code" href="CodeGen_2README_8txt.html#aa0629dbc89f0868f62da8cbcb681b2be">be</a> = TheLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a91e3f5f9bf6ecbd058624a479e150603">block_end</a>(); <a class="code" href="Target_2X86_2README_8txt.html#ac9423a63151469d95755528cceb322fb">bb</a> != <a class="code" href="CodeGen_2README_8txt.html#aa0629dbc89f0868f62da8cbcb681b2be">be</a>; ++<a class="code" href="Target_2X86_2README_8txt.html#ac9423a63151469d95755528cceb322fb">bb</a>) {</div><div class="line"><a name="l03856"></a><span class="lineno"> 3856</span>&#160;</div><div class="line"><a name="l03857"></a><span class="lineno"> 3857</span>&#160;    <span class="comment">// Scan the BB and collect legal loads and stores.</span></div><div class="line"><a name="l03858"></a><span class="lineno"> 3858</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1ilist__iterator.html">BasicBlock::iterator</a> <a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a> = (*bb)-&gt;begin(), e = (*bb)-&gt;end(); <a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a> != e;</div><div class="line"><a name="l03859"></a><span class="lineno"> 3859</span>&#160;         ++<a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a>) {</div><div class="line"><a name="l03860"></a><span class="lineno"> 3860</span>&#160;</div><div class="line"><a name="l03861"></a><span class="lineno"> 3861</span>&#160;      <span class="comment">// If this is a load, save it. If this instruction can read from memory</span></div><div class="line"><a name="l03862"></a><span class="lineno"> 3862</span>&#160;      <span class="comment">// but is not a load, then we quit. Notice that we don&#39;t handle function</span></div><div class="line"><a name="l03863"></a><span class="lineno"> 3863</span>&#160;      <span class="comment">// calls that read or write.</span></div><div class="line"><a name="l03864"></a><span class="lineno"> 3864</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a>-&gt;mayReadFromMemory()) {</div><div class="line"><a name="l03865"></a><span class="lineno"> 3865</span>&#160;        <span class="comment">// Many math library functions read the rounding mode. We will only</span></div><div class="line"><a name="l03866"></a><span class="lineno"> 3866</span>&#160;        <span class="comment">// vectorize a loop if it contains known function calls that don&#39;t set</span></div><div class="line"><a name="l03867"></a><span class="lineno"> 3867</span>&#160;        <span class="comment">// the flag. Therefore, it is safe to ignore this read from memory.</span></div><div class="line"><a name="l03868"></a><span class="lineno"> 3868</span>&#160;        <a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *<a class="code" href="namespacellvm.html#af6d6a791770bad2303c4399986979e3eae411369b2f0d8f484fec62c3291b1b51">Call</a> = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1CallInst.html">CallInst</a>&gt;(<a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a>);</div><div class="line"><a name="l03869"></a><span class="lineno"> 3869</span>&#160;        <span class="keywordflow">if</span> (Call &amp;&amp; <a class="code" href="LoopVectorize_8cpp.html#a417c0c66aeccfcbee14042ec89bab074">getIntrinsicIDForCall</a>(Call, TLI))</div><div class="line"><a name="l03870"></a><span class="lineno"> 3870</span>&#160;          <span class="keywordflow">continue</span>;</div><div class="line"><a name="l03871"></a><span class="lineno"> 3871</span>&#160;</div><div class="line"><a name="l03872"></a><span class="lineno"> 3872</span>&#160;        <a class="code" href="classllvm_1_1LoadInst.html">LoadInst</a> *Ld = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1LoadInst.html">LoadInst</a>&gt;(<a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a>);</div><div class="line"><a name="l03873"></a><span class="lineno"> 3873</span>&#160;        <span class="keywordflow">if</span> (!Ld) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l03874"></a><span class="lineno"> 3874</span>&#160;        <span class="keywordflow">if</span> (!Ld-&gt;<a class="code" href="classllvm_1_1LoadInst.html#a156c478ee8e7d1602143cdbad4bd5385">isSimple</a>() &amp;&amp; !IsAnnotatedParallel) {</div><div class="line"><a name="l03875"></a><span class="lineno"> 3875</span>&#160;          <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;LV: Found a non-simple load.\n&quot;</span>);</div><div class="line"><a name="l03876"></a><span class="lineno"> 3876</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l03877"></a><span class="lineno"> 3877</span>&#160;        }</div><div class="line"><a name="l03878"></a><span class="lineno"> 3878</span>&#160;        Loads.push_back(Ld);</div><div class="line"><a name="l03879"></a><span class="lineno"> 3879</span>&#160;        DepChecker.addAccess(Ld);</div><div class="line"><a name="l03880"></a><span class="lineno"> 3880</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l03881"></a><span class="lineno"> 3881</span>&#160;      }</div><div class="line"><a name="l03882"></a><span class="lineno"> 3882</span>&#160;</div><div class="line"><a name="l03883"></a><span class="lineno"> 3883</span>&#160;      <span class="comment">// Save &#39;store&#39; instructions. Abort if other instructions write to memory.</span></div><div class="line"><a name="l03884"></a><span class="lineno"> 3884</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a>-&gt;mayWriteToMemory()) {</div><div class="line"><a name="l03885"></a><span class="lineno"> 3885</span>&#160;        <a class="code" href="classllvm_1_1StoreInst.html">StoreInst</a> *St = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1StoreInst.html">StoreInst</a>&gt;(<a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a>);</div><div class="line"><a name="l03886"></a><span class="lineno"> 3886</span>&#160;        <span class="keywordflow">if</span> (!St) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l03887"></a><span class="lineno"> 3887</span>&#160;        <span class="keywordflow">if</span> (!St-&gt;<a class="code" href="classllvm_1_1StoreInst.html#a1149c7eeefca671ac2685bca13843568">isSimple</a>() &amp;&amp; !IsAnnotatedParallel) {</div><div class="line"><a name="l03888"></a><span class="lineno"> 3888</span>&#160;          <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;LV: Found a non-simple store.\n&quot;</span>);</div><div class="line"><a name="l03889"></a><span class="lineno"> 3889</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l03890"></a><span class="lineno"> 3890</span>&#160;        }</div><div class="line"><a name="l03891"></a><span class="lineno"> 3891</span>&#160;        Stores.push_back(St);</div><div class="line"><a name="l03892"></a><span class="lineno"> 3892</span>&#160;        DepChecker.addAccess(St);</div><div class="line"><a name="l03893"></a><span class="lineno"> 3893</span>&#160;      }</div><div class="line"><a name="l03894"></a><span class="lineno"> 3894</span>&#160;    } <span class="comment">// Next instr.</span></div><div class="line"><a name="l03895"></a><span class="lineno"> 3895</span>&#160;  } <span class="comment">// Next block.</span></div><div class="line"><a name="l03896"></a><span class="lineno"> 3896</span>&#160;</div><div class="line"><a name="l03897"></a><span class="lineno"> 3897</span>&#160;  <span class="comment">// Now we have two lists that hold the loads and the stores.</span></div><div class="line"><a name="l03898"></a><span class="lineno"> 3898</span>&#160;  <span class="comment">// Next, we find the pointers that they use.</span></div><div class="line"><a name="l03899"></a><span class="lineno"> 3899</span>&#160;</div><div class="line"><a name="l03900"></a><span class="lineno"> 3900</span>&#160;  <span class="comment">// Check if we see any stores. If there are no stores, then we don&#39;t</span></div><div class="line"><a name="l03901"></a><span class="lineno"> 3901</span>&#160;  <span class="comment">// care if the pointers are *restrict*.</span></div><div class="line"><a name="l03902"></a><span class="lineno"> 3902</span>&#160;  <span class="keywordflow">if</span> (!Stores.size()) {</div><div class="line"><a name="l03903"></a><span class="lineno"> 3903</span>&#160;    <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;LV: Found a read-only loop!\n&quot;</span>);</div><div class="line"><a name="l03904"></a><span class="lineno"> 3904</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l03905"></a><span class="lineno"> 3905</span>&#160;  }</div><div class="line"><a name="l03906"></a><span class="lineno"> 3906</span>&#160;</div><div class="line"><a name="l03907"></a><span class="lineno"> 3907</span>&#160;  <a class="code" href="classllvm_1_1EquivalenceClasses.html">AccessAnalysis::DepCandidates</a> DependentAccesses;</div><div class="line"><a name="l03908"></a><span class="lineno"> 3908</span>&#160;  AccessAnalysis Accesses(DL, DependentAccesses);</div><div class="line"><a name="l03909"></a><span class="lineno"> 3909</span>&#160;</div><div class="line"><a name="l03910"></a><span class="lineno"> 3910</span>&#160;  <span class="comment">// Holds the analyzed pointers. We don&#39;t want to call GetUnderlyingObjects</span></div><div class="line"><a name="l03911"></a><span class="lineno"> 3911</span>&#160;  <span class="comment">// multiple times on the same object. If the ptr is accessed twice, once</span></div><div class="line"><a name="l03912"></a><span class="lineno"> 3912</span>&#160;  <span class="comment">// for read and once for write, it will only appear once (on the write</span></div><div class="line"><a name="l03913"></a><span class="lineno"> 3913</span>&#160;  <span class="comment">// list). This is okay, since we are going to check for conflicts between</span></div><div class="line"><a name="l03914"></a><span class="lineno"> 3914</span>&#160;  <span class="comment">// writes and between reads and writes, but not between reads and reads.</span></div><div class="line"><a name="l03915"></a><span class="lineno"> 3915</span>&#160;  ValueSet Seen;</div><div class="line"><a name="l03916"></a><span class="lineno"> 3916</span>&#160;</div><div class="line"><a name="l03917"></a><span class="lineno"> 3917</span>&#160;  ValueVector::iterator <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="namespacellvm_1_1ARM__PROC.html#a1add7850fad3f66c140ecee871460ea4ae9d798593a4a6b5cc48486a453a59e5e">IE</a>;</div><div class="line"><a name="l03918"></a><span class="lineno"> 3918</span>&#160;  <span class="keywordflow">for</span> (I = Stores.begin(), IE = Stores.end(); I != <a class="code" href="namespacellvm_1_1ARM__PROC.html#a1add7850fad3f66c140ecee871460ea4ae9d798593a4a6b5cc48486a453a59e5e">IE</a>; ++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div><div class="line"><a name="l03919"></a><span class="lineno"> 3919</span>&#160;    <a class="code" href="classllvm_1_1StoreInst.html">StoreInst</a> *<a class="code" href="namespacellvm_1_1A64DB.html#a6fce8157775f3ec93f326b52b0f1e0f5a4916e736d6b7cc68359b39d5eb50f6db">ST</a> = cast&lt;StoreInst&gt;(*I);</div><div class="line"><a name="l03920"></a><span class="lineno"> 3920</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a>* Ptr = ST-&gt;<a class="code" href="classllvm_1_1StoreInst.html#ac03c1c093059ea000216af8dd6f2dbf4">getPointerOperand</a>();</div><div class="line"><a name="l03921"></a><span class="lineno"> 3921</span>&#160;</div><div class="line"><a name="l03922"></a><span class="lineno"> 3922</span>&#160;    <span class="keywordflow">if</span> (isUniform(Ptr)) {</div><div class="line"><a name="l03923"></a><span class="lineno"> 3923</span>&#160;      <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;LV: We don&#39;t allow storing to uniform addresses\n&quot;</span>);</div><div class="line"><a name="l03924"></a><span class="lineno"> 3924</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l03925"></a><span class="lineno"> 3925</span>&#160;    }</div><div class="line"><a name="l03926"></a><span class="lineno"> 3926</span>&#160;</div><div class="line"><a name="l03927"></a><span class="lineno"> 3927</span>&#160;    <span class="comment">// If we did *not* see this pointer before, insert it to  the read-write</span></div><div class="line"><a name="l03928"></a><span class="lineno"> 3928</span>&#160;    <span class="comment">// list. At this phase it is only a &#39;write&#39; list.</span></div><div class="line"><a name="l03929"></a><span class="lineno"> 3929</span>&#160;    <span class="keywordflow">if</span> (Seen.insert(Ptr)) {</div><div class="line"><a name="l03930"></a><span class="lineno"> 3930</span>&#160;      ++NumReadWrites;</div><div class="line"><a name="l03931"></a><span class="lineno"> 3931</span>&#160;      Accesses.addStore(Ptr);</div><div class="line"><a name="l03932"></a><span class="lineno"> 3932</span>&#160;    }</div><div class="line"><a name="l03933"></a><span class="lineno"> 3933</span>&#160;  }</div><div class="line"><a name="l03934"></a><span class="lineno"> 3934</span>&#160;</div><div class="line"><a name="l03935"></a><span class="lineno"> 3935</span>&#160;  <span class="keywordflow">if</span> (IsAnnotatedParallel) {</div><div class="line"><a name="l03936"></a><span class="lineno"> 3936</span>&#160;    <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>()</div><div class="line"><a name="l03937"></a><span class="lineno"> 3937</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;LV: A loop annotated parallel, ignore memory dependency &quot;</span></div><div class="line"><a name="l03938"></a><span class="lineno"> 3938</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;checks.\n&quot;</span>);</div><div class="line"><a name="l03939"></a><span class="lineno"> 3939</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l03940"></a><span class="lineno"> 3940</span>&#160;  }</div><div class="line"><a name="l03941"></a><span class="lineno"> 3941</span>&#160;</div><div class="line"><a name="l03942"></a><span class="lineno"> 3942</span>&#160;  <span class="keywordflow">for</span> (I = Loads.begin(), IE = Loads.end(); I != <a class="code" href="namespacellvm_1_1ARM__PROC.html#a1add7850fad3f66c140ecee871460ea4ae9d798593a4a6b5cc48486a453a59e5e">IE</a>; ++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div><div class="line"><a name="l03943"></a><span class="lineno"> 3943</span>&#160;    <a class="code" href="classllvm_1_1LoadInst.html">LoadInst</a> *<a class="code" href="namespacellvm_1_1A64DB.html#a6fce8157775f3ec93f326b52b0f1e0f5ad61b145eb8cbab18feb1b2e2ce269a7e">LD</a> = cast&lt;LoadInst&gt;(*I);</div><div class="line"><a name="l03944"></a><span class="lineno"> 3944</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a>* Ptr = LD-&gt;<a class="code" href="classllvm_1_1LoadInst.html#ad47eefa1d094f60494b6b927061ca001">getPointerOperand</a>();</div><div class="line"><a name="l03945"></a><span class="lineno"> 3945</span>&#160;    <span class="comment">// If we did *not* see this pointer before, insert it to the</span></div><div class="line"><a name="l03946"></a><span class="lineno"> 3946</span>&#160;    <span class="comment">// read list. If we *did* see it before, then it is already in</span></div><div class="line"><a name="l03947"></a><span class="lineno"> 3947</span>&#160;    <span class="comment">// the read-write list. This allows us to vectorize expressions</span></div><div class="line"><a name="l03948"></a><span class="lineno"> 3948</span>&#160;    <span class="comment">// such as A[i] += x;  Because the address of A[i] is a read-write</span></div><div class="line"><a name="l03949"></a><span class="lineno"> 3949</span>&#160;    <span class="comment">// pointer. This only works if the index of A[i] is consecutive.</span></div><div class="line"><a name="l03950"></a><span class="lineno"> 3950</span>&#160;    <span class="comment">// If the address of i is unknown (for example A[B[i]]) then we may</span></div><div class="line"><a name="l03951"></a><span class="lineno"> 3951</span>&#160;    <span class="comment">// read a few words, modify, and write a few words, and some of the</span></div><div class="line"><a name="l03952"></a><span class="lineno"> 3952</span>&#160;    <span class="comment">// words may be written to the same address.</span></div><div class="line"><a name="l03953"></a><span class="lineno"> 3953</span>&#160;    <span class="keywordtype">bool</span> IsReadOnlyPtr = <span class="keyword">false</span>;</div><div class="line"><a name="l03954"></a><span class="lineno"> 3954</span>&#160;    <span class="keywordflow">if</span> (Seen.insert(Ptr) || !<a class="code" href="LoopVectorize_8cpp.html#ae0635a013d9930362a412c26d0978739">isStridedPtr</a>(SE, DL, Ptr, TheLoop)) {</div><div class="line"><a name="l03955"></a><span class="lineno"> 3955</span>&#160;      ++NumReads;</div><div class="line"><a name="l03956"></a><span class="lineno"> 3956</span>&#160;      IsReadOnlyPtr = <span class="keyword">true</span>;</div><div class="line"><a name="l03957"></a><span class="lineno"> 3957</span>&#160;    }</div><div class="line"><a name="l03958"></a><span class="lineno"> 3958</span>&#160;    Accesses.addLoad(Ptr, IsReadOnlyPtr);</div><div class="line"><a name="l03959"></a><span class="lineno"> 3959</span>&#160;  }</div><div class="line"><a name="l03960"></a><span class="lineno"> 3960</span>&#160;</div><div class="line"><a name="l03961"></a><span class="lineno"> 3961</span>&#160;  <span class="comment">// If we write (or read-write) to a single destination and there are no</span></div><div class="line"><a name="l03962"></a><span class="lineno"> 3962</span>&#160;  <span class="comment">// other reads in this loop then is it safe to vectorize.</span></div><div class="line"><a name="l03963"></a><span class="lineno"> 3963</span>&#160;  <span class="keywordflow">if</span> (NumReadWrites == 1 &amp;&amp; NumReads == 0) {</div><div class="line"><a name="l03964"></a><span class="lineno"> 3964</span>&#160;    <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;LV: Found a write-only loop!\n&quot;</span>);</div><div class="line"><a name="l03965"></a><span class="lineno"> 3965</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l03966"></a><span class="lineno"> 3966</span>&#160;  }</div><div class="line"><a name="l03967"></a><span class="lineno"> 3967</span>&#160;</div><div class="line"><a name="l03968"></a><span class="lineno"> 3968</span>&#160;  <span class="comment">// Build dependence sets and check whether we need a runtime pointer bounds</span></div><div class="line"><a name="l03969"></a><span class="lineno"> 3969</span>&#160;  <span class="comment">// check.</span></div><div class="line"><a name="l03970"></a><span class="lineno"> 3970</span>&#160;  Accesses.buildDependenceSets();</div><div class="line"><a name="l03971"></a><span class="lineno"> 3971</span>&#160;  <span class="keywordtype">bool</span> NeedRTCheck = Accesses.isRTCheckNeeded();</div><div class="line"><a name="l03972"></a><span class="lineno"> 3972</span>&#160;</div><div class="line"><a name="l03973"></a><span class="lineno"> 3973</span>&#160;  <span class="comment">// Find pointers with computable bounds. We are going to use this information</span></div><div class="line"><a name="l03974"></a><span class="lineno"> 3974</span>&#160;  <span class="comment">// to place a runtime bound check.</span></div><div class="line"><a name="l03975"></a><span class="lineno"> 3975</span>&#160;  <span class="keywordtype">unsigned</span> NumComparisons = 0;</div><div class="line"><a name="l03976"></a><span class="lineno"> 3976</span>&#160;  <span class="keywordtype">bool</span> CanDoRT = <span class="keyword">false</span>;</div><div class="line"><a name="l03977"></a><span class="lineno"> 3977</span>&#160;  <span class="keywordflow">if</span> (NeedRTCheck)</div><div class="line"><a name="l03978"></a><span class="lineno"> 3978</span>&#160;    CanDoRT = Accesses.canCheckPtrAtRT(PtrRtCheck, NumComparisons, SE, TheLoop);</div><div class="line"><a name="l03979"></a><span class="lineno"> 3979</span>&#160;</div><div class="line"><a name="l03980"></a><span class="lineno"> 3980</span>&#160;</div><div class="line"><a name="l03981"></a><span class="lineno"> 3981</span>&#160;  <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;LV: We need to do &quot;</span> &lt;&lt; NumComparisons &lt;&lt;</div><div class="line"><a name="l03982"></a><span class="lineno"> 3982</span>&#160;        <span class="stringliteral">&quot; pointer comparisons.\n&quot;</span>);</div><div class="line"><a name="l03983"></a><span class="lineno"> 3983</span>&#160;</div><div class="line"><a name="l03984"></a><span class="lineno"> 3984</span>&#160;  <span class="comment">// If we only have one set of dependences to check pointers among we don&#39;t</span></div><div class="line"><a name="l03985"></a><span class="lineno"> 3985</span>&#160;  <span class="comment">// need a runtime check.</span></div><div class="line"><a name="l03986"></a><span class="lineno"> 3986</span>&#160;  <span class="keywordflow">if</span> (NumComparisons == 0 &amp;&amp; NeedRTCheck)</div><div class="line"><a name="l03987"></a><span class="lineno"> 3987</span>&#160;    NeedRTCheck = <span class="keyword">false</span>;</div><div class="line"><a name="l03988"></a><span class="lineno"> 3988</span>&#160;</div><div class="line"><a name="l03989"></a><span class="lineno"> 3989</span>&#160;  <span class="comment">// Check that we did not collect too many pointers or found an unsizeable</span></div><div class="line"><a name="l03990"></a><span class="lineno"> 3990</span>&#160;  <span class="comment">// pointer.</span></div><div class="line"><a name="l03991"></a><span class="lineno"> 3991</span>&#160;  <span class="keywordflow">if</span> (!CanDoRT || NumComparisons &gt; RuntimeMemoryCheckThreshold) {</div><div class="line"><a name="l03992"></a><span class="lineno"> 3992</span>&#160;    PtrRtCheck.reset();</div><div class="line"><a name="l03993"></a><span class="lineno"> 3993</span>&#160;    CanDoRT = <span class="keyword">false</span>;</div><div class="line"><a name="l03994"></a><span class="lineno"> 3994</span>&#160;  }</div><div class="line"><a name="l03995"></a><span class="lineno"> 3995</span>&#160;</div><div class="line"><a name="l03996"></a><span class="lineno"> 3996</span>&#160;  <span class="keywordflow">if</span> (CanDoRT) {</div><div class="line"><a name="l03997"></a><span class="lineno"> 3997</span>&#160;    <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;LV: We can perform a memory runtime check if needed.\n&quot;</span>);</div><div class="line"><a name="l03998"></a><span class="lineno"> 3998</span>&#160;  }</div><div class="line"><a name="l03999"></a><span class="lineno"> 3999</span>&#160;</div><div class="line"><a name="l04000"></a><span class="lineno"> 4000</span>&#160;  <span class="keywordflow">if</span> (NeedRTCheck &amp;&amp; !CanDoRT) {</div><div class="line"><a name="l04001"></a><span class="lineno"> 4001</span>&#160;    <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;LV: We can&#39;t vectorize because we can&#39;t find &quot;</span> &lt;&lt;</div><div class="line"><a name="l04002"></a><span class="lineno"> 4002</span>&#160;          <span class="stringliteral">&quot;the array bounds.\n&quot;</span>);</div><div class="line"><a name="l04003"></a><span class="lineno"> 4003</span>&#160;    PtrRtCheck.reset();</div><div class="line"><a name="l04004"></a><span class="lineno"> 4004</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l04005"></a><span class="lineno"> 4005</span>&#160;  }</div><div class="line"><a name="l04006"></a><span class="lineno"> 4006</span>&#160;</div><div class="line"><a name="l04007"></a><span class="lineno"> 4007</span>&#160;  PtrRtCheck.Need = NeedRTCheck;</div><div class="line"><a name="l04008"></a><span class="lineno"> 4008</span>&#160;</div><div class="line"><a name="l04009"></a><span class="lineno"> 4009</span>&#160;  <span class="keywordtype">bool</span> CanVecMem = <span class="keyword">true</span>;</div><div class="line"><a name="l04010"></a><span class="lineno"> 4010</span>&#160;  <span class="keywordflow">if</span> (Accesses.isDependencyCheckNeeded()) {</div><div class="line"><a name="l04011"></a><span class="lineno"> 4011</span>&#160;    <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;LV: Checking memory dependencies\n&quot;</span>);</div><div class="line"><a name="l04012"></a><span class="lineno"> 4012</span>&#160;    CanVecMem = DepChecker.areDepsSafe(DependentAccesses,</div><div class="line"><a name="l04013"></a><span class="lineno"> 4013</span>&#160;                                       Accesses.getDependenciesToCheck());</div><div class="line"><a name="l04014"></a><span class="lineno"> 4014</span>&#160;    MaxSafeDepDistBytes = DepChecker.getMaxSafeDepDistBytes();</div><div class="line"><a name="l04015"></a><span class="lineno"> 4015</span>&#160;</div><div class="line"><a name="l04016"></a><span class="lineno"> 4016</span>&#160;    <span class="keywordflow">if</span> (!CanVecMem &amp;&amp; DepChecker.shouldRetryWithRuntimeCheck()) {</div><div class="line"><a name="l04017"></a><span class="lineno"> 4017</span>&#160;      <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;LV: Retrying with memory checks\n&quot;</span>);</div><div class="line"><a name="l04018"></a><span class="lineno"> 4018</span>&#160;      NeedRTCheck = <span class="keyword">true</span>;</div><div class="line"><a name="l04019"></a><span class="lineno"> 4019</span>&#160;</div><div class="line"><a name="l04020"></a><span class="lineno"> 4020</span>&#160;      <span class="comment">// Clear the dependency checks. We assume they are not needed.</span></div><div class="line"><a name="l04021"></a><span class="lineno"> 4021</span>&#160;      Accesses.resetDepChecks();</div><div class="line"><a name="l04022"></a><span class="lineno"> 4022</span>&#160;</div><div class="line"><a name="l04023"></a><span class="lineno"> 4023</span>&#160;      PtrRtCheck.reset();</div><div class="line"><a name="l04024"></a><span class="lineno"> 4024</span>&#160;      PtrRtCheck.Need = <span class="keyword">true</span>;</div><div class="line"><a name="l04025"></a><span class="lineno"> 4025</span>&#160;</div><div class="line"><a name="l04026"></a><span class="lineno"> 4026</span>&#160;      CanDoRT = Accesses.canCheckPtrAtRT(PtrRtCheck, NumComparisons, SE,</div><div class="line"><a name="l04027"></a><span class="lineno"> 4027</span>&#160;                                         TheLoop, <span class="keyword">true</span>);</div><div class="line"><a name="l04028"></a><span class="lineno"> 4028</span>&#160;      <span class="comment">// Check that we did not collect too many pointers or found an unsizeable</span></div><div class="line"><a name="l04029"></a><span class="lineno"> 4029</span>&#160;      <span class="comment">// pointer.</span></div><div class="line"><a name="l04030"></a><span class="lineno"> 4030</span>&#160;      <span class="keywordflow">if</span> (!CanDoRT || NumComparisons &gt; RuntimeMemoryCheckThreshold) {</div><div class="line"><a name="l04031"></a><span class="lineno"> 4031</span>&#160;        <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;LV: Can&#39;t vectorize with memory checks\n&quot;</span>);</div><div class="line"><a name="l04032"></a><span class="lineno"> 4032</span>&#160;        PtrRtCheck.reset();</div><div class="line"><a name="l04033"></a><span class="lineno"> 4033</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l04034"></a><span class="lineno"> 4034</span>&#160;      }</div><div class="line"><a name="l04035"></a><span class="lineno"> 4035</span>&#160;</div><div class="line"><a name="l04036"></a><span class="lineno"> 4036</span>&#160;      CanVecMem = <span class="keyword">true</span>;</div><div class="line"><a name="l04037"></a><span class="lineno"> 4037</span>&#160;    }</div><div class="line"><a name="l04038"></a><span class="lineno"> 4038</span>&#160;  }</div><div class="line"><a name="l04039"></a><span class="lineno"> 4039</span>&#160;</div><div class="line"><a name="l04040"></a><span class="lineno"> 4040</span>&#160;  <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;LV: We&quot;</span> &lt;&lt; (NeedRTCheck ? <span class="stringliteral">&quot;&quot;</span> : <span class="stringliteral">&quot; don&#39;t&quot;</span>) &lt;&lt;</div><div class="line"><a name="l04041"></a><span class="lineno"> 4041</span>&#160;        <span class="stringliteral">&quot; need a runtime memory check.\n&quot;</span>);</div><div class="line"><a name="l04042"></a><span class="lineno"> 4042</span>&#160;</div><div class="line"><a name="l04043"></a><span class="lineno"> 4043</span>&#160;  <span class="keywordflow">return</span> CanVecMem;</div><div class="line"><a name="l04044"></a><span class="lineno"> 4044</span>&#160;}</div><div class="line"><a name="l04045"></a><span class="lineno"> 4045</span>&#160;</div><div class="line"><a name="l04046"></a><span class="lineno"><a class="line" href="LoopVectorize_8cpp.html#acd9035706d7098978089376079827aa3"> 4046</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="LoopVectorize_8cpp.html#acd9035706d7098978089376079827aa3">hasMultipleUsesOf</a>(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>,</div><div class="line"><a name="l04047"></a><span class="lineno"> 4047</span>&#160;                              <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;Instruction *, 8&gt;</a> &amp;Insts) {</div><div class="line"><a name="l04048"></a><span class="lineno"> 4048</span>&#160;  <span class="keywordtype">unsigned</span> NumUses = 0;</div><div class="line"><a name="l04049"></a><span class="lineno"> 4049</span>&#160;  <span class="keywordflow">for</span>(<a class="code" href="classllvm_1_1Use.html">User::op_iterator</a> <a class="code" href="classllvm_1_1Use.html">Use</a> = I-&gt;<a class="code" href="classllvm_1_1User.html#a2eeb1c7ed1cfe403f2ae0470e36c07e2">op_begin</a>(), E = I-&gt;<a class="code" href="classllvm_1_1User.html#af41f58e730804d10b91fcff39b035f74">op_end</a>(); <a class="code" href="classllvm_1_1Use.html">Use</a> != E; ++<a class="code" href="classllvm_1_1Use.html">Use</a>) {</div><div class="line"><a name="l04050"></a><span class="lineno"> 4050</span>&#160;    <span class="keywordflow">if</span> (Insts.<a class="code" href="classllvm_1_1SmallPtrSet.html#a2ced6343b8ad006a757059554bbf9f37">count</a>(dyn_cast&lt;Instruction&gt;(*<a class="code" href="classllvm_1_1Use.html">Use</a>)))</div><div class="line"><a name="l04051"></a><span class="lineno"> 4051</span>&#160;      ++NumUses;</div><div class="line"><a name="l04052"></a><span class="lineno"> 4052</span>&#160;    <span class="keywordflow">if</span> (NumUses &gt; 1)</div><div class="line"><a name="l04053"></a><span class="lineno"> 4053</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l04054"></a><span class="lineno"> 4054</span>&#160;  }</div><div class="line"><a name="l04055"></a><span class="lineno"> 4055</span>&#160;</div><div class="line"><a name="l04056"></a><span class="lineno"> 4056</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l04057"></a><span class="lineno"> 4057</span>&#160;}</div><div class="line"><a name="l04058"></a><span class="lineno"> 4058</span>&#160;</div><div class="line"><a name="l04059"></a><span class="lineno"><a class="line" href="LoopVectorize_8cpp.html#af650b172bfef38ac60047721430fe7d9"> 4059</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="LoopVectorize_8cpp.html#af650b172bfef38ac60047721430fe7d9">areAllUsesIn</a>(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;Instruction *, 8&gt;</a> &amp;Set) {</div><div class="line"><a name="l04060"></a><span class="lineno"> 4060</span>&#160;  <span class="keywordflow">for</span>(<a class="code" href="classllvm_1_1Use.html">User::op_iterator</a> <a class="code" href="classllvm_1_1Use.html">Use</a> = I-&gt;<a class="code" href="classllvm_1_1User.html#a2eeb1c7ed1cfe403f2ae0470e36c07e2">op_begin</a>(), E = I-&gt;<a class="code" href="classllvm_1_1User.html#af41f58e730804d10b91fcff39b035f74">op_end</a>(); <a class="code" href="classllvm_1_1Use.html">Use</a> != E; ++<a class="code" href="classllvm_1_1Use.html">Use</a>)</div><div class="line"><a name="l04061"></a><span class="lineno"> 4061</span>&#160;    <span class="keywordflow">if</span> (!Set.<a class="code" href="classllvm_1_1SmallPtrSet.html#a2ced6343b8ad006a757059554bbf9f37">count</a>(dyn_cast&lt;Instruction&gt;(*<a class="code" href="classllvm_1_1Use.html">Use</a>)))</div><div class="line"><a name="l04062"></a><span class="lineno"> 4062</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l04063"></a><span class="lineno"> 4063</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l04064"></a><span class="lineno"> 4064</span>&#160;}</div><div class="line"><a name="l04065"></a><span class="lineno"> 4065</span>&#160;</div><div class="line"><a name="l04066"></a><span class="lineno"> 4066</span>&#160;<span class="keywordtype">bool</span> LoopVectorizationLegality::AddReductionVar(<a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *Phi,</div><div class="line"><a name="l04067"></a><span class="lineno"> 4067</span>&#160;                                                ReductionKind <a class="code" href="namespacellvm_1_1EngineKind.html#a9df47239a42cd9621ac26d9ecbd57441">Kind</a>) {</div><div class="line"><a name="l04068"></a><span class="lineno"> 4068</span>&#160;  <span class="keywordflow">if</span> (Phi-&gt;<a class="code" href="classllvm_1_1PHINode.html#aa45f6c0433576e3858a6209a43750ad4">getNumIncomingValues</a>() != 2)</div><div class="line"><a name="l04069"></a><span class="lineno"> 4069</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l04070"></a><span class="lineno"> 4070</span>&#160;</div><div class="line"><a name="l04071"></a><span class="lineno"> 4071</span>&#160;  <span class="comment">// Reduction variables are only found in the loop header block.</span></div><div class="line"><a name="l04072"></a><span class="lineno"> 4072</span>&#160;  <span class="keywordflow">if</span> (Phi-&gt;<a class="code" href="classllvm_1_1Instruction.html#a9cd49851904f15060edb782ef4dd1b2d">getParent</a>() != TheLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#ac4f141a355e5898255f2cbc57c5b54c3">getHeader</a>())</div><div class="line"><a name="l04073"></a><span class="lineno"> 4073</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l04074"></a><span class="lineno"> 4074</span>&#160;</div><div class="line"><a name="l04075"></a><span class="lineno"> 4075</span>&#160;  <span class="comment">// Obtain the reduction start value from the value that comes from the loop</span></div><div class="line"><a name="l04076"></a><span class="lineno"> 4076</span>&#160;  <span class="comment">// preheader.</span></div><div class="line"><a name="l04077"></a><span class="lineno"> 4077</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *RdxStart = Phi-&gt;<a class="code" href="classllvm_1_1PHINode.html#a21960167f529265a1cb02ac1e8ad10f6">getIncomingValueForBlock</a>(TheLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a1bc74c76b876ad387293ecde0f21ed45">getLoopPreheader</a>());</div><div class="line"><a name="l04078"></a><span class="lineno"> 4078</span>&#160;</div><div class="line"><a name="l04079"></a><span class="lineno"> 4079</span>&#160;  <span class="comment">// ExitInstruction is the single value which is used outside the loop.</span></div><div class="line"><a name="l04080"></a><span class="lineno"> 4080</span>&#160;  <span class="comment">// We only allow for a single reduction value to be used outside the loop.</span></div><div class="line"><a name="l04081"></a><span class="lineno"> 4081</span>&#160;  <span class="comment">// This includes users of the reduction, variables (which form a cycle</span></div><div class="line"><a name="l04082"></a><span class="lineno"> 4082</span>&#160;  <span class="comment">// which ends in the phi node).</span></div><div class="line"><a name="l04083"></a><span class="lineno"> 4083</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *ExitInstruction = 0;</div><div class="line"><a name="l04084"></a><span class="lineno"> 4084</span>&#160;  <span class="comment">// Indicates that we found a reduction operation in our scan.</span></div><div class="line"><a name="l04085"></a><span class="lineno"> 4085</span>&#160;  <span class="keywordtype">bool</span> FoundReduxOp = <span class="keyword">false</span>;</div><div class="line"><a name="l04086"></a><span class="lineno"> 4086</span>&#160;</div><div class="line"><a name="l04087"></a><span class="lineno"> 4087</span>&#160;  <span class="comment">// We start with the PHI node and scan for all of the users of this</span></div><div class="line"><a name="l04088"></a><span class="lineno"> 4088</span>&#160;  <span class="comment">// instruction. All users must be instructions that can be used as reduction</span></div><div class="line"><a name="l04089"></a><span class="lineno"> 4089</span>&#160;  <span class="comment">// variables (such as ADD). We must have a single out-of-block user. The cycle</span></div><div class="line"><a name="l04090"></a><span class="lineno"> 4090</span>&#160;  <span class="comment">// must include the original PHI.</span></div><div class="line"><a name="l04091"></a><span class="lineno"> 4091</span>&#160;  <span class="keywordtype">bool</span> FoundStartPHI = <span class="keyword">false</span>;</div><div class="line"><a name="l04092"></a><span class="lineno"> 4092</span>&#160;</div><div class="line"><a name="l04093"></a><span class="lineno"> 4093</span>&#160;  <span class="comment">// To recognize min/max patterns formed by a icmp select sequence, we store</span></div><div class="line"><a name="l04094"></a><span class="lineno"> 4094</span>&#160;  <span class="comment">// the number of instruction we saw from the recognized min/max pattern,</span></div><div class="line"><a name="l04095"></a><span class="lineno"> 4095</span>&#160;  <span class="comment">//  to make sure we only see exactly the two instructions.</span></div><div class="line"><a name="l04096"></a><span class="lineno"> 4096</span>&#160;  <span class="keywordtype">unsigned</span> NumCmpSelectPatternInst = 0;</div><div class="line"><a name="l04097"></a><span class="lineno"> 4097</span>&#160;  ReductionInstDesc ReduxDesc(<span class="keyword">false</span>, 0);</div><div class="line"><a name="l04098"></a><span class="lineno"> 4098</span>&#160;</div><div class="line"><a name="l04099"></a><span class="lineno"> 4099</span>&#160;  <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;Instruction *, 8&gt;</a> VisitedInsts;</div><div class="line"><a name="l04100"></a><span class="lineno"> 4100</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Instruction *, 8&gt;</a> Worklist;</div><div class="line"><a name="l04101"></a><span class="lineno"> 4101</span>&#160;  Worklist.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(Phi);</div><div class="line"><a name="l04102"></a><span class="lineno"> 4102</span>&#160;  VisitedInsts.<a class="code" href="classllvm_1_1SmallPtrSet.html#a9b6dd0fc7a648a939e571246045b673e">insert</a>(Phi);</div><div class="line"><a name="l04103"></a><span class="lineno"> 4103</span>&#160;</div><div class="line"><a name="l04104"></a><span class="lineno"> 4104</span>&#160;  <span class="comment">// A value in the reduction can be used:</span></div><div class="line"><a name="l04105"></a><span class="lineno"> 4105</span>&#160;  <span class="comment">//  - By the reduction:</span></div><div class="line"><a name="l04106"></a><span class="lineno"> 4106</span>&#160;  <span class="comment">//      - Reduction operation:</span></div><div class="line"><a name="l04107"></a><span class="lineno"> 4107</span>&#160;  <span class="comment">//        - One use of reduction value (safe).</span></div><div class="line"><a name="l04108"></a><span class="lineno"> 4108</span>&#160;  <span class="comment">//        - Multiple use of reduction value (not safe).</span></div><div class="line"><a name="l04109"></a><span class="lineno"> 4109</span>&#160;  <span class="comment">//      - PHI:</span></div><div class="line"><a name="l04110"></a><span class="lineno"> 4110</span>&#160;  <span class="comment">//        - All uses of the PHI must be the reduction (safe).</span></div><div class="line"><a name="l04111"></a><span class="lineno"> 4111</span>&#160;  <span class="comment">//        - Otherwise, not safe.</span></div><div class="line"><a name="l04112"></a><span class="lineno"> 4112</span>&#160;  <span class="comment">//  - By one instruction outside of the loop (safe).</span></div><div class="line"><a name="l04113"></a><span class="lineno"> 4113</span>&#160;  <span class="comment">//  - By further instructions outside of the loop (not safe).</span></div><div class="line"><a name="l04114"></a><span class="lineno"> 4114</span>&#160;  <span class="comment">//  - By an instruction that is not part of the reduction (not safe).</span></div><div class="line"><a name="l04115"></a><span class="lineno"> 4115</span>&#160;  <span class="comment">//    This is either:</span></div><div class="line"><a name="l04116"></a><span class="lineno"> 4116</span>&#160;  <span class="comment">//      * An instruction type other than PHI or the reduction operation.</span></div><div class="line"><a name="l04117"></a><span class="lineno"> 4117</span>&#160;  <span class="comment">//      * A PHI in the header other than the initial PHI.</span></div><div class="line"><a name="l04118"></a><span class="lineno"> 4118</span>&#160;  <span class="keywordflow">while</span> (!Worklist.<a class="code" href="classllvm_1_1SmallVectorBase.html#a8a8df4d85555c7954a95f86080cd3b64">empty</a>()) {</div><div class="line"><a name="l04119"></a><span class="lineno"> 4119</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *Cur = Worklist.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#acd9e771a3296c6b24146955754620557">back</a>();</div><div class="line"><a name="l04120"></a><span class="lineno"> 4120</span>&#160;    Worklist.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#a1f2303df9bbee2233c11d61c2f6f7930">pop_back</a>();</div><div class="line"><a name="l04121"></a><span class="lineno"> 4121</span>&#160;</div><div class="line"><a name="l04122"></a><span class="lineno"> 4122</span>&#160;    <span class="comment">// No Users.</span></div><div class="line"><a name="l04123"></a><span class="lineno"> 4123</span>&#160;    <span class="comment">// If the instruction has no users then this is a broken chain and can&#39;t be</span></div><div class="line"><a name="l04124"></a><span class="lineno"> 4124</span>&#160;    <span class="comment">// a reduction variable.</span></div><div class="line"><a name="l04125"></a><span class="lineno"> 4125</span>&#160;    <span class="keywordflow">if</span> (Cur-&gt;<a class="code" href="classllvm_1_1Value.html#ac38c53f76ef532f91f1666c8a87370e9">use_empty</a>())</div><div class="line"><a name="l04126"></a><span class="lineno"> 4126</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l04127"></a><span class="lineno"> 4127</span>&#160;</div><div class="line"><a name="l04128"></a><span class="lineno"> 4128</span>&#160;    <span class="keywordtype">bool</span> IsAPhi = isa&lt;PHINode&gt;(Cur);</div><div class="line"><a name="l04129"></a><span class="lineno"> 4129</span>&#160;</div><div class="line"><a name="l04130"></a><span class="lineno"> 4130</span>&#160;    <span class="comment">// A header PHI use other than the original PHI.</span></div><div class="line"><a name="l04131"></a><span class="lineno"> 4131</span>&#160;    <span class="keywordflow">if</span> (Cur != Phi &amp;&amp; IsAPhi &amp;&amp; Cur-&gt;<a class="code" href="classllvm_1_1Instruction.html#a9cd49851904f15060edb782ef4dd1b2d">getParent</a>() == Phi-&gt;<a class="code" href="classllvm_1_1Instruction.html#a9cd49851904f15060edb782ef4dd1b2d">getParent</a>())</div><div class="line"><a name="l04132"></a><span class="lineno"> 4132</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l04133"></a><span class="lineno"> 4133</span>&#160;</div><div class="line"><a name="l04134"></a><span class="lineno"> 4134</span>&#160;    <span class="comment">// Reductions of instructions such as Div, and Sub is only possible if the</span></div><div class="line"><a name="l04135"></a><span class="lineno"> 4135</span>&#160;    <span class="comment">// LHS is the reduction variable.</span></div><div class="line"><a name="l04136"></a><span class="lineno"> 4136</span>&#160;    <span class="keywordflow">if</span> (!Cur-&gt;<a class="code" href="classllvm_1_1Instruction.html#a1c2048f254df730c4de1643ec791ddf9">isCommutative</a>() &amp;&amp; !IsAPhi &amp;&amp; !isa&lt;SelectInst&gt;(Cur) &amp;&amp;</div><div class="line"><a name="l04137"></a><span class="lineno"> 4137</span>&#160;        !isa&lt;ICmpInst&gt;(Cur) &amp;&amp; !isa&lt;FCmpInst&gt;(Cur) &amp;&amp;</div><div class="line"><a name="l04138"></a><span class="lineno"> 4138</span>&#160;        !VisitedInsts.<a class="code" href="classllvm_1_1SmallPtrSet.html#a2ced6343b8ad006a757059554bbf9f37">count</a>(dyn_cast&lt;Instruction&gt;(Cur-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0))))</div><div class="line"><a name="l04139"></a><span class="lineno"> 4139</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l04140"></a><span class="lineno"> 4140</span>&#160;</div><div class="line"><a name="l04141"></a><span class="lineno"> 4141</span>&#160;    <span class="comment">// Any reduction instruction must be of one of the allowed kinds.</span></div><div class="line"><a name="l04142"></a><span class="lineno"> 4142</span>&#160;    ReduxDesc = isReductionInstr(Cur, Kind, ReduxDesc);</div><div class="line"><a name="l04143"></a><span class="lineno"> 4143</span>&#160;    <span class="keywordflow">if</span> (!ReduxDesc.IsReduction)</div><div class="line"><a name="l04144"></a><span class="lineno"> 4144</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l04145"></a><span class="lineno"> 4145</span>&#160;</div><div class="line"><a name="l04146"></a><span class="lineno"> 4146</span>&#160;    <span class="comment">// A reduction operation must only have one use of the reduction value.</span></div><div class="line"><a name="l04147"></a><span class="lineno"> 4147</span>&#160;    <span class="keywordflow">if</span> (!IsAPhi &amp;&amp; Kind != RK_IntegerMinMax &amp;&amp; Kind != RK_FloatMinMax &amp;&amp;</div><div class="line"><a name="l04148"></a><span class="lineno"> 4148</span>&#160;        <a class="code" href="LoopVectorize_8cpp.html#acd9035706d7098978089376079827aa3">hasMultipleUsesOf</a>(Cur, VisitedInsts))</div><div class="line"><a name="l04149"></a><span class="lineno"> 4149</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l04150"></a><span class="lineno"> 4150</span>&#160;</div><div class="line"><a name="l04151"></a><span class="lineno"> 4151</span>&#160;    <span class="comment">// All inputs to a PHI node must be a reduction value.</span></div><div class="line"><a name="l04152"></a><span class="lineno"> 4152</span>&#160;    <span class="keywordflow">if</span>(IsAPhi &amp;&amp; Cur != Phi &amp;&amp; !<a class="code" href="LoopVectorize_8cpp.html#af650b172bfef38ac60047721430fe7d9">areAllUsesIn</a>(Cur, VisitedInsts))</div><div class="line"><a name="l04153"></a><span class="lineno"> 4153</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l04154"></a><span class="lineno"> 4154</span>&#160;</div><div class="line"><a name="l04155"></a><span class="lineno"> 4155</span>&#160;    <span class="keywordflow">if</span> (Kind == RK_IntegerMinMax &amp;&amp; (isa&lt;ICmpInst&gt;(Cur) ||</div><div class="line"><a name="l04156"></a><span class="lineno"> 4156</span>&#160;                                     isa&lt;SelectInst&gt;(Cur)))</div><div class="line"><a name="l04157"></a><span class="lineno"> 4157</span>&#160;      ++NumCmpSelectPatternInst;</div><div class="line"><a name="l04158"></a><span class="lineno"> 4158</span>&#160;    <span class="keywordflow">if</span> (Kind == RK_FloatMinMax &amp;&amp; (isa&lt;FCmpInst&gt;(Cur) ||</div><div class="line"><a name="l04159"></a><span class="lineno"> 4159</span>&#160;                                   isa&lt;SelectInst&gt;(Cur)))</div><div class="line"><a name="l04160"></a><span class="lineno"> 4160</span>&#160;      ++NumCmpSelectPatternInst;</div><div class="line"><a name="l04161"></a><span class="lineno"> 4161</span>&#160;</div><div class="line"><a name="l04162"></a><span class="lineno"> 4162</span>&#160;    <span class="comment">// Check  whether we found a reduction operator.</span></div><div class="line"><a name="l04163"></a><span class="lineno"> 4163</span>&#160;    FoundReduxOp |= !IsAPhi;</div><div class="line"><a name="l04164"></a><span class="lineno"> 4164</span>&#160;</div><div class="line"><a name="l04165"></a><span class="lineno"> 4165</span>&#160;    <span class="comment">// Process users of current instruction. Push non PHI nodes after PHI nodes</span></div><div class="line"><a name="l04166"></a><span class="lineno"> 4166</span>&#160;    <span class="comment">// onto the stack. This way we are going to have seen all inputs to PHI</span></div><div class="line"><a name="l04167"></a><span class="lineno"> 4167</span>&#160;    <span class="comment">// nodes once we get to them.</span></div><div class="line"><a name="l04168"></a><span class="lineno"> 4168</span>&#160;    <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Instruction *, 8&gt;</a> NonPHIs;</div><div class="line"><a name="l04169"></a><span class="lineno"> 4169</span>&#160;    <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Instruction *, 8&gt;</a> PHIs;</div><div class="line"><a name="l04170"></a><span class="lineno"> 4170</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1value__use__iterator.html">Value::use_iterator</a> UI = Cur-&gt;<a class="code" href="classllvm_1_1Value.html#a413abcab8dbc3900fc2fde96a5d8fca6">use_begin</a>(), E = Cur-&gt;<a class="code" href="classllvm_1_1Value.html#ad86469939d2a8bdd4169be9403b89f5a">use_end</a>(); UI != E;</div><div class="line"><a name="l04171"></a><span class="lineno"> 4171</span>&#160;         ++UI) {</div><div class="line"><a name="l04172"></a><span class="lineno"> 4172</span>&#160;      <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *Usr = cast&lt;Instruction&gt;(*UI);</div><div class="line"><a name="l04173"></a><span class="lineno"> 4173</span>&#160;</div><div class="line"><a name="l04174"></a><span class="lineno"> 4174</span>&#160;      <span class="comment">// Check if we found the exit user.</span></div><div class="line"><a name="l04175"></a><span class="lineno"> 4175</span>&#160;      <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *Parent = Usr-&gt;<a class="code" href="classllvm_1_1Instruction.html#a9cd49851904f15060edb782ef4dd1b2d">getParent</a>();</div><div class="line"><a name="l04176"></a><span class="lineno"> 4176</span>&#160;      <span class="keywordflow">if</span> (!TheLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a92a38e2e3412bde7fd2b71db212b61aa">contains</a>(Parent)) {</div><div class="line"><a name="l04177"></a><span class="lineno"> 4177</span>&#160;        <span class="comment">// Exit if you find multiple outside users or if the header phi node is</span></div><div class="line"><a name="l04178"></a><span class="lineno"> 4178</span>&#160;        <span class="comment">// being used. In this case the user uses the value of the previous</span></div><div class="line"><a name="l04179"></a><span class="lineno"> 4179</span>&#160;        <span class="comment">// iteration, in which case we would loose &quot;VF-1&quot; iterations of the</span></div><div class="line"><a name="l04180"></a><span class="lineno"> 4180</span>&#160;        <span class="comment">// reduction operation if we vectorize.</span></div><div class="line"><a name="l04181"></a><span class="lineno"> 4181</span>&#160;        <span class="keywordflow">if</span> (ExitInstruction != 0 || Cur == Phi)</div><div class="line"><a name="l04182"></a><span class="lineno"> 4182</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l04183"></a><span class="lineno"> 4183</span>&#160;</div><div class="line"><a name="l04184"></a><span class="lineno"> 4184</span>&#160;        <span class="comment">// The instruction used by an outside user must be the last instruction</span></div><div class="line"><a name="l04185"></a><span class="lineno"> 4185</span>&#160;        <span class="comment">// before we feed back to the reduction phi. Otherwise, we loose VF-1</span></div><div class="line"><a name="l04186"></a><span class="lineno"> 4186</span>&#160;        <span class="comment">// operations on the value.</span></div><div class="line"><a name="l04187"></a><span class="lineno"> 4187</span>&#160;        <span class="keywordflow">if</span> (std::find(Phi-&gt;<a class="code" href="classllvm_1_1User.html#a2eeb1c7ed1cfe403f2ae0470e36c07e2">op_begin</a>(), Phi-&gt;<a class="code" href="classllvm_1_1User.html#af41f58e730804d10b91fcff39b035f74">op_end</a>(), Cur) == Phi-&gt;<a class="code" href="classllvm_1_1User.html#af41f58e730804d10b91fcff39b035f74">op_end</a>())</div><div class="line"><a name="l04188"></a><span class="lineno"> 4188</span>&#160;         <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l04189"></a><span class="lineno"> 4189</span>&#160;</div><div class="line"><a name="l04190"></a><span class="lineno"> 4190</span>&#160;        ExitInstruction = Cur;</div><div class="line"><a name="l04191"></a><span class="lineno"> 4191</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l04192"></a><span class="lineno"> 4192</span>&#160;      }</div><div class="line"><a name="l04193"></a><span class="lineno"> 4193</span>&#160;</div><div class="line"><a name="l04194"></a><span class="lineno"> 4194</span>&#160;      <span class="comment">// Process instructions only once (termination).</span></div><div class="line"><a name="l04195"></a><span class="lineno"> 4195</span>&#160;      <span class="keywordflow">if</span> (VisitedInsts.<a class="code" href="classllvm_1_1SmallPtrSet.html#a9b6dd0fc7a648a939e571246045b673e">insert</a>(Usr)) {</div><div class="line"><a name="l04196"></a><span class="lineno"> 4196</span>&#160;        <span class="keywordflow">if</span> (isa&lt;PHINode&gt;(Usr))</div><div class="line"><a name="l04197"></a><span class="lineno"> 4197</span>&#160;          PHIs.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(Usr);</div><div class="line"><a name="l04198"></a><span class="lineno"> 4198</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l04199"></a><span class="lineno"> 4199</span>&#160;          NonPHIs.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(Usr);</div><div class="line"><a name="l04200"></a><span class="lineno"> 4200</span>&#160;      }</div><div class="line"><a name="l04201"></a><span class="lineno"> 4201</span>&#160;      <span class="comment">// Remember that we completed the cycle.</span></div><div class="line"><a name="l04202"></a><span class="lineno"> 4202</span>&#160;      <span class="keywordflow">if</span> (Usr == Phi)</div><div class="line"><a name="l04203"></a><span class="lineno"> 4203</span>&#160;        FoundStartPHI = <span class="keyword">true</span>;</div><div class="line"><a name="l04204"></a><span class="lineno"> 4204</span>&#160;    }</div><div class="line"><a name="l04205"></a><span class="lineno"> 4205</span>&#160;    Worklist.<a class="code" href="classllvm_1_1SmallVectorImpl.html#a669d55980a7d4b6307b94596deeb0b1f">append</a>(PHIs.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#a8a045d250952c0867382a9840ee18fdf">begin</a>(), PHIs.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#a075e34e98605d0e7c289763a104869ac">end</a>());</div><div class="line"><a name="l04206"></a><span class="lineno"> 4206</span>&#160;    Worklist.<a class="code" href="classllvm_1_1SmallVectorImpl.html#a669d55980a7d4b6307b94596deeb0b1f">append</a>(NonPHIs.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#a8a045d250952c0867382a9840ee18fdf">begin</a>(), NonPHIs.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#a075e34e98605d0e7c289763a104869ac">end</a>());</div><div class="line"><a name="l04207"></a><span class="lineno"> 4207</span>&#160;  }</div><div class="line"><a name="l04208"></a><span class="lineno"> 4208</span>&#160;</div><div class="line"><a name="l04209"></a><span class="lineno"> 4209</span>&#160;  <span class="comment">// This means we have seen one but not the other instruction of the</span></div><div class="line"><a name="l04210"></a><span class="lineno"> 4210</span>&#160;  <span class="comment">// pattern or more than just a select and cmp.</span></div><div class="line"><a name="l04211"></a><span class="lineno"> 4211</span>&#160;  <span class="keywordflow">if</span> ((Kind == RK_IntegerMinMax || Kind == RK_FloatMinMax) &amp;&amp;</div><div class="line"><a name="l04212"></a><span class="lineno"> 4212</span>&#160;      NumCmpSelectPatternInst != 2)</div><div class="line"><a name="l04213"></a><span class="lineno"> 4213</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l04214"></a><span class="lineno"> 4214</span>&#160;</div><div class="line"><a name="l04215"></a><span class="lineno"> 4215</span>&#160;  <span class="keywordflow">if</span> (!FoundStartPHI || !FoundReduxOp || !ExitInstruction)</div><div class="line"><a name="l04216"></a><span class="lineno"> 4216</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l04217"></a><span class="lineno"> 4217</span>&#160;</div><div class="line"><a name="l04218"></a><span class="lineno"> 4218</span>&#160;  <span class="comment">// We found a reduction var if we have reached the original phi node and we</span></div><div class="line"><a name="l04219"></a><span class="lineno"> 4219</span>&#160;  <span class="comment">// only have a single instruction with out-of-loop users.</span></div><div class="line"><a name="l04220"></a><span class="lineno"> 4220</span>&#160;</div><div class="line"><a name="l04221"></a><span class="lineno"> 4221</span>&#160;  <span class="comment">// This instruction is allowed to have out-of-loop users.</span></div><div class="line"><a name="l04222"></a><span class="lineno"> 4222</span>&#160;  AllowedExit.insert(ExitInstruction);</div><div class="line"><a name="l04223"></a><span class="lineno"> 4223</span>&#160;</div><div class="line"><a name="l04224"></a><span class="lineno"> 4224</span>&#160;  <span class="comment">// Save the description of this reduction variable.</span></div><div class="line"><a name="l04225"></a><span class="lineno"> 4225</span>&#160;  ReductionDescriptor RD(RdxStart, ExitInstruction, Kind,</div><div class="line"><a name="l04226"></a><span class="lineno"> 4226</span>&#160;                         ReduxDesc.MinMaxKind);</div><div class="line"><a name="l04227"></a><span class="lineno"> 4227</span>&#160;  Reductions[Phi] = RD;</div><div class="line"><a name="l04228"></a><span class="lineno"> 4228</span>&#160;  <span class="comment">// We&#39;ve ended the cycle. This is a reduction variable if we have an</span></div><div class="line"><a name="l04229"></a><span class="lineno"> 4229</span>&#160;  <span class="comment">// outside user and it has a binary op.</span></div><div class="line"><a name="l04230"></a><span class="lineno"> 4230</span>&#160;</div><div class="line"><a name="l04231"></a><span class="lineno"> 4231</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l04232"></a><span class="lineno"> 4232</span>&#160;}</div><div class="line"><a name="l04233"></a><span class="lineno"> 4233</span>&#160;<span class="comment"></span></div><div class="line"><a name="l04234"></a><span class="lineno"> 4234</span>&#160;<span class="comment">/// Returns true if the instruction is a Select(ICmp(X, Y), X, Y) instruction</span></div><div class="line"><a name="l04235"></a><span class="lineno"> 4235</span>&#160;<span class="comment">/// pattern corresponding to a min(X, Y) or max(X, Y).</span></div><div class="line"><a name="l04236"></a><span class="lineno"> 4236</span>&#160;<span class="comment"></span>LoopVectorizationLegality::ReductionInstDesc</div><div class="line"><a name="l04237"></a><span class="lineno"> 4237</span>&#160;LoopVectorizationLegality::isMinMaxSelectCmpPattern(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>,</div><div class="line"><a name="l04238"></a><span class="lineno"> 4238</span>&#160;                                                    ReductionInstDesc &amp;Prev) {</div><div class="line"><a name="l04239"></a><span class="lineno"> 4239</span>&#160;</div><div class="line"><a name="l04240"></a><span class="lineno"> 4240</span>&#160;  assert((isa&lt;ICmpInst&gt;(I) || isa&lt;FCmpInst&gt;(I) || isa&lt;SelectInst&gt;(I)) &amp;&amp;</div><div class="line"><a name="l04241"></a><span class="lineno"> 4241</span>&#160;         <span class="stringliteral">&quot;Expect a select instruction&quot;</span>);</div><div class="line"><a name="l04242"></a><span class="lineno"> 4242</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *Cmp = 0;</div><div class="line"><a name="l04243"></a><span class="lineno"> 4243</span>&#160;  <a class="code" href="classllvm_1_1SelectInst.html">SelectInst</a> *<a class="code" href="namespacellvm_1_1MCID.html#a8035044d40d3758eb45b65dce69dc90ba32dbd2c72a98eaee90e3ad5ef7b5af16">Select</a> = 0;</div><div class="line"><a name="l04244"></a><span class="lineno"> 4244</span>&#160;</div><div class="line"><a name="l04245"></a><span class="lineno"> 4245</span>&#160;  <span class="comment">// We must handle the select(cmp()) as a single instruction. Advance to the</span></div><div class="line"><a name="l04246"></a><span class="lineno"> 4246</span>&#160;  <span class="comment">// select.</span></div><div class="line"><a name="l04247"></a><span class="lineno"> 4247</span>&#160;  <span class="keywordflow">if</span> ((Cmp = dyn_cast&lt;ICmpInst&gt;(I)) || (Cmp = dyn_cast&lt;FCmpInst&gt;(I))) {</div><div class="line"><a name="l04248"></a><span class="lineno"> 4248</span>&#160;    <span class="keywordflow">if</span> (!Cmp-&gt;<a class="code" href="classllvm_1_1Value.html#a085b82f074c28030fb8e194377ed2d0c">hasOneUse</a>() || !(Select = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1SelectInst.html">SelectInst</a>&gt;(*I-&gt;<a class="code" href="classllvm_1_1Value.html#a413abcab8dbc3900fc2fde96a5d8fca6">use_begin</a>())))</div><div class="line"><a name="l04249"></a><span class="lineno"> 4249</span>&#160;      <span class="keywordflow">return</span> ReductionInstDesc(<span class="keyword">false</span>, I);</div><div class="line"><a name="l04250"></a><span class="lineno"> 4250</span>&#160;    <span class="keywordflow">return</span> ReductionInstDesc(Select, Prev.MinMaxKind);</div><div class="line"><a name="l04251"></a><span class="lineno"> 4251</span>&#160;  }</div><div class="line"><a name="l04252"></a><span class="lineno"> 4252</span>&#160;</div><div class="line"><a name="l04253"></a><span class="lineno"> 4253</span>&#160;  <span class="comment">// Only handle single use cases for now.</span></div><div class="line"><a name="l04254"></a><span class="lineno"> 4254</span>&#160;  <span class="keywordflow">if</span> (!(Select = dyn_cast&lt;SelectInst&gt;(I)))</div><div class="line"><a name="l04255"></a><span class="lineno"> 4255</span>&#160;    <span class="keywordflow">return</span> ReductionInstDesc(<span class="keyword">false</span>, I);</div><div class="line"><a name="l04256"></a><span class="lineno"> 4256</span>&#160;  <span class="keywordflow">if</span> (!(Cmp = dyn_cast&lt;ICmpInst&gt;(I-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0))) &amp;&amp;</div><div class="line"><a name="l04257"></a><span class="lineno"> 4257</span>&#160;      !(Cmp = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1FCmpInst.html">FCmpInst</a>&gt;(I-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0))))</div><div class="line"><a name="l04258"></a><span class="lineno"> 4258</span>&#160;    <span class="keywordflow">return</span> ReductionInstDesc(<span class="keyword">false</span>, I);</div><div class="line"><a name="l04259"></a><span class="lineno"> 4259</span>&#160;  <span class="keywordflow">if</span> (!Cmp-&gt;<a class="code" href="classllvm_1_1Value.html#a085b82f074c28030fb8e194377ed2d0c">hasOneUse</a>())</div><div class="line"><a name="l04260"></a><span class="lineno"> 4260</span>&#160;    <span class="keywordflow">return</span> ReductionInstDesc(<span class="keyword">false</span>, I);</div><div class="line"><a name="l04261"></a><span class="lineno"> 4261</span>&#160;</div><div class="line"><a name="l04262"></a><span class="lineno"> 4262</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *CmpLeft;</div><div class="line"><a name="l04263"></a><span class="lineno"> 4263</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *CmpRight;</div><div class="line"><a name="l04264"></a><span class="lineno"> 4264</span>&#160;</div><div class="line"><a name="l04265"></a><span class="lineno"> 4265</span>&#160;  <span class="comment">// Look for a min/max pattern.</span></div><div class="line"><a name="l04266"></a><span class="lineno"> 4266</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1PatternMatch.html#adc571425e9aecccf7ebf5fcc3c678d94">m_UMin</a>(<a class="code" href="namespacellvm_1_1PatternMatch.html#a24bca8838396aa81b87de8e7ac774b19">m_Value</a>(CmpLeft), <a class="code" href="namespacellvm_1_1PatternMatch.html#a24bca8838396aa81b87de8e7ac774b19">m_Value</a>(CmpRight)).match(Select))</div><div class="line"><a name="l04267"></a><span class="lineno"> 4267</span>&#160;    <span class="keywordflow">return</span> ReductionInstDesc(Select, MRK_UIntMin);</div><div class="line"><a name="l04268"></a><span class="lineno"> 4268</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1PatternMatch.html#ae5a9f5c71425f38b8874296c380567ad">m_UMax</a>(<a class="code" href="namespacellvm_1_1PatternMatch.html#a24bca8838396aa81b87de8e7ac774b19">m_Value</a>(CmpLeft), <a class="code" href="namespacellvm_1_1PatternMatch.html#a24bca8838396aa81b87de8e7ac774b19">m_Value</a>(CmpRight)).match(Select))</div><div class="line"><a name="l04269"></a><span class="lineno"> 4269</span>&#160;    <span class="keywordflow">return</span> ReductionInstDesc(Select, MRK_UIntMax);</div><div class="line"><a name="l04270"></a><span class="lineno"> 4270</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1PatternMatch.html#a38a6a25e425f94c9836dda96f3718593">m_SMax</a>(<a class="code" href="namespacellvm_1_1PatternMatch.html#a24bca8838396aa81b87de8e7ac774b19">m_Value</a>(CmpLeft), <a class="code" href="namespacellvm_1_1PatternMatch.html#a24bca8838396aa81b87de8e7ac774b19">m_Value</a>(CmpRight)).match(Select))</div><div class="line"><a name="l04271"></a><span class="lineno"> 4271</span>&#160;    <span class="keywordflow">return</span> ReductionInstDesc(Select, MRK_SIntMax);</div><div class="line"><a name="l04272"></a><span class="lineno"> 4272</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1PatternMatch.html#af16a6c9336ca2a17389ea709b45fe7f5">m_SMin</a>(<a class="code" href="namespacellvm_1_1PatternMatch.html#a24bca8838396aa81b87de8e7ac774b19">m_Value</a>(CmpLeft), <a class="code" href="namespacellvm_1_1PatternMatch.html#a24bca8838396aa81b87de8e7ac774b19">m_Value</a>(CmpRight)).match(Select))</div><div class="line"><a name="l04273"></a><span class="lineno"> 4273</span>&#160;    <span class="keywordflow">return</span> ReductionInstDesc(Select, MRK_SIntMin);</div><div class="line"><a name="l04274"></a><span class="lineno"> 4274</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1PatternMatch.html#aa437a212f5c7987d6b0e6cf722e25a2e">m_OrdFMin</a>(<a class="code" href="namespacellvm_1_1PatternMatch.html#a24bca8838396aa81b87de8e7ac774b19">m_Value</a>(CmpLeft), <a class="code" href="namespacellvm_1_1PatternMatch.html#a24bca8838396aa81b87de8e7ac774b19">m_Value</a>(CmpRight)).match(Select))</div><div class="line"><a name="l04275"></a><span class="lineno"> 4275</span>&#160;    <span class="keywordflow">return</span> ReductionInstDesc(Select, MRK_FloatMin);</div><div class="line"><a name="l04276"></a><span class="lineno"> 4276</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1PatternMatch.html#a235364424b2c4c8261f4030681d9630b">m_OrdFMax</a>(<a class="code" href="namespacellvm_1_1PatternMatch.html#a24bca8838396aa81b87de8e7ac774b19">m_Value</a>(CmpLeft), <a class="code" href="namespacellvm_1_1PatternMatch.html#a24bca8838396aa81b87de8e7ac774b19">m_Value</a>(CmpRight)).match(Select))</div><div class="line"><a name="l04277"></a><span class="lineno"> 4277</span>&#160;    <span class="keywordflow">return</span> ReductionInstDesc(Select, MRK_FloatMax);</div><div class="line"><a name="l04278"></a><span class="lineno"> 4278</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1PatternMatch.html#a22ec1b0d7fdb5ccfaa26c65373d5f362">m_UnordFMin</a>(<a class="code" href="namespacellvm_1_1PatternMatch.html#a24bca8838396aa81b87de8e7ac774b19">m_Value</a>(CmpLeft), <a class="code" href="namespacellvm_1_1PatternMatch.html#a24bca8838396aa81b87de8e7ac774b19">m_Value</a>(CmpRight)).match(Select))</div><div class="line"><a name="l04279"></a><span class="lineno"> 4279</span>&#160;    <span class="keywordflow">return</span> ReductionInstDesc(Select, MRK_FloatMin);</div><div class="line"><a name="l04280"></a><span class="lineno"> 4280</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1PatternMatch.html#ac043191f36a8e63baf22e9398394cff9">m_UnordFMax</a>(<a class="code" href="namespacellvm_1_1PatternMatch.html#a24bca8838396aa81b87de8e7ac774b19">m_Value</a>(CmpLeft), <a class="code" href="namespacellvm_1_1PatternMatch.html#a24bca8838396aa81b87de8e7ac774b19">m_Value</a>(CmpRight)).match(Select))</div><div class="line"><a name="l04281"></a><span class="lineno"> 4281</span>&#160;    <span class="keywordflow">return</span> ReductionInstDesc(Select, MRK_FloatMax);</div><div class="line"><a name="l04282"></a><span class="lineno"> 4282</span>&#160;</div><div class="line"><a name="l04283"></a><span class="lineno"> 4283</span>&#160;  <span class="keywordflow">return</span> ReductionInstDesc(<span class="keyword">false</span>, I);</div><div class="line"><a name="l04284"></a><span class="lineno"> 4284</span>&#160;}</div><div class="line"><a name="l04285"></a><span class="lineno"> 4285</span>&#160;</div><div class="line"><a name="l04286"></a><span class="lineno"> 4286</span>&#160;LoopVectorizationLegality::ReductionInstDesc</div><div class="line"><a name="l04287"></a><span class="lineno"> 4287</span>&#160;LoopVectorizationLegality::isReductionInstr(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *I,</div><div class="line"><a name="l04288"></a><span class="lineno"> 4288</span>&#160;                                            ReductionKind Kind,</div><div class="line"><a name="l04289"></a><span class="lineno"> 4289</span>&#160;                                            ReductionInstDesc &amp;Prev) {</div><div class="line"><a name="l04290"></a><span class="lineno"> 4290</span>&#160;  <span class="keywordtype">bool</span> FP = I-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a40113570b0c52a18c34cabed8359e2c8">isFloatingPointTy</a>();</div><div class="line"><a name="l04291"></a><span class="lineno"> 4291</span>&#160;  <span class="keywordtype">bool</span> FastMath = (FP &amp;&amp; I-&gt;<a class="code" href="classllvm_1_1Instruction.html#a1c2048f254df730c4de1643ec791ddf9">isCommutative</a>() &amp;&amp; I-&gt;<a class="code" href="classllvm_1_1Instruction.html#aa113b8a9ef3de9c2f075a046ad658717">isAssociative</a>());</div><div class="line"><a name="l04292"></a><span class="lineno"> 4292</span>&#160;  <span class="keywordflow">switch</span> (I-&gt;<a class="code" href="classllvm_1_1Instruction.html#a021bb7c9aad6003fe8089f6327356c6c">getOpcode</a>()) {</div><div class="line"><a name="l04293"></a><span class="lineno"> 4293</span>&#160;  <span class="keywordflow">default</span>:</div><div class="line"><a name="l04294"></a><span class="lineno"> 4294</span>&#160;    <span class="keywordflow">return</span> ReductionInstDesc(<span class="keyword">false</span>, I);</div><div class="line"><a name="l04295"></a><span class="lineno"> 4295</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1TargetOpcode.html#a348d4259b5fa6a8ecfe94e7ae512e1a8ae41f9ca68ba5e8b9613cea03652ebd72">Instruction::PHI</a>:</div><div class="line"><a name="l04296"></a><span class="lineno"> 4296</span>&#160;      <span class="keywordflow">if</span> (FP &amp;&amp; (Kind != RK_FloatMult &amp;&amp; Kind != RK_FloatAdd &amp;&amp;</div><div class="line"><a name="l04297"></a><span class="lineno"> 4297</span>&#160;                 Kind != RK_FloatMinMax))</div><div class="line"><a name="l04298"></a><span class="lineno"> 4298</span>&#160;        <span class="keywordflow">return</span> ReductionInstDesc(<span class="keyword">false</span>, I);</div><div class="line"><a name="l04299"></a><span class="lineno"> 4299</span>&#160;    <span class="keywordflow">return</span> ReductionInstDesc(I, Prev.MinMaxKind);</div><div class="line"><a name="l04300"></a><span class="lineno"> 4300</span>&#160;  <span class="keywordflow">case</span> Instruction::Sub:</div><div class="line"><a name="l04301"></a><span class="lineno"> 4301</span>&#160;  <span class="keywordflow">case</span> Instruction::Add:</div><div class="line"><a name="l04302"></a><span class="lineno"> 4302</span>&#160;    <span class="keywordflow">return</span> ReductionInstDesc(Kind == RK_IntegerAdd, I);</div><div class="line"><a name="l04303"></a><span class="lineno"> 4303</span>&#160;  <span class="keywordflow">case</span> Instruction::Mul:</div><div class="line"><a name="l04304"></a><span class="lineno"> 4304</span>&#160;    <span class="keywordflow">return</span> ReductionInstDesc(Kind == RK_IntegerMult, I);</div><div class="line"><a name="l04305"></a><span class="lineno"> 4305</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1APIntOps.html#a684cfe02c582e8d75cd6d457e63e6c25">Instruction::And</a>:</div><div class="line"><a name="l04306"></a><span class="lineno"> 4306</span>&#160;    <span class="keywordflow">return</span> ReductionInstDesc(Kind == RK_IntegerAnd, I);</div><div class="line"><a name="l04307"></a><span class="lineno"> 4307</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1APIntOps.html#a22f056804d2b9882f74adc905872bc39">Instruction::Or</a>:</div><div class="line"><a name="l04308"></a><span class="lineno"> 4308</span>&#160;    <span class="keywordflow">return</span> ReductionInstDesc(Kind == RK_IntegerOr, I);</div><div class="line"><a name="l04309"></a><span class="lineno"> 4309</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1APIntOps.html#afc7c4d88d09cba0c5e920f8a3a3ace55">Instruction::Xor</a>:</div><div class="line"><a name="l04310"></a><span class="lineno"> 4310</span>&#160;    <span class="keywordflow">return</span> ReductionInstDesc(Kind == RK_IntegerXor, I);</div><div class="line"><a name="l04311"></a><span class="lineno"> 4311</span>&#160;  <span class="keywordflow">case</span> Instruction::FMul:</div><div class="line"><a name="l04312"></a><span class="lineno"> 4312</span>&#160;    <span class="keywordflow">return</span> ReductionInstDesc(Kind == RK_FloatMult &amp;&amp; FastMath, I);</div><div class="line"><a name="l04313"></a><span class="lineno"> 4313</span>&#160;  <span class="keywordflow">case</span> Instruction::FAdd:</div><div class="line"><a name="l04314"></a><span class="lineno"> 4314</span>&#160;    <span class="keywordflow">return</span> ReductionInstDesc(Kind == RK_FloatAdd &amp;&amp; FastMath, I);</div><div class="line"><a name="l04315"></a><span class="lineno"> 4315</span>&#160;  <span class="keywordflow">case</span> Instruction::FCmp:</div><div class="line"><a name="l04316"></a><span class="lineno"> 4316</span>&#160;  <span class="keywordflow">case</span> Instruction::ICmp:</div><div class="line"><a name="l04317"></a><span class="lineno"> 4317</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1MCID.html#a8035044d40d3758eb45b65dce69dc90ba32dbd2c72a98eaee90e3ad5ef7b5af16">Instruction::Select</a>:</div><div class="line"><a name="l04318"></a><span class="lineno"> 4318</span>&#160;    <span class="keywordflow">if</span> (Kind != RK_IntegerMinMax &amp;&amp;</div><div class="line"><a name="l04319"></a><span class="lineno"> 4319</span>&#160;        (!HasFunNoNaNAttr || Kind != RK_FloatMinMax))</div><div class="line"><a name="l04320"></a><span class="lineno"> 4320</span>&#160;      <span class="keywordflow">return</span> ReductionInstDesc(<span class="keyword">false</span>, I);</div><div class="line"><a name="l04321"></a><span class="lineno"> 4321</span>&#160;    <span class="keywordflow">return</span> isMinMaxSelectCmpPattern(I, Prev);</div><div class="line"><a name="l04322"></a><span class="lineno"> 4322</span>&#160;  }</div><div class="line"><a name="l04323"></a><span class="lineno"> 4323</span>&#160;}</div><div class="line"><a name="l04324"></a><span class="lineno"> 4324</span>&#160;</div><div class="line"><a name="l04325"></a><span class="lineno"> 4325</span>&#160;LoopVectorizationLegality::InductionKind</div><div class="line"><a name="l04326"></a><span class="lineno"> 4326</span>&#160;LoopVectorizationLegality::isInductionVariable(<a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *Phi) {</div><div class="line"><a name="l04327"></a><span class="lineno"> 4327</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *PhiTy = Phi-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>();</div><div class="line"><a name="l04328"></a><span class="lineno"> 4328</span>&#160;  <span class="comment">// We only handle integer and pointer inductions variables.</span></div><div class="line"><a name="l04329"></a><span class="lineno"> 4329</span>&#160;  <span class="keywordflow">if</span> (!PhiTy-&gt;<a class="code" href="classllvm_1_1Type.html#a6e328feb83afa5cf1c966d6704e43fc1">isIntegerTy</a>() &amp;&amp; !PhiTy-&gt;<a class="code" href="classllvm_1_1Type.html#a2eba483f5cc876e824aa6c085736086b">isPointerTy</a>())</div><div class="line"><a name="l04330"></a><span class="lineno"> 4330</span>&#160;    <span class="keywordflow">return</span> IK_NoInduction;</div><div class="line"><a name="l04331"></a><span class="lineno"> 4331</span>&#160;</div><div class="line"><a name="l04332"></a><span class="lineno"> 4332</span>&#160;  <span class="comment">// Check that the PHI is consecutive.</span></div><div class="line"><a name="l04333"></a><span class="lineno"> 4333</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *PhiScev = SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a30bd18ac905eacf3601bc6a553a9ff49">getSCEV</a>(Phi);</div><div class="line"><a name="l04334"></a><span class="lineno"> 4334</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEVAddRecExpr.html">SCEVAddRecExpr</a> *AR = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1SCEVAddRecExpr.html">SCEVAddRecExpr</a>&gt;(PhiScev);</div><div class="line"><a name="l04335"></a><span class="lineno"> 4335</span>&#160;  <span class="keywordflow">if</span> (!AR) {</div><div class="line"><a name="l04336"></a><span class="lineno"> 4336</span>&#160;    <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;LV: PHI is not a poly recurrence.\n&quot;</span>);</div><div class="line"><a name="l04337"></a><span class="lineno"> 4337</span>&#160;    <span class="keywordflow">return</span> IK_NoInduction;</div><div class="line"><a name="l04338"></a><span class="lineno"> 4338</span>&#160;  }</div><div class="line"><a name="l04339"></a><span class="lineno"> 4339</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *Step = AR-&gt;<a class="code" href="classllvm_1_1SCEVAddRecExpr.html#a443e9130cd9f3e3baaa1b566e6aa5060">getStepRecurrence</a>(*SE);</div><div class="line"><a name="l04340"></a><span class="lineno"> 4340</span>&#160;</div><div class="line"><a name="l04341"></a><span class="lineno"> 4341</span>&#160;  <span class="comment">// Integer inductions need to have a stride of one.</span></div><div class="line"><a name="l04342"></a><span class="lineno"> 4342</span>&#160;  <span class="keywordflow">if</span> (PhiTy-&gt;<a class="code" href="classllvm_1_1Type.html#a6e328feb83afa5cf1c966d6704e43fc1">isIntegerTy</a>()) {</div><div class="line"><a name="l04343"></a><span class="lineno"> 4343</span>&#160;    <span class="keywordflow">if</span> (Step-&gt;<a class="code" href="classllvm_1_1SCEV.html#a3935a9de0ebdf3dc625cfb28e35bd009">isOne</a>())</div><div class="line"><a name="l04344"></a><span class="lineno"> 4344</span>&#160;      <span class="keywordflow">return</span> IK_IntInduction;</div><div class="line"><a name="l04345"></a><span class="lineno"> 4345</span>&#160;    <span class="keywordflow">if</span> (Step-&gt;<a class="code" href="classllvm_1_1SCEV.html#a6e915d0a915541a818ab88b1fac7cbd1">isAllOnesValue</a>())</div><div class="line"><a name="l04346"></a><span class="lineno"> 4346</span>&#160;      <span class="keywordflow">return</span> IK_ReverseIntInduction;</div><div class="line"><a name="l04347"></a><span class="lineno"> 4347</span>&#160;    <span class="keywordflow">return</span> IK_NoInduction;</div><div class="line"><a name="l04348"></a><span class="lineno"> 4348</span>&#160;  }</div><div class="line"><a name="l04349"></a><span class="lineno"> 4349</span>&#160;</div><div class="line"><a name="l04350"></a><span class="lineno"> 4350</span>&#160;  <span class="comment">// Calculate the pointer stride and check if it is consecutive.</span></div><div class="line"><a name="l04351"></a><span class="lineno"> 4351</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEVConstant.html">SCEVConstant</a> *<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1SCEVConstant.html">SCEVConstant</a>&gt;(Step);</div><div class="line"><a name="l04352"></a><span class="lineno"> 4352</span>&#160;  <span class="keywordflow">if</span> (!C)</div><div class="line"><a name="l04353"></a><span class="lineno"> 4353</span>&#160;    <span class="keywordflow">return</span> IK_NoInduction;</div><div class="line"><a name="l04354"></a><span class="lineno"> 4354</span>&#160;</div><div class="line"><a name="l04355"></a><span class="lineno"> 4355</span>&#160;  assert(PhiTy-&gt;<a class="code" href="classllvm_1_1Type.html#a2eba483f5cc876e824aa6c085736086b">isPointerTy</a>() &amp;&amp; <span class="stringliteral">&quot;The PHI must be a pointer&quot;</span>);</div><div class="line"><a name="l04356"></a><span class="lineno"> 4356</span>&#160;  uint64_t Size = DL-&gt;<a class="code" href="classllvm_1_1DataLayout.html#a1d6fcc02e91ba24510aba42660c90e29">getTypeAllocSize</a>(PhiTy-&gt;<a class="code" href="classllvm_1_1Type.html#a5c09d927a0079ad16e8367271efe9bc2">getPointerElementType</a>());</div><div class="line"><a name="l04357"></a><span class="lineno"> 4357</span>&#160;  <span class="keywordflow">if</span> (C-&gt;<a class="code" href="classllvm_1_1SCEVConstant.html#a64f0133adf37f9513005465580a19a66">getValue</a>()-&gt;<a class="code" href="classllvm_1_1ConstantInt.html#aba1dd3231ce4399a15b39ff769277f8d">equalsInt</a>(Size))</div><div class="line"><a name="l04358"></a><span class="lineno"> 4358</span>&#160;    <span class="keywordflow">return</span> IK_PtrInduction;</div><div class="line"><a name="l04359"></a><span class="lineno"> 4359</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (C-&gt;<a class="code" href="classllvm_1_1SCEVConstant.html#a64f0133adf37f9513005465580a19a66">getValue</a>()-&gt;<a class="code" href="classllvm_1_1ConstantInt.html#aba1dd3231ce4399a15b39ff769277f8d">equalsInt</a>(0 - Size))</div><div class="line"><a name="l04360"></a><span class="lineno"> 4360</span>&#160;    <span class="keywordflow">return</span> IK_ReversePtrInduction;</div><div class="line"><a name="l04361"></a><span class="lineno"> 4361</span>&#160;</div><div class="line"><a name="l04362"></a><span class="lineno"> 4362</span>&#160;  <span class="keywordflow">return</span> IK_NoInduction;</div><div class="line"><a name="l04363"></a><span class="lineno"> 4363</span>&#160;}</div><div class="line"><a name="l04364"></a><span class="lineno"> 4364</span>&#160;</div><div class="line"><a name="l04365"></a><span class="lineno"> 4365</span>&#160;<span class="keywordtype">bool</span> LoopVectorizationLegality::isInductionVariable(<span class="keyword">const</span> <a class="code" href="classllvm_1_1Value.html">Value</a> *V) {</div><div class="line"><a name="l04366"></a><span class="lineno"> 4366</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *In0 = <span class="keyword">const_cast&lt;</span><a class="code" href="classllvm_1_1Value.html">Value</a>*<span class="keyword">&gt;</span>(V);</div><div class="line"><a name="l04367"></a><span class="lineno"> 4367</span>&#160;  <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *PN = dyn_cast_or_null&lt;PHINode&gt;(In0);</div><div class="line"><a name="l04368"></a><span class="lineno"> 4368</span>&#160;  <span class="keywordflow">if</span> (!PN)</div><div class="line"><a name="l04369"></a><span class="lineno"> 4369</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l04370"></a><span class="lineno"> 4370</span>&#160;</div><div class="line"><a name="l04371"></a><span class="lineno"> 4371</span>&#160;  <span class="keywordflow">return</span> Inductions.count(PN);</div><div class="line"><a name="l04372"></a><span class="lineno"> 4372</span>&#160;}</div><div class="line"><a name="l04373"></a><span class="lineno"> 4373</span>&#160;</div><div class="line"><a name="l04374"></a><span class="lineno"> 4374</span>&#160;<span class="keywordtype">bool</span> LoopVectorizationLegality::blockNeedsPredication(<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *BB)  {</div><div class="line"><a name="l04375"></a><span class="lineno"> 4375</span>&#160;  assert(TheLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a92a38e2e3412bde7fd2b71db212b61aa">contains</a>(BB) &amp;&amp; <span class="stringliteral">&quot;Unknown block used&quot;</span>);</div><div class="line"><a name="l04376"></a><span class="lineno"> 4376</span>&#160;</div><div class="line"><a name="l04377"></a><span class="lineno"> 4377</span>&#160;  <span class="comment">// Blocks that do not dominate the latch need predication.</span></div><div class="line"><a name="l04378"></a><span class="lineno"> 4378</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a>* Latch = TheLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a8917d359fc92f25eb0117386588c6f1c">getLoopLatch</a>();</div><div class="line"><a name="l04379"></a><span class="lineno"> 4379</span>&#160;  <span class="keywordflow">return</span> !DT-&gt;dominates(BB, Latch);</div><div class="line"><a name="l04380"></a><span class="lineno"> 4380</span>&#160;}</div><div class="line"><a name="l04381"></a><span class="lineno"> 4381</span>&#160;</div><div class="line"><a name="l04382"></a><span class="lineno"> 4382</span>&#160;<span class="keywordtype">bool</span> LoopVectorizationLegality::blockCanBePredicated(<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *BB,</div><div class="line"><a name="l04383"></a><span class="lineno"> 4383</span>&#160;                                            <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;Value *, 8&gt;</a>&amp; SafePtrs) {</div><div class="line"><a name="l04384"></a><span class="lineno"> 4384</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1ilist__iterator.html">BasicBlock::iterator</a> <a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a> = BB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a0ed5f3ab3c2e4196ee0cffffa080c062">begin</a>(), e = BB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a0b4e7bee9b8575cc7db73329f1a561bd">end</a>(); <a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a> != e; ++<a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a>) {</div><div class="line"><a name="l04385"></a><span class="lineno"> 4385</span>&#160;    <span class="comment">// We might be able to hoist the load.</span></div><div class="line"><a name="l04386"></a><span class="lineno"> 4386</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a>-&gt;mayReadFromMemory()) {</div><div class="line"><a name="l04387"></a><span class="lineno"> 4387</span>&#160;      <a class="code" href="classllvm_1_1LoadInst.html">LoadInst</a> *LI = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1LoadInst.html">LoadInst</a>&gt;(<a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a>);</div><div class="line"><a name="l04388"></a><span class="lineno"> 4388</span>&#160;      <span class="keywordflow">if</span> (!LI || !SafePtrs.<a class="code" href="classllvm_1_1SmallPtrSet.html#a2ced6343b8ad006a757059554bbf9f37">count</a>(LI-&gt;<a class="code" href="classllvm_1_1LoadInst.html#ad47eefa1d094f60494b6b927061ca001">getPointerOperand</a>()))</div><div class="line"><a name="l04389"></a><span class="lineno"> 4389</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l04390"></a><span class="lineno"> 4390</span>&#160;    }</div><div class="line"><a name="l04391"></a><span class="lineno"> 4391</span>&#160;</div><div class="line"><a name="l04392"></a><span class="lineno"> 4392</span>&#160;    <span class="comment">// We don&#39;t predicate stores at the moment.</span></div><div class="line"><a name="l04393"></a><span class="lineno"> 4393</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a>-&gt;mayWriteToMemory() || <a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a>-&gt;mayThrow())</div><div class="line"><a name="l04394"></a><span class="lineno"> 4394</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l04395"></a><span class="lineno"> 4395</span>&#160;</div><div class="line"><a name="l04396"></a><span class="lineno"> 4396</span>&#160;    <span class="comment">// Check that we don&#39;t have a constant expression that can trap as operand.</span></div><div class="line"><a name="l04397"></a><span class="lineno"> 4397</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1User.html#a40df11649fb4c41a4de49f793c2d231f">Instruction::op_iterator</a> OI = <a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a>-&gt;op_begin(), OE = <a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a>-&gt;op_end();</div><div class="line"><a name="l04398"></a><span class="lineno"> 4398</span>&#160;         OI != OE; ++OI) {</div><div class="line"><a name="l04399"></a><span class="lineno"> 4399</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Constant.html">Constant</a> *<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = dyn_cast&lt;Constant&gt;(*OI))</div><div class="line"><a name="l04400"></a><span class="lineno"> 4400</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>-&gt;canTrap())</div><div class="line"><a name="l04401"></a><span class="lineno"> 4401</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l04402"></a><span class="lineno"> 4402</span>&#160;    }</div><div class="line"><a name="l04403"></a><span class="lineno"> 4403</span>&#160;</div><div class="line"><a name="l04404"></a><span class="lineno"> 4404</span>&#160;    <span class="comment">// The instructions below can trap.</span></div><div class="line"><a name="l04405"></a><span class="lineno"> 4405</span>&#160;    <span class="keywordflow">switch</span> (<a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a>-&gt;getOpcode()) {</div><div class="line"><a name="l04406"></a><span class="lineno"> 4406</span>&#160;    <span class="keywordflow">default</span>: <span class="keywordflow">continue</span>;</div><div class="line"><a name="l04407"></a><span class="lineno"> 4407</span>&#160;    <span class="keywordflow">case</span> Instruction::UDiv:</div><div class="line"><a name="l04408"></a><span class="lineno"> 4408</span>&#160;    <span class="keywordflow">case</span> Instruction::SDiv:</div><div class="line"><a name="l04409"></a><span class="lineno"> 4409</span>&#160;    <span class="keywordflow">case</span> Instruction::URem:</div><div class="line"><a name="l04410"></a><span class="lineno"> 4410</span>&#160;    <span class="keywordflow">case</span> Instruction::SRem:</div><div class="line"><a name="l04411"></a><span class="lineno"> 4411</span>&#160;             <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l04412"></a><span class="lineno"> 4412</span>&#160;    }</div><div class="line"><a name="l04413"></a><span class="lineno"> 4413</span>&#160;  }</div><div class="line"><a name="l04414"></a><span class="lineno"> 4414</span>&#160;</div><div class="line"><a name="l04415"></a><span class="lineno"> 4415</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l04416"></a><span class="lineno"> 4416</span>&#160;}</div><div class="line"><a name="l04417"></a><span class="lineno"> 4417</span>&#160;</div><div class="line"><a name="l04418"></a><span class="lineno"> 4418</span>&#160;<a class="code" href="LoopVectorize_8cpp.html#a7db5de6d612f2730abd7aa99a724615a">LoopVectorizationCostModel::VectorizationFactor</a></div><div class="line"><a name="l04419"></a><span class="lineno"> 4419</span>&#160;LoopVectorizationCostModel::selectVectorizationFactor(<span class="keywordtype">bool</span> OptForSize,</div><div class="line"><a name="l04420"></a><span class="lineno"> 4420</span>&#160;                                                      <span class="keywordtype">unsigned</span> UserVF) {</div><div class="line"><a name="l04421"></a><span class="lineno"> 4421</span>&#160;  <span class="comment">// Width 1 means no vectorize</span></div><div class="line"><a name="l04422"></a><span class="lineno"> 4422</span>&#160;  <a class="code" href="LoopVectorize_8cpp.html#a7db5de6d612f2730abd7aa99a724615a">VectorizationFactor</a> Factor = { 1U, 0U };</div><div class="line"><a name="l04423"></a><span class="lineno"> 4423</span>&#160;  <span class="keywordflow">if</span> (OptForSize &amp;&amp; Legal-&gt;getRuntimePointerCheck()-&gt;Need) {</div><div class="line"><a name="l04424"></a><span class="lineno"> 4424</span>&#160;    <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;LV: Aborting. Runtime ptr check is required in Os.\n&quot;</span>);</div><div class="line"><a name="l04425"></a><span class="lineno"> 4425</span>&#160;    <span class="keywordflow">return</span> Factor;</div><div class="line"><a name="l04426"></a><span class="lineno"> 4426</span>&#160;  }</div><div class="line"><a name="l04427"></a><span class="lineno"> 4427</span>&#160;</div><div class="line"><a name="l04428"></a><span class="lineno"> 4428</span>&#160;  <span class="comment">// Find the trip count.</span></div><div class="line"><a name="l04429"></a><span class="lineno"> 4429</span>&#160;  <span class="keywordtype">unsigned</span> TC = SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a5984e47d0885332478dc9232634d82e8">getSmallConstantTripCount</a>(TheLoop, TheLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a8917d359fc92f25eb0117386588c6f1c">getLoopLatch</a>());</div><div class="line"><a name="l04430"></a><span class="lineno"> 4430</span>&#160;  <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;LV: Found trip count: &quot;</span> &lt;&lt; TC &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>);</div><div class="line"><a name="l04431"></a><span class="lineno"> 4431</span>&#160;</div><div class="line"><a name="l04432"></a><span class="lineno"> 4432</span>&#160;  <span class="keywordtype">unsigned</span> WidestType = getWidestType();</div><div class="line"><a name="l04433"></a><span class="lineno"> 4433</span>&#160;  <span class="keywordtype">unsigned</span> WidestRegister = TTI.getRegisterBitWidth(<span class="keyword">true</span>);</div><div class="line"><a name="l04434"></a><span class="lineno"> 4434</span>&#160;  <span class="keywordtype">unsigned</span> MaxSafeDepDist = -1U;</div><div class="line"><a name="l04435"></a><span class="lineno"> 4435</span>&#160;  <span class="keywordflow">if</span> (Legal-&gt;getMaxSafeDepDistBytes() != -1U)</div><div class="line"><a name="l04436"></a><span class="lineno"> 4436</span>&#160;    MaxSafeDepDist = Legal-&gt;getMaxSafeDepDistBytes() * 8;</div><div class="line"><a name="l04437"></a><span class="lineno"> 4437</span>&#160;  WidestRegister = ((WidestRegister &lt; MaxSafeDepDist) ?</div><div class="line"><a name="l04438"></a><span class="lineno"> 4438</span>&#160;                    WidestRegister : MaxSafeDepDist);</div><div class="line"><a name="l04439"></a><span class="lineno"> 4439</span>&#160;  <span class="keywordtype">unsigned</span> MaxVectorSize = WidestRegister / WidestType;</div><div class="line"><a name="l04440"></a><span class="lineno"> 4440</span>&#160;  <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;LV: The Widest type: &quot;</span> &lt;&lt; WidestType &lt;&lt; <span class="stringliteral">&quot; bits.\n&quot;</span>);</div><div class="line"><a name="l04441"></a><span class="lineno"> 4441</span>&#160;  <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;LV: The Widest register is: &quot;</span></div><div class="line"><a name="l04442"></a><span class="lineno"> 4442</span>&#160;          &lt;&lt; WidestRegister &lt;&lt; <span class="stringliteral">&quot; bits.\n&quot;</span>);</div><div class="line"><a name="l04443"></a><span class="lineno"> 4443</span>&#160;</div><div class="line"><a name="l04444"></a><span class="lineno"> 4444</span>&#160;  <span class="keywordflow">if</span> (MaxVectorSize == 0) {</div><div class="line"><a name="l04445"></a><span class="lineno"> 4445</span>&#160;    <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;LV: The target has no vector registers.\n&quot;</span>);</div><div class="line"><a name="l04446"></a><span class="lineno"> 4446</span>&#160;    MaxVectorSize = 1;</div><div class="line"><a name="l04447"></a><span class="lineno"> 4447</span>&#160;  }</div><div class="line"><a name="l04448"></a><span class="lineno"> 4448</span>&#160;</div><div class="line"><a name="l04449"></a><span class="lineno"> 4449</span>&#160;  assert(MaxVectorSize &lt;= 32 &amp;&amp; <span class="stringliteral">&quot;Did not expect to pack so many elements&quot;</span></div><div class="line"><a name="l04450"></a><span class="lineno"> 4450</span>&#160;         <span class="stringliteral">&quot; into one vector!&quot;</span>);</div><div class="line"><a name="l04451"></a><span class="lineno"> 4451</span>&#160;</div><div class="line"><a name="l04452"></a><span class="lineno"> 4452</span>&#160;  <span class="keywordtype">unsigned</span> VF = MaxVectorSize;</div><div class="line"><a name="l04453"></a><span class="lineno"> 4453</span>&#160;</div><div class="line"><a name="l04454"></a><span class="lineno"> 4454</span>&#160;  <span class="comment">// If we optimize the program for size, avoid creating the tail loop.</span></div><div class="line"><a name="l04455"></a><span class="lineno"> 4455</span>&#160;  <span class="keywordflow">if</span> (OptForSize) {</div><div class="line"><a name="l04456"></a><span class="lineno"> 4456</span>&#160;    <span class="comment">// If we are unable to calculate the trip count then don&#39;t try to vectorize.</span></div><div class="line"><a name="l04457"></a><span class="lineno"> 4457</span>&#160;    <span class="keywordflow">if</span> (TC &lt; 2) {</div><div class="line"><a name="l04458"></a><span class="lineno"> 4458</span>&#160;      <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;LV: Aborting. A tail loop is required in Os.\n&quot;</span>);</div><div class="line"><a name="l04459"></a><span class="lineno"> 4459</span>&#160;      <span class="keywordflow">return</span> Factor;</div><div class="line"><a name="l04460"></a><span class="lineno"> 4460</span>&#160;    }</div><div class="line"><a name="l04461"></a><span class="lineno"> 4461</span>&#160;</div><div class="line"><a name="l04462"></a><span class="lineno"> 4462</span>&#160;    <span class="comment">// Find the maximum SIMD width that can fit within the trip count.</span></div><div class="line"><a name="l04463"></a><span class="lineno"> 4463</span>&#160;    VF = TC % MaxVectorSize;</div><div class="line"><a name="l04464"></a><span class="lineno"> 4464</span>&#160;</div><div class="line"><a name="l04465"></a><span class="lineno"> 4465</span>&#160;    <span class="keywordflow">if</span> (VF == 0)</div><div class="line"><a name="l04466"></a><span class="lineno"> 4466</span>&#160;      VF = MaxVectorSize;</div><div class="line"><a name="l04467"></a><span class="lineno"> 4467</span>&#160;</div><div class="line"><a name="l04468"></a><span class="lineno"> 4468</span>&#160;    <span class="comment">// If the trip count that we found modulo the vectorization factor is not</span></div><div class="line"><a name="l04469"></a><span class="lineno"> 4469</span>&#160;    <span class="comment">// zero then we require a tail.</span></div><div class="line"><a name="l04470"></a><span class="lineno"> 4470</span>&#160;    <span class="keywordflow">if</span> (VF &lt; 2) {</div><div class="line"><a name="l04471"></a><span class="lineno"> 4471</span>&#160;      <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;LV: Aborting. A tail loop is required in Os.\n&quot;</span>);</div><div class="line"><a name="l04472"></a><span class="lineno"> 4472</span>&#160;      <span class="keywordflow">return</span> Factor;</div><div class="line"><a name="l04473"></a><span class="lineno"> 4473</span>&#160;    }</div><div class="line"><a name="l04474"></a><span class="lineno"> 4474</span>&#160;  }</div><div class="line"><a name="l04475"></a><span class="lineno"> 4475</span>&#160;</div><div class="line"><a name="l04476"></a><span class="lineno"> 4476</span>&#160;  <span class="keywordflow">if</span> (UserVF != 0) {</div><div class="line"><a name="l04477"></a><span class="lineno"> 4477</span>&#160;    assert(<a class="code" href="namespacellvm.html#af4d1a918800291e75b01ce1447be0e83">isPowerOf2_32</a>(UserVF) &amp;&amp; <span class="stringliteral">&quot;VF needs to be a power of two&quot;</span>);</div><div class="line"><a name="l04478"></a><span class="lineno"> 4478</span>&#160;    <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;LV: Using user VF &quot;</span> &lt;&lt; UserVF &lt;&lt; <span class="stringliteral">&quot;.\n&quot;</span>);</div><div class="line"><a name="l04479"></a><span class="lineno"> 4479</span>&#160;</div><div class="line"><a name="l04480"></a><span class="lineno"> 4480</span>&#160;    Factor.Width = UserVF;</div><div class="line"><a name="l04481"></a><span class="lineno"> 4481</span>&#160;    <span class="keywordflow">return</span> Factor;</div><div class="line"><a name="l04482"></a><span class="lineno"> 4482</span>&#160;  }</div><div class="line"><a name="l04483"></a><span class="lineno"> 4483</span>&#160;</div><div class="line"><a name="l04484"></a><span class="lineno"> 4484</span>&#160;  <span class="keywordtype">float</span> Cost = expectedCost(1);</div><div class="line"><a name="l04485"></a><span class="lineno"> 4485</span>&#160;  <span class="keywordtype">unsigned</span> Width = 1;</div><div class="line"><a name="l04486"></a><span class="lineno"> 4486</span>&#160;  <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;LV: Scalar loop costs: &quot;</span> &lt;&lt; (<span class="keywordtype">int</span>)Cost &lt;&lt; <span class="stringliteral">&quot;.\n&quot;</span>);</div><div class="line"><a name="l04487"></a><span class="lineno"> 4487</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>=2; <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt;= VF; <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>*=2) {</div><div class="line"><a name="l04488"></a><span class="lineno"> 4488</span>&#160;    <span class="comment">// Notice that the vector loop needs to be executed less times, so</span></div><div class="line"><a name="l04489"></a><span class="lineno"> 4489</span>&#160;    <span class="comment">// we need to divide the cost of the vector loops by the width of</span></div><div class="line"><a name="l04490"></a><span class="lineno"> 4490</span>&#160;    <span class="comment">// the vector elements.</span></div><div class="line"><a name="l04491"></a><span class="lineno"> 4491</span>&#160;    <span class="keywordtype">float</span> VectorCost = expectedCost(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) / (float)<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div><div class="line"><a name="l04492"></a><span class="lineno"> 4492</span>&#160;    <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;LV: Vector loop of width &quot;</span> &lt;&lt; <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt;&lt; <span class="stringliteral">&quot; costs: &quot;</span> &lt;&lt;</div><div class="line"><a name="l04493"></a><span class="lineno"> 4493</span>&#160;          (<span class="keywordtype">int</span>)VectorCost &lt;&lt; <span class="stringliteral">&quot;.\n&quot;</span>);</div><div class="line"><a name="l04494"></a><span class="lineno"> 4494</span>&#160;    <span class="keywordflow">if</span> (VectorCost &lt; Cost) {</div><div class="line"><a name="l04495"></a><span class="lineno"> 4495</span>&#160;      Cost = VectorCost;</div><div class="line"><a name="l04496"></a><span class="lineno"> 4496</span>&#160;      Width = <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div><div class="line"><a name="l04497"></a><span class="lineno"> 4497</span>&#160;    }</div><div class="line"><a name="l04498"></a><span class="lineno"> 4498</span>&#160;  }</div><div class="line"><a name="l04499"></a><span class="lineno"> 4499</span>&#160;</div><div class="line"><a name="l04500"></a><span class="lineno"> 4500</span>&#160;  <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;LV: Selecting VF = : &quot;</span>&lt;&lt; Width &lt;&lt; <span class="stringliteral">&quot;.\n&quot;</span>);</div><div class="line"><a name="l04501"></a><span class="lineno"> 4501</span>&#160;  Factor.Width = Width;</div><div class="line"><a name="l04502"></a><span class="lineno"> 4502</span>&#160;  Factor.Cost = Width * Cost;</div><div class="line"><a name="l04503"></a><span class="lineno"> 4503</span>&#160;  <span class="keywordflow">return</span> Factor;</div><div class="line"><a name="l04504"></a><span class="lineno"> 4504</span>&#160;}</div><div class="line"><a name="l04505"></a><span class="lineno"> 4505</span>&#160;</div><div class="line"><a name="l04506"></a><span class="lineno"> 4506</span>&#160;<span class="keywordtype">unsigned</span> LoopVectorizationCostModel::getWidestType() {</div><div class="line"><a name="l04507"></a><span class="lineno"> 4507</span>&#160;  <span class="keywordtype">unsigned</span> MaxWidth = 8;</div><div class="line"><a name="l04508"></a><span class="lineno"> 4508</span>&#160;</div><div class="line"><a name="l04509"></a><span class="lineno"> 4509</span>&#160;  <span class="comment">// For each block.</span></div><div class="line"><a name="l04510"></a><span class="lineno"> 4510</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1LoopBase.html#ab39f9623eaa8cd22213aa716c6fb9994">Loop::block_iterator</a> <a class="code" href="Target_2X86_2README_8txt.html#ac9423a63151469d95755528cceb322fb">bb</a> = TheLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a3df1c508a7b1c89247367cab269076e2">block_begin</a>(),</div><div class="line"><a name="l04511"></a><span class="lineno"> 4511</span>&#160;       <a class="code" href="CodeGen_2README_8txt.html#aa0629dbc89f0868f62da8cbcb681b2be">be</a> = TheLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a91e3f5f9bf6ecbd058624a479e150603">block_end</a>(); <a class="code" href="Target_2X86_2README_8txt.html#ac9423a63151469d95755528cceb322fb">bb</a> != <a class="code" href="CodeGen_2README_8txt.html#aa0629dbc89f0868f62da8cbcb681b2be">be</a>; ++<a class="code" href="Target_2X86_2README_8txt.html#ac9423a63151469d95755528cceb322fb">bb</a>) {</div><div class="line"><a name="l04512"></a><span class="lineno"> 4512</span>&#160;    <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *BB = *<a class="code" href="Target_2X86_2README_8txt.html#ac9423a63151469d95755528cceb322fb">bb</a>;</div><div class="line"><a name="l04513"></a><span class="lineno"> 4513</span>&#160;</div><div class="line"><a name="l04514"></a><span class="lineno"> 4514</span>&#160;    <span class="comment">// For each instruction in the loop.</span></div><div class="line"><a name="l04515"></a><span class="lineno"> 4515</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1ilist__iterator.html">BasicBlock::iterator</a> <a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a> = BB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a0ed5f3ab3c2e4196ee0cffffa080c062">begin</a>(), e = BB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a0b4e7bee9b8575cc7db73329f1a561bd">end</a>(); <a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a> != e; ++<a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a>) {</div><div class="line"><a name="l04516"></a><span class="lineno"> 4516</span>&#160;      <a class="code" href="classllvm_1_1Type.html">Type</a> *<a class="code" href="classT.html">T</a> = <a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a>-&gt;getType();</div><div class="line"><a name="l04517"></a><span class="lineno"> 4517</span>&#160;</div><div class="line"><a name="l04518"></a><span class="lineno"> 4518</span>&#160;      <span class="comment">// Only examine Loads, Stores and PHINodes.</span></div><div class="line"><a name="l04519"></a><span class="lineno"> 4519</span>&#160;      <span class="keywordflow">if</span> (!isa&lt;LoadInst&gt;(<a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a>) &amp;&amp; !isa&lt;StoreInst&gt;(<a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a>) &amp;&amp; !isa&lt;PHINode&gt;(<a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a>))</div><div class="line"><a name="l04520"></a><span class="lineno"> 4520</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l04521"></a><span class="lineno"> 4521</span>&#160;</div><div class="line"><a name="l04522"></a><span class="lineno"> 4522</span>&#160;      <span class="comment">// Examine PHI nodes that are reduction variables.</span></div><div class="line"><a name="l04523"></a><span class="lineno"> 4523</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *PN = dyn_cast&lt;PHINode&gt;(<a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a>))</div><div class="line"><a name="l04524"></a><span class="lineno"> 4524</span>&#160;        <span class="keywordflow">if</span> (!Legal-&gt;getReductionVars()-&gt;count(PN))</div><div class="line"><a name="l04525"></a><span class="lineno"> 4525</span>&#160;          <span class="keywordflow">continue</span>;</div><div class="line"><a name="l04526"></a><span class="lineno"> 4526</span>&#160;</div><div class="line"><a name="l04527"></a><span class="lineno"> 4527</span>&#160;      <span class="comment">// Examine the stored values.</span></div><div class="line"><a name="l04528"></a><span class="lineno"> 4528</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1StoreInst.html">StoreInst</a> *<a class="code" href="namespacellvm_1_1A64DB.html#a6fce8157775f3ec93f326b52b0f1e0f5a4916e736d6b7cc68359b39d5eb50f6db">ST</a> = dyn_cast&lt;StoreInst&gt;(<a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a>))</div><div class="line"><a name="l04529"></a><span class="lineno"> 4529</span>&#160;        T = <a class="code" href="namespacellvm_1_1A64DB.html#a6fce8157775f3ec93f326b52b0f1e0f5a4916e736d6b7cc68359b39d5eb50f6db">ST</a>-&gt;getValueOperand()-&gt;getType();</div><div class="line"><a name="l04530"></a><span class="lineno"> 4530</span>&#160;</div><div class="line"><a name="l04531"></a><span class="lineno"> 4531</span>&#160;      <span class="comment">// Ignore loaded pointer types and stored pointer types that are not</span></div><div class="line"><a name="l04532"></a><span class="lineno"> 4532</span>&#160;      <span class="comment">// consecutive. However, we do want to take consecutive stores/loads of</span></div><div class="line"><a name="l04533"></a><span class="lineno"> 4533</span>&#160;      <span class="comment">// pointer vectors into account.</span></div><div class="line"><a name="l04534"></a><span class="lineno"> 4534</span>&#160;      <span class="keywordflow">if</span> (T-&gt;<a class="code" href="classllvm_1_1Type.html#a2eba483f5cc876e824aa6c085736086b">isPointerTy</a>() &amp;&amp; !isConsecutiveLoadOrStore(<a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a>))</div><div class="line"><a name="l04535"></a><span class="lineno"> 4535</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l04536"></a><span class="lineno"> 4536</span>&#160;</div><div class="line"><a name="l04537"></a><span class="lineno"> 4537</span>&#160;      MaxWidth = std::max(MaxWidth,</div><div class="line"><a name="l04538"></a><span class="lineno"> 4538</span>&#160;                          (<span class="keywordtype">unsigned</span>)DL-&gt;<a class="code" href="classllvm_1_1DataLayout.html#add914112e0b2935dda06ad5dfd3a31db">getTypeSizeInBits</a>(T-&gt;<a class="code" href="classllvm_1_1Type.html#a8eafa71cf399da8f21b2af5549f3f9e7">getScalarType</a>()));</div><div class="line"><a name="l04539"></a><span class="lineno"> 4539</span>&#160;    }</div><div class="line"><a name="l04540"></a><span class="lineno"> 4540</span>&#160;  }</div><div class="line"><a name="l04541"></a><span class="lineno"> 4541</span>&#160;</div><div class="line"><a name="l04542"></a><span class="lineno"> 4542</span>&#160;  <span class="keywordflow">return</span> MaxWidth;</div><div class="line"><a name="l04543"></a><span class="lineno"> 4543</span>&#160;}</div><div class="line"><a name="l04544"></a><span class="lineno"> 4544</span>&#160;</div><div class="line"><a name="l04545"></a><span class="lineno"> 4545</span>&#160;<span class="keywordtype">unsigned</span></div><div class="line"><a name="l04546"></a><span class="lineno"> 4546</span>&#160;LoopVectorizationCostModel::selectUnrollFactor(<span class="keywordtype">bool</span> OptForSize,</div><div class="line"><a name="l04547"></a><span class="lineno"> 4547</span>&#160;                                               <span class="keywordtype">unsigned</span> UserUF,</div><div class="line"><a name="l04548"></a><span class="lineno"> 4548</span>&#160;                                               <span class="keywordtype">unsigned</span> VF,</div><div class="line"><a name="l04549"></a><span class="lineno"> 4549</span>&#160;                                               <span class="keywordtype">unsigned</span> LoopCost) {</div><div class="line"><a name="l04550"></a><span class="lineno"> 4550</span>&#160;</div><div class="line"><a name="l04551"></a><span class="lineno"> 4551</span>&#160;  <span class="comment">// -- The unroll heuristics --</span></div><div class="line"><a name="l04552"></a><span class="lineno"> 4552</span>&#160;  <span class="comment">// We unroll the loop in order to expose ILP and reduce the loop overhead.</span></div><div class="line"><a name="l04553"></a><span class="lineno"> 4553</span>&#160;  <span class="comment">// There are many micro-architectural considerations that we can&#39;t predict</span></div><div class="line"><a name="l04554"></a><span class="lineno"> 4554</span>&#160;  <span class="comment">// at this level. For example frontend pressure (on decode or fetch) due to</span></div><div class="line"><a name="l04555"></a><span class="lineno"> 4555</span>&#160;  <span class="comment">// code size, or the number and capabilities of the execution ports.</span></div><div class="line"><a name="l04556"></a><span class="lineno"> 4556</span>&#160;  <span class="comment">//</span></div><div class="line"><a name="l04557"></a><span class="lineno"> 4557</span>&#160;  <span class="comment">// We use the following heuristics to select the unroll factor:</span></div><div class="line"><a name="l04558"></a><span class="lineno"> 4558</span>&#160;  <span class="comment">// 1. If the code has reductions the we unroll in order to break the cross</span></div><div class="line"><a name="l04559"></a><span class="lineno"> 4559</span>&#160;  <span class="comment">// iteration dependency.</span></div><div class="line"><a name="l04560"></a><span class="lineno"> 4560</span>&#160;  <span class="comment">// 2. If the loop is really small then we unroll in order to reduce the loop</span></div><div class="line"><a name="l04561"></a><span class="lineno"> 4561</span>&#160;  <span class="comment">// overhead.</span></div><div class="line"><a name="l04562"></a><span class="lineno"> 4562</span>&#160;  <span class="comment">// 3. We don&#39;t unroll if we think that we will spill registers to memory due</span></div><div class="line"><a name="l04563"></a><span class="lineno"> 4563</span>&#160;  <span class="comment">// to the increased register pressure.</span></div><div class="line"><a name="l04564"></a><span class="lineno"> 4564</span>&#160;</div><div class="line"><a name="l04565"></a><span class="lineno"> 4565</span>&#160;  <span class="comment">// Use the user preference, unless &#39;auto&#39; is selected.</span></div><div class="line"><a name="l04566"></a><span class="lineno"> 4566</span>&#160;  <span class="keywordflow">if</span> (UserUF != 0)</div><div class="line"><a name="l04567"></a><span class="lineno"> 4567</span>&#160;    <span class="keywordflow">return</span> UserUF;</div><div class="line"><a name="l04568"></a><span class="lineno"> 4568</span>&#160;</div><div class="line"><a name="l04569"></a><span class="lineno"> 4569</span>&#160;  <span class="comment">// When we optimize for size we don&#39;t unroll.</span></div><div class="line"><a name="l04570"></a><span class="lineno"> 4570</span>&#160;  <span class="keywordflow">if</span> (OptForSize)</div><div class="line"><a name="l04571"></a><span class="lineno"> 4571</span>&#160;    <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l04572"></a><span class="lineno"> 4572</span>&#160;</div><div class="line"><a name="l04573"></a><span class="lineno"> 4573</span>&#160;  <span class="comment">// We used the distance for the unroll factor.</span></div><div class="line"><a name="l04574"></a><span class="lineno"> 4574</span>&#160;  <span class="keywordflow">if</span> (Legal-&gt;getMaxSafeDepDistBytes() != -1U)</div><div class="line"><a name="l04575"></a><span class="lineno"> 4575</span>&#160;    <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l04576"></a><span class="lineno"> 4576</span>&#160;</div><div class="line"><a name="l04577"></a><span class="lineno"> 4577</span>&#160;  <span class="comment">// Do not unroll loops with a relatively small trip count.</span></div><div class="line"><a name="l04578"></a><span class="lineno"> 4578</span>&#160;  <span class="keywordtype">unsigned</span> TC = SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a5984e47d0885332478dc9232634d82e8">getSmallConstantTripCount</a>(TheLoop,</div><div class="line"><a name="l04579"></a><span class="lineno"> 4579</span>&#160;                                              TheLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a8917d359fc92f25eb0117386588c6f1c">getLoopLatch</a>());</div><div class="line"><a name="l04580"></a><span class="lineno"> 4580</span>&#160;  <span class="keywordflow">if</span> (TC &gt; 1 &amp;&amp; TC &lt; TinyTripCountUnrollThreshold)</div><div class="line"><a name="l04581"></a><span class="lineno"> 4581</span>&#160;    <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l04582"></a><span class="lineno"> 4582</span>&#160;</div><div class="line"><a name="l04583"></a><span class="lineno"> 4583</span>&#160;  <span class="keywordtype">unsigned</span> TargetVectorRegisters = TTI.getNumberOfRegisters(<span class="keyword">true</span>);</div><div class="line"><a name="l04584"></a><span class="lineno"> 4584</span>&#160;  <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;LV: The target has &quot;</span> &lt;&lt; TargetVectorRegisters &lt;&lt;</div><div class="line"><a name="l04585"></a><span class="lineno"> 4585</span>&#160;        <span class="stringliteral">&quot; vector registers\n&quot;</span>);</div><div class="line"><a name="l04586"></a><span class="lineno"> 4586</span>&#160;</div><div class="line"><a name="l04587"></a><span class="lineno"> 4587</span>&#160;  LoopVectorizationCostModel::RegisterUsage R = calculateRegisterUsage();</div><div class="line"><a name="l04588"></a><span class="lineno"> 4588</span>&#160;  <span class="comment">// We divide by these constants so assume that we have at least one</span></div><div class="line"><a name="l04589"></a><span class="lineno"> 4589</span>&#160;  <span class="comment">// instruction that uses at least one register.</span></div><div class="line"><a name="l04590"></a><span class="lineno"> 4590</span>&#160;  R.MaxLocalUsers = std::max(R.MaxLocalUsers, 1U);</div><div class="line"><a name="l04591"></a><span class="lineno"> 4591</span>&#160;  R.NumInstructions = std::max(R.NumInstructions, 1U);</div><div class="line"><a name="l04592"></a><span class="lineno"> 4592</span>&#160;</div><div class="line"><a name="l04593"></a><span class="lineno"> 4593</span>&#160;  <span class="comment">// We calculate the unroll factor using the following formula.</span></div><div class="line"><a name="l04594"></a><span class="lineno"> 4594</span>&#160;  <span class="comment">// Subtract the number of loop invariants from the number of available</span></div><div class="line"><a name="l04595"></a><span class="lineno"> 4595</span>&#160;  <span class="comment">// registers. These registers are used by all of the unrolled instances.</span></div><div class="line"><a name="l04596"></a><span class="lineno"> 4596</span>&#160;  <span class="comment">// Next, divide the remaining registers by the number of registers that is</span></div><div class="line"><a name="l04597"></a><span class="lineno"> 4597</span>&#160;  <span class="comment">// required by the loop, in order to estimate how many parallel instances</span></div><div class="line"><a name="l04598"></a><span class="lineno"> 4598</span>&#160;  <span class="comment">// fit without causing spills.</span></div><div class="line"><a name="l04599"></a><span class="lineno"> 4599</span>&#160;  <span class="keywordtype">unsigned</span> UF = (TargetVectorRegisters - R.LoopInvariantRegs) / R.MaxLocalUsers;</div><div class="line"><a name="l04600"></a><span class="lineno"> 4600</span>&#160;</div><div class="line"><a name="l04601"></a><span class="lineno"> 4601</span>&#160;  <span class="comment">// Clamp the unroll factor ranges to reasonable factors.</span></div><div class="line"><a name="l04602"></a><span class="lineno"> 4602</span>&#160;  <span class="keywordtype">unsigned</span> MaxUnrollSize = TTI.getMaximumUnrollFactor();</div><div class="line"><a name="l04603"></a><span class="lineno"> 4603</span>&#160;</div><div class="line"><a name="l04604"></a><span class="lineno"> 4604</span>&#160;  <span class="comment">// If we did not calculate the cost for VF (because the user selected the VF)</span></div><div class="line"><a name="l04605"></a><span class="lineno"> 4605</span>&#160;  <span class="comment">// then we calculate the cost of VF here.</span></div><div class="line"><a name="l04606"></a><span class="lineno"> 4606</span>&#160;  <span class="keywordflow">if</span> (LoopCost == 0)</div><div class="line"><a name="l04607"></a><span class="lineno"> 4607</span>&#160;    LoopCost = expectedCost(VF);</div><div class="line"><a name="l04608"></a><span class="lineno"> 4608</span>&#160;</div><div class="line"><a name="l04609"></a><span class="lineno"> 4609</span>&#160;  <span class="comment">// Clamp the calculated UF to be between the 1 and the max unroll factor</span></div><div class="line"><a name="l04610"></a><span class="lineno"> 4610</span>&#160;  <span class="comment">// that the target allows.</span></div><div class="line"><a name="l04611"></a><span class="lineno"> 4611</span>&#160;  <span class="keywordflow">if</span> (UF &gt; MaxUnrollSize)</div><div class="line"><a name="l04612"></a><span class="lineno"> 4612</span>&#160;    UF = MaxUnrollSize;</div><div class="line"><a name="l04613"></a><span class="lineno"> 4613</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (UF &lt; 1)</div><div class="line"><a name="l04614"></a><span class="lineno"> 4614</span>&#160;    UF = 1;</div><div class="line"><a name="l04615"></a><span class="lineno"> 4615</span>&#160;</div><div class="line"><a name="l04616"></a><span class="lineno"> 4616</span>&#160;  <span class="keywordtype">bool</span> HasReductions = Legal-&gt;getReductionVars()-&gt;size();</div><div class="line"><a name="l04617"></a><span class="lineno"> 4617</span>&#160;</div><div class="line"><a name="l04618"></a><span class="lineno"> 4618</span>&#160;  <span class="comment">// Decide if we want to unroll if we decided that it is legal to vectorize</span></div><div class="line"><a name="l04619"></a><span class="lineno"> 4619</span>&#160;  <span class="comment">// but not profitable.</span></div><div class="line"><a name="l04620"></a><span class="lineno"> 4620</span>&#160;  <span class="keywordflow">if</span> (VF == 1) {</div><div class="line"><a name="l04621"></a><span class="lineno"> 4621</span>&#160;    <span class="keywordflow">if</span> (TheLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a9a89d64fefa63ff782d8f29e53a01873">getNumBlocks</a>() &gt; 1 || !HasReductions ||</div><div class="line"><a name="l04622"></a><span class="lineno"> 4622</span>&#160;        LoopCost &gt; <a class="code" href="LoopVectorize_8cpp.html#a4888997ffd62d30edefde5170b33f854">SmallLoopCost</a>)</div><div class="line"><a name="l04623"></a><span class="lineno"> 4623</span>&#160;      <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l04624"></a><span class="lineno"> 4624</span>&#160;</div><div class="line"><a name="l04625"></a><span class="lineno"> 4625</span>&#160;    <span class="keywordflow">return</span> UF;</div><div class="line"><a name="l04626"></a><span class="lineno"> 4626</span>&#160;  }</div><div class="line"><a name="l04627"></a><span class="lineno"> 4627</span>&#160;</div><div class="line"><a name="l04628"></a><span class="lineno"> 4628</span>&#160;  <span class="keywordflow">if</span> (HasReductions) {</div><div class="line"><a name="l04629"></a><span class="lineno"> 4629</span>&#160;    <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;LV: Unrolling because of reductions.\n&quot;</span>);</div><div class="line"><a name="l04630"></a><span class="lineno"> 4630</span>&#160;    <span class="keywordflow">return</span> UF;</div><div class="line"><a name="l04631"></a><span class="lineno"> 4631</span>&#160;  }</div><div class="line"><a name="l04632"></a><span class="lineno"> 4632</span>&#160;</div><div class="line"><a name="l04633"></a><span class="lineno"> 4633</span>&#160;  <span class="comment">// We want to unroll tiny loops in order to reduce the loop overhead.</span></div><div class="line"><a name="l04634"></a><span class="lineno"> 4634</span>&#160;  <span class="comment">// We assume that the cost overhead is 1 and we use the cost model</span></div><div class="line"><a name="l04635"></a><span class="lineno"> 4635</span>&#160;  <span class="comment">// to estimate the cost of the loop and unroll until the cost of the</span></div><div class="line"><a name="l04636"></a><span class="lineno"> 4636</span>&#160;  <span class="comment">// loop overhead is about 5% of the cost of the loop.</span></div><div class="line"><a name="l04637"></a><span class="lineno"> 4637</span>&#160;  <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;LV: Loop cost is &quot;</span> &lt;&lt; LoopCost &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>);</div><div class="line"><a name="l04638"></a><span class="lineno"> 4638</span>&#160;  <span class="keywordflow">if</span> (LoopCost &lt; SmallLoopCost) {</div><div class="line"><a name="l04639"></a><span class="lineno"> 4639</span>&#160;    <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;LV: Unrolling to reduce branch cost.\n&quot;</span>);</div><div class="line"><a name="l04640"></a><span class="lineno"> 4640</span>&#160;    <span class="keywordtype">unsigned</span> NewUF = SmallLoopCost / (LoopCost + 1);</div><div class="line"><a name="l04641"></a><span class="lineno"> 4641</span>&#160;    <span class="keywordflow">return</span> std::min(NewUF, UF);</div><div class="line"><a name="l04642"></a><span class="lineno"> 4642</span>&#160;  }</div><div class="line"><a name="l04643"></a><span class="lineno"> 4643</span>&#160;</div><div class="line"><a name="l04644"></a><span class="lineno"> 4644</span>&#160;  <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;LV: Not Unrolling.\n&quot;</span>);</div><div class="line"><a name="l04645"></a><span class="lineno"> 4645</span>&#160;  <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l04646"></a><span class="lineno"> 4646</span>&#160;}</div><div class="line"><a name="l04647"></a><span class="lineno"> 4647</span>&#160;</div><div class="line"><a name="l04648"></a><span class="lineno"> 4648</span>&#160;LoopVectorizationCostModel::RegisterUsage</div><div class="line"><a name="l04649"></a><span class="lineno"> 4649</span>&#160;LoopVectorizationCostModel::calculateRegisterUsage() {</div><div class="line"><a name="l04650"></a><span class="lineno"> 4650</span>&#160;  <span class="comment">// This function calculates the register usage by measuring the highest number</span></div><div class="line"><a name="l04651"></a><span class="lineno"> 4651</span>&#160;  <span class="comment">// of values that are alive at a single location. Obviously, this is a very</span></div><div class="line"><a name="l04652"></a><span class="lineno"> 4652</span>&#160;  <span class="comment">// rough estimation. We scan the loop in a topological order in order and</span></div><div class="line"><a name="l04653"></a><span class="lineno"> 4653</span>&#160;  <span class="comment">// assign a number to each instruction. We use RPO to ensure that defs are</span></div><div class="line"><a name="l04654"></a><span class="lineno"> 4654</span>&#160;  <span class="comment">// met before their users. We assume that each instruction that has in-loop</span></div><div class="line"><a name="l04655"></a><span class="lineno"> 4655</span>&#160;  <span class="comment">// users starts an interval. We record every time that an in-loop value is</span></div><div class="line"><a name="l04656"></a><span class="lineno"> 4656</span>&#160;  <span class="comment">// used, so we have a list of the first and last occurrences of each</span></div><div class="line"><a name="l04657"></a><span class="lineno"> 4657</span>&#160;  <span class="comment">// instruction. Next, we transpose this data structure into a multi map that</span></div><div class="line"><a name="l04658"></a><span class="lineno"> 4658</span>&#160;  <span class="comment">// holds the list of intervals that *end* at a specific location. This multi</span></div><div class="line"><a name="l04659"></a><span class="lineno"> 4659</span>&#160;  <span class="comment">// map allows us to perform a linear search. We scan the instructions linearly</span></div><div class="line"><a name="l04660"></a><span class="lineno"> 4660</span>&#160;  <span class="comment">// and record each time that a new interval starts, by placing it in a set.</span></div><div class="line"><a name="l04661"></a><span class="lineno"> 4661</span>&#160;  <span class="comment">// If we find this value in the multi-map then we remove it from the set.</span></div><div class="line"><a name="l04662"></a><span class="lineno"> 4662</span>&#160;  <span class="comment">// The max register usage is the maximum size of the set.</span></div><div class="line"><a name="l04663"></a><span class="lineno"> 4663</span>&#160;  <span class="comment">// We also search for instructions that are defined outside the loop, but are</span></div><div class="line"><a name="l04664"></a><span class="lineno"> 4664</span>&#160;  <span class="comment">// used inside the loop. We need this number separately from the max-interval</span></div><div class="line"><a name="l04665"></a><span class="lineno"> 4665</span>&#160;  <span class="comment">// usage number because when we unroll, loop-invariant values do not take</span></div><div class="line"><a name="l04666"></a><span class="lineno"> 4666</span>&#160;  <span class="comment">// more register.</span></div><div class="line"><a name="l04667"></a><span class="lineno"> 4667</span>&#160;  <a class="code" href="classllvm_1_1LoopBlocksDFS.html">LoopBlocksDFS</a> DFS(TheLoop);</div><div class="line"><a name="l04668"></a><span class="lineno"> 4668</span>&#160;  DFS.<a class="code" href="classllvm_1_1LoopBlocksDFS.html#ab38fc97602eaec1838f2b86624001ae1">perform</a>(LI);</div><div class="line"><a name="l04669"></a><span class="lineno"> 4669</span>&#160;</div><div class="line"><a name="l04670"></a><span class="lineno"> 4670</span>&#160;  RegisterUsage R;</div><div class="line"><a name="l04671"></a><span class="lineno"> 4671</span>&#160;  R.NumInstructions = 0;</div><div class="line"><a name="l04672"></a><span class="lineno"> 4672</span>&#160;</div><div class="line"><a name="l04673"></a><span class="lineno"> 4673</span>&#160;  <span class="comment">// Each &#39;key&#39; in the map opens a new interval. The values</span></div><div class="line"><a name="l04674"></a><span class="lineno"> 4674</span>&#160;  <span class="comment">// of the map are the index of the &#39;last seen&#39; usage of the</span></div><div class="line"><a name="l04675"></a><span class="lineno"> 4675</span>&#160;  <span class="comment">// instruction that is the key.</span></div><div class="line"><a name="l04676"></a><span class="lineno"> 4676</span>&#160;  <span class="keyword">typedef</span> <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;Instruction*, unsigned&gt;</a> <a class="code" href="classllvm_1_1IntervalMap.html">IntervalMap</a>;</div><div class="line"><a name="l04677"></a><span class="lineno"> 4677</span>&#160;  <span class="comment">// Maps instruction to its index.</span></div><div class="line"><a name="l04678"></a><span class="lineno"> 4678</span>&#160;  <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;unsigned, Instruction*&gt;</a> IdxToInstr;</div><div class="line"><a name="l04679"></a><span class="lineno"> 4679</span>&#160;  <span class="comment">// Marks the end of each interval.</span></div><div class="line"><a name="l04680"></a><span class="lineno"> 4680</span>&#160;  IntervalMap EndPoint;</div><div class="line"><a name="l04681"></a><span class="lineno"> 4681</span>&#160;  <span class="comment">// Saves the list of instruction indices that are used in the loop.</span></div><div class="line"><a name="l04682"></a><span class="lineno"> 4682</span>&#160;  <a class="code" href="classllvm_1_1SmallSet.html">SmallSet&lt;Instruction*, 8&gt;</a> Ends;</div><div class="line"><a name="l04683"></a><span class="lineno"> 4683</span>&#160;  <span class="comment">// Saves the list of values that are used in the loop but are</span></div><div class="line"><a name="l04684"></a><span class="lineno"> 4684</span>&#160;  <span class="comment">// defined outside the loop, such as arguments and constants.</span></div><div class="line"><a name="l04685"></a><span class="lineno"> 4685</span>&#160;  <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;Value*, 8&gt;</a> LoopInvariants;</div><div class="line"><a name="l04686"></a><span class="lineno"> 4686</span>&#160;</div><div class="line"><a name="l04687"></a><span class="lineno"> 4687</span>&#160;  <span class="keywordtype">unsigned</span> Index = 0;</div><div class="line"><a name="l04688"></a><span class="lineno"> 4688</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1LoopBlocksDFS.html#a0c1bb1134650f3f69f5921d57fb50b78">LoopBlocksDFS::RPOIterator</a> <a class="code" href="Target_2X86_2README_8txt.html#ac9423a63151469d95755528cceb322fb">bb</a> = DFS.<a class="code" href="classllvm_1_1LoopBlocksDFS.html#a68caba9c5912b27ddbf05e2541ec4aaf">beginRPO</a>(),</div><div class="line"><a name="l04689"></a><span class="lineno"> 4689</span>&#160;       <a class="code" href="CodeGen_2README_8txt.html#aa0629dbc89f0868f62da8cbcb681b2be">be</a> = DFS.<a class="code" href="classllvm_1_1LoopBlocksDFS.html#a7d9c121f1346f2c68017838acb57c7e8">endRPO</a>(); <a class="code" href="Target_2X86_2README_8txt.html#ac9423a63151469d95755528cceb322fb">bb</a> != <a class="code" href="CodeGen_2README_8txt.html#aa0629dbc89f0868f62da8cbcb681b2be">be</a>; ++<a class="code" href="Target_2X86_2README_8txt.html#ac9423a63151469d95755528cceb322fb">bb</a>) {</div><div class="line"><a name="l04690"></a><span class="lineno"> 4690</span>&#160;    R.NumInstructions += (*bb)-&gt;size();</div><div class="line"><a name="l04691"></a><span class="lineno"> 4691</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1ilist__iterator.html">BasicBlock::iterator</a> <a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a> = (*bb)-&gt;begin(), e = (*bb)-&gt;end(); <a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a> != e;</div><div class="line"><a name="l04692"></a><span class="lineno"> 4692</span>&#160;         ++<a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a>) {</div><div class="line"><a name="l04693"></a><span class="lineno"> 4693</span>&#160;      <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *I = <a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a>;</div><div class="line"><a name="l04694"></a><span class="lineno"> 4694</span>&#160;      IdxToInstr[Index++] = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>;</div><div class="line"><a name="l04695"></a><span class="lineno"> 4695</span>&#160;</div><div class="line"><a name="l04696"></a><span class="lineno"> 4696</span>&#160;      <span class="comment">// Save the end location of each USE.</span></div><div class="line"><a name="l04697"></a><span class="lineno"> 4697</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; I-&gt;<a class="code" href="classllvm_1_1User.html#a2f81e0c1fc6554df7ad2eafabf5fc5a5">getNumOperands</a>(); ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l04698"></a><span class="lineno"> 4698</span>&#160;        <a class="code" href="classllvm_1_1Value.html">Value</a> *U = I-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l04699"></a><span class="lineno"> 4699</span>&#160;        <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *Instr = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1Instruction.html">Instruction</a>&gt;(U);</div><div class="line"><a name="l04700"></a><span class="lineno"> 4700</span>&#160;</div><div class="line"><a name="l04701"></a><span class="lineno"> 4701</span>&#160;        <span class="comment">// Ignore non-instruction values such as arguments, constants, etc.</span></div><div class="line"><a name="l04702"></a><span class="lineno"> 4702</span>&#160;        <span class="keywordflow">if</span> (!Instr) <span class="keywordflow">continue</span>;</div><div class="line"><a name="l04703"></a><span class="lineno"> 4703</span>&#160;</div><div class="line"><a name="l04704"></a><span class="lineno"> 4704</span>&#160;        <span class="comment">// If this instruction is outside the loop then record it and continue.</span></div><div class="line"><a name="l04705"></a><span class="lineno"> 4705</span>&#160;        <span class="keywordflow">if</span> (!TheLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a92a38e2e3412bde7fd2b71db212b61aa">contains</a>(Instr)) {</div><div class="line"><a name="l04706"></a><span class="lineno"> 4706</span>&#160;          LoopInvariants.<a class="code" href="classllvm_1_1SmallPtrSet.html#a9b6dd0fc7a648a939e571246045b673e">insert</a>(Instr);</div><div class="line"><a name="l04707"></a><span class="lineno"> 4707</span>&#160;          <span class="keywordflow">continue</span>;</div><div class="line"><a name="l04708"></a><span class="lineno"> 4708</span>&#160;        }</div><div class="line"><a name="l04709"></a><span class="lineno"> 4709</span>&#160;</div><div class="line"><a name="l04710"></a><span class="lineno"> 4710</span>&#160;        <span class="comment">// Overwrite previous end points.</span></div><div class="line"><a name="l04711"></a><span class="lineno"> 4711</span>&#160;        EndPoint[Instr] = Index;</div><div class="line"><a name="l04712"></a><span class="lineno"> 4712</span>&#160;        Ends.<a class="code" href="classllvm_1_1SmallSet.html#a8d8348060ccdeeba13fb8bc651dfbf82">insert</a>(Instr);</div><div class="line"><a name="l04713"></a><span class="lineno"> 4713</span>&#160;      }</div><div class="line"><a name="l04714"></a><span class="lineno"> 4714</span>&#160;    }</div><div class="line"><a name="l04715"></a><span class="lineno"> 4715</span>&#160;  }</div><div class="line"><a name="l04716"></a><span class="lineno"> 4716</span>&#160;</div><div class="line"><a name="l04717"></a><span class="lineno"> 4717</span>&#160;  <span class="comment">// Saves the list of intervals that end with the index in &#39;key&#39;.</span></div><div class="line"><a name="l04718"></a><span class="lineno"> 4718</span>&#160;  <span class="keyword">typedef</span> <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Instruction*, 2&gt;</a> InstrList;</div><div class="line"><a name="l04719"></a><span class="lineno"> 4719</span>&#160;  <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;unsigned, InstrList&gt;</a> TransposeEnds;</div><div class="line"><a name="l04720"></a><span class="lineno"> 4720</span>&#160;</div><div class="line"><a name="l04721"></a><span class="lineno"> 4721</span>&#160;  <span class="comment">// Transpose the EndPoints to a list of values that end at each index.</span></div><div class="line"><a name="l04722"></a><span class="lineno"> 4722</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1IntervalMap_1_1iterator.html">IntervalMap::iterator</a> <a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a> = EndPoint.<a class="code" href="classllvm_1_1IntervalMap.html#aaa6329ac17c770c00c849c74fbe1c7b4">begin</a>(), e = EndPoint.<a class="code" href="classllvm_1_1IntervalMap.html#a51e234ecb8eb36b77d36c3585f4d094b">end</a>();</div><div class="line"><a name="l04723"></a><span class="lineno"> 4723</span>&#160;       <a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a> != e; ++<a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a>)</div><div class="line"><a name="l04724"></a><span class="lineno"> 4724</span>&#160;    TransposeEnds[<a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a>-&gt;second].push_back(<a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a>-&gt;first);</div><div class="line"><a name="l04725"></a><span class="lineno"> 4725</span>&#160;</div><div class="line"><a name="l04726"></a><span class="lineno"> 4726</span>&#160;  <a class="code" href="classllvm_1_1SmallSet.html">SmallSet&lt;Instruction*, 8&gt;</a> OpenIntervals;</div><div class="line"><a name="l04727"></a><span class="lineno"> 4727</span>&#160;  <span class="keywordtype">unsigned</span> MaxUsage = 0;</div><div class="line"><a name="l04728"></a><span class="lineno"> 4728</span>&#160;</div><div class="line"><a name="l04729"></a><span class="lineno"> 4729</span>&#160;</div><div class="line"><a name="l04730"></a><span class="lineno"> 4730</span>&#160;  <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;LV(REG): Calculating max register usage:\n&quot;</span>);</div><div class="line"><a name="l04731"></a><span class="lineno"> 4731</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; Index; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l04732"></a><span class="lineno"> 4732</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *I = IdxToInstr[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div><div class="line"><a name="l04733"></a><span class="lineno"> 4733</span>&#160;    <span class="comment">// Ignore instructions that are never used within the loop.</span></div><div class="line"><a name="l04734"></a><span class="lineno"> 4734</span>&#160;    <span class="keywordflow">if</span> (!Ends.<a class="code" href="classllvm_1_1SmallSet.html#ab28aa342862f6d16361be514fd98c22e">count</a>(I)) <span class="keywordflow">continue</span>;</div><div class="line"><a name="l04735"></a><span class="lineno"> 4735</span>&#160;</div><div class="line"><a name="l04736"></a><span class="lineno"> 4736</span>&#160;    <span class="comment">// Remove all of the instructions that end at this location.</span></div><div class="line"><a name="l04737"></a><span class="lineno"> 4737</span>&#160;    InstrList &amp;<a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5afef9bccea014fbcc9d61070cb7dbb5ff">List</a> = TransposeEnds[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div><div class="line"><a name="l04738"></a><span class="lineno"> 4738</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a>=0, e = List.size(); <a class="code" href="Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a> &lt; e; ++<a class="code" href="Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a>)</div><div class="line"><a name="l04739"></a><span class="lineno"> 4739</span>&#160;      OpenIntervals.<a class="code" href="classllvm_1_1SmallSet.html#a75a2d2ad3b3dce6702750d570ee8f343">erase</a>(List[<a class="code" href="Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a>]);</div><div class="line"><a name="l04740"></a><span class="lineno"> 4740</span>&#160;</div><div class="line"><a name="l04741"></a><span class="lineno"> 4741</span>&#160;    <span class="comment">// Count the number of live interals.</span></div><div class="line"><a name="l04742"></a><span class="lineno"> 4742</span>&#160;    MaxUsage = std::max(MaxUsage, OpenIntervals.<a class="code" href="classllvm_1_1SmallSet.html#a12d5f426acafa2dea032861636976889">size</a>());</div><div class="line"><a name="l04743"></a><span class="lineno"> 4743</span>&#160;</div><div class="line"><a name="l04744"></a><span class="lineno"> 4744</span>&#160;    <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;LV(REG): At #&quot;</span> &lt;&lt; <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt;&lt; <span class="stringliteral">&quot; Interval # &quot;</span> &lt;&lt;</div><div class="line"><a name="l04745"></a><span class="lineno"> 4745</span>&#160;          OpenIntervals.<a class="code" href="classllvm_1_1SmallSet.html#a12d5f426acafa2dea032861636976889">size</a>() &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>);</div><div class="line"><a name="l04746"></a><span class="lineno"> 4746</span>&#160;</div><div class="line"><a name="l04747"></a><span class="lineno"> 4747</span>&#160;    <span class="comment">// Add the current instruction to the list of open intervals.</span></div><div class="line"><a name="l04748"></a><span class="lineno"> 4748</span>&#160;    OpenIntervals.<a class="code" href="classllvm_1_1SmallSet.html#a8d8348060ccdeeba13fb8bc651dfbf82">insert</a>(I);</div><div class="line"><a name="l04749"></a><span class="lineno"> 4749</span>&#160;  }</div><div class="line"><a name="l04750"></a><span class="lineno"> 4750</span>&#160;</div><div class="line"><a name="l04751"></a><span class="lineno"> 4751</span>&#160;  <span class="keywordtype">unsigned</span> Invariant = LoopInvariants.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#a41c201584742f7eb45b2be8cd54e3bcb">size</a>();</div><div class="line"><a name="l04752"></a><span class="lineno"> 4752</span>&#160;  <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;LV(REG): Found max usage: &quot;</span> &lt;&lt; MaxUsage &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>);</div><div class="line"><a name="l04753"></a><span class="lineno"> 4753</span>&#160;  <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;LV(REG): Found invariant usage: &quot;</span> &lt;&lt; Invariant &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>);</div><div class="line"><a name="l04754"></a><span class="lineno"> 4754</span>&#160;  <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;LV(REG): LoopSize: &quot;</span> &lt;&lt; R.NumInstructions &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>);</div><div class="line"><a name="l04755"></a><span class="lineno"> 4755</span>&#160;</div><div class="line"><a name="l04756"></a><span class="lineno"> 4756</span>&#160;  R.LoopInvariantRegs = Invariant;</div><div class="line"><a name="l04757"></a><span class="lineno"> 4757</span>&#160;  R.MaxLocalUsers = MaxUsage;</div><div class="line"><a name="l04758"></a><span class="lineno"> 4758</span>&#160;  <span class="keywordflow">return</span> R;</div><div class="line"><a name="l04759"></a><span class="lineno"> 4759</span>&#160;}</div><div class="line"><a name="l04760"></a><span class="lineno"> 4760</span>&#160;</div><div class="line"><a name="l04761"></a><span class="lineno"> 4761</span>&#160;<span class="keywordtype">unsigned</span> LoopVectorizationCostModel::expectedCost(<span class="keywordtype">unsigned</span> VF) {</div><div class="line"><a name="l04762"></a><span class="lineno"> 4762</span>&#160;  <span class="keywordtype">unsigned</span> Cost = 0;</div><div class="line"><a name="l04763"></a><span class="lineno"> 4763</span>&#160;</div><div class="line"><a name="l04764"></a><span class="lineno"> 4764</span>&#160;  <span class="comment">// For each block.</span></div><div class="line"><a name="l04765"></a><span class="lineno"> 4765</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1LoopBase.html#ab39f9623eaa8cd22213aa716c6fb9994">Loop::block_iterator</a> <a class="code" href="Target_2X86_2README_8txt.html#ac9423a63151469d95755528cceb322fb">bb</a> = TheLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a3df1c508a7b1c89247367cab269076e2">block_begin</a>(),</div><div class="line"><a name="l04766"></a><span class="lineno"> 4766</span>&#160;       <a class="code" href="CodeGen_2README_8txt.html#aa0629dbc89f0868f62da8cbcb681b2be">be</a> = TheLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a91e3f5f9bf6ecbd058624a479e150603">block_end</a>(); <a class="code" href="Target_2X86_2README_8txt.html#ac9423a63151469d95755528cceb322fb">bb</a> != <a class="code" href="CodeGen_2README_8txt.html#aa0629dbc89f0868f62da8cbcb681b2be">be</a>; ++<a class="code" href="Target_2X86_2README_8txt.html#ac9423a63151469d95755528cceb322fb">bb</a>) {</div><div class="line"><a name="l04767"></a><span class="lineno"> 4767</span>&#160;    <span class="keywordtype">unsigned</span> BlockCost = 0;</div><div class="line"><a name="l04768"></a><span class="lineno"> 4768</span>&#160;    <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *BB = *<a class="code" href="Target_2X86_2README_8txt.html#ac9423a63151469d95755528cceb322fb">bb</a>;</div><div class="line"><a name="l04769"></a><span class="lineno"> 4769</span>&#160;</div><div class="line"><a name="l04770"></a><span class="lineno"> 4770</span>&#160;    <span class="comment">// For each instruction in the old loop.</span></div><div class="line"><a name="l04771"></a><span class="lineno"> 4771</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1ilist__iterator.html">BasicBlock::iterator</a> <a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a> = BB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a0ed5f3ab3c2e4196ee0cffffa080c062">begin</a>(), e = BB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a0b4e7bee9b8575cc7db73329f1a561bd">end</a>(); <a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a> != e; ++<a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a>) {</div><div class="line"><a name="l04772"></a><span class="lineno"> 4772</span>&#160;      <span class="comment">// Skip dbg intrinsics.</span></div><div class="line"><a name="l04773"></a><span class="lineno"> 4773</span>&#160;      <span class="keywordflow">if</span> (isa&lt;DbgInfoIntrinsic&gt;(<a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a>))</div><div class="line"><a name="l04774"></a><span class="lineno"> 4774</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l04775"></a><span class="lineno"> 4775</span>&#160;</div><div class="line"><a name="l04776"></a><span class="lineno"> 4776</span>&#160;      <span class="keywordtype">unsigned</span> <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = getInstructionCost(<a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a>, VF);</div><div class="line"><a name="l04777"></a><span class="lineno"> 4777</span>&#160;      BlockCost += <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>;</div><div class="line"><a name="l04778"></a><span class="lineno"> 4778</span>&#160;      <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;LV: Found an estimated cost of &quot;</span> &lt;&lt; C &lt;&lt; <span class="stringliteral">&quot; for VF &quot;</span> &lt;&lt;</div><div class="line"><a name="l04779"></a><span class="lineno"> 4779</span>&#160;            VF &lt;&lt; <span class="stringliteral">&quot; For instruction: &quot;</span> &lt;&lt; *<a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a> &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>);</div><div class="line"><a name="l04780"></a><span class="lineno"> 4780</span>&#160;    }</div><div class="line"><a name="l04781"></a><span class="lineno"> 4781</span>&#160;</div><div class="line"><a name="l04782"></a><span class="lineno"> 4782</span>&#160;    <span class="comment">// We assume that if-converted blocks have a 50% chance of being executed.</span></div><div class="line"><a name="l04783"></a><span class="lineno"> 4783</span>&#160;    <span class="comment">// When the code is scalar then some of the blocks are avoided due to CF.</span></div><div class="line"><a name="l04784"></a><span class="lineno"> 4784</span>&#160;    <span class="comment">// When the code is vectorized we execute all code paths.</span></div><div class="line"><a name="l04785"></a><span class="lineno"> 4785</span>&#160;    <span class="keywordflow">if</span> (VF == 1 &amp;&amp; Legal-&gt;blockNeedsPredication(*<a class="code" href="Target_2X86_2README_8txt.html#ac9423a63151469d95755528cceb322fb">bb</a>))</div><div class="line"><a name="l04786"></a><span class="lineno"> 4786</span>&#160;      BlockCost /= 2;</div><div class="line"><a name="l04787"></a><span class="lineno"> 4787</span>&#160;</div><div class="line"><a name="l04788"></a><span class="lineno"> 4788</span>&#160;    Cost += BlockCost;</div><div class="line"><a name="l04789"></a><span class="lineno"> 4789</span>&#160;  }</div><div class="line"><a name="l04790"></a><span class="lineno"> 4790</span>&#160;</div><div class="line"><a name="l04791"></a><span class="lineno"> 4791</span>&#160;  <span class="keywordflow">return</span> Cost;</div><div class="line"><a name="l04792"></a><span class="lineno"> 4792</span>&#160;}</div><div class="line"><a name="l04793"></a><span class="lineno"> 4793</span>&#160;<span class="comment"></span></div><div class="line"><a name="l04794"></a><span class="lineno"> 4794</span>&#160;<span class="comment">/// \brief Check whether the address computation for a non-consecutive memory</span></div><div class="line"><a name="l04795"></a><span class="lineno"> 4795</span>&#160;<span class="comment">/// access looks like an unlikely candidate for being merged into the indexing</span></div><div class="line"><a name="l04796"></a><span class="lineno"> 4796</span>&#160;<span class="comment">/// mode.</span></div><div class="line"><a name="l04797"></a><span class="lineno"> 4797</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l04798"></a><span class="lineno"> 4798</span>&#160;<span class="comment">/// We look for a GEP which has one index that is an induction variable and all</span></div><div class="line"><a name="l04799"></a><span class="lineno"> 4799</span>&#160;<span class="comment">/// other indices are loop invariant. If the stride of this access is also</span></div><div class="line"><a name="l04800"></a><span class="lineno"> 4800</span>&#160;<span class="comment">/// within a small bound we decide that this address computation can likely be</span></div><div class="line"><a name="l04801"></a><span class="lineno"> 4801</span>&#160;<span class="comment">/// merged into the addressing mode.</span></div><div class="line"><a name="l04802"></a><span class="lineno"> 4802</span>&#160;<span class="comment">/// In all other cases, we identify the address computation as complex.</span></div><div class="line"><a name="l04803"></a><span class="lineno"><a class="line" href="LoopVectorize_8cpp.html#a629b5a7c606c6557464a43689baadd7c"> 4803</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="LoopVectorize_8cpp.html#a629b5a7c606c6557464a43689baadd7c">isLikelyComplexAddressComputation</a>(<a class="code" href="classllvm_1_1Value.html">Value</a> *Ptr,</div><div class="line"><a name="l04804"></a><span class="lineno"> 4804</span>&#160;                                              LoopVectorizationLegality *Legal,</div><div class="line"><a name="l04805"></a><span class="lineno"> 4805</span>&#160;                                              <a class="code" href="classllvm_1_1ScalarEvolution.html">ScalarEvolution</a> *SE,</div><div class="line"><a name="l04806"></a><span class="lineno"> 4806</span>&#160;                                              <span class="keyword">const</span> <a class="code" href="classllvm_1_1Loop.html">Loop</a> *TheLoop) {</div><div class="line"><a name="l04807"></a><span class="lineno"> 4807</span>&#160;  <a class="code" href="classllvm_1_1GetElementPtrInst.html">GetElementPtrInst</a> *Gep = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1GetElementPtrInst.html">GetElementPtrInst</a>&gt;(Ptr);</div><div class="line"><a name="l04808"></a><span class="lineno"> 4808</span>&#160;  <span class="keywordflow">if</span> (!Gep)</div><div class="line"><a name="l04809"></a><span class="lineno"> 4809</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l04810"></a><span class="lineno"> 4810</span>&#160;</div><div class="line"><a name="l04811"></a><span class="lineno"> 4811</span>&#160;  <span class="comment">// We are looking for a gep with all loop invariant indices except for one</span></div><div class="line"><a name="l04812"></a><span class="lineno"> 4812</span>&#160;  <span class="comment">// which should be an induction variable.</span></div><div class="line"><a name="l04813"></a><span class="lineno"> 4813</span>&#160;  <span class="keywordtype">unsigned</span> NumOperands = Gep-&gt;<a class="code" href="classllvm_1_1User.html#a2f81e0c1fc6554df7ad2eafabf5fc5a5">getNumOperands</a>();</div><div class="line"><a name="l04814"></a><span class="lineno"> 4814</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 1; <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; NumOperands; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l04815"></a><span class="lineno"> 4815</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *Opd = Gep-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l04816"></a><span class="lineno"> 4816</span>&#160;    <span class="keywordflow">if</span> (!SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a5a19768af81df7e5fe571bc08dcd48b3">isLoopInvariant</a>(SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a30bd18ac905eacf3601bc6a553a9ff49">getSCEV</a>(Opd), TheLoop) &amp;&amp;</div><div class="line"><a name="l04817"></a><span class="lineno"> 4817</span>&#160;        !Legal-&gt;isInductionVariable(Opd))</div><div class="line"><a name="l04818"></a><span class="lineno"> 4818</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l04819"></a><span class="lineno"> 4819</span>&#160;  }</div><div class="line"><a name="l04820"></a><span class="lineno"> 4820</span>&#160;</div><div class="line"><a name="l04821"></a><span class="lineno"> 4821</span>&#160;  <span class="comment">// Now we know we have a GEP ptr, %inv, %ind, %inv. Make sure that the step</span></div><div class="line"><a name="l04822"></a><span class="lineno"> 4822</span>&#160;  <span class="comment">// can likely be merged into the address computation.</span></div><div class="line"><a name="l04823"></a><span class="lineno"> 4823</span>&#160;  <span class="keywordtype">unsigned</span> MaxMergeDistance = 64;</div><div class="line"><a name="l04824"></a><span class="lineno"> 4824</span>&#160;</div><div class="line"><a name="l04825"></a><span class="lineno"> 4825</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEVAddRecExpr.html">SCEVAddRecExpr</a> *AddRec = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1SCEVAddRecExpr.html">SCEVAddRecExpr</a>&gt;(SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a30bd18ac905eacf3601bc6a553a9ff49">getSCEV</a>(Ptr));</div><div class="line"><a name="l04826"></a><span class="lineno"> 4826</span>&#160;  <span class="keywordflow">if</span> (!AddRec)</div><div class="line"><a name="l04827"></a><span class="lineno"> 4827</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l04828"></a><span class="lineno"> 4828</span>&#160;</div><div class="line"><a name="l04829"></a><span class="lineno"> 4829</span>&#160;  <span class="comment">// Check the step is constant.</span></div><div class="line"><a name="l04830"></a><span class="lineno"> 4830</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *Step = AddRec-&gt;<a class="code" href="classllvm_1_1SCEVAddRecExpr.html#a443e9130cd9f3e3baaa1b566e6aa5060">getStepRecurrence</a>(*SE);</div><div class="line"><a name="l04831"></a><span class="lineno"> 4831</span>&#160;  <span class="comment">// Calculate the pointer stride and check if it is consecutive.</span></div><div class="line"><a name="l04832"></a><span class="lineno"> 4832</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEVConstant.html">SCEVConstant</a> *<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1SCEVConstant.html">SCEVConstant</a>&gt;(Step);</div><div class="line"><a name="l04833"></a><span class="lineno"> 4833</span>&#160;  <span class="keywordflow">if</span> (!C)</div><div class="line"><a name="l04834"></a><span class="lineno"> 4834</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l04835"></a><span class="lineno"> 4835</span>&#160;</div><div class="line"><a name="l04836"></a><span class="lineno"> 4836</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1APInt.html">APInt</a> &amp;APStepVal = C-&gt;<a class="code" href="classllvm_1_1SCEVConstant.html#a64f0133adf37f9513005465580a19a66">getValue</a>()-&gt;<a class="code" href="classllvm_1_1ConstantInt.html#af8dde13a97efce293a7b04daf1e208fb">getValue</a>();</div><div class="line"><a name="l04837"></a><span class="lineno"> 4837</span>&#160;</div><div class="line"><a name="l04838"></a><span class="lineno"> 4838</span>&#160;  <span class="comment">// Huge step value - give up.</span></div><div class="line"><a name="l04839"></a><span class="lineno"> 4839</span>&#160;  <span class="keywordflow">if</span> (APStepVal.<a class="code" href="classllvm_1_1APInt.html#ad081689e23a8f5dea78dedd623d6a8f8">getBitWidth</a>() &gt; 64)</div><div class="line"><a name="l04840"></a><span class="lineno"> 4840</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l04841"></a><span class="lineno"> 4841</span>&#160;</div><div class="line"><a name="l04842"></a><span class="lineno"> 4842</span>&#160;  int64_t StepVal = APStepVal.<a class="code" href="classllvm_1_1APInt.html#a7189a37206963029447c31d57771b997">getSExtValue</a>();</div><div class="line"><a name="l04843"></a><span class="lineno"> 4843</span>&#160;</div><div class="line"><a name="l04844"></a><span class="lineno"> 4844</span>&#160;  <span class="keywordflow">return</span> StepVal &gt; MaxMergeDistance;</div><div class="line"><a name="l04845"></a><span class="lineno"> 4845</span>&#160;}</div><div class="line"><a name="l04846"></a><span class="lineno"> 4846</span>&#160;</div><div class="line"><a name="l04847"></a><span class="lineno"> 4847</span>&#160;<span class="keywordtype">unsigned</span></div><div class="line"><a name="l04848"></a><span class="lineno"> 4848</span>&#160;LoopVectorizationCostModel::getInstructionCost(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *I, <span class="keywordtype">unsigned</span> VF) {</div><div class="line"><a name="l04849"></a><span class="lineno"> 4849</span>&#160;  <span class="comment">// If we know that this instruction will remain uniform, check the cost of</span></div><div class="line"><a name="l04850"></a><span class="lineno"> 4850</span>&#160;  <span class="comment">// the scalar version.</span></div><div class="line"><a name="l04851"></a><span class="lineno"> 4851</span>&#160;  <span class="keywordflow">if</span> (Legal-&gt;isUniformAfterVectorization(I))</div><div class="line"><a name="l04852"></a><span class="lineno"> 4852</span>&#160;    VF = 1;</div><div class="line"><a name="l04853"></a><span class="lineno"> 4853</span>&#160;</div><div class="line"><a name="l04854"></a><span class="lineno"> 4854</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *RetTy = I-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>();</div><div class="line"><a name="l04855"></a><span class="lineno"> 4855</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *VectorTy = ToVectorTy(RetTy, VF);</div><div class="line"><a name="l04856"></a><span class="lineno"> 4856</span>&#160;</div><div class="line"><a name="l04857"></a><span class="lineno"> 4857</span>&#160;  <span class="comment">// TODO: We need to estimate the cost of intrinsic calls.</span></div><div class="line"><a name="l04858"></a><span class="lineno"> 4858</span>&#160;  <span class="keywordflow">switch</span> (I-&gt;<a class="code" href="classllvm_1_1Instruction.html#a021bb7c9aad6003fe8089f6327356c6c">getOpcode</a>()) {</div><div class="line"><a name="l04859"></a><span class="lineno"> 4859</span>&#160;  <span class="keywordflow">case</span> Instruction::GetElementPtr:</div><div class="line"><a name="l04860"></a><span class="lineno"> 4860</span>&#160;    <span class="comment">// We mark this instruction as zero-cost because the cost of GEPs in</span></div><div class="line"><a name="l04861"></a><span class="lineno"> 4861</span>&#160;    <span class="comment">// vectorized code depends on whether the corresponding memory instruction</span></div><div class="line"><a name="l04862"></a><span class="lineno"> 4862</span>&#160;    <span class="comment">// is scalarized or not. Therefore, we handle GEPs with the memory</span></div><div class="line"><a name="l04863"></a><span class="lineno"> 4863</span>&#160;    <span class="comment">// instruction cost.</span></div><div class="line"><a name="l04864"></a><span class="lineno"> 4864</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l04865"></a><span class="lineno"> 4865</span>&#160;  <span class="keywordflow">case</span> Instruction::Br: {</div><div class="line"><a name="l04866"></a><span class="lineno"> 4866</span>&#160;    <span class="keywordflow">return</span> TTI.getCFInstrCost(I-&gt;<a class="code" href="classllvm_1_1Instruction.html#a021bb7c9aad6003fe8089f6327356c6c">getOpcode</a>());</div><div class="line"><a name="l04867"></a><span class="lineno"> 4867</span>&#160;  }</div><div class="line"><a name="l04868"></a><span class="lineno"> 4868</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1TargetOpcode.html#a348d4259b5fa6a8ecfe94e7ae512e1a8ae41f9ca68ba5e8b9613cea03652ebd72">Instruction::PHI</a>:</div><div class="line"><a name="l04869"></a><span class="lineno"> 4869</span>&#160;    <span class="comment">//TODO: IF-converted IFs become selects.</span></div><div class="line"><a name="l04870"></a><span class="lineno"> 4870</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l04871"></a><span class="lineno"> 4871</span>&#160;  <span class="keywordflow">case</span> Instruction::Add:</div><div class="line"><a name="l04872"></a><span class="lineno"> 4872</span>&#160;  <span class="keywordflow">case</span> Instruction::FAdd:</div><div class="line"><a name="l04873"></a><span class="lineno"> 4873</span>&#160;  <span class="keywordflow">case</span> Instruction::Sub:</div><div class="line"><a name="l04874"></a><span class="lineno"> 4874</span>&#160;  <span class="keywordflow">case</span> Instruction::FSub:</div><div class="line"><a name="l04875"></a><span class="lineno"> 4875</span>&#160;  <span class="keywordflow">case</span> Instruction::Mul:</div><div class="line"><a name="l04876"></a><span class="lineno"> 4876</span>&#160;  <span class="keywordflow">case</span> Instruction::FMul:</div><div class="line"><a name="l04877"></a><span class="lineno"> 4877</span>&#160;  <span class="keywordflow">case</span> Instruction::UDiv:</div><div class="line"><a name="l04878"></a><span class="lineno"> 4878</span>&#160;  <span class="keywordflow">case</span> Instruction::SDiv:</div><div class="line"><a name="l04879"></a><span class="lineno"> 4879</span>&#160;  <span class="keywordflow">case</span> Instruction::FDiv:</div><div class="line"><a name="l04880"></a><span class="lineno"> 4880</span>&#160;  <span class="keywordflow">case</span> Instruction::URem:</div><div class="line"><a name="l04881"></a><span class="lineno"> 4881</span>&#160;  <span class="keywordflow">case</span> Instruction::SRem:</div><div class="line"><a name="l04882"></a><span class="lineno"> 4882</span>&#160;  <span class="keywordflow">case</span> Instruction::FRem:</div><div class="line"><a name="l04883"></a><span class="lineno"> 4883</span>&#160;  <span class="keywordflow">case</span> Instruction::Shl:</div><div class="line"><a name="l04884"></a><span class="lineno"> 4884</span>&#160;  <span class="keywordflow">case</span> Instruction::LShr:</div><div class="line"><a name="l04885"></a><span class="lineno"> 4885</span>&#160;  <span class="keywordflow">case</span> Instruction::AShr:</div><div class="line"><a name="l04886"></a><span class="lineno"> 4886</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1APIntOps.html#a684cfe02c582e8d75cd6d457e63e6c25">Instruction::And</a>:</div><div class="line"><a name="l04887"></a><span class="lineno"> 4887</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1APIntOps.html#a22f056804d2b9882f74adc905872bc39">Instruction::Or</a>:</div><div class="line"><a name="l04888"></a><span class="lineno"> 4888</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1APIntOps.html#afc7c4d88d09cba0c5e920f8a3a3ace55">Instruction::Xor</a>: {</div><div class="line"><a name="l04889"></a><span class="lineno"> 4889</span>&#160;    <span class="comment">// Certain instructions can be cheaper to vectorize if they have a constant</span></div><div class="line"><a name="l04890"></a><span class="lineno"> 4890</span>&#160;    <span class="comment">// second vector operand. One example of this are shifts on x86.</span></div><div class="line"><a name="l04891"></a><span class="lineno"> 4891</span>&#160;    <a class="code" href="classllvm_1_1TargetTransformInfo.html#afa38851d75434d1476444ac93f94cb4c">TargetTransformInfo::OperandValueKind</a> Op1VK =</div><div class="line"><a name="l04892"></a><span class="lineno"> 4892</span>&#160;      <a class="code" href="classllvm_1_1TargetTransformInfo.html#afa38851d75434d1476444ac93f94cb4ca9c0eecea29e9fa58e4dac7ee32b9b2ac">TargetTransformInfo::OK_AnyValue</a>;</div><div class="line"><a name="l04893"></a><span class="lineno"> 4893</span>&#160;    <a class="code" href="classllvm_1_1TargetTransformInfo.html#afa38851d75434d1476444ac93f94cb4c">TargetTransformInfo::OperandValueKind</a> Op2VK =</div><div class="line"><a name="l04894"></a><span class="lineno"> 4894</span>&#160;      <a class="code" href="classllvm_1_1TargetTransformInfo.html#afa38851d75434d1476444ac93f94cb4ca9c0eecea29e9fa58e4dac7ee32b9b2ac">TargetTransformInfo::OK_AnyValue</a>;</div><div class="line"><a name="l04895"></a><span class="lineno"> 4895</span>&#160;</div><div class="line"><a name="l04896"></a><span class="lineno"> 4896</span>&#160;    <span class="keywordflow">if</span> (isa&lt;ConstantInt&gt;(I-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(1)))</div><div class="line"><a name="l04897"></a><span class="lineno"> 4897</span>&#160;      Op2VK = <a class="code" href="classllvm_1_1TargetTransformInfo.html#afa38851d75434d1476444ac93f94cb4ca76d8855d96b8e66b9411ed74737ca8f7">TargetTransformInfo::OK_UniformConstantValue</a>;</div><div class="line"><a name="l04898"></a><span class="lineno"> 4898</span>&#160;</div><div class="line"><a name="l04899"></a><span class="lineno"> 4899</span>&#160;    <span class="keywordflow">return</span> TTI.getArithmeticInstrCost(I-&gt;<a class="code" href="classllvm_1_1Instruction.html#a021bb7c9aad6003fe8089f6327356c6c">getOpcode</a>(), VectorTy, Op1VK, Op2VK);</div><div class="line"><a name="l04900"></a><span class="lineno"> 4900</span>&#160;  }</div><div class="line"><a name="l04901"></a><span class="lineno"> 4901</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1MCID.html#a8035044d40d3758eb45b65dce69dc90ba32dbd2c72a98eaee90e3ad5ef7b5af16">Instruction::Select</a>: {</div><div class="line"><a name="l04902"></a><span class="lineno"> 4902</span>&#160;    <a class="code" href="classllvm_1_1SelectInst.html">SelectInst</a> *SI = cast&lt;SelectInst&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div><div class="line"><a name="l04903"></a><span class="lineno"> 4903</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *CondSCEV = SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a30bd18ac905eacf3601bc6a553a9ff49">getSCEV</a>(SI-&gt;<a class="code" href="classllvm_1_1SelectInst.html#ad285a69e32ddeee367fed93b5f392801">getCondition</a>());</div><div class="line"><a name="l04904"></a><span class="lineno"> 4904</span>&#160;    <span class="keywordtype">bool</span> ScalarCond = (SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a5a19768af81df7e5fe571bc08dcd48b3">isLoopInvariant</a>(CondSCEV, TheLoop));</div><div class="line"><a name="l04905"></a><span class="lineno"> 4905</span>&#160;    <a class="code" href="classllvm_1_1Type.html">Type</a> *CondTy = SI-&gt;<a class="code" href="classllvm_1_1SelectInst.html#ad285a69e32ddeee367fed93b5f392801">getCondition</a>()-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>();</div><div class="line"><a name="l04906"></a><span class="lineno"> 4906</span>&#160;    <span class="keywordflow">if</span> (!ScalarCond)</div><div class="line"><a name="l04907"></a><span class="lineno"> 4907</span>&#160;      CondTy = <a class="code" href="classllvm_1_1VectorType.html#ab43657ed1abe2e2ed3a6a394f233ebd0">VectorType::get</a>(CondTy, VF);</div><div class="line"><a name="l04908"></a><span class="lineno"> 4908</span>&#160;</div><div class="line"><a name="l04909"></a><span class="lineno"> 4909</span>&#160;    <span class="keywordflow">return</span> TTI.getCmpSelInstrCost(I-&gt;<a class="code" href="classllvm_1_1Instruction.html#a021bb7c9aad6003fe8089f6327356c6c">getOpcode</a>(), VectorTy, CondTy);</div><div class="line"><a name="l04910"></a><span class="lineno"> 4910</span>&#160;  }</div><div class="line"><a name="l04911"></a><span class="lineno"> 4911</span>&#160;  <span class="keywordflow">case</span> Instruction::ICmp:</div><div class="line"><a name="l04912"></a><span class="lineno"> 4912</span>&#160;  <span class="keywordflow">case</span> Instruction::FCmp: {</div><div class="line"><a name="l04913"></a><span class="lineno"> 4913</span>&#160;    <a class="code" href="classllvm_1_1Type.html">Type</a> *ValTy = I-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0)-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>();</div><div class="line"><a name="l04914"></a><span class="lineno"> 4914</span>&#160;    VectorTy = ToVectorTy(ValTy, VF);</div><div class="line"><a name="l04915"></a><span class="lineno"> 4915</span>&#160;    <span class="keywordflow">return</span> TTI.getCmpSelInstrCost(I-&gt;<a class="code" href="classllvm_1_1Instruction.html#a021bb7c9aad6003fe8089f6327356c6c">getOpcode</a>(), VectorTy);</div><div class="line"><a name="l04916"></a><span class="lineno"> 4916</span>&#160;  }</div><div class="line"><a name="l04917"></a><span class="lineno"> 4917</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1SPII.html#a11e9b8fca4a074643a6a21f444e51406a36b3dd3b84fde3f8494a9b18af131856">Instruction::Store</a>:</div><div class="line"><a name="l04918"></a><span class="lineno"> 4918</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1SPII.html#a11e9b8fca4a074643a6a21f444e51406a5069619ca8fdce305534f3fe85091a0f">Instruction::Load</a>: {</div><div class="line"><a name="l04919"></a><span class="lineno"> 4919</span>&#160;    <a class="code" href="classllvm_1_1StoreInst.html">StoreInst</a> *SI = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1StoreInst.html">StoreInst</a>&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div><div class="line"><a name="l04920"></a><span class="lineno"> 4920</span>&#160;    <a class="code" href="classllvm_1_1LoadInst.html">LoadInst</a> *LI = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1LoadInst.html">LoadInst</a>&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div><div class="line"><a name="l04921"></a><span class="lineno"> 4921</span>&#160;    <a class="code" href="classllvm_1_1Type.html">Type</a> *ValTy = (SI ? SI-&gt;<a class="code" href="classllvm_1_1StoreInst.html#a14298313bdf734e2db5a921cc6e861a0">getValueOperand</a>()-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>() :</div><div class="line"><a name="l04922"></a><span class="lineno"> 4922</span>&#160;                   LI-&gt;getType());</div><div class="line"><a name="l04923"></a><span class="lineno"> 4923</span>&#160;    VectorTy = ToVectorTy(ValTy, VF);</div><div class="line"><a name="l04924"></a><span class="lineno"> 4924</span>&#160;</div><div class="line"><a name="l04925"></a><span class="lineno"> 4925</span>&#160;    <span class="keywordtype">unsigned</span> Alignment = SI ? SI-&gt;<a class="code" href="classllvm_1_1StoreInst.html#a3084f1dd69d67e1965fd1fe721a69f2e">getAlignment</a>() : LI-&gt;getAlignment();</div><div class="line"><a name="l04926"></a><span class="lineno"> 4926</span>&#160;    <span class="keywordtype">unsigned</span> AS = SI ? SI-&gt;<a class="code" href="classllvm_1_1StoreInst.html#a6cac341b1b354174d0e0a81a2e7a9109">getPointerAddressSpace</a>() :</div><div class="line"><a name="l04927"></a><span class="lineno"> 4927</span>&#160;      LI-&gt;getPointerAddressSpace();</div><div class="line"><a name="l04928"></a><span class="lineno"> 4928</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *Ptr = SI ? SI-&gt;<a class="code" href="classllvm_1_1StoreInst.html#ac03c1c093059ea000216af8dd6f2dbf4">getPointerOperand</a>() : LI-&gt;getPointerOperand();</div><div class="line"><a name="l04929"></a><span class="lineno"> 4929</span>&#160;    <span class="comment">// We add the cost of address computation here instead of with the gep</span></div><div class="line"><a name="l04930"></a><span class="lineno"> 4930</span>&#160;    <span class="comment">// instruction because only here we know whether the operation is</span></div><div class="line"><a name="l04931"></a><span class="lineno"> 4931</span>&#160;    <span class="comment">// scalarized.</span></div><div class="line"><a name="l04932"></a><span class="lineno"> 4932</span>&#160;    <span class="keywordflow">if</span> (VF == 1)</div><div class="line"><a name="l04933"></a><span class="lineno"> 4933</span>&#160;      <span class="keywordflow">return</span> TTI.getAddressComputationCost(VectorTy) +</div><div class="line"><a name="l04934"></a><span class="lineno"> 4934</span>&#160;        TTI.getMemoryOpCost(I-&gt;<a class="code" href="classllvm_1_1Instruction.html#a021bb7c9aad6003fe8089f6327356c6c">getOpcode</a>(), VectorTy, Alignment, AS);</div><div class="line"><a name="l04935"></a><span class="lineno"> 4935</span>&#160;</div><div class="line"><a name="l04936"></a><span class="lineno"> 4936</span>&#160;    <span class="comment">// Scalarized loads/stores.</span></div><div class="line"><a name="l04937"></a><span class="lineno"> 4937</span>&#160;    <span class="keywordtype">int</span> ConsecutiveStride = Legal-&gt;isConsecutivePtr(Ptr);</div><div class="line"><a name="l04938"></a><span class="lineno"> 4938</span>&#160;    <span class="keywordtype">bool</span> Reverse = ConsecutiveStride &lt; 0;</div><div class="line"><a name="l04939"></a><span class="lineno"> 4939</span>&#160;    <span class="keywordtype">unsigned</span> ScalarAllocatedSize = DL-&gt;<a class="code" href="classllvm_1_1DataLayout.html#a1d6fcc02e91ba24510aba42660c90e29">getTypeAllocSize</a>(ValTy);</div><div class="line"><a name="l04940"></a><span class="lineno"> 4940</span>&#160;    <span class="keywordtype">unsigned</span> VectorElementSize = DL-&gt;<a class="code" href="classllvm_1_1DataLayout.html#a4b979cd93852fd44c48851c94ee00758">getTypeStoreSize</a>(VectorTy)/VF;</div><div class="line"><a name="l04941"></a><span class="lineno"> 4941</span>&#160;    <span class="keywordflow">if</span> (!ConsecutiveStride || ScalarAllocatedSize != VectorElementSize) {</div><div class="line"><a name="l04942"></a><span class="lineno"> 4942</span>&#160;      <span class="keywordtype">bool</span> IsComplexComputation =</div><div class="line"><a name="l04943"></a><span class="lineno"> 4943</span>&#160;        <a class="code" href="LoopVectorize_8cpp.html#a629b5a7c606c6557464a43689baadd7c">isLikelyComplexAddressComputation</a>(Ptr, Legal, SE, TheLoop);</div><div class="line"><a name="l04944"></a><span class="lineno"> 4944</span>&#160;      <span class="keywordtype">unsigned</span> Cost = 0;</div><div class="line"><a name="l04945"></a><span class="lineno"> 4945</span>&#160;      <span class="comment">// The cost of extracting from the value vector and pointer vector.</span></div><div class="line"><a name="l04946"></a><span class="lineno"> 4946</span>&#160;      <a class="code" href="classllvm_1_1Type.html">Type</a> *PtrTy = ToVectorTy(Ptr-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>(), VF);</div><div class="line"><a name="l04947"></a><span class="lineno"> 4947</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; VF; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l04948"></a><span class="lineno"> 4948</span>&#160;        <span class="comment">//  The cost of extracting the pointer operand.</span></div><div class="line"><a name="l04949"></a><span class="lineno"> 4949</span>&#160;        Cost += TTI.getVectorInstrCost(<a class="code" href="InstCombineCompares_8cpp.html#aa5ab8c7b55d8bc7cab66be444daa70a1">Instruction::ExtractElement</a>, PtrTy, <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l04950"></a><span class="lineno"> 4950</span>&#160;        <span class="comment">// In case of STORE, the cost of ExtractElement from the vector.</span></div><div class="line"><a name="l04951"></a><span class="lineno"> 4951</span>&#160;        <span class="comment">// In case of LOAD, the cost of InsertElement into the returned</span></div><div class="line"><a name="l04952"></a><span class="lineno"> 4952</span>&#160;        <span class="comment">// vector.</span></div><div class="line"><a name="l04953"></a><span class="lineno"> 4953</span>&#160;        Cost += TTI.getVectorInstrCost(SI ? <a class="code" href="InstCombineCompares_8cpp.html#aa5ab8c7b55d8bc7cab66be444daa70a1">Instruction::ExtractElement</a> :</div><div class="line"><a name="l04954"></a><span class="lineno"> 4954</span>&#160;                                            Instruction::InsertElement,</div><div class="line"><a name="l04955"></a><span class="lineno"> 4955</span>&#160;                                            VectorTy, <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l04956"></a><span class="lineno"> 4956</span>&#160;      }</div><div class="line"><a name="l04957"></a><span class="lineno"> 4957</span>&#160;</div><div class="line"><a name="l04958"></a><span class="lineno"> 4958</span>&#160;      <span class="comment">// The cost of the scalar loads/stores.</span></div><div class="line"><a name="l04959"></a><span class="lineno"> 4959</span>&#160;      Cost += VF * TTI.getAddressComputationCost(PtrTy, IsComplexComputation);</div><div class="line"><a name="l04960"></a><span class="lineno"> 4960</span>&#160;      Cost += VF * TTI.getMemoryOpCost(I-&gt;<a class="code" href="classllvm_1_1Instruction.html#a021bb7c9aad6003fe8089f6327356c6c">getOpcode</a>(), ValTy-&gt;getScalarType(),</div><div class="line"><a name="l04961"></a><span class="lineno"> 4961</span>&#160;                                       Alignment, AS);</div><div class="line"><a name="l04962"></a><span class="lineno"> 4962</span>&#160;      <span class="keywordflow">return</span> Cost;</div><div class="line"><a name="l04963"></a><span class="lineno"> 4963</span>&#160;    }</div><div class="line"><a name="l04964"></a><span class="lineno"> 4964</span>&#160;</div><div class="line"><a name="l04965"></a><span class="lineno"> 4965</span>&#160;    <span class="comment">// Wide load/stores.</span></div><div class="line"><a name="l04966"></a><span class="lineno"> 4966</span>&#160;    <span class="keywordtype">unsigned</span> Cost = TTI.getAddressComputationCost(VectorTy);</div><div class="line"><a name="l04967"></a><span class="lineno"> 4967</span>&#160;    Cost += TTI.getMemoryOpCost(I-&gt;<a class="code" href="classllvm_1_1Instruction.html#a021bb7c9aad6003fe8089f6327356c6c">getOpcode</a>(), VectorTy, Alignment, AS);</div><div class="line"><a name="l04968"></a><span class="lineno"> 4968</span>&#160;</div><div class="line"><a name="l04969"></a><span class="lineno"> 4969</span>&#160;    <span class="keywordflow">if</span> (Reverse)</div><div class="line"><a name="l04970"></a><span class="lineno"> 4970</span>&#160;      Cost += TTI.getShuffleCost(<a class="code" href="classllvm_1_1TargetTransformInfo.html#af46433d0e36d3f80afc3a8c67b5c53ecaea788d98147161f25d5adc3ec6ce7e1f">TargetTransformInfo::SK_Reverse</a>,</div><div class="line"><a name="l04971"></a><span class="lineno"> 4971</span>&#160;                                  VectorTy, 0);</div><div class="line"><a name="l04972"></a><span class="lineno"> 4972</span>&#160;    <span class="keywordflow">return</span> Cost;</div><div class="line"><a name="l04973"></a><span class="lineno"> 4973</span>&#160;  }</div><div class="line"><a name="l04974"></a><span class="lineno"> 4974</span>&#160;  <span class="keywordflow">case</span> Instruction::ZExt:</div><div class="line"><a name="l04975"></a><span class="lineno"> 4975</span>&#160;  <span class="keywordflow">case</span> Instruction::SExt:</div><div class="line"><a name="l04976"></a><span class="lineno"> 4976</span>&#160;  <span class="keywordflow">case</span> Instruction::FPToUI:</div><div class="line"><a name="l04977"></a><span class="lineno"> 4977</span>&#160;  <span class="keywordflow">case</span> Instruction::FPToSI:</div><div class="line"><a name="l04978"></a><span class="lineno"> 4978</span>&#160;  <span class="keywordflow">case</span> Instruction::FPExt:</div><div class="line"><a name="l04979"></a><span class="lineno"> 4979</span>&#160;  <span class="keywordflow">case</span> Instruction::PtrToInt:</div><div class="line"><a name="l04980"></a><span class="lineno"> 4980</span>&#160;  <span class="keywordflow">case</span> Instruction::IntToPtr:</div><div class="line"><a name="l04981"></a><span class="lineno"> 4981</span>&#160;  <span class="keywordflow">case</span> Instruction::SIToFP:</div><div class="line"><a name="l04982"></a><span class="lineno"> 4982</span>&#160;  <span class="keywordflow">case</span> Instruction::UIToFP:</div><div class="line"><a name="l04983"></a><span class="lineno"> 4983</span>&#160;  <span class="keywordflow">case</span> Instruction::Trunc:</div><div class="line"><a name="l04984"></a><span class="lineno"> 4984</span>&#160;  <span class="keywordflow">case</span> Instruction::FPTrunc:</div><div class="line"><a name="l04985"></a><span class="lineno"> 4985</span>&#160;  <span class="keywordflow">case</span> Instruction::BitCast: {</div><div class="line"><a name="l04986"></a><span class="lineno"> 4986</span>&#160;    <span class="comment">// We optimize the truncation of induction variable.</span></div><div class="line"><a name="l04987"></a><span class="lineno"> 4987</span>&#160;    <span class="comment">// The cost of these is the same as the scalar operation.</span></div><div class="line"><a name="l04988"></a><span class="lineno"> 4988</span>&#160;    <span class="keywordflow">if</span> (I-&gt;<a class="code" href="classllvm_1_1Instruction.html#a021bb7c9aad6003fe8089f6327356c6c">getOpcode</a>() == Instruction::Trunc &amp;&amp;</div><div class="line"><a name="l04989"></a><span class="lineno"> 4989</span>&#160;        Legal-&gt;isInductionVariable(I-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0)))</div><div class="line"><a name="l04990"></a><span class="lineno"> 4990</span>&#160;      <span class="keywordflow">return</span> TTI.getCastInstrCost(I-&gt;<a class="code" href="classllvm_1_1Instruction.html#a021bb7c9aad6003fe8089f6327356c6c">getOpcode</a>(), I-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>(),</div><div class="line"><a name="l04991"></a><span class="lineno"> 4991</span>&#160;                                  I-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0)-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>());</div><div class="line"><a name="l04992"></a><span class="lineno"> 4992</span>&#160;</div><div class="line"><a name="l04993"></a><span class="lineno"> 4993</span>&#160;    <a class="code" href="classllvm_1_1Type.html">Type</a> *SrcVecTy = ToVectorTy(I-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0)-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>(), VF);</div><div class="line"><a name="l04994"></a><span class="lineno"> 4994</span>&#160;    <span class="keywordflow">return</span> TTI.getCastInstrCost(I-&gt;<a class="code" href="classllvm_1_1Instruction.html#a021bb7c9aad6003fe8089f6327356c6c">getOpcode</a>(), VectorTy, SrcVecTy);</div><div class="line"><a name="l04995"></a><span class="lineno"> 4995</span>&#160;  }</div><div class="line"><a name="l04996"></a><span class="lineno"> 4996</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm.html#af6d6a791770bad2303c4399986979e3eae411369b2f0d8f484fec62c3291b1b51">Instruction::Call</a>: {</div><div class="line"><a name="l04997"></a><span class="lineno"> 4997</span>&#160;    <a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI = cast&lt;CallInst&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div><div class="line"><a name="l04998"></a><span class="lineno"> 4998</span>&#160;    <a class="code" href="namespacellvm_1_1Intrinsic.html#a73349916f7e54a6b988a3646c7a02e90">Intrinsic::ID</a> <a class="code" href="namespacellvm_1_1CallingConv.html#a4f861731fc6dbfdccc05af5968d98974">ID</a> = <a class="code" href="LoopVectorize_8cpp.html#a417c0c66aeccfcbee14042ec89bab074">getIntrinsicIDForCall</a>(CI, TLI);</div><div class="line"><a name="l04999"></a><span class="lineno"> 4999</span>&#160;    assert(ID &amp;&amp; <span class="stringliteral">&quot;Not an intrinsic call!&quot;</span>);</div><div class="line"><a name="l05000"></a><span class="lineno"> 5000</span>&#160;    <a class="code" href="classllvm_1_1Type.html">Type</a> *RetTy = ToVectorTy(CI-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>(), VF);</div><div class="line"><a name="l05001"></a><span class="lineno"> 5001</span>&#160;    <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Type*, 4&gt;</a> Tys;</div><div class="line"><a name="l05002"></a><span class="lineno"> 5002</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0, ie = CI-&gt;<a class="code" href="classllvm_1_1CallInst.html#ac88b95273e6c753188f6a54d65548579">getNumArgOperands</a>(); <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != ie; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div><div class="line"><a name="l05003"></a><span class="lineno"> 5003</span>&#160;      Tys.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(ToVectorTy(CI-&gt;<a class="code" href="classllvm_1_1CallInst.html#a150b33ecedbc8c7803c2db8040fbe3f8">getArgOperand</a>(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>)-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>(), VF));</div><div class="line"><a name="l05004"></a><span class="lineno"> 5004</span>&#160;    <span class="keywordflow">return</span> TTI.getIntrinsicInstrCost(ID, RetTy, Tys);</div><div class="line"><a name="l05005"></a><span class="lineno"> 5005</span>&#160;  }</div><div class="line"><a name="l05006"></a><span class="lineno"> 5006</span>&#160;  <span class="keywordflow">default</span>: {</div><div class="line"><a name="l05007"></a><span class="lineno"> 5007</span>&#160;    <span class="comment">// We are scalarizing the instruction. Return the cost of the scalar</span></div><div class="line"><a name="l05008"></a><span class="lineno"> 5008</span>&#160;    <span class="comment">// instruction, plus the cost of insert and extract into vector</span></div><div class="line"><a name="l05009"></a><span class="lineno"> 5009</span>&#160;    <span class="comment">// elements, times the vector width.</span></div><div class="line"><a name="l05010"></a><span class="lineno"> 5010</span>&#160;    <span class="keywordtype">unsigned</span> Cost = 0;</div><div class="line"><a name="l05011"></a><span class="lineno"> 5011</span>&#160;</div><div class="line"><a name="l05012"></a><span class="lineno"> 5012</span>&#160;    <span class="keywordflow">if</span> (!RetTy-&gt;<a class="code" href="classllvm_1_1Type.html#af5c7041df3ad5edffe5da17b5264c1fc">isVoidTy</a>() &amp;&amp; VF != 1) {</div><div class="line"><a name="l05013"></a><span class="lineno"> 5013</span>&#160;      <span class="keywordtype">unsigned</span> InsCost = TTI.getVectorInstrCost(Instruction::InsertElement,</div><div class="line"><a name="l05014"></a><span class="lineno"> 5014</span>&#160;                                                VectorTy);</div><div class="line"><a name="l05015"></a><span class="lineno"> 5015</span>&#160;      <span class="keywordtype">unsigned</span> ExtCost = TTI.getVectorInstrCost(<a class="code" href="InstCombineCompares_8cpp.html#aa5ab8c7b55d8bc7cab66be444daa70a1">Instruction::ExtractElement</a>,</div><div class="line"><a name="l05016"></a><span class="lineno"> 5016</span>&#160;                                                VectorTy);</div><div class="line"><a name="l05017"></a><span class="lineno"> 5017</span>&#160;</div><div class="line"><a name="l05018"></a><span class="lineno"> 5018</span>&#160;      <span class="comment">// The cost of inserting the results plus extracting each one of the</span></div><div class="line"><a name="l05019"></a><span class="lineno"> 5019</span>&#160;      <span class="comment">// operands.</span></div><div class="line"><a name="l05020"></a><span class="lineno"> 5020</span>&#160;      Cost += VF * (InsCost + ExtCost * I-&gt;<a class="code" href="classllvm_1_1User.html#a2f81e0c1fc6554df7ad2eafabf5fc5a5">getNumOperands</a>());</div><div class="line"><a name="l05021"></a><span class="lineno"> 5021</span>&#160;    }</div><div class="line"><a name="l05022"></a><span class="lineno"> 5022</span>&#160;</div><div class="line"><a name="l05023"></a><span class="lineno"> 5023</span>&#160;    <span class="comment">// The cost of executing VF copies of the scalar instruction. This opcode</span></div><div class="line"><a name="l05024"></a><span class="lineno"> 5024</span>&#160;    <span class="comment">// is unknown. Assume that it is the same as &#39;mul&#39;.</span></div><div class="line"><a name="l05025"></a><span class="lineno"> 5025</span>&#160;    Cost += VF * TTI.getArithmeticInstrCost(Instruction::Mul, VectorTy);</div><div class="line"><a name="l05026"></a><span class="lineno"> 5026</span>&#160;    <span class="keywordflow">return</span> Cost;</div><div class="line"><a name="l05027"></a><span class="lineno"> 5027</span>&#160;  }</div><div class="line"><a name="l05028"></a><span class="lineno"> 5028</span>&#160;  }<span class="comment">// end of switch.</span></div><div class="line"><a name="l05029"></a><span class="lineno"> 5029</span>&#160;}</div><div class="line"><a name="l05030"></a><span class="lineno"> 5030</span>&#160;</div><div class="line"><a name="l05031"></a><span class="lineno"> 5031</span>&#160;<a class="code" href="classllvm_1_1Type.html">Type</a>* LoopVectorizationCostModel::ToVectorTy(<a class="code" href="classllvm_1_1Type.html">Type</a> *<a class="code" href="namespacellvm_1_1NVPTX_1_1PTXLdStInstCode.html#a91119cbee2be000c528a690252aee07ca09c68d67f7dbfa6cc77eaf73aa535217">Scalar</a>, <span class="keywordtype">unsigned</span> VF) {</div><div class="line"><a name="l05032"></a><span class="lineno"> 5032</span>&#160;  <span class="keywordflow">if</span> (Scalar-&gt;<a class="code" href="classllvm_1_1Type.html#af5c7041df3ad5edffe5da17b5264c1fc">isVoidTy</a>() || VF == 1)</div><div class="line"><a name="l05033"></a><span class="lineno"> 5033</span>&#160;    <span class="keywordflow">return</span> Scalar;</div><div class="line"><a name="l05034"></a><span class="lineno"> 5034</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1VectorType.html#ab43657ed1abe2e2ed3a6a394f233ebd0">VectorType::get</a>(Scalar, VF);</div><div class="line"><a name="l05035"></a><span class="lineno"> 5035</span>&#160;}</div><div class="line"><a name="l05036"></a><span class="lineno"> 5036</span>&#160;</div><div class="line"><a name="l05037"></a><span class="lineno"> 5037</span>&#160;<span class="keywordtype">char</span> <a class="code" href="namespacellvm_1_1CallingConv.html#a4f861731fc6dbfdccc05af5968d98974">LoopVectorize::ID</a> = 0;</div><div class="line"><a name="l05038"></a><span class="lineno"><a class="line" href="LoopVectorize_8cpp.html#a5ce679c74f9d5aa21d8ea3d1a798f0a9"> 5038</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="LoopVectorize_8cpp.html#a5ce679c74f9d5aa21d8ea3d1a798f0a9">lv_name</a>[] = <span class="stringliteral">&quot;Loop Vectorization&quot;</span>;</div><div class="line"><a name="l05039"></a><span class="lineno"> 5039</span>&#160;<a class="code" href="PassSupport_8h.html#aaa970fc931c1c63037a8182e028d04b1">INITIALIZE_PASS_BEGIN</a>(LoopVectorize, <a class="code" href="LoopVectorize_8cpp.html#a0eff4a8bccb143ae91e197e6a59d4692">LV_NAME</a>, lv_name, <span class="keyword">false</span>, <span class="keyword">false</span>)</div><div class="line"><a name="l05040"></a><span class="lineno"> 5040</span>&#160;<a class="code" href="PassSupport_8h.html#af0564bcdde2dd4400c670ca278c6035f">INITIALIZE_AG_DEPENDENCY</a>(<a class="code" href="classllvm_1_1TargetTransformInfo.html">TargetTransformInfo</a>)</div><div class="line"><a name="l05041"></a><span class="lineno"> 5041</span>&#160;<a class="code" href="PassSupport_8h.html#a14724f1ccf528e73bb29bc9230737967">INITIALIZE_PASS_DEPENDENCY</a>(<a class="code" href="classllvm_1_1DominatorTree.html">DominatorTree</a>)</div><div class="line"><a name="l05042"></a><span class="lineno"> 5042</span>&#160;<a class="code" href="PassSupport_8h.html#a14724f1ccf528e73bb29bc9230737967">INITIALIZE_PASS_DEPENDENCY</a>(<a class="code" href="classllvm_1_1ScalarEvolution.html">ScalarEvolution</a>)</div><div class="line"><a name="l05043"></a><span class="lineno"> 5043</span>&#160;<a class="code" href="PassSupport_8h.html#a14724f1ccf528e73bb29bc9230737967">INITIALIZE_PASS_DEPENDENCY</a>(LCSSA)</div><div class="line"><a name="l05044"></a><span class="lineno"> 5044</span>&#160;<a class="code" href="PassSupport_8h.html#a14724f1ccf528e73bb29bc9230737967">INITIALIZE_PASS_DEPENDENCY</a>(<a class="code" href="classllvm_1_1LoopInfo.html">LoopInfo</a>)</div><div class="line"><a name="l05045"></a><span class="lineno"> 5045</span>&#160;<a class="code" href="PassSupport_8h.html#a14724f1ccf528e73bb29bc9230737967">INITIALIZE_PASS_DEPENDENCY</a>(LoopSimplify)</div><div class="line"><a name="l05046"></a><span class="lineno"> 5046</span>&#160;<a class="code" href="PassSupport_8h.html#a74ce8276b89067e806f67c45a6d92575">INITIALIZE_PASS_END</a>(LoopVectorize, <a class="code" href="LoopVectorize_8cpp.html#a0eff4a8bccb143ae91e197e6a59d4692">LV_NAME</a>, lv_name, <a class="code" href="namespacefalse.html">false</a>, false)</div><div class="line"><a name="l05047"></a><span class="lineno"> 5047</span>&#160;</div><div class="line"><a name="l05048"></a><span class="lineno"> 5048</span>&#160;namespace <a class="code" href="namespacellvm.html">llvm</a> {</div><div class="line"><a name="l05049"></a><span class="lineno"><a class="line" href="namespacellvm.html#a370d7c9b3e6065af079fdb25df89e711"> 5049</a></span>&#160;  <a class="code" href="classllvm_1_1Pass.html">Pass</a> *<a class="code" href="namespacellvm.html#a370d7c9b3e6065af079fdb25df89e711">createLoopVectorizePass</a>(<span class="keywordtype">bool</span> NoUnrolling) {</div><div class="line"><a name="l05050"></a><span class="lineno"> 5050</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">new</span> LoopVectorize(NoUnrolling);</div><div class="line"><a name="l05051"></a><span class="lineno"> 5051</span>&#160;  }</div><div class="line"><a name="l05052"></a><span class="lineno"> 5052</span>&#160;}</div><div class="line"><a name="l05053"></a><span class="lineno"> 5053</span>&#160;</div><div class="line"><a name="l05054"></a><span class="lineno"> 5054</span>&#160;<span class="keywordtype">bool</span> LoopVectorizationCostModel::isConsecutiveLoadOrStore(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *Inst) {</div><div class="line"><a name="l05055"></a><span class="lineno"> 5055</span>&#160;  <span class="comment">// Check for a store.</span></div><div class="line"><a name="l05056"></a><span class="lineno"> 5056</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1StoreInst.html">StoreInst</a> *<a class="code" href="namespacellvm_1_1A64DB.html#a6fce8157775f3ec93f326b52b0f1e0f5a4916e736d6b7cc68359b39d5eb50f6db">ST</a> = dyn_cast&lt;StoreInst&gt;(Inst))</div><div class="line"><a name="l05057"></a><span class="lineno"> 5057</span>&#160;    <span class="keywordflow">return</span> Legal-&gt;isConsecutivePtr(<a class="code" href="namespacellvm_1_1A64DB.html#a6fce8157775f3ec93f326b52b0f1e0f5a4916e736d6b7cc68359b39d5eb50f6db">ST</a>-&gt;getPointerOperand()) != 0;</div><div class="line"><a name="l05058"></a><span class="lineno"> 5058</span>&#160;</div><div class="line"><a name="l05059"></a><span class="lineno"> 5059</span>&#160;  <span class="comment">// Check for a load.</span></div><div class="line"><a name="l05060"></a><span class="lineno"> 5060</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1LoadInst.html">LoadInst</a> *LI = dyn_cast&lt;LoadInst&gt;(Inst))</div><div class="line"><a name="l05061"></a><span class="lineno"> 5061</span>&#160;    <span class="keywordflow">return</span> Legal-&gt;isConsecutivePtr(LI-&gt;getPointerOperand()) != 0;</div><div class="line"><a name="l05062"></a><span class="lineno"> 5062</span>&#160;</div><div class="line"><a name="l05063"></a><span class="lineno"> 5063</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l05064"></a><span class="lineno"> 5064</span>&#160;}</div><div class="line"><a name="l05065"></a><span class="lineno"> 5065</span>&#160;</div><div class="line"><a name="l05066"></a><span class="lineno"> 5066</span>&#160;</div><div class="line"><a name="l05067"></a><span class="lineno"> 5067</span>&#160;<span class="keywordtype">void</span> InnerLoopUnroller::scalarizeInstruction(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *Instr) {</div><div class="line"><a name="l05068"></a><span class="lineno"> 5068</span>&#160;  assert(!Instr-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a0a32c2cb0342323dc78f6aa31d7e581e">isAggregateType</a>() &amp;&amp; <span class="stringliteral">&quot;Can&#39;t handle vectors&quot;</span>);</div><div class="line"><a name="l05069"></a><span class="lineno"> 5069</span>&#160;  <span class="comment">// Holds vector parameters or scalars, in case of uniform vals.</span></div><div class="line"><a name="l05070"></a><span class="lineno"> 5070</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;VectorParts, 4&gt;</a> Params;</div><div class="line"><a name="l05071"></a><span class="lineno"> 5071</span>&#160;</div><div class="line"><a name="l05072"></a><span class="lineno"> 5072</span>&#160;  setDebugLocFromInst(Builder, Instr);</div><div class="line"><a name="l05073"></a><span class="lineno"> 5073</span>&#160;</div><div class="line"><a name="l05074"></a><span class="lineno"> 5074</span>&#160;  <span class="comment">// Find all of the vectorized parameters.</span></div><div class="line"><a name="l05075"></a><span class="lineno"> 5075</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> op = 0, e = Instr-&gt;<a class="code" href="classllvm_1_1User.html#a2f81e0c1fc6554df7ad2eafabf5fc5a5">getNumOperands</a>(); op != e; ++op) {</div><div class="line"><a name="l05076"></a><span class="lineno"> 5076</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *SrcOp = Instr-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(op);</div><div class="line"><a name="l05077"></a><span class="lineno"> 5077</span>&#160;</div><div class="line"><a name="l05078"></a><span class="lineno"> 5078</span>&#160;    <span class="comment">// If we are accessing the old induction variable, use the new one.</span></div><div class="line"><a name="l05079"></a><span class="lineno"> 5079</span>&#160;    <span class="keywordflow">if</span> (SrcOp == OldInduction) {</div><div class="line"><a name="l05080"></a><span class="lineno"> 5080</span>&#160;      Params.push_back(getVectorValue(SrcOp));</div><div class="line"><a name="l05081"></a><span class="lineno"> 5081</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l05082"></a><span class="lineno"> 5082</span>&#160;    }</div><div class="line"><a name="l05083"></a><span class="lineno"> 5083</span>&#160;</div><div class="line"><a name="l05084"></a><span class="lineno"> 5084</span>&#160;    <span class="comment">// Try using previously calculated values.</span></div><div class="line"><a name="l05085"></a><span class="lineno"> 5085</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *SrcInst = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1Instruction.html">Instruction</a>&gt;(SrcOp);</div><div class="line"><a name="l05086"></a><span class="lineno"> 5086</span>&#160;</div><div class="line"><a name="l05087"></a><span class="lineno"> 5087</span>&#160;    <span class="comment">// If the src is an instruction that appeared earlier in the basic block</span></div><div class="line"><a name="l05088"></a><span class="lineno"> 5088</span>&#160;    <span class="comment">// then it should already be vectorized.</span></div><div class="line"><a name="l05089"></a><span class="lineno"> 5089</span>&#160;    <span class="keywordflow">if</span> (SrcInst &amp;&amp; OrigLoop-&gt;contains(SrcInst)) {</div><div class="line"><a name="l05090"></a><span class="lineno"> 5090</span>&#160;      assert(WidenMap.has(SrcInst) &amp;&amp; <span class="stringliteral">&quot;Source operand is unavailable&quot;</span>);</div><div class="line"><a name="l05091"></a><span class="lineno"> 5091</span>&#160;      <span class="comment">// The parameter is a vector value from earlier.</span></div><div class="line"><a name="l05092"></a><span class="lineno"> 5092</span>&#160;      Params.push_back(WidenMap.get(SrcInst));</div><div class="line"><a name="l05093"></a><span class="lineno"> 5093</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l05094"></a><span class="lineno"> 5094</span>&#160;      <span class="comment">// The parameter is a scalar from outside the loop. Maybe even a constant.</span></div><div class="line"><a name="l05095"></a><span class="lineno"> 5095</span>&#160;      VectorParts Scalars;</div><div class="line"><a name="l05096"></a><span class="lineno"> 5096</span>&#160;      Scalars.append(UF, SrcOp);</div><div class="line"><a name="l05097"></a><span class="lineno"> 5097</span>&#160;      Params.push_back(Scalars);</div><div class="line"><a name="l05098"></a><span class="lineno"> 5098</span>&#160;    }</div><div class="line"><a name="l05099"></a><span class="lineno"> 5099</span>&#160;  }</div><div class="line"><a name="l05100"></a><span class="lineno"> 5100</span>&#160;</div><div class="line"><a name="l05101"></a><span class="lineno"> 5101</span>&#160;  assert(Params.size() == Instr-&gt;<a class="code" href="classllvm_1_1User.html#a2f81e0c1fc6554df7ad2eafabf5fc5a5">getNumOperands</a>() &amp;&amp;</div><div class="line"><a name="l05102"></a><span class="lineno"> 5102</span>&#160;         <span class="stringliteral">&quot;Invalid number of operands&quot;</span>);</div><div class="line"><a name="l05103"></a><span class="lineno"> 5103</span>&#160;</div><div class="line"><a name="l05104"></a><span class="lineno"> 5104</span>&#160;  <span class="comment">// Does this instruction return a value ?</span></div><div class="line"><a name="l05105"></a><span class="lineno"> 5105</span>&#160;  <span class="keywordtype">bool</span> IsVoidRetTy = Instr-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#af5c7041df3ad5edffe5da17b5264c1fc">isVoidTy</a>();</div><div class="line"><a name="l05106"></a><span class="lineno"> 5106</span>&#160;</div><div class="line"><a name="l05107"></a><span class="lineno"> 5107</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *UndefVec = IsVoidRetTy ? 0 :</div><div class="line"><a name="l05108"></a><span class="lineno"> 5108</span>&#160;  <a class="code" href="classllvm_1_1UndefValue.html#a4ae5ff22b700a42bcc5d889233721335">UndefValue::get</a>(Instr-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>());</div><div class="line"><a name="l05109"></a><span class="lineno"> 5109</span>&#160;  <span class="comment">// Create a new entry in the WidenMap and initialize it to Undef or Null.</span></div><div class="line"><a name="l05110"></a><span class="lineno"> 5110</span>&#160;  VectorParts &amp;VecResults = WidenMap.splat(Instr, UndefVec);</div><div class="line"><a name="l05111"></a><span class="lineno"> 5111</span>&#160;</div><div class="line"><a name="l05112"></a><span class="lineno"> 5112</span>&#160;  <span class="comment">// For each vector unroll &#39;part&#39;:</span></div><div class="line"><a name="l05113"></a><span class="lineno"> 5113</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> Part = 0; Part &lt; UF; ++Part) {</div><div class="line"><a name="l05114"></a><span class="lineno"> 5114</span>&#160;    <span class="comment">// For each scalar that we create:</span></div><div class="line"><a name="l05115"></a><span class="lineno"> 5115</span>&#160;</div><div class="line"><a name="l05116"></a><span class="lineno"> 5116</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *Cloned = Instr-&gt;<a class="code" href="classllvm_1_1Instruction.html#af6aad0c9ba7b8720130235c9621b55b5">clone</a>();</div><div class="line"><a name="l05117"></a><span class="lineno"> 5117</span>&#160;      <span class="keywordflow">if</span> (!IsVoidRetTy)</div><div class="line"><a name="l05118"></a><span class="lineno"> 5118</span>&#160;        Cloned-&gt;<a class="code" href="classllvm_1_1Value.html#a35ee267850af7c235474a8c46c7ac5af">setName</a>(Instr-&gt;<a class="code" href="classllvm_1_1Value.html#ad452febc1ac0b394876e640ec03ffa38">getName</a>() + <span class="stringliteral">&quot;.cloned&quot;</span>);</div><div class="line"><a name="l05119"></a><span class="lineno"> 5119</span>&#160;      <span class="comment">// Replace the operands of the cloned instructions with extracted scalars.</span></div><div class="line"><a name="l05120"></a><span class="lineno"> 5120</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> op = 0, e = Instr-&gt;<a class="code" href="classllvm_1_1User.html#a2f81e0c1fc6554df7ad2eafabf5fc5a5">getNumOperands</a>(); op != e; ++op) {</div><div class="line"><a name="l05121"></a><span class="lineno"> 5121</span>&#160;        <a class="code" href="classllvm_1_1Value.html">Value</a> *Op = Params[op][Part];</div><div class="line"><a name="l05122"></a><span class="lineno"> 5122</span>&#160;        Cloned-&gt;<a class="code" href="classllvm_1_1User.html#a5fa9b8e1842b354f64c1ba6be0a4a17f">setOperand</a>(op, Op);</div><div class="line"><a name="l05123"></a><span class="lineno"> 5123</span>&#160;      }</div><div class="line"><a name="l05124"></a><span class="lineno"> 5124</span>&#160;</div><div class="line"><a name="l05125"></a><span class="lineno"> 5125</span>&#160;      <span class="comment">// Place the cloned scalar in the new loop.</span></div><div class="line"><a name="l05126"></a><span class="lineno"> 5126</span>&#160;      Builder.Insert(Cloned);</div><div class="line"><a name="l05127"></a><span class="lineno"> 5127</span>&#160;</div><div class="line"><a name="l05128"></a><span class="lineno"> 5128</span>&#160;      <span class="comment">// If the original scalar returns a value we need to place it in a vector</span></div><div class="line"><a name="l05129"></a><span class="lineno"> 5129</span>&#160;      <span class="comment">// so that future users will be able to use it.</span></div><div class="line"><a name="l05130"></a><span class="lineno"> 5130</span>&#160;      <span class="keywordflow">if</span> (!IsVoidRetTy)</div><div class="line"><a name="l05131"></a><span class="lineno"> 5131</span>&#160;        VecResults[Part] = Cloned;</div><div class="line"><a name="l05132"></a><span class="lineno"> 5132</span>&#160;  }</div><div class="line"><a name="l05133"></a><span class="lineno"> 5133</span>&#160;}</div><div class="line"><a name="l05134"></a><span class="lineno"> 5134</span>&#160;</div><div class="line"><a name="l05135"></a><span class="lineno"> 5135</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l05136"></a><span class="lineno"> 5136</span>&#160;InnerLoopUnroller::vectorizeMemoryInstruction(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *Instr,</div><div class="line"><a name="l05137"></a><span class="lineno"> 5137</span>&#160;                                              LoopVectorizationLegality*) {</div><div class="line"><a name="l05138"></a><span class="lineno"> 5138</span>&#160;  <span class="keywordflow">return</span> scalarizeInstruction(Instr);</div><div class="line"><a name="l05139"></a><span class="lineno"> 5139</span>&#160;}</div><div class="line"><a name="l05140"></a><span class="lineno"> 5140</span>&#160;</div><div class="line"><a name="l05141"></a><span class="lineno"> 5141</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *InnerLoopUnroller::reverseVector(<a class="code" href="classllvm_1_1Value.html">Value</a> *Vec) {</div><div class="line"><a name="l05142"></a><span class="lineno"> 5142</span>&#160;  <span class="keywordflow">return</span> Vec;</div><div class="line"><a name="l05143"></a><span class="lineno"> 5143</span>&#160;}</div><div class="line"><a name="l05144"></a><span class="lineno"> 5144</span>&#160;</div><div class="line"><a name="l05145"></a><span class="lineno"> 5145</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *InnerLoopUnroller::getBroadcastInstrs(<a class="code" href="classllvm_1_1Value.html">Value</a> *V) {</div><div class="line"><a name="l05146"></a><span class="lineno"> 5146</span>&#160;  <span class="keywordflow">return</span> V;</div><div class="line"><a name="l05147"></a><span class="lineno"> 5147</span>&#160;}</div><div class="line"><a name="l05148"></a><span class="lineno"> 5148</span>&#160;</div><div class="line"><a name="l05149"></a><span class="lineno"> 5149</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *InnerLoopUnroller::getConsecutiveVector(<a class="code" href="classllvm_1_1Value.html">Value</a>* Val, <span class="keywordtype">int</span> StartIdx,</div><div class="line"><a name="l05150"></a><span class="lineno"> 5150</span>&#160;                                               <span class="keywordtype">bool</span> Negate) {</div><div class="line"><a name="l05151"></a><span class="lineno"> 5151</span>&#160;  <span class="comment">// When unrolling and the VF is 1, we only need to add a simple scalar.</span></div><div class="line"><a name="l05152"></a><span class="lineno"> 5152</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *ITy = Val-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>();</div><div class="line"><a name="l05153"></a><span class="lineno"> 5153</span>&#160;  assert(!ITy-&gt;<a class="code" href="classllvm_1_1Type.html#a6f725580f7834e2ca90762965866dad4">isVectorTy</a>() &amp;&amp; <span class="stringliteral">&quot;Val must be a scalar&quot;</span>);</div><div class="line"><a name="l05154"></a><span class="lineno"> 5154</span>&#160;  <a class="code" href="classllvm_1_1Constant.html">Constant</a> *<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = <a class="code" href="classllvm_1_1ConstantInt.html#a9105541412dab869e18b3cceebfff07d">ConstantInt::get</a>(ITy, StartIdx, Negate);</div><div class="line"><a name="l05155"></a><span class="lineno"> 5155</span>&#160;  <span class="keywordflow">return</span> Builder.CreateAdd(Val, C, <span class="stringliteral">&quot;induction&quot;</span>);</div><div class="line"><a name="l05156"></a><span class="lineno"> 5156</span>&#160;}</div><div class="line"><a name="l05157"></a><span class="lineno"> 5157</span>&#160;</div><div class="ttc" id="classllvm_1_1SCEVNAryExpr_html_aaca141c03630036930698325f423cb49"><div class="ttname"><a href="classllvm_1_1SCEVNAryExpr.html#aaca141c03630036930698325f423cb49">llvm::SCEVNAryExpr::getNoWrapFlags</a></div><div class="ttdeci">NoWrapFlags getNoWrapFlags(NoWrapFlags Mask=NoWrapMask) const </div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolutionExpressions_8h_source.html#l00159">ScalarEvolutionExpressions.h:159</a></div></div>
<div class="ttc" id="namespacellvm_1_1PatternMatch_html_adc571425e9aecccf7ebf5fcc3c678d94"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#adc571425e9aecccf7ebf5fcc3c678d94">llvm::PatternMatch::m_UMin</a></div><div class="ttdeci">MaxMin_match&lt; ICmpInst, LHS, RHS, umin_pred_ty &gt; m_UMin(const LHS &amp;L, const RHS &amp;R)</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l00958">PatternMatch.h:958</a></div></div>
<div class="ttc" id="classllvm_1_1Pass_html"><div class="ttname"><a href="classllvm_1_1Pass.html">llvm::Pass</a></div><div class="ttdef"><b>Definition:</b> <a href="Pass_8h_source.html#l00082">Pass.h:82</a></div></div>
<div class="ttc" id="classllvm_1_1ScalarEvolution_html_a426976cfd81411f49f7e5fe77ee4e3a4"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html#a426976cfd81411f49f7e5fe77ee4e3a4">llvm::ScalarEvolution::getTruncateOrNoop</a></div><div class="ttdeci">const SCEV * getTruncateOrNoop(const SCEV *V, Type *Ty)</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8cpp_source.html#l02887">ScalarEvolution.cpp:2887</a></div></div>
<div class="ttc" id="AArch64Disassembler_8cpp_html_a5d37f23ec6bf93da60e38fda41e9a83d"><div class="ttname"><a href="AArch64Disassembler_8cpp.html#a5d37f23ec6bf93da60e38fda41e9a83d">Check</a></div><div class="ttdeci">static bool Check(DecodeStatus &amp;Out, DecodeStatus In)</div><div class="ttdef"><b>Definition:</b> <a href="AArch64Disassembler_8cpp_source.html#l00250">AArch64Disassembler.cpp:250</a></div></div>
<div class="ttc" id="classllvm_1_1MapVector_html_a63222e22bd798c7db94246adbb9cf2be"><div class="ttname"><a href="classllvm_1_1MapVector.html#a63222e22bd798c7db94246adbb9cf2be">llvm::MapVector::iterator</a></div><div class="ttdeci">VectorType::iterator iterator</div><div class="ttdef"><b>Definition:</b> <a href="MapVector_8h_source.html#l00040">MapVector.h:40</a></div></div>
<div class="ttc" id="namespacellvm_1_1Intrinsic_html_a73349916f7e54a6b988a3646c7a02e90afcac7d7dd4a11e3e7fa5c08757f2db40"><div class="ttname"><a href="namespacellvm_1_1Intrinsic.html#a73349916f7e54a6b988a3646c7a02e90afcac7d7dd4a11e3e7fa5c08757f2db40">llvm::Intrinsic::sin</a></div><div class="ttdef"><b>Definition:</b> <a href="Intrinsics_8h_source.html#l02435">Intrinsics.h:2435</a></div></div>
<div class="ttc" id="classllvm_1_1SmallVectorTemplateCommon_html_a075e34e98605d0e7c289763a104869ac"><div class="ttname"><a href="classllvm_1_1SmallVectorTemplateCommon.html#a075e34e98605d0e7c289763a104869ac">llvm::SmallVectorTemplateCommon&lt; T &gt;::end</a></div><div class="ttdeci">iterator end()</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00114">SmallVector.h:114</a></div></div>
<div class="ttc" id="classllvm_1_1SCEVAddRecExpr_html_a11bb31f99854303d2a934765469c5c2c"><div class="ttname"><a href="classllvm_1_1SCEVAddRecExpr.html#a11bb31f99854303d2a934765469c5c2c">llvm::SCEVAddRecExpr::evaluateAtIteration</a></div><div class="ttdeci">const SCEV * evaluateAtIteration(const SCEV *It, ScalarEvolution &amp;SE) const </div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8cpp_source.html#l00802">ScalarEvolution.cpp:802</a></div></div>
<div class="ttc" id="classllvm_1_1SmallVectorTemplateCommon_html_a22a311dfe4c28a897de8a9365a4f0a84"><div class="ttname"><a href="classllvm_1_1SmallVectorTemplateCommon.html#a22a311dfe4c28a897de8a9365a4f0a84">llvm::SmallVectorTemplateCommon&lt; T &gt;::size</a></div><div class="ttdeci">size_type size() const</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00127">SmallVector.h:127</a></div></div>
<div class="ttc" id="SmallSet_8h_html"><div class="ttname"><a href="SmallSet_8h.html">SmallSet.h</a></div></div>
<div class="ttc" id="classllvm_1_1StoreInst_html_a14298313bdf734e2db5a921cc6e861a0"><div class="ttname"><a href="classllvm_1_1StoreInst.html#a14298313bdf734e2db5a921cc6e861a0">llvm::StoreInst::getValueOperand</a></div><div class="ttdeci">Value * getValueOperand()</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00343">Instructions.h:343</a></div></div>
<div class="ttc" id="MapVector_8h_html"><div class="ttname"><a href="MapVector_8h.html">MapVector.h</a></div></div>
<div class="ttc" id="classllvm_1_1SmallVectorTemplateBase_html_ae1a10b90f22c0478960fb5798ff73916"><div class="ttname"><a href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">llvm::SmallVectorTemplateBase&lt; T, isPodLike&lt; T &gt;::value &gt;::push_back</a></div><div class="ttdeci">void push_back(const T &amp;Elt)</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00236">SmallVector.h:236</a></div></div>
<div class="ttc" id="classllvm_1_1Value_html_ad86469939d2a8bdd4169be9403b89f5a"><div class="ttname"><a href="classllvm_1_1Value.html#ad86469939d2a8bdd4169be9403b89f5a">llvm::Value::use_end</a></div><div class="ttdeci">use_iterator use_end()</div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00152">Value.h:152</a></div></div>
<div class="ttc" id="classllvm_1_1MDNode_html_a0bd8a5b0a6ce390d0064c025ad58e946"><div class="ttname"><a href="classllvm_1_1MDNode.html#a0bd8a5b0a6ce390d0064c025ad58e946">llvm::MDNode::replaceOperandWith</a></div><div class="ttdeci">void replaceOperandWith(unsigned i, Value *NewVal)</div><div class="ttdoc">replaceOperandWith - Replace a specific operand. </div><div class="ttdef"><b>Definition:</b> <a href="Metadata_8cpp_source.html#l00108">Metadata.cpp:108</a></div></div>
<div class="ttc" id="namespacellvm_1_1Intrinsic_html_a73349916f7e54a6b988a3646c7a02e90aa332b90dd5e4ebf4bbbcc0964220d373"><div class="ttname"><a href="namespacellvm_1_1Intrinsic.html#a73349916f7e54a6b988a3646c7a02e90aa332b90dd5e4ebf4bbbcc0964220d373">llvm::Intrinsic::lifetime_end</a></div><div class="ttdef"><b>Definition:</b> <a href="Intrinsics_8h_source.html#l01254">Intrinsics.h:1254</a></div></div>
<div class="ttc" id="classllvm_1_1DataLayout_html"><div class="ttname"><a href="classllvm_1_1DataLayout.html">llvm::DataLayout</a></div><div class="ttdef"><b>Definition:</b> <a href="DataLayout_8h_source.html#l00098">DataLayout.h:98</a></div></div>
<div class="ttc" id="namespacellvm_1_1sys_1_1path_html_a214ec2f04ffd92636ed4bd2717607a1d"><div class="ttname"><a href="namespacellvm_1_1sys_1_1path.html#a214ec2f04ffd92636ed4bd2717607a1d">llvm::sys::path::end</a></div><div class="ttdeci">const_iterator end(StringRef path)</div><div class="ttdoc">Get end iterator over path. </div><div class="ttdef"><b>Definition:</b> <a href="Path_8cpp_source.html#l00181">Path.cpp:181</a></div></div>
<div class="ttc" id="classllvm_1_1GetElementPtrInst_html_ad200825f26189cd43f3b80728649c4a9"><div class="ttname"><a href="classllvm_1_1GetElementPtrInst.html#ad200825f26189cd43f3b80728649c4a9">llvm::GetElementPtrInst::getPointerOperand</a></div><div class="ttdeci">Value * getPointerOperand()</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00790">Instructions.h:790</a></div></div>
<div class="ttc" id="classllvm_1_1CastInst_html_adc3489e61d5f37a0e4c5589859fbccc2"><div class="ttname"><a href="classllvm_1_1CastInst.html#adc3489e61d5f37a0e4c5589859fbccc2">llvm::CastInst::getOpcode</a></div><div class="ttdeci">Instruction::CastOps getOpcode() const </div><div class="ttdoc">Return the opcode of this CastInst. </div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00603">InstrTypes.h:603</a></div></div>
<div class="ttc" id="namespacellvm_1_1PatternMatch_html_a24bca8838396aa81b87de8e7ac774b19"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#a24bca8838396aa81b87de8e7ac774b19">llvm::PatternMatch::m_Value</a></div><div class="ttdeci">class_match&lt; Value &gt; m_Value()</div><div class="ttdoc">m_Value() - Match an arbitrary value and ignore it. </div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l00070">PatternMatch.h:70</a></div></div>
<div class="ttc" id="classllvm_1_1BinaryOperator_html_a21ce697328893029ae2c63974061a294"><div class="ttname"><a href="classllvm_1_1BinaryOperator.html#a21ce697328893029ae2c63974061a294">llvm::BinaryOperator::setHasNoSignedWrap</a></div><div class="ttdeci">void setHasNoSignedWrap(bool b=true)</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8cpp_source.html#l02001">Instructions.cpp:2001</a></div></div>
<div class="ttc" id="classllvm_1_1SmallDenseMap_html"><div class="ttname"><a href="classllvm_1_1SmallDenseMap.html">llvm::SmallDenseMap</a></div><div class="ttdef"><b>Definition:</b> <a href="DenseMap_8h_source.html#l00690">DenseMap.h:690</a></div></div>
<div class="ttc" id="classllvm_1_1CmpInst_html"><div class="ttname"><a href="classllvm_1_1CmpInst.html">llvm::CmpInst</a></div><div class="ttdoc">Abstract base class of comparison instructions. </div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00633">InstrTypes.h:633</a></div></div>
<div class="ttc" id="classllvm_1_1MDString_html_a1313e7e5d3792f0d96f2b485d3ca6a70"><div class="ttname"><a href="classllvm_1_1MDString.html#a1313e7e5d3792f0d96f2b485d3ca6a70">llvm::MDString::getString</a></div><div class="ttdeci">StringRef getString() const </div><div class="ttdef"><b>Definition:</b> <a href="Metadata_8h_source.html#l00050">Metadata.h:50</a></div></div>
<div class="ttc" id="namespacellvm_1_1ARM__PROC_html_aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5"><div class="ttname"><a href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">llvm::ARM_PROC::A</a></div><div class="ttdef"><b>Definition:</b> <a href="ARMBaseInfo_8h_source.html#l00098">ARMBaseInfo.h:98</a></div></div>
<div class="ttc" id="namespacellvm_1_1tgtok_html_abbc5259d649363016626e2529fabe0c5a5fa7b4069ef3bd1ceb9f2caa315cf5ac"><div class="ttname"><a href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5a5fa7b4069ef3bd1ceb9f2caa315cf5ac">llvm::tgtok::In</a></div><div class="ttdef"><b>Definition:</b> <a href="TGLexer_8h_source.html#l00046">TGLexer.h:46</a></div></div>
<div class="ttc" id="classllvm_1_1AnalysisUsage_html_a884f90190bca4bd354f2d5c91c264028"><div class="ttname"><a href="classllvm_1_1AnalysisUsage.html#a884f90190bca4bd354f2d5c91c264028">llvm::AnalysisUsage::addPreserved</a></div><div class="ttdeci">AnalysisUsage &amp; addPreserved()</div><div class="ttdef"><b>Definition:</b> <a href="PassAnalysisSupport_8h_source.html#l00081">PassAnalysisSupport.h:81</a></div></div>
<div class="ttc" id="classllvm_1_1Type_html_aa75984a442f2379de0c66018201fa628"><div class="ttname"><a href="classllvm_1_1Type.html#aa75984a442f2379de0c66018201fa628">llvm::Type::getInt1Ty</a></div><div class="ttdeci">static IntegerType * getInt1Ty(LLVMContext &amp;C)</div><div class="ttdef"><b>Definition:</b> <a href="Type_8cpp_source.html#l00238">Type.cpp:238</a></div></div>
<div class="ttc" id="namespacellvm_html_a370d7c9b3e6065af079fdb25df89e711"><div class="ttname"><a href="namespacellvm.html#a370d7c9b3e6065af079fdb25df89e711">llvm::createLoopVectorizePass</a></div><div class="ttdeci">Pass * createLoopVectorizePass(bool NoUnrolling=false)</div><div class="ttdef"><b>Definition:</b> <a href="LoopVectorize_8cpp_source.html#l05049">LoopVectorize.cpp:5049</a></div></div>
<div class="ttc" id="classllvm_1_1APInt_html_ae130d109fdba9ebb976e4fe2621b374a"><div class="ttname"><a href="classllvm_1_1APInt.html#ae130d109fdba9ebb976e4fe2621b374a">llvm::APInt::abs</a></div><div class="ttdeci">APInt LLVM_ATTRIBUTE_UNUSED_RESULT abs() const </div><div class="ttdoc">Get the absolute value;. </div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l01521">APInt.h:1521</a></div></div>
<div class="ttc" id="classllvm_1_1PHINode_html_a089cccb6f231efee72abc76d0f9c695f"><div class="ttname"><a href="classllvm_1_1PHINode.html#a089cccb6f231efee72abc76d0f9c695f">llvm::PHINode::addIncoming</a></div><div class="ttdeci">void addIncoming(Value *V, BasicBlock *BB)</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02100">Instructions.h:2100</a></div></div>
<div class="ttc" id="LoopVectorize_8cpp_html_acd9035706d7098978089376079827aa3"><div class="ttname"><a href="LoopVectorize_8cpp.html#acd9035706d7098978089376079827aa3">hasMultipleUsesOf</a></div><div class="ttdeci">static bool hasMultipleUsesOf(Instruction *I, SmallPtrSet&lt; Instruction *, 8 &gt; &amp;Insts)</div><div class="ttdef"><b>Definition:</b> <a href="LoopVectorize_8cpp_source.html#l04046">LoopVectorize.cpp:4046</a></div></div>
<div class="ttc" id="classllvm_1_1PassRegistry_html_a05a729900b76c89e808c6c3094921b2f"><div class="ttname"><a href="classllvm_1_1PassRegistry.html#a05a729900b76c89e808c6c3094921b2f">llvm::PassRegistry::getPassRegistry</a></div><div class="ttdeci">static PassRegistry * getPassRegistry()</div><div class="ttdef"><b>Definition:</b> <a href="PassRegistry_8cpp_source.html#l00035">PassRegistry.cpp:35</a></div></div>
<div class="ttc" id="classllvm_1_1IntervalMap_html_aaa6329ac17c770c00c849c74fbe1c7b4"><div class="ttname"><a href="classllvm_1_1IntervalMap.html#aaa6329ac17c770c00c849c74fbe1c7b4">llvm::IntervalMap::begin</a></div><div class="ttdeci">const_iterator begin() const </div><div class="ttdef"><b>Definition:</b> <a href="IntervalMap_8h_source.html#l01110">IntervalMap.h:1110</a></div></div>
<div class="ttc" id="namespacellvm_1_1SPII_html_a11e9b8fca4a074643a6a21f444e51406a5069619ca8fdce305534f3fe85091a0f"><div class="ttname"><a href="namespacellvm_1_1SPII.html#a11e9b8fca4a074643a6a21f444e51406a5069619ca8fdce305534f3fe85091a0f">llvm::SPII::Load</a></div><div class="ttdef"><b>Definition:</b> <a href="SparcInstrInfo_8h_source.html#l00031">SparcInstrInfo.h:31</a></div></div>
<div class="ttc" id="classllvm_1_1Instruction_html_a6fe2f06b8a4b2c3d6308afb223a0238a"><div class="ttname"><a href="classllvm_1_1Instruction.html#a6fe2f06b8a4b2c3d6308afb223a0238a">llvm::Instruction::eraseFromParent</a></div><div class="ttdeci">void eraseFromParent()</div><div class="ttdef"><b>Definition:</b> <a href="Instruction_8cpp_source.html#l00072">Instruction.cpp:72</a></div></div>
<div class="ttc" id="classllvm_1_1APInt_html_a7dc983ebf0eb2d255fa90a67063c72e2"><div class="ttname"><a href="classllvm_1_1APInt.html#a7dc983ebf0eb2d255fa90a67063c72e2">llvm::APInt::getZExtValue</a></div><div class="ttdeci">uint64_t getZExtValue() const </div><div class="ttdoc">Get zero extended value. </div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l01306">APInt.h:1306</a></div></div>
<div class="ttc" id="classllvm_1_1IRBuilderBase_html_a571ae7ebae7038da7f6073efc65aaa50"><div class="ttname"><a href="classllvm_1_1IRBuilderBase.html#a571ae7ebae7038da7f6073efc65aaa50">llvm::IRBuilderBase::SetCurrentDebugLocation</a></div><div class="ttdeci">void SetCurrentDebugLocation(const DebugLoc &amp;L)</div><div class="ttdoc">Set location information used by debugging information. </div><div class="ttdef"><b>Definition:</b> <a href="IRBuilder_8h_source.html#l00118">IRBuilder.h:118</a></div></div>
<div class="ttc" id="Instructions_8h_html"><div class="ttname"><a href="Instructions_8h.html">Instructions.h</a></div></div>
<div class="ttc" id="classllvm_1_1IRBuilder_html_a495d91fb3d2662acbffd0162c56153ed"><div class="ttname"><a href="classllvm_1_1IRBuilder.html#a495d91fb3d2662acbffd0162c56153ed">llvm::IRBuilder::CreateICmp</a></div><div class="ttdeci">Value * CreateICmp(CmpInst::Predicate P, Value *LHS, Value *RHS, const Twine &amp;Name=&quot;&quot;)</div><div class="ttdef"><b>Definition:</b> <a href="IRBuilder_8h_source.html#l01280">IRBuilder.h:1280</a></div></div>
<div class="ttc" id="classllvm_1_1SCEV_html_a3935a9de0ebdf3dc625cfb28e35bd009"><div class="ttname"><a href="classllvm_1_1SCEV.html#a3935a9de0ebdf3dc625cfb28e35bd009">llvm::SCEV::isOne</a></div><div class="ttdeci">bool isOne() const </div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8cpp_source.html#l00281">ScalarEvolution.cpp:281</a></div></div>
<div class="ttc" id="namespacellvm_html_ae7484b83e7c2b58ffd67422a919aba40"><div class="ttname"><a href="namespacellvm.html#ae7484b83e7c2b58ffd67422a919aba40">llvm::GetUnderlyingObjects</a></div><div class="ttdeci">void GetUnderlyingObjects(Value *V, SmallVectorImpl&lt; Value * &gt; &amp;Objects, const DataLayout *TD=0, unsigned MaxLookup=6)</div><div class="ttdef"><b>Definition:</b> <a href="ValueTracking_8cpp_source.html#l01928">ValueTracking.cpp:1928</a></div></div>
<div class="ttc" id="namespacellvm_1_1Intrinsic_html_a73349916f7e54a6b988a3646c7a02e90a42b08bce2f24e45c11b2afeef6db32d4"><div class="ttname"><a href="namespacellvm_1_1Intrinsic.html#a73349916f7e54a6b988a3646c7a02e90a42b08bce2f24e45c11b2afeef6db32d4">llvm::Intrinsic::rint</a></div><div class="ttdef"><b>Definition:</b> <a href="Intrinsics_8h_source.html#l02429">Intrinsics.h:2429</a></div></div>
<div class="ttc" id="classllvm_1_1ScalarEvolution_html_a2eb94d079d8416118f4aaed865ab05d7"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html#a2eb94d079d8416118f4aaed865ab05d7">llvm::ScalarEvolution::getConstant</a></div><div class="ttdeci">const SCEV * getConstant(ConstantInt *V)</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8cpp_source.html#l00314">ScalarEvolution.cpp:314</a></div></div>
<div class="ttc" id="classllvm_1_1TargetTransformInfo_html_afa38851d75434d1476444ac93f94cb4ca9c0eecea29e9fa58e4dac7ee32b9b2ac"><div class="ttname"><a href="classllvm_1_1TargetTransformInfo.html#afa38851d75434d1476444ac93f94cb4ca9c0eecea29e9fa58e4dac7ee32b9b2ac">llvm::TargetTransformInfo::OK_AnyValue</a></div><div class="ttdef"><b>Definition:</b> <a href="TargetTransformInfo_8h_source.html#l00319">TargetTransformInfo.h:319</a></div></div>
<div class="ttc" id="namespacellvm_html"><div class="ttname"><a href="namespacellvm.html">llvm</a></div><div class="ttdoc">List of target independent CodeGen pass IDs. </div><div class="ttdef"><b>Definition:</b> <a href="APFloat_8h_source.html#l00022">APFloat.h:22</a></div></div>
<div class="ttc" id="Target_2README_8txt_html_a02def7c594e9f19ff247ed0bf33d1c30"><div class="ttname"><a href="Target_2README_8txt.html#a02def7c594e9f19ff247ed0bf33d1c30">size</a></div><div class="ttdeci">i&lt; reg-&gt; size</div><div class="ttdef"><b>Definition:</b> <a href="Target_2README_8txt_source.html#l00204">Target/README.txt:204</a></div></div>
<div class="ttc" id="classllvm_1_1Type_html_ad979b3c1bc975ee23810e3018ffe951b"><div class="ttname"><a href="classllvm_1_1Type.html#ad979b3c1bc975ee23810e3018ffe951b">llvm::Type::getScalarSizeInBits</a></div><div class="ttdeci">unsigned getScalarSizeInBits()</div><div class="ttdef"><b>Definition:</b> <a href="Type_8cpp_source.html#l00135">Type.cpp:135</a></div></div>
<div class="ttc" id="namespacellvm_1_1X86II_html_a97dc14052814702ba0e2b14fb14dd02da4e7ea93eb7bffafeed5db26fe5e9a179"><div class="ttname"><a href="namespacellvm_1_1X86II.html#a97dc14052814702ba0e2b14fb14dd02da4e7ea93eb7bffafeed5db26fe5e9a179">llvm::X86II::DA</a></div><div class="ttdef"><b>Definition:</b> <a href="X86BaseInfo_8h_source.html#l00330">X86BaseInfo.h:330</a></div></div>
<div class="ttc" id="DerivedTypes_8h_html"><div class="ttname"><a href="DerivedTypes_8h.html">DerivedTypes.h</a></div></div>
<div class="ttc" id="classllvm_1_1Module_html"><div class="ttname"><a href="classllvm_1_1Module.html">llvm::Module</a></div><div class="ttdoc">The main container class for the LLVM Intermediate Representation. </div><div class="ttdef"><b>Definition:</b> <a href="Module_8h_source.html#l00112">Module.h:112</a></div></div>
<div class="ttc" id="Type_8h_html"><div class="ttname"><a href="Type_8h.html">Type.h</a></div></div>
<div class="ttc" id="classllvm_1_1ScalarEvolution_html_aa89f44fd7549e81b02f2be1be894f098"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html#aa89f44fd7549e81b02f2be1be894f098">llvm::ScalarEvolution::getContext</a></div><div class="ttdeci">LLVMContext &amp; getContext() const </div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8h_source.html#l00551">ScalarEvolution.h:551</a></div></div>
<div class="ttc" id="Target_2X86_2README_8txt_html_ac9423a63151469d95755528cceb322fb"><div class="ttname"><a href="Target_2X86_2README_8txt.html#ac9423a63151469d95755528cceb322fb">bb</a></div><div class="ttdeci">&lt; i1 &gt; br i1 label label bb bb</div><div class="ttdef"><b>Definition:</b> <a href="Target_2X86_2README_8txt_source.html#l01139">Target/X86/README.txt:1139</a></div></div>
<div class="ttc" id="namespacellvm_1_1LibFunc_html_abf8f6830387f338fed0bce2e65108c6fa7d3fc30f043c58272273d77c908d5db8"><div class="ttname"><a href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fa7d3fc30f043c58272273d77c908d5db8">llvm::LibFunc::rint</a></div><div class="ttdoc">double rint(double x); </div><div class="ttdef"><b>Definition:</b> <a href="TargetLibraryInfo_8h_source.html#l00472">TargetLibraryInfo.h:472</a></div></div>
<div class="ttc" id="classllvm_1_1Loop_html_a9a528e07e493ebddf91f2e1762d013e7"><div class="ttname"><a href="classllvm_1_1Loop.html#a9a528e07e493ebddf91f2e1762d013e7">llvm::Loop::isAnnotatedParallel</a></div><div class="ttdeci">bool isAnnotatedParallel() const </div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8cpp_source.html#l00290">LoopInfo.cpp:290</a></div></div>
<div class="ttc" id="namespacellvm_1_1PatternMatch_html_ab3b5beca3a0dedd21adac813123a2ae6"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#ab3b5beca3a0dedd21adac813123a2ae6">llvm::PatternMatch::m_Zero</a></div><div class="ttdeci">match_zero m_Zero()</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l00137">PatternMatch.h:137</a></div></div>
<div class="ttc" id="classllvm_1_1MDString_html_affbb7e2e9ad8d18114816f2443d672b9"><div class="ttname"><a href="classllvm_1_1MDString.html#affbb7e2e9ad8d18114816f2443d672b9">llvm::MDString::get</a></div><div class="ttdeci">static MDString * get(LLVMContext &amp;Context, StringRef Str)</div><div class="ttdef"><b>Definition:</b> <a href="Metadata_8cpp_source.html#l00038">Metadata.cpp:38</a></div></div>
<div class="ttc" id="IntrinsicInst_8h_html"><div class="ttname"><a href="IntrinsicInst_8h.html">IntrinsicInst.h</a></div></div>
<div class="ttc" id="namespacellvm_html_a3f2f98c2a67c9e79f58aad9150a62e42"><div class="ttname"><a href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">llvm::dyn_cast</a></div><div class="ttdeci">enable_if_c&lt;!is_simple_type&lt; Y &gt;::value, typename cast_retty&lt; X, const Y &gt;::ret_type &gt;::type dyn_cast(const Y &amp;Val)</div><div class="ttdef"><b>Definition:</b> <a href="Casting_8h_source.html#l00266">Casting.h:266</a></div></div>
<div class="ttc" id="namespacellvm_1_1LibFunc_html_abf8f6830387f338fed0bce2e65108c6faa32cd0d3fa29f9018cfc2fd19bc9c8a2"><div class="ttname"><a href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6faa32cd0d3fa29f9018cfc2fd19bc9c8a2">llvm::LibFunc::copysignl</a></div><div class="ttdoc">long double copysignl(long double x, long double y); </div><div class="ttdef"><b>Definition:</b> <a href="TargetLibraryInfo_8h_source.html#l00175">TargetLibraryInfo.h:175</a></div></div>
<div class="ttc" id="classllvm_1_1User_html_a2f81e0c1fc6554df7ad2eafabf5fc5a5"><div class="ttname"><a href="classllvm_1_1User.html#a2f81e0c1fc6554df7ad2eafabf5fc5a5">llvm::User::getNumOperands</a></div><div class="ttdeci">unsigned getNumOperands() const </div><div class="ttdef"><b>Definition:</b> <a href="User_8h_source.html#l00108">User.h:108</a></div></div>
<div class="ttc" id="classllvm_1_1MDNode_html_ade17b50e4f0b835cd9eb58dffe12a90d"><div class="ttname"><a href="classllvm_1_1MDNode.html#ade17b50e4f0b835cd9eb58dffe12a90d">llvm::MDNode::getNumOperands</a></div><div class="ttdeci">unsigned getNumOperands() const </div><div class="ttdoc">getNumOperands - Return number of MDNode operands. </div><div class="ttdef"><b>Definition:</b> <a href="Metadata_8h_source.html#l00146">Metadata.h:146</a></div></div>
<div class="ttc" id="namespacellvm_1_1Intrinsic_html_a73349916f7e54a6b988a3646c7a02e90ae8381623b66af7d8e29f051b8d03ea93"><div class="ttname"><a href="namespacellvm_1_1Intrinsic.html#a73349916f7e54a6b988a3646c7a02e90ae8381623b66af7d8e29f051b8d03ea93">llvm::Intrinsic::log</a></div><div class="ttdef"><b>Definition:</b> <a href="Intrinsics_8h_source.html#l01256">Intrinsics.h:1256</a></div></div>
<div class="ttc" id="namespacellvm_1_1LibFunc_html_abf8f6830387f338fed0bce2e65108c6fa80047f1595abe8bc418ead050262f341"><div class="ttname"><a href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fa80047f1595abe8bc418ead050262f341">llvm::LibFunc::rintl</a></div><div class="ttdoc">long double rintl(long double x); </div><div class="ttdef"><b>Definition:</b> <a href="TargetLibraryInfo_8h_source.html#l00476">TargetLibraryInfo.h:476</a></div></div>
<div class="ttc" id="DataLayout_8h_html"><div class="ttname"><a href="DataLayout_8h.html">DataLayout.h</a></div></div>
<div class="ttc" id="namespacellvm_1_1LibFunc_html_abf8f6830387f338fed0bce2e65108c6fa726f30bb43659dee0803fffe6f883133"><div class="ttname"><a href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fa726f30bb43659dee0803fffe6f883133">llvm::LibFunc::truncl</a></div><div class="ttdoc">long double truncl(long double x); </div><div class="ttdef"><b>Definition:</b> <a href="TargetLibraryInfo_8h_source.html#l00618">TargetLibraryInfo.h:618</a></div></div>
<div class="ttc" id="classllvm_1_1User_html_ad93396a26f6fd589ed400bb280319836"><div class="ttname"><a href="classllvm_1_1User.html#ad93396a26f6fd589ed400bb280319836">llvm::User::value_op_begin</a></div><div class="ttdeci">value_op_iterator value_op_begin()</div><div class="ttdef"><b>Definition:</b> <a href="User_8h_source.html#l00153">User.h:153</a></div></div>
<div class="ttc" id="classllvm_1_1ScalarEvolution_html"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html">llvm::ScalarEvolution</a></div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8h_source.html#l00172">ScalarEvolution.h:172</a></div></div>
<div class="ttc" id="classllvm_1_1DenseMap_html"><div class="ttname"><a href="classllvm_1_1DenseMap.html">llvm::DenseMap</a></div><div class="ttdef"><b>Definition:</b> <a href="DenseMap_8h_source.html#l00534">DenseMap.h:534</a></div></div>
<div class="ttc" id="classllvm_1_1StoreInst_html_a1149c7eeefca671ac2685bca13843568"><div class="ttname"><a href="classllvm_1_1StoreInst.html#a1149c7eeefca671ac2685bca13843568">llvm::StoreInst::isSimple</a></div><div class="ttdeci">bool isSimple() const </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00338">Instructions.h:338</a></div></div>
<div class="ttc" id="README-SSE_8txt_html_a63d206a063eefcdf8c318ded97b65020"><div class="ttname"><a href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a></div><div class="ttdeci">This currently compiles esp xmm0 movsd esp eax eax esp ret We should use not the dag combiner This is because dagcombine2 needs to be able to see through the X86ISD::Wrapper which DAGCombine can t really do The code for turning x load into a single vector load is target independent and should be moved to the dag combiner The code for turning x load into a vector load can only handle a direct load from a global or a direct load from the stack It should be generalized to handle any load from P</div><div class="ttdef"><b>Definition:</b> <a href="README-SSE_8txt_source.html#l00427">README-SSE.txt:427</a></div></div>
<div class="ttc" id="classllvm_1_1Pass_html_a048082a5be9ae0d8901ea64de59e5c8f"><div class="ttname"><a href="classllvm_1_1Pass.html#a048082a5be9ae0d8901ea64de59e5c8f">llvm::Pass::getAnalysisUsage</a></div><div class="ttdeci">virtual void getAnalysisUsage(AnalysisUsage &amp;) const </div><div class="ttdef"><b>Definition:</b> <a href="Pass_8cpp_source.html#l00075">Pass.cpp:75</a></div></div>
<div class="ttc" id="classllvm_1_1PHINode_html"><div class="ttname"><a href="classllvm_1_1PHINode.html">llvm::PHINode</a></div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l01978">Instructions.h:1978</a></div></div>
<div class="ttc" id="namespacellvm_1_1LibFunc_html_abf8f6830387f338fed0bce2e65108c6fab5ad1d91e85f029b6fa7ee26cbb9e122"><div class="ttname"><a href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fab5ad1d91e85f029b6fa7ee26cbb9e122">llvm::LibFunc::cos</a></div><div class="ttdoc">double cos(double x); </div><div class="ttdef"><b>Definition:</b> <a href="TargetLibraryInfo_8h_source.html#l00177">TargetLibraryInfo.h:177</a></div></div>
<div class="ttc" id="Debug_8h_html"><div class="ttname"><a href="Debug_8h.html">Debug.h</a></div></div>
<div class="ttc" id="classllvm_1_1CallInst_html"><div class="ttname"><a href="classllvm_1_1CallInst.html">llvm::CallInst</a></div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l01161">Instructions.h:1161</a></div></div>
<div class="ttc" id="Target_2README_8txt_html_a3a76669632041022e6976766a22bd2b0"><div class="ttname"><a href="Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a></div><div class="ttdeci">return j(j&lt;&lt; 16)</div></div>
<div class="ttc" id="LoopVectorize_8cpp_html_ae0635a013d9930362a412c26d0978739"><div class="ttname"><a href="LoopVectorize_8cpp.html#ae0635a013d9930362a412c26d0978739">isStridedPtr</a></div><div class="ttdeci">static int isStridedPtr(ScalarEvolution *SE, DataLayout *DL, Value *Ptr, const Loop *Lp)</div><div class="ttdoc">Check the stride of the pointer and ensure that it does not wrap in the address space. </div><div class="ttdef"><b>Definition:</b> <a href="LoopVectorize_8cpp_source.html#l03557">LoopVectorize.cpp:3557</a></div></div>
<div class="ttc" id="namespacellvm_1_1LibFunc_html_abf8f6830387f338fed0bce2e65108c6fa782a4bc8f1f44e735a02061b84af3ae0"><div class="ttname"><a href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fa782a4bc8f1f44e735a02061b84af3ae0">llvm::LibFunc::truncf</a></div><div class="ttdoc">float truncf(float x); </div><div class="ttdef"><b>Definition:</b> <a href="TargetLibraryInfo_8h_source.html#l00616">TargetLibraryInfo.h:616</a></div></div>
<div class="ttc" id="structllvm_1_1DenseMapInfo_html"><div class="ttname"><a href="structllvm_1_1DenseMapInfo.html">llvm::DenseMapInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="DenseMapInfo_8h_source.html#l00023">DenseMapInfo.h:23</a></div></div>
<div class="ttc" id="LoopVectorize_8cpp_html_a71e2ca53c4dead6e5f91af3320e40499"><div class="ttname"><a href="LoopVectorize_8cpp.html#a71e2ca53c4dead6e5f91af3320e40499">getReductionBinOp</a></div><div class="ttdeci">static unsigned getReductionBinOp(LoopVectorizationLegality::ReductionKind Kind)</div><div class="ttdoc">This function translates the reduction kind to an LLVM binary operator. </div><div class="ttdef"><b>Definition:</b> <a href="LoopVectorize_8cpp_source.html#l02006">LoopVectorize.cpp:2006</a></div></div>
<div class="ttc" id="namespacellvm_1_1LibFunc_html_abf8f6830387f338fed0bce2e65108c6fa3e0dfbf297df565a836b7263a922146a"><div class="ttname"><a href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fa3e0dfbf297df565a836b7263a922146a">llvm::LibFunc::sinl</a></div><div class="ttdoc">long double sinl(long double x); </div><div class="ttdef"><b>Definition:</b> <a href="TargetLibraryInfo_8h_source.html#l00505">TargetLibraryInfo.h:505</a></div></div>
<div class="ttc" id="namespacellvm_1_1cl_html_afcbd4ecc474e2d218391d6d3027b086aa7861ef1db44eac8ea7a373cd7c53a7c5"><div class="ttname"><a href="namespacellvm_1_1cl.html#afcbd4ecc474e2d218391d6d3027b086aa7861ef1db44eac8ea7a373cd7c53a7c5">llvm::cl::Prefix</a></div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l00131">CommandLine.h:131</a></div></div>
<div class="ttc" id="classllvm_1_1CmpInst_html_a283f9a5d4d843d20c40bb4d3e364bb05a91d86a4753c8bd7624e01bf565d87f8e"><div class="ttname"><a href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05a91d86a4753c8bd7624e01bf565d87f8e">llvm::CmpInst::ICMP_ULT</a></div><div class="ttdoc">unsigned less than </div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00676">InstrTypes.h:676</a></div></div>
<div class="ttc" id="classllvm_1_1SmallPtrSet_html_a9b6dd0fc7a648a939e571246045b673e"><div class="ttname"><a href="classllvm_1_1SmallPtrSet.html#a9b6dd0fc7a648a939e571246045b673e">llvm::SmallPtrSet::insert</a></div><div class="ttdeci">bool insert(PtrType Ptr)</div><div class="ttdef"><b>Definition:</b> <a href="SmallPtrSet_8h_source.html#l00253">SmallPtrSet.h:253</a></div></div>
<div class="ttc" id="classllvm_1_1CmpInst_html_a283f9a5d4d843d20c40bb4d3e364bb05a326bee0a4a424cef21c1cf8adb8b8dd8"><div class="ttname"><a href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05a326bee0a4a424cef21c1cf8adb8b8dd8">llvm::CmpInst::FCMP_OLT</a></div><div class="ttdoc">0 1 0 0 True if ordered and less than </div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00657">InstrTypes.h:657</a></div></div>
<div class="ttc" id="namespacellvm_1_1LibFunc_html_abf8f6830387f338fed0bce2e65108c6fa05508f8c6ed5aa858e634f44bebeabf9"><div class="ttname"><a href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fa05508f8c6ed5aa858e634f44bebeabf9">llvm::LibFunc::exp2f</a></div><div class="ttdoc">float exp2f(float x); </div><div class="ttdef"><b>Definition:</b> <a href="TargetLibraryInfo_8h_source.html#l00201">TargetLibraryInfo.h:201</a></div></div>
<div class="ttc" id="classllvm_1_1StringRef_html_a3d0712956e53687d1894ba17b84aeffa"><div class="ttname"><a href="classllvm_1_1StringRef.html#a3d0712956e53687d1894ba17b84aeffa">llvm::StringRef::substr</a></div><div class="ttdeci">StringRef substr(size_t Start, size_t N=npos) const </div><div class="ttdef"><b>Definition:</b> <a href="StringRef_8h_source.html#l00392">StringRef.h:392</a></div></div>
<div class="ttc" id="LoopVectorize_8cpp_html_a5318ba92781fc5fa3e26483f058b470a"><div class="ttname"><a href="LoopVectorize_8cpp.html#a5318ba92781fc5fa3e26483f058b470a">TinyTripCountVectorThreshold</a></div><div class="ttdeci">static cl::opt&lt; unsigned &gt; TinyTripCountVectorThreshold(&quot;vectorizer-min-trip-count&quot;, cl::init(16), cl::Hidden, cl::desc(&quot;Don't vectorize loops with a constant &quot;&quot;trip count that is smaller than this &quot;&quot;value.&quot;))</div><div class="ttdoc">We don&amp;#39;t vectorize loops with a known constant trip count below this number. </div></div>
<div class="ttc" id="classllvm_1_1SCEVAddRecExpr_html_a443e9130cd9f3e3baaa1b566e6aa5060"><div class="ttname"><a href="classllvm_1_1SCEVAddRecExpr.html#a443e9130cd9f3e3baaa1b566e6aa5060">llvm::SCEVAddRecExpr::getStepRecurrence</a></div><div class="ttdeci">const SCEV * getStepRecurrence(ScalarEvolution &amp;SE) const </div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolutionExpressions_8h_source.html#l00300">ScalarEvolutionExpressions.h:300</a></div></div>
<div class="ttc" id="namespacellvm_1_1LibFunc_html_abf8f6830387f338fed0bce2e65108c6fa961ece50208c300ef05a2a3d0f727545"><div class="ttname"><a href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fa961ece50208c300ef05a2a3d0f727545">llvm::LibFunc::expf</a></div><div class="ttdoc">float expf(float x); </div><div class="ttdef"><b>Definition:</b> <a href="TargetLibraryInfo_8h_source.html#l00205">TargetLibraryInfo.h:205</a></div></div>
<div class="ttc" id="namespacellvm_html_a6feec53bc62dc3b5677f0b7c066535d3"><div class="ttname"><a href="namespacellvm.html#a6feec53bc62dc3b5677f0b7c066535d3">llvm::initializeLoopVectorizePass</a></div><div class="ttdeci">void initializeLoopVectorizePass(PassRegistry &amp;)</div></div>
<div class="ttc" id="namespacellvm_1_1Intrinsic_html_a73349916f7e54a6b988a3646c7a02e90a7a35a0c20884a2a1b608229116ff92b1"><div class="ttname"><a href="namespacellvm_1_1Intrinsic.html#a73349916f7e54a6b988a3646c7a02e90a7a35a0c20884a2a1b608229116ff92b1">llvm::Intrinsic::exp2</a></div><div class="ttdef"><b>Definition:</b> <a href="Intrinsics_8h_source.html#l00384">Intrinsics.h:384</a></div></div>
<div class="ttc" id="namespacellvm_1_1NVPTX_1_1PTXLdStInstCode_html_a91119cbee2be000c528a690252aee07ca09c68d67f7dbfa6cc77eaf73aa535217"><div class="ttname"><a href="namespacellvm_1_1NVPTX_1_1PTXLdStInstCode.html#a91119cbee2be000c528a690252aee07ca09c68d67f7dbfa6cc77eaf73aa535217">llvm::NVPTX::PTXLdStInstCode::Scalar</a></div><div class="ttdef"><b>Definition:</b> <a href="NVPTX_8h_source.html#l00126">NVPTX.h:126</a></div></div>
<div class="ttc" id="namespacellvm_1_1sys_1_1path_html_a33706aab89e700b8f79e1fa6f4f0e3ee"><div class="ttname"><a href="namespacellvm_1_1sys_1_1path.html#a33706aab89e700b8f79e1fa6f4f0e3ee">llvm::sys::path::begin</a></div><div class="ttdeci">const_iterator begin(StringRef path)</div><div class="ttdoc">Get begin iterator over path. </div><div class="ttdef"><b>Definition:</b> <a href="Path_8cpp_source.html#l00173">Path.cpp:173</a></div></div>
<div class="ttc" id="classllvm_1_1MapVector_html"><div class="ttname"><a href="classllvm_1_1MapVector.html">llvm::MapVector</a></div><div class="ttdef"><b>Definition:</b> <a href="MapVector_8h_source.html#l00033">MapVector.h:33</a></div></div>
<div class="ttc" id="classllvm_1_1ScalarEvolution_html_a5a19768af81df7e5fe571bc08dcd48b3"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html#a5a19768af81df7e5fe571bc08dcd48b3">llvm::ScalarEvolution::isLoopInvariant</a></div><div class="ttdeci">bool isLoopInvariant(const SCEV *S, const Loop *L)</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8cpp_source.html#l07497">ScalarEvolution.cpp:7497</a></div></div>
<div class="ttc" id="Transforms_2Vectorize_8h_html"><div class="ttname"><a href="Transforms_2Vectorize_8h.html">Vectorize.h</a></div></div>
<div class="ttc" id="classllvm_1_1User_html_a5d1730a173d0a69624b80e1e22e6d225"><div class="ttname"><a href="classllvm_1_1User.html#a5d1730a173d0a69624b80e1e22e6d225">llvm::User::value_op_end</a></div><div class="ttdeci">value_op_iterator value_op_end()</div><div class="ttdef"><b>Definition:</b> <a href="User_8h_source.html#l00156">User.h:156</a></div></div>
<div class="ttc" id="namespacellvm_1_1Intrinsic_html_a73349916f7e54a6b988a3646c7a02e90a731d303bf0e4c2bf8bfe546590cd8352"><div class="ttname"><a href="namespacellvm_1_1Intrinsic.html#a73349916f7e54a6b988a3646c7a02e90a731d303bf0e4c2bf8bfe546590cd8352">llvm::Intrinsic::round</a></div><div class="ttdef"><b>Definition:</b> <a href="Intrinsics_8h_source.html#l02430">Intrinsics.h:2430</a></div></div>
<div class="ttc" id="classllvm_1_1BasicBlock_html_aca229503e4f5c83a187a6a921c625fa8"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#aca229503e4f5c83a187a6a921c625fa8">llvm::BasicBlock::getParent</a></div><div class="ttdeci">const Function * getParent() const </div><div class="ttdoc">Return the enclosing method, or null if none. </div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00116">BasicBlock.h:116</a></div></div>
<div class="ttc" id="namespacellvm_1_1LibFunc_html_abf8f6830387f338fed0bce2e65108c6fadb44221ce904c9dc8c7763a11576edd8"><div class="ttname"><a href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fadb44221ce904c9dc8c7763a11576edd8">llvm::LibFunc::expl</a></div><div class="ttdoc">long double expl(long double x); </div><div class="ttdef"><b>Definition:</b> <a href="TargetLibraryInfo_8h_source.html#l00207">TargetLibraryInfo.h:207</a></div></div>
<div class="ttc" id="LoopVectorize_8cpp_html_abe6d015febd4845fa107ab9c87c031c0"><div class="ttname"><a href="LoopVectorize_8cpp.html#abe6d015febd4845fa107ab9c87c031c0">isInBoundsGep</a></div><div class="ttdeci">static bool isInBoundsGep(Value *Ptr)</div><div class="ttdef"><b>Definition:</b> <a href="LoopVectorize_8cpp_source.html#l03550">LoopVectorize.cpp:3550</a></div></div>
<div class="ttc" id="namespacellvm_1_1LibFunc_html_abf8f6830387f338fed0bce2e65108c6fa7b4b4719f17bfc590fe1f8726d049e30"><div class="ttname"><a href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fa7b4b4719f17bfc590fe1f8726d049e30">llvm::LibFunc::nearbyint</a></div><div class="ttdoc">double nearbyint(double x); </div><div class="ttdef"><b>Definition:</b> <a href="TargetLibraryInfo_8h_source.html#l00410">TargetLibraryInfo.h:410</a></div></div>
<div class="ttc" id="classllvm_1_1PredIterator_html"><div class="ttname"><a href="classllvm_1_1PredIterator.html">llvm::PredIterator</a></div><div class="ttdef"><b>Definition:</b> <a href="Support_2CFG_8h_source.html#l00029">Support/CFG.h:29</a></div></div>
<div class="ttc" id="classllvm_1_1DebugLoc_html"><div class="ttname"><a href="classllvm_1_1DebugLoc.html">llvm::DebugLoc</a></div><div class="ttdef"><b>Definition:</b> <a href="DebugLoc_8h_source.html#l00028">DebugLoc.h:28</a></div></div>
<div class="ttc" id="classllvm_1_1MDNode_html"><div class="ttname"><a href="classllvm_1_1MDNode.html">llvm::MDNode</a></div><div class="ttdoc">MDNode - a tuple of other values. </div><div class="ttdef"><b>Definition:</b> <a href="Metadata_8h_source.html#l00073">Metadata.h:73</a></div></div>
<div class="ttc" id="LLParser_8cpp_html_a33ece1ef8074506a15d7f86eb76dbae6"><div class="ttname"><a href="LLParser_8cpp.html#a33ece1ef8074506a15d7f86eb76dbae6">F</a></div><div class="ttdeci">F(f)</div></div>
<div class="ttc" id="namespacellvm_html_a433468826ef20b5ddb53704fc38363fc"><div class="ttname"><a href="namespacellvm.html#a433468826ef20b5ddb53704fc38363fc">llvm::isNoAliasCall</a></div><div class="ttdeci">bool isNoAliasCall(const Value *V)</div><div class="ttdef"><b>Definition:</b> <a href="AliasAnalysis_8cpp_source.html#l00523">AliasAnalysis.cpp:523</a></div></div>
<div class="ttc" id="classllvm_1_1Function_html"><div class="ttname"><a href="classllvm_1_1Function.html">llvm::Function</a></div><div class="ttdef"><b>Definition:</b> <a href="Function_8h_source.html#l00070">Function.h:70</a></div></div>
<div class="ttc" id="classllvm_1_1LoadInst_html"><div class="ttname"><a href="classllvm_1_1LoadInst.html">llvm::LoadInst</a></div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00136">Instructions.h:136</a></div></div>
<div class="ttc" id="namespacellvm_1_1PatternMatch_html_ac043191f36a8e63baf22e9398394cff9"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#ac043191f36a8e63baf22e9398394cff9">llvm::PatternMatch::m_UnordFMax</a></div><div class="ttdeci">MaxMin_match&lt; FCmpInst, LHS, RHS, ufmax_pred_ty &gt; m_UnordFMax(const LHS &amp;L, const RHS &amp;R)</div><div class="ttdoc">Match an &amp;#39;unordered&amp;#39; floating point maximum function. Floating point has one special value &amp;#39;NaN&amp;#39;...</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l01003">PatternMatch.h:1003</a></div></div>
<div class="ttc" id="classllvm_1_1IntervalMap_html_a51e234ecb8eb36b77d36c3585f4d094b"><div class="ttname"><a href="classllvm_1_1IntervalMap.html#a51e234ecb8eb36b77d36c3585f4d094b">llvm::IntervalMap::end</a></div><div class="ttdeci">const_iterator end() const </div><div class="ttdef"><b>Definition:</b> <a href="IntervalMap_8h_source.html#l01122">IntervalMap.h:1122</a></div></div>
<div class="ttc" id="namespacellvm_1_1Intrinsic_html_ac015f68d60ea67a2e31bc10bc720d3e8"><div class="ttname"><a href="namespacellvm_1_1Intrinsic.html#ac015f68d60ea67a2e31bc10bc720d3e8">llvm::Intrinsic::getType</a></div><div class="ttdeci">FunctionType * getType(LLVMContext &amp;Context, ID id, ArrayRef&lt; Type * &gt; Tys=None)</div><div class="ttdef"><b>Definition:</b> <a href="Function_8cpp_source.html#l00657">Function.cpp:657</a></div></div>
<div class="ttc" id="classllvm_1_1Type_html_a33f9fa1a7cb21319a30836fce847c3c4"><div class="ttname"><a href="classllvm_1_1Type.html#a33f9fa1a7cb21319a30836fce847c3c4">llvm::Type::getPointerAddressSpace</a></div><div class="ttdeci">unsigned getPointerAddressSpace() const </div><div class="ttdoc">Get the address space of this pointer or pointer vector type. </div><div class="ttdef"><b>Definition:</b> <a href="Type_8cpp_source.html#l00218">Type.cpp:218</a></div></div>
<div class="ttc" id="classllvm_1_1EquivalenceClasses_html_aae2c0f52f973c407654c6f0bea9c95e8"><div class="ttname"><a href="classllvm_1_1EquivalenceClasses.html#aae2c0f52f973c407654c6f0bea9c95e8">llvm::EquivalenceClasses::member_begin</a></div><div class="ttdeci">member_iterator member_begin(iterator I) const </div><div class="ttdef"><b>Definition:</b> <a href="EquivalenceClasses_8h_source.html#l00148">EquivalenceClasses.h:148</a></div></div>
<div class="ttc" id="classllvm_1_1AttributeSet_html_a54abbe67d4a53c92652f1666dc19281f"><div class="ttname"><a href="classllvm_1_1AttributeSet.html#a54abbe67d4a53c92652f1666dc19281f">llvm::AttributeSet::hasAttribute</a></div><div class="ttdeci">bool hasAttribute(unsigned Index, Attribute::AttrKind Kind) const </div><div class="ttdoc">Return true if the attribute exists at the given index. </div><div class="ttdef"><b>Definition:</b> <a href="Attributes_8cpp_source.html#l00818">Attributes.cpp:818</a></div></div>
<div class="ttc" id="classllvm_1_1LoadInst_html_a156c478ee8e7d1602143cdbad4bd5385"><div class="ttname"><a href="classllvm_1_1LoadInst.html#a156c478ee8e7d1602143cdbad4bd5385">llvm::LoadInst::isSimple</a></div><div class="ttdeci">bool isSimple() const </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00218">Instructions.h:218</a></div></div>
<div class="ttc" id="classllvm_1_1SmallSet_html_a75a2d2ad3b3dce6702750d570ee8f343"><div class="ttname"><a href="classllvm_1_1SmallSet.html#a75a2d2ad3b3dce6702750d570ee8f343">llvm::SmallSet::erase</a></div><div class="ttdeci">bool erase(const T &amp;V)</div><div class="ttdef"><b>Definition:</b> <a href="SmallSet_8h_source.html#l00086">SmallSet.h:86</a></div></div>
<div class="ttc" id="classllvm_1_1User_html_a2eeb1c7ed1cfe403f2ae0470e36c07e2"><div class="ttname"><a href="classllvm_1_1User.html#a2eeb1c7ed1cfe403f2ae0470e36c07e2">llvm::User::op_begin</a></div><div class="ttdeci">op_iterator op_begin()</div><div class="ttdef"><b>Definition:</b> <a href="User_8h_source.html#l00116">User.h:116</a></div></div>
<div class="ttc" id="namespacellvm_1_1ARM__PROC_html_a1add7850fad3f66c140ecee871460ea4ae9d798593a4a6b5cc48486a453a59e5e"><div class="ttname"><a href="namespacellvm_1_1ARM__PROC.html#a1add7850fad3f66c140ecee871460ea4ae9d798593a4a6b5cc48486a453a59e5e">llvm::ARM_PROC::IE</a></div><div class="ttdef"><b>Definition:</b> <a href="ARMBaseInfo_8h_source.html#l00091">ARMBaseInfo.h:91</a></div></div>
<div class="ttc" id="namespacellvm_1_1cl_html_a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6"><div class="ttname"><a href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">llvm::cl::Hidden</a></div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l00109">CommandLine.h:109</a></div></div>
<div class="ttc" id="namespacellvm_1_1LibFunc_html_abf8f6830387f338fed0bce2e65108c6fa91ad52fe1d8397138fc997534a2e3297"><div class="ttname"><a href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fa91ad52fe1d8397138fc997534a2e3297">llvm::LibFunc::nearbyintl</a></div><div class="ttdoc">long double nearbyintl(long double x); </div><div class="ttdef"><b>Definition:</b> <a href="TargetLibraryInfo_8h_source.html#l00414">TargetLibraryInfo.h:414</a></div></div>
<div class="ttc" id="classllvm_1_1IRBuilder_html_abd3da4c9a7bdee3fb759a06410095f75"><div class="ttname"><a href="classllvm_1_1IRBuilder.html#abd3da4c9a7bdee3fb759a06410095f75">llvm::IRBuilder::Insert</a></div><div class="ttdeci">InstTy * Insert(InstTy *I, const Twine &amp;Name=&quot;&quot;) const </div><div class="ttdoc">Insert and return the specified instruction. </div><div class="ttdef"><b>Definition:</b> <a href="IRBuilder_8h_source.html#l00475">IRBuilder.h:475</a></div></div>
<div class="ttc" id="classllvm_1_1Type_html_a5c09d927a0079ad16e8367271efe9bc2"><div class="ttname"><a href="classllvm_1_1Type.html#a5c09d927a0079ad16e8367271efe9bc2">llvm::Type::getPointerElementType</a></div><div class="ttdeci">Type * getPointerElementType() const </div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00373">Type.h:373</a></div></div>
<div class="ttc" id="namespacellvm_1_1LibFunc_html_abf8f6830387f338fed0bce2e65108c6fad0a09e2728a769f54ffea5bb54747daa"><div class="ttname"><a href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fad0a09e2728a769f54ffea5bb54747daa">llvm::LibFunc::trunc</a></div><div class="ttdoc">double trunc(double x); </div><div class="ttdef"><b>Definition:</b> <a href="TargetLibraryInfo_8h_source.html#l00614">TargetLibraryInfo.h:614</a></div></div>
<div class="ttc" id="classllvm_1_1MDNode_html_ad66ceb4f77078b084e527a19baab19d6"><div class="ttname"><a href="classllvm_1_1MDNode.html#ad66ceb4f77078b084e527a19baab19d6">llvm::MDNode::get</a></div><div class="ttdeci">static MDNode * get(LLVMContext &amp;Context, ArrayRef&lt; Value * &gt; Vals)</div><div class="ttdef"><b>Definition:</b> <a href="Metadata_8cpp_source.html#l00268">Metadata.cpp:268</a></div></div>
<div class="ttc" id="classllvm_1_1SCEVAddRecExpr_html_a0d53a749bd858b270d322b34b8d7e1e5"><div class="ttname"><a href="classllvm_1_1SCEVAddRecExpr.html#a0d53a749bd858b270d322b34b8d7e1e5">llvm::SCEVAddRecExpr::getStart</a></div><div class="ttdeci">const SCEV * getStart() const </div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolutionExpressions_8h_source.html#l00293">ScalarEvolutionExpressions.h:293</a></div></div>
<div class="ttc" id="classllvm_1_1generic__gep__type__iterator_html"><div class="ttname"><a href="classllvm_1_1generic__gep__type__iterator.html">llvm::generic_gep_type_iterator</a></div><div class="ttdef"><b>Definition:</b> <a href="GetElementPtrTypeIterator_8h_source.html#l00023">GetElementPtrTypeIterator.h:23</a></div></div>
<div class="ttc" id="classllvm_1_1Value_html_ad452febc1ac0b394876e640ec03ffa38"><div class="ttname"><a href="classllvm_1_1Value.html#ad452febc1ac0b394876e640ec03ffa38">llvm::Value::getName</a></div><div class="ttdeci">StringRef getName() const </div><div class="ttdef"><b>Definition:</b> <a href="Value_8cpp_source.html#l00167">Value.cpp:167</a></div></div>
<div class="ttc" id="classllvm_1_1LoopBase_html_a8917d359fc92f25eb0117386588c6f1c"><div class="ttname"><a href="classllvm_1_1LoopBase.html#a8917d359fc92f25eb0117386588c6f1c">llvm::LoopBase::getLoopLatch</a></div><div class="ttdeci">BlockT * getLoopLatch() const </div><div class="ttdef"><b>Definition:</b> <a href="LoopInfoImpl_8h_source.html#l00154">LoopInfoImpl.h:154</a></div></div>
<div class="ttc" id="classllvm_1_1BasicBlock_html_a0ed5f3ab3c2e4196ee0cffffa080c062"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a0ed5f3ab3c2e4196ee0cffffa080c062">llvm::BasicBlock::begin</a></div><div class="ttdeci">iterator begin()</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00193">BasicBlock.h:193</a></div></div>
<div class="ttc" id="namespacellvm_1_1Intrinsic_html_a73349916f7e54a6b988a3646c7a02e90afcf978f83f97f765943aa6b0b679eb1d"><div class="ttname"><a href="namespacellvm_1_1Intrinsic.html#a73349916f7e54a6b988a3646c7a02e90afcf978f83f97f765943aa6b0b679eb1d">llvm::Intrinsic::trunc</a></div><div class="ttdef"><b>Definition:</b> <a href="Intrinsics_8h_source.html#l02444">Intrinsics.h:2444</a></div></div>
<div class="ttc" id="classllvm_1_1MDNode_html_adb91929f939ff02dbee552d32afaf4e6"><div class="ttname"><a href="classllvm_1_1MDNode.html#adb91929f939ff02dbee552d32afaf4e6">llvm::MDNode::getOperand</a></div><div class="ttdeci">Value * getOperand(unsigned i) const LLVM_READONLY</div><div class="ttdoc">getOperand - Return specified operand. </div><div class="ttdef"><b>Definition:</b> <a href="Metadata_8cpp_source.html#l00307">Metadata.cpp:307</a></div></div>
<div class="ttc" id="EquivalenceClasses_8h_html"><div class="ttname"><a href="EquivalenceClasses_8h.html">EquivalenceClasses.h</a></div></div>
<div class="ttc" id="classllvm_1_1IRBuilder_html_afce46232afe3b97b1a586eb762f307a4"><div class="ttname"><a href="classllvm_1_1IRBuilder.html#afce46232afe3b97b1a586eb762f307a4">llvm::IRBuilder::CreateICmpULE</a></div><div class="ttdeci">Value * CreateICmpULE(Value *LHS, Value *RHS, const Twine &amp;Name=&quot;&quot;)</div><div class="ttdef"><b>Definition:</b> <a href="IRBuilder_8h_source.html#l01221">IRBuilder.h:1221</a></div></div>
<div class="ttc" id="namespacellvm_1_1LibFunc_html_abf8f6830387f338fed0bce2e65108c6fa1f784d198f8bfe8a27ebc1f72d739161"><div class="ttname"><a href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fa1f784d198f8bfe8a27ebc1f72d739161">llvm::LibFunc::roundl</a></div><div class="ttdoc">long double roundl(long double x); </div><div class="ttdef"><b>Definition:</b> <a href="TargetLibraryInfo_8h_source.html#l00484">TargetLibraryInfo.h:484</a></div></div>
<div class="ttc" id="classllvm_1_1LoopBase_html_ab39f9623eaa8cd22213aa716c6fb9994"><div class="ttname"><a href="classllvm_1_1LoopBase.html#ab39f9623eaa8cd22213aa716c6fb9994">llvm::LoopBase&lt; BasicBlock, Loop &gt;::block_iterator</a></div><div class="ttdeci">std::vector&lt; BasicBlock * &gt;::const_iterator block_iterator</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l00139">LoopInfo.h:139</a></div></div>
<div class="ttc" id="classllvm_1_1APInt_html_a0e9a2d7ec903d191ef029589ec647cb6"><div class="ttname"><a href="classllvm_1_1APInt.html#a0e9a2d7ec903d191ef029589ec647cb6">llvm::APInt::isNegative</a></div><div class="ttdeci">bool isNegative() const </div><div class="ttdoc">Determine sign of this APInt. </div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l00322">APInt.h:322</a></div></div>
<div class="ttc" id="ScalarEvolutionExpander_8h_html"><div class="ttname"><a href="ScalarEvolutionExpander_8h.html">ScalarEvolutionExpander.h</a></div></div>
<div class="ttc" id="namespacellvm_1_1MCID_html_a8035044d40d3758eb45b65dce69dc90ba32dbd2c72a98eaee90e3ad5ef7b5af16"><div class="ttname"><a href="namespacellvm_1_1MCID.html#a8035044d40d3758eb45b65dce69dc90ba32dbd2c72a98eaee90e3ad5ef7b5af16">llvm::MCID::Select</a></div><div class="ttdef"><b>Definition:</b> <a href="MCInstrDesc_8h_source.html#l00113">MCInstrDesc.h:113</a></div></div>
<div class="ttc" id="classllvm_1_1CallInst_html_adfa58cca12e39889c36ca2aa668e68b2"><div class="ttname"><a href="classllvm_1_1CallInst.html#adfa58cca12e39889c36ca2aa668e68b2">llvm::CallInst::onlyReadsMemory</a></div><div class="ttdeci">bool onlyReadsMemory() const </div><div class="ttdoc">Determine if the call does not access or only reads memory. </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l01317">Instructions.h:1317</a></div></div>
<div class="ttc" id="namespacellvm_1_1LibFunc_html_abf8f6830387f338fed0bce2e65108c6fa311d355a7612d8ed79a9d1f8c3f734fa"><div class="ttname"><a href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fa311d355a7612d8ed79a9d1f8c3f734fa">llvm::LibFunc::fabsl</a></div><div class="ttdoc">long double fabsl(long double x); </div><div class="ttdef"><b>Definition:</b> <a href="TargetLibraryInfo_8h_source.html#l00219">TargetLibraryInfo.h:219</a></div></div>
<div class="ttc" id="namespacellvm_1_1PatternMatch_html_a25d956d9e0beadd47ce4bc255dfa811d"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">llvm::PatternMatch::match</a></div><div class="ttdeci">bool match(Val *V, const Pattern &amp;P)</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l00042">PatternMatch.h:42</a></div></div>
<div class="ttc" id="classllvm_1_1AnalysisUsage_html_ae5c60fd282ee894c87ea02c3f0fcb6d0"><div class="ttname"><a href="classllvm_1_1AnalysisUsage.html#ae5c60fd282ee894c87ea02c3f0fcb6d0">llvm::AnalysisUsage::addRequired</a></div><div class="ttdeci">AnalysisUsage &amp; addRequired()</div><div class="ttdef"><b>Definition:</b> <a href="PassAnalysisSupport_8h_source.html#l00055">PassAnalysisSupport.h:55</a></div></div>
<div class="ttc" id="namespacellvm_1_1GraphProgram_html_a0ad4685976f8c4d4a697a53fbe05d10b"><div class="ttname"><a href="namespacellvm_1_1GraphProgram.html#a0ad4685976f8c4d4a697a53fbe05d10b">llvm::GraphProgram::Name</a></div><div class="ttdeci">Name</div><div class="ttdef"><b>Definition:</b> <a href="GraphWriter_8h_source.html#l00044">GraphWriter.h:44</a></div></div>
<div class="ttc" id="PassSupport_8h_html_a14724f1ccf528e73bb29bc9230737967"><div class="ttname"><a href="PassSupport_8h.html#a14724f1ccf528e73bb29bc9230737967">INITIALIZE_PASS_DEPENDENCY</a></div><div class="ttdeci">#define INITIALIZE_PASS_DEPENDENCY(depName)</div><div class="ttdef"><b>Definition:</b> <a href="PassSupport_8h_source.html#l00167">PassSupport.h:167</a></div></div>
<div class="ttc" id="namespacellvm_1_1object_html_a63a8f680ecd1aa68ae0efdd3b5c4f4a7"><div class="ttname"><a href="namespacellvm_1_1object.html#a63a8f680ecd1aa68ae0efdd3b5c4f4a7">llvm::object::advance</a></div><div class="ttdeci">static error_code advance(T &amp;it, size_t Val)</div><div class="ttdef"><b>Definition:</b> <a href="MachOObjectFile_8cpp_source.html#l00278">MachOObjectFile.cpp:278</a></div></div>
<div class="ttc" id="LoopVectorize_8cpp_html_a952c05caf05575f974ed5bf7c1cf305f"><div class="ttname"><a href="LoopVectorize_8cpp.html#a952c05caf05575f974ed5bf7c1cf305f">RuntimeMemoryCheckThreshold</a></div><div class="ttdeci">static const unsigned RuntimeMemoryCheckThreshold</div><div class="ttdef"><b>Definition:</b> <a href="LoopVectorize_8cpp_source.html#l00122">LoopVectorize.cpp:122</a></div></div>
<div class="ttc" id="namespacellvm_1_1Intrinsic_html_a73349916f7e54a6b988a3646c7a02e90a2282198fc9635210d0f678fd0b92e5ce"><div class="ttname"><a href="namespacellvm_1_1Intrinsic.html#a73349916f7e54a6b988a3646c7a02e90a2282198fc9635210d0f678fd0b92e5ce">llvm::Intrinsic::sqrt</a></div><div class="ttdef"><b>Definition:</b> <a href="Intrinsics_8h_source.html#l02437">Intrinsics.h:2437</a></div></div>
<div class="ttc" id="classllvm_1_1value__use__iterator_html"><div class="ttname"><a href="classllvm_1_1value__use__iterator.html">llvm::value_use_iterator</a></div><div class="ttdef"><b>Definition:</b> <a href="Use_8h_source.html#l00168">Use.h:168</a></div></div>
<div class="ttc" id="LoopVectorize_8cpp_html_a3ef9112c12dac5ab9f2ca94868eed479"><div class="ttname"><a href="LoopVectorize_8cpp.html#a3ef9112c12dac5ab9f2ca94868eed479">MaxUnrollFactor</a></div><div class="ttdeci">static const unsigned MaxUnrollFactor</div><div class="ttdoc">Maximum vectorization unroll count. </div><div class="ttdef"><b>Definition:</b> <a href="LoopVectorize_8cpp_source.html#l00128">LoopVectorize.cpp:128</a></div></div>
<div class="ttc" id="namespacellvm_1_1LibFunc_html_abf8f6830387f338fed0bce2e65108c6fae21b44ea5af90d5a8682f5f7242146e7"><div class="ttname"><a href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fae21b44ea5af90d5a8682f5f7242146e7">llvm::LibFunc::cosl</a></div><div class="ttdoc">long double cosl(long double x); </div><div class="ttdef"><b>Definition:</b> <a href="TargetLibraryInfo_8h_source.html#l00187">TargetLibraryInfo.h:187</a></div></div>
<div class="ttc" id="namespacellvm_1_1LibFunc_html_abf8f6830387f338fed0bce2e65108c6fac87ea230161f1f2247a5f72da886a23d"><div class="ttname"><a href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fac87ea230161f1f2247a5f72da886a23d">llvm::LibFunc::round</a></div><div class="ttdoc">double round(double x); </div><div class="ttdef"><b>Definition:</b> <a href="TargetLibraryInfo_8h_source.html#l00480">TargetLibraryInfo.h:480</a></div></div>
<div class="ttc" id="classllvm_1_1SelectInst_html"><div class="ttname"><a href="classllvm_1_1SelectInst.html">llvm::SelectInst</a></div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l01430">Instructions.h:1430</a></div></div>
<div class="ttc" id="classllvm_1_1Instruction_html_ac72e0be80ec7138a1ec42c798b249981"><div class="ttname"><a href="classllvm_1_1Instruction.html#ac72e0be80ec7138a1ec42c798b249981">llvm::Instruction::isIdenticalTo</a></div><div class="ttdeci">bool isIdenticalTo(const Instruction *I) const </div><div class="ttdef"><b>Definition:</b> <a href="Instruction_8cpp_source.html#l00264">Instruction.cpp:264</a></div></div>
<div class="ttc" id="classllvm_1_1Twine_html"><div class="ttname"><a href="classllvm_1_1Twine.html">llvm::Twine</a></div><div class="ttdef"><b>Definition:</b> <a href="Twine_8h_source.html#l00081">Twine.h:81</a></div></div>
<div class="ttc" id="classllvm_1_1CastInst_html"><div class="ttname"><a href="classllvm_1_1CastInst.html">llvm::CastInst</a></div><div class="ttdoc">Base class of casting instructions. </div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00387">InstrTypes.h:387</a></div></div>
<div class="ttc" id="LoopInfo_8h_html"><div class="ttname"><a href="LoopInfo_8h.html">LoopInfo.h</a></div></div>
<div class="ttc" id="classllvm_1_1ConstantInt_html_af8dde13a97efce293a7b04daf1e208fb"><div class="ttname"><a href="classllvm_1_1ConstantInt.html#af8dde13a97efce293a7b04daf1e208fb">llvm::ConstantInt::getValue</a></div><div class="ttdeci">const APInt &amp; getValue() const </div><div class="ttdoc">Return the constant&amp;#39;s value. </div><div class="ttdef"><b>Definition:</b> <a href="Constants_8h_source.html#l00105">Constants.h:105</a></div></div>
<div class="ttc" id="classllvm_1_1TargetLibraryInfo_html_a2e29ccd61341a821011294b733173fda"><div class="ttname"><a href="classllvm_1_1TargetLibraryInfo.html#a2e29ccd61341a821011294b733173fda">llvm::TargetLibraryInfo::getLibFunc</a></div><div class="ttdeci">bool getLibFunc(StringRef funcName, LibFunc::Func &amp;F) const </div><div class="ttdef"><b>Definition:</b> <a href="TargetLibraryInfo_8cpp_source.html#l00659">TargetLibraryInfo.cpp:659</a></div></div>
<div class="ttc" id="classllvm_1_1CmpInst_html_a283f9a5d4d843d20c40bb4d3e364bb05ac17897ebf2f6a6986280fc3bdf28a30a"><div class="ttname"><a href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05ac17897ebf2f6a6986280fc3bdf28a30a">llvm::CmpInst::ICMP_NE</a></div><div class="ttdoc">not equal </div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00673">InstrTypes.h:673</a></div></div>
<div class="ttc" id="ErrorHandling_8h_html_ace243f5c25697a1107cce46626b3dc94"><div class="ttname"><a href="ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a></div><div class="ttdeci">#define llvm_unreachable(msg)</div><div class="ttdef"><b>Definition:</b> <a href="ErrorHandling_8h_source.html#l00103">ErrorHandling.h:103</a></div></div>
<div class="ttc" id="classllvm_1_1Use_html"><div class="ttname"><a href="classllvm_1_1Use.html">llvm::Use</a></div><div class="ttdef"><b>Definition:</b> <a href="Use_8h_source.html#l00060">Use.h:60</a></div></div>
<div class="ttc" id="classllvm_1_1BinaryOperator_html_aaa9083a85e23c9c5ee366920d90ae51e"><div class="ttname"><a href="classllvm_1_1BinaryOperator.html#aaa9083a85e23c9c5ee366920d90ae51e">llvm::BinaryOperator::setHasNoUnsignedWrap</a></div><div class="ttdeci">void setHasNoUnsignedWrap(bool b=true)</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8cpp_source.html#l01997">Instructions.cpp:1997</a></div></div>
<div class="ttc" id="classllvm_1_1EquivalenceClasses_html_aebaeeb87ebb6d56f063c394d160ead3e"><div class="ttname"><a href="classllvm_1_1EquivalenceClasses.html#aebaeeb87ebb6d56f063c394d160ead3e">llvm::EquivalenceClasses::member_end</a></div><div class="ttdeci">member_iterator member_end() const </div><div class="ttdef"><b>Definition:</b> <a href="EquivalenceClasses_8h_source.html#l00152">EquivalenceClasses.h:152</a></div></div>
<div class="ttc" id="PassSupport_8h_html_a74ce8276b89067e806f67c45a6d92575"><div class="ttname"><a href="PassSupport_8h.html#a74ce8276b89067e806f67c45a6d92575">INITIALIZE_PASS_END</a></div><div class="ttdeci">#define INITIALIZE_PASS_END(passName, arg, name, cfg, analysis)</div><div class="ttdef"><b>Definition:</b> <a href="PassSupport_8h_source.html#l00172">PassSupport.h:172</a></div></div>
<div class="ttc" id="namespacellvm_1_1LibFunc_html_abf8f6830387f338fed0bce2e65108c6faa5f74d0f4796907f9845103b1f6a61db"><div class="ttname"><a href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6faa5f74d0f4796907f9845103b1f6a61db">llvm::LibFunc::copysign</a></div><div class="ttdoc">double copysign(double x, double y); </div><div class="ttdef"><b>Definition:</b> <a href="TargetLibraryInfo_8h_source.html#l00171">TargetLibraryInfo.h:171</a></div></div>
<div class="ttc" id="classllvm_1_1CallInst_html_ac88b95273e6c753188f6a54d65548579"><div class="ttname"><a href="classllvm_1_1CallInst.html#ac88b95273e6c753188f6a54d65548579">llvm::CallInst::getNumArgOperands</a></div><div class="ttdeci">unsigned getNumArgOperands() const </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l01241">Instructions.h:1241</a></div></div>
<div class="ttc" id="classllvm_1_1BasicBlock_html_a0e73f4e09745bb69fdd7b15232c45428"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a0e73f4e09745bb69fdd7b15232c45428">llvm::BasicBlock::getFirstNonPHI</a></div><div class="ttdeci">Instruction * getFirstNonPHI()</div><div class="ttdoc">Returns a pointer to the first instruction in this block that is not a PHINode instruction. </div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8cpp_source.html#l00130">BasicBlock.cpp:130</a></div></div>
<div class="ttc" id="classllvm_1_1ConstantVector_html_ade9fa017ca3aa82f7694a47090547bc1"><div class="ttname"><a href="classllvm_1_1ConstantVector.html#ade9fa017ca3aa82f7694a47090547bc1">llvm::ConstantVector::get</a></div><div class="ttdeci">static Constant * get(ArrayRef&lt; Constant * &gt; V)</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l00923">Constants.cpp:923</a></div></div>
<div class="ttc" id="classllvm_1_1IRBuilder_html"><div class="ttname"><a href="classllvm_1_1IRBuilder.html">llvm::IRBuilder</a></div><div class="ttdoc">This provides a uniform API for creating instructions and inserting them into a basic block: either a...</div><div class="ttdef"><b>Definition:</b> <a href="IRBuilder_8h_source.html#l00421">IRBuilder.h:421</a></div></div>
<div class="ttc" id="classllvm_1_1BranchInst_html_ae9cbc599309fd2da33ec1c61df01ce1f"><div class="ttname"><a href="classllvm_1_1BranchInst.html#ae9cbc599309fd2da33ec1c61df01ce1f">llvm::BranchInst::Create</a></div><div class="ttdeci">static BranchInst * Create(BasicBlock *IfTrue, Instruction *InsertBefore=0)</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02373">Instructions.h:2373</a></div></div>
<div class="ttc" id="namespacellvm_1_1LibFunc_html_abf8f6830387f338fed0bce2e65108c6fa59df814479e1f13712ebb50a1159bd19"><div class="ttname"><a href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fa59df814479e1f13712ebb50a1159bd19">llvm::LibFunc::log10</a></div><div class="ttdoc">double log10(double x); </div><div class="ttdef"><b>Definition:</b> <a href="TargetLibraryInfo_8h_source.html#l00348">TargetLibraryInfo.h:348</a></div></div>
<div class="ttc" id="namespacellvm_1_1PatternMatch_html_a22ec1b0d7fdb5ccfaa26c65373d5f362"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#a22ec1b0d7fdb5ccfaa26c65373d5f362">llvm::PatternMatch::m_UnordFMin</a></div><div class="ttdeci">MaxMin_match&lt; FCmpInst, LHS, RHS, ufmin_pred_ty &gt; m_UnordFMin(const LHS &amp;L, const RHS &amp;R)</div><div class="ttdoc">Match an &amp;#39;unordered&amp;#39; floating point minimum function. Floating point has one special value &amp;#39;NaN&amp;#39;...</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l01018">PatternMatch.h:1018</a></div></div>
<div class="ttc" id="namespacefalse_html"><div class="ttname"><a href="namespacefalse.html">false</a></div><div class="ttdef"><b>Definition:</b> <a href="StackSlotColoring_8cpp_source.html#l00126">StackSlotColoring.cpp:126</a></div></div>
<div class="ttc" id="classllvm_1_1Value_html_a35ee267850af7c235474a8c46c7ac5af"><div class="ttname"><a href="classllvm_1_1Value.html#a35ee267850af7c235474a8c46c7ac5af">llvm::Value::setName</a></div><div class="ttdeci">void setName(const Twine &amp;Name)</div><div class="ttdef"><b>Definition:</b> <a href="Value_8cpp_source.html#l00175">Value.cpp:175</a></div></div>
<div class="ttc" id="classllvm_1_1IntervalMap_1_1iterator_html"><div class="ttname"><a href="classllvm_1_1IntervalMap_1_1iterator.html">llvm::IntervalMap::iterator</a></div><div class="ttdef"><b>Definition:</b> <a href="IntervalMap_8h_source.html#l01519">IntervalMap.h:1519</a></div></div>
<div class="ttc" id="InstCombineCompares_8cpp_html_aa5ab8c7b55d8bc7cab66be444daa70a1"><div class="ttname"><a href="InstCombineCompares_8cpp.html#aa5ab8c7b55d8bc7cab66be444daa70a1">ExtractElement</a></div><div class="ttdeci">static ConstantInt * ExtractElement(Constant *V, Constant *Idx)</div><div class="ttdef"><b>Definition:</b> <a href="InstCombineCompares_8cpp_source.html#l00040">InstCombineCompares.cpp:40</a></div></div>
<div class="ttc" id="namespacellvm_1_1CallingConv_html_a4f861731fc6dbfdccc05af5968d98974"><div class="ttname"><a href="namespacellvm_1_1CallingConv.html#a4f861731fc6dbfdccc05af5968d98974">llvm::CallingConv::ID</a></div><div class="ttdeci">ID</div><div class="ttdoc">LLVM Calling Convention Representation. </div><div class="ttdef"><b>Definition:</b> <a href="CallingConv_8h_source.html#l00026">CallingConv.h:26</a></div></div>
<div class="ttc" id="classllvm_1_1Instruction_html_af6aad0c9ba7b8720130235c9621b55b5"><div class="ttname"><a href="classllvm_1_1Instruction.html#af6aad0c9ba7b8720130235c9621b55b5">llvm::Instruction::clone</a></div><div class="ttdeci">Instruction * clone() const </div><div class="ttdef"><b>Definition:</b> <a href="Instruction_8cpp_source.html#l00541">Instruction.cpp:541</a></div></div>
<div class="ttc" id="classllvm_1_1Module_html_a339f163decf5f2c881937600d1e953fa"><div class="ttname"><a href="classllvm_1_1Module.html#a339f163decf5f2c881937600d1e953fa">llvm::Module::getModuleIdentifier</a></div><div class="ttdeci">const std::string &amp; getModuleIdentifier() const </div><div class="ttdef"><b>Definition:</b> <a href="Module_8h_source.html#l00228">Module.h:228</a></div></div>
<div class="ttc" id="LoopVectorize_8cpp_html_acc13ee8b8985399901ac09b51822e21a"><div class="ttname"><a href="LoopVectorize_8cpp.html#acc13ee8b8985399901ac09b51822e21a">cse</a></div><div class="ttdeci">static void cse(BasicBlock *BB)</div><div class="ttdoc">Perform cse of induction variable instructions. </div><div class="ttdef"><b>Definition:</b> <a href="LoopVectorize_8cpp_source.html#l02097">LoopVectorize.cpp:2097</a></div></div>
<div class="ttc" id="classllvm_1_1Instruction_html"><div class="ttname"><a href="classllvm_1_1Instruction.html">llvm::Instruction</a></div><div class="ttdef"><b>Definition:</b> <a href="Instruction_8h_source.html#l00031">Instruction.h:31</a></div></div>
<div class="ttc" id="namespacellvm_1_1tgtok_html_abbc5259d649363016626e2529fabe0c5afef9bccea014fbcc9d61070cb7dbb5ff"><div class="ttname"><a href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5afef9bccea014fbcc9d61070cb7dbb5ff">llvm::tgtok::List</a></div><div class="ttdef"><b>Definition:</b> <a href="TGLexer_8h_source.html#l00046">TGLexer.h:46</a></div></div>
<div class="ttc" id="TargetLibraryInfo_8h_html"><div class="ttname"><a href="TargetLibraryInfo_8h.html">TargetLibraryInfo.h</a></div></div>
<div class="ttc" id="namespacellvm_1_1Intrinsic_html_a73349916f7e54a6b988a3646c7a02e90"><div class="ttname"><a href="namespacellvm_1_1Intrinsic.html#a73349916f7e54a6b988a3646c7a02e90">llvm::Intrinsic::ID</a></div><div class="ttdeci">ID</div><div class="ttdef"><b>Definition:</b> <a href="Intrinsics_8h_source.html#l00036">Intrinsics.h:36</a></div></div>
<div class="ttc" id="namespacellvm_html_aed2c5dd2a303159f87771db83f54352b"><div class="ttname"><a href="namespacellvm.html#aed2c5dd2a303159f87771db83f54352b">llvm::isIdentifiedObject</a></div><div class="ttdeci">bool isIdentifiedObject(const Value *V)</div><div class="ttdef"><b>Definition:</b> <a href="AliasAnalysis_8cpp_source.html#l00546">AliasAnalysis.cpp:546</a></div></div>
<div class="ttc" id="Dominators_8h_html"><div class="ttname"><a href="Dominators_8h.html">Dominators.h</a></div></div>
<div class="ttc" id="classllvm_1_1ConstantInt_html_a6edd823ba5e4e1effc8280ca8a1194ef"><div class="ttname"><a href="classllvm_1_1ConstantInt.html#a6edd823ba5e4e1effc8280ca8a1194ef">llvm::ConstantInt::getZExtValue</a></div><div class="ttdeci">uint64_t getZExtValue() const </div><div class="ttdoc">Return the zero extended value. </div><div class="ttdef"><b>Definition:</b> <a href="Constants_8h_source.html#l00116">Constants.h:116</a></div></div>
<div class="ttc" id="classllvm_1_1StoreInst_html_a6cac341b1b354174d0e0a81a2e7a9109"><div class="ttname"><a href="classllvm_1_1StoreInst.html#a6cac341b1b354174d0e0a81a2e7a9109">llvm::StoreInst::getPointerAddressSpace</a></div><div class="ttdeci">unsigned getPointerAddressSpace() const </div><div class="ttdoc">Returns the address space of the pointer operand. </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00351">Instructions.h:351</a></div></div>
<div class="ttc" id="namespacellvm_1_1LibFunc_html_abf8f6830387f338fed0bce2e65108c6fa44e103850c4472c7e43280c5252cde20"><div class="ttname"><a href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fa44e103850c4472c7e43280c5252cde20">llvm::LibFunc::log10f</a></div><div class="ttdoc">float log10f(float x); </div><div class="ttdef"><b>Definition:</b> <a href="TargetLibraryInfo_8h_source.html#l00350">TargetLibraryInfo.h:350</a></div></div>
<div class="ttc" id="classllvm_1_1IRBuilder_html_a88cc5a48bb4170aa6541c7c6364e03b5"><div class="ttname"><a href="classllvm_1_1IRBuilder.html#a88cc5a48bb4170aa6541c7c6364e03b5">llvm::IRBuilder::CreateFCmp</a></div><div class="ttdeci">Value * CreateFCmp(CmpInst::Predicate P, Value *LHS, Value *RHS, const Twine &amp;Name=&quot;&quot;)</div><div class="ttdef"><b>Definition:</b> <a href="IRBuilder_8h_source.html#l01287">IRBuilder.h:1287</a></div></div>
<div class="ttc" id="classllvm_1_1EquivalenceClasses_html_ab32ed10f483db713155827b70a046410"><div class="ttname"><a href="classllvm_1_1EquivalenceClasses.html#ab32ed10f483db713155827b70a046410">llvm::EquivalenceClasses::findValue</a></div><div class="ttdeci">iterator findValue(const ElemTy &amp;V) const </div><div class="ttdef"><b>Definition:</b> <a href="EquivalenceClasses_8h_source.html#l00158">EquivalenceClasses.h:158</a></div></div>
<div class="ttc" id="LoopVectorize_8cpp_html_a417c0c66aeccfcbee14042ec89bab074"><div class="ttname"><a href="LoopVectorize_8cpp.html#a417c0c66aeccfcbee14042ec89bab074">getIntrinsicIDForCall</a></div><div class="ttdeci">static Intrinsic::ID getIntrinsicIDForCall(CallInst *CI, const TargetLibraryInfo *TLI)</div><div class="ttdef"><b>Definition:</b> <a href="LoopVectorize_8cpp_source.html#l01888">LoopVectorize.cpp:1888</a></div></div>
<div class="ttc" id="classllvm_1_1IRBuilder_html_a197d5dd77cad4560a082900962a830aa"><div class="ttname"><a href="classllvm_1_1IRBuilder.html#a197d5dd77cad4560a082900962a830aa">llvm::IRBuilder::CreateAnd</a></div><div class="ttdeci">Value * CreateAnd(Value *LHS, Value *RHS, const Twine &amp;Name=&quot;&quot;)</div><div class="ttdef"><b>Definition:</b> <a href="IRBuilder_8h_source.html#l00789">IRBuilder.h:789</a></div></div>
<div class="ttc" id="LoopVectorize_8cpp_html_a2d7f676d7d60f9dd4f812eb55ee07aed"><div class="ttname"><a href="LoopVectorize_8cpp.html#a2d7f676d7d60f9dd4f812eb55ee07aed">getWiderType</a></div><div class="ttdeci">static Type * getWiderType(DataLayout &amp;DL, Type *Ty0, Type *Ty1)</div><div class="ttdef"><b>Definition:</b> <a href="LoopVectorize_8cpp_source.html#l02931">LoopVectorize.cpp:2931</a></div></div>
<div class="ttc" id="classllvm_1_1Type_html_af348d5ea83429d08ba891ca3dd0e92b2"><div class="ttname"><a href="classllvm_1_1Type.html#af348d5ea83429d08ba891ca3dd0e92b2">llvm::Type::getContext</a></div><div class="ttdeci">LLVMContext &amp; getContext() const </div><div class="ttdoc">getContext - Return the LLVMContext in which this type was uniqued. </div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00128">Type.h:128</a></div></div>
<div class="ttc" id="Hashing_8h_html"><div class="ttname"><a href="Hashing_8h.html">Hashing.h</a></div></div>
<div class="ttc" id="classllvm_1_1IRBuilder_html_a8f55dd4237be6778517ddd752ca8b76a"><div class="ttname"><a href="classllvm_1_1IRBuilder.html#a8f55dd4237be6778517ddd752ca8b76a">llvm::IRBuilder::CreateOr</a></div><div class="ttdeci">Value * CreateOr(Value *LHS, Value *RHS, const Twine &amp;Name=&quot;&quot;)</div><div class="ttdef"><b>Definition:</b> <a href="IRBuilder_8h_source.html#l00805">IRBuilder.h:805</a></div></div>
<div class="ttc" id="classllvm_1_1SmallPtrSet_html_a2ced6343b8ad006a757059554bbf9f37"><div class="ttname"><a href="classllvm_1_1SmallPtrSet.html#a2ced6343b8ad006a757059554bbf9f37">llvm::SmallPtrSet::count</a></div><div class="ttdeci">bool count(PtrType Ptr) const </div><div class="ttdoc">count - Return true if the specified pointer is in the set. </div><div class="ttdef"><b>Definition:</b> <a href="SmallPtrSet_8h_source.html#l00264">SmallPtrSet.h:264</a></div></div>
<div class="ttc" id="classllvm_1_1LoopBase_html_a63f099d3bf7cf97eb3ae2d630e3d1afc"><div class="ttname"><a href="classllvm_1_1LoopBase.html#a63f099d3bf7cf97eb3ae2d630e3d1afc">llvm::LoopBase::addBasicBlockToLoop</a></div><div class="ttdeci">void addBasicBlockToLoop(BlockT *NewBB, LoopInfoBase&lt; BlockT, LoopT &gt; &amp;LI)</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfoImpl_8h_source.html#l00185">LoopInfoImpl.h:185</a></div></div>
<div class="ttc" id="classllvm_1_1SCEVAddRecExpr_html"><div class="ttname"><a href="classllvm_1_1SCEVAddRecExpr.html">llvm::SCEVAddRecExpr</a></div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolutionExpressions_8h_source.html#l00283">ScalarEvolutionExpressions.h:283</a></div></div>
<div class="ttc" id="classllvm_1_1SmallVectorBase_html_a8a8df4d85555c7954a95f86080cd3b64"><div class="ttname"><a href="classllvm_1_1SmallVectorBase.html#a8a8df4d85555c7954a95f86080cd3b64">llvm::SmallVectorBase::empty</a></div><div class="ttdeci">bool LLVM_ATTRIBUTE_UNUSED_RESULT empty() const </div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00056">SmallVector.h:56</a></div></div>
<div class="ttc" id="classllvm_1_1Instruction_html_ac26154a24f393f523c87cc5f8239f36c"><div class="ttname"><a href="classllvm_1_1Instruction.html#ac26154a24f393f523c87cc5f8239f36c">llvm::Instruction::BinaryOps</a></div><div class="ttdeci">BinaryOps</div><div class="ttdef"><b>Definition:</b> <a href="Instruction_8h_source.html#l00387">Instruction.h:387</a></div></div>
<div class="ttc" id="classllvm_1_1Instruction_html_aa113b8a9ef3de9c2f075a046ad658717"><div class="ttname"><a href="classllvm_1_1Instruction.html#aa113b8a9ef3de9c2f075a046ad658717">llvm::Instruction::isAssociative</a></div><div class="ttdeci">bool isAssociative() const </div><div class="ttdef"><b>Definition:</b> <a href="Instruction_8cpp_source.html#l00482">Instruction.cpp:482</a></div></div>
<div class="ttc" id="classllvm_1_1VectorType_html_a071e25c5c6eae5299b1cdc3350c6d55c"><div class="ttname"><a href="classllvm_1_1VectorType.html#a071e25c5c6eae5299b1cdc3350c6d55c">llvm::VectorType::isValidElementType</a></div><div class="ttdeci">static bool isValidElementType(Type *ElemTy)</div><div class="ttdef"><b>Definition:</b> <a href="Type_8cpp_source.html#l00721">Type.cpp:721</a></div></div>
<div class="ttc" id="classllvm_1_1FCmpInst_html"><div class="ttname"><a href="classllvm_1_1FCmpInst.html">llvm::FCmpInst</a></div><div class="ttdoc">Represents a floating point comparison operator. </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l01055">Instructions.h:1055</a></div></div>
<div class="ttc" id="classllvm_1_1BranchInst_html_a74e70ecbb79defbbfa6f6c87f76155bf"><div class="ttname"><a href="classllvm_1_1BranchInst.html#a74e70ecbb79defbbfa6f6c87f76155bf">llvm::BranchInst::getSuccessor</a></div><div class="ttdeci">BasicBlock * getSuccessor(unsigned i) const </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02406">Instructions.h:2406</a></div></div>
<div class="ttc" id="namespacellvm_1_1PatternMatch_html_aa437a212f5c7987d6b0e6cf722e25a2e"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#aa437a212f5c7987d6b0e6cf722e25a2e">llvm::PatternMatch::m_OrdFMin</a></div><div class="ttdeci">MaxMin_match&lt; FCmpInst, LHS, RHS, ofmin_pred_ty &gt; m_OrdFMin(const LHS &amp;L, const RHS &amp;R)</div><div class="ttdoc">Match an &amp;#39;ordered&amp;#39; floating point minimum function. Floating point has one special value &amp;#39;NaN&amp;#39;...</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l00988">PatternMatch.h:988</a></div></div>
<div class="ttc" id="namespacellvm_1_1PatternMatch_html_af16a6c9336ca2a17389ea709b45fe7f5"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#af16a6c9336ca2a17389ea709b45fe7f5">llvm::PatternMatch::m_SMin</a></div><div class="ttdeci">MaxMin_match&lt; ICmpInst, LHS, RHS, smin_pred_ty &gt; m_SMin(const LHS &amp;L, const RHS &amp;R)</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l00946">PatternMatch.h:946</a></div></div>
<div class="ttc" id="SmallPtrSet_8h_html"><div class="ttname"><a href="SmallPtrSet_8h.html">SmallPtrSet.h</a></div></div>
<div class="ttc" id="namespacellvm_html_af6d6a791770bad2303c4399986979e3eae411369b2f0d8f484fec62c3291b1b51"><div class="ttname"><a href="namespacellvm.html#af6d6a791770bad2303c4399986979e3eae411369b2f0d8f484fec62c3291b1b51">llvm::Call</a></div><div class="ttdef"><b>Definition:</b> <a href="CallingConvLower_8h_source.html#l00149">CallingConvLower.h:149</a></div></div>
<div class="ttc" id="classllvm_1_1Type_html_a40113570b0c52a18c34cabed8359e2c8"><div class="ttname"><a href="classllvm_1_1Type.html#a40113570b0c52a18c34cabed8359e2c8">llvm::Type::isFloatingPointTy</a></div><div class="ttdeci">bool isFloatingPointTy() const </div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00162">Type.h:162</a></div></div>
<div class="ttc" id="classllvm_1_1EquivalenceClasses_html_a7a49b8e8780b3ebfd805c613fb8626e2"><div class="ttname"><a href="classllvm_1_1EquivalenceClasses.html#a7a49b8e8780b3ebfd805c613fb8626e2">llvm::EquivalenceClasses::iterator</a></div><div class="ttdeci">std::set&lt; ECValue &gt;::const_iterator iterator</div><div class="ttdoc">iterator* - Provides a way to iterate over all values in the set. </div><div class="ttdef"><b>Definition:</b> <a href="EquivalenceClasses_8h_source.html#l00139">EquivalenceClasses.h:139</a></div></div>
<div class="ttc" id="namespacellvm_1_1Intrinsic_html_a842176a2c8c60a94bc788454b0828ea2"><div class="ttname"><a href="namespacellvm_1_1Intrinsic.html#a842176a2c8c60a94bc788454b0828ea2">llvm::Intrinsic::getDeclaration</a></div><div class="ttdeci">Function * getDeclaration(Module *M, ID id, ArrayRef&lt; Type * &gt; Tys=None)</div><div class="ttdef"><b>Definition:</b> <a href="Function_8cpp_source.html#l00683">Function.cpp:683</a></div></div>
<div class="ttc" id="LoopVectorize_8cpp_html_a040f109a39db8077a2dd926dd8fb4206"><div class="ttname"><a href="LoopVectorize_8cpp.html#a040f109a39db8077a2dd926dd8fb4206">checkBinaryFloatSignature</a></div><div class="ttdeci">static Intrinsic::ID checkBinaryFloatSignature(const CallInst &amp;I, Intrinsic::ID ValidIntrinsicID)</div><div class="ttdef"><b>Definition:</b> <a href="LoopVectorize_8cpp_source.html#l01873">LoopVectorize.cpp:1873</a></div></div>
<div class="ttc" id="classllvm_1_1SmallSet_html_a8d8348060ccdeeba13fb8bc651dfbf82"><div class="ttname"><a href="classllvm_1_1SmallSet.html#a8d8348060ccdeeba13fb8bc651dfbf82">llvm::SmallSet::insert</a></div><div class="ttdeci">bool insert(const T &amp;V)</div><div class="ttdef"><b>Definition:</b> <a href="SmallSet_8h_source.html#l00059">SmallSet.h:59</a></div></div>
<div class="ttc" id="classllvm_1_1StoreInst_html"><div class="ttname"><a href="classllvm_1_1StoreInst.html">llvm::StoreInst</a></div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00255">Instructions.h:255</a></div></div>
<div class="ttc" id="classllvm_1_1Value_html_a3ab5fc45117b450e8bb04e564cb6e5f2"><div class="ttname"><a href="classllvm_1_1Value.html#a3ab5fc45117b450e8bb04e564cb6e5f2">llvm::Value::replaceAllUsesWith</a></div><div class="ttdeci">void replaceAllUsesWith(Value *V)</div><div class="ttdef"><b>Definition:</b> <a href="Value_8cpp_source.html#l00303">Value.cpp:303</a></div></div>
<div class="ttc" id="namespacellvm_1_1LibFunc_html_abf8f6830387f338fed0bce2e65108c6fa881ba9a89b3bc1f75154c0b3e4abea7a"><div class="ttname"><a href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fa881ba9a89b3bc1f75154c0b3e4abea7a">llvm::LibFunc::log2</a></div><div class="ttdoc">double log2(double x); </div><div class="ttdef"><b>Definition:</b> <a href="TargetLibraryInfo_8h_source.html#l00360">TargetLibraryInfo.h:360</a></div></div>
<div class="ttc" id="classllvm_1_1VectorType_html_a580510fa692dccfb26d0e967d8f164e7"><div class="ttname"><a href="classllvm_1_1VectorType.html#a580510fa692dccfb26d0e967d8f164e7">llvm::VectorType::getNumElements</a></div><div class="ttdeci">unsigned getNumElements() const </div><div class="ttdoc">Return the number of elements in the Vector type. </div><div class="ttdef"><b>Definition:</b> <a href="DerivedTypes_8h_source.html#l00408">DerivedTypes.h:408</a></div></div>
<div class="ttc" id="classllvm_1_1TargetTransformInfo_html_af46433d0e36d3f80afc3a8c67b5c53ecaea788d98147161f25d5adc3ec6ce7e1f"><div class="ttname"><a href="classllvm_1_1TargetTransformInfo.html#af46433d0e36d3f80afc3a8c67b5c53ecaea788d98147161f25d5adc3ec6ce7e1f">llvm::TargetTransformInfo::SK_Reverse</a></div><div class="ttdoc">Reverse the order of the vector. </div><div class="ttdef"><b>Definition:</b> <a href="TargetTransformInfo_8h_source.html#l00312">TargetTransformInfo.h:312</a></div></div>
<div class="ttc" id="classllvm_1_1LoopBlocksDFS_html_ab38fc97602eaec1838f2b86624001ae1"><div class="ttname"><a href="classllvm_1_1LoopBlocksDFS.html#ab38fc97602eaec1838f2b86624001ae1">llvm::LoopBlocksDFS::perform</a></div><div class="ttdeci">void perform(LoopInfo *LI)</div><div class="ttdoc">Traverse the loop blocks and store the DFS result. </div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8cpp_source.html#l00722">LoopInfo.cpp:722</a></div></div>
<div class="ttc" id="classllvm_1_1DominatorTree_html"><div class="ttname"><a href="classllvm_1_1DominatorTree.html">llvm::DominatorTree</a></div><div class="ttdef"><b>Definition:</b> <a href="Dominators_8h_source.html#l00740">Dominators.h:740</a></div></div>
<div class="ttc" id="classllvm_1_1SequentialType_html_a39f2c3a62f293faf11ac28b15bc53359"><div class="ttname"><a href="classllvm_1_1SequentialType.html#a39f2c3a62f293faf11ac28b15bc53359">llvm::SequentialType::getElementType</a></div><div class="ttdeci">Type * getElementType() const </div><div class="ttdef"><b>Definition:</b> <a href="DerivedTypes_8h_source.html#l00319">DerivedTypes.h:319</a></div></div>
<div class="ttc" id="classllvm_1_1PointerType_html"><div class="ttname"><a href="classllvm_1_1PointerType.html">llvm::PointerType</a></div><div class="ttdef"><b>Definition:</b> <a href="DerivedTypes_8h_source.html#l00425">DerivedTypes.h:425</a></div></div>
<div class="ttc" id="classllvm_1_1PHINode_html_aa45f6c0433576e3858a6209a43750ad4"><div class="ttname"><a href="classllvm_1_1PHINode.html#aa45f6c0433576e3858a6209a43750ad4">llvm::PHINode::getNumIncomingValues</a></div><div class="ttdeci">unsigned getNumIncomingValues() const </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02055">Instructions.h:2055</a></div></div>
<div class="ttc" id="namespacellvm_1_1LibFunc_html_abf8f6830387f338fed0bce2e65108c6fa4bd06237ec73d9b75b468fb61e75431f"><div class="ttname"><a href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fa4bd06237ec73d9b75b468fb61e75431f">llvm::LibFunc::log2f</a></div><div class="ttdoc">float log2f(float x); </div><div class="ttdef"><b>Definition:</b> <a href="TargetLibraryInfo_8h_source.html#l00362">TargetLibraryInfo.h:362</a></div></div>
<div class="ttc" id="LoopVectorize_8cpp_html_ad0837b25464367550b8d67a5607c0149"><div class="ttname"><a href="LoopVectorize_8cpp.html#ad0837b25464367550b8d67a5607c0149">canIfConvertPHINodes</a></div><div class="ttdeci">static bool canIfConvertPHINodes(BasicBlock *BB)</div><div class="ttdoc">Check whether it is safe to if-convert this phi node. </div><div class="ttdef"><b>Definition:</b> <a href="LoopVectorize_8cpp_source.html#l02788">LoopVectorize.cpp:2788</a></div></div>
<div class="ttc" id="classllvm_1_1SCEV_html_af43000d4dcb7d6d63cb6e36933ed3f6fae022582ed4b56bdb108b4488809e11e6"><div class="ttname"><a href="classllvm_1_1SCEV.html#af43000d4dcb7d6d63cb6e36933ed3f6fae022582ed4b56bdb108b4488809e11e6">llvm::SCEV::NoWrapMask</a></div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8h_source.html#l00098">ScalarEvolution.h:98</a></div></div>
<div class="ttc" id="LoopVectorize_8cpp_html_a07903be1ff7f0dbad4df2f2f19b8703d"><div class="ttname"><a href="LoopVectorize_8cpp.html#a07903be1ff7f0dbad4df2f2f19b8703d">createMinMaxOp</a></div><div class="ttdeci">Value * createMinMaxOp(IRBuilder&lt;&gt; &amp;Builder, LoopVectorizationLegality::MinMaxReductionKind RK, Value *Left, Value *Right)</div><div class="ttdef"><b>Definition:</b> <a href="LoopVectorize_8cpp_source.html#l02031">LoopVectorize.cpp:2031</a></div></div>
<div class="ttc" id="classllvm_1_1GetElementPtrInst_html"><div class="ttname"><a href="classllvm_1_1GetElementPtrInst.html">llvm::GetElementPtrInst</a></div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00709">Instructions.h:709</a></div></div>
<div class="ttc" id="classllvm_1_1ScalarEvolution_html_aaa9b9055fd9c69fe14eb20f0d18d53d5"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html#aaa9b9055fd9c69fe14eb20f0d18d53d5">llvm::ScalarEvolution::getCouldNotCompute</a></div><div class="ttdeci">const SCEV * getCouldNotCompute()</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8cpp_source.html#l02704">ScalarEvolution.cpp:2704</a></div></div>
<div class="ttc" id="namespacellvm_1_1A64DB_html_a6fce8157775f3ec93f326b52b0f1e0f5a4916e736d6b7cc68359b39d5eb50f6db"><div class="ttname"><a href="namespacellvm_1_1A64DB.html#a6fce8157775f3ec93f326b52b0f1e0f5a4916e736d6b7cc68359b39d5eb50f6db">llvm::A64DB::ST</a></div><div class="ttdef"><b>Definition:</b> <a href="AArch64BaseInfo_8h_source.html#l00178">AArch64BaseInfo.h:178</a></div></div>
<div class="ttc" id="namespacellvm_1_1Intrinsic_html_a73349916f7e54a6b988a3646c7a02e90aa5e3272cd3a1252dab94b777ec25e949"><div class="ttname"><a href="namespacellvm_1_1Intrinsic.html#a73349916f7e54a6b988a3646c7a02e90aa5e3272cd3a1252dab94b777ec25e949">llvm::Intrinsic::floor</a></div><div class="ttdef"><b>Definition:</b> <a href="Intrinsics_8h_source.html#l00390">Intrinsics.h:390</a></div></div>
<div class="ttc" id="README__ALTIVEC_8txt_html_a9aacd9146afe44bf656cd664e2a88c8c"><div class="ttname"><a href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a></div><div class="ttdeci">(vector float) vec_cmpeq(*A,*B) C</div><div class="ttdef"><b>Definition:</b> <a href="README__ALTIVEC_8txt_source.html#l00091">README_ALTIVEC.txt:91</a></div></div>
<div class="ttc" id="CommandLine_8h_html"><div class="ttname"><a href="CommandLine_8h.html">CommandLine.h</a></div></div>
<div class="ttc" id="namespacellvm_1_1cl_html_a10a041239ae1870cfcc064bfaa79fb65"><div class="ttname"><a href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">llvm::cl::init</a></div><div class="ttdeci">initializer&lt; Ty &gt; init(const Ty &amp;Val)</div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l00314">CommandLine.h:314</a></div></div>
<div class="ttc" id="LoopVectorize_8cpp_html_abdb1bd0a614004fa8015e9c449670b42"><div class="ttname"><a href="LoopVectorize_8cpp.html#abdb1bd0a614004fa8015e9c449670b42">checkUnaryFloatSignature</a></div><div class="ttdeci">static Intrinsic::ID checkUnaryFloatSignature(const CallInst &amp;I, Intrinsic::ID ValidIntrinsicID)</div><div class="ttdef"><b>Definition:</b> <a href="LoopVectorize_8cpp_source.html#l01862">LoopVectorize.cpp:1862</a></div></div>
<div class="ttc" id="namespacellvm_1_1LibFunc_html_abf8f6830387f338fed0bce2e65108c6fa20f8ff9bd73cb5ab622f77719667f70e"><div class="ttname"><a href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fa20f8ff9bd73cb5ab622f77719667f70e">llvm::LibFunc::floorf</a></div><div class="ttdoc">float floorf(float x); </div><div class="ttdef"><b>Definition:</b> <a href="TargetLibraryInfo_8h_source.html#l00251">TargetLibraryInfo.h:251</a></div></div>
<div class="ttc" id="classllvm_1_1StoreInst_html_a3084f1dd69d67e1965fd1fe721a69f2e"><div class="ttname"><a href="classllvm_1_1StoreInst.html#a3084f1dd69d67e1965fd1fe721a69f2e">llvm::StoreInst::getAlignment</a></div><div class="ttdeci">unsigned getAlignment() const </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00301">Instructions.h:301</a></div></div>
<div class="ttc" id="classllvm_1_1SCEVAddRecExpr_html_a88f514461ddb0af0fc59ac4639f644bc"><div class="ttname"><a href="classllvm_1_1SCEVAddRecExpr.html#a88f514461ddb0af0fc59ac4639f644bc">llvm::SCEVAddRecExpr::isAffine</a></div><div class="ttdeci">bool isAffine() const </div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolutionExpressions_8h_source.html#l00309">ScalarEvolutionExpressions.h:309</a></div></div>
<div class="ttc" id="LoopPass_8h_html"><div class="ttname"><a href="LoopPass_8h.html">LoopPass.h</a></div></div>
<div class="ttc" id="namespacellvm_1_1PatternMatch_html_ae5a9f5c71425f38b8874296c380567ad"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#ae5a9f5c71425f38b8874296c380567ad">llvm::PatternMatch::m_UMax</a></div><div class="ttdeci">MaxMin_match&lt; ICmpInst, LHS, RHS, umax_pred_ty &gt; m_UMax(const LHS &amp;L, const RHS &amp;R)</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l00952">PatternMatch.h:952</a></div></div>
<div class="ttc" id="namespacellvm_1_1LibFunc_html_abf8f6830387f338fed0bce2e65108c6fabeff2268736aa278b16443193ca13ba5"><div class="ttname"><a href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fabeff2268736aa278b16443193ca13ba5">llvm::LibFunc::ceilf</a></div><div class="ttdoc">float ceilf(float x); </div><div class="ttdef"><b>Definition:</b> <a href="TargetLibraryInfo_8h_source.html#l00159">TargetLibraryInfo.h:159</a></div></div>
<div class="ttc" id="namespacellvm_1_1Intrinsic_html_a73349916f7e54a6b988a3646c7a02e90aa3d4911fd70a787382c691646d119ff4"><div class="ttname"><a href="namespacellvm_1_1Intrinsic.html#a73349916f7e54a6b988a3646c7a02e90aa3d4911fd70a787382c691646d119ff4">llvm::Intrinsic::exp</a></div><div class="ttdef"><b>Definition:</b> <a href="Intrinsics_8h_source.html#l00383">Intrinsics.h:383</a></div></div>
<div class="ttc" id="classllvm_1_1LoopBase_html_a1bc74c76b876ad387293ecde0f21ed45"><div class="ttname"><a href="classllvm_1_1LoopBase.html#a1bc74c76b876ad387293ecde0f21ed45">llvm::LoopBase::getLoopPreheader</a></div><div class="ttdeci">BlockT * getLoopPreheader() const </div><div class="ttdef"><b>Definition:</b> <a href="LoopInfoImpl_8h_source.html#l00106">LoopInfoImpl.h:106</a></div></div>
<div class="ttc" id="classllvm_1_1SmallVectorTemplateCommon_html_acd9e771a3296c6b24146955754620557"><div class="ttname"><a href="classllvm_1_1SmallVectorTemplateCommon.html#acd9e771a3296c6b24146955754620557">llvm::SmallVectorTemplateCommon&lt; T &gt;::back</a></div><div class="ttdeci">reference back()</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00157">SmallVector.h:157</a></div></div>
<div class="ttc" id="classllvm_1_1BasicBlock_html"><div class="ttname"><a href="classllvm_1_1BasicBlock.html">llvm::BasicBlock</a></div><div class="ttdoc">LLVM Basic Block Representation. </div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00072">BasicBlock.h:72</a></div></div>
<div class="ttc" id="namespacellvm_1_1LibFunc_html_abf8f6830387f338fed0bce2e65108c6fa0a95274b8e56005845287ff568140a9c"><div class="ttname"><a href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fa0a95274b8e56005845287ff568140a9c">llvm::LibFunc::floorl</a></div><div class="ttdoc">long double floorl(long double x); </div><div class="ttdef"><b>Definition:</b> <a href="TargetLibraryInfo_8h_source.html#l00253">TargetLibraryInfo.h:253</a></div></div>
<div class="ttc" id="classllvm_1_1PointerIntPair_html"><div class="ttname"><a href="classllvm_1_1PointerIntPair.html">llvm::PointerIntPair</a></div><div class="ttdef"><b>Definition:</b> <a href="PointerIntPair_8h_source.html#l00042">PointerIntPair.h:42</a></div></div>
<div class="ttc" id="classllvm_1_1Type_html"><div class="ttname"><a href="classllvm_1_1Type.html">llvm::Type</a></div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00044">Type.h:44</a></div></div>
<div class="ttc" id="classllvm_1_1LLVMContext_html"><div class="ttname"><a href="classllvm_1_1LLVMContext.html">llvm::LLVMContext</a></div><div class="ttdef"><b>Definition:</b> <a href="LLVMContext_8h_source.html#l00037">LLVMContext.h:37</a></div></div>
<div class="ttc" id="classllvm_1_1SCEV_html_a9a16f1241255a605fc8debc1e26eaa4c"><div class="ttname"><a href="classllvm_1_1SCEV.html#a9a16f1241255a605fc8debc1e26eaa4c">llvm::SCEV::getType</a></div><div class="ttdeci">Type * getType() const </div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8cpp_source.html#l00249">ScalarEvolution.cpp:249</a></div></div>
<div class="ttc" id="LoopVectorize_8cpp_html_ac0a7f10a4ddc8820c772795c63cb5c83"><div class="ttname"><a href="LoopVectorize_8cpp.html#ac0a7f10a4ddc8820c772795c63cb5c83">isFunctionScopeIdentifiedObject</a></div><div class="ttdeci">static bool isFunctionScopeIdentifiedObject(Value *Ptr)</div><div class="ttdef"><b>Definition:</b> <a href="LoopVectorize_8cpp_source.html#l03346">LoopVectorize.cpp:3346</a></div></div>
<div class="ttc" id="classllvm_1_1BranchInst_html"><div class="ttname"><a href="classllvm_1_1BranchInst.html">llvm::BranchInst</a></div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02350">Instructions.h:2350</a></div></div>
<div class="ttc" id="classllvm_1_1Type_html_a6f725580f7834e2ca90762965866dad4"><div class="ttname"><a href="classllvm_1_1Type.html#a6f725580f7834e2ca90762965866dad4">llvm::Type::isVectorTy</a></div><div class="ttdeci">bool isVectorTy() const </div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00229">Type.h:229</a></div></div>
<div class="ttc" id="classllvm_1_1TrackingVH_html"><div class="ttname"><a href="classllvm_1_1TrackingVH.html">llvm::TrackingVH</a></div><div class="ttdef"><b>Definition:</b> <a href="ValueHandle_8h_source.html#l00279">ValueHandle.h:279</a></div></div>
<div class="ttc" id="classllvm_1_1Constant_html"><div class="ttname"><a href="classllvm_1_1Constant.html">llvm::Constant</a></div><div class="ttdoc">LLVM Constant Representation. </div><div class="ttdef"><b>Definition:</b> <a href="Constant_8h_source.html#l00041">Constant.h:41</a></div></div>
<div class="ttc" id="ScalarEvolutionExpressions_8h_html"><div class="ttname"><a href="ScalarEvolutionExpressions_8h.html">ScalarEvolutionExpressions.h</a></div></div>
<div class="ttc" id="classllvm_1_1SelectInst_html_ad285a69e32ddeee367fed93b5f392801"><div class="ttname"><a href="classllvm_1_1SelectInst.html#ad285a69e32ddeee367fed93b5f392801">llvm::SelectInst::getCondition</a></div><div class="ttdeci">const Value * getCondition() const </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l01466">Instructions.h:1466</a></div></div>
<div class="ttc" id="namespacellvm_html_a2b33f2166f38124ec3081c2fd59672f7"><div class="ttname"><a href="namespacellvm.html#a2b33f2166f38124ec3081c2fd59672f7">llvm::hash_combine</a></div><div class="ttdeci">hash_code hash_combine(const T1 &amp;arg1, const T2 &amp;arg2, const T3 &amp;arg3, const T4 &amp;arg4, const T5 &amp;arg5, const T6 &amp;arg6)</div><div class="ttdef"><b>Definition:</b> <a href="Hashing_8h_source.html#l00674">Hashing.h:674</a></div></div>
<div class="ttc" id="classllvm_1_1APInt_html_a7189a37206963029447c31d57771b997"><div class="ttname"><a href="classllvm_1_1APInt.html#a7189a37206963029447c31d57771b997">llvm::APInt::getSExtValue</a></div><div class="ttdeci">int64_t getSExtValue() const </div><div class="ttdoc">Get sign extended value. </div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l01318">APInt.h:1318</a></div></div>
<div class="ttc" id="classllvm_1_1SmallSet_html"><div class="ttname"><a href="classllvm_1_1SmallSet.html">llvm::SmallSet</a></div><div class="ttdef"><b>Definition:</b> <a href="SmallSet_8h_source.html#l00031">SmallSet.h:31</a></div></div>
<div class="ttc" id="Constants_8h_html"><div class="ttname"><a href="Constants_8h.html">Constants.h</a></div></div>
<div class="ttc" id="namespacellvm_1_1GC_html_a5f606a2b04c809f789a574660cd25213a960eba6a93af558b44d3d14e8393d324"><div class="ttname"><a href="namespacellvm_1_1GC.html#a5f606a2b04c809f789a574660cd25213a960eba6a93af558b44d3d14e8393d324">llvm::GC::Loop</a></div><div class="ttdoc">Instr is a loop (backwards branch). </div><div class="ttdef"><b>Definition:</b> <a href="GCMetadata_8h_source.html#l00051">GCMetadata.h:51</a></div></div>
<div class="ttc" id="namespacellvm_1_1APIntOps_html_a22f056804d2b9882f74adc905872bc39"><div class="ttname"><a href="namespacellvm_1_1APIntOps.html#a22f056804d2b9882f74adc905872bc39">llvm::APIntOps::Or</a></div><div class="ttdeci">APInt Or(const APInt &amp;LHS, const APInt &amp;RHS)</div><div class="ttdoc">Bitwise OR function for APInt. </div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l01845">APInt.h:1845</a></div></div>
<div class="ttc" id="namespacellvm_1_1LibFunc_html_abf8f6830387f338fed0bce2e65108c6facbe67d9e2920bce533f6874be1fe34c5"><div class="ttname"><a href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6facbe67d9e2920bce533f6874be1fe34c5">llvm::LibFunc::cosf</a></div><div class="ttdoc">float cosf(float x); </div><div class="ttdef"><b>Definition:</b> <a href="TargetLibraryInfo_8h_source.html#l00179">TargetLibraryInfo.h:179</a></div></div>
<div class="ttc" id="namespacellvm_1_1LibFunc_html_abf8f6830387f338fed0bce2e65108c6fa3c97ccd58dc11bb1fcb8f3864db3c5ee"><div class="ttname"><a href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fa3c97ccd58dc11bb1fcb8f3864db3c5ee">llvm::LibFunc::logf</a></div><div class="ttdoc">float logf(float x); </div><div class="ttdef"><b>Definition:</b> <a href="TargetLibraryInfo_8h_source.html#l00372">TargetLibraryInfo.h:372</a></div></div>
<div class="ttc" id="namespacellvm_html_a3e3d3c6d4e33a4f5ca579ee7939f0349"><div class="ttname"><a href="namespacellvm.html#a3e3d3c6d4e33a4f5ca579ee7939f0349">llvm::LCSSAID</a></div><div class="ttdeci">char &amp; LCSSAID</div><div class="ttdef"><b>Definition:</b> <a href="LCSSA_8cpp_source.html#l00094">LCSSA.cpp:94</a></div></div>
<div class="ttc" id="structllvm_1_1cl_1_1desc_html"><div class="ttname"><a href="structllvm_1_1cl_1_1desc.html">llvm::cl::desc</a></div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l00286">CommandLine.h:286</a></div></div>
<div class="ttc" id="namespacellvm_1_1APIntOps_html_afc7c4d88d09cba0c5e920f8a3a3ace55"><div class="ttname"><a href="namespacellvm_1_1APIntOps.html#afc7c4d88d09cba0c5e920f8a3a3ace55">llvm::APIntOps::Xor</a></div><div class="ttdeci">APInt Xor(const APInt &amp;LHS, const APInt &amp;RHS)</div><div class="ttdoc">Bitwise XOR function for APInt. </div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l01850">APInt.h:1850</a></div></div>
<div class="ttc" id="LoopVectorize_8cpp_html_a629b5a7c606c6557464a43689baadd7c"><div class="ttname"><a href="LoopVectorize_8cpp.html#a629b5a7c606c6557464a43689baadd7c">isLikelyComplexAddressComputation</a></div><div class="ttdeci">static bool isLikelyComplexAddressComputation(Value *Ptr, LoopVectorizationLegality *Legal, ScalarEvolution *SE, const Loop *TheLoop)</div><div class="ttdoc">Check whether the address computation for a non-consecutive memory access looks like an unlikely cand...</div><div class="ttdef"><b>Definition:</b> <a href="LoopVectorize_8cpp_source.html#l04803">LoopVectorize.cpp:4803</a></div></div>
<div class="ttc" id="namespacellvm_html_a7e108932dc3da5294aed99a353aac9c4"><div class="ttname"><a href="namespacellvm.html#a7e108932dc3da5294aed99a353aac9c4">llvm::pred_begin</a></div><div class="ttdeci">Interval::pred_iterator pred_begin(Interval *I)</div><div class="ttdef"><b>Definition:</b> <a href="Interval_8h_source.html#l00117">Interval.h:117</a></div></div>
<div class="ttc" id="namespacellvm_1_1LibFunc_html_abf8f6830387f338fed0bce2e65108c6fa617cf64238cf2b7352a32bcc1babedf0"><div class="ttname"><a href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fa617cf64238cf2b7352a32bcc1babedf0">llvm::LibFunc::roundf</a></div><div class="ttdoc">float roundf(float x); </div><div class="ttdef"><b>Definition:</b> <a href="TargetLibraryInfo_8h_source.html#l00482">TargetLibraryInfo.h:482</a></div></div>
<div class="ttc" id="namespacellvm_1_1LibFunc_html_abf8f6830387f338fed0bce2e65108c6fa1a6ee879e869cf6071a4db1631239795"><div class="ttname"><a href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fa1a6ee879e869cf6071a4db1631239795">llvm::LibFunc::rintf</a></div><div class="ttdoc">float rintf(float x); </div><div class="ttdef"><b>Definition:</b> <a href="TargetLibraryInfo_8h_source.html#l00474">TargetLibraryInfo.h:474</a></div></div>
<div class="ttc" id="classllvm_1_1EquivalenceClasses_html"><div class="ttname"><a href="classllvm_1_1EquivalenceClasses.html">llvm::EquivalenceClasses</a></div><div class="ttdef"><b>Definition:</b> <a href="EquivalenceClasses_8h_source.html#l00057">EquivalenceClasses.h:57</a></div></div>
<div class="ttc" id="classllvm_1_1Instruction_html_aab8e16a35183ce39aad394714087bcff"><div class="ttname"><a href="classllvm_1_1Instruction.html#aab8e16a35183ce39aad394714087bcff">llvm::Instruction::getDebugLoc</a></div><div class="ttdeci">const DebugLoc &amp; getDebugLoc() const </div><div class="ttdoc">getDebugLoc - Return the debug location for this node as a DebugLoc. </div><div class="ttdef"><b>Definition:</b> <a href="Instruction_8h_source.html#l00178">Instruction.h:178</a></div></div>
<div class="ttc" id="namespacellvm_1_1Intrinsic_html_a73349916f7e54a6b988a3646c7a02e90a9435bd14da4637e66589624ea43fa758"><div class="ttname"><a href="namespacellvm_1_1Intrinsic.html#a73349916f7e54a6b988a3646c7a02e90a9435bd14da4637e66589624ea43fa758">llvm::Intrinsic::log10</a></div><div class="ttdef"><b>Definition:</b> <a href="Intrinsics_8h_source.html#l01257">Intrinsics.h:1257</a></div></div>
<div class="ttc" id="LoopVectorize_8cpp_html_aa197dfdac853372e44c5dc91ffab03ea"><div class="ttname"><a href="LoopVectorize_8cpp.html#aa197dfdac853372e44c5dc91ffab03ea">MaxVectorWidth</a></div><div class="ttdeci">static const unsigned MaxVectorWidth</div><div class="ttdoc">Maximum simd width. </div><div class="ttdef"><b>Definition:</b> <a href="LoopVectorize_8cpp_source.html#l00125">LoopVectorize.cpp:125</a></div></div>
<div class="ttc" id="classllvm_1_1Loop_html_aeb9e1c66dbe5a07f65e833f86008ae14"><div class="ttname"><a href="classllvm_1_1Loop.html#aeb9e1c66dbe5a07f65e833f86008ae14">llvm::Loop::getLoopID</a></div><div class="ttdeci">MDNode * getLoopID() const </div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8cpp_source.html#l00236">LoopInfo.cpp:236</a></div></div>
<div class="ttc" id="classllvm_1_1AnalysisUsage_html"><div class="ttname"><a href="classllvm_1_1AnalysisUsage.html">llvm::AnalysisUsage</a></div><div class="ttdef"><b>Definition:</b> <a href="PassAnalysisSupport_8h_source.html#l00037">PassAnalysisSupport.h:37</a></div></div>
<div class="ttc" id="classllvm_1_1PHINode_html_afb5e83bf5123ff7c51058eb0ebebcdc6"><div class="ttname"><a href="classllvm_1_1PHINode.html#afb5e83bf5123ff7c51058eb0ebebcdc6">llvm::PHINode::Create</a></div><div class="ttdeci">static PHINode * Create(Type *Ty, unsigned NumReservedValues, const Twine &amp;NameStr=&quot;&quot;, Instruction *InsertBefore=0)</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02013">Instructions.h:2013</a></div></div>
<div class="ttc" id="classllvm_1_1User_html_af41f58e730804d10b91fcff39b035f74"><div class="ttname"><a href="classllvm_1_1User.html#af41f58e730804d10b91fcff39b035f74">llvm::User::op_end</a></div><div class="ttdeci">op_iterator op_end()</div><div class="ttdef"><b>Definition:</b> <a href="User_8h_source.html#l00118">User.h:118</a></div></div>
<div class="ttc" id="namespacellvm_html_a36798313569555c6f79b4ac8cc0bf63d"><div class="ttname"><a href="namespacellvm.html#a36798313569555c6f79b4ac8cc0bf63d">llvm::verifyFunction</a></div><div class="ttdeci">bool verifyFunction(const Function &amp;F, VerifierFailureAction action=AbortProcessAction)</div><div class="ttdef"><b>Definition:</b> <a href="Verifier_8cpp_source.html#l02417">Verifier.cpp:2417</a></div></div>
<div class="ttc" id="classllvm_1_1PHINode_html_a4c25b6c00c4867281779c81ab64d2081"><div class="ttname"><a href="classllvm_1_1PHINode.html#a4c25b6c00c4867281779c81ab64d2081">llvm::PHINode::getIncomingBlock</a></div><div class="ttdeci">BasicBlock * getIncomingBlock(unsigned i) const </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02074">Instructions.h:2074</a></div></div>
<div class="ttc" id="classllvm_1_1LoopBase_html_ac4f141a355e5898255f2cbc57c5b54c3"><div class="ttname"><a href="classllvm_1_1LoopBase.html#ac4f141a355e5898255f2cbc57c5b54c3">llvm::LoopBase::getHeader</a></div><div class="ttdeci">BlockT * getHeader() const </div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l00095">LoopInfo.h:95</a></div></div>
<div class="ttc" id="namespacellvm_html_aa1704159f75e6eacd595962ea6d93ffe"><div class="ttname"><a href="namespacellvm.html#aa1704159f75e6eacd595962ea6d93ffe">llvm::next</a></div><div class="ttdeci">ItTy next(ItTy it, Dist n)</div><div class="ttdef"><b>Definition:</b> <a href="STLExtras_8h_source.html#l00154">STLExtras.h:154</a></div></div>
<div class="ttc" id="classllvm_1_1IntervalMap_html"><div class="ttname"><a href="classllvm_1_1IntervalMap.html">llvm::IntervalMap</a></div><div class="ttdef"><b>Definition:</b> <a href="IntervalMap_8h_source.html#l00931">IntervalMap.h:931</a></div></div>
<div class="ttc" id="namespacellvm_1_1LibFunc_html_abf8f6830387f338fed0bce2e65108c6faf017b93d43a8de0d5fe5680131ec14d6"><div class="ttname"><a href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6faf017b93d43a8de0d5fe5680131ec14d6">llvm::LibFunc::fabsf</a></div><div class="ttdoc">float fabsf(float x); </div><div class="ttdef"><b>Definition:</b> <a href="TargetLibraryInfo_8h_source.html#l00217">TargetLibraryInfo.h:217</a></div></div>
<div class="ttc" id="classllvm_1_1ScalarEvolution_html_aa888e3661c809163273aca85ded4d846"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html#aa888e3661c809163273aca85ded4d846">llvm::ScalarEvolution::getMinusSCEV</a></div><div class="ttdeci">const SCEV * getMinusSCEV(const SCEV *LHS, const SCEV *RHS, SCEV::NoWrapFlags Flags=SCEV::FlagAnyWrap)</div><div class="ttdoc">getMinusSCEV - Return LHS-RHS. Minus is represented in SCEV as A+B*-1. </div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8cpp_source.html#l02790">ScalarEvolution.cpp:2790</a></div></div>
<div class="ttc" id="classllvm_1_1CmpInst_html_a283f9a5d4d843d20c40bb4d3e364bb05"><div class="ttname"><a href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05">llvm::CmpInst::Predicate</a></div><div class="ttdeci">Predicate</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00651">InstrTypes.h:651</a></div></div>
<div class="ttc" id="classllvm_1_1APInt_html_ad081689e23a8f5dea78dedd623d6a8f8"><div class="ttname"><a href="classllvm_1_1APInt.html#ad081689e23a8f5dea78dedd623d6a8f8">llvm::APInt::getBitWidth</a></div><div class="ttdeci">unsigned getBitWidth() const </div><div class="ttdoc">Return the number of bits in the APInt. </div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l01252">APInt.h:1252</a></div></div>
<div class="ttc" id="classllvm_1_1SCEVExpander_html_a583d3ca95f83216d632a4d1ae0330dd0"><div class="ttname"><a href="classllvm_1_1SCEVExpander.html#a583d3ca95f83216d632a4d1ae0330dd0">llvm::SCEVExpander::expandCodeFor</a></div><div class="ttdeci">Value * expandCodeFor(const SCEV *SH, Type *Ty, Instruction *I)</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolutionExpander_8cpp_source.html#l01468">ScalarEvolutionExpander.cpp:1468</a></div></div>
<div class="ttc" id="namespacellvm_1_1LibFunc_html_abf8f6830387f338fed0bce2e65108c6fafa3f73bf84a733da4c5652bd21b378a9"><div class="ttname"><a href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fafa3f73bf84a733da4c5652bd21b378a9">llvm::LibFunc::log</a></div><div class="ttdoc">double log(double x); </div><div class="ttdef"><b>Definition:</b> <a href="TargetLibraryInfo_8h_source.html#l00346">TargetLibraryInfo.h:346</a></div></div>
<div class="ttc" id="namespacellvm_1_1LibFunc_html_abf8f6830387f338fed0bce2e65108c6fa3f6287461c2cfdc3ad7b2c9a67ee27fd"><div class="ttname"><a href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fa3f6287461c2cfdc3ad7b2c9a67ee27fd">llvm::LibFunc::pow</a></div><div class="ttdoc">double pow(double x, double y); </div><div class="ttdef"><b>Definition:</b> <a href="TargetLibraryInfo_8h_source.html#l00434">TargetLibraryInfo.h:434</a></div></div>
<div class="ttc" id="classllvm_1_1LoopBlocksDFS_html_a0c1bb1134650f3f69f5921d57fb50b78"><div class="ttname"><a href="classllvm_1_1LoopBlocksDFS.html#a0c1bb1134650f3f69f5921d57fb50b78">llvm::LoopBlocksDFS::RPOIterator</a></div><div class="ttdeci">std::vector&lt; BasicBlock * &gt;::const_reverse_iterator RPOIterator</div><div class="ttdef"><b>Definition:</b> <a href="LoopIterator_8h_source.html#l00042">LoopIterator.h:42</a></div></div>
<div class="ttc" id="classllvm_1_1User_html_a997ff6a1758bf732b9b263fc61011644"><div class="ttname"><a href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">llvm::User::getOperand</a></div><div class="ttdeci">Value * getOperand(unsigned i) const </div><div class="ttdef"><b>Definition:</b> <a href="User_8h_source.html#l00088">User.h:88</a></div></div>
<div class="ttc" id="namespacellvm_html_a5eeaf08e96168c2cac8960f87f0ef360"><div class="ttname"><a href="namespacellvm.html#a5eeaf08e96168c2cac8960f87f0ef360">llvm::pred_end</a></div><div class="ttdeci">Interval::pred_iterator pred_end(Interval *I)</div><div class="ttdef"><b>Definition:</b> <a href="Interval_8h_source.html#l00120">Interval.h:120</a></div></div>
<div class="ttc" id="classllvm_1_1LoadInst_html_ad47eefa1d094f60494b6b927061ca001"><div class="ttname"><a href="classllvm_1_1LoadInst.html#ad47eefa1d094f60494b6b927061ca001">llvm::LoadInst::getPointerOperand</a></div><div class="ttdeci">Value * getPointerOperand()</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00223">Instructions.h:223</a></div></div>
<div class="ttc" id="classllvm_1_1Instruction_html_a1c2048f254df730c4de1643ec791ddf9"><div class="ttname"><a href="classllvm_1_1Instruction.html#a1c2048f254df730c4de1643ec791ddf9">llvm::Instruction::isCommutative</a></div><div class="ttdeci">bool isCommutative() const </div><div class="ttdef"><b>Definition:</b> <a href="Instruction_8h_source.html#l00269">Instruction.h:269</a></div></div>
<div class="ttc" id="classllvm_1_1LoopBase_html_a92a38e2e3412bde7fd2b71db212b61aa"><div class="ttname"><a href="classllvm_1_1LoopBase.html#a92a38e2e3412bde7fd2b71db212b61aa">llvm::LoopBase::contains</a></div><div class="ttdeci">bool contains(const LoopT *L) const </div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l00104">LoopInfo.h:104</a></div></div>
<div class="ttc" id="namespacellvm_1_1LibFunc_html_abf8f6830387f338fed0bce2e65108c6fa067808435d99404a97c5be8b8790a639"><div class="ttname"><a href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fa067808435d99404a97c5be8b8790a639">llvm::LibFunc::nearbyintf</a></div><div class="ttdoc">float nearbyintf(float x); </div><div class="ttdef"><b>Definition:</b> <a href="TargetLibraryInfo_8h_source.html#l00412">TargetLibraryInfo.h:412</a></div></div>
<div class="ttc" id="classllvm_1_1IntegerType_html"><div class="ttname"><a href="classllvm_1_1IntegerType.html">llvm::IntegerType</a></div><div class="ttdoc">Integer representation type. </div><div class="ttdef"><b>Definition:</b> <a href="DerivedTypes_8h_source.html#l00037">DerivedTypes.h:37</a></div></div>
<div class="ttc" id="classllvm_1_1CmpInst_html_a8afd4995fae596b2c86eeed85b3d388b"><div class="ttname"><a href="classllvm_1_1CmpInst.html#a8afd4995fae596b2c86eeed85b3d388b">llvm::CmpInst::getPredicate</a></div><div class="ttdeci">Predicate getPredicate() const </div><div class="ttdoc">Return the predicate for this instruction. </div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00714">InstrTypes.h:714</a></div></div>
<div class="ttc" id="namespacellvm_1_1LibFunc_html_abf8f6830387f338fed0bce2e65108c6f"><div class="ttname"><a href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6f">llvm::LibFunc::Func</a></div><div class="ttdeci">Func</div><div class="ttdef"><b>Definition:</b> <a href="TargetLibraryInfo_8h_source.html#l00020">TargetLibraryInfo.h:20</a></div></div>
<div class="ttc" id="DenseMap_8h_html"><div class="ttname"><a href="DenseMap_8h.html">DenseMap.h</a></div></div>
<div class="ttc" id="PassSupport_8h_html_af0564bcdde2dd4400c670ca278c6035f"><div class="ttname"><a href="PassSupport_8h.html#af0564bcdde2dd4400c670ca278c6035f">INITIALIZE_AG_DEPENDENCY</a></div><div class="ttdeci">#define INITIALIZE_AG_DEPENDENCY(depName)</div><div class="ttdef"><b>Definition:</b> <a href="PassSupport_8h_source.html#l00169">PassSupport.h:169</a></div></div>
<div class="ttc" id="classllvm_1_1SmallVectorImpl_html_a669d55980a7d4b6307b94596deeb0b1f"><div class="ttname"><a href="classllvm_1_1SmallVectorImpl.html#a669d55980a7d4b6307b94596deeb0b1f">llvm::SmallVectorImpl::append</a></div><div class="ttdeci">void append(in_iter in_start, in_iter in_end)</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00445">SmallVector.h:445</a></div></div>
<div class="ttc" id="classllvm_1_1Type_html_a2eba483f5cc876e824aa6c085736086b"><div class="ttname"><a href="classllvm_1_1Type.html#a2eba483f5cc876e824aa6c085736086b">llvm::Type::isPointerTy</a></div><div class="ttdeci">bool isPointerTy() const </div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00220">Type.h:220</a></div></div>
<div class="ttc" id="classllvm_1_1UndefValue_html_a4ae5ff22b700a42bcc5d889233721335"><div class="ttname"><a href="classllvm_1_1UndefValue.html#a4ae5ff22b700a42bcc5d889233721335">llvm::UndefValue::get</a></div><div class="ttdeci">static UndefValue * get(Type *T)</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l01334">Constants.cpp:1334</a></div></div>
<div class="ttc" id="classllvm_1_1Value_html_af85a4828b6b5a8de7fc0a55cc0e5b52f"><div class="ttname"><a href="classllvm_1_1Value.html#af85a4828b6b5a8de7fc0a55cc0e5b52f">llvm::Value::getContext</a></div><div class="ttdeci">LLVMContext &amp; getContext() const </div><div class="ttdoc">All values hold a context through their type. </div><div class="ttdef"><b>Definition:</b> <a href="Value_8cpp_source.html#l00517">Value.cpp:517</a></div></div>
<div class="ttc" id="classT_html"><div class="ttname"><a href="classT.html">T</a></div></div>
<div class="ttc" id="namespacellvm_1_1Intrinsic_html_a73349916f7e54a6b988a3646c7a02e90a11ad781c8e6b52fd3c123f7cf2f43db0"><div class="ttname"><a href="namespacellvm_1_1Intrinsic.html#a73349916f7e54a6b988a3646c7a02e90a11ad781c8e6b52fd3c123f7cf2f43db0">llvm::Intrinsic::copysign</a></div><div class="ttdef"><b>Definition:</b> <a href="Intrinsics_8h_source.html#l00363">Intrinsics.h:363</a></div></div>
<div class="ttc" id="classllvm_1_1Type_html_ab6cc070c37c59589af100aab6f48ef4f"><div class="ttname"><a href="classllvm_1_1Type.html#ab6cc070c37c59589af100aab6f48ef4f">llvm::Type::getPointerTo</a></div><div class="ttdeci">PointerType * getPointerTo(unsigned AddrSpace=0)</div><div class="ttdef"><b>Definition:</b> <a href="Type_8cpp_source.html#l00756">Type.cpp:756</a></div></div>
<div class="ttc" id="classllvm_1_1Type_html_a7fe9ccd4893f4e2caa826126c09545ea"><div class="ttname"><a href="classllvm_1_1Type.html#a7fe9ccd4893f4e2caa826126c09545ea">llvm::Type::getInt8PtrTy</a></div><div class="ttdeci">static PointerType * getInt8PtrTy(LLVMContext &amp;C, unsigned AS=0)</div><div class="ttdef"><b>Definition:</b> <a href="Type_8cpp_source.html#l00284">Type.cpp:284</a></div></div>
<div class="ttc" id="classllvm_1_1ScalarEvolution_html_a933eb87303a6ce51c8894e431fbc389b"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html#a933eb87303a6ce51c8894e431fbc389b">llvm::ScalarEvolution::getNoopOrZeroExtend</a></div><div class="ttdeci">const SCEV * getNoopOrZeroExtend(const SCEV *V, Type *Ty)</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8cpp_source.html#l02839">ScalarEvolution.cpp:2839</a></div></div>
<div class="ttc" id="classllvm_1_1BinaryOperator_html_a07783e6f39803037259a1ebe376c2b1e"><div class="ttname"><a href="classllvm_1_1BinaryOperator.html#a07783e6f39803037259a1ebe376c2b1e">llvm::BinaryOperator::hasNoSignedWrap</a></div><div class="ttdeci">bool hasNoSignedWrap() const </div><div class="ttdoc">hasNoSignedWrap - Determine whether the no signed wrap flag is set. </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8cpp_source.html#l02013">Instructions.cpp:2013</a></div></div>
<div class="ttc" id="namespacellvm_1_1LibFunc_html_abf8f6830387f338fed0bce2e65108c6fa29e412513f719e77341b9a59c0ec4efd"><div class="ttname"><a href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fa29e412513f719e77341b9a59c0ec4efd">llvm::LibFunc::exp</a></div><div class="ttdoc">double exp(double x); </div><div class="ttdef"><b>Definition:</b> <a href="TargetLibraryInfo_8h_source.html#l00191">TargetLibraryInfo.h:191</a></div></div>
<div class="ttc" id="namespacellvm_1_1PatternMatch_html"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html">llvm::PatternMatch</a></div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l00039">PatternMatch.h:39</a></div></div>
<div class="ttc" id="classllvm_1_1CmpInst_html_a283f9a5d4d843d20c40bb4d3e364bb05a720a42e85f7e981afd61e28473b0000a"><div class="ttname"><a href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05a720a42e85f7e981afd61e28473b0000a">llvm::CmpInst::ICMP_SGT</a></div><div class="ttdoc">signed greater than </div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00678">InstrTypes.h:678</a></div></div>
<div class="ttc" id="namespacellvm_html_a472515fc67a5fb572afeb00aa2609cca"><div class="ttname"><a href="namespacellvm.html#a472515fc67a5fb572afeb00aa2609cca">llvm::LoopSimplifyID</a></div><div class="ttdeci">char &amp; LoopSimplifyID</div><div class="ttdef"><b>Definition:</b> <a href="LoopSimplify_8cpp_source.html#l00123">LoopSimplify.cpp:123</a></div></div>
<div class="ttc" id="classllvm_1_1BinaryOperator_html_aac502d7d65e2996cf6b819b14e17499c"><div class="ttname"><a href="classllvm_1_1BinaryOperator.html#aac502d7d65e2996cf6b819b14e17499c">llvm::BinaryOperator::setIsExact</a></div><div class="ttdeci">void setIsExact(bool b=true)</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8cpp_source.html#l02005">Instructions.cpp:2005</a></div></div>
<div class="ttc" id="classllvm_1_1LoopBase_html_a9a89d64fefa63ff782d8f29e53a01873"><div class="ttname"><a href="classllvm_1_1LoopBase.html#a9a89d64fefa63ff782d8f29e53a01873">llvm::LoopBase::getNumBlocks</a></div><div class="ttdeci">unsigned getNumBlocks() const </div><div class="ttdoc">getNumBlocks - Get the number of blocks in this loop in constant time. </div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l00144">LoopInfo.h:144</a></div></div>
<div class="ttc" id="classllvm_1_1BranchInst_html_a03cc0dff22b31447f43af97acb76b1a2"><div class="ttname"><a href="classllvm_1_1BranchInst.html#a03cc0dff22b31447f43af97acb76b1a2">llvm::BranchInst::isConditional</a></div><div class="ttdeci">bool isConditional() const </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02392">Instructions.h:2392</a></div></div>
<div class="ttc" id="classllvm_1_1Loop_html_a59e5d5a53c39c2508ef67c0c04d23f7c"><div class="ttname"><a href="classllvm_1_1Loop.html#a59e5d5a53c39c2508ef67c0c04d23f7c">llvm::Loop::setLoopID</a></div><div class="ttdeci">void setLoopID(MDNode *LoopID) const </div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8cpp_source.html#l00270">LoopInfo.cpp:270</a></div></div>
<div class="ttc" id="classllvm_1_1DataLayout_html_ae84bb2408dfffa4e8b5fe2ce0714a3bd"><div class="ttname"><a href="classllvm_1_1DataLayout.html#ae84bb2408dfffa4e8b5fe2ce0714a3bd">llvm::DataLayout::getIntPtrType</a></div><div class="ttdeci">IntegerType * getIntPtrType(LLVMContext &amp;C, unsigned AddressSpace=0) const </div><div class="ttdef"><b>Definition:</b> <a href="DataLayout_8cpp_source.html#l00610">DataLayout.cpp:610</a></div></div>
<div class="ttc" id="classllvm_1_1SmallPtrSetImpl_html_aa72472422d95c7052d62432ec279ff85"><div class="ttname"><a href="classllvm_1_1SmallPtrSetImpl.html#aa72472422d95c7052d62432ec279ff85">llvm::SmallPtrSetImpl::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdef"><b>Definition:</b> <a href="SmallPtrSet_8h_source.html#l00077">SmallPtrSet.h:77</a></div></div>
<div class="ttc" id="classllvm_1_1CmpInst_html_a283f9a5d4d843d20c40bb4d3e364bb05a4c399f525bbcf03d72af4b303e6eeca8"><div class="ttname"><a href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05a4c399f525bbcf03d72af4b303e6eeca8">llvm::CmpInst::FCMP_OGT</a></div><div class="ttdoc">0 0 1 0 True if ordered and greater than </div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00655">InstrTypes.h:655</a></div></div>
<div class="ttc" id="classllvm_1_1DenseMapBase_html_a699a66e504b48fdeff124e82f6c61917"><div class="ttname"><a href="classllvm_1_1DenseMapBase.html#a699a66e504b48fdeff124e82f6c61917">llvm::DenseMapBase&lt; DenseMap&lt; KeyT, ValueT, KeyInfoT &gt;, KeyT, ValueT, KeyInfoT &gt;::insert</a></div><div class="ttdeci">std::pair&lt; iterator, bool &gt; insert(const std::pair&lt; KeyT, ValueT &gt; &amp;KV)</div><div class="ttdef"><b>Definition:</b> <a href="DenseMap_8h_source.html#l00153">DenseMap.h:153</a></div></div>
<div class="ttc" id="namespacellvm_1_1Intrinsic_html_a73349916f7e54a6b988a3646c7a02e90a8acf62dbfb8a84e6e5edd4a0be9c3e4c"><div class="ttname"><a href="namespacellvm_1_1Intrinsic.html#a73349916f7e54a6b988a3646c7a02e90a8acf62dbfb8a84e6e5edd4a0be9c3e4c">llvm::Intrinsic::cos</a></div><div class="ttdef"><b>Definition:</b> <a href="Intrinsics_8h_source.html#l00364">Intrinsics.h:364</a></div></div>
<div class="ttc" id="classllvm_1_1BinaryOperator_html_a88505baf41407782678a5df1702d2d31"><div class="ttname"><a href="classllvm_1_1BinaryOperator.html#a88505baf41407782678a5df1702d2d31">llvm::BinaryOperator::getOpcode</a></div><div class="ttdeci">BinaryOps getOpcode() const </div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00326">InstrTypes.h:326</a></div></div>
<div class="ttc" id="classllvm_1_1ConstantVector_html_a5ce0c10fc8f570a6411da209203a1c6e"><div class="ttname"><a href="classllvm_1_1ConstantVector.html#a5ce0c10fc8f570a6411da209203a1c6e">llvm::ConstantVector::getSplat</a></div><div class="ttdeci">static Constant * getSplat(unsigned NumElts, Constant *Elt)</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l01021">Constants.cpp:1021</a></div></div>
<div class="ttc" id="namespacellvm_1_1TargetOpcode_html_a348d4259b5fa6a8ecfe94e7ae512e1a8ae41f9ca68ba5e8b9613cea03652ebd72"><div class="ttname"><a href="namespacellvm_1_1TargetOpcode.html#a348d4259b5fa6a8ecfe94e7ae512e1a8ae41f9ca68ba5e8b9613cea03652ebd72">llvm::TargetOpcode::PHI</a></div><div class="ttdef"><b>Definition:</b> <a href="TargetOpcodes_8h_source.html#l00026">TargetOpcodes.h:26</a></div></div>
<div class="ttc" id="classllvm_1_1ilist__iterator_html"><div class="ttname"><a href="classllvm_1_1ilist__iterator.html">llvm::ilist_iterator</a></div><div class="ttdef"><b>Definition:</b> <a href="ilist_8h_source.html#l00050">ilist.h:50</a></div></div>
<div class="ttc" id="classllvm_1_1ValueMap_html"><div class="ttname"><a href="classllvm_1_1ValueMap.html">llvm::ValueMap</a></div><div class="ttdoc">See the file comment. </div><div class="ttdef"><b>Definition:</b> <a href="ValueMap_8h_source.html#l00075">ValueMap.h:75</a></div></div>
<div class="ttc" id="Target_2ARM_2README_8txt_html_a1b45f45820a60c09244a87eb59824aec"><div class="ttname"><a href="Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a></div><div class="ttdeci">add sub stmia L5 ldr r0 bl L_printf $stub Instead of a and a wouldn t it be better to do three moves *Return an aggregate type is even return S</div><div class="ttdef"><b>Definition:</b> <a href="Target_2ARM_2README_8txt_source.html#l00197">Target/ARM/README.txt:197</a></div></div>
<div class="ttc" id="classllvm_1_1StringRef_html_a1a7bc4930b0396a67c30081f7cb30542"><div class="ttname"><a href="classllvm_1_1StringRef.html#a1a7bc4930b0396a67c30081f7cb30542">llvm::StringRef::startswith</a></div><div class="ttdeci">bool startswith(StringRef Prefix) const </div><div class="ttdoc">Check if this string starts with the given Prefix. </div><div class="ttdef"><b>Definition:</b> <a href="StringRef_8h_source.html#l00208">StringRef.h:208</a></div></div>
<div class="ttc" id="classllvm_1_1SmallPtrSet_html"><div class="ttname"><a href="classllvm_1_1SmallPtrSet.html">llvm::SmallPtrSet</a></div><div class="ttdef"><b>Definition:</b> <a href="SmallPtrSet_8h_source.html#l00236">SmallPtrSet.h:236</a></div></div>
<div class="ttc" id="LoopVectorize_8cpp_html_a0eff4a8bccb143ae91e197e6a59d4692"><div class="ttname"><a href="LoopVectorize_8cpp.html#a0eff4a8bccb143ae91e197e6a59d4692">LV_NAME</a></div><div class="ttdeci">#define LV_NAME</div><div class="ttdef"><b>Definition:</b> <a href="LoopVectorize_8cpp_source.html#l00045">LoopVectorize.cpp:45</a></div></div>
<div class="ttc" id="LoopVectorize_8cpp_html_aaf182c357feddb2f076f2c7e0d7edcea"><div class="ttname"><a href="LoopVectorize_8cpp.html#aaf182c357feddb2f076f2c7e0d7edcea">hasOutsideLoopUser</a></div><div class="ttdeci">static bool hasOutsideLoopUser(const Loop *TheLoop, Instruction *Inst, SmallPtrSet&lt; Value *, 4 &gt; &amp;Reductions)</div><div class="ttdoc">Check that the instruction has outside loop users and is not an identified reduction variable...</div><div class="ttdef"><b>Definition:</b> <a href="LoopVectorize_8cpp_source.html#l02941">LoopVectorize.cpp:2941</a></div></div>
<div class="ttc" id="classllvm_1_1ConstantInt_html"><div class="ttname"><a href="classllvm_1_1ConstantInt.html">llvm::ConstantInt</a></div><div class="ttdoc">Class for constant integers. </div><div class="ttdef"><b>Definition:</b> <a href="Constants_8h_source.html#l00051">Constants.h:51</a></div></div>
<div class="ttc" id="namespacellvm_1_1LibFunc_html_abf8f6830387f338fed0bce2e65108c6fa646f887eab0ba44958ccc8092b0d9199"><div class="ttname"><a href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fa646f887eab0ba44958ccc8092b0d9199">llvm::LibFunc::log10l</a></div><div class="ttdoc">long double log10l(long double x); </div><div class="ttdef"><b>Definition:</b> <a href="TargetLibraryInfo_8h_source.html#l00352">TargetLibraryInfo.h:352</a></div></div>
<div class="ttc" id="classllvm_1_1TargetTransformInfo_html"><div class="ttname"><a href="classllvm_1_1TargetTransformInfo.html">llvm::TargetTransformInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="TargetTransformInfo_8h_source.html#l00039">TargetTransformInfo.h:39</a></div></div>
<div class="ttc" id="namespacellvm_1_1Intrinsic_html_a73349916f7e54a6b988a3646c7a02e90a2107ef535957e9ea31e1fc60f5716e03"><div class="ttname"><a href="namespacellvm_1_1Intrinsic.html#a73349916f7e54a6b988a3646c7a02e90a2107ef535957e9ea31e1fc60f5716e03">llvm::Intrinsic::ceil</a></div><div class="ttdef"><b>Definition:</b> <a href="Intrinsics_8h_source.html#l00351">Intrinsics.h:351</a></div></div>
<div class="ttc" id="classllvm_1_1PHINode_html_aba6a4cc4ed6d6fef3664b8d65ef04820"><div class="ttname"><a href="classllvm_1_1PHINode.html#aba6a4cc4ed6d6fef3664b8d65ef04820">llvm::PHINode::getIncomingValue</a></div><div class="ttdeci">Value * getIncomingValue(unsigned i) const </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02059">Instructions.h:2059</a></div></div>
<div class="ttc" id="classllvm_1_1DataLayout_html_a1d6fcc02e91ba24510aba42660c90e29"><div class="ttname"><a href="classllvm_1_1DataLayout.html#a1d6fcc02e91ba24510aba42660c90e29">llvm::DataLayout::getTypeAllocSize</a></div><div class="ttdeci">uint64_t getTypeAllocSize(Type *Ty) const </div><div class="ttdef"><b>Definition:</b> <a href="DataLayout_8h_source.html#l00326">DataLayout.h:326</a></div></div>
<div class="ttc" id="Target_2README_8txt_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">i</div><div class="ttdef"><b>Definition:</b> <a href="Target_2README_8txt_source.html#l00029">Target/README.txt:29</a></div></div>
<div class="ttc" id="classllvm_1_1BasicBlock_html_a0b4e7bee9b8575cc7db73329f1a561bd"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a0b4e7bee9b8575cc7db73329f1a561bd">llvm::BasicBlock::end</a></div><div class="ttdeci">iterator end()</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00195">BasicBlock.h:195</a></div></div>
<div class="ttc" id="classllvm_1_1AnalysisUsage_html_a053677ebc731b47a534f841b11b5cf0c"><div class="ttname"><a href="classllvm_1_1AnalysisUsage.html#a053677ebc731b47a534f841b11b5cf0c">llvm::AnalysisUsage::addRequiredID</a></div><div class="ttdeci">AnalysisUsage &amp; addRequiredID(const void *ID)</div><div class="ttdef"><b>Definition:</b> <a href="Pass_8cpp_source.html#l00262">Pass.cpp:262</a></div></div>
<div class="ttc" id="LoopVectorize_8cpp_html_a9934327154d90155e54840cdf84df6a0"><div class="ttname"><a href="LoopVectorize_8cpp.html#a9934327154d90155e54840cdf84df6a0">getGEPInductionOperand</a></div><div class="ttdeci">static unsigned getGEPInductionOperand(DataLayout *DL, const GetElementPtrInst *Gep)</div><div class="ttdoc">Find the operand of the GEP that should be checked for consecutive stores. This ignores trailing indi...</div><div class="ttdef"><b>Definition:</b> <a href="LoopVectorize_8cpp_source.html#l01073">LoopVectorize.cpp:1073</a></div></div>
<div class="ttc" id="namespacellvm_1_1EngineKind_html_a9df47239a42cd9621ac26d9ecbd57441"><div class="ttname"><a href="namespacellvm_1_1EngineKind.html#a9df47239a42cd9621ac26d9ecbd57441">llvm::EngineKind::Kind</a></div><div class="ttdeci">Kind</div><div class="ttdef"><b>Definition:</b> <a href="ExecutionEngine_2ExecutionEngine_8h_source.html#l00499">ExecutionEngine/ExecutionEngine.h:499</a></div></div>
<div class="ttc" id="classllvm_1_1EquivalenceClasses_1_1member__iterator_html"><div class="ttname"><a href="classllvm_1_1EquivalenceClasses_1_1member__iterator.html">llvm::EquivalenceClasses::member_iterator</a></div><div class="ttdef"><b>Definition:</b> <a href="EquivalenceClasses_8h_source.html#l00239">EquivalenceClasses.h:239</a></div></div>
<div class="ttc" id="classllvm_1_1IRBuilder_html_a87b363b9dad9f5040ea7e29ea9e60ff5"><div class="ttname"><a href="classllvm_1_1IRBuilder.html#a87b363b9dad9f5040ea7e29ea9e60ff5">llvm::IRBuilder::CreateBitCast</a></div><div class="ttdeci">Value * CreateBitCast(Value *V, Type *DestTy, const Twine &amp;Name=&quot;&quot;)</div><div class="ttdef"><b>Definition:</b> <a href="IRBuilder_8h_source.html#l01132">IRBuilder.h:1132</a></div></div>
<div class="ttc" id="classllvm_1_1SmallVector_html"><div class="ttname"><a href="classllvm_1_1SmallVector.html">llvm::SmallVector</a></div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00880">SmallVector.h:880</a></div></div>
<div class="ttc" id="classllvm_1_1Attribute_html_aab7ee4b8fd1d3e7e4cea87868855e60ea2ac83e0612ce8f8d69651cd529061feb"><div class="ttname"><a href="classllvm_1_1Attribute.html#aab7ee4b8fd1d3e7e4cea87868855e60ea2ac83e0612ce8f8d69651cd529061feb">llvm::Attribute::OptimizeForSize</a></div><div class="ttdoc">opt_size </div><div class="ttdef"><b>Definition:</b> <a href="Attributes_8h_source.html#l00091">Attributes.h:91</a></div></div>
<div class="ttc" id="classllvm_1_1SCEV_html_a6e915d0a915541a818ab88b1fac7cbd1"><div class="ttname"><a href="classllvm_1_1SCEV.html#a6e915d0a915541a818ab88b1fac7cbd1">llvm::SCEV::isAllOnesValue</a></div><div class="ttdeci">bool isAllOnesValue() const </div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8cpp_source.html#l00287">ScalarEvolution.cpp:287</a></div></div>
<div class="ttc" id="Module_8h_html"><div class="ttname"><a href="Module_8h.html">Module.h</a></div></div>
<div class="ttc" id="classllvm_1_1Value_html_a0cf3748dba54f931bb1241ae4adc76bc"><div class="ttname"><a href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">llvm::Value::getType</a></div><div class="ttdeci">Type * getType() const </div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00111">Value.h:111</a></div></div>
<div class="ttc" id="classllvm_1_1TargetLibraryInfo_html"><div class="ttname"><a href="classllvm_1_1TargetLibraryInfo.html">llvm::TargetLibraryInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="TargetLibraryInfo_8h_source.html#l00657">TargetLibraryInfo.h:657</a></div></div>
<div class="ttc" id="namespacellvm_html_a2c3c18bffdc25d969233c5448bdfe7eb"><div class="ttname"><a href="namespacellvm.html#a2c3c18bffdc25d969233c5448bdfe7eb">llvm::AddressSpace</a></div><div class="ttdeci">AddressSpace</div><div class="ttdef"><b>Definition:</b> <a href="NVPTXBaseInfo_8h_source.html#l00022">NVPTXBaseInfo.h:22</a></div></div>
<div class="ttc" id="classllvm_1_1LoopInfo_html"><div class="ttname"><a href="classllvm_1_1LoopInfo.html">llvm::LoopInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l00589">LoopInfo.h:589</a></div></div>
<div class="ttc" id="classllvm_1_1LoopBase_html_a1431766de798501f107d9031821f311e"><div class="ttname"><a href="classllvm_1_1LoopBase.html#a1431766de798501f107d9031821f311e">llvm::LoopBase::getParentLoop</a></div><div class="ttdeci">LoopT * getParentLoop() const </div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l00096">LoopInfo.h:96</a></div></div>
<div class="ttc" id="classllvm_1_1BinaryOperator_html"><div class="ttname"><a href="classllvm_1_1BinaryOperator.html">llvm::BinaryOperator</a></div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00138">InstrTypes.h:138</a></div></div>
<div class="ttc" id="classllvm_1_1CmpInst_html_a283f9a5d4d843d20c40bb4d3e364bb05a15ae464950ac676919c2f0c7aafc706c"><div class="ttname"><a href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05a15ae464950ac676919c2f0c7aafc706c">llvm::CmpInst::ICMP_SLT</a></div><div class="ttdoc">signed less than </div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00680">InstrTypes.h:680</a></div></div>
<div class="ttc" id="PassSupport_8h_html_aaa970fc931c1c63037a8182e028d04b1"><div class="ttname"><a href="PassSupport_8h.html#aaa970fc931c1c63037a8182e028d04b1">INITIALIZE_PASS_BEGIN</a></div><div class="ttdeci">#define INITIALIZE_PASS_BEGIN(passName, arg, name, cfg, analysis)</div><div class="ttdef"><b>Definition:</b> <a href="PassSupport_8h_source.html#l00164">PassSupport.h:164</a></div></div>
<div class="ttc" id="classllvm_1_1GetElementPtrInst_html_abfc8f5fb56fb06e32a26f28ba7ec1c0b"><div class="ttname"><a href="classllvm_1_1GetElementPtrInst.html#abfc8f5fb56fb06e32a26f28ba7ec1c0b">llvm::GetElementPtrInst::getType</a></div><div class="ttdeci">SequentialType * getType() const </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00764">Instructions.h:764</a></div></div>
<div class="ttc" id="classllvm_1_1SmallPtrSetImpl_html_a41c201584742f7eb45b2be8cd54e3bcb"><div class="ttname"><a href="classllvm_1_1SmallPtrSetImpl.html#a41c201584742f7eb45b2be8cd54e3bcb">llvm::SmallPtrSetImpl::size</a></div><div class="ttdeci">unsigned size() const </div><div class="ttdef"><b>Definition:</b> <a href="SmallPtrSet_8h_source.html#l00075">SmallPtrSet.h:75</a></div></div>
<div class="ttc" id="classllvm_1_1APInt_html_aeebb29dd5a7aaf9b4546fec69c43653b"><div class="ttname"><a href="classllvm_1_1APInt.html#aeebb29dd5a7aaf9b4546fec69c43653b">llvm::APInt::isStrictlyPositive</a></div><div class="ttdeci">bool isStrictlyPositive() const </div><div class="ttdoc">Determine if this APInt Value is positive. </div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l00335">APInt.h:335</a></div></div>
<div class="ttc" id="Verifier_8h_html"><div class="ttname"><a href="Verifier_8h.html">Verifier.h</a></div></div>
<div class="ttc" id="classllvm_1_1ConstantInt_html_aba1dd3231ce4399a15b39ff769277f8d"><div class="ttname"><a href="classllvm_1_1ConstantInt.html#aba1dd3231ce4399a15b39ff769277f8d">llvm::ConstantInt::equalsInt</a></div><div class="ttdeci">bool equalsInt(uint64_t V) const </div><div class="ttdoc">Determine if this constant&amp;#39;s value is same as an unsigned char. </div><div class="ttdef"><b>Definition:</b> <a href="Constants_8h_source.html#l00132">Constants.h:132</a></div></div>
<div class="ttc" id="classllvm_1_1LoopPass_html"><div class="ttname"><a href="classllvm_1_1LoopPass.html">llvm::LoopPass</a></div><div class="ttdef"><b>Definition:</b> <a href="LoopPass_8h_source.html#l00029">LoopPass.h:29</a></div></div>
<div class="ttc" id="classllvm_1_1ConstantInt_html_a9105541412dab869e18b3cceebfff07d"><div class="ttname"><a href="classllvm_1_1ConstantInt.html#a9105541412dab869e18b3cceebfff07d">llvm::ConstantInt::get</a></div><div class="ttdeci">static Constant * get(Type *Ty, uint64_t V, bool isSigned=false)</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l00492">Constants.cpp:492</a></div></div>
<div class="ttc" id="classllvm_1_1CallInst_html_a0bcd4131e1a1d92215f5385b4e16cd2e"><div class="ttname"><a href="classllvm_1_1CallInst.html#a0bcd4131e1a1d92215f5385b4e16cd2e">llvm::CallInst::getCalledFunction</a></div><div class="ttdeci">Function * getCalledFunction() const </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l01357">Instructions.h:1357</a></div></div>
<div class="ttc" id="namespacellvm_1_1LibFunc_html_abf8f6830387f338fed0bce2e65108c6faf3a65ea3339861d41948aa2de71ba2e4"><div class="ttname"><a href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6faf3a65ea3339861d41948aa2de71ba2e4">llvm::LibFunc::fabs</a></div><div class="ttdoc">double fabs(double x); </div><div class="ttdef"><b>Definition:</b> <a href="TargetLibraryInfo_8h_source.html#l00215">TargetLibraryInfo.h:215</a></div></div>
<div class="ttc" id="classllvm_1_1LoopBase_html_a3df1c508a7b1c89247367cab269076e2"><div class="ttname"><a href="classllvm_1_1LoopBase.html#a3df1c508a7b1c89247367cab269076e2">llvm::LoopBase::block_begin</a></div><div class="ttdeci">block_iterator block_begin() const </div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l00140">LoopInfo.h:140</a></div></div>
<div class="ttc" id="classllvm_1_1SCEVConstant_html_a64f0133adf37f9513005465580a19a66"><div class="ttname"><a href="classllvm_1_1SCEVConstant.html#a64f0133adf37f9513005465580a19a66">llvm::SCEVConstant::getValue</a></div><div class="ttdeci">ConstantInt * getValue() const </div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolutionExpressions_8h_source.html#l00044">ScalarEvolutionExpressions.h:44</a></div></div>
<div class="ttc" id="classllvm_1_1ConstantFP_html_a5eb8f7a5d3cfdd127ad9db2e425e14eb"><div class="ttname"><a href="classllvm_1_1ConstantFP.html#a5eb8f7a5d3cfdd127ad9db2e425e14eb">llvm::ConstantFP::get</a></div><div class="ttdeci">static Constant * get(Type *Ty, double V)</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l00557">Constants.cpp:557</a></div></div>
<div class="ttc" id="classllvm_1_1LoopBase_html_a91e3f5f9bf6ecbd058624a479e150603"><div class="ttname"><a href="classllvm_1_1LoopBase.html#a91e3f5f9bf6ecbd058624a479e150603">llvm::LoopBase::block_end</a></div><div class="ttdeci">block_iterator block_end() const </div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l00141">LoopInfo.h:141</a></div></div>
<div class="ttc" id="classllvm_1_1BinaryOperator_html_a0f67e7208255f5088f0d515185109174"><div class="ttname"><a href="classllvm_1_1BinaryOperator.html#a0f67e7208255f5088f0d515185109174">llvm::BinaryOperator::isExact</a></div><div class="ttdeci">bool isExact() const </div><div class="ttdoc">isExact - Determine whether the exact flag is set. </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8cpp_source.html#l02017">Instructions.cpp:2017</a></div></div>
<div class="ttc" id="classllvm_1_1ConstantInt_html_a82dbbd8e3688b0bc1eedb338864d0d0c"><div class="ttname"><a href="classllvm_1_1ConstantInt.html#a82dbbd8e3688b0bc1eedb338864d0d0c">llvm::ConstantInt::getTrue</a></div><div class="ttdeci">static ConstantInt * getTrue(LLVMContext &amp;Context)</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l00438">Constants.cpp:438</a></div></div>
<div class="ttc" id="namespacellvm_1_1A64DB_html_a6fce8157775f3ec93f326b52b0f1e0f5ad61b145eb8cbab18feb1b2e2ce269a7e"><div class="ttname"><a href="namespacellvm_1_1A64DB.html#a6fce8157775f3ec93f326b52b0f1e0f5ad61b145eb8cbab18feb1b2e2ce269a7e">llvm::A64DB::LD</a></div><div class="ttdef"><b>Definition:</b> <a href="AArch64BaseInfo_8h_source.html#l00177">AArch64BaseInfo.h:177</a></div></div>
<div class="ttc" id="classllvm_1_1User_html_a5fa9b8e1842b354f64c1ba6be0a4a17f"><div class="ttname"><a href="classllvm_1_1User.html#a5fa9b8e1842b354f64c1ba6be0a4a17f">llvm::User::setOperand</a></div><div class="ttdeci">void setOperand(unsigned i, Value *Val)</div><div class="ttdef"><b>Definition:</b> <a href="User_8h_source.html#l00092">User.h:92</a></div></div>
<div class="ttc" id="namespacellvm_html_a7c46c742c31be54870e2038048e6b391"><div class="ttname"><a href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">llvm::dbgs</a></div><div class="ttdeci">raw_ostream &amp; dbgs()</div><div class="ttdoc">dbgs - Return a circular-buffered debug stream. </div><div class="ttdef"><b>Definition:</b> <a href="Debug_8cpp_source.html#l00101">Debug.cpp:101</a></div></div>
<div class="ttc" id="namespacellvm_1_1LibFunc_html_abf8f6830387f338fed0bce2e65108c6fa7297eb46d831890d559d86805c768ac7"><div class="ttname"><a href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fa7297eb46d831890d559d86805c768ac7">llvm::LibFunc::log2l</a></div><div class="ttdoc">double long double log2l(long double x); </div><div class="ttdef"><b>Definition:</b> <a href="TargetLibraryInfo_8h_source.html#l00364">TargetLibraryInfo.h:364</a></div></div>
<div class="ttc" id="namespacestd_html_ab8424022895aee3e366fb9a32f2883cb"><div class="ttname"><a href="namespacestd.html#ab8424022895aee3e366fb9a32f2883cb">std::swap</a></div><div class="ttdeci">void swap(llvm::BitVector &amp;LHS, llvm::BitVector &amp;RHS)</div><div class="ttdoc">Implement std::swap in terms of BitVector swap. </div><div class="ttdef"><b>Definition:</b> <a href="BitVector_8h_source.html#l00591">BitVector.h:591</a></div></div>
<div class="ttc" id="classllvm_1_1Function_html_a72873ed64b7be01507a2248b8e756ec8"><div class="ttname"><a href="classllvm_1_1Function.html#a72873ed64b7be01507a2248b8e756ec8">llvm::Function::getAttributes</a></div><div class="ttdeci">AttributeSet getAttributes() const </div><div class="ttdoc">Return the attribute list for this Function. </div><div class="ttdef"><b>Definition:</b> <a href="Function_8h_source.html#l00170">Function.h:170</a></div></div>
<div class="ttc" id="CodeGen_2README_8txt_html_aa0629dbc89f0868f62da8cbcb681b2be"><div class="ttname"><a href="CodeGen_2README_8txt.html#aa0629dbc89f0868f62da8cbcb681b2be">be</a></div><div class="ttdeci">Common register allocation spilling lr str ldr sxth r3 ldr mla r4 can be</div><div class="ttdef"><b>Definition:</b> <a href="CodeGen_2README_8txt_source.html#l00005">CodeGen/README.txt:5</a></div></div>
<div class="ttc" id="classllvm_1_1CallInst_html_a150b33ecedbc8c7803c2db8040fbe3f8"><div class="ttname"><a href="classllvm_1_1CallInst.html#a150b33ecedbc8c7803c2db8040fbe3f8">llvm::CallInst::getArgOperand</a></div><div class="ttdeci">Value * getArgOperand(unsigned i) const </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l01245">Instructions.h:1245</a></div></div>
<div class="ttc" id="classllvm_1_1LoopBlocksDFS_html"><div class="ttname"><a href="classllvm_1_1LoopBlocksDFS.html">llvm::LoopBlocksDFS</a></div><div class="ttdef"><b>Definition:</b> <a href="LoopIterator_8h_source.html#l00038">LoopIterator.h:38</a></div></div>
<div class="ttc" id="classllvm_1_1VectorType_html"><div class="ttname"><a href="classllvm_1_1VectorType.html">llvm::VectorType</a></div><div class="ttdef"><b>Definition:</b> <a href="DerivedTypes_8h_source.html#l00358">DerivedTypes.h:358</a></div></div>
<div class="ttc" id="classllvm_1_1APInt_html"><div class="ttname"><a href="classllvm_1_1APInt.html">llvm::APInt</a></div><div class="ttdoc">Class for arbitrary precision integers. </div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l00075">APInt.h:75</a></div></div>
<div class="ttc" id="namespacellvm_1_1LibFunc_html_abf8f6830387f338fed0bce2e65108c6fa2b4d1af9a93856b794d542815d091176"><div class="ttname"><a href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fa2b4d1af9a93856b794d542815d091176">llvm::LibFunc::logl</a></div><div class="ttdoc">long double logl(long double x); </div><div class="ttdef"><b>Definition:</b> <a href="TargetLibraryInfo_8h_source.html#l00374">TargetLibraryInfo.h:374</a></div></div>
<div class="ttc" id="ScalarEvolution_8h_html"><div class="ttname"><a href="ScalarEvolution_8h.html">ScalarEvolution.h</a></div></div>
<div class="ttc" id="CodeGen_2README_8txt_html_a09776db24cf586ec9f1e18f3bae14099"><div class="ttname"><a href="CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a></div><div class="ttdeci">Common register allocation spilling lr str ldr sxth r3 ldr mla r4 can lr mov lr str ldr sxth r3 mla r4 and then merge mul and lr str ldr sxth r3 mla r4 It also increase the likelihood the store may become dead bb27 Successors according to LLVM BB</div><div class="ttdef"><b>Definition:</b> <a href="CodeGen_2README_8txt_source.html#l00036">CodeGen/README.txt:36</a></div></div>
<div class="ttc" id="namespacellvm_1_1cl_html_ac96f30ba8b117dbd380b88ab8a03732ba1e82b710efc2f25cc275e53b3833e6fa"><div class="ttname"><a href="namespacellvm_1_1cl.html#ac96f30ba8b117dbd380b88ab8a03732ba1e82b710efc2f25cc275e53b3833e6fa">llvm::cl::Sink</a></div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l00138">CommandLine.h:138</a></div></div>
<div class="ttc" id="classllvm_1_1PHINode_html_a21960167f529265a1cb02ac1e8ad10f6"><div class="ttname"><a href="classllvm_1_1PHINode.html#a21960167f529265a1cb02ac1e8ad10f6">llvm::PHINode::getIncomingValueForBlock</a></div><div class="ttdeci">Value * getIncomingValueForBlock(const BasicBlock *BB) const </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02139">Instructions.h:2139</a></div></div>
<div class="ttc" id="classllvm_1_1Type_html_a6e328feb83afa5cf1c966d6704e43fc1"><div class="ttname"><a href="classllvm_1_1Type.html#a6e328feb83afa5cf1c966d6704e43fc1">llvm::Type::isIntegerTy</a></div><div class="ttdeci">bool isIntegerTy() const </div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00196">Type.h:196</a></div></div>
<div class="ttc" id="Pass_8h_html"><div class="ttname"><a href="Pass_8h.html">Pass.h</a></div></div>
<div class="ttc" id="classllvm_1_1IRBuilder_html_ae19d9d49f39d404703b42161ce788954"><div class="ttname"><a href="classllvm_1_1IRBuilder.html#ae19d9d49f39d404703b42161ce788954">llvm::IRBuilder::CreateSelect</a></div><div class="ttdeci">Value * CreateSelect(Value *C, Value *True, Value *False, const Twine &amp;Name=&quot;&quot;)</div><div class="ttdef"><b>Definition:</b> <a href="IRBuilder_8h_source.html#l01336">IRBuilder.h:1336</a></div></div>
<div class="ttc" id="namespacellvm_1_1LibFunc_html_abf8f6830387f338fed0bce2e65108c6fa62c8dfa59caa8250b9c988b6d49fc18c"><div class="ttname"><a href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fa62c8dfa59caa8250b9c988b6d49fc18c">llvm::LibFunc::powf</a></div><div class="ttdoc">float powf(float x, float y); </div><div class="ttdef"><b>Definition:</b> <a href="TargetLibraryInfo_8h_source.html#l00436">TargetLibraryInfo.h:436</a></div></div>
<div class="ttc" id="LoopVectorize_8cpp_html_ab46314da66bb0ae8d7651f1909e1fa15"><div class="ttname"><a href="LoopVectorize_8cpp.html#ab46314da66bb0ae8d7651f1909e1fa15">convertPointerToIntegerType</a></div><div class="ttdeci">static Type * convertPointerToIntegerType(DataLayout &amp;DL, Type *Ty)</div><div class="ttdef"><b>Definition:</b> <a href="LoopVectorize_8cpp_source.html#l02919">LoopVectorize.cpp:2919</a></div></div>
<div class="ttc" id="classllvm_1_1ScalarEvolution_html_a5984e47d0885332478dc9232634d82e8"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html#a5984e47d0885332478dc9232634d82e8">llvm::ScalarEvolution::getSmallConstantTripCount</a></div><div class="ttdeci">unsigned getSmallConstantTripCount(Loop *L, BasicBlock *ExitingBlock)</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8cpp_source.html#l03986">ScalarEvolution.cpp:3986</a></div></div>
<div class="ttc" id="LoopVectorize_8cpp_html_a5ce679c74f9d5aa21d8ea3d1a798f0a9"><div class="ttname"><a href="LoopVectorize_8cpp.html#a5ce679c74f9d5aa21d8ea3d1a798f0a9">lv_name</a></div><div class="ttdeci">static const char lv_name[]</div><div class="ttdef"><b>Definition:</b> <a href="LoopVectorize_8cpp_source.html#l05038">LoopVectorize.cpp:5038</a></div></div>
<div class="ttc" id="classllvm_1_1SCEVExpander_html"><div class="ttname"><a href="classllvm_1_1SCEVExpander.html">llvm::SCEVExpander</a></div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolutionExpander_8h_source.html#l00037">ScalarEvolutionExpander.h:37</a></div></div>
<div class="ttc" id="PatternMatch_8h_html"><div class="ttname"><a href="PatternMatch_8h.html">PatternMatch.h</a></div></div>
<div class="ttc" id="namespacellvm_html_af80edfc5e42059e045aa7bf7fe42bee3"><div class="ttname"><a href="namespacellvm.html#af80edfc5e42059e045aa7bf7fe42bee3">llvm::hash_combine_range</a></div><div class="ttdeci">hash_code hash_combine_range(InputIteratorT first, InputIteratorT last)</div><div class="ttdoc">Compute a hash_code for a sequence of values. </div><div class="ttdef"><b>Definition:</b> <a href="Hashing_8h_source.html#l00487">Hashing.h:487</a></div></div>
<div class="ttc" id="classllvm_1_1ScalarEvolution_html_a23541ecba66207184eaf2279a70c5b12"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html#a23541ecba66207184eaf2279a70c5b12">llvm::ScalarEvolution::getAddExpr</a></div><div class="ttdeci">const SCEV * getAddExpr(SmallVectorImpl&lt; const SCEV * &gt; &amp;Ops, SCEV::NoWrapFlags Flags=SCEV::FlagAnyWrap)</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8cpp_source.html#l01461">ScalarEvolution.cpp:1461</a></div></div>
<div class="ttc" id="namespacellvm_1_1Intrinsic_html_a73349916f7e54a6b988a3646c7a02e90a3f406d8b74c8f3009ee1fee5172b1415"><div class="ttname"><a href="namespacellvm_1_1Intrinsic.html#a73349916f7e54a6b988a3646c7a02e90a3f406d8b74c8f3009ee1fee5172b1415">llvm::Intrinsic::nearbyint</a></div><div class="ttdef"><b>Definition:</b> <a href="Intrinsics_8h_source.html#l01929">Intrinsics.h:1929</a></div></div>
<div class="ttc" id="Function_8h_html"><div class="ttname"><a href="Function_8h.html">Function.h</a></div></div>
<div class="ttc" id="namespacellvm_1_1LibFunc_html_abf8f6830387f338fed0bce2e65108c6fa7187926b06529564381106c98bd3a1b7"><div class="ttname"><a href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fa7187926b06529564381106c98bd3a1b7">llvm::LibFunc::sin</a></div><div class="ttdoc">double sin(double x); </div><div class="ttdef"><b>Definition:</b> <a href="TargetLibraryInfo_8h_source.html#l00495">TargetLibraryInfo.h:495</a></div></div>
<div class="ttc" id="namespacellvm_1_1APIntOps_html_a684cfe02c582e8d75cd6d457e63e6c25"><div class="ttname"><a href="namespacellvm_1_1APIntOps.html#a684cfe02c582e8d75cd6d457e63e6c25">llvm::APIntOps::And</a></div><div class="ttdeci">APInt And(const APInt &amp;LHS, const APInt &amp;RHS)</div><div class="ttdoc">Bitwise AND function for APInt. </div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l01840">APInt.h:1840</a></div></div>
<div class="ttc" id="LoopVectorize_8cpp_html_af303907f5edd23d696cb2af21c6fec66"><div class="ttname"><a href="LoopVectorize_8cpp.html#af303907f5edd23d696cb2af21c6fec66">VectorizationUnroll</a></div><div class="ttdeci">static cl::opt&lt; unsigned &gt; VectorizationUnroll(&quot;force-vector-unroll&quot;, cl::init(0), cl::Hidden, cl::desc(&quot;Sets the vectorization unroll count. &quot;&quot;Zero is autoselect.&quot;))</div></div>
<div class="ttc" id="classllvm_1_1SmallVectorTemplateCommon_html_a8a045d250952c0867382a9840ee18fdf"><div class="ttname"><a href="classllvm_1_1SmallVectorTemplateCommon.html#a8a045d250952c0867382a9840ee18fdf">llvm::SmallVectorTemplateCommon&lt; T &gt;::begin</a></div><div class="ttdeci">iterator begin()</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00112">SmallVector.h:112</a></div></div>
<div class="ttc" id="classllvm_1_1SmallSet_html_ab28aa342862f6d16361be514fd98c22e"><div class="ttname"><a href="classllvm_1_1SmallSet.html#ab28aa342862f6d16361be514fd98c22e">llvm::SmallSet::count</a></div><div class="ttdeci">bool count(const T &amp;V) const </div><div class="ttdoc">count - Return true if the element is in the set. </div><div class="ttdef"><b>Definition:</b> <a href="SmallSet_8h_source.html#l00048">SmallSet.h:48</a></div></div>
<div class="ttc" id="ValueHandle_8h_html"><div class="ttname"><a href="ValueHandle_8h.html">ValueHandle.h</a></div></div>
<div class="ttc" id="namespacellvm_1_1LibFunc_html_abf8f6830387f338fed0bce2e65108c6fa16fd74479c27fa3280666ad302ab4a5a"><div class="ttname"><a href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fa16fd74479c27fa3280666ad302ab4a5a">llvm::LibFunc::ceill</a></div><div class="ttdoc">long double ceill(long double x); </div><div class="ttdef"><b>Definition:</b> <a href="TargetLibraryInfo_8h_source.html#l00161">TargetLibraryInfo.h:161</a></div></div>
<div class="ttc" id="classllvm_1_1Value_html_a413abcab8dbc3900fc2fde96a5d8fca6"><div class="ttname"><a href="classllvm_1_1Value.html#a413abcab8dbc3900fc2fde96a5d8fca6">llvm::Value::use_begin</a></div><div class="ttdeci">use_iterator use_begin()</div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00150">Value.h:150</a></div></div>
<div class="ttc" id="LoopVectorize_8cpp_html_ab10ac4a80fce310e0fa7c74066153ebc"><div class="ttname"><a href="LoopVectorize_8cpp.html#ab10ac4a80fce310e0fa7c74066153ebc">EnableIfConversion</a></div><div class="ttdeci">static cl::opt&lt; bool &gt; EnableIfConversion(&quot;enable-if-conversion&quot;, cl::init(true), cl::Hidden, cl::desc(&quot;Enable if-conversion during vectorization.&quot;))</div></div>
<div class="ttc" id="AliasAnalysis_8h_html"><div class="ttname"><a href="AliasAnalysis_8h.html">AliasAnalysis.h</a></div></div>
<div class="ttc" id="StringExtras_8h_html"><div class="ttname"><a href="StringExtras_8h.html">StringExtras.h</a></div></div>
<div class="ttc" id="classllvm_1_1CmpInst_html_a4cd12603c3c76eb84d050733f6ddc8b7"><div class="ttname"><a href="classllvm_1_1CmpInst.html#a4cd12603c3c76eb84d050733f6ddc8b7">llvm::CmpInst::Create</a></div><div class="ttdeci">static CmpInst * Create(OtherOps Op, unsigned short predicate, Value *S1, Value *S2, const Twine &amp;Name=&quot;&quot;, Instruction *InsertBefore=0)</div><div class="ttdoc">Create a CmpInst. </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8cpp_source.html#l03035">Instructions.cpp:3035</a></div></div>
<div class="ttc" id="Transforms_2Scalar_8h_html"><div class="ttname"><a href="Transforms_2Scalar_8h.html">Scalar.h</a></div></div>
<div class="ttc" id="namespacellvm_1_1Intrinsic_html_a73349916f7e54a6b988a3646c7a02e90af7d48287addfbfdc4bcd296efbc44e4e"><div class="ttname"><a href="namespacellvm_1_1Intrinsic.html#a73349916f7e54a6b988a3646c7a02e90af7d48287addfbfdc4bcd296efbc44e4e">llvm::Intrinsic::log2</a></div><div class="ttdef"><b>Definition:</b> <a href="Intrinsics_8h_source.html#l01258">Intrinsics.h:1258</a></div></div>
<div class="ttc" id="classllvm_1_1BranchInst_html_a84309bb8c34c8bc5694ec5d48dd8668f"><div class="ttname"><a href="classllvm_1_1BranchInst.html#a84309bb8c34c8bc5694ec5d48dd8668f">llvm::BranchInst::getCondition</a></div><div class="ttdeci">Value * getCondition() const </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02394">Instructions.h:2394</a></div></div>
<div class="ttc" id="classllvm_1_1cl_1_1opt_html"><div class="ttname"><a href="classllvm_1_1cl_1_1opt.html">llvm::cl::opt</a></div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l01149">CommandLine.h:1149</a></div></div>
<div class="ttc" id="classllvm_1_1ScalarEvolution_html_a592bdd7731b14ff4ff5d646f6f399900"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html#a592bdd7731b14ff4ff5d646f6f399900">llvm::ScalarEvolution::forgetLoop</a></div><div class="ttdeci">void forgetLoop(const Loop *L)</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8cpp_source.html#l04162">ScalarEvolution.cpp:4162</a></div></div>
<div class="ttc" id="classllvm_1_1Function_html_a603f8f8d2c9d8de6762092830cf82b13"><div class="ttname"><a href="classllvm_1_1Function.html#a603f8f8d2c9d8de6762092830cf82b13">llvm::Function::hasFnAttribute</a></div><div class="ttdeci">bool hasFnAttribute(Attribute::AttrKind Kind) const </div><div class="ttdoc">Return true if the function has the attribute. </div><div class="ttdef"><b>Definition:</b> <a href="Function_8h_source.html#l00200">Function.h:200</a></div></div>
<div class="ttc" id="classllvm_1_1Type_html_a0a32c2cb0342323dc78f6aa31d7e581e"><div class="ttname"><a href="classllvm_1_1Type.html#a0a32c2cb0342323dc78f6aa31d7e581e">llvm::Type::isAggregateType</a></div><div class="ttdeci">bool isAggregateType() const </div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00270">Type.h:270</a></div></div>
<div class="ttc" id="namespacellvm_1_1LibFunc_html_abf8f6830387f338fed0bce2e65108c6faa782c4e760a1f85a047f0f445fe9a166"><div class="ttname"><a href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6faa782c4e760a1f85a047f0f445fe9a166">llvm::LibFunc::ceil</a></div><div class="ttdoc">double ceil(double x); </div><div class="ttdef"><b>Definition:</b> <a href="TargetLibraryInfo_8h_source.html#l00157">TargetLibraryInfo.h:157</a></div></div>
<div class="ttc" id="classllvm_1_1StringRef_html_a7414af479a1a88b0631120a4fc681e20"><div class="ttname"><a href="classllvm_1_1StringRef.html#a7414af479a1a88b0631120a4fc681e20">llvm::StringRef::npos</a></div><div class="ttdeci">static const size_t npos</div><div class="ttdef"><b>Definition:</b> <a href="StringRef_8h_source.html#l00045">StringRef.h:45</a></div></div>
<div class="ttc" id="classllvm_1_1SCEV_html"><div class="ttname"><a href="classllvm_1_1SCEV.html">llvm::SCEV</a></div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8h_source.html#l00057">ScalarEvolution.h:57</a></div></div>
<div class="ttc" id="classllvm_1_1SmallSet_html_a12d5f426acafa2dea032861636976889"><div class="ttname"><a href="classllvm_1_1SmallSet.html#a12d5f426acafa2dea032861636976889">llvm::SmallSet::size</a></div><div class="ttdeci">unsigned size() const </div><div class="ttdef"><b>Definition:</b> <a href="SmallSet_8h_source.html#l00043">SmallSet.h:43</a></div></div>
<div class="ttc" id="classllvm_1_1Type_html_a30dd396c5b40cd86c1591872e574ccdf"><div class="ttname"><a href="classllvm_1_1Type.html#a30dd396c5b40cd86c1591872e574ccdf">llvm::Type::getInt32Ty</a></div><div class="ttdeci">static IntegerType * getInt32Ty(LLVMContext &amp;C)</div><div class="ttdef"><b>Definition:</b> <a href="Type_8cpp_source.html#l00241">Type.cpp:241</a></div></div>
<div class="ttc" id="classllvm_1_1LoopBase_html_a990a86b0de7a84a9f489d2034878e330"><div class="ttname"><a href="classllvm_1_1LoopBase.html#a990a86b0de7a84a9f489d2034878e330">llvm::LoopBase::addChildLoop</a></div><div class="ttdeci">void addChildLoop(LoopT *NewChild)</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l00252">LoopInfo.h:252</a></div></div>
<div class="ttc" id="Value_8h_html"><div class="ttname"><a href="Value_8h.html">Value.h</a></div></div>
<div class="ttc" id="classllvm_1_1Loop_html"><div class="ttname"><a href="classllvm_1_1Loop.html">llvm::Loop</a></div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l00338">LoopInfo.h:338</a></div></div>
<div class="ttc" id="classllvm_1_1LoadInst_html_ad1168fc42bcba1b71217a4969483671a"><div class="ttname"><a href="classllvm_1_1LoadInst.html#ad1168fc42bcba1b71217a4969483671a">llvm::LoadInst::getAlignment</a></div><div class="ttdeci">unsigned getAlignment() const </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00181">Instructions.h:181</a></div></div>
<div class="ttc" id="namespacellvm_1_1Intrinsic_html_a73349916f7e54a6b988a3646c7a02e90ae5cfc8e1a94b46b64a26f1a6cb4e6ba0"><div class="ttname"><a href="namespacellvm_1_1Intrinsic.html#a73349916f7e54a6b988a3646c7a02e90ae5cfc8e1a94b46b64a26f1a6cb4e6ba0">llvm::Intrinsic::fabs</a></div><div class="ttdef"><b>Definition:</b> <a href="Intrinsics_8h_source.html#l00389">Intrinsics.h:389</a></div></div>
<div class="ttc" id="namespacellvm_1_1LibFunc_html_abf8f6830387f338fed0bce2e65108c6fa56063a1f5d567e59c1b1dbdd82307afc"><div class="ttname"><a href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fa56063a1f5d567e59c1b1dbdd82307afc">llvm::LibFunc::floor</a></div><div class="ttdoc">double floor(double x); </div><div class="ttdef"><b>Definition:</b> <a href="TargetLibraryInfo_8h_source.html#l00249">TargetLibraryInfo.h:249</a></div></div>
<div class="ttc" id="Target_2ARM_2README_8txt_html_a38e79c83dad9b9a5f38c9693371a8709"><div class="ttname"><a href="Target_2ARM_2README_8txt.html#a38e79c83dad9b9a5f38c9693371a8709">p</a></div><div class="ttdeci">the resulting code requires compare and branches when and if * p</div><div class="ttdef"><b>Definition:</b> <a href="Target_2ARM_2README_8txt_source.html#l00396">Target/ARM/README.txt:396</a></div></div>
<div class="ttc" id="MD5_8cpp_html_ac0eafdc9ee161b71e7af98af736952fd"><div class="ttname"><a href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a></div><div class="ttdeci">#define I(x, y, z)</div><div class="ttdef"><b>Definition:</b> <a href="MD5_8cpp_source.html#l00054">MD5.cpp:54</a></div></div>
<div class="ttc" id="classllvm_1_1BasicBlock_html_a5cb76a65b6524dba1493dd2b9dc3abbe"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a5cb76a65b6524dba1493dd2b9dc3abbe">llvm::BasicBlock::getTerminator</a></div><div class="ttdeci">TerminatorInst * getTerminator()</div><div class="ttdoc">Returns the terminator instruction if the block is well formed or null if the block is not well forme...</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8cpp_source.html#l00120">BasicBlock.cpp:120</a></div></div>
<div class="ttc" id="classllvm_1_1Value_html_a085b82f074c28030fb8e194377ed2d0c"><div class="ttname"><a href="classllvm_1_1Value.html#a085b82f074c28030fb8e194377ed2d0c">llvm::Value::hasOneUse</a></div><div class="ttdeci">bool hasOneUse() const </div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00161">Value.h:161</a></div></div>
<div class="ttc" id="LoopVectorize_8cpp_html_a4888997ffd62d30edefde5170b33f854"><div class="ttname"><a href="LoopVectorize_8cpp.html#a4888997ffd62d30edefde5170b33f854">SmallLoopCost</a></div><div class="ttdeci">static const unsigned SmallLoopCost</div><div class="ttdoc">The cost of a loop that is considered &amp;#39;small&amp;#39; by the unroller. </div><div class="ttdef"><b>Definition:</b> <a href="LoopVectorize_8cpp_source.html#l00131">LoopVectorize.cpp:131</a></div></div>
<div class="ttc" id="namespacellvm_1_1PatternMatch_html_a38a6a25e425f94c9836dda96f3718593"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#a38a6a25e425f94c9836dda96f3718593">llvm::PatternMatch::m_SMax</a></div><div class="ttdeci">MaxMin_match&lt; ICmpInst, LHS, RHS, smax_pred_ty &gt; m_SMax(const LHS &amp;L, const RHS &amp;R)</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l00940">PatternMatch.h:940</a></div></div>
<div class="ttc" id="BasicBlockUtils_8h_html"><div class="ttname"><a href="BasicBlockUtils_8h.html">BasicBlockUtils.h</a></div></div>
<div class="ttc" id="classllvm_1_1SmallVectorTemplateBase_html_a1f2303df9bbee2233c11d61c2f6f7930"><div class="ttname"><a href="classllvm_1_1SmallVectorTemplateBase.html#a1f2303df9bbee2233c11d61c2f6f7930">llvm::SmallVectorTemplateBase&lt; T, isPodLike&lt; T &gt;::value &gt;::pop_back</a></div><div class="ttdeci">void pop_back()</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00260">SmallVector.h:260</a></div></div>
<div class="ttc" id="classllvm_1_1Type_html_a8eafa71cf399da8f21b2af5549f3f9e7"><div class="ttname"><a href="classllvm_1_1Type.html#a8eafa71cf399da8f21b2af5549f3f9e7">llvm::Type::getScalarType</a></div><div class="ttdeci">const Type * getScalarType() const </div><div class="ttdef"><b>Definition:</b> <a href="Type_8cpp_source.html#l00051">Type.cpp:51</a></div></div>
<div class="ttc" id="ValueTracking_8h_html"><div class="ttname"><a href="ValueTracking_8h.html">ValueTracking.h</a></div></div>
<div class="ttc" id="classllvm_1_1TargetTransformInfo_html_afa38851d75434d1476444ac93f94cb4ca76d8855d96b8e66b9411ed74737ca8f7"><div class="ttname"><a href="classllvm_1_1TargetTransformInfo.html#afa38851d75434d1476444ac93f94cb4ca76d8855d96b8e66b9411ed74737ca8f7">llvm::TargetTransformInfo::OK_UniformConstantValue</a></div><div class="ttdef"><b>Definition:</b> <a href="TargetTransformInfo_8h_source.html#l00321">TargetTransformInfo.h:321</a></div></div>
<div class="ttc" id="classllvm_1_1Type_html_a5a7cfa245af120b44ac8a86143bb9e57"><div class="ttname"><a href="classllvm_1_1Type.html#a5a7cfa245af120b44ac8a86143bb9e57">llvm::Type::getPrimitiveSizeInBits</a></div><div class="ttdeci">unsigned getPrimitiveSizeInBits() const </div><div class="ttdef"><b>Definition:</b> <a href="Type_8cpp_source.html#l00117">Type.cpp:117</a></div></div>
<div class="ttc" id="classllvm_1_1SCEVAddRecExpr_html_a7fcbbc51eef313e675a2442bb2053ae9"><div class="ttname"><a href="classllvm_1_1SCEVAddRecExpr.html#a7fcbbc51eef313e675a2442bb2053ae9">llvm::SCEVAddRecExpr::getLoop</a></div><div class="ttdeci">const Loop * getLoop() const </div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolutionExpressions_8h_source.html#l00294">ScalarEvolutionExpressions.h:294</a></div></div>
<div class="ttc" id="classllvm_1_1BasicBlock_html_a19445f836d9e1ecb32cba27ec4338fff"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a19445f836d9e1ecb32cba27ec4338fff">llvm::BasicBlock::splitBasicBlock</a></div><div class="ttdeci">BasicBlock * splitBasicBlock(iterator I, const Twine &amp;BBName=&quot;&quot;)</div><div class="ttdoc">Split the basic block into two basic blocks at the specified instruction. </div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8cpp_source.html#l00298">BasicBlock.cpp:298</a></div></div>
<div class="ttc" id="classllvm_1_1DataLayout_html_a4b979cd93852fd44c48851c94ee00758"><div class="ttname"><a href="classllvm_1_1DataLayout.html#a4b979cd93852fd44c48851c94ee00758">llvm::DataLayout::getTypeStoreSize</a></div><div class="ttdeci">uint64_t getTypeStoreSize(Type *Ty) const </div><div class="ttdef"><b>Definition:</b> <a href="DataLayout_8h_source.html#l00311">DataLayout.h:311</a></div></div>
<div class="ttc" id="classllvm_1_1GlobalValue_html_abefc2d8baa67d6f9e49c95912cfde480"><div class="ttname"><a href="classllvm_1_1GlobalValue.html#abefc2d8baa67d6f9e49c95912cfde480">llvm::GlobalValue::hasLocalLinkage</a></div><div class="ttdeci">bool hasLocalLinkage() const </div><div class="ttdef"><b>Definition:</b> <a href="GlobalValue_8h_source.html#l00211">GlobalValue.h:211</a></div></div>
<div class="ttc" id="IRBuilder_8h_html"><div class="ttname"><a href="IRBuilder_8h.html">IRBuilder.h</a></div></div>
<div class="ttc" id="classllvm_1_1LoopBlocksDFS_html_a68caba9c5912b27ddbf05e2541ec4aaf"><div class="ttname"><a href="classllvm_1_1LoopBlocksDFS.html#a68caba9c5912b27ddbf05e2541ec4aaf">llvm::LoopBlocksDFS::beginRPO</a></div><div class="ttdeci">RPOIterator beginRPO() const </div><div class="ttdoc">Reverse iterate over the cached postorder blocks. </div><div class="ttdef"><b>Definition:</b> <a href="LoopIterator_8h_source.html#l00077">LoopIterator.h:77</a></div></div>
<div class="ttc" id="classllvm_1_1AttributeSet_html_a9a03295702933e2d98be92202fe403f9"><div class="ttname"><a href="classllvm_1_1AttributeSet.html#a9a03295702933e2d98be92202fe403f9">llvm::AttributeSet::getAttribute</a></div><div class="ttdeci">Attribute getAttribute(unsigned Index, Attribute::AttrKind Kind) const </div><div class="ttdoc">Return the attribute object that exists at the given index. </div><div class="ttdef"><b>Definition:</b> <a href="Attributes_8cpp_source.html#l00847">Attributes.cpp:847</a></div></div>
<div class="ttc" id="classllvm_1_1MapVector_html_aa610cab7ee61e36a6d1d122fc252c278"><div class="ttname"><a href="classllvm_1_1MapVector.html#aa610cab7ee61e36a6d1d122fc252c278">llvm::MapVector::begin</a></div><div class="ttdeci">iterator begin()</div><div class="ttdef"><b>Definition:</b> <a href="MapVector_8h_source.html#l00047">MapVector.h:47</a></div></div>
<div class="ttc" id="namespacellvm_1_1Intrinsic_html_a73349916f7e54a6b988a3646c7a02e90aab5fb650050f184fa7c19c26abde5226"><div class="ttname"><a href="namespacellvm_1_1Intrinsic.html#a73349916f7e54a6b988a3646c7a02e90aab5fb650050f184fa7c19c26abde5226">llvm::Intrinsic::not_intrinsic</a></div><div class="ttdef"><b>Definition:</b> <a href="Intrinsics_8h_source.html#l00037">Intrinsics.h:37</a></div></div>
<div class="ttc" id="classllvm_1_1CmpInst_html_a283f9a5d4d843d20c40bb4d3e364bb05aa719225e2de4059f93fd3209e1f48218"><div class="ttname"><a href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05aa719225e2de4059f93fd3209e1f48218">llvm::CmpInst::ICMP_EQ</a></div><div class="ttdoc">equal </div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00672">InstrTypes.h:672</a></div></div>
<div class="ttc" id="LLVMContext_8h_html"><div class="ttname"><a href="LLVMContext_8h.html">LLVMContext.h</a></div></div>
<div class="ttc" id="SetVector_8h_html"><div class="ttname"><a href="SetVector_8h.html">SetVector.h</a></div></div>
<div class="ttc" id="classllvm_1_1ScalarEvolution_html_aecd7aba4460358813feef37d71d5024e"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html#aecd7aba4460358813feef37d71d5024e">llvm::ScalarEvolution::getBackedgeTakenCount</a></div><div class="ttdeci">const SCEV * getBackedgeTakenCount(const Loop *L)</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8cpp_source.html#l04062">ScalarEvolution.cpp:4062</a></div></div>
<div class="ttc" id="classllvm_1_1Attribute_html_ade69a27a314332bc6e8f36d72a05d0aa"><div class="ttname"><a href="classllvm_1_1Attribute.html#ade69a27a314332bc6e8f36d72a05d0aa">llvm::Attribute::getValueAsString</a></div><div class="ttdeci">StringRef getValueAsString() const </div><div class="ttdoc">Return the attribute&amp;#39;s value as a string. This requires the attribute to be a string attribute...</div><div class="ttdef"><b>Definition:</b> <a href="Attributes_8cpp_source.html#l00127">Attributes.cpp:127</a></div></div>
<div class="ttc" id="classllvm_1_1Value_html_ac38c53f76ef532f91f1666c8a87370e9"><div class="ttname"><a href="classllvm_1_1Value.html#ac38c53f76ef532f91f1666c8a87370e9">llvm::Value::use_empty</a></div><div class="ttdeci">bool use_empty() const </div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00149">Value.h:149</a></div></div>
<div class="ttc" id="namespacellvm_1_1Intrinsic_html_a73349916f7e54a6b988a3646c7a02e90af387c9295462cb7394f13fc3b9276dc0"><div class="ttname"><a href="namespacellvm_1_1Intrinsic.html#a73349916f7e54a6b988a3646c7a02e90af387c9295462cb7394f13fc3b9276dc0">llvm::Intrinsic::pow</a></div><div class="ttdef"><b>Definition:</b> <a href="Intrinsics_8h_source.html#l02216">Intrinsics.h:2216</a></div></div>
<div class="ttc" id="namespacellvm_1_1LibFunc_html_abf8f6830387f338fed0bce2e65108c6fa57aee1773b8300e2ad207948eaffd566"><div class="ttname"><a href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fa57aee1773b8300e2ad207948eaffd566">llvm::LibFunc::sinf</a></div><div class="ttdoc">float sinf(float x); </div><div class="ttdef"><b>Definition:</b> <a href="TargetLibraryInfo_8h_source.html#l00497">TargetLibraryInfo.h:497</a></div></div>
<div class="ttc" id="classllvm_1_1MapVector_html_a0881334358ff6ff7ff8cea5562c7988e"><div class="ttname"><a href="classllvm_1_1MapVector.html#a0881334358ff6ff7ff8cea5562c7988e">llvm::MapVector::end</a></div><div class="ttdeci">iterator end()</div><div class="ttdef"><b>Definition:</b> <a href="MapVector_8h_source.html#l00055">MapVector.h:55</a></div></div>
<div class="ttc" id="Local_8h_html"><div class="ttname"><a href="Local_8h.html">Local.h</a></div></div>
<div class="ttc" id="classllvm_1_1User_html_a40df11649fb4c41a4de49f793c2d231f"><div class="ttname"><a href="classllvm_1_1User.html#a40df11649fb4c41a4de49f793c2d231f">llvm::User::op_iterator</a></div><div class="ttdeci">Use * op_iterator</div><div class="ttdef"><b>Definition:</b> <a href="User_8h_source.html#l00113">User.h:113</a></div></div>
<div class="ttc" id="classllvm_1_1BasicBlock_html_ad652423d9d91271ba153eb86482b2f55"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#ad652423d9d91271ba153eb86482b2f55">llvm::BasicBlock::getContext</a></div><div class="ttdeci">LLVMContext &amp; getContext() const </div><div class="ttdoc">Get the context in which this basic block lives. </div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8cpp_source.html#l00033">BasicBlock.cpp:33</a></div></div>
<div class="ttc" id="namespacellvm_1_1PatternMatch_html_a235364424b2c4c8261f4030681d9630b"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#a235364424b2c4c8261f4030681d9630b">llvm::PatternMatch::m_OrdFMax</a></div><div class="ttdeci">MaxMin_match&lt; FCmpInst, LHS, RHS, ofmax_pred_ty &gt; m_OrdFMax(const LHS &amp;L, const RHS &amp;R)</div><div class="ttdoc">Match an &amp;#39;ordered&amp;#39; floating point maximum function. Floating point has one special value &amp;#39;NaN&amp;#39;...</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l00973">PatternMatch.h:973</a></div></div>
<div class="ttc" id="classllvm_1_1GlobalValue_html_a9e1fc23a17e97d2d1732e753ae9251ac"><div class="ttname"><a href="classllvm_1_1GlobalValue.html#a9e1fc23a17e97d2d1732e753ae9251ac">llvm::GlobalValue::getParent</a></div><div class="ttdeci">Module * getParent()</div><div class="ttdef"><b>Definition:</b> <a href="GlobalValue_8h_source.html#l00286">GlobalValue.h:286</a></div></div>
<div class="ttc" id="classllvm_1_1Value_html"><div class="ttname"><a href="classllvm_1_1Value.html">llvm::Value</a></div><div class="ttdoc">LLVM Value Representation. </div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00066">Value.h:66</a></div></div>
<div class="ttc" id="classllvm_1_1EquivalenceClasses_html_aa00be6d847dfe5d62c7aa570d4a70584"><div class="ttname"><a href="classllvm_1_1EquivalenceClasses.html#aa00be6d847dfe5d62c7aa570d4a70584">llvm::EquivalenceClasses::getLeaderValue</a></div><div class="ttdeci">const ElemTy &amp; getLeaderValue(const ElemTy &amp;V) const </div><div class="ttdef"><b>Definition:</b> <a href="EquivalenceClasses_8h_source.html#l00165">EquivalenceClasses.h:165</a></div></div>
<div class="ttc" id="classllvm_1_1BinaryOperator_html_a5b6cd6c043f54b40899aff62e6e40488"><div class="ttname"><a href="classllvm_1_1BinaryOperator.html#a5b6cd6c043f54b40899aff62e6e40488">llvm::BinaryOperator::hasNoUnsignedWrap</a></div><div class="ttdeci">bool hasNoUnsignedWrap() const </div><div class="ttdoc">hasNoUnsignedWrap - Determine whether the no unsigned wrap flag is set. </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8cpp_source.html#l02009">Instructions.cpp:2009</a></div></div>
<div class="ttc" id="classllvm_1_1DenseMapBase_html_acfd7cc74125222a81c02b4097ed5166c"><div class="ttname"><a href="classllvm_1_1DenseMapBase.html#acfd7cc74125222a81c02b4097ed5166c">llvm::DenseMapBase&lt; SmallDenseMap&lt; KeyT, ValueT, InlineBuckets, KeyInfoT &gt;, KeyT, ValueT, KeyInfoT &gt;::lookup</a></div><div class="ttdeci">ValueT lookup(const KeyT &amp;Val) const</div><div class="ttdef"><b>Definition:</b> <a href="DenseMap_8h_source.html#l00143">DenseMap.h:143</a></div></div>
<div class="ttc" id="classllvm_1_1ScalarEvolution_html_a30bd18ac905eacf3601bc6a553a9ff49"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html#a30bd18ac905eacf3601bc6a553a9ff49">llvm::ScalarEvolution::getSCEV</a></div><div class="ttdeci">const SCEV * getSCEV(Value *V)</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8cpp_source.html#l02742">ScalarEvolution.cpp:2742</a></div></div>
<div class="ttc" id="classllvm_1_1Instruction_html_a021bb7c9aad6003fe8089f6327356c6c"><div class="ttname"><a href="classllvm_1_1Instruction.html#a021bb7c9aad6003fe8089f6327356c6c">llvm::Instruction::getOpcode</a></div><div class="ttdeci">unsigned getOpcode() const </div><div class="ttdoc">getOpcode() returns a member of one of the enums like Instruction::Add. </div><div class="ttdef"><b>Definition:</b> <a href="Instruction_8h_source.html#l00083">Instruction.h:83</a></div></div>
<div class="ttc" id="Target_2X86_2README_8txt_html_ac88fe1d3a61b056a4f64fbbb156a62ff"><div class="ttname"><a href="Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a></div><div class="ttdeci">We currently emits eax Perhaps this is what we really should generate is Is imull three or four cycles eax eax The current instruction priority is based on pattern complexity The former is more complex because it folds a load so the latter will not be emitted Perhaps we should use AddedComplexity to give LEA32r a higher priority We should always try to match LEA first since the LEA matching code does some estimate to determine whether the match is profitable if we care more about code then imull is better It s two bytes shorter than movl leal On a Pentium M</div><div class="ttdef"><b>Definition:</b> <a href="Target_2X86_2README_8txt_source.html#l00297">Target/X86/README.txt:297</a></div></div>
<div class="ttc" id="classllvm_1_1SetVector_html"><div class="ttname"><a href="classllvm_1_1SetVector.html">llvm::SetVector</a></div><div class="ttdoc">A vector that has set insertion semantics. </div><div class="ttdef"><b>Definition:</b> <a href="SetVector_8h_source.html#l00037">SetVector.h:37</a></div></div>
<div class="ttc" id="classllvm_1_1VectorType_html_ab43657ed1abe2e2ed3a6a394f233ebd0"><div class="ttname"><a href="classllvm_1_1VectorType.html#ab43657ed1abe2e2ed3a6a394f233ebd0">llvm::VectorType::get</a></div><div class="ttdeci">static VectorType * get(Type *ElementType, unsigned NumElements)</div><div class="ttdef"><b>Definition:</b> <a href="Type_8cpp_source.html#l00706">Type.cpp:706</a></div></div>
<div class="ttc" id="namespacellvm_1_1Intrinsic_html_a73349916f7e54a6b988a3646c7a02e90ab4c5fed3774fc563c9b252d3483f56d2"><div class="ttname"><a href="namespacellvm_1_1Intrinsic.html#a73349916f7e54a6b988a3646c7a02e90ab4c5fed3774fc563c9b252d3483f56d2">llvm::Intrinsic::fma</a></div><div class="ttdef"><b>Definition:</b> <a href="Intrinsics_8h_source.html#l00392">Intrinsics.h:392</a></div></div>
<div class="ttc" id="SmallVector_8h_html"><div class="ttname"><a href="SmallVector_8h.html">SmallVector.h</a></div></div>
<div class="ttc" id="classllvm_1_1Attribute_html_aab7ee4b8fd1d3e7e4cea87868855e60ea9e330fa070dd4bb79cbc6c74b41958a4"><div class="ttname"><a href="classllvm_1_1Attribute.html#aab7ee4b8fd1d3e7e4cea87868855e60ea9e330fa070dd4bb79cbc6c74b41958a4">llvm::Attribute::NoImplicitFloat</a></div><div class="ttdoc">Disable implicit floating point insts. </div><div class="ttdef"><b>Definition:</b> <a href="Attributes_8h_source.html#l00084">Attributes.h:84</a></div></div>
<div class="ttc" id="namespacellvm_1_1LibFunc_html_abf8f6830387f338fed0bce2e65108c6fa59bb423c84bc9293df624f68bad35332"><div class="ttname"><a href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fa59bb423c84bc9293df624f68bad35332">llvm::LibFunc::exp2l</a></div><div class="ttdoc">long double exp2l(long double x); </div><div class="ttdef"><b>Definition:</b> <a href="TargetLibraryInfo_8h_source.html#l00203">TargetLibraryInfo.h:203</a></div></div>
<div class="ttc" id="LoopIterator_8h_html"><div class="ttname"><a href="LoopIterator_8h.html">LoopIterator.h</a></div></div>
<div class="ttc" id="classllvm_1_1DataLayout_html_add914112e0b2935dda06ad5dfd3a31db"><div class="ttname"><a href="classllvm_1_1DataLayout.html#add914112e0b2935dda06ad5dfd3a31db">llvm::DataLayout::getTypeSizeInBits</a></div><div class="ttdeci">uint64_t getTypeSizeInBits(Type *Ty) const </div><div class="ttdef"><b>Definition:</b> <a href="DataLayout_8h_source.html#l00459">DataLayout.h:459</a></div></div>
<div class="ttc" id="namespacellvm_1_1LibFunc_html_abf8f6830387f338fed0bce2e65108c6fa1e752b4eaa4c9db56a2bbcef82f934b9"><div class="ttname"><a href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fa1e752b4eaa4c9db56a2bbcef82f934b9">llvm::LibFunc::exp2</a></div><div class="ttdoc">double exp2(double x); </div><div class="ttdef"><b>Definition:</b> <a href="TargetLibraryInfo_8h_source.html#l00199">TargetLibraryInfo.h:199</a></div></div>
<div class="ttc" id="LoopVectorize_8cpp_html_ad06e389b36de2016de0913f2d112954d"><div class="ttname"><a href="LoopVectorize_8cpp.html#ad06e389b36de2016de0913f2d112954d">TinyTripCountUnrollThreshold</a></div><div class="ttdeci">static const unsigned TinyTripCountUnrollThreshold</div><div class="ttdoc">We don&amp;#39;t unroll loops with a known constant trip count below this number. </div><div class="ttdef"><b>Definition:</b> <a href="LoopVectorize_8cpp_source.html#l00118">LoopVectorize.cpp:118</a></div></div>
<div class="ttc" id="Debug_8h_html_aef41e8aaf4c60819b30faf396cdf4978"><div class="ttname"><a href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a></div><div class="ttdeci">#define DEBUG(X)</div><div class="ttdef"><b>Definition:</b> <a href="Debug_8h_source.html#l00097">Debug.h:97</a></div></div>
<div class="ttc" id="LoopVectorize_8cpp_html_a7db5de6d612f2730abd7aa99a724615a"><div class="ttname"><a href="LoopVectorize_8cpp.html#a7db5de6d612f2730abd7aa99a724615a">VectorizationFactor</a></div><div class="ttdeci">static cl::opt&lt; unsigned &gt; VectorizationFactor(&quot;force-vector-width&quot;, cl::init(0), cl::Hidden, cl::desc(&quot;Sets the SIMD width. Zero is autoselect.&quot;))</div></div>
<div class="ttc" id="namespacellvm_html_af4d1a918800291e75b01ce1447be0e83"><div class="ttname"><a href="namespacellvm.html#af4d1a918800291e75b01ce1447be0e83">llvm::isPowerOf2_32</a></div><div class="ttdeci">bool isPowerOf2_32(uint32_t Value)</div><div class="ttdef"><b>Definition:</b> <a href="MathExtras_8h_source.html#l00354">MathExtras.h:354</a></div></div>
<div class="ttc" id="classllvm_1_1CmpInst_html_a283f9a5d4d843d20c40bb4d3e364bb05a607cecdc5172814382033e001ed11fad"><div class="ttname"><a href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05a607cecdc5172814382033e001ed11fad">llvm::CmpInst::ICMP_UGT</a></div><div class="ttdoc">unsigned greater than </div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00674">InstrTypes.h:674</a></div></div>
<div class="ttc" id="classllvm_1_1TargetTransformInfo_html_afa38851d75434d1476444ac93f94cb4c"><div class="ttname"><a href="classllvm_1_1TargetTransformInfo.html#afa38851d75434d1476444ac93f94cb4c">llvm::TargetTransformInfo::OperandValueKind</a></div><div class="ttdeci">OperandValueKind</div><div class="ttdoc">Additional information about an operand&amp;#39;s possible values. </div><div class="ttdef"><b>Definition:</b> <a href="TargetTransformInfo_8h_source.html#l00318">TargetTransformInfo.h:318</a></div></div>
<div class="ttc" id="classllvm_1_1StringRef_html"><div class="ttname"><a href="classllvm_1_1StringRef.html">llvm::StringRef</a></div><div class="ttdef"><b>Definition:</b> <a href="StringRef_8h_source.html#l00041">StringRef.h:41</a></div></div>
<div class="ttc" id="classllvm_1_1MDString_html"><div class="ttname"><a href="classllvm_1_1MDString.html">llvm::MDString</a></div><div class="ttdef"><b>Definition:</b> <a href="Metadata_8h_source.html#l00039">Metadata.h:39</a></div></div>
<div class="ttc" id="namespacellvm_html_a691b42b1b319ffdde8a8394c38627c63"><div class="ttname"><a href="namespacellvm.html#a691b42b1b319ffdde8a8394c38627c63">llvm::isNoAliasArgument</a></div><div class="ttdeci">bool isNoAliasArgument(const Value *V)</div><div class="ttdef"><b>Definition:</b> <a href="AliasAnalysis_8cpp_source.html#l00532">AliasAnalysis.cpp:532</a></div></div>
<div class="ttc" id="raw__ostream_8h_html"><div class="ttname"><a href="raw__ostream_8h.html">raw_ostream.h</a></div></div>
<div class="ttc" id="TargetTransformInfo_8h_html"><div class="ttname"><a href="TargetTransformInfo_8h.html">TargetTransformInfo.h</a></div></div>
<div class="ttc" id="namespacellvm_1_1SPII_html_a11e9b8fca4a074643a6a21f444e51406a36b3dd3b84fde3f8494a9b18af131856"><div class="ttname"><a href="namespacellvm_1_1SPII.html#a11e9b8fca4a074643a6a21f444e51406a36b3dd3b84fde3f8494a9b18af131856">llvm::SPII::Store</a></div><div class="ttdef"><b>Definition:</b> <a href="SparcInstrInfo_8h_source.html#l00032">SparcInstrInfo.h:32</a></div></div>
<div class="ttc" id="classllvm_1_1BasicBlock_html_ab1cd5a3713b93a33f89a2086d473cf6e"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#ab1cd5a3713b93a33f89a2086d473cf6e">llvm::BasicBlock::getFirstInsertionPt</a></div><div class="ttdeci">iterator getFirstInsertionPt()</div><div class="ttdoc">Returns an iterator to the first instruction in this block that is suitable for inserting a non-PHI i...</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8cpp_source.html#l00170">BasicBlock.cpp:170</a></div></div>
<div class="ttc" id="LoopVectorize_8cpp_html_af650b172bfef38ac60047721430fe7d9"><div class="ttname"><a href="LoopVectorize_8cpp.html#af650b172bfef38ac60047721430fe7d9">areAllUsesIn</a></div><div class="ttdeci">static bool areAllUsesIn(Instruction *I, SmallPtrSet&lt; Instruction *, 8 &gt; &amp;Set)</div><div class="ttdef"><b>Definition:</b> <a href="LoopVectorize_8cpp_source.html#l04059">LoopVectorize.cpp:4059</a></div></div>
<div class="ttc" id="classllvm_1_1PHINode_html_a88cdefb709309eddc6e5daca0be6a7b4"><div class="ttname"><a href="classllvm_1_1PHINode.html#a88cdefb709309eddc6e5daca0be6a7b4">llvm::PHINode::setIncomingValue</a></div><div class="ttdeci">void setIncomingValue(unsigned i, Value *V)</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02062">Instructions.h:2062</a></div></div>
<div class="ttc" id="namespacellvm_1_1LibFunc_html_abf8f6830387f338fed0bce2e65108c6fa859af3ad03ff3b3116d2158c652fbab9"><div class="ttname"><a href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fa859af3ad03ff3b3116d2158c652fbab9">llvm::LibFunc::powl</a></div><div class="ttdoc">long double powl(long double x, long double y); </div><div class="ttdef"><b>Definition:</b> <a href="TargetLibraryInfo_8h_source.html#l00438">TargetLibraryInfo.h:438</a></div></div>
<div class="ttc" id="Target_2ARM_2README_8txt_html_a90cca76dd78688687e0d697679dbc799"><div class="ttname"><a href="Target_2ARM_2README_8txt.html#a90cca76dd78688687e0d697679dbc799">B</a></div><div class="ttdeci">compiles ldr LCPI1_0 ldr ldr mov lsr tst moveq r1 ldr LCPI1_1 and r0 bx lr It would be better to do something like to fold the shift into the conditional ldr LCPI1_0 ldr ldr tst movne lsr ldr LCPI1_1 and r0 bx lr it saves an instruction and a register It might be profitable to cse MOVi16 if there are lots of bit immediates with the same bottom half Robert Muth started working on an alternate jump table implementation that does not put the tables in line in the text This is more like the llvm default jump table implementation This might be useful sometime Several revisions of patches are on the mailing beginning while CMP sets them like a subtract Therefore to be able to use CMN for comparisons other than the Z we ll need additional logic to reverse the conditionals associated with the comparison Perhaps a pseudo instruction for the with a post codegen pass to clean up and handle the condition codes See PR5694 for testcase Given the following on int B</div><div class="ttdef"><b>Definition:</b> <a href="Target_2ARM_2README_8txt_source.html#l00592">Target/ARM/README.txt:592</a></div></div>
<div class="ttc" id="namespacellvm_1_1LibFunc_html_abf8f6830387f338fed0bce2e65108c6fa6ec6b6b12fc6ba736e06a66d72311cd8"><div class="ttname"><a href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fa6ec6b6b12fc6ba736e06a66d72311cd8">llvm::LibFunc::copysignf</a></div><div class="ttdoc">float copysignf(float x, float y); </div><div class="ttdef"><b>Definition:</b> <a href="TargetLibraryInfo_8h_source.html#l00173">TargetLibraryInfo.h:173</a></div></div>
<div class="ttc" id="classllvm_1_1StoreInst_html_ac03c1c093059ea000216af8dd6f2dbf4"><div class="ttname"><a href="classllvm_1_1StoreInst.html#ac03c1c093059ea000216af8dd6f2dbf4">llvm::StoreInst::getPointerOperand</a></div><div class="ttdeci">Value * getPointerOperand()</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00346">Instructions.h:346</a></div></div>
<div class="ttc" id="classllvm_1_1PHINode_html_a5c2b7d7f19aac93b27b845858a7eb73e"><div class="ttname"><a href="classllvm_1_1PHINode.html#a5c2b7d7f19aac93b27b845858a7eb73e">llvm::PHINode::getBasicBlockIndex</a></div><div class="ttdeci">int getBasicBlockIndex(const BasicBlock *BB) const </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02132">Instructions.h:2132</a></div></div>
<div class="ttc" id="classllvm_1_1Instruction_html_a9cd49851904f15060edb782ef4dd1b2d"><div class="ttname"><a href="classllvm_1_1Instruction.html#a9cd49851904f15060edb782ef4dd1b2d">llvm::Instruction::getParent</a></div><div class="ttdeci">const BasicBlock * getParent() const </div><div class="ttdef"><b>Definition:</b> <a href="Instruction_8h_source.html#l00052">Instruction.h:52</a></div></div>
<div class="ttc" id="README-SSE_8txt_html_abb4ce3bc3096a12d4b93460bf78bcf95"><div class="ttname"><a href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a></div><div class="ttdeci">into xmm2 addss xmm2 xmm1 xmm3 addss xmm3 movaps xmm0 unpcklps xmm0 ret seems silly when it could just be one addps Expand libm rounding functions main should enable SSE DAZ mode and other fast SSE modes Think about doing i64 math in SSE regs on x86 This testcase should have no SSE instructions in it</div><div class="ttdef"><b>Definition:</b> <a href="README-SSE_8txt_source.html#l00053">README-SSE.txt:53</a></div></div>
<div class="ttc" id="classllvm_1_1LoopBase_html_ab191396dd1d8556d8e0a057f7fd2aaab"><div class="ttname"><a href="classllvm_1_1LoopBase.html#ab191396dd1d8556d8e0a057f7fd2aaab">llvm::LoopBase::empty</a></div><div class="ttdeci">bool empty() const </div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l00134">LoopInfo.h:134</a></div></div>
<div class="ttc" id="namespacellvm_1_1Intrinsic_html_a73349916f7e54a6b988a3646c7a02e90ae365354e47542c51f9bd46e329e3323e"><div class="ttname"><a href="namespacellvm_1_1Intrinsic.html#a73349916f7e54a6b988a3646c7a02e90ae365354e47542c51f9bd46e329e3323e">llvm::Intrinsic::lifetime_start</a></div><div class="ttdef"><b>Definition:</b> <a href="Intrinsics_8h_source.html#l01255">Intrinsics.h:1255</a></div></div>
<div class="ttc" id="classllvm_1_1LPPassManager_html"><div class="ttname"><a href="classllvm_1_1LPPassManager.html">llvm::LPPassManager</a></div><div class="ttdef"><b>Definition:</b> <a href="LoopPass_8h_source.html#l00086">LoopPass.h:86</a></div></div>
<div class="ttc" id="classllvm_1_1LoopBlocksDFS_html_a7d9c121f1346f2c68017838acb57c7e8"><div class="ttname"><a href="classllvm_1_1LoopBlocksDFS.html#a7d9c121f1346f2c68017838acb57c7e8">llvm::LoopBlocksDFS::endRPO</a></div><div class="ttdeci">RPOIterator endRPO() const </div><div class="ttdef"><b>Definition:</b> <a href="LoopIterator_8h_source.html#l00081">LoopIterator.h:81</a></div></div>
<div class="ttc" id="LoopVectorize_8cpp_html_afe0ea5914ce503bf3a5bb91bd84f3ba6"><div class="ttname"><a href="LoopVectorize_8cpp.html#afe0ea5914ce503bf3a5bb91bd84f3ba6">hasComputableBounds</a></div><div class="ttdeci">static bool hasComputableBounds(ScalarEvolution *SE, Value *Ptr)</div><div class="ttdoc">Check whether a pointer can participate in a runtime bounds check. </div><div class="ttdef"><b>Definition:</b> <a href="LoopVectorize_8cpp_source.html#l03241">LoopVectorize.cpp:3241</a></div></div>
<div class="ttc" id="namespacellvm_1_1Intrinsic_html_a73349916f7e54a6b988a3646c7a02e90a6956cc565c902dea387b502b54fa9f18"><div class="ttname"><a href="namespacellvm_1_1Intrinsic.html#a73349916f7e54a6b988a3646c7a02e90a6956cc565c902dea387b502b54fa9f18">llvm::Intrinsic::fmuladd</a></div><div class="ttdef"><b>Definition:</b> <a href="Intrinsics_8h_source.html#l00393">Intrinsics.h:393</a></div></div>
<div class="ttc" id="classllvm_1_1IntrinsicInst_html"><div class="ttname"><a href="classllvm_1_1IntrinsicInst.html">llvm::IntrinsicInst</a></div><div class="ttdef"><b>Definition:</b> <a href="IntrinsicInst_8h_source.html#l00036">IntrinsicInst.h:36</a></div></div>
<div class="ttc" id="classllvm_1_1Type_html_af5c7041df3ad5edffe5da17b5264c1fc"><div class="ttname"><a href="classllvm_1_1Type.html#af5c7041df3ad5edffe5da17b5264c1fc">llvm::Type::isVoidTy</a></div><div class="ttdeci">bool isVoidTy() const </div><div class="ttdoc">isVoidTy - Return true if this is &amp;#39;void&amp;#39;. </div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00140">Type.h:140</a></div></div>
<div class="ttc" id="classllvm_1_1SCEVConstant_html"><div class="ttname"><a href="classllvm_1_1SCEVConstant.html">llvm::SCEVConstant</a></div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolutionExpressions_8h_source.html#l00037">ScalarEvolutionExpressions.h:37</a></div></div>
<div class="ttc" id="classllvm_1_1Attribute_html_aab7ee4b8fd1d3e7e4cea87868855e60e"><div class="ttname"><a href="classllvm_1_1Attribute.html#aab7ee4b8fd1d3e7e4cea87868855e60e">llvm::Attribute::AttrKind</a></div><div class="ttdeci">AttrKind</div><div class="ttdef"><b>Definition:</b> <a href="Attributes_8h_source.html#l00064">Attributes.h:64</a></div></div>
<div class="ttc" id="namespacellvm_html_ac828b9b52935f87659a4adf237f820a3"><div class="ttname"><a href="namespacellvm.html#ac828b9b52935f87659a4adf237f820a3">llvm::gep_type_begin</a></div><div class="ttdeci">gep_type_iterator gep_type_begin(const User *GEP)</div><div class="ttdef"><b>Definition:</b> <a href="GetElementPtrTypeIterator_8h_source.html#l00085">GetElementPtrTypeIterator.h:85</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<hr>
<p class="footer">
Generated on Sat Nov 10 2018 22:59:42 for <a href="http://llvm.org/">LLVM</a> by
<a href="http://www.doxygen.org"><img src="doxygen.png" alt="Doxygen"
align="middle" border="0"/>1.8.11</a><br>
Copyright &copy; 2003-2013 University of Illinois at Urbana-Champaign.
All Rights Reserved.</p>
<hr>
<!--#include virtual="/attrib.incl" -->
</body>
</html>
