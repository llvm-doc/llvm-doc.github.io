<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head>
<meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1"/>
<meta name="keywords" content="LLVM,Low Level Virtual Machine,C++,doxygen,API,documentation"/>
<meta name="description" content="C++ source code API documentation for LLVM."/>
<title>LLVM: X86FloatingPoint.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head><body>
<p class="title">LLVM API Documentation</p>
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('X86FloatingPoint_8cpp_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">X86FloatingPoint.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="X86FloatingPoint_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//===-- X86FloatingPoint.cpp - Floating point Reg -&gt; Stack converter ------===//</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">//                     The LLVM Compiler Infrastructure</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// This file is distributed under the University of Illinois Open Source</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">// License. See LICENSE.TXT for details.</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">// This file defines the pass which converts floating point instructions from</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">// pseudo registers into register stack instructions.  This pass uses live</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">// variable information to indicate where the FPn registers are used and their</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">// lifetimes.</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">// The x87 hardware tracks liveness of the stack registers, so it is necessary</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">// to implement exact liveness tracking between basic blocks. The CFG edges are</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">// partitioned into bundles where the same FP registers must be live in</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">// identical stack positions. Instructions are inserted at the end of each basic</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">// block to rearrange the live registers to match the outgoing bundle.</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">// This approach avoids splitting critical edges at the potential cost of more</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">// live register shuffling instructions when critical edges are present.</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;</div><div class="line"><a name="l00026"></a><span class="lineno"><a class="line" href="X86FloatingPoint_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">   26</a></span>&#160;<span class="preprocessor">#define DEBUG_TYPE &quot;x86-codegen&quot;</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="X86_8h.html">X86.h</a>&quot;</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="X86InstrInfo_8h.html">X86InstrInfo.h</a>&quot;</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="DepthFirstIterator_8h.html">llvm/ADT/DepthFirstIterator.h</a>&quot;</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="STLExtras_8h.html">llvm/ADT/STLExtras.h</a>&quot;</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="SmallPtrSet_8h.html">llvm/ADT/SmallPtrSet.h</a>&quot;</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="SmallVector_8h.html">llvm/ADT/SmallVector.h</a>&quot;</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Statistic_8h.html">llvm/ADT/Statistic.h</a>&quot;</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="EdgeBundles_8h.html">llvm/CodeGen/EdgeBundles.h</a>&quot;</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="MachineFunctionPass_8h.html">llvm/CodeGen/MachineFunctionPass.h</a>&quot;</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="MachineInstrBuilder_8h.html">llvm/CodeGen/MachineInstrBuilder.h</a>&quot;</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="MachineRegisterInfo_8h.html">llvm/CodeGen/MachineRegisterInfo.h</a>&quot;</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="CodeGen_2Passes_8h.html">llvm/CodeGen/Passes.h</a>&quot;</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="InlineAsm_8h.html">llvm/IR/InlineAsm.h</a>&quot;</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Debug_8h.html">llvm/Support/Debug.h</a>&quot;</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ErrorHandling_8h.html">llvm/Support/ErrorHandling.h</a>&quot;</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="raw__ostream_8h.html">llvm/Support/raw_ostream.h</a>&quot;</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TargetInstrInfo_8h.html">llvm/Target/TargetInstrInfo.h</a>&quot;</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Target_2TargetMachine_8h.html">llvm/Target/TargetMachine.h</a>&quot;</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor">#include &lt;algorithm&gt;</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespacellvm.html">llvm</a>;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<a class="code" href="X86FloatingPoint_8cpp.html#a6b066422df544b54cfa1d1c25bbbd24f">STATISTIC</a>(NumFXCH, <span class="stringliteral">&quot;Number of fxch instructions inserted&quot;</span>);</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<a class="code" href="X86FloatingPoint_8cpp.html#a6b066422df544b54cfa1d1c25bbbd24f">STATISTIC</a>(NumFP  , <span class="stringliteral">&quot;Number of floating point instructions&quot;</span>);</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="keyword">namespace </span>{</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  <span class="keyword">struct </span>FPS : <span class="keyword">public</span> <a class="code" href="classllvm_1_1MachineFunctionPass.html">MachineFunctionPass</a> {</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <span class="keyword">static</span> <span class="keywordtype">char</span> <a class="code" href="namespacellvm_1_1CallingConv.html#a4f861731fc6dbfdccc05af5968d98974">ID</a>;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    FPS() : <a class="code" href="classllvm_1_1MachineFunctionPass.html">MachineFunctionPass</a>(ID) {</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;      <a class="code" href="namespacellvm.html#a778bcc1dd6188bd894d03c68a3fb28e7">initializeEdgeBundlesPass</a>(*<a class="code" href="classllvm_1_1PassRegistry.html#a05a729900b76c89e808c6c3094921b2f">PassRegistry::getPassRegistry</a>());</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;      <span class="comment">// This is really only to keep valgrind quiet.</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;      <span class="comment">// The logic in isLive() is too much for it.</span></div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;      <a class="code" href="namespacellvm_1_1Intrinsic.html#a73349916f7e54a6b988a3646c7a02e90ae857cbc5cf8c5a980f0bd245ad5ec61a">memset</a>(Stack, 0, <span class="keyword">sizeof</span>(Stack));</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;      <a class="code" href="namespacellvm_1_1Intrinsic.html#a73349916f7e54a6b988a3646c7a02e90ae857cbc5cf8c5a980f0bd245ad5ec61a">memset</a>(RegMap, 0, <span class="keyword">sizeof</span>(RegMap));</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    }</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">void</span> getAnalysisUsage(<a class="code" href="classllvm_1_1AnalysisUsage.html">AnalysisUsage</a> &amp;AU)<span class="keyword"> const </span>{</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;      AU.<a class="code" href="classllvm_1_1AnalysisUsage.html#af11a6ebf7ab3c388234cb6d5378439a3">setPreservesCFG</a>();</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;      AU.<a class="code" href="classllvm_1_1AnalysisUsage.html#ae5c60fd282ee894c87ea02c3f0fcb6d0">addRequired</a>&lt;<a class="code" href="classllvm_1_1EdgeBundles.html">EdgeBundles</a>&gt;();</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;      AU.<a class="code" href="classllvm_1_1AnalysisUsage.html#a40970e5d42646fb2d9aa5f7a2c879516">addPreservedID</a>(<a class="code" href="namespacellvm.html#a60b90e9a630631cf67aaef4679ffbf62">MachineLoopInfoID</a>);</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;      AU.<a class="code" href="classllvm_1_1AnalysisUsage.html#a40970e5d42646fb2d9aa5f7a2c879516">addPreservedID</a>(<a class="code" href="namespacellvm.html#a5a36a0d02a1629e4c1c8c6c587d01e5b">MachineDominatorsID</a>);</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;      <a class="code" href="classllvm_1_1MachineFunctionPass.html#aa1eece37d175f86a6f4808c0c167f13b">MachineFunctionPass::getAnalysisUsage</a>(AU);</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    }</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">bool</span> runOnMachineFunction(<a class="code" href="classllvm_1_1MachineFunction.html">MachineFunction</a> &amp;MF);</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <span class="keyword">virtual</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *getPassName()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <span class="stringliteral">&quot;X86 FP Stackifier&quot;</span>; }</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <span class="keyword">private</span>:</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetInstrInfo.html">TargetInstrInfo</a> *<a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>; <span class="comment">// Machine instruction info.</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <span class="comment">// Two CFG edges are related if they leave the same block, or enter the same</span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="comment">// block. The transitive closure of an edge under this relation is a</span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <span class="comment">// LiveBundle. It represents a set of CFG edges where the live FP stack</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <span class="comment">// registers must be allocated identically in the x87 stack.</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="comment">//</span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <span class="comment">// A LiveBundle is usually all the edges leaving a block, or all the edges</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <span class="comment">// entering a block, but it can contain more edges if critical edges are</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="comment">// present.</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="comment">//</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="comment">// The set of live FP registers in a LiveBundle is calculated by bundleCFG,</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <span class="comment">// but the exact mapping of FP registers to stack slots is fixed later.</span></div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="keyword">struct </span>LiveBundle {</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;      <span class="comment">// Bit mask of live FP registers. Bit 0 = FP0, bit 1 = FP1, &amp;c.</span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;      <span class="keywordtype">unsigned</span> Mask;</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;      <span class="comment">// Number of pre-assigned live registers in FixStack. This is 0 when the</span></div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;      <span class="comment">// stack order has not yet been fixed.</span></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;      <span class="keywordtype">unsigned</span> FixCount;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;      <span class="comment">// Assigned stack order for live-in registers.</span></div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;      <span class="comment">// FixStack[i] == getStackEntry(i) for all i &lt; FixCount.</span></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> FixStack[8];</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;      LiveBundle() : Mask(0), FixCount(0) {}</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;      <span class="comment">// Have the live registers been assigned a stack order yet?</span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;      <span class="keywordtype">bool</span> isFixed()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> !Mask || FixCount; }</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    };</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="comment">// Numbered LiveBundle structs. LiveBundles[0] is used for all CFG edges</span></div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <span class="comment">// with no live FP registers.</span></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;LiveBundle, 8&gt;</a> LiveBundles;</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="comment">// The edge bundle analysis provides indices into the LiveBundles vector.</span></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <a class="code" href="classllvm_1_1EdgeBundles.html">EdgeBundles</a> *Bundles;</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <span class="comment">// Return a bitmask of FP registers in block&#39;s live-in list.</span></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="keyword">static</span> <span class="keywordtype">unsigned</span> calcLiveInMask(<a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> *MBB) {</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;      <span class="keywordtype">unsigned</span> Mask = 0;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1MachineBasicBlock.html#a7bab64c02d740522f94f5f45959a22fc">MachineBasicBlock::livein_iterator</a> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = MBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#a6833d4f80b7e44f505b2184b04ea2693">livein_begin</a>(),</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;           E = MBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#aa314325c7062fd067a3c0b9339aa8ea6">livein_end</a>(); <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> != E; ++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        <span class="keywordtype">unsigned</span> <a class="code" href="X86DisassemblerDecoder_8h.html#a546839a5c4bcf9f9450967155f48de41">Reg</a> = *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>;</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="X86DisassemblerDecoder_8h.html#a546839a5c4bcf9f9450967155f48de41">Reg &lt; X86::FP0 || Reg &gt;</a> X86::FP6)</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;          <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        Mask |= 1 &lt;&lt; (Reg - X86::FP0);</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;      }</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;      <span class="keywordflow">return</span> Mask;</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    }</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="comment">// Partition all the CFG edges into LiveBundles.</span></div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="keywordtype">void</span> bundleCFG(<a class="code" href="classllvm_1_1MachineFunction.html">MachineFunction</a> &amp;MF);</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> *MBB;     <span class="comment">// Current basic block</span></div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="comment">// The hardware keeps track of how many FP registers are live, so we have</span></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="comment">// to model that exactly. Usually, each live register corresponds to an</span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <span class="comment">// FP&lt;n&gt; register, but when dealing with calls, returns, and inline</span></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="comment">// assembly, it is sometimes necessary to have live scratch registers.</span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <span class="keywordtype">unsigned</span> Stack[8];          <span class="comment">// FP&lt;n&gt; Registers in each stack slot...</span></div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="keywordtype">unsigned</span> StackTop;          <span class="comment">// The current top of the FP stack.</span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="keyword">enum</span> {</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;      NumFPRegs = 16            <span class="comment">// Including scratch pseudo-registers.</span></div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    };</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <span class="comment">// For each live FP&lt;n&gt; register, point to its Stack[] entry.</span></div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <span class="comment">// The first entries correspond to FP0-FP6, the rest are scratch registers</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <span class="comment">// used when we need slightly different live registers than what the</span></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="comment">// register allocator thinks.</span></div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="keywordtype">unsigned</span> RegMap[NumFPRegs];</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="comment">// Pending fixed registers - Inline assembly needs FP registers to appear</span></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="comment">// in fixed stack slot positions. This is handled by copying FP registers</span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <span class="comment">// to ST registers before the instruction, and copying back after the</span></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <span class="comment">// instruction.</span></div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <span class="comment">//</span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <span class="comment">// This is modeled with pending ST registers. NumPendingSTs is the number</span></div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="comment">// of ST registers (ST0-STn) we are tracking. PendingST[n] points to an FP</span></div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <span class="comment">// register that holds the ST value. The ST registers are not moved into</span></div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="comment">// place until immediately before the instruction that needs them.</span></div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="comment">//</span></div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="comment">// It can happen that we need an ST register to be live when no FP register</span></div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <span class="comment">// holds the value:</span></div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <span class="comment">//</span></div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="comment">//   %ST0 = COPY %FP4&lt;kill&gt;</span></div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="comment">//</span></div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <span class="comment">// When that happens, we allocate a scratch FP register to hold the ST</span></div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <span class="comment">// value. That means every register in PendingST must be live.</span></div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <span class="keywordtype">unsigned</span> NumPendingSTs;</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> PendingST[8];</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <span class="comment">// Set up our stack model to match the incoming registers to MBB.</span></div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="keywordtype">void</span> setupBlockStack();</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <span class="comment">// Shuffle live registers to match the expectations of successor blocks.</span></div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <span class="keywordtype">void</span> finishBlockStack();</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="preprocessor">#if !defined(NDEBUG) || defined(LLVM_ENABLE_DUMP)</span></div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <span class="keywordtype">void</span> dumpStack()<span class="keyword"> const </span>{</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;      <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Stack contents:&quot;</span>;</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != StackTop; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot; FP&quot;</span> &lt;&lt; Stack[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        assert(RegMap[Stack[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>]] == <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> &amp;&amp; <span class="stringliteral">&quot;Stack[] doesn&#39;t match RegMap[]!&quot;</span>);</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;      }</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != NumPendingSTs; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;, ST&quot;</span> &lt;&lt; <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt;&lt; <span class="stringliteral">&quot; in FP&quot;</span> &lt;&lt; unsigned(PendingST[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;      <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    }</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="comment">    /// getSlot - Return the stack slot number a particular register number is</span></div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="comment">    /// in.</span></div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment"></span>    <span class="keywordtype">unsigned</span> getSlot(<span class="keywordtype">unsigned</span> RegNo)<span class="keyword"> const </span>{</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;      assert(RegNo &lt; NumFPRegs &amp;&amp; <span class="stringliteral">&quot;Regno out of range!&quot;</span>);</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;      <span class="keywordflow">return</span> RegMap[RegNo];</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    }</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="comment">    /// isLive - Is RegNo currently live in the stack?</span></div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment"></span>    <span class="keywordtype">bool</span> isLive(<span class="keywordtype">unsigned</span> RegNo)<span class="keyword"> const </span>{</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;      <span class="keywordtype">unsigned</span> Slot = getSlot(RegNo);</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;      <span class="keywordflow">return</span> Slot &lt; StackTop &amp;&amp; Stack[Slot] == RegNo;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    }</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment">    /// getScratchReg - Return an FP register that is not currently in use.</span></div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment"></span>    <span class="keywordtype">unsigned</span> getScratchReg()<span class="keyword"> const </span>{</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = NumFPRegs - 1; <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> &gt;= 8; --<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        <span class="keywordflow">if</span> (!isLive(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>))</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;          <span class="keywordflow">return</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;      <a class="code" href="ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a>(<span class="stringliteral">&quot;Ran out of scratch FP registers&quot;</span>);</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    }</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment">    /// isScratchReg - Returns trus if RegNo is a scratch FP register.</span></div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment"></span>    <span class="keyword">static</span> <span class="keywordtype">bool</span> isScratchReg(<span class="keywordtype">unsigned</span> RegNo) {</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;      <span class="keywordflow">return</span> RegNo &gt; 8 &amp;&amp; RegNo &lt; NumFPRegs;</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    }</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="comment">    /// getStackEntry - Return the X86::FP&lt;n&gt; register in register ST(i).</span></div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="comment"></span>    <span class="keywordtype">unsigned</span> getStackEntry(<span class="keywordtype">unsigned</span> STi)<span class="keyword"> const </span>{</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;      <span class="keywordflow">if</span> (STi &gt;= StackTop)</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        <a class="code" href="namespacellvm.html#a1f6978055dbb761b380de39070e34bd3">report_fatal_error</a>(<span class="stringliteral">&quot;Access past stack top!&quot;</span>);</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;      <span class="keywordflow">return</span> Stack[StackTop-1-STi];</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    }</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="comment">    /// getSTReg - Return the X86::ST(i) register which contains the specified</span></div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="comment">    /// FP&lt;RegNo&gt; register.</span></div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="comment"></span>    <span class="keywordtype">unsigned</span> getSTReg(<span class="keywordtype">unsigned</span> RegNo)<span class="keyword"> const </span>{</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;      <span class="keywordflow">return</span> StackTop - 1 - getSlot(RegNo) + X86::ST0;</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    }</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="comment">// pushReg - Push the specified FP&lt;n&gt; register onto the stack.</span></div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <span class="keywordtype">void</span> pushReg(<span class="keywordtype">unsigned</span> <a class="code" href="X86DisassemblerDecoder_8h.html#a546839a5c4bcf9f9450967155f48de41">Reg</a>) {</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;      assert(Reg &lt; NumFPRegs &amp;&amp; <span class="stringliteral">&quot;Register number out of range!&quot;</span>);</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;      <span class="keywordflow">if</span> (StackTop &gt;= 8)</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        <a class="code" href="namespacellvm.html#a1f6978055dbb761b380de39070e34bd3">report_fatal_error</a>(<span class="stringliteral">&quot;Stack overflow!&quot;</span>);</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;      Stack[StackTop] = <a class="code" href="X86DisassemblerDecoder_8h.html#a546839a5c4bcf9f9450967155f48de41">Reg</a>;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;      RegMap[<a class="code" href="X86DisassemblerDecoder_8h.html#a546839a5c4bcf9f9450967155f48de41">Reg</a>] = StackTop++;</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    }</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="keywordtype">bool</span> isAtTop(<span class="keywordtype">unsigned</span> RegNo)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> getSlot(RegNo) == StackTop-1; }</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <span class="keywordtype">void</span> moveToTop(<span class="keywordtype">unsigned</span> RegNo, <a class="code" href="classllvm_1_1MachineBasicBlock.html#ac51be7ff80fe8d6ae5e8c0acb194908a">MachineBasicBlock::iterator</a> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;      <a class="code" href="classllvm_1_1DebugLoc.html">DebugLoc</a> dl = I == MBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#acbc921830578e2741be6549db716c0ce">end</a>() ? <a class="code" href="classllvm_1_1DebugLoc.html">DebugLoc</a>() : I-&gt;getDebugLoc();</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;      <span class="keywordflow">if</span> (isAtTop(RegNo)) <span class="keywordflow">return</span>;</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;      <span class="keywordtype">unsigned</span> STReg = getSTReg(RegNo);</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;      <span class="keywordtype">unsigned</span> RegOnTop = getStackEntry(0);</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;      <span class="comment">// Swap the slots the regs are in.</span></div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;      <a class="code" href="namespacestd.html#ab8424022895aee3e366fb9a32f2883cb">std::swap</a>(RegMap[RegNo], RegMap[RegOnTop]);</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;      <span class="comment">// Swap stack slot contents.</span></div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;      <span class="keywordflow">if</span> (RegMap[RegOnTop] &gt;= StackTop)</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        <a class="code" href="namespacellvm.html#a1f6978055dbb761b380de39070e34bd3">report_fatal_error</a>(<span class="stringliteral">&quot;Access past stack top!&quot;</span>);</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;      <a class="code" href="namespacestd.html#ab8424022895aee3e366fb9a32f2883cb">std::swap</a>(Stack[RegMap[RegOnTop]], Stack[StackTop-1]);</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;      <span class="comment">// Emit an fxch to update the runtime processors version of the state.</span></div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;      <a class="code" href="namespacellvm.html#a980570dc1410d4ef53806f82028ca381">BuildMI</a>(*MBB, I, dl, TII-&gt;<a class="code" href="classllvm_1_1MCInstrInfo.html#ab16f5a81fccfe4b7f645ba5a74ffad02">get</a>(X86::XCH_F)).addReg(STReg);</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;      ++NumFXCH;</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    }</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <span class="keywordtype">void</span> duplicateToTop(<span class="keywordtype">unsigned</span> RegNo, <span class="keywordtype">unsigned</span> AsReg, <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *I) {</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;      <a class="code" href="classllvm_1_1DebugLoc.html">DebugLoc</a> dl = I == MBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#acbc921830578e2741be6549db716c0ce">end</a>() ? <a class="code" href="classllvm_1_1DebugLoc.html">DebugLoc</a>() : I-&gt;getDebugLoc();</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;      <span class="keywordtype">unsigned</span> STReg = getSTReg(RegNo);</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;      pushReg(AsReg);   <span class="comment">// New register on top of stack</span></div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;      <a class="code" href="namespacellvm.html#a980570dc1410d4ef53806f82028ca381">BuildMI</a>(*MBB, I, dl, TII-&gt;<a class="code" href="classllvm_1_1MCInstrInfo.html#ab16f5a81fccfe4b7f645ba5a74ffad02">get</a>(X86::LD_Frr)).addReg(STReg);</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    }</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment">    /// duplicatePendingSTBeforeKill - The instruction at I is about to kill</span></div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment">    /// RegNo. If any PendingST registers still need the RegNo value, duplicate</span></div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="comment">    /// them to new scratch registers.</span></div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> duplicatePendingSTBeforeKill(<span class="keywordtype">unsigned</span> RegNo, <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *I) {</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != NumPendingSTs; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        <span class="keywordflow">if</span> (PendingST[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>] != RegNo)</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;          <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        <span class="keywordtype">unsigned</span> SR = getScratchReg();</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Duplicating pending ST&quot;</span> &lt;&lt; <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;                     &lt;&lt; <span class="stringliteral">&quot; in FP&quot;</span> &lt;&lt; RegNo &lt;&lt; <span class="stringliteral">&quot; to FP&quot;</span> &lt;&lt; SR &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>);</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        duplicateToTop(RegNo, SR, I);</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        PendingST[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>] = SR;</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;      }</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    }</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="comment">    /// popStackAfter - Pop the current value off of the top of the FP stack</span></div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="comment">    /// after the specified instruction.</span></div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> popStackAfter(<a class="code" href="classllvm_1_1MachineBasicBlock.html#ac51be7ff80fe8d6ae5e8c0acb194908a">MachineBasicBlock::iterator</a> &amp;I);</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="comment">    /// freeStackSlotAfter - Free the specified register from the register</span></div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="comment">    /// stack, so that it is no longer in a register.  If the register is</span></div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="comment">    /// currently at the top of the stack, we just pop the current instruction,</span></div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="comment">    /// otherwise we store the current top-of-stack into the specified slot,</span></div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="comment">    /// then pop the top of stack.</span></div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> freeStackSlotAfter(<a class="code" href="classllvm_1_1MachineBasicBlock.html#ac51be7ff80fe8d6ae5e8c0acb194908a">MachineBasicBlock::iterator</a> &amp;I, <span class="keywordtype">unsigned</span> Reg);</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="comment">    /// freeStackSlotBefore - Just the pop, no folding. Return the inserted</span></div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="comment">    /// instruction.</span></div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="comment"></span>    <a class="code" href="classllvm_1_1MachineBasicBlock.html#ac51be7ff80fe8d6ae5e8c0acb194908a">MachineBasicBlock::iterator</a></div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    freeStackSlotBefore(<a class="code" href="classllvm_1_1MachineBasicBlock.html#ac51be7ff80fe8d6ae5e8c0acb194908a">MachineBasicBlock::iterator</a> I, <span class="keywordtype">unsigned</span> FPRegNo);</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment">    /// Adjust the live registers to be the set in Mask.</span></div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> adjustLiveRegs(<span class="keywordtype">unsigned</span> Mask, <a class="code" href="classllvm_1_1MachineBasicBlock.html#ac51be7ff80fe8d6ae5e8c0acb194908a">MachineBasicBlock::iterator</a> I);</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment">    /// Shuffle the top FixCount stack entries such that FP reg FixStack[0] is</span></div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="comment">    /// st(0), FP reg FixStack[1] is st(1) etc.</span></div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> shuffleStackTop(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *FixStack, <span class="keywordtype">unsigned</span> FixCount,</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;                         <a class="code" href="classllvm_1_1MachineBasicBlock.html#ac51be7ff80fe8d6ae5e8c0acb194908a">MachineBasicBlock::iterator</a> I);</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <span class="keywordtype">bool</span> processBasicBlock(<a class="code" href="classllvm_1_1MachineFunction.html">MachineFunction</a> &amp;MF, <a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> &amp;MBB);</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    <span class="keywordtype">void</span> handleZeroArgFP(<a class="code" href="classllvm_1_1MachineBasicBlock.html#ac51be7ff80fe8d6ae5e8c0acb194908a">MachineBasicBlock::iterator</a> &amp;I);</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <span class="keywordtype">void</span> handleOneArgFP(<a class="code" href="classllvm_1_1MachineBasicBlock.html#ac51be7ff80fe8d6ae5e8c0acb194908a">MachineBasicBlock::iterator</a> &amp;I);</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <span class="keywordtype">void</span> handleOneArgFPRW(<a class="code" href="classllvm_1_1MachineBasicBlock.html#ac51be7ff80fe8d6ae5e8c0acb194908a">MachineBasicBlock::iterator</a> &amp;I);</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <span class="keywordtype">void</span> handleTwoArgFP(<a class="code" href="classllvm_1_1MachineBasicBlock.html#ac51be7ff80fe8d6ae5e8c0acb194908a">MachineBasicBlock::iterator</a> &amp;I);</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <span class="keywordtype">void</span> handleCompareFP(<a class="code" href="classllvm_1_1MachineBasicBlock.html#ac51be7ff80fe8d6ae5e8c0acb194908a">MachineBasicBlock::iterator</a> &amp;I);</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <span class="keywordtype">void</span> handleCondMovFP(<a class="code" href="classllvm_1_1MachineBasicBlock.html#ac51be7ff80fe8d6ae5e8c0acb194908a">MachineBasicBlock::iterator</a> &amp;I);</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <span class="keywordtype">void</span> handleSpecialFP(<a class="code" href="classllvm_1_1MachineBasicBlock.html#ac51be7ff80fe8d6ae5e8c0acb194908a">MachineBasicBlock::iterator</a> &amp;I);</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <span class="comment">// Check if a COPY instruction is using FP registers.</span></div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    <span class="keyword">static</span> <span class="keywordtype">bool</span> isFPCopy(<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *<a class="code" href="namespacellvm_1_1A64CC.html#af5804bc0518be9568f73db566e4d6f46a2db5e7546f960277ff98f96cd5624442">MI</a>) {</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;      <span class="keywordtype">unsigned</span> DstReg = MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a302e45878c6dc1714334c7ce96d56846">getOperand</a>(0).<a class="code" href="classllvm_1_1MachineOperand.html#ab75f703d251cc0ce0206fe00a999db86">getReg</a>();</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;      <span class="keywordtype">unsigned</span> SrcReg = MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a302e45878c6dc1714334c7ce96d56846">getOperand</a>(1).<a class="code" href="classllvm_1_1MachineOperand.html#ab75f703d251cc0ce0206fe00a999db86">getReg</a>();</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;      <span class="keywordflow">return</span> X86::RFP80RegClass.contains(DstReg) ||</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;        X86::RFP80RegClass.contains(SrcReg);</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    }</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;  };</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  <span class="keywordtype">char</span> <a class="code" href="namespacellvm_1_1CallingConv.html#a4f861731fc6dbfdccc05af5968d98974">FPS::ID</a> = 0;</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;}</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;</div><div class="line"><a name="l00326"></a><span class="lineno"><a class="line" href="namespacellvm.html#a8cee33dcd88f91352d495da4765d7471">  326</a></span>&#160;<a class="code" href="classllvm_1_1FunctionPass.html">FunctionPass</a> *<a class="code" href="namespacellvm.html#a8cee33dcd88f91352d495da4765d7471">llvm::createX86FloatingPointStackifierPass</a>() { <span class="keywordflow">return</span> <span class="keyword">new</span> FPS(); }</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="comment">/// getFPReg - Return the X86::FPx register number for the specified operand.</span></div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="comment">/// For example, this returns 3 for X86::FP3.</span></div><div class="line"><a name="l00330"></a><span class="lineno"><a class="line" href="X86FloatingPoint_8cpp.html#aa6438c766cdab5c1e26d802ef9ad14ff">  330</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">unsigned</span> <a class="code" href="X86FloatingPoint_8cpp.html#aa6438c766cdab5c1e26d802ef9ad14ff">getFPReg</a>(<span class="keyword">const</span> <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;MO) {</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  assert(MO.<a class="code" href="classllvm_1_1MachineOperand.html#ad8198d6d83af9410d867136e33fbf4b2">isReg</a>() &amp;&amp; <span class="stringliteral">&quot;Expected an FP register!&quot;</span>);</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;  <span class="keywordtype">unsigned</span> Reg = MO.<a class="code" href="classllvm_1_1MachineOperand.html#ab75f703d251cc0ce0206fe00a999db86">getReg</a>();</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;  assert(Reg &gt;= X86::FP0 &amp;&amp; Reg &lt;= X86::FP6 &amp;&amp; <span class="stringliteral">&quot;Expected FP register!&quot;</span>);</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;  <span class="keywordflow">return</span> Reg - X86::FP0;</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;}</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="comment">/// runOnMachineFunction - Loop over all of the basic blocks, transforming FP</span></div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="comment">/// register references into FP stack references.</span></div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="comment"></span><span class="keywordtype">bool</span> FPS::runOnMachineFunction(<a class="code" href="classllvm_1_1MachineFunction.html">MachineFunction</a> &amp;MF) {</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;  <span class="comment">// We only need to run this pass if there are any FP registers used in this</span></div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;  <span class="comment">// function.  If it is all integer, there is nothing for us to do!</span></div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;  <span class="keywordtype">bool</span> FPIsUsed = <span class="keyword">false</span>;</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;  assert(X86::FP6 == X86::FP0+6 &amp;&amp; <span class="stringliteral">&quot;Register enums aren&#39;t sorted right!&quot;</span>);</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt;= 6; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    <span class="keywordflow">if</span> (MF.<a class="code" href="classllvm_1_1MachineFunction.html#ab4a6ca428289b667dd691a00e9f7e334">getRegInfo</a>().<a class="code" href="classllvm_1_1MachineRegisterInfo.html#abe3c98b9803fa6a21eca279173c27b12">isPhysRegUsed</a>(X86::FP0+<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>)) {</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;      FPIsUsed = <span class="keyword">true</span>;</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    }</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;  <span class="comment">// Early exit.</span></div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;  <span class="keywordflow">if</span> (!FPIsUsed) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;  Bundles = &amp;getAnalysis&lt;EdgeBundles&gt;();</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;  TII = MF.<a class="code" href="classllvm_1_1MachineFunction.html#a6745c3bfdfc5b0643b078b96df2db252">getTarget</a>().<a class="code" href="classllvm_1_1TargetMachine.html#ac13d0f6f2c915757013b101ef6e8afbc">getInstrInfo</a>();</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;  <span class="comment">// Prepare cross-MBB liveness.</span></div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;  bundleCFG(MF);</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;  StackTop = 0;</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;  <span class="comment">// Process the function in depth first order so that we process at least one</span></div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;  <span class="comment">// of the predecessors for every reachable block in the function.</span></div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;  <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;MachineBasicBlock*, 8&gt;</a> Processed;</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;  <a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> *Entry = MF.<a class="code" href="classllvm_1_1MachineFunction.html#ab0789854909cf47f640a85fa2bac29c7">begin</a>();</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;  <span class="keywordtype">bool</span> Changed = <span class="keyword">false</span>;</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="structllvm_1_1df__ext__iterator.html">df_ext_iterator</a>&lt;<a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a>*, <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;MachineBasicBlock*, 8&gt;</a> &gt;</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;         I = <a class="code" href="namespacellvm.html#a79d4face7022f4be1d51b785a83de44f">df_ext_begin</a>(Entry, Processed), E = <a class="code" href="namespacellvm.html#aaa67df70b3bc20ef65f8fe523c41da0e">df_ext_end</a>(Entry, Processed);</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;       I != E; ++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    Changed |= processBasicBlock(MF, **I);</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;  <span class="comment">// Process any unreachable blocks in arbitrary order now.</span></div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;  <span class="keywordflow">if</span> (MF.<a class="code" href="classllvm_1_1MachineFunction.html#a1bc94fb2ca335374a6b470347a85b28f">size</a>() != Processed.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#a41c201584742f7eb45b2be8cd54e3bcb">size</a>())</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1MachineFunction.html#a340712de3e78fec11c338735cab17df7">MachineFunction::iterator</a> <a class="code" href="CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> = MF.<a class="code" href="classllvm_1_1MachineFunction.html#ab0789854909cf47f640a85fa2bac29c7">begin</a>(), E = MF.<a class="code" href="classllvm_1_1MachineFunction.html#a9d017af749f76484cb9aec9ff6e4330c">end</a>(); <a class="code" href="CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> != E; ++<a class="code" href="CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>)</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;      <span class="keywordflow">if</span> (Processed.<a class="code" href="classllvm_1_1SmallPtrSet.html#a9b6dd0fc7a648a939e571246045b673e">insert</a>(<a class="code" href="CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>))</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;        Changed |= processBasicBlock(MF, *<a class="code" href="CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>);</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;  LiveBundles.<a class="code" href="classllvm_1_1SmallVectorImpl.html#aac0ea55010b7b1a301e65a0baea057aa">clear</a>();</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;  <span class="keywordflow">return</span> Changed;</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;}</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="comment">/// bundleCFG - Scan all the basic blocks to determine consistent live-in and</span></div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="comment">/// live-out sets for the FP registers. Consistent means that the set of</span></div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="comment">/// registers live-out from a block is identical to the live-in set of all</span></div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="comment">/// successors. This is not enforced by the normal live-in lists since</span></div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="comment">/// registers may be implicitly defined, or not used by all successors.</span></div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="comment"></span><span class="keywordtype">void</span> FPS::bundleCFG(<a class="code" href="classllvm_1_1MachineFunction.html">MachineFunction</a> &amp;MF) {</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;  assert(LiveBundles.<a class="code" href="classllvm_1_1SmallVectorBase.html#a8a8df4d85555c7954a95f86080cd3b64">empty</a>() &amp;&amp; <span class="stringliteral">&quot;Stale data in LiveBundles&quot;</span>);</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;  LiveBundles.<a class="code" href="classllvm_1_1SmallVectorImpl.html#a102d0ad36060677286c3aefb812e5512">resize</a>(Bundles-&gt;<a class="code" href="classllvm_1_1EdgeBundles.html#a2fa4eb01f401c3513c1eca5024e1c2cc">getNumBundles</a>());</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;  <span class="comment">// Gather the actual live-in masks for all MBBs.</span></div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1MachineFunction.html#a340712de3e78fec11c338735cab17df7">MachineFunction::iterator</a> I = MF.<a class="code" href="classllvm_1_1MachineFunction.html#ab0789854909cf47f640a85fa2bac29c7">begin</a>(), E = MF.<a class="code" href="classllvm_1_1MachineFunction.html#a9d017af749f76484cb9aec9ff6e4330c">end</a>(); I != E; ++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    <a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> *MBB = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>;</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> Mask = calcLiveInMask(MBB);</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    <span class="keywordflow">if</span> (!Mask)</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    <span class="comment">// Update MBB ingoing bundle mask.</span></div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    LiveBundles[Bundles-&gt;<a class="code" href="classllvm_1_1EdgeBundles.html#ac1f97383ef8b8ee7c80c24f68e3c3597">getBundle</a>(MBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#a6acda287e5c19ffb173b0bf8f1dd9c5e">getNumber</a>(), <span class="keyword">false</span>)].Mask |= Mask;</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;  }</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;}</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;<span class="comment">/// processBasicBlock - Loop over all of the instructions in the basic block,</span></div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;<span class="comment">/// transforming FP instructions into their stack form.</span></div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;<span class="comment"></span><span class="keywordtype">bool</span> FPS::processBasicBlock(<a class="code" href="classllvm_1_1MachineFunction.html">MachineFunction</a> &amp;MF, <a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> &amp;<a class="code" href="CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>) {</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;  <span class="keywordtype">bool</span> Changed = <span class="keyword">false</span>;</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;  MBB = &amp;<a class="code" href="CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>;</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;  NumPendingSTs = 0;</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;  setupBlockStack();</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1MachineBasicBlock.html#ac51be7ff80fe8d6ae5e8c0acb194908a">MachineBasicBlock::iterator</a> I = BB.<a class="code" href="classllvm_1_1MachineBasicBlock.html#ab2d91e7bec944efcbc39d8e30644f111">begin</a>(); I != BB.<a class="code" href="classllvm_1_1MachineBasicBlock.html#acbc921830578e2741be6549db716c0ce">end</a>(); ++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *MI = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>;</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    uint64_t <a class="code" href="namespaceSIInstrFlags.html#a607b4b0952924970b77a9c6b42898b54">Flags</a> = MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a803a7424877fd049679b9aa2f07597b5">getDesc</a>().<a class="code" href="classllvm_1_1MCInstrDesc.html#a46e0fcca2366f30d5e35b3d7dcb9c65f">TSFlags</a>;</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <span class="keywordtype">unsigned</span> FPInstClass = Flags &amp; <a class="code" href="namespacellvm_1_1X86II.html#a97dc14052814702ba0e2b14fb14dd02dad9c72926f550ad00a4b35ba072ada7fc">X86II::FPTypeMask</a>;</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    <span class="keywordflow">if</span> (MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#acd9af7d3f8a155c4356edccbc0522c8e">isInlineAsm</a>())</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;      FPInstClass = <a class="code" href="namespacellvm_1_1X86II.html#a97dc14052814702ba0e2b14fb14dd02da0c0206ff5a225b969956cfc4ae94c5fc">X86II::SpecialFP</a>;</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    <span class="keywordflow">if</span> (MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#ae0ac5973cd95f76e3365e67aaad69de6">isCopy</a>() &amp;&amp; isFPCopy(MI))</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;      FPInstClass = <a class="code" href="namespacellvm_1_1X86II.html#a97dc14052814702ba0e2b14fb14dd02da0c0206ff5a225b969956cfc4ae94c5fc">X86II::SpecialFP</a>;</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <span class="keywordflow">if</span> (MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a0e15c0325463fc62bd16ccd9ec2b9ec5">isImplicitDef</a>() &amp;&amp;</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;        X86::RFP80RegClass.contains(MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a302e45878c6dc1714334c7ce96d56846">getOperand</a>(0).<a class="code" href="classllvm_1_1MachineOperand.html#ab75f703d251cc0ce0206fe00a999db86">getReg</a>()))</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;      FPInstClass = <a class="code" href="namespacellvm_1_1X86II.html#a97dc14052814702ba0e2b14fb14dd02da0c0206ff5a225b969956cfc4ae94c5fc">X86II::SpecialFP</a>;</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    <span class="keywordflow">if</span> (FPInstClass == <a class="code" href="namespacellvm_1_1X86II.html#a97dc14052814702ba0e2b14fb14dd02da29c03f5fb2c53a32f54eb835fb6dce02">X86II::NotFP</a>)</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;      <span class="keywordflow">continue</span>;  <span class="comment">// Efficiently ignore non-fp insts!</span></div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *PrevMI = 0;</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <span class="keywordflow">if</span> (I != BB.<a class="code" href="classllvm_1_1MachineBasicBlock.html#ab2d91e7bec944efcbc39d8e30644f111">begin</a>())</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;      PrevMI = <a class="code" href="namespacellvm.html#a7923e3e207de8bc1d0d6a5091316ddde">prior</a>(I);</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    ++NumFP;  <span class="comment">// Keep track of # of pseudo instrs</span></div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;\nFPInst:\t&quot;</span> &lt;&lt; *MI);</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    <span class="comment">// Get dead variables list now because the MI pointer may be deleted as part</span></div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    <span class="comment">// of processing!</span></div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;unsigned, 8&gt;</a> DeadRegs;</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0, e = MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a7b5fe96d88954efc855e6c466207e535">getNumOperands</a>(); <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != e; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;      <span class="keyword">const</span> <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;MO = MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a302e45878c6dc1714334c7ce96d56846">getOperand</a>(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;      <span class="keywordflow">if</span> (MO.<a class="code" href="classllvm_1_1MachineOperand.html#ad8198d6d83af9410d867136e33fbf4b2">isReg</a>() &amp;&amp; MO.<a class="code" href="classllvm_1_1MachineOperand.html#a196420aa839c2b21f42c4bf5c36df437">isDead</a>())</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;        DeadRegs.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(MO.<a class="code" href="classllvm_1_1MachineOperand.html#ab75f703d251cc0ce0206fe00a999db86">getReg</a>());</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    }</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    <span class="keywordflow">switch</span> (FPInstClass) {</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1X86II.html#a97dc14052814702ba0e2b14fb14dd02da7a3ad350fcf1708671924bff02fa5384">X86II::ZeroArgFP</a>:  handleZeroArgFP(I); <span class="keywordflow">break</span>;</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1X86II.html#a97dc14052814702ba0e2b14fb14dd02da910ed6a9ae2b24b98c26ae96e916f32c">X86II::OneArgFP</a>:   handleOneArgFP(I);  <span class="keywordflow">break</span>;  <span class="comment">// fstp ST(0)</span></div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1X86II.html#a97dc14052814702ba0e2b14fb14dd02da584c8de4beec92e693e6318cd38821fb">X86II::OneArgFPRW</a>: handleOneArgFPRW(I); <span class="keywordflow">break</span>; <span class="comment">// ST(0) = fsqrt(ST(0))</span></div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1X86II.html#a97dc14052814702ba0e2b14fb14dd02daf7281802655e34d6a26592d416090b1e">X86II::TwoArgFP</a>:   handleTwoArgFP(I);  <span class="keywordflow">break</span>;</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1X86II.html#a97dc14052814702ba0e2b14fb14dd02da923b21f9b6b3b2a5ddfb326db177dc8a">X86II::CompareFP</a>:  handleCompareFP(I); <span class="keywordflow">break</span>;</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1X86II.html#a97dc14052814702ba0e2b14fb14dd02dac8b9cf1b6c894ccfae9058503988b31a">X86II::CondMovFP</a>:  handleCondMovFP(I); <span class="keywordflow">break</span>;</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1X86II.html#a97dc14052814702ba0e2b14fb14dd02da0c0206ff5a225b969956cfc4ae94c5fc">X86II::SpecialFP</a>:  handleSpecialFP(I); <span class="keywordflow">break</span>;</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    <span class="keywordflow">default</span>: <a class="code" href="ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a>(<span class="stringliteral">&quot;Unknown FP Type!&quot;</span>);</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    }</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    <span class="comment">// Check to see if any of the values defined by this instruction are dead</span></div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    <span class="comment">// after definition.  If so, pop them.</span></div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0, e = DeadRegs.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#a22a311dfe4c28a897de8a9365a4f0a84">size</a>(); <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != e; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;      <span class="keywordtype">unsigned</span> Reg = DeadRegs[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;      <span class="keywordflow">if</span> (Reg &gt;= X86::FP0 &amp;&amp; Reg &lt;= X86::FP6) {</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;        <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Register FP#&quot;</span> &lt;&lt; Reg-X86::FP0 &lt;&lt; <span class="stringliteral">&quot; is dead!\n&quot;</span>);</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;        freeStackSlotAfter(I, Reg-X86::FP0);</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;      }</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    }</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    <span class="comment">// Print out all of the instructions expanded to if -debug</span></div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;      <a class="code" href="classllvm_1_1MachineBasicBlock.html#ac51be7ff80fe8d6ae5e8c0acb194908a">MachineBasicBlock::iterator</a> PrevI(PrevMI);</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;      <span class="keywordflow">if</span> (I == PrevI) {</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;        <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Just deleted pseudo instruction\n&quot;</span>;</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;        <a class="code" href="classllvm_1_1MachineBasicBlock.html#ac51be7ff80fe8d6ae5e8c0acb194908a">MachineBasicBlock::iterator</a> Start = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>;</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;        <span class="comment">// Rewind to first instruction newly inserted.</span></div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;        <span class="keywordflow">while</span> (Start != BB.<a class="code" href="classllvm_1_1MachineBasicBlock.html#ab2d91e7bec944efcbc39d8e30644f111">begin</a>() &amp;&amp; <a class="code" href="namespacellvm.html#a7923e3e207de8bc1d0d6a5091316ddde">prior</a>(Start) != PrevI) --Start;</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;        <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Inserted instructions:\n\t&quot;</span>;</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;        Start-&gt;print(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>(), &amp;MF.<a class="code" href="classllvm_1_1MachineFunction.html#a6745c3bfdfc5b0643b078b96df2db252">getTarget</a>());</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;        <span class="keywordflow">while</span> (++Start != <a class="code" href="namespacellvm.html#aa1704159f75e6eacd595962ea6d93ffe">llvm::next</a>(I)) {}</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;      }</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;      dumpStack();</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    );</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    (void)PrevMI;</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    Changed = <span class="keyword">true</span>;</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;  }</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;  finishBlockStack();</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;  <span class="keywordflow">return</span> Changed;</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;}</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;<span class="comment">/// setupBlockStack - Use the live bundles to set up our model of the stack</span></div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;<span class="comment">/// to match predecessors&#39; live out stack.</span></div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;<span class="comment"></span><span class="keywordtype">void</span> FPS::setupBlockStack() {</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;  <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;\nSetting up live-ins for BB#&quot;</span> &lt;&lt; MBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#a6acda287e5c19ffb173b0bf8f1dd9c5e">getNumber</a>()</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;               &lt;&lt; <span class="stringliteral">&quot; derived from &quot;</span> &lt;&lt; MBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#a454838c989e99a86bd804e056c367bd9">getName</a>() &lt;&lt; <span class="stringliteral">&quot;.\n&quot;</span>);</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;  StackTop = 0;</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;  <span class="comment">// Get the live-in bundle for MBB.</span></div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;  <span class="keyword">const</span> LiveBundle &amp;Bundle =</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    LiveBundles[Bundles-&gt;<a class="code" href="classllvm_1_1EdgeBundles.html#ac1f97383ef8b8ee7c80c24f68e3c3597">getBundle</a>(MBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#a6acda287e5c19ffb173b0bf8f1dd9c5e">getNumber</a>(), <span class="keyword">false</span>)];</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;  <span class="keywordflow">if</span> (!Bundle.Mask) {</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Block has no FP live-ins.\n&quot;</span>);</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;  }</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;  <span class="comment">// Depth-first iteration should ensure that we always have an assigned stack.</span></div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;  assert(Bundle.isFixed() &amp;&amp; <span class="stringliteral">&quot;Reached block before any predecessors&quot;</span>);</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;  <span class="comment">// Push the fixed live-in registers.</span></div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = Bundle.FixCount; <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> &gt; 0; --<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    MBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#ae26efdb76d5c56388c65dc5b02a2ae6f">addLiveIn</a>(X86::ST0+<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>-1);</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Live-in st(&quot;</span> &lt;&lt; (<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>-1) &lt;&lt; <span class="stringliteral">&quot;): %FP&quot;</span></div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;                 &lt;&lt; <span class="keywordtype">unsigned</span>(Bundle.FixStack[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>-1]) &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>);</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    pushReg(Bundle.FixStack[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>-1]);</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;  }</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;  <span class="comment">// Kill off unwanted live-ins. This can happen with a critical edge.</span></div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;  <span class="comment">// FIXME: We could keep these live registers around as zombies. They may need</span></div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;  <span class="comment">// to be revived at the end of a short block. It might save a few instrs.</span></div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;  adjustLiveRegs(calcLiveInMask(MBB), MBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#ab2d91e7bec944efcbc39d8e30644f111">begin</a>());</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;  <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(MBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#a034eb3171c0fc312556559ac96d11c2b">dump</a>());</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;}</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;<span class="comment">/// finishBlockStack - Revive live-outs that are implicitly defined out of</span></div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;<span class="comment">/// MBB. Shuffle live registers to match the expected fixed stack of any</span></div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;<span class="comment">/// predecessors, and ensure that all predecessors are expecting the same</span></div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;<span class="comment">/// stack.</span></div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;<span class="comment"></span><span class="keywordtype">void</span> FPS::finishBlockStack() {</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;  <span class="comment">// The RET handling below takes care of return blocks for us.</span></div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;  <span class="keywordflow">if</span> (MBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#a1570dd3a2568ba5e52073cdf6d904ee9">succ_empty</a>())</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;  <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Setting up live-outs for BB#&quot;</span> &lt;&lt; MBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#a6acda287e5c19ffb173b0bf8f1dd9c5e">getNumber</a>()</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;               &lt;&lt; <span class="stringliteral">&quot; derived from &quot;</span> &lt;&lt; MBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#a454838c989e99a86bd804e056c367bd9">getName</a>() &lt;&lt; <span class="stringliteral">&quot;.\n&quot;</span>);</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;  <span class="comment">// Get MBB&#39;s live-out bundle.</span></div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;  <span class="keywordtype">unsigned</span> BundleIdx = Bundles-&gt;<a class="code" href="classllvm_1_1EdgeBundles.html#ac1f97383ef8b8ee7c80c24f68e3c3597">getBundle</a>(MBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#a6acda287e5c19ffb173b0bf8f1dd9c5e">getNumber</a>(), <span class="keyword">true</span>);</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;  LiveBundle &amp;Bundle = LiveBundles[BundleIdx];</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;  <span class="comment">// We may need to kill and define some registers to match successors.</span></div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;  <span class="comment">// FIXME: This can probably be combined with the shuffle below.</span></div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;  <a class="code" href="classllvm_1_1MachineBasicBlock.html#ac51be7ff80fe8d6ae5e8c0acb194908a">MachineBasicBlock::iterator</a> Term = MBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#a7f0521fa2de44271fd4b909ea7351ef3">getFirstTerminator</a>();</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;  adjustLiveRegs(Bundle.Mask, Term);</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;  <span class="keywordflow">if</span> (!Bundle.Mask) {</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;No live-outs.\n&quot;</span>);</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;  }</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;  <span class="comment">// Has the stack order been fixed yet?</span></div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;  <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;LB#&quot;</span> &lt;&lt; BundleIdx &lt;&lt; <span class="stringliteral">&quot;: &quot;</span>);</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;  <span class="keywordflow">if</span> (Bundle.isFixed()) {</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Shuffling stack to match.\n&quot;</span>);</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    shuffleStackTop(Bundle.FixStack, Bundle.FixCount, Term);</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    <span class="comment">// Not fixed yet, we get to choose.</span></div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Fixing stack order now.\n&quot;</span>);</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    Bundle.FixCount = StackTop;</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; StackTop; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;      Bundle.FixStack[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>] = getStackEntry(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;  }</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;}</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;<span class="comment">// Efficient Lookup Table Support</span></div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;<span class="keyword">namespace </span>{</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;  <span class="keyword">struct </span>TableEntry {</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    uint16_t from;</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    uint16_t <a class="code" href="Target_2ARM_2README_8txt.html#a91f4469a9d29e354421494afd4ba466d">to</a>;</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="namespacellvm.html#a7c469a194119a14e5a018ebb9b847cf0">operator&lt;</a>(<span class="keyword">const</span> TableEntry &amp;TE)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> from &lt; TE.from; }</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    <span class="keyword">friend</span> <span class="keywordtype">bool</span> <a class="code" href="namespacellvm.html#a7c469a194119a14e5a018ebb9b847cf0">operator&lt;</a>(<span class="keyword">const</span> TableEntry &amp;TE, <span class="keywordtype">unsigned</span> V) {</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;      <span class="keywordflow">return</span> TE.from &lt; V;</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    }</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    <span class="keyword">friend</span> <span class="keywordtype">bool</span> <a class="code" href="Compiler_8h.html#acc1c483f4b4ee2f17bb6643a3b353609">LLVM_ATTRIBUTE_UNUSED</a> <a class="code" href="namespacellvm.html#a7c469a194119a14e5a018ebb9b847cf0">operator&lt;</a>(<span class="keywordtype">unsigned</span> V,</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;                                                <span class="keyword">const</span> TableEntry &amp;TE) {</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;      <span class="keywordflow">return</span> V &lt; TE.from;</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    }</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;  };</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;}</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;<span class="preprocessor">#ifndef NDEBUG</span></div><div class="line"><a name="l00589"></a><span class="lineno"><a class="line" href="X86FloatingPoint_8cpp.html#a6504ea1184d62ab95799d9ae9f958c14">  589</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="X86FloatingPoint_8cpp.html#a6504ea1184d62ab95799d9ae9f958c14">TableIsSorted</a>(<span class="keyword">const</span> TableEntry *Table, <span class="keywordtype">unsigned</span> NumEntries) {</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != NumEntries-1; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    <span class="keywordflow">if</span> (!(Table[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>] &lt; Table[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>+1])) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;}</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;</div><div class="line"><a name="l00596"></a><span class="lineno"><a class="line" href="X86FloatingPoint_8cpp.html#a386baa6afd7f1266869bb8fdc44f29d0">  596</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="X86FloatingPoint_8cpp.html#a386baa6afd7f1266869bb8fdc44f29d0">Lookup</a>(<span class="keyword">const</span> TableEntry *Table, <span class="keywordtype">unsigned</span> <a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>, <span class="keywordtype">unsigned</span> Opcode) {</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;  <span class="keyword">const</span> TableEntry *I = std::lower_bound(Table, Table+N, Opcode);</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;  <span class="keywordflow">if</span> (I != Table+N &amp;&amp; I-&gt;from == Opcode)</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;    <span class="keywordflow">return</span> I-&gt;to;</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;  <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;}</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;<span class="preprocessor">#ifdef NDEBUG</span></div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;<span class="preprocessor">#define ASSERT_SORTED(TABLE)</span></div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00606"></a><span class="lineno"><a class="line" href="X86FloatingPoint_8cpp.html#a79bccd1176385cddbdfafb156196cc87">  606</a></span>&#160;<span class="preprocessor">#define ASSERT_SORTED(TABLE)                                              \</span></div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;<span class="preprocessor">  { static bool TABLE##Checked = false;                                   \</span></div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;<span class="preprocessor">    if (!TABLE##Checked) {                                                \</span></div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;<span class="preprocessor">       assert(TableIsSorted(TABLE, array_lengthof(TABLE)) &amp;&amp;              \</span></div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;<span class="preprocessor">              &quot;All lookup tables must be sorted for efficient access!&quot;);  \</span></div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;<span class="preprocessor">       TABLE##Checked = true;                                             \</span></div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;<span class="preprocessor">    }                                                                     \</span></div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;<span class="preprocessor">  }</span></div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;<span class="comment">// Register File -&gt; Register Stack Mapping Methods</span></div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;<span class="comment">// OpcodeTable - Sorted map of register instructions to their stack version.</span></div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;<span class="comment">// The first element is an register file pseudo instruction, the second is the</span></div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;<span class="comment">// concrete X86 instruction which uses the register stack.</span></div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00624"></a><span class="lineno"><a class="line" href="X86FloatingPoint_8cpp.html#aba327247fb132ea41094732710efd600">  624</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> TableEntry <a class="code" href="X86FloatingPoint_8cpp.html#aba327247fb132ea41094732710efd600">OpcodeTable</a>[] = {</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;  { X86::ABS_Fp32     , X86::ABS_F     },</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;  { X86::ABS_Fp64     , X86::ABS_F     },</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;  { X86::ABS_Fp80     , X86::ABS_F     },</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;  { X86::ADD_Fp32m    , X86::ADD_F32m  },</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;  { X86::ADD_Fp64m    , X86::ADD_F64m  },</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;  { X86::ADD_Fp64m32  , X86::ADD_F32m  },</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;  { X86::ADD_Fp80m32  , X86::ADD_F32m  },</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;  { X86::ADD_Fp80m64  , X86::ADD_F64m  },</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;  { X86::ADD_FpI16m32 , X86::ADD_FI16m },</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;  { X86::ADD_FpI16m64 , X86::ADD_FI16m },</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;  { X86::ADD_FpI16m80 , X86::ADD_FI16m },</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;  { X86::ADD_FpI32m32 , X86::ADD_FI32m },</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;  { X86::ADD_FpI32m64 , X86::ADD_FI32m },</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;  { X86::ADD_FpI32m80 , X86::ADD_FI32m },</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;  { X86::CHS_Fp32     , X86::CHS_F     },</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;  { X86::CHS_Fp64     , X86::CHS_F     },</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;  { X86::CHS_Fp80     , X86::CHS_F     },</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;  { X86::CMOVBE_Fp32  , X86::CMOVBE_F  },</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;  { X86::CMOVBE_Fp64  , X86::CMOVBE_F  },</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;  { X86::CMOVBE_Fp80  , X86::CMOVBE_F  },</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;  { X86::CMOVB_Fp32   , X86::CMOVB_F   },</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;  { X86::CMOVB_Fp64   , X86::CMOVB_F  },</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;  { X86::CMOVB_Fp80   , X86::CMOVB_F  },</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;  { X86::CMOVE_Fp32   , X86::CMOVE_F  },</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;  { X86::CMOVE_Fp64   , X86::CMOVE_F   },</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;  { X86::CMOVE_Fp80   , X86::CMOVE_F   },</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;  { X86::CMOVNBE_Fp32 , X86::CMOVNBE_F },</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;  { X86::CMOVNBE_Fp64 , X86::CMOVNBE_F },</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;  { X86::CMOVNBE_Fp80 , X86::CMOVNBE_F },</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;  { X86::CMOVNB_Fp32  , X86::CMOVNB_F  },</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;  { X86::CMOVNB_Fp64  , X86::CMOVNB_F  },</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;  { X86::CMOVNB_Fp80  , X86::CMOVNB_F  },</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;  { X86::CMOVNE_Fp32  , X86::CMOVNE_F  },</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;  { X86::CMOVNE_Fp64  , X86::CMOVNE_F  },</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;  { X86::CMOVNE_Fp80  , X86::CMOVNE_F  },</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;  { X86::CMOVNP_Fp32  , X86::CMOVNP_F  },</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;  { X86::CMOVNP_Fp64  , X86::CMOVNP_F  },</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;  { X86::CMOVNP_Fp80  , X86::CMOVNP_F  },</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;  { X86::CMOVP_Fp32   , X86::CMOVP_F   },</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;  { X86::CMOVP_Fp64   , X86::CMOVP_F   },</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;  { X86::CMOVP_Fp80   , X86::CMOVP_F   },</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;  { X86::COS_Fp32     , X86::COS_F     },</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;  { X86::COS_Fp64     , X86::COS_F     },</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;  { X86::COS_Fp80     , X86::COS_F     },</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;  { X86::DIVR_Fp32m   , X86::DIVR_F32m },</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;  { X86::DIVR_Fp64m   , X86::DIVR_F64m },</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;  { X86::DIVR_Fp64m32 , X86::DIVR_F32m },</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;  { X86::DIVR_Fp80m32 , X86::DIVR_F32m },</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;  { X86::DIVR_Fp80m64 , X86::DIVR_F64m },</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;  { X86::DIVR_FpI16m32, X86::DIVR_FI16m},</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;  { X86::DIVR_FpI16m64, X86::DIVR_FI16m},</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;  { X86::DIVR_FpI16m80, X86::DIVR_FI16m},</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;  { X86::DIVR_FpI32m32, X86::DIVR_FI32m},</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;  { X86::DIVR_FpI32m64, X86::DIVR_FI32m},</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;  { X86::DIVR_FpI32m80, X86::DIVR_FI32m},</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;  { X86::DIV_Fp32m    , X86::DIV_F32m  },</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;  { X86::DIV_Fp64m    , X86::DIV_F64m  },</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;  { X86::DIV_Fp64m32  , X86::DIV_F32m  },</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;  { X86::DIV_Fp80m32  , X86::DIV_F32m  },</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;  { X86::DIV_Fp80m64  , X86::DIV_F64m  },</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;  { X86::DIV_FpI16m32 , X86::DIV_FI16m },</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;  { X86::DIV_FpI16m64 , X86::DIV_FI16m },</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;  { X86::DIV_FpI16m80 , X86::DIV_FI16m },</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;  { X86::DIV_FpI32m32 , X86::DIV_FI32m },</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;  { X86::DIV_FpI32m64 , X86::DIV_FI32m },</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;  { X86::DIV_FpI32m80 , X86::DIV_FI32m },</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;  { X86::ILD_Fp16m32  , X86::ILD_F16m  },</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;  { X86::ILD_Fp16m64  , X86::ILD_F16m  },</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;  { X86::ILD_Fp16m80  , X86::ILD_F16m  },</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;  { X86::ILD_Fp32m32  , X86::ILD_F32m  },</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;  { X86::ILD_Fp32m64  , X86::ILD_F32m  },</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;  { X86::ILD_Fp32m80  , X86::ILD_F32m  },</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;  { X86::ILD_Fp64m32  , X86::ILD_F64m  },</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;  { X86::ILD_Fp64m64  , X86::ILD_F64m  },</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;  { X86::ILD_Fp64m80  , X86::ILD_F64m  },</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;  { X86::ISTT_Fp16m32 , X86::ISTT_FP16m},</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;  { X86::ISTT_Fp16m64 , X86::ISTT_FP16m},</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;  { X86::ISTT_Fp16m80 , X86::ISTT_FP16m},</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;  { X86::ISTT_Fp32m32 , X86::ISTT_FP32m},</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;  { X86::ISTT_Fp32m64 , X86::ISTT_FP32m},</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;  { X86::ISTT_Fp32m80 , X86::ISTT_FP32m},</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;  { X86::ISTT_Fp64m32 , X86::ISTT_FP64m},</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;  { X86::ISTT_Fp64m64 , X86::ISTT_FP64m},</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;  { X86::ISTT_Fp64m80 , X86::ISTT_FP64m},</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;  { X86::IST_Fp16m32  , X86::IST_F16m  },</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;  { X86::IST_Fp16m64  , X86::IST_F16m  },</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;  { X86::IST_Fp16m80  , X86::IST_F16m  },</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;  { X86::IST_Fp32m32  , X86::IST_F32m  },</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;  { X86::IST_Fp32m64  , X86::IST_F32m  },</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;  { X86::IST_Fp32m80  , X86::IST_F32m  },</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;  { X86::IST_Fp64m32  , X86::IST_FP64m },</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;  { X86::IST_Fp64m64  , X86::IST_FP64m },</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;  { X86::IST_Fp64m80  , X86::IST_FP64m },</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;  { X86::LD_Fp032     , X86::LD_F0     },</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;  { X86::LD_Fp064     , X86::LD_F0     },</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;  { X86::LD_Fp080     , X86::LD_F0     },</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;  { X86::LD_Fp132     , X86::LD_F1     },</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;  { X86::LD_Fp164     , X86::LD_F1     },</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;  { X86::LD_Fp180     , X86::LD_F1     },</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;  { X86::LD_Fp32m     , X86::LD_F32m   },</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;  { X86::LD_Fp32m64   , X86::LD_F32m   },</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;  { X86::LD_Fp32m80   , X86::LD_F32m   },</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;  { X86::LD_Fp64m     , X86::LD_F64m   },</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;  { X86::LD_Fp64m80   , X86::LD_F64m   },</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;  { X86::LD_Fp80m     , X86::LD_F80m   },</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;  { X86::MUL_Fp32m    , X86::MUL_F32m  },</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;  { X86::MUL_Fp64m    , X86::MUL_F64m  },</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;  { X86::MUL_Fp64m32  , X86::MUL_F32m  },</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;  { X86::MUL_Fp80m32  , X86::MUL_F32m  },</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;  { X86::MUL_Fp80m64  , X86::MUL_F64m  },</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;  { X86::MUL_FpI16m32 , X86::MUL_FI16m },</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;  { X86::MUL_FpI16m64 , X86::MUL_FI16m },</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;  { X86::MUL_FpI16m80 , X86::MUL_FI16m },</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;  { X86::MUL_FpI32m32 , X86::MUL_FI32m },</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;  { X86::MUL_FpI32m64 , X86::MUL_FI32m },</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;  { X86::MUL_FpI32m80 , X86::MUL_FI32m },</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;  { X86::SIN_Fp32     , X86::SIN_F     },</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;  { X86::SIN_Fp64     , X86::SIN_F     },</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;  { X86::SIN_Fp80     , X86::SIN_F     },</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;  { X86::SQRT_Fp32    , X86::SQRT_F    },</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;  { X86::SQRT_Fp64    , X86::SQRT_F    },</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;  { X86::SQRT_Fp80    , X86::SQRT_F    },</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;  { X86::ST_Fp32m     , X86::ST_F32m   },</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;  { X86::ST_Fp64m     , X86::ST_F64m   },</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;  { X86::ST_Fp64m32   , X86::ST_F32m   },</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;  { X86::ST_Fp80m32   , X86::ST_F32m   },</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;  { X86::ST_Fp80m64   , X86::ST_F64m   },</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;  { X86::ST_FpP80m    , X86::ST_FP80m  },</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;  { X86::SUBR_Fp32m   , X86::SUBR_F32m },</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;  { X86::SUBR_Fp64m   , X86::SUBR_F64m },</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;  { X86::SUBR_Fp64m32 , X86::SUBR_F32m },</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;  { X86::SUBR_Fp80m32 , X86::SUBR_F32m },</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;  { X86::SUBR_Fp80m64 , X86::SUBR_F64m },</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;  { X86::SUBR_FpI16m32, X86::SUBR_FI16m},</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;  { X86::SUBR_FpI16m64, X86::SUBR_FI16m},</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;  { X86::SUBR_FpI16m80, X86::SUBR_FI16m},</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;  { X86::SUBR_FpI32m32, X86::SUBR_FI32m},</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;  { X86::SUBR_FpI32m64, X86::SUBR_FI32m},</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;  { X86::SUBR_FpI32m80, X86::SUBR_FI32m},</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;  { X86::SUB_Fp32m    , X86::SUB_F32m  },</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;  { X86::SUB_Fp64m    , X86::SUB_F64m  },</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;  { X86::SUB_Fp64m32  , X86::SUB_F32m  },</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;  { X86::SUB_Fp80m32  , X86::SUB_F32m  },</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;  { X86::SUB_Fp80m64  , X86::SUB_F64m  },</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;  { X86::SUB_FpI16m32 , X86::SUB_FI16m },</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;  { X86::SUB_FpI16m64 , X86::SUB_FI16m },</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;  { X86::SUB_FpI16m80 , X86::SUB_FI16m },</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;  { X86::SUB_FpI32m32 , X86::SUB_FI32m },</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;  { X86::SUB_FpI32m64 , X86::SUB_FI32m },</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;  { X86::SUB_FpI32m80 , X86::SUB_FI32m },</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;  { X86::TST_Fp32     , X86::TST_F     },</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;  { X86::TST_Fp64     , X86::TST_F     },</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;  { X86::TST_Fp80     , X86::TST_F     },</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;  { X86::UCOM_FpIr32  , X86::UCOM_FIr  },</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;  { X86::UCOM_FpIr64  , X86::UCOM_FIr  },</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;  { X86::UCOM_FpIr80  , X86::UCOM_FIr  },</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;  { X86::UCOM_Fpr32   , X86::UCOM_Fr   },</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;  { X86::UCOM_Fpr64   , X86::UCOM_Fr   },</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;  { X86::UCOM_Fpr80   , X86::UCOM_Fr   },</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;};</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;</div><div class="line"><a name="l00786"></a><span class="lineno"><a class="line" href="X86FloatingPoint_8cpp.html#acc4a1cce0acc04a92e9866fad21bb3b5">  786</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">unsigned</span> <a class="code" href="X86FloatingPoint_8cpp.html#acc4a1cce0acc04a92e9866fad21bb3b5">getConcreteOpcode</a>(<span class="keywordtype">unsigned</span> Opcode) {</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;  <a class="code" href="X86FloatingPoint_8cpp.html#a79bccd1176385cddbdfafb156196cc87">ASSERT_SORTED</a>(OpcodeTable);</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;  <span class="keywordtype">int</span> Opc = <a class="code" href="X86FloatingPoint_8cpp.html#a386baa6afd7f1266869bb8fdc44f29d0">Lookup</a>(OpcodeTable, <a class="code" href="namespacellvm.html#a370ed0e0f2bb66d17cd13f84be54e867">array_lengthof</a>(OpcodeTable), Opcode);</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;  assert(Opc != -1 &amp;&amp; <span class="stringliteral">&quot;FP Stack instruction not in OpcodeTable!&quot;</span>);</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;  <span class="keywordflow">return</span> Opc;</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;}</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;<span class="comment">// Helper Methods</span></div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;<span class="comment">// PopTable - Sorted map of instructions to their popping version.  The first</span></div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;<span class="comment">// element is an instruction, the second is the version which pops.</span></div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00800"></a><span class="lineno"><a class="line" href="X86FloatingPoint_8cpp.html#acbe3830a216e55fb110225bccb9ffc97">  800</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> TableEntry <a class="code" href="X86FloatingPoint_8cpp.html#acbe3830a216e55fb110225bccb9ffc97">PopTable</a>[] = {</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;  { X86::ADD_FrST0 , X86::ADD_FPrST0  },</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;  { X86::DIVR_FrST0, X86::DIVR_FPrST0 },</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;  { X86::DIV_FrST0 , X86::DIV_FPrST0  },</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;  { X86::IST_F16m  , X86::IST_FP16m   },</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;  { X86::IST_F32m  , X86::IST_FP32m   },</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;  { X86::MUL_FrST0 , X86::MUL_FPrST0  },</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;  { X86::ST_F32m   , X86::ST_FP32m    },</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;  { X86::ST_F64m   , X86::ST_FP64m    },</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;  { X86::ST_Frr    , X86::ST_FPrr     },</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;  { X86::SUBR_FrST0, X86::SUBR_FPrST0 },</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;  { X86::SUB_FrST0 , X86::SUB_FPrST0  },</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;  { X86::UCOM_FIr  , X86::UCOM_FIPr   },</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;  { X86::UCOM_FPr  , X86::UCOM_FPPr   },</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;  { X86::UCOM_Fr   , X86::UCOM_FPr    },</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;};</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;<span class="comment">/// popStackAfter - Pop the current value off of the top of the FP stack after</span></div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;<span class="comment">/// the specified instruction.  This attempts to be sneaky and combine the pop</span></div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;<span class="comment">/// into the instruction itself if possible.  The iterator is left pointing to</span></div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;<span class="comment">/// the last instruction, be it a new pop instruction inserted, or the old</span></div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;<span class="comment">/// instruction if it was modified in place.</span></div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;<span class="comment"></span><span class="keywordtype">void</span> FPS::popStackAfter(<a class="code" href="classllvm_1_1MachineBasicBlock.html#ac51be7ff80fe8d6ae5e8c0acb194908a">MachineBasicBlock::iterator</a> &amp;I) {</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;  <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a>* MI = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>;</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;  <a class="code" href="classllvm_1_1DebugLoc.html">DebugLoc</a> dl = MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a5ca4af2a257043145ad650eafb4402f9">getDebugLoc</a>();</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;  <a class="code" href="X86FloatingPoint_8cpp.html#a79bccd1176385cddbdfafb156196cc87">ASSERT_SORTED</a>(PopTable);</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;  <span class="keywordflow">if</span> (StackTop == 0)</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;    <a class="code" href="namespacellvm.html#a1f6978055dbb761b380de39070e34bd3">report_fatal_error</a>(<span class="stringliteral">&quot;Cannot pop empty stack!&quot;</span>);</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;  RegMap[Stack[--StackTop]] = ~0;     <span class="comment">// Update state</span></div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;  <span class="comment">// Check to see if there is a popping version of this instruction...</span></div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;  <span class="keywordtype">int</span> Opcode = <a class="code" href="X86FloatingPoint_8cpp.html#a386baa6afd7f1266869bb8fdc44f29d0">Lookup</a>(PopTable, <a class="code" href="namespacellvm.html#a370ed0e0f2bb66d17cd13f84be54e867">array_lengthof</a>(PopTable), I-&gt;getOpcode());</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;  <span class="keywordflow">if</span> (Opcode != -1) {</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;    I-&gt;setDesc(TII-&gt;<a class="code" href="classllvm_1_1MCInstrInfo.html#ab16f5a81fccfe4b7f645ba5a74ffad02">get</a>(Opcode));</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;    <span class="keywordflow">if</span> (Opcode == X86::UCOM_FPPr)</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;      I-&gt;RemoveOperand(0);</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;  } <span class="keywordflow">else</span> {    <span class="comment">// Insert an explicit pop</span></div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;    I = <a class="code" href="namespacellvm.html#a980570dc1410d4ef53806f82028ca381">BuildMI</a>(*MBB, ++I, dl, TII-&gt;<a class="code" href="classllvm_1_1MCInstrInfo.html#ab16f5a81fccfe4b7f645ba5a74ffad02">get</a>(X86::ST_FPrr)).addReg(X86::ST0);</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;  }</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;}</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;<span class="comment">/// freeStackSlotAfter - Free the specified register from the register stack, so</span></div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;<span class="comment">/// that it is no longer in a register.  If the register is currently at the top</span></div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;<span class="comment">/// of the stack, we just pop the current instruction, otherwise we store the</span></div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;<span class="comment">/// current top-of-stack into the specified slot, then pop the top of stack.</span></div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;<span class="comment"></span><span class="keywordtype">void</span> FPS::freeStackSlotAfter(<a class="code" href="classllvm_1_1MachineBasicBlock.html#ac51be7ff80fe8d6ae5e8c0acb194908a">MachineBasicBlock::iterator</a> &amp;I, <span class="keywordtype">unsigned</span> FPRegNo) {</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;  <span class="keywordflow">if</span> (getStackEntry(0) == FPRegNo) {  <span class="comment">// already at the top of stack? easy.</span></div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;    popStackAfter(I);</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;  }</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;  <span class="comment">// Otherwise, store the top of stack into the dead slot, killing the operand</span></div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;  <span class="comment">// without having to add in an explicit xchg then pop.</span></div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;  <span class="comment">//</span></div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;  I = freeStackSlotBefore(++I, FPRegNo);</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;}</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;<span class="comment">/// freeStackSlotBefore - Free the specified register without trying any</span></div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;<span class="comment">/// folding.</span></div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;<span class="comment"></span><a class="code" href="classllvm_1_1MachineBasicBlock.html#ac51be7ff80fe8d6ae5e8c0acb194908a">MachineBasicBlock::iterator</a></div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;FPS::freeStackSlotBefore(<a class="code" href="classllvm_1_1MachineBasicBlock.html#ac51be7ff80fe8d6ae5e8c0acb194908a">MachineBasicBlock::iterator</a> I, <span class="keywordtype">unsigned</span> FPRegNo) {</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;  <span class="keywordtype">unsigned</span> STReg    = getSTReg(FPRegNo);</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;  <span class="keywordtype">unsigned</span> OldSlot  = getSlot(FPRegNo);</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;  <span class="keywordtype">unsigned</span> TopReg   = Stack[StackTop-1];</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;  Stack[OldSlot]    = TopReg;</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;  RegMap[TopReg]    = OldSlot;</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;  RegMap[FPRegNo]   = ~0;</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;  Stack[--StackTop] = ~0;</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#a980570dc1410d4ef53806f82028ca381">BuildMI</a>(*MBB, I, <a class="code" href="classllvm_1_1DebugLoc.html">DebugLoc</a>(), TII-&gt;<a class="code" href="classllvm_1_1MCInstrInfo.html#ab16f5a81fccfe4b7f645ba5a74ffad02">get</a>(X86::ST_FPrr)).addReg(STReg);</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;}</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;<span class="comment">/// adjustLiveRegs - Kill and revive registers such that exactly the FP</span></div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;<span class="comment">/// registers with a bit in Mask are live.</span></div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;<span class="comment"></span><span class="keywordtype">void</span> FPS::adjustLiveRegs(<span class="keywordtype">unsigned</span> Mask, <a class="code" href="classllvm_1_1MachineBasicBlock.html#ac51be7ff80fe8d6ae5e8c0acb194908a">MachineBasicBlock::iterator</a> I) {</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;  <span class="keywordtype">unsigned</span> Defs = Mask;</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;  <span class="keywordtype">unsigned</span> Kills = 0;</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; StackTop; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;    <span class="keywordtype">unsigned</span> RegNo = Stack[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;    <span class="keywordflow">if</span> (!(Defs &amp; (1 &lt;&lt; RegNo)))</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;      <span class="comment">// This register is live, but we don&#39;t want it.</span></div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;      Kills |= (1 &lt;&lt; RegNo);</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;      <span class="comment">// We don&#39;t need to imp-def this live register.</span></div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;      Defs &amp;= ~(1 &lt;&lt; RegNo);</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;  }</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;  assert((Kills &amp; Defs) == 0 &amp;&amp; <span class="stringliteral">&quot;Register needs killing and def&#39;ing?&quot;</span>);</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;  <span class="comment">// Produce implicit-defs for free by using killed registers.</span></div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;  <span class="keywordflow">while</span> (Kills &amp;&amp; Defs) {</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;    <span class="keywordtype">unsigned</span> KReg = <a class="code" href="namespacellvm.html#abdaf1eaf6120421977095bd97eee892e">countTrailingZeros</a>(Kills);</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;    <span class="keywordtype">unsigned</span> DReg = <a class="code" href="namespacellvm.html#abdaf1eaf6120421977095bd97eee892e">countTrailingZeros</a>(Defs);</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;    <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Renaming %FP&quot;</span> &lt;&lt; KReg &lt;&lt; <span class="stringliteral">&quot; as imp %FP&quot;</span> &lt;&lt; DReg &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;    <a class="code" href="namespacestd.html#ab8424022895aee3e366fb9a32f2883cb">std::swap</a>(Stack[getSlot(KReg)], Stack[getSlot(DReg)]);</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;    <a class="code" href="namespacestd.html#ab8424022895aee3e366fb9a32f2883cb">std::swap</a>(RegMap[KReg], RegMap[DReg]);</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;    Kills &amp;= ~(1 &lt;&lt; KReg);</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;    Defs &amp;= ~(1 &lt;&lt; DReg);</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;  }</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;  <span class="comment">// Kill registers by popping.</span></div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;  <span class="keywordflow">if</span> (Kills &amp;&amp; I != MBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#ab2d91e7bec944efcbc39d8e30644f111">begin</a>()) {</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;    <a class="code" href="classllvm_1_1MachineBasicBlock.html#ac51be7ff80fe8d6ae5e8c0acb194908a">MachineBasicBlock::iterator</a> I2 = <a class="code" href="namespacellvm.html#a7923e3e207de8bc1d0d6a5091316ddde">llvm::prior</a>(I);</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;    <span class="keywordflow">while</span> (StackTop) {</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;      <span class="keywordtype">unsigned</span> KReg = getStackEntry(0);</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;      <span class="keywordflow">if</span> (!(Kills &amp; (1 &lt;&lt; KReg)))</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;      <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Popping %FP&quot;</span> &lt;&lt; KReg &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;      popStackAfter(I2);</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;      Kills &amp;= ~(1 &lt;&lt; KReg);</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;    }</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;  }</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;  <span class="comment">// Manually kill the rest.</span></div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;  <span class="keywordflow">while</span> (Kills) {</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;    <span class="keywordtype">unsigned</span> KReg = <a class="code" href="namespacellvm.html#abdaf1eaf6120421977095bd97eee892e">countTrailingZeros</a>(Kills);</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;    <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Killing %FP&quot;</span> &lt;&lt; KReg &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;    freeStackSlotBefore(I, KReg);</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;    Kills &amp;= ~(1 &lt;&lt; KReg);</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;  }</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;  <span class="comment">// Load zeros for all the imp-defs.</span></div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;  <span class="keywordflow">while</span>(Defs) {</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;    <span class="keywordtype">unsigned</span> DReg = <a class="code" href="namespacellvm.html#abdaf1eaf6120421977095bd97eee892e">countTrailingZeros</a>(Defs);</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;    <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Defining %FP&quot;</span> &lt;&lt; DReg &lt;&lt; <span class="stringliteral">&quot; as 0\n&quot;</span>);</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;    <a class="code" href="namespacellvm.html#a980570dc1410d4ef53806f82028ca381">BuildMI</a>(*MBB, I, <a class="code" href="classllvm_1_1DebugLoc.html">DebugLoc</a>(), TII-&gt;<a class="code" href="classllvm_1_1MCInstrInfo.html#ab16f5a81fccfe4b7f645ba5a74ffad02">get</a>(X86::LD_F0));</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;    pushReg(DReg);</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;    Defs &amp;= ~(1 &lt;&lt; DReg);</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;  }</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;  <span class="comment">// Now we should have the correct registers live.</span></div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;  <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(dumpStack());</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;  assert(StackTop == <a class="code" href="namespacellvm.html#a5bc63f24ddd2f83ee85383788c5b48cc">CountPopulation_32</a>(Mask) &amp;&amp; <span class="stringliteral">&quot;Live count mismatch&quot;</span>);</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;}</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;<span class="comment">/// shuffleStackTop - emit fxch instructions before I to shuffle the top</span></div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;<span class="comment">/// FixCount entries into the order given by FixStack.</span></div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;<span class="comment">/// FIXME: Is there a better algorithm than insertion sort?</span></div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;<span class="comment"></span><span class="keywordtype">void</span> FPS::shuffleStackTop(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *FixStack,</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;                          <span class="keywordtype">unsigned</span> FixCount,</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;                          <a class="code" href="classllvm_1_1MachineBasicBlock.html#ac51be7ff80fe8d6ae5e8c0acb194908a">MachineBasicBlock::iterator</a> I) {</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;  <span class="comment">// Move items into place, starting from the desired stack bottom.</span></div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;  <span class="keywordflow">while</span> (FixCount--) {</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;    <span class="comment">// Old register at position FixCount.</span></div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;    <span class="keywordtype">unsigned</span> OldReg = getStackEntry(FixCount);</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;    <span class="comment">// Desired register at position FixCount.</span></div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;    <span class="keywordtype">unsigned</span> Reg = FixStack[FixCount];</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;    <span class="keywordflow">if</span> (Reg == OldReg)</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;    <span class="comment">// (Reg st0) (OldReg st0) = (Reg OldReg st0)</span></div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;    moveToTop(Reg, I);</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;    <span class="keywordflow">if</span> (FixCount &gt; 0)</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;      moveToTop(OldReg, I);</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;  }</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;  <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(dumpStack());</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;}</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;<span class="comment">// Instruction transformation implementation</span></div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;<span class="comment">/// handleZeroArgFP - ST(0) = fld0    ST(0) = flds &lt;mem&gt;</span></div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;<span class="comment"></span><span class="keywordtype">void</span> FPS::handleZeroArgFP(<a class="code" href="classllvm_1_1MachineBasicBlock.html#ac51be7ff80fe8d6ae5e8c0acb194908a">MachineBasicBlock::iterator</a> &amp;I) {</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;  <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *MI = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>;</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;  <span class="keywordtype">unsigned</span> DestReg = <a class="code" href="X86FloatingPoint_8cpp.html#aa6438c766cdab5c1e26d802ef9ad14ff">getFPReg</a>(MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a302e45878c6dc1714334c7ce96d56846">getOperand</a>(0));</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;  <span class="comment">// Change from the pseudo instruction to the concrete instruction.</span></div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;  MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a001a88e1d71c2e11ccd57efe75da4af3">RemoveOperand</a>(0);   <span class="comment">// Remove the explicit ST(0) operand</span></div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;  MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a1ecb35298bc4d1fe03997959e1210c87">setDesc</a>(TII-&gt;<a class="code" href="classllvm_1_1MCInstrInfo.html#ab16f5a81fccfe4b7f645ba5a74ffad02">get</a>(<a class="code" href="X86FloatingPoint_8cpp.html#acc4a1cce0acc04a92e9866fad21bb3b5">getConcreteOpcode</a>(MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a242314c0ae0147d1a7ef54c9bc312616">getOpcode</a>())));</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;  <span class="comment">// Result gets pushed on the stack.</span></div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;  pushReg(DestReg);</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;}</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;<span class="comment">/// handleOneArgFP - fst &lt;mem&gt;, ST(0)</span></div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;<span class="comment"></span><span class="keywordtype">void</span> FPS::handleOneArgFP(<a class="code" href="classllvm_1_1MachineBasicBlock.html#ac51be7ff80fe8d6ae5e8c0acb194908a">MachineBasicBlock::iterator</a> &amp;I) {</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;  <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *MI = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>;</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;  <span class="keywordtype">unsigned</span> NumOps = MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a803a7424877fd049679b9aa2f07597b5">getDesc</a>().<a class="code" href="classllvm_1_1MCInstrDesc.html#a55194ec3a1e49d04eab64e993e614246">getNumOperands</a>();</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;  assert((NumOps == <a class="code" href="namespacellvm_1_1X86.html#a2676a7a40e87d37dcdf74487ef47480eac4169d78e1c6de9b189f31b90f1c2691">X86::AddrNumOperands</a> + 1 || NumOps == 1) &amp;&amp;</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;         <span class="stringliteral">&quot;Can only handle fst* &amp; ftst instructions!&quot;</span>);</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;  <span class="comment">// Is this the last use of the source register?</span></div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;  <span class="keywordtype">unsigned</span> Reg = <a class="code" href="X86FloatingPoint_8cpp.html#aa6438c766cdab5c1e26d802ef9ad14ff">getFPReg</a>(MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a302e45878c6dc1714334c7ce96d56846">getOperand</a>(NumOps-1));</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;  <span class="keywordtype">bool</span> KillsSrc = MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#aff83f9aeef903ed06c5098f5172624ed">killsRegister</a>(X86::FP0+Reg);</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;  <span class="keywordflow">if</span> (KillsSrc)</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;    duplicatePendingSTBeforeKill(Reg, I);</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;  <span class="comment">// FISTP64m is strange because there isn&#39;t a non-popping versions.</span></div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;  <span class="comment">// If we have one _and_ we don&#39;t want to pop the operand, duplicate the value</span></div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;  <span class="comment">// on the stack instead of moving it.  This ensure that popping the value is</span></div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;  <span class="comment">// always ok.</span></div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;  <span class="comment">// Ditto FISTTP16m, FISTTP32m, FISTTP64m, ST_FpP80m.</span></div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;  <span class="comment">//</span></div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;  <span class="keywordflow">if</span> (!KillsSrc &amp;&amp;</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;      (MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a242314c0ae0147d1a7ef54c9bc312616">getOpcode</a>() == X86::IST_Fp64m32 ||</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;       MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a242314c0ae0147d1a7ef54c9bc312616">getOpcode</a>() == X86::ISTT_Fp16m32 ||</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;       MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a242314c0ae0147d1a7ef54c9bc312616">getOpcode</a>() == X86::ISTT_Fp32m32 ||</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;       MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a242314c0ae0147d1a7ef54c9bc312616">getOpcode</a>() == X86::ISTT_Fp64m32 ||</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;       MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a242314c0ae0147d1a7ef54c9bc312616">getOpcode</a>() == X86::IST_Fp64m64 ||</div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;       MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a242314c0ae0147d1a7ef54c9bc312616">getOpcode</a>() == X86::ISTT_Fp16m64 ||</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;       MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a242314c0ae0147d1a7ef54c9bc312616">getOpcode</a>() == X86::ISTT_Fp32m64 ||</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;       MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a242314c0ae0147d1a7ef54c9bc312616">getOpcode</a>() == X86::ISTT_Fp64m64 ||</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;       MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a242314c0ae0147d1a7ef54c9bc312616">getOpcode</a>() == X86::IST_Fp64m80 ||</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;       MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a242314c0ae0147d1a7ef54c9bc312616">getOpcode</a>() == X86::ISTT_Fp16m80 ||</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;       MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a242314c0ae0147d1a7ef54c9bc312616">getOpcode</a>() == X86::ISTT_Fp32m80 ||</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;       MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a242314c0ae0147d1a7ef54c9bc312616">getOpcode</a>() == X86::ISTT_Fp64m80 ||</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;       MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a242314c0ae0147d1a7ef54c9bc312616">getOpcode</a>() == X86::ST_FpP80m)) {</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;    duplicateToTop(Reg, getScratchReg(), I);</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;    moveToTop(Reg, I);            <span class="comment">// Move to the top of the stack...</span></div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;  }</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;  <span class="comment">// Convert from the pseudo instruction to the concrete instruction.</span></div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;  MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a001a88e1d71c2e11ccd57efe75da4af3">RemoveOperand</a>(NumOps-1);    <span class="comment">// Remove explicit ST(0) operand</span></div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;  MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a1ecb35298bc4d1fe03997959e1210c87">setDesc</a>(TII-&gt;<a class="code" href="classllvm_1_1MCInstrInfo.html#ab16f5a81fccfe4b7f645ba5a74ffad02">get</a>(<a class="code" href="X86FloatingPoint_8cpp.html#acc4a1cce0acc04a92e9866fad21bb3b5">getConcreteOpcode</a>(MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a242314c0ae0147d1a7ef54c9bc312616">getOpcode</a>())));</div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;  <span class="keywordflow">if</span> (MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a242314c0ae0147d1a7ef54c9bc312616">getOpcode</a>() == X86::IST_FP64m ||</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;      MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a242314c0ae0147d1a7ef54c9bc312616">getOpcode</a>() == X86::ISTT_FP16m ||</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;      MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a242314c0ae0147d1a7ef54c9bc312616">getOpcode</a>() == X86::ISTT_FP32m ||</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;      MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a242314c0ae0147d1a7ef54c9bc312616">getOpcode</a>() == X86::ISTT_FP64m ||</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;      MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a242314c0ae0147d1a7ef54c9bc312616">getOpcode</a>() == X86::ST_FP80m) {</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;    <span class="keywordflow">if</span> (StackTop == 0)</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;      <a class="code" href="namespacellvm.html#a1f6978055dbb761b380de39070e34bd3">report_fatal_error</a>(<span class="stringliteral">&quot;Stack empty??&quot;</span>);</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;    --StackTop;</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (KillsSrc) { <span class="comment">// Last use of operand?</span></div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;    popStackAfter(I);</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;  }</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;}</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;<span class="comment">/// handleOneArgFPRW: Handle instructions that read from the top of stack and</span></div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;<span class="comment">/// replace the value with a newly computed value.  These instructions may have</span></div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;<span class="comment">/// non-fp operands after their FP operands.</span></div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;<span class="comment">///  Examples:</span></div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;<span class="comment">///     R1 = fchs R2</span></div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;<span class="comment">///     R1 = fadd R2, [mem]</span></div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;<span class="comment"></span><span class="keywordtype">void</span> FPS::handleOneArgFPRW(<a class="code" href="classllvm_1_1MachineBasicBlock.html#ac51be7ff80fe8d6ae5e8c0acb194908a">MachineBasicBlock::iterator</a> &amp;I) {</div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;  <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *MI = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>;</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;<span class="preprocessor">#ifndef NDEBUG</span></div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;  <span class="keywordtype">unsigned</span> NumOps = MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a803a7424877fd049679b9aa2f07597b5">getDesc</a>().<a class="code" href="classllvm_1_1MCInstrDesc.html#a55194ec3a1e49d04eab64e993e614246">getNumOperands</a>();</div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;  assert(NumOps &gt;= 2 &amp;&amp; <span class="stringliteral">&quot;FPRW instructions must have 2 ops!!&quot;</span>);</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;  <span class="comment">// Is this the last use of the source register?</span></div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;  <span class="keywordtype">unsigned</span> Reg = <a class="code" href="X86FloatingPoint_8cpp.html#aa6438c766cdab5c1e26d802ef9ad14ff">getFPReg</a>(MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a302e45878c6dc1714334c7ce96d56846">getOperand</a>(1));</div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;  <span class="keywordtype">bool</span> KillsSrc = MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#aff83f9aeef903ed06c5098f5172624ed">killsRegister</a>(X86::FP0+Reg);</div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;  <span class="keywordflow">if</span> (KillsSrc) {</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;    duplicatePendingSTBeforeKill(Reg, I);</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;    <span class="comment">// If this is the last use of the source register, just make sure it&#39;s on</span></div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;    <span class="comment">// the top of the stack.</span></div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;    moveToTop(Reg, I);</div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;    <span class="keywordflow">if</span> (StackTop == 0)</div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;      <a class="code" href="namespacellvm.html#a1f6978055dbb761b380de39070e34bd3">report_fatal_error</a>(<span class="stringliteral">&quot;Stack cannot be empty!&quot;</span>);</div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;    --StackTop;</div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;    pushReg(<a class="code" href="X86FloatingPoint_8cpp.html#aa6438c766cdab5c1e26d802ef9ad14ff">getFPReg</a>(MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a302e45878c6dc1714334c7ce96d56846">getOperand</a>(0)));</div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;    <span class="comment">// If this is not the last use of the source register, _copy_ it to the top</span></div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;    <span class="comment">// of the stack.</span></div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;    duplicateToTop(Reg, <a class="code" href="X86FloatingPoint_8cpp.html#aa6438c766cdab5c1e26d802ef9ad14ff">getFPReg</a>(MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a302e45878c6dc1714334c7ce96d56846">getOperand</a>(0)), I);</div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;  }</div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;</div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;  <span class="comment">// Change from the pseudo instruction to the concrete instruction.</span></div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;  MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a001a88e1d71c2e11ccd57efe75da4af3">RemoveOperand</a>(1);   <span class="comment">// Drop the source operand.</span></div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;  MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a001a88e1d71c2e11ccd57efe75da4af3">RemoveOperand</a>(0);   <span class="comment">// Drop the destination operand.</span></div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;  MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a1ecb35298bc4d1fe03997959e1210c87">setDesc</a>(TII-&gt;<a class="code" href="classllvm_1_1MCInstrInfo.html#ab16f5a81fccfe4b7f645ba5a74ffad02">get</a>(<a class="code" href="X86FloatingPoint_8cpp.html#acc4a1cce0acc04a92e9866fad21bb3b5">getConcreteOpcode</a>(MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a242314c0ae0147d1a7ef54c9bc312616">getOpcode</a>())));</div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;}</div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;</div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;</div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;<span class="comment">// Define tables of various ways to map pseudo instructions</span></div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;</div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;<span class="comment">// ForwardST0Table - Map: A = B op C  into: ST(0) = ST(0) op ST(i)</span></div><div class="line"><a name="l01086"></a><span class="lineno"><a class="line" href="X86FloatingPoint_8cpp.html#a83c82a7a8e5af3b2f88962cdec3952ef"> 1086</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> TableEntry <a class="code" href="X86FloatingPoint_8cpp.html#a83c82a7a8e5af3b2f88962cdec3952ef">ForwardST0Table</a>[] = {</div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;  { X86::ADD_Fp32  , X86::ADD_FST0r },</div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;  { X86::ADD_Fp64  , X86::ADD_FST0r },</div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;  { X86::ADD_Fp80  , X86::ADD_FST0r },</div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;  { X86::DIV_Fp32  , X86::DIV_FST0r },</div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;  { X86::DIV_Fp64  , X86::DIV_FST0r },</div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;  { X86::DIV_Fp80  , X86::DIV_FST0r },</div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;  { X86::MUL_Fp32  , X86::MUL_FST0r },</div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;  { X86::MUL_Fp64  , X86::MUL_FST0r },</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;  { X86::MUL_Fp80  , X86::MUL_FST0r },</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;  { X86::SUB_Fp32  , X86::SUB_FST0r },</div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;  { X86::SUB_Fp64  , X86::SUB_FST0r },</div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;  { X86::SUB_Fp80  , X86::SUB_FST0r },</div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;};</div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;</div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;<span class="comment">// ReverseST0Table - Map: A = B op C  into: ST(0) = ST(i) op ST(0)</span></div><div class="line"><a name="l01102"></a><span class="lineno"><a class="line" href="X86FloatingPoint_8cpp.html#a3f0984675b87018d44304c32575a7c47"> 1102</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> TableEntry <a class="code" href="X86FloatingPoint_8cpp.html#a3f0984675b87018d44304c32575a7c47">ReverseST0Table</a>[] = {</div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;  { X86::ADD_Fp32  , X86::ADD_FST0r  },   <span class="comment">// commutative</span></div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;  { X86::ADD_Fp64  , X86::ADD_FST0r  },   <span class="comment">// commutative</span></div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;  { X86::ADD_Fp80  , X86::ADD_FST0r  },   <span class="comment">// commutative</span></div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;  { X86::DIV_Fp32  , X86::DIVR_FST0r },</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;  { X86::DIV_Fp64  , X86::DIVR_FST0r },</div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;  { X86::DIV_Fp80  , X86::DIVR_FST0r },</div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;  { X86::MUL_Fp32  , X86::MUL_FST0r  },   <span class="comment">// commutative</span></div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;  { X86::MUL_Fp64  , X86::MUL_FST0r  },   <span class="comment">// commutative</span></div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;  { X86::MUL_Fp80  , X86::MUL_FST0r  },   <span class="comment">// commutative</span></div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;  { X86::SUB_Fp32  , X86::SUBR_FST0r },</div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;  { X86::SUB_Fp64  , X86::SUBR_FST0r },</div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;  { X86::SUB_Fp80  , X86::SUBR_FST0r },</div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;};</div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;</div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;<span class="comment">// ForwardSTiTable - Map: A = B op C  into: ST(i) = ST(0) op ST(i)</span></div><div class="line"><a name="l01118"></a><span class="lineno"><a class="line" href="X86FloatingPoint_8cpp.html#aaaafaa1cac63fc196f14174327a87eb5"> 1118</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> TableEntry <a class="code" href="X86FloatingPoint_8cpp.html#aaaafaa1cac63fc196f14174327a87eb5">ForwardSTiTable</a>[] = {</div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;  { X86::ADD_Fp32  , X86::ADD_FrST0  },   <span class="comment">// commutative</span></div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;  { X86::ADD_Fp64  , X86::ADD_FrST0  },   <span class="comment">// commutative</span></div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;  { X86::ADD_Fp80  , X86::ADD_FrST0  },   <span class="comment">// commutative</span></div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;  { X86::DIV_Fp32  , X86::DIVR_FrST0 },</div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;  { X86::DIV_Fp64  , X86::DIVR_FrST0 },</div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;  { X86::DIV_Fp80  , X86::DIVR_FrST0 },</div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;  { X86::MUL_Fp32  , X86::MUL_FrST0  },   <span class="comment">// commutative</span></div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;  { X86::MUL_Fp64  , X86::MUL_FrST0  },   <span class="comment">// commutative</span></div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;  { X86::MUL_Fp80  , X86::MUL_FrST0  },   <span class="comment">// commutative</span></div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;  { X86::SUB_Fp32  , X86::SUBR_FrST0 },</div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;  { X86::SUB_Fp64  , X86::SUBR_FrST0 },</div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;  { X86::SUB_Fp80  , X86::SUBR_FrST0 },</div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;};</div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;</div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;<span class="comment">// ReverseSTiTable - Map: A = B op C  into: ST(i) = ST(i) op ST(0)</span></div><div class="line"><a name="l01134"></a><span class="lineno"><a class="line" href="X86FloatingPoint_8cpp.html#abe556c5eca51a99b45126470f269dc9c"> 1134</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> TableEntry <a class="code" href="X86FloatingPoint_8cpp.html#abe556c5eca51a99b45126470f269dc9c">ReverseSTiTable</a>[] = {</div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;  { X86::ADD_Fp32  , X86::ADD_FrST0 },</div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;  { X86::ADD_Fp64  , X86::ADD_FrST0 },</div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;  { X86::ADD_Fp80  , X86::ADD_FrST0 },</div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;  { X86::DIV_Fp32  , X86::DIV_FrST0 },</div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;  { X86::DIV_Fp64  , X86::DIV_FrST0 },</div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;  { X86::DIV_Fp80  , X86::DIV_FrST0 },</div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;  { X86::MUL_Fp32  , X86::MUL_FrST0 },</div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;  { X86::MUL_Fp64  , X86::MUL_FrST0 },</div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;  { X86::MUL_Fp80  , X86::MUL_FrST0 },</div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;  { X86::SUB_Fp32  , X86::SUB_FrST0 },</div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;  { X86::SUB_Fp64  , X86::SUB_FrST0 },</div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;  { X86::SUB_Fp80  , X86::SUB_FrST0 },</div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;};</div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;</div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;<span class="comment">/// handleTwoArgFP - Handle instructions like FADD and friends which are virtual</span></div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;<span class="comment">/// instructions which need to be simplified and possibly transformed.</span></div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;<span class="comment">/// Result: ST(0) = fsub  ST(0), ST(i)</span></div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;<span class="comment">///         ST(i) = fsub  ST(0), ST(i)</span></div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;<span class="comment">///         ST(0) = fsubr ST(0), ST(i)</span></div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;<span class="comment">///         ST(i) = fsubr ST(0), ST(i)</span></div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;<span class="comment"></span><span class="keywordtype">void</span> FPS::handleTwoArgFP(<a class="code" href="classllvm_1_1MachineBasicBlock.html#ac51be7ff80fe8d6ae5e8c0acb194908a">MachineBasicBlock::iterator</a> &amp;I) {</div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;  <a class="code" href="X86FloatingPoint_8cpp.html#a79bccd1176385cddbdfafb156196cc87">ASSERT_SORTED</a>(ForwardST0Table); <a class="code" href="X86FloatingPoint_8cpp.html#a79bccd1176385cddbdfafb156196cc87">ASSERT_SORTED</a>(ReverseST0Table);</div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;  <a class="code" href="X86FloatingPoint_8cpp.html#a79bccd1176385cddbdfafb156196cc87">ASSERT_SORTED</a>(ForwardSTiTable); <a class="code" href="X86FloatingPoint_8cpp.html#a79bccd1176385cddbdfafb156196cc87">ASSERT_SORTED</a>(ReverseSTiTable);</div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;  <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *MI = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>;</div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;</div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;  <span class="keywordtype">unsigned</span> NumOperands = MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a803a7424877fd049679b9aa2f07597b5">getDesc</a>().<a class="code" href="classllvm_1_1MCInstrDesc.html#a55194ec3a1e49d04eab64e993e614246">getNumOperands</a>();</div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;  assert(NumOperands == 3 &amp;&amp; <span class="stringliteral">&quot;Illegal TwoArgFP instruction!&quot;</span>);</div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;  <span class="keywordtype">unsigned</span> Dest = <a class="code" href="X86FloatingPoint_8cpp.html#aa6438c766cdab5c1e26d802ef9ad14ff">getFPReg</a>(MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a302e45878c6dc1714334c7ce96d56846">getOperand</a>(0));</div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;  <span class="keywordtype">unsigned</span> Op0 = <a class="code" href="X86FloatingPoint_8cpp.html#aa6438c766cdab5c1e26d802ef9ad14ff">getFPReg</a>(MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a302e45878c6dc1714334c7ce96d56846">getOperand</a>(NumOperands-2));</div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;  <span class="keywordtype">unsigned</span> Op1 = <a class="code" href="X86FloatingPoint_8cpp.html#aa6438c766cdab5c1e26d802ef9ad14ff">getFPReg</a>(MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a302e45878c6dc1714334c7ce96d56846">getOperand</a>(NumOperands-1));</div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;  <span class="keywordtype">bool</span> KillsOp0 = MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#aff83f9aeef903ed06c5098f5172624ed">killsRegister</a>(X86::FP0+Op0);</div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;  <span class="keywordtype">bool</span> KillsOp1 = MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#aff83f9aeef903ed06c5098f5172624ed">killsRegister</a>(X86::FP0+Op1);</div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;  <a class="code" href="classllvm_1_1DebugLoc.html">DebugLoc</a> dl = MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a5ca4af2a257043145ad650eafb4402f9">getDebugLoc</a>();</div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;</div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;  <span class="keywordtype">unsigned</span> TOS = getStackEntry(0);</div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;</div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;  <span class="comment">// One of our operands must be on the top of the stack.  If neither is yet, we</span></div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;  <span class="comment">// need to move one.</span></div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;  <span class="keywordflow">if</span> (Op0 != TOS &amp;&amp; Op1 != TOS) {   <span class="comment">// No operand at TOS?</span></div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;    <span class="comment">// We can choose to move either operand to the top of the stack.  If one of</span></div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;    <span class="comment">// the operands is killed by this instruction, we want that one so that we</span></div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;    <span class="comment">// can update right on top of the old version.</span></div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;    <span class="keywordflow">if</span> (KillsOp0) {</div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;      moveToTop(Op0, I);         <span class="comment">// Move dead operand to TOS.</span></div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;      TOS = Op0;</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (KillsOp1) {</div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;      moveToTop(Op1, I);</div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;      TOS = Op1;</div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;      <span class="comment">// All of the operands are live after this instruction executes, so we</span></div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;      <span class="comment">// cannot update on top of any operand.  Because of this, we must</span></div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;      <span class="comment">// duplicate one of the stack elements to the top.  It doesn&#39;t matter</span></div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;      <span class="comment">// which one we pick.</span></div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;      <span class="comment">//</span></div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;      duplicateToTop(Op0, Dest, I);</div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;      Op0 = TOS = Dest;</div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;      KillsOp0 = <span class="keyword">true</span>;</div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;    }</div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!KillsOp0 &amp;&amp; !KillsOp1) {</div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;    <span class="comment">// If we DO have one of our operands at the top of the stack, but we don&#39;t</span></div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;    <span class="comment">// have a dead operand, we must duplicate one of the operands to a new slot</span></div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;    <span class="comment">// on the stack.</span></div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;    duplicateToTop(Op0, Dest, I);</div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;    Op0 = TOS = Dest;</div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;    KillsOp0 = <span class="keyword">true</span>;</div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;  }</div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;</div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;  <span class="comment">// Now we know that one of our operands is on the top of the stack, and at</span></div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;  <span class="comment">// least one of our operands is killed by this instruction.</span></div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;  assert((TOS == Op0 || TOS == Op1) &amp;&amp; (KillsOp0 || KillsOp1) &amp;&amp;</div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;         <span class="stringliteral">&quot;Stack conditions not set up right!&quot;</span>);</div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;</div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;  <span class="comment">// We decide which form to use based on what is on the top of the stack, and</span></div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;  <span class="comment">// which operand is killed by this instruction.</span></div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;  <span class="keyword">const</span> TableEntry *InstTable;</div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;  <span class="keywordtype">bool</span> isForward = TOS == Op0;</div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;  <span class="keywordtype">bool</span> updateST0 = (TOS == Op0 &amp;&amp; !KillsOp1) || (TOS == Op1 &amp;&amp; !KillsOp0);</div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;  <span class="keywordflow">if</span> (updateST0) {</div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;    <span class="keywordflow">if</span> (isForward)</div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;      InstTable = <a class="code" href="X86FloatingPoint_8cpp.html#a83c82a7a8e5af3b2f88962cdec3952ef">ForwardST0Table</a>;</div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;      InstTable = <a class="code" href="X86FloatingPoint_8cpp.html#a3f0984675b87018d44304c32575a7c47">ReverseST0Table</a>;</div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;    <span class="keywordflow">if</span> (isForward)</div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;      InstTable = <a class="code" href="X86FloatingPoint_8cpp.html#aaaafaa1cac63fc196f14174327a87eb5">ForwardSTiTable</a>;</div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;      InstTable = <a class="code" href="X86FloatingPoint_8cpp.html#abe556c5eca51a99b45126470f269dc9c">ReverseSTiTable</a>;</div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;  }</div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;</div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;  <span class="keywordtype">int</span> Opcode = <a class="code" href="X86FloatingPoint_8cpp.html#a386baa6afd7f1266869bb8fdc44f29d0">Lookup</a>(InstTable, <a class="code" href="namespacellvm.html#a370ed0e0f2bb66d17cd13f84be54e867">array_lengthof</a>(ForwardST0Table),</div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;                      MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a242314c0ae0147d1a7ef54c9bc312616">getOpcode</a>());</div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;  assert(Opcode != -1 &amp;&amp; <span class="stringliteral">&quot;Unknown TwoArgFP pseudo instruction!&quot;</span>);</div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;</div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;  <span class="comment">// NotTOS - The register which is not on the top of stack...</span></div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;  <span class="keywordtype">unsigned</span> NotTOS = (TOS == Op0) ? Op1 : Op0;</div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;</div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;  <span class="comment">// Replace the old instruction with a new instruction</span></div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;  MBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#a00c9d82d8d59adedd1734fed16051c73">remove</a>(I++);</div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;  I = <a class="code" href="namespacellvm.html#a980570dc1410d4ef53806f82028ca381">BuildMI</a>(*MBB, I, dl, TII-&gt;<a class="code" href="classllvm_1_1MCInstrInfo.html#ab16f5a81fccfe4b7f645ba5a74ffad02">get</a>(Opcode)).addReg(getSTReg(NotTOS));</div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;</div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;  <span class="comment">// If both operands are killed, pop one off of the stack in addition to</span></div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;  <span class="comment">// overwriting the other one.</span></div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;  <span class="keywordflow">if</span> (KillsOp0 &amp;&amp; KillsOp1 &amp;&amp; Op0 != Op1) {</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;    assert(!updateST0 &amp;&amp; <span class="stringliteral">&quot;Should have updated other operand!&quot;</span>);</div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;    popStackAfter(I);   <span class="comment">// Pop the top of stack</span></div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;  }</div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;</div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;  <span class="comment">// Update stack information so that we know the destination register is now on</span></div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;  <span class="comment">// the stack.</span></div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;  <span class="keywordtype">unsigned</span> UpdatedSlot = getSlot(updateST0 ? TOS : NotTOS);</div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;  assert(UpdatedSlot &lt; StackTop &amp;&amp; Dest &lt; 7);</div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;  Stack[UpdatedSlot]   = Dest;</div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;  RegMap[Dest]         = UpdatedSlot;</div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;  MBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#af2e482ff2a9253ec6bc2285491496bd6">getParent</a>()-&gt;<a class="code" href="classllvm_1_1MachineFunction.html#a61126c45c9c4b281173205f7bc3ef241">DeleteMachineInstr</a>(MI); <span class="comment">// Remove the old instruction</span></div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;}</div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;<span class="comment">/// handleCompareFP - Handle FUCOM and FUCOMI instructions, which have two FP</span></div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;<span class="comment">/// register arguments and no explicit destinations.</span></div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;<span class="comment"></span><span class="keywordtype">void</span> FPS::handleCompareFP(<a class="code" href="classllvm_1_1MachineBasicBlock.html#ac51be7ff80fe8d6ae5e8c0acb194908a">MachineBasicBlock::iterator</a> &amp;I) {</div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;  <a class="code" href="X86FloatingPoint_8cpp.html#a79bccd1176385cddbdfafb156196cc87">ASSERT_SORTED</a>(ForwardST0Table); <a class="code" href="X86FloatingPoint_8cpp.html#a79bccd1176385cddbdfafb156196cc87">ASSERT_SORTED</a>(ReverseST0Table);</div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;  <a class="code" href="X86FloatingPoint_8cpp.html#a79bccd1176385cddbdfafb156196cc87">ASSERT_SORTED</a>(ForwardSTiTable); <a class="code" href="X86FloatingPoint_8cpp.html#a79bccd1176385cddbdfafb156196cc87">ASSERT_SORTED</a>(ReverseSTiTable);</div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;  <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *MI = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>;</div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;</div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;  <span class="keywordtype">unsigned</span> NumOperands = MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a803a7424877fd049679b9aa2f07597b5">getDesc</a>().<a class="code" href="classllvm_1_1MCInstrDesc.html#a55194ec3a1e49d04eab64e993e614246">getNumOperands</a>();</div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;  assert(NumOperands == 2 &amp;&amp; <span class="stringliteral">&quot;Illegal FUCOM* instruction!&quot;</span>);</div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;  <span class="keywordtype">unsigned</span> Op0 = <a class="code" href="X86FloatingPoint_8cpp.html#aa6438c766cdab5c1e26d802ef9ad14ff">getFPReg</a>(MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a302e45878c6dc1714334c7ce96d56846">getOperand</a>(NumOperands-2));</div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;  <span class="keywordtype">unsigned</span> Op1 = <a class="code" href="X86FloatingPoint_8cpp.html#aa6438c766cdab5c1e26d802ef9ad14ff">getFPReg</a>(MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a302e45878c6dc1714334c7ce96d56846">getOperand</a>(NumOperands-1));</div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;  <span class="keywordtype">bool</span> KillsOp0 = MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#aff83f9aeef903ed06c5098f5172624ed">killsRegister</a>(X86::FP0+Op0);</div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;  <span class="keywordtype">bool</span> KillsOp1 = MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#aff83f9aeef903ed06c5098f5172624ed">killsRegister</a>(X86::FP0+Op1);</div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;</div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;  <span class="comment">// Make sure the first operand is on the top of stack, the other one can be</span></div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;  <span class="comment">// anywhere.</span></div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;  moveToTop(Op0, I);</div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;</div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;  <span class="comment">// Change from the pseudo instruction to the concrete instruction.</span></div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;  MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a302e45878c6dc1714334c7ce96d56846">getOperand</a>(0).<a class="code" href="classllvm_1_1MachineOperand.html#a624a062754a09d3787614d8627096705">setReg</a>(getSTReg(Op1));</div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;  MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a001a88e1d71c2e11ccd57efe75da4af3">RemoveOperand</a>(1);</div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;  MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a1ecb35298bc4d1fe03997959e1210c87">setDesc</a>(TII-&gt;<a class="code" href="classllvm_1_1MCInstrInfo.html#ab16f5a81fccfe4b7f645ba5a74ffad02">get</a>(<a class="code" href="X86FloatingPoint_8cpp.html#acc4a1cce0acc04a92e9866fad21bb3b5">getConcreteOpcode</a>(MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a242314c0ae0147d1a7ef54c9bc312616">getOpcode</a>())));</div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;</div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;  <span class="comment">// If any of the operands are killed by this instruction, free them.</span></div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;  <span class="keywordflow">if</span> (KillsOp0) freeStackSlotAfter(I, Op0);</div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;  <span class="keywordflow">if</span> (KillsOp1 &amp;&amp; Op0 != Op1) freeStackSlotAfter(I, Op1);</div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;}</div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;<span class="comment">/// handleCondMovFP - Handle two address conditional move instructions.  These</span></div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;<span class="comment">/// instructions move a st(i) register to st(0) iff a condition is true.  These</span></div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;<span class="comment">/// instructions require that the first operand is at the top of the stack, but</span></div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;<span class="comment">/// otherwise don&#39;t modify the stack at all.</span></div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;<span class="comment"></span><span class="keywordtype">void</span> FPS::handleCondMovFP(<a class="code" href="classllvm_1_1MachineBasicBlock.html#ac51be7ff80fe8d6ae5e8c0acb194908a">MachineBasicBlock::iterator</a> &amp;I) {</div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;  <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *MI = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>;</div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;</div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;  <span class="keywordtype">unsigned</span> Op0 = <a class="code" href="X86FloatingPoint_8cpp.html#aa6438c766cdab5c1e26d802ef9ad14ff">getFPReg</a>(MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a302e45878c6dc1714334c7ce96d56846">getOperand</a>(0));</div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;  <span class="keywordtype">unsigned</span> Op1 = <a class="code" href="X86FloatingPoint_8cpp.html#aa6438c766cdab5c1e26d802ef9ad14ff">getFPReg</a>(MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a302e45878c6dc1714334c7ce96d56846">getOperand</a>(2));</div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;  <span class="keywordtype">bool</span> KillsOp1 = MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#aff83f9aeef903ed06c5098f5172624ed">killsRegister</a>(X86::FP0+Op1);</div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;</div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;  <span class="comment">// The first operand *must* be on the top of the stack.</span></div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;  moveToTop(Op0, I);</div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;</div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;  <span class="comment">// Change the second operand to the stack register that the operand is in.</span></div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;  <span class="comment">// Change from the pseudo instruction to the concrete instruction.</span></div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;  MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a001a88e1d71c2e11ccd57efe75da4af3">RemoveOperand</a>(0);</div><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;  MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a001a88e1d71c2e11ccd57efe75da4af3">RemoveOperand</a>(1);</div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;  MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a302e45878c6dc1714334c7ce96d56846">getOperand</a>(0).<a class="code" href="classllvm_1_1MachineOperand.html#a624a062754a09d3787614d8627096705">setReg</a>(getSTReg(Op1));</div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;  MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a1ecb35298bc4d1fe03997959e1210c87">setDesc</a>(TII-&gt;<a class="code" href="classllvm_1_1MCInstrInfo.html#ab16f5a81fccfe4b7f645ba5a74ffad02">get</a>(<a class="code" href="X86FloatingPoint_8cpp.html#acc4a1cce0acc04a92e9866fad21bb3b5">getConcreteOpcode</a>(MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a242314c0ae0147d1a7ef54c9bc312616">getOpcode</a>())));</div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;</div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;  <span class="comment">// If we kill the second operand, make sure to pop it from the stack.</span></div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;  <span class="keywordflow">if</span> (Op0 != Op1 &amp;&amp; KillsOp1) {</div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;    <span class="comment">// Get this value off of the register stack.</span></div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;    freeStackSlotAfter(I, Op1);</div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;  }</div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;}</div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;</div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;<span class="comment">/// handleSpecialFP - Handle special instructions which behave unlike other</span></div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;<span class="comment">/// floating point instructions.  This is primarily intended for use by pseudo</span></div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;<span class="comment">/// instructions.</span></div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;<span class="comment"></span><span class="keywordtype">void</span> FPS::handleSpecialFP(<a class="code" href="classllvm_1_1MachineBasicBlock.html#ac51be7ff80fe8d6ae5e8c0acb194908a">MachineBasicBlock::iterator</a> &amp;I) {</div><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;  <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *MI = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>;</div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;  <span class="keywordflow">switch</span> (MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a242314c0ae0147d1a7ef54c9bc312616">getOpcode</a>()) {</div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;  <span class="keywordflow">default</span>: <a class="code" href="ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a>(<span class="stringliteral">&quot;Unknown SpecialFP instruction!&quot;</span>);</div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1TargetOpcode.html#a348d4259b5fa6a8ecfe94e7ae512e1a8afbad4e5ed543b4325115bdb3aff2f8d9">TargetOpcode::COPY</a>: {</div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;    <span class="comment">// We handle three kinds of copies: FP &lt;- FP, FP &lt;- ST, and ST &lt;- FP.</span></div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;MO1 = MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a302e45878c6dc1714334c7ce96d56846">getOperand</a>(1);</div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;MO0 = MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a302e45878c6dc1714334c7ce96d56846">getOperand</a>(0);</div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;    <span class="keywordtype">unsigned</span> DstST = MO0.<a class="code" href="classllvm_1_1MachineOperand.html#ab75f703d251cc0ce0206fe00a999db86">getReg</a>() - X86::ST0;</div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;    <span class="keywordtype">unsigned</span> SrcST = MO1.<a class="code" href="classllvm_1_1MachineOperand.html#ab75f703d251cc0ce0206fe00a999db86">getReg</a>() - X86::ST0;</div><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;    <span class="keywordtype">bool</span> KillsSrc = MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#aff83f9aeef903ed06c5098f5172624ed">killsRegister</a>(MO1.<a class="code" href="classllvm_1_1MachineOperand.html#ab75f703d251cc0ce0206fe00a999db86">getReg</a>());</div><div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;</div><div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;    <span class="comment">// ST = COPY FP. Set up a pending ST register.</span></div><div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;    <span class="keywordflow">if</span> (DstST &lt; 8) {</div><div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;      <span class="keywordtype">unsigned</span> SrcFP = <a class="code" href="X86FloatingPoint_8cpp.html#aa6438c766cdab5c1e26d802ef9ad14ff">getFPReg</a>(MO1);</div><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;      assert(isLive(SrcFP) &amp;&amp; <span class="stringliteral">&quot;Cannot copy dead register&quot;</span>);</div><div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;      assert(!MO0.<a class="code" href="classllvm_1_1MachineOperand.html#a196420aa839c2b21f42c4bf5c36df437">isDead</a>() &amp;&amp; <span class="stringliteral">&quot;Cannot copy to dead ST register&quot;</span>);</div><div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;</div><div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;      <span class="comment">// Unallocated STs are marked as the nonexistent FP255.</span></div><div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;      <span class="keywordflow">while</span> (NumPendingSTs &lt;= DstST)</div><div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;        PendingST[NumPendingSTs++] = NumFPRegs;</div><div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;</div><div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;      <span class="comment">// STi could still be live from a previous inline asm.</span></div><div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;      <span class="keywordflow">if</span> (isScratchReg(PendingST[DstST])) {</div><div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;        <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Clobbering old ST in FP&quot;</span> &lt;&lt; <span class="keywordtype">unsigned</span>(PendingST[DstST])</div><div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;                     &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>);</div><div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;        freeStackSlotBefore(MI, PendingST[DstST]);</div><div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;      }</div><div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;</div><div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;      <span class="comment">// When the source is killed, allocate a scratch FP register.</span></div><div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;      <span class="keywordflow">if</span> (KillsSrc) {</div><div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;        duplicatePendingSTBeforeKill(SrcFP, I);</div><div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;        <span class="keywordtype">unsigned</span> Slot = getSlot(SrcFP);</div><div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;        <span class="keywordtype">unsigned</span> SR = getScratchReg();</div><div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;        PendingST[DstST] = SR;</div><div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;        Stack[Slot] = SR;</div><div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;        RegMap[SR] = Slot;</div><div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;      } <span class="keywordflow">else</span></div><div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;        PendingST[DstST] = SrcFP;</div><div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;    }</div><div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;</div><div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;    <span class="comment">// FP = COPY ST. Extract fixed stack value.</span></div><div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;    <span class="comment">// Any instruction defining ST registers must have assigned them to a</span></div><div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;    <span class="comment">// scratch register.</span></div><div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;    <span class="keywordflow">if</span> (SrcST &lt; 8) {</div><div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;      <span class="keywordtype">unsigned</span> DstFP = <a class="code" href="X86FloatingPoint_8cpp.html#aa6438c766cdab5c1e26d802ef9ad14ff">getFPReg</a>(MO0);</div><div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;      assert(!isLive(DstFP) &amp;&amp; <span class="stringliteral">&quot;Cannot copy ST to live FP register&quot;</span>);</div><div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;      assert(NumPendingSTs &gt; SrcST &amp;&amp; <span class="stringliteral">&quot;Cannot copy from dead ST register&quot;</span>);</div><div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;      <span class="keywordtype">unsigned</span> SrcFP = PendingST[SrcST];</div><div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;      assert(isScratchReg(SrcFP) &amp;&amp; <span class="stringliteral">&quot;Expected ST in a scratch register&quot;</span>);</div><div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;      assert(isLive(SrcFP) &amp;&amp; <span class="stringliteral">&quot;Scratch holding ST is dead&quot;</span>);</div><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;</div><div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;      <span class="comment">// DstFP steals the stack slot from SrcFP.</span></div><div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;      <span class="keywordtype">unsigned</span> Slot = getSlot(SrcFP);</div><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;      Stack[Slot] = DstFP;</div><div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;      RegMap[DstFP] = Slot;</div><div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;</div><div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;      <span class="comment">// Always treat the ST as killed.</span></div><div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;      PendingST[SrcST] = NumFPRegs;</div><div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;      <span class="keywordflow">while</span> (NumPendingSTs &amp;&amp; PendingST[NumPendingSTs - 1] == NumFPRegs)</div><div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;        --NumPendingSTs;</div><div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;    }</div><div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;</div><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;    <span class="comment">// FP &lt;- FP copy.</span></div><div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;    <span class="keywordtype">unsigned</span> DstFP = <a class="code" href="X86FloatingPoint_8cpp.html#aa6438c766cdab5c1e26d802ef9ad14ff">getFPReg</a>(MO0);</div><div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;    <span class="keywordtype">unsigned</span> SrcFP = <a class="code" href="X86FloatingPoint_8cpp.html#aa6438c766cdab5c1e26d802ef9ad14ff">getFPReg</a>(MO1);</div><div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;    assert(isLive(SrcFP) &amp;&amp; <span class="stringliteral">&quot;Cannot copy dead register&quot;</span>);</div><div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;    <span class="keywordflow">if</span> (KillsSrc) {</div><div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;      <span class="comment">// If the input operand is killed, we can just change the owner of the</span></div><div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;      <span class="comment">// incoming stack slot into the result.</span></div><div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;      <span class="keywordtype">unsigned</span> Slot = getSlot(SrcFP);</div><div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;      Stack[Slot] = DstFP;</div><div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;      RegMap[DstFP] = Slot;</div><div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;      <span class="comment">// For COPY we just duplicate the specified value to a new stack slot.</span></div><div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;      <span class="comment">// This could be made better, but would require substantial changes.</span></div><div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;      duplicateToTop(SrcFP, DstFP, I);</div><div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;    }</div><div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;  }</div><div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;</div><div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1TargetOpcode.html#a348d4259b5fa6a8ecfe94e7ae512e1a8a5a91c23866687baf221ce86ff6fde01f">TargetOpcode::IMPLICIT_DEF</a>: {</div><div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;    <span class="comment">// All FP registers must be explicitly defined, so load a 0 instead.</span></div><div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;    <span class="keywordtype">unsigned</span> Reg = MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a302e45878c6dc1714334c7ce96d56846">getOperand</a>(0).<a class="code" href="classllvm_1_1MachineOperand.html#ab75f703d251cc0ce0206fe00a999db86">getReg</a>() - X86::FP0;</div><div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;    <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Emitting LD_F0 for implicit FP&quot;</span> &lt;&lt; Reg &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>);</div><div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;    <a class="code" href="namespacellvm.html#a980570dc1410d4ef53806f82028ca381">BuildMI</a>(*MBB, I, MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a5ca4af2a257043145ad650eafb4402f9">getDebugLoc</a>(), TII-&gt;<a class="code" href="classllvm_1_1MCInstrInfo.html#ab16f5a81fccfe4b7f645ba5a74ffad02">get</a>(X86::LD_F0));</div><div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;    pushReg(Reg);</div><div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;  }</div><div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;</div><div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;  <span class="keywordflow">case</span> X86::FpPOP_RETVAL: {</div><div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;    <span class="comment">// The FpPOP_RETVAL instruction is used after calls that return a value on</span></div><div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;    <span class="comment">// the floating point stack. We cannot model this with ST defs since CALL</span></div><div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;    <span class="comment">// instructions have fixed clobber lists. This instruction is interpreted</span></div><div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;    <span class="comment">// to mean that there is one more live register on the stack than we</span></div><div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;    <span class="comment">// thought.</span></div><div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;    <span class="comment">//</span></div><div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;    <span class="comment">// This means that StackTop does not match the hardware stack between a</span></div><div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;    <span class="comment">// call and the FpPOP_RETVAL instructions.  We do tolerate FP instructions</span></div><div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;    <span class="comment">// between CALL and FpPOP_RETVAL as long as they don&#39;t overflow the</span></div><div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;    <span class="comment">// hardware stack.</span></div><div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;    <span class="keywordtype">unsigned</span> DstFP = <a class="code" href="X86FloatingPoint_8cpp.html#aa6438c766cdab5c1e26d802ef9ad14ff">getFPReg</a>(MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a302e45878c6dc1714334c7ce96d56846">getOperand</a>(0));</div><div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;</div><div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;    <span class="comment">// Move existing stack elements up to reflect reality.</span></div><div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;    assert(StackTop &lt; 8 &amp;&amp; <span class="stringliteral">&quot;Stack overflowed before FpPOP_RETVAL&quot;</span>);</div><div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;    <span class="keywordflow">if</span> (StackTop) {</div><div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;      std::copy_backward(Stack, Stack + StackTop, Stack + StackTop + 1);</div><div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != NumFPRegs; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div><div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;        ++RegMap[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div><div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;    }</div><div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;    ++StackTop;</div><div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;</div><div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;    <span class="comment">// DstFP is the new bottom of the stack.</span></div><div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;    Stack[0] = DstFP;</div><div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;    RegMap[DstFP] = 0;</div><div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;</div><div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;    <span class="comment">// DstFP will be killed by processBasicBlock if this was a dead def.</span></div><div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;  }</div><div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;</div><div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1TargetOpcode.html#a348d4259b5fa6a8ecfe94e7ae512e1a8ae48b49a3b740bb9162f647640fd19c21">TargetOpcode::INLINEASM</a>: {</div><div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;    <span class="comment">// The inline asm MachineInstr currently only *uses* FP registers for the</span></div><div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;    <span class="comment">// &#39;f&#39; constraint.  These should be turned into the current ST(x) register</span></div><div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;    <span class="comment">// in the machine instr.</span></div><div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;    <span class="comment">//</span></div><div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;    <span class="comment">// There are special rules for x87 inline assembly. The compiler must know</span></div><div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;    <span class="comment">// exactly how many registers are popped and pushed implicitly by the asm.</span></div><div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;    <span class="comment">// Otherwise it is not possible to restore the stack state after the inline</span></div><div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;    <span class="comment">// asm.</span></div><div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;    <span class="comment">//</span></div><div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;    <span class="comment">// There are 3 kinds of input operands:</span></div><div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;    <span class="comment">//</span></div><div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;    <span class="comment">// 1. Popped inputs. These must appear at the stack top in ST0-STn. A</span></div><div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;    <span class="comment">//    popped input operand must be in a fixed stack slot, and it is either</span></div><div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;    <span class="comment">//    tied to an output operand, or in the clobber list. The MI has ST use</span></div><div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;    <span class="comment">//    and def operands for these inputs.</span></div><div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;    <span class="comment">//</span></div><div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;    <span class="comment">// 2. Fixed inputs. These inputs appear in fixed stack slots, but are</span></div><div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;    <span class="comment">//    preserved by the inline asm. The fixed stack slots must be STn-STm</span></div><div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;    <span class="comment">//    following the popped inputs. A fixed input operand cannot be tied to</span></div><div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;    <span class="comment">//    an output or appear in the clobber list. The MI has ST use operands</span></div><div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;    <span class="comment">//    and no defs for these inputs.</span></div><div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;    <span class="comment">//</span></div><div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;    <span class="comment">// 3. Preserved inputs. These inputs use the &quot;f&quot; constraint which is</span></div><div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;    <span class="comment">//    represented as an FP register. The inline asm won&#39;t change these</span></div><div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;    <span class="comment">//    stack slots.</span></div><div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;    <span class="comment">//</span></div><div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;    <span class="comment">// Outputs must be in ST registers, FP outputs are not allowed. Clobbered</span></div><div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;    <span class="comment">// registers do not count as output operands. The inline asm changes the</span></div><div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;    <span class="comment">// stack as if it popped all the popped inputs and then pushed all the</span></div><div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;    <span class="comment">// output operands.</span></div><div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;</div><div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;    <span class="comment">// Scan the assembly for ST registers used, defined and clobbered. We can</span></div><div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;    <span class="comment">// only tell clobbers from defs by looking at the asm descriptor.</span></div><div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;    <span class="keywordtype">unsigned</span> STUses = 0, STDefs = 0, STClobbers = 0, STDeadDefs = 0;</div><div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;    <span class="keywordtype">unsigned</span> NumOps = 0;</div><div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = InlineAsm::MIOp_FirstOperand, e = MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a7b5fe96d88954efc855e6c466207e535">getNumOperands</a>();</div><div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;         <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != e &amp;&amp; MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a302e45878c6dc1714334c7ce96d56846">getOperand</a>(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>).<a class="code" href="classllvm_1_1MachineOperand.html#a2ac18ceda9f2857fea2e5cc4e8bf4ff5">isImm</a>(); <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> += 1 + NumOps) {</div><div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;      <span class="keywordtype">unsigned</span> <a class="code" href="namespaceSIInstrFlags.html#a607b4b0952924970b77a9c6b42898b54">Flags</a> = MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a302e45878c6dc1714334c7ce96d56846">getOperand</a>(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>).<a class="code" href="classllvm_1_1MachineOperand.html#a7059d68a29d5ecfb37623ab45cdb4e8d">getImm</a>();</div><div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;      NumOps = <a class="code" href="classllvm_1_1InlineAsm.html#a4437506c56127755bed59ee1b30e95b9">InlineAsm::getNumOperandRegisters</a>(Flags);</div><div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;      <span class="keywordflow">if</span> (NumOps != 1)</div><div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;      <span class="keyword">const</span> <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;MO = MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a302e45878c6dc1714334c7ce96d56846">getOperand</a>(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> + 1);</div><div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;      <span class="keywordflow">if</span> (!MO.<a class="code" href="classllvm_1_1MachineOperand.html#ad8198d6d83af9410d867136e33fbf4b2">isReg</a>())</div><div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;      <span class="keywordtype">unsigned</span> STReg = MO.<a class="code" href="classllvm_1_1MachineOperand.html#ab75f703d251cc0ce0206fe00a999db86">getReg</a>() - X86::ST0;</div><div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;      <span class="keywordflow">if</span> (STReg &gt;= 8)</div><div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;</div><div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;      <span class="keywordflow">switch</span> (<a class="code" href="classllvm_1_1InlineAsm.html#ae61e5f4b796419c0912a891100b46916">InlineAsm::getKind</a>(Flags)) {</div><div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;      <span class="keywordflow">case</span> InlineAsm::Kind_RegUse:</div><div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;        STUses |= (1u &lt;&lt; STReg);</div><div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;      <span class="keywordflow">case</span> InlineAsm::Kind_RegDef:</div><div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;      <span class="keywordflow">case</span> InlineAsm::Kind_RegDefEarlyClobber:</div><div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;        STDefs |= (1u &lt;&lt; STReg);</div><div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;        <span class="keywordflow">if</span> (MO.<a class="code" href="classllvm_1_1MachineOperand.html#a196420aa839c2b21f42c4bf5c36df437">isDead</a>())</div><div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;          STDeadDefs |= (1u &lt;&lt; STReg);</div><div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;      <span class="keywordflow">case</span> InlineAsm::Kind_Clobber:</div><div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;        STClobbers |= (1u &lt;&lt; STReg);</div><div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;      <span class="keywordflow">default</span>:</div><div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;      }</div><div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;    }</div><div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;</div><div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;    <span class="keywordflow">if</span> (STUses &amp;&amp; !<a class="code" href="namespacellvm.html#a4233b4cb04d87d64916c8143ddfb7f77">isMask_32</a>(STUses))</div><div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;      MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a4da6a2bf5f76edf5c438ef69aff579c0">emitError</a>(<span class="stringliteral">&quot;fixed input regs must be last on the x87 stack&quot;</span>);</div><div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;    <span class="keywordtype">unsigned</span> NumSTUses = <a class="code" href="namespacellvm.html#a2a37fef2c58b20b5884297b082eca44b">CountTrailingOnes_32</a>(STUses);</div><div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;</div><div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;    <span class="comment">// Defs must be contiguous from the stack top. ST0-STn.</span></div><div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;    <span class="keywordflow">if</span> (STDefs &amp;&amp; !<a class="code" href="namespacellvm.html#a4233b4cb04d87d64916c8143ddfb7f77">isMask_32</a>(STDefs)) {</div><div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;      MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a4da6a2bf5f76edf5c438ef69aff579c0">emitError</a>(<span class="stringliteral">&quot;output regs must be last on the x87 stack&quot;</span>);</div><div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;      STDefs = <a class="code" href="namespacellvm.html#a0490c32aa8dd63ddc56bb046fd0258c7">NextPowerOf2</a>(STDefs) - 1;</div><div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;    }</div><div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;    <span class="keywordtype">unsigned</span> NumSTDefs = <a class="code" href="namespacellvm.html#a2a37fef2c58b20b5884297b082eca44b">CountTrailingOnes_32</a>(STDefs);</div><div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;</div><div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;    <span class="comment">// So must the clobbered stack slots. ST0-STm, m &gt;= n.</span></div><div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;    <span class="keywordflow">if</span> (STClobbers &amp;&amp; !<a class="code" href="namespacellvm.html#a4233b4cb04d87d64916c8143ddfb7f77">isMask_32</a>(STDefs | STClobbers))</div><div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;      MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a4da6a2bf5f76edf5c438ef69aff579c0">emitError</a>(<span class="stringliteral">&quot;clobbers must be last on the x87 stack&quot;</span>);</div><div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;</div><div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;    <span class="comment">// Popped inputs are the ones that are also clobbered or defined.</span></div><div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;    <span class="keywordtype">unsigned</span> STPopped = STUses &amp; (STDefs | STClobbers);</div><div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;    <span class="keywordflow">if</span> (STPopped &amp;&amp; !<a class="code" href="namespacellvm.html#a4233b4cb04d87d64916c8143ddfb7f77">isMask_32</a>(STPopped))</div><div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;      MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a4da6a2bf5f76edf5c438ef69aff579c0">emitError</a>(<span class="stringliteral">&quot;implicitly popped regs must be last on the x87 stack&quot;</span>);</div><div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;    <span class="keywordtype">unsigned</span> NumSTPopped = <a class="code" href="namespacellvm.html#a2a37fef2c58b20b5884297b082eca44b">CountTrailingOnes_32</a>(STPopped);</div><div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;</div><div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;    <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Asm uses &quot;</span> &lt;&lt; NumSTUses &lt;&lt; <span class="stringliteral">&quot; fixed regs, pops &quot;</span></div><div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;                 &lt;&lt; NumSTPopped &lt;&lt; <span class="stringliteral">&quot;, and defines &quot;</span> &lt;&lt; NumSTDefs &lt;&lt; <span class="stringliteral">&quot; regs.\n&quot;</span>);</div><div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;</div><div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;    <span class="comment">// Scan the instruction for FP uses corresponding to &quot;f&quot; constraints.</span></div><div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;    <span class="comment">// Collect FP registers to kill afer the instruction.</span></div><div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;    <span class="comment">// Always kill all the scratch regs.</span></div><div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;    <span class="keywordtype">unsigned</span> FPKills = ((1u &lt;&lt; NumFPRegs) - 1) &amp; ~0xff;</div><div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;    <span class="keywordtype">unsigned</span> FPUsed = 0;</div><div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0, e = MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a7b5fe96d88954efc855e6c466207e535">getNumOperands</a>(); <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != e; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;      <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;Op = MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a302e45878c6dc1714334c7ce96d56846">getOperand</a>(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;      <span class="keywordflow">if</span> (!Op.<a class="code" href="classllvm_1_1MachineOperand.html#ad8198d6d83af9410d867136e33fbf4b2">isReg</a>() || Op.<a class="code" href="classllvm_1_1MachineOperand.html#ab75f703d251cc0ce0206fe00a999db86">getReg</a>() &lt; X86::FP0 || Op.<a class="code" href="classllvm_1_1MachineOperand.html#ab75f703d251cc0ce0206fe00a999db86">getReg</a>() &gt; X86::FP6)</div><div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;      <span class="keywordflow">if</span> (!Op.<a class="code" href="classllvm_1_1MachineOperand.html#a57bf9ee7219097ff0f98da23a3b3b782">isUse</a>())</div><div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;        MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a4da6a2bf5f76edf5c438ef69aff579c0">emitError</a>(<span class="stringliteral">&quot;illegal \&quot;f\&quot; output constraint&quot;</span>);</div><div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;      <span class="keywordtype">unsigned</span> FPReg = <a class="code" href="X86FloatingPoint_8cpp.html#aa6438c766cdab5c1e26d802ef9ad14ff">getFPReg</a>(Op);</div><div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;      FPUsed |= 1U &lt;&lt; FPReg;</div><div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;</div><div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;      <span class="comment">// If we kill this operand, make sure to pop it from the stack after the</span></div><div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;      <span class="comment">// asm.  We just remember it for now, and pop them all off at the end in</span></div><div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;      <span class="comment">// a batch.</span></div><div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;      <span class="keywordflow">if</span> (Op.<a class="code" href="classllvm_1_1MachineOperand.html#aa21b508be8c212bdb0b28d734ab0ddb8">isKill</a>())</div><div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;        FPKills |= 1U &lt;&lt; FPReg;</div><div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;    }</div><div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;</div><div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;    <span class="comment">// The popped inputs will be killed by the instruction, so duplicate them</span></div><div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;    <span class="comment">// if the FP register needs to be live after the instruction, or if it is</span></div><div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;    <span class="comment">// used in the instruction itself. We effectively treat the popped inputs</span></div><div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;    <span class="comment">// as early clobbers.</span></div><div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; NumSTPopped; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;      <span class="keywordflow">if</span> ((FPKills &amp; ~FPUsed) &amp; (1u &lt;&lt; PendingST[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>]))</div><div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;      <span class="keywordtype">unsigned</span> SR = getScratchReg();</div><div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;      duplicateToTop(PendingST[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>], SR, I);</div><div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;      <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Duplicating ST&quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot; in FP&quot;</span></div><div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;                   &lt;&lt; <span class="keywordtype">unsigned</span>(PendingST[i]) &lt;&lt; <span class="stringliteral">&quot; to avoid clobbering it.\n&quot;</span>);</div><div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;      PendingST[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>] = SR;</div><div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;    }</div><div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;</div><div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;    <span class="comment">// Make sure we have a unique live register for every fixed use. Some of</span></div><div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;    <span class="comment">// them could be undef uses, and we need to emit LD_F0 instructions.</span></div><div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; NumSTUses; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; NumPendingSTs &amp;&amp; PendingST[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>] &lt; NumFPRegs) {</div><div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;        <span class="comment">// Check for shared assignments.</span></div><div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a> = 0; <a class="code" href="Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a> &lt; <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>; ++<a class="code" href="Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a>) {</div><div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;          <span class="keywordflow">if</span> (PendingST[<a class="code" href="Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a>] != PendingST[i])</div><div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;          <span class="comment">// STi and STj are inn the same register, create a copy.</span></div><div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;          <span class="keywordtype">unsigned</span> SR = getScratchReg();</div><div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;          duplicateToTop(PendingST[i], SR, I);</div><div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;          <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Duplicating ST&quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot; in FP&quot;</span></div><div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;                       &lt;&lt; <span class="keywordtype">unsigned</span>(PendingST[i])</div><div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;                       &lt;&lt; <span class="stringliteral">&quot; to avoid collision with ST&quot;</span> &lt;&lt; <a class="code" href="Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a> &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>);</div><div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;          PendingST[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>] = SR;</div><div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;        }</div><div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;      }</div><div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;      <span class="keywordtype">unsigned</span> SR = getScratchReg();</div><div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;      <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Emitting LD_F0 for ST&quot;</span> &lt;&lt; <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt;&lt; <span class="stringliteral">&quot; in FP&quot;</span> &lt;&lt; SR &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>);</div><div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;      <a class="code" href="namespacellvm.html#a980570dc1410d4ef53806f82028ca381">BuildMI</a>(*MBB, I, MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a5ca4af2a257043145ad650eafb4402f9">getDebugLoc</a>(), TII-&gt;<a class="code" href="classllvm_1_1MCInstrInfo.html#ab16f5a81fccfe4b7f645ba5a74ffad02">get</a>(X86::LD_F0));</div><div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;      pushReg(SR);</div><div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;      PendingST[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>] = SR;</div><div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;      <span class="keywordflow">if</span> (NumPendingSTs == <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div><div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;        ++NumPendingSTs;</div><div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;    }</div><div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;    assert(NumPendingSTs &gt;= NumSTUses &amp;&amp; <span class="stringliteral">&quot;Fixed registers should be assigned&quot;</span>);</div><div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;</div><div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;    <span class="comment">// Now we can rearrange the live registers to match what was requested.</span></div><div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;    shuffleStackTop(PendingST, NumPendingSTs, I);</div><div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;    <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>({<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Before asm: &quot;</span>; dumpStack();});</div><div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;</div><div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;    <span class="comment">// With the stack layout fixed, rewrite the FP registers.</span></div><div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0, e = MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a7b5fe96d88954efc855e6c466207e535">getNumOperands</a>(); <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != e; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;      <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;Op = MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a302e45878c6dc1714334c7ce96d56846">getOperand</a>(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;      <span class="keywordflow">if</span> (!Op.<a class="code" href="classllvm_1_1MachineOperand.html#ad8198d6d83af9410d867136e33fbf4b2">isReg</a>() || Op.<a class="code" href="classllvm_1_1MachineOperand.html#ab75f703d251cc0ce0206fe00a999db86">getReg</a>() &lt; X86::FP0 || Op.<a class="code" href="classllvm_1_1MachineOperand.html#ab75f703d251cc0ce0206fe00a999db86">getReg</a>() &gt; X86::FP6)</div><div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;      <span class="keywordtype">unsigned</span> FPReg = <a class="code" href="X86FloatingPoint_8cpp.html#aa6438c766cdab5c1e26d802ef9ad14ff">getFPReg</a>(Op);</div><div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;      Op.<a class="code" href="classllvm_1_1MachineOperand.html#a624a062754a09d3787614d8627096705">setReg</a>(getSTReg(FPReg));</div><div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;    }</div><div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;</div><div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;    <span class="comment">// Simulate the inline asm popping its inputs and pushing its outputs.</span></div><div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;    StackTop -= NumSTPopped;</div><div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;</div><div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;    <span class="comment">// Hold the fixed output registers in scratch FP registers. They will be</span></div><div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;    <span class="comment">// transferred to real FP registers by copies.</span></div><div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;    NumPendingSTs = 0;</div><div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; NumSTDefs; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;      <span class="keywordtype">unsigned</span> SR = getScratchReg();</div><div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;      pushReg(SR);</div><div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;      FPKills &amp;= ~(1u &lt;&lt; SR);</div><div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;    }</div><div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; NumSTDefs; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div><div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;      PendingST[NumPendingSTs++] = getStackEntry(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;    <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>({<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;After asm: &quot;</span>; dumpStack();});</div><div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;</div><div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;    <span class="comment">// If any of the ST defs were dead, pop them immediately. Our caller only</span></div><div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;    <span class="comment">// handles dead FP defs.</span></div><div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;    <a class="code" href="classllvm_1_1MachineBasicBlock.html#ac51be7ff80fe8d6ae5e8c0acb194908a">MachineBasicBlock::iterator</a> InsertPt = <a class="code" href="namespacellvm_1_1A64CC.html#af5804bc0518be9568f73db566e4d6f46a2db5e7546f960277ff98f96cd5624442">MI</a>;</div><div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; STDefs &amp; (1u &lt;&lt; <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>); ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;      <span class="keywordflow">if</span> (!(STDeadDefs &amp; (1u &lt;&lt; <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>)))</div><div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;      freeStackSlotAfter(InsertPt, PendingST[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div><div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;      PendingST[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>] = NumFPRegs;</div><div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;    }</div><div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;    <span class="keywordflow">while</span> (NumPendingSTs &amp;&amp; PendingST[NumPendingSTs - 1] == NumFPRegs)</div><div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;      --NumPendingSTs;</div><div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;</div><div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;    <span class="comment">// If this asm kills any FP registers (is the last use of them) we must</span></div><div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;    <span class="comment">// explicitly emit pop instructions for them.  Do this now after the asm has</span></div><div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;    <span class="comment">// executed so that the ST(x) numbers are not off (which would happen if we</span></div><div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;    <span class="comment">// did this inline with operand rewriting).</span></div><div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;    <span class="comment">//</span></div><div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;    <span class="comment">// Note: this might be a non-optimal pop sequence.  We might be able to do</span></div><div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;    <span class="comment">// better by trying to pop in stack order or something.</span></div><div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;    <span class="keywordflow">while</span> (FPKills) {</div><div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;      <span class="keywordtype">unsigned</span> FPReg = <a class="code" href="namespacellvm.html#abdaf1eaf6120421977095bd97eee892e">countTrailingZeros</a>(FPKills);</div><div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;      <span class="keywordflow">if</span> (isLive(FPReg))</div><div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;        freeStackSlotAfter(InsertPt, FPReg);</div><div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;      FPKills &amp;= ~(1U &lt;&lt; FPReg);</div><div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;    }</div><div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;    <span class="comment">// Don&#39;t delete the inline asm!</span></div><div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;  }</div><div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;</div><div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;  <span class="keywordflow">case</span> X86::WIN_FTOL_32:</div><div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;  <span class="keywordflow">case</span> X86::WIN_FTOL_64: {</div><div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;    <span class="comment">// Push the operand into ST0.</span></div><div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;    <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;Op = MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a302e45878c6dc1714334c7ce96d56846">getOperand</a>(0);</div><div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;    assert(Op.<a class="code" href="classllvm_1_1MachineOperand.html#a57bf9ee7219097ff0f98da23a3b3b782">isUse</a>() &amp;&amp; Op.<a class="code" href="classllvm_1_1MachineOperand.html#ad8198d6d83af9410d867136e33fbf4b2">isReg</a>() &amp;&amp;</div><div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;      Op.<a class="code" href="classllvm_1_1MachineOperand.html#ab75f703d251cc0ce0206fe00a999db86">getReg</a>() &gt;= X86::FP0 &amp;&amp; Op.<a class="code" href="classllvm_1_1MachineOperand.html#ab75f703d251cc0ce0206fe00a999db86">getReg</a>() &lt;= X86::FP6);</div><div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;    <span class="keywordtype">unsigned</span> FPReg = <a class="code" href="X86FloatingPoint_8cpp.html#aa6438c766cdab5c1e26d802ef9ad14ff">getFPReg</a>(Op);</div><div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;    <span class="keywordflow">if</span> (Op.<a class="code" href="classllvm_1_1MachineOperand.html#aa21b508be8c212bdb0b28d734ab0ddb8">isKill</a>())</div><div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;      moveToTop(FPReg, I);</div><div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;      duplicateToTop(FPReg, FPReg, I);</div><div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;</div><div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;    <span class="comment">// Emit the call. This will pop the operand.</span></div><div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;    <a class="code" href="namespacellvm.html#a980570dc1410d4ef53806f82028ca381">BuildMI</a>(*MBB, I, MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a5ca4af2a257043145ad650eafb4402f9">getDebugLoc</a>(), TII-&gt;<a class="code" href="classllvm_1_1MCInstrInfo.html#ab16f5a81fccfe4b7f645ba5a74ffad02">get</a>(X86::CALLpcrel32))</div><div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;      .addExternalSymbol(<span class="stringliteral">&quot;_ftol2&quot;</span>)</div><div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;      .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a5125cce72b214df09ca8f93dcbbf4c3a">addReg</a>(X86::ST0, <a class="code" href="namespacellvm_1_1RegState.html#a079b254e749130fbe5d740f314ca92daacff74dc04327bef6824ecb2e3648d0f0">RegState::ImplicitKill</a>)</div><div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;      .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a5125cce72b214df09ca8f93dcbbf4c3a">addReg</a>(<a class="code" href="namespacellvm_1_1N86.html#a154c9f74eba4608c7d1b656eb025a96da667b758702693d9dfb46e55025fc559d">X86::ECX</a>, <a class="code" href="namespacellvm_1_1RegState.html#a079b254e749130fbe5d740f314ca92daa833922eca2ad0eab70573ba1f5fba9af">RegState::ImplicitDefine</a>)</div><div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;      .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a5125cce72b214df09ca8f93dcbbf4c3a">addReg</a>(<a class="code" href="README-SSE_8txt.html#abd9c765b9afafff59eb14d50c9e9fba1">X86::EAX</a>, <a class="code" href="namespacellvm_1_1RegState.html#a079b254e749130fbe5d740f314ca92daa72c17e2ff2d5af62a30e56ac152aa8d5">RegState::Define</a> | <a class="code" href="namespacellvm_1_1RegState.html#a079b254e749130fbe5d740f314ca92daa0fec8ba6f4a4dc758b725205985eee99">RegState::Implicit</a>)</div><div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;      .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a5125cce72b214df09ca8f93dcbbf4c3a">addReg</a>(<a class="code" href="README-SSE_8txt.html#aafb0a6c62a7cfe1538db1d20d759a34b">X86::EDX</a>, <a class="code" href="namespacellvm_1_1RegState.html#a079b254e749130fbe5d740f314ca92daa72c17e2ff2d5af62a30e56ac152aa8d5">RegState::Define</a> | <a class="code" href="namespacellvm_1_1RegState.html#a079b254e749130fbe5d740f314ca92daa0fec8ba6f4a4dc758b725205985eee99">RegState::Implicit</a>)</div><div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;      .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a5125cce72b214df09ca8f93dcbbf4c3a">addReg</a>(X86::EFLAGS, <a class="code" href="namespacellvm_1_1RegState.html#a079b254e749130fbe5d740f314ca92daa72c17e2ff2d5af62a30e56ac152aa8d5">RegState::Define</a> | <a class="code" href="namespacellvm_1_1RegState.html#a079b254e749130fbe5d740f314ca92daa0fec8ba6f4a4dc758b725205985eee99">RegState::Implicit</a>);</div><div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;    --StackTop;</div><div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;</div><div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;  }</div><div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;</div><div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;  <span class="keywordflow">case</span> X86::RET:</div><div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;  <span class="keywordflow">case</span> X86::RETI:</div><div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;    <span class="comment">// If RET has an FP register use operand, pass the first one in ST(0) and</span></div><div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;    <span class="comment">// the second one in ST(1).</span></div><div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;</div><div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;    <span class="comment">// Find the register operands.</span></div><div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;    <span class="keywordtype">unsigned</span> FirstFPRegOp = ~0U, SecondFPRegOp = ~0U;</div><div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;    <span class="keywordtype">unsigned</span> LiveMask = 0;</div><div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;</div><div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0, e = MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a7b5fe96d88954efc855e6c466207e535">getNumOperands</a>(); <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != e; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;      <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;Op = MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a302e45878c6dc1714334c7ce96d56846">getOperand</a>(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;      <span class="keywordflow">if</span> (!Op.<a class="code" href="classllvm_1_1MachineOperand.html#ad8198d6d83af9410d867136e33fbf4b2">isReg</a>() || Op.<a class="code" href="classllvm_1_1MachineOperand.html#ab75f703d251cc0ce0206fe00a999db86">getReg</a>() &lt; X86::FP0 || Op.<a class="code" href="classllvm_1_1MachineOperand.html#ab75f703d251cc0ce0206fe00a999db86">getReg</a>() &gt; X86::FP6)</div><div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;      <span class="comment">// FP Register uses must be kills unless there are two uses of the same</span></div><div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;      <span class="comment">// register, in which case only one will be a kill.</span></div><div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;      assert(Op.<a class="code" href="classllvm_1_1MachineOperand.html#a57bf9ee7219097ff0f98da23a3b3b782">isUse</a>() &amp;&amp;</div><div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;             (Op.<a class="code" href="classllvm_1_1MachineOperand.html#aa21b508be8c212bdb0b28d734ab0ddb8">isKill</a>() ||                        <span class="comment">// Marked kill.</span></div><div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;              <a class="code" href="X86FloatingPoint_8cpp.html#aa6438c766cdab5c1e26d802ef9ad14ff">getFPReg</a>(Op) == FirstFPRegOp ||       <span class="comment">// Second instance.</span></div><div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;              MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#aff83f9aeef903ed06c5098f5172624ed">killsRegister</a>(Op.<a class="code" href="classllvm_1_1MachineOperand.html#ab75f703d251cc0ce0206fe00a999db86">getReg</a>())) &amp;&amp;    <span class="comment">// Later use is marked kill.</span></div><div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;             <span class="stringliteral">&quot;Ret only defs operands, and values aren&#39;t live beyond it&quot;</span>);</div><div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;</div><div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;      <span class="keywordflow">if</span> (FirstFPRegOp == ~0U)</div><div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;        FirstFPRegOp = <a class="code" href="X86FloatingPoint_8cpp.html#aa6438c766cdab5c1e26d802ef9ad14ff">getFPReg</a>(Op);</div><div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;      <span class="keywordflow">else</span> {</div><div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;        assert(SecondFPRegOp == ~0U &amp;&amp; <span class="stringliteral">&quot;More than two fp operands!&quot;</span>);</div><div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;        SecondFPRegOp = <a class="code" href="X86FloatingPoint_8cpp.html#aa6438c766cdab5c1e26d802ef9ad14ff">getFPReg</a>(Op);</div><div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;      }</div><div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;      LiveMask |= (1 &lt;&lt; <a class="code" href="X86FloatingPoint_8cpp.html#aa6438c766cdab5c1e26d802ef9ad14ff">getFPReg</a>(Op));</div><div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;</div><div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;      <span class="comment">// Remove the operand so that later passes don&#39;t see it.</span></div><div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;      MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a001a88e1d71c2e11ccd57efe75da4af3">RemoveOperand</a>(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;      --<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>, --e;</div><div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;    }</div><div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;</div><div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;    <span class="comment">// We may have been carrying spurious live-ins, so make sure only the returned</span></div><div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;    <span class="comment">// registers are left live.</span></div><div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;    adjustLiveRegs(LiveMask, MI);</div><div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;    <span class="keywordflow">if</span> (!LiveMask) <span class="keywordflow">return</span>;  <span class="comment">// Quick check to see if any are possible.</span></div><div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;</div><div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;    <span class="comment">// There are only four possibilities here:</span></div><div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;    <span class="comment">// 1) we are returning a single FP value.  In this case, it has to be in</span></div><div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;    <span class="comment">//    ST(0) already, so just declare success by removing the value from the</span></div><div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;    <span class="comment">//    FP Stack.</span></div><div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;    <span class="keywordflow">if</span> (SecondFPRegOp == ~0U) {</div><div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;      <span class="comment">// Assert that the top of stack contains the right FP register.</span></div><div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;      assert(StackTop == 1 &amp;&amp; FirstFPRegOp == getStackEntry(0) &amp;&amp;</div><div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;             <span class="stringliteral">&quot;Top of stack not the right register for RET!&quot;</span>);</div><div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;</div><div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;      <span class="comment">// Ok, everything is good, mark the value as not being on the stack</span></div><div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;      <span class="comment">// anymore so that our assertion about the stack being empty at end of</span></div><div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;      <span class="comment">// block doesn&#39;t fire.</span></div><div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;      StackTop = 0;</div><div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;    }</div><div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;</div><div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;    <span class="comment">// Otherwise, we are returning two values:</span></div><div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;    <span class="comment">// 2) If returning the same value for both, we only have one thing in the FP</span></div><div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;    <span class="comment">//    stack.  Consider:  RET FP1, FP1</span></div><div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;    <span class="keywordflow">if</span> (StackTop == 1) {</div><div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;      assert(FirstFPRegOp == SecondFPRegOp &amp;&amp; FirstFPRegOp == getStackEntry(0)&amp;&amp;</div><div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;             <span class="stringliteral">&quot;Stack misconfiguration for RET!&quot;</span>);</div><div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;</div><div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;      <span class="comment">// Duplicate the TOS so that we return it twice.  Just pick some other FPx</span></div><div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;      <span class="comment">// register to hold it.</span></div><div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;      <span class="keywordtype">unsigned</span> NewReg = getScratchReg();</div><div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;      duplicateToTop(FirstFPRegOp, NewReg, MI);</div><div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;      FirstFPRegOp = NewReg;</div><div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;    }</div><div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;<span class="comment">    /// Okay we know we have two different FPx operands now:</span></div><div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;<span class="comment"></span>    assert(StackTop == 2 &amp;&amp; <span class="stringliteral">&quot;Must have two values live!&quot;</span>);</div><div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;<span class="comment">    /// 3) If SecondFPRegOp is currently in ST(0) and FirstFPRegOp is currently</span></div><div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;<span class="comment">    ///    in ST(1).  In this case, emit an fxch.</span></div><div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;<span class="comment"></span>    <span class="keywordflow">if</span> (getStackEntry(0) == SecondFPRegOp) {</div><div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;      assert(getStackEntry(1) == FirstFPRegOp &amp;&amp; <span class="stringliteral">&quot;Unknown regs live&quot;</span>);</div><div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;      moveToTop(FirstFPRegOp, MI);</div><div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;    }</div><div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;<span class="comment">    /// 4) Finally, FirstFPRegOp must be in ST(0) and SecondFPRegOp must be in</span></div><div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;<span class="comment">    /// ST(1).  Just remove both from our understanding of the stack and return.</span></div><div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;<span class="comment"></span>    assert(getStackEntry(0) == FirstFPRegOp &amp;&amp; <span class="stringliteral">&quot;Unknown regs live&quot;</span>);</div><div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;    assert(getStackEntry(1) == SecondFPRegOp &amp;&amp; <span class="stringliteral">&quot;Unknown regs live&quot;</span>);</div><div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;    StackTop = 0;</div><div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;  }</div><div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;</div><div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;  I = MBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#a537a9265c55392ab47d44954f27db538">erase</a>(I);  <span class="comment">// Remove the pseudo instruction</span></div><div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;</div><div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;  <span class="comment">// We want to leave I pointing to the previous instruction, but what if we</span></div><div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;  <span class="comment">// just erased the first instruction?</span></div><div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;  <span class="keywordflow">if</span> (I == MBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#ab2d91e7bec944efcbc39d8e30644f111">begin</a>()) {</div><div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;    <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Inserting dummy KILL\n&quot;</span>);</div><div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;    I = <a class="code" href="namespacellvm.html#a980570dc1410d4ef53806f82028ca381">BuildMI</a>(*MBB, I, <a class="code" href="classllvm_1_1DebugLoc.html">DebugLoc</a>(), TII-&gt;<a class="code" href="classllvm_1_1MCInstrInfo.html#ab16f5a81fccfe4b7f645ba5a74ffad02">get</a>(<a class="code" href="namespacellvm_1_1TargetOpcode.html#a348d4259b5fa6a8ecfe94e7ae512e1a8a3de0a03c0721e0683934a37868f6a421">TargetOpcode::KILL</a>));</div><div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;    --<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>;</div><div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;}</div><div class="ttc" id="namespaceSIInstrFlags_html_a607b4b0952924970b77a9c6b42898b54"><div class="ttname"><a href="namespaceSIInstrFlags.html#a607b4b0952924970b77a9c6b42898b54">SIInstrFlags::Flags</a></div><div class="ttdeci">Flags</div><div class="ttdef"><b>Definition:</b> <a href="SIInstrInfo_8h_source.html#l00140">SIInstrInfo.h:140</a></div></div>
<div class="ttc" id="X86FloatingPoint_8cpp_html_a6504ea1184d62ab95799d9ae9f958c14"><div class="ttname"><a href="X86FloatingPoint_8cpp.html#a6504ea1184d62ab95799d9ae9f958c14">TableIsSorted</a></div><div class="ttdeci">static bool TableIsSorted(const TableEntry *Table, unsigned NumEntries)</div><div class="ttdef"><b>Definition:</b> <a href="X86FloatingPoint_8cpp_source.html#l00589">X86FloatingPoint.cpp:589</a></div></div>
<div class="ttc" id="classllvm_1_1SmallVectorTemplateCommon_html_a22a311dfe4c28a897de8a9365a4f0a84"><div class="ttname"><a href="classllvm_1_1SmallVectorTemplateCommon.html#a22a311dfe4c28a897de8a9365a4f0a84">llvm::SmallVectorTemplateCommon::size</a></div><div class="ttdeci">size_type size() const </div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00127">SmallVector.h:127</a></div></div>
<div class="ttc" id="X86FloatingPoint_8cpp_html_aba327247fb132ea41094732710efd600"><div class="ttname"><a href="X86FloatingPoint_8cpp.html#aba327247fb132ea41094732710efd600">OpcodeTable</a></div><div class="ttdeci">static const TableEntry OpcodeTable[]</div><div class="ttdef"><b>Definition:</b> <a href="X86FloatingPoint_8cpp_source.html#l00624">X86FloatingPoint.cpp:624</a></div></div>
<div class="ttc" id="classllvm_1_1SmallVectorTemplateBase_html_ae1a10b90f22c0478960fb5798ff73916"><div class="ttname"><a href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">llvm::SmallVectorTemplateBase::push_back</a></div><div class="ttdeci">void push_back(const T &amp;Elt)</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00236">SmallVector.h:236</a></div></div>
<div class="ttc" id="classllvm_1_1MachineBasicBlock_html_af2e482ff2a9253ec6bc2285491496bd6"><div class="ttname"><a href="classllvm_1_1MachineBasicBlock.html#af2e482ff2a9253ec6bc2285491496bd6">llvm::MachineBasicBlock::getParent</a></div><div class="ttdeci">const MachineFunction * getParent() const </div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8h_source.html#l00137">MachineBasicBlock.h:137</a></div></div>
<div class="ttc" id="classllvm_1_1MachineBasicBlock_html_a537a9265c55392ab47d44954f27db538"><div class="ttname"><a href="classllvm_1_1MachineBasicBlock.html#a537a9265c55392ab47d44954f27db538">llvm::MachineBasicBlock::erase</a></div><div class="ttdeci">instr_iterator erase(instr_iterator I)</div></div>
<div class="ttc" id="classllvm_1_1MachineBasicBlock_html_a034eb3171c0fc312556559ac96d11c2b"><div class="ttname"><a href="classllvm_1_1MachineBasicBlock.html#a034eb3171c0fc312556559ac96d11c2b">llvm::MachineBasicBlock::dump</a></div><div class="ttdeci">void dump() const </div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8cpp_source.html#l00240">MachineBasicBlock.cpp:240</a></div></div>
<div class="ttc" id="classllvm_1_1PassRegistry_html_a05a729900b76c89e808c6c3094921b2f"><div class="ttname"><a href="classllvm_1_1PassRegistry.html#a05a729900b76c89e808c6c3094921b2f">llvm::PassRegistry::getPassRegistry</a></div><div class="ttdeci">static PassRegistry * getPassRegistry()</div><div class="ttdef"><b>Definition:</b> <a href="PassRegistry_8cpp_source.html#l00035">PassRegistry.cpp:35</a></div></div>
<div class="ttc" id="namespacellvm_html"><div class="ttname"><a href="namespacellvm.html">llvm</a></div><div class="ttdoc">List of target independent CodeGen pass IDs. </div><div class="ttdef"><b>Definition:</b> <a href="APFloat_8h_source.html#l00022">APFloat.h:22</a></div></div>
<div class="ttc" id="X86FloatingPoint_8cpp_html_acc4a1cce0acc04a92e9866fad21bb3b5"><div class="ttname"><a href="X86FloatingPoint_8cpp.html#acc4a1cce0acc04a92e9866fad21bb3b5">getConcreteOpcode</a></div><div class="ttdeci">static unsigned getConcreteOpcode(unsigned Opcode)</div><div class="ttdef"><b>Definition:</b> <a href="X86FloatingPoint_8cpp_source.html#l00786">X86FloatingPoint.cpp:786</a></div></div>
<div class="ttc" id="classllvm_1_1MachineFunction_html_a9d017af749f76484cb9aec9ff6e4330c"><div class="ttname"><a href="classllvm_1_1MachineFunction.html#a9d017af749f76484cb9aec9ff6e4330c">llvm::MachineFunction::end</a></div><div class="ttdeci">iterator end()</div><div class="ttdef"><b>Definition:</b> <a href="MachineFunction_8h_source.html#l00317">MachineFunction.h:317</a></div></div>
<div class="ttc" id="classllvm_1_1MachineFunction_html"><div class="ttname"><a href="classllvm_1_1MachineFunction.html">llvm::MachineFunction</a></div><div class="ttdef"><b>Definition:</b> <a href="MachineFunction_8h_source.html#l00075">MachineFunction.h:75</a></div></div>
<div class="ttc" id="classllvm_1_1MachineBasicBlock_html_a6acda287e5c19ffb173b0bf8f1dd9c5e"><div class="ttname"><a href="classllvm_1_1MachineBasicBlock.html#a6acda287e5c19ffb173b0bf8f1dd9c5e">llvm::MachineBasicBlock::getNumber</a></div><div class="ttdeci">int getNumber() const </div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8h_source.html#l00615">MachineBasicBlock.h:615</a></div></div>
<div class="ttc" id="namespacellvm_1_1X86II_html_a97dc14052814702ba0e2b14fb14dd02da0c0206ff5a225b969956cfc4ae94c5fc"><div class="ttname"><a href="namespacellvm_1_1X86II.html#a97dc14052814702ba0e2b14fb14dd02da0c0206ff5a225b969956cfc4ae94c5fc">llvm::X86II::SpecialFP</a></div><div class="ttdef"><b>Definition:</b> <a href="X86BaseInfo_8h_source.html#l00416">X86BaseInfo.h:416</a></div></div>
<div class="ttc" id="classllvm_1_1MachineFunction_html_ab0789854909cf47f640a85fa2bac29c7"><div class="ttname"><a href="classllvm_1_1MachineFunction.html#ab0789854909cf47f640a85fa2bac29c7">llvm::MachineFunction::begin</a></div><div class="ttdeci">iterator begin()</div><div class="ttdef"><b>Definition:</b> <a href="MachineFunction_8h_source.html#l00315">MachineFunction.h:315</a></div></div>
<div class="ttc" id="namespacellvm_1_1X86II_html_a97dc14052814702ba0e2b14fb14dd02da29c03f5fb2c53a32f54eb835fb6dce02"><div class="ttname"><a href="namespacellvm_1_1X86II.html#a97dc14052814702ba0e2b14fb14dd02da29c03f5fb2c53a32f54eb835fb6dce02">llvm::X86II::NotFP</a></div><div class="ttdef"><b>Definition:</b> <a href="X86BaseInfo_8h_source.html#l00390">X86BaseInfo.h:390</a></div></div>
<div class="ttc" id="namespacellvm_html_a5a36a0d02a1629e4c1c8c6c587d01e5b"><div class="ttname"><a href="namespacellvm.html#a5a36a0d02a1629e4c1c8c6c587d01e5b">llvm::MachineDominatorsID</a></div><div class="ttdeci">char &amp; MachineDominatorsID</div><div class="ttdoc">MachineDominators - This pass is a machine dominators analysis pass. </div></div>
<div class="ttc" id="classllvm_1_1MachineBasicBlock_html_a7bab64c02d740522f94f5f45959a22fc"><div class="ttname"><a href="classllvm_1_1MachineBasicBlock.html#a7bab64c02d740522f94f5f45959a22fc">llvm::MachineBasicBlock::livein_iterator</a></div><div class="ttdeci">std::vector&lt; unsigned &gt;::const_iterator livein_iterator</div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8h_source.html#l00314">MachineBasicBlock.h:314</a></div></div>
<div class="ttc" id="classllvm_1_1MachineBasicBlock_html_a7f0521fa2de44271fd4b909ea7351ef3"><div class="ttname"><a href="classllvm_1_1MachineBasicBlock.html#a7f0521fa2de44271fd4b909ea7351ef3">llvm::MachineBasicBlock::getFirstTerminator</a></div><div class="ttdeci">iterator getFirstTerminator()</div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8cpp_source.html#l00172">MachineBasicBlock.cpp:172</a></div></div>
<div class="ttc" id="classllvm_1_1MachineOperand_html_a196420aa839c2b21f42c4bf5c36df437"><div class="ttname"><a href="classllvm_1_1MachineOperand.html#a196420aa839c2b21f42c4bf5c36df437">llvm::MachineOperand::isDead</a></div><div class="ttdeci">bool isDead() const </div><div class="ttdef"><b>Definition:</b> <a href="MachineOperand_8h_source.html#l00284">MachineOperand.h:284</a></div></div>
<div class="ttc" id="Debug_8h_html"><div class="ttname"><a href="Debug_8h.html">Debug.h</a></div></div>
<div class="ttc" id="Target_2README_8txt_html_a3a76669632041022e6976766a22bd2b0"><div class="ttname"><a href="Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a></div><div class="ttdeci">return j(j&lt;&lt; 16)</div></div>
<div class="ttc" id="X86FloatingPoint_8cpp_html_a6b066422df544b54cfa1d1c25bbbd24f"><div class="ttname"><a href="X86FloatingPoint_8cpp.html#a6b066422df544b54cfa1d1c25bbbd24f">STATISTIC</a></div><div class="ttdeci">STATISTIC(NumFXCH,&quot;Number of fxch instructions inserted&quot;)</div></div>
<div class="ttc" id="namespacellvm_1_1RegState_html_a079b254e749130fbe5d740f314ca92daa0fec8ba6f4a4dc758b725205985eee99"><div class="ttname"><a href="namespacellvm_1_1RegState.html#a079b254e749130fbe5d740f314ca92daa0fec8ba6f4a4dc758b725205985eee99">llvm::RegState::Implicit</a></div><div class="ttdef"><b>Definition:</b> <a href="MachineInstrBuilder_8h_source.html#l00032">MachineInstrBuilder.h:32</a></div></div>
<div class="ttc" id="classllvm_1_1SmallPtrSet_html_a9b6dd0fc7a648a939e571246045b673e"><div class="ttname"><a href="classllvm_1_1SmallPtrSet.html#a9b6dd0fc7a648a939e571246045b673e">llvm::SmallPtrSet::insert</a></div><div class="ttdeci">bool insert(PtrType Ptr)</div><div class="ttdef"><b>Definition:</b> <a href="SmallPtrSet_8h_source.html#l00253">SmallPtrSet.h:253</a></div></div>
<div class="ttc" id="Target_2TargetMachine_8h_html"><div class="ttname"><a href="Target_2TargetMachine_8h.html">TargetMachine.h</a></div></div>
<div class="ttc" id="classllvm_1_1MachineBasicBlock_html_ae26efdb76d5c56388c65dc5b02a2ae6f"><div class="ttname"><a href="classllvm_1_1MachineBasicBlock.html#ae26efdb76d5c56388c65dc5b02a2ae6f">llvm::MachineBasicBlock::addLiveIn</a></div><div class="ttdeci">void addLiveIn(unsigned Reg)</div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8h_source.html#l00297">MachineBasicBlock.h:297</a></div></div>
<div class="ttc" id="namespacellvm_html_a7c469a194119a14e5a018ebb9b847cf0"><div class="ttname"><a href="namespacellvm.html#a7c469a194119a14e5a018ebb9b847cf0">llvm::operator&lt;</a></div><div class="ttdeci">void operator&lt;(const Optional&lt; T &gt; &amp;X, const Optional&lt; U &gt; &amp;Y)</div><div class="ttdoc">Poison comparison between two Optional objects. Clients needs to explicitly compare the underlying va...</div></div>
<div class="ttc" id="classllvm_1_1MachineInstr_html_a803a7424877fd049679b9aa2f07597b5"><div class="ttname"><a href="classllvm_1_1MachineInstr.html#a803a7424877fd049679b9aa2f07597b5">llvm::MachineInstr::getDesc</a></div><div class="ttdeci">const MCInstrDesc &amp; getDesc() const </div><div class="ttdef"><b>Definition:</b> <a href="MachineInstr_8h_source.html#l00257">MachineInstr.h:257</a></div></div>
<div class="ttc" id="classllvm_1_1DebugLoc_html"><div class="ttname"><a href="classllvm_1_1DebugLoc.html">llvm::DebugLoc</a></div><div class="ttdef"><b>Definition:</b> <a href="DebugLoc_8h_source.html#l00028">DebugLoc.h:28</a></div></div>
<div class="ttc" id="X86FloatingPoint_8cpp_html_abe556c5eca51a99b45126470f269dc9c"><div class="ttname"><a href="X86FloatingPoint_8cpp.html#abe556c5eca51a99b45126470f269dc9c">ReverseSTiTable</a></div><div class="ttdeci">static const TableEntry ReverseSTiTable[]</div><div class="ttdef"><b>Definition:</b> <a href="X86FloatingPoint_8cpp_source.html#l01134">X86FloatingPoint.cpp:1134</a></div></div>
<div class="ttc" id="namespacellvm_1_1TargetOpcode_html_a348d4259b5fa6a8ecfe94e7ae512e1a8afbad4e5ed543b4325115bdb3aff2f8d9"><div class="ttname"><a href="namespacellvm_1_1TargetOpcode.html#a348d4259b5fa6a8ecfe94e7ae512e1a8afbad4e5ed543b4325115bdb3aff2f8d9">llvm::TargetOpcode::COPY</a></div><div class="ttdef"><b>Definition:</b> <a href="TargetOpcodes_8h_source.html#l00086">TargetOpcodes.h:86</a></div></div>
<div class="ttc" id="classllvm_1_1MachineBasicBlock_html_acbc921830578e2741be6549db716c0ce"><div class="ttname"><a href="classllvm_1_1MachineBasicBlock.html#acbc921830578e2741be6549db716c0ce">llvm::MachineBasicBlock::end</a></div><div class="ttdeci">iterator end()</div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8h_source.html#l00238">MachineBasicBlock.h:238</a></div></div>
<div class="ttc" id="classllvm_1_1MCInstrDesc_html_a46e0fcca2366f30d5e35b3d7dcb9c65f"><div class="ttname"><a href="classllvm_1_1MCInstrDesc.html#a46e0fcca2366f30d5e35b3d7dcb9c65f">llvm::MCInstrDesc::TSFlags</a></div><div class="ttdeci">uint64_t TSFlags</div><div class="ttdef"><b>Definition:</b> <a href="MCInstrDesc_8h_source.html#l00145">MCInstrDesc.h:145</a></div></div>
<div class="ttc" id="Statistic_8h_html"><div class="ttname"><a href="Statistic_8h.html">Statistic.h</a></div></div>
<div class="ttc" id="namespacellvm_1_1RegState_html_a079b254e749130fbe5d740f314ca92daa833922eca2ad0eab70573ba1f5fba9af"><div class="ttname"><a href="namespacellvm_1_1RegState.html#a079b254e749130fbe5d740f314ca92daa833922eca2ad0eab70573ba1f5fba9af">llvm::RegState::ImplicitDefine</a></div><div class="ttdef"><b>Definition:</b> <a href="MachineInstrBuilder_8h_source.html#l00040">MachineInstrBuilder.h:40</a></div></div>
<div class="ttc" id="namespacellvm_html_a1f6978055dbb761b380de39070e34bd3"><div class="ttname"><a href="namespacellvm.html#a1f6978055dbb761b380de39070e34bd3">llvm::report_fatal_error</a></div><div class="ttdeci">LLVM_ATTRIBUTE_NORETURN void report_fatal_error(const char *reason, bool gen_crash_diag=true)</div><div class="ttdef"><b>Definition:</b> <a href="ErrorHandling_8cpp_source.html#l00053">ErrorHandling.cpp:53</a></div></div>
<div class="ttc" id="X86DisassemblerDecoder_8h_html_a546839a5c4bcf9f9450967155f48de41"><div class="ttname"><a href="X86DisassemblerDecoder_8h.html#a546839a5c4bcf9f9450967155f48de41">Reg</a></div><div class="ttdeci">Reg</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00428">X86DisassemblerDecoder.h:428</a></div></div>
<div class="ttc" id="classllvm_1_1MachineBasicBlock_html_a6833d4f80b7e44f505b2184b04ea2693"><div class="ttname"><a href="classllvm_1_1MachineBasicBlock.html#a6833d4f80b7e44f505b2184b04ea2693">llvm::MachineBasicBlock::livein_begin</a></div><div class="ttdeci">livein_iterator livein_begin() const </div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8h_source.html#l00315">MachineBasicBlock.h:315</a></div></div>
<div class="ttc" id="X86_8h_html"><div class="ttname"><a href="X86_8h.html">X86.h</a></div></div>
<div class="ttc" id="InlineAsm_8h_html"><div class="ttname"><a href="InlineAsm_8h.html">InlineAsm.h</a></div></div>
<div class="ttc" id="classllvm_1_1AnalysisUsage_html_ae5c60fd282ee894c87ea02c3f0fcb6d0"><div class="ttname"><a href="classllvm_1_1AnalysisUsage.html#ae5c60fd282ee894c87ea02c3f0fcb6d0">llvm::AnalysisUsage::addRequired</a></div><div class="ttdeci">AnalysisUsage &amp; addRequired()</div><div class="ttdef"><b>Definition:</b> <a href="PassAnalysisSupport_8h_source.html#l00055">PassAnalysisSupport.h:55</a></div></div>
<div class="ttc" id="namespacellvm_html_a60b90e9a630631cf67aaef4679ffbf62"><div class="ttname"><a href="namespacellvm.html#a60b90e9a630631cf67aaef4679ffbf62">llvm::MachineLoopInfoID</a></div><div class="ttdeci">char &amp; MachineLoopInfoID</div><div class="ttdoc">MachineLoopInfo - This pass is a loop analysis pass. </div><div class="ttdef"><b>Definition:</b> <a href="MachineLoopInfo_8cpp_source.html#l00035">MachineLoopInfo.cpp:35</a></div></div>
<div class="ttc" id="classllvm_1_1MachineFunctionPass_html"><div class="ttname"><a href="classllvm_1_1MachineFunctionPass.html">llvm::MachineFunctionPass</a></div><div class="ttdef"><b>Definition:</b> <a href="MachineFunctionPass_8h_source.html#l00032">MachineFunctionPass.h:32</a></div></div>
<div class="ttc" id="HexagonCopyToCombine_8cpp_html_a1d40004718218dbdf06b496766299101"><div class="ttname"><a href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a></div><div class="ttdeci">const HexagonInstrInfo * TII</div><div class="ttdef"><b>Definition:</b> <a href="HexagonCopyToCombine_8cpp_source.html#l00115">HexagonCopyToCombine.cpp:115</a></div></div>
<div class="ttc" id="classllvm_1_1MachineOperand_html_a2ac18ceda9f2857fea2e5cc4e8bf4ff5"><div class="ttname"><a href="classllvm_1_1MachineOperand.html#a2ac18ceda9f2857fea2e5cc4e8bf4ff5">llvm::MachineOperand::isImm</a></div><div class="ttdeci">bool isImm() const </div><div class="ttdoc">isImm - Tests if this is a MO_Immediate operand. </div><div class="ttdef"><b>Definition:</b> <a href="MachineOperand_8h_source.html#l00226">MachineOperand.h:226</a></div></div>
<div class="ttc" id="ErrorHandling_8h_html_ace243f5c25697a1107cce46626b3dc94"><div class="ttname"><a href="ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a></div><div class="ttdeci">#define llvm_unreachable(msg)</div><div class="ttdef"><b>Definition:</b> <a href="ErrorHandling_8h_source.html#l00103">ErrorHandling.h:103</a></div></div>
<div class="ttc" id="classllvm_1_1MachineOperand_html_ad8198d6d83af9410d867136e33fbf4b2"><div class="ttname"><a href="classllvm_1_1MachineOperand.html#ad8198d6d83af9410d867136e33fbf4b2">llvm::MachineOperand::isReg</a></div><div class="ttdeci">bool isReg() const </div><div class="ttdoc">isReg - Tests if this is a MO_Register operand. </div><div class="ttdef"><b>Definition:</b> <a href="MachineOperand_8h_source.html#l00224">MachineOperand.h:224</a></div></div>
<div class="ttc" id="STLExtras_8h_html"><div class="ttname"><a href="STLExtras_8h.html">STLExtras.h</a></div></div>
<div class="ttc" id="Target_2ARM_2README_8txt_html_a91f4469a9d29e354421494afd4ba466d"><div class="ttname"><a href="Target_2ARM_2README_8txt.html#a91f4469a9d29e354421494afd4ba466d">to</a></div><div class="ttdeci">Should compile to</div><div class="ttdef"><b>Definition:</b> <a href="Target_2ARM_2README_8txt_source.html#l00449">Target/ARM/README.txt:449</a></div></div>
<div class="ttc" id="X86FloatingPoint_8cpp_html_a83c82a7a8e5af3b2f88962cdec3952ef"><div class="ttname"><a href="X86FloatingPoint_8cpp.html#a83c82a7a8e5af3b2f88962cdec3952ef">ForwardST0Table</a></div><div class="ttdeci">static const TableEntry ForwardST0Table[]</div><div class="ttdef"><b>Definition:</b> <a href="X86FloatingPoint_8cpp_source.html#l01086">X86FloatingPoint.cpp:1086</a></div></div>
<div class="ttc" id="ErrorHandling_8h_html"><div class="ttname"><a href="ErrorHandling_8h.html">ErrorHandling.h</a></div></div>
<div class="ttc" id="classllvm_1_1EdgeBundles_html_a2fa4eb01f401c3513c1eca5024e1c2cc"><div class="ttname"><a href="classllvm_1_1EdgeBundles.html#a2fa4eb01f401c3513c1eca5024e1c2cc">llvm::EdgeBundles::getNumBundles</a></div><div class="ttdeci">unsigned getNumBundles() const </div><div class="ttdoc">getNumBundles - Return the total number of bundles in the CFG. </div><div class="ttdef"><b>Definition:</b> <a href="EdgeBundles_8h_source.html#l00046">EdgeBundles.h:46</a></div></div>
<div class="ttc" id="namespacellvm_1_1CallingConv_html_a4f861731fc6dbfdccc05af5968d98974"><div class="ttname"><a href="namespacellvm_1_1CallingConv.html#a4f861731fc6dbfdccc05af5968d98974">llvm::CallingConv::ID</a></div><div class="ttdeci">ID</div><div class="ttdoc">LLVM Calling Convention Representation. </div><div class="ttdef"><b>Definition:</b> <a href="CallingConv_8h_source.html#l00026">CallingConv.h:26</a></div></div>
<div class="ttc" id="classllvm_1_1MachineInstr_html_a7b5fe96d88954efc855e6c466207e535"><div class="ttname"><a href="classllvm_1_1MachineInstr.html#a7b5fe96d88954efc855e6c466207e535">llvm::MachineInstr::getNumOperands</a></div><div class="ttdeci">unsigned getNumOperands() const </div><div class="ttdef"><b>Definition:</b> <a href="MachineInstr_8h_source.html#l00265">MachineInstr.h:265</a></div></div>
<div class="ttc" id="README-SSE_8txt_html_aafb0a6c62a7cfe1538db1d20d759a34b"><div class="ttname"><a href="README-SSE_8txt.html#aafb0a6c62a7cfe1538db1d20d759a34b">EDX</a></div><div class="ttdeci">We currently esp xorpd xmm0 xmm0 xmm1 xmm2 xmm1 jb LBB_X_2 xmm2 esp esp ret Lower memcpy memset to a series of SSE bit move instructions when it s feasible Still ok After register LLVM ADD32rm EDX</div><div class="ttdef"><b>Definition:</b> <a href="README-SSE_8txt_source.html#l00132">README-SSE.txt:132</a></div></div>
<div class="ttc" id="classllvm_1_1MachineInstr_html_a001a88e1d71c2e11ccd57efe75da4af3"><div class="ttname"><a href="classllvm_1_1MachineInstr.html#a001a88e1d71c2e11ccd57efe75da4af3">llvm::MachineInstr::RemoveOperand</a></div><div class="ttdeci">void RemoveOperand(unsigned i)</div><div class="ttdef"><b>Definition:</b> <a href="MachineInstr_8cpp_source.html#l00717">MachineInstr.cpp:717</a></div></div>
<div class="ttc" id="namespacellvm_1_1X86II_html_a97dc14052814702ba0e2b14fb14dd02daf7281802655e34d6a26592d416090b1e"><div class="ttname"><a href="namespacellvm_1_1X86II.html#a97dc14052814702ba0e2b14fb14dd02daf7281802655e34d6a26592d416090b1e">llvm::X86II::TwoArgFP</a></div><div class="ttdef"><b>Definition:</b> <a href="X86BaseInfo_8h_source.html#l00406">X86BaseInfo.h:406</a></div></div>
<div class="ttc" id="classllvm_1_1EdgeBundles_html"><div class="ttname"><a href="classllvm_1_1EdgeBundles.html">llvm::EdgeBundles</a></div><div class="ttdef"><b>Definition:</b> <a href="EdgeBundles_8h_source.html#l00026">EdgeBundles.h:26</a></div></div>
<div class="ttc" id="classllvm_1_1MachineOperand_html_aa21b508be8c212bdb0b28d734ab0ddb8"><div class="ttname"><a href="classllvm_1_1MachineOperand.html#aa21b508be8c212bdb0b28d734ab0ddb8">llvm::MachineOperand::isKill</a></div><div class="ttdeci">bool isKill() const </div><div class="ttdef"><b>Definition:</b> <a href="MachineOperand_8h_source.html#l00289">MachineOperand.h:289</a></div></div>
<div class="ttc" id="X86FloatingPoint_8cpp_html_aa6438c766cdab5c1e26d802ef9ad14ff"><div class="ttname"><a href="X86FloatingPoint_8cpp.html#aa6438c766cdab5c1e26d802ef9ad14ff">getFPReg</a></div><div class="ttdeci">static unsigned getFPReg(const MachineOperand &amp;MO)</div><div class="ttdef"><b>Definition:</b> <a href="X86FloatingPoint_8cpp_source.html#l00330">X86FloatingPoint.cpp:330</a></div></div>
<div class="ttc" id="namespacellvm_html_a370ed0e0f2bb66d17cd13f84be54e867"><div class="ttname"><a href="namespacellvm.html#a370ed0e0f2bb66d17cd13f84be54e867">llvm::array_lengthof</a></div><div class="ttdeci">size_t array_lengthof(T(&amp;)[N])</div><div class="ttdoc">Find the length of an array. </div><div class="ttdef"><b>Definition:</b> <a href="STLExtras_8h_source.html#l00250">STLExtras.h:250</a></div></div>
<div class="ttc" id="classllvm_1_1SmallVectorBase_html_a8a8df4d85555c7954a95f86080cd3b64"><div class="ttname"><a href="classllvm_1_1SmallVectorBase.html#a8a8df4d85555c7954a95f86080cd3b64">llvm::SmallVectorBase::empty</a></div><div class="ttdeci">bool LLVM_ATTRIBUTE_UNUSED_RESULT empty() const </div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00056">SmallVector.h:56</a></div></div>
<div class="ttc" id="classllvm_1_1MachineInstr_html_a242314c0ae0147d1a7ef54c9bc312616"><div class="ttname"><a href="classllvm_1_1MachineInstr.html#a242314c0ae0147d1a7ef54c9bc312616">llvm::MachineInstr::getOpcode</a></div><div class="ttdeci">int getOpcode() const </div><div class="ttdef"><b>Definition:</b> <a href="MachineInstr_8h_source.html#l00261">MachineInstr.h:261</a></div></div>
<div class="ttc" id="MachineInstrBuilder_8h_html"><div class="ttname"><a href="MachineInstrBuilder_8h.html">MachineInstrBuilder.h</a></div></div>
<div class="ttc" id="namespacellvm_html_abdaf1eaf6120421977095bd97eee892e"><div class="ttname"><a href="namespacellvm.html#abdaf1eaf6120421977095bd97eee892e">llvm::countTrailingZeros</a></div><div class="ttdeci">enable_if_c&lt; std::numeric_limits&lt; T &gt;::is_integer &amp;&amp;!std::numeric_limits&lt; T &gt;::is_signed, std::size_t &gt;::type countTrailingZeros(T Val, ZeroBehavior ZB=ZB_Width)</div><div class="ttdoc">Count number of 0&amp;#39;s from the least significant bit to the most stopping at the first 1...</div><div class="ttdef"><b>Definition:</b> <a href="MathExtras_8h_source.html#l00049">MathExtras.h:49</a></div></div>
<div class="ttc" id="namespacellvm_1_1Intrinsic_html_a73349916f7e54a6b988a3646c7a02e90ae857cbc5cf8c5a980f0bd245ad5ec61a"><div class="ttname"><a href="namespacellvm_1_1Intrinsic.html#a73349916f7e54a6b988a3646c7a02e90ae857cbc5cf8c5a980f0bd245ad5ec61a">llvm::Intrinsic::memset</a></div><div class="ttdef"><b>Definition:</b> <a href="Intrinsics_8h_source.html#l01262">Intrinsics.h:1262</a></div></div>
<div class="ttc" id="SmallPtrSet_8h_html"><div class="ttname"><a href="SmallPtrSet_8h.html">SmallPtrSet.h</a></div></div>
<div class="ttc" id="classllvm_1_1AnalysisUsage_html_a40970e5d42646fb2d9aa5f7a2c879516"><div class="ttname"><a href="classllvm_1_1AnalysisUsage.html#a40970e5d42646fb2d9aa5f7a2c879516">llvm::AnalysisUsage::addPreservedID</a></div><div class="ttdeci">AnalysisUsage &amp; addPreservedID(const void *ID)</div><div class="ttdef"><b>Definition:</b> <a href="PassAnalysisSupport_8h_source.html#l00068">PassAnalysisSupport.h:68</a></div></div>
<div class="ttc" id="classllvm_1_1MachineOperand_html_a7059d68a29d5ecfb37623ab45cdb4e8d"><div class="ttname"><a href="classllvm_1_1MachineOperand.html#a7059d68a29d5ecfb37623ab45cdb4e8d">llvm::MachineOperand::getImm</a></div><div class="ttdeci">int64_t getImm() const </div><div class="ttdef"><b>Definition:</b> <a href="MachineOperand_8h_source.html#l00402">MachineOperand.h:402</a></div></div>
<div class="ttc" id="DepthFirstIterator_8h_html"><div class="ttname"><a href="DepthFirstIterator_8h.html">DepthFirstIterator.h</a></div></div>
<div class="ttc" id="X86FloatingPoint_8cpp_html_acbe3830a216e55fb110225bccb9ffc97"><div class="ttname"><a href="X86FloatingPoint_8cpp.html#acbe3830a216e55fb110225bccb9ffc97">PopTable</a></div><div class="ttdeci">static const TableEntry PopTable[]</div><div class="ttdef"><b>Definition:</b> <a href="X86FloatingPoint_8cpp_source.html#l00800">X86FloatingPoint.cpp:800</a></div></div>
<div class="ttc" id="classllvm_1_1TargetInstrInfo_html"><div class="ttname"><a href="classllvm_1_1TargetInstrInfo.html">llvm::TargetInstrInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="TargetInstrInfo_8h_source.html#l00047">TargetInstrInfo.h:47</a></div></div>
<div class="ttc" id="classllvm_1_1MachineInstr_html_a0e15c0325463fc62bd16ccd9ec2b9ec5"><div class="ttname"><a href="classllvm_1_1MachineInstr.html#a0e15c0325463fc62bd16ccd9ec2b9ec5">llvm::MachineInstr::isImplicitDef</a></div><div class="ttdeci">bool isImplicitDef() const </div><div class="ttdef"><b>Definition:</b> <a href="MachineInstr_8h_source.html#l00650">MachineInstr.h:650</a></div></div>
<div class="ttc" id="classllvm_1_1MachineBasicBlock_html_ac51be7ff80fe8d6ae5e8c0acb194908a"><div class="ttname"><a href="classllvm_1_1MachineBasicBlock.html#ac51be7ff80fe8d6ae5e8c0acb194908a">llvm::MachineBasicBlock::iterator</a></div><div class="ttdeci">bundle_iterator&lt; MachineInstr, instr_iterator &gt; iterator</div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8h_source.html#l00212">MachineBasicBlock.h:212</a></div></div>
<div class="ttc" id="namespacellvm_1_1X86II_html_a97dc14052814702ba0e2b14fb14dd02da7a3ad350fcf1708671924bff02fa5384"><div class="ttname"><a href="namespacellvm_1_1X86II.html#a97dc14052814702ba0e2b14fb14dd02da7a3ad350fcf1708671924bff02fa5384">llvm::X86II::ZeroArgFP</a></div><div class="ttdef"><b>Definition:</b> <a href="X86BaseInfo_8h_source.html#l00393">X86BaseInfo.h:393</a></div></div>
<div class="ttc" id="classllvm_1_1SmallVectorImpl_html_aac0ea55010b7b1a301e65a0baea057aa"><div class="ttname"><a href="classllvm_1_1SmallVectorImpl.html#aac0ea55010b7b1a301e65a0baea057aa">llvm::SmallVectorImpl::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00396">SmallVector.h:396</a></div></div>
<div class="ttc" id="classllvm_1_1MachineBasicBlock_html_a1570dd3a2568ba5e52073cdf6d904ee9"><div class="ttname"><a href="classllvm_1_1MachineBasicBlock.html#a1570dd3a2568ba5e52073cdf6d904ee9">llvm::MachineBasicBlock::succ_empty</a></div><div class="ttdeci">bool succ_empty() const </div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8h_source.html#l00291">MachineBasicBlock.h:291</a></div></div>
<div class="ttc" id="namespacellvm_html_aaa67df70b3bc20ef65f8fe523c41da0e"><div class="ttname"><a href="namespacellvm.html#aaa67df70b3bc20ef65f8fe523c41da0e">llvm::df_ext_end</a></div><div class="ttdeci">df_ext_iterator&lt; T, SetTy &gt; df_ext_end(const T &amp;G, SetTy &amp;S)</div><div class="ttdef"><b>Definition:</b> <a href="DepthFirstIterator_8h_source.html#l00223">DepthFirstIterator.h:223</a></div></div>
<div class="ttc" id="X86FloatingPoint_8cpp_html_aaaafaa1cac63fc196f14174327a87eb5"><div class="ttname"><a href="X86FloatingPoint_8cpp.html#aaaafaa1cac63fc196f14174327a87eb5">ForwardSTiTable</a></div><div class="ttdeci">static const TableEntry ForwardSTiTable[]</div><div class="ttdef"><b>Definition:</b> <a href="X86FloatingPoint_8cpp_source.html#l01118">X86FloatingPoint.cpp:1118</a></div></div>
<div class="ttc" id="X86InstrInfo_8h_html"><div class="ttname"><a href="X86InstrInfo_8h.html">X86InstrInfo.h</a></div></div>
<div class="ttc" id="classllvm_1_1MachineBasicBlock_html_aa314325c7062fd067a3c0b9339aa8ea6"><div class="ttname"><a href="classllvm_1_1MachineBasicBlock.html#aa314325c7062fd067a3c0b9339aa8ea6">llvm::MachineBasicBlock::livein_end</a></div><div class="ttdeci">livein_iterator livein_end() const </div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8h_source.html#l00316">MachineBasicBlock.h:316</a></div></div>
<div class="ttc" id="TargetInstrInfo_8h_html"><div class="ttname"><a href="TargetInstrInfo_8h.html">TargetInstrInfo.h</a></div></div>
<div class="ttc" id="classllvm_1_1MachineInstr_html_a302e45878c6dc1714334c7ce96d56846"><div class="ttname"><a href="classllvm_1_1MachineInstr.html#a302e45878c6dc1714334c7ce96d56846">llvm::MachineInstr::getOperand</a></div><div class="ttdeci">const MachineOperand &amp; getOperand(unsigned i) const </div><div class="ttdef"><b>Definition:</b> <a href="MachineInstr_8h_source.html#l00267">MachineInstr.h:267</a></div></div>
<div class="ttc" id="namespacellvm_1_1X86II_html_a97dc14052814702ba0e2b14fb14dd02dac8b9cf1b6c894ccfae9058503988b31a"><div class="ttname"><a href="namespacellvm_1_1X86II.html#a97dc14052814702ba0e2b14fb14dd02dac8b9cf1b6c894ccfae9058503988b31a">llvm::X86II::CondMovFP</a></div><div class="ttdef"><b>Definition:</b> <a href="X86BaseInfo_8h_source.html#l00413">X86BaseInfo.h:413</a></div></div>
<div class="ttc" id="X86FloatingPoint_8cpp_html_a386baa6afd7f1266869bb8fdc44f29d0"><div class="ttname"><a href="X86FloatingPoint_8cpp.html#a386baa6afd7f1266869bb8fdc44f29d0">Lookup</a></div><div class="ttdeci">static int Lookup(const TableEntry *Table, unsigned N, unsigned Opcode)</div><div class="ttdef"><b>Definition:</b> <a href="X86FloatingPoint_8cpp_source.html#l00596">X86FloatingPoint.cpp:596</a></div></div>
<div class="ttc" id="classllvm_1_1InlineAsm_html_a4437506c56127755bed59ee1b30e95b9"><div class="ttname"><a href="classllvm_1_1InlineAsm.html#a4437506c56127755bed59ee1b30e95b9">llvm::InlineAsm::getNumOperandRegisters</a></div><div class="ttdeci">static unsigned getNumOperandRegisters(unsigned Flag)</div><div class="ttdef"><b>Definition:</b> <a href="InlineAsm_8h_source.html#l00278">InlineAsm.h:278</a></div></div>
<div class="ttc" id="classllvm_1_1MachineBasicBlock_html"><div class="ttname"><a href="classllvm_1_1MachineBasicBlock.html">llvm::MachineBasicBlock</a></div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8h_source.html#l00062">MachineBasicBlock.h:62</a></div></div>
<div class="ttc" id="classllvm_1_1MachineInstr_html_ae0ac5973cd95f76e3365e67aaad69de6"><div class="ttname"><a href="classllvm_1_1MachineInstr.html#ae0ac5973cd95f76e3365e67aaad69de6">llvm::MachineInstr::isCopy</a></div><div class="ttdeci">bool isCopy() const </div><div class="ttdef"><b>Definition:</b> <a href="MachineInstr_8h_source.html#l00669">MachineInstr.h:669</a></div></div>
<div class="ttc" id="classllvm_1_1AnalysisUsage_html"><div class="ttname"><a href="classllvm_1_1AnalysisUsage.html">llvm::AnalysisUsage</a></div><div class="ttdef"><b>Definition:</b> <a href="PassAnalysisSupport_8h_source.html#l00037">PassAnalysisSupport.h:37</a></div></div>
<div class="ttc" id="namespacellvm_html_a79d4face7022f4be1d51b785a83de44f"><div class="ttname"><a href="namespacellvm.html#a79d4face7022f4be1d51b785a83de44f">llvm::df_ext_begin</a></div><div class="ttdeci">df_ext_iterator&lt; T, SetTy &gt; df_ext_begin(const T &amp;G, SetTy &amp;S)</div><div class="ttdef"><b>Definition:</b> <a href="DepthFirstIterator_8h_source.html#l00218">DepthFirstIterator.h:218</a></div></div>
<div class="ttc" id="namespacellvm_html_aa1704159f75e6eacd595962ea6d93ffe"><div class="ttname"><a href="namespacellvm.html#aa1704159f75e6eacd595962ea6d93ffe">llvm::next</a></div><div class="ttdeci">ItTy next(ItTy it, Dist n)</div><div class="ttdef"><b>Definition:</b> <a href="STLExtras_8h_source.html#l00154">STLExtras.h:154</a></div></div>
<div class="ttc" id="Compiler_8h_html_acc1c483f4b4ee2f17bb6643a3b353609"><div class="ttname"><a href="Compiler_8h.html#acc1c483f4b4ee2f17bb6643a3b353609">LLVM_ATTRIBUTE_UNUSED</a></div><div class="ttdeci">#define LLVM_ATTRIBUTE_UNUSED</div><div class="ttdef"><b>Definition:</b> <a href="Compiler_8h_source.html#l00199">Compiler.h:199</a></div></div>
<div class="ttc" id="namespacellvm_1_1RegState_html_a079b254e749130fbe5d740f314ca92daacff74dc04327bef6824ecb2e3648d0f0"><div class="ttname"><a href="namespacellvm_1_1RegState.html#a079b254e749130fbe5d740f314ca92daacff74dc04327bef6824ecb2e3648d0f0">llvm::RegState::ImplicitKill</a></div><div class="ttdef"><b>Definition:</b> <a href="MachineInstrBuilder_8h_source.html#l00041">MachineInstrBuilder.h:41</a></div></div>
<div class="ttc" id="classllvm_1_1InlineAsm_html_ae61e5f4b796419c0912a891100b46916"><div class="ttname"><a href="classllvm_1_1InlineAsm.html#ae61e5f4b796419c0912a891100b46916">llvm::InlineAsm::getKind</a></div><div class="ttdeci">static unsigned getKind(unsigned Flags)</div><div class="ttdef"><b>Definition:</b> <a href="InlineAsm_8h_source.html#l00262">InlineAsm.h:262</a></div></div>
<div class="ttc" id="classllvm_1_1FunctionPass_html"><div class="ttname"><a href="classllvm_1_1FunctionPass.html">llvm::FunctionPass</a></div><div class="ttdef"><b>Definition:</b> <a href="Pass_8h_source.html#l00293">Pass.h:293</a></div></div>
<div class="ttc" id="README-SSE_8txt_html_abd9c765b9afafff59eb14d50c9e9fba1"><div class="ttname"><a href="README-SSE_8txt.html#abd9c765b9afafff59eb14d50c9e9fba1">EAX</a></div><div class="ttdeci">We currently esp xorpd xmm0 xmm0 xmm1 xmm2 xmm1 jb LBB_X_2 xmm2 esp esp ret Lower memcpy memset to a series of SSE bit move instructions when it s feasible Still ok After register LLVM ADD32rm IMUL32rr EDX ESI EAX</div><div class="ttdef"><b>Definition:</b> <a href="README-SSE_8txt_source.html#l00208">README-SSE.txt:208</a></div></div>
<div class="ttc" id="namespacellvm_1_1X86_html_a2676a7a40e87d37dcdf74487ef47480eac4169d78e1c6de9b189f31b90f1c2691"><div class="ttname"><a href="namespacellvm_1_1X86.html#a2676a7a40e87d37dcdf74487ef47480eac4169d78e1c6de9b189f31b90f1c2691">llvm::X86::AddrNumOperands</a></div><div class="ttdoc">AddrNumOperands - Total number of operands in a memory reference. </div><div class="ttdef"><b>Definition:</b> <a href="X86BaseInfo_8h_source.html#l00042">X86BaseInfo.h:42</a></div></div>
<div class="ttc" id="namespacellvm_1_1N86_html_a154c9f74eba4608c7d1b656eb025a96da667b758702693d9dfb46e55025fc559d"><div class="ttname"><a href="namespacellvm_1_1N86.html#a154c9f74eba4608c7d1b656eb025a96da667b758702693d9dfb46e55025fc559d">llvm::N86::ECX</a></div><div class="ttdef"><b>Definition:</b> <a href="X86MCTargetDesc_8h_source.html#l00047">X86MCTargetDesc.h:47</a></div></div>
<div class="ttc" id="namespacellvm_html_a980570dc1410d4ef53806f82028ca381"><div class="ttname"><a href="namespacellvm.html#a980570dc1410d4ef53806f82028ca381">llvm::BuildMI</a></div><div class="ttdeci">MachineInstrBuilder BuildMI(MachineFunction &amp;MF, DebugLoc DL, const MCInstrDesc &amp;MCID)</div><div class="ttdef"><b>Definition:</b> <a href="MachineInstrBuilder_8h_source.html#l00223">MachineInstrBuilder.h:223</a></div></div>
<div class="ttc" id="classllvm_1_1MachineFunction_html_a1bc94fb2ca335374a6b470347a85b28f"><div class="ttname"><a href="classllvm_1_1MachineFunction.html#a1bc94fb2ca335374a6b470347a85b28f">llvm::MachineFunction::size</a></div><div class="ttdeci">unsigned size() const </div><div class="ttdef"><b>Definition:</b> <a href="MachineFunction_8h_source.html#l00325">MachineFunction.h:325</a></div></div>
<div class="ttc" id="classllvm_1_1MachineFunction_html_a61126c45c9c4b281173205f7bc3ef241"><div class="ttname"><a href="classllvm_1_1MachineFunction.html#a61126c45c9c4b281173205f7bc3ef241">llvm::MachineFunction::DeleteMachineInstr</a></div><div class="ttdeci">void DeleteMachineInstr(MachineInstr *MI)</div><div class="ttdef"><b>Definition:</b> <a href="MachineFunction_8cpp_source.html#l00194">MachineFunction.cpp:194</a></div></div>
<div class="ttc" id="namespacellvm_html_a0490c32aa8dd63ddc56bb046fd0258c7"><div class="ttname"><a href="namespacellvm.html#a0490c32aa8dd63ddc56bb046fd0258c7">llvm::NextPowerOf2</a></div><div class="ttdeci">uint64_t NextPowerOf2(uint64_t A)</div><div class="ttdef"><b>Definition:</b> <a href="MathExtras_8h_source.html#l00546">MathExtras.h:546</a></div></div>
<div class="ttc" id="EdgeBundles_8h_html"><div class="ttname"><a href="EdgeBundles_8h.html">EdgeBundles.h</a></div></div>
<div class="ttc" id="classllvm_1_1MachineInstr_html_a4da6a2bf5f76edf5c438ef69aff579c0"><div class="ttname"><a href="classllvm_1_1MachineInstr.html#a4da6a2bf5f76edf5c438ef69aff579c0">llvm::MachineInstr::emitError</a></div><div class="ttdeci">void emitError(StringRef Msg) const </div><div class="ttdef"><b>Definition:</b> <a href="MachineInstr_8cpp_source.html#l01827">MachineInstr.cpp:1827</a></div></div>
<div class="ttc" id="classllvm_1_1MCInstrInfo_html_ab16f5a81fccfe4b7f645ba5a74ffad02"><div class="ttname"><a href="classllvm_1_1MCInstrInfo.html#ab16f5a81fccfe4b7f645ba5a74ffad02">llvm::MCInstrInfo::get</a></div><div class="ttdeci">const MCInstrDesc &amp; get(unsigned Opcode) const </div><div class="ttdef"><b>Definition:</b> <a href="MCInstrInfo_8h_source.html#l00048">MCInstrInfo.h:48</a></div></div>
<div class="ttc" id="classllvm_1_1TargetMachine_html_ac13d0f6f2c915757013b101ef6e8afbc"><div class="ttname"><a href="classllvm_1_1TargetMachine.html#ac13d0f6f2c915757013b101ef6e8afbc">llvm::TargetMachine::getInstrInfo</a></div><div class="ttdeci">virtual const TargetInstrInfo * getInstrInfo() const </div><div class="ttdef"><b>Definition:</b> <a href="Target_2TargetMachine_8h_source.html#l00119">Target/TargetMachine.h:119</a></div></div>
<div class="ttc" id="structllvm_1_1df__ext__iterator_html"><div class="ttname"><a href="structllvm_1_1df__ext__iterator.html">llvm::df_ext_iterator</a></div><div class="ttdef"><b>Definition:</b> <a href="DepthFirstIterator_8h_source.html#l00212">DepthFirstIterator.h:212</a></div></div>
<div class="ttc" id="namespacellvm_html_a5bc63f24ddd2f83ee85383788c5b48cc"><div class="ttname"><a href="namespacellvm.html#a5bc63f24ddd2f83ee85383788c5b48cc">llvm::CountPopulation_32</a></div><div class="ttdeci">unsigned CountPopulation_32(uint32_t Value)</div><div class="ttdef"><b>Definition:</b> <a href="MathExtras_8h_source.html#l00417">MathExtras.h:417</a></div></div>
<div class="ttc" id="classllvm_1_1SmallPtrSet_html"><div class="ttname"><a href="classllvm_1_1SmallPtrSet.html">llvm::SmallPtrSet</a></div><div class="ttdef"><b>Definition:</b> <a href="SmallPtrSet_8h_source.html#l00236">SmallPtrSet.h:236</a></div></div>
<div class="ttc" id="classllvm_1_1MachineInstr_html_a1ecb35298bc4d1fe03997959e1210c87"><div class="ttname"><a href="classllvm_1_1MachineInstr.html#a1ecb35298bc4d1fe03997959e1210c87">llvm::MachineInstr::setDesc</a></div><div class="ttdeci">void setDesc(const MCInstrDesc &amp;tid)</div><div class="ttdef"><b>Definition:</b> <a href="MachineInstr_8h_source.html#l00984">MachineInstr.h:984</a></div></div>
<div class="ttc" id="namespacellvm_html_a2a37fef2c58b20b5884297b082eca44b"><div class="ttname"><a href="namespacellvm.html#a2a37fef2c58b20b5884297b082eca44b">llvm::CountTrailingOnes_32</a></div><div class="ttdeci">unsigned CountTrailingOnes_32(uint32_t Value)</div><div class="ttdef"><b>Definition:</b> <a href="MathExtras_8h_source.html#l00402">MathExtras.h:402</a></div></div>
<div class="ttc" id="Target_2README_8txt_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">i</div><div class="ttdef"><b>Definition:</b> <a href="Target_2README_8txt_source.html#l00029">Target/README.txt:29</a></div></div>
<div class="ttc" id="classllvm_1_1MachineOperand_html"><div class="ttname"><a href="classllvm_1_1MachineOperand.html">llvm::MachineOperand</a></div><div class="ttdef"><b>Definition:</b> <a href="MachineOperand_8h_source.html#l00043">MachineOperand.h:43</a></div></div>
<div class="ttc" id="classllvm_1_1SmallVector_html"><div class="ttname"><a href="classllvm_1_1SmallVector.html">llvm::SmallVector</a></div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00880">SmallVector.h:880</a></div></div>
<div class="ttc" id="classllvm_1_1MachineInstr_html_acd9af7d3f8a155c4356edccbc0522c8e"><div class="ttname"><a href="classllvm_1_1MachineInstr.html#acd9af7d3f8a155c4356edccbc0522c8e">llvm::MachineInstr::isInlineAsm</a></div><div class="ttdeci">bool isInlineAsm() const </div><div class="ttdef"><b>Definition:</b> <a href="MachineInstr_8h_source.html#l00651">MachineInstr.h:651</a></div></div>
<div class="ttc" id="namespacellvm_1_1TargetOpcode_html_a348d4259b5fa6a8ecfe94e7ae512e1a8a3de0a03c0721e0683934a37868f6a421"><div class="ttname"><a href="namespacellvm_1_1TargetOpcode.html#a348d4259b5fa6a8ecfe94e7ae512e1a8a3de0a03c0721e0683934a37868f6a421">llvm::TargetOpcode::KILL</a></div><div class="ttdef"><b>Definition:</b> <a href="TargetOpcodes_8h_source.html#l00035">TargetOpcodes.h:35</a></div></div>
<div class="ttc" id="namespacellvm_1_1X86II_html_a97dc14052814702ba0e2b14fb14dd02da910ed6a9ae2b24b98c26ae96e916f32c"><div class="ttname"><a href="namespacellvm_1_1X86II.html#a97dc14052814702ba0e2b14fb14dd02da910ed6a9ae2b24b98c26ae96e916f32c">llvm::X86II::OneArgFP</a></div><div class="ttdef"><b>Definition:</b> <a href="X86BaseInfo_8h_source.html#l00396">X86BaseInfo.h:396</a></div></div>
<div class="ttc" id="classllvm_1_1SmallPtrSetImpl_html_a41c201584742f7eb45b2be8cd54e3bcb"><div class="ttname"><a href="classllvm_1_1SmallPtrSetImpl.html#a41c201584742f7eb45b2be8cd54e3bcb">llvm::SmallPtrSetImpl::size</a></div><div class="ttdeci">unsigned size() const </div><div class="ttdef"><b>Definition:</b> <a href="SmallPtrSet_8h_source.html#l00075">SmallPtrSet.h:75</a></div></div>
<div class="ttc" id="classllvm_1_1MachineInstr_html_aff83f9aeef903ed06c5098f5172624ed"><div class="ttname"><a href="classllvm_1_1MachineInstr.html#aff83f9aeef903ed06c5098f5172624ed">llvm::MachineInstr::killsRegister</a></div><div class="ttdeci">bool killsRegister(unsigned Reg, const TargetRegisterInfo *TRI=NULL) const </div><div class="ttdef"><b>Definition:</b> <a href="MachineInstr_8h_source.html#l00745">MachineInstr.h:745</a></div></div>
<div class="ttc" id="classllvm_1_1AnalysisUsage_html_af11a6ebf7ab3c388234cb6d5378439a3"><div class="ttname"><a href="classllvm_1_1AnalysisUsage.html#af11a6ebf7ab3c388234cb6d5378439a3">llvm::AnalysisUsage::setPreservesCFG</a></div><div class="ttdeci">void setPreservesCFG()</div><div class="ttdef"><b>Definition:</b> <a href="Pass_8cpp_source.html#l00249">Pass.cpp:249</a></div></div>
<div class="ttc" id="classllvm_1_1MachineBasicBlock_html_a00c9d82d8d59adedd1734fed16051c73"><div class="ttname"><a href="classllvm_1_1MachineBasicBlock.html#a00c9d82d8d59adedd1734fed16051c73">llvm::MachineBasicBlock::remove</a></div><div class="ttdeci">MachineInstr * remove(MachineInstr *I)</div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8h_source.html#l00519">MachineBasicBlock.h:519</a></div></div>
<div class="ttc" id="namespacellvm_html_a7c46c742c31be54870e2038048e6b391"><div class="ttname"><a href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">llvm::dbgs</a></div><div class="ttdeci">raw_ostream &amp; dbgs()</div><div class="ttdoc">dbgs - Return a circular-buffered debug stream. </div><div class="ttdef"><b>Definition:</b> <a href="Debug_8cpp_source.html#l00101">Debug.cpp:101</a></div></div>
<div class="ttc" id="namespacestd_html_ab8424022895aee3e366fb9a32f2883cb"><div class="ttname"><a href="namespacestd.html#ab8424022895aee3e366fb9a32f2883cb">std::swap</a></div><div class="ttdeci">void swap(llvm::BitVector &amp;LHS, llvm::BitVector &amp;RHS)</div><div class="ttdoc">Implement std::swap in terms of BitVector swap. </div><div class="ttdef"><b>Definition:</b> <a href="BitVector_8h_source.html#l00591">BitVector.h:591</a></div></div>
<div class="ttc" id="namespacellvm_html_a8cee33dcd88f91352d495da4765d7471"><div class="ttname"><a href="namespacellvm.html#a8cee33dcd88f91352d495da4765d7471">llvm::createX86FloatingPointStackifierPass</a></div><div class="ttdeci">FunctionPass * createX86FloatingPointStackifierPass()</div><div class="ttdef"><b>Definition:</b> <a href="X86FloatingPoint_8cpp_source.html#l00326">X86FloatingPoint.cpp:326</a></div></div>
<div class="ttc" id="classllvm_1_1MachineBasicBlock_html_a454838c989e99a86bd804e056c367bd9"><div class="ttname"><a href="classllvm_1_1MachineBasicBlock.html#a454838c989e99a86bd804e056c367bd9">llvm::MachineBasicBlock::getName</a></div><div class="ttdeci">StringRef getName() const </div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8cpp_source.html#l00245">MachineBasicBlock.cpp:245</a></div></div>
<div class="ttc" id="CodeGen_2README_8txt_html_a09776db24cf586ec9f1e18f3bae14099"><div class="ttname"><a href="CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a></div><div class="ttdeci">Common register allocation spilling lr str ldr sxth r3 ldr mla r4 can lr mov lr str ldr sxth r3 mla r4 and then merge mul and lr str ldr sxth r3 mla r4 It also increase the likelihood the store may become dead bb27 Successors according to LLVM BB</div><div class="ttdef"><b>Definition:</b> <a href="CodeGen_2README_8txt_source.html#l00036">CodeGen/README.txt:36</a></div></div>
<div class="ttc" id="namespacellvm_html_a4233b4cb04d87d64916c8143ddfb7f77"><div class="ttname"><a href="namespacellvm.html#a4233b4cb04d87d64916c8143ddfb7f77">llvm::isMask_32</a></div><div class="ttdeci">bool isMask_32(uint32_t Value)</div><div class="ttdef"><b>Definition:</b> <a href="MathExtras_8h_source.html#l00328">MathExtras.h:328</a></div></div>
<div class="ttc" id="MachineRegisterInfo_8h_html"><div class="ttname"><a href="MachineRegisterInfo_8h.html">MachineRegisterInfo.h</a></div></div>
<div class="ttc" id="classllvm_1_1MachineInstr_html"><div class="ttname"><a href="classllvm_1_1MachineInstr.html">llvm::MachineInstr</a></div><div class="ttdef"><b>Definition:</b> <a href="MachineInstr_8h_source.html#l00050">MachineInstr.h:50</a></div></div>
<div class="ttc" id="X86FloatingPoint_8cpp_html_a3f0984675b87018d44304c32575a7c47"><div class="ttname"><a href="X86FloatingPoint_8cpp.html#a3f0984675b87018d44304c32575a7c47">ReverseST0Table</a></div><div class="ttdeci">static const TableEntry ReverseST0Table[]</div><div class="ttdef"><b>Definition:</b> <a href="X86FloatingPoint_8cpp_source.html#l01102">X86FloatingPoint.cpp:1102</a></div></div>
<div class="ttc" id="classllvm_1_1MachineFunction_html_ab4a6ca428289b667dd691a00e9f7e334"><div class="ttname"><a href="classllvm_1_1MachineFunction.html#ab4a6ca428289b667dd691a00e9f7e334">llvm::MachineFunction::getRegInfo</a></div><div class="ttdeci">MachineRegisterInfo &amp; getRegInfo()</div><div class="ttdef"><b>Definition:</b> <a href="MachineFunction_8h_source.html#l00167">MachineFunction.h:167</a></div></div>
<div class="ttc" id="classllvm_1_1MachineFunctionPass_html_aa1eece37d175f86a6f4808c0c167f13b"><div class="ttname"><a href="classllvm_1_1MachineFunctionPass.html#aa1eece37d175f86a6f4808c0c167f13b">llvm::MachineFunctionPass::getAnalysisUsage</a></div><div class="ttdeci">virtual void getAnalysisUsage(AnalysisUsage &amp;AU) const </div><div class="ttdef"><b>Definition:</b> <a href="MachineFunctionPass_8cpp_source.html#l00036">MachineFunctionPass.cpp:36</a></div></div>
<div class="ttc" id="namespacellvm_1_1TargetOpcode_html_a348d4259b5fa6a8ecfe94e7ae512e1a8a5a91c23866687baf221ce86ff6fde01f"><div class="ttname"><a href="namespacellvm_1_1TargetOpcode.html#a348d4259b5fa6a8ecfe94e7ae512e1a8a5a91c23866687baf221ce86ff6fde01f">llvm::TargetOpcode::IMPLICIT_DEF</a></div><div class="ttdoc">IMPLICIT_DEF - This is the MachineInstr-level equivalent of undef. </div><div class="ttdef"><b>Definition:</b> <a href="TargetOpcodes_8h_source.html#l00052">TargetOpcodes.h:52</a></div></div>
<div class="ttc" id="classllvm_1_1MachineOperand_html_a57bf9ee7219097ff0f98da23a3b3b782"><div class="ttname"><a href="classllvm_1_1MachineOperand.html#a57bf9ee7219097ff0f98da23a3b3b782">llvm::MachineOperand::isUse</a></div><div class="ttdeci">bool isUse() const </div><div class="ttdef"><b>Definition:</b> <a href="MachineOperand_8h_source.html#l00269">MachineOperand.h:269</a></div></div>
<div class="ttc" id="classllvm_1_1MachineOperand_html_a624a062754a09d3787614d8627096705"><div class="ttname"><a href="classllvm_1_1MachineOperand.html#a624a062754a09d3787614d8627096705">llvm::MachineOperand::setReg</a></div><div class="ttdeci">void setReg(unsigned Reg)</div><div class="ttdef"><b>Definition:</b> <a href="MachineInstr_8cpp_source.html#l00049">MachineInstr.cpp:49</a></div></div>
<div class="ttc" id="MD5_8cpp_html_ac0eafdc9ee161b71e7af98af736952fd"><div class="ttname"><a href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a></div><div class="ttdeci">#define I(x, y, z)</div><div class="ttdef"><b>Definition:</b> <a href="MD5_8cpp_source.html#l00054">MD5.cpp:54</a></div></div>
<div class="ttc" id="regcomp_8c_html_a0240ac851181b84ac374872dc5434ee4"><div class="ttname"><a href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a></div><div class="ttdeci">#define N</div></div>
<div class="ttc" id="classllvm_1_1SmallVectorImpl_html_a102d0ad36060677286c3aefb812e5512"><div class="ttname"><a href="classllvm_1_1SmallVectorImpl.html#a102d0ad36060677286c3aefb812e5512">llvm::SmallVectorImpl::resize</a></div><div class="ttdeci">void resize(unsigned N)</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00401">SmallVector.h:401</a></div></div>
<div class="ttc" id="classllvm_1_1MachineFunction_html_a6745c3bfdfc5b0643b078b96df2db252"><div class="ttname"><a href="classllvm_1_1MachineFunction.html#a6745c3bfdfc5b0643b078b96df2db252">llvm::MachineFunction::getTarget</a></div><div class="ttdeci">const TargetMachine &amp; getTarget() const </div><div class="ttdef"><b>Definition:</b> <a href="MachineFunction_8h_source.html#l00163">MachineFunction.h:163</a></div></div>
<div class="ttc" id="classllvm_1_1MachineBasicBlock_html_ab2d91e7bec944efcbc39d8e30644f111"><div class="ttname"><a href="classllvm_1_1MachineBasicBlock.html#ab2d91e7bec944efcbc39d8e30644f111">llvm::MachineBasicBlock::begin</a></div><div class="ttdeci">iterator begin()</div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8h_source.html#l00236">MachineBasicBlock.h:236</a></div></div>
<div class="ttc" id="classllvm_1_1EdgeBundles_html_ac1f97383ef8b8ee7c80c24f68e3c3597"><div class="ttname"><a href="classllvm_1_1EdgeBundles.html#ac1f97383ef8b8ee7c80c24f68e3c3597">llvm::EdgeBundles::getBundle</a></div><div class="ttdeci">unsigned getBundle(unsigned N, bool Out) const </div><div class="ttdef"><b>Definition:</b> <a href="EdgeBundles_8h_source.html#l00043">EdgeBundles.h:43</a></div></div>
<div class="ttc" id="classllvm_1_1MachineOperand_html_ab75f703d251cc0ce0206fe00a999db86"><div class="ttname"><a href="classllvm_1_1MachineOperand.html#ab75f703d251cc0ce0206fe00a999db86">llvm::MachineOperand::getReg</a></div><div class="ttdeci">unsigned getReg() const </div><div class="ttdoc">getReg - Returns the register number. </div><div class="ttdef"><b>Definition:</b> <a href="MachineOperand_8h_source.html#l00259">MachineOperand.h:259</a></div></div>
<div class="ttc" id="namespacellvm_1_1X86II_html_a97dc14052814702ba0e2b14fb14dd02dad9c72926f550ad00a4b35ba072ada7fc"><div class="ttname"><a href="namespacellvm_1_1X86II.html#a97dc14052814702ba0e2b14fb14dd02dad9c72926f550ad00a4b35ba072ada7fc">llvm::X86II::FPTypeMask</a></div><div class="ttdef"><b>Definition:</b> <a href="X86BaseInfo_8h_source.html#l00387">X86BaseInfo.h:387</a></div></div>
<div class="ttc" id="SmallVector_8h_html"><div class="ttname"><a href="SmallVector_8h.html">SmallVector.h</a></div></div>
<div class="ttc" id="classllvm_1_1MCInstrDesc_html_a55194ec3a1e49d04eab64e993e614246"><div class="ttname"><a href="classllvm_1_1MCInstrDesc.html#a55194ec3a1e49d04eab64e993e614246">llvm::MCInstrDesc::getNumOperands</a></div><div class="ttdeci">unsigned getNumOperands() const </div><div class="ttdoc">Return the number of declared MachineOperands for this MachineInstruction. Note that variadic (isVari...</div><div class="ttdef"><b>Definition:</b> <a href="MCInstrDesc_8h_source.html#l00190">MCInstrDesc.h:190</a></div></div>
<div class="ttc" id="X86FloatingPoint_8cpp_html_a79bccd1176385cddbdfafb156196cc87"><div class="ttname"><a href="X86FloatingPoint_8cpp.html#a79bccd1176385cddbdfafb156196cc87">ASSERT_SORTED</a></div><div class="ttdeci">#define ASSERT_SORTED(TABLE)</div><div class="ttdef"><b>Definition:</b> <a href="X86FloatingPoint_8cpp_source.html#l00606">X86FloatingPoint.cpp:606</a></div></div>
<div class="ttc" id="MachineFunctionPass_8h_html"><div class="ttname"><a href="MachineFunctionPass_8h.html">MachineFunctionPass.h</a></div></div>
<div class="ttc" id="namespacellvm_1_1A64CC_html_af5804bc0518be9568f73db566e4d6f46a2db5e7546f960277ff98f96cd5624442"><div class="ttname"><a href="namespacellvm_1_1A64CC.html#af5804bc0518be9568f73db566e4d6f46a2db5e7546f960277ff98f96cd5624442">llvm::A64CC::MI</a></div><div class="ttdef"><b>Definition:</b> <a href="AArch64BaseInfo_8h_source.html#l00035">AArch64BaseInfo.h:35</a></div></div>
<div class="ttc" id="classllvm_1_1MachineRegisterInfo_html_abe3c98b9803fa6a21eca279173c27b12"><div class="ttname"><a href="classllvm_1_1MachineRegisterInfo.html#abe3c98b9803fa6a21eca279173c27b12">llvm::MachineRegisterInfo::isPhysRegUsed</a></div><div class="ttdeci">bool isPhysRegUsed(unsigned Reg) const </div><div class="ttdef"><b>Definition:</b> <a href="MachineRegisterInfo_8h_source.html#l00416">MachineRegisterInfo.h:416</a></div></div>
<div class="ttc" id="classllvm_1_1MachineFunction_html_a340712de3e78fec11c338735cab17df7"><div class="ttname"><a href="classllvm_1_1MachineFunction.html#a340712de3e78fec11c338735cab17df7">llvm::MachineFunction::iterator</a></div><div class="ttdeci">BasicBlockListType::iterator iterator</div><div class="ttdef"><b>Definition:</b> <a href="MachineFunction_8h_source.html#l00303">MachineFunction.h:303</a></div></div>
<div class="ttc" id="namespacellvm_html_a7923e3e207de8bc1d0d6a5091316ddde"><div class="ttname"><a href="namespacellvm.html#a7923e3e207de8bc1d0d6a5091316ddde">llvm::prior</a></div><div class="ttdeci">ItTy prior(ItTy it, Dist n)</div><div class="ttdef"><b>Definition:</b> <a href="STLExtras_8h_source.html#l00167">STLExtras.h:167</a></div></div>
<div class="ttc" id="namespacellvm_1_1X86II_html_a97dc14052814702ba0e2b14fb14dd02da923b21f9b6b3b2a5ddfb326db177dc8a"><div class="ttname"><a href="namespacellvm_1_1X86II.html#a97dc14052814702ba0e2b14fb14dd02da923b21f9b6b3b2a5ddfb326db177dc8a">llvm::X86II::CompareFP</a></div><div class="ttdef"><b>Definition:</b> <a href="X86BaseInfo_8h_source.html#l00410">X86BaseInfo.h:410</a></div></div>
<div class="ttc" id="Debug_8h_html_aef41e8aaf4c60819b30faf396cdf4978"><div class="ttname"><a href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a></div><div class="ttdeci">#define DEBUG(X)</div><div class="ttdef"><b>Definition:</b> <a href="Debug_8h_source.html#l00097">Debug.h:97</a></div></div>
<div class="ttc" id="namespacellvm_html_a778bcc1dd6188bd894d03c68a3fb28e7"><div class="ttname"><a href="namespacellvm.html#a778bcc1dd6188bd894d03c68a3fb28e7">llvm::initializeEdgeBundlesPass</a></div><div class="ttdeci">void initializeEdgeBundlesPass(PassRegistry &amp;)</div></div>
<div class="ttc" id="namespacellvm_1_1TargetOpcode_html_a348d4259b5fa6a8ecfe94e7ae512e1a8ae48b49a3b740bb9162f647640fd19c21"><div class="ttname"><a href="namespacellvm_1_1TargetOpcode.html#a348d4259b5fa6a8ecfe94e7ae512e1a8ae48b49a3b740bb9162f647640fd19c21">llvm::TargetOpcode::INLINEASM</a></div><div class="ttdef"><b>Definition:</b> <a href="TargetOpcodes_8h_source.html#l00027">TargetOpcodes.h:27</a></div></div>
<div class="ttc" id="namespacellvm_1_1X86II_html_a97dc14052814702ba0e2b14fb14dd02da584c8de4beec92e693e6318cd38821fb"><div class="ttname"><a href="namespacellvm_1_1X86II.html#a97dc14052814702ba0e2b14fb14dd02da584c8de4beec92e693e6318cd38821fb">llvm::X86II::OneArgFPRW</a></div><div class="ttdef"><b>Definition:</b> <a href="X86BaseInfo_8h_source.html#l00401">X86BaseInfo.h:401</a></div></div>
<div class="ttc" id="raw__ostream_8h_html"><div class="ttname"><a href="raw__ostream_8h.html">raw_ostream.h</a></div></div>
<div class="ttc" id="CodeGen_2Passes_8h_html"><div class="ttname"><a href="CodeGen_2Passes_8h.html">Passes.h</a></div></div>
<div class="ttc" id="classllvm_1_1MachineInstrBuilder_html_a5125cce72b214df09ca8f93dcbbf4c3a"><div class="ttname"><a href="classllvm_1_1MachineInstrBuilder.html#a5125cce72b214df09ca8f93dcbbf4c3a">llvm::MachineInstrBuilder::addReg</a></div><div class="ttdeci">const MachineInstrBuilder &amp; addReg(unsigned RegNo, unsigned flags=0, unsigned SubReg=0) const </div><div class="ttdef"><b>Definition:</b> <a href="MachineInstrBuilder_8h_source.html#l00064">MachineInstrBuilder.h:64</a></div></div>
<div class="ttc" id="namespacellvm_1_1RegState_html_a079b254e749130fbe5d740f314ca92daa72c17e2ff2d5af62a30e56ac152aa8d5"><div class="ttname"><a href="namespacellvm_1_1RegState.html#a079b254e749130fbe5d740f314ca92daa72c17e2ff2d5af62a30e56ac152aa8d5">llvm::RegState::Define</a></div><div class="ttdef"><b>Definition:</b> <a href="MachineInstrBuilder_8h_source.html#l00031">MachineInstrBuilder.h:31</a></div></div>
<div class="ttc" id="classllvm_1_1MachineInstr_html_a5ca4af2a257043145ad650eafb4402f9"><div class="ttname"><a href="classllvm_1_1MachineInstr.html#a5ca4af2a257043145ad650eafb4402f9">llvm::MachineInstr::getDebugLoc</a></div><div class="ttdeci">DebugLoc getDebugLoc() const </div><div class="ttdef"><b>Definition:</b> <a href="MachineInstr_8h_source.html#l00244">MachineInstr.h:244</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<hr>
<p class="footer">
Generated on Sat Nov 10 2018 23:03:11 for <a href="http://llvm.org/">LLVM</a> by
<a href="http://www.doxygen.org"><img src="doxygen.png" alt="Doxygen"
align="middle" border="0"/>1.8.11</a><br>
Copyright &copy; 2003-2013 University of Illinois at Urbana-Champaign.
All Rights Reserved.</p>
<hr>
<!--#include virtual="/attrib.incl" -->
</body>
</html>
