<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head>
<meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1"/>
<meta name="keywords" content="LLVM,Low Level Virtual Machine,C++,doxygen,API,documentation"/>
<meta name="description" content="C++ source code API documentation for LLVM."/>
<title>LLVM: DAGCombiner.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head><body>
<p class="title">LLVM API Documentation</p>
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('DAGCombiner_8cpp_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">DAGCombiner.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="DAGCombiner_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//===-- DAGCombiner.cpp - Implement a DAG node combiner -------------------===//</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">//                     The LLVM Compiler Infrastructure</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// This file is distributed under the University of Illinois Open Source</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">// License. See LICENSE.TXT for details.</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">// This pass combines dag nodes to form fewer, simpler DAG nodes.  It can be run</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">// both before and after the DAG is legalized.</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">// This pass is not a substitute for the LLVM IR instcombine pass. This pass is</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">// primarily intended to handle simplification opportunities that are implicit</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">// in the LLVM IR and exposed by the various codegen lowering phases.</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;</div><div class="line"><a name="l00019"></a><span class="lineno"><a class="line" href="DAGCombiner_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">   19</a></span>&#160;<span class="preprocessor">#define DEBUG_TYPE &quot;dagcombine&quot;</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="SelectionDAG_8h.html">llvm/CodeGen/SelectionDAG.h</a>&quot;</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="SmallPtrSet_8h.html">llvm/ADT/SmallPtrSet.h</a>&quot;</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Statistic_8h.html">llvm/ADT/Statistic.h</a>&quot;</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="AliasAnalysis_8h.html">llvm/Analysis/AliasAnalysis.h</a>&quot;</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="MachineFrameInfo_8h.html">llvm/CodeGen/MachineFrameInfo.h</a>&quot;</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="MachineFunction_8h.html">llvm/CodeGen/MachineFunction.h</a>&quot;</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="DataLayout_8h.html">llvm/IR/DataLayout.h</a>&quot;</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="DerivedTypes_8h.html">llvm/IR/DerivedTypes.h</a>&quot;</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Function_8h.html">llvm/IR/Function.h</a>&quot;</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="LLVMContext_8h.html">llvm/IR/LLVMContext.h</a>&quot;</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="CommandLine_8h.html">llvm/Support/CommandLine.h</a>&quot;</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Debug_8h.html">llvm/Support/Debug.h</a>&quot;</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ErrorHandling_8h.html">llvm/Support/ErrorHandling.h</a>&quot;</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="MathExtras_8h.html">llvm/Support/MathExtras.h</a>&quot;</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="raw__ostream_8h.html">llvm/Support/raw_ostream.h</a>&quot;</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TargetLowering_8h.html">llvm/Target/TargetLowering.h</a>&quot;</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Target_2TargetMachine_8h.html">llvm/Target/TargetMachine.h</a>&quot;</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TargetOptions_8h.html">llvm/Target/TargetOptions.h</a>&quot;</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TargetRegisterInfo_8h.html">llvm/Target/TargetRegisterInfo.h</a>&quot;</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TargetSubtargetInfo_8h.html">llvm/Target/TargetSubtargetInfo.h</a>&quot;</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#include &lt;algorithm&gt;</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespacellvm.html">llvm</a>;</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<a class="code" href="DAGCombiner_8cpp.html#a2ca1d07b97e41f047418b6428ce0f31d">STATISTIC</a>(NodesCombined   , <span class="stringliteral">&quot;Number of dag nodes combined&quot;</span>);</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<a class="code" href="DAGCombiner_8cpp.html#a2ca1d07b97e41f047418b6428ce0f31d">STATISTIC</a>(PreIndexedNodes , <span class="stringliteral">&quot;Number of pre-indexed nodes created&quot;</span>);</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<a class="code" href="DAGCombiner_8cpp.html#a2ca1d07b97e41f047418b6428ce0f31d">STATISTIC</a>(PostIndexedNodes, <span class="stringliteral">&quot;Number of post-indexed nodes created&quot;</span>);</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<a class="code" href="DAGCombiner_8cpp.html#a2ca1d07b97e41f047418b6428ce0f31d">STATISTIC</a>(OpsNarrowed     , <span class="stringliteral">&quot;Number of load/op/store narrowed&quot;</span>);</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<a class="code" href="DAGCombiner_8cpp.html#a2ca1d07b97e41f047418b6428ce0f31d">STATISTIC</a>(LdStFP2Int      , <span class="stringliteral">&quot;Number of fp load/store pairs transformed to int&quot;</span>);</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<a class="code" href="DAGCombiner_8cpp.html#a2ca1d07b97e41f047418b6428ce0f31d">STATISTIC</a>(SlicedLoads, <span class="stringliteral">&quot;Number of load sliced&quot;</span>);</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="keyword">namespace </span>{</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  <span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;bool&gt;</a></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    CombinerAA(<span class="stringliteral">&quot;combiner-alias-analysis&quot;</span>, <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>,</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;               <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Turn on alias analysis during testing&quot;</span>));</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  <span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;bool&gt;</a></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    CombinerGlobalAA(<span class="stringliteral">&quot;combiner-global-alias-analysis&quot;</span>, <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>,</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;               <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Include global information in alias analysis&quot;</span>));</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">  /// Hidden option to stress test load slicing, i.e., when this option</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">  /// is enabled, load slicing bypasses most of its profitability guards.</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment"></span>  <span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;bool&gt;</a></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  StressLoadSlicing(<span class="stringliteral">&quot;combiner-stress-load-slicing&quot;</span>, <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>,</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;                    <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Bypass the profitability model of load &quot;</span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;                             <span class="stringliteral">&quot;slicing&quot;</span>),</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;                    <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(<span class="keyword">false</span>));</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">//------------------------------ DAGCombiner ---------------------------------//</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  <span class="keyword">class </span>DAGCombiner {</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <a class="code" href="classllvm_1_1SelectionDAG.html">SelectionDAG</a> &amp;DAG;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetLowering.html">TargetLowering</a> &amp;TLI;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <a class="code" href="namespacellvm.html#aa6d856e4879bb775617f8c3634773b7a">CombineLevel</a> <a class="code" href="namespacellvm_1_1CodeGenOpt.html#a411055ea15209051c2370bbf655ec8d4">Level</a>;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <a class="code" href="namespacellvm_1_1CodeGenOpt.html#a411055ea15209051c2370bbf655ec8d4">CodeGenOpt::Level</a> OptLevel;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <span class="keywordtype">bool</span> LegalOperations;</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="keywordtype">bool</span> LegalTypes;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <span class="keywordtype">bool</span> ForCodeSize;</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="comment">// Worklist of all of the nodes that need to be simplified.</span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <span class="comment">//</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <span class="comment">// This has the semantics that when adding to the worklist,</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="comment">// the item added must be next to be processed. It should</span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <span class="comment">// also only appear once. The naive approach to this takes</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <span class="comment">// linear time.</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="comment">//</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="comment">// To reduce the insert/remove time to logarithmic, we use</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="comment">// a set and a vector to maintain our worklist.</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <span class="comment">//</span></div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="comment">// The set contains the items on the worklist, but does not</span></div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <span class="comment">// maintain the order they should be visited.</span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="comment">//</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="comment">// The vector maintains the order nodes should be visited, but may</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="comment">// contain duplicate or removed nodes. When choosing a node to</span></div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="comment">// visit, we pop off the order stack until we find an item that is</span></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="comment">// also in the contents set. All operations are O(log N).</span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;SDNode*, 64&gt;</a> WorkListContents;</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;SDNode*, 64&gt;</a> WorkListOrder;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="comment">// AA - Used for DAG load/store alias analysis.</span></div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <a class="code" href="classllvm_1_1AliasAnalysis.html">AliasAnalysis</a> &amp;AA;</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment">    /// AddUsersToWorkList - When an instruction is simplified, add all users of</span></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment">    /// the instruction to the work lists because they might get more simplified</span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment">    /// now.</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">    ///</span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> AddUsersToWorkList(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *<a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>) {</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1SDNode_1_1use__iterator.html">SDNode::use_iterator</a> UI = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a8810bf428dcf84d48f39c8f5ba9a8c94">use_begin</a>(), UE = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#aef02f2c1bd12936a80611b134b24a47d">use_end</a>();</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;           UI != UE; ++UI)</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        AddToWorkList(*UI);</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    }</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment">    /// visit - call the node-specific routine that knows how to fold each</span></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment">    /// particular type of node.</span></div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment"></span>    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> visit(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N);</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  <span class="keyword">public</span>:<span class="comment"></span></div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment">    /// AddToWorkList - Add to the work list making sure its instance is at the</span></div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment">    /// back (next to be processed.)</span></div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> AddToWorkList(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N) {</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;      WorkListContents.<a class="code" href="classllvm_1_1SmallPtrSet.html#a9b6dd0fc7a648a939e571246045b673e">insert</a>(N);</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;      WorkListOrder.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(N);</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    }</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment">    /// removeFromWorkList - remove all instances of N from the worklist.</span></div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment">    ///</span></div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> removeFromWorkList(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N) {</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;      WorkListContents.<a class="code" href="classllvm_1_1SmallPtrSet.html#a2ce650c1d4a48661b501206d04b6ab04">erase</a>(N);</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    }</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> CombineTo(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N, <span class="keyword">const</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> *To, <span class="keywordtype">unsigned</span> NumTo,</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;                      <span class="keywordtype">bool</span> AddTo = <span class="keyword">true</span>);</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> CombineTo(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N, <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Res, <span class="keywordtype">bool</span> AddTo = <span class="keyword">true</span>) {</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;      <span class="keywordflow">return</span> CombineTo(N, &amp;Res, 1, AddTo);</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    }</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> CombineTo(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N, <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Res0, <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Res1,</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                      <span class="keywordtype">bool</span> AddTo = <span class="keyword">true</span>) {</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> To[] = { Res0, Res1 };</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;      <span class="keywordflow">return</span> CombineTo(N, To, 2, AddTo);</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    }</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <span class="keywordtype">void</span> CommitTargetLoweringOpt(<span class="keyword">const</span> <a class="code" href="structllvm_1_1TargetLowering_1_1TargetLoweringOpt.html">TargetLowering::TargetLoweringOpt</a> &amp;TLO);</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  <span class="keyword">private</span>:</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment">    /// SimplifyDemandedBits - Check the specified integer node value to see if</span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment">    /// it can be simplified or if things it uses can be simplified by bit</span></div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment">    /// propagation.  If so, return true.</span></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment"></span>    <span class="keywordtype">bool</span> SimplifyDemandedBits(<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Op) {</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;      <span class="keywordtype">unsigned</span> BitWidth = Op.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>().<a class="code" href="structllvm_1_1EVT.html#a15be9767d0aad93fe5dcb60b7b7a78da">getScalarType</a>().<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>();</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;      <a class="code" href="classllvm_1_1APInt.html">APInt</a> Demanded = <a class="code" href="classllvm_1_1APInt.html#a539bdb4fdbf46e0bfcefebf5ac6d21dd">APInt::getAllOnesValue</a>(BitWidth);</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;      <span class="keywordflow">return</span> SimplifyDemandedBits(Op, Demanded);</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    }</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <span class="keywordtype">bool</span> SimplifyDemandedBits(<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Op, <span class="keyword">const</span> <a class="code" href="classllvm_1_1APInt.html">APInt</a> &amp;Demanded);</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="keywordtype">bool</span> CombineToPreIndexedLoadStore(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N);</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="keywordtype">bool</span> CombineToPostIndexedLoadStore(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N);</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <span class="keywordtype">bool</span> SliceUpLoad(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N);</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="keywordtype">void</span> ReplaceLoadWithPromotedLoad(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *<a class="code" href="namespacellvm_1_1SPII.html#a11e9b8fca4a074643a6a21f444e51406a5069619ca8fdce305534f3fe85091a0f">Load</a>, <a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *ExtLoad);</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> PromoteOperand(<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Op, <a class="code" href="structllvm_1_1EVT.html">EVT</a> PVT, <span class="keywordtype">bool</span> &amp;Replace);</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> SExtPromoteOperand(<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Op, <a class="code" href="structllvm_1_1EVT.html">EVT</a> PVT);</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> ZExtPromoteOperand(<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Op, <a class="code" href="structllvm_1_1EVT.html">EVT</a> PVT);</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> PromoteIntBinOp(<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Op);</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> PromoteIntShiftOp(<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Op);</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> PromoteExtend(<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Op);</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="keywordtype">bool</span> PromoteLoad(<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Op);</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="keywordtype">void</span> ExtendSetCCUses(<span class="keyword">const</span> <a class="code" href="classllvm_1_1SmallVectorImpl.html">SmallVectorImpl&lt;SDNode *&gt;</a> &amp;SetCCs,</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                         <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Trunc, <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> ExtLoad, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a> DL,</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;                         <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110">ISD::NodeType</a> ExtType);</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="comment">    /// combine - call the node-specific routine that knows how to fold each</span></div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="comment">    /// particular type of node. If that doesn&#39;t do anything, try the</span></div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="comment">    /// target-specific DAG combines.</span></div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment"></span>    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> combine(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N);</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="comment">// Visitation implementation - Implement dag node combining for different</span></div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <span class="comment">// node types.  The semantics are as follows:</span></div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <span class="comment">// Return Value:</span></div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="comment">//   SDValue.getNode() == 0 - No change was made</span></div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="comment">//   SDValue.getNode() == N - N was replaced, is dead and has been handled.</span></div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="comment">//   otherwise              - N should be replaced by the returned Operand.</span></div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="comment">//</span></div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> visitTokenFactor(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N);</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> visitMERGE_VALUES(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N);</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> visitADD(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N);</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> visitSUB(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N);</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> visitADDC(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N);</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> visitSUBC(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N);</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> visitADDE(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N);</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> visitSUBE(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N);</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> visitMUL(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N);</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> visitSDIV(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N);</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> visitUDIV(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N);</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> visitSREM(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N);</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> visitUREM(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N);</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> visitMULHU(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N);</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> visitMULHS(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N);</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> visitSMUL_LOHI(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N);</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> visitUMUL_LOHI(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N);</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> visitSMULO(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N);</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> visitUMULO(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N);</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> visitSDIVREM(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N);</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> visitUDIVREM(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N);</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> visitAND(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N);</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> visitOR(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N);</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> visitXOR(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N);</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> SimplifyVBinOp(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N);</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> SimplifyVUnaryOp(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N);</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> visitSHL(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N);</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> visitSRA(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N);</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> visitSRL(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N);</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> visitCTLZ(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N);</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> visitCTLZ_ZERO_UNDEF(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N);</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> visitCTTZ(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N);</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> visitCTTZ_ZERO_UNDEF(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N);</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> visitCTPOP(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N);</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> visitSELECT(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N);</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> visitVSELECT(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N);</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> visitSELECT_CC(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N);</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> visitSETCC(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N);</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> visitSIGN_EXTEND(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N);</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> visitZERO_EXTEND(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N);</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> visitANY_EXTEND(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N);</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> visitSIGN_EXTEND_INREG(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N);</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> visitTRUNCATE(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N);</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> visitBITCAST(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N);</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> visitBUILD_PAIR(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N);</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> visitFADD(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N);</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> visitFSUB(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N);</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> visitFMUL(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N);</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> visitFMA(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N);</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> visitFDIV(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N);</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> visitFREM(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N);</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> visitFCOPYSIGN(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N);</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> visitSINT_TO_FP(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N);</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> visitUINT_TO_FP(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N);</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> visitFP_TO_SINT(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N);</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> visitFP_TO_UINT(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N);</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> visitFP_ROUND(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N);</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> visitFP_ROUND_INREG(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N);</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> visitFP_EXTEND(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N);</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> visitFNEG(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N);</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> visitFABS(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N);</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> visitFCEIL(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N);</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> visitFTRUNC(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N);</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> visitFFLOOR(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N);</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> visitBRCOND(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N);</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> visitBR_CC(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N);</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> visitLOAD(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N);</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> visitSTORE(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N);</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> visitINSERT_VECTOR_ELT(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N);</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> visitEXTRACT_VECTOR_ELT(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N);</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> visitBUILD_VECTOR(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N);</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> visitCONCAT_VECTORS(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N);</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> visitEXTRACT_SUBVECTOR(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N);</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> visitVECTOR_SHUFFLE(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N);</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> XformToShuffleWithZero(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N);</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> ReassociateOps(<span class="keywordtype">unsigned</span> Opc, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a> DL, <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> LHS, <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> RHS);</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> visitShiftByConstant(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N, <span class="keywordtype">unsigned</span> Amt);</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <span class="keywordtype">bool</span> SimplifySelectOps(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a78d0f198115bfe3331ab7cfcf7a40a97">SELECT</a>, <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> LHS, <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> RHS);</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> SimplifyBinOpWithSameOpcodeHands(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N);</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> SimplifySelect(<a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a> DL, <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N0, <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N1, <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N2);</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> SimplifySelectCC(<a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a> DL, <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N0, <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N1, <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N2,</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;                             <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N3, <a class="code" href="namespacellvm_1_1ISD.html#ac3c3cf58d6d631af6a172457304d3d07">ISD::CondCode</a> <a class="code" href="Target_2PowerPC_2README_8txt.html#afc7ca55ad1da67847ecd4b99ef64dc84">CC</a>,</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;                             <span class="keywordtype">bool</span> NotExtCompare = <span class="keyword">false</span>);</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> SimplifySetCC(<a class="code" href="structllvm_1_1EVT.html">EVT</a> VT, <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N0, <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N1, <a class="code" href="namespacellvm_1_1ISD.html#ac3c3cf58d6d631af6a172457304d3d07">ISD::CondCode</a> Cond,</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;                          <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a> DL, <span class="keywordtype">bool</span> foldBooleans = <span class="keyword">true</span>);</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> SimplifyNodeWithTwoResults(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N, <span class="keywordtype">unsigned</span> LoOp,</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;                                         <span class="keywordtype">unsigned</span> HiOp);</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> CombineConsecutiveLoads(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N, <a class="code" href="structllvm_1_1EVT.html">EVT</a> VT);</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> ConstantFoldBITCASTofBUILD_VECTOR(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *, <a class="code" href="structllvm_1_1EVT.html">EVT</a>);</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> BuildSDIV(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N);</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> BuildUDIV(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N);</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> MatchBSwapHWordLow(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N, <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N0, <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N1,</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;                               <span class="keywordtype">bool</span> DemandHighBits = <span class="keyword">true</span>);</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> MatchBSwapHWord(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N, <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N0, <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N1);</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *MatchRotate(<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> LHS, <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> RHS, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a> DL);</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> ReduceLoadWidth(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N);</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> ReduceLoadOpStoreWidth(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N);</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> TransformFPLoadStorePair(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N);</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> reduceBuildVecExtToExtBuildVec(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N);</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> reduceBuildVecConvertToConvertBuildVec(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N);</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> GetDemandedBits(<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> V, <span class="keyword">const</span> <a class="code" href="classllvm_1_1APInt.html">APInt</a> &amp;Mask);</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="comment">    /// GatherAllAliases - Walk up chain skipping non-aliasing memory nodes,</span></div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="comment">    /// looking for aliasing nodes and adding them to the Aliases vector.</span></div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> GatherAllAliases(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N, <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> OriginalChain,</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;                          <a class="code" href="classllvm_1_1SmallVectorImpl.html">SmallVectorImpl&lt;SDValue&gt;</a> &amp;Aliases);</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="comment">    /// isAlias - Return true if there is any possibility that the two addresses</span></div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="comment">    /// overlap.</span></div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment"></span>    <span class="keywordtype">bool</span> isAlias(<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Ptr1, int64_t Size1, <span class="keywordtype">bool</span> IsVolatile1,</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;                 <span class="keyword">const</span> <a class="code" href="classllvm_1_1Value.html">Value</a> *SrcValue1, <span class="keywordtype">int</span> SrcValueOffset1,</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;                 <span class="keywordtype">unsigned</span> SrcValueAlign1,</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;                 <span class="keyword">const</span> <a class="code" href="classllvm_1_1MDNode.html">MDNode</a> *TBAAInfo1,</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                 <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Ptr2, int64_t Size2, <span class="keywordtype">bool</span> IsVolatile2,</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;                 <span class="keyword">const</span> <a class="code" href="classllvm_1_1Value.html">Value</a> *SrcValue2, <span class="keywordtype">int</span> SrcValueOffset2,</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                 <span class="keywordtype">unsigned</span> SrcValueAlign2,</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                 <span class="keyword">const</span> <a class="code" href="classllvm_1_1MDNode.html">MDNode</a> *TBAAInfo2) <span class="keyword">const</span>;</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="comment">    /// isAlias - Return true if there is any possibility that the two addresses</span></div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="comment">    /// overlap.</span></div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="comment"></span>    <span class="keywordtype">bool</span> isAlias(<a class="code" href="classllvm_1_1LSBaseSDNode.html">LSBaseSDNode</a> *Op0, <a class="code" href="classllvm_1_1LSBaseSDNode.html">LSBaseSDNode</a> *Op1);</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="comment">    /// FindAliasInfo - Extracts the relevant alias information from the memory</span></div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="comment">    /// node.  Returns true if the operand was a load.</span></div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="comment"></span>    <span class="keywordtype">bool</span> FindAliasInfo(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N,</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;                       <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> &amp;Ptr, int64_t &amp;Size, <span class="keywordtype">bool</span> &amp;IsVolatile,</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;                       <span class="keyword">const</span> <a class="code" href="classllvm_1_1Value.html">Value</a> *&amp;SrcValue, <span class="keywordtype">int</span> &amp;SrcValueOffset,</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;                       <span class="keywordtype">unsigned</span> &amp;SrcValueAlignment,</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;                       <span class="keyword">const</span> <a class="code" href="classllvm_1_1MDNode.html">MDNode</a> *&amp;TBAAInfo) <span class="keyword">const</span>;</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="comment">    /// FindBetterChain - Walk up chain skipping non-aliasing memory nodes,</span></div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="comment">    /// looking for a better chain (aliasing node.)</span></div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="comment"></span>    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> FindBetterChain(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N, <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Chain);</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="comment">    /// Merge consecutive store operations into a wide store.</span></div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="comment">    /// This optimization uses wide integers or vectors when possible.</span></div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="comment">    /// \return True if some memory operations were changed.</span></div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="comment"></span>    <span class="keywordtype">bool</span> MergeConsecutiveStores(<a class="code" href="classllvm_1_1StoreSDNode.html">StoreSDNode</a> *N);</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  <span class="keyword">public</span>:</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    DAGCombiner(<a class="code" href="classllvm_1_1SelectionDAG.html">SelectionDAG</a> &amp;D, <a class="code" href="classllvm_1_1AliasAnalysis.html">AliasAnalysis</a> &amp;<a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>, <a class="code" href="namespacellvm_1_1CodeGenOpt.html#a411055ea15209051c2370bbf655ec8d4">CodeGenOpt::Level</a> OL)</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;        : DAG(D), TLI(D.getTargetLoweringInfo()), Level(<a class="code" href="namespacellvm.html#aa6d856e4879bb775617f8c3634773b7aa9386e6e4a4c86dabf136bc0fc9f6cf3b">BeforeLegalizeTypes</a>),</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;          OptLevel(OL), LegalOperations(<a class="code" href="namespacefalse.html">false</a>), LegalTypes(<a class="code" href="namespacefalse.html">false</a>), AA(A) {</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;      <a class="code" href="classllvm_1_1AttributeSet.html">AttributeSet</a> FnAttrs =</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;          DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a95d3f899fd68931ed5fa42e012468bdb">getMachineFunction</a>().<a class="code" href="classllvm_1_1MachineFunction.html#ad784a6594990530bffb2018aeeed56f3">getFunction</a>()-&gt;<a class="code" href="classllvm_1_1Function.html#a72873ed64b7be01507a2248b8e756ec8">getAttributes</a>();</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;      ForCodeSize =</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;          FnAttrs.<a class="code" href="classllvm_1_1AttributeSet.html#a54abbe67d4a53c92652f1666dc19281f">hasAttribute</a>(AttributeSet::FunctionIndex,</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;                               <a class="code" href="classllvm_1_1Attribute.html#aab7ee4b8fd1d3e7e4cea87868855e60ea2ac83e0612ce8f8d69651cd529061feb">Attribute::OptimizeForSize</a>) ||</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;          FnAttrs.<a class="code" href="classllvm_1_1AttributeSet.html#a54abbe67d4a53c92652f1666dc19281f">hasAttribute</a>(AttributeSet::FunctionIndex, <a class="code" href="classllvm_1_1Attribute.html#aab7ee4b8fd1d3e7e4cea87868855e60ea490ee0eef953b867ec5f39859c6a03bf">Attribute::MinSize</a>);</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    }</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="comment">    /// Run - runs the dag combiner on all nodes in the work list</span></div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> Run(<a class="code" href="namespacellvm.html#aa6d856e4879bb775617f8c3634773b7a">CombineLevel</a> AtLevel);</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <a class="code" href="classllvm_1_1SelectionDAG.html">SelectionDAG</a> &amp;getDAG()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> DAG; }</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="comment">    /// getShiftAmountTy - Returns a type large enough to hold any valid</span></div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="comment">    /// shift amount - before type legalization these can be huge.</span></div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="comment"></span>    <a class="code" href="structllvm_1_1EVT.html">EVT</a> getShiftAmountTy(<a class="code" href="structllvm_1_1EVT.html">EVT</a> LHSTy) {</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;      assert(LHSTy.<a class="code" href="structllvm_1_1EVT.html#a8cc407ac00df4edd4ec4d5168d6ecb26">isInteger</a>() &amp;&amp; <span class="stringliteral">&quot;Shift amount is not an integer type!&quot;</span>);</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;      <span class="keywordflow">if</span> (LHSTy.<a class="code" href="structllvm_1_1EVT.html#a73f7c824cad61a47c21bf6d652ae2fd7">isVector</a>())</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;        <span class="keywordflow">return</span> LHSTy;</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;      <span class="keywordflow">return</span> LegalTypes ? TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a0a5f9cfaec7239ea289716ff11c8e56a">getScalarShiftAmountTy</a>(LHSTy)</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;                        : TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a2824c264a25f2f03586588c7020b7a5d">getPointerTy</a>();</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    }</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="comment">    /// isTypeLegal - This method returns true if we are running before type</span></div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="comment">    /// legalization or if the specified VT is legal.</span></div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="comment"></span>    <span class="keywordtype">bool</span> isTypeLegal(<span class="keyword">const</span> <a class="code" href="structllvm_1_1EVT.html">EVT</a> &amp;VT) {</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;      <span class="keywordflow">if</span> (!LegalTypes) <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;      <span class="keywordflow">return</span> TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a861aaccc0f468493e76c011811548804">isTypeLegal</a>(VT);</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    }</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="comment">    /// getSetCCResultType - Convenience wrapper around</span></div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="comment">    /// TargetLowering::getSetCCResultType</span></div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="comment"></span>    <a class="code" href="structllvm_1_1EVT.html">EVT</a> getSetCCResultType(<a class="code" href="structllvm_1_1EVT.html">EVT</a> VT)<span class="keyword"> const </span>{</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;      <span class="keywordflow">return</span> TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a6bae2f7f49a5438c150cbd4cbdda11f9">getSetCCResultType</a>(*DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a39c6dff47b8dbd25cfaf6336c7056077">getContext</a>(), VT);</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    }</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;  };</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;}</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="keyword">namespace </span>{<span class="comment"></span></div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="comment">/// WorkListRemover - This class is a DAGUpdateListener that removes any deleted</span></div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="comment">/// nodes from the worklist.</span></div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="comment"></span><span class="keyword">class </span>WorkListRemover : <span class="keyword">public</span> <a class="code" href="structllvm_1_1SelectionDAG_1_1DAGUpdateListener.html">SelectionDAG::DAGUpdateListener</a> {</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;  DAGCombiner &amp;<a class="code" href="namespacellvm_1_1X86II.html#a97dc14052814702ba0e2b14fb14dd02da41e3661a4c59a694dcd9b978acdde1a9">DC</a>;</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;  <span class="keyword">explicit</span> WorkListRemover(DAGCombiner &amp;dc)</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    : <a class="code" href="classllvm_1_1SelectionDAG.html">SelectionDAG</a>::DAGUpdateListener(dc.getDAG()), DC(dc) {}</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span> NodeDeleted(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N, <a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *E) {</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    DC.removeFromWorkList(N);</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;  }</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;};</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;}</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="comment">//  TargetLowering::DAGCombinerInfo implementation</span></div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;</div><div class="line"><a name="l00391"></a><span class="lineno"><a class="line" href="structllvm_1_1TargetLowering_1_1DAGCombinerInfo.html#a9e3e1453357b1b1cd870a4ac3528f918">  391</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="structllvm_1_1TargetLowering_1_1DAGCombinerInfo.html#a9e3e1453357b1b1cd870a4ac3528f918">TargetLowering::DAGCombinerInfo::AddToWorklist</a>(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N) {</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;  ((DAGCombiner*)<a class="code" href="namespacellvm_1_1X86II.html#a97dc14052814702ba0e2b14fb14dd02da41e3661a4c59a694dcd9b978acdde1a9">DC</a>)-&gt;AddToWorkList(N);</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;}</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;</div><div class="line"><a name="l00395"></a><span class="lineno"><a class="line" href="structllvm_1_1TargetLowering_1_1DAGCombinerInfo.html#a2e1d73eb122a4b894d4f2b08ef46ffdf">  395</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="structllvm_1_1TargetLowering_1_1DAGCombinerInfo.html#a2e1d73eb122a4b894d4f2b08ef46ffdf">TargetLowering::DAGCombinerInfo::RemoveFromWorklist</a>(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N) {</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  ((DAGCombiner*)<a class="code" href="namespacellvm_1_1X86II.html#a97dc14052814702ba0e2b14fb14dd02da41e3661a4c59a694dcd9b978acdde1a9">DC</a>)-&gt;removeFromWorkList(N);</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;}</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> <a class="code" href="structllvm_1_1TargetLowering_1_1DAGCombinerInfo.html#a00151b714ce26a44b0c8288bf93696cf">TargetLowering::DAGCombinerInfo::</a></div><div class="line"><a name="l00400"></a><span class="lineno"><a class="line" href="structllvm_1_1TargetLowering_1_1DAGCombinerInfo.html#a00151b714ce26a44b0c8288bf93696cf">  400</a></span>&#160;<a class="code" href="structllvm_1_1TargetLowering_1_1DAGCombinerInfo.html#a00151b714ce26a44b0c8288bf93696cf">CombineTo</a>(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N, <span class="keyword">const</span> std::vector&lt;SDValue&gt; &amp;To, <span class="keywordtype">bool</span> AddTo) {</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;  <span class="keywordflow">return</span> ((DAGCombiner*)<a class="code" href="namespacellvm_1_1X86II.html#a97dc14052814702ba0e2b14fb14dd02da41e3661a4c59a694dcd9b978acdde1a9">DC</a>)-&gt;CombineTo(N, &amp;To[0], To.size(), AddTo);</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;}</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> <a class="code" href="structllvm_1_1TargetLowering_1_1DAGCombinerInfo.html#a00151b714ce26a44b0c8288bf93696cf">TargetLowering::DAGCombinerInfo::</a></div><div class="line"><a name="l00405"></a><span class="lineno"><a class="line" href="structllvm_1_1TargetLowering_1_1DAGCombinerInfo.html#a7cf6bcad9fbd93aa99faf16377831feb">  405</a></span>&#160;<a class="code" href="structllvm_1_1TargetLowering_1_1DAGCombinerInfo.html#a00151b714ce26a44b0c8288bf93696cf">CombineTo</a>(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N, <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Res, <span class="keywordtype">bool</span> AddTo) {</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;  <span class="keywordflow">return</span> ((DAGCombiner*)<a class="code" href="namespacellvm_1_1X86II.html#a97dc14052814702ba0e2b14fb14dd02da41e3661a4c59a694dcd9b978acdde1a9">DC</a>)-&gt;CombineTo(N, Res, AddTo);</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;}</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> <a class="code" href="structllvm_1_1TargetLowering_1_1DAGCombinerInfo.html#a00151b714ce26a44b0c8288bf93696cf">TargetLowering::DAGCombinerInfo::</a></div><div class="line"><a name="l00411"></a><span class="lineno"><a class="line" href="structllvm_1_1TargetLowering_1_1DAGCombinerInfo.html#a9ed65892d0b297e512746d6ef74debb7">  411</a></span>&#160;<a class="code" href="structllvm_1_1TargetLowering_1_1DAGCombinerInfo.html#a00151b714ce26a44b0c8288bf93696cf">CombineTo</a>(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N, <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Res0, <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Res1, <span class="keywordtype">bool</span> AddTo) {</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;  <span class="keywordflow">return</span> ((DAGCombiner*)<a class="code" href="namespacellvm_1_1X86II.html#a97dc14052814702ba0e2b14fb14dd02da41e3661a4c59a694dcd9b978acdde1a9">DC</a>)-&gt;CombineTo(N, Res0, Res1, AddTo);</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;}</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;<span class="keywordtype">void</span> <a class="code" href="structllvm_1_1TargetLowering_1_1DAGCombinerInfo.html#aeecdb6a29a24d717a83fc1c948e00d98">TargetLowering::DAGCombinerInfo::</a></div><div class="line"><a name="l00416"></a><span class="lineno"><a class="line" href="structllvm_1_1TargetLowering_1_1DAGCombinerInfo.html#aeecdb6a29a24d717a83fc1c948e00d98">  416</a></span>&#160;<a class="code" href="structllvm_1_1TargetLowering_1_1DAGCombinerInfo.html#aeecdb6a29a24d717a83fc1c948e00d98">CommitTargetLoweringOpt</a>(<span class="keyword">const</span> <a class="code" href="structllvm_1_1TargetLowering_1_1TargetLoweringOpt.html">TargetLowering::TargetLoweringOpt</a> &amp;TLO) {</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;  <span class="keywordflow">return</span> ((DAGCombiner*)<a class="code" href="namespacellvm_1_1X86II.html#a97dc14052814702ba0e2b14fb14dd02da41e3661a4c59a694dcd9b978acdde1a9">DC</a>)-&gt;CommitTargetLoweringOpt(TLO);</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;}</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;<span class="comment">// Helper Functions</span></div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="comment">/// isNegatibleForFree - Return 1 if we can compute the negated form of the</span></div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="comment">/// specified expression for the same cost as the expression itself, or 2 if we</span></div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="comment">/// can compute the negated form more cheaply than the expression itself.</span></div><div class="line"><a name="l00427"></a><span class="lineno"><a class="line" href="DAGCombiner_8cpp.html#aec1e6891acbf695c615301db72893862">  427</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">char</span> <a class="code" href="DAGCombiner_8cpp.html#aec1e6891acbf695c615301db72893862">isNegatibleForFree</a>(<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Op, <span class="keywordtype">bool</span> LegalOperations,</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;                               <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetLowering.html">TargetLowering</a> &amp;TLI,</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;                               <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetOptions.html">TargetOptions</a> *Options,</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;                               <span class="keywordtype">unsigned</span> Depth = 0) {</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;  <span class="comment">// fneg is removable even if it has multiple uses.</span></div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;  <span class="keywordflow">if</span> (Op.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a6d26c45c040d8f85d577a5f645261d1a">ISD::FNEG</a>) <span class="keywordflow">return</span> 2;</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;  <span class="comment">// Don&#39;t allow anything with multiple uses.</span></div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;  <span class="keywordflow">if</span> (!Op.<a class="code" href="classllvm_1_1SDValue.html#a97b0f24f3e52f030830fca6fbfcbd37d">hasOneUse</a>()) <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;  <span class="comment">// Don&#39;t recurse exponentially.</span></div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;  <span class="keywordflow">if</span> (Depth &gt; 6) <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;  <span class="keywordflow">switch</span> (Op.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>()) {</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;  <span class="keywordflow">default</span>: <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a1be4c8da7c68a4c683de1a98b5cc5b9d">ISD::ConstantFP</a>:</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    <span class="comment">// Don&#39;t invert constant FP values after legalize.  The negated constant</span></div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    <span class="comment">// isn&#39;t necessarily legal.</span></div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    <span class="keywordflow">return</span> LegalOperations ? 0 : 1;</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a32ec12017722f5b42a295fe5eb0b0bdf">ISD::FADD</a>:</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    <span class="comment">// FIXME: determine better conditions for this xform.</span></div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    <span class="keywordflow">if</span> (!Options-&gt;<a class="code" href="classllvm_1_1TargetOptions.html#a0544e2966374684ff74255e5a4290fa7">UnsafeFPMath</a>) <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    <span class="comment">// After operation legalization, it might not be legal to create new FSUBs.</span></div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    <span class="keywordflow">if</span> (LegalOperations &amp;&amp;</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;        !TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a087dd0f9650e999b087c17cc7f46f2d0">isOperationLegalOrCustom</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a2852a5b6baa80b1589a46737210a8cad">ISD::FSUB</a>,  Op.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>()))</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    <span class="comment">// fold (fneg (fadd A, B)) -&gt; (fsub (fneg A), B)</span></div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    <span class="keywordflow">if</span> (<span class="keywordtype">char</span> V = <a class="code" href="DAGCombiner_8cpp.html#aec1e6891acbf695c615301db72893862">isNegatibleForFree</a>(Op.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0), LegalOperations, TLI,</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;                                    Options, Depth + 1))</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;      <span class="keywordflow">return</span> V;</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    <span class="comment">// fold (fneg (fadd A, B)) -&gt; (fsub (fneg B), A)</span></div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="DAGCombiner_8cpp.html#aec1e6891acbf695c615301db72893862">isNegatibleForFree</a>(Op.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1), LegalOperations, TLI, Options,</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;                              Depth + 1);</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a2852a5b6baa80b1589a46737210a8cad">ISD::FSUB</a>:</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    <span class="comment">// We can&#39;t turn -(A-B) into B-A when we honor signed zeros.</span></div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    <span class="keywordflow">if</span> (!Options-&gt;UnsafeFPMath) <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    <span class="comment">// fold (fneg (fsub A, B)) -&gt; (fsub B, A)</span></div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9ab5860c97a00c4627a08cab7b0c8178">ISD::FMUL</a>:</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110abc6c09c7af98236460f0b020eb3be94e">ISD::FDIV</a>:</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    <span class="keywordflow">if</span> (Options-&gt;HonorSignDependentRoundingFPMath()) <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    <span class="comment">// fold (fneg (fmul X, Y)) -&gt; (fmul (fneg X), Y) or (fmul X, (fneg Y))</span></div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    <span class="keywordflow">if</span> (<span class="keywordtype">char</span> V = <a class="code" href="DAGCombiner_8cpp.html#aec1e6891acbf695c615301db72893862">isNegatibleForFree</a>(Op.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0), LegalOperations, TLI,</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;                                    Options, Depth + 1))</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;      <span class="keywordflow">return</span> V;</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="DAGCombiner_8cpp.html#aec1e6891acbf695c615301db72893862">isNegatibleForFree</a>(Op.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1), LegalOperations, TLI, Options,</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;                              Depth + 1);</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110aadfdefcb133a7f0262a05934aba8ce5d">ISD::FP_EXTEND</a>:</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110adaf9a3cb5c2ef5eb713bd6bf4ae23aeb">ISD::FP_ROUND</a>:</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ad46ae9fdfe20cd04f7fda7ccbb937543">ISD::FSIN</a>:</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="DAGCombiner_8cpp.html#aec1e6891acbf695c615301db72893862">isNegatibleForFree</a>(Op.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0), LegalOperations, TLI, Options,</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;                              Depth + 1);</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;  }</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;}</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;<span class="comment">/// GetNegatedExpression - If isNegatibleForFree returns true, this function</span></div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;<span class="comment">/// returns the newly negated expression.</span></div><div class="line"><a name="l00491"></a><span class="lineno"><a class="line" href="DAGCombiner_8cpp.html#a55d3de0deed33d70188b2b5a9cab8f00">  491</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> <a class="code" href="DAGCombiner_8cpp.html#a55d3de0deed33d70188b2b5a9cab8f00">GetNegatedExpression</a>(<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Op, <a class="code" href="classllvm_1_1SelectionDAG.html">SelectionDAG</a> &amp;DAG,</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;                                    <span class="keywordtype">bool</span> LegalOperations, <span class="keywordtype">unsigned</span> Depth = 0) {</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;  <span class="comment">// fneg is removable even if it has multiple uses.</span></div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;  <span class="keywordflow">if</span> (Op.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a6d26c45c040d8f85d577a5f645261d1a">ISD::FNEG</a>) <span class="keywordflow">return</span> Op.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0);</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;  <span class="comment">// Don&#39;t allow anything with multiple uses.</span></div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;  assert(Op.<a class="code" href="classllvm_1_1SDValue.html#a97b0f24f3e52f030830fca6fbfcbd37d">hasOneUse</a>() &amp;&amp; <span class="stringliteral">&quot;Unknown reuse!&quot;</span>);</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;  assert(Depth &lt;= 6 &amp;&amp; <span class="stringliteral">&quot;GetNegatedExpression doesn&#39;t match isNegatibleForFree&quot;</span>);</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;  <span class="keywordflow">switch</span> (Op.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>()) {</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;  <span class="keywordflow">default</span>: <a class="code" href="ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a>(<span class="stringliteral">&quot;Unknown code&quot;</span>);</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a1be4c8da7c68a4c683de1a98b5cc5b9d">ISD::ConstantFP</a>: {</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    <a class="code" href="classllvm_1_1APFloat.html">APFloat</a> V = cast&lt;ConstantFPSDNode&gt;(Op)-&gt;getValueAPF();</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    V.<a class="code" href="classllvm_1_1APFloat.html#ab5131b6b960e5e4687016d5b6f64069b">changeSign</a>();</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a268e5bc7dd40a28712a33ca6c9c91c6f">getConstantFP</a>(V, Op.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>());</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;  }</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a32ec12017722f5b42a295fe5eb0b0bdf">ISD::FADD</a>:</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    <span class="comment">// FIXME: determine better conditions for this xform.</span></div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    assert(DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a6b60694d1d9d7f634e7638856898e20d">getTarget</a>().<a class="code" href="classllvm_1_1TargetMachine.html#ab1fb67187fc37e569cc5171cbebba873">Options</a>.<a class="code" href="classllvm_1_1TargetOptions.html#a0544e2966374684ff74255e5a4290fa7">UnsafeFPMath</a>);</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    <span class="comment">// fold (fneg (fadd A, B)) -&gt; (fsub (fneg A), B)</span></div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="DAGCombiner_8cpp.html#aec1e6891acbf695c615301db72893862">isNegatibleForFree</a>(Op.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0), LegalOperations,</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;                           DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a848b46af8fabd1ab34b28adbc3665609">getTargetLoweringInfo</a>(),</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;                           &amp;DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a6b60694d1d9d7f634e7638856898e20d">getTarget</a>().<a class="code" href="classllvm_1_1TargetMachine.html#ab1fb67187fc37e569cc5171cbebba873">Options</a>, Depth+1))</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a2852a5b6baa80b1589a46737210a8cad">ISD::FSUB</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(Op), Op.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>(),</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;                         <a class="code" href="DAGCombiner_8cpp.html#a55d3de0deed33d70188b2b5a9cab8f00">GetNegatedExpression</a>(Op.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0), DAG,</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;                                              LegalOperations, Depth+1),</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;                         Op.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1));</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    <span class="comment">// fold (fneg (fadd A, B)) -&gt; (fsub (fneg B), A)</span></div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a2852a5b6baa80b1589a46737210a8cad">ISD::FSUB</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(Op), Op.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>(),</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;                       <a class="code" href="DAGCombiner_8cpp.html#a55d3de0deed33d70188b2b5a9cab8f00">GetNegatedExpression</a>(Op.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1), DAG,</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;                                            LegalOperations, Depth+1),</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;                       Op.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0));</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a2852a5b6baa80b1589a46737210a8cad">ISD::FSUB</a>:</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    <span class="comment">// We can&#39;t turn -(A-B) into B-A when we honor signed zeros.</span></div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    assert(DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a6b60694d1d9d7f634e7638856898e20d">getTarget</a>().<a class="code" href="classllvm_1_1TargetMachine.html#ab1fb67187fc37e569cc5171cbebba873">Options</a>.<a class="code" href="classllvm_1_1TargetOptions.html#a0544e2966374684ff74255e5a4290fa7">UnsafeFPMath</a>);</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    <span class="comment">// fold (fneg (fsub 0, B)) -&gt; B</span></div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1ConstantFPSDNode.html">ConstantFPSDNode</a> *N0CFP = dyn_cast&lt;ConstantFPSDNode&gt;(Op.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0)))</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;      <span class="keywordflow">if</span> (N0CFP-&gt;getValueAPF().isZero())</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;        <span class="keywordflow">return</span> Op.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1);</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    <span class="comment">// fold (fneg (fsub A, B)) -&gt; (fsub B, A)</span></div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a2852a5b6baa80b1589a46737210a8cad">ISD::FSUB</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(Op), Op.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>(),</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;                       Op.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1), Op.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0));</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9ab5860c97a00c4627a08cab7b0c8178">ISD::FMUL</a>:</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110abc6c09c7af98236460f0b020eb3be94e">ISD::FDIV</a>:</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    assert(!DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a6b60694d1d9d7f634e7638856898e20d">getTarget</a>().<a class="code" href="classllvm_1_1TargetMachine.html#ab1fb67187fc37e569cc5171cbebba873">Options</a>.<a class="code" href="classllvm_1_1TargetOptions.html#ac63543526e222ba0596e421e21189a86">HonorSignDependentRoundingFPMath</a>());</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    <span class="comment">// fold (fneg (fmul X, Y)) -&gt; (fmul (fneg X), Y)</span></div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="DAGCombiner_8cpp.html#aec1e6891acbf695c615301db72893862">isNegatibleForFree</a>(Op.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0), LegalOperations,</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;                           DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a848b46af8fabd1ab34b28adbc3665609">getTargetLoweringInfo</a>(),</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;                           &amp;DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a6b60694d1d9d7f634e7638856898e20d">getTarget</a>().<a class="code" href="classllvm_1_1TargetMachine.html#ab1fb67187fc37e569cc5171cbebba873">Options</a>, Depth+1))</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(Op.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>(), <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(Op), Op.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>(),</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;                         <a class="code" href="DAGCombiner_8cpp.html#a55d3de0deed33d70188b2b5a9cab8f00">GetNegatedExpression</a>(Op.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0), DAG,</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;                                              LegalOperations, Depth+1),</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;                         Op.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1));</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    <span class="comment">// fold (fneg (fmul X, Y)) -&gt; (fmul X, (fneg Y))</span></div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(Op.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>(), <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(Op), Op.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>(),</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;                       Op.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0),</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;                       <a class="code" href="DAGCombiner_8cpp.html#a55d3de0deed33d70188b2b5a9cab8f00">GetNegatedExpression</a>(Op.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1), DAG,</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;                                            LegalOperations, Depth+1));</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110aadfdefcb133a7f0262a05934aba8ce5d">ISD::FP_EXTEND</a>:</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ad46ae9fdfe20cd04f7fda7ccbb937543">ISD::FSIN</a>:</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(Op.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>(), <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(Op), Op.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>(),</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;                       <a class="code" href="DAGCombiner_8cpp.html#a55d3de0deed33d70188b2b5a9cab8f00">GetNegatedExpression</a>(Op.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0), DAG,</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;                                            LegalOperations, Depth+1));</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110adaf9a3cb5c2ef5eb713bd6bf4ae23aeb">ISD::FP_ROUND</a>:</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110adaf9a3cb5c2ef5eb713bd6bf4ae23aeb">ISD::FP_ROUND</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(Op), Op.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>(),</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;                         <a class="code" href="DAGCombiner_8cpp.html#a55d3de0deed33d70188b2b5a9cab8f00">GetNegatedExpression</a>(Op.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0), DAG,</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;                                              LegalOperations, Depth+1),</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;                         Op.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1));</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;  }</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;}</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;<span class="comment">// isSetCCEquivalent - Return true if this node is a setcc, or is a select_cc</span></div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<span class="comment">// that selects between the values 1 and 0, making it equivalent to a setcc.</span></div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;<span class="comment">// Also, set the incoming LHS, RHS, and CC references to the appropriate</span></div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;<span class="comment">// nodes based on the type of node we are checking.  This simplifies life a</span></div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;<span class="comment">// bit for the callers.</span></div><div class="line"><a name="l00575"></a><span class="lineno"><a class="line" href="DAGCombiner_8cpp.html#aad9b27fb736faf90f342b3fcabf413fb">  575</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="DAGCombiner_8cpp.html#aad9b27fb736faf90f342b3fcabf413fb">isSetCCEquivalent</a>(<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N, <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> &amp;LHS, <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> &amp;RHS,</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;                              <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> &amp;<a class="code" href="Target_2PowerPC_2README_8txt.html#afc7ca55ad1da67847ecd4b99ef64dc84">CC</a>) {</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;  <span class="keywordflow">if</span> (N.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a0158ee47dfa868be5d28e2cbef70d5d0">ISD::SETCC</a>) {</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    LHS = N.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0);</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    RHS = N.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1);</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    CC  = N.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(2);</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;  }</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;  <span class="keywordflow">if</span> (N.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a99ad6b342b7457df56b91d24e66016b3">ISD::SELECT_CC</a> &amp;&amp;</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;      N.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(2).<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110aac2f0a84dd2aa5ee4c3f1385e9565f5e">ISD::Constant</a> &amp;&amp;</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;      N.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(3).<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110aac2f0a84dd2aa5ee4c3f1385e9565f5e">ISD::Constant</a> &amp;&amp;</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;      cast&lt;ConstantSDNode&gt;(N.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(2))-&gt;getAPIntValue() == 1 &amp;&amp;</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;      cast&lt;ConstantSDNode&gt;(N.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(3))-&gt;isNullValue()) {</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    LHS = N.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0);</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    RHS = N.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1);</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    CC  = N.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(4);</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;  }</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;}</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;<span class="comment">// isOneUseSetCC - Return true if this is a SetCC-equivalent operation with only</span></div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;<span class="comment">// one use.  If this is true, it allows the users to invert the operation for</span></div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;<span class="comment">// free when it is profitable to do so.</span></div><div class="line"><a name="l00599"></a><span class="lineno"><a class="line" href="DAGCombiner_8cpp.html#af44b8fb65d2366f4cacc6845f751c5ba">  599</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="DAGCombiner_8cpp.html#af44b8fb65d2366f4cacc6845f751c5ba">isOneUseSetCC</a>(<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N) {</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N0, N1, N2;</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="DAGCombiner_8cpp.html#aad9b27fb736faf90f342b3fcabf413fb">isSetCCEquivalent</a>(N, N0, N1, N2) &amp;&amp; N.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()-&gt;<a class="code" href="classllvm_1_1SDNode.html#a52753947fce3a01b1c18dd4713c587e8">hasOneUse</a>())</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;}</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::ReassociateOps(<span class="keywordtype">unsigned</span> Opc, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a> DL,</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;                                    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N0, <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N1) {</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> VT = N0.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>();</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;  <span class="keywordflow">if</span> (N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == Opc &amp;&amp; isa&lt;ConstantSDNode&gt;(N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1))) {</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    <span class="keywordflow">if</span> (isa&lt;ConstantSDNode&gt;(N1)) {</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;      <span class="comment">// reassoc. (op (op x, c1), c2) -&gt; (op x, (op c1, c2))</span></div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> OpNode =</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;        DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a8503b91b7bbfb128a42fa582857f8828">FoldConstantArithmetic</a>(Opc, VT,</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;                                   cast&lt;ConstantSDNode&gt;(N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1)),</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;                                   cast&lt;ConstantSDNode&gt;(N1));</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(Opc, DL, VT, N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0), OpNode);</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    }</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    <span class="keywordflow">if</span> (N0.<a class="code" href="classllvm_1_1SDValue.html#a97b0f24f3e52f030830fca6fbfcbd37d">hasOneUse</a>()) {</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;      <span class="comment">// reassoc. (op (op x, c1), y) -&gt; (op (op x, y), c1) iff x+c1 has one use</span></div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> OpNode = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(Opc, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N0), VT,</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;                                   N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0), N1);</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;      AddToWorkList(OpNode.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(Opc, DL, VT, OpNode, N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1));</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    }</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;  }</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;  <span class="keywordflow">if</span> (N1.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == Opc &amp;&amp; isa&lt;ConstantSDNode&gt;(N1.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1))) {</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    <span class="keywordflow">if</span> (isa&lt;ConstantSDNode&gt;(N0)) {</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;      <span class="comment">// reassoc. (op c2, (op x, c1)) -&gt; (op x, (op c1, c2))</span></div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> OpNode =</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;        DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a8503b91b7bbfb128a42fa582857f8828">FoldConstantArithmetic</a>(Opc, VT,</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;                                   cast&lt;ConstantSDNode&gt;(N1.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1)),</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;                                   cast&lt;ConstantSDNode&gt;(N0));</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(Opc, DL, VT, N1.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0), OpNode);</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;    }</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    <span class="keywordflow">if</span> (N1.<a class="code" href="classllvm_1_1SDValue.html#a97b0f24f3e52f030830fca6fbfcbd37d">hasOneUse</a>()) {</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;      <span class="comment">// reassoc. (op y, (op x, c1)) -&gt; (op (op x, y), c1) iff x+c1 has one use</span></div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> OpNode = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(Opc, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N0), VT,</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;                                   N1.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0), N0);</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;      AddToWorkList(OpNode.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(Opc, DL, VT, OpNode, N1.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1));</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;    }</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;  }</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;}</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::CombineTo(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N, <span class="keyword">const</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> *To, <span class="keywordtype">unsigned</span> NumTo,</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;                               <span class="keywordtype">bool</span> AddTo) {</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;  assert(N-&gt;<a class="code" href="classllvm_1_1SDNode.html#ab319fc51db27ec95fd50a910c7ccec94">getNumValues</a>() == NumTo &amp;&amp; <span class="stringliteral">&quot;Broken CombineTo call!&quot;</span>);</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;  ++NodesCombined;</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;  <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;\nReplacing.1 &quot;</span>;</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;        N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a535ca517df1b4ae62e75475141e65787">dump</a>(&amp;DAG);</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;        <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;\nWith: &quot;</span>;</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;        To[0].<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()-&gt;<a class="code" href="classllvm_1_1SDNode.html#a535ca517df1b4ae62e75475141e65787">dump</a>(&amp;DAG);</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;        <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot; and &quot;</span> &lt;&lt; NumTo-1 &lt;&lt; <span class="stringliteral">&quot; other values\n&quot;</span>;</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0, e = NumTo; <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != e; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;          assert((!To[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>].getNode() ||</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;                  N-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) == To[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>].<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>()) &amp;&amp;</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;                 <span class="stringliteral">&quot;Cannot combine value to value of different type!&quot;</span>));</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;  WorkListRemover DeadNodes(*<span class="keyword">this</span>);</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;  DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a307e5150c6c85f43348d2b09a69d7591">ReplaceAllUsesWith</a>(N, To);</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;  <span class="keywordflow">if</span> (AddTo) {</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    <span class="comment">// Push the new nodes and any users onto the worklist</span></div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0, e = NumTo; <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != e; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;      <span class="keywordflow">if</span> (To[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>].getNode()) {</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;        AddToWorkList(To[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>].getNode());</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;        AddUsersToWorkList(To[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>].getNode());</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;      }</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;    }</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;  }</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;  <span class="comment">// Finally, if the node is now dead, remove it from the graph.  The node</span></div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;  <span class="comment">// may not be dead if the replacement process recursively simplified to</span></div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;  <span class="comment">// something else needing this node.</span></div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;  <span class="keywordflow">if</span> (N-&gt;<a class="code" href="classllvm_1_1SDNode.html#afc071edeb7e2007d000374eba843f76a">use_empty</a>()) {</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    <span class="comment">// Nodes can be reintroduced into the worklist.  Make sure we do not</span></div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    <span class="comment">// process a node that has been replaced.</span></div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;    removeFromWorkList(N);</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;    <span class="comment">// Finally, since the node is now dead, remove it from the graph.</span></div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;    DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a5f57dcbedc16dced31c61f7bbbb06ded">DeleteNode</a>(N);</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;  }</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(N, 0);</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;}</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;<span class="keywordtype">void</span> DAGCombiner::</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;CommitTargetLoweringOpt(<span class="keyword">const</span> <a class="code" href="structllvm_1_1TargetLowering_1_1TargetLoweringOpt.html">TargetLowering::TargetLoweringOpt</a> &amp;TLO) {</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;  <span class="comment">// Replace all uses.  If any nodes become isomorphic to other nodes and</span></div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;  <span class="comment">// are deleted, make sure to remove them from our worklist.</span></div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;  WorkListRemover DeadNodes(*<span class="keyword">this</span>);</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;  DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#ac630ccda26fea2f45afa3fb89bc1a8f4">ReplaceAllUsesOfValueWith</a>(TLO.<a class="code" href="structllvm_1_1TargetLowering_1_1TargetLoweringOpt.html#af62539995977e2e2b411bbb87378e894">Old</a>, TLO.<a class="code" href="structllvm_1_1TargetLowering_1_1TargetLoweringOpt.html#aa59ebff339822e9d6912a36acbeff118">New</a>);</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;  <span class="comment">// Push the new node and any (possibly new) users onto the worklist.</span></div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;  AddToWorkList(TLO.<a class="code" href="structllvm_1_1TargetLowering_1_1TargetLoweringOpt.html#aa59ebff339822e9d6912a36acbeff118">New</a>.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;  AddUsersToWorkList(TLO.<a class="code" href="structllvm_1_1TargetLowering_1_1TargetLoweringOpt.html#aa59ebff339822e9d6912a36acbeff118">New</a>.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;  <span class="comment">// Finally, if the node is now dead, remove it from the graph.  The node</span></div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;  <span class="comment">// may not be dead if the replacement process recursively simplified to</span></div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;  <span class="comment">// something else needing this node.</span></div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;  <span class="keywordflow">if</span> (TLO.<a class="code" href="structllvm_1_1TargetLowering_1_1TargetLoweringOpt.html#af62539995977e2e2b411bbb87378e894">Old</a>.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()-&gt;<a class="code" href="classllvm_1_1SDNode.html#afc071edeb7e2007d000374eba843f76a">use_empty</a>()) {</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;    removeFromWorkList(TLO.<a class="code" href="structllvm_1_1TargetLowering_1_1TargetLoweringOpt.html#af62539995977e2e2b411bbb87378e894">Old</a>.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;    <span class="comment">// If the operands of this node are only used by the node, they will now</span></div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;    <span class="comment">// be dead.  Make sure to visit them first to delete dead nodes early.</span></div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0, e = TLO.<a class="code" href="structllvm_1_1TargetLowering_1_1TargetLoweringOpt.html#af62539995977e2e2b411bbb87378e894">Old</a>.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()-&gt;<a class="code" href="classllvm_1_1SDNode.html#abc5c2f1d47a517373030133c6a102106">getNumOperands</a>(); <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != e; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;      <span class="keywordflow">if</span> (TLO.<a class="code" href="structllvm_1_1TargetLowering_1_1TargetLoweringOpt.html#af62539995977e2e2b411bbb87378e894">Old</a>.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>).<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()-&gt;<a class="code" href="classllvm_1_1SDNode.html#a52753947fce3a01b1c18dd4713c587e8">hasOneUse</a>())</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;        AddToWorkList(TLO.<a class="code" href="structllvm_1_1TargetLowering_1_1TargetLoweringOpt.html#af62539995977e2e2b411bbb87378e894">Old</a>.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>).<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;    DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a5f57dcbedc16dced31c61f7bbbb06ded">DeleteNode</a>(TLO.<a class="code" href="structllvm_1_1TargetLowering_1_1TargetLoweringOpt.html#af62539995977e2e2b411bbb87378e894">Old</a>.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;  }</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;}</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;<span class="comment">/// SimplifyDemandedBits - Check the specified integer node value to see if</span></div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;<span class="comment">/// it can be simplified or if things it uses can be simplified by bit</span></div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;<span class="comment">/// propagation.  If so, return true.</span></div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;<span class="comment"></span><span class="keywordtype">bool</span> DAGCombiner::SimplifyDemandedBits(<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Op, <span class="keyword">const</span> <a class="code" href="classllvm_1_1APInt.html">APInt</a> &amp;Demanded) {</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;  <a class="code" href="structllvm_1_1TargetLowering_1_1TargetLoweringOpt.html">TargetLowering::TargetLoweringOpt</a> TLO(DAG, LegalTypes, LegalOperations);</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;  <a class="code" href="classllvm_1_1APInt.html">APInt</a> KnownZero, KnownOne;</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;  <span class="keywordflow">if</span> (!TLI.<a class="code" href="classllvm_1_1TargetLowering.html#acfbda80cc07884ccb7b267aaea403141">SimplifyDemandedBits</a>(Op, Demanded, KnownZero, KnownOne, TLO))</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;  <span class="comment">// Revisit the node.</span></div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;  AddToWorkList(Op.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;  <span class="comment">// Replace the old value with the new one.</span></div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;  ++NodesCombined;</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;  <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;\nReplacing.2 &quot;</span>;</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;        TLO.<a class="code" href="structllvm_1_1TargetLowering_1_1TargetLoweringOpt.html#af62539995977e2e2b411bbb87378e894">Old</a>.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()-&gt;<a class="code" href="classllvm_1_1SDNode.html#a535ca517df1b4ae62e75475141e65787">dump</a>(&amp;DAG);</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;        <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;\nWith: &quot;</span>;</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;        TLO.<a class="code" href="structllvm_1_1TargetLowering_1_1TargetLoweringOpt.html#aa59ebff339822e9d6912a36acbeff118">New</a>.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()-&gt;<a class="code" href="classllvm_1_1SDNode.html#a535ca517df1b4ae62e75475141e65787">dump</a>(&amp;DAG);</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;        <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>);</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;  CommitTargetLoweringOpt(TLO);</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;}</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;<span class="keywordtype">void</span> DAGCombiner::ReplaceLoadWithPromotedLoad(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *<a class="code" href="namespacellvm_1_1SPII.html#a11e9b8fca4a074643a6a21f444e51406a5069619ca8fdce305534f3fe85091a0f">Load</a>, <a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *ExtLoad) {</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;  <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a> dl(Load);</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> VT = Load-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(0);</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Trunc = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ae690127648393001a7d5b93dc23da7b3">ISD::TRUNCATE</a>, dl, VT, <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(ExtLoad, 0));</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;  <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;\nReplacing.9 &quot;</span>;</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;        Load-&gt;<a class="code" href="classllvm_1_1SDNode.html#a535ca517df1b4ae62e75475141e65787">dump</a>(&amp;DAG);</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;        <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;\nWith: &quot;</span>;</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;        Trunc.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()-&gt;<a class="code" href="classllvm_1_1SDNode.html#a535ca517df1b4ae62e75475141e65787">dump</a>(&amp;DAG);</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;        <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>);</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;  WorkListRemover DeadNodes(*<span class="keyword">this</span>);</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;  DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#ac630ccda26fea2f45afa3fb89bc1a8f4">ReplaceAllUsesOfValueWith</a>(<a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(Load, 0), Trunc);</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;  DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#ac630ccda26fea2f45afa3fb89bc1a8f4">ReplaceAllUsesOfValueWith</a>(<a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(Load, 1), <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(ExtLoad, 1));</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;  removeFromWorkList(Load);</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;  DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a5f57dcbedc16dced31c61f7bbbb06ded">DeleteNode</a>(Load);</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;  AddToWorkList(Trunc.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;}</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::PromoteOperand(<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Op, <a class="code" href="structllvm_1_1EVT.html">EVT</a> PVT, <span class="keywordtype">bool</span> &amp;Replace) {</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;  Replace = <span class="keyword">false</span>;</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;  <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a> dl(Op);</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1LoadSDNode.html">LoadSDNode</a> *<a class="code" href="namespacellvm_1_1A64DB.html#a6fce8157775f3ec93f326b52b0f1e0f5ad61b145eb8cbab18feb1b2e2ce269a7e">LD</a> = dyn_cast&lt;LoadSDNode&gt;(Op)) {</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;    <a class="code" href="structllvm_1_1EVT.html">EVT</a> MemVT = <a class="code" href="namespacellvm_1_1A64DB.html#a6fce8157775f3ec93f326b52b0f1e0f5ad61b145eb8cbab18feb1b2e2ce269a7e">LD</a>-&gt;getMemoryVT();</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;    <a class="code" href="namespacellvm_1_1ISD.html#ad4d48171b87ca51ff54c10a436bac4d7">ISD::LoadExtType</a> ExtType = <a class="code" href="namespacellvm_1_1ISD.html#a15623094a1ed0cd7163dc786e44c87c9">ISD::isNON_EXTLoad</a>(<a class="code" href="namespacellvm_1_1A64DB.html#a6fce8157775f3ec93f326b52b0f1e0f5ad61b145eb8cbab18feb1b2e2ce269a7e">LD</a>)</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;      ? (TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#ad85f712b9e49629c2c160f16521fe91f">isLoadExtLegal</a>(<a class="code" href="namespacellvm_1_1ISD.html#ad4d48171b87ca51ff54c10a436bac4d7a8d89c7da4444d9ec11667aa369abc5f7">ISD::ZEXTLOAD</a>, MemVT) ? <a class="code" href="namespacellvm_1_1ISD.html#ad4d48171b87ca51ff54c10a436bac4d7a8d89c7da4444d9ec11667aa369abc5f7">ISD::ZEXTLOAD</a></div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;                                                  : <a class="code" href="namespacellvm_1_1ISD.html#ad4d48171b87ca51ff54c10a436bac4d7afab3fffd153f7d7770fed81272e4b78f">ISD::EXTLOAD</a>)</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;      : <a class="code" href="namespacellvm_1_1A64DB.html#a6fce8157775f3ec93f326b52b0f1e0f5ad61b145eb8cbab18feb1b2e2ce269a7e">LD</a>-&gt;getExtensionType();</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;    Replace = <span class="keyword">true</span>;</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#ad6ff413bea6f8195d8e6f29f4fc519c4">getExtLoad</a>(ExtType, dl, PVT,</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;                          <a class="code" href="namespacellvm_1_1A64DB.html#a6fce8157775f3ec93f326b52b0f1e0f5ad61b145eb8cbab18feb1b2e2ce269a7e">LD</a>-&gt;getChain(), <a class="code" href="namespacellvm_1_1A64DB.html#a6fce8157775f3ec93f326b52b0f1e0f5ad61b145eb8cbab18feb1b2e2ce269a7e">LD</a>-&gt;getBasePtr(),</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;                          MemVT, <a class="code" href="namespacellvm_1_1A64DB.html#a6fce8157775f3ec93f326b52b0f1e0f5ad61b145eb8cbab18feb1b2e2ce269a7e">LD</a>-&gt;getMemOperand());</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;  }</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;  <span class="keywordtype">unsigned</span> Opc = Op.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>();</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;  <span class="keywordflow">switch</span> (Opc) {</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;  <span class="keywordflow">default</span>: <span class="keywordflow">break</span>;</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110aee4f13218bdbb5c5697f7e786618ecb2">ISD::AssertSext</a>:</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110aee4f13218bdbb5c5697f7e786618ecb2">ISD::AssertSext</a>, dl, PVT,</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;                       SExtPromoteOperand(Op.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0), PVT),</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;                       Op.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1));</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110af23301e60475124fd80a2cb51f6ba863">ISD::AssertZext</a>:</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110af23301e60475124fd80a2cb51f6ba863">ISD::AssertZext</a>, dl, PVT,</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;                       ZExtPromoteOperand(Op.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0), PVT),</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;                       Op.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1));</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110aac2f0a84dd2aa5ee4c3f1385e9565f5e">ISD::Constant</a>: {</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;    <span class="keywordtype">unsigned</span> ExtOpc =</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;      Op.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>().<a class="code" href="structllvm_1_1EVT.html#a0e47d5994d9b6fd12125d13d20867ceb">isByteSized</a>() ? <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a5183f3d72924bc7c77ba8d3f5de9f602">ISD::SIGN_EXTEND</a> : <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a93fdf85eff945f1a668b4915a051453e">ISD::ZERO_EXTEND</a>;</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(ExtOpc, dl, PVT, Op);</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;  }</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;  }</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;  <span class="keywordflow">if</span> (!TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a055b3905dbbc16fae11510b9ebd1e00c">isOperationLegal</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a27d5d8ef82302b739ba3ca8be1a5513d">ISD::ANY_EXTEND</a>, PVT))</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;  <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a27d5d8ef82302b739ba3ca8be1a5513d">ISD::ANY_EXTEND</a>, dl, PVT, Op);</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;}</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::SExtPromoteOperand(<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Op, <a class="code" href="structllvm_1_1EVT.html">EVT</a> PVT) {</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;  <span class="keywordflow">if</span> (!TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a055b3905dbbc16fae11510b9ebd1e00c">isOperationLegal</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110aaa59dd5ec37f21905436b354c0292d9e">ISD::SIGN_EXTEND_INREG</a>, PVT))</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> OldVT = Op.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>();</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;  <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a> dl(Op);</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;  <span class="keywordtype">bool</span> Replace = <span class="keyword">false</span>;</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> NewOp = PromoteOperand(Op, PVT, Replace);</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;  <span class="keywordflow">if</span> (NewOp.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>() == 0)</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;  AddToWorkList(NewOp.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;  <span class="keywordflow">if</span> (Replace)</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;    ReplaceLoadWithPromotedLoad(Op.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>(), NewOp.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;  <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110aaa59dd5ec37f21905436b354c0292d9e">ISD::SIGN_EXTEND_INREG</a>, dl, NewOp.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>(), NewOp,</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;                     DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#ab8ba6b05ad4fa7517f2e23b26f84ae1b">getValueType</a>(OldVT));</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;}</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::ZExtPromoteOperand(<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Op, <a class="code" href="structllvm_1_1EVT.html">EVT</a> PVT) {</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> OldVT = Op.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>();</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;  <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a> dl(Op);</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;  <span class="keywordtype">bool</span> Replace = <span class="keyword">false</span>;</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> NewOp = PromoteOperand(Op, PVT, Replace);</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;  <span class="keywordflow">if</span> (NewOp.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>() == 0)</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;  AddToWorkList(NewOp.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;  <span class="keywordflow">if</span> (Replace)</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;    ReplaceLoadWithPromotedLoad(Op.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>(), NewOp.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;  <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#ad03d69f873a948a3de21ba504364d352">getZeroExtendInReg</a>(NewOp, dl, OldVT);</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;}</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;<span class="comment">/// PromoteIntBinOp - Promote the specified integer binary operation if the</span></div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;<span class="comment">/// target indicates it is beneficial. e.g. On x86, it&#39;s usually better to</span></div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;<span class="comment">/// promote i16 operations to i32 since i16 instructions are longer.</span></div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;<span class="comment"></span><a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::PromoteIntBinOp(<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Op) {</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;  <span class="keywordflow">if</span> (!LegalOperations)</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> VT = Op.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>();</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;  <span class="keywordflow">if</span> (VT.<a class="code" href="structllvm_1_1EVT.html#a73f7c824cad61a47c21bf6d652ae2fd7">isVector</a>() || !VT.<a class="code" href="structllvm_1_1EVT.html#a8cc407ac00df4edd4ec4d5168d6ecb26">isInteger</a>())</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;  <span class="comment">// If operation type is &#39;undesirable&#39;, e.g. i16 on x86, consider</span></div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;  <span class="comment">// promoting it.</span></div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;  <span class="keywordtype">unsigned</span> Opc = Op.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>();</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;  <span class="keywordflow">if</span> (TLI.<a class="code" href="classllvm_1_1TargetLowering.html#ab945eaf78cbe0a5e7cd0dbc3a6b92ae4">isTypeDesirableForOp</a>(Opc, VT))</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> PVT = VT;</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;  <span class="comment">// Consult target whether it is a good idea to promote this operation and</span></div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;  <span class="comment">// what&#39;s the right type to promote it to.</span></div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;  <span class="keywordflow">if</span> (TLI.<a class="code" href="classllvm_1_1TargetLowering.html#ae66d05287096fa4d278d0c5b763fd639">IsDesirableToPromoteOp</a>(Op, PVT)) {</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;    assert(PVT != VT &amp;&amp; <span class="stringliteral">&quot;Don&#39;t know what type to promote to!&quot;</span>);</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;    <span class="keywordtype">bool</span> Replace0 = <span class="keyword">false</span>;</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N0 = Op.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0);</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> NN0 = PromoteOperand(N0, PVT, Replace0);</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;    <span class="keywordflow">if</span> (NN0.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>() == 0)</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;    <span class="keywordtype">bool</span> Replace1 = <span class="keyword">false</span>;</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N1 = Op.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1);</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> NN1;</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;    <span class="keywordflow">if</span> (N0 == N1)</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;      NN1 = NN0;</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;    <span class="keywordflow">else</span> {</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;      NN1 = PromoteOperand(N1, PVT, Replace1);</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;      <span class="keywordflow">if</span> (NN1.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>() == 0)</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;    }</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;    AddToWorkList(NN0.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;    <span class="keywordflow">if</span> (NN1.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>())</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;      AddToWorkList(NN1.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;    <span class="keywordflow">if</span> (Replace0)</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;      ReplaceLoadWithPromotedLoad(N0.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>(), NN0.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;    <span class="keywordflow">if</span> (Replace1)</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;      ReplaceLoadWithPromotedLoad(N1.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>(), NN1.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;    <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;\nPromoting &quot;</span>;</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;          Op.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()-&gt;<a class="code" href="classllvm_1_1SDNode.html#a535ca517df1b4ae62e75475141e65787">dump</a>(&amp;DAG));</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;    <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a> dl(Op);</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ae690127648393001a7d5b93dc23da7b3">ISD::TRUNCATE</a>, dl, VT,</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;                       DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(Opc, dl, PVT, NN0, NN1));</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;  }</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;}</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;<span class="comment">/// PromoteIntShiftOp - Promote the specified integer shift operation if the</span></div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;<span class="comment">/// target indicates it is beneficial. e.g. On x86, it&#39;s usually better to</span></div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;<span class="comment">/// promote i16 operations to i32 since i16 instructions are longer.</span></div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;<span class="comment"></span><a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::PromoteIntShiftOp(<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Op) {</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;  <span class="keywordflow">if</span> (!LegalOperations)</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> VT = Op.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>();</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;  <span class="keywordflow">if</span> (VT.<a class="code" href="structllvm_1_1EVT.html#a73f7c824cad61a47c21bf6d652ae2fd7">isVector</a>() || !VT.<a class="code" href="structllvm_1_1EVT.html#a8cc407ac00df4edd4ec4d5168d6ecb26">isInteger</a>())</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;  <span class="comment">// If operation type is &#39;undesirable&#39;, e.g. i16 on x86, consider</span></div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;  <span class="comment">// promoting it.</span></div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;  <span class="keywordtype">unsigned</span> Opc = Op.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>();</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;  <span class="keywordflow">if</span> (TLI.<a class="code" href="classllvm_1_1TargetLowering.html#ab945eaf78cbe0a5e7cd0dbc3a6b92ae4">isTypeDesirableForOp</a>(Opc, VT))</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> PVT = VT;</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;  <span class="comment">// Consult target whether it is a good idea to promote this operation and</span></div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;  <span class="comment">// what&#39;s the right type to promote it to.</span></div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;  <span class="keywordflow">if</span> (TLI.<a class="code" href="classllvm_1_1TargetLowering.html#ae66d05287096fa4d278d0c5b763fd639">IsDesirableToPromoteOp</a>(Op, PVT)) {</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;    assert(PVT != VT &amp;&amp; <span class="stringliteral">&quot;Don&#39;t know what type to promote to!&quot;</span>);</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;    <span class="keywordtype">bool</span> Replace = <span class="keyword">false</span>;</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N0 = Op.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0);</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;    <span class="keywordflow">if</span> (Opc == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a4a055321c361a0f6ee77ed764730ffc1">ISD::SRA</a>)</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;      N0 = SExtPromoteOperand(Op.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0), PVT);</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Opc == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a3c6553c8acebe1b57c211ee45e2d8f98">ISD::SRL</a>)</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;      N0 = ZExtPromoteOperand(Op.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0), PVT);</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;      N0 = PromoteOperand(N0, PVT, Replace);</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;    <span class="keywordflow">if</span> (N0.getNode() == 0)</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;    AddToWorkList(N0.getNode());</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;    <span class="keywordflow">if</span> (Replace)</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;      ReplaceLoadWithPromotedLoad(Op.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>(), N0.getNode());</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;    <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;\nPromoting &quot;</span>;</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;          Op.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()-&gt;<a class="code" href="classllvm_1_1SDNode.html#a535ca517df1b4ae62e75475141e65787">dump</a>(&amp;DAG));</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;    <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a> dl(Op);</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ae690127648393001a7d5b93dc23da7b3">ISD::TRUNCATE</a>, dl, VT,</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;                       DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(Opc, dl, PVT, N0, Op.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1)));</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;  }</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;}</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::PromoteExtend(<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Op) {</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;  <span class="keywordflow">if</span> (!LegalOperations)</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> VT = Op.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>();</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;  <span class="keywordflow">if</span> (VT.<a class="code" href="structllvm_1_1EVT.html#a73f7c824cad61a47c21bf6d652ae2fd7">isVector</a>() || !VT.<a class="code" href="structllvm_1_1EVT.html#a8cc407ac00df4edd4ec4d5168d6ecb26">isInteger</a>())</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;  <span class="comment">// If operation type is &#39;undesirable&#39;, e.g. i16 on x86, consider</span></div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;  <span class="comment">// promoting it.</span></div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;  <span class="keywordtype">unsigned</span> Opc = Op.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>();</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;  <span class="keywordflow">if</span> (TLI.<a class="code" href="classllvm_1_1TargetLowering.html#ab945eaf78cbe0a5e7cd0dbc3a6b92ae4">isTypeDesirableForOp</a>(Opc, VT))</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> PVT = VT;</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;  <span class="comment">// Consult target whether it is a good idea to promote this operation and</span></div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;  <span class="comment">// what&#39;s the right type to promote it to.</span></div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;  <span class="keywordflow">if</span> (TLI.<a class="code" href="classllvm_1_1TargetLowering.html#ae66d05287096fa4d278d0c5b763fd639">IsDesirableToPromoteOp</a>(Op, PVT)) {</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;    assert(PVT != VT &amp;&amp; <span class="stringliteral">&quot;Don&#39;t know what type to promote to!&quot;</span>);</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;    <span class="comment">// fold (aext (aext x)) -&gt; (aext x)</span></div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;    <span class="comment">// fold (aext (zext x)) -&gt; (zext x)</span></div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;    <span class="comment">// fold (aext (sext x)) -&gt; (sext x)</span></div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;    <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;\nPromoting &quot;</span>;</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;          Op.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()-&gt;<a class="code" href="classllvm_1_1SDNode.html#a535ca517df1b4ae62e75475141e65787">dump</a>(&amp;DAG));</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(Op.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>(), <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(Op), VT, Op.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0));</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;  }</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;}</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;<span class="keywordtype">bool</span> DAGCombiner::PromoteLoad(<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Op) {</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;  <span class="keywordflow">if</span> (!LegalOperations)</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> VT = Op.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>();</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;  <span class="keywordflow">if</span> (VT.<a class="code" href="structllvm_1_1EVT.html#a73f7c824cad61a47c21bf6d652ae2fd7">isVector</a>() || !VT.<a class="code" href="structllvm_1_1EVT.html#a8cc407ac00df4edd4ec4d5168d6ecb26">isInteger</a>())</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;  <span class="comment">// If operation type is &#39;undesirable&#39;, e.g. i16 on x86, consider</span></div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;  <span class="comment">// promoting it.</span></div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;  <span class="keywordtype">unsigned</span> Opc = Op.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>();</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;  <span class="keywordflow">if</span> (TLI.<a class="code" href="classllvm_1_1TargetLowering.html#ab945eaf78cbe0a5e7cd0dbc3a6b92ae4">isTypeDesirableForOp</a>(Opc, VT))</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> PVT = VT;</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;  <span class="comment">// Consult target whether it is a good idea to promote this operation and</span></div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;  <span class="comment">// what&#39;s the right type to promote it to.</span></div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;  <span class="keywordflow">if</span> (TLI.<a class="code" href="classllvm_1_1TargetLowering.html#ae66d05287096fa4d278d0c5b763fd639">IsDesirableToPromoteOp</a>(Op, PVT)) {</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;    assert(PVT != VT &amp;&amp; <span class="stringliteral">&quot;Don&#39;t know what type to promote to!&quot;</span>);</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;    <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a> dl(Op);</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;    <a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N = Op.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>();</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;    <a class="code" href="classllvm_1_1LoadSDNode.html">LoadSDNode</a> *<a class="code" href="namespacellvm_1_1A64DB.html#a6fce8157775f3ec93f326b52b0f1e0f5ad61b145eb8cbab18feb1b2e2ce269a7e">LD</a> = cast&lt;LoadSDNode&gt;(<a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>);</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;    <a class="code" href="structllvm_1_1EVT.html">EVT</a> MemVT = LD-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a7cead3a2a7771e61083bcc6959915a13">getMemoryVT</a>();</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;    <a class="code" href="namespacellvm_1_1ISD.html#ad4d48171b87ca51ff54c10a436bac4d7">ISD::LoadExtType</a> ExtType = <a class="code" href="namespacellvm_1_1ISD.html#a15623094a1ed0cd7163dc786e44c87c9">ISD::isNON_EXTLoad</a>(LD)</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;      ? (TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#ad85f712b9e49629c2c160f16521fe91f">isLoadExtLegal</a>(<a class="code" href="namespacellvm_1_1ISD.html#ad4d48171b87ca51ff54c10a436bac4d7a8d89c7da4444d9ec11667aa369abc5f7">ISD::ZEXTLOAD</a>, MemVT) ? <a class="code" href="namespacellvm_1_1ISD.html#ad4d48171b87ca51ff54c10a436bac4d7a8d89c7da4444d9ec11667aa369abc5f7">ISD::ZEXTLOAD</a></div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;                                                  : <a class="code" href="namespacellvm_1_1ISD.html#ad4d48171b87ca51ff54c10a436bac4d7afab3fffd153f7d7770fed81272e4b78f">ISD::EXTLOAD</a>)</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;      : LD-&gt;<a class="code" href="classllvm_1_1LoadSDNode.html#af15fb8b2d4c9f295bdcf85a1eb506702">getExtensionType</a>();</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> NewLD = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#ad6ff413bea6f8195d8e6f29f4fc519c4">getExtLoad</a>(ExtType, dl, PVT,</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;                                   LD-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#ae3cb6fbf8c8cb79e10ac61bd98c85211">getChain</a>(), LD-&gt;<a class="code" href="classllvm_1_1LoadSDNode.html#a3ded48ce66b58b7e7e143991df5dbfae">getBasePtr</a>(),</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;                                   MemVT, LD-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a89e2b5e3fb867b4040f893c6ae3d2132">getMemOperand</a>());</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Result = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ae690127648393001a7d5b93dc23da7b3">ISD::TRUNCATE</a>, dl, VT, NewLD);</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;    <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;\nPromoting &quot;</span>;</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;          N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a535ca517df1b4ae62e75475141e65787">dump</a>(&amp;DAG);</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;          <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;\nTo: &quot;</span>;</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;          Result.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()-&gt;<a class="code" href="classllvm_1_1SDNode.html#a535ca517df1b4ae62e75475141e65787">dump</a>(&amp;DAG);</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;          <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>);</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;    WorkListRemover DeadNodes(*<span class="keyword">this</span>);</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;    DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#ac630ccda26fea2f45afa3fb89bc1a8f4">ReplaceAllUsesOfValueWith</a>(<a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(N, 0), Result);</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;    DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#ac630ccda26fea2f45afa3fb89bc1a8f4">ReplaceAllUsesOfValueWith</a>(<a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(N, 1), NewLD.<a class="code" href="classllvm_1_1SDValue.html#a040481b9bda32faa6b1435532405d88f">getValue</a>(1));</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;    removeFromWorkList(N);</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;    DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a5f57dcbedc16dced31c61f7bbbb06ded">DeleteNode</a>(N);</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;    AddToWorkList(Result.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;  }</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;}</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;</div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;<span class="comment">//  Main DAG Combiner implementation</span></div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;<span class="keywordtype">void</span> DAGCombiner::Run(<a class="code" href="namespacellvm.html#aa6d856e4879bb775617f8c3634773b7a">CombineLevel</a> AtLevel) {</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;  <span class="comment">// set the instance variables, so that the various visit routines may use it.</span></div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;  Level = AtLevel;</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;  LegalOperations = Level &gt;= <a class="code" href="namespacellvm.html#aa6d856e4879bb775617f8c3634773b7aa805f5e0d60c9ebc5b134bc9190569a50">AfterLegalizeVectorOps</a>;</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;  LegalTypes = Level &gt;= <a class="code" href="namespacellvm.html#aa6d856e4879bb775617f8c3634773b7aabfb921bbd2fd66e0a6b7524eb4b3dd9f">AfterLegalizeTypes</a>;</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;  <span class="comment">// Add all the dag nodes to the worklist.</span></div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1ilist__iterator.html">SelectionDAG::allnodes_iterator</a> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#ac493b7df1666d70c1b355c82028148f0">allnodes_begin</a>(),</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;       E = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a21c371ac00fe037f24e3f48cb62d2048">allnodes_end</a>(); <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> != E; ++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;    AddToWorkList(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;  <span class="comment">// Create a dummy node (which is not added to allnodes), that adds a reference</span></div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;  <span class="comment">// to the root node, preventing it from being deleted, and tracking any</span></div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;  <span class="comment">// changes of the root.</span></div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;  <a class="code" href="classllvm_1_1HandleSDNode.html">HandleSDNode</a> <a class="code" href="namespacellvm_1_1NVPTXISD.html#a594ac167d52343b1fe4cec37bb7dc31ca7cff9cc4a40fe2b19129ee8e9b0ec645">Dummy</a>(DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a2afe36f1344e00c9ef5f8cdb39d21890">getRoot</a>());</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;  <span class="comment">// The root of the dag may dangle to deleted nodes until the dag combiner is</span></div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;  <span class="comment">// done.  Set it to null to avoid confusion.</span></div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;  DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a3d2e079387a6e69ce2c8bb27bf7c2f32">setRoot</a>(<a class="code" href="classllvm_1_1SDValue.html">SDValue</a>());</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;  <span class="comment">// while the worklist isn&#39;t empty, find a node and</span></div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;  <span class="comment">// try and combine it.</span></div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;  <span class="keywordflow">while</span> (!WorkListContents.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#a095445850ef2c64e96b4c05120cecf66">empty</a>()) {</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;    <a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *<a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>;</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;    <span class="comment">// The WorkListOrder holds the SDNodes in order, but it may contain</span></div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;    <span class="comment">// duplicates.</span></div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;    <span class="comment">// In order to avoid a linear scan, we use a set (O(log N)) to hold what the</span></div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;    <span class="comment">// worklist *should* contain, and check the node we want to visit is should</span></div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;    <span class="comment">// actually be visited.</span></div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;    <span class="keywordflow">do</span> {</div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;      N = WorkListOrder.<a class="code" href="classllvm_1_1SmallVectorImpl.html#a400eaca9881c8dcab97e9f42b1ab1815">pop_back_val</a>();</div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;    } <span class="keywordflow">while</span> (!WorkListContents.<a class="code" href="classllvm_1_1SmallPtrSet.html#a2ce650c1d4a48661b501206d04b6ab04">erase</a>(N));</div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;</div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;    <span class="comment">// If N has no uses, it is dead.  Make sure to revisit all N&#39;s operands once</span></div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;    <span class="comment">// N is deleted from the DAG, since they too may now be dead or may have a</span></div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;    <span class="comment">// reduced number of uses, allowing other xforms.</span></div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;    <span class="keywordflow">if</span> (N-&gt;<a class="code" href="classllvm_1_1SDNode.html#afc071edeb7e2007d000374eba843f76a">use_empty</a>() &amp;&amp; N != &amp;<a class="code" href="namespacellvm_1_1NVPTXISD.html#a594ac167d52343b1fe4cec37bb7dc31ca7cff9cc4a40fe2b19129ee8e9b0ec645">Dummy</a>) {</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0, e = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#abc5c2f1d47a517373030133c6a102106">getNumOperands</a>(); <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != e; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;        AddToWorkList(N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>).<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;      DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a5f57dcbedc16dced31c61f7bbbb06ded">DeleteNode</a>(N);</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;    }</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;</div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> RV = combine(N);</div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;    <span class="keywordflow">if</span> (RV.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>() == 0)</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;</div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;    ++NodesCombined;</div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;</div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;    <span class="comment">// If we get back the same node we passed in, rather than a new node or</span></div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;    <span class="comment">// zero, we know that the node must have defined multiple values and</span></div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;    <span class="comment">// CombineTo was used.  Since CombineTo takes care of the worklist</span></div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;    <span class="comment">// mechanics for us, we have no work to do in this case.</span></div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;    <span class="keywordflow">if</span> (RV.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>() == <a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>)</div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;</div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;    assert(N-&gt;<a class="code" href="classllvm_1_1SDNode.html#af0d328f3f61168f4ea7d6e4044af4f97">getOpcode</a>() != <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a062083eb3ff8c441c73d3bf42ca09bba">ISD::DELETED_NODE</a> &amp;&amp;</div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;           RV.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()-&gt;<a class="code" href="classllvm_1_1SDNode.html#af0d328f3f61168f4ea7d6e4044af4f97">getOpcode</a>() != <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a062083eb3ff8c441c73d3bf42ca09bba">ISD::DELETED_NODE</a> &amp;&amp;</div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;           <span class="stringliteral">&quot;Node was deleted but visit returned new node!&quot;</span>);</div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;    <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;\nReplacing.3 &quot;</span>;</div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;          N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a535ca517df1b4ae62e75475141e65787">dump</a>(&amp;DAG);</div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;          <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;\nWith: &quot;</span>;</div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;          RV.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()-&gt;<a class="code" href="classllvm_1_1SDNode.html#a535ca517df1b4ae62e75475141e65787">dump</a>(&amp;DAG);</div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;          <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>);</div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;</div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;    <span class="comment">// Transfer debug value.</span></div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;    DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a1ac87b6585263c774b2b350d3a98702b">TransferDbgValues</a>(<a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(N, 0), RV);</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;    WorkListRemover DeadNodes(*<span class="keyword">this</span>);</div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;    <span class="keywordflow">if</span> (N-&gt;<a class="code" href="classllvm_1_1SDNode.html#ab319fc51db27ec95fd50a910c7ccec94">getNumValues</a>() == RV.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()-&gt;<a class="code" href="classllvm_1_1SDNode.html#ab319fc51db27ec95fd50a910c7ccec94">getNumValues</a>())</div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;      DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a307e5150c6c85f43348d2b09a69d7591">ReplaceAllUsesWith</a>(N, RV.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;    <span class="keywordflow">else</span> {</div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;      assert(N-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(0) == RV.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>() &amp;&amp;</div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;             N-&gt;<a class="code" href="classllvm_1_1SDNode.html#ab319fc51db27ec95fd50a910c7ccec94">getNumValues</a>() == 1 &amp;&amp; <span class="stringliteral">&quot;Type mismatch&quot;</span>);</div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> OpV = RV;</div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;      DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a307e5150c6c85f43348d2b09a69d7591">ReplaceAllUsesWith</a>(N, &amp;OpV);</div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;    }</div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;</div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;    <span class="comment">// Push the new node and any users onto the worklist</span></div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;    AddToWorkList(RV.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;    AddUsersToWorkList(RV.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;</div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;    <span class="comment">// Add any uses of the old node to the worklist in case this node is the</span></div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;    <span class="comment">// last one that uses them.  They may become dead after this node is</span></div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;    <span class="comment">// deleted.</span></div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0, e = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#abc5c2f1d47a517373030133c6a102106">getNumOperands</a>(); <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != e; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;      AddToWorkList(N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>).<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;</div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;    <span class="comment">// Finally, if the node is now dead, remove it from the graph.  The node</span></div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;    <span class="comment">// may not be dead if the replacement process recursively simplified to</span></div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;    <span class="comment">// something else needing this node.</span></div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;    <span class="keywordflow">if</span> (N-&gt;<a class="code" href="classllvm_1_1SDNode.html#afc071edeb7e2007d000374eba843f76a">use_empty</a>()) {</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;      <span class="comment">// Nodes can be reintroduced into the worklist.  Make sure we do not</span></div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;      <span class="comment">// process a node that has been replaced.</span></div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;      removeFromWorkList(N);</div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;</div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;      <span class="comment">// Finally, since the node is now dead, remove it from the graph.</span></div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;      DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a5f57dcbedc16dced31c61f7bbbb06ded">DeleteNode</a>(N);</div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;    }</div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;  }</div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;</div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;  <span class="comment">// If the root changed (e.g. it was a dead load, update the root).</span></div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;  DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a3d2e079387a6e69ce2c8bb27bf7c2f32">setRoot</a>(<a class="code" href="namespacellvm_1_1NVPTXISD.html#a594ac167d52343b1fe4cec37bb7dc31ca7cff9cc4a40fe2b19129ee8e9b0ec645">Dummy</a>.getValue());</div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;  DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a92c8c043c2a2d8db5b6cf9767394b747">RemoveDeadNodes</a>();</div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;}</div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;</div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::visit(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N) {</div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;  <span class="keywordflow">switch</span> (N-&gt;<a class="code" href="classllvm_1_1SDNode.html#af0d328f3f61168f4ea7d6e4044af4f97">getOpcode</a>()) {</div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;  <span class="keywordflow">default</span>: <span class="keywordflow">break</span>;</div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ad469508535ce2082a1ab1f0e429187b8">ISD::TokenFactor</a>:        <span class="keywordflow">return</span> visitTokenFactor(N);</div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a01c94937492f3ac3fb1e0be8eb0b9ef1">ISD::MERGE_VALUES</a>:       <span class="keywordflow">return</span> visitMERGE_VALUES(N);</div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a269996b43a1f3e1d1f84a70fd4387535">ISD::ADD</a>:                <span class="keywordflow">return</span> visitADD(N);</div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9fa617e5567c3c2638938f7b9ddc3f1c">ISD::SUB</a>:                <span class="keywordflow">return</span> visitSUB(N);</div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a20084f62caecb0db80ad71bdabda73c2">ISD::ADDC</a>:               <span class="keywordflow">return</span> visitADDC(N);</div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a2ab6db512a611d1ef4ff8069e2bbfd0d">ISD::SUBC</a>:               <span class="keywordflow">return</span> visitSUBC(N);</div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ad116e32876f2275acf60ffb1651c9256">ISD::ADDE</a>:               <span class="keywordflow">return</span> visitADDE(N);</div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ac9246c101c0cc9232e37b3941194bb13">ISD::SUBE</a>:               <span class="keywordflow">return</span> visitSUBE(N);</div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ad8aec9273962cf78d087090c11a1dd1c">ISD::MUL</a>:                <span class="keywordflow">return</span> visitMUL(N);</div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a1f61c2422057e10403b2f6003543c300">ISD::SDIV</a>:               <span class="keywordflow">return</span> visitSDIV(N);</div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a15637879021fa7d5226045c0668a99a8">ISD::UDIV</a>:               <span class="keywordflow">return</span> visitUDIV(N);</div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a124ba0f5b2887879212c74a68bc230a3">ISD::SREM</a>:               <span class="keywordflow">return</span> visitSREM(N);</div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ad1657dbc1957901a6d9cd224efbc0f28">ISD::UREM</a>:               <span class="keywordflow">return</span> visitUREM(N);</div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a8a80d3b085af08f0dce1724207ef99b5">ISD::MULHU</a>:              <span class="keywordflow">return</span> visitMULHU(N);</div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110aa2a7c3eccf06b41e4275bbeadb46d22e">ISD::MULHS</a>:              <span class="keywordflow">return</span> visitMULHS(N);</div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a1354c6f8508d6cd697dc89a5d9a52dfd">ISD::SMUL_LOHI</a>:          <span class="keywordflow">return</span> visitSMUL_LOHI(N);</div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a79c959df09509d7ff66d9b04bc40d18d">ISD::UMUL_LOHI</a>:          <span class="keywordflow">return</span> visitUMUL_LOHI(N);</div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110aa35d0a58fdded3d225d512a60aea0951">ISD::SMULO</a>:              <span class="keywordflow">return</span> visitSMULO(N);</div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7800622851751b8ae318b41f4096830e">ISD::UMULO</a>:              <span class="keywordflow">return</span> visitUMULO(N);</div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a3a874f66e1efe5be79552bbe7ee3121a">ISD::SDIVREM</a>:            <span class="keywordflow">return</span> visitSDIVREM(N);</div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a3a257ffa49107e2db978e8a6e2688ada">ISD::UDIVREM</a>:            <span class="keywordflow">return</span> visitUDIVREM(N);</div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ac513a7da1bf74fb3e3c594da8534f2d2">ISD::AND</a>:                <span class="keywordflow">return</span> visitAND(N);</div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7415ab9f2172c59a2ee7c7a02afa56a4">ISD::OR</a>:                 <span class="keywordflow">return</span> visitOR(N);</div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a92febb83e6ba116eb7aae8e7e3f70cc1">ISD::XOR</a>:                <span class="keywordflow">return</span> visitXOR(N);</div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a8cc94e03dea594863073a02f5bb94997">ISD::SHL</a>:                <span class="keywordflow">return</span> visitSHL(N);</div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a4a055321c361a0f6ee77ed764730ffc1">ISD::SRA</a>:                <span class="keywordflow">return</span> visitSRA(N);</div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a3c6553c8acebe1b57c211ee45e2d8f98">ISD::SRL</a>:                <span class="keywordflow">return</span> visitSRL(N);</div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110add33c0ae9a63902e573fc1f92fc33f1c">ISD::CTLZ</a>:               <span class="keywordflow">return</span> visitCTLZ(N);</div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a0340c8d57d1dcebc43a00412989583d3">ISD::CTLZ_ZERO_UNDEF</a>:    <span class="keywordflow">return</span> visitCTLZ_ZERO_UNDEF(N);</div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a6da41a113af0909470baea7486b3386b">ISD::CTTZ</a>:               <span class="keywordflow">return</span> visitCTTZ(N);</div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a601e66a26efd05520f7cb26aef3af340">ISD::CTTZ_ZERO_UNDEF</a>:    <span class="keywordflow">return</span> visitCTTZ_ZERO_UNDEF(N);</div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a991d07d163bd4d9984cf1ef36e92c214">ISD::CTPOP</a>:              <span class="keywordflow">return</span> visitCTPOP(N);</div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a78d0f198115bfe3331ab7cfcf7a40a97">ISD::SELECT</a>:             <span class="keywordflow">return</span> visitSELECT(N);</div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ab0b7d2c769fd0fbaab3c4a2fc8e7ea0c">ISD::VSELECT</a>:            <span class="keywordflow">return</span> visitVSELECT(N);</div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a99ad6b342b7457df56b91d24e66016b3">ISD::SELECT_CC</a>:          <span class="keywordflow">return</span> visitSELECT_CC(N);</div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a0158ee47dfa868be5d28e2cbef70d5d0">ISD::SETCC</a>:              <span class="keywordflow">return</span> visitSETCC(N);</div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a5183f3d72924bc7c77ba8d3f5de9f602">ISD::SIGN_EXTEND</a>:        <span class="keywordflow">return</span> visitSIGN_EXTEND(N);</div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a93fdf85eff945f1a668b4915a051453e">ISD::ZERO_EXTEND</a>:        <span class="keywordflow">return</span> visitZERO_EXTEND(N);</div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a27d5d8ef82302b739ba3ca8be1a5513d">ISD::ANY_EXTEND</a>:         <span class="keywordflow">return</span> visitANY_EXTEND(N);</div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110aaa59dd5ec37f21905436b354c0292d9e">ISD::SIGN_EXTEND_INREG</a>:  <span class="keywordflow">return</span> visitSIGN_EXTEND_INREG(N);</div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ae690127648393001a7d5b93dc23da7b3">ISD::TRUNCATE</a>:           <span class="keywordflow">return</span> visitTRUNCATE(N);</div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a412ddf522b53f07690a86bffba1278e7">ISD::BITCAST</a>:            <span class="keywordflow">return</span> visitBITCAST(N);</div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a41bd84b853e2c03fb1af1f4ca9ebdcaf">ISD::BUILD_PAIR</a>:         <span class="keywordflow">return</span> visitBUILD_PAIR(N);</div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a32ec12017722f5b42a295fe5eb0b0bdf">ISD::FADD</a>:               <span class="keywordflow">return</span> visitFADD(N);</div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a2852a5b6baa80b1589a46737210a8cad">ISD::FSUB</a>:               <span class="keywordflow">return</span> visitFSUB(N);</div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9ab5860c97a00c4627a08cab7b0c8178">ISD::FMUL</a>:               <span class="keywordflow">return</span> visitFMUL(N);</div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a293ca68b3b2ce80eef991de822822254">ISD::FMA</a>:                <span class="keywordflow">return</span> visitFMA(N);</div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110abc6c09c7af98236460f0b020eb3be94e">ISD::FDIV</a>:               <span class="keywordflow">return</span> visitFDIV(N);</div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110abdd7bbb76dac7962dda6e116e33699da">ISD::FREM</a>:               <span class="keywordflow">return</span> visitFREM(N);</div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110aeffc3319657e213a530ce583603f7221">ISD::FCOPYSIGN</a>:          <span class="keywordflow">return</span> visitFCOPYSIGN(N);</div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a315004656a75a3c3a9d7294f105a8da2">ISD::SINT_TO_FP</a>:         <span class="keywordflow">return</span> visitSINT_TO_FP(N);</div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a169032eecd015d4eeb869c457202a6c8">ISD::UINT_TO_FP</a>:         <span class="keywordflow">return</span> visitUINT_TO_FP(N);</div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ac3f8f8d8437c64b2e2e9f978e2707210">ISD::FP_TO_SINT</a>:         <span class="keywordflow">return</span> visitFP_TO_SINT(N);</div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a71640703ec096a8b07111e85cfff6987">ISD::FP_TO_UINT</a>:         <span class="keywordflow">return</span> visitFP_TO_UINT(N);</div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110adaf9a3cb5c2ef5eb713bd6bf4ae23aeb">ISD::FP_ROUND</a>:           <span class="keywordflow">return</span> visitFP_ROUND(N);</div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a8745901e68ed76ceaf48791715cefcb4">ISD::FP_ROUND_INREG</a>:     <span class="keywordflow">return</span> visitFP_ROUND_INREG(N);</div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110aadfdefcb133a7f0262a05934aba8ce5d">ISD::FP_EXTEND</a>:          <span class="keywordflow">return</span> visitFP_EXTEND(N);</div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a6d26c45c040d8f85d577a5f645261d1a">ISD::FNEG</a>:               <span class="keywordflow">return</span> visitFNEG(N);</div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a2b4d07600495a563319d6a3dda8dc44d">ISD::FABS</a>:               <span class="keywordflow">return</span> visitFABS(N);</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a4336c27826676e1ef61383cafa999219">ISD::FFLOOR</a>:             <span class="keywordflow">return</span> visitFFLOOR(N);</div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ad56e9199ae3993a09af36ff41d327a11">ISD::FCEIL</a>:              <span class="keywordflow">return</span> visitFCEIL(N);</div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a1e92ea554489509b0ad970901bcc715b">ISD::FTRUNC</a>:             <span class="keywordflow">return</span> visitFTRUNC(N);</div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ae8167e4f6fa1bfb30f074ba620b81782">ISD::BRCOND</a>:             <span class="keywordflow">return</span> visitBRCOND(N);</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a6d5e322b263f0d5ea4204efafc1d78bb">ISD::BR_CC</a>:              <span class="keywordflow">return</span> visitBR_CC(N);</div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a269b81f007000306e3e69d0d290c2159">ISD::LOAD</a>:               <span class="keywordflow">return</span> visitLOAD(N);</div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a047178c3b2c6a5df40ae22a407b8aca9">ISD::STORE</a>:              <span class="keywordflow">return</span> visitSTORE(N);</div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ad3bc7c2d379fbfdc2f8eaca038690ec9">ISD::INSERT_VECTOR_ELT</a>:  <span class="keywordflow">return</span> visitINSERT_VECTOR_ELT(N);</div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9329e79f62e9ab9b41cfbcafd314bcbd">ISD::EXTRACT_VECTOR_ELT</a>: <span class="keywordflow">return</span> visitEXTRACT_VECTOR_ELT(N);</div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110aff6f73b624fecca7dbe94259f9437e32">ISD::BUILD_VECTOR</a>:       <span class="keywordflow">return</span> visitBUILD_VECTOR(N);</div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a320898056eadc3254fc601e1362eb9f5">ISD::CONCAT_VECTORS</a>:     <span class="keywordflow">return</span> visitCONCAT_VECTORS(N);</div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9070de8a5c5b71851732c4c54e2ffedf">ISD::EXTRACT_SUBVECTOR</a>:  <span class="keywordflow">return</span> visitEXTRACT_SUBVECTOR(N);</div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a8d8773b28111d8898663d4a0f6223d68">ISD::VECTOR_SHUFFLE</a>:     <span class="keywordflow">return</span> visitVECTOR_SHUFFLE(N);</div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;  }</div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;}</div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;</div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::combine(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N) {</div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> RV = visit(N);</div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;</div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;  <span class="comment">// If nothing happened, try a target-specific DAG combine.</span></div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;  <span class="keywordflow">if</span> (RV.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>() == 0) {</div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;    assert(N-&gt;<a class="code" href="classllvm_1_1SDNode.html#af0d328f3f61168f4ea7d6e4044af4f97">getOpcode</a>() != <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a062083eb3ff8c441c73d3bf42ca09bba">ISD::DELETED_NODE</a> &amp;&amp;</div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;           <span class="stringliteral">&quot;Node was deleted but visit returned NULL!&quot;</span>);</div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;</div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;    <span class="keywordflow">if</span> (N-&gt;<a class="code" href="classllvm_1_1SDNode.html#af0d328f3f61168f4ea7d6e4044af4f97">getOpcode</a>() &gt;= <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a477ef80c70c7359199eace0e5d3133b1">ISD::BUILTIN_OP_END</a> ||</div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;        TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a813157446ae8d1335ffcb82161f40f84">hasTargetDAGCombine</a>((<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110">ISD::NodeType</a>)N-&gt;<a class="code" href="classllvm_1_1SDNode.html#af0d328f3f61168f4ea7d6e4044af4f97">getOpcode</a>())) {</div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;</div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;      <span class="comment">// Expose the DAG combiner to the target combiner impls.</span></div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;      <a class="code" href="structllvm_1_1TargetLowering_1_1DAGCombinerInfo.html">TargetLowering::DAGCombinerInfo</a></div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;        DagCombineInfo(DAG, Level, <span class="keyword">false</span>, <span class="keyword">this</span>);</div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;</div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;      RV = TLI.<a class="code" href="classllvm_1_1TargetLowering.html#a23088f6e5065a437e6448022592ad85c">PerformDAGCombine</a>(N, DagCombineInfo);</div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;    }</div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;  }</div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;</div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;  <span class="comment">// If nothing happened still, try promoting the operation.</span></div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;  <span class="keywordflow">if</span> (RV.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>() == 0) {</div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;    <span class="keywordflow">switch</span> (N-&gt;<a class="code" href="classllvm_1_1SDNode.html#af0d328f3f61168f4ea7d6e4044af4f97">getOpcode</a>()) {</div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;    <span class="keywordflow">default</span>: <span class="keywordflow">break</span>;</div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a269996b43a1f3e1d1f84a70fd4387535">ISD::ADD</a>:</div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9fa617e5567c3c2638938f7b9ddc3f1c">ISD::SUB</a>:</div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ad8aec9273962cf78d087090c11a1dd1c">ISD::MUL</a>:</div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ac513a7da1bf74fb3e3c594da8534f2d2">ISD::AND</a>:</div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7415ab9f2172c59a2ee7c7a02afa56a4">ISD::OR</a>:</div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a92febb83e6ba116eb7aae8e7e3f70cc1">ISD::XOR</a>:</div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;      RV = PromoteIntBinOp(<a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(N, 0));</div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a8cc94e03dea594863073a02f5bb94997">ISD::SHL</a>:</div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a4a055321c361a0f6ee77ed764730ffc1">ISD::SRA</a>:</div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a3c6553c8acebe1b57c211ee45e2d8f98">ISD::SRL</a>:</div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;      RV = PromoteIntShiftOp(<a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(N, 0));</div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a5183f3d72924bc7c77ba8d3f5de9f602">ISD::SIGN_EXTEND</a>:</div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a93fdf85eff945f1a668b4915a051453e">ISD::ZERO_EXTEND</a>:</div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a27d5d8ef82302b739ba3ca8be1a5513d">ISD::ANY_EXTEND</a>:</div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;      RV = PromoteExtend(<a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(N, 0));</div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a269b81f007000306e3e69d0d290c2159">ISD::LOAD</a>:</div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;      <span class="keywordflow">if</span> (PromoteLoad(<a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(N, 0)))</div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;        RV = <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(N, 0);</div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;    }</div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;  }</div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;</div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;  <span class="comment">// If N is a commutative binary node, try commuting it to enable more</span></div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;  <span class="comment">// sdisel CSE.</span></div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;  <span class="keywordflow">if</span> (RV.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>() == 0 &amp;&amp;</div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;      <a class="code" href="classllvm_1_1SelectionDAG.html#acb93eca900026b60350adc23973c2262">SelectionDAG::isCommutativeBinOp</a>(N-&gt;<a class="code" href="classllvm_1_1SDNode.html#af0d328f3f61168f4ea7d6e4044af4f97">getOpcode</a>()) &amp;&amp;</div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;      N-&gt;<a class="code" href="classllvm_1_1SDNode.html#ab319fc51db27ec95fd50a910c7ccec94">getNumValues</a>() == 1) {</div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N0 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0);</div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N1 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(1);</div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;</div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;    <span class="comment">// Constant operands are canonicalized to RHS.</span></div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;    <span class="keywordflow">if</span> (isa&lt;ConstantSDNode&gt;(N0) || !isa&lt;ConstantSDNode&gt;(N1)) {</div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Ops[] = { N1, N0 };</div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;      <a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *CSENode = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af50a5a79c7e192fa4ee098033d8246ac">getNodeIfExists</a>(N-&gt;<a class="code" href="classllvm_1_1SDNode.html#af0d328f3f61168f4ea7d6e4044af4f97">getOpcode</a>(), N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a1aac28ffadab16f6cfbadfc2ddccd8a1">getVTList</a>(),</div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;                                            Ops, 2);</div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;      <span class="keywordflow">if</span> (CSENode)</div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(CSENode, 0);</div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;    }</div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;  }</div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;</div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;  <span class="keywordflow">return</span> RV;</div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;}</div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;<span class="comment">/// getInputChainForNode - Given a node, return its input chain if it has one,</span></div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;<span class="comment">/// otherwise return a null sd operand.</span></div><div class="line"><a name="l01271"></a><span class="lineno"><a class="line" href="DAGCombiner_8cpp.html#a4fb41e4d2abb178c37b2a3615e36d877"> 1271</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> <a class="code" href="DAGCombiner_8cpp.html#a4fb41e4d2abb178c37b2a3615e36d877">getInputChainForNode</a>(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N) {</div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;  <span class="keywordflow">if</span> (<span class="keywordtype">unsigned</span> NumOps = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#abc5c2f1d47a517373030133c6a102106">getNumOperands</a>()) {</div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;    <span class="keywordflow">if</span> (N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>() == <a class="code" href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50ca62a222acce6360abd2726719fabc2797">MVT::Other</a>)</div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;      <span class="keywordflow">return</span> N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0);</div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;    <span class="keywordflow">if</span> (N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(NumOps-1).<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>() == <a class="code" href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50ca62a222acce6360abd2726719fabc2797">MVT::Other</a>)</div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;      <span class="keywordflow">return</span> N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(NumOps-1);</div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 1; <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; NumOps-1; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;      <span class="keywordflow">if</span> (N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>).<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>() == <a class="code" href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50ca62a222acce6360abd2726719fabc2797">MVT::Other</a>)</div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;        <span class="keywordflow">return</span> N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;  }</div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;}</div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;</div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::visitTokenFactor(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N) {</div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;  <span class="comment">// If N has two operands, where one has an input chain equal to the other,</span></div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;  <span class="comment">// the &#39;other&#39; chain is redundant.</span></div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;  <span class="keywordflow">if</span> (N-&gt;<a class="code" href="classllvm_1_1SDNode.html#abc5c2f1d47a517373030133c6a102106">getNumOperands</a>() == 2) {</div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="DAGCombiner_8cpp.html#a4fb41e4d2abb178c37b2a3615e36d877">getInputChainForNode</a>(N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()) == N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(1))</div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;      <span class="keywordflow">return</span> N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0);</div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="DAGCombiner_8cpp.html#a4fb41e4d2abb178c37b2a3615e36d877">getInputChainForNode</a>(N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(1).<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()) == N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0))</div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;      <span class="keywordflow">return</span> N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(1);</div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;  }</div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;</div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;SDNode *, 8&gt;</a> TFs;     <span class="comment">// List of token factors to visit.</span></div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;SDValue, 8&gt;</a> Ops;    <span class="comment">// Ops for replacing token factor.</span></div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;  <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;SDNode*, 16&gt;</a> SeenOps;</div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;  <span class="keywordtype">bool</span> Changed = <span class="keyword">false</span>;             <span class="comment">// If we should replace this token factor.</span></div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;</div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;  <span class="comment">// Start out with this token factor.</span></div><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;  TFs.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(N);</div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;</div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;  <span class="comment">// Iterate through token factors.  The TFs grows when new token factors are</span></div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;  <span class="comment">// encountered.</span></div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; TFs.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#a22a311dfe4c28a897de8a9365a4f0a84">size</a>(); ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;    <a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *TF = TFs[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;</div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;    <span class="comment">// Check each of the operands.</span></div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0, ie = TF-&gt;<a class="code" href="classllvm_1_1SDNode.html#abc5c2f1d47a517373030133c6a102106">getNumOperands</a>(); <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != ie; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Op = TF-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;</div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;      <span class="keywordflow">switch</span> (Op.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>()) {</div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a926013f6dca240eca95aca66c8d3e74b">ISD::EntryToken</a>:</div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;        <span class="comment">// Entry tokens don&#39;t need to be added to the list. They are</span></div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;        <span class="comment">// rededundant.</span></div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;        Changed = <span class="keyword">true</span>;</div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;</div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ad469508535ce2082a1ab1f0e429187b8">ISD::TokenFactor</a>:</div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;        <span class="keywordflow">if</span> (Op.<a class="code" href="classllvm_1_1SDValue.html#a97b0f24f3e52f030830fca6fbfcbd37d">hasOneUse</a>() &amp;&amp;</div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;            std::find(TFs.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#a8a045d250952c0867382a9840ee18fdf">begin</a>(), TFs.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#a075e34e98605d0e7c289763a104869ac">end</a>(), Op.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()) == TFs.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#a075e34e98605d0e7c289763a104869ac">end</a>()) {</div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;          <span class="comment">// Queue up for processing.</span></div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;          TFs.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(Op.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;          <span class="comment">// Clean up in case the token factor is removed.</span></div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;          AddToWorkList(Op.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;          Changed = <span class="keyword">true</span>;</div><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;          <span class="keywordflow">break</span>;</div><div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;        }</div><div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;        <span class="comment">// Fall thru</span></div><div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;</div><div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;      <span class="keywordflow">default</span>:</div><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;        <span class="comment">// Only add if it isn&#39;t already in the list.</span></div><div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;        <span class="keywordflow">if</span> (SeenOps.<a class="code" href="classllvm_1_1SmallPtrSet.html#a9b6dd0fc7a648a939e571246045b673e">insert</a>(Op.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()))</div><div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;          Ops.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(Op);</div><div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;          Changed = <span class="keyword">true</span>;</div><div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;      }</div><div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;    }</div><div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;  }</div><div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;</div><div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Result;</div><div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;</div><div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;  <span class="comment">// If we&#39;ve change things around then replace token factor.</span></div><div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;  <span class="keywordflow">if</span> (Changed) {</div><div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;    <span class="keywordflow">if</span> (Ops.<a class="code" href="classllvm_1_1SmallVectorBase.html#a8a8df4d85555c7954a95f86080cd3b64">empty</a>()) {</div><div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;      <span class="comment">// The entry token is the only possible outcome.</span></div><div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;      Result = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#ad755b1a25cf0c4507d5f615f64471ae9">getEntryNode</a>();</div><div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;      <span class="comment">// New and improved token factor.</span></div><div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;      Result = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ad469508535ce2082a1ab1f0e429187b8">ISD::TokenFactor</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N),</div><div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;                           <a class="code" href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50ca62a222acce6360abd2726719fabc2797">MVT::Other</a>, &amp;Ops[0], Ops.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#a22a311dfe4c28a897de8a9365a4f0a84">size</a>());</div><div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;    }</div><div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;</div><div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;    <span class="comment">// Don&#39;t add users to work list.</span></div><div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;    <span class="keywordflow">return</span> CombineTo(N, Result, <span class="keyword">false</span>);</div><div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;  }</div><div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;</div><div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;  <span class="keywordflow">return</span> Result;</div><div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;}</div><div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;<span class="comment">/// MERGE_VALUES can always be eliminated.</span></div><div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;<span class="comment"></span><a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::visitMERGE_VALUES(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N) {</div><div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;  WorkListRemover DeadNodes(*<span class="keyword">this</span>);</div><div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;  <span class="comment">// Replacing results may cause a different MERGE_VALUES to suddenly</span></div><div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;  <span class="comment">// be CSE&#39;d with N, and carry its uses with it. Iterate until no</span></div><div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;  <span class="comment">// uses remain, to ensure that the node can be safely deleted.</span></div><div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;  <span class="comment">// First add the users of this node to the work list so that they</span></div><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;  <span class="comment">// can be tried again once they have new operands.</span></div><div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;  AddUsersToWorkList(N);</div><div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;  <span class="keywordflow">do</span> {</div><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0, e = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#abc5c2f1d47a517373030133c6a102106">getNumOperands</a>(); <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != e; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div><div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;      DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#ac630ccda26fea2f45afa3fb89bc1a8f4">ReplaceAllUsesOfValueWith</a>(<a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(N, <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>), N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>));</div><div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;  } <span class="keywordflow">while</span> (!N-&gt;<a class="code" href="classllvm_1_1SDNode.html#afc071edeb7e2007d000374eba843f76a">use_empty</a>());</div><div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;  removeFromWorkList(N);</div><div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;  DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a5f57dcbedc16dced31c61f7bbbb06ded">DeleteNode</a>(N);</div><div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(N, 0);   <span class="comment">// Return N so it doesn&#39;t get rechecked!</span></div><div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;}</div><div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;</div><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;<span class="keyword">static</span></div><div class="line"><a name="l01380"></a><span class="lineno"><a class="line" href="DAGCombiner_8cpp.html#a17ebad91761318291cebf272abf95e6d"> 1380</a></span>&#160;<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> <a class="code" href="DAGCombiner_8cpp.html#a17ebad91761318291cebf272abf95e6d">combineShlAddConstant</a>(<a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a> DL, <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N0, <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N1,</div><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;                              <a class="code" href="classllvm_1_1SelectionDAG.html">SelectionDAG</a> &amp;DAG) {</div><div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> VT = N0.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>();</div><div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N00 = N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0);</div><div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N01 = N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1);</div><div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;  <a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a> *N01C = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a>&gt;(N01);</div><div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;</div><div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;  <span class="keywordflow">if</span> (N01C &amp;&amp; N00.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a269996b43a1f3e1d1f84a70fd4387535">ISD::ADD</a> &amp;&amp; N00.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()-&gt;<a class="code" href="classllvm_1_1SDNode.html#a52753947fce3a01b1c18dd4713c587e8">hasOneUse</a>() &amp;&amp;</div><div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;      isa&lt;ConstantSDNode&gt;(N00.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1))) {</div><div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;    <span class="comment">// fold (add (shl (add x, c1), c2), ) -&gt; (add (add (shl x, c2), c1&lt;&lt;c2), )</span></div><div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;    N0 = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a269996b43a1f3e1d1f84a70fd4387535">ISD::ADD</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N0), VT,</div><div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;                     DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a8cc94e03dea594863073a02f5bb94997">ISD::SHL</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N00), VT,</div><div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;                                 N00.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0), N01),</div><div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;                     DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a8cc94e03dea594863073a02f5bb94997">ISD::SHL</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N01), VT,</div><div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;                                 N00.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1), N01));</div><div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a269996b43a1f3e1d1f84a70fd4387535">ISD::ADD</a>, DL, VT, N0, N1);</div><div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;  }</div><div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;</div><div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;}</div><div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;</div><div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::visitADD(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N) {</div><div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N0 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0);</div><div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N1 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(1);</div><div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;  <a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a> *N0C = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a>&gt;(N0);</div><div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;  <a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a> *N1C = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a>&gt;(N1);</div><div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> VT = N0.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>();</div><div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;</div><div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;  <span class="comment">// fold vector ops</span></div><div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;  <span class="keywordflow">if</span> (VT.isVector()) {</div><div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> FoldedVOp = SimplifyVBinOp(N);</div><div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;    <span class="keywordflow">if</span> (FoldedVOp.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()) <span class="keywordflow">return</span> FoldedVOp;</div><div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;</div><div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;    <span class="comment">// fold (add x, 0) -&gt; x, vector edition</span></div><div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1ISD.html#aaac3e239cbdfe15a8e9bad4f8e1e3a95">ISD::isBuildVectorAllZeros</a>(N1.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()))</div><div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;      <span class="keywordflow">return</span> N0;</div><div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1ISD.html#aaac3e239cbdfe15a8e9bad4f8e1e3a95">ISD::isBuildVectorAllZeros</a>(N0.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()))</div><div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;      <span class="keywordflow">return</span> N1;</div><div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;  }</div><div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;</div><div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;  <span class="comment">// fold (add x, undef) -&gt; undef</span></div><div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;  <span class="keywordflow">if</span> (N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7c6d8f265e9e16e5debdb9a536b55d3d">ISD::UNDEF</a>)</div><div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;    <span class="keywordflow">return</span> N0;</div><div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;  <span class="keywordflow">if</span> (N1.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7c6d8f265e9e16e5debdb9a536b55d3d">ISD::UNDEF</a>)</div><div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;    <span class="keywordflow">return</span> N1;</div><div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;  <span class="comment">// fold (add c1, c2) -&gt; c1+c2</span></div><div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;  <span class="keywordflow">if</span> (N0C &amp;&amp; N1C)</div><div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a8503b91b7bbfb128a42fa582857f8828">FoldConstantArithmetic</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a269996b43a1f3e1d1f84a70fd4387535">ISD::ADD</a>, VT, N0C, N1C);</div><div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;  <span class="comment">// canonicalize constant to RHS</span></div><div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;  <span class="keywordflow">if</span> (N0C &amp;&amp; !N1C)</div><div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a269996b43a1f3e1d1f84a70fd4387535">ISD::ADD</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N1, N0);</div><div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;  <span class="comment">// fold (add x, 0) -&gt; x</span></div><div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;  <span class="keywordflow">if</span> (N1C &amp;&amp; N1C-&gt;isNullValue())</div><div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;    <span class="keywordflow">return</span> N0;</div><div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;  <span class="comment">// fold (add Sym, c) -&gt; Sym+c</span></div><div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1GlobalAddressSDNode.html">GlobalAddressSDNode</a> *GA = dyn_cast&lt;GlobalAddressSDNode&gt;(N0))</div><div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;    <span class="keywordflow">if</span> (!LegalOperations &amp;&amp; TLI.<a class="code" href="classllvm_1_1TargetLowering.html#a6634fc60337427fd6c33e851a4ff45ad">isOffsetFoldingLegal</a>(GA) &amp;&amp; N1C &amp;&amp;</div><div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;        GA-&gt;getOpcode() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a30316f8f9985260c49d7c26bc70a6cad">ISD::GlobalAddress</a>)</div><div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a0ee11b567d80b84aafb68339dbb3923c">getGlobalAddress</a>(GA-&gt;getGlobal(), <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N1C), VT,</div><div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;                                  GA-&gt;getOffset() +</div><div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;                                    (uint64_t)N1C-&gt;getSExtValue());</div><div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;  <span class="comment">// fold ((c1-A)+c2) -&gt; (c1+c2)-A</span></div><div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;  <span class="keywordflow">if</span> (N1C &amp;&amp; N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9fa617e5567c3c2638938f7b9ddc3f1c">ISD::SUB</a>)</div><div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a> *N0C = dyn_cast&lt;ConstantSDNode&gt;(N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0)))</div><div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9fa617e5567c3c2638938f7b9ddc3f1c">ISD::SUB</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT,</div><div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;                         DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(N1C-&gt;getAPIntValue()+</div><div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;                                         N0C-&gt;<a class="code" href="classllvm_1_1ConstantSDNode.html#a7951626d3fc3c89c4efee59ed9c3d8bf">getAPIntValue</a>(), VT),</div><div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;                         N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1));</div><div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;  <span class="comment">// reassociate add</span></div><div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> RADD = ReassociateOps(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a269996b43a1f3e1d1f84a70fd4387535">ISD::ADD</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), N0, N1);</div><div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;  <span class="keywordflow">if</span> (RADD.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>() != 0)</div><div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;    <span class="keywordflow">return</span> RADD;</div><div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;  <span class="comment">// fold ((0-A) + B) -&gt; B-A</span></div><div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;  <span class="keywordflow">if</span> (N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9fa617e5567c3c2638938f7b9ddc3f1c">ISD::SUB</a> &amp;&amp; isa&lt;ConstantSDNode&gt;(N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0)) &amp;&amp;</div><div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;      cast&lt;ConstantSDNode&gt;(N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0))-&gt;isNullValue())</div><div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9fa617e5567c3c2638938f7b9ddc3f1c">ISD::SUB</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N1, N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1));</div><div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;  <span class="comment">// fold (A + (0-B)) -&gt; A-B</span></div><div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;  <span class="keywordflow">if</span> (N1.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9fa617e5567c3c2638938f7b9ddc3f1c">ISD::SUB</a> &amp;&amp; isa&lt;ConstantSDNode&gt;(N1.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0)) &amp;&amp;</div><div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;      cast&lt;ConstantSDNode&gt;(N1.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0))-&gt;isNullValue())</div><div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9fa617e5567c3c2638938f7b9ddc3f1c">ISD::SUB</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N0, N1.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1));</div><div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;  <span class="comment">// fold (A+(B-A)) -&gt; B</span></div><div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;  <span class="keywordflow">if</span> (N1.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9fa617e5567c3c2638938f7b9ddc3f1c">ISD::SUB</a> &amp;&amp; N0 == N1.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1))</div><div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;    <span class="keywordflow">return</span> N1.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0);</div><div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;  <span class="comment">// fold ((B-A)+A) -&gt; B</span></div><div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;  <span class="keywordflow">if</span> (N0.getOpcode() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9fa617e5567c3c2638938f7b9ddc3f1c">ISD::SUB</a> &amp;&amp; N1 == N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1))</div><div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;    <span class="keywordflow">return</span> N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0);</div><div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;  <span class="comment">// fold (A+(B-(A+C))) to (B-C)</span></div><div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;  <span class="keywordflow">if</span> (N1.getOpcode() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9fa617e5567c3c2638938f7b9ddc3f1c">ISD::SUB</a> &amp;&amp; N1.getOperand(1).getOpcode() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a269996b43a1f3e1d1f84a70fd4387535">ISD::ADD</a> &amp;&amp;</div><div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;      N0 == N1.getOperand(1).getOperand(0))</div><div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9fa617e5567c3c2638938f7b9ddc3f1c">ISD::SUB</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N1.getOperand(0),</div><div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;                       N1.getOperand(1).getOperand(1));</div><div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;  <span class="comment">// fold (A+(B-(C+A))) to (B-C)</span></div><div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;  <span class="keywordflow">if</span> (N1.getOpcode() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9fa617e5567c3c2638938f7b9ddc3f1c">ISD::SUB</a> &amp;&amp; N1.getOperand(1).getOpcode() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a269996b43a1f3e1d1f84a70fd4387535">ISD::ADD</a> &amp;&amp;</div><div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;      N0 == N1.getOperand(1).getOperand(1))</div><div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9fa617e5567c3c2638938f7b9ddc3f1c">ISD::SUB</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N1.getOperand(0),</div><div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;                       N1.getOperand(1).getOperand(0));</div><div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;  <span class="comment">// fold (A+((B-A)+or-C)) to (B+or-C)</span></div><div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;  <span class="keywordflow">if</span> ((N1.getOpcode() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9fa617e5567c3c2638938f7b9ddc3f1c">ISD::SUB</a> || N1.getOpcode() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a269996b43a1f3e1d1f84a70fd4387535">ISD::ADD</a>) &amp;&amp;</div><div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;      N1.getOperand(0).getOpcode() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9fa617e5567c3c2638938f7b9ddc3f1c">ISD::SUB</a> &amp;&amp;</div><div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;      N0 == N1.getOperand(0).getOperand(1))</div><div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(N1.getOpcode(), <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT,</div><div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;                       N1.getOperand(0).getOperand(0), N1.getOperand(1));</div><div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;</div><div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;  <span class="comment">// fold (A-B)+(C-D) to (A+C)-(B+D) when A or C is constant</span></div><div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;  <span class="keywordflow">if</span> (N0.getOpcode() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9fa617e5567c3c2638938f7b9ddc3f1c">ISD::SUB</a> &amp;&amp; N1.getOpcode() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9fa617e5567c3c2638938f7b9ddc3f1c">ISD::SUB</a>) {</div><div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N00 = N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0);</div><div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N01 = N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1);</div><div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N10 = N1.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0);</div><div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N11 = N1.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1);</div><div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;</div><div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;    <span class="keywordflow">if</span> (isa&lt;ConstantSDNode&gt;(N00) || isa&lt;ConstantSDNode&gt;(N10))</div><div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9fa617e5567c3c2638938f7b9ddc3f1c">ISD::SUB</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT,</div><div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;                         DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a269996b43a1f3e1d1f84a70fd4387535">ISD::ADD</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N0), VT, N00, N10),</div><div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;                         DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a269996b43a1f3e1d1f84a70fd4387535">ISD::ADD</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N1), VT, N01, N11));</div><div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;  }</div><div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;</div><div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;  <span class="keywordflow">if</span> (!VT.isVector() &amp;&amp; SimplifyDemandedBits(<a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(N, 0)))</div><div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(N, 0);</div><div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;</div><div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;  <span class="comment">// fold (a+b) -&gt; (a|b) iff a and b share no bits.</span></div><div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;  <span class="keywordflow">if</span> (VT.isInteger() &amp;&amp; !VT.isVector()) {</div><div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;    <a class="code" href="classllvm_1_1APInt.html">APInt</a> LHSZero, LHSOne;</div><div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;    <a class="code" href="classllvm_1_1APInt.html">APInt</a> RHSZero, RHSOne;</div><div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;    DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#ad06ca140783fd9f03eed498e8485fc3d">ComputeMaskedBits</a>(N0, LHSZero, LHSOne);</div><div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;</div><div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;    <span class="keywordflow">if</span> (LHSZero.<a class="code" href="classllvm_1_1APInt.html#ac8be1ee0c47d9e47e567fa353f987ed5">getBoolValue</a>()) {</div><div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;      DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#ad06ca140783fd9f03eed498e8485fc3d">ComputeMaskedBits</a>(N1, RHSZero, RHSOne);</div><div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;</div><div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;      <span class="comment">// If all possibly-set bits on the LHS are clear on the RHS, return an OR.</span></div><div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;      <span class="comment">// If all possibly-set bits on the RHS are clear on the LHS, return an OR.</span></div><div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;      <span class="keywordflow">if</span> ((RHSZero &amp; ~LHSZero) == ~LHSZero || (LHSZero &amp; ~RHSZero) == ~RHSZero)</div><div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;        <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7415ab9f2172c59a2ee7c7a02afa56a4">ISD::OR</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N0, N1);</div><div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;    }</div><div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;  }</div><div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;</div><div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;  <span class="comment">// fold (add (shl (add x, c1), c2), ) -&gt; (add (add (shl x, c2), c1&lt;&lt;c2), )</span></div><div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;  <span class="keywordflow">if</span> (N0.getOpcode() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a8cc94e03dea594863073a02f5bb94997">ISD::SHL</a> &amp;&amp; N0.getNode()-&gt;hasOneUse()) {</div><div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Result = <a class="code" href="DAGCombiner_8cpp.html#a17ebad91761318291cebf272abf95e6d">combineShlAddConstant</a>(<a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), N0, N1, DAG);</div><div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;    <span class="keywordflow">if</span> (Result.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()) <span class="keywordflow">return</span> Result;</div><div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;  }</div><div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;  <span class="keywordflow">if</span> (N1.getOpcode() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a8cc94e03dea594863073a02f5bb94997">ISD::SHL</a> &amp;&amp; N1.getNode()-&gt;hasOneUse()) {</div><div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Result = <a class="code" href="DAGCombiner_8cpp.html#a17ebad91761318291cebf272abf95e6d">combineShlAddConstant</a>(<a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), N1, N0, DAG);</div><div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;    <span class="keywordflow">if</span> (Result.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()) <span class="keywordflow">return</span> Result;</div><div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;  }</div><div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;</div><div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;  <span class="comment">// fold (add x, shl(0 - y, n)) -&gt; sub(x, shl(y, n))</span></div><div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;  <span class="keywordflow">if</span> (N1.getOpcode() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a8cc94e03dea594863073a02f5bb94997">ISD::SHL</a> &amp;&amp;</div><div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;      N1.getOperand(0).getOpcode() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9fa617e5567c3c2638938f7b9ddc3f1c">ISD::SUB</a>)</div><div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a> *<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> =</div><div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;          dyn_cast&lt;ConstantSDNode&gt;(N1.getOperand(0).getOperand(0)))</div><div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>-&gt;getAPIntValue() == 0)</div><div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;        <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9fa617e5567c3c2638938f7b9ddc3f1c">ISD::SUB</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N0,</div><div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;                           DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a8cc94e03dea594863073a02f5bb94997">ISD::SHL</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT,</div><div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;                                       N1.getOperand(0).getOperand(1),</div><div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;                                       N1.getOperand(1)));</div><div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;  <span class="keywordflow">if</span> (N0.getOpcode() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a8cc94e03dea594863073a02f5bb94997">ISD::SHL</a> &amp;&amp;</div><div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;      N0.getOperand(0).getOpcode() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9fa617e5567c3c2638938f7b9ddc3f1c">ISD::SUB</a>)</div><div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a> *<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> =</div><div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;          dyn_cast&lt;ConstantSDNode&gt;(N0.getOperand(0).getOperand(0)))</div><div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>-&gt;getAPIntValue() == 0)</div><div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;        <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9fa617e5567c3c2638938f7b9ddc3f1c">ISD::SUB</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N1,</div><div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;                           DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a8cc94e03dea594863073a02f5bb94997">ISD::SHL</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT,</div><div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;                                       N0.getOperand(0).getOperand(1),</div><div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;                                       N0.getOperand(1)));</div><div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;</div><div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;  <span class="keywordflow">if</span> (N1.getOpcode() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ac513a7da1bf74fb3e3c594da8534f2d2">ISD::AND</a>) {</div><div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> AndOp0 = N1.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0);</div><div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;    <a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a> *AndOp1 = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a>&gt;(N1-&gt;getOperand(1));</div><div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;    <span class="keywordtype">unsigned</span> NumSignBits = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a01e15fa872bbde36ed8a394a01b200b9">ComputeNumSignBits</a>(AndOp0);</div><div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;    <span class="keywordtype">unsigned</span> DestBits = VT.getScalarType().getSizeInBits();</div><div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;</div><div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;    <span class="comment">// (add z, (and (sbbl x, x), 1)) -&gt; (sub z, (sbbl x, x))</span></div><div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;    <span class="comment">// and similar xforms where the inner op is either ~0 or 0.</span></div><div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;    <span class="keywordflow">if</span> (NumSignBits == DestBits &amp;&amp; AndOp1 &amp;&amp; AndOp1-&gt;<a class="code" href="classllvm_1_1ConstantSDNode.html#ac27741dc62185494433dec7a5f723f70">isOne</a>()) {</div><div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;      <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a> DL(N);</div><div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9fa617e5567c3c2638938f7b9ddc3f1c">ISD::SUB</a>, DL, VT, N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0), AndOp0);</div><div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;    }</div><div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;  }</div><div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;</div><div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;  <span class="comment">// add (sext i1), X -&gt; sub X, (zext i1)</span></div><div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;  <span class="keywordflow">if</span> (N0.getOpcode() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a5183f3d72924bc7c77ba8d3f5de9f602">ISD::SIGN_EXTEND</a> &amp;&amp;</div><div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;      N0.getOperand(0).getValueType() == <a class="code" href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50ca85440bbdbba12de574c02e515444d3f4">MVT::i1</a> &amp;&amp;</div><div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;      !TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a055b3905dbbc16fae11510b9ebd1e00c">isOperationLegal</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a5183f3d72924bc7c77ba8d3f5de9f602">ISD::SIGN_EXTEND</a>, <a class="code" href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50ca85440bbdbba12de574c02e515444d3f4">MVT::i1</a>)) {</div><div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;    <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a> DL(N);</div><div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> ZExt = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a93fdf85eff945f1a668b4915a051453e">ISD::ZERO_EXTEND</a>, DL, VT, N0.getOperand(0));</div><div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9fa617e5567c3c2638938f7b9ddc3f1c">ISD::SUB</a>, DL, VT, N1, ZExt);</div><div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;  }</div><div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;</div><div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;}</div><div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;</div><div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::visitADDC(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N) {</div><div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N0 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0);</div><div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N1 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(1);</div><div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;  <a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a> *N0C = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a>&gt;(N0);</div><div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;  <a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a> *N1C = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a>&gt;(N1);</div><div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> VT = N0.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>();</div><div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;</div><div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;  <span class="comment">// If the flag result is dead, turn this into an ADD.</span></div><div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;  <span class="keywordflow">if</span> (!N-&gt;<a class="code" href="classllvm_1_1SDNode.html#ae4cb676e77b9f238058c70faa609a5d7">hasAnyUseOfValue</a>(1))</div><div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;    <span class="keywordflow">return</span> CombineTo(N, DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a269996b43a1f3e1d1f84a70fd4387535">ISD::ADD</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N0, N1),</div><div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;                     DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110acc20c926003b2af97ba08689176e7130">ISD::CARRY_FALSE</a>,</div><div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;                                 <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), <a class="code" href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50ca59a1908cf136662bcfdc11ed49515ca9">MVT::Glue</a>));</div><div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;</div><div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;  <span class="comment">// canonicalize constant to RHS.</span></div><div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;  <span class="keywordflow">if</span> (N0C &amp;&amp; !N1C)</div><div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a20084f62caecb0db80ad71bdabda73c2">ISD::ADDC</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a1aac28ffadab16f6cfbadfc2ddccd8a1">getVTList</a>(), N1, N0);</div><div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;</div><div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;  <span class="comment">// fold (addc x, 0) -&gt; x + no carry out</span></div><div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;  <span class="keywordflow">if</span> (N1C &amp;&amp; N1C-&gt;isNullValue())</div><div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;    <span class="keywordflow">return</span> CombineTo(N, N0, DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110acc20c926003b2af97ba08689176e7130">ISD::CARRY_FALSE</a>,</div><div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;                                        <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), <a class="code" href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50ca59a1908cf136662bcfdc11ed49515ca9">MVT::Glue</a>));</div><div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;</div><div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;  <span class="comment">// fold (addc a, b) -&gt; (or a, b), CARRY_FALSE iff a and b share no bits.</span></div><div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;  <a class="code" href="classllvm_1_1APInt.html">APInt</a> LHSZero, LHSOne;</div><div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;  <a class="code" href="classllvm_1_1APInt.html">APInt</a> RHSZero, RHSOne;</div><div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;  DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#ad06ca140783fd9f03eed498e8485fc3d">ComputeMaskedBits</a>(N0, LHSZero, LHSOne);</div><div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;</div><div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;  <span class="keywordflow">if</span> (LHSZero.<a class="code" href="classllvm_1_1APInt.html#ac8be1ee0c47d9e47e567fa353f987ed5">getBoolValue</a>()) {</div><div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;    DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#ad06ca140783fd9f03eed498e8485fc3d">ComputeMaskedBits</a>(N1, RHSZero, RHSOne);</div><div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;</div><div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;    <span class="comment">// If all possibly-set bits on the LHS are clear on the RHS, return an OR.</span></div><div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;    <span class="comment">// If all possibly-set bits on the RHS are clear on the LHS, return an OR.</span></div><div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;    <span class="keywordflow">if</span> ((RHSZero &amp; ~LHSZero) == ~LHSZero || (LHSZero &amp; ~RHSZero) == ~RHSZero)</div><div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;      <span class="keywordflow">return</span> CombineTo(N, DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7415ab9f2172c59a2ee7c7a02afa56a4">ISD::OR</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N0, N1),</div><div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;                       DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110acc20c926003b2af97ba08689176e7130">ISD::CARRY_FALSE</a>,</div><div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;                                   <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), <a class="code" href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50ca59a1908cf136662bcfdc11ed49515ca9">MVT::Glue</a>));</div><div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;  }</div><div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;</div><div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;}</div><div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;</div><div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::visitADDE(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N) {</div><div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N0 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0);</div><div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N1 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(1);</div><div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> CarryIn = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(2);</div><div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;  <a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a> *N0C = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a>&gt;(N0);</div><div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;  <a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a> *N1C = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a>&gt;(N1);</div><div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;</div><div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;  <span class="comment">// canonicalize constant to RHS</span></div><div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;  <span class="keywordflow">if</span> (N0C &amp;&amp; !N1C)</div><div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ad116e32876f2275acf60ffb1651c9256">ISD::ADDE</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a1aac28ffadab16f6cfbadfc2ddccd8a1">getVTList</a>(),</div><div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;                       N1, N0, CarryIn);</div><div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;</div><div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;  <span class="comment">// fold (adde x, y, false) -&gt; (addc x, y)</span></div><div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;  <span class="keywordflow">if</span> (CarryIn.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110acc20c926003b2af97ba08689176e7130">ISD::CARRY_FALSE</a>)</div><div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a20084f62caecb0db80ad71bdabda73c2">ISD::ADDC</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a1aac28ffadab16f6cfbadfc2ddccd8a1">getVTList</a>(), N0, N1);</div><div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;</div><div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;}</div><div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;</div><div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;<span class="comment">// Since it may not be valid to emit a fold to zero for vector initializers</span></div><div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;<span class="comment">// check if we can before folding.</span></div><div class="line"><a name="l01633"></a><span class="lineno"><a class="line" href="DAGCombiner_8cpp.html#ae5856aabdc0d5eeaec3cf71f93c771a9"> 1633</a></span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> <a class="code" href="DAGCombiner_8cpp.html#ae5856aabdc0d5eeaec3cf71f93c771a9">tryFoldToZero</a>(<a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a> DL, <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetLowering.html">TargetLowering</a> &amp;TLI, <a class="code" href="structllvm_1_1EVT.html">EVT</a> VT,</div><div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;                             <a class="code" href="classllvm_1_1SelectionDAG.html">SelectionDAG</a> &amp;DAG,</div><div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;                             <span class="keywordtype">bool</span> LegalOperations, <span class="keywordtype">bool</span> LegalTypes) {</div><div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;  <span class="keywordflow">if</span> (!VT.<a class="code" href="structllvm_1_1EVT.html#a73f7c824cad61a47c21bf6d652ae2fd7">isVector</a>())</div><div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(0, VT);</div><div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;  <span class="keywordflow">if</span> (!LegalOperations || TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a055b3905dbbc16fae11510b9ebd1e00c">isOperationLegal</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110aff6f73b624fecca7dbe94259f9437e32">ISD::BUILD_VECTOR</a>, VT))</div><div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(0, VT);</div><div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;}</div><div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;</div><div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::visitSUB(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N) {</div><div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N0 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0);</div><div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N1 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(1);</div><div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;  <a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a> *N0C = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a>&gt;(N0.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;  <a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a> *N1C = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a>&gt;(N1.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;  <a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a> *N1C1 = N1.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() != <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a269996b43a1f3e1d1f84a70fd4387535">ISD::ADD</a> ? 0 :</div><div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;    <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a>&gt;(N1.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1).<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> VT = N0.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>();</div><div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;</div><div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;  <span class="comment">// fold vector ops</span></div><div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;  <span class="keywordflow">if</span> (VT.isVector()) {</div><div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> FoldedVOp = SimplifyVBinOp(N);</div><div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;    <span class="keywordflow">if</span> (FoldedVOp.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()) <span class="keywordflow">return</span> FoldedVOp;</div><div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;</div><div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;    <span class="comment">// fold (sub x, 0) -&gt; x, vector edition</span></div><div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1ISD.html#aaac3e239cbdfe15a8e9bad4f8e1e3a95">ISD::isBuildVectorAllZeros</a>(N1.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()))</div><div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;      <span class="keywordflow">return</span> N0;</div><div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;  }</div><div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;</div><div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;  <span class="comment">// fold (sub x, x) -&gt; 0</span></div><div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;  <span class="comment">// FIXME: Refactor this and xor and other similar operations together.</span></div><div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;  <span class="keywordflow">if</span> (N0 == N1)</div><div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="DAGCombiner_8cpp.html#ae5856aabdc0d5eeaec3cf71f93c771a9">tryFoldToZero</a>(<a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), TLI, VT, DAG, LegalOperations, LegalTypes);</div><div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;  <span class="comment">// fold (sub c1, c2) -&gt; c1-c2</span></div><div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;  <span class="keywordflow">if</span> (N0C &amp;&amp; N1C)</div><div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a8503b91b7bbfb128a42fa582857f8828">FoldConstantArithmetic</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9fa617e5567c3c2638938f7b9ddc3f1c">ISD::SUB</a>, VT, N0C, N1C);</div><div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;  <span class="comment">// fold (sub x, c) -&gt; (add x, -c)</span></div><div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;  <span class="keywordflow">if</span> (N1C)</div><div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a269996b43a1f3e1d1f84a70fd4387535">ISD::ADD</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N0,</div><div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;                       DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(-N1C-&gt;getAPIntValue(), VT));</div><div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;  <span class="comment">// Canonicalize (sub -1, x) -&gt; ~x, i.e. (xor x, -1)</span></div><div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;  <span class="keywordflow">if</span> (N0C &amp;&amp; N0C-&gt;<a class="code" href="classllvm_1_1ConstantSDNode.html#aa5c86745e9f101eabafef104239b9677">isAllOnesValue</a>())</div><div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a92febb83e6ba116eb7aae8e7e3f70cc1">ISD::XOR</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N1, N0);</div><div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;  <span class="comment">// fold A-(A-B) -&gt; B</span></div><div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;  <span class="keywordflow">if</span> (N1.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9fa617e5567c3c2638938f7b9ddc3f1c">ISD::SUB</a> &amp;&amp; N0 == N1.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0))</div><div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;    <span class="keywordflow">return</span> N1.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1);</div><div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;  <span class="comment">// fold (A+B)-A -&gt; B</span></div><div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;  <span class="keywordflow">if</span> (N0.getOpcode() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a269996b43a1f3e1d1f84a70fd4387535">ISD::ADD</a> &amp;&amp; N0.getOperand(0) == N1)</div><div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;    <span class="keywordflow">return</span> N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1);</div><div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;  <span class="comment">// fold (A+B)-B -&gt; A</span></div><div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;  <span class="keywordflow">if</span> (N0.getOpcode() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a269996b43a1f3e1d1f84a70fd4387535">ISD::ADD</a> &amp;&amp; N0.getOperand(1) == N1)</div><div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;    <span class="keywordflow">return</span> N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0);</div><div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;  <span class="comment">// fold C2-(A+C1) -&gt; (C2-C1)-A</span></div><div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;  <span class="keywordflow">if</span> (N1.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a269996b43a1f3e1d1f84a70fd4387535">ISD::ADD</a> &amp;&amp; N0C &amp;&amp; N1C1) {</div><div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> NewC = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(N0C-&gt;<a class="code" href="classllvm_1_1ConstantSDNode.html#a7951626d3fc3c89c4efee59ed9c3d8bf">getAPIntValue</a>() - N1C1-&gt;getAPIntValue(),</div><div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;                                   VT);</div><div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9fa617e5567c3c2638938f7b9ddc3f1c">ISD::SUB</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, NewC,</div><div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;                       N1.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0));</div><div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;  }</div><div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;  <span class="comment">// fold ((A+(B+or-C))-B) -&gt; A+or-C</span></div><div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;  <span class="keywordflow">if</span> (N0.getOpcode() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a269996b43a1f3e1d1f84a70fd4387535">ISD::ADD</a> &amp;&amp;</div><div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;      (N0.getOperand(1).getOpcode() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9fa617e5567c3c2638938f7b9ddc3f1c">ISD::SUB</a> ||</div><div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;       N0.getOperand(1).getOpcode() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a269996b43a1f3e1d1f84a70fd4387535">ISD::ADD</a>) &amp;&amp;</div><div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;      N0.getOperand(1).getOperand(0) == N1)</div><div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(N0.getOperand(1).getOpcode(), <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT,</div><div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;                       N0.getOperand(0), N0.getOperand(1).getOperand(1));</div><div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;  <span class="comment">// fold ((A+(C+B))-B) -&gt; A+C</span></div><div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;  <span class="keywordflow">if</span> (N0.getOpcode() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a269996b43a1f3e1d1f84a70fd4387535">ISD::ADD</a> &amp;&amp;</div><div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;      N0.getOperand(1).getOpcode() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a269996b43a1f3e1d1f84a70fd4387535">ISD::ADD</a> &amp;&amp;</div><div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;      N0.getOperand(1).getOperand(1) == N1)</div><div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a269996b43a1f3e1d1f84a70fd4387535">ISD::ADD</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT,</div><div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;                       N0.getOperand(0), N0.getOperand(1).getOperand(0));</div><div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;  <span class="comment">// fold ((A-(B-C))-C) -&gt; A-B</span></div><div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;  <span class="keywordflow">if</span> (N0.getOpcode() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9fa617e5567c3c2638938f7b9ddc3f1c">ISD::SUB</a> &amp;&amp;</div><div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;      N0.getOperand(1).getOpcode() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9fa617e5567c3c2638938f7b9ddc3f1c">ISD::SUB</a> &amp;&amp;</div><div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;      N0.getOperand(1).getOperand(1) == N1)</div><div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9fa617e5567c3c2638938f7b9ddc3f1c">ISD::SUB</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT,</div><div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;                       N0.getOperand(0), N0.getOperand(1).getOperand(0));</div><div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;</div><div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;  <span class="comment">// If either operand of a sub is undef, the result is undef</span></div><div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;  <span class="keywordflow">if</span> (N0.getOpcode() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7c6d8f265e9e16e5debdb9a536b55d3d">ISD::UNDEF</a>)</div><div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;    <span class="keywordflow">return</span> N0;</div><div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;  <span class="keywordflow">if</span> (N1.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7c6d8f265e9e16e5debdb9a536b55d3d">ISD::UNDEF</a>)</div><div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;    <span class="keywordflow">return</span> N1;</div><div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;</div><div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;  <span class="comment">// If the relocation model supports it, consider symbol offsets.</span></div><div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1GlobalAddressSDNode.html">GlobalAddressSDNode</a> *GA = dyn_cast&lt;GlobalAddressSDNode&gt;(N0))</div><div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;    <span class="keywordflow">if</span> (!LegalOperations &amp;&amp; TLI.<a class="code" href="classllvm_1_1TargetLowering.html#a6634fc60337427fd6c33e851a4ff45ad">isOffsetFoldingLegal</a>(GA)) {</div><div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;      <span class="comment">// fold (sub Sym, c) -&gt; Sym-c</span></div><div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;      <span class="keywordflow">if</span> (N1C &amp;&amp; GA-&gt;getOpcode() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a30316f8f9985260c49d7c26bc70a6cad">ISD::GlobalAddress</a>)</div><div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;        <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a0ee11b567d80b84aafb68339dbb3923c">getGlobalAddress</a>(GA-&gt;getGlobal(), <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N1C), VT,</div><div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;                                    GA-&gt;getOffset() -</div><div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;                                      (uint64_t)N1C-&gt;getSExtValue());</div><div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;      <span class="comment">// fold (sub Sym+c1, Sym+c2) -&gt; c1-c2</span></div><div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1GlobalAddressSDNode.html">GlobalAddressSDNode</a> *GB = dyn_cast&lt;GlobalAddressSDNode&gt;(N1))</div><div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;        <span class="keywordflow">if</span> (GA-&gt;getGlobal() == GB-&gt;getGlobal())</div><div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;          <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>((uint64_t)GA-&gt;getOffset() - GB-&gt;getOffset(),</div><div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;                                 VT);</div><div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;    }</div><div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;</div><div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;}</div><div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;</div><div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::visitSUBC(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N) {</div><div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N0 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0);</div><div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N1 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(1);</div><div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;  <a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a> *N0C = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a>&gt;(N0);</div><div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;  <a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a> *N1C = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a>&gt;(N1);</div><div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> VT = N0.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>();</div><div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;</div><div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;  <span class="comment">// If the flag result is dead, turn this into an SUB.</span></div><div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;  <span class="keywordflow">if</span> (!N-&gt;<a class="code" href="classllvm_1_1SDNode.html#ae4cb676e77b9f238058c70faa609a5d7">hasAnyUseOfValue</a>(1))</div><div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;    <span class="keywordflow">return</span> CombineTo(N, DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9fa617e5567c3c2638938f7b9ddc3f1c">ISD::SUB</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N0, N1),</div><div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;                     DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110acc20c926003b2af97ba08689176e7130">ISD::CARRY_FALSE</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N),</div><div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;                                 <a class="code" href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50ca59a1908cf136662bcfdc11ed49515ca9">MVT::Glue</a>));</div><div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;</div><div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;  <span class="comment">// fold (subc x, x) -&gt; 0 + no borrow</span></div><div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;  <span class="keywordflow">if</span> (N0 == N1)</div><div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;    <span class="keywordflow">return</span> CombineTo(N, DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(0, VT),</div><div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;                     DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110acc20c926003b2af97ba08689176e7130">ISD::CARRY_FALSE</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N),</div><div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;                                 <a class="code" href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50ca59a1908cf136662bcfdc11ed49515ca9">MVT::Glue</a>));</div><div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;</div><div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;  <span class="comment">// fold (subc x, 0) -&gt; x + no borrow</span></div><div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;  <span class="keywordflow">if</span> (N1C &amp;&amp; N1C-&gt;isNullValue())</div><div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;    <span class="keywordflow">return</span> CombineTo(N, N0, DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110acc20c926003b2af97ba08689176e7130">ISD::CARRY_FALSE</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N),</div><div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;                                        <a class="code" href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50ca59a1908cf136662bcfdc11ed49515ca9">MVT::Glue</a>));</div><div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;</div><div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;  <span class="comment">// Canonicalize (sub -1, x) -&gt; ~x, i.e. (xor x, -1) + no borrow</span></div><div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;  <span class="keywordflow">if</span> (N0C &amp;&amp; N0C-&gt;<a class="code" href="classllvm_1_1ConstantSDNode.html#aa5c86745e9f101eabafef104239b9677">isAllOnesValue</a>())</div><div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;    <span class="keywordflow">return</span> CombineTo(N, DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a92febb83e6ba116eb7aae8e7e3f70cc1">ISD::XOR</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N1, N0),</div><div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;                     DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110acc20c926003b2af97ba08689176e7130">ISD::CARRY_FALSE</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N),</div><div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;                                 <a class="code" href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50ca59a1908cf136662bcfdc11ed49515ca9">MVT::Glue</a>));</div><div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;</div><div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;}</div><div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;</div><div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::visitSUBE(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N) {</div><div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N0 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0);</div><div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N1 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(1);</div><div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> CarryIn = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(2);</div><div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;</div><div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;  <span class="comment">// fold (sube x, y, false) -&gt; (subc x, y)</span></div><div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;  <span class="keywordflow">if</span> (CarryIn.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110acc20c926003b2af97ba08689176e7130">ISD::CARRY_FALSE</a>)</div><div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a2ab6db512a611d1ef4ff8069e2bbfd0d">ISD::SUBC</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a1aac28ffadab16f6cfbadfc2ddccd8a1">getVTList</a>(), N0, N1);</div><div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;</div><div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;}</div><div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;<span class="comment">/// isConstantSplatVector - Returns true if N is a BUILD_VECTOR node whose</span></div><div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;<span class="comment">/// elements are all the same constant or undefined.</span></div><div class="line"><a name="l01783"></a><span class="lineno"><a class="line" href="DAGCombiner_8cpp.html#a000e05d8e2f060e7854793e6e9a52190"> 1783</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="DAGCombiner_8cpp.html#a000e05d8e2f060e7854793e6e9a52190">isConstantSplatVector</a>(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N, <a class="code" href="classllvm_1_1APInt.html">APInt</a>&amp; SplatValue) {</div><div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;  <a class="code" href="classllvm_1_1BuildVectorSDNode.html">BuildVectorSDNode</a> *<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1BuildVectorSDNode.html">BuildVectorSDNode</a>&gt;(<a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>);</div><div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;  <span class="keywordflow">if</span> (!C)</div><div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;</div><div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;  <a class="code" href="classllvm_1_1APInt.html">APInt</a> SplatUndef;</div><div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;  <span class="keywordtype">unsigned</span> SplatBitSize;</div><div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;  <span class="keywordtype">bool</span> HasAnyUndefs;</div><div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> EltVT = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(0).<a class="code" href="structllvm_1_1EVT.html#a3a07c062cc9330acd8e8c4e3930cbb25">getVectorElementType</a>();</div><div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;  <span class="keywordflow">return</span> (C-&gt;<a class="code" href="classllvm_1_1BuildVectorSDNode.html#a0d1aedc8b57ec58e82db037ccb38c2a2">isConstantSplat</a>(SplatValue, SplatUndef, SplatBitSize,</div><div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;                             HasAnyUndefs) &amp;&amp;</div><div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;          EltVT.<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>() &gt;= SplatBitSize);</div><div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;}</div><div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;</div><div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::visitMUL(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N) {</div><div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N0 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0);</div><div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N1 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(1);</div><div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> VT = N0.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>();</div><div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;</div><div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;  <span class="comment">// fold (mul x, undef) -&gt; 0</span></div><div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;  <span class="keywordflow">if</span> (N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7c6d8f265e9e16e5debdb9a536b55d3d">ISD::UNDEF</a> || N1.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7c6d8f265e9e16e5debdb9a536b55d3d">ISD::UNDEF</a>)</div><div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(0, VT);</div><div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;</div><div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;  <span class="keywordtype">bool</span> N0IsConst = <span class="keyword">false</span>;</div><div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;  <span class="keywordtype">bool</span> N1IsConst = <span class="keyword">false</span>;</div><div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;  <a class="code" href="classllvm_1_1APInt.html">APInt</a> ConstValue0, ConstValue1;</div><div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;  <span class="comment">// fold vector ops</span></div><div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;  <span class="keywordflow">if</span> (VT.<a class="code" href="structllvm_1_1EVT.html#a73f7c824cad61a47c21bf6d652ae2fd7">isVector</a>()) {</div><div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> FoldedVOp = SimplifyVBinOp(N);</div><div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;    <span class="keywordflow">if</span> (FoldedVOp.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()) <span class="keywordflow">return</span> FoldedVOp;</div><div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;</div><div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;    N0IsConst = <a class="code" href="DAGCombiner_8cpp.html#a000e05d8e2f060e7854793e6e9a52190">isConstantSplatVector</a>(N0.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>(), ConstValue0);</div><div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;    N1IsConst = <a class="code" href="DAGCombiner_8cpp.html#a000e05d8e2f060e7854793e6e9a52190">isConstantSplatVector</a>(N1.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>(), ConstValue1);</div><div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;    N0IsConst = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a>&gt;(N0) != 0;</div><div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;    ConstValue0 = N0IsConst ? (<a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a>&gt;(N0))-&gt;getAPIntValue()</div><div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;                            : <a class="code" href="classllvm_1_1APInt.html">APInt</a>();</div><div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;    N1IsConst = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a>&gt;(N1) != 0;</div><div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;    ConstValue1 = N1IsConst ? (<a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a>&gt;(N1))-&gt;getAPIntValue()</div><div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;                            : <a class="code" href="classllvm_1_1APInt.html">APInt</a>();</div><div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;  }</div><div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;</div><div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;  <span class="comment">// fold (mul c1, c2) -&gt; c1*c2</span></div><div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;  <span class="keywordflow">if</span> (N0IsConst &amp;&amp; N1IsConst)</div><div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a8503b91b7bbfb128a42fa582857f8828">FoldConstantArithmetic</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ad8aec9273962cf78d087090c11a1dd1c">ISD::MUL</a>, VT, N0.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>(), N1.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;</div><div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;  <span class="comment">// canonicalize constant to RHS</span></div><div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;  <span class="keywordflow">if</span> (N0IsConst &amp;&amp; !N1IsConst)</div><div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ad8aec9273962cf78d087090c11a1dd1c">ISD::MUL</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N1, N0);</div><div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;  <span class="comment">// fold (mul x, 0) -&gt; 0</span></div><div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;  <span class="keywordflow">if</span> (N1IsConst &amp;&amp; ConstValue1 == 0)</div><div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;    <span class="keywordflow">return</span> N1;</div><div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;  <span class="comment">// We require a splat of the entire scalar bit width for non-contiguous</span></div><div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;  <span class="comment">// bit patterns.</span></div><div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;  <span class="keywordtype">bool</span> IsFullSplat =</div><div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;    ConstValue1.<a class="code" href="classllvm_1_1APInt.html#ad081689e23a8f5dea78dedd623d6a8f8">getBitWidth</a>() == VT.<a class="code" href="structllvm_1_1EVT.html#a15be9767d0aad93fe5dcb60b7b7a78da">getScalarType</a>().<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>();</div><div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;  <span class="comment">// fold (mul x, 1) -&gt; x</span></div><div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;  <span class="keywordflow">if</span> (N1IsConst &amp;&amp; ConstValue1 == 1 &amp;&amp; IsFullSplat)</div><div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;    <span class="keywordflow">return</span> N0;</div><div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;  <span class="comment">// fold (mul x, -1) -&gt; 0-x</span></div><div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;  <span class="keywordflow">if</span> (N1IsConst &amp;&amp; ConstValue1.<a class="code" href="classllvm_1_1APInt.html#a21260f8037e665d235ace5718cf68bc4">isAllOnesValue</a>())</div><div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9fa617e5567c3c2638938f7b9ddc3f1c">ISD::SUB</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT,</div><div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;                       DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(0, VT), N0);</div><div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;  <span class="comment">// fold (mul x, (1 &lt;&lt; c)) -&gt; x &lt;&lt; c</span></div><div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;  <span class="keywordflow">if</span> (N1IsConst &amp;&amp; ConstValue1.<a class="code" href="classllvm_1_1APInt.html#af3deb6522c4fe2043fe07af2ec90190c">isPowerOf2</a>() &amp;&amp; IsFullSplat)</div><div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a8cc94e03dea594863073a02f5bb94997">ISD::SHL</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N0,</div><div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;                       DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(ConstValue1.<a class="code" href="classllvm_1_1APInt.html#a474f562a4871689af74b0fd1ae42daa1">logBase2</a>(),</div><div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;                                       getShiftAmountTy(N0.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>())));</div><div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;  <span class="comment">// fold (mul x, -(1 &lt;&lt; c)) -&gt; -(x &lt;&lt; c) or (-x) &lt;&lt; c</span></div><div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;  <span class="keywordflow">if</span> (N1IsConst &amp;&amp; (-ConstValue1).isPowerOf2() &amp;&amp; IsFullSplat) {</div><div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;    <span class="keywordtype">unsigned</span> Log2Val = (-ConstValue1).<a class="code" href="namespacellvm_1_1APIntOps.html#a4a8fe7a278424a14cecbea8b3cbaef5d">logBase2</a>();</div><div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;    <span class="comment">// FIXME: If the input is something that is easily negated (e.g. a</span></div><div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;    <span class="comment">// single-use add), we should put the negate there.</span></div><div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9fa617e5567c3c2638938f7b9ddc3f1c">ISD::SUB</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT,</div><div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;                       DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(0, VT),</div><div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;                       DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a8cc94e03dea594863073a02f5bb94997">ISD::SHL</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N0,</div><div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;                            DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(Log2Val,</div><div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;                                      getShiftAmountTy(N0.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>()))));</div><div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;  }</div><div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;</div><div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;  <a class="code" href="classllvm_1_1APInt.html">APInt</a> Val;</div><div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;  <span class="comment">// (mul (shl X, c1), c2) -&gt; (mul X, c2 &lt;&lt; c1)</span></div><div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;  <span class="keywordflow">if</span> (N1IsConst &amp;&amp; N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a8cc94e03dea594863073a02f5bb94997">ISD::SHL</a> &amp;&amp;</div><div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;      (<a class="code" href="DAGCombiner_8cpp.html#a000e05d8e2f060e7854793e6e9a52190">isConstantSplatVector</a>(N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1).<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>(), Val) ||</div><div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;                     isa&lt;ConstantSDNode&gt;(N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1)))) {</div><div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> C3 = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a8cc94e03dea594863073a02f5bb94997">ISD::SHL</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT,</div><div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;                             N1, N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1));</div><div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;    AddToWorkList(C3.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ad8aec9273962cf78d087090c11a1dd1c">ISD::MUL</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT,</div><div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;                       N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0), C3);</div><div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;  }</div><div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;</div><div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;  <span class="comment">// Change (mul (shl X, C), Y) -&gt; (shl (mul X, Y), C) when the shift has one</span></div><div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;  <span class="comment">// use.</span></div><div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;  {</div><div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Sh(0,0), <a class="code" href="OcamlGCPrinter_8cpp.html#a1bdbcdc4205781eefd549946d40ff378">Y</a>(0,0);</div><div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;    <span class="comment">// Check for both (mul (shl X, C), Y)  and  (mul Y, (shl X, C)).</span></div><div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;    <span class="keywordflow">if</span> (N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a8cc94e03dea594863073a02f5bb94997">ISD::SHL</a> &amp;&amp;</div><div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;        (<a class="code" href="DAGCombiner_8cpp.html#a000e05d8e2f060e7854793e6e9a52190">isConstantSplatVector</a>(N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1).<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>(), Val) ||</div><div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;                       isa&lt;ConstantSDNode&gt;(N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1))) &amp;&amp;</div><div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;        N0.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()-&gt;<a class="code" href="classllvm_1_1SDNode.html#a52753947fce3a01b1c18dd4713c587e8">hasOneUse</a>()) {</div><div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;      Sh = N0; Y = N1;</div><div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (N1.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a8cc94e03dea594863073a02f5bb94997">ISD::SHL</a> &amp;&amp;</div><div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;               isa&lt;ConstantSDNode&gt;(N1.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1)) &amp;&amp;</div><div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;               N1.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()-&gt;<a class="code" href="classllvm_1_1SDNode.html#a52753947fce3a01b1c18dd4713c587e8">hasOneUse</a>()) {</div><div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;      Sh = N1; Y = N0;</div><div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;    }</div><div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;</div><div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;    <span class="keywordflow">if</span> (Sh.getNode()) {</div><div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Mul = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ad8aec9273962cf78d087090c11a1dd1c">ISD::MUL</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT,</div><div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;                                Sh.getOperand(0), <a class="code" href="OcamlGCPrinter_8cpp.html#a1bdbcdc4205781eefd549946d40ff378">Y</a>);</div><div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a8cc94e03dea594863073a02f5bb94997">ISD::SHL</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT,</div><div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;                         Mul, Sh.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1));</div><div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;    }</div><div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;  }</div><div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;</div><div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;  <span class="comment">// fold (mul (add x, c1), c2) -&gt; (add (mul x, c2), c1*c2)</span></div><div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;  <span class="keywordflow">if</span> (N1IsConst &amp;&amp; N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a269996b43a1f3e1d1f84a70fd4387535">ISD::ADD</a> &amp;&amp; N0.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()-&gt;<a class="code" href="classllvm_1_1SDNode.html#a52753947fce3a01b1c18dd4713c587e8">hasOneUse</a>() &amp;&amp;</div><div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;      (<a class="code" href="DAGCombiner_8cpp.html#a000e05d8e2f060e7854793e6e9a52190">isConstantSplatVector</a>(N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1).<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>(), Val) ||</div><div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;                     isa&lt;ConstantSDNode&gt;(N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1))))</div><div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a269996b43a1f3e1d1f84a70fd4387535">ISD::ADD</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT,</div><div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;                       DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ad8aec9273962cf78d087090c11a1dd1c">ISD::MUL</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N0), VT,</div><div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;                                   N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0), N1),</div><div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;                       DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ad8aec9273962cf78d087090c11a1dd1c">ISD::MUL</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N1), VT,</div><div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;                                   N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1), N1));</div><div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;</div><div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;  <span class="comment">// reassociate mul</span></div><div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> RMUL = ReassociateOps(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ad8aec9273962cf78d087090c11a1dd1c">ISD::MUL</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), N0, N1);</div><div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;  <span class="keywordflow">if</span> (RMUL.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>() != 0)</div><div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;    <span class="keywordflow">return</span> RMUL;</div><div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;</div><div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;}</div><div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;</div><div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::visitSDIV(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N) {</div><div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N0 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0);</div><div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N1 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(1);</div><div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;  <a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a> *N0C = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a>&gt;(N0.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;  <a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a> *N1C = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a>&gt;(N1.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> VT = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(0);</div><div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;</div><div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;  <span class="comment">// fold vector ops</span></div><div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;  <span class="keywordflow">if</span> (VT.isVector()) {</div><div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> FoldedVOp = SimplifyVBinOp(N);</div><div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;    <span class="keywordflow">if</span> (FoldedVOp.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()) <span class="keywordflow">return</span> FoldedVOp;</div><div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;  }</div><div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;</div><div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;  <span class="comment">// fold (sdiv c1, c2) -&gt; c1/c2</span></div><div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;  <span class="keywordflow">if</span> (N0C &amp;&amp; N1C &amp;&amp; !N1C-&gt;<a class="code" href="classllvm_1_1ConstantSDNode.html#a702de70a3d9e57c3ffe65bc3fab3e087">isNullValue</a>())</div><div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a8503b91b7bbfb128a42fa582857f8828">FoldConstantArithmetic</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a1f61c2422057e10403b2f6003543c300">ISD::SDIV</a>, VT, N0C, N1C);</div><div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;  <span class="comment">// fold (sdiv X, 1) -&gt; X</span></div><div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;  <span class="keywordflow">if</span> (N1C &amp;&amp; N1C-&gt;getAPIntValue() == 1LL)</div><div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;    <span class="keywordflow">return</span> N0;</div><div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;  <span class="comment">// fold (sdiv X, -1) -&gt; 0-X</span></div><div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;  <span class="keywordflow">if</span> (N1C &amp;&amp; N1C-&gt;isAllOnesValue())</div><div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9fa617e5567c3c2638938f7b9ddc3f1c">ISD::SUB</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT,</div><div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;                       DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(0, VT), N0);</div><div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;  <span class="comment">// If we know the sign bits of both operands are zero, strength reduce to a</span></div><div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;  <span class="comment">// udiv instead.  Handles (X&amp;15) /s 4 -&gt; X&amp;15 &gt;&gt; 2</span></div><div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;  <span class="keywordflow">if</span> (!VT.isVector()) {</div><div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;    <span class="keywordflow">if</span> (DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af52a1ca20308888443767831a21352ca">SignBitIsZero</a>(N1) &amp;&amp; DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af52a1ca20308888443767831a21352ca">SignBitIsZero</a>(N0))</div><div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a15637879021fa7d5226045c0668a99a8">ISD::UDIV</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), N1.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>(),</div><div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;                         N0, N1);</div><div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;  }</div><div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;  <span class="comment">// fold (sdiv X, pow2) -&gt; simple ops after legalize</span></div><div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;  <span class="keywordflow">if</span> (N1C &amp;&amp; !N1C-&gt;isNullValue() &amp;&amp;</div><div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;      (N1C-&gt;getAPIntValue().isPowerOf2() ||</div><div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;       (-N1C-&gt;getAPIntValue()).isPowerOf2())) {</div><div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;    <span class="comment">// If dividing by powers of two is cheap, then don&#39;t perform the following</span></div><div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;    <span class="comment">// fold.</span></div><div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;    <span class="keywordflow">if</span> (TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#ab119bc60a5d16c72edff3e7c21f05278">isPow2DivCheap</a>())</div><div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;</div><div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;    <span class="keywordtype">unsigned</span> lg2 = N1C-&gt;getAPIntValue().countTrailingZeros();</div><div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;</div><div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;    <span class="comment">// Splat the sign bit into the register</span></div><div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> SGN = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a4a055321c361a0f6ee77ed764730ffc1">ISD::SRA</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N0,</div><div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;                              DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(VT.getSizeInBits()-1,</div><div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;                                       getShiftAmountTy(N0.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>())));</div><div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;    AddToWorkList(SGN.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;</div><div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;    <span class="comment">// Add (N0 &lt; 0) ? abs2 - 1 : 0;</span></div><div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a3c6553c8acebe1b57c211ee45e2d8f98">SRL</a> = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a3c6553c8acebe1b57c211ee45e2d8f98">ISD::SRL</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, SGN,</div><div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;                              DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(VT.getSizeInBits() - lg2,</div><div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;                                       getShiftAmountTy(SGN.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>())));</div><div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> <a class="code" href="X86ISelDAGToDAG_8cpp.html#afc4e10b4f2ab2d548ab80b30f3b712e9acfcf145f2788bf340ff3f3098bc54909">ADD</a> = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a269996b43a1f3e1d1f84a70fd4387535">ISD::ADD</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N0, SRL);</div><div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;    AddToWorkList(SRL.getNode());</div><div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;    AddToWorkList(ADD.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());    <span class="comment">// Divide by pow2</span></div><div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a4a055321c361a0f6ee77ed764730ffc1">SRA</a> = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a4a055321c361a0f6ee77ed764730ffc1">ISD::SRA</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, ADD,</div><div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;                  DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(lg2, getShiftAmountTy(ADD.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>())));</div><div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;</div><div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;    <span class="comment">// If we&#39;re dividing by a positive value, we&#39;re done.  Otherwise, we must</span></div><div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;    <span class="comment">// negate the result.</span></div><div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;    <span class="keywordflow">if</span> (N1C-&gt;getAPIntValue().isNonNegative())</div><div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;      <span class="keywordflow">return</span> SRA;</div><div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;</div><div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;    AddToWorkList(SRA.getNode());</div><div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9fa617e5567c3c2638938f7b9ddc3f1c">ISD::SUB</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT,</div><div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;                       DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(0, VT), <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a4a055321c361a0f6ee77ed764730ffc1">SRA</a>);</div><div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;  }</div><div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;</div><div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;  <span class="comment">// if integer divide is expensive and we satisfy the requirements, emit an</span></div><div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;  <span class="comment">// alternate sequence.</span></div><div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;  <span class="keywordflow">if</span> (N1C &amp;&amp; !N1C-&gt;isNullValue() &amp;&amp; !TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#adb45e7ad0a527824d12e1705864e577e">isIntDivCheap</a>()) {</div><div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Op = BuildSDIV(N);</div><div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;    <span class="keywordflow">if</span> (Op.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()) <span class="keywordflow">return</span> Op;</div><div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;  }</div><div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;</div><div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;  <span class="comment">// undef / X -&gt; 0</span></div><div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;  <span class="keywordflow">if</span> (N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7c6d8f265e9e16e5debdb9a536b55d3d">ISD::UNDEF</a>)</div><div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(0, VT);</div><div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;  <span class="comment">// X / undef -&gt; undef</span></div><div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;  <span class="keywordflow">if</span> (N1.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7c6d8f265e9e16e5debdb9a536b55d3d">ISD::UNDEF</a>)</div><div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;    <span class="keywordflow">return</span> N1;</div><div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;</div><div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;}</div><div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;</div><div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::visitUDIV(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N) {</div><div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N0 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0);</div><div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N1 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(1);</div><div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;  <a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a> *N0C = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a>&gt;(N0.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;  <a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a> *N1C = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a>&gt;(N1.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> VT = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(0);</div><div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;</div><div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;  <span class="comment">// fold vector ops</span></div><div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;  <span class="keywordflow">if</span> (VT.isVector()) {</div><div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> FoldedVOp = SimplifyVBinOp(N);</div><div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;    <span class="keywordflow">if</span> (FoldedVOp.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()) <span class="keywordflow">return</span> FoldedVOp;</div><div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;  }</div><div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;</div><div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;  <span class="comment">// fold (udiv c1, c2) -&gt; c1/c2</span></div><div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;  <span class="keywordflow">if</span> (N0C &amp;&amp; N1C &amp;&amp; !N1C-&gt;<a class="code" href="classllvm_1_1ConstantSDNode.html#a702de70a3d9e57c3ffe65bc3fab3e087">isNullValue</a>())</div><div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a8503b91b7bbfb128a42fa582857f8828">FoldConstantArithmetic</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a15637879021fa7d5226045c0668a99a8">ISD::UDIV</a>, VT, N0C, N1C);</div><div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;  <span class="comment">// fold (udiv x, (1 &lt;&lt; c)) -&gt; x &gt;&gt;u c</span></div><div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;  <span class="keywordflow">if</span> (N1C &amp;&amp; N1C-&gt;getAPIntValue().isPowerOf2())</div><div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a3c6553c8acebe1b57c211ee45e2d8f98">ISD::SRL</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N0,</div><div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;                       DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(N1C-&gt;getAPIntValue().logBase2(),</div><div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;                                       getShiftAmountTy(N0.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>())));</div><div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;  <span class="comment">// fold (udiv x, (shl c, y)) -&gt; x &gt;&gt;u (log2(c)+y) iff c is power of 2</span></div><div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;  <span class="keywordflow">if</span> (N1.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a8cc94e03dea594863073a02f5bb94997">ISD::SHL</a>) {</div><div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a> *SHC = dyn_cast&lt;ConstantSDNode&gt;(N1.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0))) {</div><div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;      <span class="keywordflow">if</span> (SHC-&gt;getAPIntValue().isPowerOf2()) {</div><div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;        <a class="code" href="structllvm_1_1EVT.html">EVT</a> ADDVT = N1.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1).<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>();</div><div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;        <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Add = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a269996b43a1f3e1d1f84a70fd4387535">ISD::ADD</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), ADDVT,</div><div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;                                  N1.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1),</div><div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;                                  DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(SHC-&gt;getAPIntValue()</div><div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;                                                                  .logBase2(),</div><div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;                                                  ADDVT));</div><div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;        AddToWorkList(Add.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;        <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a3c6553c8acebe1b57c211ee45e2d8f98">ISD::SRL</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N0, Add);</div><div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;      }</div><div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;    }</div><div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;  }</div><div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;  <span class="comment">// fold (udiv x, c) -&gt; alternate</span></div><div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;  <span class="keywordflow">if</span> (N1C &amp;&amp; !N1C-&gt;isNullValue() &amp;&amp; !TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#adb45e7ad0a527824d12e1705864e577e">isIntDivCheap</a>()) {</div><div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Op = BuildUDIV(N);</div><div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;    <span class="keywordflow">if</span> (Op.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()) <span class="keywordflow">return</span> Op;</div><div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;  }</div><div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;</div><div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;  <span class="comment">// undef / X -&gt; 0</span></div><div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;  <span class="keywordflow">if</span> (N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7c6d8f265e9e16e5debdb9a536b55d3d">ISD::UNDEF</a>)</div><div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(0, VT);</div><div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;  <span class="comment">// X / undef -&gt; undef</span></div><div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;  <span class="keywordflow">if</span> (N1.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7c6d8f265e9e16e5debdb9a536b55d3d">ISD::UNDEF</a>)</div><div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;    <span class="keywordflow">return</span> N1;</div><div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;</div><div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;}</div><div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;</div><div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::visitSREM(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N) {</div><div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N0 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0);</div><div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N1 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(1);</div><div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;  <a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a> *N0C = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a>&gt;(N0);</div><div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;  <a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a> *N1C = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a>&gt;(N1);</div><div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> VT = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(0);</div><div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;</div><div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;  <span class="comment">// fold (srem c1, c2) -&gt; c1%c2</span></div><div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;  <span class="keywordflow">if</span> (N0C &amp;&amp; N1C &amp;&amp; !N1C-&gt;<a class="code" href="classllvm_1_1ConstantSDNode.html#a702de70a3d9e57c3ffe65bc3fab3e087">isNullValue</a>())</div><div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a8503b91b7bbfb128a42fa582857f8828">FoldConstantArithmetic</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a124ba0f5b2887879212c74a68bc230a3">ISD::SREM</a>, VT, N0C, N1C);</div><div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;  <span class="comment">// If we know the sign bits of both operands are zero, strength reduce to a</span></div><div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;  <span class="comment">// urem instead.  Handles (X &amp; 0x0FFFFFFF) %s 16 -&gt; X&amp;15</span></div><div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;  <span class="keywordflow">if</span> (!VT.isVector()) {</div><div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;    <span class="keywordflow">if</span> (DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af52a1ca20308888443767831a21352ca">SignBitIsZero</a>(N1) &amp;&amp; DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af52a1ca20308888443767831a21352ca">SignBitIsZero</a>(N0))</div><div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ad1657dbc1957901a6d9cd224efbc0f28">ISD::UREM</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N0, N1);</div><div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;  }</div><div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;</div><div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;  <span class="comment">// If X/C can be simplified by the division-by-constant logic, lower</span></div><div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;  <span class="comment">// X%C to the equivalent of X-X/C*C.</span></div><div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;  <span class="keywordflow">if</span> (N1C &amp;&amp; !N1C-&gt;isNullValue()) {</div><div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Div = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a1f61c2422057e10403b2f6003543c300">ISD::SDIV</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N0, N1);</div><div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;    AddToWorkList(Div.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> OptimizedDiv = combine(Div.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;    <span class="keywordflow">if</span> (OptimizedDiv.getNode() &amp;&amp; OptimizedDiv.getNode() != Div.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()) {</div><div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Mul = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ad8aec9273962cf78d087090c11a1dd1c">ISD::MUL</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT,</div><div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;                                OptimizedDiv, N1);</div><div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Sub = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9fa617e5567c3c2638938f7b9ddc3f1c">ISD::SUB</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N0, Mul);</div><div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;      AddToWorkList(Mul.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;      <span class="keywordflow">return</span> Sub;</div><div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;    }</div><div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;  }</div><div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;</div><div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;  <span class="comment">// undef % X -&gt; 0</span></div><div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;  <span class="keywordflow">if</span> (N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7c6d8f265e9e16e5debdb9a536b55d3d">ISD::UNDEF</a>)</div><div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(0, VT);</div><div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;  <span class="comment">// X % undef -&gt; undef</span></div><div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;  <span class="keywordflow">if</span> (N1.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7c6d8f265e9e16e5debdb9a536b55d3d">ISD::UNDEF</a>)</div><div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;    <span class="keywordflow">return</span> N1;</div><div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;</div><div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;}</div><div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;</div><div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::visitUREM(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N) {</div><div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N0 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0);</div><div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N1 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(1);</div><div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;  <a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a> *N0C = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a>&gt;(N0);</div><div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;  <a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a> *N1C = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a>&gt;(N1);</div><div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> VT = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(0);</div><div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;</div><div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;  <span class="comment">// fold (urem c1, c2) -&gt; c1%c2</span></div><div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;  <span class="keywordflow">if</span> (N0C &amp;&amp; N1C &amp;&amp; !N1C-&gt;<a class="code" href="classllvm_1_1ConstantSDNode.html#a702de70a3d9e57c3ffe65bc3fab3e087">isNullValue</a>())</div><div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a8503b91b7bbfb128a42fa582857f8828">FoldConstantArithmetic</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ad1657dbc1957901a6d9cd224efbc0f28">ISD::UREM</a>, VT, N0C, N1C);</div><div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;  <span class="comment">// fold (urem x, pow2) -&gt; (and x, pow2-1)</span></div><div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;  <span class="keywordflow">if</span> (N1C &amp;&amp; !N1C-&gt;isNullValue() &amp;&amp; N1C-&gt;getAPIntValue().isPowerOf2())</div><div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ac513a7da1bf74fb3e3c594da8534f2d2">ISD::AND</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N0,</div><div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;                       DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(N1C-&gt;getAPIntValue()-1,VT));</div><div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;  <span class="comment">// fold (urem x, (shl pow2, y)) -&gt; (and x, (add (shl pow2, y), -1))</span></div><div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;  <span class="keywordflow">if</span> (N1.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a8cc94e03dea594863073a02f5bb94997">ISD::SHL</a>) {</div><div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a> *SHC = dyn_cast&lt;ConstantSDNode&gt;(N1.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0))) {</div><div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;      <span class="keywordflow">if</span> (SHC-&gt;getAPIntValue().isPowerOf2()) {</div><div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;        <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Add =</div><div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;          DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a269996b43a1f3e1d1f84a70fd4387535">ISD::ADD</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N1,</div><div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;                 DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(<a class="code" href="classllvm_1_1APInt.html#a539bdb4fdbf46e0bfcefebf5ac6d21dd">APInt::getAllOnesValue</a>(VT.getSizeInBits()),</div><div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;                                 VT));</div><div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;        AddToWorkList(Add.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;        <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ac513a7da1bf74fb3e3c594da8534f2d2">ISD::AND</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N0, Add);</div><div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;      }</div><div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;    }</div><div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;  }</div><div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;</div><div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;  <span class="comment">// If X/C can be simplified by the division-by-constant logic, lower</span></div><div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;  <span class="comment">// X%C to the equivalent of X-X/C*C.</span></div><div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;  <span class="keywordflow">if</span> (N1C &amp;&amp; !N1C-&gt;isNullValue()) {</div><div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Div = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a15637879021fa7d5226045c0668a99a8">ISD::UDIV</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N0, N1);</div><div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;    AddToWorkList(Div.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> OptimizedDiv = combine(Div.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;    <span class="keywordflow">if</span> (OptimizedDiv.getNode() &amp;&amp; OptimizedDiv.getNode() != Div.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()) {</div><div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Mul = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ad8aec9273962cf78d087090c11a1dd1c">ISD::MUL</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT,</div><div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;                                OptimizedDiv, N1);</div><div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Sub = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9fa617e5567c3c2638938f7b9ddc3f1c">ISD::SUB</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N0, Mul);</div><div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;      AddToWorkList(Mul.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;      <span class="keywordflow">return</span> Sub;</div><div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;    }</div><div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;  }</div><div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;</div><div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;  <span class="comment">// undef % X -&gt; 0</span></div><div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;  <span class="keywordflow">if</span> (N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7c6d8f265e9e16e5debdb9a536b55d3d">ISD::UNDEF</a>)</div><div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(0, VT);</div><div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;  <span class="comment">// X % undef -&gt; undef</span></div><div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;  <span class="keywordflow">if</span> (N1.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7c6d8f265e9e16e5debdb9a536b55d3d">ISD::UNDEF</a>)</div><div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;    <span class="keywordflow">return</span> N1;</div><div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;</div><div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;}</div><div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;</div><div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::visitMULHS(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N) {</div><div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N0 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0);</div><div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N1 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(1);</div><div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;  <a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a> *N1C = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a>&gt;(N1);</div><div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> VT = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(0);</div><div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;  <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a> DL(N);</div><div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;</div><div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;  <span class="comment">// fold (mulhs x, 0) -&gt; 0</span></div><div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;  <span class="keywordflow">if</span> (N1C &amp;&amp; N1C-&gt;<a class="code" href="classllvm_1_1ConstantSDNode.html#a702de70a3d9e57c3ffe65bc3fab3e087">isNullValue</a>())</div><div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;    <span class="keywordflow">return</span> N1;</div><div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;  <span class="comment">// fold (mulhs x, 1) -&gt; (sra x, size(x)-1)</span></div><div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;  <span class="keywordflow">if</span> (N1C &amp;&amp; N1C-&gt;<a class="code" href="classllvm_1_1ConstantSDNode.html#a7951626d3fc3c89c4efee59ed9c3d8bf">getAPIntValue</a>() == 1)</div><div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a4a055321c361a0f6ee77ed764730ffc1">ISD::SRA</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), N0.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>(), N0,</div><div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;                       DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(N0.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>().<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>() - 1,</div><div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;                                       getShiftAmountTy(N0.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>())));</div><div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;  <span class="comment">// fold (mulhs x, undef) -&gt; 0</span></div><div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;  <span class="keywordflow">if</span> (N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7c6d8f265e9e16e5debdb9a536b55d3d">ISD::UNDEF</a> || N1.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7c6d8f265e9e16e5debdb9a536b55d3d">ISD::UNDEF</a>)</div><div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(0, VT);</div><div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;</div><div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;  <span class="comment">// If the type twice as wide is legal, transform the mulhs to a wider multiply</span></div><div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;  <span class="comment">// plus a shift.</span></div><div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;  <span class="keywordflow">if</span> (VT.isSimple() &amp;&amp; !VT.isVector()) {</div><div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;    <a class="code" href="classllvm_1_1MVT.html">MVT</a> Simple = VT.getSimpleVT();</div><div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;    <span class="keywordtype">unsigned</span> SimpleSize = Simple.<a class="code" href="classllvm_1_1MVT.html#a423166b2b5d1010162dde0003e5ad09c">getSizeInBits</a>();</div><div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;    <a class="code" href="structllvm_1_1EVT.html">EVT</a> NewVT = <a class="code" href="structllvm_1_1EVT.html#a752372e170e4e7c595bf8810bb52adf2">EVT::getIntegerVT</a>(*DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a39c6dff47b8dbd25cfaf6336c7056077">getContext</a>(), SimpleSize*2);</div><div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;    <span class="keywordflow">if</span> (TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a055b3905dbbc16fae11510b9ebd1e00c">isOperationLegal</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ad8aec9273962cf78d087090c11a1dd1c">ISD::MUL</a>, NewVT)) {</div><div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;      N0 = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a5183f3d72924bc7c77ba8d3f5de9f602">ISD::SIGN_EXTEND</a>, DL, NewVT, N0);</div><div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;      N1 = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a5183f3d72924bc7c77ba8d3f5de9f602">ISD::SIGN_EXTEND</a>, DL, NewVT, N1);</div><div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;      N1 = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ad8aec9273962cf78d087090c11a1dd1c">ISD::MUL</a>, DL, NewVT, N0, N1);</div><div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;      N1 = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a3c6553c8acebe1b57c211ee45e2d8f98">ISD::SRL</a>, DL, NewVT, N1,</div><div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;            DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(SimpleSize, getShiftAmountTy(N1.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>())));</div><div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ae690127648393001a7d5b93dc23da7b3">ISD::TRUNCATE</a>, DL, VT, N1);</div><div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;    }</div><div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;  }</div><div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;</div><div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;}</div><div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;</div><div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::visitMULHU(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N) {</div><div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N0 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0);</div><div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N1 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(1);</div><div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;  <a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a> *N1C = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a>&gt;(N1);</div><div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> VT = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(0);</div><div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;  <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a> DL(N);</div><div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;</div><div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;  <span class="comment">// fold (mulhu x, 0) -&gt; 0</span></div><div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;  <span class="keywordflow">if</span> (N1C &amp;&amp; N1C-&gt;<a class="code" href="classllvm_1_1ConstantSDNode.html#a702de70a3d9e57c3ffe65bc3fab3e087">isNullValue</a>())</div><div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;    <span class="keywordflow">return</span> N1;</div><div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;  <span class="comment">// fold (mulhu x, 1) -&gt; 0</span></div><div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;  <span class="keywordflow">if</span> (N1C &amp;&amp; N1C-&gt;<a class="code" href="classllvm_1_1ConstantSDNode.html#a7951626d3fc3c89c4efee59ed9c3d8bf">getAPIntValue</a>() == 1)</div><div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(0, N0.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>());</div><div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;  <span class="comment">// fold (mulhu x, undef) -&gt; 0</span></div><div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;  <span class="keywordflow">if</span> (N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7c6d8f265e9e16e5debdb9a536b55d3d">ISD::UNDEF</a> || N1.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7c6d8f265e9e16e5debdb9a536b55d3d">ISD::UNDEF</a>)</div><div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(0, VT);</div><div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;</div><div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;  <span class="comment">// If the type twice as wide is legal, transform the mulhu to a wider multiply</span></div><div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;  <span class="comment">// plus a shift.</span></div><div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;  <span class="keywordflow">if</span> (VT.isSimple() &amp;&amp; !VT.isVector()) {</div><div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;    <a class="code" href="classllvm_1_1MVT.html">MVT</a> Simple = VT.getSimpleVT();</div><div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;    <span class="keywordtype">unsigned</span> SimpleSize = Simple.<a class="code" href="classllvm_1_1MVT.html#a423166b2b5d1010162dde0003e5ad09c">getSizeInBits</a>();</div><div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;    <a class="code" href="structllvm_1_1EVT.html">EVT</a> NewVT = <a class="code" href="structllvm_1_1EVT.html#a752372e170e4e7c595bf8810bb52adf2">EVT::getIntegerVT</a>(*DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a39c6dff47b8dbd25cfaf6336c7056077">getContext</a>(), SimpleSize*2);</div><div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;    <span class="keywordflow">if</span> (TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a055b3905dbbc16fae11510b9ebd1e00c">isOperationLegal</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ad8aec9273962cf78d087090c11a1dd1c">ISD::MUL</a>, NewVT)) {</div><div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;      N0 = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a93fdf85eff945f1a668b4915a051453e">ISD::ZERO_EXTEND</a>, DL, NewVT, N0);</div><div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;      N1 = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a93fdf85eff945f1a668b4915a051453e">ISD::ZERO_EXTEND</a>, DL, NewVT, N1);</div><div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;      N1 = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ad8aec9273962cf78d087090c11a1dd1c">ISD::MUL</a>, DL, NewVT, N0, N1);</div><div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;      N1 = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a3c6553c8acebe1b57c211ee45e2d8f98">ISD::SRL</a>, DL, NewVT, N1,</div><div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;            DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(SimpleSize, getShiftAmountTy(N1.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>())));</div><div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ae690127648393001a7d5b93dc23da7b3">ISD::TRUNCATE</a>, DL, VT, N1);</div><div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;    }</div><div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;  }</div><div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;</div><div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;}</div><div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;<span class="comment">/// SimplifyNodeWithTwoResults - Perform optimizations common to nodes that</span></div><div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;<span class="comment">/// compute two values. LoOp and HiOp give the opcodes for the two computations</span></div><div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;<span class="comment">/// that are being performed. Return true if a simplification was made.</span></div><div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;<span class="comment"></span><a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::SimplifyNodeWithTwoResults(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N, <span class="keywordtype">unsigned</span> LoOp,</div><div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;                                                <span class="keywordtype">unsigned</span> HiOp) {</div><div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;  <span class="comment">// If the high half is not needed, just compute the low half.</span></div><div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;  <span class="keywordtype">bool</span> HiExists = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#ae4cb676e77b9f238058c70faa609a5d7">hasAnyUseOfValue</a>(1);</div><div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;  <span class="keywordflow">if</span> (!HiExists &amp;&amp;</div><div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;      (!LegalOperations ||</div><div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;       TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a055b3905dbbc16fae11510b9ebd1e00c">isOperationLegal</a>(LoOp, N-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(0)))) {</div><div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Res = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(LoOp, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), N-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(0),</div><div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;                              N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a20f382e841761654032bf8b4712e805f">op_begin</a>(), N-&gt;<a class="code" href="classllvm_1_1SDNode.html#abc5c2f1d47a517373030133c6a102106">getNumOperands</a>());</div><div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;    <span class="keywordflow">return</span> CombineTo(N, Res, Res);</div><div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;  }</div><div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;</div><div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;  <span class="comment">// If the low half is not needed, just compute the high half.</span></div><div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;  <span class="keywordtype">bool</span> LoExists = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#ae4cb676e77b9f238058c70faa609a5d7">hasAnyUseOfValue</a>(0);</div><div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;  <span class="keywordflow">if</span> (!LoExists &amp;&amp;</div><div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;      (!LegalOperations ||</div><div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;       TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a055b3905dbbc16fae11510b9ebd1e00c">isOperationLegal</a>(HiOp, N-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(1)))) {</div><div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Res = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(HiOp, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), N-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(1),</div><div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;                              N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a20f382e841761654032bf8b4712e805f">op_begin</a>(), N-&gt;<a class="code" href="classllvm_1_1SDNode.html#abc5c2f1d47a517373030133c6a102106">getNumOperands</a>());</div><div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;    <span class="keywordflow">return</span> CombineTo(N, Res, Res);</div><div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;  }</div><div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;</div><div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;  <span class="comment">// If both halves are used, return as it is.</span></div><div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;  <span class="keywordflow">if</span> (LoExists &amp;&amp; HiExists)</div><div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;</div><div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;  <span class="comment">// If the two computed results can be simplified separately, separate them.</span></div><div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;  <span class="keywordflow">if</span> (LoExists) {</div><div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> <a class="code" href="namespacellvm_1_1HexagonISD.html#aa640667f875feccdb3cc643baff441f1a144f7e8227378979bf13646688174ed9">Lo</a> = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(LoOp, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), N-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(0),</div><div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;                             N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a20f382e841761654032bf8b4712e805f">op_begin</a>(), N-&gt;<a class="code" href="classllvm_1_1SDNode.html#abc5c2f1d47a517373030133c6a102106">getNumOperands</a>());</div><div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;    AddToWorkList(Lo.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> LoOpt = combine(Lo.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;    <span class="keywordflow">if</span> (LoOpt.getNode() &amp;&amp; LoOpt.getNode() != Lo.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>() &amp;&amp;</div><div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;        (!LegalOperations ||</div><div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;         TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a055b3905dbbc16fae11510b9ebd1e00c">isOperationLegal</a>(LoOpt.getOpcode(), LoOpt.getValueType())))</div><div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;      <span class="keywordflow">return</span> CombineTo(N, LoOpt, LoOpt);</div><div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;  }</div><div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;</div><div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;  <span class="keywordflow">if</span> (HiExists) {</div><div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> <a class="code" href="namespacellvm_1_1HexagonISD.html#aa640667f875feccdb3cc643baff441f1ab53c716337bbeea9ba39b5fa32d60303">Hi</a> = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(HiOp, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), N-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(1),</div><div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;                             N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a20f382e841761654032bf8b4712e805f">op_begin</a>(), N-&gt;<a class="code" href="classllvm_1_1SDNode.html#abc5c2f1d47a517373030133c6a102106">getNumOperands</a>());</div><div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;    AddToWorkList(Hi.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> HiOpt = combine(Hi.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;    <span class="keywordflow">if</span> (HiOpt.getNode() &amp;&amp; HiOpt != Hi &amp;&amp;</div><div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;        (!LegalOperations ||</div><div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;         TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a055b3905dbbc16fae11510b9ebd1e00c">isOperationLegal</a>(HiOpt.getOpcode(), HiOpt.getValueType())))</div><div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;      <span class="keywordflow">return</span> CombineTo(N, HiOpt, HiOpt);</div><div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;  }</div><div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;</div><div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;}</div><div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;</div><div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::visitSMUL_LOHI(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N) {</div><div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Res = SimplifyNodeWithTwoResults(N, <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ad8aec9273962cf78d087090c11a1dd1c">ISD::MUL</a>, <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110aa2a7c3eccf06b41e4275bbeadb46d22e">ISD::MULHS</a>);</div><div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;  <span class="keywordflow">if</span> (Res.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()) <span class="keywordflow">return</span> Res;</div><div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;</div><div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> VT = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(0);</div><div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;  <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a> DL(N);</div><div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;</div><div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;  <span class="comment">// If the type twice as wide is legal, transform the mulhu to a wider multiply</span></div><div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;  <span class="comment">// plus a shift.</span></div><div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;  <span class="keywordflow">if</span> (VT.<a class="code" href="structllvm_1_1EVT.html#ac6f053514ba29bdf3b7f051f643dabe5">isSimple</a>() &amp;&amp; !VT.<a class="code" href="structllvm_1_1EVT.html#a73f7c824cad61a47c21bf6d652ae2fd7">isVector</a>()) {</div><div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;    <a class="code" href="classllvm_1_1MVT.html">MVT</a> Simple = VT.<a class="code" href="structllvm_1_1EVT.html#a5b45953b758fdfe88452530f7d8371bc">getSimpleVT</a>();</div><div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;    <span class="keywordtype">unsigned</span> SimpleSize = Simple.<a class="code" href="classllvm_1_1MVT.html#a423166b2b5d1010162dde0003e5ad09c">getSizeInBits</a>();</div><div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;    <a class="code" href="structllvm_1_1EVT.html">EVT</a> NewVT = <a class="code" href="structllvm_1_1EVT.html#a752372e170e4e7c595bf8810bb52adf2">EVT::getIntegerVT</a>(*DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a39c6dff47b8dbd25cfaf6336c7056077">getContext</a>(), SimpleSize*2);</div><div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;    <span class="keywordflow">if</span> (TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a055b3905dbbc16fae11510b9ebd1e00c">isOperationLegal</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ad8aec9273962cf78d087090c11a1dd1c">ISD::MUL</a>, NewVT)) {</div><div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> <a class="code" href="namespacellvm_1_1HexagonISD.html#aa640667f875feccdb3cc643baff441f1a144f7e8227378979bf13646688174ed9">Lo</a> = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a5183f3d72924bc7c77ba8d3f5de9f602">ISD::SIGN_EXTEND</a>, DL, NewVT, N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0));</div><div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> <a class="code" href="namespacellvm_1_1HexagonISD.html#aa640667f875feccdb3cc643baff441f1ab53c716337bbeea9ba39b5fa32d60303">Hi</a> = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a5183f3d72924bc7c77ba8d3f5de9f602">ISD::SIGN_EXTEND</a>, DL, NewVT, N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(1));</div><div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;      Lo = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ad8aec9273962cf78d087090c11a1dd1c">ISD::MUL</a>, DL, NewVT, Lo, Hi);</div><div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;      <span class="comment">// Compute the high part as N1.</span></div><div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;      Hi = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a3c6553c8acebe1b57c211ee45e2d8f98">ISD::SRL</a>, DL, NewVT, Lo,</div><div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;            DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(SimpleSize, getShiftAmountTy(Lo.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>())));</div><div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;      Hi = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ae690127648393001a7d5b93dc23da7b3">ISD::TRUNCATE</a>, DL, VT, Hi);</div><div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;      <span class="comment">// Compute the low part as N0.</span></div><div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;      Lo = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ae690127648393001a7d5b93dc23da7b3">ISD::TRUNCATE</a>, DL, VT, Lo);</div><div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;      <span class="keywordflow">return</span> CombineTo(N, Lo, Hi);</div><div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;    }</div><div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;  }</div><div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;</div><div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;}</div><div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;</div><div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::visitUMUL_LOHI(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N) {</div><div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Res = SimplifyNodeWithTwoResults(N, <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ad8aec9273962cf78d087090c11a1dd1c">ISD::MUL</a>, <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a8a80d3b085af08f0dce1724207ef99b5">ISD::MULHU</a>);</div><div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;  <span class="keywordflow">if</span> (Res.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()) <span class="keywordflow">return</span> Res;</div><div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;</div><div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> VT = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(0);</div><div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;  <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a> DL(N);</div><div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;</div><div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;  <span class="comment">// If the type twice as wide is legal, transform the mulhu to a wider multiply</span></div><div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;  <span class="comment">// plus a shift.</span></div><div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;  <span class="keywordflow">if</span> (VT.<a class="code" href="structllvm_1_1EVT.html#ac6f053514ba29bdf3b7f051f643dabe5">isSimple</a>() &amp;&amp; !VT.<a class="code" href="structllvm_1_1EVT.html#a73f7c824cad61a47c21bf6d652ae2fd7">isVector</a>()) {</div><div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;    <a class="code" href="classllvm_1_1MVT.html">MVT</a> Simple = VT.<a class="code" href="structllvm_1_1EVT.html#a5b45953b758fdfe88452530f7d8371bc">getSimpleVT</a>();</div><div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;    <span class="keywordtype">unsigned</span> SimpleSize = Simple.<a class="code" href="classllvm_1_1MVT.html#a423166b2b5d1010162dde0003e5ad09c">getSizeInBits</a>();</div><div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;    <a class="code" href="structllvm_1_1EVT.html">EVT</a> NewVT = <a class="code" href="structllvm_1_1EVT.html#a752372e170e4e7c595bf8810bb52adf2">EVT::getIntegerVT</a>(*DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a39c6dff47b8dbd25cfaf6336c7056077">getContext</a>(), SimpleSize*2);</div><div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;    <span class="keywordflow">if</span> (TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a055b3905dbbc16fae11510b9ebd1e00c">isOperationLegal</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ad8aec9273962cf78d087090c11a1dd1c">ISD::MUL</a>, NewVT)) {</div><div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> <a class="code" href="namespacellvm_1_1HexagonISD.html#aa640667f875feccdb3cc643baff441f1a144f7e8227378979bf13646688174ed9">Lo</a> = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a93fdf85eff945f1a668b4915a051453e">ISD::ZERO_EXTEND</a>, DL, NewVT, N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0));</div><div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> <a class="code" href="namespacellvm_1_1HexagonISD.html#aa640667f875feccdb3cc643baff441f1ab53c716337bbeea9ba39b5fa32d60303">Hi</a> = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a93fdf85eff945f1a668b4915a051453e">ISD::ZERO_EXTEND</a>, DL, NewVT, N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(1));</div><div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;      Lo = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ad8aec9273962cf78d087090c11a1dd1c">ISD::MUL</a>, DL, NewVT, Lo, Hi);</div><div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;      <span class="comment">// Compute the high part as N1.</span></div><div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;      Hi = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a3c6553c8acebe1b57c211ee45e2d8f98">ISD::SRL</a>, DL, NewVT, Lo,</div><div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;            DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(SimpleSize, getShiftAmountTy(Lo.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>())));</div><div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;      Hi = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ae690127648393001a7d5b93dc23da7b3">ISD::TRUNCATE</a>, DL, VT, Hi);</div><div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;      <span class="comment">// Compute the low part as N0.</span></div><div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;      Lo = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ae690127648393001a7d5b93dc23da7b3">ISD::TRUNCATE</a>, DL, VT, Lo);</div><div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;      <span class="keywordflow">return</span> CombineTo(N, Lo, Hi);</div><div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;    }</div><div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;  }</div><div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;</div><div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;}</div><div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;</div><div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::visitSMULO(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N) {</div><div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;  <span class="comment">// (smulo x, 2) -&gt; (saddo x, x)</span></div><div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a> *C2 = dyn_cast&lt;ConstantSDNode&gt;(N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(1)))</div><div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;    <span class="keywordflow">if</span> (C2-&gt;getAPIntValue() == 2)</div><div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a863ec6ebb75bf89cfea14da646d77e92">ISD::SADDO</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a1aac28ffadab16f6cfbadfc2ddccd8a1">getVTList</a>(),</div><div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;                         N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0), N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0));</div><div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;</div><div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;}</div><div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;</div><div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::visitUMULO(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N) {</div><div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;  <span class="comment">// (umulo x, 2) -&gt; (uaddo x, x)</span></div><div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a> *C2 = dyn_cast&lt;ConstantSDNode&gt;(N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(1)))</div><div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;    <span class="keywordflow">if</span> (C2-&gt;getAPIntValue() == 2)</div><div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a1ddf36330110b4abea43fe390bea9ef9">ISD::UADDO</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a1aac28ffadab16f6cfbadfc2ddccd8a1">getVTList</a>(),</div><div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;                         N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0), N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0));</div><div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;</div><div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;}</div><div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;</div><div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::visitSDIVREM(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N) {</div><div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Res = SimplifyNodeWithTwoResults(N, <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a1f61c2422057e10403b2f6003543c300">ISD::SDIV</a>, <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a124ba0f5b2887879212c74a68bc230a3">ISD::SREM</a>);</div><div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;  <span class="keywordflow">if</span> (Res.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()) <span class="keywordflow">return</span> Res;</div><div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;</div><div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;}</div><div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;</div><div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::visitUDIVREM(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N) {</div><div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Res = SimplifyNodeWithTwoResults(N, <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a15637879021fa7d5226045c0668a99a8">ISD::UDIV</a>, <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ad1657dbc1957901a6d9cd224efbc0f28">ISD::UREM</a>);</div><div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;  <span class="keywordflow">if</span> (Res.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()) <span class="keywordflow">return</span> Res;</div><div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;</div><div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;}</div><div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;<span class="comment">/// SimplifyBinOpWithSameOpcodeHands - If this is a binary operator with</span></div><div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;<span class="comment">/// two operands of the same opcode, try to simplify it.</span></div><div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;<span class="comment"></span><a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::SimplifyBinOpWithSameOpcodeHands(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N) {</div><div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N0 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0), N1 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(1);</div><div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> VT = N0.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>();</div><div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;  assert(N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == N1.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() &amp;&amp; <span class="stringliteral">&quot;Bad input!&quot;</span>);</div><div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;</div><div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;  <span class="comment">// Bail early if none of these transforms apply.</span></div><div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;  <span class="keywordflow">if</span> (N0.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()-&gt;<a class="code" href="classllvm_1_1SDNode.html#abc5c2f1d47a517373030133c6a102106">getNumOperands</a>() == 0) <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;</div><div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;  <span class="comment">// For each of OP in AND/OR/XOR:</span></div><div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;  <span class="comment">// fold (OP (zext x), (zext y)) -&gt; (zext (OP x, y))</span></div><div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;  <span class="comment">// fold (OP (sext x), (sext y)) -&gt; (sext (OP x, y))</span></div><div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;  <span class="comment">// fold (OP (aext x), (aext y)) -&gt; (aext (OP x, y))</span></div><div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;  <span class="comment">// fold (OP (trunc x), (trunc y)) -&gt; (trunc (OP x, y)) (if trunc isn&#39;t free)</span></div><div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;  <span class="comment">//</span></div><div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;  <span class="comment">// do not sink logical op inside of a vector extend, since it may combine</span></div><div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;  <span class="comment">// into a vsetcc.</span></div><div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> Op0VT = N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>();</div><div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;  <span class="keywordflow">if</span> ((N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a93fdf85eff945f1a668b4915a051453e">ISD::ZERO_EXTEND</a> ||</div><div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;       N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a5183f3d72924bc7c77ba8d3f5de9f602">ISD::SIGN_EXTEND</a> ||</div><div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;       <span class="comment">// Avoid infinite looping with PromoteIntBinOp.</span></div><div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;       (N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a27d5d8ef82302b739ba3ca8be1a5513d">ISD::ANY_EXTEND</a> &amp;&amp;</div><div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;        (!LegalTypes || TLI.<a class="code" href="classllvm_1_1TargetLowering.html#ab945eaf78cbe0a5e7cd0dbc3a6b92ae4">isTypeDesirableForOp</a>(N-&gt;<a class="code" href="classllvm_1_1SDNode.html#af0d328f3f61168f4ea7d6e4044af4f97">getOpcode</a>(), Op0VT))) ||</div><div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;       (N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ae690127648393001a7d5b93dc23da7b3">ISD::TRUNCATE</a> &amp;&amp;</div><div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;        (!TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#ae40dacbf39edf0d87f07cc4389deaa67">isZExtFree</a>(VT, Op0VT) ||</div><div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;         !TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a00856c52a5a67b38d8332c7842429153">isTruncateFree</a>(Op0VT, VT)) &amp;&amp;</div><div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;        TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a861aaccc0f468493e76c011811548804">isTypeLegal</a>(Op0VT))) &amp;&amp;</div><div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;      !VT.<a class="code" href="structllvm_1_1EVT.html#a73f7c824cad61a47c21bf6d652ae2fd7">isVector</a>() &amp;&amp;</div><div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;      Op0VT == N1.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>() &amp;&amp;</div><div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;      (!LegalOperations || TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a055b3905dbbc16fae11510b9ebd1e00c">isOperationLegal</a>(N-&gt;<a class="code" href="classllvm_1_1SDNode.html#af0d328f3f61168f4ea7d6e4044af4f97">getOpcode</a>(), Op0VT))) {</div><div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> ORNode = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(N-&gt;<a class="code" href="classllvm_1_1SDNode.html#af0d328f3f61168f4ea7d6e4044af4f97">getOpcode</a>(), <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N0),</div><div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;                                 N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>(),</div><div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;                                 N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0), N1.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0));</div><div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;    AddToWorkList(ORNode.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>(), <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, ORNode);</div><div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;  }</div><div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;</div><div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;  <span class="comment">// For each of OP in SHL/SRL/SRA/AND...</span></div><div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;  <span class="comment">//   fold (and (OP x, z), (OP y, z)) -&gt; (OP (and x, y), z)</span></div><div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;  <span class="comment">//   fold (or  (OP x, z), (OP y, z)) -&gt; (OP (or  x, y), z)</span></div><div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;  <span class="comment">//   fold (xor (OP x, z), (OP y, z)) -&gt; (OP (xor x, y), z)</span></div><div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;  <span class="keywordflow">if</span> ((N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a8cc94e03dea594863073a02f5bb94997">ISD::SHL</a> || N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a3c6553c8acebe1b57c211ee45e2d8f98">ISD::SRL</a> ||</div><div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;       N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a4a055321c361a0f6ee77ed764730ffc1">ISD::SRA</a> || N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ac513a7da1bf74fb3e3c594da8534f2d2">ISD::AND</a>) &amp;&amp;</div><div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;      N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1) == N1.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1)) {</div><div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> ORNode = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(N-&gt;<a class="code" href="classllvm_1_1SDNode.html#af0d328f3f61168f4ea7d6e4044af4f97">getOpcode</a>(), <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N0),</div><div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;                                 N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>(),</div><div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;                                 N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0), N1.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0));</div><div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;    AddToWorkList(ORNode.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>(), <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT,</div><div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;                       ORNode, N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1));</div><div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;  }</div><div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;</div><div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;  <span class="comment">// Simplify xor/and/or (bitcast(A), bitcast(B)) -&gt; bitcast(op (A,B))</span></div><div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;  <span class="comment">// Only perform this optimization after type legalization and before</span></div><div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;  <span class="comment">// LegalizeVectorOprs. LegalizeVectorOprs promotes vector operations by</span></div><div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;  <span class="comment">// adding bitcasts. For example (xor v4i32) is promoted to (v2i64), and</span></div><div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;  <span class="comment">// we don&#39;t want to undo this promotion.</span></div><div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;  <span class="comment">// We also handle SCALAR_TO_VECTOR because xor/or/and operations are cheaper</span></div><div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;  <span class="comment">// on scalars.</span></div><div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;  <span class="keywordflow">if</span> ((N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a412ddf522b53f07690a86bffba1278e7">ISD::BITCAST</a> ||</div><div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;       N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a576080a08ef1bbab0308eac9d5838f75">ISD::SCALAR_TO_VECTOR</a>) &amp;&amp;</div><div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;      Level == <a class="code" href="namespacellvm.html#aa6d856e4879bb775617f8c3634773b7aabfb921bbd2fd66e0a6b7524eb4b3dd9f">AfterLegalizeTypes</a>) {</div><div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> In0 = N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0);</div><div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> In1 = N1.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0);</div><div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;    <a class="code" href="structllvm_1_1EVT.html">EVT</a> In0Ty = In0.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>();</div><div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;    <a class="code" href="structllvm_1_1EVT.html">EVT</a> In1Ty = In1.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>();</div><div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;    <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a> DL(N);</div><div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;    <span class="comment">// If both incoming values are integers, and the original types are the</span></div><div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;    <span class="comment">// same.</span></div><div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;    <span class="keywordflow">if</span> (In0Ty.<a class="code" href="structllvm_1_1EVT.html#a8cc407ac00df4edd4ec4d5168d6ecb26">isInteger</a>() &amp;&amp; In1Ty.<a class="code" href="structllvm_1_1EVT.html#a8cc407ac00df4edd4ec4d5168d6ecb26">isInteger</a>() &amp;&amp; In0Ty == In1Ty) {</div><div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Op = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(N-&gt;<a class="code" href="classllvm_1_1SDNode.html#af0d328f3f61168f4ea7d6e4044af4f97">getOpcode</a>(), DL, In0Ty, In0, In1);</div><div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> BC = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>(), DL, VT, Op);</div><div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;      AddToWorkList(Op.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;      <span class="keywordflow">return</span> BC;</div><div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;    }</div><div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;  }</div><div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;</div><div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;  <span class="comment">// Xor/and/or are indifferent to the swizzle operation (shuffle of one value).</span></div><div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;  <span class="comment">// Simplify xor/and/or (shuff(A), shuff(B)) -&gt; shuff(op (A,B))</span></div><div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;  <span class="comment">// If both shuffles use the same mask, and both shuffle within a single</span></div><div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;  <span class="comment">// vector, then it is worthwhile to move the swizzle after the operation.</span></div><div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;  <span class="comment">// The type-legalizer generates this pattern when loading illegal</span></div><div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;  <span class="comment">// vector types from memory. In many cases this allows additional shuffle</span></div><div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;  <span class="comment">// optimizations.</span></div><div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;  <span class="keywordflow">if</span> (N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a8d8773b28111d8898663d4a0f6223d68">ISD::VECTOR_SHUFFLE</a> &amp;&amp; Level &lt; <a class="code" href="namespacellvm.html#aa6d856e4879bb775617f8c3634773b7aa7fbaa966e5d5ac3bf03ba617b73bff5c">AfterLegalizeDAG</a> &amp;&amp;</div><div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;      N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1).<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7c6d8f265e9e16e5debdb9a536b55d3d">ISD::UNDEF</a> &amp;&amp;</div><div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;      N1.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1).<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7c6d8f265e9e16e5debdb9a536b55d3d">ISD::UNDEF</a>) {</div><div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;    <a class="code" href="classllvm_1_1ShuffleVectorSDNode.html">ShuffleVectorSDNode</a> *SVN0 = cast&lt;ShuffleVectorSDNode&gt;(N0);</div><div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;    <a class="code" href="classllvm_1_1ShuffleVectorSDNode.html">ShuffleVectorSDNode</a> *SVN1 = cast&lt;ShuffleVectorSDNode&gt;(N1);</div><div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;</div><div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;    assert(N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>() == N1.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1).<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>() &amp;&amp;</div><div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;           <span class="stringliteral">&quot;Inputs to shuffles are not the same type&quot;</span>);</div><div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;</div><div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;    <span class="keywordtype">unsigned</span> NumElts = VT.<a class="code" href="structllvm_1_1EVT.html#a42bca41d2438197c12b6db2c710a959c">getVectorNumElements</a>();</div><div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;</div><div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;    <span class="comment">// Check that both shuffles use the same mask. The masks are known to be of</span></div><div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;    <span class="comment">// the same length because the result vector type is the same.</span></div><div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;    <span class="keywordtype">bool</span> SameMask = <span class="keyword">true</span>;</div><div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != NumElts; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;      <span class="keywordtype">int</span> Idx0 = SVN0-&gt;<a class="code" href="classllvm_1_1ShuffleVectorSDNode.html#aae5468704c119f87dceb6728814b5502">getMaskElt</a>(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;      <span class="keywordtype">int</span> Idx1 = SVN1-&gt;getMaskElt(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;      <span class="keywordflow">if</span> (Idx0 != Idx1) {</div><div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;        SameMask = <span class="keyword">false</span>;</div><div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;      }</div><div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;    }</div><div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;</div><div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;    <span class="keywordflow">if</span> (SameMask) {</div><div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Op = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(N-&gt;<a class="code" href="classllvm_1_1SDNode.html#af0d328f3f61168f4ea7d6e4044af4f97">getOpcode</a>(), <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT,</div><div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;                               N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0), N1.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0));</div><div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;      AddToWorkList(Op.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a819041d6f932a577122acfff723fe4af">getVectorShuffle</a>(VT, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), Op,</div><div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;                                  DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a5b0e59823444a55c295af279611a9d24">getUNDEF</a>(VT), &amp;SVN0-&gt;<a class="code" href="classllvm_1_1ShuffleVectorSDNode.html#a6fe922cdd5bea1aee12d8719bac484d3">getMask</a>()[0]);</div><div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;    }</div><div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;  }</div><div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;</div><div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;}</div><div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;</div><div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::visitAND(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N) {</div><div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N0 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0);</div><div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N1 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(1);</div><div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> LL, LR, RL, RR, CC0, CC1;</div><div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;  <a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a> *N0C = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a>&gt;(N0);</div><div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;  <a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a> *N1C = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a>&gt;(N1);</div><div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> VT = N1.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>();</div><div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;  <span class="keywordtype">unsigned</span> BitWidth = VT.<a class="code" href="structllvm_1_1EVT.html#a15be9767d0aad93fe5dcb60b7b7a78da">getScalarType</a>().<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>();</div><div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;</div><div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;  <span class="comment">// fold vector ops</span></div><div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;  <span class="keywordflow">if</span> (VT.isVector()) {</div><div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> FoldedVOp = SimplifyVBinOp(N);</div><div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;    <span class="keywordflow">if</span> (FoldedVOp.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()) <span class="keywordflow">return</span> FoldedVOp;</div><div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;</div><div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;    <span class="comment">// fold (and x, 0) -&gt; 0, vector edition</span></div><div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1ISD.html#aaac3e239cbdfe15a8e9bad4f8e1e3a95">ISD::isBuildVectorAllZeros</a>(N0.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()))</div><div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;      <span class="keywordflow">return</span> N0;</div><div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1ISD.html#aaac3e239cbdfe15a8e9bad4f8e1e3a95">ISD::isBuildVectorAllZeros</a>(N1.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()))</div><div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;      <span class="keywordflow">return</span> N1;</div><div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;</div><div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;    <span class="comment">// fold (and x, -1) -&gt; x, vector edition</span></div><div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1ISD.html#ac78d4df51ca05e4fb1630a01e07de434">ISD::isBuildVectorAllOnes</a>(N0.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()))</div><div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;      <span class="keywordflow">return</span> N1;</div><div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1ISD.html#ac78d4df51ca05e4fb1630a01e07de434">ISD::isBuildVectorAllOnes</a>(N1.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()))</div><div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;      <span class="keywordflow">return</span> N0;</div><div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;  }</div><div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;</div><div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;  <span class="comment">// fold (and x, undef) -&gt; 0</span></div><div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;  <span class="keywordflow">if</span> (N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7c6d8f265e9e16e5debdb9a536b55d3d">ISD::UNDEF</a> || N1.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7c6d8f265e9e16e5debdb9a536b55d3d">ISD::UNDEF</a>)</div><div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(0, VT);</div><div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;  <span class="comment">// fold (and c1, c2) -&gt; c1&amp;c2</span></div><div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;  <span class="keywordflow">if</span> (N0C &amp;&amp; N1C)</div><div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a8503b91b7bbfb128a42fa582857f8828">FoldConstantArithmetic</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ac513a7da1bf74fb3e3c594da8534f2d2">ISD::AND</a>, VT, N0C, N1C);</div><div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;  <span class="comment">// canonicalize constant to RHS</span></div><div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;  <span class="keywordflow">if</span> (N0C &amp;&amp; !N1C)</div><div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ac513a7da1bf74fb3e3c594da8534f2d2">ISD::AND</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N1, N0);</div><div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;  <span class="comment">// fold (and x, -1) -&gt; x</span></div><div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;  <span class="keywordflow">if</span> (N1C &amp;&amp; N1C-&gt;isAllOnesValue())</div><div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;    <span class="keywordflow">return</span> N0;</div><div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;  <span class="comment">// if (and x, c) is known to be zero, return 0</span></div><div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;  <span class="keywordflow">if</span> (N1C &amp;&amp; DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af99f246db9e144fefd7a73b54ef0bbf7">MaskedValueIsZero</a>(<a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(N, 0),</div><div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;                                   <a class="code" href="classllvm_1_1APInt.html#a539bdb4fdbf46e0bfcefebf5ac6d21dd">APInt::getAllOnesValue</a>(BitWidth)))</div><div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(0, VT);</div><div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;  <span class="comment">// reassociate and</span></div><div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> RAND = ReassociateOps(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ac513a7da1bf74fb3e3c594da8534f2d2">ISD::AND</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), N0, N1);</div><div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;  <span class="keywordflow">if</span> (RAND.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>() != 0)</div><div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;    <span class="keywordflow">return</span> RAND;</div><div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;  <span class="comment">// fold (and (or x, C), D) -&gt; D if (C &amp; D) == D</span></div><div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;  <span class="keywordflow">if</span> (N1C &amp;&amp; N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7415ab9f2172c59a2ee7c7a02afa56a4">ISD::OR</a>)</div><div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a> *ORI = dyn_cast&lt;ConstantSDNode&gt;(N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1)))</div><div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;      <span class="keywordflow">if</span> ((ORI-&gt;getAPIntValue() &amp; N1C-&gt;getAPIntValue()) == N1C-&gt;getAPIntValue())</div><div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;        <span class="keywordflow">return</span> N1;</div><div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;  <span class="comment">// fold (and (any_ext V), c) -&gt; (zero_ext V) if &#39;and&#39; only clears top bits.</span></div><div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;  <span class="keywordflow">if</span> (N1C &amp;&amp; N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a27d5d8ef82302b739ba3ca8be1a5513d">ISD::ANY_EXTEND</a>) {</div><div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N0Op0 = N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0);</div><div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;    <a class="code" href="classllvm_1_1APInt.html">APInt</a> Mask = ~N1C-&gt;getAPIntValue();</div><div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;    Mask = Mask.<a class="code" href="classllvm_1_1APInt.html#a8cf5475fb3e9c737112cc248194c1040">trunc</a>(N0Op0.<a class="code" href="classllvm_1_1SDValue.html#a70aa652293da070dfe5b9fae309d0112">getValueSizeInBits</a>());</div><div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;    <span class="keywordflow">if</span> (DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af99f246db9e144fefd7a73b54ef0bbf7">MaskedValueIsZero</a>(N0Op0, Mask)) {</div><div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Zext = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a93fdf85eff945f1a668b4915a051453e">ISD::ZERO_EXTEND</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N),</div><div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;                                 N0.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>(), N0Op0);</div><div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;</div><div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;      <span class="comment">// Replace uses of the AND with uses of the Zero extend node.</span></div><div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;      CombineTo(N, Zext);</div><div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;</div><div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;      <span class="comment">// We actually want to replace all uses of the any_extend with the</span></div><div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;      <span class="comment">// zero_extend, to avoid duplicating things.  This will later cause this</span></div><div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;      <span class="comment">// AND to be folded.</span></div><div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;      CombineTo(N0.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>(), Zext);</div><div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(N, 0);   <span class="comment">// Return N so it doesn&#39;t get rechecked!</span></div><div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;    }</div><div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;  }</div><div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;  <span class="comment">// similarly fold (and (X (load ([non_ext|any_ext|zero_ext] V))), c) -&gt;</span></div><div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;  <span class="comment">// (X (load ([non_ext|zero_ext] V))) if &#39;and&#39; only clears top bits which must</span></div><div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;  <span class="comment">// already be zero by virtue of the width of the base type of the load.</span></div><div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;  <span class="comment">//</span></div><div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;  <span class="comment">// the &#39;X&#39; node here can either be nothing or an extract_vector_elt to catch</span></div><div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;  <span class="comment">// more cases.</span></div><div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;  <span class="keywordflow">if</span> ((N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9329e79f62e9ab9b41cfbcafd314bcbd">ISD::EXTRACT_VECTOR_ELT</a> &amp;&amp;</div><div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;       N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a269b81f007000306e3e69d0d290c2159">ISD::LOAD</a>) ||</div><div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;      N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a269b81f007000306e3e69d0d290c2159">ISD::LOAD</a>) {</div><div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;    <a class="code" href="classllvm_1_1LoadSDNode.html">LoadSDNode</a> *Load = cast&lt;LoadSDNode&gt;( (N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a269b81f007000306e3e69d0d290c2159">ISD::LOAD</a>) ?</div><div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;                                         N0 : N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0) );</div><div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;</div><div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;    <span class="comment">// Get the constant (if applicable) the zero&#39;th operand is being ANDed with.</span></div><div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;    <span class="comment">// This can be a pure constant or a vector splat, in which case we treat the</span></div><div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;    <span class="comment">// vector as a scalar and use the splat value.</span></div><div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;    <a class="code" href="classllvm_1_1APInt.html">APInt</a> <a class="code" href="classllvm_1_1Constant.html">Constant</a> = <a class="code" href="classllvm_1_1APInt.html#a4ba7d7f0a1e911c8384e236b5f6c1959">APInt::getNullValue</a>(1);</div><div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">const</span> <a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a> *<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = dyn_cast&lt;ConstantSDNode&gt;(N1)) {</div><div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;      Constant = <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>-&gt;getAPIntValue();</div><div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1BuildVectorSDNode.html">BuildVectorSDNode</a> *Vector = dyn_cast&lt;BuildVectorSDNode&gt;(N1)) {</div><div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;      <a class="code" href="classllvm_1_1APInt.html">APInt</a> SplatValue, SplatUndef;</div><div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;      <span class="keywordtype">unsigned</span> SplatBitSize;</div><div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;      <span class="keywordtype">bool</span> HasAnyUndefs;</div><div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;      <span class="keywordtype">bool</span> IsSplat = Vector-&gt;isConstantSplat(SplatValue, SplatUndef,</div><div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;                                             SplatBitSize, HasAnyUndefs);</div><div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;      <span class="keywordflow">if</span> (IsSplat) {</div><div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;        <span class="comment">// Undef bits can contribute to a possible optimisation if set, so</span></div><div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;        <span class="comment">// set them.</span></div><div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;        SplatValue |= SplatUndef;</div><div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;</div><div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;        <span class="comment">// The splat value may be something like &quot;0x00FFFFFF&quot;, which means 0 for</span></div><div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;        <span class="comment">// the first vector value and FF for the rest, repeating. We need a mask</span></div><div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;        <span class="comment">// that will apply equally to all members of the vector, so AND all the</span></div><div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;        <span class="comment">// lanes of the constant together.</span></div><div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;        <a class="code" href="structllvm_1_1EVT.html">EVT</a> VT = Vector-&gt;getValueType(0);</div><div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;        <span class="keywordtype">unsigned</span> BitWidth = VT.<a class="code" href="structllvm_1_1EVT.html#a3a07c062cc9330acd8e8c4e3930cbb25">getVectorElementType</a>().<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>();</div><div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;</div><div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;        <span class="comment">// If the splat value has been compressed to a bitlength lower</span></div><div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;        <span class="comment">// than the size of the vector lane, we need to re-expand it to</span></div><div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;        <span class="comment">// the lane size.</span></div><div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;        <span class="keywordflow">if</span> (BitWidth &gt; SplatBitSize)</div><div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;          <span class="keywordflow">for</span> (SplatValue = SplatValue.<a class="code" href="classllvm_1_1APInt.html#a7fe47410bb825eccb20f010dab13c72f">zextOrTrunc</a>(BitWidth);</div><div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;               SplatBitSize &lt; BitWidth;</div><div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;               SplatBitSize = SplatBitSize * 2)</div><div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;            SplatValue |= SplatValue.<a class="code" href="classllvm_1_1APInt.html#a45266d6f33cd3d34f75842ddf4029a9d">shl</a>(SplatBitSize);</div><div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;</div><div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;        Constant = <a class="code" href="classllvm_1_1APInt.html#a539bdb4fdbf46e0bfcefebf5ac6d21dd">APInt::getAllOnesValue</a>(BitWidth);</div><div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0, <a class="code" href="Target_2README_8txt.html#ab335e668fd33542ea14a2c7b527e64d3">n</a> = SplatBitSize/BitWidth; <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="Target_2README_8txt.html#ab335e668fd33542ea14a2c7b527e64d3">n</a>; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div><div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;          Constant &amp;= SplatValue.<a class="code" href="classllvm_1_1APInt.html#aa1953b3ad7ef6aa87dc0205db0c2ea45">lshr</a>(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>*BitWidth).<a class="code" href="classllvm_1_1APInt.html#a7fe47410bb825eccb20f010dab13c72f">zextOrTrunc</a>(BitWidth);</div><div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;      }</div><div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;    }</div><div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;</div><div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;    <span class="comment">// If we want to change an EXTLOAD to a ZEXTLOAD, ensure a ZEXTLOAD is</span></div><div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;    <span class="comment">// actually legal and isn&#39;t going to get expanded, else this is a false</span></div><div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;    <span class="comment">// optimisation.</span></div><div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;    <span class="keywordtype">bool</span> CanZextLoadProfitably = TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#ad85f712b9e49629c2c160f16521fe91f">isLoadExtLegal</a>(<a class="code" href="namespacellvm_1_1ISD.html#ad4d48171b87ca51ff54c10a436bac4d7a8d89c7da4444d9ec11667aa369abc5f7">ISD::ZEXTLOAD</a>,</div><div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;                                                    Load-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a7cead3a2a7771e61083bcc6959915a13">getMemoryVT</a>());</div><div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;</div><div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;    <span class="comment">// Resize the constant to the same size as the original memory access before</span></div><div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;    <span class="comment">// extension. If it is still the AllOnesValue then this AND is completely</span></div><div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;    <span class="comment">// unneeded.</span></div><div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;    Constant =</div><div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;      Constant.zextOrTrunc(Load-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a7cead3a2a7771e61083bcc6959915a13">getMemoryVT</a>().<a class="code" href="structllvm_1_1EVT.html#a15be9767d0aad93fe5dcb60b7b7a78da">getScalarType</a>().<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>());</div><div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;</div><div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="Target_2ARM_2README_8txt.html#a90cca76dd78688687e0d697679dbc799">B</a>;</div><div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;    <span class="keywordflow">switch</span> (Load-&gt;<a class="code" href="classllvm_1_1LoadSDNode.html#af15fb8b2d4c9f295bdcf85a1eb506702">getExtensionType</a>()) {</div><div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;    <span class="keywordflow">default</span>: B = <span class="keyword">false</span>; <span class="keywordflow">break</span>;</div><div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#ad4d48171b87ca51ff54c10a436bac4d7afab3fffd153f7d7770fed81272e4b78f">ISD::EXTLOAD</a>: B = CanZextLoadProfitably; <span class="keywordflow">break</span>;</div><div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#ad4d48171b87ca51ff54c10a436bac4d7a8d89c7da4444d9ec11667aa369abc5f7">ISD::ZEXTLOAD</a>:</div><div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#ad4d48171b87ca51ff54c10a436bac4d7a6aacde2c67988b43a261a7f7ceac4be3">ISD::NON_EXTLOAD</a>: B = <span class="keyword">true</span>; <span class="keywordflow">break</span>;</div><div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;    }</div><div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;</div><div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;    <span class="keywordflow">if</span> (B &amp;&amp; Constant.isAllOnesValue()) {</div><div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;      <span class="comment">// If the load type was an EXTLOAD, convert to ZEXTLOAD in order to</span></div><div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;      <span class="comment">// preserve semantics once we get rid of the AND.</span></div><div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> NewLoad(Load, 0);</div><div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160;      <span class="keywordflow">if</span> (Load-&gt;<a class="code" href="classllvm_1_1LoadSDNode.html#af15fb8b2d4c9f295bdcf85a1eb506702">getExtensionType</a>() == <a class="code" href="namespacellvm_1_1ISD.html#ad4d48171b87ca51ff54c10a436bac4d7afab3fffd153f7d7770fed81272e4b78f">ISD::EXTLOAD</a>) {</div><div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;        NewLoad = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#ab8395be5698f080c0036d866e121a478">getLoad</a>(Load-&gt;<a class="code" href="classllvm_1_1LSBaseSDNode.html#a76f8f644c33a885eaff35f94c39d5048">getAddressingMode</a>(), <a class="code" href="namespacellvm_1_1ISD.html#ad4d48171b87ca51ff54c10a436bac4d7a8d89c7da4444d9ec11667aa369abc5f7">ISD::ZEXTLOAD</a>,</div><div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160;                              Load-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(0), <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(Load),</div><div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160;                              Load-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#ae3cb6fbf8c8cb79e10ac61bd98c85211">getChain</a>(), Load-&gt;<a class="code" href="classllvm_1_1LoadSDNode.html#a3ded48ce66b58b7e7e143991df5dbfae">getBasePtr</a>(),</div><div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;                              Load-&gt;<a class="code" href="classllvm_1_1LoadSDNode.html#ae769a35bdc5f1748a40134166a312901">getOffset</a>(), Load-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a7cead3a2a7771e61083bcc6959915a13">getMemoryVT</a>(),</div><div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160;                              Load-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a89e2b5e3fb867b4040f893c6ae3d2132">getMemOperand</a>());</div><div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;        <span class="comment">// Replace uses of the EXTLOAD with the new ZEXTLOAD.</span></div><div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;        <span class="keywordflow">if</span> (Load-&gt;<a class="code" href="classllvm_1_1SDNode.html#ab319fc51db27ec95fd50a910c7ccec94">getNumValues</a>() == 3) {</div><div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;          <span class="comment">// PRE/POST_INC loads have 3 values.</span></div><div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;          <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> To[] = { NewLoad.<a class="code" href="classllvm_1_1SDValue.html#a040481b9bda32faa6b1435532405d88f">getValue</a>(0), NewLoad.<a class="code" href="classllvm_1_1SDValue.html#a040481b9bda32faa6b1435532405d88f">getValue</a>(1),</div><div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;                           NewLoad.<a class="code" href="classllvm_1_1SDValue.html#a040481b9bda32faa6b1435532405d88f">getValue</a>(2) };</div><div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;          CombineTo(Load, To, 3, <span class="keyword">true</span>);</div><div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;          CombineTo(Load, NewLoad.<a class="code" href="classllvm_1_1SDValue.html#a040481b9bda32faa6b1435532405d88f">getValue</a>(0), NewLoad.<a class="code" href="classllvm_1_1SDValue.html#a040481b9bda32faa6b1435532405d88f">getValue</a>(1));</div><div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;        }</div><div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;      }</div><div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;</div><div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;      <span class="comment">// Fold the AND away, taking care not to fold to the old load node if we</span></div><div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;      <span class="comment">// replaced it.</span></div><div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;      CombineTo(N, (N0.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>() == <a class="code" href="namespacellvm_1_1SPII.html#a11e9b8fca4a074643a6a21f444e51406a5069619ca8fdce305534f3fe85091a0f">Load</a>) ? NewLoad : N0);</div><div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;</div><div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(N, 0); <span class="comment">// Return N so it doesn&#39;t get rechecked!</span></div><div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;    }</div><div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;  }</div><div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;  <span class="comment">// fold (and (setcc x), (setcc y)) -&gt; (setcc (and x, y))</span></div><div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="DAGCombiner_8cpp.html#aad9b27fb736faf90f342b3fcabf413fb">isSetCCEquivalent</a>(N0, LL, LR, CC0) &amp;&amp; <a class="code" href="DAGCombiner_8cpp.html#aad9b27fb736faf90f342b3fcabf413fb">isSetCCEquivalent</a>(N1, RL, RR, CC1)){</div><div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;    <a class="code" href="namespacellvm_1_1ISD.html#ac3c3cf58d6d631af6a172457304d3d07">ISD::CondCode</a> Op0 = cast&lt;CondCodeSDNode&gt;(CC0)-&gt;<span class="keyword">get</span>();</div><div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;    <a class="code" href="namespacellvm_1_1ISD.html#ac3c3cf58d6d631af6a172457304d3d07">ISD::CondCode</a> Op1 = cast&lt;CondCodeSDNode&gt;(CC1)-&gt;<span class="keyword">get</span>();</div><div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;</div><div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;    <span class="keywordflow">if</span> (LR == RR &amp;&amp; isa&lt;ConstantSDNode&gt;(LR) &amp;&amp; Op0 == Op1 &amp;&amp;</div><div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;        LL.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>().<a class="code" href="structllvm_1_1EVT.html#a8cc407ac00df4edd4ec4d5168d6ecb26">isInteger</a>()) {</div><div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;      <span class="comment">// fold (and (seteq X, 0), (seteq Y, 0)) -&gt; (seteq (or X, Y), 0)</span></div><div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160;      <span class="keywordflow">if</span> (cast&lt;ConstantSDNode&gt;(LR)-&gt;isNullValue() &amp;&amp; Op1 == <a class="code" href="namespacellvm_1_1ISD.html#ac3c3cf58d6d631af6a172457304d3d07ae2e6a5e32087b9f65bd51585a6a5afb4">ISD::SETEQ</a>) {</div><div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;        <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> ORNode = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7415ab9f2172c59a2ee7c7a02afa56a4">ISD::OR</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N0),</div><div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;                                     LR.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>(), LL, RL);</div><div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;        AddToWorkList(ORNode.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;        <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a2650d530046f9ddfc602dc7383ba0730">getSetCC</a>(<a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, ORNode, LR, Op1);</div><div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;      }</div><div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160;      <span class="comment">// fold (and (seteq X, -1), (seteq Y, -1)) -&gt; (seteq (and X, Y), -1)</span></div><div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;      <span class="keywordflow">if</span> (cast&lt;ConstantSDNode&gt;(LR)-&gt;isAllOnesValue() &amp;&amp; Op1 == <a class="code" href="namespacellvm_1_1ISD.html#ac3c3cf58d6d631af6a172457304d3d07ae2e6a5e32087b9f65bd51585a6a5afb4">ISD::SETEQ</a>) {</div><div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160;        <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> ANDNode = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ac513a7da1bf74fb3e3c594da8534f2d2">ISD::AND</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N0),</div><div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;                                      LR.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>(), LL, RL);</div><div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;        AddToWorkList(ANDNode.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;        <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a2650d530046f9ddfc602dc7383ba0730">getSetCC</a>(<a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, ANDNode, LR, Op1);</div><div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;      }</div><div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;      <span class="comment">// fold (and (setgt X,  -1), (setgt Y,  -1)) -&gt; (setgt (or X, Y), -1)</span></div><div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160;      <span class="keywordflow">if</span> (cast&lt;ConstantSDNode&gt;(LR)-&gt;isAllOnesValue() &amp;&amp; Op1 == <a class="code" href="namespacellvm_1_1ISD.html#ac3c3cf58d6d631af6a172457304d3d07a5ad12b466e3a5900d0c307b301465d25">ISD::SETGT</a>) {</div><div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160;        <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> ORNode = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7415ab9f2172c59a2ee7c7a02afa56a4">ISD::OR</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N0),</div><div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160;                                     LR.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>(), LL, RL);</div><div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;        AddToWorkList(ORNode.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;        <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a2650d530046f9ddfc602dc7383ba0730">getSetCC</a>(<a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, ORNode, LR, Op1);</div><div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;      }</div><div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;    }</div><div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160;    <span class="comment">// Simplify (and (setne X, 0), (setne X, -1)) -&gt; (setuge (add X, 1), 2)</span></div><div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160;    <span class="keywordflow">if</span> (LL == RL &amp;&amp; isa&lt;ConstantSDNode&gt;(LR) &amp;&amp; isa&lt;ConstantSDNode&gt;(RR) &amp;&amp;</div><div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160;        Op0 == Op1 &amp;&amp; LL.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>().<a class="code" href="structllvm_1_1EVT.html#a8cc407ac00df4edd4ec4d5168d6ecb26">isInteger</a>() &amp;&amp;</div><div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;      Op0 == <a class="code" href="namespacellvm_1_1ISD.html#ac3c3cf58d6d631af6a172457304d3d07a2887cc8b39915a25180f4bca0026a15e">ISD::SETNE</a> &amp;&amp; ((cast&lt;ConstantSDNode&gt;(LR)-&gt;isNullValue() &amp;&amp;</div><div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;                                 cast&lt;ConstantSDNode&gt;(RR)-&gt;isAllOnesValue()) ||</div><div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;                                (cast&lt;ConstantSDNode&gt;(LR)-&gt;isAllOnesValue() &amp;&amp;</div><div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;                                 cast&lt;ConstantSDNode&gt;(RR)-&gt;isNullValue()))) {</div><div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> ADDNode = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a269996b43a1f3e1d1f84a70fd4387535">ISD::ADD</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N0), LL.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>(),</div><div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;                                    LL, DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(1, LL.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>()));</div><div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;      AddToWorkList(ADDNode.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a2650d530046f9ddfc602dc7383ba0730">getSetCC</a>(<a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, ADDNode,</div><div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160;                          DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(2, LL.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>()), <a class="code" href="namespacellvm_1_1ISD.html#ac3c3cf58d6d631af6a172457304d3d07a9dff1dcbac65852b71473818c11869b1">ISD::SETUGE</a>);</div><div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;    }</div><div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160;    <span class="comment">// canonicalize equivalent to ll == rl</span></div><div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160;    <span class="keywordflow">if</span> (LL == RR &amp;&amp; LR == RL) {</div><div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;      Op1 = <a class="code" href="namespacellvm_1_1ISD.html#a9cc23aed232ccdeadbd8648c349236a6">ISD::getSetCCSwappedOperands</a>(Op1);</div><div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160;      <a class="code" href="namespacestd.html#ab8424022895aee3e366fb9a32f2883cb">std::swap</a>(RL, RR);</div><div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;    }</div><div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;    <span class="keywordflow">if</span> (LL == RL &amp;&amp; LR == RR) {</div><div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160;      <span class="keywordtype">bool</span> isInteger = LL.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>().<a class="code" href="structllvm_1_1EVT.html#a8cc407ac00df4edd4ec4d5168d6ecb26">isInteger</a>();</div><div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;      <a class="code" href="namespacellvm_1_1ISD.html#ac3c3cf58d6d631af6a172457304d3d07">ISD::CondCode</a> Result = <a class="code" href="namespacellvm_1_1ISD.html#a9cd461f4281b55121d79d03d883fc060">ISD::getSetCCAndOperation</a>(Op0, Op1, isInteger);</div><div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;      <span class="keywordflow">if</span> (Result != <a class="code" href="namespacellvm_1_1ISD.html#ac3c3cf58d6d631af6a172457304d3d07aeded54fe1be320194e9ff0f5825df0e5">ISD::SETCC_INVALID</a> &amp;&amp;</div><div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;          (!LegalOperations ||</div><div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;           (TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a5915acdb20d31a79440117652c5232ec">isCondCodeLegal</a>(Result, LL.<a class="code" href="classllvm_1_1SDValue.html#a8bc8606044f2c3cdb6271c0378e0f9cf">getSimpleValueType</a>()) &amp;&amp;</div><div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;            TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a055b3905dbbc16fae11510b9ebd1e00c">isOperationLegal</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a0158ee47dfa868be5d28e2cbef70d5d0">ISD::SETCC</a>,</div><div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;                            getSetCCResultType(N0.<a class="code" href="classllvm_1_1SDValue.html#a8bc8606044f2c3cdb6271c0378e0f9cf">getSimpleValueType</a>())))))</div><div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160;        <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a2650d530046f9ddfc602dc7383ba0730">getSetCC</a>(<a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), N0.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>(),</div><div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;                            LL, LR, Result);</div><div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;    }</div><div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;  }</div><div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;</div><div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;  <span class="comment">// Simplify: (and (op x...), (op y...))  -&gt; (op (and x, y))</span></div><div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;  <span class="keywordflow">if</span> (N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == N1.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>()) {</div><div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Tmp = SimplifyBinOpWithSameOpcodeHands(N);</div><div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;    <span class="keywordflow">if</span> (Tmp.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()) <span class="keywordflow">return</span> Tmp;</div><div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160;  }</div><div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;</div><div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;  <span class="comment">// fold (and (sign_extend_inreg x, i16 to i32), 1) -&gt; (and x, 1)</span></div><div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160;  <span class="comment">// fold (and (sra)) -&gt; (and (srl)) when possible.</span></div><div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;  <span class="keywordflow">if</span> (!VT.isVector() &amp;&amp;</div><div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;      SimplifyDemandedBits(<a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(N, 0)))</div><div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(N, 0);</div><div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160;</div><div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;  <span class="comment">// fold (zext_inreg (extload x)) -&gt; (zextload x)</span></div><div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1ISD.html#a910795e8d77c1545da0683c0e1cb81ee">ISD::isEXTLoad</a>(N0.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()) &amp;&amp; <a class="code" href="namespacellvm_1_1ISD.html#a7da84980dd2ee06405d74303cfb90485">ISD::isUNINDEXEDLoad</a>(N0.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>())) {</div><div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160;    <a class="code" href="classllvm_1_1LoadSDNode.html">LoadSDNode</a> *LN0 = cast&lt;LoadSDNode&gt;(N0);</div><div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160;    <a class="code" href="structllvm_1_1EVT.html">EVT</a> MemVT = LN0-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a7cead3a2a7771e61083bcc6959915a13">getMemoryVT</a>();</div><div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;    <span class="comment">// If we zero all the possible extended bits, then we can turn this into</span></div><div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;    <span class="comment">// a zextload if we are running before legalize or the operation is legal.</span></div><div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;    <span class="keywordtype">unsigned</span> BitWidth = N1.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>().<a class="code" href="structllvm_1_1EVT.html#a15be9767d0aad93fe5dcb60b7b7a78da">getScalarType</a>().<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>();</div><div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160;    <span class="keywordflow">if</span> (DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af99f246db9e144fefd7a73b54ef0bbf7">MaskedValueIsZero</a>(N1, <a class="code" href="classllvm_1_1APInt.html#adcb96bd09d7c75c7669fa5f9d1190899">APInt::getHighBitsSet</a>(BitWidth,</div><div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;                           BitWidth - MemVT.getScalarType().getSizeInBits())) &amp;&amp;</div><div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;        ((!LegalOperations &amp;&amp; !LN0-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#acd3bb9ee2ec53fa4be1fdf155b0b5a17">isVolatile</a>()) ||</div><div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;         TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#ad85f712b9e49629c2c160f16521fe91f">isLoadExtLegal</a>(<a class="code" href="namespacellvm_1_1ISD.html#ad4d48171b87ca51ff54c10a436bac4d7a8d89c7da4444d9ec11667aa369abc5f7">ISD::ZEXTLOAD</a>, MemVT))) {</div><div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> ExtLoad = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#ad6ff413bea6f8195d8e6f29f4fc519c4">getExtLoad</a>(<a class="code" href="namespacellvm_1_1ISD.html#ad4d48171b87ca51ff54c10a436bac4d7a8d89c7da4444d9ec11667aa369abc5f7">ISD::ZEXTLOAD</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N0), VT,</div><div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;                                       LN0-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#ae3cb6fbf8c8cb79e10ac61bd98c85211">getChain</a>(), LN0-&gt;<a class="code" href="classllvm_1_1LoadSDNode.html#a3ded48ce66b58b7e7e143991df5dbfae">getBasePtr</a>(),</div><div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160;                                       MemVT, LN0-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a89e2b5e3fb867b4040f893c6ae3d2132">getMemOperand</a>());</div><div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;      AddToWorkList(N);</div><div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160;      CombineTo(N0.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>(), ExtLoad, ExtLoad.<a class="code" href="classllvm_1_1SDValue.html#a040481b9bda32faa6b1435532405d88f">getValue</a>(1));</div><div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(N, 0);   <span class="comment">// Return N so it doesn&#39;t get rechecked!</span></div><div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;    }</div><div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;  }</div><div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;  <span class="comment">// fold (zext_inreg (sextload x)) -&gt; (zextload x) iff load has one use</span></div><div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1ISD.html#ac174dc465cbe0e04a0f5e41c0a422124">ISD::isSEXTLoad</a>(N0.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()) &amp;&amp; <a class="code" href="namespacellvm_1_1ISD.html#a7da84980dd2ee06405d74303cfb90485">ISD::isUNINDEXEDLoad</a>(N0.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()) &amp;&amp;</div><div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;      N0.<a class="code" href="classllvm_1_1SDValue.html#a97b0f24f3e52f030830fca6fbfcbd37d">hasOneUse</a>()) {</div><div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;    <a class="code" href="classllvm_1_1LoadSDNode.html">LoadSDNode</a> *LN0 = cast&lt;LoadSDNode&gt;(N0);</div><div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;    <a class="code" href="structllvm_1_1EVT.html">EVT</a> MemVT = LN0-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a7cead3a2a7771e61083bcc6959915a13">getMemoryVT</a>();</div><div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;    <span class="comment">// If we zero all the possible extended bits, then we can turn this into</span></div><div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;    <span class="comment">// a zextload if we are running before legalize or the operation is legal.</span></div><div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;    <span class="keywordtype">unsigned</span> BitWidth = N1.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>().<a class="code" href="structllvm_1_1EVT.html#a15be9767d0aad93fe5dcb60b7b7a78da">getScalarType</a>().<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>();</div><div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160;    <span class="keywordflow">if</span> (DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af99f246db9e144fefd7a73b54ef0bbf7">MaskedValueIsZero</a>(N1, <a class="code" href="classllvm_1_1APInt.html#adcb96bd09d7c75c7669fa5f9d1190899">APInt::getHighBitsSet</a>(BitWidth,</div><div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;                           BitWidth - MemVT.getScalarType().getSizeInBits())) &amp;&amp;</div><div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;        ((!LegalOperations &amp;&amp; !LN0-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#acd3bb9ee2ec53fa4be1fdf155b0b5a17">isVolatile</a>()) ||</div><div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;         TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#ad85f712b9e49629c2c160f16521fe91f">isLoadExtLegal</a>(<a class="code" href="namespacellvm_1_1ISD.html#ad4d48171b87ca51ff54c10a436bac4d7a8d89c7da4444d9ec11667aa369abc5f7">ISD::ZEXTLOAD</a>, MemVT))) {</div><div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> ExtLoad = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#ad6ff413bea6f8195d8e6f29f4fc519c4">getExtLoad</a>(<a class="code" href="namespacellvm_1_1ISD.html#ad4d48171b87ca51ff54c10a436bac4d7a8d89c7da4444d9ec11667aa369abc5f7">ISD::ZEXTLOAD</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N0), VT,</div><div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;                                       LN0-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#ae3cb6fbf8c8cb79e10ac61bd98c85211">getChain</a>(), LN0-&gt;<a class="code" href="classllvm_1_1LoadSDNode.html#a3ded48ce66b58b7e7e143991df5dbfae">getBasePtr</a>(),</div><div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;                                       MemVT, LN0-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a89e2b5e3fb867b4040f893c6ae3d2132">getMemOperand</a>());</div><div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;      AddToWorkList(N);</div><div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;      CombineTo(N0.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>(), ExtLoad, ExtLoad.<a class="code" href="classllvm_1_1SDValue.html#a040481b9bda32faa6b1435532405d88f">getValue</a>(1));</div><div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(N, 0);   <span class="comment">// Return N so it doesn&#39;t get rechecked!</span></div><div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;    }</div><div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;  }</div><div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160;</div><div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;  <span class="comment">// fold (and (load x), 255) -&gt; (zextload x, i8)</span></div><div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;  <span class="comment">// fold (and (extload x, i16), 255) -&gt; (zextload x, i8)</span></div><div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160;  <span class="comment">// fold (and (any_ext (extload x, i16)), 255) -&gt; (zextload x, i8)</span></div><div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160;  <span class="keywordflow">if</span> (N1C &amp;&amp; (N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a269b81f007000306e3e69d0d290c2159">ISD::LOAD</a> ||</div><div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;              (N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a27d5d8ef82302b739ba3ca8be1a5513d">ISD::ANY_EXTEND</a> &amp;&amp;</div><div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;               N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a269b81f007000306e3e69d0d290c2159">ISD::LOAD</a>))) {</div><div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;    <span class="keywordtype">bool</span> HasAnyExt = N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a27d5d8ef82302b739ba3ca8be1a5513d">ISD::ANY_EXTEND</a>;</div><div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;    <a class="code" href="classllvm_1_1LoadSDNode.html">LoadSDNode</a> *LN0 = HasAnyExt</div><div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;      ? cast&lt;LoadSDNode&gt;(N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0))</div><div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160;      : cast&lt;LoadSDNode&gt;(N0);</div><div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160;    <span class="keywordflow">if</span> (LN0-&gt;<a class="code" href="classllvm_1_1LoadSDNode.html#af15fb8b2d4c9f295bdcf85a1eb506702">getExtensionType</a>() != <a class="code" href="namespacellvm_1_1ISD.html#ad4d48171b87ca51ff54c10a436bac4d7a6c61b6125c7901c549f90ee0e443a770">ISD::SEXTLOAD</a> &amp;&amp;</div><div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;        LN0-&gt;<a class="code" href="classllvm_1_1LSBaseSDNode.html#a958114b87bff3b4db5ae7766d44dc375">isUnindexed</a>() &amp;&amp; N0.<a class="code" href="classllvm_1_1SDValue.html#a97b0f24f3e52f030830fca6fbfcbd37d">hasOneUse</a>() &amp;&amp; <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(LN0, 0).<a class="code" href="classllvm_1_1SDValue.html#a97b0f24f3e52f030830fca6fbfcbd37d">hasOneUse</a>()) {</div><div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;      uint32_t ActiveBits = N1C-&gt;getAPIntValue().getActiveBits();</div><div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;      <span class="keywordflow">if</span> (ActiveBits &gt; 0 &amp;&amp; <a class="code" href="namespacellvm_1_1APIntOps.html#a3deb6e6ca37ab496c0ee8996cb06825c">APIntOps::isMask</a>(ActiveBits, N1C-&gt;getAPIntValue())){</div><div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;        <a class="code" href="structllvm_1_1EVT.html">EVT</a> ExtVT = <a class="code" href="structllvm_1_1EVT.html#a752372e170e4e7c595bf8810bb52adf2">EVT::getIntegerVT</a>(*DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a39c6dff47b8dbd25cfaf6336c7056077">getContext</a>(), ActiveBits);</div><div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160;        <a class="code" href="structllvm_1_1EVT.html">EVT</a> LoadedVT = LN0-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a7cead3a2a7771e61083bcc6959915a13">getMemoryVT</a>();</div><div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160;</div><div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160;        <span class="keywordflow">if</span> (ExtVT == LoadedVT &amp;&amp;</div><div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160;            (!LegalOperations || TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#ad85f712b9e49629c2c160f16521fe91f">isLoadExtLegal</a>(<a class="code" href="namespacellvm_1_1ISD.html#ad4d48171b87ca51ff54c10a436bac4d7a8d89c7da4444d9ec11667aa369abc5f7">ISD::ZEXTLOAD</a>, ExtVT))) {</div><div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;          <a class="code" href="structllvm_1_1EVT.html">EVT</a> LoadResultTy = HasAnyExt ? LN0-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(0) : VT;</div><div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;</div><div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160;          <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> NewLoad =</div><div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160;            DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#ad6ff413bea6f8195d8e6f29f4fc519c4">getExtLoad</a>(<a class="code" href="namespacellvm_1_1ISD.html#ad4d48171b87ca51ff54c10a436bac4d7a8d89c7da4444d9ec11667aa369abc5f7">ISD::ZEXTLOAD</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(LN0), LoadResultTy,</div><div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160;                           LN0-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#ae3cb6fbf8c8cb79e10ac61bd98c85211">getChain</a>(), LN0-&gt;<a class="code" href="classllvm_1_1LoadSDNode.html#a3ded48ce66b58b7e7e143991df5dbfae">getBasePtr</a>(), ExtVT,</div><div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160;                           LN0-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a89e2b5e3fb867b4040f893c6ae3d2132">getMemOperand</a>());</div><div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;          AddToWorkList(N);</div><div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;          CombineTo(LN0, NewLoad, NewLoad.<a class="code" href="classllvm_1_1SDValue.html#a040481b9bda32faa6b1435532405d88f">getValue</a>(1));</div><div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;          <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(N, 0);   <span class="comment">// Return N so it doesn&#39;t get rechecked!</span></div><div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;        }</div><div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160;</div><div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;        <span class="comment">// Do not change the width of a volatile load.</span></div><div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;        <span class="comment">// Do not generate loads of non-round integer types since these can</span></div><div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;        <span class="comment">// be expensive (and would be wrong if the type is not byte sized).</span></div><div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;        <span class="keywordflow">if</span> (!LN0-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#acd3bb9ee2ec53fa4be1fdf155b0b5a17">isVolatile</a>() &amp;&amp; LoadedVT.bitsGT(ExtVT) &amp;&amp; ExtVT.<a class="code" href="structllvm_1_1EVT.html#af5afc8257ed5adc0f55be3a9f7587267">isRound</a>() &amp;&amp;</div><div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;            (!LegalOperations || TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#ad85f712b9e49629c2c160f16521fe91f">isLoadExtLegal</a>(<a class="code" href="namespacellvm_1_1ISD.html#ad4d48171b87ca51ff54c10a436bac4d7a8d89c7da4444d9ec11667aa369abc5f7">ISD::ZEXTLOAD</a>, ExtVT))) {</div><div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160;          <a class="code" href="structllvm_1_1EVT.html">EVT</a> PtrType = LN0-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(1).<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>();</div><div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;</div><div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160;          <span class="keywordtype">unsigned</span> Alignment = LN0-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a4f68cd016138440f215ad80c1d6c1e04">getAlignment</a>();</div><div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;          <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> NewPtr = LN0-&gt;<a class="code" href="classllvm_1_1LoadSDNode.html#a3ded48ce66b58b7e7e143991df5dbfae">getBasePtr</a>();</div><div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160;</div><div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160;          <span class="comment">// For big endian targets, we need to add an offset to the pointer</span></div><div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;          <span class="comment">// to load the correct bytes.  For little endian systems, we merely</span></div><div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160;          <span class="comment">// need to read fewer bytes from the same pointer.</span></div><div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160;          <span class="keywordflow">if</span> (TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a785a8016a792dbc65ec16688f180af71">isBigEndian</a>()) {</div><div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;            <span class="keywordtype">unsigned</span> LVTStoreBytes = LoadedVT.getStoreSize();</div><div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160;            <span class="keywordtype">unsigned</span> EVTStoreBytes = ExtVT.<a class="code" href="structllvm_1_1EVT.html#a451be47fed950157cb4c327bc9f91c2d">getStoreSize</a>();</div><div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160;            <span class="keywordtype">unsigned</span> PtrOff = LVTStoreBytes - EVTStoreBytes;</div><div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;            NewPtr = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a269996b43a1f3e1d1f84a70fd4387535">ISD::ADD</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(LN0), PtrType,</div><div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;                                 NewPtr, DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(PtrOff, PtrType));</div><div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;            Alignment = <a class="code" href="namespacellvm.html#af36d7e69ab16b64b2e3a48c83aa9f0f6">MinAlign</a>(Alignment, PtrOff);</div><div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160;          }</div><div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;</div><div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;          AddToWorkList(NewPtr.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160;</div><div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;          <a class="code" href="structllvm_1_1EVT.html">EVT</a> LoadResultTy = HasAnyExt ? LN0-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(0) : VT;</div><div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160;          <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Load =</div><div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160;            DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#ad6ff413bea6f8195d8e6f29f4fc519c4">getExtLoad</a>(<a class="code" href="namespacellvm_1_1ISD.html#ad4d48171b87ca51ff54c10a436bac4d7a8d89c7da4444d9ec11667aa369abc5f7">ISD::ZEXTLOAD</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(LN0), LoadResultTy,</div><div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160;                           LN0-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#ae3cb6fbf8c8cb79e10ac61bd98c85211">getChain</a>(), NewPtr,</div><div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160;                           LN0-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a2fa8491ab36125d7f5dd38d3a4868934">getPointerInfo</a>(),</div><div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160;                           ExtVT, LN0-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#acd3bb9ee2ec53fa4be1fdf155b0b5a17">isVolatile</a>(), LN0-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a967ffaf77f64a5deb1e96951e4224112">isNonTemporal</a>(),</div><div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160;                           Alignment, LN0-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a23670ceb5797afa3d45ca1a9b011fd87">getTBAAInfo</a>());</div><div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160;          AddToWorkList(N);</div><div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160;          CombineTo(LN0, Load, Load.<a class="code" href="classllvm_1_1SDValue.html#a040481b9bda32faa6b1435532405d88f">getValue</a>(1));</div><div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160;          <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(N, 0);   <span class="comment">// Return N so it doesn&#39;t get rechecked!</span></div><div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160;        }</div><div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160;      }</div><div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160;    }</div><div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160;  }</div><div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160;</div><div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;  <span class="keywordflow">if</span> (N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a269996b43a1f3e1d1f84a70fd4387535">ISD::ADD</a> &amp;&amp; N1.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a3c6553c8acebe1b57c211ee45e2d8f98">ISD::SRL</a> &amp;&amp;</div><div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160;      VT.getSizeInBits() &lt;= 64) {</div><div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a> *ADDI = dyn_cast&lt;ConstantSDNode&gt;(N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1))) {</div><div class="line"><a name="l02846"></a><span class="lineno"> 2846</span>&#160;      <a class="code" href="classllvm_1_1APInt.html">APInt</a> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a20084f62caecb0db80ad71bdabda73c2">ADDC</a> = ADDI-&gt;getAPIntValue();</div><div class="line"><a name="l02847"></a><span class="lineno"> 2847</span>&#160;      <span class="keywordflow">if</span> (!TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a62fd51d57f54699226813ca9b46c4d24">isLegalAddImmediate</a>(ADDC.<a class="code" href="classllvm_1_1APInt.html#a7189a37206963029447c31d57771b997">getSExtValue</a>())) {</div><div class="line"><a name="l02848"></a><span class="lineno"> 2848</span>&#160;        <span class="comment">// Look for (and (add x, c1), (lshr y, c2)). If C1 wasn&#39;t a legal</span></div><div class="line"><a name="l02849"></a><span class="lineno"> 2849</span>&#160;        <span class="comment">// immediate for an add, but it is legal if its top c2 bits are set,</span></div><div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160;        <span class="comment">// transform the ADD so the immediate doesn&#39;t need to be materialized</span></div><div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160;        <span class="comment">// in a register.</span></div><div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a> *SRLI = dyn_cast&lt;ConstantSDNode&gt;(N1.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1))) {</div><div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160;          <a class="code" href="classllvm_1_1APInt.html">APInt</a> Mask = <a class="code" href="classllvm_1_1APInt.html#adcb96bd09d7c75c7669fa5f9d1190899">APInt::getHighBitsSet</a>(VT.getSizeInBits(),</div><div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160;                                             SRLI-&gt;getZExtValue());</div><div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160;          <span class="keywordflow">if</span> (DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af99f246db9e144fefd7a73b54ef0bbf7">MaskedValueIsZero</a>(N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1), Mask)) {</div><div class="line"><a name="l02856"></a><span class="lineno"> 2856</span>&#160;            ADDC |= Mask;</div><div class="line"><a name="l02857"></a><span class="lineno"> 2857</span>&#160;            <span class="keywordflow">if</span> (TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a62fd51d57f54699226813ca9b46c4d24">isLegalAddImmediate</a>(ADDC.<a class="code" href="classllvm_1_1APInt.html#a7189a37206963029447c31d57771b997">getSExtValue</a>())) {</div><div class="line"><a name="l02858"></a><span class="lineno"> 2858</span>&#160;              <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> NewAdd =</div><div class="line"><a name="l02859"></a><span class="lineno"> 2859</span>&#160;                DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a269996b43a1f3e1d1f84a70fd4387535">ISD::ADD</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N0), VT,</div><div class="line"><a name="l02860"></a><span class="lineno"> 2860</span>&#160;                            N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0), DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(ADDC, VT));</div><div class="line"><a name="l02861"></a><span class="lineno"> 2861</span>&#160;              CombineTo(N0.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>(), NewAdd);</div><div class="line"><a name="l02862"></a><span class="lineno"> 2862</span>&#160;              <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(N, 0); <span class="comment">// Return N so it doesn&#39;t get rechecked!</span></div><div class="line"><a name="l02863"></a><span class="lineno"> 2863</span>&#160;            }</div><div class="line"><a name="l02864"></a><span class="lineno"> 2864</span>&#160;          }</div><div class="line"><a name="l02865"></a><span class="lineno"> 2865</span>&#160;        }</div><div class="line"><a name="l02866"></a><span class="lineno"> 2866</span>&#160;      }</div><div class="line"><a name="l02867"></a><span class="lineno"> 2867</span>&#160;    }</div><div class="line"><a name="l02868"></a><span class="lineno"> 2868</span>&#160;  }</div><div class="line"><a name="l02869"></a><span class="lineno"> 2869</span>&#160;</div><div class="line"><a name="l02870"></a><span class="lineno"> 2870</span>&#160;  <span class="comment">// fold (and (or (srl N, 8), (shl N, 8)), 0xffff) -&gt; (srl (bswap N), const)</span></div><div class="line"><a name="l02871"></a><span class="lineno"> 2871</span>&#160;  <span class="keywordflow">if</span> (N1C &amp;&amp; N1C-&gt;getAPIntValue() == 0xffff &amp;&amp; N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7415ab9f2172c59a2ee7c7a02afa56a4">ISD::OR</a>) {</div><div class="line"><a name="l02872"></a><span class="lineno"> 2872</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> BSwap = MatchBSwapHWordLow(N0.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>(), N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0),</div><div class="line"><a name="l02873"></a><span class="lineno"> 2873</span>&#160;                                       N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1), <span class="keyword">false</span>);</div><div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160;    <span class="keywordflow">if</span> (BSwap.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>())</div><div class="line"><a name="l02875"></a><span class="lineno"> 2875</span>&#160;      <span class="keywordflow">return</span> BSwap;</div><div class="line"><a name="l02876"></a><span class="lineno"> 2876</span>&#160;  }</div><div class="line"><a name="l02877"></a><span class="lineno"> 2877</span>&#160;</div><div class="line"><a name="l02878"></a><span class="lineno"> 2878</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l02879"></a><span class="lineno"> 2879</span>&#160;}</div><div class="line"><a name="l02880"></a><span class="lineno"> 2880</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02881"></a><span class="lineno"> 2881</span>&#160;<span class="comment">/// MatchBSwapHWord - Match (a &gt;&gt; 8) | (a &lt;&lt; 8) as (bswap a) &gt;&gt; 16</span></div><div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160;<span class="comment"></span><a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::MatchBSwapHWordLow(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N, <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N0, <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N1,</div><div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160;                                        <span class="keywordtype">bool</span> DemandHighBits) {</div><div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160;  <span class="keywordflow">if</span> (!LegalOperations)</div><div class="line"><a name="l02886"></a><span class="lineno"> 2886</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l02887"></a><span class="lineno"> 2887</span>&#160;</div><div class="line"><a name="l02888"></a><span class="lineno"> 2888</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> VT = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(0);</div><div class="line"><a name="l02889"></a><span class="lineno"> 2889</span>&#160;  <span class="keywordflow">if</span> (VT != <a class="code" href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50ca97f56253625b3fe7b371ce76722de4b8">MVT::i64</a> &amp;&amp; VT != <a class="code" href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50ca04cca8bc12888d0a7238f55a6c550ad0">MVT::i32</a> &amp;&amp; VT != <a class="code" href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50cab3be25b50efa0289a3c86fd50454b683">MVT::i16</a>)</div><div class="line"><a name="l02890"></a><span class="lineno"> 2890</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l02891"></a><span class="lineno"> 2891</span>&#160;  <span class="keywordflow">if</span> (!TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a055b3905dbbc16fae11510b9ebd1e00c">isOperationLegal</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a19328c462764af5f4699fb1698dad994">ISD::BSWAP</a>, VT))</div><div class="line"><a name="l02892"></a><span class="lineno"> 2892</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l02893"></a><span class="lineno"> 2893</span>&#160;</div><div class="line"><a name="l02894"></a><span class="lineno"> 2894</span>&#160;  <span class="comment">// Recognize (and (shl a, 8), 0xff), (and (srl a, 8), 0xff00)</span></div><div class="line"><a name="l02895"></a><span class="lineno"> 2895</span>&#160;  <span class="keywordtype">bool</span> LookPassAnd0 = <span class="keyword">false</span>;</div><div class="line"><a name="l02896"></a><span class="lineno"> 2896</span>&#160;  <span class="keywordtype">bool</span> LookPassAnd1 = <span class="keyword">false</span>;</div><div class="line"><a name="l02897"></a><span class="lineno"> 2897</span>&#160;  <span class="keywordflow">if</span> (N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ac513a7da1bf74fb3e3c594da8534f2d2">ISD::AND</a> &amp;&amp; N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a3c6553c8acebe1b57c211ee45e2d8f98">ISD::SRL</a>)</div><div class="line"><a name="l02898"></a><span class="lineno"> 2898</span>&#160;      <a class="code" href="namespacestd.html#ab8424022895aee3e366fb9a32f2883cb">std::swap</a>(N0, N1);</div><div class="line"><a name="l02899"></a><span class="lineno"> 2899</span>&#160;  <span class="keywordflow">if</span> (N1.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ac513a7da1bf74fb3e3c594da8534f2d2">ISD::AND</a> &amp;&amp; N1.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a8cc94e03dea594863073a02f5bb94997">ISD::SHL</a>)</div><div class="line"><a name="l02900"></a><span class="lineno"> 2900</span>&#160;      <a class="code" href="namespacestd.html#ab8424022895aee3e366fb9a32f2883cb">std::swap</a>(N0, N1);</div><div class="line"><a name="l02901"></a><span class="lineno"> 2901</span>&#160;  <span class="keywordflow">if</span> (N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ac513a7da1bf74fb3e3c594da8534f2d2">ISD::AND</a>) {</div><div class="line"><a name="l02902"></a><span class="lineno"> 2902</span>&#160;    <span class="keywordflow">if</span> (!N0.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()-&gt;<a class="code" href="classllvm_1_1SDNode.html#a52753947fce3a01b1c18dd4713c587e8">hasOneUse</a>())</div><div class="line"><a name="l02903"></a><span class="lineno"> 2903</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l02904"></a><span class="lineno"> 2904</span>&#160;    <a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a> *N01C = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a>&gt;(N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1));</div><div class="line"><a name="l02905"></a><span class="lineno"> 2905</span>&#160;    <span class="keywordflow">if</span> (!N01C || N01C-&gt;<a class="code" href="classllvm_1_1ConstantSDNode.html#a1e9365c991dd55e65e9d5ab5653812e4">getZExtValue</a>() != 0xFF00)</div><div class="line"><a name="l02906"></a><span class="lineno"> 2906</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l02907"></a><span class="lineno"> 2907</span>&#160;    N0 = N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0);</div><div class="line"><a name="l02908"></a><span class="lineno"> 2908</span>&#160;    LookPassAnd0 = <span class="keyword">true</span>;</div><div class="line"><a name="l02909"></a><span class="lineno"> 2909</span>&#160;  }</div><div class="line"><a name="l02910"></a><span class="lineno"> 2910</span>&#160;</div><div class="line"><a name="l02911"></a><span class="lineno"> 2911</span>&#160;  <span class="keywordflow">if</span> (N1.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ac513a7da1bf74fb3e3c594da8534f2d2">ISD::AND</a>) {</div><div class="line"><a name="l02912"></a><span class="lineno"> 2912</span>&#160;    <span class="keywordflow">if</span> (!N1.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()-&gt;<a class="code" href="classllvm_1_1SDNode.html#a52753947fce3a01b1c18dd4713c587e8">hasOneUse</a>())</div><div class="line"><a name="l02913"></a><span class="lineno"> 2913</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l02914"></a><span class="lineno"> 2914</span>&#160;    <a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a> *N11C = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a>&gt;(N1.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1));</div><div class="line"><a name="l02915"></a><span class="lineno"> 2915</span>&#160;    <span class="keywordflow">if</span> (!N11C || N11C-&gt;<a class="code" href="classllvm_1_1ConstantSDNode.html#a1e9365c991dd55e65e9d5ab5653812e4">getZExtValue</a>() != 0xFF)</div><div class="line"><a name="l02916"></a><span class="lineno"> 2916</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l02917"></a><span class="lineno"> 2917</span>&#160;    N1 = N1.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0);</div><div class="line"><a name="l02918"></a><span class="lineno"> 2918</span>&#160;    LookPassAnd1 = <span class="keyword">true</span>;</div><div class="line"><a name="l02919"></a><span class="lineno"> 2919</span>&#160;  }</div><div class="line"><a name="l02920"></a><span class="lineno"> 2920</span>&#160;</div><div class="line"><a name="l02921"></a><span class="lineno"> 2921</span>&#160;  <span class="keywordflow">if</span> (N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a3c6553c8acebe1b57c211ee45e2d8f98">ISD::SRL</a> &amp;&amp; N1.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a8cc94e03dea594863073a02f5bb94997">ISD::SHL</a>)</div><div class="line"><a name="l02922"></a><span class="lineno"> 2922</span>&#160;    <a class="code" href="namespacestd.html#ab8424022895aee3e366fb9a32f2883cb">std::swap</a>(N0, N1);</div><div class="line"><a name="l02923"></a><span class="lineno"> 2923</span>&#160;  <span class="keywordflow">if</span> (N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() != <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a8cc94e03dea594863073a02f5bb94997">ISD::SHL</a> || N1.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() != <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a3c6553c8acebe1b57c211ee45e2d8f98">ISD::SRL</a>)</div><div class="line"><a name="l02924"></a><span class="lineno"> 2924</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l02925"></a><span class="lineno"> 2925</span>&#160;  <span class="keywordflow">if</span> (!N0.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()-&gt;<a class="code" href="classllvm_1_1SDNode.html#a52753947fce3a01b1c18dd4713c587e8">hasOneUse</a>() ||</div><div class="line"><a name="l02926"></a><span class="lineno"> 2926</span>&#160;      !N1.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()-&gt;<a class="code" href="classllvm_1_1SDNode.html#a52753947fce3a01b1c18dd4713c587e8">hasOneUse</a>())</div><div class="line"><a name="l02927"></a><span class="lineno"> 2927</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l02928"></a><span class="lineno"> 2928</span>&#160;</div><div class="line"><a name="l02929"></a><span class="lineno"> 2929</span>&#160;  <a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a> *N01C = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a>&gt;(N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1));</div><div class="line"><a name="l02930"></a><span class="lineno"> 2930</span>&#160;  <a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a> *N11C = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a>&gt;(N1.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1));</div><div class="line"><a name="l02931"></a><span class="lineno"> 2931</span>&#160;  <span class="keywordflow">if</span> (!N01C || !N11C)</div><div class="line"><a name="l02932"></a><span class="lineno"> 2932</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l02933"></a><span class="lineno"> 2933</span>&#160;  <span class="keywordflow">if</span> (N01C-&gt;<a class="code" href="classllvm_1_1ConstantSDNode.html#a1e9365c991dd55e65e9d5ab5653812e4">getZExtValue</a>() != 8 || N11C-&gt;getZExtValue() != 8)</div><div class="line"><a name="l02934"></a><span class="lineno"> 2934</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l02935"></a><span class="lineno"> 2935</span>&#160;</div><div class="line"><a name="l02936"></a><span class="lineno"> 2936</span>&#160;  <span class="comment">// Look for (shl (and a, 0xff), 8), (srl (and a, 0xff00), 8)</span></div><div class="line"><a name="l02937"></a><span class="lineno"> 2937</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N00 = N0-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0);</div><div class="line"><a name="l02938"></a><span class="lineno"> 2938</span>&#160;  <span class="keywordflow">if</span> (!LookPassAnd0 &amp;&amp; N00.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ac513a7da1bf74fb3e3c594da8534f2d2">ISD::AND</a>) {</div><div class="line"><a name="l02939"></a><span class="lineno"> 2939</span>&#160;    <span class="keywordflow">if</span> (!N00.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()-&gt;<a class="code" href="classllvm_1_1SDNode.html#a52753947fce3a01b1c18dd4713c587e8">hasOneUse</a>())</div><div class="line"><a name="l02940"></a><span class="lineno"> 2940</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l02941"></a><span class="lineno"> 2941</span>&#160;    <a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a> *N001C = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a>&gt;(N00.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1));</div><div class="line"><a name="l02942"></a><span class="lineno"> 2942</span>&#160;    <span class="keywordflow">if</span> (!N001C || N001C-&gt;<a class="code" href="classllvm_1_1ConstantSDNode.html#a1e9365c991dd55e65e9d5ab5653812e4">getZExtValue</a>() != 0xFF)</div><div class="line"><a name="l02943"></a><span class="lineno"> 2943</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l02944"></a><span class="lineno"> 2944</span>&#160;    N00 = N00.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0);</div><div class="line"><a name="l02945"></a><span class="lineno"> 2945</span>&#160;    LookPassAnd0 = <span class="keyword">true</span>;</div><div class="line"><a name="l02946"></a><span class="lineno"> 2946</span>&#160;  }</div><div class="line"><a name="l02947"></a><span class="lineno"> 2947</span>&#160;</div><div class="line"><a name="l02948"></a><span class="lineno"> 2948</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N10 = N1-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0);</div><div class="line"><a name="l02949"></a><span class="lineno"> 2949</span>&#160;  <span class="keywordflow">if</span> (!LookPassAnd1 &amp;&amp; N10.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ac513a7da1bf74fb3e3c594da8534f2d2">ISD::AND</a>) {</div><div class="line"><a name="l02950"></a><span class="lineno"> 2950</span>&#160;    <span class="keywordflow">if</span> (!N10.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()-&gt;<a class="code" href="classllvm_1_1SDNode.html#a52753947fce3a01b1c18dd4713c587e8">hasOneUse</a>())</div><div class="line"><a name="l02951"></a><span class="lineno"> 2951</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l02952"></a><span class="lineno"> 2952</span>&#160;    <a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a> *N101C = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a>&gt;(N10.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1));</div><div class="line"><a name="l02953"></a><span class="lineno"> 2953</span>&#160;    <span class="keywordflow">if</span> (!N101C || N101C-&gt;<a class="code" href="classllvm_1_1ConstantSDNode.html#a1e9365c991dd55e65e9d5ab5653812e4">getZExtValue</a>() != 0xFF00)</div><div class="line"><a name="l02954"></a><span class="lineno"> 2954</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l02955"></a><span class="lineno"> 2955</span>&#160;    N10 = N10.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0);</div><div class="line"><a name="l02956"></a><span class="lineno"> 2956</span>&#160;    LookPassAnd1 = <span class="keyword">true</span>;</div><div class="line"><a name="l02957"></a><span class="lineno"> 2957</span>&#160;  }</div><div class="line"><a name="l02958"></a><span class="lineno"> 2958</span>&#160;</div><div class="line"><a name="l02959"></a><span class="lineno"> 2959</span>&#160;  <span class="keywordflow">if</span> (N00 != N10)</div><div class="line"><a name="l02960"></a><span class="lineno"> 2960</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l02961"></a><span class="lineno"> 2961</span>&#160;</div><div class="line"><a name="l02962"></a><span class="lineno"> 2962</span>&#160;  <span class="comment">// Make sure everything beyond the low halfword gets set to zero since the SRL</span></div><div class="line"><a name="l02963"></a><span class="lineno"> 2963</span>&#160;  <span class="comment">// 16 will clear the top bits.</span></div><div class="line"><a name="l02964"></a><span class="lineno"> 2964</span>&#160;  <span class="keywordtype">unsigned</span> OpSizeInBits = VT.<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>();</div><div class="line"><a name="l02965"></a><span class="lineno"> 2965</span>&#160;  <span class="keywordflow">if</span> (DemandHighBits &amp;&amp; OpSizeInBits &gt; 16) {</div><div class="line"><a name="l02966"></a><span class="lineno"> 2966</span>&#160;    <span class="comment">// If the left-shift isn&#39;t masked out then the only way this is a bswap is</span></div><div class="line"><a name="l02967"></a><span class="lineno"> 2967</span>&#160;    <span class="comment">// if all bits beyond the low 8 are 0. In that case the entire pattern</span></div><div class="line"><a name="l02968"></a><span class="lineno"> 2968</span>&#160;    <span class="comment">// reduces to a left shift anyway: leave it for other parts of the combiner.</span></div><div class="line"><a name="l02969"></a><span class="lineno"> 2969</span>&#160;    <span class="keywordflow">if</span> (!LookPassAnd0)</div><div class="line"><a name="l02970"></a><span class="lineno"> 2970</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l02971"></a><span class="lineno"> 2971</span>&#160;</div><div class="line"><a name="l02972"></a><span class="lineno"> 2972</span>&#160;    <span class="comment">// However, if the right shift isn&#39;t masked out then it might be because</span></div><div class="line"><a name="l02973"></a><span class="lineno"> 2973</span>&#160;    <span class="comment">// it&#39;s not needed. See if we can spot that too.</span></div><div class="line"><a name="l02974"></a><span class="lineno"> 2974</span>&#160;    <span class="keywordflow">if</span> (!LookPassAnd1 &amp;&amp;</div><div class="line"><a name="l02975"></a><span class="lineno"> 2975</span>&#160;        !DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af99f246db9e144fefd7a73b54ef0bbf7">MaskedValueIsZero</a>(</div><div class="line"><a name="l02976"></a><span class="lineno"> 2976</span>&#160;            N10, <a class="code" href="classllvm_1_1APInt.html#adcb96bd09d7c75c7669fa5f9d1190899">APInt::getHighBitsSet</a>(OpSizeInBits, OpSizeInBits - 16)))</div><div class="line"><a name="l02977"></a><span class="lineno"> 2977</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l02978"></a><span class="lineno"> 2978</span>&#160;  }</div><div class="line"><a name="l02979"></a><span class="lineno"> 2979</span>&#160;</div><div class="line"><a name="l02980"></a><span class="lineno"> 2980</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Res = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a19328c462764af5f4699fb1698dad994">ISD::BSWAP</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N00);</div><div class="line"><a name="l02981"></a><span class="lineno"> 2981</span>&#160;  <span class="keywordflow">if</span> (OpSizeInBits &gt; 16)</div><div class="line"><a name="l02982"></a><span class="lineno"> 2982</span>&#160;    Res = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a3c6553c8acebe1b57c211ee45e2d8f98">ISD::SRL</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, Res,</div><div class="line"><a name="l02983"></a><span class="lineno"> 2983</span>&#160;                      DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(OpSizeInBits-16, getShiftAmountTy(VT)));</div><div class="line"><a name="l02984"></a><span class="lineno"> 2984</span>&#160;  <span class="keywordflow">return</span> Res;</div><div class="line"><a name="l02985"></a><span class="lineno"> 2985</span>&#160;}</div><div class="line"><a name="l02986"></a><span class="lineno"> 2986</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02987"></a><span class="lineno"> 2987</span>&#160;<span class="comment">/// isBSwapHWordElement - Return true if the specified node is an element</span></div><div class="line"><a name="l02988"></a><span class="lineno"> 2988</span>&#160;<span class="comment">/// that makes up a 32-bit packed halfword byteswap. i.e.</span></div><div class="line"><a name="l02989"></a><span class="lineno"> 2989</span>&#160;<span class="comment">/// ((x&amp;0xff)&lt;&lt;8)|((x&amp;0xff00)&gt;&gt;8)|((x&amp;0x00ff0000)&lt;&lt;8)|((x&amp;0xff000000)&gt;&gt;8)</span></div><div class="line"><a name="l02990"></a><span class="lineno"><a class="line" href="DAGCombiner_8cpp.html#ae17ca2c848149cf9af40c6df29296a77"> 2990</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="DAGCombiner_8cpp.html#ae17ca2c848149cf9af40c6df29296a77">isBSwapHWordElement</a>(<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N, <a class="code" href="classllvm_1_1SmallVectorImpl.html">SmallVectorImpl&lt;SDNode *&gt;</a> &amp;Parts) {</div><div class="line"><a name="l02991"></a><span class="lineno"> 2991</span>&#160;  <span class="keywordflow">if</span> (!N.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()-&gt;<a class="code" href="classllvm_1_1SDNode.html#a52753947fce3a01b1c18dd4713c587e8">hasOneUse</a>())</div><div class="line"><a name="l02992"></a><span class="lineno"> 2992</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l02993"></a><span class="lineno"> 2993</span>&#160;</div><div class="line"><a name="l02994"></a><span class="lineno"> 2994</span>&#160;  <span class="keywordtype">unsigned</span> Opc = N.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>();</div><div class="line"><a name="l02995"></a><span class="lineno"> 2995</span>&#160;  <span class="keywordflow">if</span> (Opc != <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ac513a7da1bf74fb3e3c594da8534f2d2">ISD::AND</a> &amp;&amp; Opc != <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a8cc94e03dea594863073a02f5bb94997">ISD::SHL</a> &amp;&amp; Opc != <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a3c6553c8acebe1b57c211ee45e2d8f98">ISD::SRL</a>)</div><div class="line"><a name="l02996"></a><span class="lineno"> 2996</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l02997"></a><span class="lineno"> 2997</span>&#160;</div><div class="line"><a name="l02998"></a><span class="lineno"> 2998</span>&#160;  <a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a> *N1C = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a>&gt;(N.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1));</div><div class="line"><a name="l02999"></a><span class="lineno"> 2999</span>&#160;  <span class="keywordflow">if</span> (!N1C)</div><div class="line"><a name="l03000"></a><span class="lineno"> 3000</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l03001"></a><span class="lineno"> 3001</span>&#160;</div><div class="line"><a name="l03002"></a><span class="lineno"> 3002</span>&#160;  <span class="keywordtype">unsigned</span> Num;</div><div class="line"><a name="l03003"></a><span class="lineno"> 3003</span>&#160;  <span class="keywordflow">switch</span> (N1C-&gt;<a class="code" href="classllvm_1_1ConstantSDNode.html#a1e9365c991dd55e65e9d5ab5653812e4">getZExtValue</a>()) {</div><div class="line"><a name="l03004"></a><span class="lineno"> 3004</span>&#160;  <span class="keywordflow">default</span>:</div><div class="line"><a name="l03005"></a><span class="lineno"> 3005</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l03006"></a><span class="lineno"> 3006</span>&#160;  <span class="keywordflow">case</span> 0xFF:       Num = 0; <span class="keywordflow">break</span>;</div><div class="line"><a name="l03007"></a><span class="lineno"> 3007</span>&#160;  <span class="keywordflow">case</span> 0xFF00:     Num = 1; <span class="keywordflow">break</span>;</div><div class="line"><a name="l03008"></a><span class="lineno"> 3008</span>&#160;  <span class="keywordflow">case</span> 0xFF0000:   Num = 2; <span class="keywordflow">break</span>;</div><div class="line"><a name="l03009"></a><span class="lineno"> 3009</span>&#160;  <span class="keywordflow">case</span> 0xFF000000: Num = 3; <span class="keywordflow">break</span>;</div><div class="line"><a name="l03010"></a><span class="lineno"> 3010</span>&#160;  }</div><div class="line"><a name="l03011"></a><span class="lineno"> 3011</span>&#160;</div><div class="line"><a name="l03012"></a><span class="lineno"> 3012</span>&#160;  <span class="comment">// Look for (x &amp; 0xff) &lt;&lt; 8 as well as ((x &lt;&lt; 8) &amp; 0xff00).</span></div><div class="line"><a name="l03013"></a><span class="lineno"> 3013</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N0 = N.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0);</div><div class="line"><a name="l03014"></a><span class="lineno"> 3014</span>&#160;  <span class="keywordflow">if</span> (Opc == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ac513a7da1bf74fb3e3c594da8534f2d2">ISD::AND</a>) {</div><div class="line"><a name="l03015"></a><span class="lineno"> 3015</span>&#160;    <span class="keywordflow">if</span> (Num == 0 || Num == 2) {</div><div class="line"><a name="l03016"></a><span class="lineno"> 3016</span>&#160;      <span class="comment">// (x &gt;&gt; 8) &amp; 0xff</span></div><div class="line"><a name="l03017"></a><span class="lineno"> 3017</span>&#160;      <span class="comment">// (x &gt;&gt; 8) &amp; 0xff0000</span></div><div class="line"><a name="l03018"></a><span class="lineno"> 3018</span>&#160;      <span class="keywordflow">if</span> (N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() != <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a3c6553c8acebe1b57c211ee45e2d8f98">ISD::SRL</a>)</div><div class="line"><a name="l03019"></a><span class="lineno"> 3019</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l03020"></a><span class="lineno"> 3020</span>&#160;      <a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a> *<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a>&gt;(N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1));</div><div class="line"><a name="l03021"></a><span class="lineno"> 3021</span>&#160;      <span class="keywordflow">if</span> (!C || C-&gt;<a class="code" href="classllvm_1_1ConstantSDNode.html#a1e9365c991dd55e65e9d5ab5653812e4">getZExtValue</a>() != 8)</div><div class="line"><a name="l03022"></a><span class="lineno"> 3022</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l03023"></a><span class="lineno"> 3023</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l03024"></a><span class="lineno"> 3024</span>&#160;      <span class="comment">// (x &lt;&lt; 8) &amp; 0xff00</span></div><div class="line"><a name="l03025"></a><span class="lineno"> 3025</span>&#160;      <span class="comment">// (x &lt;&lt; 8) &amp; 0xff000000</span></div><div class="line"><a name="l03026"></a><span class="lineno"> 3026</span>&#160;      <span class="keywordflow">if</span> (N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() != <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a8cc94e03dea594863073a02f5bb94997">ISD::SHL</a>)</div><div class="line"><a name="l03027"></a><span class="lineno"> 3027</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l03028"></a><span class="lineno"> 3028</span>&#160;      <a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a> *<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a>&gt;(N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1));</div><div class="line"><a name="l03029"></a><span class="lineno"> 3029</span>&#160;      <span class="keywordflow">if</span> (!C || C-&gt;<a class="code" href="classllvm_1_1ConstantSDNode.html#a1e9365c991dd55e65e9d5ab5653812e4">getZExtValue</a>() != 8)</div><div class="line"><a name="l03030"></a><span class="lineno"> 3030</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l03031"></a><span class="lineno"> 3031</span>&#160;    }</div><div class="line"><a name="l03032"></a><span class="lineno"> 3032</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Opc == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a8cc94e03dea594863073a02f5bb94997">ISD::SHL</a>) {</div><div class="line"><a name="l03033"></a><span class="lineno"> 3033</span>&#160;    <span class="comment">// (x &amp; 0xff) &lt;&lt; 8</span></div><div class="line"><a name="l03034"></a><span class="lineno"> 3034</span>&#160;    <span class="comment">// (x &amp; 0xff0000) &lt;&lt; 8</span></div><div class="line"><a name="l03035"></a><span class="lineno"> 3035</span>&#160;    <span class="keywordflow">if</span> (Num != 0 &amp;&amp; Num != 2)</div><div class="line"><a name="l03036"></a><span class="lineno"> 3036</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l03037"></a><span class="lineno"> 3037</span>&#160;    <a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a> *<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a>&gt;(N.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1));</div><div class="line"><a name="l03038"></a><span class="lineno"> 3038</span>&#160;    <span class="keywordflow">if</span> (!C || C-&gt;<a class="code" href="classllvm_1_1ConstantSDNode.html#a1e9365c991dd55e65e9d5ab5653812e4">getZExtValue</a>() != 8)</div><div class="line"><a name="l03039"></a><span class="lineno"> 3039</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l03040"></a><span class="lineno"> 3040</span>&#160;  } <span class="keywordflow">else</span> { <span class="comment">// Opc == ISD::SRL</span></div><div class="line"><a name="l03041"></a><span class="lineno"> 3041</span>&#160;    <span class="comment">// (x &amp; 0xff00) &gt;&gt; 8</span></div><div class="line"><a name="l03042"></a><span class="lineno"> 3042</span>&#160;    <span class="comment">// (x &amp; 0xff000000) &gt;&gt; 8</span></div><div class="line"><a name="l03043"></a><span class="lineno"> 3043</span>&#160;    <span class="keywordflow">if</span> (Num != 1 &amp;&amp; Num != 3)</div><div class="line"><a name="l03044"></a><span class="lineno"> 3044</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l03045"></a><span class="lineno"> 3045</span>&#160;    <a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a> *<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a>&gt;(N.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1));</div><div class="line"><a name="l03046"></a><span class="lineno"> 3046</span>&#160;    <span class="keywordflow">if</span> (!C || C-&gt;<a class="code" href="classllvm_1_1ConstantSDNode.html#a1e9365c991dd55e65e9d5ab5653812e4">getZExtValue</a>() != 8)</div><div class="line"><a name="l03047"></a><span class="lineno"> 3047</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l03048"></a><span class="lineno"> 3048</span>&#160;  }</div><div class="line"><a name="l03049"></a><span class="lineno"> 3049</span>&#160;</div><div class="line"><a name="l03050"></a><span class="lineno"> 3050</span>&#160;  <span class="keywordflow">if</span> (Parts[Num])</div><div class="line"><a name="l03051"></a><span class="lineno"> 3051</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l03052"></a><span class="lineno"> 3052</span>&#160;</div><div class="line"><a name="l03053"></a><span class="lineno"> 3053</span>&#160;  Parts[Num] = N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>();</div><div class="line"><a name="l03054"></a><span class="lineno"> 3054</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l03055"></a><span class="lineno"> 3055</span>&#160;}</div><div class="line"><a name="l03056"></a><span class="lineno"> 3056</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03057"></a><span class="lineno"> 3057</span>&#160;<span class="comment">/// MatchBSwapHWord - Match a 32-bit packed halfword bswap. That is</span></div><div class="line"><a name="l03058"></a><span class="lineno"> 3058</span>&#160;<span class="comment">/// ((x&amp;0xff)&lt;&lt;8)|((x&amp;0xff00)&gt;&gt;8)|((x&amp;0x00ff0000)&lt;&lt;8)|((x&amp;0xff000000)&gt;&gt;8)</span></div><div class="line"><a name="l03059"></a><span class="lineno"> 3059</span>&#160;<span class="comment">/// =&gt; (rotl (bswap x), 16)</span></div><div class="line"><a name="l03060"></a><span class="lineno"> 3060</span>&#160;<span class="comment"></span><a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::MatchBSwapHWord(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N, <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N0, <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N1) {</div><div class="line"><a name="l03061"></a><span class="lineno"> 3061</span>&#160;  <span class="keywordflow">if</span> (!LegalOperations)</div><div class="line"><a name="l03062"></a><span class="lineno"> 3062</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l03063"></a><span class="lineno"> 3063</span>&#160;</div><div class="line"><a name="l03064"></a><span class="lineno"> 3064</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> VT = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(0);</div><div class="line"><a name="l03065"></a><span class="lineno"> 3065</span>&#160;  <span class="keywordflow">if</span> (VT != <a class="code" href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50ca04cca8bc12888d0a7238f55a6c550ad0">MVT::i32</a>)</div><div class="line"><a name="l03066"></a><span class="lineno"> 3066</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l03067"></a><span class="lineno"> 3067</span>&#160;  <span class="keywordflow">if</span> (!TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a055b3905dbbc16fae11510b9ebd1e00c">isOperationLegal</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a19328c462764af5f4699fb1698dad994">ISD::BSWAP</a>, VT))</div><div class="line"><a name="l03068"></a><span class="lineno"> 3068</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l03069"></a><span class="lineno"> 3069</span>&#160;</div><div class="line"><a name="l03070"></a><span class="lineno"> 3070</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;SDNode*,4&gt;</a> Parts(4, (<a class="code" href="classllvm_1_1SDNode.html">SDNode</a>*)0);</div><div class="line"><a name="l03071"></a><span class="lineno"> 3071</span>&#160;  <span class="comment">// Look for either</span></div><div class="line"><a name="l03072"></a><span class="lineno"> 3072</span>&#160;  <span class="comment">// (or (or (and), (and)), (or (and), (and)))</span></div><div class="line"><a name="l03073"></a><span class="lineno"> 3073</span>&#160;  <span class="comment">// (or (or (or (and), (and)), (and)), (and))</span></div><div class="line"><a name="l03074"></a><span class="lineno"> 3074</span>&#160;  <span class="keywordflow">if</span> (N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() != <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7415ab9f2172c59a2ee7c7a02afa56a4">ISD::OR</a>)</div><div class="line"><a name="l03075"></a><span class="lineno"> 3075</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l03076"></a><span class="lineno"> 3076</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N00 = N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0);</div><div class="line"><a name="l03077"></a><span class="lineno"> 3077</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N01 = N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1);</div><div class="line"><a name="l03078"></a><span class="lineno"> 3078</span>&#160;</div><div class="line"><a name="l03079"></a><span class="lineno"> 3079</span>&#160;  <span class="keywordflow">if</span> (N1.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7415ab9f2172c59a2ee7c7a02afa56a4">ISD::OR</a> &amp;&amp;</div><div class="line"><a name="l03080"></a><span class="lineno"> 3080</span>&#160;      N00.<a class="code" href="classllvm_1_1SDValue.html#a5f0447ef8ec128563ad131b76e5062bd">getNumOperands</a>() == 2 &amp;&amp; N01.<a class="code" href="classllvm_1_1SDValue.html#a5f0447ef8ec128563ad131b76e5062bd">getNumOperands</a>() == 2) {</div><div class="line"><a name="l03081"></a><span class="lineno"> 3081</span>&#160;    <span class="comment">// (or (or (and), (and)), (or (and), (and)))</span></div><div class="line"><a name="l03082"></a><span class="lineno"> 3082</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N000 = N00.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0);</div><div class="line"><a name="l03083"></a><span class="lineno"> 3083</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="DAGCombiner_8cpp.html#ae17ca2c848149cf9af40c6df29296a77">isBSwapHWordElement</a>(N000, Parts))</div><div class="line"><a name="l03084"></a><span class="lineno"> 3084</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l03085"></a><span class="lineno"> 3085</span>&#160;</div><div class="line"><a name="l03086"></a><span class="lineno"> 3086</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N001 = N00.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1);</div><div class="line"><a name="l03087"></a><span class="lineno"> 3087</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="DAGCombiner_8cpp.html#ae17ca2c848149cf9af40c6df29296a77">isBSwapHWordElement</a>(N001, Parts))</div><div class="line"><a name="l03088"></a><span class="lineno"> 3088</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l03089"></a><span class="lineno"> 3089</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N010 = N01.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0);</div><div class="line"><a name="l03090"></a><span class="lineno"> 3090</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="DAGCombiner_8cpp.html#ae17ca2c848149cf9af40c6df29296a77">isBSwapHWordElement</a>(N010, Parts))</div><div class="line"><a name="l03091"></a><span class="lineno"> 3091</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l03092"></a><span class="lineno"> 3092</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N011 = N01.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1);</div><div class="line"><a name="l03093"></a><span class="lineno"> 3093</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="DAGCombiner_8cpp.html#ae17ca2c848149cf9af40c6df29296a77">isBSwapHWordElement</a>(N011, Parts))</div><div class="line"><a name="l03094"></a><span class="lineno"> 3094</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l03095"></a><span class="lineno"> 3095</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l03096"></a><span class="lineno"> 3096</span>&#160;    <span class="comment">// (or (or (or (and), (and)), (and)), (and))</span></div><div class="line"><a name="l03097"></a><span class="lineno"> 3097</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="DAGCombiner_8cpp.html#ae17ca2c848149cf9af40c6df29296a77">isBSwapHWordElement</a>(N1, Parts))</div><div class="line"><a name="l03098"></a><span class="lineno"> 3098</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l03099"></a><span class="lineno"> 3099</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="DAGCombiner_8cpp.html#ae17ca2c848149cf9af40c6df29296a77">isBSwapHWordElement</a>(N01, Parts))</div><div class="line"><a name="l03100"></a><span class="lineno"> 3100</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l03101"></a><span class="lineno"> 3101</span>&#160;    <span class="keywordflow">if</span> (N00.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() != <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7415ab9f2172c59a2ee7c7a02afa56a4">ISD::OR</a>)</div><div class="line"><a name="l03102"></a><span class="lineno"> 3102</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l03103"></a><span class="lineno"> 3103</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N000 = N00.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0);</div><div class="line"><a name="l03104"></a><span class="lineno"> 3104</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="DAGCombiner_8cpp.html#ae17ca2c848149cf9af40c6df29296a77">isBSwapHWordElement</a>(N000, Parts))</div><div class="line"><a name="l03105"></a><span class="lineno"> 3105</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l03106"></a><span class="lineno"> 3106</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N001 = N00.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1);</div><div class="line"><a name="l03107"></a><span class="lineno"> 3107</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="DAGCombiner_8cpp.html#ae17ca2c848149cf9af40c6df29296a77">isBSwapHWordElement</a>(N001, Parts))</div><div class="line"><a name="l03108"></a><span class="lineno"> 3108</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l03109"></a><span class="lineno"> 3109</span>&#160;  }</div><div class="line"><a name="l03110"></a><span class="lineno"> 3110</span>&#160;</div><div class="line"><a name="l03111"></a><span class="lineno"> 3111</span>&#160;  <span class="comment">// Make sure the parts are all coming from the same node.</span></div><div class="line"><a name="l03112"></a><span class="lineno"> 3112</span>&#160;  <span class="keywordflow">if</span> (Parts[0] != Parts[1] || Parts[0] != Parts[2] || Parts[0] != Parts[3])</div><div class="line"><a name="l03113"></a><span class="lineno"> 3113</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l03114"></a><span class="lineno"> 3114</span>&#160;</div><div class="line"><a name="l03115"></a><span class="lineno"> 3115</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> BSwap = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a19328c462764af5f4699fb1698dad994">ISD::BSWAP</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT,</div><div class="line"><a name="l03116"></a><span class="lineno"> 3116</span>&#160;                              <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(Parts[0],0));</div><div class="line"><a name="l03117"></a><span class="lineno"> 3117</span>&#160;</div><div class="line"><a name="l03118"></a><span class="lineno"> 3118</span>&#160;  <span class="comment">// Result of the bswap should be rotated by 16. If it&#39;s not legal, then</span></div><div class="line"><a name="l03119"></a><span class="lineno"> 3119</span>&#160;  <span class="comment">// do  (x &lt;&lt; 16) | (x &gt;&gt; 16).</span></div><div class="line"><a name="l03120"></a><span class="lineno"> 3120</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> ShAmt = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(16, getShiftAmountTy(VT));</div><div class="line"><a name="l03121"></a><span class="lineno"> 3121</span>&#160;  <span class="keywordflow">if</span> (TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a087dd0f9650e999b087c17cc7f46f2d0">isOperationLegalOrCustom</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ae8f8f81d8e8d7a557d67622c05786f1d">ISD::ROTL</a>, VT))</div><div class="line"><a name="l03122"></a><span class="lineno"> 3122</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ae8f8f81d8e8d7a557d67622c05786f1d">ISD::ROTL</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, BSwap, ShAmt);</div><div class="line"><a name="l03123"></a><span class="lineno"> 3123</span>&#160;  <span class="keywordflow">if</span> (TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a087dd0f9650e999b087c17cc7f46f2d0">isOperationLegalOrCustom</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a19cd524269b035941434cce28b585715">ISD::ROTR</a>, VT))</div><div class="line"><a name="l03124"></a><span class="lineno"> 3124</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a19cd524269b035941434cce28b585715">ISD::ROTR</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, BSwap, ShAmt);</div><div class="line"><a name="l03125"></a><span class="lineno"> 3125</span>&#160;  <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7415ab9f2172c59a2ee7c7a02afa56a4">ISD::OR</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT,</div><div class="line"><a name="l03126"></a><span class="lineno"> 3126</span>&#160;                     DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a8cc94e03dea594863073a02f5bb94997">ISD::SHL</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, BSwap, ShAmt),</div><div class="line"><a name="l03127"></a><span class="lineno"> 3127</span>&#160;                     DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a3c6553c8acebe1b57c211ee45e2d8f98">ISD::SRL</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, BSwap, ShAmt));</div><div class="line"><a name="l03128"></a><span class="lineno"> 3128</span>&#160;}</div><div class="line"><a name="l03129"></a><span class="lineno"> 3129</span>&#160;</div><div class="line"><a name="l03130"></a><span class="lineno"> 3130</span>&#160;<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::visitOR(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N) {</div><div class="line"><a name="l03131"></a><span class="lineno"> 3131</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N0 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0);</div><div class="line"><a name="l03132"></a><span class="lineno"> 3132</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N1 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(1);</div><div class="line"><a name="l03133"></a><span class="lineno"> 3133</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> LL, LR, RL, RR, CC0, CC1;</div><div class="line"><a name="l03134"></a><span class="lineno"> 3134</span>&#160;  <a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a> *N0C = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a>&gt;(N0);</div><div class="line"><a name="l03135"></a><span class="lineno"> 3135</span>&#160;  <a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a> *N1C = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a>&gt;(N1);</div><div class="line"><a name="l03136"></a><span class="lineno"> 3136</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> VT = N1.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>();</div><div class="line"><a name="l03137"></a><span class="lineno"> 3137</span>&#160;</div><div class="line"><a name="l03138"></a><span class="lineno"> 3138</span>&#160;  <span class="comment">// fold vector ops</span></div><div class="line"><a name="l03139"></a><span class="lineno"> 3139</span>&#160;  <span class="keywordflow">if</span> (VT.isVector()) {</div><div class="line"><a name="l03140"></a><span class="lineno"> 3140</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> FoldedVOp = SimplifyVBinOp(N);</div><div class="line"><a name="l03141"></a><span class="lineno"> 3141</span>&#160;    <span class="keywordflow">if</span> (FoldedVOp.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()) <span class="keywordflow">return</span> FoldedVOp;</div><div class="line"><a name="l03142"></a><span class="lineno"> 3142</span>&#160;</div><div class="line"><a name="l03143"></a><span class="lineno"> 3143</span>&#160;    <span class="comment">// fold (or x, 0) -&gt; x, vector edition</span></div><div class="line"><a name="l03144"></a><span class="lineno"> 3144</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1ISD.html#aaac3e239cbdfe15a8e9bad4f8e1e3a95">ISD::isBuildVectorAllZeros</a>(N0.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()))</div><div class="line"><a name="l03145"></a><span class="lineno"> 3145</span>&#160;      <span class="keywordflow">return</span> N1;</div><div class="line"><a name="l03146"></a><span class="lineno"> 3146</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1ISD.html#aaac3e239cbdfe15a8e9bad4f8e1e3a95">ISD::isBuildVectorAllZeros</a>(N1.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()))</div><div class="line"><a name="l03147"></a><span class="lineno"> 3147</span>&#160;      <span class="keywordflow">return</span> N0;</div><div class="line"><a name="l03148"></a><span class="lineno"> 3148</span>&#160;</div><div class="line"><a name="l03149"></a><span class="lineno"> 3149</span>&#160;    <span class="comment">// fold (or x, -1) -&gt; -1, vector edition</span></div><div class="line"><a name="l03150"></a><span class="lineno"> 3150</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1ISD.html#ac78d4df51ca05e4fb1630a01e07de434">ISD::isBuildVectorAllOnes</a>(N0.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()))</div><div class="line"><a name="l03151"></a><span class="lineno"> 3151</span>&#160;      <span class="keywordflow">return</span> N0;</div><div class="line"><a name="l03152"></a><span class="lineno"> 3152</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1ISD.html#ac78d4df51ca05e4fb1630a01e07de434">ISD::isBuildVectorAllOnes</a>(N1.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()))</div><div class="line"><a name="l03153"></a><span class="lineno"> 3153</span>&#160;      <span class="keywordflow">return</span> N1;</div><div class="line"><a name="l03154"></a><span class="lineno"> 3154</span>&#160;  }</div><div class="line"><a name="l03155"></a><span class="lineno"> 3155</span>&#160;</div><div class="line"><a name="l03156"></a><span class="lineno"> 3156</span>&#160;  <span class="comment">// fold (or x, undef) -&gt; -1</span></div><div class="line"><a name="l03157"></a><span class="lineno"> 3157</span>&#160;  <span class="keywordflow">if</span> (!LegalOperations &amp;&amp;</div><div class="line"><a name="l03158"></a><span class="lineno"> 3158</span>&#160;      (N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7c6d8f265e9e16e5debdb9a536b55d3d">ISD::UNDEF</a> || N1.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7c6d8f265e9e16e5debdb9a536b55d3d">ISD::UNDEF</a>)) {</div><div class="line"><a name="l03159"></a><span class="lineno"> 3159</span>&#160;    <a class="code" href="structllvm_1_1EVT.html">EVT</a> EltVT = VT.<a class="code" href="structllvm_1_1EVT.html#a73f7c824cad61a47c21bf6d652ae2fd7">isVector</a>() ? VT.getVectorElementType() : VT;</div><div class="line"><a name="l03160"></a><span class="lineno"> 3160</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(<a class="code" href="classllvm_1_1APInt.html#a539bdb4fdbf46e0bfcefebf5ac6d21dd">APInt::getAllOnesValue</a>(EltVT.<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>()), VT);</div><div class="line"><a name="l03161"></a><span class="lineno"> 3161</span>&#160;  }</div><div class="line"><a name="l03162"></a><span class="lineno"> 3162</span>&#160;  <span class="comment">// fold (or c1, c2) -&gt; c1|c2</span></div><div class="line"><a name="l03163"></a><span class="lineno"> 3163</span>&#160;  <span class="keywordflow">if</span> (N0C &amp;&amp; N1C)</div><div class="line"><a name="l03164"></a><span class="lineno"> 3164</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a8503b91b7bbfb128a42fa582857f8828">FoldConstantArithmetic</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7415ab9f2172c59a2ee7c7a02afa56a4">ISD::OR</a>, VT, N0C, N1C);</div><div class="line"><a name="l03165"></a><span class="lineno"> 3165</span>&#160;  <span class="comment">// canonicalize constant to RHS</span></div><div class="line"><a name="l03166"></a><span class="lineno"> 3166</span>&#160;  <span class="keywordflow">if</span> (N0C &amp;&amp; !N1C)</div><div class="line"><a name="l03167"></a><span class="lineno"> 3167</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7415ab9f2172c59a2ee7c7a02afa56a4">ISD::OR</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N1, N0);</div><div class="line"><a name="l03168"></a><span class="lineno"> 3168</span>&#160;  <span class="comment">// fold (or x, 0) -&gt; x</span></div><div class="line"><a name="l03169"></a><span class="lineno"> 3169</span>&#160;  <span class="keywordflow">if</span> (N1C &amp;&amp; N1C-&gt;isNullValue())</div><div class="line"><a name="l03170"></a><span class="lineno"> 3170</span>&#160;    <span class="keywordflow">return</span> N0;</div><div class="line"><a name="l03171"></a><span class="lineno"> 3171</span>&#160;  <span class="comment">// fold (or x, -1) -&gt; -1</span></div><div class="line"><a name="l03172"></a><span class="lineno"> 3172</span>&#160;  <span class="keywordflow">if</span> (N1C &amp;&amp; N1C-&gt;isAllOnesValue())</div><div class="line"><a name="l03173"></a><span class="lineno"> 3173</span>&#160;    <span class="keywordflow">return</span> N1;</div><div class="line"><a name="l03174"></a><span class="lineno"> 3174</span>&#160;  <span class="comment">// fold (or x, c) -&gt; c iff (x &amp; ~c) == 0</span></div><div class="line"><a name="l03175"></a><span class="lineno"> 3175</span>&#160;  <span class="keywordflow">if</span> (N1C &amp;&amp; DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af99f246db9e144fefd7a73b54ef0bbf7">MaskedValueIsZero</a>(N0, ~N1C-&gt;getAPIntValue()))</div><div class="line"><a name="l03176"></a><span class="lineno"> 3176</span>&#160;    <span class="keywordflow">return</span> N1;</div><div class="line"><a name="l03177"></a><span class="lineno"> 3177</span>&#160;</div><div class="line"><a name="l03178"></a><span class="lineno"> 3178</span>&#160;  <span class="comment">// Recognize halfword bswaps as (bswap + rotl 16) or (bswap + shl 16)</span></div><div class="line"><a name="l03179"></a><span class="lineno"> 3179</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> BSwap = MatchBSwapHWord(N, N0, N1);</div><div class="line"><a name="l03180"></a><span class="lineno"> 3180</span>&#160;  <span class="keywordflow">if</span> (BSwap.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>() != 0)</div><div class="line"><a name="l03181"></a><span class="lineno"> 3181</span>&#160;    <span class="keywordflow">return</span> BSwap;</div><div class="line"><a name="l03182"></a><span class="lineno"> 3182</span>&#160;  BSwap = MatchBSwapHWordLow(N, N0, N1);</div><div class="line"><a name="l03183"></a><span class="lineno"> 3183</span>&#160;  <span class="keywordflow">if</span> (BSwap.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>() != 0)</div><div class="line"><a name="l03184"></a><span class="lineno"> 3184</span>&#160;    <span class="keywordflow">return</span> BSwap;</div><div class="line"><a name="l03185"></a><span class="lineno"> 3185</span>&#160;</div><div class="line"><a name="l03186"></a><span class="lineno"> 3186</span>&#160;  <span class="comment">// reassociate or</span></div><div class="line"><a name="l03187"></a><span class="lineno"> 3187</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> <a class="code" href="namespacellvm_1_1A64SE.html#a01fd45cc55587b985e98c297348da443a83395d5a6e29fac625c8166616402236">ROR</a> = ReassociateOps(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7415ab9f2172c59a2ee7c7a02afa56a4">ISD::OR</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), N0, N1);</div><div class="line"><a name="l03188"></a><span class="lineno"> 3188</span>&#160;  <span class="keywordflow">if</span> (ROR.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>() != 0)</div><div class="line"><a name="l03189"></a><span class="lineno"> 3189</span>&#160;    <span class="keywordflow">return</span> ROR;</div><div class="line"><a name="l03190"></a><span class="lineno"> 3190</span>&#160;  <span class="comment">// Canonicalize (or (and X, c1), c2) -&gt; (and (or X, c2), c1|c2)</span></div><div class="line"><a name="l03191"></a><span class="lineno"> 3191</span>&#160;  <span class="comment">// iff (c1 &amp; c2) == 0.</span></div><div class="line"><a name="l03192"></a><span class="lineno"> 3192</span>&#160;  <span class="keywordflow">if</span> (N1C &amp;&amp; N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ac513a7da1bf74fb3e3c594da8534f2d2">ISD::AND</a> &amp;&amp; N0.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()-&gt;<a class="code" href="classllvm_1_1SDNode.html#a52753947fce3a01b1c18dd4713c587e8">hasOneUse</a>() &amp;&amp;</div><div class="line"><a name="l03193"></a><span class="lineno"> 3193</span>&#160;             isa&lt;ConstantSDNode&gt;(N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1))) {</div><div class="line"><a name="l03194"></a><span class="lineno"> 3194</span>&#160;    <a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a> *<a class="code" href="Target_2README_8txt.html#a2a2df5a25b9c703e74e82b48a75d0c3d">C1</a> = cast&lt;ConstantSDNode&gt;(N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1));</div><div class="line"><a name="l03195"></a><span class="lineno"> 3195</span>&#160;    <span class="keywordflow">if</span> ((C1-&gt;<a class="code" href="classllvm_1_1ConstantSDNode.html#a7951626d3fc3c89c4efee59ed9c3d8bf">getAPIntValue</a>() &amp; N1C-&gt;getAPIntValue()) != 0)</div><div class="line"><a name="l03196"></a><span class="lineno"> 3196</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ac513a7da1bf74fb3e3c594da8534f2d2">ISD::AND</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT,</div><div class="line"><a name="l03197"></a><span class="lineno"> 3197</span>&#160;                         DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7415ab9f2172c59a2ee7c7a02afa56a4">ISD::OR</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N0), VT,</div><div class="line"><a name="l03198"></a><span class="lineno"> 3198</span>&#160;                                     N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0), N1),</div><div class="line"><a name="l03199"></a><span class="lineno"> 3199</span>&#160;                         DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a8503b91b7bbfb128a42fa582857f8828">FoldConstantArithmetic</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7415ab9f2172c59a2ee7c7a02afa56a4">ISD::OR</a>, VT, N1C, C1));</div><div class="line"><a name="l03200"></a><span class="lineno"> 3200</span>&#160;  }</div><div class="line"><a name="l03201"></a><span class="lineno"> 3201</span>&#160;  <span class="comment">// fold (or (setcc x), (setcc y)) -&gt; (setcc (or x, y))</span></div><div class="line"><a name="l03202"></a><span class="lineno"> 3202</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="DAGCombiner_8cpp.html#aad9b27fb736faf90f342b3fcabf413fb">isSetCCEquivalent</a>(N0, LL, LR, CC0) &amp;&amp; <a class="code" href="DAGCombiner_8cpp.html#aad9b27fb736faf90f342b3fcabf413fb">isSetCCEquivalent</a>(N1, RL, RR, CC1)){</div><div class="line"><a name="l03203"></a><span class="lineno"> 3203</span>&#160;    <a class="code" href="namespacellvm_1_1ISD.html#ac3c3cf58d6d631af6a172457304d3d07">ISD::CondCode</a> Op0 = cast&lt;CondCodeSDNode&gt;(CC0)-&gt;<span class="keyword">get</span>();</div><div class="line"><a name="l03204"></a><span class="lineno"> 3204</span>&#160;    <a class="code" href="namespacellvm_1_1ISD.html#ac3c3cf58d6d631af6a172457304d3d07">ISD::CondCode</a> Op1 = cast&lt;CondCodeSDNode&gt;(CC1)-&gt;<span class="keyword">get</span>();</div><div class="line"><a name="l03205"></a><span class="lineno"> 3205</span>&#160;</div><div class="line"><a name="l03206"></a><span class="lineno"> 3206</span>&#160;    <span class="keywordflow">if</span> (LR == RR &amp;&amp; isa&lt;ConstantSDNode&gt;(LR) &amp;&amp; Op0 == Op1 &amp;&amp;</div><div class="line"><a name="l03207"></a><span class="lineno"> 3207</span>&#160;        LL.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>().<a class="code" href="structllvm_1_1EVT.html#a8cc407ac00df4edd4ec4d5168d6ecb26">isInteger</a>()) {</div><div class="line"><a name="l03208"></a><span class="lineno"> 3208</span>&#160;      <span class="comment">// fold (or (setne X, 0), (setne Y, 0)) -&gt; (setne (or X, Y), 0)</span></div><div class="line"><a name="l03209"></a><span class="lineno"> 3209</span>&#160;      <span class="comment">// fold (or (setlt X, 0), (setlt Y, 0)) -&gt; (setne (or X, Y), 0)</span></div><div class="line"><a name="l03210"></a><span class="lineno"> 3210</span>&#160;      <span class="keywordflow">if</span> (cast&lt;ConstantSDNode&gt;(LR)-&gt;isNullValue() &amp;&amp;</div><div class="line"><a name="l03211"></a><span class="lineno"> 3211</span>&#160;          (Op1 == <a class="code" href="namespacellvm_1_1ISD.html#ac3c3cf58d6d631af6a172457304d3d07a2887cc8b39915a25180f4bca0026a15e">ISD::SETNE</a> || Op1 == <a class="code" href="namespacellvm_1_1ISD.html#ac3c3cf58d6d631af6a172457304d3d07a6f05a09edb671910f85f8665981cbde9">ISD::SETLT</a>)) {</div><div class="line"><a name="l03212"></a><span class="lineno"> 3212</span>&#160;        <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> ORNode = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7415ab9f2172c59a2ee7c7a02afa56a4">ISD::OR</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(LR),</div><div class="line"><a name="l03213"></a><span class="lineno"> 3213</span>&#160;                                     LR.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>(), LL, RL);</div><div class="line"><a name="l03214"></a><span class="lineno"> 3214</span>&#160;        AddToWorkList(ORNode.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l03215"></a><span class="lineno"> 3215</span>&#160;        <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a2650d530046f9ddfc602dc7383ba0730">getSetCC</a>(<a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, ORNode, LR, Op1);</div><div class="line"><a name="l03216"></a><span class="lineno"> 3216</span>&#160;      }</div><div class="line"><a name="l03217"></a><span class="lineno"> 3217</span>&#160;      <span class="comment">// fold (or (setne X, -1), (setne Y, -1)) -&gt; (setne (and X, Y), -1)</span></div><div class="line"><a name="l03218"></a><span class="lineno"> 3218</span>&#160;      <span class="comment">// fold (or (setgt X, -1), (setgt Y  -1)) -&gt; (setgt (and X, Y), -1)</span></div><div class="line"><a name="l03219"></a><span class="lineno"> 3219</span>&#160;      <span class="keywordflow">if</span> (cast&lt;ConstantSDNode&gt;(LR)-&gt;isAllOnesValue() &amp;&amp;</div><div class="line"><a name="l03220"></a><span class="lineno"> 3220</span>&#160;          (Op1 == <a class="code" href="namespacellvm_1_1ISD.html#ac3c3cf58d6d631af6a172457304d3d07a2887cc8b39915a25180f4bca0026a15e">ISD::SETNE</a> || Op1 == <a class="code" href="namespacellvm_1_1ISD.html#ac3c3cf58d6d631af6a172457304d3d07a5ad12b466e3a5900d0c307b301465d25">ISD::SETGT</a>)) {</div><div class="line"><a name="l03221"></a><span class="lineno"> 3221</span>&#160;        <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> ANDNode = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ac513a7da1bf74fb3e3c594da8534f2d2">ISD::AND</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(LR),</div><div class="line"><a name="l03222"></a><span class="lineno"> 3222</span>&#160;                                      LR.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>(), LL, RL);</div><div class="line"><a name="l03223"></a><span class="lineno"> 3223</span>&#160;        AddToWorkList(ANDNode.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l03224"></a><span class="lineno"> 3224</span>&#160;        <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a2650d530046f9ddfc602dc7383ba0730">getSetCC</a>(<a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, ANDNode, LR, Op1);</div><div class="line"><a name="l03225"></a><span class="lineno"> 3225</span>&#160;      }</div><div class="line"><a name="l03226"></a><span class="lineno"> 3226</span>&#160;    }</div><div class="line"><a name="l03227"></a><span class="lineno"> 3227</span>&#160;    <span class="comment">// canonicalize equivalent to ll == rl</span></div><div class="line"><a name="l03228"></a><span class="lineno"> 3228</span>&#160;    <span class="keywordflow">if</span> (LL == RR &amp;&amp; LR == RL) {</div><div class="line"><a name="l03229"></a><span class="lineno"> 3229</span>&#160;      Op1 = <a class="code" href="namespacellvm_1_1ISD.html#a9cc23aed232ccdeadbd8648c349236a6">ISD::getSetCCSwappedOperands</a>(Op1);</div><div class="line"><a name="l03230"></a><span class="lineno"> 3230</span>&#160;      <a class="code" href="namespacestd.html#ab8424022895aee3e366fb9a32f2883cb">std::swap</a>(RL, RR);</div><div class="line"><a name="l03231"></a><span class="lineno"> 3231</span>&#160;    }</div><div class="line"><a name="l03232"></a><span class="lineno"> 3232</span>&#160;    <span class="keywordflow">if</span> (LL == RL &amp;&amp; LR == RR) {</div><div class="line"><a name="l03233"></a><span class="lineno"> 3233</span>&#160;      <span class="keywordtype">bool</span> isInteger = LL.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>().<a class="code" href="structllvm_1_1EVT.html#a8cc407ac00df4edd4ec4d5168d6ecb26">isInteger</a>();</div><div class="line"><a name="l03234"></a><span class="lineno"> 3234</span>&#160;      <a class="code" href="namespacellvm_1_1ISD.html#ac3c3cf58d6d631af6a172457304d3d07">ISD::CondCode</a> Result = <a class="code" href="namespacellvm_1_1ISD.html#aab586f6d9a8433b0121bda4aca5366d5">ISD::getSetCCOrOperation</a>(Op0, Op1, isInteger);</div><div class="line"><a name="l03235"></a><span class="lineno"> 3235</span>&#160;      <span class="keywordflow">if</span> (Result != <a class="code" href="namespacellvm_1_1ISD.html#ac3c3cf58d6d631af6a172457304d3d07aeded54fe1be320194e9ff0f5825df0e5">ISD::SETCC_INVALID</a> &amp;&amp;</div><div class="line"><a name="l03236"></a><span class="lineno"> 3236</span>&#160;          (!LegalOperations ||</div><div class="line"><a name="l03237"></a><span class="lineno"> 3237</span>&#160;           (TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a5915acdb20d31a79440117652c5232ec">isCondCodeLegal</a>(Result, LL.<a class="code" href="classllvm_1_1SDValue.html#a8bc8606044f2c3cdb6271c0378e0f9cf">getSimpleValueType</a>()) &amp;&amp;</div><div class="line"><a name="l03238"></a><span class="lineno"> 3238</span>&#160;            TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a055b3905dbbc16fae11510b9ebd1e00c">isOperationLegal</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a0158ee47dfa868be5d28e2cbef70d5d0">ISD::SETCC</a>,</div><div class="line"><a name="l03239"></a><span class="lineno"> 3239</span>&#160;              getSetCCResultType(N0.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>())))))</div><div class="line"><a name="l03240"></a><span class="lineno"> 3240</span>&#160;        <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a2650d530046f9ddfc602dc7383ba0730">getSetCC</a>(<a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), N0.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>(),</div><div class="line"><a name="l03241"></a><span class="lineno"> 3241</span>&#160;                            LL, LR, Result);</div><div class="line"><a name="l03242"></a><span class="lineno"> 3242</span>&#160;    }</div><div class="line"><a name="l03243"></a><span class="lineno"> 3243</span>&#160;  }</div><div class="line"><a name="l03244"></a><span class="lineno"> 3244</span>&#160;</div><div class="line"><a name="l03245"></a><span class="lineno"> 3245</span>&#160;  <span class="comment">// Simplify: (or (op x...), (op y...))  -&gt; (op (or x, y))</span></div><div class="line"><a name="l03246"></a><span class="lineno"> 3246</span>&#160;  <span class="keywordflow">if</span> (N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == N1.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>()) {</div><div class="line"><a name="l03247"></a><span class="lineno"> 3247</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Tmp = SimplifyBinOpWithSameOpcodeHands(N);</div><div class="line"><a name="l03248"></a><span class="lineno"> 3248</span>&#160;    <span class="keywordflow">if</span> (Tmp.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()) <span class="keywordflow">return</span> Tmp;</div><div class="line"><a name="l03249"></a><span class="lineno"> 3249</span>&#160;  }</div><div class="line"><a name="l03250"></a><span class="lineno"> 3250</span>&#160;</div><div class="line"><a name="l03251"></a><span class="lineno"> 3251</span>&#160;  <span class="comment">// (or (and X, C1), (and Y, C2))  -&gt; (and (or X, Y), C3) if possible.</span></div><div class="line"><a name="l03252"></a><span class="lineno"> 3252</span>&#160;  <span class="keywordflow">if</span> (N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ac513a7da1bf74fb3e3c594da8534f2d2">ISD::AND</a> &amp;&amp;</div><div class="line"><a name="l03253"></a><span class="lineno"> 3253</span>&#160;      N1.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ac513a7da1bf74fb3e3c594da8534f2d2">ISD::AND</a> &amp;&amp;</div><div class="line"><a name="l03254"></a><span class="lineno"> 3254</span>&#160;      N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1).<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110aac2f0a84dd2aa5ee4c3f1385e9565f5e">ISD::Constant</a> &amp;&amp;</div><div class="line"><a name="l03255"></a><span class="lineno"> 3255</span>&#160;      N1.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1).<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110aac2f0a84dd2aa5ee4c3f1385e9565f5e">ISD::Constant</a> &amp;&amp;</div><div class="line"><a name="l03256"></a><span class="lineno"> 3256</span>&#160;      <span class="comment">// Don&#39;t increase # computations.</span></div><div class="line"><a name="l03257"></a><span class="lineno"> 3257</span>&#160;      (N0.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()-&gt;<a class="code" href="classllvm_1_1SDNode.html#a52753947fce3a01b1c18dd4713c587e8">hasOneUse</a>() || N1.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()-&gt;<a class="code" href="classllvm_1_1SDNode.html#a52753947fce3a01b1c18dd4713c587e8">hasOneUse</a>())) {</div><div class="line"><a name="l03258"></a><span class="lineno"> 3258</span>&#160;    <span class="comment">// We can only do this xform if we know that bits from X that are set in C2</span></div><div class="line"><a name="l03259"></a><span class="lineno"> 3259</span>&#160;    <span class="comment">// but not in C1 are already zero.  Likewise for Y.</span></div><div class="line"><a name="l03260"></a><span class="lineno"> 3260</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1APInt.html">APInt</a> &amp;LHSMask =</div><div class="line"><a name="l03261"></a><span class="lineno"> 3261</span>&#160;      cast&lt;ConstantSDNode&gt;(N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1))-&gt;getAPIntValue();</div><div class="line"><a name="l03262"></a><span class="lineno"> 3262</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1APInt.html">APInt</a> &amp;RHSMask =</div><div class="line"><a name="l03263"></a><span class="lineno"> 3263</span>&#160;      cast&lt;ConstantSDNode&gt;(N1.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1))-&gt;getAPIntValue();</div><div class="line"><a name="l03264"></a><span class="lineno"> 3264</span>&#160;</div><div class="line"><a name="l03265"></a><span class="lineno"> 3265</span>&#160;    <span class="keywordflow">if</span> (DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af99f246db9e144fefd7a73b54ef0bbf7">MaskedValueIsZero</a>(N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0), RHSMask&amp;~LHSMask) &amp;&amp;</div><div class="line"><a name="l03266"></a><span class="lineno"> 3266</span>&#160;        DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af99f246db9e144fefd7a73b54ef0bbf7">MaskedValueIsZero</a>(N1.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0), LHSMask&amp;~RHSMask)) {</div><div class="line"><a name="l03267"></a><span class="lineno"> 3267</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> <a class="code" href="namespacellvm.html#a6569d00d31a5d74e563e2f39f82271ab">X</a> = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7415ab9f2172c59a2ee7c7a02afa56a4">ISD::OR</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N0), VT,</div><div class="line"><a name="l03268"></a><span class="lineno"> 3268</span>&#160;                              N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0), N1.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0));</div><div class="line"><a name="l03269"></a><span class="lineno"> 3269</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ac513a7da1bf74fb3e3c594da8534f2d2">ISD::AND</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, X,</div><div class="line"><a name="l03270"></a><span class="lineno"> 3270</span>&#160;                         DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(LHSMask | RHSMask, VT));</div><div class="line"><a name="l03271"></a><span class="lineno"> 3271</span>&#160;    }</div><div class="line"><a name="l03272"></a><span class="lineno"> 3272</span>&#160;  }</div><div class="line"><a name="l03273"></a><span class="lineno"> 3273</span>&#160;</div><div class="line"><a name="l03274"></a><span class="lineno"> 3274</span>&#160;  <span class="comment">// See if this is some rotate idiom.</span></div><div class="line"><a name="l03275"></a><span class="lineno"> 3275</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *Rot = MatchRotate(N0, N1, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N)))</div><div class="line"><a name="l03276"></a><span class="lineno"> 3276</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(Rot, 0);</div><div class="line"><a name="l03277"></a><span class="lineno"> 3277</span>&#160;</div><div class="line"><a name="l03278"></a><span class="lineno"> 3278</span>&#160;  <span class="comment">// Simplify the operands using demanded-bits information.</span></div><div class="line"><a name="l03279"></a><span class="lineno"> 3279</span>&#160;  <span class="keywordflow">if</span> (!VT.isVector() &amp;&amp;</div><div class="line"><a name="l03280"></a><span class="lineno"> 3280</span>&#160;      SimplifyDemandedBits(<a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(N, 0)))</div><div class="line"><a name="l03281"></a><span class="lineno"> 3281</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(N, 0);</div><div class="line"><a name="l03282"></a><span class="lineno"> 3282</span>&#160;</div><div class="line"><a name="l03283"></a><span class="lineno"> 3283</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l03284"></a><span class="lineno"> 3284</span>&#160;}</div><div class="line"><a name="l03285"></a><span class="lineno"> 3285</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03286"></a><span class="lineno"> 3286</span>&#160;<span class="comment">/// MatchRotateHalf - Match &quot;(X shl/srl V1) &amp; V2&quot; where V2 may not be present.</span></div><div class="line"><a name="l03287"></a><span class="lineno"><a class="line" href="DAGCombiner_8cpp.html#aac1d4a23814f56ced0003697d241efb6"> 3287</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="DAGCombiner_8cpp.html#aac1d4a23814f56ced0003697d241efb6">MatchRotateHalf</a>(<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Op, <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> &amp;<a class="code" href="Target_2README_8txt.html#a8db36c82f32d6f6a4d35a00e55be03a8">Shift</a>, <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> &amp;Mask) {</div><div class="line"><a name="l03288"></a><span class="lineno"> 3288</span>&#160;  <span class="keywordflow">if</span> (Op.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ac513a7da1bf74fb3e3c594da8534f2d2">ISD::AND</a>) {</div><div class="line"><a name="l03289"></a><span class="lineno"> 3289</span>&#160;    <span class="keywordflow">if</span> (isa&lt;ConstantSDNode&gt;(Op.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1))) {</div><div class="line"><a name="l03290"></a><span class="lineno"> 3290</span>&#160;      Mask = Op.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1);</div><div class="line"><a name="l03291"></a><span class="lineno"> 3291</span>&#160;      Op = Op.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0);</div><div class="line"><a name="l03292"></a><span class="lineno"> 3292</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l03293"></a><span class="lineno"> 3293</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l03294"></a><span class="lineno"> 3294</span>&#160;    }</div><div class="line"><a name="l03295"></a><span class="lineno"> 3295</span>&#160;  }</div><div class="line"><a name="l03296"></a><span class="lineno"> 3296</span>&#160;</div><div class="line"><a name="l03297"></a><span class="lineno"> 3297</span>&#160;  <span class="keywordflow">if</span> (Op.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a3c6553c8acebe1b57c211ee45e2d8f98">ISD::SRL</a> || Op.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a8cc94e03dea594863073a02f5bb94997">ISD::SHL</a>) {</div><div class="line"><a name="l03298"></a><span class="lineno"> 3298</span>&#160;    Shift = Op;</div><div class="line"><a name="l03299"></a><span class="lineno"> 3299</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l03300"></a><span class="lineno"> 3300</span>&#160;  }</div><div class="line"><a name="l03301"></a><span class="lineno"> 3301</span>&#160;</div><div class="line"><a name="l03302"></a><span class="lineno"> 3302</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l03303"></a><span class="lineno"> 3303</span>&#160;}</div><div class="line"><a name="l03304"></a><span class="lineno"> 3304</span>&#160;</div><div class="line"><a name="l03305"></a><span class="lineno"> 3305</span>&#160;<span class="comment">// MatchRotate - Handle an &#39;or&#39; of two operands.  If this is one of the many</span></div><div class="line"><a name="l03306"></a><span class="lineno"> 3306</span>&#160;<span class="comment">// idioms for rotate, and if the target supports rotation instructions, generate</span></div><div class="line"><a name="l03307"></a><span class="lineno"> 3307</span>&#160;<span class="comment">// a rot[lr].</span></div><div class="line"><a name="l03308"></a><span class="lineno"> 3308</span>&#160;<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *DAGCombiner::MatchRotate(<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> LHS, <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> RHS, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a> DL) {</div><div class="line"><a name="l03309"></a><span class="lineno"> 3309</span>&#160;  <span class="comment">// Must be a legal type.  Expanded &#39;n promoted things won&#39;t work with rotates.</span></div><div class="line"><a name="l03310"></a><span class="lineno"> 3310</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> VT = LHS.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>();</div><div class="line"><a name="l03311"></a><span class="lineno"> 3311</span>&#160;  <span class="keywordflow">if</span> (!TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a861aaccc0f468493e76c011811548804">isTypeLegal</a>(VT)) <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l03312"></a><span class="lineno"> 3312</span>&#160;</div><div class="line"><a name="l03313"></a><span class="lineno"> 3313</span>&#160;  <span class="comment">// The target must have at least one rotate flavor.</span></div><div class="line"><a name="l03314"></a><span class="lineno"> 3314</span>&#160;  <span class="keywordtype">bool</span> HasROTL = TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a087dd0f9650e999b087c17cc7f46f2d0">isOperationLegalOrCustom</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ae8f8f81d8e8d7a557d67622c05786f1d">ISD::ROTL</a>, VT);</div><div class="line"><a name="l03315"></a><span class="lineno"> 3315</span>&#160;  <span class="keywordtype">bool</span> HasROTR = TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a087dd0f9650e999b087c17cc7f46f2d0">isOperationLegalOrCustom</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a19cd524269b035941434cce28b585715">ISD::ROTR</a>, VT);</div><div class="line"><a name="l03316"></a><span class="lineno"> 3316</span>&#160;  <span class="keywordflow">if</span> (!HasROTL &amp;&amp; !HasROTR) <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l03317"></a><span class="lineno"> 3317</span>&#160;</div><div class="line"><a name="l03318"></a><span class="lineno"> 3318</span>&#160;  <span class="comment">// Match &quot;(X shl/srl V1) &amp; V2&quot; where V2 may not be present.</span></div><div class="line"><a name="l03319"></a><span class="lineno"> 3319</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> LHSShift;   <span class="comment">// The shift.</span></div><div class="line"><a name="l03320"></a><span class="lineno"> 3320</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> LHSMask;    <span class="comment">// AND value if any.</span></div><div class="line"><a name="l03321"></a><span class="lineno"> 3321</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="DAGCombiner_8cpp.html#aac1d4a23814f56ced0003697d241efb6">MatchRotateHalf</a>(LHS, LHSShift, LHSMask))</div><div class="line"><a name="l03322"></a><span class="lineno"> 3322</span>&#160;    <span class="keywordflow">return</span> 0; <span class="comment">// Not part of a rotate.</span></div><div class="line"><a name="l03323"></a><span class="lineno"> 3323</span>&#160;</div><div class="line"><a name="l03324"></a><span class="lineno"> 3324</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> RHSShift;   <span class="comment">// The shift.</span></div><div class="line"><a name="l03325"></a><span class="lineno"> 3325</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> RHSMask;    <span class="comment">// AND value if any.</span></div><div class="line"><a name="l03326"></a><span class="lineno"> 3326</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="DAGCombiner_8cpp.html#aac1d4a23814f56ced0003697d241efb6">MatchRotateHalf</a>(RHS, RHSShift, RHSMask))</div><div class="line"><a name="l03327"></a><span class="lineno"> 3327</span>&#160;    <span class="keywordflow">return</span> 0; <span class="comment">// Not part of a rotate.</span></div><div class="line"><a name="l03328"></a><span class="lineno"> 3328</span>&#160;</div><div class="line"><a name="l03329"></a><span class="lineno"> 3329</span>&#160;  <span class="keywordflow">if</span> (LHSShift.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0) != RHSShift.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0))</div><div class="line"><a name="l03330"></a><span class="lineno"> 3330</span>&#160;    <span class="keywordflow">return</span> 0;   <span class="comment">// Not shifting the same value.</span></div><div class="line"><a name="l03331"></a><span class="lineno"> 3331</span>&#160;</div><div class="line"><a name="l03332"></a><span class="lineno"> 3332</span>&#160;  <span class="keywordflow">if</span> (LHSShift.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == RHSShift.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>())</div><div class="line"><a name="l03333"></a><span class="lineno"> 3333</span>&#160;    <span class="keywordflow">return</span> 0;   <span class="comment">// Shifts must disagree.</span></div><div class="line"><a name="l03334"></a><span class="lineno"> 3334</span>&#160;</div><div class="line"><a name="l03335"></a><span class="lineno"> 3335</span>&#160;  <span class="comment">// Canonicalize shl to left side in a shl/srl pair.</span></div><div class="line"><a name="l03336"></a><span class="lineno"> 3336</span>&#160;  <span class="keywordflow">if</span> (RHSShift.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a8cc94e03dea594863073a02f5bb94997">ISD::SHL</a>) {</div><div class="line"><a name="l03337"></a><span class="lineno"> 3337</span>&#160;    <a class="code" href="namespacestd.html#ab8424022895aee3e366fb9a32f2883cb">std::swap</a>(LHS, RHS);</div><div class="line"><a name="l03338"></a><span class="lineno"> 3338</span>&#160;    <a class="code" href="namespacestd.html#ab8424022895aee3e366fb9a32f2883cb">std::swap</a>(LHSShift, RHSShift);</div><div class="line"><a name="l03339"></a><span class="lineno"> 3339</span>&#160;    <a class="code" href="namespacestd.html#ab8424022895aee3e366fb9a32f2883cb">std::swap</a>(LHSMask , RHSMask );</div><div class="line"><a name="l03340"></a><span class="lineno"> 3340</span>&#160;  }</div><div class="line"><a name="l03341"></a><span class="lineno"> 3341</span>&#160;</div><div class="line"><a name="l03342"></a><span class="lineno"> 3342</span>&#160;  <span class="keywordtype">unsigned</span> OpSizeInBits = VT.<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>();</div><div class="line"><a name="l03343"></a><span class="lineno"> 3343</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> LHSShiftArg = LHSShift.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0);</div><div class="line"><a name="l03344"></a><span class="lineno"> 3344</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> LHSShiftAmt = LHSShift.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1);</div><div class="line"><a name="l03345"></a><span class="lineno"> 3345</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> RHSShiftAmt = RHSShift.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1);</div><div class="line"><a name="l03346"></a><span class="lineno"> 3346</span>&#160;</div><div class="line"><a name="l03347"></a><span class="lineno"> 3347</span>&#160;  <span class="comment">// fold (or (shl x, C1), (srl x, C2)) -&gt; (rotl x, C1)</span></div><div class="line"><a name="l03348"></a><span class="lineno"> 3348</span>&#160;  <span class="comment">// fold (or (shl x, C1), (srl x, C2)) -&gt; (rotr x, C2)</span></div><div class="line"><a name="l03349"></a><span class="lineno"> 3349</span>&#160;  <span class="keywordflow">if</span> (LHSShiftAmt.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110aac2f0a84dd2aa5ee4c3f1385e9565f5e">ISD::Constant</a> &amp;&amp;</div><div class="line"><a name="l03350"></a><span class="lineno"> 3350</span>&#160;      RHSShiftAmt.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110aac2f0a84dd2aa5ee4c3f1385e9565f5e">ISD::Constant</a>) {</div><div class="line"><a name="l03351"></a><span class="lineno"> 3351</span>&#160;    uint64_t LShVal = cast&lt;ConstantSDNode&gt;(LHSShiftAmt)-&gt;getZExtValue();</div><div class="line"><a name="l03352"></a><span class="lineno"> 3352</span>&#160;    uint64_t RShVal = cast&lt;ConstantSDNode&gt;(RHSShiftAmt)-&gt;getZExtValue();</div><div class="line"><a name="l03353"></a><span class="lineno"> 3353</span>&#160;    <span class="keywordflow">if</span> ((LShVal + RShVal) != OpSizeInBits)</div><div class="line"><a name="l03354"></a><span class="lineno"> 3354</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l03355"></a><span class="lineno"> 3355</span>&#160;</div><div class="line"><a name="l03356"></a><span class="lineno"> 3356</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Rot = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(HasROTL ? <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ae8f8f81d8e8d7a557d67622c05786f1d">ISD::ROTL</a> : <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a19cd524269b035941434cce28b585715">ISD::ROTR</a>, DL, VT,</div><div class="line"><a name="l03357"></a><span class="lineno"> 3357</span>&#160;                              LHSShiftArg, HasROTL ? LHSShiftAmt : RHSShiftAmt);</div><div class="line"><a name="l03358"></a><span class="lineno"> 3358</span>&#160;</div><div class="line"><a name="l03359"></a><span class="lineno"> 3359</span>&#160;    <span class="comment">// If there is an AND of either shifted operand, apply it to the result.</span></div><div class="line"><a name="l03360"></a><span class="lineno"> 3360</span>&#160;    <span class="keywordflow">if</span> (LHSMask.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>() || RHSMask.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()) {</div><div class="line"><a name="l03361"></a><span class="lineno"> 3361</span>&#160;      <a class="code" href="classllvm_1_1APInt.html">APInt</a> Mask = <a class="code" href="classllvm_1_1APInt.html#a539bdb4fdbf46e0bfcefebf5ac6d21dd">APInt::getAllOnesValue</a>(OpSizeInBits);</div><div class="line"><a name="l03362"></a><span class="lineno"> 3362</span>&#160;</div><div class="line"><a name="l03363"></a><span class="lineno"> 3363</span>&#160;      <span class="keywordflow">if</span> (LHSMask.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()) {</div><div class="line"><a name="l03364"></a><span class="lineno"> 3364</span>&#160;        <a class="code" href="classllvm_1_1APInt.html">APInt</a> RHSBits = <a class="code" href="classllvm_1_1APInt.html#ad960e1ff48d25c382b6d28e7961f074e">APInt::getLowBitsSet</a>(OpSizeInBits, LShVal);</div><div class="line"><a name="l03365"></a><span class="lineno"> 3365</span>&#160;        Mask &amp;= cast&lt;ConstantSDNode&gt;(LHSMask)-&gt;getAPIntValue() | RHSBits;</div><div class="line"><a name="l03366"></a><span class="lineno"> 3366</span>&#160;      }</div><div class="line"><a name="l03367"></a><span class="lineno"> 3367</span>&#160;      <span class="keywordflow">if</span> (RHSMask.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()) {</div><div class="line"><a name="l03368"></a><span class="lineno"> 3368</span>&#160;        <a class="code" href="classllvm_1_1APInt.html">APInt</a> LHSBits = <a class="code" href="classllvm_1_1APInt.html#adcb96bd09d7c75c7669fa5f9d1190899">APInt::getHighBitsSet</a>(OpSizeInBits, RShVal);</div><div class="line"><a name="l03369"></a><span class="lineno"> 3369</span>&#160;        Mask &amp;= cast&lt;ConstantSDNode&gt;(RHSMask)-&gt;getAPIntValue() | LHSBits;</div><div class="line"><a name="l03370"></a><span class="lineno"> 3370</span>&#160;      }</div><div class="line"><a name="l03371"></a><span class="lineno"> 3371</span>&#160;</div><div class="line"><a name="l03372"></a><span class="lineno"> 3372</span>&#160;      Rot = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ac513a7da1bf74fb3e3c594da8534f2d2">ISD::AND</a>, DL, VT, Rot, DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(Mask, VT));</div><div class="line"><a name="l03373"></a><span class="lineno"> 3373</span>&#160;    }</div><div class="line"><a name="l03374"></a><span class="lineno"> 3374</span>&#160;</div><div class="line"><a name="l03375"></a><span class="lineno"> 3375</span>&#160;    <span class="keywordflow">return</span> Rot.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>();</div><div class="line"><a name="l03376"></a><span class="lineno"> 3376</span>&#160;  }</div><div class="line"><a name="l03377"></a><span class="lineno"> 3377</span>&#160;</div><div class="line"><a name="l03378"></a><span class="lineno"> 3378</span>&#160;  <span class="comment">// If there is a mask here, and we have a variable shift, we can&#39;t be sure</span></div><div class="line"><a name="l03379"></a><span class="lineno"> 3379</span>&#160;  <span class="comment">// that we&#39;re masking out the right stuff.</span></div><div class="line"><a name="l03380"></a><span class="lineno"> 3380</span>&#160;  <span class="keywordflow">if</span> (LHSMask.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>() || RHSMask.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>())</div><div class="line"><a name="l03381"></a><span class="lineno"> 3381</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l03382"></a><span class="lineno"> 3382</span>&#160;</div><div class="line"><a name="l03383"></a><span class="lineno"> 3383</span>&#160;  <span class="comment">// If the shift amount is sign/zext/any-extended just peel it off.</span></div><div class="line"><a name="l03384"></a><span class="lineno"> 3384</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> LExtOp0 = LHSShiftAmt;</div><div class="line"><a name="l03385"></a><span class="lineno"> 3385</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> RExtOp0 = RHSShiftAmt;</div><div class="line"><a name="l03386"></a><span class="lineno"> 3386</span>&#160;  <span class="keywordflow">if</span> ((LHSShiftAmt.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a5183f3d72924bc7c77ba8d3f5de9f602">ISD::SIGN_EXTEND</a> ||</div><div class="line"><a name="l03387"></a><span class="lineno"> 3387</span>&#160;       LHSShiftAmt.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a93fdf85eff945f1a668b4915a051453e">ISD::ZERO_EXTEND</a> ||</div><div class="line"><a name="l03388"></a><span class="lineno"> 3388</span>&#160;       LHSShiftAmt.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a27d5d8ef82302b739ba3ca8be1a5513d">ISD::ANY_EXTEND</a> ||</div><div class="line"><a name="l03389"></a><span class="lineno"> 3389</span>&#160;       LHSShiftAmt.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ae690127648393001a7d5b93dc23da7b3">ISD::TRUNCATE</a>) &amp;&amp;</div><div class="line"><a name="l03390"></a><span class="lineno"> 3390</span>&#160;      (RHSShiftAmt.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a5183f3d72924bc7c77ba8d3f5de9f602">ISD::SIGN_EXTEND</a> ||</div><div class="line"><a name="l03391"></a><span class="lineno"> 3391</span>&#160;       RHSShiftAmt.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a93fdf85eff945f1a668b4915a051453e">ISD::ZERO_EXTEND</a> ||</div><div class="line"><a name="l03392"></a><span class="lineno"> 3392</span>&#160;       RHSShiftAmt.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a27d5d8ef82302b739ba3ca8be1a5513d">ISD::ANY_EXTEND</a> ||</div><div class="line"><a name="l03393"></a><span class="lineno"> 3393</span>&#160;       RHSShiftAmt.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ae690127648393001a7d5b93dc23da7b3">ISD::TRUNCATE</a>)) {</div><div class="line"><a name="l03394"></a><span class="lineno"> 3394</span>&#160;    LExtOp0 = LHSShiftAmt.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0);</div><div class="line"><a name="l03395"></a><span class="lineno"> 3395</span>&#160;    RExtOp0 = RHSShiftAmt.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0);</div><div class="line"><a name="l03396"></a><span class="lineno"> 3396</span>&#160;  }</div><div class="line"><a name="l03397"></a><span class="lineno"> 3397</span>&#160;</div><div class="line"><a name="l03398"></a><span class="lineno"> 3398</span>&#160;  <span class="keywordflow">if</span> (RExtOp0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9fa617e5567c3c2638938f7b9ddc3f1c">ISD::SUB</a> &amp;&amp; RExtOp0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1) == LExtOp0) {</div><div class="line"><a name="l03399"></a><span class="lineno"> 3399</span>&#160;    <span class="comment">// fold (or (shl x, (*ext y)), (srl x, (*ext (sub 32, y)))) -&gt;</span></div><div class="line"><a name="l03400"></a><span class="lineno"> 3400</span>&#160;    <span class="comment">//   (rotl x, y)</span></div><div class="line"><a name="l03401"></a><span class="lineno"> 3401</span>&#160;    <span class="comment">// fold (or (shl x, (*ext y)), (srl x, (*ext (sub 32, y)))) -&gt;</span></div><div class="line"><a name="l03402"></a><span class="lineno"> 3402</span>&#160;    <span class="comment">//   (rotr x, (sub 32, y))</span></div><div class="line"><a name="l03403"></a><span class="lineno"> 3403</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a> *<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a2ab6db512a611d1ef4ff8069e2bbfd0d">SUBC</a> =</div><div class="line"><a name="l03404"></a><span class="lineno"> 3404</span>&#160;            dyn_cast&lt;ConstantSDNode&gt;(RExtOp0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0)))</div><div class="line"><a name="l03405"></a><span class="lineno"> 3405</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a2ab6db512a611d1ef4ff8069e2bbfd0d">SUBC</a>-&gt;getAPIntValue() == OpSizeInBits)</div><div class="line"><a name="l03406"></a><span class="lineno"> 3406</span>&#160;        <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(HasROTL ? <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ae8f8f81d8e8d7a557d67622c05786f1d">ISD::ROTL</a> : <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a19cd524269b035941434cce28b585715">ISD::ROTR</a>, DL, VT, LHSShiftArg,</div><div class="line"><a name="l03407"></a><span class="lineno"> 3407</span>&#160;                           HasROTL ? LHSShiftAmt : RHSShiftAmt).<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>();</div><div class="line"><a name="l03408"></a><span class="lineno"> 3408</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (LExtOp0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9fa617e5567c3c2638938f7b9ddc3f1c">ISD::SUB</a> &amp;&amp;</div><div class="line"><a name="l03409"></a><span class="lineno"> 3409</span>&#160;             RExtOp0 == LExtOp0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1)) {</div><div class="line"><a name="l03410"></a><span class="lineno"> 3410</span>&#160;    <span class="comment">// fold (or (shl x, (*ext (sub 32, y))), (srl x, (*ext y))) -&gt;</span></div><div class="line"><a name="l03411"></a><span class="lineno"> 3411</span>&#160;    <span class="comment">//   (rotr x, y)</span></div><div class="line"><a name="l03412"></a><span class="lineno"> 3412</span>&#160;    <span class="comment">// fold (or (shl x, (*ext (sub 32, y))), (srl x, (*ext y))) -&gt;</span></div><div class="line"><a name="l03413"></a><span class="lineno"> 3413</span>&#160;    <span class="comment">//   (rotl x, (sub 32, y))</span></div><div class="line"><a name="l03414"></a><span class="lineno"> 3414</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a> *<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a2ab6db512a611d1ef4ff8069e2bbfd0d">SUBC</a> =</div><div class="line"><a name="l03415"></a><span class="lineno"> 3415</span>&#160;            dyn_cast&lt;ConstantSDNode&gt;(LExtOp0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0)))</div><div class="line"><a name="l03416"></a><span class="lineno"> 3416</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a2ab6db512a611d1ef4ff8069e2bbfd0d">SUBC</a>-&gt;getAPIntValue() == OpSizeInBits)</div><div class="line"><a name="l03417"></a><span class="lineno"> 3417</span>&#160;        <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(HasROTR ? <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a19cd524269b035941434cce28b585715">ISD::ROTR</a> : <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ae8f8f81d8e8d7a557d67622c05786f1d">ISD::ROTL</a>, DL, VT, LHSShiftArg,</div><div class="line"><a name="l03418"></a><span class="lineno"> 3418</span>&#160;                           HasROTR ? RHSShiftAmt : LHSShiftAmt).<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>();</div><div class="line"><a name="l03419"></a><span class="lineno"> 3419</span>&#160;  }</div><div class="line"><a name="l03420"></a><span class="lineno"> 3420</span>&#160;</div><div class="line"><a name="l03421"></a><span class="lineno"> 3421</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l03422"></a><span class="lineno"> 3422</span>&#160;}</div><div class="line"><a name="l03423"></a><span class="lineno"> 3423</span>&#160;</div><div class="line"><a name="l03424"></a><span class="lineno"> 3424</span>&#160;<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::visitXOR(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N) {</div><div class="line"><a name="l03425"></a><span class="lineno"> 3425</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N0 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0);</div><div class="line"><a name="l03426"></a><span class="lineno"> 3426</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N1 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(1);</div><div class="line"><a name="l03427"></a><span class="lineno"> 3427</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> LHS, RHS, <a class="code" href="Target_2PowerPC_2README_8txt.html#afc7ca55ad1da67847ecd4b99ef64dc84">CC</a>;</div><div class="line"><a name="l03428"></a><span class="lineno"> 3428</span>&#160;  <a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a> *N0C = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a>&gt;(N0);</div><div class="line"><a name="l03429"></a><span class="lineno"> 3429</span>&#160;  <a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a> *N1C = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a>&gt;(N1);</div><div class="line"><a name="l03430"></a><span class="lineno"> 3430</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> VT = N0.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>();</div><div class="line"><a name="l03431"></a><span class="lineno"> 3431</span>&#160;</div><div class="line"><a name="l03432"></a><span class="lineno"> 3432</span>&#160;  <span class="comment">// fold vector ops</span></div><div class="line"><a name="l03433"></a><span class="lineno"> 3433</span>&#160;  <span class="keywordflow">if</span> (VT.isVector()) {</div><div class="line"><a name="l03434"></a><span class="lineno"> 3434</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> FoldedVOp = SimplifyVBinOp(N);</div><div class="line"><a name="l03435"></a><span class="lineno"> 3435</span>&#160;    <span class="keywordflow">if</span> (FoldedVOp.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()) <span class="keywordflow">return</span> FoldedVOp;</div><div class="line"><a name="l03436"></a><span class="lineno"> 3436</span>&#160;</div><div class="line"><a name="l03437"></a><span class="lineno"> 3437</span>&#160;    <span class="comment">// fold (xor x, 0) -&gt; x, vector edition</span></div><div class="line"><a name="l03438"></a><span class="lineno"> 3438</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1ISD.html#aaac3e239cbdfe15a8e9bad4f8e1e3a95">ISD::isBuildVectorAllZeros</a>(N0.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()))</div><div class="line"><a name="l03439"></a><span class="lineno"> 3439</span>&#160;      <span class="keywordflow">return</span> N1;</div><div class="line"><a name="l03440"></a><span class="lineno"> 3440</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1ISD.html#aaac3e239cbdfe15a8e9bad4f8e1e3a95">ISD::isBuildVectorAllZeros</a>(N1.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()))</div><div class="line"><a name="l03441"></a><span class="lineno"> 3441</span>&#160;      <span class="keywordflow">return</span> N0;</div><div class="line"><a name="l03442"></a><span class="lineno"> 3442</span>&#160;  }</div><div class="line"><a name="l03443"></a><span class="lineno"> 3443</span>&#160;</div><div class="line"><a name="l03444"></a><span class="lineno"> 3444</span>&#160;  <span class="comment">// fold (xor undef, undef) -&gt; 0. This is a common idiom (misuse).</span></div><div class="line"><a name="l03445"></a><span class="lineno"> 3445</span>&#160;  <span class="keywordflow">if</span> (N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7c6d8f265e9e16e5debdb9a536b55d3d">ISD::UNDEF</a> &amp;&amp; N1.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7c6d8f265e9e16e5debdb9a536b55d3d">ISD::UNDEF</a>)</div><div class="line"><a name="l03446"></a><span class="lineno"> 3446</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(0, VT);</div><div class="line"><a name="l03447"></a><span class="lineno"> 3447</span>&#160;  <span class="comment">// fold (xor x, undef) -&gt; undef</span></div><div class="line"><a name="l03448"></a><span class="lineno"> 3448</span>&#160;  <span class="keywordflow">if</span> (N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7c6d8f265e9e16e5debdb9a536b55d3d">ISD::UNDEF</a>)</div><div class="line"><a name="l03449"></a><span class="lineno"> 3449</span>&#160;    <span class="keywordflow">return</span> N0;</div><div class="line"><a name="l03450"></a><span class="lineno"> 3450</span>&#160;  <span class="keywordflow">if</span> (N1.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7c6d8f265e9e16e5debdb9a536b55d3d">ISD::UNDEF</a>)</div><div class="line"><a name="l03451"></a><span class="lineno"> 3451</span>&#160;    <span class="keywordflow">return</span> N1;</div><div class="line"><a name="l03452"></a><span class="lineno"> 3452</span>&#160;  <span class="comment">// fold (xor c1, c2) -&gt; c1^c2</span></div><div class="line"><a name="l03453"></a><span class="lineno"> 3453</span>&#160;  <span class="keywordflow">if</span> (N0C &amp;&amp; N1C)</div><div class="line"><a name="l03454"></a><span class="lineno"> 3454</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a8503b91b7bbfb128a42fa582857f8828">FoldConstantArithmetic</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a92febb83e6ba116eb7aae8e7e3f70cc1">ISD::XOR</a>, VT, N0C, N1C);</div><div class="line"><a name="l03455"></a><span class="lineno"> 3455</span>&#160;  <span class="comment">// canonicalize constant to RHS</span></div><div class="line"><a name="l03456"></a><span class="lineno"> 3456</span>&#160;  <span class="keywordflow">if</span> (N0C &amp;&amp; !N1C)</div><div class="line"><a name="l03457"></a><span class="lineno"> 3457</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a92febb83e6ba116eb7aae8e7e3f70cc1">ISD::XOR</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N1, N0);</div><div class="line"><a name="l03458"></a><span class="lineno"> 3458</span>&#160;  <span class="comment">// fold (xor x, 0) -&gt; x</span></div><div class="line"><a name="l03459"></a><span class="lineno"> 3459</span>&#160;  <span class="keywordflow">if</span> (N1C &amp;&amp; N1C-&gt;isNullValue())</div><div class="line"><a name="l03460"></a><span class="lineno"> 3460</span>&#160;    <span class="keywordflow">return</span> N0;</div><div class="line"><a name="l03461"></a><span class="lineno"> 3461</span>&#160;  <span class="comment">// reassociate xor</span></div><div class="line"><a name="l03462"></a><span class="lineno"> 3462</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> RXOR = ReassociateOps(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a92febb83e6ba116eb7aae8e7e3f70cc1">ISD::XOR</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), N0, N1);</div><div class="line"><a name="l03463"></a><span class="lineno"> 3463</span>&#160;  <span class="keywordflow">if</span> (RXOR.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>() != 0)</div><div class="line"><a name="l03464"></a><span class="lineno"> 3464</span>&#160;    <span class="keywordflow">return</span> RXOR;</div><div class="line"><a name="l03465"></a><span class="lineno"> 3465</span>&#160;</div><div class="line"><a name="l03466"></a><span class="lineno"> 3466</span>&#160;  <span class="comment">// fold !(x cc y) -&gt; (x !cc y)</span></div><div class="line"><a name="l03467"></a><span class="lineno"> 3467</span>&#160;  <span class="keywordflow">if</span> (N1C &amp;&amp; N1C-&gt;getAPIntValue() == 1 &amp;&amp; <a class="code" href="DAGCombiner_8cpp.html#aad9b27fb736faf90f342b3fcabf413fb">isSetCCEquivalent</a>(N0, LHS, RHS, CC)) {</div><div class="line"><a name="l03468"></a><span class="lineno"> 3468</span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="namespacellvm.html#ac855c00dc7fe6cc64f4875f69479e9b4">isInt</a> = LHS.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>().<a class="code" href="structllvm_1_1EVT.html#a8cc407ac00df4edd4ec4d5168d6ecb26">isInteger</a>();</div><div class="line"><a name="l03469"></a><span class="lineno"> 3469</span>&#160;    <a class="code" href="namespacellvm_1_1ISD.html#ac3c3cf58d6d631af6a172457304d3d07">ISD::CondCode</a> NotCC = <a class="code" href="namespacellvm_1_1ISD.html#ab0a32eac8dc8dc257cf19864daa8c04f">ISD::getSetCCInverse</a>(cast&lt;CondCodeSDNode&gt;(CC)-&gt;<span class="keyword">get</span>(),</div><div class="line"><a name="l03470"></a><span class="lineno"> 3470</span>&#160;                                               isInt);</div><div class="line"><a name="l03471"></a><span class="lineno"> 3471</span>&#160;</div><div class="line"><a name="l03472"></a><span class="lineno"> 3472</span>&#160;    <span class="keywordflow">if</span> (!LegalOperations ||</div><div class="line"><a name="l03473"></a><span class="lineno"> 3473</span>&#160;        TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a5915acdb20d31a79440117652c5232ec">isCondCodeLegal</a>(NotCC, LHS.<a class="code" href="classllvm_1_1SDValue.html#a8bc8606044f2c3cdb6271c0378e0f9cf">getSimpleValueType</a>())) {</div><div class="line"><a name="l03474"></a><span class="lineno"> 3474</span>&#160;      <span class="keywordflow">switch</span> (N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>()) {</div><div class="line"><a name="l03475"></a><span class="lineno"> 3475</span>&#160;      <span class="keywordflow">default</span>:</div><div class="line"><a name="l03476"></a><span class="lineno"> 3476</span>&#160;        <a class="code" href="ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a>(<span class="stringliteral">&quot;Unhandled SetCC Equivalent!&quot;</span>);</div><div class="line"><a name="l03477"></a><span class="lineno"> 3477</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a0158ee47dfa868be5d28e2cbef70d5d0">ISD::SETCC</a>:</div><div class="line"><a name="l03478"></a><span class="lineno"> 3478</span>&#160;        <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a2650d530046f9ddfc602dc7383ba0730">getSetCC</a>(<a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, LHS, RHS, NotCC);</div><div class="line"><a name="l03479"></a><span class="lineno"> 3479</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a99ad6b342b7457df56b91d24e66016b3">ISD::SELECT_CC</a>:</div><div class="line"><a name="l03480"></a><span class="lineno"> 3480</span>&#160;        <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#ac5049f4bc4c1d0322abab27481d30c37">getSelectCC</a>(<a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), LHS, RHS, N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(2),</div><div class="line"><a name="l03481"></a><span class="lineno"> 3481</span>&#160;                               N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(3), NotCC);</div><div class="line"><a name="l03482"></a><span class="lineno"> 3482</span>&#160;      }</div><div class="line"><a name="l03483"></a><span class="lineno"> 3483</span>&#160;    }</div><div class="line"><a name="l03484"></a><span class="lineno"> 3484</span>&#160;  }</div><div class="line"><a name="l03485"></a><span class="lineno"> 3485</span>&#160;</div><div class="line"><a name="l03486"></a><span class="lineno"> 3486</span>&#160;  <span class="comment">// fold (not (zext (setcc x, y))) -&gt; (zext (not (setcc x, y)))</span></div><div class="line"><a name="l03487"></a><span class="lineno"> 3487</span>&#160;  <span class="keywordflow">if</span> (N1C &amp;&amp; N1C-&gt;getAPIntValue() == 1 &amp;&amp; N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a93fdf85eff945f1a668b4915a051453e">ISD::ZERO_EXTEND</a> &amp;&amp;</div><div class="line"><a name="l03488"></a><span class="lineno"> 3488</span>&#160;      N0.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()-&gt;<a class="code" href="classllvm_1_1SDNode.html#a52753947fce3a01b1c18dd4713c587e8">hasOneUse</a>() &amp;&amp;</div><div class="line"><a name="l03489"></a><span class="lineno"> 3489</span>&#160;      <a class="code" href="DAGCombiner_8cpp.html#aad9b27fb736faf90f342b3fcabf413fb">isSetCCEquivalent</a>(N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0), LHS, RHS, <a class="code" href="Target_2PowerPC_2README_8txt.html#afc7ca55ad1da67847ecd4b99ef64dc84">CC</a>)){</div><div class="line"><a name="l03490"></a><span class="lineno"> 3490</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> V = N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0);</div><div class="line"><a name="l03491"></a><span class="lineno"> 3491</span>&#160;    V = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a92febb83e6ba116eb7aae8e7e3f70cc1">ISD::XOR</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N0), V.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>(), V,</div><div class="line"><a name="l03492"></a><span class="lineno"> 3492</span>&#160;                    DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(1, V.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>()));</div><div class="line"><a name="l03493"></a><span class="lineno"> 3493</span>&#160;    AddToWorkList(V.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l03494"></a><span class="lineno"> 3494</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a93fdf85eff945f1a668b4915a051453e">ISD::ZERO_EXTEND</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, V);</div><div class="line"><a name="l03495"></a><span class="lineno"> 3495</span>&#160;  }</div><div class="line"><a name="l03496"></a><span class="lineno"> 3496</span>&#160;</div><div class="line"><a name="l03497"></a><span class="lineno"> 3497</span>&#160;  <span class="comment">// fold (not (or x, y)) -&gt; (and (not x), (not y)) iff x or y are setcc</span></div><div class="line"><a name="l03498"></a><span class="lineno"> 3498</span>&#160;  <span class="keywordflow">if</span> (N1C &amp;&amp; N1C-&gt;getAPIntValue() == 1 &amp;&amp; VT == <a class="code" href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50ca85440bbdbba12de574c02e515444d3f4">MVT::i1</a> &amp;&amp;</div><div class="line"><a name="l03499"></a><span class="lineno"> 3499</span>&#160;      (N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7415ab9f2172c59a2ee7c7a02afa56a4">ISD::OR</a> || N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ac513a7da1bf74fb3e3c594da8534f2d2">ISD::AND</a>)) {</div><div class="line"><a name="l03500"></a><span class="lineno"> 3500</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> LHS = N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0), RHS = N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1);</div><div class="line"><a name="l03501"></a><span class="lineno"> 3501</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="DAGCombiner_8cpp.html#af44b8fb65d2366f4cacc6845f751c5ba">isOneUseSetCC</a>(RHS) || <a class="code" href="DAGCombiner_8cpp.html#af44b8fb65d2366f4cacc6845f751c5ba">isOneUseSetCC</a>(LHS)) {</div><div class="line"><a name="l03502"></a><span class="lineno"> 3502</span>&#160;      <span class="keywordtype">unsigned</span> NewOpcode = N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ac513a7da1bf74fb3e3c594da8534f2d2">ISD::AND</a> ? <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7415ab9f2172c59a2ee7c7a02afa56a4">ISD::OR</a> : <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ac513a7da1bf74fb3e3c594da8534f2d2">ISD::AND</a>;</div><div class="line"><a name="l03503"></a><span class="lineno"> 3503</span>&#160;      LHS = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a92febb83e6ba116eb7aae8e7e3f70cc1">ISD::XOR</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(LHS), VT, LHS, N1); <span class="comment">// LHS = ~LHS</span></div><div class="line"><a name="l03504"></a><span class="lineno"> 3504</span>&#160;      RHS = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a92febb83e6ba116eb7aae8e7e3f70cc1">ISD::XOR</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(RHS), VT, RHS, N1); <span class="comment">// RHS = ~RHS</span></div><div class="line"><a name="l03505"></a><span class="lineno"> 3505</span>&#160;      AddToWorkList(LHS.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()); AddToWorkList(RHS.getNode());</div><div class="line"><a name="l03506"></a><span class="lineno"> 3506</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(NewOpcode, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, LHS, RHS);</div><div class="line"><a name="l03507"></a><span class="lineno"> 3507</span>&#160;    }</div><div class="line"><a name="l03508"></a><span class="lineno"> 3508</span>&#160;  }</div><div class="line"><a name="l03509"></a><span class="lineno"> 3509</span>&#160;  <span class="comment">// fold (not (or x, y)) -&gt; (and (not x), (not y)) iff x or y are constants</span></div><div class="line"><a name="l03510"></a><span class="lineno"> 3510</span>&#160;  <span class="keywordflow">if</span> (N1C &amp;&amp; N1C-&gt;isAllOnesValue() &amp;&amp;</div><div class="line"><a name="l03511"></a><span class="lineno"> 3511</span>&#160;      (N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7415ab9f2172c59a2ee7c7a02afa56a4">ISD::OR</a> || N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ac513a7da1bf74fb3e3c594da8534f2d2">ISD::AND</a>)) {</div><div class="line"><a name="l03512"></a><span class="lineno"> 3512</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> LHS = N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0), RHS = N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1);</div><div class="line"><a name="l03513"></a><span class="lineno"> 3513</span>&#160;    <span class="keywordflow">if</span> (isa&lt;ConstantSDNode&gt;(RHS) || isa&lt;ConstantSDNode&gt;(LHS)) {</div><div class="line"><a name="l03514"></a><span class="lineno"> 3514</span>&#160;      <span class="keywordtype">unsigned</span> NewOpcode = N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ac513a7da1bf74fb3e3c594da8534f2d2">ISD::AND</a> ? <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7415ab9f2172c59a2ee7c7a02afa56a4">ISD::OR</a> : <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ac513a7da1bf74fb3e3c594da8534f2d2">ISD::AND</a>;</div><div class="line"><a name="l03515"></a><span class="lineno"> 3515</span>&#160;      LHS = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a92febb83e6ba116eb7aae8e7e3f70cc1">ISD::XOR</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(LHS), VT, LHS, N1); <span class="comment">// LHS = ~LHS</span></div><div class="line"><a name="l03516"></a><span class="lineno"> 3516</span>&#160;      RHS = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a92febb83e6ba116eb7aae8e7e3f70cc1">ISD::XOR</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(RHS), VT, RHS, N1); <span class="comment">// RHS = ~RHS</span></div><div class="line"><a name="l03517"></a><span class="lineno"> 3517</span>&#160;      AddToWorkList(LHS.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()); AddToWorkList(RHS.getNode());</div><div class="line"><a name="l03518"></a><span class="lineno"> 3518</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(NewOpcode, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, LHS, RHS);</div><div class="line"><a name="l03519"></a><span class="lineno"> 3519</span>&#160;    }</div><div class="line"><a name="l03520"></a><span class="lineno"> 3520</span>&#160;  }</div><div class="line"><a name="l03521"></a><span class="lineno"> 3521</span>&#160;  <span class="comment">// fold (xor (and x, y), y) -&gt; (and (not x), y)</span></div><div class="line"><a name="l03522"></a><span class="lineno"> 3522</span>&#160;  <span class="keywordflow">if</span> (N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ac513a7da1bf74fb3e3c594da8534f2d2">ISD::AND</a> &amp;&amp; N0.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()-&gt;<a class="code" href="classllvm_1_1SDNode.html#a52753947fce3a01b1c18dd4713c587e8">hasOneUse</a>() &amp;&amp;</div><div class="line"><a name="l03523"></a><span class="lineno"> 3523</span>&#160;      N0-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(1) == N1) {</div><div class="line"><a name="l03524"></a><span class="lineno"> 3524</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> <a class="code" href="namespacellvm.html#a6569d00d31a5d74e563e2f39f82271ab">X</a> = N0-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0);</div><div class="line"><a name="l03525"></a><span class="lineno"> 3525</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> NotX = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a17becda56598e1d6b0d8fda77cd2fbe7">getNOT</a>(<a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(X), X, VT);</div><div class="line"><a name="l03526"></a><span class="lineno"> 3526</span>&#160;    AddToWorkList(NotX.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l03527"></a><span class="lineno"> 3527</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ac513a7da1bf74fb3e3c594da8534f2d2">ISD::AND</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, NotX, N1);</div><div class="line"><a name="l03528"></a><span class="lineno"> 3528</span>&#160;  }</div><div class="line"><a name="l03529"></a><span class="lineno"> 3529</span>&#160;  <span class="comment">// fold (xor (xor x, c1), c2) -&gt; (xor x, (xor c1, c2))</span></div><div class="line"><a name="l03530"></a><span class="lineno"> 3530</span>&#160;  <span class="keywordflow">if</span> (N1C &amp;&amp; N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a92febb83e6ba116eb7aae8e7e3f70cc1">ISD::XOR</a>) {</div><div class="line"><a name="l03531"></a><span class="lineno"> 3531</span>&#160;    <a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a> *N00C = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a>&gt;(N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0));</div><div class="line"><a name="l03532"></a><span class="lineno"> 3532</span>&#160;    <a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a> *N01C = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a>&gt;(N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1));</div><div class="line"><a name="l03533"></a><span class="lineno"> 3533</span>&#160;    <span class="keywordflow">if</span> (N00C)</div><div class="line"><a name="l03534"></a><span class="lineno"> 3534</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a92febb83e6ba116eb7aae8e7e3f70cc1">ISD::XOR</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1),</div><div class="line"><a name="l03535"></a><span class="lineno"> 3535</span>&#160;                         DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(N1C-&gt;getAPIntValue() ^</div><div class="line"><a name="l03536"></a><span class="lineno"> 3536</span>&#160;                                         N00C-&gt;<a class="code" href="classllvm_1_1ConstantSDNode.html#a7951626d3fc3c89c4efee59ed9c3d8bf">getAPIntValue</a>(), VT));</div><div class="line"><a name="l03537"></a><span class="lineno"> 3537</span>&#160;    <span class="keywordflow">if</span> (N01C)</div><div class="line"><a name="l03538"></a><span class="lineno"> 3538</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a92febb83e6ba116eb7aae8e7e3f70cc1">ISD::XOR</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0),</div><div class="line"><a name="l03539"></a><span class="lineno"> 3539</span>&#160;                         DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(N1C-&gt;getAPIntValue() ^</div><div class="line"><a name="l03540"></a><span class="lineno"> 3540</span>&#160;                                         N01C-&gt;getAPIntValue(), VT));</div><div class="line"><a name="l03541"></a><span class="lineno"> 3541</span>&#160;  }</div><div class="line"><a name="l03542"></a><span class="lineno"> 3542</span>&#160;  <span class="comment">// fold (xor x, x) -&gt; 0</span></div><div class="line"><a name="l03543"></a><span class="lineno"> 3543</span>&#160;  <span class="keywordflow">if</span> (N0 == N1)</div><div class="line"><a name="l03544"></a><span class="lineno"> 3544</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="DAGCombiner_8cpp.html#ae5856aabdc0d5eeaec3cf71f93c771a9">tryFoldToZero</a>(<a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), TLI, VT, DAG, LegalOperations, LegalTypes);</div><div class="line"><a name="l03545"></a><span class="lineno"> 3545</span>&#160;</div><div class="line"><a name="l03546"></a><span class="lineno"> 3546</span>&#160;  <span class="comment">// Simplify: xor (op x...), (op y...)  -&gt; (op (xor x, y))</span></div><div class="line"><a name="l03547"></a><span class="lineno"> 3547</span>&#160;  <span class="keywordflow">if</span> (N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == N1.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>()) {</div><div class="line"><a name="l03548"></a><span class="lineno"> 3548</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Tmp = SimplifyBinOpWithSameOpcodeHands(N);</div><div class="line"><a name="l03549"></a><span class="lineno"> 3549</span>&#160;    <span class="keywordflow">if</span> (Tmp.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()) <span class="keywordflow">return</span> Tmp;</div><div class="line"><a name="l03550"></a><span class="lineno"> 3550</span>&#160;  }</div><div class="line"><a name="l03551"></a><span class="lineno"> 3551</span>&#160;</div><div class="line"><a name="l03552"></a><span class="lineno"> 3552</span>&#160;  <span class="comment">// Simplify the expression using non-local knowledge.</span></div><div class="line"><a name="l03553"></a><span class="lineno"> 3553</span>&#160;  <span class="keywordflow">if</span> (!VT.isVector() &amp;&amp;</div><div class="line"><a name="l03554"></a><span class="lineno"> 3554</span>&#160;      SimplifyDemandedBits(<a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(N, 0)))</div><div class="line"><a name="l03555"></a><span class="lineno"> 3555</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(N, 0);</div><div class="line"><a name="l03556"></a><span class="lineno"> 3556</span>&#160;</div><div class="line"><a name="l03557"></a><span class="lineno"> 3557</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l03558"></a><span class="lineno"> 3558</span>&#160;}</div><div class="line"><a name="l03559"></a><span class="lineno"> 3559</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03560"></a><span class="lineno"> 3560</span>&#160;<span class="comment">/// visitShiftByConstant - Handle transforms common to the three shifts, when</span></div><div class="line"><a name="l03561"></a><span class="lineno"> 3561</span>&#160;<span class="comment">/// the shift amount is a constant.</span></div><div class="line"><a name="l03562"></a><span class="lineno"> 3562</span>&#160;<span class="comment"></span><a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::visitShiftByConstant(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N, <span class="keywordtype">unsigned</span> Amt) {</div><div class="line"><a name="l03563"></a><span class="lineno"> 3563</span>&#160;  <a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *LHS = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>();</div><div class="line"><a name="l03564"></a><span class="lineno"> 3564</span>&#160;  <span class="keywordflow">if</span> (!LHS-&gt;<a class="code" href="classllvm_1_1SDNode.html#a52753947fce3a01b1c18dd4713c587e8">hasOneUse</a>()) <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l03565"></a><span class="lineno"> 3565</span>&#160;</div><div class="line"><a name="l03566"></a><span class="lineno"> 3566</span>&#160;  <span class="comment">// We want to pull some binops through shifts, so that we have (and (shift))</span></div><div class="line"><a name="l03567"></a><span class="lineno"> 3567</span>&#160;  <span class="comment">// instead of (shift (and)), likewise for add, or, xor, etc.  This sort of</span></div><div class="line"><a name="l03568"></a><span class="lineno"> 3568</span>&#160;  <span class="comment">// thing happens with address calculations, so it&#39;s important to canonicalize</span></div><div class="line"><a name="l03569"></a><span class="lineno"> 3569</span>&#160;  <span class="comment">// it.</span></div><div class="line"><a name="l03570"></a><span class="lineno"> 3570</span>&#160;  <span class="keywordtype">bool</span> HighBitSet = <span class="keyword">false</span>;  <span class="comment">// Can we transform this if the high bit is set?</span></div><div class="line"><a name="l03571"></a><span class="lineno"> 3571</span>&#160;</div><div class="line"><a name="l03572"></a><span class="lineno"> 3572</span>&#160;  <span class="keywordflow">switch</span> (LHS-&gt;<a class="code" href="classllvm_1_1SDNode.html#af0d328f3f61168f4ea7d6e4044af4f97">getOpcode</a>()) {</div><div class="line"><a name="l03573"></a><span class="lineno"> 3573</span>&#160;  <span class="keywordflow">default</span>: <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l03574"></a><span class="lineno"> 3574</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7415ab9f2172c59a2ee7c7a02afa56a4">ISD::OR</a>:</div><div class="line"><a name="l03575"></a><span class="lineno"> 3575</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a92febb83e6ba116eb7aae8e7e3f70cc1">ISD::XOR</a>:</div><div class="line"><a name="l03576"></a><span class="lineno"> 3576</span>&#160;    HighBitSet = <span class="keyword">false</span>; <span class="comment">// We can only transform sra if the high bit is clear.</span></div><div class="line"><a name="l03577"></a><span class="lineno"> 3577</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l03578"></a><span class="lineno"> 3578</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ac513a7da1bf74fb3e3c594da8534f2d2">ISD::AND</a>:</div><div class="line"><a name="l03579"></a><span class="lineno"> 3579</span>&#160;    HighBitSet = <span class="keyword">true</span>;  <span class="comment">// We can only transform sra if the high bit is set.</span></div><div class="line"><a name="l03580"></a><span class="lineno"> 3580</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l03581"></a><span class="lineno"> 3581</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a269996b43a1f3e1d1f84a70fd4387535">ISD::ADD</a>:</div><div class="line"><a name="l03582"></a><span class="lineno"> 3582</span>&#160;    <span class="keywordflow">if</span> (N-&gt;<a class="code" href="classllvm_1_1SDNode.html#af0d328f3f61168f4ea7d6e4044af4f97">getOpcode</a>() != <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a8cc94e03dea594863073a02f5bb94997">ISD::SHL</a>)</div><div class="line"><a name="l03583"></a><span class="lineno"> 3583</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(); <span class="comment">// only shl(add) not sr[al](add).</span></div><div class="line"><a name="l03584"></a><span class="lineno"> 3584</span>&#160;    HighBitSet = <span class="keyword">false</span>; <span class="comment">// We can only transform sra if the high bit is clear.</span></div><div class="line"><a name="l03585"></a><span class="lineno"> 3585</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l03586"></a><span class="lineno"> 3586</span>&#160;  }</div><div class="line"><a name="l03587"></a><span class="lineno"> 3587</span>&#160;</div><div class="line"><a name="l03588"></a><span class="lineno"> 3588</span>&#160;  <span class="comment">// We require the RHS of the binop to be a constant as well.</span></div><div class="line"><a name="l03589"></a><span class="lineno"> 3589</span>&#160;  <a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a> *BinOpCst = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a>&gt;(LHS-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(1));</div><div class="line"><a name="l03590"></a><span class="lineno"> 3590</span>&#160;  <span class="keywordflow">if</span> (!BinOpCst) <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l03591"></a><span class="lineno"> 3591</span>&#160;</div><div class="line"><a name="l03592"></a><span class="lineno"> 3592</span>&#160;  <span class="comment">// FIXME: disable this unless the input to the binop is a shift by a constant.</span></div><div class="line"><a name="l03593"></a><span class="lineno"> 3593</span>&#160;  <span class="comment">// If it is not a shift, it pessimizes some common cases like:</span></div><div class="line"><a name="l03594"></a><span class="lineno"> 3594</span>&#160;  <span class="comment">//</span></div><div class="line"><a name="l03595"></a><span class="lineno"> 3595</span>&#160;  <span class="comment">//    void foo(int *X, int i) { X[i &amp; 1235] = 1; }</span></div><div class="line"><a name="l03596"></a><span class="lineno"> 3596</span>&#160;  <span class="comment">//    int bar(int *X, int i) { return X[i &amp; 255]; }</span></div><div class="line"><a name="l03597"></a><span class="lineno"> 3597</span>&#160;  <a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *BinOpLHSVal = LHS-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>();</div><div class="line"><a name="l03598"></a><span class="lineno"> 3598</span>&#160;  <span class="keywordflow">if</span> ((BinOpLHSVal-&gt;<a class="code" href="classllvm_1_1SDNode.html#af0d328f3f61168f4ea7d6e4044af4f97">getOpcode</a>() != <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a8cc94e03dea594863073a02f5bb94997">ISD::SHL</a> &amp;&amp;</div><div class="line"><a name="l03599"></a><span class="lineno"> 3599</span>&#160;       BinOpLHSVal-&gt;<a class="code" href="classllvm_1_1SDNode.html#af0d328f3f61168f4ea7d6e4044af4f97">getOpcode</a>() != <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a4a055321c361a0f6ee77ed764730ffc1">ISD::SRA</a> &amp;&amp;</div><div class="line"><a name="l03600"></a><span class="lineno"> 3600</span>&#160;       BinOpLHSVal-&gt;<a class="code" href="classllvm_1_1SDNode.html#af0d328f3f61168f4ea7d6e4044af4f97">getOpcode</a>() != <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a3c6553c8acebe1b57c211ee45e2d8f98">ISD::SRL</a>) ||</div><div class="line"><a name="l03601"></a><span class="lineno"> 3601</span>&#160;      !isa&lt;ConstantSDNode&gt;(BinOpLHSVal-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(1)))</div><div class="line"><a name="l03602"></a><span class="lineno"> 3602</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l03603"></a><span class="lineno"> 3603</span>&#160;</div><div class="line"><a name="l03604"></a><span class="lineno"> 3604</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> VT = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(0);</div><div class="line"><a name="l03605"></a><span class="lineno"> 3605</span>&#160;</div><div class="line"><a name="l03606"></a><span class="lineno"> 3606</span>&#160;  <span class="comment">// If this is a signed shift right, and the high bit is modified by the</span></div><div class="line"><a name="l03607"></a><span class="lineno"> 3607</span>&#160;  <span class="comment">// logical operation, do not perform the transformation. The highBitSet</span></div><div class="line"><a name="l03608"></a><span class="lineno"> 3608</span>&#160;  <span class="comment">// boolean indicates the value of the high bit of the constant which would</span></div><div class="line"><a name="l03609"></a><span class="lineno"> 3609</span>&#160;  <span class="comment">// cause it to be modified for this operation.</span></div><div class="line"><a name="l03610"></a><span class="lineno"> 3610</span>&#160;  <span class="keywordflow">if</span> (N-&gt;<a class="code" href="classllvm_1_1SDNode.html#af0d328f3f61168f4ea7d6e4044af4f97">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a4a055321c361a0f6ee77ed764730ffc1">ISD::SRA</a>) {</div><div class="line"><a name="l03611"></a><span class="lineno"> 3611</span>&#160;    <span class="keywordtype">bool</span> BinOpRHSSignSet = BinOpCst-&gt;<a class="code" href="classllvm_1_1ConstantSDNode.html#a7951626d3fc3c89c4efee59ed9c3d8bf">getAPIntValue</a>().<a class="code" href="classllvm_1_1APInt.html#a0e9a2d7ec903d191ef029589ec647cb6">isNegative</a>();</div><div class="line"><a name="l03612"></a><span class="lineno"> 3612</span>&#160;    <span class="keywordflow">if</span> (BinOpRHSSignSet != HighBitSet)</div><div class="line"><a name="l03613"></a><span class="lineno"> 3613</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l03614"></a><span class="lineno"> 3614</span>&#160;  }</div><div class="line"><a name="l03615"></a><span class="lineno"> 3615</span>&#160;</div><div class="line"><a name="l03616"></a><span class="lineno"> 3616</span>&#160;  <span class="comment">// Fold the constants, shifting the binop RHS by the shift amount.</span></div><div class="line"><a name="l03617"></a><span class="lineno"> 3617</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> NewRHS = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(N-&gt;<a class="code" href="classllvm_1_1SDNode.html#af0d328f3f61168f4ea7d6e4044af4f97">getOpcode</a>(), <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(LHS-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(1)),</div><div class="line"><a name="l03618"></a><span class="lineno"> 3618</span>&#160;                               N-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(0),</div><div class="line"><a name="l03619"></a><span class="lineno"> 3619</span>&#160;                               LHS-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(1), N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(1));</div><div class="line"><a name="l03620"></a><span class="lineno"> 3620</span>&#160;</div><div class="line"><a name="l03621"></a><span class="lineno"> 3621</span>&#160;  <span class="comment">// Create the new shift.</span></div><div class="line"><a name="l03622"></a><span class="lineno"> 3622</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> NewShift = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(N-&gt;<a class="code" href="classllvm_1_1SDNode.html#af0d328f3f61168f4ea7d6e4044af4f97">getOpcode</a>(),</div><div class="line"><a name="l03623"></a><span class="lineno"> 3623</span>&#160;                                 <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(LHS-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0)),</div><div class="line"><a name="l03624"></a><span class="lineno"> 3624</span>&#160;                                 VT, LHS-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0), N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(1));</div><div class="line"><a name="l03625"></a><span class="lineno"> 3625</span>&#160;</div><div class="line"><a name="l03626"></a><span class="lineno"> 3626</span>&#160;  <span class="comment">// Create the new binop.</span></div><div class="line"><a name="l03627"></a><span class="lineno"> 3627</span>&#160;  <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(LHS-&gt;<a class="code" href="classllvm_1_1SDNode.html#af0d328f3f61168f4ea7d6e4044af4f97">getOpcode</a>(), <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, NewShift, NewRHS);</div><div class="line"><a name="l03628"></a><span class="lineno"> 3628</span>&#160;}</div><div class="line"><a name="l03629"></a><span class="lineno"> 3629</span>&#160;</div><div class="line"><a name="l03630"></a><span class="lineno"> 3630</span>&#160;<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::visitSHL(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N) {</div><div class="line"><a name="l03631"></a><span class="lineno"> 3631</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N0 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0);</div><div class="line"><a name="l03632"></a><span class="lineno"> 3632</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N1 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(1);</div><div class="line"><a name="l03633"></a><span class="lineno"> 3633</span>&#160;  <a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a> *N0C = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a>&gt;(N0);</div><div class="line"><a name="l03634"></a><span class="lineno"> 3634</span>&#160;  <a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a> *N1C = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a>&gt;(N1);</div><div class="line"><a name="l03635"></a><span class="lineno"> 3635</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> VT = N0.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>();</div><div class="line"><a name="l03636"></a><span class="lineno"> 3636</span>&#160;  <span class="keywordtype">unsigned</span> OpSizeInBits = VT.<a class="code" href="structllvm_1_1EVT.html#a15be9767d0aad93fe5dcb60b7b7a78da">getScalarType</a>().<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>();</div><div class="line"><a name="l03637"></a><span class="lineno"> 3637</span>&#160;</div><div class="line"><a name="l03638"></a><span class="lineno"> 3638</span>&#160;  <span class="comment">// fold vector ops</span></div><div class="line"><a name="l03639"></a><span class="lineno"> 3639</span>&#160;  <span class="keywordflow">if</span> (VT.isVector()) {</div><div class="line"><a name="l03640"></a><span class="lineno"> 3640</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> FoldedVOp = SimplifyVBinOp(N);</div><div class="line"><a name="l03641"></a><span class="lineno"> 3641</span>&#160;    <span class="keywordflow">if</span> (FoldedVOp.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()) <span class="keywordflow">return</span> FoldedVOp;</div><div class="line"><a name="l03642"></a><span class="lineno"> 3642</span>&#160;  }</div><div class="line"><a name="l03643"></a><span class="lineno"> 3643</span>&#160;</div><div class="line"><a name="l03644"></a><span class="lineno"> 3644</span>&#160;  <span class="comment">// fold (shl c1, c2) -&gt; c1&lt;&lt;c2</span></div><div class="line"><a name="l03645"></a><span class="lineno"> 3645</span>&#160;  <span class="keywordflow">if</span> (N0C &amp;&amp; N1C)</div><div class="line"><a name="l03646"></a><span class="lineno"> 3646</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a8503b91b7bbfb128a42fa582857f8828">FoldConstantArithmetic</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a8cc94e03dea594863073a02f5bb94997">ISD::SHL</a>, VT, N0C, N1C);</div><div class="line"><a name="l03647"></a><span class="lineno"> 3647</span>&#160;  <span class="comment">// fold (shl 0, x) -&gt; 0</span></div><div class="line"><a name="l03648"></a><span class="lineno"> 3648</span>&#160;  <span class="keywordflow">if</span> (N0C &amp;&amp; N0C-&gt;<a class="code" href="classllvm_1_1ConstantSDNode.html#a702de70a3d9e57c3ffe65bc3fab3e087">isNullValue</a>())</div><div class="line"><a name="l03649"></a><span class="lineno"> 3649</span>&#160;    <span class="keywordflow">return</span> N0;</div><div class="line"><a name="l03650"></a><span class="lineno"> 3650</span>&#160;  <span class="comment">// fold (shl x, c &gt;= size(x)) -&gt; undef</span></div><div class="line"><a name="l03651"></a><span class="lineno"> 3651</span>&#160;  <span class="keywordflow">if</span> (N1C &amp;&amp; N1C-&gt;getZExtValue() &gt;= OpSizeInBits)</div><div class="line"><a name="l03652"></a><span class="lineno"> 3652</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a5b0e59823444a55c295af279611a9d24">getUNDEF</a>(VT);</div><div class="line"><a name="l03653"></a><span class="lineno"> 3653</span>&#160;  <span class="comment">// fold (shl x, 0) -&gt; x</span></div><div class="line"><a name="l03654"></a><span class="lineno"> 3654</span>&#160;  <span class="keywordflow">if</span> (N1C &amp;&amp; N1C-&gt;isNullValue())</div><div class="line"><a name="l03655"></a><span class="lineno"> 3655</span>&#160;    <span class="keywordflow">return</span> N0;</div><div class="line"><a name="l03656"></a><span class="lineno"> 3656</span>&#160;  <span class="comment">// fold (shl undef, x) -&gt; 0</span></div><div class="line"><a name="l03657"></a><span class="lineno"> 3657</span>&#160;  <span class="keywordflow">if</span> (N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7c6d8f265e9e16e5debdb9a536b55d3d">ISD::UNDEF</a>)</div><div class="line"><a name="l03658"></a><span class="lineno"> 3658</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(0, VT);</div><div class="line"><a name="l03659"></a><span class="lineno"> 3659</span>&#160;  <span class="comment">// if (shl x, c) is known to be zero, return 0</span></div><div class="line"><a name="l03660"></a><span class="lineno"> 3660</span>&#160;  <span class="keywordflow">if</span> (DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af99f246db9e144fefd7a73b54ef0bbf7">MaskedValueIsZero</a>(<a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(N, 0),</div><div class="line"><a name="l03661"></a><span class="lineno"> 3661</span>&#160;                            <a class="code" href="classllvm_1_1APInt.html#a539bdb4fdbf46e0bfcefebf5ac6d21dd">APInt::getAllOnesValue</a>(OpSizeInBits)))</div><div class="line"><a name="l03662"></a><span class="lineno"> 3662</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(0, VT);</div><div class="line"><a name="l03663"></a><span class="lineno"> 3663</span>&#160;  <span class="comment">// fold (shl x, (trunc (and y, c))) -&gt; (shl x, (and (trunc y), (trunc c))).</span></div><div class="line"><a name="l03664"></a><span class="lineno"> 3664</span>&#160;  <span class="keywordflow">if</span> (N1.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ae690127648393001a7d5b93dc23da7b3">ISD::TRUNCATE</a> &amp;&amp;</div><div class="line"><a name="l03665"></a><span class="lineno"> 3665</span>&#160;      N1.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ac513a7da1bf74fb3e3c594da8534f2d2">ISD::AND</a> &amp;&amp;</div><div class="line"><a name="l03666"></a><span class="lineno"> 3666</span>&#160;      N1.<a class="code" href="classllvm_1_1SDValue.html#a97b0f24f3e52f030830fca6fbfcbd37d">hasOneUse</a>() &amp;&amp; N1.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a97b0f24f3e52f030830fca6fbfcbd37d">hasOneUse</a>()) {</div><div class="line"><a name="l03667"></a><span class="lineno"> 3667</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N101 = N1.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1);</div><div class="line"><a name="l03668"></a><span class="lineno"> 3668</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a> *N101C = dyn_cast&lt;ConstantSDNode&gt;(N101)) {</div><div class="line"><a name="l03669"></a><span class="lineno"> 3669</span>&#160;      <a class="code" href="structllvm_1_1EVT.html">EVT</a> TruncVT = N1.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>();</div><div class="line"><a name="l03670"></a><span class="lineno"> 3670</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N100 = N1.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0);</div><div class="line"><a name="l03671"></a><span class="lineno"> 3671</span>&#160;      <a class="code" href="classllvm_1_1APInt.html">APInt</a> TruncC = N101C-&gt;getAPIntValue();</div><div class="line"><a name="l03672"></a><span class="lineno"> 3672</span>&#160;      TruncC = TruncC.<a class="code" href="classllvm_1_1APInt.html#a8cf5475fb3e9c737112cc248194c1040">trunc</a>(TruncVT.<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>());</div><div class="line"><a name="l03673"></a><span class="lineno"> 3673</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a8cc94e03dea594863073a02f5bb94997">ISD::SHL</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N0,</div><div class="line"><a name="l03674"></a><span class="lineno"> 3674</span>&#160;                         DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ac513a7da1bf74fb3e3c594da8534f2d2">ISD::AND</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), TruncVT,</div><div class="line"><a name="l03675"></a><span class="lineno"> 3675</span>&#160;                                     DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ae690127648393001a7d5b93dc23da7b3">ISD::TRUNCATE</a>,</div><div class="line"><a name="l03676"></a><span class="lineno"> 3676</span>&#160;                                                 <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N),</div><div class="line"><a name="l03677"></a><span class="lineno"> 3677</span>&#160;                                                 TruncVT, N100),</div><div class="line"><a name="l03678"></a><span class="lineno"> 3678</span>&#160;                                     DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(TruncC, TruncVT)));</div><div class="line"><a name="l03679"></a><span class="lineno"> 3679</span>&#160;    }</div><div class="line"><a name="l03680"></a><span class="lineno"> 3680</span>&#160;  }</div><div class="line"><a name="l03681"></a><span class="lineno"> 3681</span>&#160;</div><div class="line"><a name="l03682"></a><span class="lineno"> 3682</span>&#160;  <span class="keywordflow">if</span> (N1C &amp;&amp; SimplifyDemandedBits(<a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(N, 0)))</div><div class="line"><a name="l03683"></a><span class="lineno"> 3683</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(N, 0);</div><div class="line"><a name="l03684"></a><span class="lineno"> 3684</span>&#160;</div><div class="line"><a name="l03685"></a><span class="lineno"> 3685</span>&#160;  <span class="comment">// fold (shl (shl x, c1), c2) -&gt; 0 or (shl x, (add c1, c2))</span></div><div class="line"><a name="l03686"></a><span class="lineno"> 3686</span>&#160;  <span class="keywordflow">if</span> (N1C &amp;&amp; N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a8cc94e03dea594863073a02f5bb94997">ISD::SHL</a> &amp;&amp;</div><div class="line"><a name="l03687"></a><span class="lineno"> 3687</span>&#160;      N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1).<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110aac2f0a84dd2aa5ee4c3f1385e9565f5e">ISD::Constant</a>) {</div><div class="line"><a name="l03688"></a><span class="lineno"> 3688</span>&#160;    uint64_t c1 = cast&lt;ConstantSDNode&gt;(N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1))-&gt;getZExtValue();</div><div class="line"><a name="l03689"></a><span class="lineno"> 3689</span>&#160;    uint64_t <a class="code" href="README-SSE_8txt.html#aadea95510755202aaa1c5ebfe4fcde48">c2</a> = N1C-&gt;getZExtValue();</div><div class="line"><a name="l03690"></a><span class="lineno"> 3690</span>&#160;    <span class="keywordflow">if</span> (c1 + c2 &gt;= OpSizeInBits)</div><div class="line"><a name="l03691"></a><span class="lineno"> 3691</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(0, VT);</div><div class="line"><a name="l03692"></a><span class="lineno"> 3692</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a8cc94e03dea594863073a02f5bb94997">ISD::SHL</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0),</div><div class="line"><a name="l03693"></a><span class="lineno"> 3693</span>&#160;                       DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(c1 + c2, N1.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>()));</div><div class="line"><a name="l03694"></a><span class="lineno"> 3694</span>&#160;  }</div><div class="line"><a name="l03695"></a><span class="lineno"> 3695</span>&#160;</div><div class="line"><a name="l03696"></a><span class="lineno"> 3696</span>&#160;  <span class="comment">// fold (shl (ext (shl x, c1)), c2) -&gt; (ext (shl x, (add c1, c2)))</span></div><div class="line"><a name="l03697"></a><span class="lineno"> 3697</span>&#160;  <span class="comment">// For this to be valid, the second form must not preserve any of the bits</span></div><div class="line"><a name="l03698"></a><span class="lineno"> 3698</span>&#160;  <span class="comment">// that are shifted out by the inner shift in the first form.  This means</span></div><div class="line"><a name="l03699"></a><span class="lineno"> 3699</span>&#160;  <span class="comment">// the outer shift size must be &gt;= the number of bits added by the ext.</span></div><div class="line"><a name="l03700"></a><span class="lineno"> 3700</span>&#160;  <span class="comment">// As a corollary, we don&#39;t care what kind of ext it is.</span></div><div class="line"><a name="l03701"></a><span class="lineno"> 3701</span>&#160;  <span class="keywordflow">if</span> (N1C &amp;&amp; (N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a93fdf85eff945f1a668b4915a051453e">ISD::ZERO_EXTEND</a> ||</div><div class="line"><a name="l03702"></a><span class="lineno"> 3702</span>&#160;              N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a27d5d8ef82302b739ba3ca8be1a5513d">ISD::ANY_EXTEND</a> ||</div><div class="line"><a name="l03703"></a><span class="lineno"> 3703</span>&#160;              N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a5183f3d72924bc7c77ba8d3f5de9f602">ISD::SIGN_EXTEND</a>) &amp;&amp;</div><div class="line"><a name="l03704"></a><span class="lineno"> 3704</span>&#160;      N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a8cc94e03dea594863073a02f5bb94997">ISD::SHL</a> &amp;&amp;</div><div class="line"><a name="l03705"></a><span class="lineno"> 3705</span>&#160;      isa&lt;ConstantSDNode&gt;(N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0)-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(1))) {</div><div class="line"><a name="l03706"></a><span class="lineno"> 3706</span>&#160;    uint64_t c1 =</div><div class="line"><a name="l03707"></a><span class="lineno"> 3707</span>&#160;      cast&lt;ConstantSDNode&gt;(N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0)-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(1))-&gt;getZExtValue();</div><div class="line"><a name="l03708"></a><span class="lineno"> 3708</span>&#160;    uint64_t <a class="code" href="README-SSE_8txt.html#aadea95510755202aaa1c5ebfe4fcde48">c2</a> = N1C-&gt;getZExtValue();</div><div class="line"><a name="l03709"></a><span class="lineno"> 3709</span>&#160;    <a class="code" href="structllvm_1_1EVT.html">EVT</a> InnerShiftVT = N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>();</div><div class="line"><a name="l03710"></a><span class="lineno"> 3710</span>&#160;    uint64_t InnerShiftSize = InnerShiftVT.<a class="code" href="structllvm_1_1EVT.html#a15be9767d0aad93fe5dcb60b7b7a78da">getScalarType</a>().<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>();</div><div class="line"><a name="l03711"></a><span class="lineno"> 3711</span>&#160;    <span class="keywordflow">if</span> (c2 &gt;= OpSizeInBits - InnerShiftSize) {</div><div class="line"><a name="l03712"></a><span class="lineno"> 3712</span>&#160;      <span class="keywordflow">if</span> (c1 + c2 &gt;= OpSizeInBits)</div><div class="line"><a name="l03713"></a><span class="lineno"> 3713</span>&#160;        <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(0, VT);</div><div class="line"><a name="l03714"></a><span class="lineno"> 3714</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a8cc94e03dea594863073a02f5bb94997">ISD::SHL</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N0), VT,</div><div class="line"><a name="l03715"></a><span class="lineno"> 3715</span>&#160;                         DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>(), <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N0), VT,</div><div class="line"><a name="l03716"></a><span class="lineno"> 3716</span>&#160;                                     N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0)-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0)),</div><div class="line"><a name="l03717"></a><span class="lineno"> 3717</span>&#160;                         DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(c1 + c2, N1.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>()));</div><div class="line"><a name="l03718"></a><span class="lineno"> 3718</span>&#160;    }</div><div class="line"><a name="l03719"></a><span class="lineno"> 3719</span>&#160;  }</div><div class="line"><a name="l03720"></a><span class="lineno"> 3720</span>&#160;</div><div class="line"><a name="l03721"></a><span class="lineno"> 3721</span>&#160;  <span class="comment">// fold (shl (zext (srl x, C)), C) -&gt; (zext (shl (srl x, C), C))</span></div><div class="line"><a name="l03722"></a><span class="lineno"> 3722</span>&#160;  <span class="comment">// Only fold this if the inner zext has no other uses to avoid increasing</span></div><div class="line"><a name="l03723"></a><span class="lineno"> 3723</span>&#160;  <span class="comment">// the total number of instructions.</span></div><div class="line"><a name="l03724"></a><span class="lineno"> 3724</span>&#160;  <span class="keywordflow">if</span> (N1C &amp;&amp; N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a93fdf85eff945f1a668b4915a051453e">ISD::ZERO_EXTEND</a> &amp;&amp; N0.<a class="code" href="classllvm_1_1SDValue.html#a97b0f24f3e52f030830fca6fbfcbd37d">hasOneUse</a>() &amp;&amp;</div><div class="line"><a name="l03725"></a><span class="lineno"> 3725</span>&#160;      N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a3c6553c8acebe1b57c211ee45e2d8f98">ISD::SRL</a> &amp;&amp;</div><div class="line"><a name="l03726"></a><span class="lineno"> 3726</span>&#160;      isa&lt;ConstantSDNode&gt;(N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0)-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(1))) {</div><div class="line"><a name="l03727"></a><span class="lineno"> 3727</span>&#160;    uint64_t c1 =</div><div class="line"><a name="l03728"></a><span class="lineno"> 3728</span>&#160;      cast&lt;ConstantSDNode&gt;(N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0)-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(1))-&gt;getZExtValue();</div><div class="line"><a name="l03729"></a><span class="lineno"> 3729</span>&#160;    <span class="keywordflow">if</span> (c1 &lt; VT.getSizeInBits()) {</div><div class="line"><a name="l03730"></a><span class="lineno"> 3730</span>&#160;      uint64_t <a class="code" href="README-SSE_8txt.html#aadea95510755202aaa1c5ebfe4fcde48">c2</a> = N1C-&gt;getZExtValue();</div><div class="line"><a name="l03731"></a><span class="lineno"> 3731</span>&#160;      <span class="keywordflow">if</span> (c1 == c2) {</div><div class="line"><a name="l03732"></a><span class="lineno"> 3732</span>&#160;        <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> NewOp0 = N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0);</div><div class="line"><a name="l03733"></a><span class="lineno"> 3733</span>&#160;        <a class="code" href="structllvm_1_1EVT.html">EVT</a> CountVT = NewOp0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1).<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>();</div><div class="line"><a name="l03734"></a><span class="lineno"> 3734</span>&#160;        <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> NewSHL = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a8cc94e03dea594863073a02f5bb94997">ISD::SHL</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), NewOp0.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>(),</div><div class="line"><a name="l03735"></a><span class="lineno"> 3735</span>&#160;                                     NewOp0, DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(c2, CountVT));</div><div class="line"><a name="l03736"></a><span class="lineno"> 3736</span>&#160;        AddToWorkList(NewSHL.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l03737"></a><span class="lineno"> 3737</span>&#160;        <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a93fdf85eff945f1a668b4915a051453e">ISD::ZERO_EXTEND</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N0), VT, NewSHL);</div><div class="line"><a name="l03738"></a><span class="lineno"> 3738</span>&#160;      }</div><div class="line"><a name="l03739"></a><span class="lineno"> 3739</span>&#160;    }</div><div class="line"><a name="l03740"></a><span class="lineno"> 3740</span>&#160;  }</div><div class="line"><a name="l03741"></a><span class="lineno"> 3741</span>&#160;</div><div class="line"><a name="l03742"></a><span class="lineno"> 3742</span>&#160;  <span class="comment">// fold (shl (srl x, c1), c2) -&gt; (and (shl x, (sub c2, c1), MASK) or</span></div><div class="line"><a name="l03743"></a><span class="lineno"> 3743</span>&#160;  <span class="comment">//                               (and (srl x, (sub c1, c2), MASK)</span></div><div class="line"><a name="l03744"></a><span class="lineno"> 3744</span>&#160;  <span class="comment">// Only fold this if the inner shift has no other uses -- if it does, folding</span></div><div class="line"><a name="l03745"></a><span class="lineno"> 3745</span>&#160;  <span class="comment">// this will increase the total number of instructions.</span></div><div class="line"><a name="l03746"></a><span class="lineno"> 3746</span>&#160;  <span class="keywordflow">if</span> (N1C &amp;&amp; N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a3c6553c8acebe1b57c211ee45e2d8f98">ISD::SRL</a> &amp;&amp; N0.<a class="code" href="classllvm_1_1SDValue.html#a97b0f24f3e52f030830fca6fbfcbd37d">hasOneUse</a>() &amp;&amp;</div><div class="line"><a name="l03747"></a><span class="lineno"> 3747</span>&#160;      N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1).<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110aac2f0a84dd2aa5ee4c3f1385e9565f5e">ISD::Constant</a>) {</div><div class="line"><a name="l03748"></a><span class="lineno"> 3748</span>&#160;    uint64_t c1 = cast&lt;ConstantSDNode&gt;(N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1))-&gt;getZExtValue();</div><div class="line"><a name="l03749"></a><span class="lineno"> 3749</span>&#160;    <span class="keywordflow">if</span> (c1 &lt; VT.getSizeInBits()) {</div><div class="line"><a name="l03750"></a><span class="lineno"> 3750</span>&#160;      uint64_t <a class="code" href="README-SSE_8txt.html#aadea95510755202aaa1c5ebfe4fcde48">c2</a> = N1C-&gt;getZExtValue();</div><div class="line"><a name="l03751"></a><span class="lineno"> 3751</span>&#160;      <a class="code" href="classllvm_1_1APInt.html">APInt</a> Mask = <a class="code" href="classllvm_1_1APInt.html#adcb96bd09d7c75c7669fa5f9d1190899">APInt::getHighBitsSet</a>(VT.getSizeInBits(),</div><div class="line"><a name="l03752"></a><span class="lineno"> 3752</span>&#160;                                         VT.getSizeInBits() - c1);</div><div class="line"><a name="l03753"></a><span class="lineno"> 3753</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> <a class="code" href="Target_2README_8txt.html#a8db36c82f32d6f6a4d35a00e55be03a8">Shift</a>;</div><div class="line"><a name="l03754"></a><span class="lineno"> 3754</span>&#160;      <span class="keywordflow">if</span> (c2 &gt; c1) {</div><div class="line"><a name="l03755"></a><span class="lineno"> 3755</span>&#160;        Mask = Mask.<a class="code" href="classllvm_1_1APInt.html#a45266d6f33cd3d34f75842ddf4029a9d">shl</a>(c2-c1);</div><div class="line"><a name="l03756"></a><span class="lineno"> 3756</span>&#160;        Shift = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a8cc94e03dea594863073a02f5bb94997">ISD::SHL</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0),</div><div class="line"><a name="l03757"></a><span class="lineno"> 3757</span>&#160;                            DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(c2-c1, N1.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>()));</div><div class="line"><a name="l03758"></a><span class="lineno"> 3758</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l03759"></a><span class="lineno"> 3759</span>&#160;        Mask = Mask.<a class="code" href="classllvm_1_1APInt.html#aa1953b3ad7ef6aa87dc0205db0c2ea45">lshr</a>(c1-c2);</div><div class="line"><a name="l03760"></a><span class="lineno"> 3760</span>&#160;        Shift = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a3c6553c8acebe1b57c211ee45e2d8f98">ISD::SRL</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0),</div><div class="line"><a name="l03761"></a><span class="lineno"> 3761</span>&#160;                            DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(c1-c2, N1.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>()));</div><div class="line"><a name="l03762"></a><span class="lineno"> 3762</span>&#160;      }</div><div class="line"><a name="l03763"></a><span class="lineno"> 3763</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ac513a7da1bf74fb3e3c594da8534f2d2">ISD::AND</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N0), VT, Shift,</div><div class="line"><a name="l03764"></a><span class="lineno"> 3764</span>&#160;                         DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(Mask, VT));</div><div class="line"><a name="l03765"></a><span class="lineno"> 3765</span>&#160;    }</div><div class="line"><a name="l03766"></a><span class="lineno"> 3766</span>&#160;  }</div><div class="line"><a name="l03767"></a><span class="lineno"> 3767</span>&#160;  <span class="comment">// fold (shl (sra x, c1), c1) -&gt; (and x, (shl -1, c1))</span></div><div class="line"><a name="l03768"></a><span class="lineno"> 3768</span>&#160;  <span class="keywordflow">if</span> (N1C &amp;&amp; N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a4a055321c361a0f6ee77ed764730ffc1">ISD::SRA</a> &amp;&amp; N1 == N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1)) {</div><div class="line"><a name="l03769"></a><span class="lineno"> 3769</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> HiBitsMask =</div><div class="line"><a name="l03770"></a><span class="lineno"> 3770</span>&#160;      DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(<a class="code" href="classllvm_1_1APInt.html#adcb96bd09d7c75c7669fa5f9d1190899">APInt::getHighBitsSet</a>(VT.getSizeInBits(),</div><div class="line"><a name="l03771"></a><span class="lineno"> 3771</span>&#160;                                            VT.getSizeInBits() -</div><div class="line"><a name="l03772"></a><span class="lineno"> 3772</span>&#160;                                              N1C-&gt;getZExtValue()),</div><div class="line"><a name="l03773"></a><span class="lineno"> 3773</span>&#160;                      VT);</div><div class="line"><a name="l03774"></a><span class="lineno"> 3774</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ac513a7da1bf74fb3e3c594da8534f2d2">ISD::AND</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0),</div><div class="line"><a name="l03775"></a><span class="lineno"> 3775</span>&#160;                       HiBitsMask);</div><div class="line"><a name="l03776"></a><span class="lineno"> 3776</span>&#160;  }</div><div class="line"><a name="l03777"></a><span class="lineno"> 3777</span>&#160;</div><div class="line"><a name="l03778"></a><span class="lineno"> 3778</span>&#160;  <span class="keywordflow">if</span> (N1C) {</div><div class="line"><a name="l03779"></a><span class="lineno"> 3779</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> NewSHL = visitShiftByConstant(N, N1C-&gt;getZExtValue());</div><div class="line"><a name="l03780"></a><span class="lineno"> 3780</span>&#160;    <span class="keywordflow">if</span> (NewSHL.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>())</div><div class="line"><a name="l03781"></a><span class="lineno"> 3781</span>&#160;      <span class="keywordflow">return</span> NewSHL;</div><div class="line"><a name="l03782"></a><span class="lineno"> 3782</span>&#160;  }</div><div class="line"><a name="l03783"></a><span class="lineno"> 3783</span>&#160;</div><div class="line"><a name="l03784"></a><span class="lineno"> 3784</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l03785"></a><span class="lineno"> 3785</span>&#160;}</div><div class="line"><a name="l03786"></a><span class="lineno"> 3786</span>&#160;</div><div class="line"><a name="l03787"></a><span class="lineno"> 3787</span>&#160;<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::visitSRA(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N) {</div><div class="line"><a name="l03788"></a><span class="lineno"> 3788</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N0 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0);</div><div class="line"><a name="l03789"></a><span class="lineno"> 3789</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N1 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(1);</div><div class="line"><a name="l03790"></a><span class="lineno"> 3790</span>&#160;  <a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a> *N0C = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a>&gt;(N0);</div><div class="line"><a name="l03791"></a><span class="lineno"> 3791</span>&#160;  <a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a> *N1C = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a>&gt;(N1);</div><div class="line"><a name="l03792"></a><span class="lineno"> 3792</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> VT = N0.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>();</div><div class="line"><a name="l03793"></a><span class="lineno"> 3793</span>&#160;  <span class="keywordtype">unsigned</span> OpSizeInBits = VT.<a class="code" href="structllvm_1_1EVT.html#a15be9767d0aad93fe5dcb60b7b7a78da">getScalarType</a>().<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>();</div><div class="line"><a name="l03794"></a><span class="lineno"> 3794</span>&#160;</div><div class="line"><a name="l03795"></a><span class="lineno"> 3795</span>&#160;  <span class="comment">// fold vector ops</span></div><div class="line"><a name="l03796"></a><span class="lineno"> 3796</span>&#160;  <span class="keywordflow">if</span> (VT.isVector()) {</div><div class="line"><a name="l03797"></a><span class="lineno"> 3797</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> FoldedVOp = SimplifyVBinOp(N);</div><div class="line"><a name="l03798"></a><span class="lineno"> 3798</span>&#160;    <span class="keywordflow">if</span> (FoldedVOp.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()) <span class="keywordflow">return</span> FoldedVOp;</div><div class="line"><a name="l03799"></a><span class="lineno"> 3799</span>&#160;  }</div><div class="line"><a name="l03800"></a><span class="lineno"> 3800</span>&#160;</div><div class="line"><a name="l03801"></a><span class="lineno"> 3801</span>&#160;  <span class="comment">// fold (sra c1, c2) -&gt; (sra c1, c2)</span></div><div class="line"><a name="l03802"></a><span class="lineno"> 3802</span>&#160;  <span class="keywordflow">if</span> (N0C &amp;&amp; N1C)</div><div class="line"><a name="l03803"></a><span class="lineno"> 3803</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a8503b91b7bbfb128a42fa582857f8828">FoldConstantArithmetic</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a4a055321c361a0f6ee77ed764730ffc1">ISD::SRA</a>, VT, N0C, N1C);</div><div class="line"><a name="l03804"></a><span class="lineno"> 3804</span>&#160;  <span class="comment">// fold (sra 0, x) -&gt; 0</span></div><div class="line"><a name="l03805"></a><span class="lineno"> 3805</span>&#160;  <span class="keywordflow">if</span> (N0C &amp;&amp; N0C-&gt;<a class="code" href="classllvm_1_1ConstantSDNode.html#a702de70a3d9e57c3ffe65bc3fab3e087">isNullValue</a>())</div><div class="line"><a name="l03806"></a><span class="lineno"> 3806</span>&#160;    <span class="keywordflow">return</span> N0;</div><div class="line"><a name="l03807"></a><span class="lineno"> 3807</span>&#160;  <span class="comment">// fold (sra -1, x) -&gt; -1</span></div><div class="line"><a name="l03808"></a><span class="lineno"> 3808</span>&#160;  <span class="keywordflow">if</span> (N0C &amp;&amp; N0C-&gt;<a class="code" href="classllvm_1_1ConstantSDNode.html#aa5c86745e9f101eabafef104239b9677">isAllOnesValue</a>())</div><div class="line"><a name="l03809"></a><span class="lineno"> 3809</span>&#160;    <span class="keywordflow">return</span> N0;</div><div class="line"><a name="l03810"></a><span class="lineno"> 3810</span>&#160;  <span class="comment">// fold (sra x, (setge c, size(x))) -&gt; undef</span></div><div class="line"><a name="l03811"></a><span class="lineno"> 3811</span>&#160;  <span class="keywordflow">if</span> (N1C &amp;&amp; N1C-&gt;getZExtValue() &gt;= OpSizeInBits)</div><div class="line"><a name="l03812"></a><span class="lineno"> 3812</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a5b0e59823444a55c295af279611a9d24">getUNDEF</a>(VT);</div><div class="line"><a name="l03813"></a><span class="lineno"> 3813</span>&#160;  <span class="comment">// fold (sra x, 0) -&gt; x</span></div><div class="line"><a name="l03814"></a><span class="lineno"> 3814</span>&#160;  <span class="keywordflow">if</span> (N1C &amp;&amp; N1C-&gt;isNullValue())</div><div class="line"><a name="l03815"></a><span class="lineno"> 3815</span>&#160;    <span class="keywordflow">return</span> N0;</div><div class="line"><a name="l03816"></a><span class="lineno"> 3816</span>&#160;  <span class="comment">// fold (sra (shl x, c1), c1) -&gt; sext_inreg for some c1 and target supports</span></div><div class="line"><a name="l03817"></a><span class="lineno"> 3817</span>&#160;  <span class="comment">// sext_inreg.</span></div><div class="line"><a name="l03818"></a><span class="lineno"> 3818</span>&#160;  <span class="keywordflow">if</span> (N1C &amp;&amp; N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a8cc94e03dea594863073a02f5bb94997">ISD::SHL</a> &amp;&amp; N1 == N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1)) {</div><div class="line"><a name="l03819"></a><span class="lineno"> 3819</span>&#160;    <span class="keywordtype">unsigned</span> LowBits = OpSizeInBits - (unsigned)N1C-&gt;getZExtValue();</div><div class="line"><a name="l03820"></a><span class="lineno"> 3820</span>&#160;    <a class="code" href="structllvm_1_1EVT.html">EVT</a> ExtVT = <a class="code" href="structllvm_1_1EVT.html#a752372e170e4e7c595bf8810bb52adf2">EVT::getIntegerVT</a>(*DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a39c6dff47b8dbd25cfaf6336c7056077">getContext</a>(), LowBits);</div><div class="line"><a name="l03821"></a><span class="lineno"> 3821</span>&#160;    <span class="keywordflow">if</span> (VT.isVector())</div><div class="line"><a name="l03822"></a><span class="lineno"> 3822</span>&#160;      ExtVT = <a class="code" href="structllvm_1_1EVT.html#a18c2edf1939f6e87f1e586b815f398cd">EVT::getVectorVT</a>(*DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a39c6dff47b8dbd25cfaf6336c7056077">getContext</a>(),</div><div class="line"><a name="l03823"></a><span class="lineno"> 3823</span>&#160;                               ExtVT, VT.<a class="code" href="structllvm_1_1EVT.html#a42bca41d2438197c12b6db2c710a959c">getVectorNumElements</a>());</div><div class="line"><a name="l03824"></a><span class="lineno"> 3824</span>&#160;    <span class="keywordflow">if</span> ((!LegalOperations ||</div><div class="line"><a name="l03825"></a><span class="lineno"> 3825</span>&#160;         TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a055b3905dbbc16fae11510b9ebd1e00c">isOperationLegal</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110aaa59dd5ec37f21905436b354c0292d9e">ISD::SIGN_EXTEND_INREG</a>, ExtVT)))</div><div class="line"><a name="l03826"></a><span class="lineno"> 3826</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110aaa59dd5ec37f21905436b354c0292d9e">ISD::SIGN_EXTEND_INREG</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT,</div><div class="line"><a name="l03827"></a><span class="lineno"> 3827</span>&#160;                         N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0), DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#ab8ba6b05ad4fa7517f2e23b26f84ae1b">getValueType</a>(ExtVT));</div><div class="line"><a name="l03828"></a><span class="lineno"> 3828</span>&#160;  }</div><div class="line"><a name="l03829"></a><span class="lineno"> 3829</span>&#160;</div><div class="line"><a name="l03830"></a><span class="lineno"> 3830</span>&#160;  <span class="comment">// fold (sra (sra x, c1), c2) -&gt; (sra x, (add c1, c2))</span></div><div class="line"><a name="l03831"></a><span class="lineno"> 3831</span>&#160;  <span class="keywordflow">if</span> (N1C &amp;&amp; N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a4a055321c361a0f6ee77ed764730ffc1">ISD::SRA</a>) {</div><div class="line"><a name="l03832"></a><span class="lineno"> 3832</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a> *<a class="code" href="Target_2README_8txt.html#a2a2df5a25b9c703e74e82b48a75d0c3d">C1</a> = dyn_cast&lt;ConstantSDNode&gt;(N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1))) {</div><div class="line"><a name="l03833"></a><span class="lineno"> 3833</span>&#160;      <span class="keywordtype">unsigned</span> <a class="code" href="Target_2X86_2README_8txt.html#a0ed5c5d6ff68f354e354920a3680185c">Sum</a> = N1C-&gt;getZExtValue() + <a class="code" href="Target_2README_8txt.html#a2a2df5a25b9c703e74e82b48a75d0c3d">C1</a>-&gt;getZExtValue();</div><div class="line"><a name="l03834"></a><span class="lineno"> 3834</span>&#160;      <span class="keywordflow">if</span> (Sum &gt;= OpSizeInBits) Sum = OpSizeInBits-1;</div><div class="line"><a name="l03835"></a><span class="lineno"> 3835</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a4a055321c361a0f6ee77ed764730ffc1">ISD::SRA</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0),</div><div class="line"><a name="l03836"></a><span class="lineno"> 3836</span>&#160;                         DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(Sum, N1C-&gt;getValueType(0)));</div><div class="line"><a name="l03837"></a><span class="lineno"> 3837</span>&#160;    }</div><div class="line"><a name="l03838"></a><span class="lineno"> 3838</span>&#160;  }</div><div class="line"><a name="l03839"></a><span class="lineno"> 3839</span>&#160;</div><div class="line"><a name="l03840"></a><span class="lineno"> 3840</span>&#160;  <span class="comment">// fold (sra (shl X, m), (sub result_size, n))</span></div><div class="line"><a name="l03841"></a><span class="lineno"> 3841</span>&#160;  <span class="comment">// -&gt; (sign_extend (trunc (shl X, (sub (sub result_size, n), m)))) for</span></div><div class="line"><a name="l03842"></a><span class="lineno"> 3842</span>&#160;  <span class="comment">// result_size - n != m.</span></div><div class="line"><a name="l03843"></a><span class="lineno"> 3843</span>&#160;  <span class="comment">// If truncate is free for the target sext(shl) is likely to result in better</span></div><div class="line"><a name="l03844"></a><span class="lineno"> 3844</span>&#160;  <span class="comment">// code.</span></div><div class="line"><a name="l03845"></a><span class="lineno"> 3845</span>&#160;  <span class="keywordflow">if</span> (N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a8cc94e03dea594863073a02f5bb94997">ISD::SHL</a>) {</div><div class="line"><a name="l03846"></a><span class="lineno"> 3846</span>&#160;    <span class="comment">// Get the two constanst of the shifts, CN0 = m, CN = n.</span></div><div class="line"><a name="l03847"></a><span class="lineno"> 3847</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a> *N01C = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a>&gt;(N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1));</div><div class="line"><a name="l03848"></a><span class="lineno"> 3848</span>&#160;    <span class="keywordflow">if</span> (N01C &amp;&amp; N1C) {</div><div class="line"><a name="l03849"></a><span class="lineno"> 3849</span>&#160;      <span class="comment">// Determine what the truncate&#39;s result bitsize and type would be.</span></div><div class="line"><a name="l03850"></a><span class="lineno"> 3850</span>&#160;      <a class="code" href="structllvm_1_1EVT.html">EVT</a> TruncVT =</div><div class="line"><a name="l03851"></a><span class="lineno"> 3851</span>&#160;        <a class="code" href="structllvm_1_1EVT.html#a752372e170e4e7c595bf8810bb52adf2">EVT::getIntegerVT</a>(*DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a39c6dff47b8dbd25cfaf6336c7056077">getContext</a>(),</div><div class="line"><a name="l03852"></a><span class="lineno"> 3852</span>&#160;                          OpSizeInBits - N1C-&gt;getZExtValue());</div><div class="line"><a name="l03853"></a><span class="lineno"> 3853</span>&#160;      <span class="comment">// Determine the residual right-shift amount.</span></div><div class="line"><a name="l03854"></a><span class="lineno"> 3854</span>&#160;      <span class="keywordtype">signed</span> ShiftAmt = N1C-&gt;getZExtValue() - N01C-&gt;<a class="code" href="classllvm_1_1ConstantSDNode.html#a1e9365c991dd55e65e9d5ab5653812e4">getZExtValue</a>();</div><div class="line"><a name="l03855"></a><span class="lineno"> 3855</span>&#160;</div><div class="line"><a name="l03856"></a><span class="lineno"> 3856</span>&#160;      <span class="comment">// If the shift is not a no-op (in which case this should be just a sign</span></div><div class="line"><a name="l03857"></a><span class="lineno"> 3857</span>&#160;      <span class="comment">// extend already), the truncated to type is legal, sign_extend is legal</span></div><div class="line"><a name="l03858"></a><span class="lineno"> 3858</span>&#160;      <span class="comment">// on that type, and the truncate to that type is both legal and free,</span></div><div class="line"><a name="l03859"></a><span class="lineno"> 3859</span>&#160;      <span class="comment">// perform the transform.</span></div><div class="line"><a name="l03860"></a><span class="lineno"> 3860</span>&#160;      <span class="keywordflow">if</span> ((ShiftAmt &gt; 0) &amp;&amp;</div><div class="line"><a name="l03861"></a><span class="lineno"> 3861</span>&#160;          TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a087dd0f9650e999b087c17cc7f46f2d0">isOperationLegalOrCustom</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a5183f3d72924bc7c77ba8d3f5de9f602">ISD::SIGN_EXTEND</a>, TruncVT) &amp;&amp;</div><div class="line"><a name="l03862"></a><span class="lineno"> 3862</span>&#160;          TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a087dd0f9650e999b087c17cc7f46f2d0">isOperationLegalOrCustom</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ae690127648393001a7d5b93dc23da7b3">ISD::TRUNCATE</a>, VT) &amp;&amp;</div><div class="line"><a name="l03863"></a><span class="lineno"> 3863</span>&#160;          TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a00856c52a5a67b38d8332c7842429153">isTruncateFree</a>(VT, TruncVT)) {</div><div class="line"><a name="l03864"></a><span class="lineno"> 3864</span>&#160;</div><div class="line"><a name="l03865"></a><span class="lineno"> 3865</span>&#160;          <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Amt = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(ShiftAmt,</div><div class="line"><a name="l03866"></a><span class="lineno"> 3866</span>&#160;              getShiftAmountTy(N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>()));</div><div class="line"><a name="l03867"></a><span class="lineno"> 3867</span>&#160;          <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> <a class="code" href="Target_2README_8txt.html#a8db36c82f32d6f6a4d35a00e55be03a8">Shift</a> = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a3c6553c8acebe1b57c211ee45e2d8f98">ISD::SRL</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N0), VT,</div><div class="line"><a name="l03868"></a><span class="lineno"> 3868</span>&#160;                                      N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0), Amt);</div><div class="line"><a name="l03869"></a><span class="lineno"> 3869</span>&#160;          <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Trunc = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ae690127648393001a7d5b93dc23da7b3">ISD::TRUNCATE</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N0), TruncVT,</div><div class="line"><a name="l03870"></a><span class="lineno"> 3870</span>&#160;                                      Shift);</div><div class="line"><a name="l03871"></a><span class="lineno"> 3871</span>&#160;          <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a5183f3d72924bc7c77ba8d3f5de9f602">ISD::SIGN_EXTEND</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N),</div><div class="line"><a name="l03872"></a><span class="lineno"> 3872</span>&#160;                             N-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(0), Trunc);</div><div class="line"><a name="l03873"></a><span class="lineno"> 3873</span>&#160;      }</div><div class="line"><a name="l03874"></a><span class="lineno"> 3874</span>&#160;    }</div><div class="line"><a name="l03875"></a><span class="lineno"> 3875</span>&#160;  }</div><div class="line"><a name="l03876"></a><span class="lineno"> 3876</span>&#160;</div><div class="line"><a name="l03877"></a><span class="lineno"> 3877</span>&#160;  <span class="comment">// fold (sra x, (trunc (and y, c))) -&gt; (sra x, (and (trunc y), (trunc c))).</span></div><div class="line"><a name="l03878"></a><span class="lineno"> 3878</span>&#160;  <span class="keywordflow">if</span> (N1.getOpcode() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ae690127648393001a7d5b93dc23da7b3">ISD::TRUNCATE</a> &amp;&amp;</div><div class="line"><a name="l03879"></a><span class="lineno"> 3879</span>&#160;      N1.getOperand(0).getOpcode() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ac513a7da1bf74fb3e3c594da8534f2d2">ISD::AND</a> &amp;&amp;</div><div class="line"><a name="l03880"></a><span class="lineno"> 3880</span>&#160;      N1.hasOneUse() &amp;&amp; N1.getOperand(0).hasOneUse()) {</div><div class="line"><a name="l03881"></a><span class="lineno"> 3881</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N101 = N1.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1);</div><div class="line"><a name="l03882"></a><span class="lineno"> 3882</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a> *N101C = dyn_cast&lt;ConstantSDNode&gt;(N101)) {</div><div class="line"><a name="l03883"></a><span class="lineno"> 3883</span>&#160;      <a class="code" href="structllvm_1_1EVT.html">EVT</a> TruncVT = N1.getValueType();</div><div class="line"><a name="l03884"></a><span class="lineno"> 3884</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N100 = N1.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0);</div><div class="line"><a name="l03885"></a><span class="lineno"> 3885</span>&#160;      <a class="code" href="classllvm_1_1APInt.html">APInt</a> TruncC = N101C-&gt;getAPIntValue();</div><div class="line"><a name="l03886"></a><span class="lineno"> 3886</span>&#160;      TruncC = TruncC.<a class="code" href="classllvm_1_1APInt.html#a8cf5475fb3e9c737112cc248194c1040">trunc</a>(TruncVT.<a class="code" href="structllvm_1_1EVT.html#a15be9767d0aad93fe5dcb60b7b7a78da">getScalarType</a>().<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>());</div><div class="line"><a name="l03887"></a><span class="lineno"> 3887</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a4a055321c361a0f6ee77ed764730ffc1">ISD::SRA</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N0,</div><div class="line"><a name="l03888"></a><span class="lineno"> 3888</span>&#160;                         DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ac513a7da1bf74fb3e3c594da8534f2d2">ISD::AND</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N),</div><div class="line"><a name="l03889"></a><span class="lineno"> 3889</span>&#160;                                     TruncVT,</div><div class="line"><a name="l03890"></a><span class="lineno"> 3890</span>&#160;                                     DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ae690127648393001a7d5b93dc23da7b3">ISD::TRUNCATE</a>,</div><div class="line"><a name="l03891"></a><span class="lineno"> 3891</span>&#160;                                                 <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N),</div><div class="line"><a name="l03892"></a><span class="lineno"> 3892</span>&#160;                                                 TruncVT, N100),</div><div class="line"><a name="l03893"></a><span class="lineno"> 3893</span>&#160;                                     DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(TruncC, TruncVT)));</div><div class="line"><a name="l03894"></a><span class="lineno"> 3894</span>&#160;    }</div><div class="line"><a name="l03895"></a><span class="lineno"> 3895</span>&#160;  }</div><div class="line"><a name="l03896"></a><span class="lineno"> 3896</span>&#160;</div><div class="line"><a name="l03897"></a><span class="lineno"> 3897</span>&#160;  <span class="comment">// fold (sra (trunc (sr x, c1)), c2) -&gt; (trunc (sra x, c1+c2))</span></div><div class="line"><a name="l03898"></a><span class="lineno"> 3898</span>&#160;  <span class="comment">//      if c1 is equal to the number of bits the trunc removes</span></div><div class="line"><a name="l03899"></a><span class="lineno"> 3899</span>&#160;  <span class="keywordflow">if</span> (N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ae690127648393001a7d5b93dc23da7b3">ISD::TRUNCATE</a> &amp;&amp;</div><div class="line"><a name="l03900"></a><span class="lineno"> 3900</span>&#160;      (N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a3c6553c8acebe1b57c211ee45e2d8f98">ISD::SRL</a> ||</div><div class="line"><a name="l03901"></a><span class="lineno"> 3901</span>&#160;       N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a4a055321c361a0f6ee77ed764730ffc1">ISD::SRA</a>) &amp;&amp;</div><div class="line"><a name="l03902"></a><span class="lineno"> 3902</span>&#160;      N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a97b0f24f3e52f030830fca6fbfcbd37d">hasOneUse</a>() &amp;&amp;</div><div class="line"><a name="l03903"></a><span class="lineno"> 3903</span>&#160;      N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1).<a class="code" href="classllvm_1_1SDValue.html#a97b0f24f3e52f030830fca6fbfcbd37d">hasOneUse</a>() &amp;&amp;</div><div class="line"><a name="l03904"></a><span class="lineno"> 3904</span>&#160;      N1C &amp;&amp; isa&lt;ConstantSDNode&gt;(N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1))) {</div><div class="line"><a name="l03905"></a><span class="lineno"> 3905</span>&#160;    <a class="code" href="structllvm_1_1EVT.html">EVT</a> LargeVT = N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>();</div><div class="line"><a name="l03906"></a><span class="lineno"> 3906</span>&#160;    <a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a> *LargeShiftAmt =</div><div class="line"><a name="l03907"></a><span class="lineno"> 3907</span>&#160;      cast&lt;ConstantSDNode&gt;(N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1));</div><div class="line"><a name="l03908"></a><span class="lineno"> 3908</span>&#160;</div><div class="line"><a name="l03909"></a><span class="lineno"> 3909</span>&#160;    <span class="keywordflow">if</span> (LargeVT.<a class="code" href="structllvm_1_1EVT.html#a15be9767d0aad93fe5dcb60b7b7a78da">getScalarType</a>().<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>() - OpSizeInBits ==</div><div class="line"><a name="l03910"></a><span class="lineno"> 3910</span>&#160;        LargeShiftAmt-&gt;<a class="code" href="classllvm_1_1ConstantSDNode.html#a1e9365c991dd55e65e9d5ab5653812e4">getZExtValue</a>()) {</div><div class="line"><a name="l03911"></a><span class="lineno"> 3911</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Amt =</div><div class="line"><a name="l03912"></a><span class="lineno"> 3912</span>&#160;        DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(LargeShiftAmt-&gt;<a class="code" href="classllvm_1_1ConstantSDNode.html#a1e9365c991dd55e65e9d5ab5653812e4">getZExtValue</a>() + N1C-&gt;getZExtValue(),</div><div class="line"><a name="l03913"></a><span class="lineno"> 3913</span>&#160;              getShiftAmountTy(N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>()));</div><div class="line"><a name="l03914"></a><span class="lineno"> 3914</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a4a055321c361a0f6ee77ed764730ffc1">SRA</a> = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a4a055321c361a0f6ee77ed764730ffc1">ISD::SRA</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), LargeVT,</div><div class="line"><a name="l03915"></a><span class="lineno"> 3915</span>&#160;                                N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0), Amt);</div><div class="line"><a name="l03916"></a><span class="lineno"> 3916</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ae690127648393001a7d5b93dc23da7b3">ISD::TRUNCATE</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, SRA);</div><div class="line"><a name="l03917"></a><span class="lineno"> 3917</span>&#160;    }</div><div class="line"><a name="l03918"></a><span class="lineno"> 3918</span>&#160;  }</div><div class="line"><a name="l03919"></a><span class="lineno"> 3919</span>&#160;</div><div class="line"><a name="l03920"></a><span class="lineno"> 3920</span>&#160;  <span class="comment">// Simplify, based on bits shifted out of the LHS.</span></div><div class="line"><a name="l03921"></a><span class="lineno"> 3921</span>&#160;  <span class="keywordflow">if</span> (N1C &amp;&amp; SimplifyDemandedBits(<a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(N, 0)))</div><div class="line"><a name="l03922"></a><span class="lineno"> 3922</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(N, 0);</div><div class="line"><a name="l03923"></a><span class="lineno"> 3923</span>&#160;</div><div class="line"><a name="l03924"></a><span class="lineno"> 3924</span>&#160;</div><div class="line"><a name="l03925"></a><span class="lineno"> 3925</span>&#160;  <span class="comment">// If the sign bit is known to be zero, switch this to a SRL.</span></div><div class="line"><a name="l03926"></a><span class="lineno"> 3926</span>&#160;  <span class="keywordflow">if</span> (DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af52a1ca20308888443767831a21352ca">SignBitIsZero</a>(N0))</div><div class="line"><a name="l03927"></a><span class="lineno"> 3927</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a3c6553c8acebe1b57c211ee45e2d8f98">ISD::SRL</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N0, N1);</div><div class="line"><a name="l03928"></a><span class="lineno"> 3928</span>&#160;</div><div class="line"><a name="l03929"></a><span class="lineno"> 3929</span>&#160;  <span class="keywordflow">if</span> (N1C) {</div><div class="line"><a name="l03930"></a><span class="lineno"> 3930</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> NewSRA = visitShiftByConstant(N, N1C-&gt;getZExtValue());</div><div class="line"><a name="l03931"></a><span class="lineno"> 3931</span>&#160;    <span class="keywordflow">if</span> (NewSRA.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>())</div><div class="line"><a name="l03932"></a><span class="lineno"> 3932</span>&#160;      <span class="keywordflow">return</span> NewSRA;</div><div class="line"><a name="l03933"></a><span class="lineno"> 3933</span>&#160;  }</div><div class="line"><a name="l03934"></a><span class="lineno"> 3934</span>&#160;</div><div class="line"><a name="l03935"></a><span class="lineno"> 3935</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l03936"></a><span class="lineno"> 3936</span>&#160;}</div><div class="line"><a name="l03937"></a><span class="lineno"> 3937</span>&#160;</div><div class="line"><a name="l03938"></a><span class="lineno"> 3938</span>&#160;<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::visitSRL(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N) {</div><div class="line"><a name="l03939"></a><span class="lineno"> 3939</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N0 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0);</div><div class="line"><a name="l03940"></a><span class="lineno"> 3940</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N1 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(1);</div><div class="line"><a name="l03941"></a><span class="lineno"> 3941</span>&#160;  <a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a> *N0C = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a>&gt;(N0);</div><div class="line"><a name="l03942"></a><span class="lineno"> 3942</span>&#160;  <a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a> *N1C = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a>&gt;(N1);</div><div class="line"><a name="l03943"></a><span class="lineno"> 3943</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> VT = N0.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>();</div><div class="line"><a name="l03944"></a><span class="lineno"> 3944</span>&#160;  <span class="keywordtype">unsigned</span> OpSizeInBits = VT.<a class="code" href="structllvm_1_1EVT.html#a15be9767d0aad93fe5dcb60b7b7a78da">getScalarType</a>().<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>();</div><div class="line"><a name="l03945"></a><span class="lineno"> 3945</span>&#160;</div><div class="line"><a name="l03946"></a><span class="lineno"> 3946</span>&#160;  <span class="comment">// fold vector ops</span></div><div class="line"><a name="l03947"></a><span class="lineno"> 3947</span>&#160;  <span class="keywordflow">if</span> (VT.isVector()) {</div><div class="line"><a name="l03948"></a><span class="lineno"> 3948</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> FoldedVOp = SimplifyVBinOp(N);</div><div class="line"><a name="l03949"></a><span class="lineno"> 3949</span>&#160;    <span class="keywordflow">if</span> (FoldedVOp.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()) <span class="keywordflow">return</span> FoldedVOp;</div><div class="line"><a name="l03950"></a><span class="lineno"> 3950</span>&#160;  }</div><div class="line"><a name="l03951"></a><span class="lineno"> 3951</span>&#160;</div><div class="line"><a name="l03952"></a><span class="lineno"> 3952</span>&#160;  <span class="comment">// fold (srl c1, c2) -&gt; c1 &gt;&gt;u c2</span></div><div class="line"><a name="l03953"></a><span class="lineno"> 3953</span>&#160;  <span class="keywordflow">if</span> (N0C &amp;&amp; N1C)</div><div class="line"><a name="l03954"></a><span class="lineno"> 3954</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a8503b91b7bbfb128a42fa582857f8828">FoldConstantArithmetic</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a3c6553c8acebe1b57c211ee45e2d8f98">ISD::SRL</a>, VT, N0C, N1C);</div><div class="line"><a name="l03955"></a><span class="lineno"> 3955</span>&#160;  <span class="comment">// fold (srl 0, x) -&gt; 0</span></div><div class="line"><a name="l03956"></a><span class="lineno"> 3956</span>&#160;  <span class="keywordflow">if</span> (N0C &amp;&amp; N0C-&gt;<a class="code" href="classllvm_1_1ConstantSDNode.html#a702de70a3d9e57c3ffe65bc3fab3e087">isNullValue</a>())</div><div class="line"><a name="l03957"></a><span class="lineno"> 3957</span>&#160;    <span class="keywordflow">return</span> N0;</div><div class="line"><a name="l03958"></a><span class="lineno"> 3958</span>&#160;  <span class="comment">// fold (srl x, c &gt;= size(x)) -&gt; undef</span></div><div class="line"><a name="l03959"></a><span class="lineno"> 3959</span>&#160;  <span class="keywordflow">if</span> (N1C &amp;&amp; N1C-&gt;getZExtValue() &gt;= OpSizeInBits)</div><div class="line"><a name="l03960"></a><span class="lineno"> 3960</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a5b0e59823444a55c295af279611a9d24">getUNDEF</a>(VT);</div><div class="line"><a name="l03961"></a><span class="lineno"> 3961</span>&#160;  <span class="comment">// fold (srl x, 0) -&gt; x</span></div><div class="line"><a name="l03962"></a><span class="lineno"> 3962</span>&#160;  <span class="keywordflow">if</span> (N1C &amp;&amp; N1C-&gt;isNullValue())</div><div class="line"><a name="l03963"></a><span class="lineno"> 3963</span>&#160;    <span class="keywordflow">return</span> N0;</div><div class="line"><a name="l03964"></a><span class="lineno"> 3964</span>&#160;  <span class="comment">// if (srl x, c) is known to be zero, return 0</span></div><div class="line"><a name="l03965"></a><span class="lineno"> 3965</span>&#160;  <span class="keywordflow">if</span> (N1C &amp;&amp; DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af99f246db9e144fefd7a73b54ef0bbf7">MaskedValueIsZero</a>(<a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(N, 0),</div><div class="line"><a name="l03966"></a><span class="lineno"> 3966</span>&#160;                                   <a class="code" href="classllvm_1_1APInt.html#a539bdb4fdbf46e0bfcefebf5ac6d21dd">APInt::getAllOnesValue</a>(OpSizeInBits)))</div><div class="line"><a name="l03967"></a><span class="lineno"> 3967</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(0, VT);</div><div class="line"><a name="l03968"></a><span class="lineno"> 3968</span>&#160;</div><div class="line"><a name="l03969"></a><span class="lineno"> 3969</span>&#160;  <span class="comment">// fold (srl (srl x, c1), c2) -&gt; 0 or (srl x, (add c1, c2))</span></div><div class="line"><a name="l03970"></a><span class="lineno"> 3970</span>&#160;  <span class="keywordflow">if</span> (N1C &amp;&amp; N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a3c6553c8acebe1b57c211ee45e2d8f98">ISD::SRL</a> &amp;&amp;</div><div class="line"><a name="l03971"></a><span class="lineno"> 3971</span>&#160;      N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1).<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110aac2f0a84dd2aa5ee4c3f1385e9565f5e">ISD::Constant</a>) {</div><div class="line"><a name="l03972"></a><span class="lineno"> 3972</span>&#160;    uint64_t c1 = cast&lt;ConstantSDNode&gt;(N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1))-&gt;getZExtValue();</div><div class="line"><a name="l03973"></a><span class="lineno"> 3973</span>&#160;    uint64_t <a class="code" href="README-SSE_8txt.html#aadea95510755202aaa1c5ebfe4fcde48">c2</a> = N1C-&gt;getZExtValue();</div><div class="line"><a name="l03974"></a><span class="lineno"> 3974</span>&#160;    <span class="keywordflow">if</span> (c1 + c2 &gt;= OpSizeInBits)</div><div class="line"><a name="l03975"></a><span class="lineno"> 3975</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(0, VT);</div><div class="line"><a name="l03976"></a><span class="lineno"> 3976</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a3c6553c8acebe1b57c211ee45e2d8f98">ISD::SRL</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0),</div><div class="line"><a name="l03977"></a><span class="lineno"> 3977</span>&#160;                       DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(c1 + c2, N1.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>()));</div><div class="line"><a name="l03978"></a><span class="lineno"> 3978</span>&#160;  }</div><div class="line"><a name="l03979"></a><span class="lineno"> 3979</span>&#160;</div><div class="line"><a name="l03980"></a><span class="lineno"> 3980</span>&#160;  <span class="comment">// fold (srl (trunc (srl x, c1)), c2) -&gt; 0 or (trunc (srl x, (add c1, c2)))</span></div><div class="line"><a name="l03981"></a><span class="lineno"> 3981</span>&#160;  <span class="keywordflow">if</span> (N1C &amp;&amp; N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ae690127648393001a7d5b93dc23da7b3">ISD::TRUNCATE</a> &amp;&amp;</div><div class="line"><a name="l03982"></a><span class="lineno"> 3982</span>&#160;      N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a3c6553c8acebe1b57c211ee45e2d8f98">ISD::SRL</a> &amp;&amp;</div><div class="line"><a name="l03983"></a><span class="lineno"> 3983</span>&#160;      isa&lt;ConstantSDNode&gt;(N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0)-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(1))) {</div><div class="line"><a name="l03984"></a><span class="lineno"> 3984</span>&#160;    uint64_t c1 =</div><div class="line"><a name="l03985"></a><span class="lineno"> 3985</span>&#160;      cast&lt;ConstantSDNode&gt;(N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0)-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(1))-&gt;getZExtValue();</div><div class="line"><a name="l03986"></a><span class="lineno"> 3986</span>&#160;    uint64_t <a class="code" href="README-SSE_8txt.html#aadea95510755202aaa1c5ebfe4fcde48">c2</a> = N1C-&gt;getZExtValue();</div><div class="line"><a name="l03987"></a><span class="lineno"> 3987</span>&#160;    <a class="code" href="structllvm_1_1EVT.html">EVT</a> InnerShiftVT = N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>();</div><div class="line"><a name="l03988"></a><span class="lineno"> 3988</span>&#160;    <a class="code" href="structllvm_1_1EVT.html">EVT</a> ShiftCountVT = N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0)-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(1).<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>();</div><div class="line"><a name="l03989"></a><span class="lineno"> 3989</span>&#160;    uint64_t InnerShiftSize = InnerShiftVT.<a class="code" href="structllvm_1_1EVT.html#a15be9767d0aad93fe5dcb60b7b7a78da">getScalarType</a>().<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>();</div><div class="line"><a name="l03990"></a><span class="lineno"> 3990</span>&#160;    <span class="comment">// This is only valid if the OpSizeInBits + c1 = size of inner shift.</span></div><div class="line"><a name="l03991"></a><span class="lineno"> 3991</span>&#160;    <span class="keywordflow">if</span> (c1 + OpSizeInBits == InnerShiftSize) {</div><div class="line"><a name="l03992"></a><span class="lineno"> 3992</span>&#160;      <span class="keywordflow">if</span> (c1 + c2 &gt;= InnerShiftSize)</div><div class="line"><a name="l03993"></a><span class="lineno"> 3993</span>&#160;        <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(0, VT);</div><div class="line"><a name="l03994"></a><span class="lineno"> 3994</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ae690127648393001a7d5b93dc23da7b3">ISD::TRUNCATE</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N0), VT,</div><div class="line"><a name="l03995"></a><span class="lineno"> 3995</span>&#160;                         DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a3c6553c8acebe1b57c211ee45e2d8f98">ISD::SRL</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N0), InnerShiftVT,</div><div class="line"><a name="l03996"></a><span class="lineno"> 3996</span>&#160;                                     N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0)-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0),</div><div class="line"><a name="l03997"></a><span class="lineno"> 3997</span>&#160;                                     DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(c1 + c2, ShiftCountVT)));</div><div class="line"><a name="l03998"></a><span class="lineno"> 3998</span>&#160;    }</div><div class="line"><a name="l03999"></a><span class="lineno"> 3999</span>&#160;  }</div><div class="line"><a name="l04000"></a><span class="lineno"> 4000</span>&#160;</div><div class="line"><a name="l04001"></a><span class="lineno"> 4001</span>&#160;  <span class="comment">// fold (srl (shl x, c), c) -&gt; (and x, cst2)</span></div><div class="line"><a name="l04002"></a><span class="lineno"> 4002</span>&#160;  <span class="keywordflow">if</span> (N1C &amp;&amp; N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a8cc94e03dea594863073a02f5bb94997">ISD::SHL</a> &amp;&amp; N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1) == N1 &amp;&amp;</div><div class="line"><a name="l04003"></a><span class="lineno"> 4003</span>&#160;      N0.<a class="code" href="classllvm_1_1SDValue.html#a70aa652293da070dfe5b9fae309d0112">getValueSizeInBits</a>() &lt;= 64) {</div><div class="line"><a name="l04004"></a><span class="lineno"> 4004</span>&#160;    uint64_t ShAmt = N1C-&gt;getZExtValue()+64-N0.<a class="code" href="classllvm_1_1SDValue.html#a70aa652293da070dfe5b9fae309d0112">getValueSizeInBits</a>();</div><div class="line"><a name="l04005"></a><span class="lineno"> 4005</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ac513a7da1bf74fb3e3c594da8534f2d2">ISD::AND</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0),</div><div class="line"><a name="l04006"></a><span class="lineno"> 4006</span>&#160;                       DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(~0ULL &gt;&gt; ShAmt, VT));</div><div class="line"><a name="l04007"></a><span class="lineno"> 4007</span>&#160;  }</div><div class="line"><a name="l04008"></a><span class="lineno"> 4008</span>&#160;</div><div class="line"><a name="l04009"></a><span class="lineno"> 4009</span>&#160;  <span class="comment">// fold (srl (anyextend x), c) -&gt; (and (anyextend (srl x, c)), mask)</span></div><div class="line"><a name="l04010"></a><span class="lineno"> 4010</span>&#160;  <span class="keywordflow">if</span> (N1C &amp;&amp; N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a27d5d8ef82302b739ba3ca8be1a5513d">ISD::ANY_EXTEND</a>) {</div><div class="line"><a name="l04011"></a><span class="lineno"> 4011</span>&#160;    <span class="comment">// Shifting in all undef bits?</span></div><div class="line"><a name="l04012"></a><span class="lineno"> 4012</span>&#160;    <a class="code" href="structllvm_1_1EVT.html">EVT</a> SmallVT = N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>();</div><div class="line"><a name="l04013"></a><span class="lineno"> 4013</span>&#160;    <span class="keywordflow">if</span> (N1C-&gt;getZExtValue() &gt;= SmallVT.<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>())</div><div class="line"><a name="l04014"></a><span class="lineno"> 4014</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a5b0e59823444a55c295af279611a9d24">getUNDEF</a>(VT);</div><div class="line"><a name="l04015"></a><span class="lineno"> 4015</span>&#160;</div><div class="line"><a name="l04016"></a><span class="lineno"> 4016</span>&#160;    <span class="keywordflow">if</span> (!LegalTypes || TLI.<a class="code" href="classllvm_1_1TargetLowering.html#ab945eaf78cbe0a5e7cd0dbc3a6b92ae4">isTypeDesirableForOp</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a3c6553c8acebe1b57c211ee45e2d8f98">ISD::SRL</a>, SmallVT)) {</div><div class="line"><a name="l04017"></a><span class="lineno"> 4017</span>&#160;      uint64_t ShiftAmt = N1C-&gt;getZExtValue();</div><div class="line"><a name="l04018"></a><span class="lineno"> 4018</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> SmallShift = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a3c6553c8acebe1b57c211ee45e2d8f98">ISD::SRL</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N0), SmallVT,</div><div class="line"><a name="l04019"></a><span class="lineno"> 4019</span>&#160;                                       N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0),</div><div class="line"><a name="l04020"></a><span class="lineno"> 4020</span>&#160;                          DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(ShiftAmt, getShiftAmountTy(SmallVT)));</div><div class="line"><a name="l04021"></a><span class="lineno"> 4021</span>&#160;      AddToWorkList(SmallShift.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l04022"></a><span class="lineno"> 4022</span>&#160;      <a class="code" href="classllvm_1_1APInt.html">APInt</a> Mask = <a class="code" href="classllvm_1_1APInt.html#a539bdb4fdbf46e0bfcefebf5ac6d21dd">APInt::getAllOnesValue</a>(VT.getSizeInBits()).<a class="code" href="namespacellvm_1_1APIntOps.html#a75a71c5acb58449ea8a731e9caebf1fe">lshr</a>(ShiftAmt);</div><div class="line"><a name="l04023"></a><span class="lineno"> 4023</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ac513a7da1bf74fb3e3c594da8534f2d2">ISD::AND</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT,</div><div class="line"><a name="l04024"></a><span class="lineno"> 4024</span>&#160;                         DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a27d5d8ef82302b739ba3ca8be1a5513d">ISD::ANY_EXTEND</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, SmallShift),</div><div class="line"><a name="l04025"></a><span class="lineno"> 4025</span>&#160;                         DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(Mask, VT));</div><div class="line"><a name="l04026"></a><span class="lineno"> 4026</span>&#160;    }</div><div class="line"><a name="l04027"></a><span class="lineno"> 4027</span>&#160;  }</div><div class="line"><a name="l04028"></a><span class="lineno"> 4028</span>&#160;</div><div class="line"><a name="l04029"></a><span class="lineno"> 4029</span>&#160;  <span class="comment">// fold (srl (sra X, Y), 31) -&gt; (srl X, 31).  This srl only looks at the sign</span></div><div class="line"><a name="l04030"></a><span class="lineno"> 4030</span>&#160;  <span class="comment">// bit, which is unmodified by sra.</span></div><div class="line"><a name="l04031"></a><span class="lineno"> 4031</span>&#160;  <span class="keywordflow">if</span> (N1C &amp;&amp; N1C-&gt;getZExtValue() + 1 == VT.getSizeInBits()) {</div><div class="line"><a name="l04032"></a><span class="lineno"> 4032</span>&#160;    <span class="keywordflow">if</span> (N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a4a055321c361a0f6ee77ed764730ffc1">ISD::SRA</a>)</div><div class="line"><a name="l04033"></a><span class="lineno"> 4033</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a3c6553c8acebe1b57c211ee45e2d8f98">ISD::SRL</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0), N1);</div><div class="line"><a name="l04034"></a><span class="lineno"> 4034</span>&#160;  }</div><div class="line"><a name="l04035"></a><span class="lineno"> 4035</span>&#160;</div><div class="line"><a name="l04036"></a><span class="lineno"> 4036</span>&#160;  <span class="comment">// fold (srl (ctlz x), &quot;5&quot;) -&gt; x  iff x has one bit set (the low bit).</span></div><div class="line"><a name="l04037"></a><span class="lineno"> 4037</span>&#160;  <span class="keywordflow">if</span> (N1C &amp;&amp; N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110add33c0ae9a63902e573fc1f92fc33f1c">ISD::CTLZ</a> &amp;&amp;</div><div class="line"><a name="l04038"></a><span class="lineno"> 4038</span>&#160;      N1C-&gt;getAPIntValue() == <a class="code" href="namespacellvm.html#a646986783f35e0fef8988f0f28d2589f">Log2_32</a>(VT.getSizeInBits())) {</div><div class="line"><a name="l04039"></a><span class="lineno"> 4039</span>&#160;    <a class="code" href="classllvm_1_1APInt.html">APInt</a> KnownZero, KnownOne;</div><div class="line"><a name="l04040"></a><span class="lineno"> 4040</span>&#160;    DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#ad06ca140783fd9f03eed498e8485fc3d">ComputeMaskedBits</a>(N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0), KnownZero, KnownOne);</div><div class="line"><a name="l04041"></a><span class="lineno"> 4041</span>&#160;</div><div class="line"><a name="l04042"></a><span class="lineno"> 4042</span>&#160;    <span class="comment">// If any of the input bits are KnownOne, then the input couldn&#39;t be all</span></div><div class="line"><a name="l04043"></a><span class="lineno"> 4043</span>&#160;    <span class="comment">// zeros, thus the result of the srl will always be zero.</span></div><div class="line"><a name="l04044"></a><span class="lineno"> 4044</span>&#160;    <span class="keywordflow">if</span> (KnownOne.<a class="code" href="classllvm_1_1APInt.html#ac8be1ee0c47d9e47e567fa353f987ed5">getBoolValue</a>()) <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(0, VT);</div><div class="line"><a name="l04045"></a><span class="lineno"> 4045</span>&#160;</div><div class="line"><a name="l04046"></a><span class="lineno"> 4046</span>&#160;    <span class="comment">// If all of the bits input the to ctlz node are known to be zero, then</span></div><div class="line"><a name="l04047"></a><span class="lineno"> 4047</span>&#160;    <span class="comment">// the result of the ctlz is &quot;32&quot; and the result of the shift is one.</span></div><div class="line"><a name="l04048"></a><span class="lineno"> 4048</span>&#160;    <a class="code" href="classllvm_1_1APInt.html">APInt</a> UnknownBits = ~KnownZero;</div><div class="line"><a name="l04049"></a><span class="lineno"> 4049</span>&#160;    <span class="keywordflow">if</span> (UnknownBits == 0) <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(1, VT);</div><div class="line"><a name="l04050"></a><span class="lineno"> 4050</span>&#160;</div><div class="line"><a name="l04051"></a><span class="lineno"> 4051</span>&#160;    <span class="comment">// Otherwise, check to see if there is exactly one bit input to the ctlz.</span></div><div class="line"><a name="l04052"></a><span class="lineno"> 4052</span>&#160;    <span class="keywordflow">if</span> ((UnknownBits &amp; (UnknownBits - 1)) == 0) {</div><div class="line"><a name="l04053"></a><span class="lineno"> 4053</span>&#160;      <span class="comment">// Okay, we know that only that the single bit specified by UnknownBits</span></div><div class="line"><a name="l04054"></a><span class="lineno"> 4054</span>&#160;      <span class="comment">// could be set on input to the CTLZ node. If this bit is set, the SRL</span></div><div class="line"><a name="l04055"></a><span class="lineno"> 4055</span>&#160;      <span class="comment">// will return 0, if it is clear, it returns 1. Change the CTLZ/SRL pair</span></div><div class="line"><a name="l04056"></a><span class="lineno"> 4056</span>&#160;      <span class="comment">// to an SRL/XOR pair, which is likely to simplify more.</span></div><div class="line"><a name="l04057"></a><span class="lineno"> 4057</span>&#160;      <span class="keywordtype">unsigned</span> ShAmt = UnknownBits.<a class="code" href="classllvm_1_1APInt.html#aac277496191547e487eea07f09dffd4b">countTrailingZeros</a>();</div><div class="line"><a name="l04058"></a><span class="lineno"> 4058</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Op = N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0);</div><div class="line"><a name="l04059"></a><span class="lineno"> 4059</span>&#160;</div><div class="line"><a name="l04060"></a><span class="lineno"> 4060</span>&#160;      <span class="keywordflow">if</span> (ShAmt) {</div><div class="line"><a name="l04061"></a><span class="lineno"> 4061</span>&#160;        Op = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a3c6553c8acebe1b57c211ee45e2d8f98">ISD::SRL</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N0), VT, Op,</div><div class="line"><a name="l04062"></a><span class="lineno"> 4062</span>&#160;                  DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(ShAmt, getShiftAmountTy(Op.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>())));</div><div class="line"><a name="l04063"></a><span class="lineno"> 4063</span>&#160;        AddToWorkList(Op.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l04064"></a><span class="lineno"> 4064</span>&#160;      }</div><div class="line"><a name="l04065"></a><span class="lineno"> 4065</span>&#160;</div><div class="line"><a name="l04066"></a><span class="lineno"> 4066</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a92febb83e6ba116eb7aae8e7e3f70cc1">ISD::XOR</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT,</div><div class="line"><a name="l04067"></a><span class="lineno"> 4067</span>&#160;                         Op, DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(1, VT));</div><div class="line"><a name="l04068"></a><span class="lineno"> 4068</span>&#160;    }</div><div class="line"><a name="l04069"></a><span class="lineno"> 4069</span>&#160;  }</div><div class="line"><a name="l04070"></a><span class="lineno"> 4070</span>&#160;</div><div class="line"><a name="l04071"></a><span class="lineno"> 4071</span>&#160;  <span class="comment">// fold (srl x, (trunc (and y, c))) -&gt; (srl x, (and (trunc y), (trunc c))).</span></div><div class="line"><a name="l04072"></a><span class="lineno"> 4072</span>&#160;  <span class="keywordflow">if</span> (N1.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ae690127648393001a7d5b93dc23da7b3">ISD::TRUNCATE</a> &amp;&amp;</div><div class="line"><a name="l04073"></a><span class="lineno"> 4073</span>&#160;      N1.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ac513a7da1bf74fb3e3c594da8534f2d2">ISD::AND</a> &amp;&amp;</div><div class="line"><a name="l04074"></a><span class="lineno"> 4074</span>&#160;      N1.<a class="code" href="classllvm_1_1SDValue.html#a97b0f24f3e52f030830fca6fbfcbd37d">hasOneUse</a>() &amp;&amp; N1.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a97b0f24f3e52f030830fca6fbfcbd37d">hasOneUse</a>()) {</div><div class="line"><a name="l04075"></a><span class="lineno"> 4075</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N101 = N1.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1);</div><div class="line"><a name="l04076"></a><span class="lineno"> 4076</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a> *N101C = dyn_cast&lt;ConstantSDNode&gt;(N101)) {</div><div class="line"><a name="l04077"></a><span class="lineno"> 4077</span>&#160;      <a class="code" href="structllvm_1_1EVT.html">EVT</a> TruncVT = N1.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>();</div><div class="line"><a name="l04078"></a><span class="lineno"> 4078</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N100 = N1.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0);</div><div class="line"><a name="l04079"></a><span class="lineno"> 4079</span>&#160;      <a class="code" href="classllvm_1_1APInt.html">APInt</a> TruncC = N101C-&gt;getAPIntValue();</div><div class="line"><a name="l04080"></a><span class="lineno"> 4080</span>&#160;      TruncC = TruncC.<a class="code" href="classllvm_1_1APInt.html#a8cf5475fb3e9c737112cc248194c1040">trunc</a>(TruncVT.<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>());</div><div class="line"><a name="l04081"></a><span class="lineno"> 4081</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a3c6553c8acebe1b57c211ee45e2d8f98">ISD::SRL</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N0,</div><div class="line"><a name="l04082"></a><span class="lineno"> 4082</span>&#160;                         DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ac513a7da1bf74fb3e3c594da8534f2d2">ISD::AND</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N),</div><div class="line"><a name="l04083"></a><span class="lineno"> 4083</span>&#160;                                     TruncVT,</div><div class="line"><a name="l04084"></a><span class="lineno"> 4084</span>&#160;                                     DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ae690127648393001a7d5b93dc23da7b3">ISD::TRUNCATE</a>,</div><div class="line"><a name="l04085"></a><span class="lineno"> 4085</span>&#160;                                                 <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N),</div><div class="line"><a name="l04086"></a><span class="lineno"> 4086</span>&#160;                                                 TruncVT, N100),</div><div class="line"><a name="l04087"></a><span class="lineno"> 4087</span>&#160;                                     DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(TruncC, TruncVT)));</div><div class="line"><a name="l04088"></a><span class="lineno"> 4088</span>&#160;    }</div><div class="line"><a name="l04089"></a><span class="lineno"> 4089</span>&#160;  }</div><div class="line"><a name="l04090"></a><span class="lineno"> 4090</span>&#160;</div><div class="line"><a name="l04091"></a><span class="lineno"> 4091</span>&#160;  <span class="comment">// fold operands of srl based on knowledge that the low bits are not</span></div><div class="line"><a name="l04092"></a><span class="lineno"> 4092</span>&#160;  <span class="comment">// demanded.</span></div><div class="line"><a name="l04093"></a><span class="lineno"> 4093</span>&#160;  <span class="keywordflow">if</span> (N1C &amp;&amp; SimplifyDemandedBits(<a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(N, 0)))</div><div class="line"><a name="l04094"></a><span class="lineno"> 4094</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(N, 0);</div><div class="line"><a name="l04095"></a><span class="lineno"> 4095</span>&#160;</div><div class="line"><a name="l04096"></a><span class="lineno"> 4096</span>&#160;  <span class="keywordflow">if</span> (N1C) {</div><div class="line"><a name="l04097"></a><span class="lineno"> 4097</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> NewSRL = visitShiftByConstant(N, N1C-&gt;getZExtValue());</div><div class="line"><a name="l04098"></a><span class="lineno"> 4098</span>&#160;    <span class="keywordflow">if</span> (NewSRL.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>())</div><div class="line"><a name="l04099"></a><span class="lineno"> 4099</span>&#160;      <span class="keywordflow">return</span> NewSRL;</div><div class="line"><a name="l04100"></a><span class="lineno"> 4100</span>&#160;  }</div><div class="line"><a name="l04101"></a><span class="lineno"> 4101</span>&#160;</div><div class="line"><a name="l04102"></a><span class="lineno"> 4102</span>&#160;  <span class="comment">// Attempt to convert a srl of a load into a narrower zero-extending load.</span></div><div class="line"><a name="l04103"></a><span class="lineno"> 4103</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> NarrowLoad = ReduceLoadWidth(N);</div><div class="line"><a name="l04104"></a><span class="lineno"> 4104</span>&#160;  <span class="keywordflow">if</span> (NarrowLoad.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>())</div><div class="line"><a name="l04105"></a><span class="lineno"> 4105</span>&#160;    <span class="keywordflow">return</span> NarrowLoad;</div><div class="line"><a name="l04106"></a><span class="lineno"> 4106</span>&#160;</div><div class="line"><a name="l04107"></a><span class="lineno"> 4107</span>&#160;  <span class="comment">// Here is a common situation. We want to optimize:</span></div><div class="line"><a name="l04108"></a><span class="lineno"> 4108</span>&#160;  <span class="comment">//</span></div><div class="line"><a name="l04109"></a><span class="lineno"> 4109</span>&#160;  <span class="comment">//   %a = ...</span></div><div class="line"><a name="l04110"></a><span class="lineno"> 4110</span>&#160;  <span class="comment">//   %b = and i32 %a, 2</span></div><div class="line"><a name="l04111"></a><span class="lineno"> 4111</span>&#160;  <span class="comment">//   %c = srl i32 %b, 1</span></div><div class="line"><a name="l04112"></a><span class="lineno"> 4112</span>&#160;  <span class="comment">//   brcond i32 %c ...</span></div><div class="line"><a name="l04113"></a><span class="lineno"> 4113</span>&#160;  <span class="comment">//</span></div><div class="line"><a name="l04114"></a><span class="lineno"> 4114</span>&#160;  <span class="comment">// into</span></div><div class="line"><a name="l04115"></a><span class="lineno"> 4115</span>&#160;  <span class="comment">//</span></div><div class="line"><a name="l04116"></a><span class="lineno"> 4116</span>&#160;  <span class="comment">//   %a = ...</span></div><div class="line"><a name="l04117"></a><span class="lineno"> 4117</span>&#160;  <span class="comment">//   %b = and %a, 2</span></div><div class="line"><a name="l04118"></a><span class="lineno"> 4118</span>&#160;  <span class="comment">//   %c = setcc eq %b, 0</span></div><div class="line"><a name="l04119"></a><span class="lineno"> 4119</span>&#160;  <span class="comment">//   brcond %c ...</span></div><div class="line"><a name="l04120"></a><span class="lineno"> 4120</span>&#160;  <span class="comment">//</span></div><div class="line"><a name="l04121"></a><span class="lineno"> 4121</span>&#160;  <span class="comment">// However when after the source operand of SRL is optimized into AND, the SRL</span></div><div class="line"><a name="l04122"></a><span class="lineno"> 4122</span>&#160;  <span class="comment">// itself may not be optimized further. Look for it and add the BRCOND into</span></div><div class="line"><a name="l04123"></a><span class="lineno"> 4123</span>&#160;  <span class="comment">// the worklist.</span></div><div class="line"><a name="l04124"></a><span class="lineno"> 4124</span>&#160;  <span class="keywordflow">if</span> (N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a52753947fce3a01b1c18dd4713c587e8">hasOneUse</a>()) {</div><div class="line"><a name="l04125"></a><span class="lineno"> 4125</span>&#160;    <a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *<a class="code" href="classllvm_1_1Use.html">Use</a> = *N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a8810bf428dcf84d48f39c8f5ba9a8c94">use_begin</a>();</div><div class="line"><a name="l04126"></a><span class="lineno"> 4126</span>&#160;    <span class="keywordflow">if</span> (Use-&gt;<a class="code" href="classllvm_1_1SDNode.html#af0d328f3f61168f4ea7d6e4044af4f97">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ae8167e4f6fa1bfb30f074ba620b81782">ISD::BRCOND</a>)</div><div class="line"><a name="l04127"></a><span class="lineno"> 4127</span>&#160;      AddToWorkList(Use);</div><div class="line"><a name="l04128"></a><span class="lineno"> 4128</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Use-&gt;<a class="code" href="classllvm_1_1SDNode.html#af0d328f3f61168f4ea7d6e4044af4f97">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ae690127648393001a7d5b93dc23da7b3">ISD::TRUNCATE</a> &amp;&amp; Use-&gt;<a class="code" href="classllvm_1_1SDNode.html#a52753947fce3a01b1c18dd4713c587e8">hasOneUse</a>()) {</div><div class="line"><a name="l04129"></a><span class="lineno"> 4129</span>&#160;      <span class="comment">// Also look pass the truncate.</span></div><div class="line"><a name="l04130"></a><span class="lineno"> 4130</span>&#160;      Use = *Use-&gt;<a class="code" href="classllvm_1_1SDNode.html#a8810bf428dcf84d48f39c8f5ba9a8c94">use_begin</a>();</div><div class="line"><a name="l04131"></a><span class="lineno"> 4131</span>&#160;      <span class="keywordflow">if</span> (Use-&gt;<a class="code" href="classllvm_1_1SDNode.html#af0d328f3f61168f4ea7d6e4044af4f97">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ae8167e4f6fa1bfb30f074ba620b81782">ISD::BRCOND</a>)</div><div class="line"><a name="l04132"></a><span class="lineno"> 4132</span>&#160;        AddToWorkList(Use);</div><div class="line"><a name="l04133"></a><span class="lineno"> 4133</span>&#160;    }</div><div class="line"><a name="l04134"></a><span class="lineno"> 4134</span>&#160;  }</div><div class="line"><a name="l04135"></a><span class="lineno"> 4135</span>&#160;</div><div class="line"><a name="l04136"></a><span class="lineno"> 4136</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l04137"></a><span class="lineno"> 4137</span>&#160;}</div><div class="line"><a name="l04138"></a><span class="lineno"> 4138</span>&#160;</div><div class="line"><a name="l04139"></a><span class="lineno"> 4139</span>&#160;<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::visitCTLZ(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N) {</div><div class="line"><a name="l04140"></a><span class="lineno"> 4140</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N0 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0);</div><div class="line"><a name="l04141"></a><span class="lineno"> 4141</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> VT = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(0);</div><div class="line"><a name="l04142"></a><span class="lineno"> 4142</span>&#160;</div><div class="line"><a name="l04143"></a><span class="lineno"> 4143</span>&#160;  <span class="comment">// fold (ctlz c1) -&gt; c2</span></div><div class="line"><a name="l04144"></a><span class="lineno"> 4144</span>&#160;  <span class="keywordflow">if</span> (isa&lt;ConstantSDNode&gt;(N0))</div><div class="line"><a name="l04145"></a><span class="lineno"> 4145</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110add33c0ae9a63902e573fc1f92fc33f1c">ISD::CTLZ</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N0);</div><div class="line"><a name="l04146"></a><span class="lineno"> 4146</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l04147"></a><span class="lineno"> 4147</span>&#160;}</div><div class="line"><a name="l04148"></a><span class="lineno"> 4148</span>&#160;</div><div class="line"><a name="l04149"></a><span class="lineno"> 4149</span>&#160;<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::visitCTLZ_ZERO_UNDEF(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N) {</div><div class="line"><a name="l04150"></a><span class="lineno"> 4150</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N0 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0);</div><div class="line"><a name="l04151"></a><span class="lineno"> 4151</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> VT = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(0);</div><div class="line"><a name="l04152"></a><span class="lineno"> 4152</span>&#160;</div><div class="line"><a name="l04153"></a><span class="lineno"> 4153</span>&#160;  <span class="comment">// fold (ctlz_zero_undef c1) -&gt; c2</span></div><div class="line"><a name="l04154"></a><span class="lineno"> 4154</span>&#160;  <span class="keywordflow">if</span> (isa&lt;ConstantSDNode&gt;(N0))</div><div class="line"><a name="l04155"></a><span class="lineno"> 4155</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a0340c8d57d1dcebc43a00412989583d3">ISD::CTLZ_ZERO_UNDEF</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N0);</div><div class="line"><a name="l04156"></a><span class="lineno"> 4156</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l04157"></a><span class="lineno"> 4157</span>&#160;}</div><div class="line"><a name="l04158"></a><span class="lineno"> 4158</span>&#160;</div><div class="line"><a name="l04159"></a><span class="lineno"> 4159</span>&#160;<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::visitCTTZ(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N) {</div><div class="line"><a name="l04160"></a><span class="lineno"> 4160</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N0 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0);</div><div class="line"><a name="l04161"></a><span class="lineno"> 4161</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> VT = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(0);</div><div class="line"><a name="l04162"></a><span class="lineno"> 4162</span>&#160;</div><div class="line"><a name="l04163"></a><span class="lineno"> 4163</span>&#160;  <span class="comment">// fold (cttz c1) -&gt; c2</span></div><div class="line"><a name="l04164"></a><span class="lineno"> 4164</span>&#160;  <span class="keywordflow">if</span> (isa&lt;ConstantSDNode&gt;(N0))</div><div class="line"><a name="l04165"></a><span class="lineno"> 4165</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a6da41a113af0909470baea7486b3386b">ISD::CTTZ</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N0);</div><div class="line"><a name="l04166"></a><span class="lineno"> 4166</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l04167"></a><span class="lineno"> 4167</span>&#160;}</div><div class="line"><a name="l04168"></a><span class="lineno"> 4168</span>&#160;</div><div class="line"><a name="l04169"></a><span class="lineno"> 4169</span>&#160;<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::visitCTTZ_ZERO_UNDEF(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N) {</div><div class="line"><a name="l04170"></a><span class="lineno"> 4170</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N0 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0);</div><div class="line"><a name="l04171"></a><span class="lineno"> 4171</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> VT = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(0);</div><div class="line"><a name="l04172"></a><span class="lineno"> 4172</span>&#160;</div><div class="line"><a name="l04173"></a><span class="lineno"> 4173</span>&#160;  <span class="comment">// fold (cttz_zero_undef c1) -&gt; c2</span></div><div class="line"><a name="l04174"></a><span class="lineno"> 4174</span>&#160;  <span class="keywordflow">if</span> (isa&lt;ConstantSDNode&gt;(N0))</div><div class="line"><a name="l04175"></a><span class="lineno"> 4175</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a601e66a26efd05520f7cb26aef3af340">ISD::CTTZ_ZERO_UNDEF</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N0);</div><div class="line"><a name="l04176"></a><span class="lineno"> 4176</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l04177"></a><span class="lineno"> 4177</span>&#160;}</div><div class="line"><a name="l04178"></a><span class="lineno"> 4178</span>&#160;</div><div class="line"><a name="l04179"></a><span class="lineno"> 4179</span>&#160;<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::visitCTPOP(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N) {</div><div class="line"><a name="l04180"></a><span class="lineno"> 4180</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N0 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0);</div><div class="line"><a name="l04181"></a><span class="lineno"> 4181</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> VT = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(0);</div><div class="line"><a name="l04182"></a><span class="lineno"> 4182</span>&#160;</div><div class="line"><a name="l04183"></a><span class="lineno"> 4183</span>&#160;  <span class="comment">// fold (ctpop c1) -&gt; c2</span></div><div class="line"><a name="l04184"></a><span class="lineno"> 4184</span>&#160;  <span class="keywordflow">if</span> (isa&lt;ConstantSDNode&gt;(N0))</div><div class="line"><a name="l04185"></a><span class="lineno"> 4185</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a991d07d163bd4d9984cf1ef36e92c214">ISD::CTPOP</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N0);</div><div class="line"><a name="l04186"></a><span class="lineno"> 4186</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l04187"></a><span class="lineno"> 4187</span>&#160;}</div><div class="line"><a name="l04188"></a><span class="lineno"> 4188</span>&#160;</div><div class="line"><a name="l04189"></a><span class="lineno"> 4189</span>&#160;<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::visitSELECT(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N) {</div><div class="line"><a name="l04190"></a><span class="lineno"> 4190</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N0 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0);</div><div class="line"><a name="l04191"></a><span class="lineno"> 4191</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N1 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(1);</div><div class="line"><a name="l04192"></a><span class="lineno"> 4192</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N2 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(2);</div><div class="line"><a name="l04193"></a><span class="lineno"> 4193</span>&#160;  <a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a> *N0C = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a>&gt;(N0);</div><div class="line"><a name="l04194"></a><span class="lineno"> 4194</span>&#160;  <a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a> *N1C = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a>&gt;(N1);</div><div class="line"><a name="l04195"></a><span class="lineno"> 4195</span>&#160;  <a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a> *N2C = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a>&gt;(N2);</div><div class="line"><a name="l04196"></a><span class="lineno"> 4196</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> VT = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(0);</div><div class="line"><a name="l04197"></a><span class="lineno"> 4197</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> VT0 = N0.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>();</div><div class="line"><a name="l04198"></a><span class="lineno"> 4198</span>&#160;</div><div class="line"><a name="l04199"></a><span class="lineno"> 4199</span>&#160;  <span class="comment">// fold (select C, X, X) -&gt; X</span></div><div class="line"><a name="l04200"></a><span class="lineno"> 4200</span>&#160;  <span class="keywordflow">if</span> (N1 == N2)</div><div class="line"><a name="l04201"></a><span class="lineno"> 4201</span>&#160;    <span class="keywordflow">return</span> N1;</div><div class="line"><a name="l04202"></a><span class="lineno"> 4202</span>&#160;  <span class="comment">// fold (select true, X, Y) -&gt; X</span></div><div class="line"><a name="l04203"></a><span class="lineno"> 4203</span>&#160;  <span class="keywordflow">if</span> (N0C &amp;&amp; !N0C-&gt;<a class="code" href="classllvm_1_1ConstantSDNode.html#a702de70a3d9e57c3ffe65bc3fab3e087">isNullValue</a>())</div><div class="line"><a name="l04204"></a><span class="lineno"> 4204</span>&#160;    <span class="keywordflow">return</span> N1;</div><div class="line"><a name="l04205"></a><span class="lineno"> 4205</span>&#160;  <span class="comment">// fold (select false, X, Y) -&gt; Y</span></div><div class="line"><a name="l04206"></a><span class="lineno"> 4206</span>&#160;  <span class="keywordflow">if</span> (N0C &amp;&amp; N0C-&gt;<a class="code" href="classllvm_1_1ConstantSDNode.html#a702de70a3d9e57c3ffe65bc3fab3e087">isNullValue</a>())</div><div class="line"><a name="l04207"></a><span class="lineno"> 4207</span>&#160;    <span class="keywordflow">return</span> N2;</div><div class="line"><a name="l04208"></a><span class="lineno"> 4208</span>&#160;  <span class="comment">// fold (select C, 1, X) -&gt; (or C, X)</span></div><div class="line"><a name="l04209"></a><span class="lineno"> 4209</span>&#160;  <span class="keywordflow">if</span> (VT == <a class="code" href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50ca85440bbdbba12de574c02e515444d3f4">MVT::i1</a> &amp;&amp; N1C &amp;&amp; N1C-&gt;getAPIntValue() == 1)</div><div class="line"><a name="l04210"></a><span class="lineno"> 4210</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7415ab9f2172c59a2ee7c7a02afa56a4">ISD::OR</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N0, N2);</div><div class="line"><a name="l04211"></a><span class="lineno"> 4211</span>&#160;  <span class="comment">// fold (select C, 0, 1) -&gt; (xor C, 1)</span></div><div class="line"><a name="l04212"></a><span class="lineno"> 4212</span>&#160;  <span class="keywordflow">if</span> (VT.isInteger() &amp;&amp;</div><div class="line"><a name="l04213"></a><span class="lineno"> 4213</span>&#160;      (VT0 == <a class="code" href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50ca85440bbdbba12de574c02e515444d3f4">MVT::i1</a> ||</div><div class="line"><a name="l04214"></a><span class="lineno"> 4214</span>&#160;       (VT0.<a class="code" href="structllvm_1_1EVT.html#a8cc407ac00df4edd4ec4d5168d6ecb26">isInteger</a>() &amp;&amp;</div><div class="line"><a name="l04215"></a><span class="lineno"> 4215</span>&#160;        TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a09bdc91589b715806d421ccbc540347d">getBooleanContents</a>(<span class="keyword">false</span>) ==</div><div class="line"><a name="l04216"></a><span class="lineno"> 4216</span>&#160;        <a class="code" href="classllvm_1_1TargetLoweringBase.html#aa61af767c51a95e2dd0dff2001168755a0e2d72cfdcc49d2d189f440b3cc31dff">TargetLowering::ZeroOrOneBooleanContent</a>)) &amp;&amp;</div><div class="line"><a name="l04217"></a><span class="lineno"> 4217</span>&#160;      N1C &amp;&amp; N2C &amp;&amp; N1C-&gt;isNullValue() &amp;&amp; N2C-&gt;getAPIntValue() == 1) {</div><div class="line"><a name="l04218"></a><span class="lineno"> 4218</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> XORNode;</div><div class="line"><a name="l04219"></a><span class="lineno"> 4219</span>&#160;    <span class="keywordflow">if</span> (VT == VT0)</div><div class="line"><a name="l04220"></a><span class="lineno"> 4220</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a92febb83e6ba116eb7aae8e7e3f70cc1">ISD::XOR</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT0,</div><div class="line"><a name="l04221"></a><span class="lineno"> 4221</span>&#160;                         N0, DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(1, VT0));</div><div class="line"><a name="l04222"></a><span class="lineno"> 4222</span>&#160;    XORNode = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a92febb83e6ba116eb7aae8e7e3f70cc1">ISD::XOR</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N0), VT0,</div><div class="line"><a name="l04223"></a><span class="lineno"> 4223</span>&#160;                          N0, DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(1, VT0));</div><div class="line"><a name="l04224"></a><span class="lineno"> 4224</span>&#160;    AddToWorkList(XORNode.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l04225"></a><span class="lineno"> 4225</span>&#160;    <span class="keywordflow">if</span> (VT.bitsGT(VT0))</div><div class="line"><a name="l04226"></a><span class="lineno"> 4226</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a93fdf85eff945f1a668b4915a051453e">ISD::ZERO_EXTEND</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, XORNode);</div><div class="line"><a name="l04227"></a><span class="lineno"> 4227</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ae690127648393001a7d5b93dc23da7b3">ISD::TRUNCATE</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, XORNode);</div><div class="line"><a name="l04228"></a><span class="lineno"> 4228</span>&#160;  }</div><div class="line"><a name="l04229"></a><span class="lineno"> 4229</span>&#160;  <span class="comment">// fold (select C, 0, X) -&gt; (and (not C), X)</span></div><div class="line"><a name="l04230"></a><span class="lineno"> 4230</span>&#160;  <span class="keywordflow">if</span> (VT == VT0 &amp;&amp; VT == <a class="code" href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50ca85440bbdbba12de574c02e515444d3f4">MVT::i1</a> &amp;&amp; N1C &amp;&amp; N1C-&gt;isNullValue()) {</div><div class="line"><a name="l04231"></a><span class="lineno"> 4231</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> NOTNode = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a17becda56598e1d6b0d8fda77cd2fbe7">getNOT</a>(<a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N0), N0, VT);</div><div class="line"><a name="l04232"></a><span class="lineno"> 4232</span>&#160;    AddToWorkList(NOTNode.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l04233"></a><span class="lineno"> 4233</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ac513a7da1bf74fb3e3c594da8534f2d2">ISD::AND</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, NOTNode, N2);</div><div class="line"><a name="l04234"></a><span class="lineno"> 4234</span>&#160;  }</div><div class="line"><a name="l04235"></a><span class="lineno"> 4235</span>&#160;  <span class="comment">// fold (select C, X, 1) -&gt; (or (not C), X)</span></div><div class="line"><a name="l04236"></a><span class="lineno"> 4236</span>&#160;  <span class="keywordflow">if</span> (VT == VT0 &amp;&amp; VT == <a class="code" href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50ca85440bbdbba12de574c02e515444d3f4">MVT::i1</a> &amp;&amp; N2C &amp;&amp; N2C-&gt;getAPIntValue() == 1) {</div><div class="line"><a name="l04237"></a><span class="lineno"> 4237</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> NOTNode = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a17becda56598e1d6b0d8fda77cd2fbe7">getNOT</a>(<a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N0), N0, VT);</div><div class="line"><a name="l04238"></a><span class="lineno"> 4238</span>&#160;    AddToWorkList(NOTNode.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l04239"></a><span class="lineno"> 4239</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7415ab9f2172c59a2ee7c7a02afa56a4">ISD::OR</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, NOTNode, N1);</div><div class="line"><a name="l04240"></a><span class="lineno"> 4240</span>&#160;  }</div><div class="line"><a name="l04241"></a><span class="lineno"> 4241</span>&#160;  <span class="comment">// fold (select C, X, 0) -&gt; (and C, X)</span></div><div class="line"><a name="l04242"></a><span class="lineno"> 4242</span>&#160;  <span class="keywordflow">if</span> (VT == <a class="code" href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50ca85440bbdbba12de574c02e515444d3f4">MVT::i1</a> &amp;&amp; N2C &amp;&amp; N2C-&gt;isNullValue())</div><div class="line"><a name="l04243"></a><span class="lineno"> 4243</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ac513a7da1bf74fb3e3c594da8534f2d2">ISD::AND</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N0, N1);</div><div class="line"><a name="l04244"></a><span class="lineno"> 4244</span>&#160;  <span class="comment">// fold (select X, X, Y) -&gt; (or X, Y)</span></div><div class="line"><a name="l04245"></a><span class="lineno"> 4245</span>&#160;  <span class="comment">// fold (select X, 1, Y) -&gt; (or X, Y)</span></div><div class="line"><a name="l04246"></a><span class="lineno"> 4246</span>&#160;  <span class="keywordflow">if</span> (VT == <a class="code" href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50ca85440bbdbba12de574c02e515444d3f4">MVT::i1</a> &amp;&amp; (N0 == N1 || (N1C &amp;&amp; N1C-&gt;getAPIntValue() == 1)))</div><div class="line"><a name="l04247"></a><span class="lineno"> 4247</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7415ab9f2172c59a2ee7c7a02afa56a4">ISD::OR</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N0, N2);</div><div class="line"><a name="l04248"></a><span class="lineno"> 4248</span>&#160;  <span class="comment">// fold (select X, Y, X) -&gt; (and X, Y)</span></div><div class="line"><a name="l04249"></a><span class="lineno"> 4249</span>&#160;  <span class="comment">// fold (select X, Y, 0) -&gt; (and X, Y)</span></div><div class="line"><a name="l04250"></a><span class="lineno"> 4250</span>&#160;  <span class="keywordflow">if</span> (VT == <a class="code" href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50ca85440bbdbba12de574c02e515444d3f4">MVT::i1</a> &amp;&amp; (N0 == N2 || (N2C &amp;&amp; N2C-&gt;getAPIntValue() == 0)))</div><div class="line"><a name="l04251"></a><span class="lineno"> 4251</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ac513a7da1bf74fb3e3c594da8534f2d2">ISD::AND</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N0, N1);</div><div class="line"><a name="l04252"></a><span class="lineno"> 4252</span>&#160;</div><div class="line"><a name="l04253"></a><span class="lineno"> 4253</span>&#160;  <span class="comment">// If we can fold this based on the true/false value, do so.</span></div><div class="line"><a name="l04254"></a><span class="lineno"> 4254</span>&#160;  <span class="keywordflow">if</span> (SimplifySelectOps(N, N1, N2))</div><div class="line"><a name="l04255"></a><span class="lineno"> 4255</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(N, 0);  <span class="comment">// Don&#39;t revisit N.</span></div><div class="line"><a name="l04256"></a><span class="lineno"> 4256</span>&#160;</div><div class="line"><a name="l04257"></a><span class="lineno"> 4257</span>&#160;  <span class="comment">// fold selects based on a setcc into other things, such as min/max/abs</span></div><div class="line"><a name="l04258"></a><span class="lineno"> 4258</span>&#160;  <span class="keywordflow">if</span> (N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a0158ee47dfa868be5d28e2cbef70d5d0">ISD::SETCC</a>) {</div><div class="line"><a name="l04259"></a><span class="lineno"> 4259</span>&#160;    <span class="comment">// FIXME:</span></div><div class="line"><a name="l04260"></a><span class="lineno"> 4260</span>&#160;    <span class="comment">// Check against MVT::Other for SELECT_CC, which is a workaround for targets</span></div><div class="line"><a name="l04261"></a><span class="lineno"> 4261</span>&#160;    <span class="comment">// having to say they don&#39;t support SELECT_CC on every type the DAG knows</span></div><div class="line"><a name="l04262"></a><span class="lineno"> 4262</span>&#160;    <span class="comment">// about, since there is no way to mark an opcode illegal at all value types</span></div><div class="line"><a name="l04263"></a><span class="lineno"> 4263</span>&#160;    <span class="keywordflow">if</span> (TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a087dd0f9650e999b087c17cc7f46f2d0">isOperationLegalOrCustom</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a99ad6b342b7457df56b91d24e66016b3">ISD::SELECT_CC</a>, <a class="code" href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50ca62a222acce6360abd2726719fabc2797">MVT::Other</a>) &amp;&amp;</div><div class="line"><a name="l04264"></a><span class="lineno"> 4264</span>&#160;        TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a087dd0f9650e999b087c17cc7f46f2d0">isOperationLegalOrCustom</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a99ad6b342b7457df56b91d24e66016b3">ISD::SELECT_CC</a>, VT))</div><div class="line"><a name="l04265"></a><span class="lineno"> 4265</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a99ad6b342b7457df56b91d24e66016b3">ISD::SELECT_CC</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT,</div><div class="line"><a name="l04266"></a><span class="lineno"> 4266</span>&#160;                         N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0), N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1),</div><div class="line"><a name="l04267"></a><span class="lineno"> 4267</span>&#160;                         N1, N2, N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(2));</div><div class="line"><a name="l04268"></a><span class="lineno"> 4268</span>&#160;    <span class="keywordflow">return</span> SimplifySelect(<a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), N0, N1, N2);</div><div class="line"><a name="l04269"></a><span class="lineno"> 4269</span>&#160;  }</div><div class="line"><a name="l04270"></a><span class="lineno"> 4270</span>&#160;</div><div class="line"><a name="l04271"></a><span class="lineno"> 4271</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l04272"></a><span class="lineno"> 4272</span>&#160;}</div><div class="line"><a name="l04273"></a><span class="lineno"> 4273</span>&#160;</div><div class="line"><a name="l04274"></a><span class="lineno"> 4274</span>&#160;<span class="keyword">static</span></div><div class="line"><a name="l04275"></a><span class="lineno"><a class="line" href="DAGCombiner_8cpp.html#a7de4946ef46274f66c2c0d0e41abf552"> 4275</a></span>&#160;std::pair&lt;SDValue, SDValue&gt; <a class="code" href="DAGCombiner_8cpp.html#a7de4946ef46274f66c2c0d0e41abf552">SplitVSETCC</a>(<span class="keyword">const</span> <a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N, <a class="code" href="classllvm_1_1SelectionDAG.html">SelectionDAG</a> &amp;DAG) {</div><div class="line"><a name="l04276"></a><span class="lineno"> 4276</span>&#160;  <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a> DL(N);</div><div class="line"><a name="l04277"></a><span class="lineno"> 4277</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> LoVT, HiVT;</div><div class="line"><a name="l04278"></a><span class="lineno"> 4278</span>&#160;  <a class="code" href="namespacellvm.html#a7dc3e2c002713fec56bdbf16aa704576">llvm::tie</a>(LoVT, HiVT) = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a69a858247fbce6bd8035a1dbeb770f24">GetSplitDestVTs</a>(N-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(0));</div><div class="line"><a name="l04279"></a><span class="lineno"> 4279</span>&#160;</div><div class="line"><a name="l04280"></a><span class="lineno"> 4280</span>&#160;  <span class="comment">// Split the inputs.</span></div><div class="line"><a name="l04281"></a><span class="lineno"> 4281</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> <a class="code" href="namespacellvm_1_1HexagonISD.html#aa640667f875feccdb3cc643baff441f1a144f7e8227378979bf13646688174ed9">Lo</a>, <a class="code" href="namespacellvm_1_1HexagonISD.html#aa640667f875feccdb3cc643baff441f1ab53c716337bbeea9ba39b5fa32d60303">Hi</a>, LL, LH, RL, RH;</div><div class="line"><a name="l04282"></a><span class="lineno"> 4282</span>&#160;  <a class="code" href="namespacellvm.html#a7dc3e2c002713fec56bdbf16aa704576">llvm::tie</a>(LL, LH) = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a56a2102423fcb39c2683a7e67bddf537">SplitVectorOperand</a>(N, 0);</div><div class="line"><a name="l04283"></a><span class="lineno"> 4283</span>&#160;  <a class="code" href="namespacellvm.html#a7dc3e2c002713fec56bdbf16aa704576">llvm::tie</a>(RL, RH) = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a56a2102423fcb39c2683a7e67bddf537">SplitVectorOperand</a>(N, 1);</div><div class="line"><a name="l04284"></a><span class="lineno"> 4284</span>&#160;</div><div class="line"><a name="l04285"></a><span class="lineno"> 4285</span>&#160;  Lo = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(N-&gt;<a class="code" href="classllvm_1_1SDNode.html#af0d328f3f61168f4ea7d6e4044af4f97">getOpcode</a>(), DL, LoVT, LL, RL, N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(2));</div><div class="line"><a name="l04286"></a><span class="lineno"> 4286</span>&#160;  Hi = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(N-&gt;<a class="code" href="classllvm_1_1SDNode.html#af0d328f3f61168f4ea7d6e4044af4f97">getOpcode</a>(), DL, HiVT, LH, RH, N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(2));</div><div class="line"><a name="l04287"></a><span class="lineno"> 4287</span>&#160;</div><div class="line"><a name="l04288"></a><span class="lineno"> 4288</span>&#160;  <span class="keywordflow">return</span> std::make_pair(Lo, Hi);</div><div class="line"><a name="l04289"></a><span class="lineno"> 4289</span>&#160;}</div><div class="line"><a name="l04290"></a><span class="lineno"> 4290</span>&#160;</div><div class="line"><a name="l04291"></a><span class="lineno"> 4291</span>&#160;<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::visitVSELECT(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N) {</div><div class="line"><a name="l04292"></a><span class="lineno"> 4292</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N0 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0);</div><div class="line"><a name="l04293"></a><span class="lineno"> 4293</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N1 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(1);</div><div class="line"><a name="l04294"></a><span class="lineno"> 4294</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N2 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(2);</div><div class="line"><a name="l04295"></a><span class="lineno"> 4295</span>&#160;  <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a> DL(N);</div><div class="line"><a name="l04296"></a><span class="lineno"> 4296</span>&#160;</div><div class="line"><a name="l04297"></a><span class="lineno"> 4297</span>&#160;  <span class="comment">// Canonicalize integer abs.</span></div><div class="line"><a name="l04298"></a><span class="lineno"> 4298</span>&#160;  <span class="comment">// vselect (setg[te] X,  0),  X, -X -&gt;</span></div><div class="line"><a name="l04299"></a><span class="lineno"> 4299</span>&#160;  <span class="comment">// vselect (setgt    X, -1),  X, -X -&gt;</span></div><div class="line"><a name="l04300"></a><span class="lineno"> 4300</span>&#160;  <span class="comment">// vselect (setl[te] X,  0), -X,  X -&gt;</span></div><div class="line"><a name="l04301"></a><span class="lineno"> 4301</span>&#160;  <span class="comment">// Y = sra (X, size(X)-1); xor (add (X, Y), Y)</span></div><div class="line"><a name="l04302"></a><span class="lineno"> 4302</span>&#160;  <span class="keywordflow">if</span> (N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a0158ee47dfa868be5d28e2cbef70d5d0">ISD::SETCC</a>) {</div><div class="line"><a name="l04303"></a><span class="lineno"> 4303</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> LHS = N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0), RHS = N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1);</div><div class="line"><a name="l04304"></a><span class="lineno"> 4304</span>&#160;    <a class="code" href="namespacellvm_1_1ISD.html#ac3c3cf58d6d631af6a172457304d3d07">ISD::CondCode</a> <a class="code" href="Target_2PowerPC_2README_8txt.html#afc7ca55ad1da67847ecd4b99ef64dc84">CC</a> = cast&lt;CondCodeSDNode&gt;(N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(2))-&gt;<span class="keyword">get</span>();</div><div class="line"><a name="l04305"></a><span class="lineno"> 4305</span>&#160;    <span class="keywordtype">bool</span> isAbs = <span class="keyword">false</span>;</div><div class="line"><a name="l04306"></a><span class="lineno"> 4306</span>&#160;    <span class="keywordtype">bool</span> RHSIsAllZeros = <a class="code" href="namespacellvm_1_1ISD.html#aaac3e239cbdfe15a8e9bad4f8e1e3a95">ISD::isBuildVectorAllZeros</a>(RHS.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l04307"></a><span class="lineno"> 4307</span>&#160;</div><div class="line"><a name="l04308"></a><span class="lineno"> 4308</span>&#160;    <span class="keywordflow">if</span> (((RHSIsAllZeros &amp;&amp; (CC == <a class="code" href="namespacellvm_1_1ISD.html#ac3c3cf58d6d631af6a172457304d3d07a5ad12b466e3a5900d0c307b301465d25">ISD::SETGT</a> || CC == <a class="code" href="namespacellvm_1_1ISD.html#ac3c3cf58d6d631af6a172457304d3d07a7f47862de23f7210f88ccf98ae1efbe4">ISD::SETGE</a>)) ||</div><div class="line"><a name="l04309"></a><span class="lineno"> 4309</span>&#160;         (<a class="code" href="namespacellvm_1_1ISD.html#ac78d4df51ca05e4fb1630a01e07de434">ISD::isBuildVectorAllOnes</a>(RHS.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()) &amp;&amp; CC == <a class="code" href="namespacellvm_1_1ISD.html#ac3c3cf58d6d631af6a172457304d3d07a5ad12b466e3a5900d0c307b301465d25">ISD::SETGT</a>)) &amp;&amp;</div><div class="line"><a name="l04310"></a><span class="lineno"> 4310</span>&#160;        N1 == LHS &amp;&amp; N2.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9fa617e5567c3c2638938f7b9ddc3f1c">ISD::SUB</a> &amp;&amp; N1 == N2.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1))</div><div class="line"><a name="l04311"></a><span class="lineno"> 4311</span>&#160;      isAbs = <a class="code" href="namespacellvm_1_1ISD.html#aaac3e239cbdfe15a8e9bad4f8e1e3a95">ISD::isBuildVectorAllZeros</a>(N2.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l04312"></a><span class="lineno"> 4312</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((RHSIsAllZeros &amp;&amp; (CC == <a class="code" href="namespacellvm_1_1ISD.html#ac3c3cf58d6d631af6a172457304d3d07a6f05a09edb671910f85f8665981cbde9">ISD::SETLT</a> || CC == <a class="code" href="namespacellvm_1_1ISD.html#ac3c3cf58d6d631af6a172457304d3d07ab49f81c2ecbbff3d0fbe55dd46353774">ISD::SETLE</a>)) &amp;&amp;</div><div class="line"><a name="l04313"></a><span class="lineno"> 4313</span>&#160;             N2 == LHS &amp;&amp; N1.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9fa617e5567c3c2638938f7b9ddc3f1c">ISD::SUB</a> &amp;&amp; N2 == N1.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1))</div><div class="line"><a name="l04314"></a><span class="lineno"> 4314</span>&#160;      isAbs = <a class="code" href="namespacellvm_1_1ISD.html#aaac3e239cbdfe15a8e9bad4f8e1e3a95">ISD::isBuildVectorAllZeros</a>(N1.getOperand(0).getNode());</div><div class="line"><a name="l04315"></a><span class="lineno"> 4315</span>&#160;</div><div class="line"><a name="l04316"></a><span class="lineno"> 4316</span>&#160;    <span class="keywordflow">if</span> (isAbs) {</div><div class="line"><a name="l04317"></a><span class="lineno"> 4317</span>&#160;      <a class="code" href="structllvm_1_1EVT.html">EVT</a> VT = LHS.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>();</div><div class="line"><a name="l04318"></a><span class="lineno"> 4318</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> <a class="code" href="Target_2README_8txt.html#a8db36c82f32d6f6a4d35a00e55be03a8">Shift</a> = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(</div><div class="line"><a name="l04319"></a><span class="lineno"> 4319</span>&#160;          <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a4a055321c361a0f6ee77ed764730ffc1">ISD::SRA</a>, DL, VT, LHS,</div><div class="line"><a name="l04320"></a><span class="lineno"> 4320</span>&#160;          DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(VT.<a class="code" href="structllvm_1_1EVT.html#a15be9767d0aad93fe5dcb60b7b7a78da">getScalarType</a>().<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>() - 1, VT));</div><div class="line"><a name="l04321"></a><span class="lineno"> 4321</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Add = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a269996b43a1f3e1d1f84a70fd4387535">ISD::ADD</a>, DL, VT, LHS, Shift);</div><div class="line"><a name="l04322"></a><span class="lineno"> 4322</span>&#160;      AddToWorkList(Shift.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l04323"></a><span class="lineno"> 4323</span>&#160;      AddToWorkList(Add.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l04324"></a><span class="lineno"> 4324</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a92febb83e6ba116eb7aae8e7e3f70cc1">ISD::XOR</a>, DL, VT, Add, Shift);</div><div class="line"><a name="l04325"></a><span class="lineno"> 4325</span>&#160;    }</div><div class="line"><a name="l04326"></a><span class="lineno"> 4326</span>&#160;  }</div><div class="line"><a name="l04327"></a><span class="lineno"> 4327</span>&#160;</div><div class="line"><a name="l04328"></a><span class="lineno"> 4328</span>&#160;  <span class="comment">// If the VSELECT result requires splitting and the mask is provided by a</span></div><div class="line"><a name="l04329"></a><span class="lineno"> 4329</span>&#160;  <span class="comment">// SETCC, then split both nodes and its operands before legalization. This</span></div><div class="line"><a name="l04330"></a><span class="lineno"> 4330</span>&#160;  <span class="comment">// prevents the type legalizer from unrolling SETCC into scalar comparisons</span></div><div class="line"><a name="l04331"></a><span class="lineno"> 4331</span>&#160;  <span class="comment">// and enables future optimizations (e.g. min/max pattern matching on X86).</span></div><div class="line"><a name="l04332"></a><span class="lineno"> 4332</span>&#160;  <span class="keywordflow">if</span> (N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a0158ee47dfa868be5d28e2cbef70d5d0">ISD::SETCC</a>) {</div><div class="line"><a name="l04333"></a><span class="lineno"> 4333</span>&#160;    <a class="code" href="structllvm_1_1EVT.html">EVT</a> VT = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(0);</div><div class="line"><a name="l04334"></a><span class="lineno"> 4334</span>&#160;</div><div class="line"><a name="l04335"></a><span class="lineno"> 4335</span>&#160;    <span class="comment">// Check if any splitting is required.</span></div><div class="line"><a name="l04336"></a><span class="lineno"> 4336</span>&#160;    <span class="keywordflow">if</span> (TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a7b93b105a426bc0eda1eadd856aa195e">getTypeAction</a>(*DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a39c6dff47b8dbd25cfaf6336c7056077">getContext</a>(), VT) !=</div><div class="line"><a name="l04337"></a><span class="lineno"> 4337</span>&#160;        <a class="code" href="classllvm_1_1TargetLoweringBase.html#a88a8b01d4dbc2ebd81244d1eb459b193a40cd81ebfaf97cef327ad65d37b816da">TargetLowering::TypeSplitVector</a>)</div><div class="line"><a name="l04338"></a><span class="lineno"> 4338</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l04339"></a><span class="lineno"> 4339</span>&#160;</div><div class="line"><a name="l04340"></a><span class="lineno"> 4340</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> <a class="code" href="namespacellvm_1_1HexagonISD.html#aa640667f875feccdb3cc643baff441f1a144f7e8227378979bf13646688174ed9">Lo</a>, <a class="code" href="namespacellvm_1_1HexagonISD.html#aa640667f875feccdb3cc643baff441f1ab53c716337bbeea9ba39b5fa32d60303">Hi</a>, CCLo, CCHi, LL, LH, RL, RH;</div><div class="line"><a name="l04341"></a><span class="lineno"> 4341</span>&#160;    <a class="code" href="namespacellvm.html#a7dc3e2c002713fec56bdbf16aa704576">llvm::tie</a>(CCLo, CCHi) = <a class="code" href="DAGCombiner_8cpp.html#a7de4946ef46274f66c2c0d0e41abf552">SplitVSETCC</a>(N0.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>(), DAG);</div><div class="line"><a name="l04342"></a><span class="lineno"> 4342</span>&#160;    <a class="code" href="namespacellvm.html#a7dc3e2c002713fec56bdbf16aa704576">llvm::tie</a>(LL, LH) = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a56a2102423fcb39c2683a7e67bddf537">SplitVectorOperand</a>(N, 1);</div><div class="line"><a name="l04343"></a><span class="lineno"> 4343</span>&#160;    <a class="code" href="namespacellvm.html#a7dc3e2c002713fec56bdbf16aa704576">llvm::tie</a>(RL, RH) = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a56a2102423fcb39c2683a7e67bddf537">SplitVectorOperand</a>(N, 2);</div><div class="line"><a name="l04344"></a><span class="lineno"> 4344</span>&#160;</div><div class="line"><a name="l04345"></a><span class="lineno"> 4345</span>&#160;    Lo = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(N-&gt;<a class="code" href="classllvm_1_1SDNode.html#af0d328f3f61168f4ea7d6e4044af4f97">getOpcode</a>(), DL, LL.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>(), CCLo, LL, RL);</div><div class="line"><a name="l04346"></a><span class="lineno"> 4346</span>&#160;    Hi = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(N-&gt;<a class="code" href="classllvm_1_1SDNode.html#af0d328f3f61168f4ea7d6e4044af4f97">getOpcode</a>(), DL, LH.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>(), CCHi, LH, RH);</div><div class="line"><a name="l04347"></a><span class="lineno"> 4347</span>&#160;</div><div class="line"><a name="l04348"></a><span class="lineno"> 4348</span>&#160;    <span class="comment">// Add the new VSELECT nodes to the work list in case they need to be split</span></div><div class="line"><a name="l04349"></a><span class="lineno"> 4349</span>&#160;    <span class="comment">// again.</span></div><div class="line"><a name="l04350"></a><span class="lineno"> 4350</span>&#160;    AddToWorkList(Lo.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l04351"></a><span class="lineno"> 4351</span>&#160;    AddToWorkList(Hi.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l04352"></a><span class="lineno"> 4352</span>&#160;</div><div class="line"><a name="l04353"></a><span class="lineno"> 4353</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a320898056eadc3254fc601e1362eb9f5">ISD::CONCAT_VECTORS</a>, DL, VT, Lo, Hi);</div><div class="line"><a name="l04354"></a><span class="lineno"> 4354</span>&#160;  }</div><div class="line"><a name="l04355"></a><span class="lineno"> 4355</span>&#160;</div><div class="line"><a name="l04356"></a><span class="lineno"> 4356</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l04357"></a><span class="lineno"> 4357</span>&#160;}</div><div class="line"><a name="l04358"></a><span class="lineno"> 4358</span>&#160;</div><div class="line"><a name="l04359"></a><span class="lineno"> 4359</span>&#160;<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::visitSELECT_CC(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N) {</div><div class="line"><a name="l04360"></a><span class="lineno"> 4360</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N0 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0);</div><div class="line"><a name="l04361"></a><span class="lineno"> 4361</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N1 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(1);</div><div class="line"><a name="l04362"></a><span class="lineno"> 4362</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N2 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(2);</div><div class="line"><a name="l04363"></a><span class="lineno"> 4363</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N3 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(3);</div><div class="line"><a name="l04364"></a><span class="lineno"> 4364</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N4 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(4);</div><div class="line"><a name="l04365"></a><span class="lineno"> 4365</span>&#160;  <a class="code" href="namespacellvm_1_1ISD.html#ac3c3cf58d6d631af6a172457304d3d07">ISD::CondCode</a> <a class="code" href="Target_2PowerPC_2README_8txt.html#afc7ca55ad1da67847ecd4b99ef64dc84">CC</a> = cast&lt;CondCodeSDNode&gt;(N4)-&gt;<span class="keyword">get</span>();</div><div class="line"><a name="l04366"></a><span class="lineno"> 4366</span>&#160;</div><div class="line"><a name="l04367"></a><span class="lineno"> 4367</span>&#160;  <span class="comment">// fold select_cc lhs, rhs, x, x, cc -&gt; x</span></div><div class="line"><a name="l04368"></a><span class="lineno"> 4368</span>&#160;  <span class="keywordflow">if</span> (N2 == N3)</div><div class="line"><a name="l04369"></a><span class="lineno"> 4369</span>&#160;    <span class="keywordflow">return</span> N2;</div><div class="line"><a name="l04370"></a><span class="lineno"> 4370</span>&#160;</div><div class="line"><a name="l04371"></a><span class="lineno"> 4371</span>&#160;  <span class="comment">// Determine if the condition we&#39;re dealing with is constant</span></div><div class="line"><a name="l04372"></a><span class="lineno"> 4372</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> SCC = SimplifySetCC(getSetCCResultType(N0.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>()),</div><div class="line"><a name="l04373"></a><span class="lineno"> 4373</span>&#160;                              N0, N1, CC, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), <span class="keyword">false</span>);</div><div class="line"><a name="l04374"></a><span class="lineno"> 4374</span>&#160;  <span class="keywordflow">if</span> (SCC.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()) {</div><div class="line"><a name="l04375"></a><span class="lineno"> 4375</span>&#160;    AddToWorkList(SCC.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l04376"></a><span class="lineno"> 4376</span>&#160;</div><div class="line"><a name="l04377"></a><span class="lineno"> 4377</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a> *SCCC = dyn_cast&lt;ConstantSDNode&gt;(SCC.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>())) {</div><div class="line"><a name="l04378"></a><span class="lineno"> 4378</span>&#160;      <span class="keywordflow">if</span> (!SCCC-&gt;isNullValue())</div><div class="line"><a name="l04379"></a><span class="lineno"> 4379</span>&#160;        <span class="keywordflow">return</span> N2;    <span class="comment">// cond always true -&gt; true val</span></div><div class="line"><a name="l04380"></a><span class="lineno"> 4380</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l04381"></a><span class="lineno"> 4381</span>&#160;        <span class="keywordflow">return</span> N3;    <span class="comment">// cond always false -&gt; false val</span></div><div class="line"><a name="l04382"></a><span class="lineno"> 4382</span>&#160;    }</div><div class="line"><a name="l04383"></a><span class="lineno"> 4383</span>&#160;</div><div class="line"><a name="l04384"></a><span class="lineno"> 4384</span>&#160;    <span class="comment">// Fold to a simpler select_cc</span></div><div class="line"><a name="l04385"></a><span class="lineno"> 4385</span>&#160;    <span class="keywordflow">if</span> (SCC.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a0158ee47dfa868be5d28e2cbef70d5d0">ISD::SETCC</a>)</div><div class="line"><a name="l04386"></a><span class="lineno"> 4386</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a99ad6b342b7457df56b91d24e66016b3">ISD::SELECT_CC</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), N2.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>(),</div><div class="line"><a name="l04387"></a><span class="lineno"> 4387</span>&#160;                         SCC.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0), SCC.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1), N2, N3,</div><div class="line"><a name="l04388"></a><span class="lineno"> 4388</span>&#160;                         SCC.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(2));</div><div class="line"><a name="l04389"></a><span class="lineno"> 4389</span>&#160;  }</div><div class="line"><a name="l04390"></a><span class="lineno"> 4390</span>&#160;</div><div class="line"><a name="l04391"></a><span class="lineno"> 4391</span>&#160;  <span class="comment">// If we can fold this based on the true/false value, do so.</span></div><div class="line"><a name="l04392"></a><span class="lineno"> 4392</span>&#160;  <span class="keywordflow">if</span> (SimplifySelectOps(N, N2, N3))</div><div class="line"><a name="l04393"></a><span class="lineno"> 4393</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(N, 0);  <span class="comment">// Don&#39;t revisit N.</span></div><div class="line"><a name="l04394"></a><span class="lineno"> 4394</span>&#160;</div><div class="line"><a name="l04395"></a><span class="lineno"> 4395</span>&#160;  <span class="comment">// fold select_cc into other things, such as min/max/abs</span></div><div class="line"><a name="l04396"></a><span class="lineno"> 4396</span>&#160;  <span class="keywordflow">return</span> SimplifySelectCC(<a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), N0, N1, N2, N3, CC);</div><div class="line"><a name="l04397"></a><span class="lineno"> 4397</span>&#160;}</div><div class="line"><a name="l04398"></a><span class="lineno"> 4398</span>&#160;</div><div class="line"><a name="l04399"></a><span class="lineno"> 4399</span>&#160;<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::visitSETCC(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N) {</div><div class="line"><a name="l04400"></a><span class="lineno"> 4400</span>&#160;  <span class="keywordflow">return</span> SimplifySetCC(N-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(0), N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0), N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(1),</div><div class="line"><a name="l04401"></a><span class="lineno"> 4401</span>&#160;                       cast&lt;CondCodeSDNode&gt;(N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(2))-&gt;<span class="keyword">get</span>(),</div><div class="line"><a name="l04402"></a><span class="lineno"> 4402</span>&#160;                       <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N));</div><div class="line"><a name="l04403"></a><span class="lineno"> 4403</span>&#160;}</div><div class="line"><a name="l04404"></a><span class="lineno"> 4404</span>&#160;</div><div class="line"><a name="l04405"></a><span class="lineno"> 4405</span>&#160;<span class="comment">// ExtendUsesToFormExtLoad - Trying to extend uses of a load to enable this:</span></div><div class="line"><a name="l04406"></a><span class="lineno"> 4406</span>&#160;<span class="comment">// &quot;fold ({s|z|a}ext (load x)) -&gt; ({s|z|a}ext (truncate ({s|z|a}extload x)))&quot;</span></div><div class="line"><a name="l04407"></a><span class="lineno"> 4407</span>&#160;<span class="comment">// transformation. Returns true if extension are possible and the above</span></div><div class="line"><a name="l04408"></a><span class="lineno"> 4408</span>&#160;<span class="comment">// mentioned transformation is profitable.</span></div><div class="line"><a name="l04409"></a><span class="lineno"><a class="line" href="DAGCombiner_8cpp.html#a64f519aaefc431e6e9f2e15e921fb540"> 4409</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="DAGCombiner_8cpp.html#a64f519aaefc431e6e9f2e15e921fb540">ExtendUsesToFormExtLoad</a>(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N, <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N0,</div><div class="line"><a name="l04410"></a><span class="lineno"> 4410</span>&#160;                                    <span class="keywordtype">unsigned</span> ExtOpc,</div><div class="line"><a name="l04411"></a><span class="lineno"> 4411</span>&#160;                                    <a class="code" href="classllvm_1_1SmallVectorImpl.html">SmallVectorImpl&lt;SDNode *&gt;</a> &amp;ExtendNodes,</div><div class="line"><a name="l04412"></a><span class="lineno"> 4412</span>&#160;                                    <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetLowering.html">TargetLowering</a> &amp;TLI) {</div><div class="line"><a name="l04413"></a><span class="lineno"> 4413</span>&#160;  <span class="keywordtype">bool</span> HasCopyToRegUses = <span class="keyword">false</span>;</div><div class="line"><a name="l04414"></a><span class="lineno"> 4414</span>&#160;  <span class="keywordtype">bool</span> isTruncFree = TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a00856c52a5a67b38d8332c7842429153">isTruncateFree</a>(N-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(0), N0.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>());</div><div class="line"><a name="l04415"></a><span class="lineno"> 4415</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1SDNode_1_1use__iterator.html">SDNode::use_iterator</a> UI = N0.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()-&gt;<a class="code" href="classllvm_1_1SDNode.html#a8810bf428dcf84d48f39c8f5ba9a8c94">use_begin</a>(),</div><div class="line"><a name="l04416"></a><span class="lineno"> 4416</span>&#160;                            UE = N0.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()-&gt;<a class="code" href="classllvm_1_1SDNode.html#aef02f2c1bd12936a80611b134b24a47d">use_end</a>();</div><div class="line"><a name="l04417"></a><span class="lineno"> 4417</span>&#160;       UI != UE; ++UI) {</div><div class="line"><a name="l04418"></a><span class="lineno"> 4418</span>&#160;    <a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *<a class="code" href="classllvm_1_1User.html">User</a> = *UI;</div><div class="line"><a name="l04419"></a><span class="lineno"> 4419</span>&#160;    <span class="keywordflow">if</span> (User == N)</div><div class="line"><a name="l04420"></a><span class="lineno"> 4420</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l04421"></a><span class="lineno"> 4421</span>&#160;    <span class="keywordflow">if</span> (UI.getUse().getResNo() != N0.<a class="code" href="classllvm_1_1SDValue.html#a64881a6ca7154fccaeb92cdb1e1e745e">getResNo</a>())</div><div class="line"><a name="l04422"></a><span class="lineno"> 4422</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l04423"></a><span class="lineno"> 4423</span>&#160;    <span class="comment">// FIXME: Only extend SETCC N, N and SETCC N, c for now.</span></div><div class="line"><a name="l04424"></a><span class="lineno"> 4424</span>&#160;    <span class="keywordflow">if</span> (ExtOpc != <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a27d5d8ef82302b739ba3ca8be1a5513d">ISD::ANY_EXTEND</a> &amp;&amp; User-&gt;<a class="code" href="classllvm_1_1SDNode.html#af0d328f3f61168f4ea7d6e4044af4f97">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a0158ee47dfa868be5d28e2cbef70d5d0">ISD::SETCC</a>) {</div><div class="line"><a name="l04425"></a><span class="lineno"> 4425</span>&#160;      <a class="code" href="namespacellvm_1_1ISD.html#ac3c3cf58d6d631af6a172457304d3d07">ISD::CondCode</a> <a class="code" href="Target_2PowerPC_2README_8txt.html#afc7ca55ad1da67847ecd4b99ef64dc84">CC</a> = cast&lt;CondCodeSDNode&gt;(User-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(2))-&gt;<span class="keyword">get</span>();</div><div class="line"><a name="l04426"></a><span class="lineno"> 4426</span>&#160;      <span class="keywordflow">if</span> (ExtOpc == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a93fdf85eff945f1a668b4915a051453e">ISD::ZERO_EXTEND</a> &amp;&amp; <a class="code" href="namespacellvm_1_1ISD.html#aae86ddfa346964171caa61f29d46294b">ISD::isSignedIntSetCC</a>(CC))</div><div class="line"><a name="l04427"></a><span class="lineno"> 4427</span>&#160;        <span class="comment">// Sign bits will be lost after a zext.</span></div><div class="line"><a name="l04428"></a><span class="lineno"> 4428</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l04429"></a><span class="lineno"> 4429</span>&#160;      <span class="keywordtype">bool</span> Add = <span class="keyword">false</span>;</div><div class="line"><a name="l04430"></a><span class="lineno"> 4430</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != 2; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l04431"></a><span class="lineno"> 4431</span>&#160;        <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> UseOp = User-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l04432"></a><span class="lineno"> 4432</span>&#160;        <span class="keywordflow">if</span> (UseOp == N0)</div><div class="line"><a name="l04433"></a><span class="lineno"> 4433</span>&#160;          <span class="keywordflow">continue</span>;</div><div class="line"><a name="l04434"></a><span class="lineno"> 4434</span>&#160;        <span class="keywordflow">if</span> (!isa&lt;ConstantSDNode&gt;(UseOp))</div><div class="line"><a name="l04435"></a><span class="lineno"> 4435</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l04436"></a><span class="lineno"> 4436</span>&#160;        Add = <span class="keyword">true</span>;</div><div class="line"><a name="l04437"></a><span class="lineno"> 4437</span>&#160;      }</div><div class="line"><a name="l04438"></a><span class="lineno"> 4438</span>&#160;      <span class="keywordflow">if</span> (Add)</div><div class="line"><a name="l04439"></a><span class="lineno"> 4439</span>&#160;        ExtendNodes.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(User);</div><div class="line"><a name="l04440"></a><span class="lineno"> 4440</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l04441"></a><span class="lineno"> 4441</span>&#160;    }</div><div class="line"><a name="l04442"></a><span class="lineno"> 4442</span>&#160;    <span class="comment">// If truncates aren&#39;t free and there are users we can&#39;t</span></div><div class="line"><a name="l04443"></a><span class="lineno"> 4443</span>&#160;    <span class="comment">// extend, it isn&#39;t worthwhile.</span></div><div class="line"><a name="l04444"></a><span class="lineno"> 4444</span>&#160;    <span class="keywordflow">if</span> (!isTruncFree)</div><div class="line"><a name="l04445"></a><span class="lineno"> 4445</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l04446"></a><span class="lineno"> 4446</span>&#160;    <span class="comment">// Remember if this value is live-out.</span></div><div class="line"><a name="l04447"></a><span class="lineno"> 4447</span>&#160;    <span class="keywordflow">if</span> (User-&gt;<a class="code" href="classllvm_1_1SDNode.html#af0d328f3f61168f4ea7d6e4044af4f97">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a93bc27ca4d9e211c54b0d9efb660f080">ISD::CopyToReg</a>)</div><div class="line"><a name="l04448"></a><span class="lineno"> 4448</span>&#160;      HasCopyToRegUses = <span class="keyword">true</span>;</div><div class="line"><a name="l04449"></a><span class="lineno"> 4449</span>&#160;  }</div><div class="line"><a name="l04450"></a><span class="lineno"> 4450</span>&#160;</div><div class="line"><a name="l04451"></a><span class="lineno"> 4451</span>&#160;  <span class="keywordflow">if</span> (HasCopyToRegUses) {</div><div class="line"><a name="l04452"></a><span class="lineno"> 4452</span>&#160;    <span class="keywordtype">bool</span> BothLiveOut = <span class="keyword">false</span>;</div><div class="line"><a name="l04453"></a><span class="lineno"> 4453</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1SDNode_1_1use__iterator.html">SDNode::use_iterator</a> UI = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a8810bf428dcf84d48f39c8f5ba9a8c94">use_begin</a>(), UE = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#aef02f2c1bd12936a80611b134b24a47d">use_end</a>();</div><div class="line"><a name="l04454"></a><span class="lineno"> 4454</span>&#160;         UI != UE; ++UI) {</div><div class="line"><a name="l04455"></a><span class="lineno"> 4455</span>&#160;      <a class="code" href="classllvm_1_1SDUse.html">SDUse</a> &amp;<a class="code" href="classllvm_1_1Use.html">Use</a> = UI.getUse();</div><div class="line"><a name="l04456"></a><span class="lineno"> 4456</span>&#160;      <span class="keywordflow">if</span> (Use.<a class="code" href="classllvm_1_1SDUse.html#a837a4522010445da3f5161dcd2b95880">getResNo</a>() == 0 &amp;&amp; Use.<a class="code" href="classllvm_1_1SDUse.html#a469c58f8a39344294563f11514c352de">getUser</a>()-&gt;<a class="code" href="classllvm_1_1SDNode.html#af0d328f3f61168f4ea7d6e4044af4f97">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a93bc27ca4d9e211c54b0d9efb660f080">ISD::CopyToReg</a>) {</div><div class="line"><a name="l04457"></a><span class="lineno"> 4457</span>&#160;        BothLiveOut = <span class="keyword">true</span>;</div><div class="line"><a name="l04458"></a><span class="lineno"> 4458</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l04459"></a><span class="lineno"> 4459</span>&#160;      }</div><div class="line"><a name="l04460"></a><span class="lineno"> 4460</span>&#160;    }</div><div class="line"><a name="l04461"></a><span class="lineno"> 4461</span>&#160;    <span class="keywordflow">if</span> (BothLiveOut)</div><div class="line"><a name="l04462"></a><span class="lineno"> 4462</span>&#160;      <span class="comment">// Both unextended and extended values are live out. There had better be</span></div><div class="line"><a name="l04463"></a><span class="lineno"> 4463</span>&#160;      <span class="comment">// a good reason for the transformation.</span></div><div class="line"><a name="l04464"></a><span class="lineno"> 4464</span>&#160;      <span class="keywordflow">return</span> ExtendNodes.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#a22a311dfe4c28a897de8a9365a4f0a84">size</a>();</div><div class="line"><a name="l04465"></a><span class="lineno"> 4465</span>&#160;  }</div><div class="line"><a name="l04466"></a><span class="lineno"> 4466</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l04467"></a><span class="lineno"> 4467</span>&#160;}</div><div class="line"><a name="l04468"></a><span class="lineno"> 4468</span>&#160;</div><div class="line"><a name="l04469"></a><span class="lineno"> 4469</span>&#160;<span class="keywordtype">void</span> DAGCombiner::ExtendSetCCUses(<span class="keyword">const</span> <a class="code" href="classllvm_1_1SmallVectorImpl.html">SmallVectorImpl&lt;SDNode *&gt;</a> &amp;SetCCs,</div><div class="line"><a name="l04470"></a><span class="lineno"> 4470</span>&#160;                                  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Trunc, <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> ExtLoad, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a> DL,</div><div class="line"><a name="l04471"></a><span class="lineno"> 4471</span>&#160;                                  <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110">ISD::NodeType</a> ExtType) {</div><div class="line"><a name="l04472"></a><span class="lineno"> 4472</span>&#160;  <span class="comment">// Extend SetCC uses if necessary.</span></div><div class="line"><a name="l04473"></a><span class="lineno"> 4473</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0, e = SetCCs.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#a22a311dfe4c28a897de8a9365a4f0a84">size</a>(); <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != e; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l04474"></a><span class="lineno"> 4474</span>&#160;    <a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *SetCC = SetCCs[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div><div class="line"><a name="l04475"></a><span class="lineno"> 4475</span>&#160;    <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;SDValue, 4&gt;</a> Ops;</div><div class="line"><a name="l04476"></a><span class="lineno"> 4476</span>&#160;</div><div class="line"><a name="l04477"></a><span class="lineno"> 4477</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a> = 0; <a class="code" href="Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a> != 2; ++<a class="code" href="Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a>) {</div><div class="line"><a name="l04478"></a><span class="lineno"> 4478</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> SOp = SetCC-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(<a class="code" href="Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a>);</div><div class="line"><a name="l04479"></a><span class="lineno"> 4479</span>&#160;      <span class="keywordflow">if</span> (SOp == Trunc)</div><div class="line"><a name="l04480"></a><span class="lineno"> 4480</span>&#160;        Ops.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(ExtLoad);</div><div class="line"><a name="l04481"></a><span class="lineno"> 4481</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l04482"></a><span class="lineno"> 4482</span>&#160;        Ops.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(ExtType, DL, ExtLoad-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(0), SOp));</div><div class="line"><a name="l04483"></a><span class="lineno"> 4483</span>&#160;    }</div><div class="line"><a name="l04484"></a><span class="lineno"> 4484</span>&#160;</div><div class="line"><a name="l04485"></a><span class="lineno"> 4485</span>&#160;    Ops.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(SetCC-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(2));</div><div class="line"><a name="l04486"></a><span class="lineno"> 4486</span>&#160;    CombineTo(SetCC, DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a0158ee47dfa868be5d28e2cbef70d5d0">ISD::SETCC</a>, DL, SetCC-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(0),</div><div class="line"><a name="l04487"></a><span class="lineno"> 4487</span>&#160;                                 &amp;Ops[0], Ops.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#a22a311dfe4c28a897de8a9365a4f0a84">size</a>()));</div><div class="line"><a name="l04488"></a><span class="lineno"> 4488</span>&#160;  }</div><div class="line"><a name="l04489"></a><span class="lineno"> 4489</span>&#160;}</div><div class="line"><a name="l04490"></a><span class="lineno"> 4490</span>&#160;</div><div class="line"><a name="l04491"></a><span class="lineno"> 4491</span>&#160;<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::visitSIGN_EXTEND(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N) {</div><div class="line"><a name="l04492"></a><span class="lineno"> 4492</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N0 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0);</div><div class="line"><a name="l04493"></a><span class="lineno"> 4493</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> VT = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(0);</div><div class="line"><a name="l04494"></a><span class="lineno"> 4494</span>&#160;</div><div class="line"><a name="l04495"></a><span class="lineno"> 4495</span>&#160;  <span class="comment">// fold (sext c1) -&gt; c1</span></div><div class="line"><a name="l04496"></a><span class="lineno"> 4496</span>&#160;  <span class="keywordflow">if</span> (isa&lt;ConstantSDNode&gt;(N0))</div><div class="line"><a name="l04497"></a><span class="lineno"> 4497</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a5183f3d72924bc7c77ba8d3f5de9f602">ISD::SIGN_EXTEND</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N0);</div><div class="line"><a name="l04498"></a><span class="lineno"> 4498</span>&#160;</div><div class="line"><a name="l04499"></a><span class="lineno"> 4499</span>&#160;  <span class="comment">// fold (sext (sext x)) -&gt; (sext x)</span></div><div class="line"><a name="l04500"></a><span class="lineno"> 4500</span>&#160;  <span class="comment">// fold (sext (aext x)) -&gt; (sext x)</span></div><div class="line"><a name="l04501"></a><span class="lineno"> 4501</span>&#160;  <span class="keywordflow">if</span> (N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a5183f3d72924bc7c77ba8d3f5de9f602">ISD::SIGN_EXTEND</a> || N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a27d5d8ef82302b739ba3ca8be1a5513d">ISD::ANY_EXTEND</a>)</div><div class="line"><a name="l04502"></a><span class="lineno"> 4502</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a5183f3d72924bc7c77ba8d3f5de9f602">ISD::SIGN_EXTEND</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT,</div><div class="line"><a name="l04503"></a><span class="lineno"> 4503</span>&#160;                       N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0));</div><div class="line"><a name="l04504"></a><span class="lineno"> 4504</span>&#160;</div><div class="line"><a name="l04505"></a><span class="lineno"> 4505</span>&#160;  <span class="keywordflow">if</span> (N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ae690127648393001a7d5b93dc23da7b3">ISD::TRUNCATE</a>) {</div><div class="line"><a name="l04506"></a><span class="lineno"> 4506</span>&#160;    <span class="comment">// fold (sext (truncate (load x))) -&gt; (sext (smaller load x))</span></div><div class="line"><a name="l04507"></a><span class="lineno"> 4507</span>&#160;    <span class="comment">// fold (sext (truncate (srl (load x), c))) -&gt; (sext (smaller load (x+c/n)))</span></div><div class="line"><a name="l04508"></a><span class="lineno"> 4508</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> NarrowLoad = ReduceLoadWidth(N0.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l04509"></a><span class="lineno"> 4509</span>&#160;    <span class="keywordflow">if</span> (NarrowLoad.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()) {</div><div class="line"><a name="l04510"></a><span class="lineno"> 4510</span>&#160;      <a class="code" href="classllvm_1_1SDNode.html">SDNode</a>* oye = N0.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>();</div><div class="line"><a name="l04511"></a><span class="lineno"> 4511</span>&#160;      <span class="keywordflow">if</span> (NarrowLoad.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>() != N0.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()) {</div><div class="line"><a name="l04512"></a><span class="lineno"> 4512</span>&#160;        CombineTo(N0.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>(), NarrowLoad);</div><div class="line"><a name="l04513"></a><span class="lineno"> 4513</span>&#160;        <span class="comment">// CombineTo deleted the truncate, if needed, but not what&#39;s under it.</span></div><div class="line"><a name="l04514"></a><span class="lineno"> 4514</span>&#160;        AddToWorkList(oye);</div><div class="line"><a name="l04515"></a><span class="lineno"> 4515</span>&#160;      }</div><div class="line"><a name="l04516"></a><span class="lineno"> 4516</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(N, 0);   <span class="comment">// Return N so it doesn&#39;t get rechecked!</span></div><div class="line"><a name="l04517"></a><span class="lineno"> 4517</span>&#160;    }</div><div class="line"><a name="l04518"></a><span class="lineno"> 4518</span>&#160;</div><div class="line"><a name="l04519"></a><span class="lineno"> 4519</span>&#160;    <span class="comment">// See if the value being truncated is already sign extended.  If so, just</span></div><div class="line"><a name="l04520"></a><span class="lineno"> 4520</span>&#160;    <span class="comment">// eliminate the trunc/sext pair.</span></div><div class="line"><a name="l04521"></a><span class="lineno"> 4521</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Op = N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0);</div><div class="line"><a name="l04522"></a><span class="lineno"> 4522</span>&#160;    <span class="keywordtype">unsigned</span> OpBits   = Op.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>().<a class="code" href="structllvm_1_1EVT.html#a15be9767d0aad93fe5dcb60b7b7a78da">getScalarType</a>().<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>();</div><div class="line"><a name="l04523"></a><span class="lineno"> 4523</span>&#160;    <span class="keywordtype">unsigned</span> MidBits  = N0.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>().<a class="code" href="structllvm_1_1EVT.html#a15be9767d0aad93fe5dcb60b7b7a78da">getScalarType</a>().<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>();</div><div class="line"><a name="l04524"></a><span class="lineno"> 4524</span>&#160;    <span class="keywordtype">unsigned</span> DestBits = VT.<a class="code" href="structllvm_1_1EVT.html#a15be9767d0aad93fe5dcb60b7b7a78da">getScalarType</a>().<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>();</div><div class="line"><a name="l04525"></a><span class="lineno"> 4525</span>&#160;    <span class="keywordtype">unsigned</span> NumSignBits = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a01e15fa872bbde36ed8a394a01b200b9">ComputeNumSignBits</a>(Op);</div><div class="line"><a name="l04526"></a><span class="lineno"> 4526</span>&#160;</div><div class="line"><a name="l04527"></a><span class="lineno"> 4527</span>&#160;    <span class="keywordflow">if</span> (OpBits == DestBits) {</div><div class="line"><a name="l04528"></a><span class="lineno"> 4528</span>&#160;      <span class="comment">// Op is i32, Mid is i8, and Dest is i32.  If Op has more than 24 sign</span></div><div class="line"><a name="l04529"></a><span class="lineno"> 4529</span>&#160;      <span class="comment">// bits, it is already ready.</span></div><div class="line"><a name="l04530"></a><span class="lineno"> 4530</span>&#160;      <span class="keywordflow">if</span> (NumSignBits &gt; DestBits-MidBits)</div><div class="line"><a name="l04531"></a><span class="lineno"> 4531</span>&#160;        <span class="keywordflow">return</span> Op;</div><div class="line"><a name="l04532"></a><span class="lineno"> 4532</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (OpBits &lt; DestBits) {</div><div class="line"><a name="l04533"></a><span class="lineno"> 4533</span>&#160;      <span class="comment">// Op is i32, Mid is i8, and Dest is i64.  If Op has more than 24 sign</span></div><div class="line"><a name="l04534"></a><span class="lineno"> 4534</span>&#160;      <span class="comment">// bits, just sext from i32.</span></div><div class="line"><a name="l04535"></a><span class="lineno"> 4535</span>&#160;      <span class="keywordflow">if</span> (NumSignBits &gt; OpBits-MidBits)</div><div class="line"><a name="l04536"></a><span class="lineno"> 4536</span>&#160;        <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a5183f3d72924bc7c77ba8d3f5de9f602">ISD::SIGN_EXTEND</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, Op);</div><div class="line"><a name="l04537"></a><span class="lineno"> 4537</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l04538"></a><span class="lineno"> 4538</span>&#160;      <span class="comment">// Op is i64, Mid is i8, and Dest is i32.  If Op has more than 56 sign</span></div><div class="line"><a name="l04539"></a><span class="lineno"> 4539</span>&#160;      <span class="comment">// bits, just truncate to i32.</span></div><div class="line"><a name="l04540"></a><span class="lineno"> 4540</span>&#160;      <span class="keywordflow">if</span> (NumSignBits &gt; OpBits-MidBits)</div><div class="line"><a name="l04541"></a><span class="lineno"> 4541</span>&#160;        <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ae690127648393001a7d5b93dc23da7b3">ISD::TRUNCATE</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, Op);</div><div class="line"><a name="l04542"></a><span class="lineno"> 4542</span>&#160;    }</div><div class="line"><a name="l04543"></a><span class="lineno"> 4543</span>&#160;</div><div class="line"><a name="l04544"></a><span class="lineno"> 4544</span>&#160;    <span class="comment">// fold (sext (truncate x)) -&gt; (sextinreg x).</span></div><div class="line"><a name="l04545"></a><span class="lineno"> 4545</span>&#160;    <span class="keywordflow">if</span> (!LegalOperations || TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a055b3905dbbc16fae11510b9ebd1e00c">isOperationLegal</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110aaa59dd5ec37f21905436b354c0292d9e">ISD::SIGN_EXTEND_INREG</a>,</div><div class="line"><a name="l04546"></a><span class="lineno"> 4546</span>&#160;                                                 N0.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>())) {</div><div class="line"><a name="l04547"></a><span class="lineno"> 4547</span>&#160;      <span class="keywordflow">if</span> (OpBits &lt; DestBits)</div><div class="line"><a name="l04548"></a><span class="lineno"> 4548</span>&#160;        Op = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a27d5d8ef82302b739ba3ca8be1a5513d">ISD::ANY_EXTEND</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N0), VT, Op);</div><div class="line"><a name="l04549"></a><span class="lineno"> 4549</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (OpBits &gt; DestBits)</div><div class="line"><a name="l04550"></a><span class="lineno"> 4550</span>&#160;        Op = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ae690127648393001a7d5b93dc23da7b3">ISD::TRUNCATE</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N0), VT, Op);</div><div class="line"><a name="l04551"></a><span class="lineno"> 4551</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110aaa59dd5ec37f21905436b354c0292d9e">ISD::SIGN_EXTEND_INREG</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, Op,</div><div class="line"><a name="l04552"></a><span class="lineno"> 4552</span>&#160;                         DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#ab8ba6b05ad4fa7517f2e23b26f84ae1b">getValueType</a>(N0.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>()));</div><div class="line"><a name="l04553"></a><span class="lineno"> 4553</span>&#160;    }</div><div class="line"><a name="l04554"></a><span class="lineno"> 4554</span>&#160;  }</div><div class="line"><a name="l04555"></a><span class="lineno"> 4555</span>&#160;</div><div class="line"><a name="l04556"></a><span class="lineno"> 4556</span>&#160;  <span class="comment">// fold (sext (load x)) -&gt; (sext (truncate (sextload x)))</span></div><div class="line"><a name="l04557"></a><span class="lineno"> 4557</span>&#160;  <span class="comment">// None of the supported targets knows how to perform load and sign extend</span></div><div class="line"><a name="l04558"></a><span class="lineno"> 4558</span>&#160;  <span class="comment">// on vectors in one instruction.  We only perform this transformation on</span></div><div class="line"><a name="l04559"></a><span class="lineno"> 4559</span>&#160;  <span class="comment">// scalars.</span></div><div class="line"><a name="l04560"></a><span class="lineno"> 4560</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1ISD.html#a15623094a1ed0cd7163dc786e44c87c9">ISD::isNON_EXTLoad</a>(N0.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()) &amp;&amp; !VT.<a class="code" href="structllvm_1_1EVT.html#a73f7c824cad61a47c21bf6d652ae2fd7">isVector</a>() &amp;&amp;</div><div class="line"><a name="l04561"></a><span class="lineno"> 4561</span>&#160;      ((!LegalOperations &amp;&amp; !cast&lt;LoadSDNode&gt;(N0)-&gt;isVolatile()) ||</div><div class="line"><a name="l04562"></a><span class="lineno"> 4562</span>&#160;       TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#ad85f712b9e49629c2c160f16521fe91f">isLoadExtLegal</a>(<a class="code" href="namespacellvm_1_1ISD.html#ad4d48171b87ca51ff54c10a436bac4d7a6c61b6125c7901c549f90ee0e443a770">ISD::SEXTLOAD</a>, N0.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>()))) {</div><div class="line"><a name="l04563"></a><span class="lineno"> 4563</span>&#160;    <span class="keywordtype">bool</span> DoXform = <span class="keyword">true</span>;</div><div class="line"><a name="l04564"></a><span class="lineno"> 4564</span>&#160;    <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;SDNode*, 4&gt;</a> SetCCs;</div><div class="line"><a name="l04565"></a><span class="lineno"> 4565</span>&#160;    <span class="keywordflow">if</span> (!N0.<a class="code" href="classllvm_1_1SDValue.html#a97b0f24f3e52f030830fca6fbfcbd37d">hasOneUse</a>())</div><div class="line"><a name="l04566"></a><span class="lineno"> 4566</span>&#160;      DoXform = <a class="code" href="DAGCombiner_8cpp.html#a64f519aaefc431e6e9f2e15e921fb540">ExtendUsesToFormExtLoad</a>(N, N0, <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a5183f3d72924bc7c77ba8d3f5de9f602">ISD::SIGN_EXTEND</a>, SetCCs, TLI);</div><div class="line"><a name="l04567"></a><span class="lineno"> 4567</span>&#160;    <span class="keywordflow">if</span> (DoXform) {</div><div class="line"><a name="l04568"></a><span class="lineno"> 4568</span>&#160;      <a class="code" href="classllvm_1_1LoadSDNode.html">LoadSDNode</a> *LN0 = cast&lt;LoadSDNode&gt;(N0);</div><div class="line"><a name="l04569"></a><span class="lineno"> 4569</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> ExtLoad = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#ad6ff413bea6f8195d8e6f29f4fc519c4">getExtLoad</a>(<a class="code" href="namespacellvm_1_1ISD.html#ad4d48171b87ca51ff54c10a436bac4d7a6c61b6125c7901c549f90ee0e443a770">ISD::SEXTLOAD</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT,</div><div class="line"><a name="l04570"></a><span class="lineno"> 4570</span>&#160;                                       LN0-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#ae3cb6fbf8c8cb79e10ac61bd98c85211">getChain</a>(),</div><div class="line"><a name="l04571"></a><span class="lineno"> 4571</span>&#160;                                       LN0-&gt;<a class="code" href="classllvm_1_1LoadSDNode.html#a3ded48ce66b58b7e7e143991df5dbfae">getBasePtr</a>(), N0.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>(),</div><div class="line"><a name="l04572"></a><span class="lineno"> 4572</span>&#160;                                       LN0-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a89e2b5e3fb867b4040f893c6ae3d2132">getMemOperand</a>());</div><div class="line"><a name="l04573"></a><span class="lineno"> 4573</span>&#160;      CombineTo(N, ExtLoad);</div><div class="line"><a name="l04574"></a><span class="lineno"> 4574</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Trunc = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ae690127648393001a7d5b93dc23da7b3">ISD::TRUNCATE</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N0),</div><div class="line"><a name="l04575"></a><span class="lineno"> 4575</span>&#160;                                  N0.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>(), ExtLoad);</div><div class="line"><a name="l04576"></a><span class="lineno"> 4576</span>&#160;      CombineTo(N0.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>(), Trunc, ExtLoad.<a class="code" href="classllvm_1_1SDValue.html#a040481b9bda32faa6b1435532405d88f">getValue</a>(1));</div><div class="line"><a name="l04577"></a><span class="lineno"> 4577</span>&#160;      ExtendSetCCUses(SetCCs, Trunc, ExtLoad, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N),</div><div class="line"><a name="l04578"></a><span class="lineno"> 4578</span>&#160;                      <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a5183f3d72924bc7c77ba8d3f5de9f602">ISD::SIGN_EXTEND</a>);</div><div class="line"><a name="l04579"></a><span class="lineno"> 4579</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(N, 0);   <span class="comment">// Return N so it doesn&#39;t get rechecked!</span></div><div class="line"><a name="l04580"></a><span class="lineno"> 4580</span>&#160;    }</div><div class="line"><a name="l04581"></a><span class="lineno"> 4581</span>&#160;  }</div><div class="line"><a name="l04582"></a><span class="lineno"> 4582</span>&#160;</div><div class="line"><a name="l04583"></a><span class="lineno"> 4583</span>&#160;  <span class="comment">// fold (sext (sextload x)) -&gt; (sext (truncate (sextload x)))</span></div><div class="line"><a name="l04584"></a><span class="lineno"> 4584</span>&#160;  <span class="comment">// fold (sext ( extload x)) -&gt; (sext (truncate (sextload x)))</span></div><div class="line"><a name="l04585"></a><span class="lineno"> 4585</span>&#160;  <span class="keywordflow">if</span> ((<a class="code" href="namespacellvm_1_1ISD.html#ac174dc465cbe0e04a0f5e41c0a422124">ISD::isSEXTLoad</a>(N0.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()) || <a class="code" href="namespacellvm_1_1ISD.html#a910795e8d77c1545da0683c0e1cb81ee">ISD::isEXTLoad</a>(N0.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>())) &amp;&amp;</div><div class="line"><a name="l04586"></a><span class="lineno"> 4586</span>&#160;      <a class="code" href="namespacellvm_1_1ISD.html#a7da84980dd2ee06405d74303cfb90485">ISD::isUNINDEXEDLoad</a>(N0.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()) &amp;&amp; N0.<a class="code" href="classllvm_1_1SDValue.html#a97b0f24f3e52f030830fca6fbfcbd37d">hasOneUse</a>()) {</div><div class="line"><a name="l04587"></a><span class="lineno"> 4587</span>&#160;    <a class="code" href="classllvm_1_1LoadSDNode.html">LoadSDNode</a> *LN0 = cast&lt;LoadSDNode&gt;(N0);</div><div class="line"><a name="l04588"></a><span class="lineno"> 4588</span>&#160;    <a class="code" href="structllvm_1_1EVT.html">EVT</a> MemVT = LN0-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a7cead3a2a7771e61083bcc6959915a13">getMemoryVT</a>();</div><div class="line"><a name="l04589"></a><span class="lineno"> 4589</span>&#160;    <span class="keywordflow">if</span> ((!LegalOperations &amp;&amp; !LN0-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#acd3bb9ee2ec53fa4be1fdf155b0b5a17">isVolatile</a>()) ||</div><div class="line"><a name="l04590"></a><span class="lineno"> 4590</span>&#160;        TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#ad85f712b9e49629c2c160f16521fe91f">isLoadExtLegal</a>(<a class="code" href="namespacellvm_1_1ISD.html#ad4d48171b87ca51ff54c10a436bac4d7a6c61b6125c7901c549f90ee0e443a770">ISD::SEXTLOAD</a>, MemVT)) {</div><div class="line"><a name="l04591"></a><span class="lineno"> 4591</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> ExtLoad = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#ad6ff413bea6f8195d8e6f29f4fc519c4">getExtLoad</a>(<a class="code" href="namespacellvm_1_1ISD.html#ad4d48171b87ca51ff54c10a436bac4d7a6c61b6125c7901c549f90ee0e443a770">ISD::SEXTLOAD</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT,</div><div class="line"><a name="l04592"></a><span class="lineno"> 4592</span>&#160;                                       LN0-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#ae3cb6fbf8c8cb79e10ac61bd98c85211">getChain</a>(),</div><div class="line"><a name="l04593"></a><span class="lineno"> 4593</span>&#160;                                       LN0-&gt;<a class="code" href="classllvm_1_1LoadSDNode.html#a3ded48ce66b58b7e7e143991df5dbfae">getBasePtr</a>(), MemVT,</div><div class="line"><a name="l04594"></a><span class="lineno"> 4594</span>&#160;                                       LN0-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a89e2b5e3fb867b4040f893c6ae3d2132">getMemOperand</a>());</div><div class="line"><a name="l04595"></a><span class="lineno"> 4595</span>&#160;      CombineTo(N, ExtLoad);</div><div class="line"><a name="l04596"></a><span class="lineno"> 4596</span>&#160;      CombineTo(N0.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>(),</div><div class="line"><a name="l04597"></a><span class="lineno"> 4597</span>&#160;                DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ae690127648393001a7d5b93dc23da7b3">ISD::TRUNCATE</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N0),</div><div class="line"><a name="l04598"></a><span class="lineno"> 4598</span>&#160;                            N0.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>(), ExtLoad),</div><div class="line"><a name="l04599"></a><span class="lineno"> 4599</span>&#160;                ExtLoad.<a class="code" href="classllvm_1_1SDValue.html#a040481b9bda32faa6b1435532405d88f">getValue</a>(1));</div><div class="line"><a name="l04600"></a><span class="lineno"> 4600</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(N, 0);   <span class="comment">// Return N so it doesn&#39;t get rechecked!</span></div><div class="line"><a name="l04601"></a><span class="lineno"> 4601</span>&#160;    }</div><div class="line"><a name="l04602"></a><span class="lineno"> 4602</span>&#160;  }</div><div class="line"><a name="l04603"></a><span class="lineno"> 4603</span>&#160;</div><div class="line"><a name="l04604"></a><span class="lineno"> 4604</span>&#160;  <span class="comment">// fold (sext (and/or/xor (load x), cst)) -&gt;</span></div><div class="line"><a name="l04605"></a><span class="lineno"> 4605</span>&#160;  <span class="comment">//      (and/or/xor (sextload x), (sext cst))</span></div><div class="line"><a name="l04606"></a><span class="lineno"> 4606</span>&#160;  <span class="keywordflow">if</span> ((N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ac513a7da1bf74fb3e3c594da8534f2d2">ISD::AND</a> || N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7415ab9f2172c59a2ee7c7a02afa56a4">ISD::OR</a> ||</div><div class="line"><a name="l04607"></a><span class="lineno"> 4607</span>&#160;       N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a92febb83e6ba116eb7aae8e7e3f70cc1">ISD::XOR</a>) &amp;&amp;</div><div class="line"><a name="l04608"></a><span class="lineno"> 4608</span>&#160;      isa&lt;LoadSDNode&gt;(N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0)) &amp;&amp;</div><div class="line"><a name="l04609"></a><span class="lineno"> 4609</span>&#160;      N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1).<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110aac2f0a84dd2aa5ee4c3f1385e9565f5e">ISD::Constant</a> &amp;&amp;</div><div class="line"><a name="l04610"></a><span class="lineno"> 4610</span>&#160;      TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#ad85f712b9e49629c2c160f16521fe91f">isLoadExtLegal</a>(<a class="code" href="namespacellvm_1_1ISD.html#ad4d48171b87ca51ff54c10a436bac4d7a6c61b6125c7901c549f90ee0e443a770">ISD::SEXTLOAD</a>, N0.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>()) &amp;&amp;</div><div class="line"><a name="l04611"></a><span class="lineno"> 4611</span>&#160;      (!LegalOperations &amp;&amp; TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a055b3905dbbc16fae11510b9ebd1e00c">isOperationLegal</a>(N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>(), VT))) {</div><div class="line"><a name="l04612"></a><span class="lineno"> 4612</span>&#160;    <a class="code" href="classllvm_1_1LoadSDNode.html">LoadSDNode</a> *LN0 = cast&lt;LoadSDNode&gt;(N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0));</div><div class="line"><a name="l04613"></a><span class="lineno"> 4613</span>&#160;    <span class="keywordflow">if</span> (LN0-&gt;<a class="code" href="classllvm_1_1LoadSDNode.html#af15fb8b2d4c9f295bdcf85a1eb506702">getExtensionType</a>() != <a class="code" href="namespacellvm_1_1ISD.html#ad4d48171b87ca51ff54c10a436bac4d7a8d89c7da4444d9ec11667aa369abc5f7">ISD::ZEXTLOAD</a>) {</div><div class="line"><a name="l04614"></a><span class="lineno"> 4614</span>&#160;      <span class="keywordtype">bool</span> DoXform = <span class="keyword">true</span>;</div><div class="line"><a name="l04615"></a><span class="lineno"> 4615</span>&#160;      <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;SDNode*, 4&gt;</a> SetCCs;</div><div class="line"><a name="l04616"></a><span class="lineno"> 4616</span>&#160;      <span class="keywordflow">if</span> (!N0.<a class="code" href="classllvm_1_1SDValue.html#a97b0f24f3e52f030830fca6fbfcbd37d">hasOneUse</a>())</div><div class="line"><a name="l04617"></a><span class="lineno"> 4617</span>&#160;        DoXform = <a class="code" href="DAGCombiner_8cpp.html#a64f519aaefc431e6e9f2e15e921fb540">ExtendUsesToFormExtLoad</a>(N, N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0), <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a5183f3d72924bc7c77ba8d3f5de9f602">ISD::SIGN_EXTEND</a>,</div><div class="line"><a name="l04618"></a><span class="lineno"> 4618</span>&#160;                                          SetCCs, TLI);</div><div class="line"><a name="l04619"></a><span class="lineno"> 4619</span>&#160;      <span class="keywordflow">if</span> (DoXform) {</div><div class="line"><a name="l04620"></a><span class="lineno"> 4620</span>&#160;        <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> ExtLoad = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#ad6ff413bea6f8195d8e6f29f4fc519c4">getExtLoad</a>(<a class="code" href="namespacellvm_1_1ISD.html#ad4d48171b87ca51ff54c10a436bac4d7a6c61b6125c7901c549f90ee0e443a770">ISD::SEXTLOAD</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(LN0), VT,</div><div class="line"><a name="l04621"></a><span class="lineno"> 4621</span>&#160;                                         LN0-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#ae3cb6fbf8c8cb79e10ac61bd98c85211">getChain</a>(), LN0-&gt;<a class="code" href="classllvm_1_1LoadSDNode.html#a3ded48ce66b58b7e7e143991df5dbfae">getBasePtr</a>(),</div><div class="line"><a name="l04622"></a><span class="lineno"> 4622</span>&#160;                                         LN0-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a7cead3a2a7771e61083bcc6959915a13">getMemoryVT</a>(),</div><div class="line"><a name="l04623"></a><span class="lineno"> 4623</span>&#160;                                         LN0-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a89e2b5e3fb867b4040f893c6ae3d2132">getMemOperand</a>());</div><div class="line"><a name="l04624"></a><span class="lineno"> 4624</span>&#160;        <a class="code" href="classllvm_1_1APInt.html">APInt</a> Mask = cast&lt;ConstantSDNode&gt;(N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1))-&gt;getAPIntValue();</div><div class="line"><a name="l04625"></a><span class="lineno"> 4625</span>&#160;        Mask = Mask.<a class="code" href="classllvm_1_1APInt.html#aa3464694bcec68b89b4bffd71360b897">sext</a>(VT.<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>());</div><div class="line"><a name="l04626"></a><span class="lineno"> 4626</span>&#160;        <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> <a class="code" href="namespacellvm_1_1APIntOps.html#a684cfe02c582e8d75cd6d457e63e6c25">And</a> = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>(), <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT,</div><div class="line"><a name="l04627"></a><span class="lineno"> 4627</span>&#160;                                  ExtLoad, DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(Mask, VT));</div><div class="line"><a name="l04628"></a><span class="lineno"> 4628</span>&#160;        <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Trunc = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ae690127648393001a7d5b93dc23da7b3">ISD::TRUNCATE</a>,</div><div class="line"><a name="l04629"></a><span class="lineno"> 4629</span>&#160;                                    <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0)),</div><div class="line"><a name="l04630"></a><span class="lineno"> 4630</span>&#160;                                    N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>(), ExtLoad);</div><div class="line"><a name="l04631"></a><span class="lineno"> 4631</span>&#160;        CombineTo(N, And);</div><div class="line"><a name="l04632"></a><span class="lineno"> 4632</span>&#160;        CombineTo(N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>(), Trunc, ExtLoad.<a class="code" href="classllvm_1_1SDValue.html#a040481b9bda32faa6b1435532405d88f">getValue</a>(1));</div><div class="line"><a name="l04633"></a><span class="lineno"> 4633</span>&#160;        ExtendSetCCUses(SetCCs, Trunc, ExtLoad, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N),</div><div class="line"><a name="l04634"></a><span class="lineno"> 4634</span>&#160;                        <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a5183f3d72924bc7c77ba8d3f5de9f602">ISD::SIGN_EXTEND</a>);</div><div class="line"><a name="l04635"></a><span class="lineno"> 4635</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(N, 0);   <span class="comment">// Return N so it doesn&#39;t get rechecked!</span></div><div class="line"><a name="l04636"></a><span class="lineno"> 4636</span>&#160;      }</div><div class="line"><a name="l04637"></a><span class="lineno"> 4637</span>&#160;    }</div><div class="line"><a name="l04638"></a><span class="lineno"> 4638</span>&#160;  }</div><div class="line"><a name="l04639"></a><span class="lineno"> 4639</span>&#160;</div><div class="line"><a name="l04640"></a><span class="lineno"> 4640</span>&#160;  <span class="keywordflow">if</span> (N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a0158ee47dfa868be5d28e2cbef70d5d0">ISD::SETCC</a>) {</div><div class="line"><a name="l04641"></a><span class="lineno"> 4641</span>&#160;    <span class="comment">// sext(setcc) -&gt; sext_in_reg(vsetcc) for vectors.</span></div><div class="line"><a name="l04642"></a><span class="lineno"> 4642</span>&#160;    <span class="comment">// Only do this before legalize for now.</span></div><div class="line"><a name="l04643"></a><span class="lineno"> 4643</span>&#160;    <span class="keywordflow">if</span> (VT.<a class="code" href="structllvm_1_1EVT.html#a73f7c824cad61a47c21bf6d652ae2fd7">isVector</a>() &amp;&amp; !LegalOperations &amp;&amp;</div><div class="line"><a name="l04644"></a><span class="lineno"> 4644</span>&#160;        TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a09bdc91589b715806d421ccbc540347d">getBooleanContents</a>(<span class="keyword">true</span>) ==</div><div class="line"><a name="l04645"></a><span class="lineno"> 4645</span>&#160;          <a class="code" href="classllvm_1_1TargetLoweringBase.html#aa61af767c51a95e2dd0dff2001168755a695a19c9c3ae14638be151add82755cb">TargetLowering::ZeroOrNegativeOneBooleanContent</a>) {</div><div class="line"><a name="l04646"></a><span class="lineno"> 4646</span>&#160;      <a class="code" href="structllvm_1_1EVT.html">EVT</a> N0VT = N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>();</div><div class="line"><a name="l04647"></a><span class="lineno"> 4647</span>&#160;      <span class="comment">// On some architectures (such as SSE/NEON/etc) the SETCC result type is</span></div><div class="line"><a name="l04648"></a><span class="lineno"> 4648</span>&#160;      <span class="comment">// of the same size as the compared operands. Only optimize sext(setcc())</span></div><div class="line"><a name="l04649"></a><span class="lineno"> 4649</span>&#160;      <span class="comment">// if this is the case.</span></div><div class="line"><a name="l04650"></a><span class="lineno"> 4650</span>&#160;      <a class="code" href="structllvm_1_1EVT.html">EVT</a> SVT = getSetCCResultType(N0VT);</div><div class="line"><a name="l04651"></a><span class="lineno"> 4651</span>&#160;</div><div class="line"><a name="l04652"></a><span class="lineno"> 4652</span>&#160;      <span class="comment">// We know that the # elements of the results is the same as the</span></div><div class="line"><a name="l04653"></a><span class="lineno"> 4653</span>&#160;      <span class="comment">// # elements of the compare (and the # elements of the compare result</span></div><div class="line"><a name="l04654"></a><span class="lineno"> 4654</span>&#160;      <span class="comment">// for that matter).  Check to see that they are the same size.  If so,</span></div><div class="line"><a name="l04655"></a><span class="lineno"> 4655</span>&#160;      <span class="comment">// we know that the element size of the sext&#39;d result matches the</span></div><div class="line"><a name="l04656"></a><span class="lineno"> 4656</span>&#160;      <span class="comment">// element size of the compare operands.</span></div><div class="line"><a name="l04657"></a><span class="lineno"> 4657</span>&#160;      <span class="keywordflow">if</span> (VT.<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>() == SVT.<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>())</div><div class="line"><a name="l04658"></a><span class="lineno"> 4658</span>&#160;        <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a2650d530046f9ddfc602dc7383ba0730">getSetCC</a>(<a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0),</div><div class="line"><a name="l04659"></a><span class="lineno"> 4659</span>&#160;                             N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1),</div><div class="line"><a name="l04660"></a><span class="lineno"> 4660</span>&#160;                             cast&lt;CondCodeSDNode&gt;(N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(2))-&gt;<span class="keyword">get</span>());</div><div class="line"><a name="l04661"></a><span class="lineno"> 4661</span>&#160;</div><div class="line"><a name="l04662"></a><span class="lineno"> 4662</span>&#160;      <span class="comment">// If the desired elements are smaller or larger than the source</span></div><div class="line"><a name="l04663"></a><span class="lineno"> 4663</span>&#160;      <span class="comment">// elements we can use a matching integer vector type and then</span></div><div class="line"><a name="l04664"></a><span class="lineno"> 4664</span>&#160;      <span class="comment">// truncate/sign extend</span></div><div class="line"><a name="l04665"></a><span class="lineno"> 4665</span>&#160;      <a class="code" href="structllvm_1_1EVT.html">EVT</a> MatchingVectorType = N0VT.<a class="code" href="structllvm_1_1EVT.html#a2eed75ff7477295264c8320af1630bbb">changeVectorElementTypeToInteger</a>();</div><div class="line"><a name="l04666"></a><span class="lineno"> 4666</span>&#160;      <span class="keywordflow">if</span> (SVT == MatchingVectorType) {</div><div class="line"><a name="l04667"></a><span class="lineno"> 4667</span>&#160;        <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> VsetCC = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a2650d530046f9ddfc602dc7383ba0730">getSetCC</a>(<a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), MatchingVectorType,</div><div class="line"><a name="l04668"></a><span class="lineno"> 4668</span>&#160;                               N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0), N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1),</div><div class="line"><a name="l04669"></a><span class="lineno"> 4669</span>&#160;                               cast&lt;CondCodeSDNode&gt;(N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(2))-&gt;<span class="keyword">get</span>());</div><div class="line"><a name="l04670"></a><span class="lineno"> 4670</span>&#160;        <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a4c2e9947586d4e88ad61174b796a40d1">getSExtOrTrunc</a>(VsetCC, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT);</div><div class="line"><a name="l04671"></a><span class="lineno"> 4671</span>&#160;      }</div><div class="line"><a name="l04672"></a><span class="lineno"> 4672</span>&#160;    }</div><div class="line"><a name="l04673"></a><span class="lineno"> 4673</span>&#160;</div><div class="line"><a name="l04674"></a><span class="lineno"> 4674</span>&#160;    <span class="comment">// sext(setcc x, y, cc) -&gt; (select_cc x, y, -1, 0, cc)</span></div><div class="line"><a name="l04675"></a><span class="lineno"> 4675</span>&#160;    <span class="keywordtype">unsigned</span> ElementWidth = VT.<a class="code" href="structllvm_1_1EVT.html#a15be9767d0aad93fe5dcb60b7b7a78da">getScalarType</a>().<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>();</div><div class="line"><a name="l04676"></a><span class="lineno"> 4676</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> NegOne =</div><div class="line"><a name="l04677"></a><span class="lineno"> 4677</span>&#160;      DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(<a class="code" href="classllvm_1_1APInt.html#a539bdb4fdbf46e0bfcefebf5ac6d21dd">APInt::getAllOnesValue</a>(ElementWidth), VT);</div><div class="line"><a name="l04678"></a><span class="lineno"> 4678</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> SCC =</div><div class="line"><a name="l04679"></a><span class="lineno"> 4679</span>&#160;      SimplifySelectCC(<a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0), N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1),</div><div class="line"><a name="l04680"></a><span class="lineno"> 4680</span>&#160;                       NegOne, DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(0, VT),</div><div class="line"><a name="l04681"></a><span class="lineno"> 4681</span>&#160;                       cast&lt;CondCodeSDNode&gt;(N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(2))-&gt;<span class="keyword">get</span>(), <span class="keyword">true</span>);</div><div class="line"><a name="l04682"></a><span class="lineno"> 4682</span>&#160;    <span class="keywordflow">if</span> (SCC.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()) <span class="keywordflow">return</span> SCC;</div><div class="line"><a name="l04683"></a><span class="lineno"> 4683</span>&#160;    <span class="keywordflow">if</span> (!VT.<a class="code" href="structllvm_1_1EVT.html#a73f7c824cad61a47c21bf6d652ae2fd7">isVector</a>() &amp;&amp;</div><div class="line"><a name="l04684"></a><span class="lineno"> 4684</span>&#160;        (!LegalOperations ||</div><div class="line"><a name="l04685"></a><span class="lineno"> 4685</span>&#160;         TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a055b3905dbbc16fae11510b9ebd1e00c">isOperationLegal</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a0158ee47dfa868be5d28e2cbef70d5d0">ISD::SETCC</a>, getSetCCResultType(VT)))) {</div><div class="line"><a name="l04686"></a><span class="lineno"> 4686</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a78990d91dd364f8bb9e7008d85fd73b8">getSelect</a>(<a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT,</div><div class="line"><a name="l04687"></a><span class="lineno"> 4687</span>&#160;                           DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a2650d530046f9ddfc602dc7383ba0730">getSetCC</a>(<a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N),</div><div class="line"><a name="l04688"></a><span class="lineno"> 4688</span>&#160;                           getSetCCResultType(VT),</div><div class="line"><a name="l04689"></a><span class="lineno"> 4689</span>&#160;                           N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0), N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1),</div><div class="line"><a name="l04690"></a><span class="lineno"> 4690</span>&#160;                           cast&lt;CondCodeSDNode&gt;(N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(2))-&gt;<span class="keyword">get</span>()),</div><div class="line"><a name="l04691"></a><span class="lineno"> 4691</span>&#160;                           NegOne, DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(0, VT));</div><div class="line"><a name="l04692"></a><span class="lineno"> 4692</span>&#160;    }</div><div class="line"><a name="l04693"></a><span class="lineno"> 4693</span>&#160;  }</div><div class="line"><a name="l04694"></a><span class="lineno"> 4694</span>&#160;</div><div class="line"><a name="l04695"></a><span class="lineno"> 4695</span>&#160;  <span class="comment">// fold (sext x) -&gt; (zext x) if the sign bit is known zero.</span></div><div class="line"><a name="l04696"></a><span class="lineno"> 4696</span>&#160;  <span class="keywordflow">if</span> ((!LegalOperations || TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a055b3905dbbc16fae11510b9ebd1e00c">isOperationLegal</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a93fdf85eff945f1a668b4915a051453e">ISD::ZERO_EXTEND</a>, VT)) &amp;&amp;</div><div class="line"><a name="l04697"></a><span class="lineno"> 4697</span>&#160;      DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af52a1ca20308888443767831a21352ca">SignBitIsZero</a>(N0))</div><div class="line"><a name="l04698"></a><span class="lineno"> 4698</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a93fdf85eff945f1a668b4915a051453e">ISD::ZERO_EXTEND</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N0);</div><div class="line"><a name="l04699"></a><span class="lineno"> 4699</span>&#160;</div><div class="line"><a name="l04700"></a><span class="lineno"> 4700</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l04701"></a><span class="lineno"> 4701</span>&#160;}</div><div class="line"><a name="l04702"></a><span class="lineno"> 4702</span>&#160;</div><div class="line"><a name="l04703"></a><span class="lineno"> 4703</span>&#160;<span class="comment">// isTruncateOf - If N is a truncate of some other value, return true, record</span></div><div class="line"><a name="l04704"></a><span class="lineno"> 4704</span>&#160;<span class="comment">// the value being truncated in Op and which of Op&#39;s bits are zero in KnownZero.</span></div><div class="line"><a name="l04705"></a><span class="lineno"> 4705</span>&#160;<span class="comment">// This function computes KnownZero to avoid a duplicated call to</span></div><div class="line"><a name="l04706"></a><span class="lineno"> 4706</span>&#160;<span class="comment">// ComputeMaskedBits in the caller.</span></div><div class="line"><a name="l04707"></a><span class="lineno"><a class="line" href="DAGCombiner_8cpp.html#a1bf26a30c4b6721cd55dbb3b4d7bfc77"> 4707</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="DAGCombiner_8cpp.html#a1bf26a30c4b6721cd55dbb3b4d7bfc77">isTruncateOf</a>(<a class="code" href="classllvm_1_1SelectionDAG.html">SelectionDAG</a> &amp;DAG, <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N, <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> &amp;Op,</div><div class="line"><a name="l04708"></a><span class="lineno"> 4708</span>&#160;                         <a class="code" href="classllvm_1_1APInt.html">APInt</a> &amp;KnownZero) {</div><div class="line"><a name="l04709"></a><span class="lineno"> 4709</span>&#160;  <a class="code" href="classllvm_1_1APInt.html">APInt</a> KnownOne;</div><div class="line"><a name="l04710"></a><span class="lineno"> 4710</span>&#160;  <span class="keywordflow">if</span> (N-&gt;<a class="code" href="classllvm_1_1SDNode.html#af0d328f3f61168f4ea7d6e4044af4f97">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ae690127648393001a7d5b93dc23da7b3">ISD::TRUNCATE</a>) {</div><div class="line"><a name="l04711"></a><span class="lineno"> 4711</span>&#160;    Op = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0);</div><div class="line"><a name="l04712"></a><span class="lineno"> 4712</span>&#160;    DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#ad06ca140783fd9f03eed498e8485fc3d">ComputeMaskedBits</a>(Op, KnownZero, KnownOne);</div><div class="line"><a name="l04713"></a><span class="lineno"> 4713</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l04714"></a><span class="lineno"> 4714</span>&#160;  }</div><div class="line"><a name="l04715"></a><span class="lineno"> 4715</span>&#160;</div><div class="line"><a name="l04716"></a><span class="lineno"> 4716</span>&#160;  <span class="keywordflow">if</span> (N-&gt;<a class="code" href="classllvm_1_1SDNode.html#af0d328f3f61168f4ea7d6e4044af4f97">getOpcode</a>() != <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a0158ee47dfa868be5d28e2cbef70d5d0">ISD::SETCC</a> || N-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(0) != <a class="code" href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50ca85440bbdbba12de574c02e515444d3f4">MVT::i1</a> ||</div><div class="line"><a name="l04717"></a><span class="lineno"> 4717</span>&#160;      cast&lt;CondCodeSDNode&gt;(N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(2))-&gt;<span class="keyword">get</span>() != <a class="code" href="namespacellvm_1_1ISD.html#ac3c3cf58d6d631af6a172457304d3d07a2887cc8b39915a25180f4bca0026a15e">ISD::SETNE</a>)</div><div class="line"><a name="l04718"></a><span class="lineno"> 4718</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l04719"></a><span class="lineno"> 4719</span>&#160;</div><div class="line"><a name="l04720"></a><span class="lineno"> 4720</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Op0 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0);</div><div class="line"><a name="l04721"></a><span class="lineno"> 4721</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Op1 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(1);</div><div class="line"><a name="l04722"></a><span class="lineno"> 4722</span>&#160;  assert(Op0.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>() == Op1.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>());</div><div class="line"><a name="l04723"></a><span class="lineno"> 4723</span>&#160;</div><div class="line"><a name="l04724"></a><span class="lineno"> 4724</span>&#160;  <a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a> *COp0 = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a>&gt;(Op0);</div><div class="line"><a name="l04725"></a><span class="lineno"> 4725</span>&#160;  <a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a> *COp1 = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a>&gt;(Op1);</div><div class="line"><a name="l04726"></a><span class="lineno"> 4726</span>&#160;  <span class="keywordflow">if</span> (COp0 &amp;&amp; COp0-&gt;isNullValue())</div><div class="line"><a name="l04727"></a><span class="lineno"> 4727</span>&#160;    Op = Op1;</div><div class="line"><a name="l04728"></a><span class="lineno"> 4728</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (COp1 &amp;&amp; COp1-&gt;isNullValue())</div><div class="line"><a name="l04729"></a><span class="lineno"> 4729</span>&#160;    Op = Op0;</div><div class="line"><a name="l04730"></a><span class="lineno"> 4730</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l04731"></a><span class="lineno"> 4731</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l04732"></a><span class="lineno"> 4732</span>&#160;</div><div class="line"><a name="l04733"></a><span class="lineno"> 4733</span>&#160;  DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#ad06ca140783fd9f03eed498e8485fc3d">ComputeMaskedBits</a>(Op, KnownZero, KnownOne);</div><div class="line"><a name="l04734"></a><span class="lineno"> 4734</span>&#160;</div><div class="line"><a name="l04735"></a><span class="lineno"> 4735</span>&#160;  <span class="keywordflow">if</span> (!(KnownZero | <a class="code" href="classllvm_1_1APInt.html">APInt</a>(Op.<a class="code" href="classllvm_1_1SDValue.html#a70aa652293da070dfe5b9fae309d0112">getValueSizeInBits</a>(), 1)).isAllOnesValue())</div><div class="line"><a name="l04736"></a><span class="lineno"> 4736</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l04737"></a><span class="lineno"> 4737</span>&#160;</div><div class="line"><a name="l04738"></a><span class="lineno"> 4738</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l04739"></a><span class="lineno"> 4739</span>&#160;}</div><div class="line"><a name="l04740"></a><span class="lineno"> 4740</span>&#160;</div><div class="line"><a name="l04741"></a><span class="lineno"> 4741</span>&#160;<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::visitZERO_EXTEND(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N) {</div><div class="line"><a name="l04742"></a><span class="lineno"> 4742</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N0 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0);</div><div class="line"><a name="l04743"></a><span class="lineno"> 4743</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> VT = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(0);</div><div class="line"><a name="l04744"></a><span class="lineno"> 4744</span>&#160;</div><div class="line"><a name="l04745"></a><span class="lineno"> 4745</span>&#160;  <span class="comment">// fold (zext c1) -&gt; c1</span></div><div class="line"><a name="l04746"></a><span class="lineno"> 4746</span>&#160;  <span class="keywordflow">if</span> (isa&lt;ConstantSDNode&gt;(N0))</div><div class="line"><a name="l04747"></a><span class="lineno"> 4747</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a93fdf85eff945f1a668b4915a051453e">ISD::ZERO_EXTEND</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N0);</div><div class="line"><a name="l04748"></a><span class="lineno"> 4748</span>&#160;  <span class="comment">// fold (zext (zext x)) -&gt; (zext x)</span></div><div class="line"><a name="l04749"></a><span class="lineno"> 4749</span>&#160;  <span class="comment">// fold (zext (aext x)) -&gt; (zext x)</span></div><div class="line"><a name="l04750"></a><span class="lineno"> 4750</span>&#160;  <span class="keywordflow">if</span> (N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a93fdf85eff945f1a668b4915a051453e">ISD::ZERO_EXTEND</a> || N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a27d5d8ef82302b739ba3ca8be1a5513d">ISD::ANY_EXTEND</a>)</div><div class="line"><a name="l04751"></a><span class="lineno"> 4751</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a93fdf85eff945f1a668b4915a051453e">ISD::ZERO_EXTEND</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT,</div><div class="line"><a name="l04752"></a><span class="lineno"> 4752</span>&#160;                       N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0));</div><div class="line"><a name="l04753"></a><span class="lineno"> 4753</span>&#160;</div><div class="line"><a name="l04754"></a><span class="lineno"> 4754</span>&#160;  <span class="comment">// fold (zext (truncate x)) -&gt; (zext x) or</span></div><div class="line"><a name="l04755"></a><span class="lineno"> 4755</span>&#160;  <span class="comment">//      (zext (truncate x)) -&gt; (truncate x)</span></div><div class="line"><a name="l04756"></a><span class="lineno"> 4756</span>&#160;  <span class="comment">// This is valid when the truncated bits of x are already zero.</span></div><div class="line"><a name="l04757"></a><span class="lineno"> 4757</span>&#160;  <span class="comment">// FIXME: We should extend this to work for vectors too.</span></div><div class="line"><a name="l04758"></a><span class="lineno"> 4758</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Op;</div><div class="line"><a name="l04759"></a><span class="lineno"> 4759</span>&#160;  <a class="code" href="classllvm_1_1APInt.html">APInt</a> KnownZero;</div><div class="line"><a name="l04760"></a><span class="lineno"> 4760</span>&#160;  <span class="keywordflow">if</span> (!VT.<a class="code" href="structllvm_1_1EVT.html#a73f7c824cad61a47c21bf6d652ae2fd7">isVector</a>() &amp;&amp; <a class="code" href="DAGCombiner_8cpp.html#a1bf26a30c4b6721cd55dbb3b4d7bfc77">isTruncateOf</a>(DAG, N0, Op, KnownZero)) {</div><div class="line"><a name="l04761"></a><span class="lineno"> 4761</span>&#160;    <a class="code" href="classllvm_1_1APInt.html">APInt</a> TruncatedBits =</div><div class="line"><a name="l04762"></a><span class="lineno"> 4762</span>&#160;      (Op.<a class="code" href="classllvm_1_1SDValue.html#a70aa652293da070dfe5b9fae309d0112">getValueSizeInBits</a>() == N0.<a class="code" href="classllvm_1_1SDValue.html#a70aa652293da070dfe5b9fae309d0112">getValueSizeInBits</a>()) ?</div><div class="line"><a name="l04763"></a><span class="lineno"> 4763</span>&#160;      <a class="code" href="classllvm_1_1APInt.html">APInt</a>(Op.<a class="code" href="classllvm_1_1SDValue.html#a70aa652293da070dfe5b9fae309d0112">getValueSizeInBits</a>(), 0) :</div><div class="line"><a name="l04764"></a><span class="lineno"> 4764</span>&#160;      <a class="code" href="classllvm_1_1APInt.html#a46ceedee591f92727b85641794a96061">APInt::getBitsSet</a>(Op.<a class="code" href="classllvm_1_1SDValue.html#a70aa652293da070dfe5b9fae309d0112">getValueSizeInBits</a>(),</div><div class="line"><a name="l04765"></a><span class="lineno"> 4765</span>&#160;                        N0.<a class="code" href="classllvm_1_1SDValue.html#a70aa652293da070dfe5b9fae309d0112">getValueSizeInBits</a>(),</div><div class="line"><a name="l04766"></a><span class="lineno"> 4766</span>&#160;                        std::min(Op.<a class="code" href="classllvm_1_1SDValue.html#a70aa652293da070dfe5b9fae309d0112">getValueSizeInBits</a>(),</div><div class="line"><a name="l04767"></a><span class="lineno"> 4767</span>&#160;                                 VT.<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>()));</div><div class="line"><a name="l04768"></a><span class="lineno"> 4768</span>&#160;    <span class="keywordflow">if</span> (TruncatedBits == (KnownZero &amp; TruncatedBits)) {</div><div class="line"><a name="l04769"></a><span class="lineno"> 4769</span>&#160;      <span class="keywordflow">if</span> (VT.<a class="code" href="structllvm_1_1EVT.html#ac267a86695d58fe541ef96f8c60c1b0f">bitsGT</a>(Op.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>()))</div><div class="line"><a name="l04770"></a><span class="lineno"> 4770</span>&#160;        <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a93fdf85eff945f1a668b4915a051453e">ISD::ZERO_EXTEND</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, Op);</div><div class="line"><a name="l04771"></a><span class="lineno"> 4771</span>&#160;      <span class="keywordflow">if</span> (VT.<a class="code" href="structllvm_1_1EVT.html#a5ebe5227fe53e0dcf4102a6ebf1594a2">bitsLT</a>(Op.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>()))</div><div class="line"><a name="l04772"></a><span class="lineno"> 4772</span>&#160;        <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ae690127648393001a7d5b93dc23da7b3">ISD::TRUNCATE</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, Op);</div><div class="line"><a name="l04773"></a><span class="lineno"> 4773</span>&#160;</div><div class="line"><a name="l04774"></a><span class="lineno"> 4774</span>&#160;      <span class="keywordflow">return</span> Op;</div><div class="line"><a name="l04775"></a><span class="lineno"> 4775</span>&#160;    }</div><div class="line"><a name="l04776"></a><span class="lineno"> 4776</span>&#160;  }</div><div class="line"><a name="l04777"></a><span class="lineno"> 4777</span>&#160;</div><div class="line"><a name="l04778"></a><span class="lineno"> 4778</span>&#160;  <span class="comment">// fold (zext (truncate (load x))) -&gt; (zext (smaller load x))</span></div><div class="line"><a name="l04779"></a><span class="lineno"> 4779</span>&#160;  <span class="comment">// fold (zext (truncate (srl (load x), c))) -&gt; (zext (small load (x+c/n)))</span></div><div class="line"><a name="l04780"></a><span class="lineno"> 4780</span>&#160;  <span class="keywordflow">if</span> (N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ae690127648393001a7d5b93dc23da7b3">ISD::TRUNCATE</a>) {</div><div class="line"><a name="l04781"></a><span class="lineno"> 4781</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> NarrowLoad = ReduceLoadWidth(N0.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l04782"></a><span class="lineno"> 4782</span>&#160;    <span class="keywordflow">if</span> (NarrowLoad.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()) {</div><div class="line"><a name="l04783"></a><span class="lineno"> 4783</span>&#160;      <a class="code" href="classllvm_1_1SDNode.html">SDNode</a>* oye = N0.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>();</div><div class="line"><a name="l04784"></a><span class="lineno"> 4784</span>&#160;      <span class="keywordflow">if</span> (NarrowLoad.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>() != N0.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()) {</div><div class="line"><a name="l04785"></a><span class="lineno"> 4785</span>&#160;        CombineTo(N0.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>(), NarrowLoad);</div><div class="line"><a name="l04786"></a><span class="lineno"> 4786</span>&#160;        <span class="comment">// CombineTo deleted the truncate, if needed, but not what&#39;s under it.</span></div><div class="line"><a name="l04787"></a><span class="lineno"> 4787</span>&#160;        AddToWorkList(oye);</div><div class="line"><a name="l04788"></a><span class="lineno"> 4788</span>&#160;      }</div><div class="line"><a name="l04789"></a><span class="lineno"> 4789</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(N, 0);   <span class="comment">// Return N so it doesn&#39;t get rechecked!</span></div><div class="line"><a name="l04790"></a><span class="lineno"> 4790</span>&#160;    }</div><div class="line"><a name="l04791"></a><span class="lineno"> 4791</span>&#160;  }</div><div class="line"><a name="l04792"></a><span class="lineno"> 4792</span>&#160;</div><div class="line"><a name="l04793"></a><span class="lineno"> 4793</span>&#160;  <span class="comment">// fold (zext (truncate x)) -&gt; (and x, mask)</span></div><div class="line"><a name="l04794"></a><span class="lineno"> 4794</span>&#160;  <span class="keywordflow">if</span> (N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ae690127648393001a7d5b93dc23da7b3">ISD::TRUNCATE</a> &amp;&amp;</div><div class="line"><a name="l04795"></a><span class="lineno"> 4795</span>&#160;      (!LegalOperations || TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a055b3905dbbc16fae11510b9ebd1e00c">isOperationLegal</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ac513a7da1bf74fb3e3c594da8534f2d2">ISD::AND</a>, VT))) {</div><div class="line"><a name="l04796"></a><span class="lineno"> 4796</span>&#160;</div><div class="line"><a name="l04797"></a><span class="lineno"> 4797</span>&#160;    <span class="comment">// fold (zext (truncate (load x))) -&gt; (zext (smaller load x))</span></div><div class="line"><a name="l04798"></a><span class="lineno"> 4798</span>&#160;    <span class="comment">// fold (zext (truncate (srl (load x), c))) -&gt; (zext (smaller load (x+c/n)))</span></div><div class="line"><a name="l04799"></a><span class="lineno"> 4799</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> NarrowLoad = ReduceLoadWidth(N0.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l04800"></a><span class="lineno"> 4800</span>&#160;    <span class="keywordflow">if</span> (NarrowLoad.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()) {</div><div class="line"><a name="l04801"></a><span class="lineno"> 4801</span>&#160;      <a class="code" href="classllvm_1_1SDNode.html">SDNode</a>* oye = N0.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>();</div><div class="line"><a name="l04802"></a><span class="lineno"> 4802</span>&#160;      <span class="keywordflow">if</span> (NarrowLoad.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>() != N0.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()) {</div><div class="line"><a name="l04803"></a><span class="lineno"> 4803</span>&#160;        CombineTo(N0.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>(), NarrowLoad);</div><div class="line"><a name="l04804"></a><span class="lineno"> 4804</span>&#160;        <span class="comment">// CombineTo deleted the truncate, if needed, but not what&#39;s under it.</span></div><div class="line"><a name="l04805"></a><span class="lineno"> 4805</span>&#160;        AddToWorkList(oye);</div><div class="line"><a name="l04806"></a><span class="lineno"> 4806</span>&#160;      }</div><div class="line"><a name="l04807"></a><span class="lineno"> 4807</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(N, 0);   <span class="comment">// Return N so it doesn&#39;t get rechecked!</span></div><div class="line"><a name="l04808"></a><span class="lineno"> 4808</span>&#160;    }</div><div class="line"><a name="l04809"></a><span class="lineno"> 4809</span>&#160;</div><div class="line"><a name="l04810"></a><span class="lineno"> 4810</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Op = N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0);</div><div class="line"><a name="l04811"></a><span class="lineno"> 4811</span>&#160;    <span class="keywordflow">if</span> (Op.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>().<a class="code" href="structllvm_1_1EVT.html#a5ebe5227fe53e0dcf4102a6ebf1594a2">bitsLT</a>(VT)) {</div><div class="line"><a name="l04812"></a><span class="lineno"> 4812</span>&#160;      Op = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a27d5d8ef82302b739ba3ca8be1a5513d">ISD::ANY_EXTEND</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, Op);</div><div class="line"><a name="l04813"></a><span class="lineno"> 4813</span>&#160;      AddToWorkList(Op.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l04814"></a><span class="lineno"> 4814</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Op.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>().<a class="code" href="structllvm_1_1EVT.html#ac267a86695d58fe541ef96f8c60c1b0f">bitsGT</a>(VT)) {</div><div class="line"><a name="l04815"></a><span class="lineno"> 4815</span>&#160;      Op = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ae690127648393001a7d5b93dc23da7b3">ISD::TRUNCATE</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, Op);</div><div class="line"><a name="l04816"></a><span class="lineno"> 4816</span>&#160;      AddToWorkList(Op.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l04817"></a><span class="lineno"> 4817</span>&#160;    }</div><div class="line"><a name="l04818"></a><span class="lineno"> 4818</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#ad03d69f873a948a3de21ba504364d352">getZeroExtendInReg</a>(Op, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N),</div><div class="line"><a name="l04819"></a><span class="lineno"> 4819</span>&#160;                                  N0.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>().<a class="code" href="structllvm_1_1EVT.html#a15be9767d0aad93fe5dcb60b7b7a78da">getScalarType</a>());</div><div class="line"><a name="l04820"></a><span class="lineno"> 4820</span>&#160;  }</div><div class="line"><a name="l04821"></a><span class="lineno"> 4821</span>&#160;</div><div class="line"><a name="l04822"></a><span class="lineno"> 4822</span>&#160;  <span class="comment">// Fold (zext (and (trunc x), cst)) -&gt; (and x, cst),</span></div><div class="line"><a name="l04823"></a><span class="lineno"> 4823</span>&#160;  <span class="comment">// if either of the casts is not free.</span></div><div class="line"><a name="l04824"></a><span class="lineno"> 4824</span>&#160;  <span class="keywordflow">if</span> (N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ac513a7da1bf74fb3e3c594da8534f2d2">ISD::AND</a> &amp;&amp;</div><div class="line"><a name="l04825"></a><span class="lineno"> 4825</span>&#160;      N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ae690127648393001a7d5b93dc23da7b3">ISD::TRUNCATE</a> &amp;&amp;</div><div class="line"><a name="l04826"></a><span class="lineno"> 4826</span>&#160;      N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1).<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110aac2f0a84dd2aa5ee4c3f1385e9565f5e">ISD::Constant</a> &amp;&amp;</div><div class="line"><a name="l04827"></a><span class="lineno"> 4827</span>&#160;      (!TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a00856c52a5a67b38d8332c7842429153">isTruncateFree</a>(N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>(),</div><div class="line"><a name="l04828"></a><span class="lineno"> 4828</span>&#160;                           N0.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>()) ||</div><div class="line"><a name="l04829"></a><span class="lineno"> 4829</span>&#160;       !TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#ae40dacbf39edf0d87f07cc4389deaa67">isZExtFree</a>(N0.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>(), VT))) {</div><div class="line"><a name="l04830"></a><span class="lineno"> 4830</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> <a class="code" href="namespacellvm.html#a6569d00d31a5d74e563e2f39f82271ab">X</a> = N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0);</div><div class="line"><a name="l04831"></a><span class="lineno"> 4831</span>&#160;    <span class="keywordflow">if</span> (X.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>().<a class="code" href="structllvm_1_1EVT.html#a5ebe5227fe53e0dcf4102a6ebf1594a2">bitsLT</a>(VT)) {</div><div class="line"><a name="l04832"></a><span class="lineno"> 4832</span>&#160;      X = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a27d5d8ef82302b739ba3ca8be1a5513d">ISD::ANY_EXTEND</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(X), VT, X);</div><div class="line"><a name="l04833"></a><span class="lineno"> 4833</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (X.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>().<a class="code" href="structllvm_1_1EVT.html#ac267a86695d58fe541ef96f8c60c1b0f">bitsGT</a>(VT)) {</div><div class="line"><a name="l04834"></a><span class="lineno"> 4834</span>&#160;      X = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ae690127648393001a7d5b93dc23da7b3">ISD::TRUNCATE</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(X), VT, X);</div><div class="line"><a name="l04835"></a><span class="lineno"> 4835</span>&#160;    }</div><div class="line"><a name="l04836"></a><span class="lineno"> 4836</span>&#160;    <a class="code" href="classllvm_1_1APInt.html">APInt</a> Mask = cast&lt;ConstantSDNode&gt;(N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1))-&gt;getAPIntValue();</div><div class="line"><a name="l04837"></a><span class="lineno"> 4837</span>&#160;    Mask = Mask.<a class="code" href="classllvm_1_1APInt.html#a6142fc5662411269a7ca0217f49f338c">zext</a>(VT.<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>());</div><div class="line"><a name="l04838"></a><span class="lineno"> 4838</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ac513a7da1bf74fb3e3c594da8534f2d2">ISD::AND</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT,</div><div class="line"><a name="l04839"></a><span class="lineno"> 4839</span>&#160;                       X, DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(Mask, VT));</div><div class="line"><a name="l04840"></a><span class="lineno"> 4840</span>&#160;  }</div><div class="line"><a name="l04841"></a><span class="lineno"> 4841</span>&#160;</div><div class="line"><a name="l04842"></a><span class="lineno"> 4842</span>&#160;  <span class="comment">// fold (zext (load x)) -&gt; (zext (truncate (zextload x)))</span></div><div class="line"><a name="l04843"></a><span class="lineno"> 4843</span>&#160;  <span class="comment">// None of the supported targets knows how to perform load and vector_zext</span></div><div class="line"><a name="l04844"></a><span class="lineno"> 4844</span>&#160;  <span class="comment">// on vectors in one instruction.  We only perform this transformation on</span></div><div class="line"><a name="l04845"></a><span class="lineno"> 4845</span>&#160;  <span class="comment">// scalars.</span></div><div class="line"><a name="l04846"></a><span class="lineno"> 4846</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1ISD.html#a15623094a1ed0cd7163dc786e44c87c9">ISD::isNON_EXTLoad</a>(N0.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()) &amp;&amp; !VT.<a class="code" href="structllvm_1_1EVT.html#a73f7c824cad61a47c21bf6d652ae2fd7">isVector</a>() &amp;&amp;</div><div class="line"><a name="l04847"></a><span class="lineno"> 4847</span>&#160;      ((!LegalOperations &amp;&amp; !cast&lt;LoadSDNode&gt;(N0)-&gt;isVolatile()) ||</div><div class="line"><a name="l04848"></a><span class="lineno"> 4848</span>&#160;       TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#ad85f712b9e49629c2c160f16521fe91f">isLoadExtLegal</a>(<a class="code" href="namespacellvm_1_1ISD.html#ad4d48171b87ca51ff54c10a436bac4d7a8d89c7da4444d9ec11667aa369abc5f7">ISD::ZEXTLOAD</a>, N0.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>()))) {</div><div class="line"><a name="l04849"></a><span class="lineno"> 4849</span>&#160;    <span class="keywordtype">bool</span> DoXform = <span class="keyword">true</span>;</div><div class="line"><a name="l04850"></a><span class="lineno"> 4850</span>&#160;    <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;SDNode*, 4&gt;</a> SetCCs;</div><div class="line"><a name="l04851"></a><span class="lineno"> 4851</span>&#160;    <span class="keywordflow">if</span> (!N0.<a class="code" href="classllvm_1_1SDValue.html#a97b0f24f3e52f030830fca6fbfcbd37d">hasOneUse</a>())</div><div class="line"><a name="l04852"></a><span class="lineno"> 4852</span>&#160;      DoXform = <a class="code" href="DAGCombiner_8cpp.html#a64f519aaefc431e6e9f2e15e921fb540">ExtendUsesToFormExtLoad</a>(N, N0, <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a93fdf85eff945f1a668b4915a051453e">ISD::ZERO_EXTEND</a>, SetCCs, TLI);</div><div class="line"><a name="l04853"></a><span class="lineno"> 4853</span>&#160;    <span class="keywordflow">if</span> (DoXform) {</div><div class="line"><a name="l04854"></a><span class="lineno"> 4854</span>&#160;      <a class="code" href="classllvm_1_1LoadSDNode.html">LoadSDNode</a> *LN0 = cast&lt;LoadSDNode&gt;(N0);</div><div class="line"><a name="l04855"></a><span class="lineno"> 4855</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> ExtLoad = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#ad6ff413bea6f8195d8e6f29f4fc519c4">getExtLoad</a>(<a class="code" href="namespacellvm_1_1ISD.html#ad4d48171b87ca51ff54c10a436bac4d7a8d89c7da4444d9ec11667aa369abc5f7">ISD::ZEXTLOAD</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT,</div><div class="line"><a name="l04856"></a><span class="lineno"> 4856</span>&#160;                                       LN0-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#ae3cb6fbf8c8cb79e10ac61bd98c85211">getChain</a>(),</div><div class="line"><a name="l04857"></a><span class="lineno"> 4857</span>&#160;                                       LN0-&gt;<a class="code" href="classllvm_1_1LoadSDNode.html#a3ded48ce66b58b7e7e143991df5dbfae">getBasePtr</a>(), N0.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>(),</div><div class="line"><a name="l04858"></a><span class="lineno"> 4858</span>&#160;                                       LN0-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a89e2b5e3fb867b4040f893c6ae3d2132">getMemOperand</a>());</div><div class="line"><a name="l04859"></a><span class="lineno"> 4859</span>&#160;      CombineTo(N, ExtLoad);</div><div class="line"><a name="l04860"></a><span class="lineno"> 4860</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Trunc = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ae690127648393001a7d5b93dc23da7b3">ISD::TRUNCATE</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N0),</div><div class="line"><a name="l04861"></a><span class="lineno"> 4861</span>&#160;                                  N0.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>(), ExtLoad);</div><div class="line"><a name="l04862"></a><span class="lineno"> 4862</span>&#160;      CombineTo(N0.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>(), Trunc, ExtLoad.<a class="code" href="classllvm_1_1SDValue.html#a040481b9bda32faa6b1435532405d88f">getValue</a>(1));</div><div class="line"><a name="l04863"></a><span class="lineno"> 4863</span>&#160;</div><div class="line"><a name="l04864"></a><span class="lineno"> 4864</span>&#160;      ExtendSetCCUses(SetCCs, Trunc, ExtLoad, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N),</div><div class="line"><a name="l04865"></a><span class="lineno"> 4865</span>&#160;                      <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a93fdf85eff945f1a668b4915a051453e">ISD::ZERO_EXTEND</a>);</div><div class="line"><a name="l04866"></a><span class="lineno"> 4866</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(N, 0);   <span class="comment">// Return N so it doesn&#39;t get rechecked!</span></div><div class="line"><a name="l04867"></a><span class="lineno"> 4867</span>&#160;    }</div><div class="line"><a name="l04868"></a><span class="lineno"> 4868</span>&#160;  }</div><div class="line"><a name="l04869"></a><span class="lineno"> 4869</span>&#160;</div><div class="line"><a name="l04870"></a><span class="lineno"> 4870</span>&#160;  <span class="comment">// fold (zext (and/or/xor (load x), cst)) -&gt;</span></div><div class="line"><a name="l04871"></a><span class="lineno"> 4871</span>&#160;  <span class="comment">//      (and/or/xor (zextload x), (zext cst))</span></div><div class="line"><a name="l04872"></a><span class="lineno"> 4872</span>&#160;  <span class="keywordflow">if</span> ((N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ac513a7da1bf74fb3e3c594da8534f2d2">ISD::AND</a> || N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7415ab9f2172c59a2ee7c7a02afa56a4">ISD::OR</a> ||</div><div class="line"><a name="l04873"></a><span class="lineno"> 4873</span>&#160;       N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a92febb83e6ba116eb7aae8e7e3f70cc1">ISD::XOR</a>) &amp;&amp;</div><div class="line"><a name="l04874"></a><span class="lineno"> 4874</span>&#160;      isa&lt;LoadSDNode&gt;(N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0)) &amp;&amp;</div><div class="line"><a name="l04875"></a><span class="lineno"> 4875</span>&#160;      N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1).<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110aac2f0a84dd2aa5ee4c3f1385e9565f5e">ISD::Constant</a> &amp;&amp;</div><div class="line"><a name="l04876"></a><span class="lineno"> 4876</span>&#160;      TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#ad85f712b9e49629c2c160f16521fe91f">isLoadExtLegal</a>(<a class="code" href="namespacellvm_1_1ISD.html#ad4d48171b87ca51ff54c10a436bac4d7a8d89c7da4444d9ec11667aa369abc5f7">ISD::ZEXTLOAD</a>, N0.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>()) &amp;&amp;</div><div class="line"><a name="l04877"></a><span class="lineno"> 4877</span>&#160;      (!LegalOperations &amp;&amp; TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a055b3905dbbc16fae11510b9ebd1e00c">isOperationLegal</a>(N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>(), VT))) {</div><div class="line"><a name="l04878"></a><span class="lineno"> 4878</span>&#160;    <a class="code" href="classllvm_1_1LoadSDNode.html">LoadSDNode</a> *LN0 = cast&lt;LoadSDNode&gt;(N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0));</div><div class="line"><a name="l04879"></a><span class="lineno"> 4879</span>&#160;    <span class="keywordflow">if</span> (LN0-&gt;<a class="code" href="classllvm_1_1LoadSDNode.html#af15fb8b2d4c9f295bdcf85a1eb506702">getExtensionType</a>() != <a class="code" href="namespacellvm_1_1ISD.html#ad4d48171b87ca51ff54c10a436bac4d7a6c61b6125c7901c549f90ee0e443a770">ISD::SEXTLOAD</a>) {</div><div class="line"><a name="l04880"></a><span class="lineno"> 4880</span>&#160;      <span class="keywordtype">bool</span> DoXform = <span class="keyword">true</span>;</div><div class="line"><a name="l04881"></a><span class="lineno"> 4881</span>&#160;      <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;SDNode*, 4&gt;</a> SetCCs;</div><div class="line"><a name="l04882"></a><span class="lineno"> 4882</span>&#160;      <span class="keywordflow">if</span> (!N0.<a class="code" href="classllvm_1_1SDValue.html#a97b0f24f3e52f030830fca6fbfcbd37d">hasOneUse</a>())</div><div class="line"><a name="l04883"></a><span class="lineno"> 4883</span>&#160;        DoXform = <a class="code" href="DAGCombiner_8cpp.html#a64f519aaefc431e6e9f2e15e921fb540">ExtendUsesToFormExtLoad</a>(N, N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0), <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a93fdf85eff945f1a668b4915a051453e">ISD::ZERO_EXTEND</a>,</div><div class="line"><a name="l04884"></a><span class="lineno"> 4884</span>&#160;                                          SetCCs, TLI);</div><div class="line"><a name="l04885"></a><span class="lineno"> 4885</span>&#160;      <span class="keywordflow">if</span> (DoXform) {</div><div class="line"><a name="l04886"></a><span class="lineno"> 4886</span>&#160;        <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> ExtLoad = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#ad6ff413bea6f8195d8e6f29f4fc519c4">getExtLoad</a>(<a class="code" href="namespacellvm_1_1ISD.html#ad4d48171b87ca51ff54c10a436bac4d7a8d89c7da4444d9ec11667aa369abc5f7">ISD::ZEXTLOAD</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(LN0), VT,</div><div class="line"><a name="l04887"></a><span class="lineno"> 4887</span>&#160;                                         LN0-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#ae3cb6fbf8c8cb79e10ac61bd98c85211">getChain</a>(), LN0-&gt;<a class="code" href="classllvm_1_1LoadSDNode.html#a3ded48ce66b58b7e7e143991df5dbfae">getBasePtr</a>(),</div><div class="line"><a name="l04888"></a><span class="lineno"> 4888</span>&#160;                                         LN0-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a7cead3a2a7771e61083bcc6959915a13">getMemoryVT</a>(),</div><div class="line"><a name="l04889"></a><span class="lineno"> 4889</span>&#160;                                         LN0-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a89e2b5e3fb867b4040f893c6ae3d2132">getMemOperand</a>());</div><div class="line"><a name="l04890"></a><span class="lineno"> 4890</span>&#160;        <a class="code" href="classllvm_1_1APInt.html">APInt</a> Mask = cast&lt;ConstantSDNode&gt;(N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1))-&gt;getAPIntValue();</div><div class="line"><a name="l04891"></a><span class="lineno"> 4891</span>&#160;        Mask = Mask.<a class="code" href="classllvm_1_1APInt.html#a6142fc5662411269a7ca0217f49f338c">zext</a>(VT.<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>());</div><div class="line"><a name="l04892"></a><span class="lineno"> 4892</span>&#160;        <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> <a class="code" href="namespacellvm_1_1APIntOps.html#a684cfe02c582e8d75cd6d457e63e6c25">And</a> = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>(), <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT,</div><div class="line"><a name="l04893"></a><span class="lineno"> 4893</span>&#160;                                  ExtLoad, DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(Mask, VT));</div><div class="line"><a name="l04894"></a><span class="lineno"> 4894</span>&#160;        <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Trunc = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ae690127648393001a7d5b93dc23da7b3">ISD::TRUNCATE</a>,</div><div class="line"><a name="l04895"></a><span class="lineno"> 4895</span>&#160;                                    <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0)),</div><div class="line"><a name="l04896"></a><span class="lineno"> 4896</span>&#160;                                    N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>(), ExtLoad);</div><div class="line"><a name="l04897"></a><span class="lineno"> 4897</span>&#160;        CombineTo(N, And);</div><div class="line"><a name="l04898"></a><span class="lineno"> 4898</span>&#160;        CombineTo(N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>(), Trunc, ExtLoad.<a class="code" href="classllvm_1_1SDValue.html#a040481b9bda32faa6b1435532405d88f">getValue</a>(1));</div><div class="line"><a name="l04899"></a><span class="lineno"> 4899</span>&#160;        ExtendSetCCUses(SetCCs, Trunc, ExtLoad, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N),</div><div class="line"><a name="l04900"></a><span class="lineno"> 4900</span>&#160;                        <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a93fdf85eff945f1a668b4915a051453e">ISD::ZERO_EXTEND</a>);</div><div class="line"><a name="l04901"></a><span class="lineno"> 4901</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(N, 0);   <span class="comment">// Return N so it doesn&#39;t get rechecked!</span></div><div class="line"><a name="l04902"></a><span class="lineno"> 4902</span>&#160;      }</div><div class="line"><a name="l04903"></a><span class="lineno"> 4903</span>&#160;    }</div><div class="line"><a name="l04904"></a><span class="lineno"> 4904</span>&#160;  }</div><div class="line"><a name="l04905"></a><span class="lineno"> 4905</span>&#160;</div><div class="line"><a name="l04906"></a><span class="lineno"> 4906</span>&#160;  <span class="comment">// fold (zext (zextload x)) -&gt; (zext (truncate (zextload x)))</span></div><div class="line"><a name="l04907"></a><span class="lineno"> 4907</span>&#160;  <span class="comment">// fold (zext ( extload x)) -&gt; (zext (truncate (zextload x)))</span></div><div class="line"><a name="l04908"></a><span class="lineno"> 4908</span>&#160;  <span class="keywordflow">if</span> ((<a class="code" href="namespacellvm_1_1ISD.html#a35edacef22fcaed7a8681fa573476131">ISD::isZEXTLoad</a>(N0.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()) || <a class="code" href="namespacellvm_1_1ISD.html#a910795e8d77c1545da0683c0e1cb81ee">ISD::isEXTLoad</a>(N0.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>())) &amp;&amp;</div><div class="line"><a name="l04909"></a><span class="lineno"> 4909</span>&#160;      <a class="code" href="namespacellvm_1_1ISD.html#a7da84980dd2ee06405d74303cfb90485">ISD::isUNINDEXEDLoad</a>(N0.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()) &amp;&amp; N0.<a class="code" href="classllvm_1_1SDValue.html#a97b0f24f3e52f030830fca6fbfcbd37d">hasOneUse</a>()) {</div><div class="line"><a name="l04910"></a><span class="lineno"> 4910</span>&#160;    <a class="code" href="classllvm_1_1LoadSDNode.html">LoadSDNode</a> *LN0 = cast&lt;LoadSDNode&gt;(N0);</div><div class="line"><a name="l04911"></a><span class="lineno"> 4911</span>&#160;    <a class="code" href="structllvm_1_1EVT.html">EVT</a> MemVT = LN0-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a7cead3a2a7771e61083bcc6959915a13">getMemoryVT</a>();</div><div class="line"><a name="l04912"></a><span class="lineno"> 4912</span>&#160;    <span class="keywordflow">if</span> ((!LegalOperations &amp;&amp; !LN0-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#acd3bb9ee2ec53fa4be1fdf155b0b5a17">isVolatile</a>()) ||</div><div class="line"><a name="l04913"></a><span class="lineno"> 4913</span>&#160;        TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#ad85f712b9e49629c2c160f16521fe91f">isLoadExtLegal</a>(<a class="code" href="namespacellvm_1_1ISD.html#ad4d48171b87ca51ff54c10a436bac4d7a8d89c7da4444d9ec11667aa369abc5f7">ISD::ZEXTLOAD</a>, MemVT)) {</div><div class="line"><a name="l04914"></a><span class="lineno"> 4914</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> ExtLoad = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#ad6ff413bea6f8195d8e6f29f4fc519c4">getExtLoad</a>(<a class="code" href="namespacellvm_1_1ISD.html#ad4d48171b87ca51ff54c10a436bac4d7a8d89c7da4444d9ec11667aa369abc5f7">ISD::ZEXTLOAD</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT,</div><div class="line"><a name="l04915"></a><span class="lineno"> 4915</span>&#160;                                       LN0-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#ae3cb6fbf8c8cb79e10ac61bd98c85211">getChain</a>(),</div><div class="line"><a name="l04916"></a><span class="lineno"> 4916</span>&#160;                                       LN0-&gt;<a class="code" href="classllvm_1_1LoadSDNode.html#a3ded48ce66b58b7e7e143991df5dbfae">getBasePtr</a>(), MemVT,</div><div class="line"><a name="l04917"></a><span class="lineno"> 4917</span>&#160;                                       LN0-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a89e2b5e3fb867b4040f893c6ae3d2132">getMemOperand</a>());</div><div class="line"><a name="l04918"></a><span class="lineno"> 4918</span>&#160;      CombineTo(N, ExtLoad);</div><div class="line"><a name="l04919"></a><span class="lineno"> 4919</span>&#160;      CombineTo(N0.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>(),</div><div class="line"><a name="l04920"></a><span class="lineno"> 4920</span>&#160;                DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ae690127648393001a7d5b93dc23da7b3">ISD::TRUNCATE</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N0), N0.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>(),</div><div class="line"><a name="l04921"></a><span class="lineno"> 4921</span>&#160;                            ExtLoad),</div><div class="line"><a name="l04922"></a><span class="lineno"> 4922</span>&#160;                ExtLoad.<a class="code" href="classllvm_1_1SDValue.html#a040481b9bda32faa6b1435532405d88f">getValue</a>(1));</div><div class="line"><a name="l04923"></a><span class="lineno"> 4923</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(N, 0);   <span class="comment">// Return N so it doesn&#39;t get rechecked!</span></div><div class="line"><a name="l04924"></a><span class="lineno"> 4924</span>&#160;    }</div><div class="line"><a name="l04925"></a><span class="lineno"> 4925</span>&#160;  }</div><div class="line"><a name="l04926"></a><span class="lineno"> 4926</span>&#160;</div><div class="line"><a name="l04927"></a><span class="lineno"> 4927</span>&#160;  <span class="keywordflow">if</span> (N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a0158ee47dfa868be5d28e2cbef70d5d0">ISD::SETCC</a>) {</div><div class="line"><a name="l04928"></a><span class="lineno"> 4928</span>&#160;    <span class="keywordflow">if</span> (!LegalOperations &amp;&amp; VT.<a class="code" href="structllvm_1_1EVT.html#a73f7c824cad61a47c21bf6d652ae2fd7">isVector</a>()) {</div><div class="line"><a name="l04929"></a><span class="lineno"> 4929</span>&#160;      <span class="comment">// zext(setcc) -&gt; (and (vsetcc), (1, 1, ...) for vectors.</span></div><div class="line"><a name="l04930"></a><span class="lineno"> 4930</span>&#160;      <span class="comment">// Only do this before legalize for now.</span></div><div class="line"><a name="l04931"></a><span class="lineno"> 4931</span>&#160;      <a class="code" href="structllvm_1_1EVT.html">EVT</a> N0VT = N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>();</div><div class="line"><a name="l04932"></a><span class="lineno"> 4932</span>&#160;      <a class="code" href="structllvm_1_1EVT.html">EVT</a> EltVT = VT.<a class="code" href="structllvm_1_1EVT.html#a3a07c062cc9330acd8e8c4e3930cbb25">getVectorElementType</a>();</div><div class="line"><a name="l04933"></a><span class="lineno"> 4933</span>&#160;      <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;SDValue,8&gt;</a> OneOps(VT.<a class="code" href="structllvm_1_1EVT.html#a42bca41d2438197c12b6db2c710a959c">getVectorNumElements</a>(),</div><div class="line"><a name="l04934"></a><span class="lineno"> 4934</span>&#160;                                    DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(1, EltVT));</div><div class="line"><a name="l04935"></a><span class="lineno"> 4935</span>&#160;      <span class="keywordflow">if</span> (VT.<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>() == N0VT.<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>())</div><div class="line"><a name="l04936"></a><span class="lineno"> 4936</span>&#160;        <span class="comment">// We know that the # elements of the results is the same as the</span></div><div class="line"><a name="l04937"></a><span class="lineno"> 4937</span>&#160;        <span class="comment">// # elements of the compare (and the # elements of the compare result</span></div><div class="line"><a name="l04938"></a><span class="lineno"> 4938</span>&#160;        <span class="comment">// for that matter).  Check to see that they are the same size.  If so,</span></div><div class="line"><a name="l04939"></a><span class="lineno"> 4939</span>&#160;        <span class="comment">// we know that the element size of the sext&#39;d result matches the</span></div><div class="line"><a name="l04940"></a><span class="lineno"> 4940</span>&#160;        <span class="comment">// element size of the compare operands.</span></div><div class="line"><a name="l04941"></a><span class="lineno"> 4941</span>&#160;        <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ac513a7da1bf74fb3e3c594da8534f2d2">ISD::AND</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT,</div><div class="line"><a name="l04942"></a><span class="lineno"> 4942</span>&#160;                           DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a2650d530046f9ddfc602dc7383ba0730">getSetCC</a>(<a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0),</div><div class="line"><a name="l04943"></a><span class="lineno"> 4943</span>&#160;                                         N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1),</div><div class="line"><a name="l04944"></a><span class="lineno"> 4944</span>&#160;                                 cast&lt;CondCodeSDNode&gt;(N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(2))-&gt;<span class="keyword">get</span>()),</div><div class="line"><a name="l04945"></a><span class="lineno"> 4945</span>&#160;                           DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110aff6f73b624fecca7dbe94259f9437e32">ISD::BUILD_VECTOR</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT,</div><div class="line"><a name="l04946"></a><span class="lineno"> 4946</span>&#160;                                       &amp;OneOps[0], OneOps.size()));</div><div class="line"><a name="l04947"></a><span class="lineno"> 4947</span>&#160;</div><div class="line"><a name="l04948"></a><span class="lineno"> 4948</span>&#160;      <span class="comment">// If the desired elements are smaller or larger than the source</span></div><div class="line"><a name="l04949"></a><span class="lineno"> 4949</span>&#160;      <span class="comment">// elements we can use a matching integer vector type and then</span></div><div class="line"><a name="l04950"></a><span class="lineno"> 4950</span>&#160;      <span class="comment">// truncate/sign extend</span></div><div class="line"><a name="l04951"></a><span class="lineno"> 4951</span>&#160;      <a class="code" href="structllvm_1_1EVT.html">EVT</a> MatchingElementType =</div><div class="line"><a name="l04952"></a><span class="lineno"> 4952</span>&#160;        <a class="code" href="structllvm_1_1EVT.html#a752372e170e4e7c595bf8810bb52adf2">EVT::getIntegerVT</a>(*DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a39c6dff47b8dbd25cfaf6336c7056077">getContext</a>(),</div><div class="line"><a name="l04953"></a><span class="lineno"> 4953</span>&#160;                          N0VT.<a class="code" href="structllvm_1_1EVT.html#a15be9767d0aad93fe5dcb60b7b7a78da">getScalarType</a>().<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>());</div><div class="line"><a name="l04954"></a><span class="lineno"> 4954</span>&#160;      <a class="code" href="structllvm_1_1EVT.html">EVT</a> MatchingVectorType =</div><div class="line"><a name="l04955"></a><span class="lineno"> 4955</span>&#160;        <a class="code" href="structllvm_1_1EVT.html#a18c2edf1939f6e87f1e586b815f398cd">EVT::getVectorVT</a>(*DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a39c6dff47b8dbd25cfaf6336c7056077">getContext</a>(), MatchingElementType,</div><div class="line"><a name="l04956"></a><span class="lineno"> 4956</span>&#160;                         N0VT.<a class="code" href="structllvm_1_1EVT.html#a42bca41d2438197c12b6db2c710a959c">getVectorNumElements</a>());</div><div class="line"><a name="l04957"></a><span class="lineno"> 4957</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> VsetCC =</div><div class="line"><a name="l04958"></a><span class="lineno"> 4958</span>&#160;        DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a2650d530046f9ddfc602dc7383ba0730">getSetCC</a>(<a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), MatchingVectorType, N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0),</div><div class="line"><a name="l04959"></a><span class="lineno"> 4959</span>&#160;                      N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1),</div><div class="line"><a name="l04960"></a><span class="lineno"> 4960</span>&#160;                      cast&lt;CondCodeSDNode&gt;(N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(2))-&gt;<span class="keyword">get</span>());</div><div class="line"><a name="l04961"></a><span class="lineno"> 4961</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ac513a7da1bf74fb3e3c594da8534f2d2">ISD::AND</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT,</div><div class="line"><a name="l04962"></a><span class="lineno"> 4962</span>&#160;                         DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a4c2e9947586d4e88ad61174b796a40d1">getSExtOrTrunc</a>(VsetCC, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT),</div><div class="line"><a name="l04963"></a><span class="lineno"> 4963</span>&#160;                         DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110aff6f73b624fecca7dbe94259f9437e32">ISD::BUILD_VECTOR</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT,</div><div class="line"><a name="l04964"></a><span class="lineno"> 4964</span>&#160;                                     &amp;OneOps[0], OneOps.size()));</div><div class="line"><a name="l04965"></a><span class="lineno"> 4965</span>&#160;    }</div><div class="line"><a name="l04966"></a><span class="lineno"> 4966</span>&#160;</div><div class="line"><a name="l04967"></a><span class="lineno"> 4967</span>&#160;    <span class="comment">// zext(setcc x,y,cc) -&gt; select_cc x, y, 1, 0, cc</span></div><div class="line"><a name="l04968"></a><span class="lineno"> 4968</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> SCC =</div><div class="line"><a name="l04969"></a><span class="lineno"> 4969</span>&#160;      SimplifySelectCC(<a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0), N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1),</div><div class="line"><a name="l04970"></a><span class="lineno"> 4970</span>&#160;                       DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(1, VT), DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(0, VT),</div><div class="line"><a name="l04971"></a><span class="lineno"> 4971</span>&#160;                       cast&lt;CondCodeSDNode&gt;(N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(2))-&gt;<span class="keyword">get</span>(), <span class="keyword">true</span>);</div><div class="line"><a name="l04972"></a><span class="lineno"> 4972</span>&#160;    <span class="keywordflow">if</span> (SCC.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()) <span class="keywordflow">return</span> SCC;</div><div class="line"><a name="l04973"></a><span class="lineno"> 4973</span>&#160;  }</div><div class="line"><a name="l04974"></a><span class="lineno"> 4974</span>&#160;</div><div class="line"><a name="l04975"></a><span class="lineno"> 4975</span>&#160;  <span class="comment">// (zext (shl (zext x), cst)) -&gt; (shl (zext x), cst)</span></div><div class="line"><a name="l04976"></a><span class="lineno"> 4976</span>&#160;  <span class="keywordflow">if</span> ((N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a8cc94e03dea594863073a02f5bb94997">ISD::SHL</a> || N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a3c6553c8acebe1b57c211ee45e2d8f98">ISD::SRL</a>) &amp;&amp;</div><div class="line"><a name="l04977"></a><span class="lineno"> 4977</span>&#160;      isa&lt;ConstantSDNode&gt;(N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1)) &amp;&amp;</div><div class="line"><a name="l04978"></a><span class="lineno"> 4978</span>&#160;      N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a93fdf85eff945f1a668b4915a051453e">ISD::ZERO_EXTEND</a> &amp;&amp;</div><div class="line"><a name="l04979"></a><span class="lineno"> 4979</span>&#160;      N0.<a class="code" href="classllvm_1_1SDValue.html#a97b0f24f3e52f030830fca6fbfcbd37d">hasOneUse</a>()) {</div><div class="line"><a name="l04980"></a><span class="lineno"> 4980</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> ShAmt = N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1);</div><div class="line"><a name="l04981"></a><span class="lineno"> 4981</span>&#160;    <span class="keywordtype">unsigned</span> ShAmtVal = cast&lt;ConstantSDNode&gt;(ShAmt)-&gt;getZExtValue();</div><div class="line"><a name="l04982"></a><span class="lineno"> 4982</span>&#160;    <span class="keywordflow">if</span> (N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a8cc94e03dea594863073a02f5bb94997">ISD::SHL</a>) {</div><div class="line"><a name="l04983"></a><span class="lineno"> 4983</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> InnerZExt = N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0);</div><div class="line"><a name="l04984"></a><span class="lineno"> 4984</span>&#160;      <span class="comment">// If the original shl may be shifting out bits, do not perform this</span></div><div class="line"><a name="l04985"></a><span class="lineno"> 4985</span>&#160;      <span class="comment">// transformation.</span></div><div class="line"><a name="l04986"></a><span class="lineno"> 4986</span>&#160;      <span class="keywordtype">unsigned</span> KnownZeroBits = InnerZExt.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>().<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>() -</div><div class="line"><a name="l04987"></a><span class="lineno"> 4987</span>&#160;        InnerZExt.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>().<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>();</div><div class="line"><a name="l04988"></a><span class="lineno"> 4988</span>&#160;      <span class="keywordflow">if</span> (ShAmtVal &gt; KnownZeroBits)</div><div class="line"><a name="l04989"></a><span class="lineno"> 4989</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l04990"></a><span class="lineno"> 4990</span>&#160;    }</div><div class="line"><a name="l04991"></a><span class="lineno"> 4991</span>&#160;</div><div class="line"><a name="l04992"></a><span class="lineno"> 4992</span>&#160;    <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a> DL(N);</div><div class="line"><a name="l04993"></a><span class="lineno"> 4993</span>&#160;</div><div class="line"><a name="l04994"></a><span class="lineno"> 4994</span>&#160;    <span class="comment">// Ensure that the shift amount is wide enough for the shifted value.</span></div><div class="line"><a name="l04995"></a><span class="lineno"> 4995</span>&#160;    <span class="keywordflow">if</span> (VT.<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>() &gt;= 256)</div><div class="line"><a name="l04996"></a><span class="lineno"> 4996</span>&#160;      ShAmt = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a93fdf85eff945f1a668b4915a051453e">ISD::ZERO_EXTEND</a>, DL, <a class="code" href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50ca04cca8bc12888d0a7238f55a6c550ad0">MVT::i32</a>, ShAmt);</div><div class="line"><a name="l04997"></a><span class="lineno"> 4997</span>&#160;</div><div class="line"><a name="l04998"></a><span class="lineno"> 4998</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>(), DL, VT,</div><div class="line"><a name="l04999"></a><span class="lineno"> 4999</span>&#160;                       DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a93fdf85eff945f1a668b4915a051453e">ISD::ZERO_EXTEND</a>, DL, VT, N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0)),</div><div class="line"><a name="l05000"></a><span class="lineno"> 5000</span>&#160;                       ShAmt);</div><div class="line"><a name="l05001"></a><span class="lineno"> 5001</span>&#160;  }</div><div class="line"><a name="l05002"></a><span class="lineno"> 5002</span>&#160;</div><div class="line"><a name="l05003"></a><span class="lineno"> 5003</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l05004"></a><span class="lineno"> 5004</span>&#160;}</div><div class="line"><a name="l05005"></a><span class="lineno"> 5005</span>&#160;</div><div class="line"><a name="l05006"></a><span class="lineno"> 5006</span>&#160;<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::visitANY_EXTEND(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N) {</div><div class="line"><a name="l05007"></a><span class="lineno"> 5007</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N0 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0);</div><div class="line"><a name="l05008"></a><span class="lineno"> 5008</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> VT = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(0);</div><div class="line"><a name="l05009"></a><span class="lineno"> 5009</span>&#160;</div><div class="line"><a name="l05010"></a><span class="lineno"> 5010</span>&#160;  <span class="comment">// fold (aext c1) -&gt; c1</span></div><div class="line"><a name="l05011"></a><span class="lineno"> 5011</span>&#160;  <span class="keywordflow">if</span> (isa&lt;ConstantSDNode&gt;(N0))</div><div class="line"><a name="l05012"></a><span class="lineno"> 5012</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a27d5d8ef82302b739ba3ca8be1a5513d">ISD::ANY_EXTEND</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N0);</div><div class="line"><a name="l05013"></a><span class="lineno"> 5013</span>&#160;  <span class="comment">// fold (aext (aext x)) -&gt; (aext x)</span></div><div class="line"><a name="l05014"></a><span class="lineno"> 5014</span>&#160;  <span class="comment">// fold (aext (zext x)) -&gt; (zext x)</span></div><div class="line"><a name="l05015"></a><span class="lineno"> 5015</span>&#160;  <span class="comment">// fold (aext (sext x)) -&gt; (sext x)</span></div><div class="line"><a name="l05016"></a><span class="lineno"> 5016</span>&#160;  <span class="keywordflow">if</span> (N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a27d5d8ef82302b739ba3ca8be1a5513d">ISD::ANY_EXTEND</a>  ||</div><div class="line"><a name="l05017"></a><span class="lineno"> 5017</span>&#160;      N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a93fdf85eff945f1a668b4915a051453e">ISD::ZERO_EXTEND</a> ||</div><div class="line"><a name="l05018"></a><span class="lineno"> 5018</span>&#160;      N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a5183f3d72924bc7c77ba8d3f5de9f602">ISD::SIGN_EXTEND</a>)</div><div class="line"><a name="l05019"></a><span class="lineno"> 5019</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>(), <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0));</div><div class="line"><a name="l05020"></a><span class="lineno"> 5020</span>&#160;</div><div class="line"><a name="l05021"></a><span class="lineno"> 5021</span>&#160;  <span class="comment">// fold (aext (truncate (load x))) -&gt; (aext (smaller load x))</span></div><div class="line"><a name="l05022"></a><span class="lineno"> 5022</span>&#160;  <span class="comment">// fold (aext (truncate (srl (load x), c))) -&gt; (aext (small load (x+c/n)))</span></div><div class="line"><a name="l05023"></a><span class="lineno"> 5023</span>&#160;  <span class="keywordflow">if</span> (N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ae690127648393001a7d5b93dc23da7b3">ISD::TRUNCATE</a>) {</div><div class="line"><a name="l05024"></a><span class="lineno"> 5024</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> NarrowLoad = ReduceLoadWidth(N0.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l05025"></a><span class="lineno"> 5025</span>&#160;    <span class="keywordflow">if</span> (NarrowLoad.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()) {</div><div class="line"><a name="l05026"></a><span class="lineno"> 5026</span>&#160;      <a class="code" href="classllvm_1_1SDNode.html">SDNode</a>* oye = N0.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>();</div><div class="line"><a name="l05027"></a><span class="lineno"> 5027</span>&#160;      <span class="keywordflow">if</span> (NarrowLoad.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>() != N0.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()) {</div><div class="line"><a name="l05028"></a><span class="lineno"> 5028</span>&#160;        CombineTo(N0.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>(), NarrowLoad);</div><div class="line"><a name="l05029"></a><span class="lineno"> 5029</span>&#160;        <span class="comment">// CombineTo deleted the truncate, if needed, but not what&#39;s under it.</span></div><div class="line"><a name="l05030"></a><span class="lineno"> 5030</span>&#160;        AddToWorkList(oye);</div><div class="line"><a name="l05031"></a><span class="lineno"> 5031</span>&#160;      }</div><div class="line"><a name="l05032"></a><span class="lineno"> 5032</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(N, 0);   <span class="comment">// Return N so it doesn&#39;t get rechecked!</span></div><div class="line"><a name="l05033"></a><span class="lineno"> 5033</span>&#160;    }</div><div class="line"><a name="l05034"></a><span class="lineno"> 5034</span>&#160;  }</div><div class="line"><a name="l05035"></a><span class="lineno"> 5035</span>&#160;</div><div class="line"><a name="l05036"></a><span class="lineno"> 5036</span>&#160;  <span class="comment">// fold (aext (truncate x))</span></div><div class="line"><a name="l05037"></a><span class="lineno"> 5037</span>&#160;  <span class="keywordflow">if</span> (N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ae690127648393001a7d5b93dc23da7b3">ISD::TRUNCATE</a>) {</div><div class="line"><a name="l05038"></a><span class="lineno"> 5038</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> TruncOp = N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0);</div><div class="line"><a name="l05039"></a><span class="lineno"> 5039</span>&#160;    <span class="keywordflow">if</span> (TruncOp.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>() == VT)</div><div class="line"><a name="l05040"></a><span class="lineno"> 5040</span>&#160;      <span class="keywordflow">return</span> TruncOp; <span class="comment">// x iff x size == zext size.</span></div><div class="line"><a name="l05041"></a><span class="lineno"> 5041</span>&#160;    <span class="keywordflow">if</span> (TruncOp.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>().<a class="code" href="structllvm_1_1EVT.html#ac267a86695d58fe541ef96f8c60c1b0f">bitsGT</a>(VT))</div><div class="line"><a name="l05042"></a><span class="lineno"> 5042</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ae690127648393001a7d5b93dc23da7b3">ISD::TRUNCATE</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, TruncOp);</div><div class="line"><a name="l05043"></a><span class="lineno"> 5043</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a27d5d8ef82302b739ba3ca8be1a5513d">ISD::ANY_EXTEND</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, TruncOp);</div><div class="line"><a name="l05044"></a><span class="lineno"> 5044</span>&#160;  }</div><div class="line"><a name="l05045"></a><span class="lineno"> 5045</span>&#160;</div><div class="line"><a name="l05046"></a><span class="lineno"> 5046</span>&#160;  <span class="comment">// Fold (aext (and (trunc x), cst)) -&gt; (and x, cst)</span></div><div class="line"><a name="l05047"></a><span class="lineno"> 5047</span>&#160;  <span class="comment">// if the trunc is not free.</span></div><div class="line"><a name="l05048"></a><span class="lineno"> 5048</span>&#160;  <span class="keywordflow">if</span> (N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ac513a7da1bf74fb3e3c594da8534f2d2">ISD::AND</a> &amp;&amp;</div><div class="line"><a name="l05049"></a><span class="lineno"> 5049</span>&#160;      N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ae690127648393001a7d5b93dc23da7b3">ISD::TRUNCATE</a> &amp;&amp;</div><div class="line"><a name="l05050"></a><span class="lineno"> 5050</span>&#160;      N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1).<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110aac2f0a84dd2aa5ee4c3f1385e9565f5e">ISD::Constant</a> &amp;&amp;</div><div class="line"><a name="l05051"></a><span class="lineno"> 5051</span>&#160;      !TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a00856c52a5a67b38d8332c7842429153">isTruncateFree</a>(N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>(),</div><div class="line"><a name="l05052"></a><span class="lineno"> 5052</span>&#160;                          N0.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>())) {</div><div class="line"><a name="l05053"></a><span class="lineno"> 5053</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> <a class="code" href="namespacellvm.html#a6569d00d31a5d74e563e2f39f82271ab">X</a> = N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0);</div><div class="line"><a name="l05054"></a><span class="lineno"> 5054</span>&#160;    <span class="keywordflow">if</span> (X.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>().<a class="code" href="structllvm_1_1EVT.html#a5ebe5227fe53e0dcf4102a6ebf1594a2">bitsLT</a>(VT)) {</div><div class="line"><a name="l05055"></a><span class="lineno"> 5055</span>&#160;      X = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a27d5d8ef82302b739ba3ca8be1a5513d">ISD::ANY_EXTEND</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, X);</div><div class="line"><a name="l05056"></a><span class="lineno"> 5056</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (X.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>().<a class="code" href="structllvm_1_1EVT.html#ac267a86695d58fe541ef96f8c60c1b0f">bitsGT</a>(VT)) {</div><div class="line"><a name="l05057"></a><span class="lineno"> 5057</span>&#160;      X = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ae690127648393001a7d5b93dc23da7b3">ISD::TRUNCATE</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, X);</div><div class="line"><a name="l05058"></a><span class="lineno"> 5058</span>&#160;    }</div><div class="line"><a name="l05059"></a><span class="lineno"> 5059</span>&#160;    <a class="code" href="classllvm_1_1APInt.html">APInt</a> Mask = cast&lt;ConstantSDNode&gt;(N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1))-&gt;getAPIntValue();</div><div class="line"><a name="l05060"></a><span class="lineno"> 5060</span>&#160;    Mask = Mask.<a class="code" href="classllvm_1_1APInt.html#a6142fc5662411269a7ca0217f49f338c">zext</a>(VT.<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>());</div><div class="line"><a name="l05061"></a><span class="lineno"> 5061</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ac513a7da1bf74fb3e3c594da8534f2d2">ISD::AND</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT,</div><div class="line"><a name="l05062"></a><span class="lineno"> 5062</span>&#160;                       X, DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(Mask, VT));</div><div class="line"><a name="l05063"></a><span class="lineno"> 5063</span>&#160;  }</div><div class="line"><a name="l05064"></a><span class="lineno"> 5064</span>&#160;</div><div class="line"><a name="l05065"></a><span class="lineno"> 5065</span>&#160;  <span class="comment">// fold (aext (load x)) -&gt; (aext (truncate (extload x)))</span></div><div class="line"><a name="l05066"></a><span class="lineno"> 5066</span>&#160;  <span class="comment">// None of the supported targets knows how to perform load and any_ext</span></div><div class="line"><a name="l05067"></a><span class="lineno"> 5067</span>&#160;  <span class="comment">// on vectors in one instruction.  We only perform this transformation on</span></div><div class="line"><a name="l05068"></a><span class="lineno"> 5068</span>&#160;  <span class="comment">// scalars.</span></div><div class="line"><a name="l05069"></a><span class="lineno"> 5069</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1ISD.html#a15623094a1ed0cd7163dc786e44c87c9">ISD::isNON_EXTLoad</a>(N0.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()) &amp;&amp; !VT.<a class="code" href="structllvm_1_1EVT.html#a73f7c824cad61a47c21bf6d652ae2fd7">isVector</a>() &amp;&amp;</div><div class="line"><a name="l05070"></a><span class="lineno"> 5070</span>&#160;      ((!LegalOperations &amp;&amp; !cast&lt;LoadSDNode&gt;(N0)-&gt;isVolatile()) ||</div><div class="line"><a name="l05071"></a><span class="lineno"> 5071</span>&#160;       TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#ad85f712b9e49629c2c160f16521fe91f">isLoadExtLegal</a>(<a class="code" href="namespacellvm_1_1ISD.html#ad4d48171b87ca51ff54c10a436bac4d7afab3fffd153f7d7770fed81272e4b78f">ISD::EXTLOAD</a>, N0.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>()))) {</div><div class="line"><a name="l05072"></a><span class="lineno"> 5072</span>&#160;    <span class="keywordtype">bool</span> DoXform = <span class="keyword">true</span>;</div><div class="line"><a name="l05073"></a><span class="lineno"> 5073</span>&#160;    <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;SDNode*, 4&gt;</a> SetCCs;</div><div class="line"><a name="l05074"></a><span class="lineno"> 5074</span>&#160;    <span class="keywordflow">if</span> (!N0.<a class="code" href="classllvm_1_1SDValue.html#a97b0f24f3e52f030830fca6fbfcbd37d">hasOneUse</a>())</div><div class="line"><a name="l05075"></a><span class="lineno"> 5075</span>&#160;      DoXform = <a class="code" href="DAGCombiner_8cpp.html#a64f519aaefc431e6e9f2e15e921fb540">ExtendUsesToFormExtLoad</a>(N, N0, <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a27d5d8ef82302b739ba3ca8be1a5513d">ISD::ANY_EXTEND</a>, SetCCs, TLI);</div><div class="line"><a name="l05076"></a><span class="lineno"> 5076</span>&#160;    <span class="keywordflow">if</span> (DoXform) {</div><div class="line"><a name="l05077"></a><span class="lineno"> 5077</span>&#160;      <a class="code" href="classllvm_1_1LoadSDNode.html">LoadSDNode</a> *LN0 = cast&lt;LoadSDNode&gt;(N0);</div><div class="line"><a name="l05078"></a><span class="lineno"> 5078</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> ExtLoad = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#ad6ff413bea6f8195d8e6f29f4fc519c4">getExtLoad</a>(<a class="code" href="namespacellvm_1_1ISD.html#ad4d48171b87ca51ff54c10a436bac4d7afab3fffd153f7d7770fed81272e4b78f">ISD::EXTLOAD</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT,</div><div class="line"><a name="l05079"></a><span class="lineno"> 5079</span>&#160;                                       LN0-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#ae3cb6fbf8c8cb79e10ac61bd98c85211">getChain</a>(),</div><div class="line"><a name="l05080"></a><span class="lineno"> 5080</span>&#160;                                       LN0-&gt;<a class="code" href="classllvm_1_1LoadSDNode.html#a3ded48ce66b58b7e7e143991df5dbfae">getBasePtr</a>(), N0.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>(),</div><div class="line"><a name="l05081"></a><span class="lineno"> 5081</span>&#160;                                       LN0-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a89e2b5e3fb867b4040f893c6ae3d2132">getMemOperand</a>());</div><div class="line"><a name="l05082"></a><span class="lineno"> 5082</span>&#160;      CombineTo(N, ExtLoad);</div><div class="line"><a name="l05083"></a><span class="lineno"> 5083</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Trunc = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ae690127648393001a7d5b93dc23da7b3">ISD::TRUNCATE</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N0),</div><div class="line"><a name="l05084"></a><span class="lineno"> 5084</span>&#160;                                  N0.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>(), ExtLoad);</div><div class="line"><a name="l05085"></a><span class="lineno"> 5085</span>&#160;      CombineTo(N0.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>(), Trunc, ExtLoad.<a class="code" href="classllvm_1_1SDValue.html#a040481b9bda32faa6b1435532405d88f">getValue</a>(1));</div><div class="line"><a name="l05086"></a><span class="lineno"> 5086</span>&#160;      ExtendSetCCUses(SetCCs, Trunc, ExtLoad, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N),</div><div class="line"><a name="l05087"></a><span class="lineno"> 5087</span>&#160;                      <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a27d5d8ef82302b739ba3ca8be1a5513d">ISD::ANY_EXTEND</a>);</div><div class="line"><a name="l05088"></a><span class="lineno"> 5088</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(N, 0);   <span class="comment">// Return N so it doesn&#39;t get rechecked!</span></div><div class="line"><a name="l05089"></a><span class="lineno"> 5089</span>&#160;    }</div><div class="line"><a name="l05090"></a><span class="lineno"> 5090</span>&#160;  }</div><div class="line"><a name="l05091"></a><span class="lineno"> 5091</span>&#160;</div><div class="line"><a name="l05092"></a><span class="lineno"> 5092</span>&#160;  <span class="comment">// fold (aext (zextload x)) -&gt; (aext (truncate (zextload x)))</span></div><div class="line"><a name="l05093"></a><span class="lineno"> 5093</span>&#160;  <span class="comment">// fold (aext (sextload x)) -&gt; (aext (truncate (sextload x)))</span></div><div class="line"><a name="l05094"></a><span class="lineno"> 5094</span>&#160;  <span class="comment">// fold (aext ( extload x)) -&gt; (aext (truncate (extload  x)))</span></div><div class="line"><a name="l05095"></a><span class="lineno"> 5095</span>&#160;  <span class="keywordflow">if</span> (N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a269b81f007000306e3e69d0d290c2159">ISD::LOAD</a> &amp;&amp;</div><div class="line"><a name="l05096"></a><span class="lineno"> 5096</span>&#160;      !<a class="code" href="namespacellvm_1_1ISD.html#a15623094a1ed0cd7163dc786e44c87c9">ISD::isNON_EXTLoad</a>(N0.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()) &amp;&amp; <a class="code" href="namespacellvm_1_1ISD.html#a7da84980dd2ee06405d74303cfb90485">ISD::isUNINDEXEDLoad</a>(N0.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()) &amp;&amp;</div><div class="line"><a name="l05097"></a><span class="lineno"> 5097</span>&#160;      N0.<a class="code" href="classllvm_1_1SDValue.html#a97b0f24f3e52f030830fca6fbfcbd37d">hasOneUse</a>()) {</div><div class="line"><a name="l05098"></a><span class="lineno"> 5098</span>&#160;    <a class="code" href="classllvm_1_1LoadSDNode.html">LoadSDNode</a> *LN0 = cast&lt;LoadSDNode&gt;(N0);</div><div class="line"><a name="l05099"></a><span class="lineno"> 5099</span>&#160;    <a class="code" href="structllvm_1_1EVT.html">EVT</a> MemVT = LN0-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a7cead3a2a7771e61083bcc6959915a13">getMemoryVT</a>();</div><div class="line"><a name="l05100"></a><span class="lineno"> 5100</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> ExtLoad = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#ad6ff413bea6f8195d8e6f29f4fc519c4">getExtLoad</a>(LN0-&gt;<a class="code" href="classllvm_1_1LoadSDNode.html#af15fb8b2d4c9f295bdcf85a1eb506702">getExtensionType</a>(), <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N),</div><div class="line"><a name="l05101"></a><span class="lineno"> 5101</span>&#160;                                     VT, LN0-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#ae3cb6fbf8c8cb79e10ac61bd98c85211">getChain</a>(), LN0-&gt;<a class="code" href="classllvm_1_1LoadSDNode.html#a3ded48ce66b58b7e7e143991df5dbfae">getBasePtr</a>(),</div><div class="line"><a name="l05102"></a><span class="lineno"> 5102</span>&#160;                                     MemVT, LN0-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a89e2b5e3fb867b4040f893c6ae3d2132">getMemOperand</a>());</div><div class="line"><a name="l05103"></a><span class="lineno"> 5103</span>&#160;    CombineTo(N, ExtLoad);</div><div class="line"><a name="l05104"></a><span class="lineno"> 5104</span>&#160;    CombineTo(N0.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>(),</div><div class="line"><a name="l05105"></a><span class="lineno"> 5105</span>&#160;              DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ae690127648393001a7d5b93dc23da7b3">ISD::TRUNCATE</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N0),</div><div class="line"><a name="l05106"></a><span class="lineno"> 5106</span>&#160;                          N0.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>(), ExtLoad),</div><div class="line"><a name="l05107"></a><span class="lineno"> 5107</span>&#160;              ExtLoad.<a class="code" href="classllvm_1_1SDValue.html#a040481b9bda32faa6b1435532405d88f">getValue</a>(1));</div><div class="line"><a name="l05108"></a><span class="lineno"> 5108</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(N, 0);   <span class="comment">// Return N so it doesn&#39;t get rechecked!</span></div><div class="line"><a name="l05109"></a><span class="lineno"> 5109</span>&#160;  }</div><div class="line"><a name="l05110"></a><span class="lineno"> 5110</span>&#160;</div><div class="line"><a name="l05111"></a><span class="lineno"> 5111</span>&#160;  <span class="keywordflow">if</span> (N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a0158ee47dfa868be5d28e2cbef70d5d0">ISD::SETCC</a>) {</div><div class="line"><a name="l05112"></a><span class="lineno"> 5112</span>&#160;    <span class="comment">// aext(setcc) -&gt; sext_in_reg(vsetcc) for vectors.</span></div><div class="line"><a name="l05113"></a><span class="lineno"> 5113</span>&#160;    <span class="comment">// Only do this before legalize for now.</span></div><div class="line"><a name="l05114"></a><span class="lineno"> 5114</span>&#160;    <span class="keywordflow">if</span> (VT.<a class="code" href="structllvm_1_1EVT.html#a73f7c824cad61a47c21bf6d652ae2fd7">isVector</a>() &amp;&amp; !LegalOperations) {</div><div class="line"><a name="l05115"></a><span class="lineno"> 5115</span>&#160;      <a class="code" href="structllvm_1_1EVT.html">EVT</a> N0VT = N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>();</div><div class="line"><a name="l05116"></a><span class="lineno"> 5116</span>&#160;        <span class="comment">// We know that the # elements of the results is the same as the</span></div><div class="line"><a name="l05117"></a><span class="lineno"> 5117</span>&#160;        <span class="comment">// # elements of the compare (and the # elements of the compare result</span></div><div class="line"><a name="l05118"></a><span class="lineno"> 5118</span>&#160;        <span class="comment">// for that matter).  Check to see that they are the same size.  If so,</span></div><div class="line"><a name="l05119"></a><span class="lineno"> 5119</span>&#160;        <span class="comment">// we know that the element size of the sext&#39;d result matches the</span></div><div class="line"><a name="l05120"></a><span class="lineno"> 5120</span>&#160;        <span class="comment">// element size of the compare operands.</span></div><div class="line"><a name="l05121"></a><span class="lineno"> 5121</span>&#160;      <span class="keywordflow">if</span> (VT.<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>() == N0VT.<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>())</div><div class="line"><a name="l05122"></a><span class="lineno"> 5122</span>&#160;        <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a2650d530046f9ddfc602dc7383ba0730">getSetCC</a>(<a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0),</div><div class="line"><a name="l05123"></a><span class="lineno"> 5123</span>&#160;                             N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1),</div><div class="line"><a name="l05124"></a><span class="lineno"> 5124</span>&#160;                             cast&lt;CondCodeSDNode&gt;(N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(2))-&gt;<span class="keyword">get</span>());</div><div class="line"><a name="l05125"></a><span class="lineno"> 5125</span>&#160;      <span class="comment">// If the desired elements are smaller or larger than the source</span></div><div class="line"><a name="l05126"></a><span class="lineno"> 5126</span>&#160;      <span class="comment">// elements we can use a matching integer vector type and then</span></div><div class="line"><a name="l05127"></a><span class="lineno"> 5127</span>&#160;      <span class="comment">// truncate/sign extend</span></div><div class="line"><a name="l05128"></a><span class="lineno"> 5128</span>&#160;      <span class="keywordflow">else</span> {</div><div class="line"><a name="l05129"></a><span class="lineno"> 5129</span>&#160;        <a class="code" href="structllvm_1_1EVT.html">EVT</a> MatchingElementType =</div><div class="line"><a name="l05130"></a><span class="lineno"> 5130</span>&#160;          <a class="code" href="structllvm_1_1EVT.html#a752372e170e4e7c595bf8810bb52adf2">EVT::getIntegerVT</a>(*DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a39c6dff47b8dbd25cfaf6336c7056077">getContext</a>(),</div><div class="line"><a name="l05131"></a><span class="lineno"> 5131</span>&#160;                            N0VT.<a class="code" href="structllvm_1_1EVT.html#a15be9767d0aad93fe5dcb60b7b7a78da">getScalarType</a>().<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>());</div><div class="line"><a name="l05132"></a><span class="lineno"> 5132</span>&#160;        <a class="code" href="structllvm_1_1EVT.html">EVT</a> MatchingVectorType =</div><div class="line"><a name="l05133"></a><span class="lineno"> 5133</span>&#160;          <a class="code" href="structllvm_1_1EVT.html#a18c2edf1939f6e87f1e586b815f398cd">EVT::getVectorVT</a>(*DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a39c6dff47b8dbd25cfaf6336c7056077">getContext</a>(), MatchingElementType,</div><div class="line"><a name="l05134"></a><span class="lineno"> 5134</span>&#160;                           N0VT.<a class="code" href="structllvm_1_1EVT.html#a42bca41d2438197c12b6db2c710a959c">getVectorNumElements</a>());</div><div class="line"><a name="l05135"></a><span class="lineno"> 5135</span>&#160;        <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> VsetCC =</div><div class="line"><a name="l05136"></a><span class="lineno"> 5136</span>&#160;          DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a2650d530046f9ddfc602dc7383ba0730">getSetCC</a>(<a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), MatchingVectorType, N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0),</div><div class="line"><a name="l05137"></a><span class="lineno"> 5137</span>&#160;                        N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1),</div><div class="line"><a name="l05138"></a><span class="lineno"> 5138</span>&#160;                        cast&lt;CondCodeSDNode&gt;(N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(2))-&gt;<span class="keyword">get</span>());</div><div class="line"><a name="l05139"></a><span class="lineno"> 5139</span>&#160;        <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a4c2e9947586d4e88ad61174b796a40d1">getSExtOrTrunc</a>(VsetCC, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT);</div><div class="line"><a name="l05140"></a><span class="lineno"> 5140</span>&#160;      }</div><div class="line"><a name="l05141"></a><span class="lineno"> 5141</span>&#160;    }</div><div class="line"><a name="l05142"></a><span class="lineno"> 5142</span>&#160;</div><div class="line"><a name="l05143"></a><span class="lineno"> 5143</span>&#160;    <span class="comment">// aext(setcc x,y,cc) -&gt; select_cc x, y, 1, 0, cc</span></div><div class="line"><a name="l05144"></a><span class="lineno"> 5144</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> SCC =</div><div class="line"><a name="l05145"></a><span class="lineno"> 5145</span>&#160;      SimplifySelectCC(<a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0), N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1),</div><div class="line"><a name="l05146"></a><span class="lineno"> 5146</span>&#160;                       DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(1, VT), DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(0, VT),</div><div class="line"><a name="l05147"></a><span class="lineno"> 5147</span>&#160;                       cast&lt;CondCodeSDNode&gt;(N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(2))-&gt;<span class="keyword">get</span>(), <span class="keyword">true</span>);</div><div class="line"><a name="l05148"></a><span class="lineno"> 5148</span>&#160;    <span class="keywordflow">if</span> (SCC.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>())</div><div class="line"><a name="l05149"></a><span class="lineno"> 5149</span>&#160;      <span class="keywordflow">return</span> SCC;</div><div class="line"><a name="l05150"></a><span class="lineno"> 5150</span>&#160;  }</div><div class="line"><a name="l05151"></a><span class="lineno"> 5151</span>&#160;</div><div class="line"><a name="l05152"></a><span class="lineno"> 5152</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l05153"></a><span class="lineno"> 5153</span>&#160;}</div><div class="line"><a name="l05154"></a><span class="lineno"> 5154</span>&#160;<span class="comment"></span></div><div class="line"><a name="l05155"></a><span class="lineno"> 5155</span>&#160;<span class="comment">/// GetDemandedBits - See if the specified operand can be simplified with the</span></div><div class="line"><a name="l05156"></a><span class="lineno"> 5156</span>&#160;<span class="comment">/// knowledge that only the bits specified by Mask are used.  If so, return the</span></div><div class="line"><a name="l05157"></a><span class="lineno"> 5157</span>&#160;<span class="comment">/// simpler operand, otherwise return a null SDValue.</span></div><div class="line"><a name="l05158"></a><span class="lineno"> 5158</span>&#160;<span class="comment"></span><a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::GetDemandedBits(<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> V, <span class="keyword">const</span> <a class="code" href="classllvm_1_1APInt.html">APInt</a> &amp;Mask) {</div><div class="line"><a name="l05159"></a><span class="lineno"> 5159</span>&#160;  <span class="keywordflow">switch</span> (V.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>()) {</div><div class="line"><a name="l05160"></a><span class="lineno"> 5160</span>&#160;  <span class="keywordflow">default</span>: <span class="keywordflow">break</span>;</div><div class="line"><a name="l05161"></a><span class="lineno"> 5161</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110aac2f0a84dd2aa5ee4c3f1385e9565f5e">ISD::Constant</a>: {</div><div class="line"><a name="l05162"></a><span class="lineno"> 5162</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a> *CV = cast&lt;ConstantSDNode&gt;(V.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l05163"></a><span class="lineno"> 5163</span>&#160;    assert(CV != 0 &amp;&amp; <span class="stringliteral">&quot;Const value should be ConstSDNode.&quot;</span>);</div><div class="line"><a name="l05164"></a><span class="lineno"> 5164</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1APInt.html">APInt</a> &amp;CVal = CV-&gt;<a class="code" href="classllvm_1_1ConstantSDNode.html#a7951626d3fc3c89c4efee59ed9c3d8bf">getAPIntValue</a>();</div><div class="line"><a name="l05165"></a><span class="lineno"> 5165</span>&#160;    <a class="code" href="classllvm_1_1APInt.html">APInt</a> NewVal = CVal &amp; Mask;</div><div class="line"><a name="l05166"></a><span class="lineno"> 5166</span>&#160;    <span class="keywordflow">if</span> (NewVal != CVal)</div><div class="line"><a name="l05167"></a><span class="lineno"> 5167</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(NewVal, V.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>());</div><div class="line"><a name="l05168"></a><span class="lineno"> 5168</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l05169"></a><span class="lineno"> 5169</span>&#160;  }</div><div class="line"><a name="l05170"></a><span class="lineno"> 5170</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7415ab9f2172c59a2ee7c7a02afa56a4">ISD::OR</a>:</div><div class="line"><a name="l05171"></a><span class="lineno"> 5171</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a92febb83e6ba116eb7aae8e7e3f70cc1">ISD::XOR</a>:</div><div class="line"><a name="l05172"></a><span class="lineno"> 5172</span>&#160;    <span class="comment">// If the LHS or RHS don&#39;t contribute bits to the or, drop them.</span></div><div class="line"><a name="l05173"></a><span class="lineno"> 5173</span>&#160;    <span class="keywordflow">if</span> (DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af99f246db9e144fefd7a73b54ef0bbf7">MaskedValueIsZero</a>(V.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0), Mask))</div><div class="line"><a name="l05174"></a><span class="lineno"> 5174</span>&#160;      <span class="keywordflow">return</span> V.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1);</div><div class="line"><a name="l05175"></a><span class="lineno"> 5175</span>&#160;    <span class="keywordflow">if</span> (DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af99f246db9e144fefd7a73b54ef0bbf7">MaskedValueIsZero</a>(V.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1), Mask))</div><div class="line"><a name="l05176"></a><span class="lineno"> 5176</span>&#160;      <span class="keywordflow">return</span> V.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0);</div><div class="line"><a name="l05177"></a><span class="lineno"> 5177</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l05178"></a><span class="lineno"> 5178</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a3c6553c8acebe1b57c211ee45e2d8f98">ISD::SRL</a>:</div><div class="line"><a name="l05179"></a><span class="lineno"> 5179</span>&#160;    <span class="comment">// Only look at single-use SRLs.</span></div><div class="line"><a name="l05180"></a><span class="lineno"> 5180</span>&#160;    <span class="keywordflow">if</span> (!V.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()-&gt;<a class="code" href="classllvm_1_1SDNode.html#a52753947fce3a01b1c18dd4713c587e8">hasOneUse</a>())</div><div class="line"><a name="l05181"></a><span class="lineno"> 5181</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l05182"></a><span class="lineno"> 5182</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a> *RHSC = dyn_cast&lt;ConstantSDNode&gt;(V.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1))) {</div><div class="line"><a name="l05183"></a><span class="lineno"> 5183</span>&#160;      <span class="comment">// See if we can recursively simplify the LHS.</span></div><div class="line"><a name="l05184"></a><span class="lineno"> 5184</span>&#160;      <span class="keywordtype">unsigned</span> Amt = RHSC-&gt;getZExtValue();</div><div class="line"><a name="l05185"></a><span class="lineno"> 5185</span>&#160;</div><div class="line"><a name="l05186"></a><span class="lineno"> 5186</span>&#160;      <span class="comment">// Watch out for shift count overflow though.</span></div><div class="line"><a name="l05187"></a><span class="lineno"> 5187</span>&#160;      <span class="keywordflow">if</span> (Amt &gt;= Mask.<a class="code" href="classllvm_1_1APInt.html#ad081689e23a8f5dea78dedd623d6a8f8">getBitWidth</a>()) <span class="keywordflow">break</span>;</div><div class="line"><a name="l05188"></a><span class="lineno"> 5188</span>&#160;      <a class="code" href="classllvm_1_1APInt.html">APInt</a> NewMask = Mask &lt;&lt; Amt;</div><div class="line"><a name="l05189"></a><span class="lineno"> 5189</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> SimplifyLHS = GetDemandedBits(V.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0), NewMask);</div><div class="line"><a name="l05190"></a><span class="lineno"> 5190</span>&#160;      <span class="keywordflow">if</span> (SimplifyLHS.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>())</div><div class="line"><a name="l05191"></a><span class="lineno"> 5191</span>&#160;        <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a3c6553c8acebe1b57c211ee45e2d8f98">ISD::SRL</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(V), V.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>(),</div><div class="line"><a name="l05192"></a><span class="lineno"> 5192</span>&#160;                           SimplifyLHS, V.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1));</div><div class="line"><a name="l05193"></a><span class="lineno"> 5193</span>&#160;    }</div><div class="line"><a name="l05194"></a><span class="lineno"> 5194</span>&#160;  }</div><div class="line"><a name="l05195"></a><span class="lineno"> 5195</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l05196"></a><span class="lineno"> 5196</span>&#160;}</div><div class="line"><a name="l05197"></a><span class="lineno"> 5197</span>&#160;<span class="comment"></span></div><div class="line"><a name="l05198"></a><span class="lineno"> 5198</span>&#160;<span class="comment">/// ReduceLoadWidth - If the result of a wider load is shifted to right of N</span></div><div class="line"><a name="l05199"></a><span class="lineno"> 5199</span>&#160;<span class="comment">/// bits and then truncated to a narrower type and where N is a multiple</span></div><div class="line"><a name="l05200"></a><span class="lineno"> 5200</span>&#160;<span class="comment">/// of number of bits of the narrower type, transform it to a narrower load</span></div><div class="line"><a name="l05201"></a><span class="lineno"> 5201</span>&#160;<span class="comment">/// from address + N / num of bits of new type. If the result is to be</span></div><div class="line"><a name="l05202"></a><span class="lineno"> 5202</span>&#160;<span class="comment">/// extended, also fold the extension to form a extending load.</span></div><div class="line"><a name="l05203"></a><span class="lineno"> 5203</span>&#160;<span class="comment"></span><a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::ReduceLoadWidth(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N) {</div><div class="line"><a name="l05204"></a><span class="lineno"> 5204</span>&#160;  <span class="keywordtype">unsigned</span> Opc = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#af0d328f3f61168f4ea7d6e4044af4f97">getOpcode</a>();</div><div class="line"><a name="l05205"></a><span class="lineno"> 5205</span>&#160;</div><div class="line"><a name="l05206"></a><span class="lineno"> 5206</span>&#160;  <a class="code" href="namespacellvm_1_1ISD.html#ad4d48171b87ca51ff54c10a436bac4d7">ISD::LoadExtType</a> ExtType = <a class="code" href="namespacellvm_1_1ISD.html#ad4d48171b87ca51ff54c10a436bac4d7a6aacde2c67988b43a261a7f7ceac4be3">ISD::NON_EXTLOAD</a>;</div><div class="line"><a name="l05207"></a><span class="lineno"> 5207</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N0 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0);</div><div class="line"><a name="l05208"></a><span class="lineno"> 5208</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> VT = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(0);</div><div class="line"><a name="l05209"></a><span class="lineno"> 5209</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> ExtVT = VT;</div><div class="line"><a name="l05210"></a><span class="lineno"> 5210</span>&#160;</div><div class="line"><a name="l05211"></a><span class="lineno"> 5211</span>&#160;  <span class="comment">// This transformation isn&#39;t valid for vector loads.</span></div><div class="line"><a name="l05212"></a><span class="lineno"> 5212</span>&#160;  <span class="keywordflow">if</span> (VT.<a class="code" href="structllvm_1_1EVT.html#a73f7c824cad61a47c21bf6d652ae2fd7">isVector</a>())</div><div class="line"><a name="l05213"></a><span class="lineno"> 5213</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l05214"></a><span class="lineno"> 5214</span>&#160;</div><div class="line"><a name="l05215"></a><span class="lineno"> 5215</span>&#160;  <span class="comment">// Special case: SIGN_EXTEND_INREG is basically truncating to ExtVT then</span></div><div class="line"><a name="l05216"></a><span class="lineno"> 5216</span>&#160;  <span class="comment">// extended to VT.</span></div><div class="line"><a name="l05217"></a><span class="lineno"> 5217</span>&#160;  <span class="keywordflow">if</span> (Opc == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110aaa59dd5ec37f21905436b354c0292d9e">ISD::SIGN_EXTEND_INREG</a>) {</div><div class="line"><a name="l05218"></a><span class="lineno"> 5218</span>&#160;    ExtType = <a class="code" href="namespacellvm_1_1ISD.html#ad4d48171b87ca51ff54c10a436bac4d7a6c61b6125c7901c549f90ee0e443a770">ISD::SEXTLOAD</a>;</div><div class="line"><a name="l05219"></a><span class="lineno"> 5219</span>&#160;    ExtVT = cast&lt;VTSDNode&gt;(N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(1))-&gt;getVT();</div><div class="line"><a name="l05220"></a><span class="lineno"> 5220</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Opc == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a3c6553c8acebe1b57c211ee45e2d8f98">ISD::SRL</a>) {</div><div class="line"><a name="l05221"></a><span class="lineno"> 5221</span>&#160;    <span class="comment">// Another special-case: SRL is basically zero-extending a narrower value.</span></div><div class="line"><a name="l05222"></a><span class="lineno"> 5222</span>&#160;    ExtType = <a class="code" href="namespacellvm_1_1ISD.html#ad4d48171b87ca51ff54c10a436bac4d7a8d89c7da4444d9ec11667aa369abc5f7">ISD::ZEXTLOAD</a>;</div><div class="line"><a name="l05223"></a><span class="lineno"> 5223</span>&#160;    N0 = <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(N, 0);</div><div class="line"><a name="l05224"></a><span class="lineno"> 5224</span>&#160;    <a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a> *N01 = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a>&gt;(N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1));</div><div class="line"><a name="l05225"></a><span class="lineno"> 5225</span>&#160;    <span class="keywordflow">if</span> (!N01) <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l05226"></a><span class="lineno"> 5226</span>&#160;    ExtVT = <a class="code" href="structllvm_1_1EVT.html#a752372e170e4e7c595bf8810bb52adf2">EVT::getIntegerVT</a>(*DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a39c6dff47b8dbd25cfaf6336c7056077">getContext</a>(),</div><div class="line"><a name="l05227"></a><span class="lineno"> 5227</span>&#160;                              VT.<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>() - N01-&gt;<a class="code" href="classllvm_1_1ConstantSDNode.html#a1e9365c991dd55e65e9d5ab5653812e4">getZExtValue</a>());</div><div class="line"><a name="l05228"></a><span class="lineno"> 5228</span>&#160;  }</div><div class="line"><a name="l05229"></a><span class="lineno"> 5229</span>&#160;  <span class="keywordflow">if</span> (LegalOperations &amp;&amp; !TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#ad85f712b9e49629c2c160f16521fe91f">isLoadExtLegal</a>(ExtType, ExtVT))</div><div class="line"><a name="l05230"></a><span class="lineno"> 5230</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l05231"></a><span class="lineno"> 5231</span>&#160;</div><div class="line"><a name="l05232"></a><span class="lineno"> 5232</span>&#160;  <span class="keywordtype">unsigned</span> EVTBits = ExtVT.<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>();</div><div class="line"><a name="l05233"></a><span class="lineno"> 5233</span>&#160;</div><div class="line"><a name="l05234"></a><span class="lineno"> 5234</span>&#160;  <span class="comment">// Do not generate loads of non-round integer types since these can</span></div><div class="line"><a name="l05235"></a><span class="lineno"> 5235</span>&#160;  <span class="comment">// be expensive (and would be wrong if the type is not byte sized).</span></div><div class="line"><a name="l05236"></a><span class="lineno"> 5236</span>&#160;  <span class="keywordflow">if</span> (!ExtVT.<a class="code" href="structllvm_1_1EVT.html#af5afc8257ed5adc0f55be3a9f7587267">isRound</a>())</div><div class="line"><a name="l05237"></a><span class="lineno"> 5237</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l05238"></a><span class="lineno"> 5238</span>&#160;</div><div class="line"><a name="l05239"></a><span class="lineno"> 5239</span>&#160;  <span class="keywordtype">unsigned</span> ShAmt = 0;</div><div class="line"><a name="l05240"></a><span class="lineno"> 5240</span>&#160;  <span class="keywordflow">if</span> (N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a3c6553c8acebe1b57c211ee45e2d8f98">ISD::SRL</a> &amp;&amp; N0.<a class="code" href="classllvm_1_1SDValue.html#a97b0f24f3e52f030830fca6fbfcbd37d">hasOneUse</a>()) {</div><div class="line"><a name="l05241"></a><span class="lineno"> 5241</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a> *N01 = dyn_cast&lt;ConstantSDNode&gt;(N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1))) {</div><div class="line"><a name="l05242"></a><span class="lineno"> 5242</span>&#160;      ShAmt = N01-&gt;getZExtValue();</div><div class="line"><a name="l05243"></a><span class="lineno"> 5243</span>&#160;      <span class="comment">// Is the shift amount a multiple of size of VT?</span></div><div class="line"><a name="l05244"></a><span class="lineno"> 5244</span>&#160;      <span class="keywordflow">if</span> ((ShAmt &amp; (EVTBits-1)) == 0) {</div><div class="line"><a name="l05245"></a><span class="lineno"> 5245</span>&#160;        N0 = N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0);</div><div class="line"><a name="l05246"></a><span class="lineno"> 5246</span>&#160;        <span class="comment">// Is the load width a multiple of size of VT?</span></div><div class="line"><a name="l05247"></a><span class="lineno"> 5247</span>&#160;        <span class="keywordflow">if</span> ((N0.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>().<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>() &amp; (EVTBits-1)) != 0)</div><div class="line"><a name="l05248"></a><span class="lineno"> 5248</span>&#160;          <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l05249"></a><span class="lineno"> 5249</span>&#160;      }</div><div class="line"><a name="l05250"></a><span class="lineno"> 5250</span>&#160;</div><div class="line"><a name="l05251"></a><span class="lineno"> 5251</span>&#160;      <span class="comment">// At this point, we must have a load or else we can&#39;t do the transform.</span></div><div class="line"><a name="l05252"></a><span class="lineno"> 5252</span>&#160;      <span class="keywordflow">if</span> (!isa&lt;LoadSDNode&gt;(N0)) <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l05253"></a><span class="lineno"> 5253</span>&#160;</div><div class="line"><a name="l05254"></a><span class="lineno"> 5254</span>&#160;      <span class="comment">// Because a SRL must be assumed to *need* to zero-extend the high bits</span></div><div class="line"><a name="l05255"></a><span class="lineno"> 5255</span>&#160;      <span class="comment">// (as opposed to anyext the high bits), we can&#39;t combine the zextload</span></div><div class="line"><a name="l05256"></a><span class="lineno"> 5256</span>&#160;      <span class="comment">// lowering of SRL and an sextload.</span></div><div class="line"><a name="l05257"></a><span class="lineno"> 5257</span>&#160;      <span class="keywordflow">if</span> (cast&lt;LoadSDNode&gt;(N0)-&gt;getExtensionType() == <a class="code" href="namespacellvm_1_1ISD.html#ad4d48171b87ca51ff54c10a436bac4d7a6c61b6125c7901c549f90ee0e443a770">ISD::SEXTLOAD</a>)</div><div class="line"><a name="l05258"></a><span class="lineno"> 5258</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l05259"></a><span class="lineno"> 5259</span>&#160;</div><div class="line"><a name="l05260"></a><span class="lineno"> 5260</span>&#160;      <span class="comment">// If the shift amount is larger than the input type then we&#39;re not</span></div><div class="line"><a name="l05261"></a><span class="lineno"> 5261</span>&#160;      <span class="comment">// accessing any of the loaded bytes.  If the load was a zextload/extload</span></div><div class="line"><a name="l05262"></a><span class="lineno"> 5262</span>&#160;      <span class="comment">// then the result of the shift+trunc is zero/undef (handled elsewhere).</span></div><div class="line"><a name="l05263"></a><span class="lineno"> 5263</span>&#160;      <span class="keywordflow">if</span> (ShAmt &gt;= cast&lt;LoadSDNode&gt;(N0)-&gt;getMemoryVT().getSizeInBits())</div><div class="line"><a name="l05264"></a><span class="lineno"> 5264</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l05265"></a><span class="lineno"> 5265</span>&#160;    }</div><div class="line"><a name="l05266"></a><span class="lineno"> 5266</span>&#160;  }</div><div class="line"><a name="l05267"></a><span class="lineno"> 5267</span>&#160;</div><div class="line"><a name="l05268"></a><span class="lineno"> 5268</span>&#160;  <span class="comment">// If the load is shifted left (and the result isn&#39;t shifted back right),</span></div><div class="line"><a name="l05269"></a><span class="lineno"> 5269</span>&#160;  <span class="comment">// we can fold the truncate through the shift.</span></div><div class="line"><a name="l05270"></a><span class="lineno"> 5270</span>&#160;  <span class="keywordtype">unsigned</span> ShLeftAmt = 0;</div><div class="line"><a name="l05271"></a><span class="lineno"> 5271</span>&#160;  <span class="keywordflow">if</span> (ShAmt == 0 &amp;&amp; N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a8cc94e03dea594863073a02f5bb94997">ISD::SHL</a> &amp;&amp; N0.<a class="code" href="classllvm_1_1SDValue.html#a97b0f24f3e52f030830fca6fbfcbd37d">hasOneUse</a>() &amp;&amp;</div><div class="line"><a name="l05272"></a><span class="lineno"> 5272</span>&#160;      ExtVT == VT &amp;&amp; TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a52dbd9fc4ea2c0919913e74e003b2823">isNarrowingProfitable</a>(N0.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>(), VT)) {</div><div class="line"><a name="l05273"></a><span class="lineno"> 5273</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a> *N01 = dyn_cast&lt;ConstantSDNode&gt;(N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1))) {</div><div class="line"><a name="l05274"></a><span class="lineno"> 5274</span>&#160;      ShLeftAmt = N01-&gt;getZExtValue();</div><div class="line"><a name="l05275"></a><span class="lineno"> 5275</span>&#160;      N0 = N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0);</div><div class="line"><a name="l05276"></a><span class="lineno"> 5276</span>&#160;    }</div><div class="line"><a name="l05277"></a><span class="lineno"> 5277</span>&#160;  }</div><div class="line"><a name="l05278"></a><span class="lineno"> 5278</span>&#160;</div><div class="line"><a name="l05279"></a><span class="lineno"> 5279</span>&#160;  <span class="comment">// If we haven&#39;t found a load, we can&#39;t narrow it.  Don&#39;t transform one with</span></div><div class="line"><a name="l05280"></a><span class="lineno"> 5280</span>&#160;  <span class="comment">// multiple uses, this would require adding a new load.</span></div><div class="line"><a name="l05281"></a><span class="lineno"> 5281</span>&#160;  <span class="keywordflow">if</span> (!isa&lt;LoadSDNode&gt;(N0) || !N0.<a class="code" href="classllvm_1_1SDValue.html#a97b0f24f3e52f030830fca6fbfcbd37d">hasOneUse</a>())</div><div class="line"><a name="l05282"></a><span class="lineno"> 5282</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l05283"></a><span class="lineno"> 5283</span>&#160;</div><div class="line"><a name="l05284"></a><span class="lineno"> 5284</span>&#160;  <span class="comment">// Don&#39;t change the width of a volatile load.</span></div><div class="line"><a name="l05285"></a><span class="lineno"> 5285</span>&#160;  <a class="code" href="classllvm_1_1LoadSDNode.html">LoadSDNode</a> *LN0 = cast&lt;LoadSDNode&gt;(N0);</div><div class="line"><a name="l05286"></a><span class="lineno"> 5286</span>&#160;  <span class="keywordflow">if</span> (LN0-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#acd3bb9ee2ec53fa4be1fdf155b0b5a17">isVolatile</a>())</div><div class="line"><a name="l05287"></a><span class="lineno"> 5287</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l05288"></a><span class="lineno"> 5288</span>&#160;</div><div class="line"><a name="l05289"></a><span class="lineno"> 5289</span>&#160;  <span class="comment">// Verify that we are actually reducing a load width here.</span></div><div class="line"><a name="l05290"></a><span class="lineno"> 5290</span>&#160;  <span class="keywordflow">if</span> (LN0-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a7cead3a2a7771e61083bcc6959915a13">getMemoryVT</a>().<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>() &lt; EVTBits)</div><div class="line"><a name="l05291"></a><span class="lineno"> 5291</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l05292"></a><span class="lineno"> 5292</span>&#160;</div><div class="line"><a name="l05293"></a><span class="lineno"> 5293</span>&#160;  <span class="comment">// For the transform to be legal, the load must produce only two values</span></div><div class="line"><a name="l05294"></a><span class="lineno"> 5294</span>&#160;  <span class="comment">// (the value loaded and the chain).  Don&#39;t transform a pre-increment</span></div><div class="line"><a name="l05295"></a><span class="lineno"> 5295</span>&#160;  <span class="comment">// load, for example, which produces an extra value.  Otherwise the</span></div><div class="line"><a name="l05296"></a><span class="lineno"> 5296</span>&#160;  <span class="comment">// transformation is not equivalent, and the downstream logic to replace</span></div><div class="line"><a name="l05297"></a><span class="lineno"> 5297</span>&#160;  <span class="comment">// uses gets things wrong.</span></div><div class="line"><a name="l05298"></a><span class="lineno"> 5298</span>&#160;  <span class="keywordflow">if</span> (LN0-&gt;<a class="code" href="classllvm_1_1SDNode.html#ab319fc51db27ec95fd50a910c7ccec94">getNumValues</a>() &gt; 2)</div><div class="line"><a name="l05299"></a><span class="lineno"> 5299</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l05300"></a><span class="lineno"> 5300</span>&#160;</div><div class="line"><a name="l05301"></a><span class="lineno"> 5301</span>&#160;  <span class="comment">// If the load that we&#39;re shrinking is an extload and we&#39;re not just</span></div><div class="line"><a name="l05302"></a><span class="lineno"> 5302</span>&#160;  <span class="comment">// discarding the extension we can&#39;t simply shrink the load. Bail.</span></div><div class="line"><a name="l05303"></a><span class="lineno"> 5303</span>&#160;  <span class="comment">// TODO: It would be possible to merge the extensions in some cases.</span></div><div class="line"><a name="l05304"></a><span class="lineno"> 5304</span>&#160;  <span class="keywordflow">if</span> (LN0-&gt;<a class="code" href="classllvm_1_1LoadSDNode.html#af15fb8b2d4c9f295bdcf85a1eb506702">getExtensionType</a>() != <a class="code" href="namespacellvm_1_1ISD.html#ad4d48171b87ca51ff54c10a436bac4d7a6aacde2c67988b43a261a7f7ceac4be3">ISD::NON_EXTLOAD</a> &amp;&amp;</div><div class="line"><a name="l05305"></a><span class="lineno"> 5305</span>&#160;      LN0-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a7cead3a2a7771e61083bcc6959915a13">getMemoryVT</a>().<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>() &lt; ExtVT.<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>() + ShAmt)</div><div class="line"><a name="l05306"></a><span class="lineno"> 5306</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l05307"></a><span class="lineno"> 5307</span>&#160;</div><div class="line"><a name="l05308"></a><span class="lineno"> 5308</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> PtrType = N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1).<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>();</div><div class="line"><a name="l05309"></a><span class="lineno"> 5309</span>&#160;</div><div class="line"><a name="l05310"></a><span class="lineno"> 5310</span>&#160;  <span class="keywordflow">if</span> (PtrType == <a class="code" href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50ca707dc1fd6a4179316ffa6ca2516e18dc">MVT::Untyped</a> || PtrType.<a class="code" href="structllvm_1_1EVT.html#a0ca9e22c58f23f19b5c3eb010318b699">isExtended</a>())</div><div class="line"><a name="l05311"></a><span class="lineno"> 5311</span>&#160;    <span class="comment">// It&#39;s not possible to generate a constant of extended or untyped type.</span></div><div class="line"><a name="l05312"></a><span class="lineno"> 5312</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l05313"></a><span class="lineno"> 5313</span>&#160;</div><div class="line"><a name="l05314"></a><span class="lineno"> 5314</span>&#160;  <span class="comment">// For big endian targets, we need to adjust the offset to the pointer to</span></div><div class="line"><a name="l05315"></a><span class="lineno"> 5315</span>&#160;  <span class="comment">// load the correct bytes.</span></div><div class="line"><a name="l05316"></a><span class="lineno"> 5316</span>&#160;  <span class="keywordflow">if</span> (TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a785a8016a792dbc65ec16688f180af71">isBigEndian</a>()) {</div><div class="line"><a name="l05317"></a><span class="lineno"> 5317</span>&#160;    <span class="keywordtype">unsigned</span> LVTStoreBits = LN0-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a7cead3a2a7771e61083bcc6959915a13">getMemoryVT</a>().<a class="code" href="structllvm_1_1EVT.html#a9b1d12f467b88f8da64a1d6841910193">getStoreSizeInBits</a>();</div><div class="line"><a name="l05318"></a><span class="lineno"> 5318</span>&#160;    <span class="keywordtype">unsigned</span> EVTStoreBits = ExtVT.<a class="code" href="structllvm_1_1EVT.html#a9b1d12f467b88f8da64a1d6841910193">getStoreSizeInBits</a>();</div><div class="line"><a name="l05319"></a><span class="lineno"> 5319</span>&#160;    ShAmt = LVTStoreBits - EVTStoreBits - ShAmt;</div><div class="line"><a name="l05320"></a><span class="lineno"> 5320</span>&#160;  }</div><div class="line"><a name="l05321"></a><span class="lineno"> 5321</span>&#160;</div><div class="line"><a name="l05322"></a><span class="lineno"> 5322</span>&#160;  uint64_t PtrOff = ShAmt / 8;</div><div class="line"><a name="l05323"></a><span class="lineno"> 5323</span>&#160;  <span class="keywordtype">unsigned</span> NewAlign = <a class="code" href="namespacellvm.html#af36d7e69ab16b64b2e3a48c83aa9f0f6">MinAlign</a>(LN0-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a4f68cd016138440f215ad80c1d6c1e04">getAlignment</a>(), PtrOff);</div><div class="line"><a name="l05324"></a><span class="lineno"> 5324</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> NewPtr = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a269996b43a1f3e1d1f84a70fd4387535">ISD::ADD</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(LN0),</div><div class="line"><a name="l05325"></a><span class="lineno"> 5325</span>&#160;                               PtrType, LN0-&gt;<a class="code" href="classllvm_1_1LoadSDNode.html#a3ded48ce66b58b7e7e143991df5dbfae">getBasePtr</a>(),</div><div class="line"><a name="l05326"></a><span class="lineno"> 5326</span>&#160;                               DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(PtrOff, PtrType));</div><div class="line"><a name="l05327"></a><span class="lineno"> 5327</span>&#160;  AddToWorkList(NewPtr.getNode());</div><div class="line"><a name="l05328"></a><span class="lineno"> 5328</span>&#160;</div><div class="line"><a name="l05329"></a><span class="lineno"> 5329</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> <a class="code" href="namespacellvm_1_1SPII.html#a11e9b8fca4a074643a6a21f444e51406a5069619ca8fdce305534f3fe85091a0f">Load</a>;</div><div class="line"><a name="l05330"></a><span class="lineno"> 5330</span>&#160;  <span class="keywordflow">if</span> (ExtType == <a class="code" href="namespacellvm_1_1ISD.html#ad4d48171b87ca51ff54c10a436bac4d7a6aacde2c67988b43a261a7f7ceac4be3">ISD::NON_EXTLOAD</a>)</div><div class="line"><a name="l05331"></a><span class="lineno"> 5331</span>&#160;    Load =  DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#ab8395be5698f080c0036d866e121a478">getLoad</a>(VT, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N0), LN0-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#ae3cb6fbf8c8cb79e10ac61bd98c85211">getChain</a>(), NewPtr,</div><div class="line"><a name="l05332"></a><span class="lineno"> 5332</span>&#160;                        LN0-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a2fa8491ab36125d7f5dd38d3a4868934">getPointerInfo</a>().<a class="code" href="structllvm_1_1MachinePointerInfo.html#aa7b903b38006dd4cb8fcf8854af5b6b9">getWithOffset</a>(PtrOff),</div><div class="line"><a name="l05333"></a><span class="lineno"> 5333</span>&#160;                        LN0-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#acd3bb9ee2ec53fa4be1fdf155b0b5a17">isVolatile</a>(), LN0-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a967ffaf77f64a5deb1e96951e4224112">isNonTemporal</a>(),</div><div class="line"><a name="l05334"></a><span class="lineno"> 5334</span>&#160;                        LN0-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#ad8e64770a04af6b3da2099477e7c28de">isInvariant</a>(), NewAlign, LN0-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a23670ceb5797afa3d45ca1a9b011fd87">getTBAAInfo</a>());</div><div class="line"><a name="l05335"></a><span class="lineno"> 5335</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l05336"></a><span class="lineno"> 5336</span>&#160;    Load = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#ad6ff413bea6f8195d8e6f29f4fc519c4">getExtLoad</a>(ExtType, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N0), VT, LN0-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#ae3cb6fbf8c8cb79e10ac61bd98c85211">getChain</a>(),NewPtr,</div><div class="line"><a name="l05337"></a><span class="lineno"> 5337</span>&#160;                          LN0-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a2fa8491ab36125d7f5dd38d3a4868934">getPointerInfo</a>().<a class="code" href="structllvm_1_1MachinePointerInfo.html#aa7b903b38006dd4cb8fcf8854af5b6b9">getWithOffset</a>(PtrOff),</div><div class="line"><a name="l05338"></a><span class="lineno"> 5338</span>&#160;                          ExtVT, LN0-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#acd3bb9ee2ec53fa4be1fdf155b0b5a17">isVolatile</a>(), LN0-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a967ffaf77f64a5deb1e96951e4224112">isNonTemporal</a>(),</div><div class="line"><a name="l05339"></a><span class="lineno"> 5339</span>&#160;                          NewAlign, LN0-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a23670ceb5797afa3d45ca1a9b011fd87">getTBAAInfo</a>());</div><div class="line"><a name="l05340"></a><span class="lineno"> 5340</span>&#160;</div><div class="line"><a name="l05341"></a><span class="lineno"> 5341</span>&#160;  <span class="comment">// Replace the old load&#39;s chain with the new load&#39;s chain.</span></div><div class="line"><a name="l05342"></a><span class="lineno"> 5342</span>&#160;  WorkListRemover DeadNodes(*<span class="keyword">this</span>);</div><div class="line"><a name="l05343"></a><span class="lineno"> 5343</span>&#160;  DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#ac630ccda26fea2f45afa3fb89bc1a8f4">ReplaceAllUsesOfValueWith</a>(N0.<a class="code" href="classllvm_1_1SDValue.html#a040481b9bda32faa6b1435532405d88f">getValue</a>(1), Load.<a class="code" href="classllvm_1_1SDValue.html#a040481b9bda32faa6b1435532405d88f">getValue</a>(1));</div><div class="line"><a name="l05344"></a><span class="lineno"> 5344</span>&#160;</div><div class="line"><a name="l05345"></a><span class="lineno"> 5345</span>&#160;  <span class="comment">// Shift the result left, if we&#39;ve swallowed a left shift.</span></div><div class="line"><a name="l05346"></a><span class="lineno"> 5346</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Result = <a class="code" href="namespacellvm_1_1SPII.html#a11e9b8fca4a074643a6a21f444e51406a5069619ca8fdce305534f3fe85091a0f">Load</a>;</div><div class="line"><a name="l05347"></a><span class="lineno"> 5347</span>&#160;  <span class="keywordflow">if</span> (ShLeftAmt != 0) {</div><div class="line"><a name="l05348"></a><span class="lineno"> 5348</span>&#160;    <a class="code" href="structllvm_1_1EVT.html">EVT</a> ShImmTy = getShiftAmountTy(Result.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>());</div><div class="line"><a name="l05349"></a><span class="lineno"> 5349</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm.html#a1a995470163b6d76695cba5bc8dfb529">isUIntN</a>(ShImmTy.<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>(), ShLeftAmt))</div><div class="line"><a name="l05350"></a><span class="lineno"> 5350</span>&#160;      ShImmTy = VT;</div><div class="line"><a name="l05351"></a><span class="lineno"> 5351</span>&#160;    <span class="comment">// If the shift amount is as large as the result size (but, presumably,</span></div><div class="line"><a name="l05352"></a><span class="lineno"> 5352</span>&#160;    <span class="comment">// no larger than the source) then the useful bits of the result are</span></div><div class="line"><a name="l05353"></a><span class="lineno"> 5353</span>&#160;    <span class="comment">// zero; we can&#39;t simply return the shortened shift, because the result</span></div><div class="line"><a name="l05354"></a><span class="lineno"> 5354</span>&#160;    <span class="comment">// of that operation is undefined.</span></div><div class="line"><a name="l05355"></a><span class="lineno"> 5355</span>&#160;    <span class="keywordflow">if</span> (ShLeftAmt &gt;= VT.<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>())</div><div class="line"><a name="l05356"></a><span class="lineno"> 5356</span>&#160;      Result = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(0, VT);</div><div class="line"><a name="l05357"></a><span class="lineno"> 5357</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l05358"></a><span class="lineno"> 5358</span>&#160;      Result = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a8cc94e03dea594863073a02f5bb94997">ISD::SHL</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N0), VT,</div><div class="line"><a name="l05359"></a><span class="lineno"> 5359</span>&#160;                          Result, DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(ShLeftAmt, ShImmTy));</div><div class="line"><a name="l05360"></a><span class="lineno"> 5360</span>&#160;  }</div><div class="line"><a name="l05361"></a><span class="lineno"> 5361</span>&#160;</div><div class="line"><a name="l05362"></a><span class="lineno"> 5362</span>&#160;  <span class="comment">// Return the new loaded value.</span></div><div class="line"><a name="l05363"></a><span class="lineno"> 5363</span>&#160;  <span class="keywordflow">return</span> Result;</div><div class="line"><a name="l05364"></a><span class="lineno"> 5364</span>&#160;}</div><div class="line"><a name="l05365"></a><span class="lineno"> 5365</span>&#160;</div><div class="line"><a name="l05366"></a><span class="lineno"> 5366</span>&#160;<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::visitSIGN_EXTEND_INREG(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N) {</div><div class="line"><a name="l05367"></a><span class="lineno"> 5367</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N0 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0);</div><div class="line"><a name="l05368"></a><span class="lineno"> 5368</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N1 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(1);</div><div class="line"><a name="l05369"></a><span class="lineno"> 5369</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> VT = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(0);</div><div class="line"><a name="l05370"></a><span class="lineno"> 5370</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> <a class="code" href="structllvm_1_1EVT.html">EVT</a> = cast&lt;VTSDNode&gt;(N1)-&gt;getVT();</div><div class="line"><a name="l05371"></a><span class="lineno"> 5371</span>&#160;  <span class="keywordtype">unsigned</span> VTBits = VT.<a class="code" href="structllvm_1_1EVT.html#a15be9767d0aad93fe5dcb60b7b7a78da">getScalarType</a>().<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>();</div><div class="line"><a name="l05372"></a><span class="lineno"> 5372</span>&#160;  <span class="keywordtype">unsigned</span> EVTBits = EVT.<a class="code" href="structllvm_1_1EVT.html#a15be9767d0aad93fe5dcb60b7b7a78da">getScalarType</a>().<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>();</div><div class="line"><a name="l05373"></a><span class="lineno"> 5373</span>&#160;</div><div class="line"><a name="l05374"></a><span class="lineno"> 5374</span>&#160;  <span class="comment">// fold (sext_in_reg c1) -&gt; c1</span></div><div class="line"><a name="l05375"></a><span class="lineno"> 5375</span>&#160;  <span class="keywordflow">if</span> (isa&lt;ConstantSDNode&gt;(N0) || N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7c6d8f265e9e16e5debdb9a536b55d3d">ISD::UNDEF</a>)</div><div class="line"><a name="l05376"></a><span class="lineno"> 5376</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110aaa59dd5ec37f21905436b354c0292d9e">ISD::SIGN_EXTEND_INREG</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N0, N1);</div><div class="line"><a name="l05377"></a><span class="lineno"> 5377</span>&#160;</div><div class="line"><a name="l05378"></a><span class="lineno"> 5378</span>&#160;  <span class="comment">// If the input is already sign extended, just drop the extension.</span></div><div class="line"><a name="l05379"></a><span class="lineno"> 5379</span>&#160;  <span class="keywordflow">if</span> (DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a01e15fa872bbde36ed8a394a01b200b9">ComputeNumSignBits</a>(N0) &gt;= VTBits-EVTBits+1)</div><div class="line"><a name="l05380"></a><span class="lineno"> 5380</span>&#160;    <span class="keywordflow">return</span> N0;</div><div class="line"><a name="l05381"></a><span class="lineno"> 5381</span>&#160;</div><div class="line"><a name="l05382"></a><span class="lineno"> 5382</span>&#160;  <span class="comment">// fold (sext_in_reg (sext_in_reg x, VT2), VT1) -&gt; (sext_in_reg x, minVT) pt2</span></div><div class="line"><a name="l05383"></a><span class="lineno"> 5383</span>&#160;  <span class="keywordflow">if</span> (N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110aaa59dd5ec37f21905436b354c0292d9e">ISD::SIGN_EXTEND_INREG</a> &amp;&amp;</div><div class="line"><a name="l05384"></a><span class="lineno"> 5384</span>&#160;      EVT.<a class="code" href="structllvm_1_1EVT.html#a5ebe5227fe53e0dcf4102a6ebf1594a2">bitsLT</a>(cast&lt;VTSDNode&gt;(N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1))-&gt;getVT()))</div><div class="line"><a name="l05385"></a><span class="lineno"> 5385</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110aaa59dd5ec37f21905436b354c0292d9e">ISD::SIGN_EXTEND_INREG</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT,</div><div class="line"><a name="l05386"></a><span class="lineno"> 5386</span>&#160;                       N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0), N1);</div><div class="line"><a name="l05387"></a><span class="lineno"> 5387</span>&#160;</div><div class="line"><a name="l05388"></a><span class="lineno"> 5388</span>&#160;  <span class="comment">// fold (sext_in_reg (sext x)) -&gt; (sext x)</span></div><div class="line"><a name="l05389"></a><span class="lineno"> 5389</span>&#160;  <span class="comment">// fold (sext_in_reg (aext x)) -&gt; (sext x)</span></div><div class="line"><a name="l05390"></a><span class="lineno"> 5390</span>&#160;  <span class="comment">// if x is small enough.</span></div><div class="line"><a name="l05391"></a><span class="lineno"> 5391</span>&#160;  <span class="keywordflow">if</span> (N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a5183f3d72924bc7c77ba8d3f5de9f602">ISD::SIGN_EXTEND</a> || N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a27d5d8ef82302b739ba3ca8be1a5513d">ISD::ANY_EXTEND</a>) {</div><div class="line"><a name="l05392"></a><span class="lineno"> 5392</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N00 = N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0);</div><div class="line"><a name="l05393"></a><span class="lineno"> 5393</span>&#160;    <span class="keywordflow">if</span> (N00.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>().<a class="code" href="structllvm_1_1EVT.html#a15be9767d0aad93fe5dcb60b7b7a78da">getScalarType</a>().<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>() &lt;= EVTBits &amp;&amp;</div><div class="line"><a name="l05394"></a><span class="lineno"> 5394</span>&#160;        (!LegalOperations || TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a055b3905dbbc16fae11510b9ebd1e00c">isOperationLegal</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a5183f3d72924bc7c77ba8d3f5de9f602">ISD::SIGN_EXTEND</a>, VT)))</div><div class="line"><a name="l05395"></a><span class="lineno"> 5395</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a5183f3d72924bc7c77ba8d3f5de9f602">ISD::SIGN_EXTEND</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N00, N1);</div><div class="line"><a name="l05396"></a><span class="lineno"> 5396</span>&#160;  }</div><div class="line"><a name="l05397"></a><span class="lineno"> 5397</span>&#160;</div><div class="line"><a name="l05398"></a><span class="lineno"> 5398</span>&#160;  <span class="comment">// fold (sext_in_reg x) -&gt; (zext_in_reg x) if the sign bit is known zero.</span></div><div class="line"><a name="l05399"></a><span class="lineno"> 5399</span>&#160;  <span class="keywordflow">if</span> (DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af99f246db9e144fefd7a73b54ef0bbf7">MaskedValueIsZero</a>(N0, <a class="code" href="classllvm_1_1APInt.html#a46ceedee591f92727b85641794a96061">APInt::getBitsSet</a>(VTBits, EVTBits-1, EVTBits)))</div><div class="line"><a name="l05400"></a><span class="lineno"> 5400</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#ad03d69f873a948a3de21ba504364d352">getZeroExtendInReg</a>(N0, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), EVT);</div><div class="line"><a name="l05401"></a><span class="lineno"> 5401</span>&#160;</div><div class="line"><a name="l05402"></a><span class="lineno"> 5402</span>&#160;  <span class="comment">// fold operands of sext_in_reg based on knowledge that the top bits are not</span></div><div class="line"><a name="l05403"></a><span class="lineno"> 5403</span>&#160;  <span class="comment">// demanded.</span></div><div class="line"><a name="l05404"></a><span class="lineno"> 5404</span>&#160;  <span class="keywordflow">if</span> (SimplifyDemandedBits(<a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(N, 0)))</div><div class="line"><a name="l05405"></a><span class="lineno"> 5405</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(N, 0);</div><div class="line"><a name="l05406"></a><span class="lineno"> 5406</span>&#160;</div><div class="line"><a name="l05407"></a><span class="lineno"> 5407</span>&#160;  <span class="comment">// fold (sext_in_reg (load x)) -&gt; (smaller sextload x)</span></div><div class="line"><a name="l05408"></a><span class="lineno"> 5408</span>&#160;  <span class="comment">// fold (sext_in_reg (srl (load x), c)) -&gt; (smaller sextload (x+c/evtbits))</span></div><div class="line"><a name="l05409"></a><span class="lineno"> 5409</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> NarrowLoad = ReduceLoadWidth(N);</div><div class="line"><a name="l05410"></a><span class="lineno"> 5410</span>&#160;  <span class="keywordflow">if</span> (NarrowLoad.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>())</div><div class="line"><a name="l05411"></a><span class="lineno"> 5411</span>&#160;    <span class="keywordflow">return</span> NarrowLoad;</div><div class="line"><a name="l05412"></a><span class="lineno"> 5412</span>&#160;</div><div class="line"><a name="l05413"></a><span class="lineno"> 5413</span>&#160;  <span class="comment">// fold (sext_in_reg (srl X, 24), i8) -&gt; (sra X, 24)</span></div><div class="line"><a name="l05414"></a><span class="lineno"> 5414</span>&#160;  <span class="comment">// fold (sext_in_reg (srl X, 23), i8) -&gt; (sra X, 23) iff possible.</span></div><div class="line"><a name="l05415"></a><span class="lineno"> 5415</span>&#160;  <span class="comment">// We already fold &quot;(sext_in_reg (srl X, 25), i8) -&gt; srl X, 25&quot; above.</span></div><div class="line"><a name="l05416"></a><span class="lineno"> 5416</span>&#160;  <span class="keywordflow">if</span> (N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a3c6553c8acebe1b57c211ee45e2d8f98">ISD::SRL</a>) {</div><div class="line"><a name="l05417"></a><span class="lineno"> 5417</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a> *ShAmt = dyn_cast&lt;ConstantSDNode&gt;(N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1)))</div><div class="line"><a name="l05418"></a><span class="lineno"> 5418</span>&#160;      <span class="keywordflow">if</span> (ShAmt-&gt;getZExtValue()+EVTBits &lt;= VTBits) {</div><div class="line"><a name="l05419"></a><span class="lineno"> 5419</span>&#160;        <span class="comment">// We can turn this into an SRA iff the input to the SRL is already sign</span></div><div class="line"><a name="l05420"></a><span class="lineno"> 5420</span>&#160;        <span class="comment">// extended enough.</span></div><div class="line"><a name="l05421"></a><span class="lineno"> 5421</span>&#160;        <span class="keywordtype">unsigned</span> InSignBits = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a01e15fa872bbde36ed8a394a01b200b9">ComputeNumSignBits</a>(N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0));</div><div class="line"><a name="l05422"></a><span class="lineno"> 5422</span>&#160;        <span class="keywordflow">if</span> (VTBits-(ShAmt-&gt;getZExtValue()+EVTBits) &lt; InSignBits)</div><div class="line"><a name="l05423"></a><span class="lineno"> 5423</span>&#160;          <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a4a055321c361a0f6ee77ed764730ffc1">ISD::SRA</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT,</div><div class="line"><a name="l05424"></a><span class="lineno"> 5424</span>&#160;                             N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0), N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1));</div><div class="line"><a name="l05425"></a><span class="lineno"> 5425</span>&#160;      }</div><div class="line"><a name="l05426"></a><span class="lineno"> 5426</span>&#160;  }</div><div class="line"><a name="l05427"></a><span class="lineno"> 5427</span>&#160;</div><div class="line"><a name="l05428"></a><span class="lineno"> 5428</span>&#160;  <span class="comment">// fold (sext_inreg (extload x)) -&gt; (sextload x)</span></div><div class="line"><a name="l05429"></a><span class="lineno"> 5429</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1ISD.html#a910795e8d77c1545da0683c0e1cb81ee">ISD::isEXTLoad</a>(N0.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()) &amp;&amp;</div><div class="line"><a name="l05430"></a><span class="lineno"> 5430</span>&#160;      <a class="code" href="namespacellvm_1_1ISD.html#a7da84980dd2ee06405d74303cfb90485">ISD::isUNINDEXEDLoad</a>(N0.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()) &amp;&amp;</div><div class="line"><a name="l05431"></a><span class="lineno"> 5431</span>&#160;      EVT == cast&lt;LoadSDNode&gt;(N0)-&gt;getMemoryVT() &amp;&amp;</div><div class="line"><a name="l05432"></a><span class="lineno"> 5432</span>&#160;      ((!LegalOperations &amp;&amp; !cast&lt;LoadSDNode&gt;(N0)-&gt;isVolatile()) ||</div><div class="line"><a name="l05433"></a><span class="lineno"> 5433</span>&#160;       TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#ad85f712b9e49629c2c160f16521fe91f">isLoadExtLegal</a>(<a class="code" href="namespacellvm_1_1ISD.html#ad4d48171b87ca51ff54c10a436bac4d7a6c61b6125c7901c549f90ee0e443a770">ISD::SEXTLOAD</a>, EVT))) {</div><div class="line"><a name="l05434"></a><span class="lineno"> 5434</span>&#160;    <a class="code" href="classllvm_1_1LoadSDNode.html">LoadSDNode</a> *LN0 = cast&lt;LoadSDNode&gt;(N0);</div><div class="line"><a name="l05435"></a><span class="lineno"> 5435</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> ExtLoad = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#ad6ff413bea6f8195d8e6f29f4fc519c4">getExtLoad</a>(<a class="code" href="namespacellvm_1_1ISD.html#ad4d48171b87ca51ff54c10a436bac4d7a6c61b6125c7901c549f90ee0e443a770">ISD::SEXTLOAD</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT,</div><div class="line"><a name="l05436"></a><span class="lineno"> 5436</span>&#160;                                     LN0-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#ae3cb6fbf8c8cb79e10ac61bd98c85211">getChain</a>(),</div><div class="line"><a name="l05437"></a><span class="lineno"> 5437</span>&#160;                                     LN0-&gt;<a class="code" href="classllvm_1_1LoadSDNode.html#a3ded48ce66b58b7e7e143991df5dbfae">getBasePtr</a>(), EVT,</div><div class="line"><a name="l05438"></a><span class="lineno"> 5438</span>&#160;                                     LN0-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a89e2b5e3fb867b4040f893c6ae3d2132">getMemOperand</a>());</div><div class="line"><a name="l05439"></a><span class="lineno"> 5439</span>&#160;    CombineTo(N, ExtLoad);</div><div class="line"><a name="l05440"></a><span class="lineno"> 5440</span>&#160;    CombineTo(N0.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>(), ExtLoad, ExtLoad.getValue(1));</div><div class="line"><a name="l05441"></a><span class="lineno"> 5441</span>&#160;    AddToWorkList(ExtLoad.getNode());</div><div class="line"><a name="l05442"></a><span class="lineno"> 5442</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(N, 0);   <span class="comment">// Return N so it doesn&#39;t get rechecked!</span></div><div class="line"><a name="l05443"></a><span class="lineno"> 5443</span>&#160;  }</div><div class="line"><a name="l05444"></a><span class="lineno"> 5444</span>&#160;  <span class="comment">// fold (sext_inreg (zextload x)) -&gt; (sextload x) iff load has one use</span></div><div class="line"><a name="l05445"></a><span class="lineno"> 5445</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1ISD.html#a35edacef22fcaed7a8681fa573476131">ISD::isZEXTLoad</a>(N0.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()) &amp;&amp; <a class="code" href="namespacellvm_1_1ISD.html#a7da84980dd2ee06405d74303cfb90485">ISD::isUNINDEXEDLoad</a>(N0.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()) &amp;&amp;</div><div class="line"><a name="l05446"></a><span class="lineno"> 5446</span>&#160;      N0.<a class="code" href="classllvm_1_1SDValue.html#a97b0f24f3e52f030830fca6fbfcbd37d">hasOneUse</a>() &amp;&amp;</div><div class="line"><a name="l05447"></a><span class="lineno"> 5447</span>&#160;      EVT == cast&lt;LoadSDNode&gt;(N0)-&gt;getMemoryVT() &amp;&amp;</div><div class="line"><a name="l05448"></a><span class="lineno"> 5448</span>&#160;      ((!LegalOperations &amp;&amp; !cast&lt;LoadSDNode&gt;(N0)-&gt;isVolatile()) ||</div><div class="line"><a name="l05449"></a><span class="lineno"> 5449</span>&#160;       TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#ad85f712b9e49629c2c160f16521fe91f">isLoadExtLegal</a>(<a class="code" href="namespacellvm_1_1ISD.html#ad4d48171b87ca51ff54c10a436bac4d7a6c61b6125c7901c549f90ee0e443a770">ISD::SEXTLOAD</a>, EVT))) {</div><div class="line"><a name="l05450"></a><span class="lineno"> 5450</span>&#160;    <a class="code" href="classllvm_1_1LoadSDNode.html">LoadSDNode</a> *LN0 = cast&lt;LoadSDNode&gt;(N0);</div><div class="line"><a name="l05451"></a><span class="lineno"> 5451</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> ExtLoad = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#ad6ff413bea6f8195d8e6f29f4fc519c4">getExtLoad</a>(<a class="code" href="namespacellvm_1_1ISD.html#ad4d48171b87ca51ff54c10a436bac4d7a6c61b6125c7901c549f90ee0e443a770">ISD::SEXTLOAD</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT,</div><div class="line"><a name="l05452"></a><span class="lineno"> 5452</span>&#160;                                     LN0-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#ae3cb6fbf8c8cb79e10ac61bd98c85211">getChain</a>(),</div><div class="line"><a name="l05453"></a><span class="lineno"> 5453</span>&#160;                                     LN0-&gt;<a class="code" href="classllvm_1_1LoadSDNode.html#a3ded48ce66b58b7e7e143991df5dbfae">getBasePtr</a>(), EVT,</div><div class="line"><a name="l05454"></a><span class="lineno"> 5454</span>&#160;                                     LN0-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a89e2b5e3fb867b4040f893c6ae3d2132">getMemOperand</a>());</div><div class="line"><a name="l05455"></a><span class="lineno"> 5455</span>&#160;    CombineTo(N, ExtLoad);</div><div class="line"><a name="l05456"></a><span class="lineno"> 5456</span>&#160;    CombineTo(N0.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>(), ExtLoad, ExtLoad.getValue(1));</div><div class="line"><a name="l05457"></a><span class="lineno"> 5457</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(N, 0);   <span class="comment">// Return N so it doesn&#39;t get rechecked!</span></div><div class="line"><a name="l05458"></a><span class="lineno"> 5458</span>&#160;  }</div><div class="line"><a name="l05459"></a><span class="lineno"> 5459</span>&#160;</div><div class="line"><a name="l05460"></a><span class="lineno"> 5460</span>&#160;  <span class="comment">// Form (sext_inreg (bswap &gt;&gt; 16)) or (sext_inreg (rotl (bswap) 16))</span></div><div class="line"><a name="l05461"></a><span class="lineno"> 5461</span>&#160;  <span class="keywordflow">if</span> (EVTBits &lt;= 16 &amp;&amp; N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7415ab9f2172c59a2ee7c7a02afa56a4">ISD::OR</a>) {</div><div class="line"><a name="l05462"></a><span class="lineno"> 5462</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> BSwap = MatchBSwapHWordLow(N0.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>(), N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0),</div><div class="line"><a name="l05463"></a><span class="lineno"> 5463</span>&#160;                                       N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1), <span class="keyword">false</span>);</div><div class="line"><a name="l05464"></a><span class="lineno"> 5464</span>&#160;    <span class="keywordflow">if</span> (BSwap.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>() != 0)</div><div class="line"><a name="l05465"></a><span class="lineno"> 5465</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110aaa59dd5ec37f21905436b354c0292d9e">ISD::SIGN_EXTEND_INREG</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT,</div><div class="line"><a name="l05466"></a><span class="lineno"> 5466</span>&#160;                         BSwap, N1);</div><div class="line"><a name="l05467"></a><span class="lineno"> 5467</span>&#160;  }</div><div class="line"><a name="l05468"></a><span class="lineno"> 5468</span>&#160;</div><div class="line"><a name="l05469"></a><span class="lineno"> 5469</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l05470"></a><span class="lineno"> 5470</span>&#160;}</div><div class="line"><a name="l05471"></a><span class="lineno"> 5471</span>&#160;</div><div class="line"><a name="l05472"></a><span class="lineno"> 5472</span>&#160;<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::visitTRUNCATE(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N) {</div><div class="line"><a name="l05473"></a><span class="lineno"> 5473</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N0 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0);</div><div class="line"><a name="l05474"></a><span class="lineno"> 5474</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> VT = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(0);</div><div class="line"><a name="l05475"></a><span class="lineno"> 5475</span>&#160;  <span class="keywordtype">bool</span> isLE = TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a7fe87806292e4bb35d59a51930f3ae0e">isLittleEndian</a>();</div><div class="line"><a name="l05476"></a><span class="lineno"> 5476</span>&#160;</div><div class="line"><a name="l05477"></a><span class="lineno"> 5477</span>&#160;  <span class="comment">// noop truncate</span></div><div class="line"><a name="l05478"></a><span class="lineno"> 5478</span>&#160;  <span class="keywordflow">if</span> (N0.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>() == N-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(0))</div><div class="line"><a name="l05479"></a><span class="lineno"> 5479</span>&#160;    <span class="keywordflow">return</span> N0;</div><div class="line"><a name="l05480"></a><span class="lineno"> 5480</span>&#160;  <span class="comment">// fold (truncate c1) -&gt; c1</span></div><div class="line"><a name="l05481"></a><span class="lineno"> 5481</span>&#160;  <span class="keywordflow">if</span> (isa&lt;ConstantSDNode&gt;(N0))</div><div class="line"><a name="l05482"></a><span class="lineno"> 5482</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ae690127648393001a7d5b93dc23da7b3">ISD::TRUNCATE</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N0);</div><div class="line"><a name="l05483"></a><span class="lineno"> 5483</span>&#160;  <span class="comment">// fold (truncate (truncate x)) -&gt; (truncate x)</span></div><div class="line"><a name="l05484"></a><span class="lineno"> 5484</span>&#160;  <span class="keywordflow">if</span> (N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ae690127648393001a7d5b93dc23da7b3">ISD::TRUNCATE</a>)</div><div class="line"><a name="l05485"></a><span class="lineno"> 5485</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ae690127648393001a7d5b93dc23da7b3">ISD::TRUNCATE</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0));</div><div class="line"><a name="l05486"></a><span class="lineno"> 5486</span>&#160;  <span class="comment">// fold (truncate (ext x)) -&gt; (ext x) or (truncate x) or x</span></div><div class="line"><a name="l05487"></a><span class="lineno"> 5487</span>&#160;  <span class="keywordflow">if</span> (N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a93fdf85eff945f1a668b4915a051453e">ISD::ZERO_EXTEND</a> ||</div><div class="line"><a name="l05488"></a><span class="lineno"> 5488</span>&#160;      N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a5183f3d72924bc7c77ba8d3f5de9f602">ISD::SIGN_EXTEND</a> ||</div><div class="line"><a name="l05489"></a><span class="lineno"> 5489</span>&#160;      N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a27d5d8ef82302b739ba3ca8be1a5513d">ISD::ANY_EXTEND</a>) {</div><div class="line"><a name="l05490"></a><span class="lineno"> 5490</span>&#160;    <span class="keywordflow">if</span> (N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>().<a class="code" href="structllvm_1_1EVT.html#a5ebe5227fe53e0dcf4102a6ebf1594a2">bitsLT</a>(VT))</div><div class="line"><a name="l05491"></a><span class="lineno"> 5491</span>&#160;      <span class="comment">// if the source is smaller than the dest, we still need an extend</span></div><div class="line"><a name="l05492"></a><span class="lineno"> 5492</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>(), <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT,</div><div class="line"><a name="l05493"></a><span class="lineno"> 5493</span>&#160;                         N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0));</div><div class="line"><a name="l05494"></a><span class="lineno"> 5494</span>&#160;    <span class="keywordflow">if</span> (N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>().<a class="code" href="structllvm_1_1EVT.html#ac267a86695d58fe541ef96f8c60c1b0f">bitsGT</a>(VT))</div><div class="line"><a name="l05495"></a><span class="lineno"> 5495</span>&#160;      <span class="comment">// if the source is larger than the dest, than we just need the truncate</span></div><div class="line"><a name="l05496"></a><span class="lineno"> 5496</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ae690127648393001a7d5b93dc23da7b3">ISD::TRUNCATE</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0));</div><div class="line"><a name="l05497"></a><span class="lineno"> 5497</span>&#160;    <span class="comment">// if the source and dest are the same type, we can drop both the extend</span></div><div class="line"><a name="l05498"></a><span class="lineno"> 5498</span>&#160;    <span class="comment">// and the truncate.</span></div><div class="line"><a name="l05499"></a><span class="lineno"> 5499</span>&#160;    <span class="keywordflow">return</span> N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0);</div><div class="line"><a name="l05500"></a><span class="lineno"> 5500</span>&#160;  }</div><div class="line"><a name="l05501"></a><span class="lineno"> 5501</span>&#160;</div><div class="line"><a name="l05502"></a><span class="lineno"> 5502</span>&#160;  <span class="comment">// Fold extract-and-trunc into a narrow extract. For example:</span></div><div class="line"><a name="l05503"></a><span class="lineno"> 5503</span>&#160;  <span class="comment">//   i64 x = EXTRACT_VECTOR_ELT(v2i64 val, i32 1)</span></div><div class="line"><a name="l05504"></a><span class="lineno"> 5504</span>&#160;  <span class="comment">//   i32 y = TRUNCATE(i64 x)</span></div><div class="line"><a name="l05505"></a><span class="lineno"> 5505</span>&#160;  <span class="comment">//        -- becomes --</span></div><div class="line"><a name="l05506"></a><span class="lineno"> 5506</span>&#160;  <span class="comment">//   v16i8 b = BITCAST (v2i64 val)</span></div><div class="line"><a name="l05507"></a><span class="lineno"> 5507</span>&#160;  <span class="comment">//   i8 x = EXTRACT_VECTOR_ELT(v16i8 b, i32 8)</span></div><div class="line"><a name="l05508"></a><span class="lineno"> 5508</span>&#160;  <span class="comment">//</span></div><div class="line"><a name="l05509"></a><span class="lineno"> 5509</span>&#160;  <span class="comment">// Note: We only run this optimization after type legalization (which often</span></div><div class="line"><a name="l05510"></a><span class="lineno"> 5510</span>&#160;  <span class="comment">// creates this pattern) and before operation legalization after which</span></div><div class="line"><a name="l05511"></a><span class="lineno"> 5511</span>&#160;  <span class="comment">// we need to be more careful about the vector instructions that we generate.</span></div><div class="line"><a name="l05512"></a><span class="lineno"> 5512</span>&#160;  <span class="keywordflow">if</span> (N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9329e79f62e9ab9b41cfbcafd314bcbd">ISD::EXTRACT_VECTOR_ELT</a> &amp;&amp;</div><div class="line"><a name="l05513"></a><span class="lineno"> 5513</span>&#160;      LegalTypes &amp;&amp; !LegalOperations &amp;&amp; N0-&gt;<a class="code" href="classllvm_1_1SDNode.html#a52753947fce3a01b1c18dd4713c587e8">hasOneUse</a>()) {</div><div class="line"><a name="l05514"></a><span class="lineno"> 5514</span>&#160;</div><div class="line"><a name="l05515"></a><span class="lineno"> 5515</span>&#160;    <a class="code" href="structllvm_1_1EVT.html">EVT</a> VecTy = N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>();</div><div class="line"><a name="l05516"></a><span class="lineno"> 5516</span>&#160;    <a class="code" href="structllvm_1_1EVT.html">EVT</a> ExTy = N0.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>();</div><div class="line"><a name="l05517"></a><span class="lineno"> 5517</span>&#160;    <a class="code" href="structllvm_1_1EVT.html">EVT</a> TrTy = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(0);</div><div class="line"><a name="l05518"></a><span class="lineno"> 5518</span>&#160;</div><div class="line"><a name="l05519"></a><span class="lineno"> 5519</span>&#160;    <span class="keywordtype">unsigned</span> NumElem = VecTy.<a class="code" href="structllvm_1_1EVT.html#a42bca41d2438197c12b6db2c710a959c">getVectorNumElements</a>();</div><div class="line"><a name="l05520"></a><span class="lineno"> 5520</span>&#160;    <span class="keywordtype">unsigned</span> SizeRatio = ExTy.<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>()/TrTy.<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>();</div><div class="line"><a name="l05521"></a><span class="lineno"> 5521</span>&#160;</div><div class="line"><a name="l05522"></a><span class="lineno"> 5522</span>&#160;    <a class="code" href="structllvm_1_1EVT.html">EVT</a> NVT = <a class="code" href="structllvm_1_1EVT.html#a18c2edf1939f6e87f1e586b815f398cd">EVT::getVectorVT</a>(*DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a39c6dff47b8dbd25cfaf6336c7056077">getContext</a>(), TrTy, SizeRatio * NumElem);</div><div class="line"><a name="l05523"></a><span class="lineno"> 5523</span>&#160;    assert(NVT.<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>() == VecTy.<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>() &amp;&amp; <span class="stringliteral">&quot;Invalid Size&quot;</span>);</div><div class="line"><a name="l05524"></a><span class="lineno"> 5524</span>&#160;</div><div class="line"><a name="l05525"></a><span class="lineno"> 5525</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> EltNo = N0-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(1);</div><div class="line"><a name="l05526"></a><span class="lineno"> 5526</span>&#160;    <span class="keywordflow">if</span> (isa&lt;ConstantSDNode&gt;(EltNo) &amp;&amp; isTypeLegal(NVT)) {</div><div class="line"><a name="l05527"></a><span class="lineno"> 5527</span>&#160;      <span class="keywordtype">int</span> Elt = cast&lt;ConstantSDNode&gt;(EltNo)-&gt;getZExtValue();</div><div class="line"><a name="l05528"></a><span class="lineno"> 5528</span>&#160;      <a class="code" href="structllvm_1_1EVT.html">EVT</a> IndexTy = TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a867f81380094404dbe04ed9b7bc26a99">getVectorIdxTy</a>();</div><div class="line"><a name="l05529"></a><span class="lineno"> 5529</span>&#160;      <span class="keywordtype">int</span> Index = isLE ? (Elt*SizeRatio) : (Elt*SizeRatio + (SizeRatio-1));</div><div class="line"><a name="l05530"></a><span class="lineno"> 5530</span>&#160;</div><div class="line"><a name="l05531"></a><span class="lineno"> 5531</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> V = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a412ddf522b53f07690a86bffba1278e7">ISD::BITCAST</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N),</div><div class="line"><a name="l05532"></a><span class="lineno"> 5532</span>&#160;                              NVT, N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0));</div><div class="line"><a name="l05533"></a><span class="lineno"> 5533</span>&#160;</div><div class="line"><a name="l05534"></a><span class="lineno"> 5534</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9329e79f62e9ab9b41cfbcafd314bcbd">ISD::EXTRACT_VECTOR_ELT</a>,</div><div class="line"><a name="l05535"></a><span class="lineno"> 5535</span>&#160;                         <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), TrTy, V,</div><div class="line"><a name="l05536"></a><span class="lineno"> 5536</span>&#160;                         DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(Index, IndexTy));</div><div class="line"><a name="l05537"></a><span class="lineno"> 5537</span>&#160;    }</div><div class="line"><a name="l05538"></a><span class="lineno"> 5538</span>&#160;  }</div><div class="line"><a name="l05539"></a><span class="lineno"> 5539</span>&#160;</div><div class="line"><a name="l05540"></a><span class="lineno"> 5540</span>&#160;  <span class="comment">// Fold a series of buildvector, bitcast, and truncate if possible.</span></div><div class="line"><a name="l05541"></a><span class="lineno"> 5541</span>&#160;  <span class="comment">// For example fold</span></div><div class="line"><a name="l05542"></a><span class="lineno"> 5542</span>&#160;  <span class="comment">//   (2xi32 trunc (bitcast ((4xi32)buildvector x, x, y, y) 2xi64)) to</span></div><div class="line"><a name="l05543"></a><span class="lineno"> 5543</span>&#160;  <span class="comment">//   (2xi32 (buildvector x, y)).</span></div><div class="line"><a name="l05544"></a><span class="lineno"> 5544</span>&#160;  <span class="keywordflow">if</span> (Level == <a class="code" href="namespacellvm.html#aa6d856e4879bb775617f8c3634773b7aa805f5e0d60c9ebc5b134bc9190569a50">AfterLegalizeVectorOps</a> &amp;&amp; VT.<a class="code" href="structllvm_1_1EVT.html#a73f7c824cad61a47c21bf6d652ae2fd7">isVector</a>() &amp;&amp;</div><div class="line"><a name="l05545"></a><span class="lineno"> 5545</span>&#160;      N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a412ddf522b53f07690a86bffba1278e7">ISD::BITCAST</a> &amp;&amp; N0.<a class="code" href="classllvm_1_1SDValue.html#a97b0f24f3e52f030830fca6fbfcbd37d">hasOneUse</a>() &amp;&amp;</div><div class="line"><a name="l05546"></a><span class="lineno"> 5546</span>&#160;      N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110aff6f73b624fecca7dbe94259f9437e32">ISD::BUILD_VECTOR</a> &amp;&amp;</div><div class="line"><a name="l05547"></a><span class="lineno"> 5547</span>&#160;      N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a97b0f24f3e52f030830fca6fbfcbd37d">hasOneUse</a>()) {</div><div class="line"><a name="l05548"></a><span class="lineno"> 5548</span>&#160;</div><div class="line"><a name="l05549"></a><span class="lineno"> 5549</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> BuildVect = N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0);</div><div class="line"><a name="l05550"></a><span class="lineno"> 5550</span>&#160;    <a class="code" href="structllvm_1_1EVT.html">EVT</a> BuildVectEltTy = BuildVect.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>().<a class="code" href="structllvm_1_1EVT.html#a3a07c062cc9330acd8e8c4e3930cbb25">getVectorElementType</a>();</div><div class="line"><a name="l05551"></a><span class="lineno"> 5551</span>&#160;    <a class="code" href="structllvm_1_1EVT.html">EVT</a> TruncVecEltTy = VT.<a class="code" href="structllvm_1_1EVT.html#a3a07c062cc9330acd8e8c4e3930cbb25">getVectorElementType</a>();</div><div class="line"><a name="l05552"></a><span class="lineno"> 5552</span>&#160;</div><div class="line"><a name="l05553"></a><span class="lineno"> 5553</span>&#160;    <span class="comment">// Check that the element types match.</span></div><div class="line"><a name="l05554"></a><span class="lineno"> 5554</span>&#160;    <span class="keywordflow">if</span> (BuildVectEltTy == TruncVecEltTy) {</div><div class="line"><a name="l05555"></a><span class="lineno"> 5555</span>&#160;      <span class="comment">// Now we only need to compute the offset of the truncated elements.</span></div><div class="line"><a name="l05556"></a><span class="lineno"> 5556</span>&#160;      <span class="keywordtype">unsigned</span> BuildVecNumElts =  BuildVect.<a class="code" href="classllvm_1_1SDValue.html#a5f0447ef8ec128563ad131b76e5062bd">getNumOperands</a>();</div><div class="line"><a name="l05557"></a><span class="lineno"> 5557</span>&#160;      <span class="keywordtype">unsigned</span> TruncVecNumElts = VT.<a class="code" href="structllvm_1_1EVT.html#a42bca41d2438197c12b6db2c710a959c">getVectorNumElements</a>();</div><div class="line"><a name="l05558"></a><span class="lineno"> 5558</span>&#160;      <span class="keywordtype">unsigned</span> TruncEltOffset = BuildVecNumElts / TruncVecNumElts;</div><div class="line"><a name="l05559"></a><span class="lineno"> 5559</span>&#160;</div><div class="line"><a name="l05560"></a><span class="lineno"> 5560</span>&#160;      assert((BuildVecNumElts % TruncVecNumElts) == 0 &amp;&amp;</div><div class="line"><a name="l05561"></a><span class="lineno"> 5561</span>&#160;             <span class="stringliteral">&quot;Invalid number of elements&quot;</span>);</div><div class="line"><a name="l05562"></a><span class="lineno"> 5562</span>&#160;</div><div class="line"><a name="l05563"></a><span class="lineno"> 5563</span>&#160;      <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;SDValue, 8&gt;</a> Opnds;</div><div class="line"><a name="l05564"></a><span class="lineno"> 5564</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0, e = BuildVecNumElts; <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != e; <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> += TruncEltOffset)</div><div class="line"><a name="l05565"></a><span class="lineno"> 5565</span>&#160;        Opnds.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(BuildVect.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>));</div><div class="line"><a name="l05566"></a><span class="lineno"> 5566</span>&#160;</div><div class="line"><a name="l05567"></a><span class="lineno"> 5567</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110aff6f73b624fecca7dbe94259f9437e32">ISD::BUILD_VECTOR</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, &amp;Opnds[0],</div><div class="line"><a name="l05568"></a><span class="lineno"> 5568</span>&#160;                         Opnds.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#a22a311dfe4c28a897de8a9365a4f0a84">size</a>());</div><div class="line"><a name="l05569"></a><span class="lineno"> 5569</span>&#160;    }</div><div class="line"><a name="l05570"></a><span class="lineno"> 5570</span>&#160;  }</div><div class="line"><a name="l05571"></a><span class="lineno"> 5571</span>&#160;</div><div class="line"><a name="l05572"></a><span class="lineno"> 5572</span>&#160;  <span class="comment">// See if we can simplify the input to this truncate through knowledge that</span></div><div class="line"><a name="l05573"></a><span class="lineno"> 5573</span>&#160;  <span class="comment">// only the low bits are being used.</span></div><div class="line"><a name="l05574"></a><span class="lineno"> 5574</span>&#160;  <span class="comment">// For example &quot;trunc (or (shl x, 8), y)&quot; // -&gt; trunc y</span></div><div class="line"><a name="l05575"></a><span class="lineno"> 5575</span>&#160;  <span class="comment">// Currently we only perform this optimization on scalars because vectors</span></div><div class="line"><a name="l05576"></a><span class="lineno"> 5576</span>&#160;  <span class="comment">// may have different active low bits.</span></div><div class="line"><a name="l05577"></a><span class="lineno"> 5577</span>&#160;  <span class="keywordflow">if</span> (!VT.<a class="code" href="structllvm_1_1EVT.html#a73f7c824cad61a47c21bf6d652ae2fd7">isVector</a>()) {</div><div class="line"><a name="l05578"></a><span class="lineno"> 5578</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Shorter =</div><div class="line"><a name="l05579"></a><span class="lineno"> 5579</span>&#160;      GetDemandedBits(N0, <a class="code" href="classllvm_1_1APInt.html#ad960e1ff48d25c382b6d28e7961f074e">APInt::getLowBitsSet</a>(N0.<a class="code" href="classllvm_1_1SDValue.html#a70aa652293da070dfe5b9fae309d0112">getValueSizeInBits</a>(),</div><div class="line"><a name="l05580"></a><span class="lineno"> 5580</span>&#160;                                               VT.<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>()));</div><div class="line"><a name="l05581"></a><span class="lineno"> 5581</span>&#160;    <span class="keywordflow">if</span> (Shorter.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>())</div><div class="line"><a name="l05582"></a><span class="lineno"> 5582</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ae690127648393001a7d5b93dc23da7b3">ISD::TRUNCATE</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, Shorter);</div><div class="line"><a name="l05583"></a><span class="lineno"> 5583</span>&#160;  }</div><div class="line"><a name="l05584"></a><span class="lineno"> 5584</span>&#160;  <span class="comment">// fold (truncate (load x)) -&gt; (smaller load x)</span></div><div class="line"><a name="l05585"></a><span class="lineno"> 5585</span>&#160;  <span class="comment">// fold (truncate (srl (load x), c)) -&gt; (smaller load (x+c/evtbits))</span></div><div class="line"><a name="l05586"></a><span class="lineno"> 5586</span>&#160;  <span class="keywordflow">if</span> (!LegalTypes || TLI.<a class="code" href="classllvm_1_1TargetLowering.html#ab945eaf78cbe0a5e7cd0dbc3a6b92ae4">isTypeDesirableForOp</a>(N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>(), VT)) {</div><div class="line"><a name="l05587"></a><span class="lineno"> 5587</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Reduced = ReduceLoadWidth(N);</div><div class="line"><a name="l05588"></a><span class="lineno"> 5588</span>&#160;    <span class="keywordflow">if</span> (Reduced.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>())</div><div class="line"><a name="l05589"></a><span class="lineno"> 5589</span>&#160;      <span class="keywordflow">return</span> Reduced;</div><div class="line"><a name="l05590"></a><span class="lineno"> 5590</span>&#160;  }</div><div class="line"><a name="l05591"></a><span class="lineno"> 5591</span>&#160;  <span class="comment">// fold (trunc (concat ... x ...)) -&gt; (concat ..., (trunc x), ...)),</span></div><div class="line"><a name="l05592"></a><span class="lineno"> 5592</span>&#160;  <span class="comment">// where ... are all &#39;undef&#39;.</span></div><div class="line"><a name="l05593"></a><span class="lineno"> 5593</span>&#160;  <span class="keywordflow">if</span> (N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a320898056eadc3254fc601e1362eb9f5">ISD::CONCAT_VECTORS</a> &amp;&amp; !LegalTypes) {</div><div class="line"><a name="l05594"></a><span class="lineno"> 5594</span>&#160;    <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;EVT, 8&gt;</a> VTs;</div><div class="line"><a name="l05595"></a><span class="lineno"> 5595</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> V;</div><div class="line"><a name="l05596"></a><span class="lineno"> 5596</span>&#160;    <span class="keywordtype">unsigned</span> Idx = 0;</div><div class="line"><a name="l05597"></a><span class="lineno"> 5597</span>&#160;    <span class="keywordtype">unsigned</span> NumDefs = 0;</div><div class="line"><a name="l05598"></a><span class="lineno"> 5598</span>&#160;</div><div class="line"><a name="l05599"></a><span class="lineno"> 5599</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0, e = N0.<a class="code" href="classllvm_1_1SDValue.html#a5f0447ef8ec128563ad131b76e5062bd">getNumOperands</a>(); <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != e; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l05600"></a><span class="lineno"> 5600</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> <a class="code" href="namespacellvm.html#a6569d00d31a5d74e563e2f39f82271ab">X</a> = N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l05601"></a><span class="lineno"> 5601</span>&#160;      <span class="keywordflow">if</span> (X.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() != <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7c6d8f265e9e16e5debdb9a536b55d3d">ISD::UNDEF</a>) {</div><div class="line"><a name="l05602"></a><span class="lineno"> 5602</span>&#160;        V = <a class="code" href="namespacellvm.html#a6569d00d31a5d74e563e2f39f82271ab">X</a>;</div><div class="line"><a name="l05603"></a><span class="lineno"> 5603</span>&#160;        Idx = <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div><div class="line"><a name="l05604"></a><span class="lineno"> 5604</span>&#160;        NumDefs++;</div><div class="line"><a name="l05605"></a><span class="lineno"> 5605</span>&#160;      }</div><div class="line"><a name="l05606"></a><span class="lineno"> 5606</span>&#160;      <span class="comment">// Stop if more than one members are non-undef.</span></div><div class="line"><a name="l05607"></a><span class="lineno"> 5607</span>&#160;      <span class="keywordflow">if</span> (NumDefs &gt; 1)</div><div class="line"><a name="l05608"></a><span class="lineno"> 5608</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l05609"></a><span class="lineno"> 5609</span>&#160;      VTs.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(<a class="code" href="structllvm_1_1EVT.html#a18c2edf1939f6e87f1e586b815f398cd">EVT::getVectorVT</a>(*DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a39c6dff47b8dbd25cfaf6336c7056077">getContext</a>(),</div><div class="line"><a name="l05610"></a><span class="lineno"> 5610</span>&#160;                                     VT.<a class="code" href="structllvm_1_1EVT.html#a3a07c062cc9330acd8e8c4e3930cbb25">getVectorElementType</a>(),</div><div class="line"><a name="l05611"></a><span class="lineno"> 5611</span>&#160;                                     X.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>().<a class="code" href="structllvm_1_1EVT.html#a42bca41d2438197c12b6db2c710a959c">getVectorNumElements</a>()));</div><div class="line"><a name="l05612"></a><span class="lineno"> 5612</span>&#160;    }</div><div class="line"><a name="l05613"></a><span class="lineno"> 5613</span>&#160;</div><div class="line"><a name="l05614"></a><span class="lineno"> 5614</span>&#160;    <span class="keywordflow">if</span> (NumDefs == 0)</div><div class="line"><a name="l05615"></a><span class="lineno"> 5615</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a5b0e59823444a55c295af279611a9d24">getUNDEF</a>(VT);</div><div class="line"><a name="l05616"></a><span class="lineno"> 5616</span>&#160;</div><div class="line"><a name="l05617"></a><span class="lineno"> 5617</span>&#160;    <span class="keywordflow">if</span> (NumDefs == 1) {</div><div class="line"><a name="l05618"></a><span class="lineno"> 5618</span>&#160;      assert(V.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>() &amp;&amp; <span class="stringliteral">&quot;The single defined operand is empty!&quot;</span>);</div><div class="line"><a name="l05619"></a><span class="lineno"> 5619</span>&#160;      <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;SDValue, 8&gt;</a> Opnds;</div><div class="line"><a name="l05620"></a><span class="lineno"> 5620</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0, e = VTs.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#a22a311dfe4c28a897de8a9365a4f0a84">size</a>(); <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != e; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l05621"></a><span class="lineno"> 5621</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != Idx) {</div><div class="line"><a name="l05622"></a><span class="lineno"> 5622</span>&#160;          Opnds.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a5b0e59823444a55c295af279611a9d24">getUNDEF</a>(VTs[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>]));</div><div class="line"><a name="l05623"></a><span class="lineno"> 5623</span>&#160;          <span class="keywordflow">continue</span>;</div><div class="line"><a name="l05624"></a><span class="lineno"> 5624</span>&#160;        }</div><div class="line"><a name="l05625"></a><span class="lineno"> 5625</span>&#160;        <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> <a class="code" href="namespacellvm_1_1A64CC.html#af5804bc0518be9568f73db566e4d6f46a2a6c4724226f9ccea96d35fd4c131af8">NV</a> = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ae690127648393001a7d5b93dc23da7b3">ISD::TRUNCATE</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(V), VTs[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>], V);</div><div class="line"><a name="l05626"></a><span class="lineno"> 5626</span>&#160;        AddToWorkList(NV.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l05627"></a><span class="lineno"> 5627</span>&#160;        Opnds.push_back(NV);</div><div class="line"><a name="l05628"></a><span class="lineno"> 5628</span>&#160;      }</div><div class="line"><a name="l05629"></a><span class="lineno"> 5629</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a320898056eadc3254fc601e1362eb9f5">ISD::CONCAT_VECTORS</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT,</div><div class="line"><a name="l05630"></a><span class="lineno"> 5630</span>&#160;                         &amp;Opnds[0], Opnds.size());</div><div class="line"><a name="l05631"></a><span class="lineno"> 5631</span>&#160;    }</div><div class="line"><a name="l05632"></a><span class="lineno"> 5632</span>&#160;  }</div><div class="line"><a name="l05633"></a><span class="lineno"> 5633</span>&#160;</div><div class="line"><a name="l05634"></a><span class="lineno"> 5634</span>&#160;  <span class="comment">// Simplify the operands using demanded-bits information.</span></div><div class="line"><a name="l05635"></a><span class="lineno"> 5635</span>&#160;  <span class="keywordflow">if</span> (!VT.<a class="code" href="structllvm_1_1EVT.html#a73f7c824cad61a47c21bf6d652ae2fd7">isVector</a>() &amp;&amp;</div><div class="line"><a name="l05636"></a><span class="lineno"> 5636</span>&#160;      SimplifyDemandedBits(<a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(N, 0)))</div><div class="line"><a name="l05637"></a><span class="lineno"> 5637</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(N, 0);</div><div class="line"><a name="l05638"></a><span class="lineno"> 5638</span>&#160;</div><div class="line"><a name="l05639"></a><span class="lineno"> 5639</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l05640"></a><span class="lineno"> 5640</span>&#160;}</div><div class="line"><a name="l05641"></a><span class="lineno"> 5641</span>&#160;</div><div class="line"><a name="l05642"></a><span class="lineno"><a class="line" href="DAGCombiner_8cpp.html#ab765652bbe47da8cc58c7f449d8f5fd7"> 5642</a></span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *<a class="code" href="DAGCombiner_8cpp.html#ab765652bbe47da8cc58c7f449d8f5fd7">getBuildPairElt</a>(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N, <span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l05643"></a><span class="lineno"> 5643</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Elt = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(i);</div><div class="line"><a name="l05644"></a><span class="lineno"> 5644</span>&#160;  <span class="keywordflow">if</span> (Elt.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() != <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a01c94937492f3ac3fb1e0be8eb0b9ef1">ISD::MERGE_VALUES</a>)</div><div class="line"><a name="l05645"></a><span class="lineno"> 5645</span>&#160;    <span class="keywordflow">return</span> Elt.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>();</div><div class="line"><a name="l05646"></a><span class="lineno"> 5646</span>&#160;  <span class="keywordflow">return</span> Elt.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(Elt.<a class="code" href="classllvm_1_1SDValue.html#a64881a6ca7154fccaeb92cdb1e1e745e">getResNo</a>()).getNode();</div><div class="line"><a name="l05647"></a><span class="lineno"> 5647</span>&#160;}</div><div class="line"><a name="l05648"></a><span class="lineno"> 5648</span>&#160;<span class="comment"></span></div><div class="line"><a name="l05649"></a><span class="lineno"> 5649</span>&#160;<span class="comment">/// CombineConsecutiveLoads - build_pair (load, load) -&gt; load</span></div><div class="line"><a name="l05650"></a><span class="lineno"> 5650</span>&#160;<span class="comment">/// if load locations are consecutive.</span></div><div class="line"><a name="l05651"></a><span class="lineno"> 5651</span>&#160;<span class="comment"></span><a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::CombineConsecutiveLoads(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N, <a class="code" href="structllvm_1_1EVT.html">EVT</a> VT) {</div><div class="line"><a name="l05652"></a><span class="lineno"> 5652</span>&#160;  assert(N-&gt;<a class="code" href="classllvm_1_1SDNode.html#af0d328f3f61168f4ea7d6e4044af4f97">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a41bd84b853e2c03fb1af1f4ca9ebdcaf">ISD::BUILD_PAIR</a>);</div><div class="line"><a name="l05653"></a><span class="lineno"> 5653</span>&#160;</div><div class="line"><a name="l05654"></a><span class="lineno"> 5654</span>&#160;  <a class="code" href="classllvm_1_1LoadSDNode.html">LoadSDNode</a> *LD1 = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1LoadSDNode.html">LoadSDNode</a>&gt;(<a class="code" href="DAGCombiner_8cpp.html#ab765652bbe47da8cc58c7f449d8f5fd7">getBuildPairElt</a>(N, 0));</div><div class="line"><a name="l05655"></a><span class="lineno"> 5655</span>&#160;  <a class="code" href="classllvm_1_1LoadSDNode.html">LoadSDNode</a> *LD2 = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1LoadSDNode.html">LoadSDNode</a>&gt;(<a class="code" href="DAGCombiner_8cpp.html#ab765652bbe47da8cc58c7f449d8f5fd7">getBuildPairElt</a>(N, 1));</div><div class="line"><a name="l05656"></a><span class="lineno"> 5656</span>&#160;  <span class="keywordflow">if</span> (!LD1 || !LD2 || !<a class="code" href="namespacellvm_1_1ISD.html#a15623094a1ed0cd7163dc786e44c87c9">ISD::isNON_EXTLoad</a>(LD1) || !LD1-&gt;hasOneUse() ||</div><div class="line"><a name="l05657"></a><span class="lineno"> 5657</span>&#160;      LD1-&gt;getPointerInfo().getAddrSpace() !=</div><div class="line"><a name="l05658"></a><span class="lineno"> 5658</span>&#160;         LD2-&gt;getPointerInfo().getAddrSpace())</div><div class="line"><a name="l05659"></a><span class="lineno"> 5659</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l05660"></a><span class="lineno"> 5660</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> LD1VT = LD1-&gt;getValueType(0);</div><div class="line"><a name="l05661"></a><span class="lineno"> 5661</span>&#160;</div><div class="line"><a name="l05662"></a><span class="lineno"> 5662</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1ISD.html#a15623094a1ed0cd7163dc786e44c87c9">ISD::isNON_EXTLoad</a>(LD2) &amp;&amp;</div><div class="line"><a name="l05663"></a><span class="lineno"> 5663</span>&#160;      LD2-&gt;hasOneUse() &amp;&amp;</div><div class="line"><a name="l05664"></a><span class="lineno"> 5664</span>&#160;      <span class="comment">// If both are volatile this would reduce the number of volatile loads.</span></div><div class="line"><a name="l05665"></a><span class="lineno"> 5665</span>&#160;      <span class="comment">// If one is volatile it might be ok, but play conservative and bail out.</span></div><div class="line"><a name="l05666"></a><span class="lineno"> 5666</span>&#160;      !LD1-&gt;isVolatile() &amp;&amp;</div><div class="line"><a name="l05667"></a><span class="lineno"> 5667</span>&#160;      !LD2-&gt;isVolatile() &amp;&amp;</div><div class="line"><a name="l05668"></a><span class="lineno"> 5668</span>&#160;      DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a02ff977a0e8963fcbb3c448dcd3a81ea">isConsecutiveLoad</a>(LD2, LD1, LD1VT.<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>()/8, 1)) {</div><div class="line"><a name="l05669"></a><span class="lineno"> 5669</span>&#160;    <span class="keywordtype">unsigned</span> <a class="code" href="ARMSubtarget_8cpp.html#a4bd80d4e433d9f72af26b364036900dc">Align</a> = LD1-&gt;getAlignment();</div><div class="line"><a name="l05670"></a><span class="lineno"> 5670</span>&#160;    <span class="keywordtype">unsigned</span> NewAlign = TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#adc25bcc279ccfb5b867c2b7b8eedaa9b">getDataLayout</a>()-&gt;</div><div class="line"><a name="l05671"></a><span class="lineno"> 5671</span>&#160;      getABITypeAlignment(VT.<a class="code" href="structllvm_1_1EVT.html#a226345d0c8262e9469d30a993d1656ff">getTypeForEVT</a>(*DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a39c6dff47b8dbd25cfaf6336c7056077">getContext</a>()));</div><div class="line"><a name="l05672"></a><span class="lineno"> 5672</span>&#160;</div><div class="line"><a name="l05673"></a><span class="lineno"> 5673</span>&#160;    <span class="keywordflow">if</span> (NewAlign &lt;= Align &amp;&amp;</div><div class="line"><a name="l05674"></a><span class="lineno"> 5674</span>&#160;        (!LegalOperations || TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a055b3905dbbc16fae11510b9ebd1e00c">isOperationLegal</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a269b81f007000306e3e69d0d290c2159">ISD::LOAD</a>, VT)))</div><div class="line"><a name="l05675"></a><span class="lineno"> 5675</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#ab8395be5698f080c0036d866e121a478">getLoad</a>(VT, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), LD1-&gt;getChain(),</div><div class="line"><a name="l05676"></a><span class="lineno"> 5676</span>&#160;                         LD1-&gt;getBasePtr(), LD1-&gt;getPointerInfo(),</div><div class="line"><a name="l05677"></a><span class="lineno"> 5677</span>&#160;                         <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <a class="code" href="ARMSubtarget_8cpp.html#a4bd80d4e433d9f72af26b364036900dc">Align</a>);</div><div class="line"><a name="l05678"></a><span class="lineno"> 5678</span>&#160;  }</div><div class="line"><a name="l05679"></a><span class="lineno"> 5679</span>&#160;</div><div class="line"><a name="l05680"></a><span class="lineno"> 5680</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l05681"></a><span class="lineno"> 5681</span>&#160;}</div><div class="line"><a name="l05682"></a><span class="lineno"> 5682</span>&#160;</div><div class="line"><a name="l05683"></a><span class="lineno"> 5683</span>&#160;<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::visitBITCAST(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N) {</div><div class="line"><a name="l05684"></a><span class="lineno"> 5684</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N0 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0);</div><div class="line"><a name="l05685"></a><span class="lineno"> 5685</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> VT = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(0);</div><div class="line"><a name="l05686"></a><span class="lineno"> 5686</span>&#160;</div><div class="line"><a name="l05687"></a><span class="lineno"> 5687</span>&#160;  <span class="comment">// If the input is a BUILD_VECTOR with all constant elements, fold this now.</span></div><div class="line"><a name="l05688"></a><span class="lineno"> 5688</span>&#160;  <span class="comment">// Only do this before legalize, since afterward the target may be depending</span></div><div class="line"><a name="l05689"></a><span class="lineno"> 5689</span>&#160;  <span class="comment">// on the bitconvert.</span></div><div class="line"><a name="l05690"></a><span class="lineno"> 5690</span>&#160;  <span class="comment">// First check to see if this is all constant.</span></div><div class="line"><a name="l05691"></a><span class="lineno"> 5691</span>&#160;  <span class="keywordflow">if</span> (!LegalTypes &amp;&amp;</div><div class="line"><a name="l05692"></a><span class="lineno"> 5692</span>&#160;      N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110aff6f73b624fecca7dbe94259f9437e32">ISD::BUILD_VECTOR</a> &amp;&amp; N0.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()-&gt;<a class="code" href="classllvm_1_1SDNode.html#a52753947fce3a01b1c18dd4713c587e8">hasOneUse</a>() &amp;&amp;</div><div class="line"><a name="l05693"></a><span class="lineno"> 5693</span>&#160;      VT.<a class="code" href="structllvm_1_1EVT.html#a73f7c824cad61a47c21bf6d652ae2fd7">isVector</a>()) {</div><div class="line"><a name="l05694"></a><span class="lineno"> 5694</span>&#160;    <span class="keywordtype">bool</span> isSimple = <span class="keyword">true</span>;</div><div class="line"><a name="l05695"></a><span class="lineno"> 5695</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0, e = N0.<a class="code" href="classllvm_1_1SDValue.html#a5f0447ef8ec128563ad131b76e5062bd">getNumOperands</a>(); <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != e; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div><div class="line"><a name="l05696"></a><span class="lineno"> 5696</span>&#160;      <span class="keywordflow">if</span> (N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>).<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() != <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7c6d8f265e9e16e5debdb9a536b55d3d">ISD::UNDEF</a> &amp;&amp;</div><div class="line"><a name="l05697"></a><span class="lineno"> 5697</span>&#160;          N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>).<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() != <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110aac2f0a84dd2aa5ee4c3f1385e9565f5e">ISD::Constant</a> &amp;&amp;</div><div class="line"><a name="l05698"></a><span class="lineno"> 5698</span>&#160;          N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>).<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() != <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a1be4c8da7c68a4c683de1a98b5cc5b9d">ISD::ConstantFP</a>) {</div><div class="line"><a name="l05699"></a><span class="lineno"> 5699</span>&#160;        isSimple = <span class="keyword">false</span>;</div><div class="line"><a name="l05700"></a><span class="lineno"> 5700</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l05701"></a><span class="lineno"> 5701</span>&#160;      }</div><div class="line"><a name="l05702"></a><span class="lineno"> 5702</span>&#160;</div><div class="line"><a name="l05703"></a><span class="lineno"> 5703</span>&#160;    <a class="code" href="structllvm_1_1EVT.html">EVT</a> DestEltVT = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(0).<a class="code" href="structllvm_1_1EVT.html#a3a07c062cc9330acd8e8c4e3930cbb25">getVectorElementType</a>();</div><div class="line"><a name="l05704"></a><span class="lineno"> 5704</span>&#160;    assert(!DestEltVT.<a class="code" href="structllvm_1_1EVT.html#a73f7c824cad61a47c21bf6d652ae2fd7">isVector</a>() &amp;&amp;</div><div class="line"><a name="l05705"></a><span class="lineno"> 5705</span>&#160;           <span class="stringliteral">&quot;Element type of vector ValueType must not be vector!&quot;</span>);</div><div class="line"><a name="l05706"></a><span class="lineno"> 5706</span>&#160;    <span class="keywordflow">if</span> (isSimple)</div><div class="line"><a name="l05707"></a><span class="lineno"> 5707</span>&#160;      <span class="keywordflow">return</span> ConstantFoldBITCASTofBUILD_VECTOR(N0.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>(), DestEltVT);</div><div class="line"><a name="l05708"></a><span class="lineno"> 5708</span>&#160;  }</div><div class="line"><a name="l05709"></a><span class="lineno"> 5709</span>&#160;</div><div class="line"><a name="l05710"></a><span class="lineno"> 5710</span>&#160;  <span class="comment">// If the input is a constant, let getNode fold it.</span></div><div class="line"><a name="l05711"></a><span class="lineno"> 5711</span>&#160;  <span class="keywordflow">if</span> (isa&lt;ConstantSDNode&gt;(N0) || isa&lt;ConstantFPSDNode&gt;(N0)) {</div><div class="line"><a name="l05712"></a><span class="lineno"> 5712</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Res = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a412ddf522b53f07690a86bffba1278e7">ISD::BITCAST</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N0);</div><div class="line"><a name="l05713"></a><span class="lineno"> 5713</span>&#160;    <span class="keywordflow">if</span> (Res.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>() != <a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>) {</div><div class="line"><a name="l05714"></a><span class="lineno"> 5714</span>&#160;      <span class="keywordflow">if</span> (!LegalOperations ||</div><div class="line"><a name="l05715"></a><span class="lineno"> 5715</span>&#160;          TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a055b3905dbbc16fae11510b9ebd1e00c">isOperationLegal</a>(Res.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()-&gt;<a class="code" href="classllvm_1_1SDNode.html#af0d328f3f61168f4ea7d6e4044af4f97">getOpcode</a>(), VT))</div><div class="line"><a name="l05716"></a><span class="lineno"> 5716</span>&#160;        <span class="keywordflow">return</span> Res;</div><div class="line"><a name="l05717"></a><span class="lineno"> 5717</span>&#160;</div><div class="line"><a name="l05718"></a><span class="lineno"> 5718</span>&#160;      <span class="comment">// Folding it resulted in an illegal node, and it&#39;s too late to</span></div><div class="line"><a name="l05719"></a><span class="lineno"> 5719</span>&#160;      <span class="comment">// do that. Clean up the old node and forego the transformation.</span></div><div class="line"><a name="l05720"></a><span class="lineno"> 5720</span>&#160;      <span class="comment">// Ideally this won&#39;t happen very often, because instcombine</span></div><div class="line"><a name="l05721"></a><span class="lineno"> 5721</span>&#160;      <span class="comment">// and the earlier dagcombine runs (where illegal nodes are</span></div><div class="line"><a name="l05722"></a><span class="lineno"> 5722</span>&#160;      <span class="comment">// permitted) should have folded most of them already.</span></div><div class="line"><a name="l05723"></a><span class="lineno"> 5723</span>&#160;      DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a5f57dcbedc16dced31c61f7bbbb06ded">DeleteNode</a>(Res.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l05724"></a><span class="lineno"> 5724</span>&#160;    }</div><div class="line"><a name="l05725"></a><span class="lineno"> 5725</span>&#160;  }</div><div class="line"><a name="l05726"></a><span class="lineno"> 5726</span>&#160;</div><div class="line"><a name="l05727"></a><span class="lineno"> 5727</span>&#160;  <span class="comment">// (conv (conv x, t1), t2) -&gt; (conv x, t2)</span></div><div class="line"><a name="l05728"></a><span class="lineno"> 5728</span>&#160;  <span class="keywordflow">if</span> (N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a412ddf522b53f07690a86bffba1278e7">ISD::BITCAST</a>)</div><div class="line"><a name="l05729"></a><span class="lineno"> 5729</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a412ddf522b53f07690a86bffba1278e7">ISD::BITCAST</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT,</div><div class="line"><a name="l05730"></a><span class="lineno"> 5730</span>&#160;                       N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0));</div><div class="line"><a name="l05731"></a><span class="lineno"> 5731</span>&#160;</div><div class="line"><a name="l05732"></a><span class="lineno"> 5732</span>&#160;  <span class="comment">// fold (conv (load x)) -&gt; (load (conv*)x)</span></div><div class="line"><a name="l05733"></a><span class="lineno"> 5733</span>&#160;  <span class="comment">// If the resultant load doesn&#39;t need a higher alignment than the original!</span></div><div class="line"><a name="l05734"></a><span class="lineno"> 5734</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1ISD.html#afaaeadcd82b42fc0d385a6247bf7bb52">ISD::isNormalLoad</a>(N0.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()) &amp;&amp; N0.<a class="code" href="classllvm_1_1SDValue.html#a97b0f24f3e52f030830fca6fbfcbd37d">hasOneUse</a>() &amp;&amp;</div><div class="line"><a name="l05735"></a><span class="lineno"> 5735</span>&#160;      <span class="comment">// Do not change the width of a volatile load.</span></div><div class="line"><a name="l05736"></a><span class="lineno"> 5736</span>&#160;      !cast&lt;LoadSDNode&gt;(N0)-&gt;isVolatile() &amp;&amp;</div><div class="line"><a name="l05737"></a><span class="lineno"> 5737</span>&#160;      (!LegalOperations || TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a055b3905dbbc16fae11510b9ebd1e00c">isOperationLegal</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a269b81f007000306e3e69d0d290c2159">ISD::LOAD</a>, VT)) &amp;&amp;</div><div class="line"><a name="l05738"></a><span class="lineno"> 5738</span>&#160;      TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#aebbd7a2d93f67bd693cdac43795dc9d4">isLoadBitCastBeneficial</a>(N0.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>(), VT)) {</div><div class="line"><a name="l05739"></a><span class="lineno"> 5739</span>&#160;    <a class="code" href="classllvm_1_1LoadSDNode.html">LoadSDNode</a> *LN0 = cast&lt;LoadSDNode&gt;(N0);</div><div class="line"><a name="l05740"></a><span class="lineno"> 5740</span>&#160;    <span class="keywordtype">unsigned</span> <a class="code" href="ARMSubtarget_8cpp.html#a4bd80d4e433d9f72af26b364036900dc">Align</a> = TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#adc25bcc279ccfb5b867c2b7b8eedaa9b">getDataLayout</a>()-&gt;</div><div class="line"><a name="l05741"></a><span class="lineno"> 5741</span>&#160;      getABITypeAlignment(VT.<a class="code" href="structllvm_1_1EVT.html#a226345d0c8262e9469d30a993d1656ff">getTypeForEVT</a>(*DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a39c6dff47b8dbd25cfaf6336c7056077">getContext</a>()));</div><div class="line"><a name="l05742"></a><span class="lineno"> 5742</span>&#160;    <span class="keywordtype">unsigned</span> OrigAlign = LN0-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a4f68cd016138440f215ad80c1d6c1e04">getAlignment</a>();</div><div class="line"><a name="l05743"></a><span class="lineno"> 5743</span>&#160;</div><div class="line"><a name="l05744"></a><span class="lineno"> 5744</span>&#160;    <span class="keywordflow">if</span> (Align &lt;= OrigAlign) {</div><div class="line"><a name="l05745"></a><span class="lineno"> 5745</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Load = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#ab8395be5698f080c0036d866e121a478">getLoad</a>(VT, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), LN0-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#ae3cb6fbf8c8cb79e10ac61bd98c85211">getChain</a>(),</div><div class="line"><a name="l05746"></a><span class="lineno"> 5746</span>&#160;                                 LN0-&gt;<a class="code" href="classllvm_1_1LoadSDNode.html#a3ded48ce66b58b7e7e143991df5dbfae">getBasePtr</a>(), LN0-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a2fa8491ab36125d7f5dd38d3a4868934">getPointerInfo</a>(),</div><div class="line"><a name="l05747"></a><span class="lineno"> 5747</span>&#160;                                 LN0-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#acd3bb9ee2ec53fa4be1fdf155b0b5a17">isVolatile</a>(), LN0-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a967ffaf77f64a5deb1e96951e4224112">isNonTemporal</a>(),</div><div class="line"><a name="l05748"></a><span class="lineno"> 5748</span>&#160;                                 LN0-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#ad8e64770a04af6b3da2099477e7c28de">isInvariant</a>(), OrigAlign,</div><div class="line"><a name="l05749"></a><span class="lineno"> 5749</span>&#160;                                 LN0-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a23670ceb5797afa3d45ca1a9b011fd87">getTBAAInfo</a>());</div><div class="line"><a name="l05750"></a><span class="lineno"> 5750</span>&#160;      AddToWorkList(N);</div><div class="line"><a name="l05751"></a><span class="lineno"> 5751</span>&#160;      CombineTo(N0.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>(),</div><div class="line"><a name="l05752"></a><span class="lineno"> 5752</span>&#160;                DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a412ddf522b53f07690a86bffba1278e7">ISD::BITCAST</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N0),</div><div class="line"><a name="l05753"></a><span class="lineno"> 5753</span>&#160;                            N0.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>(), <a class="code" href="namespacellvm_1_1SPII.html#a11e9b8fca4a074643a6a21f444e51406a5069619ca8fdce305534f3fe85091a0f">Load</a>),</div><div class="line"><a name="l05754"></a><span class="lineno"> 5754</span>&#160;                Load.<a class="code" href="classllvm_1_1SDValue.html#a040481b9bda32faa6b1435532405d88f">getValue</a>(1));</div><div class="line"><a name="l05755"></a><span class="lineno"> 5755</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1SPII.html#a11e9b8fca4a074643a6a21f444e51406a5069619ca8fdce305534f3fe85091a0f">Load</a>;</div><div class="line"><a name="l05756"></a><span class="lineno"> 5756</span>&#160;    }</div><div class="line"><a name="l05757"></a><span class="lineno"> 5757</span>&#160;  }</div><div class="line"><a name="l05758"></a><span class="lineno"> 5758</span>&#160;</div><div class="line"><a name="l05759"></a><span class="lineno"> 5759</span>&#160;  <span class="comment">// fold (bitconvert (fneg x)) -&gt; (xor (bitconvert x), signbit)</span></div><div class="line"><a name="l05760"></a><span class="lineno"> 5760</span>&#160;  <span class="comment">// fold (bitconvert (fabs x)) -&gt; (and (bitconvert x), (not signbit))</span></div><div class="line"><a name="l05761"></a><span class="lineno"> 5761</span>&#160;  <span class="comment">// This often reduces constant pool loads.</span></div><div class="line"><a name="l05762"></a><span class="lineno"> 5762</span>&#160;  <span class="keywordflow">if</span> (((N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a6d26c45c040d8f85d577a5f645261d1a">ISD::FNEG</a> &amp;&amp; !TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a814573c6f6263d6f7b463ce0a591781a">isFNegFree</a>(N0.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>())) ||</div><div class="line"><a name="l05763"></a><span class="lineno"> 5763</span>&#160;       (N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a2b4d07600495a563319d6a3dda8dc44d">ISD::FABS</a> &amp;&amp; !TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a03d795b93578bd5b530aa998869fb1ac">isFAbsFree</a>(N0.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>()))) &amp;&amp;</div><div class="line"><a name="l05764"></a><span class="lineno"> 5764</span>&#160;      N0.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()-&gt;<a class="code" href="classllvm_1_1SDNode.html#a52753947fce3a01b1c18dd4713c587e8">hasOneUse</a>() &amp;&amp; VT.<a class="code" href="structllvm_1_1EVT.html#a8cc407ac00df4edd4ec4d5168d6ecb26">isInteger</a>() &amp;&amp;</div><div class="line"><a name="l05765"></a><span class="lineno"> 5765</span>&#160;      !VT.<a class="code" href="structllvm_1_1EVT.html#a73f7c824cad61a47c21bf6d652ae2fd7">isVector</a>() &amp;&amp; !N0.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>().<a class="code" href="structllvm_1_1EVT.html#a73f7c824cad61a47c21bf6d652ae2fd7">isVector</a>()) {</div><div class="line"><a name="l05766"></a><span class="lineno"> 5766</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> NewConv = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a412ddf522b53f07690a86bffba1278e7">ISD::BITCAST</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N0), VT,</div><div class="line"><a name="l05767"></a><span class="lineno"> 5767</span>&#160;                                  N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0));</div><div class="line"><a name="l05768"></a><span class="lineno"> 5768</span>&#160;    AddToWorkList(NewConv.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l05769"></a><span class="lineno"> 5769</span>&#160;</div><div class="line"><a name="l05770"></a><span class="lineno"> 5770</span>&#160;    <a class="code" href="classllvm_1_1APInt.html">APInt</a> SignBit = <a class="code" href="classllvm_1_1APInt.html#a2e5e9f65d911e80a46d3098933794056">APInt::getSignBit</a>(VT.<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>());</div><div class="line"><a name="l05771"></a><span class="lineno"> 5771</span>&#160;    <span class="keywordflow">if</span> (N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a6d26c45c040d8f85d577a5f645261d1a">ISD::FNEG</a>)</div><div class="line"><a name="l05772"></a><span class="lineno"> 5772</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a92febb83e6ba116eb7aae8e7e3f70cc1">ISD::XOR</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT,</div><div class="line"><a name="l05773"></a><span class="lineno"> 5773</span>&#160;                         NewConv, DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(SignBit, VT));</div><div class="line"><a name="l05774"></a><span class="lineno"> 5774</span>&#160;    assert(N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a2b4d07600495a563319d6a3dda8dc44d">ISD::FABS</a>);</div><div class="line"><a name="l05775"></a><span class="lineno"> 5775</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ac513a7da1bf74fb3e3c594da8534f2d2">ISD::AND</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT,</div><div class="line"><a name="l05776"></a><span class="lineno"> 5776</span>&#160;                       NewConv, DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(~SignBit, VT));</div><div class="line"><a name="l05777"></a><span class="lineno"> 5777</span>&#160;  }</div><div class="line"><a name="l05778"></a><span class="lineno"> 5778</span>&#160;</div><div class="line"><a name="l05779"></a><span class="lineno"> 5779</span>&#160;  <span class="comment">// fold (bitconvert (fcopysign cst, x)) -&gt;</span></div><div class="line"><a name="l05780"></a><span class="lineno"> 5780</span>&#160;  <span class="comment">//         (or (and (bitconvert x), sign), (and cst, (not sign)))</span></div><div class="line"><a name="l05781"></a><span class="lineno"> 5781</span>&#160;  <span class="comment">// Note that we don&#39;t handle (copysign x, cst) because this can always be</span></div><div class="line"><a name="l05782"></a><span class="lineno"> 5782</span>&#160;  <span class="comment">// folded to an fneg or fabs.</span></div><div class="line"><a name="l05783"></a><span class="lineno"> 5783</span>&#160;  <span class="keywordflow">if</span> (N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110aeffc3319657e213a530ce583603f7221">ISD::FCOPYSIGN</a> &amp;&amp; N0.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()-&gt;<a class="code" href="classllvm_1_1SDNode.html#a52753947fce3a01b1c18dd4713c587e8">hasOneUse</a>() &amp;&amp;</div><div class="line"><a name="l05784"></a><span class="lineno"> 5784</span>&#160;      isa&lt;ConstantFPSDNode&gt;(N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0)) &amp;&amp;</div><div class="line"><a name="l05785"></a><span class="lineno"> 5785</span>&#160;      VT.<a class="code" href="structllvm_1_1EVT.html#a8cc407ac00df4edd4ec4d5168d6ecb26">isInteger</a>() &amp;&amp; !VT.<a class="code" href="structllvm_1_1EVT.html#a73f7c824cad61a47c21bf6d652ae2fd7">isVector</a>()) {</div><div class="line"><a name="l05786"></a><span class="lineno"> 5786</span>&#160;    <span class="keywordtype">unsigned</span> OrigXWidth = N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1).<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>().<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>();</div><div class="line"><a name="l05787"></a><span class="lineno"> 5787</span>&#160;    <a class="code" href="structllvm_1_1EVT.html">EVT</a> IntXVT = <a class="code" href="structllvm_1_1EVT.html#a752372e170e4e7c595bf8810bb52adf2">EVT::getIntegerVT</a>(*DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a39c6dff47b8dbd25cfaf6336c7056077">getContext</a>(), OrigXWidth);</div><div class="line"><a name="l05788"></a><span class="lineno"> 5788</span>&#160;    <span class="keywordflow">if</span> (isTypeLegal(IntXVT)) {</div><div class="line"><a name="l05789"></a><span class="lineno"> 5789</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> <a class="code" href="namespacellvm.html#a6569d00d31a5d74e563e2f39f82271ab">X</a> = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a412ddf522b53f07690a86bffba1278e7">ISD::BITCAST</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N0),</div><div class="line"><a name="l05790"></a><span class="lineno"> 5790</span>&#160;                              IntXVT, N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1));</div><div class="line"><a name="l05791"></a><span class="lineno"> 5791</span>&#160;      AddToWorkList(X.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l05792"></a><span class="lineno"> 5792</span>&#160;</div><div class="line"><a name="l05793"></a><span class="lineno"> 5793</span>&#160;      <span class="comment">// If X has a different width than the result/lhs, sext it or truncate it.</span></div><div class="line"><a name="l05794"></a><span class="lineno"> 5794</span>&#160;      <span class="keywordtype">unsigned</span> VTWidth = VT.<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>();</div><div class="line"><a name="l05795"></a><span class="lineno"> 5795</span>&#160;      <span class="keywordflow">if</span> (OrigXWidth &lt; VTWidth) {</div><div class="line"><a name="l05796"></a><span class="lineno"> 5796</span>&#160;        X = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a5183f3d72924bc7c77ba8d3f5de9f602">ISD::SIGN_EXTEND</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, X);</div><div class="line"><a name="l05797"></a><span class="lineno"> 5797</span>&#160;        AddToWorkList(X.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l05798"></a><span class="lineno"> 5798</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (OrigXWidth &gt; VTWidth) {</div><div class="line"><a name="l05799"></a><span class="lineno"> 5799</span>&#160;        <span class="comment">// To get the sign bit in the right place, we have to shift it right</span></div><div class="line"><a name="l05800"></a><span class="lineno"> 5800</span>&#160;        <span class="comment">// before truncating.</span></div><div class="line"><a name="l05801"></a><span class="lineno"> 5801</span>&#160;        X = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a3c6553c8acebe1b57c211ee45e2d8f98">ISD::SRL</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(X),</div><div class="line"><a name="l05802"></a><span class="lineno"> 5802</span>&#160;                        X.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>(), <a class="code" href="namespacellvm.html#a6569d00d31a5d74e563e2f39f82271ab">X</a>,</div><div class="line"><a name="l05803"></a><span class="lineno"> 5803</span>&#160;                        DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(OrigXWidth-VTWidth, X.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>()));</div><div class="line"><a name="l05804"></a><span class="lineno"> 5804</span>&#160;        AddToWorkList(X.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l05805"></a><span class="lineno"> 5805</span>&#160;        X = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ae690127648393001a7d5b93dc23da7b3">ISD::TRUNCATE</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(X), VT, X);</div><div class="line"><a name="l05806"></a><span class="lineno"> 5806</span>&#160;        AddToWorkList(X.getNode());</div><div class="line"><a name="l05807"></a><span class="lineno"> 5807</span>&#160;      }</div><div class="line"><a name="l05808"></a><span class="lineno"> 5808</span>&#160;</div><div class="line"><a name="l05809"></a><span class="lineno"> 5809</span>&#160;      <a class="code" href="classllvm_1_1APInt.html">APInt</a> SignBit = <a class="code" href="classllvm_1_1APInt.html#a2e5e9f65d911e80a46d3098933794056">APInt::getSignBit</a>(VT.<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>());</div><div class="line"><a name="l05810"></a><span class="lineno"> 5810</span>&#160;      X = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ac513a7da1bf74fb3e3c594da8534f2d2">ISD::AND</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(X), VT,</div><div class="line"><a name="l05811"></a><span class="lineno"> 5811</span>&#160;                      X, DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(SignBit, VT));</div><div class="line"><a name="l05812"></a><span class="lineno"> 5812</span>&#160;      AddToWorkList(X.getNode());</div><div class="line"><a name="l05813"></a><span class="lineno"> 5813</span>&#160;</div><div class="line"><a name="l05814"></a><span class="lineno"> 5814</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Cst = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a412ddf522b53f07690a86bffba1278e7">ISD::BITCAST</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N0),</div><div class="line"><a name="l05815"></a><span class="lineno"> 5815</span>&#160;                                VT, N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0));</div><div class="line"><a name="l05816"></a><span class="lineno"> 5816</span>&#160;      Cst = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ac513a7da1bf74fb3e3c594da8534f2d2">ISD::AND</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(Cst), VT,</div><div class="line"><a name="l05817"></a><span class="lineno"> 5817</span>&#160;                        Cst, DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(~SignBit, VT));</div><div class="line"><a name="l05818"></a><span class="lineno"> 5818</span>&#160;      AddToWorkList(Cst.getNode());</div><div class="line"><a name="l05819"></a><span class="lineno"> 5819</span>&#160;</div><div class="line"><a name="l05820"></a><span class="lineno"> 5820</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7415ab9f2172c59a2ee7c7a02afa56a4">ISD::OR</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, X, Cst);</div><div class="line"><a name="l05821"></a><span class="lineno"> 5821</span>&#160;    }</div><div class="line"><a name="l05822"></a><span class="lineno"> 5822</span>&#160;  }</div><div class="line"><a name="l05823"></a><span class="lineno"> 5823</span>&#160;</div><div class="line"><a name="l05824"></a><span class="lineno"> 5824</span>&#160;  <span class="comment">// bitconvert(build_pair(ld, ld)) -&gt; ld iff load locations are consecutive.</span></div><div class="line"><a name="l05825"></a><span class="lineno"> 5825</span>&#160;  <span class="keywordflow">if</span> (N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a41bd84b853e2c03fb1af1f4ca9ebdcaf">ISD::BUILD_PAIR</a>) {</div><div class="line"><a name="l05826"></a><span class="lineno"> 5826</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> CombineLD = CombineConsecutiveLoads(N0.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>(), VT);</div><div class="line"><a name="l05827"></a><span class="lineno"> 5827</span>&#160;    <span class="keywordflow">if</span> (CombineLD.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>())</div><div class="line"><a name="l05828"></a><span class="lineno"> 5828</span>&#160;      <span class="keywordflow">return</span> CombineLD;</div><div class="line"><a name="l05829"></a><span class="lineno"> 5829</span>&#160;  }</div><div class="line"><a name="l05830"></a><span class="lineno"> 5830</span>&#160;</div><div class="line"><a name="l05831"></a><span class="lineno"> 5831</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l05832"></a><span class="lineno"> 5832</span>&#160;}</div><div class="line"><a name="l05833"></a><span class="lineno"> 5833</span>&#160;</div><div class="line"><a name="l05834"></a><span class="lineno"> 5834</span>&#160;<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::visitBUILD_PAIR(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N) {</div><div class="line"><a name="l05835"></a><span class="lineno"> 5835</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> VT = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(0);</div><div class="line"><a name="l05836"></a><span class="lineno"> 5836</span>&#160;  <span class="keywordflow">return</span> CombineConsecutiveLoads(N, VT);</div><div class="line"><a name="l05837"></a><span class="lineno"> 5837</span>&#160;}</div><div class="line"><a name="l05838"></a><span class="lineno"> 5838</span>&#160;<span class="comment"></span></div><div class="line"><a name="l05839"></a><span class="lineno"> 5839</span>&#160;<span class="comment">/// ConstantFoldBITCASTofBUILD_VECTOR - We know that BV is a build_vector</span></div><div class="line"><a name="l05840"></a><span class="lineno"> 5840</span>&#160;<span class="comment">/// node with Constant, ConstantFP or Undef operands.  DstEltVT indicates the</span></div><div class="line"><a name="l05841"></a><span class="lineno"> 5841</span>&#160;<span class="comment">/// destination element value type.</span></div><div class="line"><a name="l05842"></a><span class="lineno"> 5842</span>&#160;<span class="comment"></span><a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::</div><div class="line"><a name="l05843"></a><span class="lineno"> 5843</span>&#160;ConstantFoldBITCASTofBUILD_VECTOR(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *BV, <a class="code" href="structllvm_1_1EVT.html">EVT</a> DstEltVT) {</div><div class="line"><a name="l05844"></a><span class="lineno"> 5844</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> SrcEltVT = BV-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(0).<a class="code" href="structllvm_1_1EVT.html#a3a07c062cc9330acd8e8c4e3930cbb25">getVectorElementType</a>();</div><div class="line"><a name="l05845"></a><span class="lineno"> 5845</span>&#160;</div><div class="line"><a name="l05846"></a><span class="lineno"> 5846</span>&#160;  <span class="comment">// If this is already the right type, we&#39;re done.</span></div><div class="line"><a name="l05847"></a><span class="lineno"> 5847</span>&#160;  <span class="keywordflow">if</span> (SrcEltVT == DstEltVT) <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(BV, 0);</div><div class="line"><a name="l05848"></a><span class="lineno"> 5848</span>&#160;</div><div class="line"><a name="l05849"></a><span class="lineno"> 5849</span>&#160;  <span class="keywordtype">unsigned</span> SrcBitSize = SrcEltVT.<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>();</div><div class="line"><a name="l05850"></a><span class="lineno"> 5850</span>&#160;  <span class="keywordtype">unsigned</span> DstBitSize = DstEltVT.<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>();</div><div class="line"><a name="l05851"></a><span class="lineno"> 5851</span>&#160;</div><div class="line"><a name="l05852"></a><span class="lineno"> 5852</span>&#160;  <span class="comment">// If this is a conversion of N elements of one type to N elements of another</span></div><div class="line"><a name="l05853"></a><span class="lineno"> 5853</span>&#160;  <span class="comment">// type, convert each element.  This handles FP&lt;-&gt;INT cases.</span></div><div class="line"><a name="l05854"></a><span class="lineno"> 5854</span>&#160;  <span class="keywordflow">if</span> (SrcBitSize == DstBitSize) {</div><div class="line"><a name="l05855"></a><span class="lineno"> 5855</span>&#160;    <a class="code" href="structllvm_1_1EVT.html">EVT</a> VT = <a class="code" href="structllvm_1_1EVT.html#a18c2edf1939f6e87f1e586b815f398cd">EVT::getVectorVT</a>(*DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a39c6dff47b8dbd25cfaf6336c7056077">getContext</a>(), DstEltVT,</div><div class="line"><a name="l05856"></a><span class="lineno"> 5856</span>&#160;                              BV-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(0).<a class="code" href="structllvm_1_1EVT.html#a42bca41d2438197c12b6db2c710a959c">getVectorNumElements</a>());</div><div class="line"><a name="l05857"></a><span class="lineno"> 5857</span>&#160;</div><div class="line"><a name="l05858"></a><span class="lineno"> 5858</span>&#160;    <span class="comment">// Due to the FP element handling below calling this routine recursively,</span></div><div class="line"><a name="l05859"></a><span class="lineno"> 5859</span>&#160;    <span class="comment">// we can end up with a scalar-to-vector node here.</span></div><div class="line"><a name="l05860"></a><span class="lineno"> 5860</span>&#160;    <span class="keywordflow">if</span> (BV-&gt;<a class="code" href="classllvm_1_1SDNode.html#af0d328f3f61168f4ea7d6e4044af4f97">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a576080a08ef1bbab0308eac9d5838f75">ISD::SCALAR_TO_VECTOR</a>)</div><div class="line"><a name="l05861"></a><span class="lineno"> 5861</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a576080a08ef1bbab0308eac9d5838f75">ISD::SCALAR_TO_VECTOR</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(BV), VT,</div><div class="line"><a name="l05862"></a><span class="lineno"> 5862</span>&#160;                         DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a412ddf522b53f07690a86bffba1278e7">ISD::BITCAST</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(BV),</div><div class="line"><a name="l05863"></a><span class="lineno"> 5863</span>&#160;                                     DstEltVT, BV-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0)));</div><div class="line"><a name="l05864"></a><span class="lineno"> 5864</span>&#160;</div><div class="line"><a name="l05865"></a><span class="lineno"> 5865</span>&#160;    <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;SDValue, 8&gt;</a> Ops;</div><div class="line"><a name="l05866"></a><span class="lineno"> 5866</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0, e = BV-&gt;<a class="code" href="classllvm_1_1SDNode.html#abc5c2f1d47a517373030133c6a102106">getNumOperands</a>(); <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != e; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l05867"></a><span class="lineno"> 5867</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Op = BV-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l05868"></a><span class="lineno"> 5868</span>&#160;      <span class="comment">// If the vector element type is not legal, the BUILD_VECTOR operands</span></div><div class="line"><a name="l05869"></a><span class="lineno"> 5869</span>&#160;      <span class="comment">// are promoted and implicitly truncated.  Make that explicit here.</span></div><div class="line"><a name="l05870"></a><span class="lineno"> 5870</span>&#160;      <span class="keywordflow">if</span> (Op.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>() != SrcEltVT)</div><div class="line"><a name="l05871"></a><span class="lineno"> 5871</span>&#160;        Op = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ae690127648393001a7d5b93dc23da7b3">ISD::TRUNCATE</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(BV), SrcEltVT, Op);</div><div class="line"><a name="l05872"></a><span class="lineno"> 5872</span>&#160;      Ops.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a412ddf522b53f07690a86bffba1278e7">ISD::BITCAST</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(BV),</div><div class="line"><a name="l05873"></a><span class="lineno"> 5873</span>&#160;                                DstEltVT, Op));</div><div class="line"><a name="l05874"></a><span class="lineno"> 5874</span>&#160;      AddToWorkList(Ops.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#acd9e771a3296c6b24146955754620557">back</a>().<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l05875"></a><span class="lineno"> 5875</span>&#160;    }</div><div class="line"><a name="l05876"></a><span class="lineno"> 5876</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110aff6f73b624fecca7dbe94259f9437e32">ISD::BUILD_VECTOR</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(BV), VT,</div><div class="line"><a name="l05877"></a><span class="lineno"> 5877</span>&#160;                       &amp;Ops[0], Ops.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#a22a311dfe4c28a897de8a9365a4f0a84">size</a>());</div><div class="line"><a name="l05878"></a><span class="lineno"> 5878</span>&#160;  }</div><div class="line"><a name="l05879"></a><span class="lineno"> 5879</span>&#160;</div><div class="line"><a name="l05880"></a><span class="lineno"> 5880</span>&#160;  <span class="comment">// Otherwise, we&#39;re growing or shrinking the elements.  To avoid having to</span></div><div class="line"><a name="l05881"></a><span class="lineno"> 5881</span>&#160;  <span class="comment">// handle annoying details of growing/shrinking FP values, we convert them to</span></div><div class="line"><a name="l05882"></a><span class="lineno"> 5882</span>&#160;  <span class="comment">// int first.</span></div><div class="line"><a name="l05883"></a><span class="lineno"> 5883</span>&#160;  <span class="keywordflow">if</span> (SrcEltVT.<a class="code" href="structllvm_1_1EVT.html#afc4147764cdb5599c67f747813ef9bdc">isFloatingPoint</a>()) {</div><div class="line"><a name="l05884"></a><span class="lineno"> 5884</span>&#160;    <span class="comment">// Convert the input float vector to a int vector where the elements are the</span></div><div class="line"><a name="l05885"></a><span class="lineno"> 5885</span>&#160;    <span class="comment">// same sizes.</span></div><div class="line"><a name="l05886"></a><span class="lineno"> 5886</span>&#160;    assert((SrcEltVT == <a class="code" href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50ca586bae91020e6d8cccfe0995f527606f">MVT::f32</a> || SrcEltVT == <a class="code" href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50cac661c912350e3095c85ba75b8dbc17b1">MVT::f64</a>) &amp;&amp; <span class="stringliteral">&quot;Unknown FP VT!&quot;</span>);</div><div class="line"><a name="l05887"></a><span class="lineno"> 5887</span>&#160;    <a class="code" href="structllvm_1_1EVT.html">EVT</a> IntVT = <a class="code" href="structllvm_1_1EVT.html#a752372e170e4e7c595bf8810bb52adf2">EVT::getIntegerVT</a>(*DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a39c6dff47b8dbd25cfaf6336c7056077">getContext</a>(), SrcEltVT.<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>());</div><div class="line"><a name="l05888"></a><span class="lineno"> 5888</span>&#160;    BV = ConstantFoldBITCASTofBUILD_VECTOR(BV, IntVT).getNode();</div><div class="line"><a name="l05889"></a><span class="lineno"> 5889</span>&#160;    SrcEltVT = IntVT;</div><div class="line"><a name="l05890"></a><span class="lineno"> 5890</span>&#160;  }</div><div class="line"><a name="l05891"></a><span class="lineno"> 5891</span>&#160;</div><div class="line"><a name="l05892"></a><span class="lineno"> 5892</span>&#160;  <span class="comment">// Now we know the input is an integer vector.  If the output is a FP type,</span></div><div class="line"><a name="l05893"></a><span class="lineno"> 5893</span>&#160;  <span class="comment">// convert to integer first, then to FP of the right size.</span></div><div class="line"><a name="l05894"></a><span class="lineno"> 5894</span>&#160;  <span class="keywordflow">if</span> (DstEltVT.<a class="code" href="structllvm_1_1EVT.html#afc4147764cdb5599c67f747813ef9bdc">isFloatingPoint</a>()) {</div><div class="line"><a name="l05895"></a><span class="lineno"> 5895</span>&#160;    assert((DstEltVT == <a class="code" href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50ca586bae91020e6d8cccfe0995f527606f">MVT::f32</a> || DstEltVT == <a class="code" href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50cac661c912350e3095c85ba75b8dbc17b1">MVT::f64</a>) &amp;&amp; <span class="stringliteral">&quot;Unknown FP VT!&quot;</span>);</div><div class="line"><a name="l05896"></a><span class="lineno"> 5896</span>&#160;    <a class="code" href="structllvm_1_1EVT.html">EVT</a> TmpVT = <a class="code" href="structllvm_1_1EVT.html#a752372e170e4e7c595bf8810bb52adf2">EVT::getIntegerVT</a>(*DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a39c6dff47b8dbd25cfaf6336c7056077">getContext</a>(), DstEltVT.<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>());</div><div class="line"><a name="l05897"></a><span class="lineno"> 5897</span>&#160;    <a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *Tmp = ConstantFoldBITCASTofBUILD_VECTOR(BV, TmpVT).getNode();</div><div class="line"><a name="l05898"></a><span class="lineno"> 5898</span>&#160;</div><div class="line"><a name="l05899"></a><span class="lineno"> 5899</span>&#160;    <span class="comment">// Next, convert to FP elements of the same size.</span></div><div class="line"><a name="l05900"></a><span class="lineno"> 5900</span>&#160;    <span class="keywordflow">return</span> ConstantFoldBITCASTofBUILD_VECTOR(Tmp, DstEltVT);</div><div class="line"><a name="l05901"></a><span class="lineno"> 5901</span>&#160;  }</div><div class="line"><a name="l05902"></a><span class="lineno"> 5902</span>&#160;</div><div class="line"><a name="l05903"></a><span class="lineno"> 5903</span>&#160;  <span class="comment">// Okay, we know the src/dst types are both integers of differing types.</span></div><div class="line"><a name="l05904"></a><span class="lineno"> 5904</span>&#160;  <span class="comment">// Handling growing first.</span></div><div class="line"><a name="l05905"></a><span class="lineno"> 5905</span>&#160;  assert(SrcEltVT.<a class="code" href="structllvm_1_1EVT.html#a8cc407ac00df4edd4ec4d5168d6ecb26">isInteger</a>() &amp;&amp; DstEltVT.<a class="code" href="structllvm_1_1EVT.html#a8cc407ac00df4edd4ec4d5168d6ecb26">isInteger</a>());</div><div class="line"><a name="l05906"></a><span class="lineno"> 5906</span>&#160;  <span class="keywordflow">if</span> (SrcBitSize &lt; DstBitSize) {</div><div class="line"><a name="l05907"></a><span class="lineno"> 5907</span>&#160;    <span class="keywordtype">unsigned</span> NumInputsPerOutput = DstBitSize/SrcBitSize;</div><div class="line"><a name="l05908"></a><span class="lineno"> 5908</span>&#160;</div><div class="line"><a name="l05909"></a><span class="lineno"> 5909</span>&#160;    <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;SDValue, 8&gt;</a> Ops;</div><div class="line"><a name="l05910"></a><span class="lineno"> 5910</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0, e = BV-&gt;<a class="code" href="classllvm_1_1SDNode.html#abc5c2f1d47a517373030133c6a102106">getNumOperands</a>(); <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != e;</div><div class="line"><a name="l05911"></a><span class="lineno"> 5911</span>&#160;         <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> += NumInputsPerOutput) {</div><div class="line"><a name="l05912"></a><span class="lineno"> 5912</span>&#160;      <span class="keywordtype">bool</span> isLE = TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a7fe87806292e4bb35d59a51930f3ae0e">isLittleEndian</a>();</div><div class="line"><a name="l05913"></a><span class="lineno"> 5913</span>&#160;      <a class="code" href="classllvm_1_1APInt.html">APInt</a> NewBits = <a class="code" href="classllvm_1_1APInt.html">APInt</a>(DstBitSize, 0);</div><div class="line"><a name="l05914"></a><span class="lineno"> 5914</span>&#160;      <span class="keywordtype">bool</span> EltIsUndef = <span class="keyword">true</span>;</div><div class="line"><a name="l05915"></a><span class="lineno"> 5915</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a> = 0; <a class="code" href="Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a> != NumInputsPerOutput; ++<a class="code" href="Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a>) {</div><div class="line"><a name="l05916"></a><span class="lineno"> 5916</span>&#160;        <span class="comment">// Shift the previously computed bits over.</span></div><div class="line"><a name="l05917"></a><span class="lineno"> 5917</span>&#160;        NewBits &lt;&lt;= SrcBitSize;</div><div class="line"><a name="l05918"></a><span class="lineno"> 5918</span>&#160;        <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Op = BV-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>+ (isLE ? (NumInputsPerOutput-<a class="code" href="Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a>-1) : <a class="code" href="Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a>));</div><div class="line"><a name="l05919"></a><span class="lineno"> 5919</span>&#160;        <span class="keywordflow">if</span> (Op.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7c6d8f265e9e16e5debdb9a536b55d3d">ISD::UNDEF</a>) <span class="keywordflow">continue</span>;</div><div class="line"><a name="l05920"></a><span class="lineno"> 5920</span>&#160;        EltIsUndef = <span class="keyword">false</span>;</div><div class="line"><a name="l05921"></a><span class="lineno"> 5921</span>&#160;</div><div class="line"><a name="l05922"></a><span class="lineno"> 5922</span>&#160;        NewBits |= cast&lt;ConstantSDNode&gt;(Op)-&gt;getAPIntValue().</div><div class="line"><a name="l05923"></a><span class="lineno"> 5923</span>&#160;                   zextOrTrunc(SrcBitSize).<a class="code" href="classllvm_1_1APInt.html#a6142fc5662411269a7ca0217f49f338c">zext</a>(DstBitSize);</div><div class="line"><a name="l05924"></a><span class="lineno"> 5924</span>&#160;      }</div><div class="line"><a name="l05925"></a><span class="lineno"> 5925</span>&#160;</div><div class="line"><a name="l05926"></a><span class="lineno"> 5926</span>&#160;      <span class="keywordflow">if</span> (EltIsUndef)</div><div class="line"><a name="l05927"></a><span class="lineno"> 5927</span>&#160;        Ops.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a5b0e59823444a55c295af279611a9d24">getUNDEF</a>(DstEltVT));</div><div class="line"><a name="l05928"></a><span class="lineno"> 5928</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l05929"></a><span class="lineno"> 5929</span>&#160;        Ops.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(NewBits, DstEltVT));</div><div class="line"><a name="l05930"></a><span class="lineno"> 5930</span>&#160;    }</div><div class="line"><a name="l05931"></a><span class="lineno"> 5931</span>&#160;</div><div class="line"><a name="l05932"></a><span class="lineno"> 5932</span>&#160;    <a class="code" href="structllvm_1_1EVT.html">EVT</a> VT = <a class="code" href="structllvm_1_1EVT.html#a18c2edf1939f6e87f1e586b815f398cd">EVT::getVectorVT</a>(*DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a39c6dff47b8dbd25cfaf6336c7056077">getContext</a>(), DstEltVT, Ops.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#a22a311dfe4c28a897de8a9365a4f0a84">size</a>());</div><div class="line"><a name="l05933"></a><span class="lineno"> 5933</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110aff6f73b624fecca7dbe94259f9437e32">ISD::BUILD_VECTOR</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(BV), VT,</div><div class="line"><a name="l05934"></a><span class="lineno"> 5934</span>&#160;                       &amp;Ops[0], Ops.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#a22a311dfe4c28a897de8a9365a4f0a84">size</a>());</div><div class="line"><a name="l05935"></a><span class="lineno"> 5935</span>&#160;  }</div><div class="line"><a name="l05936"></a><span class="lineno"> 5936</span>&#160;</div><div class="line"><a name="l05937"></a><span class="lineno"> 5937</span>&#160;  <span class="comment">// Finally, this must be the case where we are shrinking elements: each input</span></div><div class="line"><a name="l05938"></a><span class="lineno"> 5938</span>&#160;  <span class="comment">// turns into multiple outputs.</span></div><div class="line"><a name="l05939"></a><span class="lineno"> 5939</span>&#160;  <span class="keywordtype">bool</span> isS2V = <a class="code" href="namespacellvm_1_1ISD.html#a0a31c08480b7e1029f824c35671f96b4">ISD::isScalarToVector</a>(BV);</div><div class="line"><a name="l05940"></a><span class="lineno"> 5940</span>&#160;  <span class="keywordtype">unsigned</span> NumOutputsPerInput = SrcBitSize/DstBitSize;</div><div class="line"><a name="l05941"></a><span class="lineno"> 5941</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> VT = <a class="code" href="structllvm_1_1EVT.html#a18c2edf1939f6e87f1e586b815f398cd">EVT::getVectorVT</a>(*DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a39c6dff47b8dbd25cfaf6336c7056077">getContext</a>(), DstEltVT,</div><div class="line"><a name="l05942"></a><span class="lineno"> 5942</span>&#160;                            NumOutputsPerInput*BV-&gt;<a class="code" href="classllvm_1_1SDNode.html#abc5c2f1d47a517373030133c6a102106">getNumOperands</a>());</div><div class="line"><a name="l05943"></a><span class="lineno"> 5943</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;SDValue, 8&gt;</a> Ops;</div><div class="line"><a name="l05944"></a><span class="lineno"> 5944</span>&#160;</div><div class="line"><a name="l05945"></a><span class="lineno"> 5945</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0, e = BV-&gt;<a class="code" href="classllvm_1_1SDNode.html#abc5c2f1d47a517373030133c6a102106">getNumOperands</a>(); <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != e; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l05946"></a><span class="lineno"> 5946</span>&#160;    <span class="keywordflow">if</span> (BV-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>).<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7c6d8f265e9e16e5debdb9a536b55d3d">ISD::UNDEF</a>) {</div><div class="line"><a name="l05947"></a><span class="lineno"> 5947</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a> = 0; <a class="code" href="Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a> != NumOutputsPerInput; ++<a class="code" href="Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a>)</div><div class="line"><a name="l05948"></a><span class="lineno"> 5948</span>&#160;        Ops.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a5b0e59823444a55c295af279611a9d24">getUNDEF</a>(DstEltVT));</div><div class="line"><a name="l05949"></a><span class="lineno"> 5949</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l05950"></a><span class="lineno"> 5950</span>&#160;    }</div><div class="line"><a name="l05951"></a><span class="lineno"> 5951</span>&#160;</div><div class="line"><a name="l05952"></a><span class="lineno"> 5952</span>&#160;    <a class="code" href="classllvm_1_1APInt.html">APInt</a> OpVal = cast&lt;ConstantSDNode&gt;(BV-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>))-&gt;</div><div class="line"><a name="l05953"></a><span class="lineno"> 5953</span>&#160;                  getAPIntValue().<a class="code" href="classllvm_1_1APInt.html#a7fe47410bb825eccb20f010dab13c72f">zextOrTrunc</a>(SrcBitSize);</div><div class="line"><a name="l05954"></a><span class="lineno"> 5954</span>&#160;</div><div class="line"><a name="l05955"></a><span class="lineno"> 5955</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a> = 0; <a class="code" href="Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a> != NumOutputsPerInput; ++<a class="code" href="Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a>) {</div><div class="line"><a name="l05956"></a><span class="lineno"> 5956</span>&#160;      <a class="code" href="classllvm_1_1APInt.html">APInt</a> ThisVal = OpVal.<a class="code" href="classllvm_1_1APInt.html#a8cf5475fb3e9c737112cc248194c1040">trunc</a>(DstBitSize);</div><div class="line"><a name="l05957"></a><span class="lineno"> 5957</span>&#160;      Ops.push_back(DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(ThisVal, DstEltVT));</div><div class="line"><a name="l05958"></a><span class="lineno"> 5958</span>&#160;      <span class="keywordflow">if</span> (isS2V &amp;&amp; <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> == 0 &amp;&amp; <a class="code" href="Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a> == 0 &amp;&amp; ThisVal.<a class="code" href="classllvm_1_1APInt.html#a6142fc5662411269a7ca0217f49f338c">zext</a>(SrcBitSize) == OpVal)</div><div class="line"><a name="l05959"></a><span class="lineno"> 5959</span>&#160;        <span class="comment">// Simply turn this into a SCALAR_TO_VECTOR of the new type.</span></div><div class="line"><a name="l05960"></a><span class="lineno"> 5960</span>&#160;        <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a576080a08ef1bbab0308eac9d5838f75">ISD::SCALAR_TO_VECTOR</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(BV), VT,</div><div class="line"><a name="l05961"></a><span class="lineno"> 5961</span>&#160;                           Ops[0]);</div><div class="line"><a name="l05962"></a><span class="lineno"> 5962</span>&#160;      OpVal = OpVal.<a class="code" href="classllvm_1_1APInt.html#aa1953b3ad7ef6aa87dc0205db0c2ea45">lshr</a>(DstBitSize);</div><div class="line"><a name="l05963"></a><span class="lineno"> 5963</span>&#160;    }</div><div class="line"><a name="l05964"></a><span class="lineno"> 5964</span>&#160;</div><div class="line"><a name="l05965"></a><span class="lineno"> 5965</span>&#160;    <span class="comment">// For big endian targets, swap the order of the pieces of each element.</span></div><div class="line"><a name="l05966"></a><span class="lineno"> 5966</span>&#160;    <span class="keywordflow">if</span> (TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a785a8016a792dbc65ec16688f180af71">isBigEndian</a>())</div><div class="line"><a name="l05967"></a><span class="lineno"> 5967</span>&#160;      std::reverse(Ops.end()-NumOutputsPerInput, Ops.end());</div><div class="line"><a name="l05968"></a><span class="lineno"> 5968</span>&#160;  }</div><div class="line"><a name="l05969"></a><span class="lineno"> 5969</span>&#160;</div><div class="line"><a name="l05970"></a><span class="lineno"> 5970</span>&#160;  <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110aff6f73b624fecca7dbe94259f9437e32">ISD::BUILD_VECTOR</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(BV), VT,</div><div class="line"><a name="l05971"></a><span class="lineno"> 5971</span>&#160;                     &amp;Ops[0], Ops.size());</div><div class="line"><a name="l05972"></a><span class="lineno"> 5972</span>&#160;}</div><div class="line"><a name="l05973"></a><span class="lineno"> 5973</span>&#160;</div><div class="line"><a name="l05974"></a><span class="lineno"> 5974</span>&#160;<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::visitFADD(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N) {</div><div class="line"><a name="l05975"></a><span class="lineno"> 5975</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N0 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0);</div><div class="line"><a name="l05976"></a><span class="lineno"> 5976</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N1 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(1);</div><div class="line"><a name="l05977"></a><span class="lineno"> 5977</span>&#160;  <a class="code" href="classllvm_1_1ConstantFPSDNode.html">ConstantFPSDNode</a> *N0CFP = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantFPSDNode.html">ConstantFPSDNode</a>&gt;(N0);</div><div class="line"><a name="l05978"></a><span class="lineno"> 5978</span>&#160;  <a class="code" href="classllvm_1_1ConstantFPSDNode.html">ConstantFPSDNode</a> *N1CFP = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantFPSDNode.html">ConstantFPSDNode</a>&gt;(N1);</div><div class="line"><a name="l05979"></a><span class="lineno"> 5979</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> VT = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(0);</div><div class="line"><a name="l05980"></a><span class="lineno"> 5980</span>&#160;</div><div class="line"><a name="l05981"></a><span class="lineno"> 5981</span>&#160;  <span class="comment">// fold vector ops</span></div><div class="line"><a name="l05982"></a><span class="lineno"> 5982</span>&#160;  <span class="keywordflow">if</span> (VT.isVector()) {</div><div class="line"><a name="l05983"></a><span class="lineno"> 5983</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> FoldedVOp = SimplifyVBinOp(N);</div><div class="line"><a name="l05984"></a><span class="lineno"> 5984</span>&#160;    <span class="keywordflow">if</span> (FoldedVOp.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()) <span class="keywordflow">return</span> FoldedVOp;</div><div class="line"><a name="l05985"></a><span class="lineno"> 5985</span>&#160;  }</div><div class="line"><a name="l05986"></a><span class="lineno"> 5986</span>&#160;</div><div class="line"><a name="l05987"></a><span class="lineno"> 5987</span>&#160;  <span class="comment">// fold (fadd c1, c2) -&gt; c1 + c2</span></div><div class="line"><a name="l05988"></a><span class="lineno"> 5988</span>&#160;  <span class="keywordflow">if</span> (N0CFP &amp;&amp; N1CFP)</div><div class="line"><a name="l05989"></a><span class="lineno"> 5989</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a32ec12017722f5b42a295fe5eb0b0bdf">ISD::FADD</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N0, N1);</div><div class="line"><a name="l05990"></a><span class="lineno"> 5990</span>&#160;  <span class="comment">// canonicalize constant to RHS</span></div><div class="line"><a name="l05991"></a><span class="lineno"> 5991</span>&#160;  <span class="keywordflow">if</span> (N0CFP &amp;&amp; !N1CFP)</div><div class="line"><a name="l05992"></a><span class="lineno"> 5992</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a32ec12017722f5b42a295fe5eb0b0bdf">ISD::FADD</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N1, N0);</div><div class="line"><a name="l05993"></a><span class="lineno"> 5993</span>&#160;  <span class="comment">// fold (fadd A, 0) -&gt; A</span></div><div class="line"><a name="l05994"></a><span class="lineno"> 5994</span>&#160;  <span class="keywordflow">if</span> (DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a6b60694d1d9d7f634e7638856898e20d">getTarget</a>().<a class="code" href="classllvm_1_1TargetMachine.html#ab1fb67187fc37e569cc5171cbebba873">Options</a>.<a class="code" href="classllvm_1_1TargetOptions.html#a0544e2966374684ff74255e5a4290fa7">UnsafeFPMath</a> &amp;&amp; N1CFP &amp;&amp;</div><div class="line"><a name="l05995"></a><span class="lineno"> 5995</span>&#160;      N1CFP-&gt;getValueAPF().isZero())</div><div class="line"><a name="l05996"></a><span class="lineno"> 5996</span>&#160;    <span class="keywordflow">return</span> N0;</div><div class="line"><a name="l05997"></a><span class="lineno"> 5997</span>&#160;  <span class="comment">// fold (fadd A, (fneg B)) -&gt; (fsub A, B)</span></div><div class="line"><a name="l05998"></a><span class="lineno"> 5998</span>&#160;  <span class="keywordflow">if</span> ((!LegalOperations || TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a087dd0f9650e999b087c17cc7f46f2d0">isOperationLegalOrCustom</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a2852a5b6baa80b1589a46737210a8cad">ISD::FSUB</a>, VT)) &amp;&amp;</div><div class="line"><a name="l05999"></a><span class="lineno"> 5999</span>&#160;    <a class="code" href="DAGCombiner_8cpp.html#aec1e6891acbf695c615301db72893862">isNegatibleForFree</a>(N1, LegalOperations, TLI, &amp;DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a6b60694d1d9d7f634e7638856898e20d">getTarget</a>().<a class="code" href="classllvm_1_1TargetMachine.html#ab1fb67187fc37e569cc5171cbebba873">Options</a>) == 2)</div><div class="line"><a name="l06000"></a><span class="lineno"> 6000</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a2852a5b6baa80b1589a46737210a8cad">ISD::FSUB</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N0,</div><div class="line"><a name="l06001"></a><span class="lineno"> 6001</span>&#160;                       <a class="code" href="DAGCombiner_8cpp.html#a55d3de0deed33d70188b2b5a9cab8f00">GetNegatedExpression</a>(N1, DAG, LegalOperations));</div><div class="line"><a name="l06002"></a><span class="lineno"> 6002</span>&#160;  <span class="comment">// fold (fadd (fneg A), B) -&gt; (fsub B, A)</span></div><div class="line"><a name="l06003"></a><span class="lineno"> 6003</span>&#160;  <span class="keywordflow">if</span> ((!LegalOperations || TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a087dd0f9650e999b087c17cc7f46f2d0">isOperationLegalOrCustom</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a2852a5b6baa80b1589a46737210a8cad">ISD::FSUB</a>, VT)) &amp;&amp;</div><div class="line"><a name="l06004"></a><span class="lineno"> 6004</span>&#160;    <a class="code" href="DAGCombiner_8cpp.html#aec1e6891acbf695c615301db72893862">isNegatibleForFree</a>(N0, LegalOperations, TLI, &amp;DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a6b60694d1d9d7f634e7638856898e20d">getTarget</a>().<a class="code" href="classllvm_1_1TargetMachine.html#ab1fb67187fc37e569cc5171cbebba873">Options</a>) == 2)</div><div class="line"><a name="l06005"></a><span class="lineno"> 6005</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a2852a5b6baa80b1589a46737210a8cad">ISD::FSUB</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N1,</div><div class="line"><a name="l06006"></a><span class="lineno"> 6006</span>&#160;                       <a class="code" href="DAGCombiner_8cpp.html#a55d3de0deed33d70188b2b5a9cab8f00">GetNegatedExpression</a>(N0, DAG, LegalOperations));</div><div class="line"><a name="l06007"></a><span class="lineno"> 6007</span>&#160;</div><div class="line"><a name="l06008"></a><span class="lineno"> 6008</span>&#160;  <span class="comment">// If allowed, fold (fadd (fadd x, c1), c2) -&gt; (fadd x, (fadd c1, c2))</span></div><div class="line"><a name="l06009"></a><span class="lineno"> 6009</span>&#160;  <span class="keywordflow">if</span> (DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a6b60694d1d9d7f634e7638856898e20d">getTarget</a>().<a class="code" href="classllvm_1_1TargetMachine.html#ab1fb67187fc37e569cc5171cbebba873">Options</a>.<a class="code" href="classllvm_1_1TargetOptions.html#a0544e2966374684ff74255e5a4290fa7">UnsafeFPMath</a> &amp;&amp; N1CFP &amp;&amp;</div><div class="line"><a name="l06010"></a><span class="lineno"> 6010</span>&#160;      N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a32ec12017722f5b42a295fe5eb0b0bdf">ISD::FADD</a> &amp;&amp; N0.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()-&gt;<a class="code" href="classllvm_1_1SDNode.html#a52753947fce3a01b1c18dd4713c587e8">hasOneUse</a>() &amp;&amp;</div><div class="line"><a name="l06011"></a><span class="lineno"> 6011</span>&#160;      isa&lt;ConstantFPSDNode&gt;(N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1)))</div><div class="line"><a name="l06012"></a><span class="lineno"> 6012</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a32ec12017722f5b42a295fe5eb0b0bdf">ISD::FADD</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0),</div><div class="line"><a name="l06013"></a><span class="lineno"> 6013</span>&#160;                       DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a32ec12017722f5b42a295fe5eb0b0bdf">ISD::FADD</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT,</div><div class="line"><a name="l06014"></a><span class="lineno"> 6014</span>&#160;                                   N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1), N1));</div><div class="line"><a name="l06015"></a><span class="lineno"> 6015</span>&#160;</div><div class="line"><a name="l06016"></a><span class="lineno"> 6016</span>&#160;  <span class="comment">// No FP constant should be created after legalization as Instruction</span></div><div class="line"><a name="l06017"></a><span class="lineno"> 6017</span>&#160;  <span class="comment">// Selection pass has hard time in dealing with FP constant.</span></div><div class="line"><a name="l06018"></a><span class="lineno"> 6018</span>&#160;  <span class="comment">//</span></div><div class="line"><a name="l06019"></a><span class="lineno"> 6019</span>&#160;  <span class="comment">// We don&#39;t need test this condition for transformation like following, as</span></div><div class="line"><a name="l06020"></a><span class="lineno"> 6020</span>&#160;  <span class="comment">// the DAG being transformed implies it is legal to take FP constant as</span></div><div class="line"><a name="l06021"></a><span class="lineno"> 6021</span>&#160;  <span class="comment">// operand.</span></div><div class="line"><a name="l06022"></a><span class="lineno"> 6022</span>&#160;  <span class="comment">//</span></div><div class="line"><a name="l06023"></a><span class="lineno"> 6023</span>&#160;  <span class="comment">//  (fadd (fmul c, x), x) -&gt; (fmul c+1, x)</span></div><div class="line"><a name="l06024"></a><span class="lineno"> 6024</span>&#160;  <span class="comment">//</span></div><div class="line"><a name="l06025"></a><span class="lineno"> 6025</span>&#160;  <span class="keywordtype">bool</span> AllowNewFpConst = (Level &lt; <a class="code" href="namespacellvm.html#aa6d856e4879bb775617f8c3634773b7aa7fbaa966e5d5ac3bf03ba617b73bff5c">AfterLegalizeDAG</a>);</div><div class="line"><a name="l06026"></a><span class="lineno"> 6026</span>&#160;</div><div class="line"><a name="l06027"></a><span class="lineno"> 6027</span>&#160;  <span class="comment">// If allow, fold (fadd (fneg x), x) -&gt; 0.0</span></div><div class="line"><a name="l06028"></a><span class="lineno"> 6028</span>&#160;  <span class="keywordflow">if</span> (AllowNewFpConst &amp;&amp; DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a6b60694d1d9d7f634e7638856898e20d">getTarget</a>().<a class="code" href="classllvm_1_1TargetMachine.html#ab1fb67187fc37e569cc5171cbebba873">Options</a>.<a class="code" href="classllvm_1_1TargetOptions.html#a0544e2966374684ff74255e5a4290fa7">UnsafeFPMath</a> &amp;&amp;</div><div class="line"><a name="l06029"></a><span class="lineno"> 6029</span>&#160;      N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a6d26c45c040d8f85d577a5f645261d1a">ISD::FNEG</a> &amp;&amp; N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0) == N1)</div><div class="line"><a name="l06030"></a><span class="lineno"> 6030</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a268e5bc7dd40a28712a33ca6c9c91c6f">getConstantFP</a>(0.0, VT);</div><div class="line"><a name="l06031"></a><span class="lineno"> 6031</span>&#160;</div><div class="line"><a name="l06032"></a><span class="lineno"> 6032</span>&#160;    <span class="comment">// If allow, fold (fadd x, (fneg x)) -&gt; 0.0</span></div><div class="line"><a name="l06033"></a><span class="lineno"> 6033</span>&#160;  <span class="keywordflow">if</span> (AllowNewFpConst &amp;&amp; DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a6b60694d1d9d7f634e7638856898e20d">getTarget</a>().<a class="code" href="classllvm_1_1TargetMachine.html#ab1fb67187fc37e569cc5171cbebba873">Options</a>.<a class="code" href="classllvm_1_1TargetOptions.html#a0544e2966374684ff74255e5a4290fa7">UnsafeFPMath</a> &amp;&amp;</div><div class="line"><a name="l06034"></a><span class="lineno"> 6034</span>&#160;      N1.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a6d26c45c040d8f85d577a5f645261d1a">ISD::FNEG</a> &amp;&amp; N1.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0) == N0)</div><div class="line"><a name="l06035"></a><span class="lineno"> 6035</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a268e5bc7dd40a28712a33ca6c9c91c6f">getConstantFP</a>(0.0, VT);</div><div class="line"><a name="l06036"></a><span class="lineno"> 6036</span>&#160;</div><div class="line"><a name="l06037"></a><span class="lineno"> 6037</span>&#160;  <span class="comment">// In unsafe math mode, we can fold chains of FADD&#39;s of the same value</span></div><div class="line"><a name="l06038"></a><span class="lineno"> 6038</span>&#160;  <span class="comment">// into multiplications.  This transform is not safe in general because</span></div><div class="line"><a name="l06039"></a><span class="lineno"> 6039</span>&#160;  <span class="comment">// we are reducing the number of rounding steps.</span></div><div class="line"><a name="l06040"></a><span class="lineno"> 6040</span>&#160;  <span class="keywordflow">if</span> (DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a6b60694d1d9d7f634e7638856898e20d">getTarget</a>().<a class="code" href="classllvm_1_1TargetMachine.html#ab1fb67187fc37e569cc5171cbebba873">Options</a>.<a class="code" href="classllvm_1_1TargetOptions.html#a0544e2966374684ff74255e5a4290fa7">UnsafeFPMath</a> &amp;&amp;</div><div class="line"><a name="l06041"></a><span class="lineno"> 6041</span>&#160;      TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a087dd0f9650e999b087c17cc7f46f2d0">isOperationLegalOrCustom</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9ab5860c97a00c4627a08cab7b0c8178">ISD::FMUL</a>, VT) &amp;&amp;</div><div class="line"><a name="l06042"></a><span class="lineno"> 6042</span>&#160;      !N0CFP &amp;&amp; !N1CFP) {</div><div class="line"><a name="l06043"></a><span class="lineno"> 6043</span>&#160;    <span class="keywordflow">if</span> (N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9ab5860c97a00c4627a08cab7b0c8178">ISD::FMUL</a>) {</div><div class="line"><a name="l06044"></a><span class="lineno"> 6044</span>&#160;      <a class="code" href="classllvm_1_1ConstantFPSDNode.html">ConstantFPSDNode</a> *CFP00 = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantFPSDNode.html">ConstantFPSDNode</a>&gt;(N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0));</div><div class="line"><a name="l06045"></a><span class="lineno"> 6045</span>&#160;      <a class="code" href="classllvm_1_1ConstantFPSDNode.html">ConstantFPSDNode</a> *CFP01 = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantFPSDNode.html">ConstantFPSDNode</a>&gt;(N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1));</div><div class="line"><a name="l06046"></a><span class="lineno"> 6046</span>&#160;</div><div class="line"><a name="l06047"></a><span class="lineno"> 6047</span>&#160;      <span class="comment">// (fadd (fmul c, x), x) -&gt; (fmul x, c+1)</span></div><div class="line"><a name="l06048"></a><span class="lineno"> 6048</span>&#160;      <span class="keywordflow">if</span> (CFP00 &amp;&amp; !CFP01 &amp;&amp; N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1) == N1) {</div><div class="line"><a name="l06049"></a><span class="lineno"> 6049</span>&#160;        <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> NewCFP = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a32ec12017722f5b42a295fe5eb0b0bdf">ISD::FADD</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT,</div><div class="line"><a name="l06050"></a><span class="lineno"> 6050</span>&#160;                                     <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(CFP00, 0),</div><div class="line"><a name="l06051"></a><span class="lineno"> 6051</span>&#160;                                     DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a268e5bc7dd40a28712a33ca6c9c91c6f">getConstantFP</a>(1.0, VT));</div><div class="line"><a name="l06052"></a><span class="lineno"> 6052</span>&#160;        <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9ab5860c97a00c4627a08cab7b0c8178">ISD::FMUL</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT,</div><div class="line"><a name="l06053"></a><span class="lineno"> 6053</span>&#160;                           N1, NewCFP);</div><div class="line"><a name="l06054"></a><span class="lineno"> 6054</span>&#160;      }</div><div class="line"><a name="l06055"></a><span class="lineno"> 6055</span>&#160;</div><div class="line"><a name="l06056"></a><span class="lineno"> 6056</span>&#160;      <span class="comment">// (fadd (fmul x, c), x) -&gt; (fmul x, c+1)</span></div><div class="line"><a name="l06057"></a><span class="lineno"> 6057</span>&#160;      <span class="keywordflow">if</span> (CFP01 &amp;&amp; !CFP00 &amp;&amp; N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0) == N1) {</div><div class="line"><a name="l06058"></a><span class="lineno"> 6058</span>&#160;        <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> NewCFP = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a32ec12017722f5b42a295fe5eb0b0bdf">ISD::FADD</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT,</div><div class="line"><a name="l06059"></a><span class="lineno"> 6059</span>&#160;                                     <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(CFP01, 0),</div><div class="line"><a name="l06060"></a><span class="lineno"> 6060</span>&#160;                                     DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a268e5bc7dd40a28712a33ca6c9c91c6f">getConstantFP</a>(1.0, VT));</div><div class="line"><a name="l06061"></a><span class="lineno"> 6061</span>&#160;        <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9ab5860c97a00c4627a08cab7b0c8178">ISD::FMUL</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT,</div><div class="line"><a name="l06062"></a><span class="lineno"> 6062</span>&#160;                           N1, NewCFP);</div><div class="line"><a name="l06063"></a><span class="lineno"> 6063</span>&#160;      }</div><div class="line"><a name="l06064"></a><span class="lineno"> 6064</span>&#160;</div><div class="line"><a name="l06065"></a><span class="lineno"> 6065</span>&#160;      <span class="comment">// (fadd (fmul c, x), (fadd x, x)) -&gt; (fmul x, c+2)</span></div><div class="line"><a name="l06066"></a><span class="lineno"> 6066</span>&#160;      <span class="keywordflow">if</span> (CFP00 &amp;&amp; !CFP01 &amp;&amp; N1.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a32ec12017722f5b42a295fe5eb0b0bdf">ISD::FADD</a> &amp;&amp;</div><div class="line"><a name="l06067"></a><span class="lineno"> 6067</span>&#160;          N1.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0) == N1.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1) &amp;&amp;</div><div class="line"><a name="l06068"></a><span class="lineno"> 6068</span>&#160;          N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1) == N1.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0)) {</div><div class="line"><a name="l06069"></a><span class="lineno"> 6069</span>&#160;        <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> NewCFP = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a32ec12017722f5b42a295fe5eb0b0bdf">ISD::FADD</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT,</div><div class="line"><a name="l06070"></a><span class="lineno"> 6070</span>&#160;                                     <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(CFP00, 0),</div><div class="line"><a name="l06071"></a><span class="lineno"> 6071</span>&#160;                                     DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a268e5bc7dd40a28712a33ca6c9c91c6f">getConstantFP</a>(2.0, VT));</div><div class="line"><a name="l06072"></a><span class="lineno"> 6072</span>&#160;        <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9ab5860c97a00c4627a08cab7b0c8178">ISD::FMUL</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT,</div><div class="line"><a name="l06073"></a><span class="lineno"> 6073</span>&#160;                           N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1), NewCFP);</div><div class="line"><a name="l06074"></a><span class="lineno"> 6074</span>&#160;      }</div><div class="line"><a name="l06075"></a><span class="lineno"> 6075</span>&#160;</div><div class="line"><a name="l06076"></a><span class="lineno"> 6076</span>&#160;      <span class="comment">// (fadd (fmul x, c), (fadd x, x)) -&gt; (fmul x, c+2)</span></div><div class="line"><a name="l06077"></a><span class="lineno"> 6077</span>&#160;      <span class="keywordflow">if</span> (CFP01 &amp;&amp; !CFP00 &amp;&amp; N1.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a32ec12017722f5b42a295fe5eb0b0bdf">ISD::FADD</a> &amp;&amp;</div><div class="line"><a name="l06078"></a><span class="lineno"> 6078</span>&#160;          N1.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0) == N1.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1) &amp;&amp;</div><div class="line"><a name="l06079"></a><span class="lineno"> 6079</span>&#160;          N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0) == N1.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0)) {</div><div class="line"><a name="l06080"></a><span class="lineno"> 6080</span>&#160;        <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> NewCFP = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a32ec12017722f5b42a295fe5eb0b0bdf">ISD::FADD</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT,</div><div class="line"><a name="l06081"></a><span class="lineno"> 6081</span>&#160;                                     <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(CFP01, 0),</div><div class="line"><a name="l06082"></a><span class="lineno"> 6082</span>&#160;                                     DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a268e5bc7dd40a28712a33ca6c9c91c6f">getConstantFP</a>(2.0, VT));</div><div class="line"><a name="l06083"></a><span class="lineno"> 6083</span>&#160;        <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9ab5860c97a00c4627a08cab7b0c8178">ISD::FMUL</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT,</div><div class="line"><a name="l06084"></a><span class="lineno"> 6084</span>&#160;                           N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0), NewCFP);</div><div class="line"><a name="l06085"></a><span class="lineno"> 6085</span>&#160;      }</div><div class="line"><a name="l06086"></a><span class="lineno"> 6086</span>&#160;    }</div><div class="line"><a name="l06087"></a><span class="lineno"> 6087</span>&#160;</div><div class="line"><a name="l06088"></a><span class="lineno"> 6088</span>&#160;    <span class="keywordflow">if</span> (N1.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9ab5860c97a00c4627a08cab7b0c8178">ISD::FMUL</a>) {</div><div class="line"><a name="l06089"></a><span class="lineno"> 6089</span>&#160;      <a class="code" href="classllvm_1_1ConstantFPSDNode.html">ConstantFPSDNode</a> *CFP10 = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantFPSDNode.html">ConstantFPSDNode</a>&gt;(N1.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0));</div><div class="line"><a name="l06090"></a><span class="lineno"> 6090</span>&#160;      <a class="code" href="classllvm_1_1ConstantFPSDNode.html">ConstantFPSDNode</a> *CFP11 = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantFPSDNode.html">ConstantFPSDNode</a>&gt;(N1.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1));</div><div class="line"><a name="l06091"></a><span class="lineno"> 6091</span>&#160;</div><div class="line"><a name="l06092"></a><span class="lineno"> 6092</span>&#160;      <span class="comment">// (fadd x, (fmul c, x)) -&gt; (fmul x, c+1)</span></div><div class="line"><a name="l06093"></a><span class="lineno"> 6093</span>&#160;      <span class="keywordflow">if</span> (CFP10 &amp;&amp; !CFP11 &amp;&amp; N1.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1) == N0) {</div><div class="line"><a name="l06094"></a><span class="lineno"> 6094</span>&#160;        <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> NewCFP = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a32ec12017722f5b42a295fe5eb0b0bdf">ISD::FADD</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT,</div><div class="line"><a name="l06095"></a><span class="lineno"> 6095</span>&#160;                                     <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(CFP10, 0),</div><div class="line"><a name="l06096"></a><span class="lineno"> 6096</span>&#160;                                     DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a268e5bc7dd40a28712a33ca6c9c91c6f">getConstantFP</a>(1.0, VT));</div><div class="line"><a name="l06097"></a><span class="lineno"> 6097</span>&#160;        <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9ab5860c97a00c4627a08cab7b0c8178">ISD::FMUL</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT,</div><div class="line"><a name="l06098"></a><span class="lineno"> 6098</span>&#160;                           N0, NewCFP);</div><div class="line"><a name="l06099"></a><span class="lineno"> 6099</span>&#160;      }</div><div class="line"><a name="l06100"></a><span class="lineno"> 6100</span>&#160;</div><div class="line"><a name="l06101"></a><span class="lineno"> 6101</span>&#160;      <span class="comment">// (fadd x, (fmul x, c)) -&gt; (fmul x, c+1)</span></div><div class="line"><a name="l06102"></a><span class="lineno"> 6102</span>&#160;      <span class="keywordflow">if</span> (CFP11 &amp;&amp; !CFP10 &amp;&amp; N1.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0) == N0) {</div><div class="line"><a name="l06103"></a><span class="lineno"> 6103</span>&#160;        <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> NewCFP = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a32ec12017722f5b42a295fe5eb0b0bdf">ISD::FADD</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT,</div><div class="line"><a name="l06104"></a><span class="lineno"> 6104</span>&#160;                                     <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(CFP11, 0),</div><div class="line"><a name="l06105"></a><span class="lineno"> 6105</span>&#160;                                     DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a268e5bc7dd40a28712a33ca6c9c91c6f">getConstantFP</a>(1.0, VT));</div><div class="line"><a name="l06106"></a><span class="lineno"> 6106</span>&#160;        <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9ab5860c97a00c4627a08cab7b0c8178">ISD::FMUL</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT,</div><div class="line"><a name="l06107"></a><span class="lineno"> 6107</span>&#160;                           N0, NewCFP);</div><div class="line"><a name="l06108"></a><span class="lineno"> 6108</span>&#160;      }</div><div class="line"><a name="l06109"></a><span class="lineno"> 6109</span>&#160;</div><div class="line"><a name="l06110"></a><span class="lineno"> 6110</span>&#160;</div><div class="line"><a name="l06111"></a><span class="lineno"> 6111</span>&#160;      <span class="comment">// (fadd (fadd x, x), (fmul c, x)) -&gt; (fmul x, c+2)</span></div><div class="line"><a name="l06112"></a><span class="lineno"> 6112</span>&#160;      <span class="keywordflow">if</span> (CFP10 &amp;&amp; !CFP11 &amp;&amp; N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a32ec12017722f5b42a295fe5eb0b0bdf">ISD::FADD</a> &amp;&amp;</div><div class="line"><a name="l06113"></a><span class="lineno"> 6113</span>&#160;          N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0) == N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1) &amp;&amp;</div><div class="line"><a name="l06114"></a><span class="lineno"> 6114</span>&#160;          N1.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1) == N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0)) {</div><div class="line"><a name="l06115"></a><span class="lineno"> 6115</span>&#160;        <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> NewCFP = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a32ec12017722f5b42a295fe5eb0b0bdf">ISD::FADD</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT,</div><div class="line"><a name="l06116"></a><span class="lineno"> 6116</span>&#160;                                     <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(CFP10, 0),</div><div class="line"><a name="l06117"></a><span class="lineno"> 6117</span>&#160;                                     DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a268e5bc7dd40a28712a33ca6c9c91c6f">getConstantFP</a>(2.0, VT));</div><div class="line"><a name="l06118"></a><span class="lineno"> 6118</span>&#160;        <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9ab5860c97a00c4627a08cab7b0c8178">ISD::FMUL</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT,</div><div class="line"><a name="l06119"></a><span class="lineno"> 6119</span>&#160;                           N1.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1), NewCFP);</div><div class="line"><a name="l06120"></a><span class="lineno"> 6120</span>&#160;      }</div><div class="line"><a name="l06121"></a><span class="lineno"> 6121</span>&#160;</div><div class="line"><a name="l06122"></a><span class="lineno"> 6122</span>&#160;      <span class="comment">// (fadd (fadd x, x), (fmul x, c)) -&gt; (fmul x, c+2)</span></div><div class="line"><a name="l06123"></a><span class="lineno"> 6123</span>&#160;      <span class="keywordflow">if</span> (CFP11 &amp;&amp; !CFP10 &amp;&amp; N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a32ec12017722f5b42a295fe5eb0b0bdf">ISD::FADD</a> &amp;&amp;</div><div class="line"><a name="l06124"></a><span class="lineno"> 6124</span>&#160;          N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0) == N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1) &amp;&amp;</div><div class="line"><a name="l06125"></a><span class="lineno"> 6125</span>&#160;          N1.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0) == N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0)) {</div><div class="line"><a name="l06126"></a><span class="lineno"> 6126</span>&#160;        <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> NewCFP = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a32ec12017722f5b42a295fe5eb0b0bdf">ISD::FADD</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT,</div><div class="line"><a name="l06127"></a><span class="lineno"> 6127</span>&#160;                                     <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(CFP11, 0),</div><div class="line"><a name="l06128"></a><span class="lineno"> 6128</span>&#160;                                     DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a268e5bc7dd40a28712a33ca6c9c91c6f">getConstantFP</a>(2.0, VT));</div><div class="line"><a name="l06129"></a><span class="lineno"> 6129</span>&#160;        <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9ab5860c97a00c4627a08cab7b0c8178">ISD::FMUL</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT,</div><div class="line"><a name="l06130"></a><span class="lineno"> 6130</span>&#160;                           N1.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0), NewCFP);</div><div class="line"><a name="l06131"></a><span class="lineno"> 6131</span>&#160;      }</div><div class="line"><a name="l06132"></a><span class="lineno"> 6132</span>&#160;    }</div><div class="line"><a name="l06133"></a><span class="lineno"> 6133</span>&#160;</div><div class="line"><a name="l06134"></a><span class="lineno"> 6134</span>&#160;    <span class="keywordflow">if</span> (N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a32ec12017722f5b42a295fe5eb0b0bdf">ISD::FADD</a> &amp;&amp; AllowNewFpConst) {</div><div class="line"><a name="l06135"></a><span class="lineno"> 6135</span>&#160;      <a class="code" href="classllvm_1_1ConstantFPSDNode.html">ConstantFPSDNode</a> *CFP = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantFPSDNode.html">ConstantFPSDNode</a>&gt;(N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0));</div><div class="line"><a name="l06136"></a><span class="lineno"> 6136</span>&#160;      <span class="comment">// (fadd (fadd x, x), x) -&gt; (fmul x, 3.0)</span></div><div class="line"><a name="l06137"></a><span class="lineno"> 6137</span>&#160;      <span class="keywordflow">if</span> (!CFP &amp;&amp; N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0) == N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1) &amp;&amp;</div><div class="line"><a name="l06138"></a><span class="lineno"> 6138</span>&#160;          (N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0) == N1))</div><div class="line"><a name="l06139"></a><span class="lineno"> 6139</span>&#160;        <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9ab5860c97a00c4627a08cab7b0c8178">ISD::FMUL</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT,</div><div class="line"><a name="l06140"></a><span class="lineno"> 6140</span>&#160;                           N1, DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a268e5bc7dd40a28712a33ca6c9c91c6f">getConstantFP</a>(3.0, VT));</div><div class="line"><a name="l06141"></a><span class="lineno"> 6141</span>&#160;    }</div><div class="line"><a name="l06142"></a><span class="lineno"> 6142</span>&#160;</div><div class="line"><a name="l06143"></a><span class="lineno"> 6143</span>&#160;    <span class="keywordflow">if</span> (N1.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a32ec12017722f5b42a295fe5eb0b0bdf">ISD::FADD</a> &amp;&amp; AllowNewFpConst) {</div><div class="line"><a name="l06144"></a><span class="lineno"> 6144</span>&#160;      <a class="code" href="classllvm_1_1ConstantFPSDNode.html">ConstantFPSDNode</a> *CFP10 = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantFPSDNode.html">ConstantFPSDNode</a>&gt;(N1.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0));</div><div class="line"><a name="l06145"></a><span class="lineno"> 6145</span>&#160;      <span class="comment">// (fadd x, (fadd x, x)) -&gt; (fmul x, 3.0)</span></div><div class="line"><a name="l06146"></a><span class="lineno"> 6146</span>&#160;      <span class="keywordflow">if</span> (!CFP10 &amp;&amp; N1.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0) == N1.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1) &amp;&amp;</div><div class="line"><a name="l06147"></a><span class="lineno"> 6147</span>&#160;          N1.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0) == N0)</div><div class="line"><a name="l06148"></a><span class="lineno"> 6148</span>&#160;        <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9ab5860c97a00c4627a08cab7b0c8178">ISD::FMUL</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT,</div><div class="line"><a name="l06149"></a><span class="lineno"> 6149</span>&#160;                           N0, DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a268e5bc7dd40a28712a33ca6c9c91c6f">getConstantFP</a>(3.0, VT));</div><div class="line"><a name="l06150"></a><span class="lineno"> 6150</span>&#160;    }</div><div class="line"><a name="l06151"></a><span class="lineno"> 6151</span>&#160;</div><div class="line"><a name="l06152"></a><span class="lineno"> 6152</span>&#160;    <span class="comment">// (fadd (fadd x, x), (fadd x, x)) -&gt; (fmul x, 4.0)</span></div><div class="line"><a name="l06153"></a><span class="lineno"> 6153</span>&#160;    <span class="keywordflow">if</span> (AllowNewFpConst &amp;&amp;</div><div class="line"><a name="l06154"></a><span class="lineno"> 6154</span>&#160;        N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a32ec12017722f5b42a295fe5eb0b0bdf">ISD::FADD</a> &amp;&amp; N1.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a32ec12017722f5b42a295fe5eb0b0bdf">ISD::FADD</a> &amp;&amp;</div><div class="line"><a name="l06155"></a><span class="lineno"> 6155</span>&#160;        N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0) == N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1) &amp;&amp;</div><div class="line"><a name="l06156"></a><span class="lineno"> 6156</span>&#160;        N1.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0) == N1.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1) &amp;&amp;</div><div class="line"><a name="l06157"></a><span class="lineno"> 6157</span>&#160;        N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0) == N1.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0))</div><div class="line"><a name="l06158"></a><span class="lineno"> 6158</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9ab5860c97a00c4627a08cab7b0c8178">ISD::FMUL</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT,</div><div class="line"><a name="l06159"></a><span class="lineno"> 6159</span>&#160;                         N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0),</div><div class="line"><a name="l06160"></a><span class="lineno"> 6160</span>&#160;                         DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a268e5bc7dd40a28712a33ca6c9c91c6f">getConstantFP</a>(4.0, VT));</div><div class="line"><a name="l06161"></a><span class="lineno"> 6161</span>&#160;  }</div><div class="line"><a name="l06162"></a><span class="lineno"> 6162</span>&#160;</div><div class="line"><a name="l06163"></a><span class="lineno"> 6163</span>&#160;  <span class="comment">// FADD -&gt; FMA combines:</span></div><div class="line"><a name="l06164"></a><span class="lineno"> 6164</span>&#160;  <span class="keywordflow">if</span> ((DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a6b60694d1d9d7f634e7638856898e20d">getTarget</a>().<a class="code" href="classllvm_1_1TargetMachine.html#ab1fb67187fc37e569cc5171cbebba873">Options</a>.<a class="code" href="classllvm_1_1TargetOptions.html#affeb69a55c900f2d333c385955676931">AllowFPOpFusion</a> == <a class="code" href="namespacellvm_1_1FPOpFusion.html#a9c71bae9f02af273833fde586d529fc5aa9dfaae1f5b7d4ebb31ccf9aee1aacce">FPOpFusion::Fast</a> ||</div><div class="line"><a name="l06165"></a><span class="lineno"> 6165</span>&#160;       DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a6b60694d1d9d7f634e7638856898e20d">getTarget</a>().<a class="code" href="classllvm_1_1TargetMachine.html#ab1fb67187fc37e569cc5171cbebba873">Options</a>.<a class="code" href="classllvm_1_1TargetOptions.html#a0544e2966374684ff74255e5a4290fa7">UnsafeFPMath</a>) &amp;&amp;</div><div class="line"><a name="l06166"></a><span class="lineno"> 6166</span>&#160;      DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a6b60694d1d9d7f634e7638856898e20d">getTarget</a>().<a class="code" href="classllvm_1_1TargetMachine.html#ac962b1af600c2e418625a5fecc5e0f95">getTargetLowering</a>()-&gt;<a class="code" href="classllvm_1_1TargetLoweringBase.html#a8cbe090e0985c49fdc3d9b27b42788f0">isFMAFasterThanFMulAndFAdd</a>(VT) &amp;&amp;</div><div class="line"><a name="l06167"></a><span class="lineno"> 6167</span>&#160;      (!LegalOperations || TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a087dd0f9650e999b087c17cc7f46f2d0">isOperationLegalOrCustom</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a293ca68b3b2ce80eef991de822822254">ISD::FMA</a>, VT))) {</div><div class="line"><a name="l06168"></a><span class="lineno"> 6168</span>&#160;</div><div class="line"><a name="l06169"></a><span class="lineno"> 6169</span>&#160;    <span class="comment">// fold (fadd (fmul x, y), z) -&gt; (fma x, y, z)</span></div><div class="line"><a name="l06170"></a><span class="lineno"> 6170</span>&#160;    <span class="keywordflow">if</span> (N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9ab5860c97a00c4627a08cab7b0c8178">ISD::FMUL</a> &amp;&amp; N0-&gt;<a class="code" href="classllvm_1_1SDNode.html#a52753947fce3a01b1c18dd4713c587e8">hasOneUse</a>())</div><div class="line"><a name="l06171"></a><span class="lineno"> 6171</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a293ca68b3b2ce80eef991de822822254">ISD::FMA</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT,</div><div class="line"><a name="l06172"></a><span class="lineno"> 6172</span>&#160;                         N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0), N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1), N1);</div><div class="line"><a name="l06173"></a><span class="lineno"> 6173</span>&#160;</div><div class="line"><a name="l06174"></a><span class="lineno"> 6174</span>&#160;    <span class="comment">// fold (fadd x, (fmul y, z)) -&gt; (fma y, z, x)</span></div><div class="line"><a name="l06175"></a><span class="lineno"> 6175</span>&#160;    <span class="comment">// Note: Commutes FADD operands.</span></div><div class="line"><a name="l06176"></a><span class="lineno"> 6176</span>&#160;    <span class="keywordflow">if</span> (N1.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9ab5860c97a00c4627a08cab7b0c8178">ISD::FMUL</a> &amp;&amp; N1-&gt;<a class="code" href="classllvm_1_1SDNode.html#a52753947fce3a01b1c18dd4713c587e8">hasOneUse</a>())</div><div class="line"><a name="l06177"></a><span class="lineno"> 6177</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a293ca68b3b2ce80eef991de822822254">ISD::FMA</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT,</div><div class="line"><a name="l06178"></a><span class="lineno"> 6178</span>&#160;                         N1.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0), N1.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1), N0);</div><div class="line"><a name="l06179"></a><span class="lineno"> 6179</span>&#160;  }</div><div class="line"><a name="l06180"></a><span class="lineno"> 6180</span>&#160;</div><div class="line"><a name="l06181"></a><span class="lineno"> 6181</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l06182"></a><span class="lineno"> 6182</span>&#160;}</div><div class="line"><a name="l06183"></a><span class="lineno"> 6183</span>&#160;</div><div class="line"><a name="l06184"></a><span class="lineno"> 6184</span>&#160;<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::visitFSUB(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N) {</div><div class="line"><a name="l06185"></a><span class="lineno"> 6185</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N0 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0);</div><div class="line"><a name="l06186"></a><span class="lineno"> 6186</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N1 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(1);</div><div class="line"><a name="l06187"></a><span class="lineno"> 6187</span>&#160;  <a class="code" href="classllvm_1_1ConstantFPSDNode.html">ConstantFPSDNode</a> *N0CFP = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantFPSDNode.html">ConstantFPSDNode</a>&gt;(N0);</div><div class="line"><a name="l06188"></a><span class="lineno"> 6188</span>&#160;  <a class="code" href="classllvm_1_1ConstantFPSDNode.html">ConstantFPSDNode</a> *N1CFP = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantFPSDNode.html">ConstantFPSDNode</a>&gt;(N1);</div><div class="line"><a name="l06189"></a><span class="lineno"> 6189</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> VT = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(0);</div><div class="line"><a name="l06190"></a><span class="lineno"> 6190</span>&#160;  <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a> dl(N);</div><div class="line"><a name="l06191"></a><span class="lineno"> 6191</span>&#160;</div><div class="line"><a name="l06192"></a><span class="lineno"> 6192</span>&#160;  <span class="comment">// fold vector ops</span></div><div class="line"><a name="l06193"></a><span class="lineno"> 6193</span>&#160;  <span class="keywordflow">if</span> (VT.isVector()) {</div><div class="line"><a name="l06194"></a><span class="lineno"> 6194</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> FoldedVOp = SimplifyVBinOp(N);</div><div class="line"><a name="l06195"></a><span class="lineno"> 6195</span>&#160;    <span class="keywordflow">if</span> (FoldedVOp.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()) <span class="keywordflow">return</span> FoldedVOp;</div><div class="line"><a name="l06196"></a><span class="lineno"> 6196</span>&#160;  }</div><div class="line"><a name="l06197"></a><span class="lineno"> 6197</span>&#160;</div><div class="line"><a name="l06198"></a><span class="lineno"> 6198</span>&#160;  <span class="comment">// fold (fsub c1, c2) -&gt; c1-c2</span></div><div class="line"><a name="l06199"></a><span class="lineno"> 6199</span>&#160;  <span class="keywordflow">if</span> (N0CFP &amp;&amp; N1CFP)</div><div class="line"><a name="l06200"></a><span class="lineno"> 6200</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a2852a5b6baa80b1589a46737210a8cad">ISD::FSUB</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N0, N1);</div><div class="line"><a name="l06201"></a><span class="lineno"> 6201</span>&#160;  <span class="comment">// fold (fsub A, 0) -&gt; A</span></div><div class="line"><a name="l06202"></a><span class="lineno"> 6202</span>&#160;  <span class="keywordflow">if</span> (DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a6b60694d1d9d7f634e7638856898e20d">getTarget</a>().<a class="code" href="classllvm_1_1TargetMachine.html#ab1fb67187fc37e569cc5171cbebba873">Options</a>.<a class="code" href="classllvm_1_1TargetOptions.html#a0544e2966374684ff74255e5a4290fa7">UnsafeFPMath</a> &amp;&amp;</div><div class="line"><a name="l06203"></a><span class="lineno"> 6203</span>&#160;      N1CFP &amp;&amp; N1CFP-&gt;getValueAPF().isZero())</div><div class="line"><a name="l06204"></a><span class="lineno"> 6204</span>&#160;    <span class="keywordflow">return</span> N0;</div><div class="line"><a name="l06205"></a><span class="lineno"> 6205</span>&#160;  <span class="comment">// fold (fsub 0, B) -&gt; -B</span></div><div class="line"><a name="l06206"></a><span class="lineno"> 6206</span>&#160;  <span class="keywordflow">if</span> (DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a6b60694d1d9d7f634e7638856898e20d">getTarget</a>().<a class="code" href="classllvm_1_1TargetMachine.html#ab1fb67187fc37e569cc5171cbebba873">Options</a>.<a class="code" href="classllvm_1_1TargetOptions.html#a0544e2966374684ff74255e5a4290fa7">UnsafeFPMath</a> &amp;&amp;</div><div class="line"><a name="l06207"></a><span class="lineno"> 6207</span>&#160;      N0CFP &amp;&amp; N0CFP-&gt;<a class="code" href="classllvm_1_1ConstantFPSDNode.html#a31c374d2e45ef09b957dce7356380ccd">getValueAPF</a>().<a class="code" href="classllvm_1_1APFloat.html#a30b29f2be19eb73f6225de032a1fafb3">isZero</a>()) {</div><div class="line"><a name="l06208"></a><span class="lineno"> 6208</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="DAGCombiner_8cpp.html#aec1e6891acbf695c615301db72893862">isNegatibleForFree</a>(N1, LegalOperations, TLI, &amp;DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a6b60694d1d9d7f634e7638856898e20d">getTarget</a>().<a class="code" href="classllvm_1_1TargetMachine.html#ab1fb67187fc37e569cc5171cbebba873">Options</a>))</div><div class="line"><a name="l06209"></a><span class="lineno"> 6209</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="DAGCombiner_8cpp.html#a55d3de0deed33d70188b2b5a9cab8f00">GetNegatedExpression</a>(N1, DAG, LegalOperations);</div><div class="line"><a name="l06210"></a><span class="lineno"> 6210</span>&#160;    <span class="keywordflow">if</span> (!LegalOperations || TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a055b3905dbbc16fae11510b9ebd1e00c">isOperationLegal</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a6d26c45c040d8f85d577a5f645261d1a">ISD::FNEG</a>, VT))</div><div class="line"><a name="l06211"></a><span class="lineno"> 6211</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a6d26c45c040d8f85d577a5f645261d1a">ISD::FNEG</a>, dl, VT, N1);</div><div class="line"><a name="l06212"></a><span class="lineno"> 6212</span>&#160;  }</div><div class="line"><a name="l06213"></a><span class="lineno"> 6213</span>&#160;  <span class="comment">// fold (fsub A, (fneg B)) -&gt; (fadd A, B)</span></div><div class="line"><a name="l06214"></a><span class="lineno"> 6214</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="DAGCombiner_8cpp.html#aec1e6891acbf695c615301db72893862">isNegatibleForFree</a>(N1, LegalOperations, TLI, &amp;DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a6b60694d1d9d7f634e7638856898e20d">getTarget</a>().<a class="code" href="classllvm_1_1TargetMachine.html#ab1fb67187fc37e569cc5171cbebba873">Options</a>))</div><div class="line"><a name="l06215"></a><span class="lineno"> 6215</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a32ec12017722f5b42a295fe5eb0b0bdf">ISD::FADD</a>, dl, VT, N0,</div><div class="line"><a name="l06216"></a><span class="lineno"> 6216</span>&#160;                       <a class="code" href="DAGCombiner_8cpp.html#a55d3de0deed33d70188b2b5a9cab8f00">GetNegatedExpression</a>(N1, DAG, LegalOperations));</div><div class="line"><a name="l06217"></a><span class="lineno"> 6217</span>&#160;</div><div class="line"><a name="l06218"></a><span class="lineno"> 6218</span>&#160;  <span class="comment">// If &#39;unsafe math&#39; is enabled, fold</span></div><div class="line"><a name="l06219"></a><span class="lineno"> 6219</span>&#160;  <span class="comment">//    (fsub x, x) -&gt; 0.0 &amp;</span></div><div class="line"><a name="l06220"></a><span class="lineno"> 6220</span>&#160;  <span class="comment">//    (fsub x, (fadd x, y)) -&gt; (fneg y) &amp;</span></div><div class="line"><a name="l06221"></a><span class="lineno"> 6221</span>&#160;  <span class="comment">//    (fsub x, (fadd y, x)) -&gt; (fneg y)</span></div><div class="line"><a name="l06222"></a><span class="lineno"> 6222</span>&#160;  <span class="keywordflow">if</span> (DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a6b60694d1d9d7f634e7638856898e20d">getTarget</a>().<a class="code" href="classllvm_1_1TargetMachine.html#ab1fb67187fc37e569cc5171cbebba873">Options</a>.<a class="code" href="classllvm_1_1TargetOptions.html#a0544e2966374684ff74255e5a4290fa7">UnsafeFPMath</a>) {</div><div class="line"><a name="l06223"></a><span class="lineno"> 6223</span>&#160;    <span class="keywordflow">if</span> (N0 == N1)</div><div class="line"><a name="l06224"></a><span class="lineno"> 6224</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a268e5bc7dd40a28712a33ca6c9c91c6f">getConstantFP</a>(0.0<a class="code" href="README__ALTIVEC_8txt.html#afb354c8aea0150628f8aa06c7f4a4168">f</a>, VT);</div><div class="line"><a name="l06225"></a><span class="lineno"> 6225</span>&#160;</div><div class="line"><a name="l06226"></a><span class="lineno"> 6226</span>&#160;    <span class="keywordflow">if</span> (N1.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a32ec12017722f5b42a295fe5eb0b0bdf">ISD::FADD</a>) {</div><div class="line"><a name="l06227"></a><span class="lineno"> 6227</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N10 = N1-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0);</div><div class="line"><a name="l06228"></a><span class="lineno"> 6228</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N11 = N1-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(1);</div><div class="line"><a name="l06229"></a><span class="lineno"> 6229</span>&#160;</div><div class="line"><a name="l06230"></a><span class="lineno"> 6230</span>&#160;      <span class="keywordflow">if</span> (N10 == N0 &amp;&amp; <a class="code" href="DAGCombiner_8cpp.html#aec1e6891acbf695c615301db72893862">isNegatibleForFree</a>(N11, LegalOperations, TLI,</div><div class="line"><a name="l06231"></a><span class="lineno"> 6231</span>&#160;                                          &amp;DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a6b60694d1d9d7f634e7638856898e20d">getTarget</a>().<a class="code" href="classllvm_1_1TargetMachine.html#ab1fb67187fc37e569cc5171cbebba873">Options</a>))</div><div class="line"><a name="l06232"></a><span class="lineno"> 6232</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="DAGCombiner_8cpp.html#a55d3de0deed33d70188b2b5a9cab8f00">GetNegatedExpression</a>(N11, DAG, LegalOperations);</div><div class="line"><a name="l06233"></a><span class="lineno"> 6233</span>&#160;</div><div class="line"><a name="l06234"></a><span class="lineno"> 6234</span>&#160;      <span class="keywordflow">if</span> (N11 == N0 &amp;&amp; <a class="code" href="DAGCombiner_8cpp.html#aec1e6891acbf695c615301db72893862">isNegatibleForFree</a>(N10, LegalOperations, TLI,</div><div class="line"><a name="l06235"></a><span class="lineno"> 6235</span>&#160;                                          &amp;DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a6b60694d1d9d7f634e7638856898e20d">getTarget</a>().<a class="code" href="classllvm_1_1TargetMachine.html#ab1fb67187fc37e569cc5171cbebba873">Options</a>))</div><div class="line"><a name="l06236"></a><span class="lineno"> 6236</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="DAGCombiner_8cpp.html#a55d3de0deed33d70188b2b5a9cab8f00">GetNegatedExpression</a>(N10, DAG, LegalOperations);</div><div class="line"><a name="l06237"></a><span class="lineno"> 6237</span>&#160;    }</div><div class="line"><a name="l06238"></a><span class="lineno"> 6238</span>&#160;  }</div><div class="line"><a name="l06239"></a><span class="lineno"> 6239</span>&#160;</div><div class="line"><a name="l06240"></a><span class="lineno"> 6240</span>&#160;  <span class="comment">// FSUB -&gt; FMA combines:</span></div><div class="line"><a name="l06241"></a><span class="lineno"> 6241</span>&#160;  <span class="keywordflow">if</span> ((DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a6b60694d1d9d7f634e7638856898e20d">getTarget</a>().<a class="code" href="classllvm_1_1TargetMachine.html#ab1fb67187fc37e569cc5171cbebba873">Options</a>.<a class="code" href="classllvm_1_1TargetOptions.html#affeb69a55c900f2d333c385955676931">AllowFPOpFusion</a> == <a class="code" href="namespacellvm_1_1FPOpFusion.html#a9c71bae9f02af273833fde586d529fc5aa9dfaae1f5b7d4ebb31ccf9aee1aacce">FPOpFusion::Fast</a> ||</div><div class="line"><a name="l06242"></a><span class="lineno"> 6242</span>&#160;       DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a6b60694d1d9d7f634e7638856898e20d">getTarget</a>().<a class="code" href="classllvm_1_1TargetMachine.html#ab1fb67187fc37e569cc5171cbebba873">Options</a>.<a class="code" href="classllvm_1_1TargetOptions.html#a0544e2966374684ff74255e5a4290fa7">UnsafeFPMath</a>) &amp;&amp;</div><div class="line"><a name="l06243"></a><span class="lineno"> 6243</span>&#160;      DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a6b60694d1d9d7f634e7638856898e20d">getTarget</a>().<a class="code" href="classllvm_1_1TargetMachine.html#ac962b1af600c2e418625a5fecc5e0f95">getTargetLowering</a>()-&gt;<a class="code" href="classllvm_1_1TargetLoweringBase.html#a8cbe090e0985c49fdc3d9b27b42788f0">isFMAFasterThanFMulAndFAdd</a>(VT) &amp;&amp;</div><div class="line"><a name="l06244"></a><span class="lineno"> 6244</span>&#160;      (!LegalOperations || TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a087dd0f9650e999b087c17cc7f46f2d0">isOperationLegalOrCustom</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a293ca68b3b2ce80eef991de822822254">ISD::FMA</a>, VT))) {</div><div class="line"><a name="l06245"></a><span class="lineno"> 6245</span>&#160;</div><div class="line"><a name="l06246"></a><span class="lineno"> 6246</span>&#160;    <span class="comment">// fold (fsub (fmul x, y), z) -&gt; (fma x, y, (fneg z))</span></div><div class="line"><a name="l06247"></a><span class="lineno"> 6247</span>&#160;    <span class="keywordflow">if</span> (N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9ab5860c97a00c4627a08cab7b0c8178">ISD::FMUL</a> &amp;&amp; N0-&gt;<a class="code" href="classllvm_1_1SDNode.html#a52753947fce3a01b1c18dd4713c587e8">hasOneUse</a>())</div><div class="line"><a name="l06248"></a><span class="lineno"> 6248</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a293ca68b3b2ce80eef991de822822254">ISD::FMA</a>, dl, VT,</div><div class="line"><a name="l06249"></a><span class="lineno"> 6249</span>&#160;                         N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0), N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1),</div><div class="line"><a name="l06250"></a><span class="lineno"> 6250</span>&#160;                         DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a6d26c45c040d8f85d577a5f645261d1a">ISD::FNEG</a>, dl, VT, N1));</div><div class="line"><a name="l06251"></a><span class="lineno"> 6251</span>&#160;</div><div class="line"><a name="l06252"></a><span class="lineno"> 6252</span>&#160;    <span class="comment">// fold (fsub x, (fmul y, z)) -&gt; (fma (fneg y), z, x)</span></div><div class="line"><a name="l06253"></a><span class="lineno"> 6253</span>&#160;    <span class="comment">// Note: Commutes FSUB operands.</span></div><div class="line"><a name="l06254"></a><span class="lineno"> 6254</span>&#160;    <span class="keywordflow">if</span> (N1.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9ab5860c97a00c4627a08cab7b0c8178">ISD::FMUL</a> &amp;&amp; N1-&gt;<a class="code" href="classllvm_1_1SDNode.html#a52753947fce3a01b1c18dd4713c587e8">hasOneUse</a>())</div><div class="line"><a name="l06255"></a><span class="lineno"> 6255</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a293ca68b3b2ce80eef991de822822254">ISD::FMA</a>, dl, VT,</div><div class="line"><a name="l06256"></a><span class="lineno"> 6256</span>&#160;                         DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a6d26c45c040d8f85d577a5f645261d1a">ISD::FNEG</a>, dl, VT,</div><div class="line"><a name="l06257"></a><span class="lineno"> 6257</span>&#160;                         N1.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0)),</div><div class="line"><a name="l06258"></a><span class="lineno"> 6258</span>&#160;                         N1.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1), N0);</div><div class="line"><a name="l06259"></a><span class="lineno"> 6259</span>&#160;</div><div class="line"><a name="l06260"></a><span class="lineno"> 6260</span>&#160;    <span class="comment">// fold (fsub (fneg (fmul, x, y)), z) -&gt; (fma (fneg x), y, (fneg z))</span></div><div class="line"><a name="l06261"></a><span class="lineno"> 6261</span>&#160;    <span class="keywordflow">if</span> (N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a6d26c45c040d8f85d577a5f645261d1a">ISD::FNEG</a> &amp;&amp;</div><div class="line"><a name="l06262"></a><span class="lineno"> 6262</span>&#160;        N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9ab5860c97a00c4627a08cab7b0c8178">ISD::FMUL</a> &amp;&amp;</div><div class="line"><a name="l06263"></a><span class="lineno"> 6263</span>&#160;        N0-&gt;<a class="code" href="classllvm_1_1SDNode.html#a52753947fce3a01b1c18dd4713c587e8">hasOneUse</a>() &amp;&amp; N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a97b0f24f3e52f030830fca6fbfcbd37d">hasOneUse</a>()) {</div><div class="line"><a name="l06264"></a><span class="lineno"> 6264</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N00 = N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0);</div><div class="line"><a name="l06265"></a><span class="lineno"> 6265</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N01 = N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1);</div><div class="line"><a name="l06266"></a><span class="lineno"> 6266</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a293ca68b3b2ce80eef991de822822254">ISD::FMA</a>, dl, VT,</div><div class="line"><a name="l06267"></a><span class="lineno"> 6267</span>&#160;                         DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a6d26c45c040d8f85d577a5f645261d1a">ISD::FNEG</a>, dl, VT, N00), N01,</div><div class="line"><a name="l06268"></a><span class="lineno"> 6268</span>&#160;                         DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a6d26c45c040d8f85d577a5f645261d1a">ISD::FNEG</a>, dl, VT, N1));</div><div class="line"><a name="l06269"></a><span class="lineno"> 6269</span>&#160;    }</div><div class="line"><a name="l06270"></a><span class="lineno"> 6270</span>&#160;  }</div><div class="line"><a name="l06271"></a><span class="lineno"> 6271</span>&#160;</div><div class="line"><a name="l06272"></a><span class="lineno"> 6272</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l06273"></a><span class="lineno"> 6273</span>&#160;}</div><div class="line"><a name="l06274"></a><span class="lineno"> 6274</span>&#160;</div><div class="line"><a name="l06275"></a><span class="lineno"> 6275</span>&#160;<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::visitFMUL(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N) {</div><div class="line"><a name="l06276"></a><span class="lineno"> 6276</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N0 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0);</div><div class="line"><a name="l06277"></a><span class="lineno"> 6277</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N1 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(1);</div><div class="line"><a name="l06278"></a><span class="lineno"> 6278</span>&#160;  <a class="code" href="classllvm_1_1ConstantFPSDNode.html">ConstantFPSDNode</a> *N0CFP = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantFPSDNode.html">ConstantFPSDNode</a>&gt;(N0);</div><div class="line"><a name="l06279"></a><span class="lineno"> 6279</span>&#160;  <a class="code" href="classllvm_1_1ConstantFPSDNode.html">ConstantFPSDNode</a> *N1CFP = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantFPSDNode.html">ConstantFPSDNode</a>&gt;(N1);</div><div class="line"><a name="l06280"></a><span class="lineno"> 6280</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> VT = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(0);</div><div class="line"><a name="l06281"></a><span class="lineno"> 6281</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetLowering.html">TargetLowering</a> &amp;TLI = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a848b46af8fabd1ab34b28adbc3665609">getTargetLoweringInfo</a>();</div><div class="line"><a name="l06282"></a><span class="lineno"> 6282</span>&#160;</div><div class="line"><a name="l06283"></a><span class="lineno"> 6283</span>&#160;  <span class="comment">// fold vector ops</span></div><div class="line"><a name="l06284"></a><span class="lineno"> 6284</span>&#160;  <span class="keywordflow">if</span> (VT.isVector()) {</div><div class="line"><a name="l06285"></a><span class="lineno"> 6285</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> FoldedVOp = SimplifyVBinOp(N);</div><div class="line"><a name="l06286"></a><span class="lineno"> 6286</span>&#160;    <span class="keywordflow">if</span> (FoldedVOp.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()) <span class="keywordflow">return</span> FoldedVOp;</div><div class="line"><a name="l06287"></a><span class="lineno"> 6287</span>&#160;  }</div><div class="line"><a name="l06288"></a><span class="lineno"> 6288</span>&#160;</div><div class="line"><a name="l06289"></a><span class="lineno"> 6289</span>&#160;  <span class="comment">// fold (fmul c1, c2) -&gt; c1*c2</span></div><div class="line"><a name="l06290"></a><span class="lineno"> 6290</span>&#160;  <span class="keywordflow">if</span> (N0CFP &amp;&amp; N1CFP)</div><div class="line"><a name="l06291"></a><span class="lineno"> 6291</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9ab5860c97a00c4627a08cab7b0c8178">ISD::FMUL</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N0, N1);</div><div class="line"><a name="l06292"></a><span class="lineno"> 6292</span>&#160;  <span class="comment">// canonicalize constant to RHS</span></div><div class="line"><a name="l06293"></a><span class="lineno"> 6293</span>&#160;  <span class="keywordflow">if</span> (N0CFP &amp;&amp; !N1CFP)</div><div class="line"><a name="l06294"></a><span class="lineno"> 6294</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9ab5860c97a00c4627a08cab7b0c8178">ISD::FMUL</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N1, N0);</div><div class="line"><a name="l06295"></a><span class="lineno"> 6295</span>&#160;  <span class="comment">// fold (fmul A, 0) -&gt; 0</span></div><div class="line"><a name="l06296"></a><span class="lineno"> 6296</span>&#160;  <span class="keywordflow">if</span> (DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a6b60694d1d9d7f634e7638856898e20d">getTarget</a>().<a class="code" href="classllvm_1_1TargetMachine.html#ab1fb67187fc37e569cc5171cbebba873">Options</a>.<a class="code" href="classllvm_1_1TargetOptions.html#a0544e2966374684ff74255e5a4290fa7">UnsafeFPMath</a> &amp;&amp;</div><div class="line"><a name="l06297"></a><span class="lineno"> 6297</span>&#160;      N1CFP &amp;&amp; N1CFP-&gt;getValueAPF().isZero())</div><div class="line"><a name="l06298"></a><span class="lineno"> 6298</span>&#160;    <span class="keywordflow">return</span> N1;</div><div class="line"><a name="l06299"></a><span class="lineno"> 6299</span>&#160;  <span class="comment">// fold (fmul A, 0) -&gt; 0, vector edition.</span></div><div class="line"><a name="l06300"></a><span class="lineno"> 6300</span>&#160;  <span class="keywordflow">if</span> (DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a6b60694d1d9d7f634e7638856898e20d">getTarget</a>().<a class="code" href="classllvm_1_1TargetMachine.html#ab1fb67187fc37e569cc5171cbebba873">Options</a>.<a class="code" href="classllvm_1_1TargetOptions.html#a0544e2966374684ff74255e5a4290fa7">UnsafeFPMath</a> &amp;&amp;</div><div class="line"><a name="l06301"></a><span class="lineno"> 6301</span>&#160;      <a class="code" href="namespacellvm_1_1ISD.html#aaac3e239cbdfe15a8e9bad4f8e1e3a95">ISD::isBuildVectorAllZeros</a>(N1.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()))</div><div class="line"><a name="l06302"></a><span class="lineno"> 6302</span>&#160;    <span class="keywordflow">return</span> N1;</div><div class="line"><a name="l06303"></a><span class="lineno"> 6303</span>&#160;  <span class="comment">// fold (fmul A, 1.0) -&gt; A</span></div><div class="line"><a name="l06304"></a><span class="lineno"> 6304</span>&#160;  <span class="keywordflow">if</span> (N1CFP &amp;&amp; N1CFP-&gt;isExactlyValue(1.0))</div><div class="line"><a name="l06305"></a><span class="lineno"> 6305</span>&#160;    <span class="keywordflow">return</span> N0;</div><div class="line"><a name="l06306"></a><span class="lineno"> 6306</span>&#160;  <span class="comment">// fold (fmul X, 2.0) -&gt; (fadd X, X)</span></div><div class="line"><a name="l06307"></a><span class="lineno"> 6307</span>&#160;  <span class="keywordflow">if</span> (N1CFP &amp;&amp; N1CFP-&gt;isExactlyValue(+2.0))</div><div class="line"><a name="l06308"></a><span class="lineno"> 6308</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a32ec12017722f5b42a295fe5eb0b0bdf">ISD::FADD</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N0, N0);</div><div class="line"><a name="l06309"></a><span class="lineno"> 6309</span>&#160;  <span class="comment">// fold (fmul X, -1.0) -&gt; (fneg X)</span></div><div class="line"><a name="l06310"></a><span class="lineno"> 6310</span>&#160;  <span class="keywordflow">if</span> (N1CFP &amp;&amp; N1CFP-&gt;isExactlyValue(-1.0))</div><div class="line"><a name="l06311"></a><span class="lineno"> 6311</span>&#160;    <span class="keywordflow">if</span> (!LegalOperations || TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a055b3905dbbc16fae11510b9ebd1e00c">isOperationLegal</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a6d26c45c040d8f85d577a5f645261d1a">ISD::FNEG</a>, VT))</div><div class="line"><a name="l06312"></a><span class="lineno"> 6312</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a6d26c45c040d8f85d577a5f645261d1a">ISD::FNEG</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N0);</div><div class="line"><a name="l06313"></a><span class="lineno"> 6313</span>&#160;</div><div class="line"><a name="l06314"></a><span class="lineno"> 6314</span>&#160;  <span class="comment">// fold (fmul (fneg X), (fneg Y)) -&gt; (fmul X, Y)</span></div><div class="line"><a name="l06315"></a><span class="lineno"> 6315</span>&#160;  <span class="keywordflow">if</span> (<span class="keywordtype">char</span> LHSNeg = <a class="code" href="DAGCombiner_8cpp.html#aec1e6891acbf695c615301db72893862">isNegatibleForFree</a>(N0, LegalOperations, TLI,</div><div class="line"><a name="l06316"></a><span class="lineno"> 6316</span>&#160;                                       &amp;DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a6b60694d1d9d7f634e7638856898e20d">getTarget</a>().<a class="code" href="classllvm_1_1TargetMachine.html#ab1fb67187fc37e569cc5171cbebba873">Options</a>)) {</div><div class="line"><a name="l06317"></a><span class="lineno"> 6317</span>&#160;    <span class="keywordflow">if</span> (<span class="keywordtype">char</span> RHSNeg = <a class="code" href="DAGCombiner_8cpp.html#aec1e6891acbf695c615301db72893862">isNegatibleForFree</a>(N1, LegalOperations, TLI,</div><div class="line"><a name="l06318"></a><span class="lineno"> 6318</span>&#160;                                         &amp;DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a6b60694d1d9d7f634e7638856898e20d">getTarget</a>().<a class="code" href="classllvm_1_1TargetMachine.html#ab1fb67187fc37e569cc5171cbebba873">Options</a>)) {</div><div class="line"><a name="l06319"></a><span class="lineno"> 6319</span>&#160;      <span class="comment">// Both can be negated for free, check to see if at least one is cheaper</span></div><div class="line"><a name="l06320"></a><span class="lineno"> 6320</span>&#160;      <span class="comment">// negated.</span></div><div class="line"><a name="l06321"></a><span class="lineno"> 6321</span>&#160;      <span class="keywordflow">if</span> (LHSNeg == 2 || RHSNeg == 2)</div><div class="line"><a name="l06322"></a><span class="lineno"> 6322</span>&#160;        <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9ab5860c97a00c4627a08cab7b0c8178">ISD::FMUL</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT,</div><div class="line"><a name="l06323"></a><span class="lineno"> 6323</span>&#160;                           <a class="code" href="DAGCombiner_8cpp.html#a55d3de0deed33d70188b2b5a9cab8f00">GetNegatedExpression</a>(N0, DAG, LegalOperations),</div><div class="line"><a name="l06324"></a><span class="lineno"> 6324</span>&#160;                           <a class="code" href="DAGCombiner_8cpp.html#a55d3de0deed33d70188b2b5a9cab8f00">GetNegatedExpression</a>(N1, DAG, LegalOperations));</div><div class="line"><a name="l06325"></a><span class="lineno"> 6325</span>&#160;    }</div><div class="line"><a name="l06326"></a><span class="lineno"> 6326</span>&#160;  }</div><div class="line"><a name="l06327"></a><span class="lineno"> 6327</span>&#160;</div><div class="line"><a name="l06328"></a><span class="lineno"> 6328</span>&#160;  <span class="comment">// If allowed, fold (fmul (fmul x, c1), c2) -&gt; (fmul x, (fmul c1, c2))</span></div><div class="line"><a name="l06329"></a><span class="lineno"> 6329</span>&#160;  <span class="keywordflow">if</span> (DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a6b60694d1d9d7f634e7638856898e20d">getTarget</a>().<a class="code" href="classllvm_1_1TargetMachine.html#ab1fb67187fc37e569cc5171cbebba873">Options</a>.<a class="code" href="classllvm_1_1TargetOptions.html#a0544e2966374684ff74255e5a4290fa7">UnsafeFPMath</a> &amp;&amp;</div><div class="line"><a name="l06330"></a><span class="lineno"> 6330</span>&#160;      N1CFP &amp;&amp; N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9ab5860c97a00c4627a08cab7b0c8178">ISD::FMUL</a> &amp;&amp;</div><div class="line"><a name="l06331"></a><span class="lineno"> 6331</span>&#160;      N0.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()-&gt;<a class="code" href="classllvm_1_1SDNode.html#a52753947fce3a01b1c18dd4713c587e8">hasOneUse</a>() &amp;&amp; isa&lt;ConstantFPSDNode&gt;(N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1)))</div><div class="line"><a name="l06332"></a><span class="lineno"> 6332</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9ab5860c97a00c4627a08cab7b0c8178">ISD::FMUL</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0),</div><div class="line"><a name="l06333"></a><span class="lineno"> 6333</span>&#160;                       DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9ab5860c97a00c4627a08cab7b0c8178">ISD::FMUL</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT,</div><div class="line"><a name="l06334"></a><span class="lineno"> 6334</span>&#160;                                   N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1), N1));</div><div class="line"><a name="l06335"></a><span class="lineno"> 6335</span>&#160;</div><div class="line"><a name="l06336"></a><span class="lineno"> 6336</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l06337"></a><span class="lineno"> 6337</span>&#160;}</div><div class="line"><a name="l06338"></a><span class="lineno"> 6338</span>&#160;</div><div class="line"><a name="l06339"></a><span class="lineno"> 6339</span>&#160;<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::visitFMA(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N) {</div><div class="line"><a name="l06340"></a><span class="lineno"> 6340</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N0 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0);</div><div class="line"><a name="l06341"></a><span class="lineno"> 6341</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N1 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(1);</div><div class="line"><a name="l06342"></a><span class="lineno"> 6342</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N2 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(2);</div><div class="line"><a name="l06343"></a><span class="lineno"> 6343</span>&#160;  <a class="code" href="classllvm_1_1ConstantFPSDNode.html">ConstantFPSDNode</a> *N0CFP = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantFPSDNode.html">ConstantFPSDNode</a>&gt;(N0);</div><div class="line"><a name="l06344"></a><span class="lineno"> 6344</span>&#160;  <a class="code" href="classllvm_1_1ConstantFPSDNode.html">ConstantFPSDNode</a> *N1CFP = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantFPSDNode.html">ConstantFPSDNode</a>&gt;(N1);</div><div class="line"><a name="l06345"></a><span class="lineno"> 6345</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> VT = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(0);</div><div class="line"><a name="l06346"></a><span class="lineno"> 6346</span>&#160;  <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a> dl(N);</div><div class="line"><a name="l06347"></a><span class="lineno"> 6347</span>&#160;</div><div class="line"><a name="l06348"></a><span class="lineno"> 6348</span>&#160;  <span class="keywordflow">if</span> (DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a6b60694d1d9d7f634e7638856898e20d">getTarget</a>().<a class="code" href="classllvm_1_1TargetMachine.html#ab1fb67187fc37e569cc5171cbebba873">Options</a>.<a class="code" href="classllvm_1_1TargetOptions.html#a0544e2966374684ff74255e5a4290fa7">UnsafeFPMath</a>) {</div><div class="line"><a name="l06349"></a><span class="lineno"> 6349</span>&#160;    <span class="keywordflow">if</span> (N0CFP &amp;&amp; N0CFP-&gt;<a class="code" href="classllvm_1_1ConstantFPSDNode.html#a97d4ef979a8e5004f23bd340bcb222f0">isZero</a>())</div><div class="line"><a name="l06350"></a><span class="lineno"> 6350</span>&#160;      <span class="keywordflow">return</span> N2;</div><div class="line"><a name="l06351"></a><span class="lineno"> 6351</span>&#160;    <span class="keywordflow">if</span> (N1CFP &amp;&amp; N1CFP-&gt;isZero())</div><div class="line"><a name="l06352"></a><span class="lineno"> 6352</span>&#160;      <span class="keywordflow">return</span> N2;</div><div class="line"><a name="l06353"></a><span class="lineno"> 6353</span>&#160;  }</div><div class="line"><a name="l06354"></a><span class="lineno"> 6354</span>&#160;  <span class="keywordflow">if</span> (N0CFP &amp;&amp; N0CFP-&gt;<a class="code" href="classllvm_1_1ConstantFPSDNode.html#ae99f0c21a471750e1d75243898837001">isExactlyValue</a>(1.0))</div><div class="line"><a name="l06355"></a><span class="lineno"> 6355</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a32ec12017722f5b42a295fe5eb0b0bdf">ISD::FADD</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N1, N2);</div><div class="line"><a name="l06356"></a><span class="lineno"> 6356</span>&#160;  <span class="keywordflow">if</span> (N1CFP &amp;&amp; N1CFP-&gt;isExactlyValue(1.0))</div><div class="line"><a name="l06357"></a><span class="lineno"> 6357</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a32ec12017722f5b42a295fe5eb0b0bdf">ISD::FADD</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N0, N2);</div><div class="line"><a name="l06358"></a><span class="lineno"> 6358</span>&#160;</div><div class="line"><a name="l06359"></a><span class="lineno"> 6359</span>&#160;  <span class="comment">// Canonicalize (fma c, x, y) -&gt; (fma x, c, y)</span></div><div class="line"><a name="l06360"></a><span class="lineno"> 6360</span>&#160;  <span class="keywordflow">if</span> (N0CFP &amp;&amp; !N1CFP)</div><div class="line"><a name="l06361"></a><span class="lineno"> 6361</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a293ca68b3b2ce80eef991de822822254">ISD::FMA</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N1, N0, N2);</div><div class="line"><a name="l06362"></a><span class="lineno"> 6362</span>&#160;</div><div class="line"><a name="l06363"></a><span class="lineno"> 6363</span>&#160;  <span class="comment">// (fma x, c1, (fmul x, c2)) -&gt; (fmul x, c1+c2)</span></div><div class="line"><a name="l06364"></a><span class="lineno"> 6364</span>&#160;  <span class="keywordflow">if</span> (DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a6b60694d1d9d7f634e7638856898e20d">getTarget</a>().<a class="code" href="classllvm_1_1TargetMachine.html#ab1fb67187fc37e569cc5171cbebba873">Options</a>.<a class="code" href="classllvm_1_1TargetOptions.html#a0544e2966374684ff74255e5a4290fa7">UnsafeFPMath</a> &amp;&amp; N1CFP &amp;&amp;</div><div class="line"><a name="l06365"></a><span class="lineno"> 6365</span>&#160;      N2.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9ab5860c97a00c4627a08cab7b0c8178">ISD::FMUL</a> &amp;&amp;</div><div class="line"><a name="l06366"></a><span class="lineno"> 6366</span>&#160;      N0 == N2.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0) &amp;&amp;</div><div class="line"><a name="l06367"></a><span class="lineno"> 6367</span>&#160;      N2.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1).<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a1be4c8da7c68a4c683de1a98b5cc5b9d">ISD::ConstantFP</a>) {</div><div class="line"><a name="l06368"></a><span class="lineno"> 6368</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9ab5860c97a00c4627a08cab7b0c8178">ISD::FMUL</a>, dl, VT, N0,</div><div class="line"><a name="l06369"></a><span class="lineno"> 6369</span>&#160;                       DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a32ec12017722f5b42a295fe5eb0b0bdf">ISD::FADD</a>, dl, VT, N1, N2.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1)));</div><div class="line"><a name="l06370"></a><span class="lineno"> 6370</span>&#160;  }</div><div class="line"><a name="l06371"></a><span class="lineno"> 6371</span>&#160;</div><div class="line"><a name="l06372"></a><span class="lineno"> 6372</span>&#160;</div><div class="line"><a name="l06373"></a><span class="lineno"> 6373</span>&#160;  <span class="comment">// (fma (fmul x, c1), c2, y) -&gt; (fma x, c1*c2, y)</span></div><div class="line"><a name="l06374"></a><span class="lineno"> 6374</span>&#160;  <span class="keywordflow">if</span> (DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a6b60694d1d9d7f634e7638856898e20d">getTarget</a>().<a class="code" href="classllvm_1_1TargetMachine.html#ab1fb67187fc37e569cc5171cbebba873">Options</a>.<a class="code" href="classllvm_1_1TargetOptions.html#a0544e2966374684ff74255e5a4290fa7">UnsafeFPMath</a> &amp;&amp;</div><div class="line"><a name="l06375"></a><span class="lineno"> 6375</span>&#160;      N0.getOpcode() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9ab5860c97a00c4627a08cab7b0c8178">ISD::FMUL</a> &amp;&amp; N1CFP &amp;&amp;</div><div class="line"><a name="l06376"></a><span class="lineno"> 6376</span>&#160;      N0.getOperand(1).getOpcode() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a1be4c8da7c68a4c683de1a98b5cc5b9d">ISD::ConstantFP</a>) {</div><div class="line"><a name="l06377"></a><span class="lineno"> 6377</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a293ca68b3b2ce80eef991de822822254">ISD::FMA</a>, dl, VT,</div><div class="line"><a name="l06378"></a><span class="lineno"> 6378</span>&#160;                       N0.getOperand(0),</div><div class="line"><a name="l06379"></a><span class="lineno"> 6379</span>&#160;                       DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9ab5860c97a00c4627a08cab7b0c8178">ISD::FMUL</a>, dl, VT, N1, N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1)),</div><div class="line"><a name="l06380"></a><span class="lineno"> 6380</span>&#160;                       N2);</div><div class="line"><a name="l06381"></a><span class="lineno"> 6381</span>&#160;  }</div><div class="line"><a name="l06382"></a><span class="lineno"> 6382</span>&#160;</div><div class="line"><a name="l06383"></a><span class="lineno"> 6383</span>&#160;  <span class="comment">// (fma x, 1, y) -&gt; (fadd x, y)</span></div><div class="line"><a name="l06384"></a><span class="lineno"> 6384</span>&#160;  <span class="comment">// (fma x, -1, y) -&gt; (fadd (fneg x), y)</span></div><div class="line"><a name="l06385"></a><span class="lineno"> 6385</span>&#160;  <span class="keywordflow">if</span> (N1CFP) {</div><div class="line"><a name="l06386"></a><span class="lineno"> 6386</span>&#160;    <span class="keywordflow">if</span> (N1CFP-&gt;isExactlyValue(1.0))</div><div class="line"><a name="l06387"></a><span class="lineno"> 6387</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a32ec12017722f5b42a295fe5eb0b0bdf">ISD::FADD</a>, dl, VT, N0, N2);</div><div class="line"><a name="l06388"></a><span class="lineno"> 6388</span>&#160;</div><div class="line"><a name="l06389"></a><span class="lineno"> 6389</span>&#160;    <span class="keywordflow">if</span> (N1CFP-&gt;isExactlyValue(-1.0) &amp;&amp;</div><div class="line"><a name="l06390"></a><span class="lineno"> 6390</span>&#160;        (!LegalOperations || TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a055b3905dbbc16fae11510b9ebd1e00c">isOperationLegal</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a6d26c45c040d8f85d577a5f645261d1a">ISD::FNEG</a>, VT))) {</div><div class="line"><a name="l06391"></a><span class="lineno"> 6391</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> RHSNeg = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a6d26c45c040d8f85d577a5f645261d1a">ISD::FNEG</a>, dl, VT, N0);</div><div class="line"><a name="l06392"></a><span class="lineno"> 6392</span>&#160;      AddToWorkList(RHSNeg.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l06393"></a><span class="lineno"> 6393</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a32ec12017722f5b42a295fe5eb0b0bdf">ISD::FADD</a>, dl, VT, N2, RHSNeg);</div><div class="line"><a name="l06394"></a><span class="lineno"> 6394</span>&#160;    }</div><div class="line"><a name="l06395"></a><span class="lineno"> 6395</span>&#160;  }</div><div class="line"><a name="l06396"></a><span class="lineno"> 6396</span>&#160;</div><div class="line"><a name="l06397"></a><span class="lineno"> 6397</span>&#160;  <span class="comment">// (fma x, c, x) -&gt; (fmul x, (c+1))</span></div><div class="line"><a name="l06398"></a><span class="lineno"> 6398</span>&#160;  <span class="keywordflow">if</span> (DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a6b60694d1d9d7f634e7638856898e20d">getTarget</a>().<a class="code" href="classllvm_1_1TargetMachine.html#ab1fb67187fc37e569cc5171cbebba873">Options</a>.<a class="code" href="classllvm_1_1TargetOptions.html#a0544e2966374684ff74255e5a4290fa7">UnsafeFPMath</a> &amp;&amp; N1CFP &amp;&amp; N0 == N2)</div><div class="line"><a name="l06399"></a><span class="lineno"> 6399</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9ab5860c97a00c4627a08cab7b0c8178">ISD::FMUL</a>, dl, VT, N0,</div><div class="line"><a name="l06400"></a><span class="lineno"> 6400</span>&#160;                       DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a32ec12017722f5b42a295fe5eb0b0bdf">ISD::FADD</a>, dl, VT,</div><div class="line"><a name="l06401"></a><span class="lineno"> 6401</span>&#160;                                   N1, DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a268e5bc7dd40a28712a33ca6c9c91c6f">getConstantFP</a>(1.0, VT)));</div><div class="line"><a name="l06402"></a><span class="lineno"> 6402</span>&#160;</div><div class="line"><a name="l06403"></a><span class="lineno"> 6403</span>&#160;  <span class="comment">// (fma x, c, (fneg x)) -&gt; (fmul x, (c-1))</span></div><div class="line"><a name="l06404"></a><span class="lineno"> 6404</span>&#160;  <span class="keywordflow">if</span> (DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a6b60694d1d9d7f634e7638856898e20d">getTarget</a>().<a class="code" href="classllvm_1_1TargetMachine.html#ab1fb67187fc37e569cc5171cbebba873">Options</a>.<a class="code" href="classllvm_1_1TargetOptions.html#a0544e2966374684ff74255e5a4290fa7">UnsafeFPMath</a> &amp;&amp; N1CFP &amp;&amp;</div><div class="line"><a name="l06405"></a><span class="lineno"> 6405</span>&#160;      N2.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a6d26c45c040d8f85d577a5f645261d1a">ISD::FNEG</a> &amp;&amp; N2.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0) == N0)</div><div class="line"><a name="l06406"></a><span class="lineno"> 6406</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9ab5860c97a00c4627a08cab7b0c8178">ISD::FMUL</a>, dl, VT, N0,</div><div class="line"><a name="l06407"></a><span class="lineno"> 6407</span>&#160;                       DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a32ec12017722f5b42a295fe5eb0b0bdf">ISD::FADD</a>, dl, VT,</div><div class="line"><a name="l06408"></a><span class="lineno"> 6408</span>&#160;                                   N1, DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a268e5bc7dd40a28712a33ca6c9c91c6f">getConstantFP</a>(-1.0, VT)));</div><div class="line"><a name="l06409"></a><span class="lineno"> 6409</span>&#160;</div><div class="line"><a name="l06410"></a><span class="lineno"> 6410</span>&#160;</div><div class="line"><a name="l06411"></a><span class="lineno"> 6411</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l06412"></a><span class="lineno"> 6412</span>&#160;}</div><div class="line"><a name="l06413"></a><span class="lineno"> 6413</span>&#160;</div><div class="line"><a name="l06414"></a><span class="lineno"> 6414</span>&#160;<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::visitFDIV(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N) {</div><div class="line"><a name="l06415"></a><span class="lineno"> 6415</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N0 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0);</div><div class="line"><a name="l06416"></a><span class="lineno"> 6416</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N1 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(1);</div><div class="line"><a name="l06417"></a><span class="lineno"> 6417</span>&#160;  <a class="code" href="classllvm_1_1ConstantFPSDNode.html">ConstantFPSDNode</a> *N0CFP = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantFPSDNode.html">ConstantFPSDNode</a>&gt;(N0);</div><div class="line"><a name="l06418"></a><span class="lineno"> 6418</span>&#160;  <a class="code" href="classllvm_1_1ConstantFPSDNode.html">ConstantFPSDNode</a> *N1CFP = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantFPSDNode.html">ConstantFPSDNode</a>&gt;(N1);</div><div class="line"><a name="l06419"></a><span class="lineno"> 6419</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> VT = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(0);</div><div class="line"><a name="l06420"></a><span class="lineno"> 6420</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetLowering.html">TargetLowering</a> &amp;TLI = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a848b46af8fabd1ab34b28adbc3665609">getTargetLoweringInfo</a>();</div><div class="line"><a name="l06421"></a><span class="lineno"> 6421</span>&#160;</div><div class="line"><a name="l06422"></a><span class="lineno"> 6422</span>&#160;  <span class="comment">// fold vector ops</span></div><div class="line"><a name="l06423"></a><span class="lineno"> 6423</span>&#160;  <span class="keywordflow">if</span> (VT.isVector()) {</div><div class="line"><a name="l06424"></a><span class="lineno"> 6424</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> FoldedVOp = SimplifyVBinOp(N);</div><div class="line"><a name="l06425"></a><span class="lineno"> 6425</span>&#160;    <span class="keywordflow">if</span> (FoldedVOp.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()) <span class="keywordflow">return</span> FoldedVOp;</div><div class="line"><a name="l06426"></a><span class="lineno"> 6426</span>&#160;  }</div><div class="line"><a name="l06427"></a><span class="lineno"> 6427</span>&#160;</div><div class="line"><a name="l06428"></a><span class="lineno"> 6428</span>&#160;  <span class="comment">// fold (fdiv c1, c2) -&gt; c1/c2</span></div><div class="line"><a name="l06429"></a><span class="lineno"> 6429</span>&#160;  <span class="keywordflow">if</span> (N0CFP &amp;&amp; N1CFP)</div><div class="line"><a name="l06430"></a><span class="lineno"> 6430</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110abc6c09c7af98236460f0b020eb3be94e">ISD::FDIV</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N0, N1);</div><div class="line"><a name="l06431"></a><span class="lineno"> 6431</span>&#160;</div><div class="line"><a name="l06432"></a><span class="lineno"> 6432</span>&#160;  <span class="comment">// fold (fdiv X, c2) -&gt; fmul X, 1/c2 if losing precision is acceptable.</span></div><div class="line"><a name="l06433"></a><span class="lineno"> 6433</span>&#160;  <span class="keywordflow">if</span> (N1CFP &amp;&amp; DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a6b60694d1d9d7f634e7638856898e20d">getTarget</a>().<a class="code" href="classllvm_1_1TargetMachine.html#ab1fb67187fc37e569cc5171cbebba873">Options</a>.<a class="code" href="classllvm_1_1TargetOptions.html#a0544e2966374684ff74255e5a4290fa7">UnsafeFPMath</a>) {</div><div class="line"><a name="l06434"></a><span class="lineno"> 6434</span>&#160;    <span class="comment">// Compute the reciprocal 1.0 / c2.</span></div><div class="line"><a name="l06435"></a><span class="lineno"> 6435</span>&#160;    <a class="code" href="classllvm_1_1APFloat.html">APFloat</a> N1APF = N1CFP-&gt;getValueAPF();</div><div class="line"><a name="l06436"></a><span class="lineno"> 6436</span>&#160;    <a class="code" href="classllvm_1_1APFloat.html">APFloat</a> Recip(N1APF.<a class="code" href="classllvm_1_1APFloat.html#a4f9fe1ca06b44499c16742431c00cb34">getSemantics</a>(), 1); <span class="comment">// 1.0</span></div><div class="line"><a name="l06437"></a><span class="lineno"> 6437</span>&#160;    <a class="code" href="classllvm_1_1APFloat.html#a42fe920c8131569bb30114d7f294c8f8">APFloat::opStatus</a> st = Recip.<a class="code" href="classllvm_1_1APFloat.html#a7b22f406d0d5381bae105045caca60ea">divide</a>(N1APF, <a class="code" href="classllvm_1_1APFloat.html#a26f3c979ec46a5d2d9bccd300eb606fea3a561d1750cb3c30d5deb1193c8e1ec5">APFloat::rmNearestTiesToEven</a>);</div><div class="line"><a name="l06438"></a><span class="lineno"> 6438</span>&#160;    <span class="comment">// Only do the transform if the reciprocal is a legal fp immediate that</span></div><div class="line"><a name="l06439"></a><span class="lineno"> 6439</span>&#160;    <span class="comment">// isn&#39;t too nasty (eg NaN, denormal, ...).</span></div><div class="line"><a name="l06440"></a><span class="lineno"> 6440</span>&#160;    <span class="keywordflow">if</span> ((st == <a class="code" href="classllvm_1_1APFloat.html#a42fe920c8131569bb30114d7f294c8f8a527f71be1f3fdab1f3354020d5bec081">APFloat::opOK</a> || st == <a class="code" href="classllvm_1_1APFloat.html#a42fe920c8131569bb30114d7f294c8f8a9b6cce9cb9cdb5ceca4b5cf796eb7cd2">APFloat::opInexact</a>) &amp;&amp; <span class="comment">// Not too nasty</span></div><div class="line"><a name="l06441"></a><span class="lineno"> 6441</span>&#160;        (!LegalOperations ||</div><div class="line"><a name="l06442"></a><span class="lineno"> 6442</span>&#160;         <span class="comment">// FIXME: custom lowering of ConstantFP might fail (see e.g. ARM</span></div><div class="line"><a name="l06443"></a><span class="lineno"> 6443</span>&#160;         <span class="comment">// backend)... we should handle this gracefully after Legalize.</span></div><div class="line"><a name="l06444"></a><span class="lineno"> 6444</span>&#160;         <span class="comment">// TLI.isOperationLegalOrCustom(llvm::ISD::ConstantFP, VT) ||</span></div><div class="line"><a name="l06445"></a><span class="lineno"> 6445</span>&#160;         TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a055b3905dbbc16fae11510b9ebd1e00c">isOperationLegal</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a1be4c8da7c68a4c683de1a98b5cc5b9d">llvm::ISD::ConstantFP</a>, VT) ||</div><div class="line"><a name="l06446"></a><span class="lineno"> 6446</span>&#160;         TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a36072d8d2e3e7ffbb69fbdad448fcad3">isFPImmLegal</a>(Recip, VT)))</div><div class="line"><a name="l06447"></a><span class="lineno"> 6447</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9ab5860c97a00c4627a08cab7b0c8178">ISD::FMUL</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N0,</div><div class="line"><a name="l06448"></a><span class="lineno"> 6448</span>&#160;                         DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a268e5bc7dd40a28712a33ca6c9c91c6f">getConstantFP</a>(Recip, VT));</div><div class="line"><a name="l06449"></a><span class="lineno"> 6449</span>&#160;  }</div><div class="line"><a name="l06450"></a><span class="lineno"> 6450</span>&#160;</div><div class="line"><a name="l06451"></a><span class="lineno"> 6451</span>&#160;  <span class="comment">// (fdiv (fneg X), (fneg Y)) -&gt; (fdiv X, Y)</span></div><div class="line"><a name="l06452"></a><span class="lineno"> 6452</span>&#160;  <span class="keywordflow">if</span> (<span class="keywordtype">char</span> LHSNeg = <a class="code" href="DAGCombiner_8cpp.html#aec1e6891acbf695c615301db72893862">isNegatibleForFree</a>(N0, LegalOperations, TLI,</div><div class="line"><a name="l06453"></a><span class="lineno"> 6453</span>&#160;                                       &amp;DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a6b60694d1d9d7f634e7638856898e20d">getTarget</a>().<a class="code" href="classllvm_1_1TargetMachine.html#ab1fb67187fc37e569cc5171cbebba873">Options</a>)) {</div><div class="line"><a name="l06454"></a><span class="lineno"> 6454</span>&#160;    <span class="keywordflow">if</span> (<span class="keywordtype">char</span> RHSNeg = <a class="code" href="DAGCombiner_8cpp.html#aec1e6891acbf695c615301db72893862">isNegatibleForFree</a>(N1, LegalOperations, TLI,</div><div class="line"><a name="l06455"></a><span class="lineno"> 6455</span>&#160;                                         &amp;DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a6b60694d1d9d7f634e7638856898e20d">getTarget</a>().<a class="code" href="classllvm_1_1TargetMachine.html#ab1fb67187fc37e569cc5171cbebba873">Options</a>)) {</div><div class="line"><a name="l06456"></a><span class="lineno"> 6456</span>&#160;      <span class="comment">// Both can be negated for free, check to see if at least one is cheaper</span></div><div class="line"><a name="l06457"></a><span class="lineno"> 6457</span>&#160;      <span class="comment">// negated.</span></div><div class="line"><a name="l06458"></a><span class="lineno"> 6458</span>&#160;      <span class="keywordflow">if</span> (LHSNeg == 2 || RHSNeg == 2)</div><div class="line"><a name="l06459"></a><span class="lineno"> 6459</span>&#160;        <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110abc6c09c7af98236460f0b020eb3be94e">ISD::FDIV</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT,</div><div class="line"><a name="l06460"></a><span class="lineno"> 6460</span>&#160;                           <a class="code" href="DAGCombiner_8cpp.html#a55d3de0deed33d70188b2b5a9cab8f00">GetNegatedExpression</a>(N0, DAG, LegalOperations),</div><div class="line"><a name="l06461"></a><span class="lineno"> 6461</span>&#160;                           <a class="code" href="DAGCombiner_8cpp.html#a55d3de0deed33d70188b2b5a9cab8f00">GetNegatedExpression</a>(N1, DAG, LegalOperations));</div><div class="line"><a name="l06462"></a><span class="lineno"> 6462</span>&#160;    }</div><div class="line"><a name="l06463"></a><span class="lineno"> 6463</span>&#160;  }</div><div class="line"><a name="l06464"></a><span class="lineno"> 6464</span>&#160;</div><div class="line"><a name="l06465"></a><span class="lineno"> 6465</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l06466"></a><span class="lineno"> 6466</span>&#160;}</div><div class="line"><a name="l06467"></a><span class="lineno"> 6467</span>&#160;</div><div class="line"><a name="l06468"></a><span class="lineno"> 6468</span>&#160;<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::visitFREM(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N) {</div><div class="line"><a name="l06469"></a><span class="lineno"> 6469</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N0 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0);</div><div class="line"><a name="l06470"></a><span class="lineno"> 6470</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N1 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(1);</div><div class="line"><a name="l06471"></a><span class="lineno"> 6471</span>&#160;  <a class="code" href="classllvm_1_1ConstantFPSDNode.html">ConstantFPSDNode</a> *N0CFP = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantFPSDNode.html">ConstantFPSDNode</a>&gt;(N0);</div><div class="line"><a name="l06472"></a><span class="lineno"> 6472</span>&#160;  <a class="code" href="classllvm_1_1ConstantFPSDNode.html">ConstantFPSDNode</a> *N1CFP = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantFPSDNode.html">ConstantFPSDNode</a>&gt;(N1);</div><div class="line"><a name="l06473"></a><span class="lineno"> 6473</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> VT = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(0);</div><div class="line"><a name="l06474"></a><span class="lineno"> 6474</span>&#160;</div><div class="line"><a name="l06475"></a><span class="lineno"> 6475</span>&#160;  <span class="comment">// fold (frem c1, c2) -&gt; fmod(c1,c2)</span></div><div class="line"><a name="l06476"></a><span class="lineno"> 6476</span>&#160;  <span class="keywordflow">if</span> (N0CFP &amp;&amp; N1CFP)</div><div class="line"><a name="l06477"></a><span class="lineno"> 6477</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110abdd7bbb76dac7962dda6e116e33699da">ISD::FREM</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N0, N1);</div><div class="line"><a name="l06478"></a><span class="lineno"> 6478</span>&#160;</div><div class="line"><a name="l06479"></a><span class="lineno"> 6479</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l06480"></a><span class="lineno"> 6480</span>&#160;}</div><div class="line"><a name="l06481"></a><span class="lineno"> 6481</span>&#160;</div><div class="line"><a name="l06482"></a><span class="lineno"> 6482</span>&#160;<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::visitFCOPYSIGN(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N) {</div><div class="line"><a name="l06483"></a><span class="lineno"> 6483</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N0 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0);</div><div class="line"><a name="l06484"></a><span class="lineno"> 6484</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N1 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(1);</div><div class="line"><a name="l06485"></a><span class="lineno"> 6485</span>&#160;  <a class="code" href="classllvm_1_1ConstantFPSDNode.html">ConstantFPSDNode</a> *N0CFP = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantFPSDNode.html">ConstantFPSDNode</a>&gt;(N0);</div><div class="line"><a name="l06486"></a><span class="lineno"> 6486</span>&#160;  <a class="code" href="classllvm_1_1ConstantFPSDNode.html">ConstantFPSDNode</a> *N1CFP = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantFPSDNode.html">ConstantFPSDNode</a>&gt;(N1);</div><div class="line"><a name="l06487"></a><span class="lineno"> 6487</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> VT = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(0);</div><div class="line"><a name="l06488"></a><span class="lineno"> 6488</span>&#160;</div><div class="line"><a name="l06489"></a><span class="lineno"> 6489</span>&#160;  <span class="keywordflow">if</span> (N0CFP &amp;&amp; N1CFP)  <span class="comment">// Constant fold</span></div><div class="line"><a name="l06490"></a><span class="lineno"> 6490</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110aeffc3319657e213a530ce583603f7221">ISD::FCOPYSIGN</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N0, N1);</div><div class="line"><a name="l06491"></a><span class="lineno"> 6491</span>&#160;</div><div class="line"><a name="l06492"></a><span class="lineno"> 6492</span>&#160;  <span class="keywordflow">if</span> (N1CFP) {</div><div class="line"><a name="l06493"></a><span class="lineno"> 6493</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1APFloat.html">APFloat</a>&amp; V = N1CFP-&gt;getValueAPF();</div><div class="line"><a name="l06494"></a><span class="lineno"> 6494</span>&#160;    <span class="comment">// copysign(x, c1) -&gt; fabs(x)       iff ispos(c1)</span></div><div class="line"><a name="l06495"></a><span class="lineno"> 6495</span>&#160;    <span class="comment">// copysign(x, c1) -&gt; fneg(fabs(x)) iff isneg(c1)</span></div><div class="line"><a name="l06496"></a><span class="lineno"> 6496</span>&#160;    <span class="keywordflow">if</span> (!V.<a class="code" href="classllvm_1_1APFloat.html#aec02d46854c76f20a6da7002e390f612">isNegative</a>()) {</div><div class="line"><a name="l06497"></a><span class="lineno"> 6497</span>&#160;      <span class="keywordflow">if</span> (!LegalOperations || TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a055b3905dbbc16fae11510b9ebd1e00c">isOperationLegal</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a2b4d07600495a563319d6a3dda8dc44d">ISD::FABS</a>, VT))</div><div class="line"><a name="l06498"></a><span class="lineno"> 6498</span>&#160;        <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a2b4d07600495a563319d6a3dda8dc44d">ISD::FABS</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N0);</div><div class="line"><a name="l06499"></a><span class="lineno"> 6499</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l06500"></a><span class="lineno"> 6500</span>&#160;      <span class="keywordflow">if</span> (!LegalOperations || TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a055b3905dbbc16fae11510b9ebd1e00c">isOperationLegal</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a6d26c45c040d8f85d577a5f645261d1a">ISD::FNEG</a>, VT))</div><div class="line"><a name="l06501"></a><span class="lineno"> 6501</span>&#160;        <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a6d26c45c040d8f85d577a5f645261d1a">ISD::FNEG</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT,</div><div class="line"><a name="l06502"></a><span class="lineno"> 6502</span>&#160;                           DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a2b4d07600495a563319d6a3dda8dc44d">ISD::FABS</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N0), VT, N0));</div><div class="line"><a name="l06503"></a><span class="lineno"> 6503</span>&#160;    }</div><div class="line"><a name="l06504"></a><span class="lineno"> 6504</span>&#160;  }</div><div class="line"><a name="l06505"></a><span class="lineno"> 6505</span>&#160;</div><div class="line"><a name="l06506"></a><span class="lineno"> 6506</span>&#160;  <span class="comment">// copysign(fabs(x), y) -&gt; copysign(x, y)</span></div><div class="line"><a name="l06507"></a><span class="lineno"> 6507</span>&#160;  <span class="comment">// copysign(fneg(x), y) -&gt; copysign(x, y)</span></div><div class="line"><a name="l06508"></a><span class="lineno"> 6508</span>&#160;  <span class="comment">// copysign(copysign(x,z), y) -&gt; copysign(x, y)</span></div><div class="line"><a name="l06509"></a><span class="lineno"> 6509</span>&#160;  <span class="keywordflow">if</span> (N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a2b4d07600495a563319d6a3dda8dc44d">ISD::FABS</a> || N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a6d26c45c040d8f85d577a5f645261d1a">ISD::FNEG</a> ||</div><div class="line"><a name="l06510"></a><span class="lineno"> 6510</span>&#160;      N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110aeffc3319657e213a530ce583603f7221">ISD::FCOPYSIGN</a>)</div><div class="line"><a name="l06511"></a><span class="lineno"> 6511</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110aeffc3319657e213a530ce583603f7221">ISD::FCOPYSIGN</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT,</div><div class="line"><a name="l06512"></a><span class="lineno"> 6512</span>&#160;                       N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0), N1);</div><div class="line"><a name="l06513"></a><span class="lineno"> 6513</span>&#160;</div><div class="line"><a name="l06514"></a><span class="lineno"> 6514</span>&#160;  <span class="comment">// copysign(x, abs(y)) -&gt; abs(x)</span></div><div class="line"><a name="l06515"></a><span class="lineno"> 6515</span>&#160;  <span class="keywordflow">if</span> (N1.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a2b4d07600495a563319d6a3dda8dc44d">ISD::FABS</a>)</div><div class="line"><a name="l06516"></a><span class="lineno"> 6516</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a2b4d07600495a563319d6a3dda8dc44d">ISD::FABS</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N0);</div><div class="line"><a name="l06517"></a><span class="lineno"> 6517</span>&#160;</div><div class="line"><a name="l06518"></a><span class="lineno"> 6518</span>&#160;  <span class="comment">// copysign(x, copysign(y,z)) -&gt; copysign(x, z)</span></div><div class="line"><a name="l06519"></a><span class="lineno"> 6519</span>&#160;  <span class="keywordflow">if</span> (N1.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110aeffc3319657e213a530ce583603f7221">ISD::FCOPYSIGN</a>)</div><div class="line"><a name="l06520"></a><span class="lineno"> 6520</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110aeffc3319657e213a530ce583603f7221">ISD::FCOPYSIGN</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT,</div><div class="line"><a name="l06521"></a><span class="lineno"> 6521</span>&#160;                       N0, N1.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1));</div><div class="line"><a name="l06522"></a><span class="lineno"> 6522</span>&#160;</div><div class="line"><a name="l06523"></a><span class="lineno"> 6523</span>&#160;  <span class="comment">// copysign(x, fp_extend(y)) -&gt; copysign(x, y)</span></div><div class="line"><a name="l06524"></a><span class="lineno"> 6524</span>&#160;  <span class="comment">// copysign(x, fp_round(y)) -&gt; copysign(x, y)</span></div><div class="line"><a name="l06525"></a><span class="lineno"> 6525</span>&#160;  <span class="keywordflow">if</span> (N1.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110aadfdefcb133a7f0262a05934aba8ce5d">ISD::FP_EXTEND</a> || N1.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110adaf9a3cb5c2ef5eb713bd6bf4ae23aeb">ISD::FP_ROUND</a>)</div><div class="line"><a name="l06526"></a><span class="lineno"> 6526</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110aeffc3319657e213a530ce583603f7221">ISD::FCOPYSIGN</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT,</div><div class="line"><a name="l06527"></a><span class="lineno"> 6527</span>&#160;                       N0, N1.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0));</div><div class="line"><a name="l06528"></a><span class="lineno"> 6528</span>&#160;</div><div class="line"><a name="l06529"></a><span class="lineno"> 6529</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l06530"></a><span class="lineno"> 6530</span>&#160;}</div><div class="line"><a name="l06531"></a><span class="lineno"> 6531</span>&#160;</div><div class="line"><a name="l06532"></a><span class="lineno"> 6532</span>&#160;<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::visitSINT_TO_FP(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N) {</div><div class="line"><a name="l06533"></a><span class="lineno"> 6533</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N0 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0);</div><div class="line"><a name="l06534"></a><span class="lineno"> 6534</span>&#160;  <a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a> *N0C = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a>&gt;(N0);</div><div class="line"><a name="l06535"></a><span class="lineno"> 6535</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> VT = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(0);</div><div class="line"><a name="l06536"></a><span class="lineno"> 6536</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> OpVT = N0.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>();</div><div class="line"><a name="l06537"></a><span class="lineno"> 6537</span>&#160;</div><div class="line"><a name="l06538"></a><span class="lineno"> 6538</span>&#160;  <span class="comment">// fold (sint_to_fp c1) -&gt; c1fp</span></div><div class="line"><a name="l06539"></a><span class="lineno"> 6539</span>&#160;  <span class="keywordflow">if</span> (N0C &amp;&amp;</div><div class="line"><a name="l06540"></a><span class="lineno"> 6540</span>&#160;      <span class="comment">// ...but only if the target supports immediate floating-point values</span></div><div class="line"><a name="l06541"></a><span class="lineno"> 6541</span>&#160;      (!LegalOperations ||</div><div class="line"><a name="l06542"></a><span class="lineno"> 6542</span>&#160;       TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a087dd0f9650e999b087c17cc7f46f2d0">isOperationLegalOrCustom</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a1be4c8da7c68a4c683de1a98b5cc5b9d">llvm::ISD::ConstantFP</a>, VT)))</div><div class="line"><a name="l06543"></a><span class="lineno"> 6543</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a315004656a75a3c3a9d7294f105a8da2">ISD::SINT_TO_FP</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N0);</div><div class="line"><a name="l06544"></a><span class="lineno"> 6544</span>&#160;</div><div class="line"><a name="l06545"></a><span class="lineno"> 6545</span>&#160;  <span class="comment">// If the input is a legal type, and SINT_TO_FP is not legal on this target,</span></div><div class="line"><a name="l06546"></a><span class="lineno"> 6546</span>&#160;  <span class="comment">// but UINT_TO_FP is legal on this target, try to convert.</span></div><div class="line"><a name="l06547"></a><span class="lineno"> 6547</span>&#160;  <span class="keywordflow">if</span> (!TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a087dd0f9650e999b087c17cc7f46f2d0">isOperationLegalOrCustom</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a315004656a75a3c3a9d7294f105a8da2">ISD::SINT_TO_FP</a>, OpVT) &amp;&amp;</div><div class="line"><a name="l06548"></a><span class="lineno"> 6548</span>&#160;      TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a087dd0f9650e999b087c17cc7f46f2d0">isOperationLegalOrCustom</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a169032eecd015d4eeb869c457202a6c8">ISD::UINT_TO_FP</a>, OpVT)) {</div><div class="line"><a name="l06549"></a><span class="lineno"> 6549</span>&#160;    <span class="comment">// If the sign bit is known to be zero, we can change this to UINT_TO_FP.</span></div><div class="line"><a name="l06550"></a><span class="lineno"> 6550</span>&#160;    <span class="keywordflow">if</span> (DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af52a1ca20308888443767831a21352ca">SignBitIsZero</a>(N0))</div><div class="line"><a name="l06551"></a><span class="lineno"> 6551</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a169032eecd015d4eeb869c457202a6c8">ISD::UINT_TO_FP</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N0);</div><div class="line"><a name="l06552"></a><span class="lineno"> 6552</span>&#160;  }</div><div class="line"><a name="l06553"></a><span class="lineno"> 6553</span>&#160;</div><div class="line"><a name="l06554"></a><span class="lineno"> 6554</span>&#160;  <span class="comment">// The next optimizations are desireable only if SELECT_CC can be lowered.</span></div><div class="line"><a name="l06555"></a><span class="lineno"> 6555</span>&#160;  <span class="comment">// Check against MVT::Other for SELECT_CC, which is a workaround for targets</span></div><div class="line"><a name="l06556"></a><span class="lineno"> 6556</span>&#160;  <span class="comment">// having to say they don&#39;t support SELECT_CC on every type the DAG knows</span></div><div class="line"><a name="l06557"></a><span class="lineno"> 6557</span>&#160;  <span class="comment">// about, since there is no way to mark an opcode illegal at all value types</span></div><div class="line"><a name="l06558"></a><span class="lineno"> 6558</span>&#160;  <span class="comment">// (See also visitSELECT)</span></div><div class="line"><a name="l06559"></a><span class="lineno"> 6559</span>&#160;  <span class="keywordflow">if</span> (TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a087dd0f9650e999b087c17cc7f46f2d0">isOperationLegalOrCustom</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a99ad6b342b7457df56b91d24e66016b3">ISD::SELECT_CC</a>, <a class="code" href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50ca62a222acce6360abd2726719fabc2797">MVT::Other</a>)) {</div><div class="line"><a name="l06560"></a><span class="lineno"> 6560</span>&#160;    <span class="comment">// fold (sint_to_fp (setcc x, y, cc)) -&gt; (select_cc x, y, -1.0, 0.0,, cc)</span></div><div class="line"><a name="l06561"></a><span class="lineno"> 6561</span>&#160;    <span class="keywordflow">if</span> (N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a0158ee47dfa868be5d28e2cbef70d5d0">ISD::SETCC</a> &amp;&amp; N0.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>() == <a class="code" href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50ca85440bbdbba12de574c02e515444d3f4">MVT::i1</a> &amp;&amp;</div><div class="line"><a name="l06562"></a><span class="lineno"> 6562</span>&#160;        !VT.isVector() &amp;&amp;</div><div class="line"><a name="l06563"></a><span class="lineno"> 6563</span>&#160;        (!LegalOperations ||</div><div class="line"><a name="l06564"></a><span class="lineno"> 6564</span>&#160;         TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a087dd0f9650e999b087c17cc7f46f2d0">isOperationLegalOrCustom</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a1be4c8da7c68a4c683de1a98b5cc5b9d">llvm::ISD::ConstantFP</a>, VT))) {</div><div class="line"><a name="l06565"></a><span class="lineno"> 6565</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Ops[] =</div><div class="line"><a name="l06566"></a><span class="lineno"> 6566</span>&#160;        { N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0), N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1),</div><div class="line"><a name="l06567"></a><span class="lineno"> 6567</span>&#160;          DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a268e5bc7dd40a28712a33ca6c9c91c6f">getConstantFP</a>(-1.0, VT) , DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a268e5bc7dd40a28712a33ca6c9c91c6f">getConstantFP</a>(0.0, VT),</div><div class="line"><a name="l06568"></a><span class="lineno"> 6568</span>&#160;          N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(2) };</div><div class="line"><a name="l06569"></a><span class="lineno"> 6569</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a99ad6b342b7457df56b91d24e66016b3">ISD::SELECT_CC</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, Ops, 5);</div><div class="line"><a name="l06570"></a><span class="lineno"> 6570</span>&#160;    }</div><div class="line"><a name="l06571"></a><span class="lineno"> 6571</span>&#160;</div><div class="line"><a name="l06572"></a><span class="lineno"> 6572</span>&#160;    <span class="comment">// fold (sint_to_fp (zext (setcc x, y, cc))) -&gt;</span></div><div class="line"><a name="l06573"></a><span class="lineno"> 6573</span>&#160;    <span class="comment">//      (select_cc x, y, 1.0, 0.0,, cc)</span></div><div class="line"><a name="l06574"></a><span class="lineno"> 6574</span>&#160;    <span class="keywordflow">if</span> (N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a93fdf85eff945f1a668b4915a051453e">ISD::ZERO_EXTEND</a> &amp;&amp;</div><div class="line"><a name="l06575"></a><span class="lineno"> 6575</span>&#160;        N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a0158ee47dfa868be5d28e2cbef70d5d0">ISD::SETCC</a> &amp;&amp;!VT.isVector() &amp;&amp;</div><div class="line"><a name="l06576"></a><span class="lineno"> 6576</span>&#160;        (!LegalOperations ||</div><div class="line"><a name="l06577"></a><span class="lineno"> 6577</span>&#160;         TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a087dd0f9650e999b087c17cc7f46f2d0">isOperationLegalOrCustom</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a1be4c8da7c68a4c683de1a98b5cc5b9d">llvm::ISD::ConstantFP</a>, VT))) {</div><div class="line"><a name="l06578"></a><span class="lineno"> 6578</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Ops[] =</div><div class="line"><a name="l06579"></a><span class="lineno"> 6579</span>&#160;        { N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0), N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1),</div><div class="line"><a name="l06580"></a><span class="lineno"> 6580</span>&#160;          DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a268e5bc7dd40a28712a33ca6c9c91c6f">getConstantFP</a>(1.0, VT) , DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a268e5bc7dd40a28712a33ca6c9c91c6f">getConstantFP</a>(0.0, VT),</div><div class="line"><a name="l06581"></a><span class="lineno"> 6581</span>&#160;          N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(2) };</div><div class="line"><a name="l06582"></a><span class="lineno"> 6582</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a99ad6b342b7457df56b91d24e66016b3">ISD::SELECT_CC</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, Ops, 5);</div><div class="line"><a name="l06583"></a><span class="lineno"> 6583</span>&#160;    }</div><div class="line"><a name="l06584"></a><span class="lineno"> 6584</span>&#160;  }</div><div class="line"><a name="l06585"></a><span class="lineno"> 6585</span>&#160;</div><div class="line"><a name="l06586"></a><span class="lineno"> 6586</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l06587"></a><span class="lineno"> 6587</span>&#160;}</div><div class="line"><a name="l06588"></a><span class="lineno"> 6588</span>&#160;</div><div class="line"><a name="l06589"></a><span class="lineno"> 6589</span>&#160;<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::visitUINT_TO_FP(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N) {</div><div class="line"><a name="l06590"></a><span class="lineno"> 6590</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N0 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0);</div><div class="line"><a name="l06591"></a><span class="lineno"> 6591</span>&#160;  <a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a> *N0C = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a>&gt;(N0);</div><div class="line"><a name="l06592"></a><span class="lineno"> 6592</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> VT = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(0);</div><div class="line"><a name="l06593"></a><span class="lineno"> 6593</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> OpVT = N0.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>();</div><div class="line"><a name="l06594"></a><span class="lineno"> 6594</span>&#160;</div><div class="line"><a name="l06595"></a><span class="lineno"> 6595</span>&#160;  <span class="comment">// fold (uint_to_fp c1) -&gt; c1fp</span></div><div class="line"><a name="l06596"></a><span class="lineno"> 6596</span>&#160;  <span class="keywordflow">if</span> (N0C &amp;&amp;</div><div class="line"><a name="l06597"></a><span class="lineno"> 6597</span>&#160;      <span class="comment">// ...but only if the target supports immediate floating-point values</span></div><div class="line"><a name="l06598"></a><span class="lineno"> 6598</span>&#160;      (!LegalOperations ||</div><div class="line"><a name="l06599"></a><span class="lineno"> 6599</span>&#160;       TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a087dd0f9650e999b087c17cc7f46f2d0">isOperationLegalOrCustom</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a1be4c8da7c68a4c683de1a98b5cc5b9d">llvm::ISD::ConstantFP</a>, VT)))</div><div class="line"><a name="l06600"></a><span class="lineno"> 6600</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a169032eecd015d4eeb869c457202a6c8">ISD::UINT_TO_FP</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N0);</div><div class="line"><a name="l06601"></a><span class="lineno"> 6601</span>&#160;</div><div class="line"><a name="l06602"></a><span class="lineno"> 6602</span>&#160;  <span class="comment">// If the input is a legal type, and UINT_TO_FP is not legal on this target,</span></div><div class="line"><a name="l06603"></a><span class="lineno"> 6603</span>&#160;  <span class="comment">// but SINT_TO_FP is legal on this target, try to convert.</span></div><div class="line"><a name="l06604"></a><span class="lineno"> 6604</span>&#160;  <span class="keywordflow">if</span> (!TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a087dd0f9650e999b087c17cc7f46f2d0">isOperationLegalOrCustom</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a169032eecd015d4eeb869c457202a6c8">ISD::UINT_TO_FP</a>, OpVT) &amp;&amp;</div><div class="line"><a name="l06605"></a><span class="lineno"> 6605</span>&#160;      TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a087dd0f9650e999b087c17cc7f46f2d0">isOperationLegalOrCustom</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a315004656a75a3c3a9d7294f105a8da2">ISD::SINT_TO_FP</a>, OpVT)) {</div><div class="line"><a name="l06606"></a><span class="lineno"> 6606</span>&#160;    <span class="comment">// If the sign bit is known to be zero, we can change this to SINT_TO_FP.</span></div><div class="line"><a name="l06607"></a><span class="lineno"> 6607</span>&#160;    <span class="keywordflow">if</span> (DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af52a1ca20308888443767831a21352ca">SignBitIsZero</a>(N0))</div><div class="line"><a name="l06608"></a><span class="lineno"> 6608</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a315004656a75a3c3a9d7294f105a8da2">ISD::SINT_TO_FP</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N0);</div><div class="line"><a name="l06609"></a><span class="lineno"> 6609</span>&#160;  }</div><div class="line"><a name="l06610"></a><span class="lineno"> 6610</span>&#160;</div><div class="line"><a name="l06611"></a><span class="lineno"> 6611</span>&#160;  <span class="comment">// The next optimizations are desireable only if SELECT_CC can be lowered.</span></div><div class="line"><a name="l06612"></a><span class="lineno"> 6612</span>&#160;  <span class="comment">// Check against MVT::Other for SELECT_CC, which is a workaround for targets</span></div><div class="line"><a name="l06613"></a><span class="lineno"> 6613</span>&#160;  <span class="comment">// having to say they don&#39;t support SELECT_CC on every type the DAG knows</span></div><div class="line"><a name="l06614"></a><span class="lineno"> 6614</span>&#160;  <span class="comment">// about, since there is no way to mark an opcode illegal at all value types</span></div><div class="line"><a name="l06615"></a><span class="lineno"> 6615</span>&#160;  <span class="comment">// (See also visitSELECT)</span></div><div class="line"><a name="l06616"></a><span class="lineno"> 6616</span>&#160;  <span class="keywordflow">if</span> (TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a087dd0f9650e999b087c17cc7f46f2d0">isOperationLegalOrCustom</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a99ad6b342b7457df56b91d24e66016b3">ISD::SELECT_CC</a>, <a class="code" href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50ca62a222acce6360abd2726719fabc2797">MVT::Other</a>)) {</div><div class="line"><a name="l06617"></a><span class="lineno"> 6617</span>&#160;    <span class="comment">// fold (uint_to_fp (setcc x, y, cc)) -&gt; (select_cc x, y, -1.0, 0.0,, cc)</span></div><div class="line"><a name="l06618"></a><span class="lineno"> 6618</span>&#160;</div><div class="line"><a name="l06619"></a><span class="lineno"> 6619</span>&#160;    <span class="keywordflow">if</span> (N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a0158ee47dfa868be5d28e2cbef70d5d0">ISD::SETCC</a> &amp;&amp; !VT.isVector() &amp;&amp;</div><div class="line"><a name="l06620"></a><span class="lineno"> 6620</span>&#160;        (!LegalOperations ||</div><div class="line"><a name="l06621"></a><span class="lineno"> 6621</span>&#160;         TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a087dd0f9650e999b087c17cc7f46f2d0">isOperationLegalOrCustom</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a1be4c8da7c68a4c683de1a98b5cc5b9d">llvm::ISD::ConstantFP</a>, VT))) {</div><div class="line"><a name="l06622"></a><span class="lineno"> 6622</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Ops[] =</div><div class="line"><a name="l06623"></a><span class="lineno"> 6623</span>&#160;        { N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0), N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1),</div><div class="line"><a name="l06624"></a><span class="lineno"> 6624</span>&#160;          DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a268e5bc7dd40a28712a33ca6c9c91c6f">getConstantFP</a>(1.0, VT),  DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a268e5bc7dd40a28712a33ca6c9c91c6f">getConstantFP</a>(0.0, VT),</div><div class="line"><a name="l06625"></a><span class="lineno"> 6625</span>&#160;          N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(2) };</div><div class="line"><a name="l06626"></a><span class="lineno"> 6626</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a99ad6b342b7457df56b91d24e66016b3">ISD::SELECT_CC</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, Ops, 5);</div><div class="line"><a name="l06627"></a><span class="lineno"> 6627</span>&#160;    }</div><div class="line"><a name="l06628"></a><span class="lineno"> 6628</span>&#160;  }</div><div class="line"><a name="l06629"></a><span class="lineno"> 6629</span>&#160;</div><div class="line"><a name="l06630"></a><span class="lineno"> 6630</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l06631"></a><span class="lineno"> 6631</span>&#160;}</div><div class="line"><a name="l06632"></a><span class="lineno"> 6632</span>&#160;</div><div class="line"><a name="l06633"></a><span class="lineno"> 6633</span>&#160;<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::visitFP_TO_SINT(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N) {</div><div class="line"><a name="l06634"></a><span class="lineno"> 6634</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N0 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0);</div><div class="line"><a name="l06635"></a><span class="lineno"> 6635</span>&#160;  <a class="code" href="classllvm_1_1ConstantFPSDNode.html">ConstantFPSDNode</a> *N0CFP = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantFPSDNode.html">ConstantFPSDNode</a>&gt;(N0);</div><div class="line"><a name="l06636"></a><span class="lineno"> 6636</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> VT = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(0);</div><div class="line"><a name="l06637"></a><span class="lineno"> 6637</span>&#160;</div><div class="line"><a name="l06638"></a><span class="lineno"> 6638</span>&#160;  <span class="comment">// fold (fp_to_sint c1fp) -&gt; c1</span></div><div class="line"><a name="l06639"></a><span class="lineno"> 6639</span>&#160;  <span class="keywordflow">if</span> (N0CFP)</div><div class="line"><a name="l06640"></a><span class="lineno"> 6640</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ac3f8f8d8437c64b2e2e9f978e2707210">ISD::FP_TO_SINT</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N0);</div><div class="line"><a name="l06641"></a><span class="lineno"> 6641</span>&#160;</div><div class="line"><a name="l06642"></a><span class="lineno"> 6642</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l06643"></a><span class="lineno"> 6643</span>&#160;}</div><div class="line"><a name="l06644"></a><span class="lineno"> 6644</span>&#160;</div><div class="line"><a name="l06645"></a><span class="lineno"> 6645</span>&#160;<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::visitFP_TO_UINT(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N) {</div><div class="line"><a name="l06646"></a><span class="lineno"> 6646</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N0 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0);</div><div class="line"><a name="l06647"></a><span class="lineno"> 6647</span>&#160;  <a class="code" href="classllvm_1_1ConstantFPSDNode.html">ConstantFPSDNode</a> *N0CFP = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantFPSDNode.html">ConstantFPSDNode</a>&gt;(N0);</div><div class="line"><a name="l06648"></a><span class="lineno"> 6648</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> VT = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(0);</div><div class="line"><a name="l06649"></a><span class="lineno"> 6649</span>&#160;</div><div class="line"><a name="l06650"></a><span class="lineno"> 6650</span>&#160;  <span class="comment">// fold (fp_to_uint c1fp) -&gt; c1</span></div><div class="line"><a name="l06651"></a><span class="lineno"> 6651</span>&#160;  <span class="keywordflow">if</span> (N0CFP)</div><div class="line"><a name="l06652"></a><span class="lineno"> 6652</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a71640703ec096a8b07111e85cfff6987">ISD::FP_TO_UINT</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N0);</div><div class="line"><a name="l06653"></a><span class="lineno"> 6653</span>&#160;</div><div class="line"><a name="l06654"></a><span class="lineno"> 6654</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l06655"></a><span class="lineno"> 6655</span>&#160;}</div><div class="line"><a name="l06656"></a><span class="lineno"> 6656</span>&#160;</div><div class="line"><a name="l06657"></a><span class="lineno"> 6657</span>&#160;<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::visitFP_ROUND(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N) {</div><div class="line"><a name="l06658"></a><span class="lineno"> 6658</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N0 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0);</div><div class="line"><a name="l06659"></a><span class="lineno"> 6659</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N1 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(1);</div><div class="line"><a name="l06660"></a><span class="lineno"> 6660</span>&#160;  <a class="code" href="classllvm_1_1ConstantFPSDNode.html">ConstantFPSDNode</a> *N0CFP = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantFPSDNode.html">ConstantFPSDNode</a>&gt;(N0);</div><div class="line"><a name="l06661"></a><span class="lineno"> 6661</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> VT = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(0);</div><div class="line"><a name="l06662"></a><span class="lineno"> 6662</span>&#160;</div><div class="line"><a name="l06663"></a><span class="lineno"> 6663</span>&#160;  <span class="comment">// fold (fp_round c1fp) -&gt; c1fp</span></div><div class="line"><a name="l06664"></a><span class="lineno"> 6664</span>&#160;  <span class="keywordflow">if</span> (N0CFP)</div><div class="line"><a name="l06665"></a><span class="lineno"> 6665</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110adaf9a3cb5c2ef5eb713bd6bf4ae23aeb">ISD::FP_ROUND</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N0, N1);</div><div class="line"><a name="l06666"></a><span class="lineno"> 6666</span>&#160;</div><div class="line"><a name="l06667"></a><span class="lineno"> 6667</span>&#160;  <span class="comment">// fold (fp_round (fp_extend x)) -&gt; x</span></div><div class="line"><a name="l06668"></a><span class="lineno"> 6668</span>&#160;  <span class="keywordflow">if</span> (N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110aadfdefcb133a7f0262a05934aba8ce5d">ISD::FP_EXTEND</a> &amp;&amp; VT == N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>())</div><div class="line"><a name="l06669"></a><span class="lineno"> 6669</span>&#160;    <span class="keywordflow">return</span> N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0);</div><div class="line"><a name="l06670"></a><span class="lineno"> 6670</span>&#160;</div><div class="line"><a name="l06671"></a><span class="lineno"> 6671</span>&#160;  <span class="comment">// fold (fp_round (fp_round x)) -&gt; (fp_round x)</span></div><div class="line"><a name="l06672"></a><span class="lineno"> 6672</span>&#160;  <span class="keywordflow">if</span> (N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110adaf9a3cb5c2ef5eb713bd6bf4ae23aeb">ISD::FP_ROUND</a>) {</div><div class="line"><a name="l06673"></a><span class="lineno"> 6673</span>&#160;    <span class="comment">// This is a value preserving truncation if both round&#39;s are.</span></div><div class="line"><a name="l06674"></a><span class="lineno"> 6674</span>&#160;    <span class="keywordtype">bool</span> IsTrunc = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#aff84cd98daca4f1901020fb99845fcfc">getConstantOperandVal</a>(1) == 1 &amp;&amp;</div><div class="line"><a name="l06675"></a><span class="lineno"> 6675</span>&#160;                   N0.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()-&gt;<a class="code" href="classllvm_1_1SDNode.html#aff84cd98daca4f1901020fb99845fcfc">getConstantOperandVal</a>(1) == 1;</div><div class="line"><a name="l06676"></a><span class="lineno"> 6676</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110adaf9a3cb5c2ef5eb713bd6bf4ae23aeb">ISD::FP_ROUND</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0),</div><div class="line"><a name="l06677"></a><span class="lineno"> 6677</span>&#160;                       DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a9a66b00ea9db7d80bf1bcbbcaa108239">getIntPtrConstant</a>(IsTrunc));</div><div class="line"><a name="l06678"></a><span class="lineno"> 6678</span>&#160;  }</div><div class="line"><a name="l06679"></a><span class="lineno"> 6679</span>&#160;</div><div class="line"><a name="l06680"></a><span class="lineno"> 6680</span>&#160;  <span class="comment">// fold (fp_round (copysign X, Y)) -&gt; (copysign (fp_round X), Y)</span></div><div class="line"><a name="l06681"></a><span class="lineno"> 6681</span>&#160;  <span class="keywordflow">if</span> (N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110aeffc3319657e213a530ce583603f7221">ISD::FCOPYSIGN</a> &amp;&amp; N0.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()-&gt;<a class="code" href="classllvm_1_1SDNode.html#a52753947fce3a01b1c18dd4713c587e8">hasOneUse</a>()) {</div><div class="line"><a name="l06682"></a><span class="lineno"> 6682</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Tmp = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110adaf9a3cb5c2ef5eb713bd6bf4ae23aeb">ISD::FP_ROUND</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N0), VT,</div><div class="line"><a name="l06683"></a><span class="lineno"> 6683</span>&#160;                              N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0), N1);</div><div class="line"><a name="l06684"></a><span class="lineno"> 6684</span>&#160;    AddToWorkList(Tmp.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l06685"></a><span class="lineno"> 6685</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110aeffc3319657e213a530ce583603f7221">ISD::FCOPYSIGN</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT,</div><div class="line"><a name="l06686"></a><span class="lineno"> 6686</span>&#160;                       Tmp, N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1));</div><div class="line"><a name="l06687"></a><span class="lineno"> 6687</span>&#160;  }</div><div class="line"><a name="l06688"></a><span class="lineno"> 6688</span>&#160;</div><div class="line"><a name="l06689"></a><span class="lineno"> 6689</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l06690"></a><span class="lineno"> 6690</span>&#160;}</div><div class="line"><a name="l06691"></a><span class="lineno"> 6691</span>&#160;</div><div class="line"><a name="l06692"></a><span class="lineno"> 6692</span>&#160;<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::visitFP_ROUND_INREG(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N) {</div><div class="line"><a name="l06693"></a><span class="lineno"> 6693</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N0 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0);</div><div class="line"><a name="l06694"></a><span class="lineno"> 6694</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> VT = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(0);</div><div class="line"><a name="l06695"></a><span class="lineno"> 6695</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> <a class="code" href="structllvm_1_1EVT.html">EVT</a> = cast&lt;VTSDNode&gt;(N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(1))-&gt;getVT();</div><div class="line"><a name="l06696"></a><span class="lineno"> 6696</span>&#160;  <a class="code" href="classllvm_1_1ConstantFPSDNode.html">ConstantFPSDNode</a> *N0CFP = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantFPSDNode.html">ConstantFPSDNode</a>&gt;(N0);</div><div class="line"><a name="l06697"></a><span class="lineno"> 6697</span>&#160;</div><div class="line"><a name="l06698"></a><span class="lineno"> 6698</span>&#160;  <span class="comment">// fold (fp_round_inreg c1fp) -&gt; c1fp</span></div><div class="line"><a name="l06699"></a><span class="lineno"> 6699</span>&#160;  <span class="keywordflow">if</span> (N0CFP &amp;&amp; isTypeLegal(EVT)) {</div><div class="line"><a name="l06700"></a><span class="lineno"> 6700</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Round = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a268e5bc7dd40a28712a33ca6c9c91c6f">getConstantFP</a>(*N0CFP-&gt;<a class="code" href="classllvm_1_1ConstantFPSDNode.html#a9e6e07caea417920f3f2a755ea5f06db">getConstantFPValue</a>(), EVT);</div><div class="line"><a name="l06701"></a><span class="lineno"> 6701</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110aadfdefcb133a7f0262a05934aba8ce5d">ISD::FP_EXTEND</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, Round);</div><div class="line"><a name="l06702"></a><span class="lineno"> 6702</span>&#160;  }</div><div class="line"><a name="l06703"></a><span class="lineno"> 6703</span>&#160;</div><div class="line"><a name="l06704"></a><span class="lineno"> 6704</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l06705"></a><span class="lineno"> 6705</span>&#160;}</div><div class="line"><a name="l06706"></a><span class="lineno"> 6706</span>&#160;</div><div class="line"><a name="l06707"></a><span class="lineno"> 6707</span>&#160;<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::visitFP_EXTEND(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N) {</div><div class="line"><a name="l06708"></a><span class="lineno"> 6708</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N0 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0);</div><div class="line"><a name="l06709"></a><span class="lineno"> 6709</span>&#160;  <a class="code" href="classllvm_1_1ConstantFPSDNode.html">ConstantFPSDNode</a> *N0CFP = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantFPSDNode.html">ConstantFPSDNode</a>&gt;(N0);</div><div class="line"><a name="l06710"></a><span class="lineno"> 6710</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> VT = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(0);</div><div class="line"><a name="l06711"></a><span class="lineno"> 6711</span>&#160;</div><div class="line"><a name="l06712"></a><span class="lineno"> 6712</span>&#160;  <span class="comment">// If this is fp_round(fpextend), don&#39;t fold it, allow ourselves to be folded.</span></div><div class="line"><a name="l06713"></a><span class="lineno"> 6713</span>&#160;  <span class="keywordflow">if</span> (N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a52753947fce3a01b1c18dd4713c587e8">hasOneUse</a>() &amp;&amp;</div><div class="line"><a name="l06714"></a><span class="lineno"> 6714</span>&#160;      N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a8810bf428dcf84d48f39c8f5ba9a8c94">use_begin</a>()-&gt;<a class="code" href="classllvm_1_1SDNode.html#af0d328f3f61168f4ea7d6e4044af4f97">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110adaf9a3cb5c2ef5eb713bd6bf4ae23aeb">ISD::FP_ROUND</a>)</div><div class="line"><a name="l06715"></a><span class="lineno"> 6715</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l06716"></a><span class="lineno"> 6716</span>&#160;</div><div class="line"><a name="l06717"></a><span class="lineno"> 6717</span>&#160;  <span class="comment">// fold (fp_extend c1fp) -&gt; c1fp</span></div><div class="line"><a name="l06718"></a><span class="lineno"> 6718</span>&#160;  <span class="keywordflow">if</span> (N0CFP)</div><div class="line"><a name="l06719"></a><span class="lineno"> 6719</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110aadfdefcb133a7f0262a05934aba8ce5d">ISD::FP_EXTEND</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N0);</div><div class="line"><a name="l06720"></a><span class="lineno"> 6720</span>&#160;</div><div class="line"><a name="l06721"></a><span class="lineno"> 6721</span>&#160;  <span class="comment">// Turn fp_extend(fp_round(X, 1)) -&gt; x since the fp_round doesn&#39;t affect the</span></div><div class="line"><a name="l06722"></a><span class="lineno"> 6722</span>&#160;  <span class="comment">// value of X.</span></div><div class="line"><a name="l06723"></a><span class="lineno"> 6723</span>&#160;  <span class="keywordflow">if</span> (N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110adaf9a3cb5c2ef5eb713bd6bf4ae23aeb">ISD::FP_ROUND</a></div><div class="line"><a name="l06724"></a><span class="lineno"> 6724</span>&#160;      &amp;&amp; N0.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()-&gt;<a class="code" href="classllvm_1_1SDNode.html#aff84cd98daca4f1901020fb99845fcfc">getConstantOperandVal</a>(1) == 1) {</div><div class="line"><a name="l06725"></a><span class="lineno"> 6725</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> <a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5a5fa7b4069ef3bd1ceb9f2caa315cf5ac">In</a> = N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0);</div><div class="line"><a name="l06726"></a><span class="lineno"> 6726</span>&#160;    <span class="keywordflow">if</span> (In.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>() == VT) <span class="keywordflow">return</span> In;</div><div class="line"><a name="l06727"></a><span class="lineno"> 6727</span>&#160;    <span class="keywordflow">if</span> (VT.bitsLT(In.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>()))</div><div class="line"><a name="l06728"></a><span class="lineno"> 6728</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110adaf9a3cb5c2ef5eb713bd6bf4ae23aeb">ISD::FP_ROUND</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT,</div><div class="line"><a name="l06729"></a><span class="lineno"> 6729</span>&#160;                         In, N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1));</div><div class="line"><a name="l06730"></a><span class="lineno"> 6730</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110aadfdefcb133a7f0262a05934aba8ce5d">ISD::FP_EXTEND</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, In);</div><div class="line"><a name="l06731"></a><span class="lineno"> 6731</span>&#160;  }</div><div class="line"><a name="l06732"></a><span class="lineno"> 6732</span>&#160;</div><div class="line"><a name="l06733"></a><span class="lineno"> 6733</span>&#160;  <span class="comment">// fold (fpext (load x)) -&gt; (fpext (fptrunc (extload x)))</span></div><div class="line"><a name="l06734"></a><span class="lineno"> 6734</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1ISD.html#afaaeadcd82b42fc0d385a6247bf7bb52">ISD::isNormalLoad</a>(N0.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()) &amp;&amp; N0.<a class="code" href="classllvm_1_1SDValue.html#a97b0f24f3e52f030830fca6fbfcbd37d">hasOneUse</a>() &amp;&amp;</div><div class="line"><a name="l06735"></a><span class="lineno"> 6735</span>&#160;      ((!LegalOperations &amp;&amp; !cast&lt;LoadSDNode&gt;(N0)-&gt;isVolatile()) ||</div><div class="line"><a name="l06736"></a><span class="lineno"> 6736</span>&#160;       TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#ad85f712b9e49629c2c160f16521fe91f">isLoadExtLegal</a>(<a class="code" href="namespacellvm_1_1ISD.html#ad4d48171b87ca51ff54c10a436bac4d7afab3fffd153f7d7770fed81272e4b78f">ISD::EXTLOAD</a>, N0.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>()))) {</div><div class="line"><a name="l06737"></a><span class="lineno"> 6737</span>&#160;    <a class="code" href="classllvm_1_1LoadSDNode.html">LoadSDNode</a> *LN0 = cast&lt;LoadSDNode&gt;(N0);</div><div class="line"><a name="l06738"></a><span class="lineno"> 6738</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> ExtLoad = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#ad6ff413bea6f8195d8e6f29f4fc519c4">getExtLoad</a>(<a class="code" href="namespacellvm_1_1ISD.html#ad4d48171b87ca51ff54c10a436bac4d7afab3fffd153f7d7770fed81272e4b78f">ISD::EXTLOAD</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT,</div><div class="line"><a name="l06739"></a><span class="lineno"> 6739</span>&#160;                                     LN0-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#ae3cb6fbf8c8cb79e10ac61bd98c85211">getChain</a>(),</div><div class="line"><a name="l06740"></a><span class="lineno"> 6740</span>&#160;                                     LN0-&gt;<a class="code" href="classllvm_1_1LoadSDNode.html#a3ded48ce66b58b7e7e143991df5dbfae">getBasePtr</a>(), N0.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>(),</div><div class="line"><a name="l06741"></a><span class="lineno"> 6741</span>&#160;                                     LN0-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a89e2b5e3fb867b4040f893c6ae3d2132">getMemOperand</a>());</div><div class="line"><a name="l06742"></a><span class="lineno"> 6742</span>&#160;    CombineTo(N, ExtLoad);</div><div class="line"><a name="l06743"></a><span class="lineno"> 6743</span>&#160;    CombineTo(N0.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>(),</div><div class="line"><a name="l06744"></a><span class="lineno"> 6744</span>&#160;              DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110adaf9a3cb5c2ef5eb713bd6bf4ae23aeb">ISD::FP_ROUND</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N0),</div><div class="line"><a name="l06745"></a><span class="lineno"> 6745</span>&#160;                          N0.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>(), ExtLoad, DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a9a66b00ea9db7d80bf1bcbbcaa108239">getIntPtrConstant</a>(1)),</div><div class="line"><a name="l06746"></a><span class="lineno"> 6746</span>&#160;              ExtLoad.<a class="code" href="classllvm_1_1SDValue.html#a040481b9bda32faa6b1435532405d88f">getValue</a>(1));</div><div class="line"><a name="l06747"></a><span class="lineno"> 6747</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(N, 0);   <span class="comment">// Return N so it doesn&#39;t get rechecked!</span></div><div class="line"><a name="l06748"></a><span class="lineno"> 6748</span>&#160;  }</div><div class="line"><a name="l06749"></a><span class="lineno"> 6749</span>&#160;</div><div class="line"><a name="l06750"></a><span class="lineno"> 6750</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l06751"></a><span class="lineno"> 6751</span>&#160;}</div><div class="line"><a name="l06752"></a><span class="lineno"> 6752</span>&#160;</div><div class="line"><a name="l06753"></a><span class="lineno"> 6753</span>&#160;<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::visitFNEG(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N) {</div><div class="line"><a name="l06754"></a><span class="lineno"> 6754</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N0 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0);</div><div class="line"><a name="l06755"></a><span class="lineno"> 6755</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> VT = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(0);</div><div class="line"><a name="l06756"></a><span class="lineno"> 6756</span>&#160;</div><div class="line"><a name="l06757"></a><span class="lineno"> 6757</span>&#160;  <span class="keywordflow">if</span> (VT.<a class="code" href="structllvm_1_1EVT.html#a73f7c824cad61a47c21bf6d652ae2fd7">isVector</a>()) {</div><div class="line"><a name="l06758"></a><span class="lineno"> 6758</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> FoldedVOp = SimplifyVUnaryOp(N);</div><div class="line"><a name="l06759"></a><span class="lineno"> 6759</span>&#160;    <span class="keywordflow">if</span> (FoldedVOp.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()) <span class="keywordflow">return</span> FoldedVOp;</div><div class="line"><a name="l06760"></a><span class="lineno"> 6760</span>&#160;  }</div><div class="line"><a name="l06761"></a><span class="lineno"> 6761</span>&#160;</div><div class="line"><a name="l06762"></a><span class="lineno"> 6762</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="DAGCombiner_8cpp.html#aec1e6891acbf695c615301db72893862">isNegatibleForFree</a>(N0, LegalOperations, DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a848b46af8fabd1ab34b28adbc3665609">getTargetLoweringInfo</a>(),</div><div class="line"><a name="l06763"></a><span class="lineno"> 6763</span>&#160;                         &amp;DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a6b60694d1d9d7f634e7638856898e20d">getTarget</a>().<a class="code" href="classllvm_1_1TargetMachine.html#ab1fb67187fc37e569cc5171cbebba873">Options</a>))</div><div class="line"><a name="l06764"></a><span class="lineno"> 6764</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="DAGCombiner_8cpp.html#a55d3de0deed33d70188b2b5a9cab8f00">GetNegatedExpression</a>(N0, DAG, LegalOperations);</div><div class="line"><a name="l06765"></a><span class="lineno"> 6765</span>&#160;</div><div class="line"><a name="l06766"></a><span class="lineno"> 6766</span>&#160;  <span class="comment">// Transform fneg(bitconvert(x)) -&gt; bitconvert(x^sign) to avoid loading</span></div><div class="line"><a name="l06767"></a><span class="lineno"> 6767</span>&#160;  <span class="comment">// constant pool values.</span></div><div class="line"><a name="l06768"></a><span class="lineno"> 6768</span>&#160;  <span class="keywordflow">if</span> (!TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a814573c6f6263d6f7b463ce0a591781a">isFNegFree</a>(VT) &amp;&amp; N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a412ddf522b53f07690a86bffba1278e7">ISD::BITCAST</a> &amp;&amp;</div><div class="line"><a name="l06769"></a><span class="lineno"> 6769</span>&#160;      !VT.<a class="code" href="structllvm_1_1EVT.html#a73f7c824cad61a47c21bf6d652ae2fd7">isVector</a>() &amp;&amp;</div><div class="line"><a name="l06770"></a><span class="lineno"> 6770</span>&#160;      N0.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()-&gt;<a class="code" href="classllvm_1_1SDNode.html#a52753947fce3a01b1c18dd4713c587e8">hasOneUse</a>() &amp;&amp;</div><div class="line"><a name="l06771"></a><span class="lineno"> 6771</span>&#160;      N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>().<a class="code" href="structllvm_1_1EVT.html#a8cc407ac00df4edd4ec4d5168d6ecb26">isInteger</a>()) {</div><div class="line"><a name="l06772"></a><span class="lineno"> 6772</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> <a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5abb824e612ba80ddfd262b018bf537595">Int</a> = N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0);</div><div class="line"><a name="l06773"></a><span class="lineno"> 6773</span>&#160;    <a class="code" href="structllvm_1_1EVT.html">EVT</a> IntVT = Int.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>();</div><div class="line"><a name="l06774"></a><span class="lineno"> 6774</span>&#160;    <span class="keywordflow">if</span> (IntVT.<a class="code" href="structllvm_1_1EVT.html#a8cc407ac00df4edd4ec4d5168d6ecb26">isInteger</a>() &amp;&amp; !IntVT.<a class="code" href="structllvm_1_1EVT.html#a73f7c824cad61a47c21bf6d652ae2fd7">isVector</a>()) {</div><div class="line"><a name="l06775"></a><span class="lineno"> 6775</span>&#160;      Int = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a92febb83e6ba116eb7aae8e7e3f70cc1">ISD::XOR</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N0), IntVT, Int,</div><div class="line"><a name="l06776"></a><span class="lineno"> 6776</span>&#160;              DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(<a class="code" href="classllvm_1_1APInt.html#a2e5e9f65d911e80a46d3098933794056">APInt::getSignBit</a>(IntVT.<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>()), IntVT));</div><div class="line"><a name="l06777"></a><span class="lineno"> 6777</span>&#160;      AddToWorkList(Int.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l06778"></a><span class="lineno"> 6778</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a412ddf522b53f07690a86bffba1278e7">ISD::BITCAST</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N),</div><div class="line"><a name="l06779"></a><span class="lineno"> 6779</span>&#160;                         VT, Int);</div><div class="line"><a name="l06780"></a><span class="lineno"> 6780</span>&#160;    }</div><div class="line"><a name="l06781"></a><span class="lineno"> 6781</span>&#160;  }</div><div class="line"><a name="l06782"></a><span class="lineno"> 6782</span>&#160;</div><div class="line"><a name="l06783"></a><span class="lineno"> 6783</span>&#160;  <span class="comment">// (fneg (fmul c, x)) -&gt; (fmul -c, x)</span></div><div class="line"><a name="l06784"></a><span class="lineno"> 6784</span>&#160;  <span class="keywordflow">if</span> (N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9ab5860c97a00c4627a08cab7b0c8178">ISD::FMUL</a>) {</div><div class="line"><a name="l06785"></a><span class="lineno"> 6785</span>&#160;    <a class="code" href="classllvm_1_1ConstantFPSDNode.html">ConstantFPSDNode</a> *CFP1 = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantFPSDNode.html">ConstantFPSDNode</a>&gt;(N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1));</div><div class="line"><a name="l06786"></a><span class="lineno"> 6786</span>&#160;    <span class="keywordflow">if</span> (CFP1)</div><div class="line"><a name="l06787"></a><span class="lineno"> 6787</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9ab5860c97a00c4627a08cab7b0c8178">ISD::FMUL</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT,</div><div class="line"><a name="l06788"></a><span class="lineno"> 6788</span>&#160;                         N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0),</div><div class="line"><a name="l06789"></a><span class="lineno"> 6789</span>&#160;                         DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a6d26c45c040d8f85d577a5f645261d1a">ISD::FNEG</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT,</div><div class="line"><a name="l06790"></a><span class="lineno"> 6790</span>&#160;                                     N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1)));</div><div class="line"><a name="l06791"></a><span class="lineno"> 6791</span>&#160;  }</div><div class="line"><a name="l06792"></a><span class="lineno"> 6792</span>&#160;</div><div class="line"><a name="l06793"></a><span class="lineno"> 6793</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l06794"></a><span class="lineno"> 6794</span>&#160;}</div><div class="line"><a name="l06795"></a><span class="lineno"> 6795</span>&#160;</div><div class="line"><a name="l06796"></a><span class="lineno"> 6796</span>&#160;<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::visitFCEIL(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N) {</div><div class="line"><a name="l06797"></a><span class="lineno"> 6797</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N0 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0);</div><div class="line"><a name="l06798"></a><span class="lineno"> 6798</span>&#160;  <a class="code" href="classllvm_1_1ConstantFPSDNode.html">ConstantFPSDNode</a> *N0CFP = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantFPSDNode.html">ConstantFPSDNode</a>&gt;(N0);</div><div class="line"><a name="l06799"></a><span class="lineno"> 6799</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> VT = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(0);</div><div class="line"><a name="l06800"></a><span class="lineno"> 6800</span>&#160;</div><div class="line"><a name="l06801"></a><span class="lineno"> 6801</span>&#160;  <span class="comment">// fold (fceil c1) -&gt; fceil(c1)</span></div><div class="line"><a name="l06802"></a><span class="lineno"> 6802</span>&#160;  <span class="keywordflow">if</span> (N0CFP)</div><div class="line"><a name="l06803"></a><span class="lineno"> 6803</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ad56e9199ae3993a09af36ff41d327a11">ISD::FCEIL</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N0);</div><div class="line"><a name="l06804"></a><span class="lineno"> 6804</span>&#160;</div><div class="line"><a name="l06805"></a><span class="lineno"> 6805</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l06806"></a><span class="lineno"> 6806</span>&#160;}</div><div class="line"><a name="l06807"></a><span class="lineno"> 6807</span>&#160;</div><div class="line"><a name="l06808"></a><span class="lineno"> 6808</span>&#160;<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::visitFTRUNC(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N) {</div><div class="line"><a name="l06809"></a><span class="lineno"> 6809</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N0 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0);</div><div class="line"><a name="l06810"></a><span class="lineno"> 6810</span>&#160;  <a class="code" href="classllvm_1_1ConstantFPSDNode.html">ConstantFPSDNode</a> *N0CFP = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantFPSDNode.html">ConstantFPSDNode</a>&gt;(N0);</div><div class="line"><a name="l06811"></a><span class="lineno"> 6811</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> VT = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(0);</div><div class="line"><a name="l06812"></a><span class="lineno"> 6812</span>&#160;</div><div class="line"><a name="l06813"></a><span class="lineno"> 6813</span>&#160;  <span class="comment">// fold (ftrunc c1) -&gt; ftrunc(c1)</span></div><div class="line"><a name="l06814"></a><span class="lineno"> 6814</span>&#160;  <span class="keywordflow">if</span> (N0CFP)</div><div class="line"><a name="l06815"></a><span class="lineno"> 6815</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a1e92ea554489509b0ad970901bcc715b">ISD::FTRUNC</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N0);</div><div class="line"><a name="l06816"></a><span class="lineno"> 6816</span>&#160;</div><div class="line"><a name="l06817"></a><span class="lineno"> 6817</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l06818"></a><span class="lineno"> 6818</span>&#160;}</div><div class="line"><a name="l06819"></a><span class="lineno"> 6819</span>&#160;</div><div class="line"><a name="l06820"></a><span class="lineno"> 6820</span>&#160;<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::visitFFLOOR(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N) {</div><div class="line"><a name="l06821"></a><span class="lineno"> 6821</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N0 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0);</div><div class="line"><a name="l06822"></a><span class="lineno"> 6822</span>&#160;  <a class="code" href="classllvm_1_1ConstantFPSDNode.html">ConstantFPSDNode</a> *N0CFP = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantFPSDNode.html">ConstantFPSDNode</a>&gt;(N0);</div><div class="line"><a name="l06823"></a><span class="lineno"> 6823</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> VT = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(0);</div><div class="line"><a name="l06824"></a><span class="lineno"> 6824</span>&#160;</div><div class="line"><a name="l06825"></a><span class="lineno"> 6825</span>&#160;  <span class="comment">// fold (ffloor c1) -&gt; ffloor(c1)</span></div><div class="line"><a name="l06826"></a><span class="lineno"> 6826</span>&#160;  <span class="keywordflow">if</span> (N0CFP)</div><div class="line"><a name="l06827"></a><span class="lineno"> 6827</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a4336c27826676e1ef61383cafa999219">ISD::FFLOOR</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N0);</div><div class="line"><a name="l06828"></a><span class="lineno"> 6828</span>&#160;</div><div class="line"><a name="l06829"></a><span class="lineno"> 6829</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l06830"></a><span class="lineno"> 6830</span>&#160;}</div><div class="line"><a name="l06831"></a><span class="lineno"> 6831</span>&#160;</div><div class="line"><a name="l06832"></a><span class="lineno"> 6832</span>&#160;<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::visitFABS(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N) {</div><div class="line"><a name="l06833"></a><span class="lineno"> 6833</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N0 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0);</div><div class="line"><a name="l06834"></a><span class="lineno"> 6834</span>&#160;  <a class="code" href="classllvm_1_1ConstantFPSDNode.html">ConstantFPSDNode</a> *N0CFP = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantFPSDNode.html">ConstantFPSDNode</a>&gt;(N0);</div><div class="line"><a name="l06835"></a><span class="lineno"> 6835</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> VT = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(0);</div><div class="line"><a name="l06836"></a><span class="lineno"> 6836</span>&#160;</div><div class="line"><a name="l06837"></a><span class="lineno"> 6837</span>&#160;  <span class="keywordflow">if</span> (VT.isVector()) {</div><div class="line"><a name="l06838"></a><span class="lineno"> 6838</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> FoldedVOp = SimplifyVUnaryOp(N);</div><div class="line"><a name="l06839"></a><span class="lineno"> 6839</span>&#160;    <span class="keywordflow">if</span> (FoldedVOp.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()) <span class="keywordflow">return</span> FoldedVOp;</div><div class="line"><a name="l06840"></a><span class="lineno"> 6840</span>&#160;  }</div><div class="line"><a name="l06841"></a><span class="lineno"> 6841</span>&#160;</div><div class="line"><a name="l06842"></a><span class="lineno"> 6842</span>&#160;  <span class="comment">// fold (fabs c1) -&gt; fabs(c1)</span></div><div class="line"><a name="l06843"></a><span class="lineno"> 6843</span>&#160;  <span class="keywordflow">if</span> (N0CFP)</div><div class="line"><a name="l06844"></a><span class="lineno"> 6844</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a2b4d07600495a563319d6a3dda8dc44d">ISD::FABS</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N0);</div><div class="line"><a name="l06845"></a><span class="lineno"> 6845</span>&#160;  <span class="comment">// fold (fabs (fabs x)) -&gt; (fabs x)</span></div><div class="line"><a name="l06846"></a><span class="lineno"> 6846</span>&#160;  <span class="keywordflow">if</span> (N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a2b4d07600495a563319d6a3dda8dc44d">ISD::FABS</a>)</div><div class="line"><a name="l06847"></a><span class="lineno"> 6847</span>&#160;    <span class="keywordflow">return</span> N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0);</div><div class="line"><a name="l06848"></a><span class="lineno"> 6848</span>&#160;  <span class="comment">// fold (fabs (fneg x)) -&gt; (fabs x)</span></div><div class="line"><a name="l06849"></a><span class="lineno"> 6849</span>&#160;  <span class="comment">// fold (fabs (fcopysign x, y)) -&gt; (fabs x)</span></div><div class="line"><a name="l06850"></a><span class="lineno"> 6850</span>&#160;  <span class="keywordflow">if</span> (N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a6d26c45c040d8f85d577a5f645261d1a">ISD::FNEG</a> || N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110aeffc3319657e213a530ce583603f7221">ISD::FCOPYSIGN</a>)</div><div class="line"><a name="l06851"></a><span class="lineno"> 6851</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a2b4d07600495a563319d6a3dda8dc44d">ISD::FABS</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0));</div><div class="line"><a name="l06852"></a><span class="lineno"> 6852</span>&#160;</div><div class="line"><a name="l06853"></a><span class="lineno"> 6853</span>&#160;  <span class="comment">// Transform fabs(bitconvert(x)) -&gt; bitconvert(x&amp;~sign) to avoid loading</span></div><div class="line"><a name="l06854"></a><span class="lineno"> 6854</span>&#160;  <span class="comment">// constant pool values.</span></div><div class="line"><a name="l06855"></a><span class="lineno"> 6855</span>&#160;  <span class="keywordflow">if</span> (!TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a03d795b93578bd5b530aa998869fb1ac">isFAbsFree</a>(VT) &amp;&amp;</div><div class="line"><a name="l06856"></a><span class="lineno"> 6856</span>&#160;      N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a412ddf522b53f07690a86bffba1278e7">ISD::BITCAST</a> &amp;&amp; N0.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()-&gt;<a class="code" href="classllvm_1_1SDNode.html#a52753947fce3a01b1c18dd4713c587e8">hasOneUse</a>() &amp;&amp;</div><div class="line"><a name="l06857"></a><span class="lineno"> 6857</span>&#160;      N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>().<a class="code" href="structllvm_1_1EVT.html#a8cc407ac00df4edd4ec4d5168d6ecb26">isInteger</a>() &amp;&amp;</div><div class="line"><a name="l06858"></a><span class="lineno"> 6858</span>&#160;      !N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>().<a class="code" href="structllvm_1_1EVT.html#a73f7c824cad61a47c21bf6d652ae2fd7">isVector</a>()) {</div><div class="line"><a name="l06859"></a><span class="lineno"> 6859</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> <a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5abb824e612ba80ddfd262b018bf537595">Int</a> = N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0);</div><div class="line"><a name="l06860"></a><span class="lineno"> 6860</span>&#160;    <a class="code" href="structllvm_1_1EVT.html">EVT</a> IntVT = Int.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>();</div><div class="line"><a name="l06861"></a><span class="lineno"> 6861</span>&#160;    <span class="keywordflow">if</span> (IntVT.<a class="code" href="structllvm_1_1EVT.html#a8cc407ac00df4edd4ec4d5168d6ecb26">isInteger</a>() &amp;&amp; !IntVT.<a class="code" href="structllvm_1_1EVT.html#a73f7c824cad61a47c21bf6d652ae2fd7">isVector</a>()) {</div><div class="line"><a name="l06862"></a><span class="lineno"> 6862</span>&#160;      Int = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ac513a7da1bf74fb3e3c594da8534f2d2">ISD::AND</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N0), IntVT, Int,</div><div class="line"><a name="l06863"></a><span class="lineno"> 6863</span>&#160;             DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(~<a class="code" href="classllvm_1_1APInt.html#a2e5e9f65d911e80a46d3098933794056">APInt::getSignBit</a>(IntVT.<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>()), IntVT));</div><div class="line"><a name="l06864"></a><span class="lineno"> 6864</span>&#160;      AddToWorkList(Int.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l06865"></a><span class="lineno"> 6865</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a412ddf522b53f07690a86bffba1278e7">ISD::BITCAST</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N),</div><div class="line"><a name="l06866"></a><span class="lineno"> 6866</span>&#160;                         N-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(0), <a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5abb824e612ba80ddfd262b018bf537595">Int</a>);</div><div class="line"><a name="l06867"></a><span class="lineno"> 6867</span>&#160;    }</div><div class="line"><a name="l06868"></a><span class="lineno"> 6868</span>&#160;  }</div><div class="line"><a name="l06869"></a><span class="lineno"> 6869</span>&#160;</div><div class="line"><a name="l06870"></a><span class="lineno"> 6870</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l06871"></a><span class="lineno"> 6871</span>&#160;}</div><div class="line"><a name="l06872"></a><span class="lineno"> 6872</span>&#160;</div><div class="line"><a name="l06873"></a><span class="lineno"> 6873</span>&#160;<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::visitBRCOND(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N) {</div><div class="line"><a name="l06874"></a><span class="lineno"> 6874</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Chain = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0);</div><div class="line"><a name="l06875"></a><span class="lineno"> 6875</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N1 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(1);</div><div class="line"><a name="l06876"></a><span class="lineno"> 6876</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N2 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(2);</div><div class="line"><a name="l06877"></a><span class="lineno"> 6877</span>&#160;</div><div class="line"><a name="l06878"></a><span class="lineno"> 6878</span>&#160;  <span class="comment">// If N is a constant we could fold this into a fallthrough or unconditional</span></div><div class="line"><a name="l06879"></a><span class="lineno"> 6879</span>&#160;  <span class="comment">// branch. However that doesn&#39;t happen very often in normal code, because</span></div><div class="line"><a name="l06880"></a><span class="lineno"> 6880</span>&#160;  <span class="comment">// Instcombine/SimplifyCFG should have handled the available opportunities.</span></div><div class="line"><a name="l06881"></a><span class="lineno"> 6881</span>&#160;  <span class="comment">// If we did this folding here, it would be necessary to update the</span></div><div class="line"><a name="l06882"></a><span class="lineno"> 6882</span>&#160;  <span class="comment">// MachineBasicBlock CFG, which is awkward.</span></div><div class="line"><a name="l06883"></a><span class="lineno"> 6883</span>&#160;</div><div class="line"><a name="l06884"></a><span class="lineno"> 6884</span>&#160;  <span class="comment">// fold a brcond with a setcc condition into a BR_CC node if BR_CC is legal</span></div><div class="line"><a name="l06885"></a><span class="lineno"> 6885</span>&#160;  <span class="comment">// on the target.</span></div><div class="line"><a name="l06886"></a><span class="lineno"> 6886</span>&#160;  <span class="keywordflow">if</span> (N1.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a0158ee47dfa868be5d28e2cbef70d5d0">ISD::SETCC</a> &amp;&amp;</div><div class="line"><a name="l06887"></a><span class="lineno"> 6887</span>&#160;      TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a087dd0f9650e999b087c17cc7f46f2d0">isOperationLegalOrCustom</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a6d5e322b263f0d5ea4204efafc1d78bb">ISD::BR_CC</a>,</div><div class="line"><a name="l06888"></a><span class="lineno"> 6888</span>&#160;                                   N1.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>())) {</div><div class="line"><a name="l06889"></a><span class="lineno"> 6889</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a6d5e322b263f0d5ea4204efafc1d78bb">ISD::BR_CC</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), <a class="code" href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50ca62a222acce6360abd2726719fabc2797">MVT::Other</a>,</div><div class="line"><a name="l06890"></a><span class="lineno"> 6890</span>&#160;                       Chain, N1.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(2),</div><div class="line"><a name="l06891"></a><span class="lineno"> 6891</span>&#160;                       N1.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0), N1.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1), N2);</div><div class="line"><a name="l06892"></a><span class="lineno"> 6892</span>&#160;  }</div><div class="line"><a name="l06893"></a><span class="lineno"> 6893</span>&#160;</div><div class="line"><a name="l06894"></a><span class="lineno"> 6894</span>&#160;  <span class="keywordflow">if</span> ((N1.<a class="code" href="classllvm_1_1SDValue.html#a97b0f24f3e52f030830fca6fbfcbd37d">hasOneUse</a>() &amp;&amp; N1.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a3c6553c8acebe1b57c211ee45e2d8f98">ISD::SRL</a>) ||</div><div class="line"><a name="l06895"></a><span class="lineno"> 6895</span>&#160;      ((N1.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ae690127648393001a7d5b93dc23da7b3">ISD::TRUNCATE</a> &amp;&amp; N1.<a class="code" href="classllvm_1_1SDValue.html#a97b0f24f3e52f030830fca6fbfcbd37d">hasOneUse</a>()) &amp;&amp;</div><div class="line"><a name="l06896"></a><span class="lineno"> 6896</span>&#160;       (N1.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a97b0f24f3e52f030830fca6fbfcbd37d">hasOneUse</a>() &amp;&amp;</div><div class="line"><a name="l06897"></a><span class="lineno"> 6897</span>&#160;        N1.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a3c6553c8acebe1b57c211ee45e2d8f98">ISD::SRL</a>))) {</div><div class="line"><a name="l06898"></a><span class="lineno"> 6898</span>&#160;    <a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *Trunc = 0;</div><div class="line"><a name="l06899"></a><span class="lineno"> 6899</span>&#160;    <span class="keywordflow">if</span> (N1.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ae690127648393001a7d5b93dc23da7b3">ISD::TRUNCATE</a>) {</div><div class="line"><a name="l06900"></a><span class="lineno"> 6900</span>&#160;      <span class="comment">// Look pass the truncate.</span></div><div class="line"><a name="l06901"></a><span class="lineno"> 6901</span>&#160;      Trunc = N1.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>();</div><div class="line"><a name="l06902"></a><span class="lineno"> 6902</span>&#160;      N1 = N1.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0);</div><div class="line"><a name="l06903"></a><span class="lineno"> 6903</span>&#160;    }</div><div class="line"><a name="l06904"></a><span class="lineno"> 6904</span>&#160;</div><div class="line"><a name="l06905"></a><span class="lineno"> 6905</span>&#160;    <span class="comment">// Match this pattern so that we can generate simpler code:</span></div><div class="line"><a name="l06906"></a><span class="lineno"> 6906</span>&#160;    <span class="comment">//</span></div><div class="line"><a name="l06907"></a><span class="lineno"> 6907</span>&#160;    <span class="comment">//   %a = ...</span></div><div class="line"><a name="l06908"></a><span class="lineno"> 6908</span>&#160;    <span class="comment">//   %b = and i32 %a, 2</span></div><div class="line"><a name="l06909"></a><span class="lineno"> 6909</span>&#160;    <span class="comment">//   %c = srl i32 %b, 1</span></div><div class="line"><a name="l06910"></a><span class="lineno"> 6910</span>&#160;    <span class="comment">//   brcond i32 %c ...</span></div><div class="line"><a name="l06911"></a><span class="lineno"> 6911</span>&#160;    <span class="comment">//</span></div><div class="line"><a name="l06912"></a><span class="lineno"> 6912</span>&#160;    <span class="comment">// into</span></div><div class="line"><a name="l06913"></a><span class="lineno"> 6913</span>&#160;    <span class="comment">//</span></div><div class="line"><a name="l06914"></a><span class="lineno"> 6914</span>&#160;    <span class="comment">//   %a = ...</span></div><div class="line"><a name="l06915"></a><span class="lineno"> 6915</span>&#160;    <span class="comment">//   %b = and i32 %a, 2</span></div><div class="line"><a name="l06916"></a><span class="lineno"> 6916</span>&#160;    <span class="comment">//   %c = setcc eq %b, 0</span></div><div class="line"><a name="l06917"></a><span class="lineno"> 6917</span>&#160;    <span class="comment">//   brcond %c ...</span></div><div class="line"><a name="l06918"></a><span class="lineno"> 6918</span>&#160;    <span class="comment">//</span></div><div class="line"><a name="l06919"></a><span class="lineno"> 6919</span>&#160;    <span class="comment">// This applies only when the AND constant value has one bit set and the</span></div><div class="line"><a name="l06920"></a><span class="lineno"> 6920</span>&#160;    <span class="comment">// SRL constant is equal to the log2 of the AND constant. The back-end is</span></div><div class="line"><a name="l06921"></a><span class="lineno"> 6921</span>&#160;    <span class="comment">// smart enough to convert the result into a TEST/JMP sequence.</span></div><div class="line"><a name="l06922"></a><span class="lineno"> 6922</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Op0 = N1.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0);</div><div class="line"><a name="l06923"></a><span class="lineno"> 6923</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Op1 = N1.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1);</div><div class="line"><a name="l06924"></a><span class="lineno"> 6924</span>&#160;</div><div class="line"><a name="l06925"></a><span class="lineno"> 6925</span>&#160;    <span class="keywordflow">if</span> (Op0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ac513a7da1bf74fb3e3c594da8534f2d2">ISD::AND</a> &amp;&amp;</div><div class="line"><a name="l06926"></a><span class="lineno"> 6926</span>&#160;        Op1.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110aac2f0a84dd2aa5ee4c3f1385e9565f5e">ISD::Constant</a>) {</div><div class="line"><a name="l06927"></a><span class="lineno"> 6927</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> AndOp1 = Op0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1);</div><div class="line"><a name="l06928"></a><span class="lineno"> 6928</span>&#160;</div><div class="line"><a name="l06929"></a><span class="lineno"> 6929</span>&#160;      <span class="keywordflow">if</span> (AndOp1.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110aac2f0a84dd2aa5ee4c3f1385e9565f5e">ISD::Constant</a>) {</div><div class="line"><a name="l06930"></a><span class="lineno"> 6930</span>&#160;        <span class="keyword">const</span> <a class="code" href="classllvm_1_1APInt.html">APInt</a> &amp;AndConst = cast&lt;ConstantSDNode&gt;(AndOp1)-&gt;getAPIntValue();</div><div class="line"><a name="l06931"></a><span class="lineno"> 6931</span>&#160;</div><div class="line"><a name="l06932"></a><span class="lineno"> 6932</span>&#160;        <span class="keywordflow">if</span> (AndConst.<a class="code" href="classllvm_1_1APInt.html#af3deb6522c4fe2043fe07af2ec90190c">isPowerOf2</a>() &amp;&amp;</div><div class="line"><a name="l06933"></a><span class="lineno"> 6933</span>&#160;            cast&lt;ConstantSDNode&gt;(Op1)-&gt;getAPIntValue()==AndConst.<a class="code" href="classllvm_1_1APInt.html#a474f562a4871689af74b0fd1ae42daa1">logBase2</a>()) {</div><div class="line"><a name="l06934"></a><span class="lineno"> 6934</span>&#160;          <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> SetCC =</div><div class="line"><a name="l06935"></a><span class="lineno"> 6935</span>&#160;            DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a2650d530046f9ddfc602dc7383ba0730">getSetCC</a>(<a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N),</div><div class="line"><a name="l06936"></a><span class="lineno"> 6936</span>&#160;                         getSetCCResultType(Op0.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>()),</div><div class="line"><a name="l06937"></a><span class="lineno"> 6937</span>&#160;                         Op0, DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(0, Op0.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>()),</div><div class="line"><a name="l06938"></a><span class="lineno"> 6938</span>&#160;                         <a class="code" href="namespacellvm_1_1ISD.html#ac3c3cf58d6d631af6a172457304d3d07a2887cc8b39915a25180f4bca0026a15e">ISD::SETNE</a>);</div><div class="line"><a name="l06939"></a><span class="lineno"> 6939</span>&#160;</div><div class="line"><a name="l06940"></a><span class="lineno"> 6940</span>&#160;          <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> NewBRCond = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ae8167e4f6fa1bfb30f074ba620b81782">ISD::BRCOND</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N),</div><div class="line"><a name="l06941"></a><span class="lineno"> 6941</span>&#160;                                          <a class="code" href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50ca62a222acce6360abd2726719fabc2797">MVT::Other</a>, Chain, SetCC, N2);</div><div class="line"><a name="l06942"></a><span class="lineno"> 6942</span>&#160;          <span class="comment">// Don&#39;t add the new BRCond into the worklist or else SimplifySelectCC</span></div><div class="line"><a name="l06943"></a><span class="lineno"> 6943</span>&#160;          <span class="comment">// will convert it back to (X &amp; C1) &gt;&gt; C2.</span></div><div class="line"><a name="l06944"></a><span class="lineno"> 6944</span>&#160;          CombineTo(N, NewBRCond, <span class="keyword">false</span>);</div><div class="line"><a name="l06945"></a><span class="lineno"> 6945</span>&#160;          <span class="comment">// Truncate is dead.</span></div><div class="line"><a name="l06946"></a><span class="lineno"> 6946</span>&#160;          <span class="keywordflow">if</span> (Trunc) {</div><div class="line"><a name="l06947"></a><span class="lineno"> 6947</span>&#160;            removeFromWorkList(Trunc);</div><div class="line"><a name="l06948"></a><span class="lineno"> 6948</span>&#160;            DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a5f57dcbedc16dced31c61f7bbbb06ded">DeleteNode</a>(Trunc);</div><div class="line"><a name="l06949"></a><span class="lineno"> 6949</span>&#160;          }</div><div class="line"><a name="l06950"></a><span class="lineno"> 6950</span>&#160;          <span class="comment">// Replace the uses of SRL with SETCC</span></div><div class="line"><a name="l06951"></a><span class="lineno"> 6951</span>&#160;          WorkListRemover DeadNodes(*<span class="keyword">this</span>);</div><div class="line"><a name="l06952"></a><span class="lineno"> 6952</span>&#160;          DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#ac630ccda26fea2f45afa3fb89bc1a8f4">ReplaceAllUsesOfValueWith</a>(N1, SetCC);</div><div class="line"><a name="l06953"></a><span class="lineno"> 6953</span>&#160;          removeFromWorkList(N1.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l06954"></a><span class="lineno"> 6954</span>&#160;          DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a5f57dcbedc16dced31c61f7bbbb06ded">DeleteNode</a>(N1.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l06955"></a><span class="lineno"> 6955</span>&#160;          <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(N, 0);   <span class="comment">// Return N so it doesn&#39;t get rechecked!</span></div><div class="line"><a name="l06956"></a><span class="lineno"> 6956</span>&#160;        }</div><div class="line"><a name="l06957"></a><span class="lineno"> 6957</span>&#160;      }</div><div class="line"><a name="l06958"></a><span class="lineno"> 6958</span>&#160;    }</div><div class="line"><a name="l06959"></a><span class="lineno"> 6959</span>&#160;</div><div class="line"><a name="l06960"></a><span class="lineno"> 6960</span>&#160;    <span class="keywordflow">if</span> (Trunc)</div><div class="line"><a name="l06961"></a><span class="lineno"> 6961</span>&#160;      <span class="comment">// Restore N1 if the above transformation doesn&#39;t match.</span></div><div class="line"><a name="l06962"></a><span class="lineno"> 6962</span>&#160;      N1 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(1);</div><div class="line"><a name="l06963"></a><span class="lineno"> 6963</span>&#160;  }</div><div class="line"><a name="l06964"></a><span class="lineno"> 6964</span>&#160;</div><div class="line"><a name="l06965"></a><span class="lineno"> 6965</span>&#160;  <span class="comment">// Transform br(xor(x, y)) -&gt; br(x != y)</span></div><div class="line"><a name="l06966"></a><span class="lineno"> 6966</span>&#160;  <span class="comment">// Transform br(xor(xor(x,y), 1)) -&gt; br (x == y)</span></div><div class="line"><a name="l06967"></a><span class="lineno"> 6967</span>&#160;  <span class="keywordflow">if</span> (N1.<a class="code" href="classllvm_1_1SDValue.html#a97b0f24f3e52f030830fca6fbfcbd37d">hasOneUse</a>() &amp;&amp; N1.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a92febb83e6ba116eb7aae8e7e3f70cc1">ISD::XOR</a>) {</div><div class="line"><a name="l06968"></a><span class="lineno"> 6968</span>&#160;    <a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *TheXor = N1.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>();</div><div class="line"><a name="l06969"></a><span class="lineno"> 6969</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Op0 = TheXor-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0);</div><div class="line"><a name="l06970"></a><span class="lineno"> 6970</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Op1 = TheXor-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(1);</div><div class="line"><a name="l06971"></a><span class="lineno"> 6971</span>&#160;    <span class="keywordflow">if</span> (Op0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == Op1.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>()) {</div><div class="line"><a name="l06972"></a><span class="lineno"> 6972</span>&#160;      <span class="comment">// Avoid missing important xor optimizations.</span></div><div class="line"><a name="l06973"></a><span class="lineno"> 6973</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Tmp = visitXOR(TheXor);</div><div class="line"><a name="l06974"></a><span class="lineno"> 6974</span>&#160;      <span class="keywordflow">if</span> (Tmp.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()) {</div><div class="line"><a name="l06975"></a><span class="lineno"> 6975</span>&#160;        <span class="keywordflow">if</span> (Tmp.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>() != TheXor) {</div><div class="line"><a name="l06976"></a><span class="lineno"> 6976</span>&#160;          <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;\nReplacing.8 &quot;</span>;</div><div class="line"><a name="l06977"></a><span class="lineno"> 6977</span>&#160;                TheXor-&gt;<a class="code" href="classllvm_1_1SDNode.html#a535ca517df1b4ae62e75475141e65787">dump</a>(&amp;DAG);</div><div class="line"><a name="l06978"></a><span class="lineno"> 6978</span>&#160;                <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;\nWith: &quot;</span>;</div><div class="line"><a name="l06979"></a><span class="lineno"> 6979</span>&#160;                Tmp.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()-&gt;<a class="code" href="classllvm_1_1SDNode.html#a535ca517df1b4ae62e75475141e65787">dump</a>(&amp;DAG);</div><div class="line"><a name="l06980"></a><span class="lineno"> 6980</span>&#160;                <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>);</div><div class="line"><a name="l06981"></a><span class="lineno"> 6981</span>&#160;          WorkListRemover DeadNodes(*<span class="keyword">this</span>);</div><div class="line"><a name="l06982"></a><span class="lineno"> 6982</span>&#160;          DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#ac630ccda26fea2f45afa3fb89bc1a8f4">ReplaceAllUsesOfValueWith</a>(N1, Tmp);</div><div class="line"><a name="l06983"></a><span class="lineno"> 6983</span>&#160;          removeFromWorkList(TheXor);</div><div class="line"><a name="l06984"></a><span class="lineno"> 6984</span>&#160;          DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a5f57dcbedc16dced31c61f7bbbb06ded">DeleteNode</a>(TheXor);</div><div class="line"><a name="l06985"></a><span class="lineno"> 6985</span>&#160;          <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ae8167e4f6fa1bfb30f074ba620b81782">ISD::BRCOND</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N),</div><div class="line"><a name="l06986"></a><span class="lineno"> 6986</span>&#160;                             <a class="code" href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50ca62a222acce6360abd2726719fabc2797">MVT::Other</a>, Chain, Tmp, N2);</div><div class="line"><a name="l06987"></a><span class="lineno"> 6987</span>&#160;        }</div><div class="line"><a name="l06988"></a><span class="lineno"> 6988</span>&#160;</div><div class="line"><a name="l06989"></a><span class="lineno"> 6989</span>&#160;        <span class="comment">// visitXOR has changed XOR&#39;s operands or replaced the XOR completely,</span></div><div class="line"><a name="l06990"></a><span class="lineno"> 6990</span>&#160;        <span class="comment">// bail out.</span></div><div class="line"><a name="l06991"></a><span class="lineno"> 6991</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(N, 0);</div><div class="line"><a name="l06992"></a><span class="lineno"> 6992</span>&#160;      }</div><div class="line"><a name="l06993"></a><span class="lineno"> 6993</span>&#160;    }</div><div class="line"><a name="l06994"></a><span class="lineno"> 6994</span>&#160;</div><div class="line"><a name="l06995"></a><span class="lineno"> 6995</span>&#160;    <span class="keywordflow">if</span> (Op0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() != <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a0158ee47dfa868be5d28e2cbef70d5d0">ISD::SETCC</a> &amp;&amp; Op1.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() != <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a0158ee47dfa868be5d28e2cbef70d5d0">ISD::SETCC</a>) {</div><div class="line"><a name="l06996"></a><span class="lineno"> 6996</span>&#160;      <span class="keywordtype">bool</span> Equal = <span class="keyword">false</span>;</div><div class="line"><a name="l06997"></a><span class="lineno"> 6997</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a> *RHSCI = dyn_cast&lt;ConstantSDNode&gt;(Op0))</div><div class="line"><a name="l06998"></a><span class="lineno"> 6998</span>&#160;        <span class="keywordflow">if</span> (RHSCI-&gt;getAPIntValue() == 1 &amp;&amp; Op0.<a class="code" href="classllvm_1_1SDValue.html#a97b0f24f3e52f030830fca6fbfcbd37d">hasOneUse</a>() &amp;&amp;</div><div class="line"><a name="l06999"></a><span class="lineno"> 6999</span>&#160;            Op0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a92febb83e6ba116eb7aae8e7e3f70cc1">ISD::XOR</a>) {</div><div class="line"><a name="l07000"></a><span class="lineno"> 7000</span>&#160;          TheXor = Op0.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>();</div><div class="line"><a name="l07001"></a><span class="lineno"> 7001</span>&#160;          Equal = <span class="keyword">true</span>;</div><div class="line"><a name="l07002"></a><span class="lineno"> 7002</span>&#160;        }</div><div class="line"><a name="l07003"></a><span class="lineno"> 7003</span>&#160;</div><div class="line"><a name="l07004"></a><span class="lineno"> 7004</span>&#160;      <a class="code" href="structllvm_1_1EVT.html">EVT</a> SetCCVT = N1.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>();</div><div class="line"><a name="l07005"></a><span class="lineno"> 7005</span>&#160;      <span class="keywordflow">if</span> (LegalTypes)</div><div class="line"><a name="l07006"></a><span class="lineno"> 7006</span>&#160;        SetCCVT = getSetCCResultType(SetCCVT);</div><div class="line"><a name="l07007"></a><span class="lineno"> 7007</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> SetCC = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a2650d530046f9ddfc602dc7383ba0730">getSetCC</a>(<a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(TheXor),</div><div class="line"><a name="l07008"></a><span class="lineno"> 7008</span>&#160;                                   SetCCVT,</div><div class="line"><a name="l07009"></a><span class="lineno"> 7009</span>&#160;                                   Op0, Op1,</div><div class="line"><a name="l07010"></a><span class="lineno"> 7010</span>&#160;                                   Equal ? <a class="code" href="namespacellvm_1_1ISD.html#ac3c3cf58d6d631af6a172457304d3d07ae2e6a5e32087b9f65bd51585a6a5afb4">ISD::SETEQ</a> : <a class="code" href="namespacellvm_1_1ISD.html#ac3c3cf58d6d631af6a172457304d3d07a2887cc8b39915a25180f4bca0026a15e">ISD::SETNE</a>);</div><div class="line"><a name="l07011"></a><span class="lineno"> 7011</span>&#160;      <span class="comment">// Replace the uses of XOR with SETCC</span></div><div class="line"><a name="l07012"></a><span class="lineno"> 7012</span>&#160;      WorkListRemover DeadNodes(*<span class="keyword">this</span>);</div><div class="line"><a name="l07013"></a><span class="lineno"> 7013</span>&#160;      DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#ac630ccda26fea2f45afa3fb89bc1a8f4">ReplaceAllUsesOfValueWith</a>(N1, SetCC);</div><div class="line"><a name="l07014"></a><span class="lineno"> 7014</span>&#160;      removeFromWorkList(N1.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l07015"></a><span class="lineno"> 7015</span>&#160;      DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a5f57dcbedc16dced31c61f7bbbb06ded">DeleteNode</a>(N1.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l07016"></a><span class="lineno"> 7016</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ae8167e4f6fa1bfb30f074ba620b81782">ISD::BRCOND</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N),</div><div class="line"><a name="l07017"></a><span class="lineno"> 7017</span>&#160;                         <a class="code" href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50ca62a222acce6360abd2726719fabc2797">MVT::Other</a>, Chain, SetCC, N2);</div><div class="line"><a name="l07018"></a><span class="lineno"> 7018</span>&#160;    }</div><div class="line"><a name="l07019"></a><span class="lineno"> 7019</span>&#160;  }</div><div class="line"><a name="l07020"></a><span class="lineno"> 7020</span>&#160;</div><div class="line"><a name="l07021"></a><span class="lineno"> 7021</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l07022"></a><span class="lineno"> 7022</span>&#160;}</div><div class="line"><a name="l07023"></a><span class="lineno"> 7023</span>&#160;</div><div class="line"><a name="l07024"></a><span class="lineno"> 7024</span>&#160;<span class="comment">// Operand List for BR_CC: Chain, CondCC, CondLHS, CondRHS, DestBB.</span></div><div class="line"><a name="l07025"></a><span class="lineno"> 7025</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l07026"></a><span class="lineno"> 7026</span>&#160;<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::visitBR_CC(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N) {</div><div class="line"><a name="l07027"></a><span class="lineno"> 7027</span>&#160;  <a class="code" href="classllvm_1_1CondCodeSDNode.html">CondCodeSDNode</a> *<a class="code" href="Target_2PowerPC_2README_8txt.html#afc7ca55ad1da67847ecd4b99ef64dc84">CC</a> = cast&lt;CondCodeSDNode&gt;(N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(1));</div><div class="line"><a name="l07028"></a><span class="lineno"> 7028</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> CondLHS = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(2), CondRHS = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(3);</div><div class="line"><a name="l07029"></a><span class="lineno"> 7029</span>&#160;</div><div class="line"><a name="l07030"></a><span class="lineno"> 7030</span>&#160;  <span class="comment">// If N is a constant we could fold this into a fallthrough or unconditional</span></div><div class="line"><a name="l07031"></a><span class="lineno"> 7031</span>&#160;  <span class="comment">// branch. However that doesn&#39;t happen very often in normal code, because</span></div><div class="line"><a name="l07032"></a><span class="lineno"> 7032</span>&#160;  <span class="comment">// Instcombine/SimplifyCFG should have handled the available opportunities.</span></div><div class="line"><a name="l07033"></a><span class="lineno"> 7033</span>&#160;  <span class="comment">// If we did this folding here, it would be necessary to update the</span></div><div class="line"><a name="l07034"></a><span class="lineno"> 7034</span>&#160;  <span class="comment">// MachineBasicBlock CFG, which is awkward.</span></div><div class="line"><a name="l07035"></a><span class="lineno"> 7035</span>&#160;</div><div class="line"><a name="l07036"></a><span class="lineno"> 7036</span>&#160;  <span class="comment">// Use SimplifySetCC to simplify SETCC&#39;s.</span></div><div class="line"><a name="l07037"></a><span class="lineno"> 7037</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Simp = SimplifySetCC(getSetCCResultType(CondLHS.getValueType()),</div><div class="line"><a name="l07038"></a><span class="lineno"> 7038</span>&#160;                               CondLHS, CondRHS, CC-&gt;<a class="code" href="classllvm_1_1CondCodeSDNode.html#a6c3eefd310631cda3dd266e224bc1492">get</a>(), <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N),</div><div class="line"><a name="l07039"></a><span class="lineno"> 7039</span>&#160;                               <span class="keyword">false</span>);</div><div class="line"><a name="l07040"></a><span class="lineno"> 7040</span>&#160;  <span class="keywordflow">if</span> (Simp.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()) AddToWorkList(Simp.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l07041"></a><span class="lineno"> 7041</span>&#160;</div><div class="line"><a name="l07042"></a><span class="lineno"> 7042</span>&#160;  <span class="comment">// fold to a simpler setcc</span></div><div class="line"><a name="l07043"></a><span class="lineno"> 7043</span>&#160;  <span class="keywordflow">if</span> (Simp.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>() &amp;&amp; Simp.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a0158ee47dfa868be5d28e2cbef70d5d0">ISD::SETCC</a>)</div><div class="line"><a name="l07044"></a><span class="lineno"> 7044</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a6d5e322b263f0d5ea4204efafc1d78bb">ISD::BR_CC</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), <a class="code" href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50ca62a222acce6360abd2726719fabc2797">MVT::Other</a>,</div><div class="line"><a name="l07045"></a><span class="lineno"> 7045</span>&#160;                       N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0), Simp.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(2),</div><div class="line"><a name="l07046"></a><span class="lineno"> 7046</span>&#160;                       Simp.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0), Simp.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1),</div><div class="line"><a name="l07047"></a><span class="lineno"> 7047</span>&#160;                       N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(4));</div><div class="line"><a name="l07048"></a><span class="lineno"> 7048</span>&#160;</div><div class="line"><a name="l07049"></a><span class="lineno"> 7049</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l07050"></a><span class="lineno"> 7050</span>&#160;}</div><div class="line"><a name="l07051"></a><span class="lineno"> 7051</span>&#160;<span class="comment"></span></div><div class="line"><a name="l07052"></a><span class="lineno"> 7052</span>&#160;<span class="comment">/// canFoldInAddressingMode - Return true if &#39;Use&#39; is a load or a store that</span></div><div class="line"><a name="l07053"></a><span class="lineno"> 7053</span>&#160;<span class="comment">/// uses N as its base pointer and that N may be folded in the load / store</span></div><div class="line"><a name="l07054"></a><span class="lineno"> 7054</span>&#160;<span class="comment">/// addressing mode.</span></div><div class="line"><a name="l07055"></a><span class="lineno"><a class="line" href="DAGCombiner_8cpp.html#a631357f1796c922cce73dae4bff6018f"> 7055</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="DAGCombiner_8cpp.html#a631357f1796c922cce73dae4bff6018f">canFoldInAddressingMode</a>(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N, <a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *<a class="code" href="classllvm_1_1Use.html">Use</a>,</div><div class="line"><a name="l07056"></a><span class="lineno"> 7056</span>&#160;                                    <a class="code" href="classllvm_1_1SelectionDAG.html">SelectionDAG</a> &amp;DAG,</div><div class="line"><a name="l07057"></a><span class="lineno"> 7057</span>&#160;                                    <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetLowering.html">TargetLowering</a> &amp;TLI) {</div><div class="line"><a name="l07058"></a><span class="lineno"> 7058</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> VT;</div><div class="line"><a name="l07059"></a><span class="lineno"> 7059</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1LoadSDNode.html">LoadSDNode</a> *<a class="code" href="namespacellvm_1_1A64DB.html#a6fce8157775f3ec93f326b52b0f1e0f5ad61b145eb8cbab18feb1b2e2ce269a7e">LD</a>  = dyn_cast&lt;LoadSDNode&gt;(Use)) {</div><div class="line"><a name="l07060"></a><span class="lineno"> 7060</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1A64DB.html#a6fce8157775f3ec93f326b52b0f1e0f5ad61b145eb8cbab18feb1b2e2ce269a7e">LD</a>-&gt;isIndexed() || <a class="code" href="namespacellvm_1_1A64DB.html#a6fce8157775f3ec93f326b52b0f1e0f5ad61b145eb8cbab18feb1b2e2ce269a7e">LD</a>-&gt;getBasePtr().getNode() != <a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>)</div><div class="line"><a name="l07061"></a><span class="lineno"> 7061</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l07062"></a><span class="lineno"> 7062</span>&#160;    VT = Use-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(0);</div><div class="line"><a name="l07063"></a><span class="lineno"> 7063</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1StoreSDNode.html">StoreSDNode</a> *<a class="code" href="namespacellvm_1_1A64DB.html#a6fce8157775f3ec93f326b52b0f1e0f5a4916e736d6b7cc68359b39d5eb50f6db">ST</a>  = dyn_cast&lt;StoreSDNode&gt;(Use)) {</div><div class="line"><a name="l07064"></a><span class="lineno"> 7064</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1A64DB.html#a6fce8157775f3ec93f326b52b0f1e0f5a4916e736d6b7cc68359b39d5eb50f6db">ST</a>-&gt;isIndexed() || <a class="code" href="namespacellvm_1_1A64DB.html#a6fce8157775f3ec93f326b52b0f1e0f5a4916e736d6b7cc68359b39d5eb50f6db">ST</a>-&gt;getBasePtr().getNode() != <a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>)</div><div class="line"><a name="l07065"></a><span class="lineno"> 7065</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l07066"></a><span class="lineno"> 7066</span>&#160;    VT = <a class="code" href="namespacellvm_1_1A64DB.html#a6fce8157775f3ec93f326b52b0f1e0f5a4916e736d6b7cc68359b39d5eb50f6db">ST</a>-&gt;getValue().getValueType();</div><div class="line"><a name="l07067"></a><span class="lineno"> 7067</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l07068"></a><span class="lineno"> 7068</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l07069"></a><span class="lineno"> 7069</span>&#160;</div><div class="line"><a name="l07070"></a><span class="lineno"> 7070</span>&#160;  <a class="code" href="namespacellvm_1_1ARMII.html#ace99f086a3cd38c7477a8f038dae7ff4">TargetLowering::AddrMode</a> AM;</div><div class="line"><a name="l07071"></a><span class="lineno"> 7071</span>&#160;  <span class="keywordflow">if</span> (N-&gt;<a class="code" href="classllvm_1_1SDNode.html#af0d328f3f61168f4ea7d6e4044af4f97">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a269996b43a1f3e1d1f84a70fd4387535">ISD::ADD</a>) {</div><div class="line"><a name="l07072"></a><span class="lineno"> 7072</span>&#160;    <a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a> *Offset = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a>&gt;(N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(1));</div><div class="line"><a name="l07073"></a><span class="lineno"> 7073</span>&#160;    <span class="keywordflow">if</span> (Offset)</div><div class="line"><a name="l07074"></a><span class="lineno"> 7074</span>&#160;      <span class="comment">// [reg +/- imm]</span></div><div class="line"><a name="l07075"></a><span class="lineno"> 7075</span>&#160;      AM.BaseOffs = Offset-&gt;<a class="code" href="classllvm_1_1ConstantSDNode.html#ae52ea754f0f064b6440e99103abea366">getSExtValue</a>();</div><div class="line"><a name="l07076"></a><span class="lineno"> 7076</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l07077"></a><span class="lineno"> 7077</span>&#160;      <span class="comment">// [reg +/- reg]</span></div><div class="line"><a name="l07078"></a><span class="lineno"> 7078</span>&#160;      AM.Scale = 1;</div><div class="line"><a name="l07079"></a><span class="lineno"> 7079</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (N-&gt;<a class="code" href="classllvm_1_1SDNode.html#af0d328f3f61168f4ea7d6e4044af4f97">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9fa617e5567c3c2638938f7b9ddc3f1c">ISD::SUB</a>) {</div><div class="line"><a name="l07080"></a><span class="lineno"> 7080</span>&#160;    <a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a> *Offset = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a>&gt;(N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(1));</div><div class="line"><a name="l07081"></a><span class="lineno"> 7081</span>&#160;    <span class="keywordflow">if</span> (Offset)</div><div class="line"><a name="l07082"></a><span class="lineno"> 7082</span>&#160;      <span class="comment">// [reg +/- imm]</span></div><div class="line"><a name="l07083"></a><span class="lineno"> 7083</span>&#160;      AM.BaseOffs = -Offset-&gt;<a class="code" href="classllvm_1_1ConstantSDNode.html#ae52ea754f0f064b6440e99103abea366">getSExtValue</a>();</div><div class="line"><a name="l07084"></a><span class="lineno"> 7084</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l07085"></a><span class="lineno"> 7085</span>&#160;      <span class="comment">// [reg +/- reg]</span></div><div class="line"><a name="l07086"></a><span class="lineno"> 7086</span>&#160;      AM.Scale = 1;</div><div class="line"><a name="l07087"></a><span class="lineno"> 7087</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l07088"></a><span class="lineno"> 7088</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l07089"></a><span class="lineno"> 7089</span>&#160;</div><div class="line"><a name="l07090"></a><span class="lineno"> 7090</span>&#160;  <span class="keywordflow">return</span> TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#ab6b8ec6add84f851e922b6e5844ca1a1">isLegalAddressingMode</a>(AM, VT.<a class="code" href="structllvm_1_1EVT.html#a226345d0c8262e9469d30a993d1656ff">getTypeForEVT</a>(*DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a39c6dff47b8dbd25cfaf6336c7056077">getContext</a>()));</div><div class="line"><a name="l07091"></a><span class="lineno"> 7091</span>&#160;}</div><div class="line"><a name="l07092"></a><span class="lineno"> 7092</span>&#160;<span class="comment"></span></div><div class="line"><a name="l07093"></a><span class="lineno"> 7093</span>&#160;<span class="comment">/// CombineToPreIndexedLoadStore - Try turning a load / store into a</span></div><div class="line"><a name="l07094"></a><span class="lineno"> 7094</span>&#160;<span class="comment">/// pre-indexed load / store when the base pointer is an add or subtract</span></div><div class="line"><a name="l07095"></a><span class="lineno"> 7095</span>&#160;<span class="comment">/// and it has other uses besides the load / store. After the</span></div><div class="line"><a name="l07096"></a><span class="lineno"> 7096</span>&#160;<span class="comment">/// transformation, the new indexed load / store has effectively folded</span></div><div class="line"><a name="l07097"></a><span class="lineno"> 7097</span>&#160;<span class="comment">/// the add / subtract in and all of its other uses are redirected to the</span></div><div class="line"><a name="l07098"></a><span class="lineno"> 7098</span>&#160;<span class="comment">/// new load / store.</span></div><div class="line"><a name="l07099"></a><span class="lineno"> 7099</span>&#160;<span class="comment"></span><span class="keywordtype">bool</span> DAGCombiner::CombineToPreIndexedLoadStore(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N) {</div><div class="line"><a name="l07100"></a><span class="lineno"> 7100</span>&#160;  <span class="keywordflow">if</span> (Level &lt; <a class="code" href="namespacellvm.html#aa6d856e4879bb775617f8c3634773b7aa7fbaa966e5d5ac3bf03ba617b73bff5c">AfterLegalizeDAG</a>)</div><div class="line"><a name="l07101"></a><span class="lineno"> 7101</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l07102"></a><span class="lineno"> 7102</span>&#160;</div><div class="line"><a name="l07103"></a><span class="lineno"> 7103</span>&#160;  <span class="keywordtype">bool</span> isLoad = <span class="keyword">true</span>;</div><div class="line"><a name="l07104"></a><span class="lineno"> 7104</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Ptr;</div><div class="line"><a name="l07105"></a><span class="lineno"> 7105</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> VT;</div><div class="line"><a name="l07106"></a><span class="lineno"> 7106</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1LoadSDNode.html">LoadSDNode</a> *<a class="code" href="namespacellvm_1_1A64DB.html#a6fce8157775f3ec93f326b52b0f1e0f5ad61b145eb8cbab18feb1b2e2ce269a7e">LD</a>  = dyn_cast&lt;LoadSDNode&gt;(N)) {</div><div class="line"><a name="l07107"></a><span class="lineno"> 7107</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1A64DB.html#a6fce8157775f3ec93f326b52b0f1e0f5ad61b145eb8cbab18feb1b2e2ce269a7e">LD</a>-&gt;isIndexed())</div><div class="line"><a name="l07108"></a><span class="lineno"> 7108</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l07109"></a><span class="lineno"> 7109</span>&#160;    VT = <a class="code" href="namespacellvm_1_1A64DB.html#a6fce8157775f3ec93f326b52b0f1e0f5ad61b145eb8cbab18feb1b2e2ce269a7e">LD</a>-&gt;getMemoryVT();</div><div class="line"><a name="l07110"></a><span class="lineno"> 7110</span>&#160;    <span class="keywordflow">if</span> (!TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a9c8b7aaed941ee853da98aafd6739af6">isIndexedLoadLegal</a>(<a class="code" href="namespacellvm_1_1ISD.html#abee7ecb577fcade34eb16ccb7f503e31ab5bb854fadd42503c849c4a48d7f3d90">ISD::PRE_INC</a>, VT) &amp;&amp;</div><div class="line"><a name="l07111"></a><span class="lineno"> 7111</span>&#160;        !TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a9c8b7aaed941ee853da98aafd6739af6">isIndexedLoadLegal</a>(<a class="code" href="namespacellvm_1_1ISD.html#abee7ecb577fcade34eb16ccb7f503e31a57c3822f99653c422d5a21206adc6e42">ISD::PRE_DEC</a>, VT))</div><div class="line"><a name="l07112"></a><span class="lineno"> 7112</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l07113"></a><span class="lineno"> 7113</span>&#160;    Ptr = <a class="code" href="namespacellvm_1_1A64DB.html#a6fce8157775f3ec93f326b52b0f1e0f5ad61b145eb8cbab18feb1b2e2ce269a7e">LD</a>-&gt;getBasePtr();</div><div class="line"><a name="l07114"></a><span class="lineno"> 7114</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1StoreSDNode.html">StoreSDNode</a> *<a class="code" href="namespacellvm_1_1A64DB.html#a6fce8157775f3ec93f326b52b0f1e0f5a4916e736d6b7cc68359b39d5eb50f6db">ST</a>  = dyn_cast&lt;StoreSDNode&gt;(N)) {</div><div class="line"><a name="l07115"></a><span class="lineno"> 7115</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1A64DB.html#a6fce8157775f3ec93f326b52b0f1e0f5a4916e736d6b7cc68359b39d5eb50f6db">ST</a>-&gt;isIndexed())</div><div class="line"><a name="l07116"></a><span class="lineno"> 7116</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l07117"></a><span class="lineno"> 7117</span>&#160;    VT = <a class="code" href="namespacellvm_1_1A64DB.html#a6fce8157775f3ec93f326b52b0f1e0f5a4916e736d6b7cc68359b39d5eb50f6db">ST</a>-&gt;getMemoryVT();</div><div class="line"><a name="l07118"></a><span class="lineno"> 7118</span>&#160;    <span class="keywordflow">if</span> (!TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a4fe606f87214ac58150a6c99bde8db84">isIndexedStoreLegal</a>(<a class="code" href="namespacellvm_1_1ISD.html#abee7ecb577fcade34eb16ccb7f503e31ab5bb854fadd42503c849c4a48d7f3d90">ISD::PRE_INC</a>, VT) &amp;&amp;</div><div class="line"><a name="l07119"></a><span class="lineno"> 7119</span>&#160;        !TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a4fe606f87214ac58150a6c99bde8db84">isIndexedStoreLegal</a>(<a class="code" href="namespacellvm_1_1ISD.html#abee7ecb577fcade34eb16ccb7f503e31a57c3822f99653c422d5a21206adc6e42">ISD::PRE_DEC</a>, VT))</div><div class="line"><a name="l07120"></a><span class="lineno"> 7120</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l07121"></a><span class="lineno"> 7121</span>&#160;    Ptr = <a class="code" href="namespacellvm_1_1A64DB.html#a6fce8157775f3ec93f326b52b0f1e0f5a4916e736d6b7cc68359b39d5eb50f6db">ST</a>-&gt;getBasePtr();</div><div class="line"><a name="l07122"></a><span class="lineno"> 7122</span>&#160;    isLoad = <span class="keyword">false</span>;</div><div class="line"><a name="l07123"></a><span class="lineno"> 7123</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l07124"></a><span class="lineno"> 7124</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l07125"></a><span class="lineno"> 7125</span>&#160;  }</div><div class="line"><a name="l07126"></a><span class="lineno"> 7126</span>&#160;</div><div class="line"><a name="l07127"></a><span class="lineno"> 7127</span>&#160;  <span class="comment">// If the pointer is not an add/sub, or if it doesn&#39;t have multiple uses, bail</span></div><div class="line"><a name="l07128"></a><span class="lineno"> 7128</span>&#160;  <span class="comment">// out.  There is no reason to make this a preinc/predec.</span></div><div class="line"><a name="l07129"></a><span class="lineno"> 7129</span>&#160;  <span class="keywordflow">if</span> ((Ptr.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() != <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a269996b43a1f3e1d1f84a70fd4387535">ISD::ADD</a> &amp;&amp; Ptr.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() != <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9fa617e5567c3c2638938f7b9ddc3f1c">ISD::SUB</a>) ||</div><div class="line"><a name="l07130"></a><span class="lineno"> 7130</span>&#160;      Ptr.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()-&gt;<a class="code" href="classllvm_1_1SDNode.html#a52753947fce3a01b1c18dd4713c587e8">hasOneUse</a>())</div><div class="line"><a name="l07131"></a><span class="lineno"> 7131</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l07132"></a><span class="lineno"> 7132</span>&#160;</div><div class="line"><a name="l07133"></a><span class="lineno"> 7133</span>&#160;  <span class="comment">// Ask the target to do addressing mode selection.</span></div><div class="line"><a name="l07134"></a><span class="lineno"> 7134</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> BasePtr;</div><div class="line"><a name="l07135"></a><span class="lineno"> 7135</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Offset;</div><div class="line"><a name="l07136"></a><span class="lineno"> 7136</span>&#160;  <a class="code" href="namespacellvm_1_1ISD.html#abee7ecb577fcade34eb16ccb7f503e31">ISD::MemIndexedMode</a> AM = <a class="code" href="namespacellvm_1_1ISD.html#abee7ecb577fcade34eb16ccb7f503e31ade1c53e7b8a373e22ec53ff7bcbace9f">ISD::UNINDEXED</a>;</div><div class="line"><a name="l07137"></a><span class="lineno"> 7137</span>&#160;  <span class="keywordflow">if</span> (!TLI.<a class="code" href="classllvm_1_1TargetLowering.html#a0494f569df118d504e92cbe003d96319">getPreIndexedAddressParts</a>(N, BasePtr, Offset, AM, DAG))</div><div class="line"><a name="l07138"></a><span class="lineno"> 7138</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l07139"></a><span class="lineno"> 7139</span>&#160;</div><div class="line"><a name="l07140"></a><span class="lineno"> 7140</span>&#160;  <span class="comment">// Backends without true r+i pre-indexed forms may need to pass a</span></div><div class="line"><a name="l07141"></a><span class="lineno"> 7141</span>&#160;  <span class="comment">// constant base with a variable offset so that constant coercion</span></div><div class="line"><a name="l07142"></a><span class="lineno"> 7142</span>&#160;  <span class="comment">// will work with the patterns in canonical form.</span></div><div class="line"><a name="l07143"></a><span class="lineno"> 7143</span>&#160;  <span class="keywordtype">bool</span> Swapped = <span class="keyword">false</span>;</div><div class="line"><a name="l07144"></a><span class="lineno"> 7144</span>&#160;  <span class="keywordflow">if</span> (isa&lt;ConstantSDNode&gt;(BasePtr)) {</div><div class="line"><a name="l07145"></a><span class="lineno"> 7145</span>&#160;    <a class="code" href="namespacestd.html#ab8424022895aee3e366fb9a32f2883cb">std::swap</a>(BasePtr, Offset);</div><div class="line"><a name="l07146"></a><span class="lineno"> 7146</span>&#160;    Swapped = <span class="keyword">true</span>;</div><div class="line"><a name="l07147"></a><span class="lineno"> 7147</span>&#160;  }</div><div class="line"><a name="l07148"></a><span class="lineno"> 7148</span>&#160;</div><div class="line"><a name="l07149"></a><span class="lineno"> 7149</span>&#160;  <span class="comment">// Don&#39;t create a indexed load / store with zero offset.</span></div><div class="line"><a name="l07150"></a><span class="lineno"> 7150</span>&#160;  <span class="keywordflow">if</span> (isa&lt;ConstantSDNode&gt;(Offset) &amp;&amp;</div><div class="line"><a name="l07151"></a><span class="lineno"> 7151</span>&#160;      cast&lt;ConstantSDNode&gt;(Offset)-&gt;isNullValue())</div><div class="line"><a name="l07152"></a><span class="lineno"> 7152</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l07153"></a><span class="lineno"> 7153</span>&#160;</div><div class="line"><a name="l07154"></a><span class="lineno"> 7154</span>&#160;  <span class="comment">// Try turning it into a pre-indexed load / store except when:</span></div><div class="line"><a name="l07155"></a><span class="lineno"> 7155</span>&#160;  <span class="comment">// 1) The new base ptr is a frame index.</span></div><div class="line"><a name="l07156"></a><span class="lineno"> 7156</span>&#160;  <span class="comment">// 2) If N is a store and the new base ptr is either the same as or is a</span></div><div class="line"><a name="l07157"></a><span class="lineno"> 7157</span>&#160;  <span class="comment">//    predecessor of the value being stored.</span></div><div class="line"><a name="l07158"></a><span class="lineno"> 7158</span>&#160;  <span class="comment">// 3) Another use of old base ptr is a predecessor of N. If ptr is folded</span></div><div class="line"><a name="l07159"></a><span class="lineno"> 7159</span>&#160;  <span class="comment">//    that would create a cycle.</span></div><div class="line"><a name="l07160"></a><span class="lineno"> 7160</span>&#160;  <span class="comment">// 4) All uses are load / store ops that use it as old base ptr.</span></div><div class="line"><a name="l07161"></a><span class="lineno"> 7161</span>&#160;</div><div class="line"><a name="l07162"></a><span class="lineno"> 7162</span>&#160;  <span class="comment">// Check #1.  Preinc&#39;ing a frame index would require copying the stack pointer</span></div><div class="line"><a name="l07163"></a><span class="lineno"> 7163</span>&#160;  <span class="comment">// (plus the implicit offset) to a register to preinc anyway.</span></div><div class="line"><a name="l07164"></a><span class="lineno"> 7164</span>&#160;  <span class="keywordflow">if</span> (isa&lt;FrameIndexSDNode&gt;(BasePtr) || isa&lt;RegisterSDNode&gt;(BasePtr))</div><div class="line"><a name="l07165"></a><span class="lineno"> 7165</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l07166"></a><span class="lineno"> 7166</span>&#160;</div><div class="line"><a name="l07167"></a><span class="lineno"> 7167</span>&#160;  <span class="comment">// Check #2.</span></div><div class="line"><a name="l07168"></a><span class="lineno"> 7168</span>&#160;  <span class="keywordflow">if</span> (!isLoad) {</div><div class="line"><a name="l07169"></a><span class="lineno"> 7169</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Val = cast&lt;StoreSDNode&gt;(<a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>)-&gt;getValue();</div><div class="line"><a name="l07170"></a><span class="lineno"> 7170</span>&#160;    <span class="keywordflow">if</span> (Val == BasePtr || BasePtr.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()-&gt;<a class="code" href="classllvm_1_1SDNode.html#a7ee80bb807d0f88ecbfbc44607228ef6">isPredecessorOf</a>(Val.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()))</div><div class="line"><a name="l07171"></a><span class="lineno"> 7171</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l07172"></a><span class="lineno"> 7172</span>&#160;  }</div><div class="line"><a name="l07173"></a><span class="lineno"> 7173</span>&#160;</div><div class="line"><a name="l07174"></a><span class="lineno"> 7174</span>&#160;  <span class="comment">// If the offset is a constant, there may be other adds of constants that</span></div><div class="line"><a name="l07175"></a><span class="lineno"> 7175</span>&#160;  <span class="comment">// can be folded with this one. We should do this to avoid having to keep</span></div><div class="line"><a name="l07176"></a><span class="lineno"> 7176</span>&#160;  <span class="comment">// a copy of the original base pointer.</span></div><div class="line"><a name="l07177"></a><span class="lineno"> 7177</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;SDNode *, 16&gt;</a> OtherUses;</div><div class="line"><a name="l07178"></a><span class="lineno"> 7178</span>&#160;  <span class="keywordflow">if</span> (isa&lt;ConstantSDNode&gt;(Offset))</div><div class="line"><a name="l07179"></a><span class="lineno"> 7179</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1SDNode_1_1use__iterator.html">SDNode::use_iterator</a> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = BasePtr.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()-&gt;<a class="code" href="classllvm_1_1SDNode.html#a8810bf428dcf84d48f39c8f5ba9a8c94">use_begin</a>(),</div><div class="line"><a name="l07180"></a><span class="lineno"> 7180</span>&#160;         E = BasePtr.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()-&gt;<a class="code" href="classllvm_1_1SDNode.html#aef02f2c1bd12936a80611b134b24a47d">use_end</a>(); <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> != E; ++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div><div class="line"><a name="l07181"></a><span class="lineno"> 7181</span>&#160;      <a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *<a class="code" href="classllvm_1_1Use.html">Use</a> = *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>;</div><div class="line"><a name="l07182"></a><span class="lineno"> 7182</span>&#160;      <span class="keywordflow">if</span> (Use == Ptr.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>())</div><div class="line"><a name="l07183"></a><span class="lineno"> 7183</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l07184"></a><span class="lineno"> 7184</span>&#160;</div><div class="line"><a name="l07185"></a><span class="lineno"> 7185</span>&#160;      <span class="keywordflow">if</span> (Use-&gt;<a class="code" href="classllvm_1_1SDNode.html#a7ee80bb807d0f88ecbfbc44607228ef6">isPredecessorOf</a>(N))</div><div class="line"><a name="l07186"></a><span class="lineno"> 7186</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l07187"></a><span class="lineno"> 7187</span>&#160;</div><div class="line"><a name="l07188"></a><span class="lineno"> 7188</span>&#160;      <span class="keywordflow">if</span> (Use-&gt;<a class="code" href="classllvm_1_1SDNode.html#af0d328f3f61168f4ea7d6e4044af4f97">getOpcode</a>() != <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a269996b43a1f3e1d1f84a70fd4387535">ISD::ADD</a> &amp;&amp; Use-&gt;<a class="code" href="classllvm_1_1SDNode.html#af0d328f3f61168f4ea7d6e4044af4f97">getOpcode</a>() != <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9fa617e5567c3c2638938f7b9ddc3f1c">ISD::SUB</a>) {</div><div class="line"><a name="l07189"></a><span class="lineno"> 7189</span>&#160;        OtherUses.<a class="code" href="classllvm_1_1SmallVectorImpl.html#aac0ea55010b7b1a301e65a0baea057aa">clear</a>();</div><div class="line"><a name="l07190"></a><span class="lineno"> 7190</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l07191"></a><span class="lineno"> 7191</span>&#160;      }</div><div class="line"><a name="l07192"></a><span class="lineno"> 7192</span>&#160;</div><div class="line"><a name="l07193"></a><span class="lineno"> 7193</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Op0 = Use-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0), Op1 = Use-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(1);</div><div class="line"><a name="l07194"></a><span class="lineno"> 7194</span>&#160;      <span class="keywordflow">if</span> (Op1.getNode() == BasePtr.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>())</div><div class="line"><a name="l07195"></a><span class="lineno"> 7195</span>&#160;        <a class="code" href="namespacestd.html#ab8424022895aee3e366fb9a32f2883cb">std::swap</a>(Op0, Op1);</div><div class="line"><a name="l07196"></a><span class="lineno"> 7196</span>&#160;      assert(Op0.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>() == BasePtr.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>() &amp;&amp;</div><div class="line"><a name="l07197"></a><span class="lineno"> 7197</span>&#160;             <span class="stringliteral">&quot;Use of ADD/SUB but not an operand&quot;</span>);</div><div class="line"><a name="l07198"></a><span class="lineno"> 7198</span>&#160;</div><div class="line"><a name="l07199"></a><span class="lineno"> 7199</span>&#160;      <span class="keywordflow">if</span> (!isa&lt;ConstantSDNode&gt;(Op1)) {</div><div class="line"><a name="l07200"></a><span class="lineno"> 7200</span>&#160;        OtherUses.<a class="code" href="classllvm_1_1SmallVectorImpl.html#aac0ea55010b7b1a301e65a0baea057aa">clear</a>();</div><div class="line"><a name="l07201"></a><span class="lineno"> 7201</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l07202"></a><span class="lineno"> 7202</span>&#160;      }</div><div class="line"><a name="l07203"></a><span class="lineno"> 7203</span>&#160;</div><div class="line"><a name="l07204"></a><span class="lineno"> 7204</span>&#160;      <span class="comment">// FIXME: In some cases, we can be smarter about this.</span></div><div class="line"><a name="l07205"></a><span class="lineno"> 7205</span>&#160;      <span class="keywordflow">if</span> (Op1.getValueType() != Offset.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>()) {</div><div class="line"><a name="l07206"></a><span class="lineno"> 7206</span>&#160;        OtherUses.<a class="code" href="classllvm_1_1SmallVectorImpl.html#aac0ea55010b7b1a301e65a0baea057aa">clear</a>();</div><div class="line"><a name="l07207"></a><span class="lineno"> 7207</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l07208"></a><span class="lineno"> 7208</span>&#160;      }</div><div class="line"><a name="l07209"></a><span class="lineno"> 7209</span>&#160;</div><div class="line"><a name="l07210"></a><span class="lineno"> 7210</span>&#160;      OtherUses.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(Use);</div><div class="line"><a name="l07211"></a><span class="lineno"> 7211</span>&#160;    }</div><div class="line"><a name="l07212"></a><span class="lineno"> 7212</span>&#160;</div><div class="line"><a name="l07213"></a><span class="lineno"> 7213</span>&#160;  <span class="keywordflow">if</span> (Swapped)</div><div class="line"><a name="l07214"></a><span class="lineno"> 7214</span>&#160;    <a class="code" href="namespacestd.html#ab8424022895aee3e366fb9a32f2883cb">std::swap</a>(BasePtr, Offset);</div><div class="line"><a name="l07215"></a><span class="lineno"> 7215</span>&#160;</div><div class="line"><a name="l07216"></a><span class="lineno"> 7216</span>&#160;  <span class="comment">// Now check for #3 and #4.</span></div><div class="line"><a name="l07217"></a><span class="lineno"> 7217</span>&#160;  <span class="keywordtype">bool</span> RealUse = <span class="keyword">false</span>;</div><div class="line"><a name="l07218"></a><span class="lineno"> 7218</span>&#160;</div><div class="line"><a name="l07219"></a><span class="lineno"> 7219</span>&#160;  <span class="comment">// Caches for hasPredecessorHelper</span></div><div class="line"><a name="l07220"></a><span class="lineno"> 7220</span>&#160;  <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;const SDNode *, 32&gt;</a> Visited;</div><div class="line"><a name="l07221"></a><span class="lineno"> 7221</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;const SDNode *, 16&gt;</a> Worklist;</div><div class="line"><a name="l07222"></a><span class="lineno"> 7222</span>&#160;</div><div class="line"><a name="l07223"></a><span class="lineno"> 7223</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1SDNode_1_1use__iterator.html">SDNode::use_iterator</a> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = Ptr.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()-&gt;<a class="code" href="classllvm_1_1SDNode.html#a8810bf428dcf84d48f39c8f5ba9a8c94">use_begin</a>(),</div><div class="line"><a name="l07224"></a><span class="lineno"> 7224</span>&#160;         E = Ptr.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()-&gt;<a class="code" href="classllvm_1_1SDNode.html#aef02f2c1bd12936a80611b134b24a47d">use_end</a>(); <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> != E; ++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div><div class="line"><a name="l07225"></a><span class="lineno"> 7225</span>&#160;    <a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *<a class="code" href="classllvm_1_1Use.html">Use</a> = *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>;</div><div class="line"><a name="l07226"></a><span class="lineno"> 7226</span>&#160;    <span class="keywordflow">if</span> (Use == N)</div><div class="line"><a name="l07227"></a><span class="lineno"> 7227</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l07228"></a><span class="lineno"> 7228</span>&#160;    <span class="keywordflow">if</span> (N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a7a49f347b7c1be27687d82d066b2b625">hasPredecessorHelper</a>(Use, Visited, Worklist))</div><div class="line"><a name="l07229"></a><span class="lineno"> 7229</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l07230"></a><span class="lineno"> 7230</span>&#160;</div><div class="line"><a name="l07231"></a><span class="lineno"> 7231</span>&#160;    <span class="comment">// If Ptr may be folded in addressing mode of other use, then it&#39;s</span></div><div class="line"><a name="l07232"></a><span class="lineno"> 7232</span>&#160;    <span class="comment">// not profitable to do this transformation.</span></div><div class="line"><a name="l07233"></a><span class="lineno"> 7233</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="DAGCombiner_8cpp.html#a631357f1796c922cce73dae4bff6018f">canFoldInAddressingMode</a>(Ptr.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>(), Use, DAG, TLI))</div><div class="line"><a name="l07234"></a><span class="lineno"> 7234</span>&#160;      RealUse = <span class="keyword">true</span>;</div><div class="line"><a name="l07235"></a><span class="lineno"> 7235</span>&#160;  }</div><div class="line"><a name="l07236"></a><span class="lineno"> 7236</span>&#160;</div><div class="line"><a name="l07237"></a><span class="lineno"> 7237</span>&#160;  <span class="keywordflow">if</span> (!RealUse)</div><div class="line"><a name="l07238"></a><span class="lineno"> 7238</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l07239"></a><span class="lineno"> 7239</span>&#160;</div><div class="line"><a name="l07240"></a><span class="lineno"> 7240</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Result;</div><div class="line"><a name="l07241"></a><span class="lineno"> 7241</span>&#160;  <span class="keywordflow">if</span> (isLoad)</div><div class="line"><a name="l07242"></a><span class="lineno"> 7242</span>&#160;    Result = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#ac1f26ebe6fcefcb117d3a6fd1fe32e67">getIndexedLoad</a>(<a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(N,0), <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N),</div><div class="line"><a name="l07243"></a><span class="lineno"> 7243</span>&#160;                                BasePtr, Offset, AM);</div><div class="line"><a name="l07244"></a><span class="lineno"> 7244</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l07245"></a><span class="lineno"> 7245</span>&#160;    Result = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a5be091659170a3bf7a2cbbd819cfd9ac">getIndexedStore</a>(<a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(N,0), <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N),</div><div class="line"><a name="l07246"></a><span class="lineno"> 7246</span>&#160;                                 BasePtr, Offset, AM);</div><div class="line"><a name="l07247"></a><span class="lineno"> 7247</span>&#160;  ++PreIndexedNodes;</div><div class="line"><a name="l07248"></a><span class="lineno"> 7248</span>&#160;  ++NodesCombined;</div><div class="line"><a name="l07249"></a><span class="lineno"> 7249</span>&#160;  <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;\nReplacing.4 &quot;</span>;</div><div class="line"><a name="l07250"></a><span class="lineno"> 7250</span>&#160;        N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a535ca517df1b4ae62e75475141e65787">dump</a>(&amp;DAG);</div><div class="line"><a name="l07251"></a><span class="lineno"> 7251</span>&#160;        <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;\nWith: &quot;</span>;</div><div class="line"><a name="l07252"></a><span class="lineno"> 7252</span>&#160;        Result.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()-&gt;<a class="code" href="classllvm_1_1SDNode.html#a535ca517df1b4ae62e75475141e65787">dump</a>(&amp;DAG);</div><div class="line"><a name="l07253"></a><span class="lineno"> 7253</span>&#160;        <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>);</div><div class="line"><a name="l07254"></a><span class="lineno"> 7254</span>&#160;  WorkListRemover DeadNodes(*<span class="keyword">this</span>);</div><div class="line"><a name="l07255"></a><span class="lineno"> 7255</span>&#160;  <span class="keywordflow">if</span> (isLoad) {</div><div class="line"><a name="l07256"></a><span class="lineno"> 7256</span>&#160;    DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#ac630ccda26fea2f45afa3fb89bc1a8f4">ReplaceAllUsesOfValueWith</a>(<a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(N, 0), Result.<a class="code" href="classllvm_1_1SDValue.html#a040481b9bda32faa6b1435532405d88f">getValue</a>(0));</div><div class="line"><a name="l07257"></a><span class="lineno"> 7257</span>&#160;    DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#ac630ccda26fea2f45afa3fb89bc1a8f4">ReplaceAllUsesOfValueWith</a>(<a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(N, 1), Result.<a class="code" href="classllvm_1_1SDValue.html#a040481b9bda32faa6b1435532405d88f">getValue</a>(2));</div><div class="line"><a name="l07258"></a><span class="lineno"> 7258</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l07259"></a><span class="lineno"> 7259</span>&#160;    DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#ac630ccda26fea2f45afa3fb89bc1a8f4">ReplaceAllUsesOfValueWith</a>(<a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(N, 0), Result.<a class="code" href="classllvm_1_1SDValue.html#a040481b9bda32faa6b1435532405d88f">getValue</a>(1));</div><div class="line"><a name="l07260"></a><span class="lineno"> 7260</span>&#160;  }</div><div class="line"><a name="l07261"></a><span class="lineno"> 7261</span>&#160;</div><div class="line"><a name="l07262"></a><span class="lineno"> 7262</span>&#160;  <span class="comment">// Finally, since the node is now dead, remove it from the graph.</span></div><div class="line"><a name="l07263"></a><span class="lineno"> 7263</span>&#160;  DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a5f57dcbedc16dced31c61f7bbbb06ded">DeleteNode</a>(N);</div><div class="line"><a name="l07264"></a><span class="lineno"> 7264</span>&#160;</div><div class="line"><a name="l07265"></a><span class="lineno"> 7265</span>&#160;  <span class="keywordflow">if</span> (Swapped)</div><div class="line"><a name="l07266"></a><span class="lineno"> 7266</span>&#160;    <a class="code" href="namespacestd.html#ab8424022895aee3e366fb9a32f2883cb">std::swap</a>(BasePtr, Offset);</div><div class="line"><a name="l07267"></a><span class="lineno"> 7267</span>&#160;</div><div class="line"><a name="l07268"></a><span class="lineno"> 7268</span>&#160;  <span class="comment">// Replace other uses of BasePtr that can be updated to use Ptr</span></div><div class="line"><a name="l07269"></a><span class="lineno"> 7269</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0, e = OtherUses.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#a22a311dfe4c28a897de8a9365a4f0a84">size</a>(); <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != e; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l07270"></a><span class="lineno"> 7270</span>&#160;    <span class="keywordtype">unsigned</span> OffsetIdx = 1;</div><div class="line"><a name="l07271"></a><span class="lineno"> 7271</span>&#160;    <span class="keywordflow">if</span> (OtherUses[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;getOperand(OffsetIdx).getNode() == BasePtr.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>())</div><div class="line"><a name="l07272"></a><span class="lineno"> 7272</span>&#160;      OffsetIdx = 0;</div><div class="line"><a name="l07273"></a><span class="lineno"> 7273</span>&#160;    assert(OtherUses[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;getOperand(!OffsetIdx).getNode() ==</div><div class="line"><a name="l07274"></a><span class="lineno"> 7274</span>&#160;           BasePtr.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>() &amp;&amp; <span class="stringliteral">&quot;Expected BasePtr operand&quot;</span>);</div><div class="line"><a name="l07275"></a><span class="lineno"> 7275</span>&#160;</div><div class="line"><a name="l07276"></a><span class="lineno"> 7276</span>&#160;    <span class="comment">// We need to replace ptr0 in the following expression:</span></div><div class="line"><a name="l07277"></a><span class="lineno"> 7277</span>&#160;    <span class="comment">//   x0 * offset0 + y0 * ptr0 = t0</span></div><div class="line"><a name="l07278"></a><span class="lineno"> 7278</span>&#160;    <span class="comment">// knowing that</span></div><div class="line"><a name="l07279"></a><span class="lineno"> 7279</span>&#160;    <span class="comment">//   x1 * offset1 + y1 * ptr0 = t1 (the indexed load/store)</span></div><div class="line"><a name="l07280"></a><span class="lineno"> 7280</span>&#160;    <span class="comment">//</span></div><div class="line"><a name="l07281"></a><span class="lineno"> 7281</span>&#160;    <span class="comment">// where x0, x1, y0 and y1 in {-1, 1} are given by the types of the</span></div><div class="line"><a name="l07282"></a><span class="lineno"> 7282</span>&#160;    <span class="comment">// indexed load/store and the expresion that needs to be re-written.</span></div><div class="line"><a name="l07283"></a><span class="lineno"> 7283</span>&#160;    <span class="comment">//</span></div><div class="line"><a name="l07284"></a><span class="lineno"> 7284</span>&#160;    <span class="comment">// Therefore, we have:</span></div><div class="line"><a name="l07285"></a><span class="lineno"> 7285</span>&#160;    <span class="comment">//   t0 = (x0 * offset0 - x1 * y0 * y1 *offset1) + (y0 * y1) * t1</span></div><div class="line"><a name="l07286"></a><span class="lineno"> 7286</span>&#160;</div><div class="line"><a name="l07287"></a><span class="lineno"> 7287</span>&#160;    <a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a> *CN =</div><div class="line"><a name="l07288"></a><span class="lineno"> 7288</span>&#160;      cast&lt;ConstantSDNode&gt;(OtherUses[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;getOperand(OffsetIdx));</div><div class="line"><a name="l07289"></a><span class="lineno"> 7289</span>&#160;    <span class="keywordtype">int</span> X0, X1, Y0, Y1;</div><div class="line"><a name="l07290"></a><span class="lineno"> 7290</span>&#160;    <a class="code" href="classllvm_1_1APInt.html">APInt</a> Offset0 = CN-&gt;getAPIntValue();</div><div class="line"><a name="l07291"></a><span class="lineno"> 7291</span>&#160;    <a class="code" href="classllvm_1_1APInt.html">APInt</a> Offset1 = cast&lt;ConstantSDNode&gt;(Offset)-&gt;getAPIntValue();</div><div class="line"><a name="l07292"></a><span class="lineno"> 7292</span>&#160;</div><div class="line"><a name="l07293"></a><span class="lineno"> 7293</span>&#160;    X0 = (OtherUses[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;getOpcode() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9fa617e5567c3c2638938f7b9ddc3f1c">ISD::SUB</a> &amp;&amp; OffsetIdx == 1) ? -1 : 1;</div><div class="line"><a name="l07294"></a><span class="lineno"> 7294</span>&#160;    Y0 = (OtherUses[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;getOpcode() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9fa617e5567c3c2638938f7b9ddc3f1c">ISD::SUB</a> &amp;&amp; OffsetIdx == 0) ? -1 : 1;</div><div class="line"><a name="l07295"></a><span class="lineno"> 7295</span>&#160;    X1 = (AM == <a class="code" href="namespacellvm_1_1ISD.html#abee7ecb577fcade34eb16ccb7f503e31a57c3822f99653c422d5a21206adc6e42">ISD::PRE_DEC</a> &amp;&amp; !Swapped) ? -1 : 1;</div><div class="line"><a name="l07296"></a><span class="lineno"> 7296</span>&#160;    Y1 = (AM == <a class="code" href="namespacellvm_1_1ISD.html#abee7ecb577fcade34eb16ccb7f503e31a57c3822f99653c422d5a21206adc6e42">ISD::PRE_DEC</a> &amp;&amp; Swapped) ? -1 : 1;</div><div class="line"><a name="l07297"></a><span class="lineno"> 7297</span>&#160;</div><div class="line"><a name="l07298"></a><span class="lineno"> 7298</span>&#160;    <span class="keywordtype">unsigned</span> Opcode = (Y0 * Y1 &lt; 0) ? <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9fa617e5567c3c2638938f7b9ddc3f1c">ISD::SUB</a> : <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a269996b43a1f3e1d1f84a70fd4387535">ISD::ADD</a>;</div><div class="line"><a name="l07299"></a><span class="lineno"> 7299</span>&#160;</div><div class="line"><a name="l07300"></a><span class="lineno"> 7300</span>&#160;    <a class="code" href="classllvm_1_1APInt.html">APInt</a> CNV = Offset0;</div><div class="line"><a name="l07301"></a><span class="lineno"> 7301</span>&#160;    <span class="keywordflow">if</span> (X0 &lt; 0) CNV = -CNV;</div><div class="line"><a name="l07302"></a><span class="lineno"> 7302</span>&#160;    <span class="keywordflow">if</span> (X1 * Y0 * Y1 &lt; 0) CNV = CNV + Offset1;</div><div class="line"><a name="l07303"></a><span class="lineno"> 7303</span>&#160;    <span class="keywordflow">else</span> CNV = CNV - Offset1;</div><div class="line"><a name="l07304"></a><span class="lineno"> 7304</span>&#160;</div><div class="line"><a name="l07305"></a><span class="lineno"> 7305</span>&#160;    <span class="comment">// We can now generate the new expression.</span></div><div class="line"><a name="l07306"></a><span class="lineno"> 7306</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> NewOp1 = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(CNV, CN-&gt;getValueType(0));</div><div class="line"><a name="l07307"></a><span class="lineno"> 7307</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> NewOp2 = Result.<a class="code" href="classllvm_1_1SDValue.html#a040481b9bda32faa6b1435532405d88f">getValue</a>(isLoad ? 1 : 0);</div><div class="line"><a name="l07308"></a><span class="lineno"> 7308</span>&#160;</div><div class="line"><a name="l07309"></a><span class="lineno"> 7309</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> NewUse = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(Opcode,</div><div class="line"><a name="l07310"></a><span class="lineno"> 7310</span>&#160;                                 <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(OtherUses[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>]),</div><div class="line"><a name="l07311"></a><span class="lineno"> 7311</span>&#160;                                 OtherUses[i]-&gt;getValueType(0), NewOp1, NewOp2);</div><div class="line"><a name="l07312"></a><span class="lineno"> 7312</span>&#160;    DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#ac630ccda26fea2f45afa3fb89bc1a8f4">ReplaceAllUsesOfValueWith</a>(<a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(OtherUses[i], 0), NewUse);</div><div class="line"><a name="l07313"></a><span class="lineno"> 7313</span>&#160;    removeFromWorkList(OtherUses[i]);</div><div class="line"><a name="l07314"></a><span class="lineno"> 7314</span>&#160;    DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a5f57dcbedc16dced31c61f7bbbb06ded">DeleteNode</a>(OtherUses[i]);</div><div class="line"><a name="l07315"></a><span class="lineno"> 7315</span>&#160;  }</div><div class="line"><a name="l07316"></a><span class="lineno"> 7316</span>&#160;</div><div class="line"><a name="l07317"></a><span class="lineno"> 7317</span>&#160;  <span class="comment">// Replace the uses of Ptr with uses of the updated base value.</span></div><div class="line"><a name="l07318"></a><span class="lineno"> 7318</span>&#160;  DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#ac630ccda26fea2f45afa3fb89bc1a8f4">ReplaceAllUsesOfValueWith</a>(Ptr, Result.<a class="code" href="classllvm_1_1SDValue.html#a040481b9bda32faa6b1435532405d88f">getValue</a>(isLoad ? 1 : 0));</div><div class="line"><a name="l07319"></a><span class="lineno"> 7319</span>&#160;  removeFromWorkList(Ptr.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l07320"></a><span class="lineno"> 7320</span>&#160;  DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a5f57dcbedc16dced31c61f7bbbb06ded">DeleteNode</a>(Ptr.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l07321"></a><span class="lineno"> 7321</span>&#160;</div><div class="line"><a name="l07322"></a><span class="lineno"> 7322</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l07323"></a><span class="lineno"> 7323</span>&#160;}</div><div class="line"><a name="l07324"></a><span class="lineno"> 7324</span>&#160;<span class="comment"></span></div><div class="line"><a name="l07325"></a><span class="lineno"> 7325</span>&#160;<span class="comment">/// CombineToPostIndexedLoadStore - Try to combine a load / store with a</span></div><div class="line"><a name="l07326"></a><span class="lineno"> 7326</span>&#160;<span class="comment">/// add / sub of the base pointer node into a post-indexed load / store.</span></div><div class="line"><a name="l07327"></a><span class="lineno"> 7327</span>&#160;<span class="comment">/// The transformation folded the add / subtract into the new indexed</span></div><div class="line"><a name="l07328"></a><span class="lineno"> 7328</span>&#160;<span class="comment">/// load / store effectively and all of its uses are redirected to the</span></div><div class="line"><a name="l07329"></a><span class="lineno"> 7329</span>&#160;<span class="comment">/// new load / store.</span></div><div class="line"><a name="l07330"></a><span class="lineno"> 7330</span>&#160;<span class="comment"></span><span class="keywordtype">bool</span> DAGCombiner::CombineToPostIndexedLoadStore(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N) {</div><div class="line"><a name="l07331"></a><span class="lineno"> 7331</span>&#160;  <span class="keywordflow">if</span> (Level &lt; <a class="code" href="namespacellvm.html#aa6d856e4879bb775617f8c3634773b7aa7fbaa966e5d5ac3bf03ba617b73bff5c">AfterLegalizeDAG</a>)</div><div class="line"><a name="l07332"></a><span class="lineno"> 7332</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l07333"></a><span class="lineno"> 7333</span>&#160;</div><div class="line"><a name="l07334"></a><span class="lineno"> 7334</span>&#160;  <span class="keywordtype">bool</span> isLoad = <span class="keyword">true</span>;</div><div class="line"><a name="l07335"></a><span class="lineno"> 7335</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Ptr;</div><div class="line"><a name="l07336"></a><span class="lineno"> 7336</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> VT;</div><div class="line"><a name="l07337"></a><span class="lineno"> 7337</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1LoadSDNode.html">LoadSDNode</a> *<a class="code" href="namespacellvm_1_1A64DB.html#a6fce8157775f3ec93f326b52b0f1e0f5ad61b145eb8cbab18feb1b2e2ce269a7e">LD</a>  = dyn_cast&lt;LoadSDNode&gt;(N)) {</div><div class="line"><a name="l07338"></a><span class="lineno"> 7338</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1A64DB.html#a6fce8157775f3ec93f326b52b0f1e0f5ad61b145eb8cbab18feb1b2e2ce269a7e">LD</a>-&gt;isIndexed())</div><div class="line"><a name="l07339"></a><span class="lineno"> 7339</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l07340"></a><span class="lineno"> 7340</span>&#160;    VT = <a class="code" href="namespacellvm_1_1A64DB.html#a6fce8157775f3ec93f326b52b0f1e0f5ad61b145eb8cbab18feb1b2e2ce269a7e">LD</a>-&gt;getMemoryVT();</div><div class="line"><a name="l07341"></a><span class="lineno"> 7341</span>&#160;    <span class="keywordflow">if</span> (!TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a9c8b7aaed941ee853da98aafd6739af6">isIndexedLoadLegal</a>(<a class="code" href="namespacellvm_1_1ISD.html#abee7ecb577fcade34eb16ccb7f503e31a866c29237765ff291c9503abbdca60e1">ISD::POST_INC</a>, VT) &amp;&amp;</div><div class="line"><a name="l07342"></a><span class="lineno"> 7342</span>&#160;        !TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a9c8b7aaed941ee853da98aafd6739af6">isIndexedLoadLegal</a>(<a class="code" href="namespacellvm_1_1ISD.html#abee7ecb577fcade34eb16ccb7f503e31a10a4094c81c0b9cd5e82e53b48932203">ISD::POST_DEC</a>, VT))</div><div class="line"><a name="l07343"></a><span class="lineno"> 7343</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l07344"></a><span class="lineno"> 7344</span>&#160;    Ptr = <a class="code" href="namespacellvm_1_1A64DB.html#a6fce8157775f3ec93f326b52b0f1e0f5ad61b145eb8cbab18feb1b2e2ce269a7e">LD</a>-&gt;getBasePtr();</div><div class="line"><a name="l07345"></a><span class="lineno"> 7345</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1StoreSDNode.html">StoreSDNode</a> *<a class="code" href="namespacellvm_1_1A64DB.html#a6fce8157775f3ec93f326b52b0f1e0f5a4916e736d6b7cc68359b39d5eb50f6db">ST</a>  = dyn_cast&lt;StoreSDNode&gt;(N)) {</div><div class="line"><a name="l07346"></a><span class="lineno"> 7346</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1A64DB.html#a6fce8157775f3ec93f326b52b0f1e0f5a4916e736d6b7cc68359b39d5eb50f6db">ST</a>-&gt;isIndexed())</div><div class="line"><a name="l07347"></a><span class="lineno"> 7347</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l07348"></a><span class="lineno"> 7348</span>&#160;    VT = <a class="code" href="namespacellvm_1_1A64DB.html#a6fce8157775f3ec93f326b52b0f1e0f5a4916e736d6b7cc68359b39d5eb50f6db">ST</a>-&gt;getMemoryVT();</div><div class="line"><a name="l07349"></a><span class="lineno"> 7349</span>&#160;    <span class="keywordflow">if</span> (!TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a4fe606f87214ac58150a6c99bde8db84">isIndexedStoreLegal</a>(<a class="code" href="namespacellvm_1_1ISD.html#abee7ecb577fcade34eb16ccb7f503e31a866c29237765ff291c9503abbdca60e1">ISD::POST_INC</a>, VT) &amp;&amp;</div><div class="line"><a name="l07350"></a><span class="lineno"> 7350</span>&#160;        !TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a4fe606f87214ac58150a6c99bde8db84">isIndexedStoreLegal</a>(<a class="code" href="namespacellvm_1_1ISD.html#abee7ecb577fcade34eb16ccb7f503e31a10a4094c81c0b9cd5e82e53b48932203">ISD::POST_DEC</a>, VT))</div><div class="line"><a name="l07351"></a><span class="lineno"> 7351</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l07352"></a><span class="lineno"> 7352</span>&#160;    Ptr = <a class="code" href="namespacellvm_1_1A64DB.html#a6fce8157775f3ec93f326b52b0f1e0f5a4916e736d6b7cc68359b39d5eb50f6db">ST</a>-&gt;getBasePtr();</div><div class="line"><a name="l07353"></a><span class="lineno"> 7353</span>&#160;    isLoad = <span class="keyword">false</span>;</div><div class="line"><a name="l07354"></a><span class="lineno"> 7354</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l07355"></a><span class="lineno"> 7355</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l07356"></a><span class="lineno"> 7356</span>&#160;  }</div><div class="line"><a name="l07357"></a><span class="lineno"> 7357</span>&#160;</div><div class="line"><a name="l07358"></a><span class="lineno"> 7358</span>&#160;  <span class="keywordflow">if</span> (Ptr.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()-&gt;<a class="code" href="classllvm_1_1SDNode.html#a52753947fce3a01b1c18dd4713c587e8">hasOneUse</a>())</div><div class="line"><a name="l07359"></a><span class="lineno"> 7359</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l07360"></a><span class="lineno"> 7360</span>&#160;</div><div class="line"><a name="l07361"></a><span class="lineno"> 7361</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1SDNode_1_1use__iterator.html">SDNode::use_iterator</a> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = Ptr.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()-&gt;<a class="code" href="classllvm_1_1SDNode.html#a8810bf428dcf84d48f39c8f5ba9a8c94">use_begin</a>(),</div><div class="line"><a name="l07362"></a><span class="lineno"> 7362</span>&#160;         E = Ptr.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()-&gt;<a class="code" href="classllvm_1_1SDNode.html#aef02f2c1bd12936a80611b134b24a47d">use_end</a>(); <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> != E; ++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div><div class="line"><a name="l07363"></a><span class="lineno"> 7363</span>&#160;    <a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *Op = *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>;</div><div class="line"><a name="l07364"></a><span class="lineno"> 7364</span>&#160;    <span class="keywordflow">if</span> (Op == N ||</div><div class="line"><a name="l07365"></a><span class="lineno"> 7365</span>&#160;        (Op-&gt;<a class="code" href="classllvm_1_1SDNode.html#af0d328f3f61168f4ea7d6e4044af4f97">getOpcode</a>() != <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a269996b43a1f3e1d1f84a70fd4387535">ISD::ADD</a> &amp;&amp; Op-&gt;<a class="code" href="classllvm_1_1SDNode.html#af0d328f3f61168f4ea7d6e4044af4f97">getOpcode</a>() != <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9fa617e5567c3c2638938f7b9ddc3f1c">ISD::SUB</a>))</div><div class="line"><a name="l07366"></a><span class="lineno"> 7366</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l07367"></a><span class="lineno"> 7367</span>&#160;</div><div class="line"><a name="l07368"></a><span class="lineno"> 7368</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> BasePtr;</div><div class="line"><a name="l07369"></a><span class="lineno"> 7369</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Offset;</div><div class="line"><a name="l07370"></a><span class="lineno"> 7370</span>&#160;    <a class="code" href="namespacellvm_1_1ISD.html#abee7ecb577fcade34eb16ccb7f503e31">ISD::MemIndexedMode</a> AM = <a class="code" href="namespacellvm_1_1ISD.html#abee7ecb577fcade34eb16ccb7f503e31ade1c53e7b8a373e22ec53ff7bcbace9f">ISD::UNINDEXED</a>;</div><div class="line"><a name="l07371"></a><span class="lineno"> 7371</span>&#160;    <span class="keywordflow">if</span> (TLI.<a class="code" href="classllvm_1_1TargetLowering.html#af5b4e842b91ce6dce0e96ea576ef8517">getPostIndexedAddressParts</a>(N, Op, BasePtr, Offset, AM, DAG)) {</div><div class="line"><a name="l07372"></a><span class="lineno"> 7372</span>&#160;      <span class="comment">// Don&#39;t create a indexed load / store with zero offset.</span></div><div class="line"><a name="l07373"></a><span class="lineno"> 7373</span>&#160;      <span class="keywordflow">if</span> (isa&lt;ConstantSDNode&gt;(Offset) &amp;&amp;</div><div class="line"><a name="l07374"></a><span class="lineno"> 7374</span>&#160;          cast&lt;ConstantSDNode&gt;(Offset)-&gt;isNullValue())</div><div class="line"><a name="l07375"></a><span class="lineno"> 7375</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l07376"></a><span class="lineno"> 7376</span>&#160;</div><div class="line"><a name="l07377"></a><span class="lineno"> 7377</span>&#160;      <span class="comment">// Try turning it into a post-indexed load / store except when</span></div><div class="line"><a name="l07378"></a><span class="lineno"> 7378</span>&#160;      <span class="comment">// 1) All uses are load / store ops that use it as base ptr (and</span></div><div class="line"><a name="l07379"></a><span class="lineno"> 7379</span>&#160;      <span class="comment">//    it may be folded as addressing mmode).</span></div><div class="line"><a name="l07380"></a><span class="lineno"> 7380</span>&#160;      <span class="comment">// 2) Op must be independent of N, i.e. Op is neither a predecessor</span></div><div class="line"><a name="l07381"></a><span class="lineno"> 7381</span>&#160;      <span class="comment">//    nor a successor of N. Otherwise, if Op is folded that would</span></div><div class="line"><a name="l07382"></a><span class="lineno"> 7382</span>&#160;      <span class="comment">//    create a cycle.</span></div><div class="line"><a name="l07383"></a><span class="lineno"> 7383</span>&#160;</div><div class="line"><a name="l07384"></a><span class="lineno"> 7384</span>&#160;      <span class="keywordflow">if</span> (isa&lt;FrameIndexSDNode&gt;(BasePtr) || isa&lt;RegisterSDNode&gt;(BasePtr))</div><div class="line"><a name="l07385"></a><span class="lineno"> 7385</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l07386"></a><span class="lineno"> 7386</span>&#160;</div><div class="line"><a name="l07387"></a><span class="lineno"> 7387</span>&#160;      <span class="comment">// Check for #1.</span></div><div class="line"><a name="l07388"></a><span class="lineno"> 7388</span>&#160;      <span class="keywordtype">bool</span> TryNext = <span class="keyword">false</span>;</div><div class="line"><a name="l07389"></a><span class="lineno"> 7389</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1SDNode_1_1use__iterator.html">SDNode::use_iterator</a> II = BasePtr.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()-&gt;<a class="code" href="classllvm_1_1SDNode.html#a8810bf428dcf84d48f39c8f5ba9a8c94">use_begin</a>(),</div><div class="line"><a name="l07390"></a><span class="lineno"> 7390</span>&#160;             EE = BasePtr.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()-&gt;<a class="code" href="classllvm_1_1SDNode.html#aef02f2c1bd12936a80611b134b24a47d">use_end</a>(); II != EE; ++II) {</div><div class="line"><a name="l07391"></a><span class="lineno"> 7391</span>&#160;        <a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *<a class="code" href="classllvm_1_1Use.html">Use</a> = *II;</div><div class="line"><a name="l07392"></a><span class="lineno"> 7392</span>&#160;        <span class="keywordflow">if</span> (Use == Ptr.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>())</div><div class="line"><a name="l07393"></a><span class="lineno"> 7393</span>&#160;          <span class="keywordflow">continue</span>;</div><div class="line"><a name="l07394"></a><span class="lineno"> 7394</span>&#160;</div><div class="line"><a name="l07395"></a><span class="lineno"> 7395</span>&#160;        <span class="comment">// If all the uses are load / store addresses, then don&#39;t do the</span></div><div class="line"><a name="l07396"></a><span class="lineno"> 7396</span>&#160;        <span class="comment">// transformation.</span></div><div class="line"><a name="l07397"></a><span class="lineno"> 7397</span>&#160;        <span class="keywordflow">if</span> (Use-&gt;<a class="code" href="classllvm_1_1SDNode.html#af0d328f3f61168f4ea7d6e4044af4f97">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a269996b43a1f3e1d1f84a70fd4387535">ISD::ADD</a> || Use-&gt;<a class="code" href="classllvm_1_1SDNode.html#af0d328f3f61168f4ea7d6e4044af4f97">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9fa617e5567c3c2638938f7b9ddc3f1c">ISD::SUB</a>){</div><div class="line"><a name="l07398"></a><span class="lineno"> 7398</span>&#160;          <span class="keywordtype">bool</span> RealUse = <span class="keyword">false</span>;</div><div class="line"><a name="l07399"></a><span class="lineno"> 7399</span>&#160;          <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1SDNode_1_1use__iterator.html">SDNode::use_iterator</a> III = Use-&gt;<a class="code" href="classllvm_1_1SDNode.html#a8810bf428dcf84d48f39c8f5ba9a8c94">use_begin</a>(),</div><div class="line"><a name="l07400"></a><span class="lineno"> 7400</span>&#160;                 EEE = Use-&gt;<a class="code" href="classllvm_1_1SDNode.html#aef02f2c1bd12936a80611b134b24a47d">use_end</a>(); III != EEE; ++III) {</div><div class="line"><a name="l07401"></a><span class="lineno"> 7401</span>&#160;            <a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *UseUse = *III;</div><div class="line"><a name="l07402"></a><span class="lineno"> 7402</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="DAGCombiner_8cpp.html#a631357f1796c922cce73dae4bff6018f">canFoldInAddressingMode</a>(Use, UseUse, DAG, TLI))</div><div class="line"><a name="l07403"></a><span class="lineno"> 7403</span>&#160;              RealUse = <span class="keyword">true</span>;</div><div class="line"><a name="l07404"></a><span class="lineno"> 7404</span>&#160;          }</div><div class="line"><a name="l07405"></a><span class="lineno"> 7405</span>&#160;</div><div class="line"><a name="l07406"></a><span class="lineno"> 7406</span>&#160;          <span class="keywordflow">if</span> (!RealUse) {</div><div class="line"><a name="l07407"></a><span class="lineno"> 7407</span>&#160;            TryNext = <span class="keyword">true</span>;</div><div class="line"><a name="l07408"></a><span class="lineno"> 7408</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l07409"></a><span class="lineno"> 7409</span>&#160;          }</div><div class="line"><a name="l07410"></a><span class="lineno"> 7410</span>&#160;        }</div><div class="line"><a name="l07411"></a><span class="lineno"> 7411</span>&#160;      }</div><div class="line"><a name="l07412"></a><span class="lineno"> 7412</span>&#160;</div><div class="line"><a name="l07413"></a><span class="lineno"> 7413</span>&#160;      <span class="keywordflow">if</span> (TryNext)</div><div class="line"><a name="l07414"></a><span class="lineno"> 7414</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l07415"></a><span class="lineno"> 7415</span>&#160;</div><div class="line"><a name="l07416"></a><span class="lineno"> 7416</span>&#160;      <span class="comment">// Check for #2</span></div><div class="line"><a name="l07417"></a><span class="lineno"> 7417</span>&#160;      <span class="keywordflow">if</span> (!Op-&gt;<a class="code" href="classllvm_1_1SDNode.html#a7ee80bb807d0f88ecbfbc44607228ef6">isPredecessorOf</a>(N) &amp;&amp; !N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a7ee80bb807d0f88ecbfbc44607228ef6">isPredecessorOf</a>(Op)) {</div><div class="line"><a name="l07418"></a><span class="lineno"> 7418</span>&#160;        <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Result = isLoad</div><div class="line"><a name="l07419"></a><span class="lineno"> 7419</span>&#160;          ? DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#ac1f26ebe6fcefcb117d3a6fd1fe32e67">getIndexedLoad</a>(<a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(N,0), <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N),</div><div class="line"><a name="l07420"></a><span class="lineno"> 7420</span>&#160;                               BasePtr, Offset, AM)</div><div class="line"><a name="l07421"></a><span class="lineno"> 7421</span>&#160;          : DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a5be091659170a3bf7a2cbbd819cfd9ac">getIndexedStore</a>(<a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(N,0), <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N),</div><div class="line"><a name="l07422"></a><span class="lineno"> 7422</span>&#160;                                BasePtr, Offset, AM);</div><div class="line"><a name="l07423"></a><span class="lineno"> 7423</span>&#160;        ++PostIndexedNodes;</div><div class="line"><a name="l07424"></a><span class="lineno"> 7424</span>&#160;        ++NodesCombined;</div><div class="line"><a name="l07425"></a><span class="lineno"> 7425</span>&#160;        <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;\nReplacing.5 &quot;</span>;</div><div class="line"><a name="l07426"></a><span class="lineno"> 7426</span>&#160;              N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a535ca517df1b4ae62e75475141e65787">dump</a>(&amp;DAG);</div><div class="line"><a name="l07427"></a><span class="lineno"> 7427</span>&#160;              <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;\nWith: &quot;</span>;</div><div class="line"><a name="l07428"></a><span class="lineno"> 7428</span>&#160;              Result.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()-&gt;<a class="code" href="classllvm_1_1SDNode.html#a535ca517df1b4ae62e75475141e65787">dump</a>(&amp;DAG);</div><div class="line"><a name="l07429"></a><span class="lineno"> 7429</span>&#160;              <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>);</div><div class="line"><a name="l07430"></a><span class="lineno"> 7430</span>&#160;        WorkListRemover DeadNodes(*<span class="keyword">this</span>);</div><div class="line"><a name="l07431"></a><span class="lineno"> 7431</span>&#160;        <span class="keywordflow">if</span> (isLoad) {</div><div class="line"><a name="l07432"></a><span class="lineno"> 7432</span>&#160;          DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#ac630ccda26fea2f45afa3fb89bc1a8f4">ReplaceAllUsesOfValueWith</a>(<a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(N, 0), Result.<a class="code" href="classllvm_1_1SDValue.html#a040481b9bda32faa6b1435532405d88f">getValue</a>(0));</div><div class="line"><a name="l07433"></a><span class="lineno"> 7433</span>&#160;          DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#ac630ccda26fea2f45afa3fb89bc1a8f4">ReplaceAllUsesOfValueWith</a>(<a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(N, 1), Result.<a class="code" href="classllvm_1_1SDValue.html#a040481b9bda32faa6b1435532405d88f">getValue</a>(2));</div><div class="line"><a name="l07434"></a><span class="lineno"> 7434</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l07435"></a><span class="lineno"> 7435</span>&#160;          DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#ac630ccda26fea2f45afa3fb89bc1a8f4">ReplaceAllUsesOfValueWith</a>(<a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(N, 0), Result.<a class="code" href="classllvm_1_1SDValue.html#a040481b9bda32faa6b1435532405d88f">getValue</a>(1));</div><div class="line"><a name="l07436"></a><span class="lineno"> 7436</span>&#160;        }</div><div class="line"><a name="l07437"></a><span class="lineno"> 7437</span>&#160;</div><div class="line"><a name="l07438"></a><span class="lineno"> 7438</span>&#160;        <span class="comment">// Finally, since the node is now dead, remove it from the graph.</span></div><div class="line"><a name="l07439"></a><span class="lineno"> 7439</span>&#160;        DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a5f57dcbedc16dced31c61f7bbbb06ded">DeleteNode</a>(N);</div><div class="line"><a name="l07440"></a><span class="lineno"> 7440</span>&#160;</div><div class="line"><a name="l07441"></a><span class="lineno"> 7441</span>&#160;        <span class="comment">// Replace the uses of Use with uses of the updated base value.</span></div><div class="line"><a name="l07442"></a><span class="lineno"> 7442</span>&#160;        DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#ac630ccda26fea2f45afa3fb89bc1a8f4">ReplaceAllUsesOfValueWith</a>(<a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(Op, 0),</div><div class="line"><a name="l07443"></a><span class="lineno"> 7443</span>&#160;                                      Result.<a class="code" href="classllvm_1_1SDValue.html#a040481b9bda32faa6b1435532405d88f">getValue</a>(isLoad ? 1 : 0));</div><div class="line"><a name="l07444"></a><span class="lineno"> 7444</span>&#160;        removeFromWorkList(Op);</div><div class="line"><a name="l07445"></a><span class="lineno"> 7445</span>&#160;        DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a5f57dcbedc16dced31c61f7bbbb06ded">DeleteNode</a>(Op);</div><div class="line"><a name="l07446"></a><span class="lineno"> 7446</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l07447"></a><span class="lineno"> 7447</span>&#160;      }</div><div class="line"><a name="l07448"></a><span class="lineno"> 7448</span>&#160;    }</div><div class="line"><a name="l07449"></a><span class="lineno"> 7449</span>&#160;  }</div><div class="line"><a name="l07450"></a><span class="lineno"> 7450</span>&#160;</div><div class="line"><a name="l07451"></a><span class="lineno"> 7451</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l07452"></a><span class="lineno"> 7452</span>&#160;}</div><div class="line"><a name="l07453"></a><span class="lineno"> 7453</span>&#160;</div><div class="line"><a name="l07454"></a><span class="lineno"> 7454</span>&#160;<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::visitLOAD(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N) {</div><div class="line"><a name="l07455"></a><span class="lineno"> 7455</span>&#160;  <a class="code" href="classllvm_1_1LoadSDNode.html">LoadSDNode</a> *<a class="code" href="namespacellvm_1_1A64DB.html#a6fce8157775f3ec93f326b52b0f1e0f5ad61b145eb8cbab18feb1b2e2ce269a7e">LD</a>  = cast&lt;LoadSDNode&gt;(<a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>);</div><div class="line"><a name="l07456"></a><span class="lineno"> 7456</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Chain = LD-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#ae3cb6fbf8c8cb79e10ac61bd98c85211">getChain</a>();</div><div class="line"><a name="l07457"></a><span class="lineno"> 7457</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Ptr   = LD-&gt;<a class="code" href="classllvm_1_1LoadSDNode.html#a3ded48ce66b58b7e7e143991df5dbfae">getBasePtr</a>();</div><div class="line"><a name="l07458"></a><span class="lineno"> 7458</span>&#160;</div><div class="line"><a name="l07459"></a><span class="lineno"> 7459</span>&#160;  <span class="comment">// If load is not volatile and there are no uses of the loaded value (and</span></div><div class="line"><a name="l07460"></a><span class="lineno"> 7460</span>&#160;  <span class="comment">// the updated indexed value in case of indexed loads), change uses of the</span></div><div class="line"><a name="l07461"></a><span class="lineno"> 7461</span>&#160;  <span class="comment">// chain value into uses of the chain input (i.e. delete the dead load).</span></div><div class="line"><a name="l07462"></a><span class="lineno"> 7462</span>&#160;  <span class="keywordflow">if</span> (!LD-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#acd3bb9ee2ec53fa4be1fdf155b0b5a17">isVolatile</a>()) {</div><div class="line"><a name="l07463"></a><span class="lineno"> 7463</span>&#160;    <span class="keywordflow">if</span> (N-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(1) == <a class="code" href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50ca62a222acce6360abd2726719fabc2797">MVT::Other</a>) {</div><div class="line"><a name="l07464"></a><span class="lineno"> 7464</span>&#160;      <span class="comment">// Unindexed loads.</span></div><div class="line"><a name="l07465"></a><span class="lineno"> 7465</span>&#160;      <span class="keywordflow">if</span> (!N-&gt;<a class="code" href="classllvm_1_1SDNode.html#ae4cb676e77b9f238058c70faa609a5d7">hasAnyUseOfValue</a>(0)) {</div><div class="line"><a name="l07466"></a><span class="lineno"> 7466</span>&#160;        <span class="comment">// It&#39;s not safe to use the two value CombineTo variant here. e.g.</span></div><div class="line"><a name="l07467"></a><span class="lineno"> 7467</span>&#160;        <span class="comment">// v1, chain2 = load chain1, loc</span></div><div class="line"><a name="l07468"></a><span class="lineno"> 7468</span>&#160;        <span class="comment">// v2, chain3 = load chain2, loc</span></div><div class="line"><a name="l07469"></a><span class="lineno"> 7469</span>&#160;        <span class="comment">// v3         = add v2, c</span></div><div class="line"><a name="l07470"></a><span class="lineno"> 7470</span>&#160;        <span class="comment">// Now we replace use of chain2 with chain1.  This makes the second load</span></div><div class="line"><a name="l07471"></a><span class="lineno"> 7471</span>&#160;        <span class="comment">// isomorphic to the one we are deleting, and thus makes this load live.</span></div><div class="line"><a name="l07472"></a><span class="lineno"> 7472</span>&#160;        <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;\nReplacing.6 &quot;</span>;</div><div class="line"><a name="l07473"></a><span class="lineno"> 7473</span>&#160;              N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a535ca517df1b4ae62e75475141e65787">dump</a>(&amp;DAG);</div><div class="line"><a name="l07474"></a><span class="lineno"> 7474</span>&#160;              <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;\nWith chain: &quot;</span>;</div><div class="line"><a name="l07475"></a><span class="lineno"> 7475</span>&#160;              Chain.getNode()-&gt;dump(&amp;DAG);</div><div class="line"><a name="l07476"></a><span class="lineno"> 7476</span>&#160;              <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line"><a name="l07477"></a><span class="lineno"> 7477</span>&#160;        WorkListRemover DeadNodes(*<span class="keyword">this</span>);</div><div class="line"><a name="l07478"></a><span class="lineno"> 7478</span>&#160;        DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#ac630ccda26fea2f45afa3fb89bc1a8f4">ReplaceAllUsesOfValueWith</a>(<a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(N, 1), Chain);</div><div class="line"><a name="l07479"></a><span class="lineno"> 7479</span>&#160;</div><div class="line"><a name="l07480"></a><span class="lineno"> 7480</span>&#160;        <span class="keywordflow">if</span> (N-&gt;<a class="code" href="classllvm_1_1SDNode.html#afc071edeb7e2007d000374eba843f76a">use_empty</a>()) {</div><div class="line"><a name="l07481"></a><span class="lineno"> 7481</span>&#160;          removeFromWorkList(N);</div><div class="line"><a name="l07482"></a><span class="lineno"> 7482</span>&#160;          DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a5f57dcbedc16dced31c61f7bbbb06ded">DeleteNode</a>(N);</div><div class="line"><a name="l07483"></a><span class="lineno"> 7483</span>&#160;        }</div><div class="line"><a name="l07484"></a><span class="lineno"> 7484</span>&#160;</div><div class="line"><a name="l07485"></a><span class="lineno"> 7485</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(N, 0);   <span class="comment">// Return N so it doesn&#39;t get rechecked!</span></div><div class="line"><a name="l07486"></a><span class="lineno"> 7486</span>&#160;      }</div><div class="line"><a name="l07487"></a><span class="lineno"> 7487</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l07488"></a><span class="lineno"> 7488</span>&#160;      <span class="comment">// Indexed loads.</span></div><div class="line"><a name="l07489"></a><span class="lineno"> 7489</span>&#160;      assert(N-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(2) == <a class="code" href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50ca62a222acce6360abd2726719fabc2797">MVT::Other</a> &amp;&amp; <span class="stringliteral">&quot;Malformed indexed loads?&quot;</span>);</div><div class="line"><a name="l07490"></a><span class="lineno"> 7490</span>&#160;      <span class="keywordflow">if</span> (!N-&gt;<a class="code" href="classllvm_1_1SDNode.html#ae4cb676e77b9f238058c70faa609a5d7">hasAnyUseOfValue</a>(0) &amp;&amp; !N-&gt;<a class="code" href="classllvm_1_1SDNode.html#ae4cb676e77b9f238058c70faa609a5d7">hasAnyUseOfValue</a>(1)) {</div><div class="line"><a name="l07491"></a><span class="lineno"> 7491</span>&#160;        <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> <a class="code" href="namespacellvm_1_1RegState.html#a079b254e749130fbe5d740f314ca92daab502f975742e9bff6d6dd7b49439b806">Undef</a> = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a5b0e59823444a55c295af279611a9d24">getUNDEF</a>(N-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(0));</div><div class="line"><a name="l07492"></a><span class="lineno"> 7492</span>&#160;        <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;\nReplacing.7 &quot;</span>;</div><div class="line"><a name="l07493"></a><span class="lineno"> 7493</span>&#160;              N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a535ca517df1b4ae62e75475141e65787">dump</a>(&amp;DAG);</div><div class="line"><a name="l07494"></a><span class="lineno"> 7494</span>&#160;              <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;\nWith: &quot;</span>;</div><div class="line"><a name="l07495"></a><span class="lineno"> 7495</span>&#160;              Undef.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()-&gt;<a class="code" href="classllvm_1_1SDNode.html#a535ca517df1b4ae62e75475141e65787">dump</a>(&amp;DAG);</div><div class="line"><a name="l07496"></a><span class="lineno"> 7496</span>&#160;              <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot; and 2 other values\n&quot;</span>);</div><div class="line"><a name="l07497"></a><span class="lineno"> 7497</span>&#160;        WorkListRemover DeadNodes(*<span class="keyword">this</span>);</div><div class="line"><a name="l07498"></a><span class="lineno"> 7498</span>&#160;        DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#ac630ccda26fea2f45afa3fb89bc1a8f4">ReplaceAllUsesOfValueWith</a>(<a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(N, 0), Undef);</div><div class="line"><a name="l07499"></a><span class="lineno"> 7499</span>&#160;        DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#ac630ccda26fea2f45afa3fb89bc1a8f4">ReplaceAllUsesOfValueWith</a>(<a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(N, 1),</div><div class="line"><a name="l07500"></a><span class="lineno"> 7500</span>&#160;                                      DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a5b0e59823444a55c295af279611a9d24">getUNDEF</a>(N-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(1)));</div><div class="line"><a name="l07501"></a><span class="lineno"> 7501</span>&#160;        DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#ac630ccda26fea2f45afa3fb89bc1a8f4">ReplaceAllUsesOfValueWith</a>(<a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(N, 2), Chain);</div><div class="line"><a name="l07502"></a><span class="lineno"> 7502</span>&#160;        removeFromWorkList(N);</div><div class="line"><a name="l07503"></a><span class="lineno"> 7503</span>&#160;        DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a5f57dcbedc16dced31c61f7bbbb06ded">DeleteNode</a>(N);</div><div class="line"><a name="l07504"></a><span class="lineno"> 7504</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(N, 0);   <span class="comment">// Return N so it doesn&#39;t get rechecked!</span></div><div class="line"><a name="l07505"></a><span class="lineno"> 7505</span>&#160;      }</div><div class="line"><a name="l07506"></a><span class="lineno"> 7506</span>&#160;    }</div><div class="line"><a name="l07507"></a><span class="lineno"> 7507</span>&#160;  }</div><div class="line"><a name="l07508"></a><span class="lineno"> 7508</span>&#160;</div><div class="line"><a name="l07509"></a><span class="lineno"> 7509</span>&#160;  <span class="comment">// If this load is directly stored, replace the load value with the stored</span></div><div class="line"><a name="l07510"></a><span class="lineno"> 7510</span>&#160;  <span class="comment">// value.</span></div><div class="line"><a name="l07511"></a><span class="lineno"> 7511</span>&#160;  <span class="comment">// TODO: Handle store large -&gt; read small portion.</span></div><div class="line"><a name="l07512"></a><span class="lineno"> 7512</span>&#160;  <span class="comment">// TODO: Handle TRUNCSTORE/LOADEXT</span></div><div class="line"><a name="l07513"></a><span class="lineno"> 7513</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1ISD.html#afaaeadcd82b42fc0d385a6247bf7bb52">ISD::isNormalLoad</a>(N) &amp;&amp; !LD-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#acd3bb9ee2ec53fa4be1fdf155b0b5a17">isVolatile</a>()) {</div><div class="line"><a name="l07514"></a><span class="lineno"> 7514</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1ISD.html#abfb4d7af9b241a75a155d468678c4fc1">ISD::isNON_TRUNCStore</a>(Chain.getNode())) {</div><div class="line"><a name="l07515"></a><span class="lineno"> 7515</span>&#160;      <a class="code" href="classllvm_1_1StoreSDNode.html">StoreSDNode</a> *PrevST = cast&lt;StoreSDNode&gt;(Chain);</div><div class="line"><a name="l07516"></a><span class="lineno"> 7516</span>&#160;      <span class="keywordflow">if</span> (PrevST-&gt;<a class="code" href="classllvm_1_1StoreSDNode.html#aec453733fbb9f24036960fdc6b3b4b46">getBasePtr</a>() == Ptr &amp;&amp;</div><div class="line"><a name="l07517"></a><span class="lineno"> 7517</span>&#160;          PrevST-&gt;<a class="code" href="classllvm_1_1StoreSDNode.html#a7f9820a84907a5aa530d4dc36f841c76">getValue</a>().<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>() == N-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(0))</div><div class="line"><a name="l07518"></a><span class="lineno"> 7518</span>&#160;      <span class="keywordflow">return</span> CombineTo(N, Chain.<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(1), Chain);</div><div class="line"><a name="l07519"></a><span class="lineno"> 7519</span>&#160;    }</div><div class="line"><a name="l07520"></a><span class="lineno"> 7520</span>&#160;  }</div><div class="line"><a name="l07521"></a><span class="lineno"> 7521</span>&#160;</div><div class="line"><a name="l07522"></a><span class="lineno"> 7522</span>&#160;  <span class="comment">// Try to infer better alignment information than the load already has.</span></div><div class="line"><a name="l07523"></a><span class="lineno"> 7523</span>&#160;  <span class="keywordflow">if</span> (OptLevel != <a class="code" href="namespacellvm_1_1CodeGenOpt.html#a411055ea15209051c2370bbf655ec8d4a451bbac85aff02d070be3c17a6bef928">CodeGenOpt::None</a> &amp;&amp; LD-&gt;<a class="code" href="classllvm_1_1LSBaseSDNode.html#a958114b87bff3b4db5ae7766d44dc375">isUnindexed</a>()) {</div><div class="line"><a name="l07524"></a><span class="lineno"> 7524</span>&#160;    <span class="keywordflow">if</span> (<span class="keywordtype">unsigned</span> <a class="code" href="ARMSubtarget_8cpp.html#a4bd80d4e433d9f72af26b364036900dc">Align</a> = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a2bf689949a7a6c115298d4f8e4f637cd">InferPtrAlignment</a>(Ptr)) {</div><div class="line"><a name="l07525"></a><span class="lineno"> 7525</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="ARMSubtarget_8cpp.html#a4bd80d4e433d9f72af26b364036900dc">Align</a> &gt; LD-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a89e2b5e3fb867b4040f893c6ae3d2132">getMemOperand</a>()-&gt;<a class="code" href="classllvm_1_1MachineMemOperand.html#a9700a86585614c5beedfdf3e8d7fb9d1">getBaseAlignment</a>()) {</div><div class="line"><a name="l07526"></a><span class="lineno"> 7526</span>&#160;        <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> NewLoad =</div><div class="line"><a name="l07527"></a><span class="lineno"> 7527</span>&#160;               DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#ad6ff413bea6f8195d8e6f29f4fc519c4">getExtLoad</a>(LD-&gt;<a class="code" href="classllvm_1_1LoadSDNode.html#af15fb8b2d4c9f295bdcf85a1eb506702">getExtensionType</a>(), <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N),</div><div class="line"><a name="l07528"></a><span class="lineno"> 7528</span>&#160;                              LD-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(0),</div><div class="line"><a name="l07529"></a><span class="lineno"> 7529</span>&#160;                              Chain, Ptr, LD-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a2fa8491ab36125d7f5dd38d3a4868934">getPointerInfo</a>(),</div><div class="line"><a name="l07530"></a><span class="lineno"> 7530</span>&#160;                              LD-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a7cead3a2a7771e61083bcc6959915a13">getMemoryVT</a>(),</div><div class="line"><a name="l07531"></a><span class="lineno"> 7531</span>&#160;                              LD-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#acd3bb9ee2ec53fa4be1fdf155b0b5a17">isVolatile</a>(), LD-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a967ffaf77f64a5deb1e96951e4224112">isNonTemporal</a>(), <a class="code" href="ARMSubtarget_8cpp.html#a4bd80d4e433d9f72af26b364036900dc">Align</a>,</div><div class="line"><a name="l07532"></a><span class="lineno"> 7532</span>&#160;                              LD-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a23670ceb5797afa3d45ca1a9b011fd87">getTBAAInfo</a>());</div><div class="line"><a name="l07533"></a><span class="lineno"> 7533</span>&#160;        <span class="keywordflow">return</span> CombineTo(N, NewLoad, <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(NewLoad.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>(), 1), <span class="keyword">true</span>);</div><div class="line"><a name="l07534"></a><span class="lineno"> 7534</span>&#160;      }</div><div class="line"><a name="l07535"></a><span class="lineno"> 7535</span>&#160;    }</div><div class="line"><a name="l07536"></a><span class="lineno"> 7536</span>&#160;  }</div><div class="line"><a name="l07537"></a><span class="lineno"> 7537</span>&#160;</div><div class="line"><a name="l07538"></a><span class="lineno"> 7538</span>&#160;  <span class="keywordtype">bool</span> UseAA = CombinerAA.getNumOccurrences() &gt; 0 ? CombinerAA :</div><div class="line"><a name="l07539"></a><span class="lineno"> 7539</span>&#160;    TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#ada5f4a5dd489c777870538cdbb6da228">getTargetMachine</a>().<a class="code" href="classllvm_1_1TargetMachine.html#a5af2fed99951774b6a14d30ec6e73792">getSubtarget</a>&lt;<a class="code" href="classllvm_1_1TargetSubtargetInfo.html">TargetSubtargetInfo</a>&gt;().useAA();</div><div class="line"><a name="l07540"></a><span class="lineno"> 7540</span>&#160;  <span class="keywordflow">if</span> (UseAA) {</div><div class="line"><a name="l07541"></a><span class="lineno"> 7541</span>&#160;    <span class="comment">// Walk up chain skipping non-aliasing memory nodes.</span></div><div class="line"><a name="l07542"></a><span class="lineno"> 7542</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> BetterChain = FindBetterChain(N, Chain);</div><div class="line"><a name="l07543"></a><span class="lineno"> 7543</span>&#160;</div><div class="line"><a name="l07544"></a><span class="lineno"> 7544</span>&#160;    <span class="comment">// If there is a better chain.</span></div><div class="line"><a name="l07545"></a><span class="lineno"> 7545</span>&#160;    <span class="keywordflow">if</span> (Chain != BetterChain) {</div><div class="line"><a name="l07546"></a><span class="lineno"> 7546</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> ReplLoad;</div><div class="line"><a name="l07547"></a><span class="lineno"> 7547</span>&#160;</div><div class="line"><a name="l07548"></a><span class="lineno"> 7548</span>&#160;      <span class="comment">// Replace the chain to void dependency.</span></div><div class="line"><a name="l07549"></a><span class="lineno"> 7549</span>&#160;      <span class="keywordflow">if</span> (LD-&gt;<a class="code" href="classllvm_1_1LoadSDNode.html#af15fb8b2d4c9f295bdcf85a1eb506702">getExtensionType</a>() == <a class="code" href="namespacellvm_1_1ISD.html#ad4d48171b87ca51ff54c10a436bac4d7a6aacde2c67988b43a261a7f7ceac4be3">ISD::NON_EXTLOAD</a>) {</div><div class="line"><a name="l07550"></a><span class="lineno"> 7550</span>&#160;        ReplLoad = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#ab8395be5698f080c0036d866e121a478">getLoad</a>(N-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(0), <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(LD),</div><div class="line"><a name="l07551"></a><span class="lineno"> 7551</span>&#160;                               BetterChain, Ptr, LD-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a89e2b5e3fb867b4040f893c6ae3d2132">getMemOperand</a>());</div><div class="line"><a name="l07552"></a><span class="lineno"> 7552</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l07553"></a><span class="lineno"> 7553</span>&#160;        ReplLoad = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#ad6ff413bea6f8195d8e6f29f4fc519c4">getExtLoad</a>(LD-&gt;<a class="code" href="classllvm_1_1LoadSDNode.html#af15fb8b2d4c9f295bdcf85a1eb506702">getExtensionType</a>(), <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(LD),</div><div class="line"><a name="l07554"></a><span class="lineno"> 7554</span>&#160;                                  LD-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(0),</div><div class="line"><a name="l07555"></a><span class="lineno"> 7555</span>&#160;                                  BetterChain, Ptr, LD-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a7cead3a2a7771e61083bcc6959915a13">getMemoryVT</a>(),</div><div class="line"><a name="l07556"></a><span class="lineno"> 7556</span>&#160;                                  LD-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a89e2b5e3fb867b4040f893c6ae3d2132">getMemOperand</a>());</div><div class="line"><a name="l07557"></a><span class="lineno"> 7557</span>&#160;      }</div><div class="line"><a name="l07558"></a><span class="lineno"> 7558</span>&#160;</div><div class="line"><a name="l07559"></a><span class="lineno"> 7559</span>&#160;      <span class="comment">// Create token factor to keep old chain connected.</span></div><div class="line"><a name="l07560"></a><span class="lineno"> 7560</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Token = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ad469508535ce2082a1ab1f0e429187b8">ISD::TokenFactor</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N),</div><div class="line"><a name="l07561"></a><span class="lineno"> 7561</span>&#160;                                  <a class="code" href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50ca62a222acce6360abd2726719fabc2797">MVT::Other</a>, Chain, ReplLoad.<a class="code" href="classllvm_1_1SDValue.html#a040481b9bda32faa6b1435532405d88f">getValue</a>(1));</div><div class="line"><a name="l07562"></a><span class="lineno"> 7562</span>&#160;</div><div class="line"><a name="l07563"></a><span class="lineno"> 7563</span>&#160;      <span class="comment">// Make sure the new and old chains are cleaned up.</span></div><div class="line"><a name="l07564"></a><span class="lineno"> 7564</span>&#160;      AddToWorkList(Token.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l07565"></a><span class="lineno"> 7565</span>&#160;</div><div class="line"><a name="l07566"></a><span class="lineno"> 7566</span>&#160;      <span class="comment">// Replace uses with load result and token factor. Don&#39;t add users</span></div><div class="line"><a name="l07567"></a><span class="lineno"> 7567</span>&#160;      <span class="comment">// to work list.</span></div><div class="line"><a name="l07568"></a><span class="lineno"> 7568</span>&#160;      <span class="keywordflow">return</span> CombineTo(N, ReplLoad.<a class="code" href="classllvm_1_1SDValue.html#a040481b9bda32faa6b1435532405d88f">getValue</a>(0), Token, <span class="keyword">false</span>);</div><div class="line"><a name="l07569"></a><span class="lineno"> 7569</span>&#160;    }</div><div class="line"><a name="l07570"></a><span class="lineno"> 7570</span>&#160;  }</div><div class="line"><a name="l07571"></a><span class="lineno"> 7571</span>&#160;</div><div class="line"><a name="l07572"></a><span class="lineno"> 7572</span>&#160;  <span class="comment">// Try transforming N to an indexed load.</span></div><div class="line"><a name="l07573"></a><span class="lineno"> 7573</span>&#160;  <span class="keywordflow">if</span> (CombineToPreIndexedLoadStore(N) || CombineToPostIndexedLoadStore(N))</div><div class="line"><a name="l07574"></a><span class="lineno"> 7574</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(N, 0);</div><div class="line"><a name="l07575"></a><span class="lineno"> 7575</span>&#160;</div><div class="line"><a name="l07576"></a><span class="lineno"> 7576</span>&#160;  <span class="comment">// Try to slice up N to more direct loads if the slices are mapped to</span></div><div class="line"><a name="l07577"></a><span class="lineno"> 7577</span>&#160;  <span class="comment">// different register banks or pairing can take place.</span></div><div class="line"><a name="l07578"></a><span class="lineno"> 7578</span>&#160;  <span class="keywordflow">if</span> (SliceUpLoad(N))</div><div class="line"><a name="l07579"></a><span class="lineno"> 7579</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(N, 0);</div><div class="line"><a name="l07580"></a><span class="lineno"> 7580</span>&#160;</div><div class="line"><a name="l07581"></a><span class="lineno"> 7581</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l07582"></a><span class="lineno"> 7582</span>&#160;}</div><div class="line"><a name="l07583"></a><span class="lineno"> 7583</span>&#160;</div><div class="line"><a name="l07584"></a><span class="lineno"> 7584</span>&#160;<span class="keyword">namespace </span>{<span class="comment"></span></div><div class="line"><a name="l07585"></a><span class="lineno"> 7585</span>&#160;<span class="comment">/// \brief Helper structure used to slice a load in smaller loads.</span></div><div class="line"><a name="l07586"></a><span class="lineno"> 7586</span>&#160;<span class="comment">/// Basically a slice is obtained from the following sequence:</span></div><div class="line"><a name="l07587"></a><span class="lineno"> 7587</span>&#160;<span class="comment">/// Origin = load Ty1, Base</span></div><div class="line"><a name="l07588"></a><span class="lineno"> 7588</span>&#160;<span class="comment">/// Shift = srl Ty1 Origin, CstTy Amount</span></div><div class="line"><a name="l07589"></a><span class="lineno"> 7589</span>&#160;<span class="comment">/// Inst = trunc Shift to Ty2</span></div><div class="line"><a name="l07590"></a><span class="lineno"> 7590</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l07591"></a><span class="lineno"> 7591</span>&#160;<span class="comment">/// Then, it will be rewriten into:</span></div><div class="line"><a name="l07592"></a><span class="lineno"> 7592</span>&#160;<span class="comment">/// Slice = load SliceTy, Base + SliceOffset</span></div><div class="line"><a name="l07593"></a><span class="lineno"> 7593</span>&#160;<span class="comment">/// [Inst = zext Slice to Ty2], only if SliceTy &lt;&gt; Ty2</span></div><div class="line"><a name="l07594"></a><span class="lineno"> 7594</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l07595"></a><span class="lineno"> 7595</span>&#160;<span class="comment">/// SliceTy is deduced from the number of bits that are actually used to</span></div><div class="line"><a name="l07596"></a><span class="lineno"> 7596</span>&#160;<span class="comment">/// build Inst.</span></div><div class="line"><a name="l07597"></a><span class="lineno"> 7597</span>&#160;<span class="comment"></span><span class="keyword">struct </span>LoadedSlice {<span class="comment"></span></div><div class="line"><a name="l07598"></a><span class="lineno"> 7598</span>&#160;<span class="comment">  /// \brief Helper structure used to compute the cost of a slice.</span></div><div class="line"><a name="l07599"></a><span class="lineno"> 7599</span>&#160;<span class="comment"></span>  <span class="keyword">struct </span>Cost {<span class="comment"></span></div><div class="line"><a name="l07600"></a><span class="lineno"> 7600</span>&#160;<span class="comment">    /// Are we optimizing for code size.</span></div><div class="line"><a name="l07601"></a><span class="lineno"> 7601</span>&#160;<span class="comment"></span>    <span class="keywordtype">bool</span> ForCodeSize;<span class="comment"></span></div><div class="line"><a name="l07602"></a><span class="lineno"> 7602</span>&#160;<span class="comment">    /// Various cost.</span></div><div class="line"><a name="l07603"></a><span class="lineno"> 7603</span>&#160;<span class="comment"></span>    <span class="keywordtype">unsigned</span> Loads;</div><div class="line"><a name="l07604"></a><span class="lineno"> 7604</span>&#160;    <span class="keywordtype">unsigned</span> Truncates;</div><div class="line"><a name="l07605"></a><span class="lineno"> 7605</span>&#160;    <span class="keywordtype">unsigned</span> CrossRegisterBanksCopies;</div><div class="line"><a name="l07606"></a><span class="lineno"> 7606</span>&#160;    <span class="keywordtype">unsigned</span> ZExts;</div><div class="line"><a name="l07607"></a><span class="lineno"> 7607</span>&#160;    <span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#a8db36c82f32d6f6a4d35a00e55be03a8">Shift</a>;</div><div class="line"><a name="l07608"></a><span class="lineno"> 7608</span>&#160;</div><div class="line"><a name="l07609"></a><span class="lineno"> 7609</span>&#160;    Cost(<span class="keywordtype">bool</span> ForCodeSize = <span class="keyword">false</span>)</div><div class="line"><a name="l07610"></a><span class="lineno"> 7610</span>&#160;        : ForCodeSize(ForCodeSize), Loads(0), Truncates(0),</div><div class="line"><a name="l07611"></a><span class="lineno"> 7611</span>&#160;          CrossRegisterBanksCopies(0), ZExts(0), <a class="code" href="Target_2README_8txt.html#a8db36c82f32d6f6a4d35a00e55be03a8">Shift</a>(0) {}</div><div class="line"><a name="l07612"></a><span class="lineno"> 7612</span>&#160;<span class="comment"></span></div><div class="line"><a name="l07613"></a><span class="lineno"> 7613</span>&#160;<span class="comment">    /// \brief Get the cost of one isolated slice.</span></div><div class="line"><a name="l07614"></a><span class="lineno"> 7614</span>&#160;<span class="comment"></span>    Cost(<span class="keyword">const</span> LoadedSlice &amp;<a class="code" href="namespacellvm_1_1A64CC.html#af5804bc0518be9568f73db566e4d6f46a262de230e8b3511eaf693762cabdc1ca">LS</a>, <span class="keywordtype">bool</span> ForCodeSize = <span class="keyword">false</span>)</div><div class="line"><a name="l07615"></a><span class="lineno"> 7615</span>&#160;        : ForCodeSize(ForCodeSize), Loads(1), Truncates(0),</div><div class="line"><a name="l07616"></a><span class="lineno"> 7616</span>&#160;          CrossRegisterBanksCopies(0), ZExts(0), <a class="code" href="Target_2README_8txt.html#a8db36c82f32d6f6a4d35a00e55be03a8">Shift</a>(0) {</div><div class="line"><a name="l07617"></a><span class="lineno"> 7617</span>&#160;      <a class="code" href="structllvm_1_1EVT.html">EVT</a> TruncType = LS.Inst-&gt;getValueType(0);</div><div class="line"><a name="l07618"></a><span class="lineno"> 7618</span>&#160;      <a class="code" href="structllvm_1_1EVT.html">EVT</a> LoadedType = LS.getLoadedType();</div><div class="line"><a name="l07619"></a><span class="lineno"> 7619</span>&#160;      <span class="keywordflow">if</span> (TruncType != LoadedType &amp;&amp;</div><div class="line"><a name="l07620"></a><span class="lineno"> 7620</span>&#160;          !LS.DAG-&gt;getTargetLoweringInfo().isZExtFree(LoadedType, TruncType))</div><div class="line"><a name="l07621"></a><span class="lineno"> 7621</span>&#160;        ZExts = 1;</div><div class="line"><a name="l07622"></a><span class="lineno"> 7622</span>&#160;    }</div><div class="line"><a name="l07623"></a><span class="lineno"> 7623</span>&#160;<span class="comment"></span></div><div class="line"><a name="l07624"></a><span class="lineno"> 7624</span>&#160;<span class="comment">    /// \brief Account for slicing gain in the current cost.</span></div><div class="line"><a name="l07625"></a><span class="lineno"> 7625</span>&#160;<span class="comment">    /// Slicing provide a few gains like removing a shift or a</span></div><div class="line"><a name="l07626"></a><span class="lineno"> 7626</span>&#160;<span class="comment">    /// truncate. This method allows to grow the cost of the original</span></div><div class="line"><a name="l07627"></a><span class="lineno"> 7627</span>&#160;<span class="comment">    /// load with the gain from this slice.</span></div><div class="line"><a name="l07628"></a><span class="lineno"> 7628</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> addSliceGain(<span class="keyword">const</span> LoadedSlice &amp;LS) {</div><div class="line"><a name="l07629"></a><span class="lineno"> 7629</span>&#160;      <span class="comment">// Each slice saves a truncate.</span></div><div class="line"><a name="l07630"></a><span class="lineno"> 7630</span>&#160;      <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetLowering.html">TargetLowering</a> &amp;TLI = LS.DAG-&gt;getTargetLoweringInfo();</div><div class="line"><a name="l07631"></a><span class="lineno"> 7631</span>&#160;      <span class="keywordflow">if</span> (!TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a00856c52a5a67b38d8332c7842429153">isTruncateFree</a>(LS.Inst-&gt;getValueType(0),</div><div class="line"><a name="l07632"></a><span class="lineno"> 7632</span>&#160;                              LS.Inst-&gt;getOperand(0).getValueType()))</div><div class="line"><a name="l07633"></a><span class="lineno"> 7633</span>&#160;        ++Truncates;</div><div class="line"><a name="l07634"></a><span class="lineno"> 7634</span>&#160;      <span class="comment">// If there is a shift amount, this slice gets rid of it.</span></div><div class="line"><a name="l07635"></a><span class="lineno"> 7635</span>&#160;      <span class="keywordflow">if</span> (LS.Shift)</div><div class="line"><a name="l07636"></a><span class="lineno"> 7636</span>&#160;        ++<a class="code" href="Target_2README_8txt.html#a8db36c82f32d6f6a4d35a00e55be03a8">Shift</a>;</div><div class="line"><a name="l07637"></a><span class="lineno"> 7637</span>&#160;      <span class="comment">// If this slice can merge a cross register bank copy, account for it.</span></div><div class="line"><a name="l07638"></a><span class="lineno"> 7638</span>&#160;      <span class="keywordflow">if</span> (LS.canMergeExpensiveCrossRegisterBankCopy())</div><div class="line"><a name="l07639"></a><span class="lineno"> 7639</span>&#160;        ++CrossRegisterBanksCopies;</div><div class="line"><a name="l07640"></a><span class="lineno"> 7640</span>&#160;    }</div><div class="line"><a name="l07641"></a><span class="lineno"> 7641</span>&#160;</div><div class="line"><a name="l07642"></a><span class="lineno"> 7642</span>&#160;    Cost &amp;<a class="code" href="namespacellvm.html#a0068da90e0fe51c9645b75e2a2235dc1">operator+=</a>(<span class="keyword">const</span> Cost &amp;RHS) {</div><div class="line"><a name="l07643"></a><span class="lineno"> 7643</span>&#160;      Loads += RHS.Loads;</div><div class="line"><a name="l07644"></a><span class="lineno"> 7644</span>&#160;      Truncates += RHS.Truncates;</div><div class="line"><a name="l07645"></a><span class="lineno"> 7645</span>&#160;      CrossRegisterBanksCopies += RHS.CrossRegisterBanksCopies;</div><div class="line"><a name="l07646"></a><span class="lineno"> 7646</span>&#160;      ZExts += RHS.ZExts;</div><div class="line"><a name="l07647"></a><span class="lineno"> 7647</span>&#160;      Shift += RHS.Shift;</div><div class="line"><a name="l07648"></a><span class="lineno"> 7648</span>&#160;      <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div><div class="line"><a name="l07649"></a><span class="lineno"> 7649</span>&#160;    }</div><div class="line"><a name="l07650"></a><span class="lineno"> 7650</span>&#160;</div><div class="line"><a name="l07651"></a><span class="lineno"> 7651</span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="namespacellvm.html#a162c90bc179a6359438d060722bee35f">operator==</a>(<span class="keyword">const</span> Cost &amp;RHS)<span class="keyword"> const </span>{</div><div class="line"><a name="l07652"></a><span class="lineno"> 7652</span>&#160;      <span class="keywordflow">return</span> Loads == RHS.Loads &amp;&amp; Truncates == RHS.Truncates &amp;&amp;</div><div class="line"><a name="l07653"></a><span class="lineno"> 7653</span>&#160;             CrossRegisterBanksCopies == RHS.CrossRegisterBanksCopies &amp;&amp;</div><div class="line"><a name="l07654"></a><span class="lineno"> 7654</span>&#160;             ZExts == RHS.ZExts &amp;&amp; Shift == RHS.Shift;</div><div class="line"><a name="l07655"></a><span class="lineno"> 7655</span>&#160;    }</div><div class="line"><a name="l07656"></a><span class="lineno"> 7656</span>&#160;</div><div class="line"><a name="l07657"></a><span class="lineno"> 7657</span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="namespacellvm.html#a2f883c895f4d244f4ed56ed8a8c160c1">operator!=</a>(<span class="keyword">const</span> Cost &amp;RHS)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> !(*<span class="keyword">this</span> == RHS); }</div><div class="line"><a name="l07658"></a><span class="lineno"> 7658</span>&#160;</div><div class="line"><a name="l07659"></a><span class="lineno"> 7659</span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="namespacellvm.html#a7c469a194119a14e5a018ebb9b847cf0">operator&lt;</a>(<span class="keyword">const</span> Cost &amp;RHS)<span class="keyword"> const </span>{</div><div class="line"><a name="l07660"></a><span class="lineno"> 7660</span>&#160;      <span class="comment">// Assume cross register banks copies are as expensive as loads.</span></div><div class="line"><a name="l07661"></a><span class="lineno"> 7661</span>&#160;      <span class="comment">// FIXME: Do we want some more target hooks?</span></div><div class="line"><a name="l07662"></a><span class="lineno"> 7662</span>&#160;      <span class="keywordtype">unsigned</span> ExpensiveOpsLHS = Loads + CrossRegisterBanksCopies;</div><div class="line"><a name="l07663"></a><span class="lineno"> 7663</span>&#160;      <span class="keywordtype">unsigned</span> ExpensiveOpsRHS = RHS.Loads + RHS.CrossRegisterBanksCopies;</div><div class="line"><a name="l07664"></a><span class="lineno"> 7664</span>&#160;      <span class="comment">// Unless we are optimizing for code size, consider the</span></div><div class="line"><a name="l07665"></a><span class="lineno"> 7665</span>&#160;      <span class="comment">// expensive operation first.</span></div><div class="line"><a name="l07666"></a><span class="lineno"> 7666</span>&#160;      <span class="keywordflow">if</span> (!ForCodeSize &amp;&amp; ExpensiveOpsLHS != ExpensiveOpsRHS)</div><div class="line"><a name="l07667"></a><span class="lineno"> 7667</span>&#160;        <span class="keywordflow">return</span> ExpensiveOpsLHS &lt; ExpensiveOpsRHS;</div><div class="line"><a name="l07668"></a><span class="lineno"> 7668</span>&#160;      <span class="keywordflow">return</span> (Truncates + ZExts + Shift + ExpensiveOpsLHS) &lt;</div><div class="line"><a name="l07669"></a><span class="lineno"> 7669</span>&#160;             (RHS.Truncates + RHS.ZExts + RHS.Shift + ExpensiveOpsRHS);</div><div class="line"><a name="l07670"></a><span class="lineno"> 7670</span>&#160;    }</div><div class="line"><a name="l07671"></a><span class="lineno"> 7671</span>&#160;</div><div class="line"><a name="l07672"></a><span class="lineno"> 7672</span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="namespacellvm.html#a8773fab32deb314deb5c6ad78bc8ec99">operator&gt;</a>(<span class="keyword">const</span> Cost &amp;RHS)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> RHS &lt; *<span class="keyword">this</span>; }</div><div class="line"><a name="l07673"></a><span class="lineno"> 7673</span>&#160;</div><div class="line"><a name="l07674"></a><span class="lineno"> 7674</span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="namespacellvm.html#a191214269543e01221529a5d127c3bcd">operator&lt;=</a>(<span class="keyword">const</span> Cost &amp;RHS)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> !(RHS &lt; *<span class="keyword">this</span>); }</div><div class="line"><a name="l07675"></a><span class="lineno"> 7675</span>&#160;</div><div class="line"><a name="l07676"></a><span class="lineno"> 7676</span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="namespacellvm.html#aeefd21a8a609ad0811323352e2576a28">operator&gt;=</a>(<span class="keyword">const</span> Cost &amp;RHS)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> !(*<span class="keyword">this</span> &lt; RHS); }</div><div class="line"><a name="l07677"></a><span class="lineno"> 7677</span>&#160;  };</div><div class="line"><a name="l07678"></a><span class="lineno"> 7678</span>&#160;  <span class="comment">// The last instruction that represent the slice. This should be a</span></div><div class="line"><a name="l07679"></a><span class="lineno"> 7679</span>&#160;  <span class="comment">// truncate instruction.</span></div><div class="line"><a name="l07680"></a><span class="lineno"> 7680</span>&#160;  <a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *Inst;</div><div class="line"><a name="l07681"></a><span class="lineno"> 7681</span>&#160;  <span class="comment">// The original load instruction.</span></div><div class="line"><a name="l07682"></a><span class="lineno"> 7682</span>&#160;  <a class="code" href="classllvm_1_1LoadSDNode.html">LoadSDNode</a> *Origin;</div><div class="line"><a name="l07683"></a><span class="lineno"> 7683</span>&#160;  <span class="comment">// The right shift amount in bits from the original load.</span></div><div class="line"><a name="l07684"></a><span class="lineno"> 7684</span>&#160;  <span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#a8db36c82f32d6f6a4d35a00e55be03a8">Shift</a>;</div><div class="line"><a name="l07685"></a><span class="lineno"> 7685</span>&#160;  <span class="comment">// The DAG from which Origin came from.</span></div><div class="line"><a name="l07686"></a><span class="lineno"> 7686</span>&#160;  <span class="comment">// This is used to get some contextual information about legal types, etc.</span></div><div class="line"><a name="l07687"></a><span class="lineno"> 7687</span>&#160;  <a class="code" href="classllvm_1_1SelectionDAG.html">SelectionDAG</a> *DAG;</div><div class="line"><a name="l07688"></a><span class="lineno"> 7688</span>&#160;</div><div class="line"><a name="l07689"></a><span class="lineno"> 7689</span>&#160;  LoadedSlice(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *Inst = NULL, <a class="code" href="classllvm_1_1LoadSDNode.html">LoadSDNode</a> *Origin = NULL,</div><div class="line"><a name="l07690"></a><span class="lineno"> 7690</span>&#160;              <span class="keywordtype">unsigned</span> Shift = 0, <a class="code" href="classllvm_1_1SelectionDAG.html">SelectionDAG</a> *DAG = NULL)</div><div class="line"><a name="l07691"></a><span class="lineno"> 7691</span>&#160;      : Inst(Inst), Origin(Origin), <a class="code" href="Target_2README_8txt.html#a8db36c82f32d6f6a4d35a00e55be03a8">Shift</a>(Shift), DAG(DAG) {}</div><div class="line"><a name="l07692"></a><span class="lineno"> 7692</span>&#160;</div><div class="line"><a name="l07693"></a><span class="lineno"> 7693</span>&#160;  LoadedSlice(<span class="keyword">const</span> LoadedSlice &amp;<a class="code" href="namespacellvm_1_1A64CC.html#af5804bc0518be9568f73db566e4d6f46a262de230e8b3511eaf693762cabdc1ca">LS</a>)</div><div class="line"><a name="l07694"></a><span class="lineno"> 7694</span>&#160;      : Inst(LS.Inst), Origin(LS.Origin), <a class="code" href="Target_2README_8txt.html#a8db36c82f32d6f6a4d35a00e55be03a8">Shift</a>(LS.Shift), DAG(LS.DAG) {}</div><div class="line"><a name="l07695"></a><span class="lineno"> 7695</span>&#160;<span class="comment"></span></div><div class="line"><a name="l07696"></a><span class="lineno"> 7696</span>&#160;<span class="comment">  /// \brief Get the bits used in a chunk of bits \p BitWidth large.</span></div><div class="line"><a name="l07697"></a><span class="lineno"> 7697</span>&#160;<span class="comment">  /// \return Result is \p BitWidth and has used bits set to 1 and</span></div><div class="line"><a name="l07698"></a><span class="lineno"> 7698</span>&#160;<span class="comment">  ///         not used bits set to 0.</span></div><div class="line"><a name="l07699"></a><span class="lineno"> 7699</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1APInt.html">APInt</a> getUsedBits()<span class="keyword"> const </span>{</div><div class="line"><a name="l07700"></a><span class="lineno"> 7700</span>&#160;    <span class="comment">// Reproduce the trunc(lshr) sequence:</span></div><div class="line"><a name="l07701"></a><span class="lineno"> 7701</span>&#160;    <span class="comment">// - Start from the truncated value.</span></div><div class="line"><a name="l07702"></a><span class="lineno"> 7702</span>&#160;    <span class="comment">// - Zero extend to the desired bit width.</span></div><div class="line"><a name="l07703"></a><span class="lineno"> 7703</span>&#160;    <span class="comment">// - Shift left.</span></div><div class="line"><a name="l07704"></a><span class="lineno"> 7704</span>&#160;    assert(Origin &amp;&amp; <span class="stringliteral">&quot;No original load to compare against.&quot;</span>);</div><div class="line"><a name="l07705"></a><span class="lineno"> 7705</span>&#160;    <span class="keywordtype">unsigned</span> BitWidth = Origin-&gt;<a class="code" href="classllvm_1_1SDNode.html#a3e579897b3fc3d645d0eea2f3442cfa2">getValueSizeInBits</a>(0);</div><div class="line"><a name="l07706"></a><span class="lineno"> 7706</span>&#160;    assert(Inst &amp;&amp; <span class="stringliteral">&quot;This slice is not bound to an instruction&quot;</span>);</div><div class="line"><a name="l07707"></a><span class="lineno"> 7707</span>&#160;    assert(Inst-&gt;<a class="code" href="classllvm_1_1SDNode.html#a3e579897b3fc3d645d0eea2f3442cfa2">getValueSizeInBits</a>(0) &lt;= BitWidth &amp;&amp;</div><div class="line"><a name="l07708"></a><span class="lineno"> 7708</span>&#160;           <span class="stringliteral">&quot;Extracted slice is bigger than the whole type!&quot;</span>);</div><div class="line"><a name="l07709"></a><span class="lineno"> 7709</span>&#160;    <a class="code" href="classllvm_1_1APInt.html">APInt</a> UsedBits(Inst-&gt;<a class="code" href="classllvm_1_1SDNode.html#a3e579897b3fc3d645d0eea2f3442cfa2">getValueSizeInBits</a>(0), 0);</div><div class="line"><a name="l07710"></a><span class="lineno"> 7710</span>&#160;    UsedBits.<a class="code" href="classllvm_1_1APInt.html#ab6fff8a97bcb55e50e9be0ecf0c99b63">setAllBits</a>();</div><div class="line"><a name="l07711"></a><span class="lineno"> 7711</span>&#160;    UsedBits = UsedBits.zext(BitWidth);</div><div class="line"><a name="l07712"></a><span class="lineno"> 7712</span>&#160;    UsedBits &lt;&lt;= <a class="code" href="Target_2README_8txt.html#a8db36c82f32d6f6a4d35a00e55be03a8">Shift</a>;</div><div class="line"><a name="l07713"></a><span class="lineno"> 7713</span>&#160;    <span class="keywordflow">return</span> UsedBits;</div><div class="line"><a name="l07714"></a><span class="lineno"> 7714</span>&#160;  }</div><div class="line"><a name="l07715"></a><span class="lineno"> 7715</span>&#160;<span class="comment"></span></div><div class="line"><a name="l07716"></a><span class="lineno"> 7716</span>&#160;<span class="comment">  /// \brief Get the size of the slice to be loaded in bytes.</span></div><div class="line"><a name="l07717"></a><span class="lineno"> 7717</span>&#160;<span class="comment"></span>  <span class="keywordtype">unsigned</span> getLoadedSize()<span class="keyword"> const </span>{</div><div class="line"><a name="l07718"></a><span class="lineno"> 7718</span>&#160;    <span class="keywordtype">unsigned</span> SliceSize = getUsedBits().countPopulation();</div><div class="line"><a name="l07719"></a><span class="lineno"> 7719</span>&#160;    assert(!(SliceSize &amp; 0x7) &amp;&amp; <span class="stringliteral">&quot;Size is not a multiple of a byte.&quot;</span>);</div><div class="line"><a name="l07720"></a><span class="lineno"> 7720</span>&#160;    <span class="keywordflow">return</span> SliceSize / 8;</div><div class="line"><a name="l07721"></a><span class="lineno"> 7721</span>&#160;  }</div><div class="line"><a name="l07722"></a><span class="lineno"> 7722</span>&#160;<span class="comment"></span></div><div class="line"><a name="l07723"></a><span class="lineno"> 7723</span>&#160;<span class="comment">  /// \brief Get the type that will be loaded for this slice.</span></div><div class="line"><a name="l07724"></a><span class="lineno"> 7724</span>&#160;<span class="comment">  /// Note: This may not be the final type for the slice.</span></div><div class="line"><a name="l07725"></a><span class="lineno"> 7725</span>&#160;<span class="comment"></span>  <a class="code" href="structllvm_1_1EVT.html">EVT</a> getLoadedType()<span class="keyword"> const </span>{</div><div class="line"><a name="l07726"></a><span class="lineno"> 7726</span>&#160;    assert(DAG &amp;&amp; <span class="stringliteral">&quot;Missing context&quot;</span>);</div><div class="line"><a name="l07727"></a><span class="lineno"> 7727</span>&#160;    <a class="code" href="classllvm_1_1LLVMContext.html">LLVMContext</a> &amp;Ctxt = *DAG-&gt;<a class="code" href="classllvm_1_1SelectionDAG.html#a39c6dff47b8dbd25cfaf6336c7056077">getContext</a>();</div><div class="line"><a name="l07728"></a><span class="lineno"> 7728</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="structllvm_1_1EVT.html#a752372e170e4e7c595bf8810bb52adf2">EVT::getIntegerVT</a>(Ctxt, getLoadedSize() * 8);</div><div class="line"><a name="l07729"></a><span class="lineno"> 7729</span>&#160;  }</div><div class="line"><a name="l07730"></a><span class="lineno"> 7730</span>&#160;<span class="comment"></span></div><div class="line"><a name="l07731"></a><span class="lineno"> 7731</span>&#160;<span class="comment">  /// \brief Get the alignment of the load used for this slice.</span></div><div class="line"><a name="l07732"></a><span class="lineno"> 7732</span>&#160;<span class="comment"></span>  <span class="keywordtype">unsigned</span> getAlignment()<span class="keyword"> const </span>{</div><div class="line"><a name="l07733"></a><span class="lineno"> 7733</span>&#160;    <span class="keywordtype">unsigned</span> Alignment = Origin-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a4f68cd016138440f215ad80c1d6c1e04">getAlignment</a>();</div><div class="line"><a name="l07734"></a><span class="lineno"> 7734</span>&#160;    <span class="keywordtype">unsigned</span> Offset = getOffsetFromBase();</div><div class="line"><a name="l07735"></a><span class="lineno"> 7735</span>&#160;    <span class="keywordflow">if</span> (Offset != 0)</div><div class="line"><a name="l07736"></a><span class="lineno"> 7736</span>&#160;      Alignment = <a class="code" href="namespacellvm.html#af36d7e69ab16b64b2e3a48c83aa9f0f6">MinAlign</a>(Alignment, Alignment + Offset);</div><div class="line"><a name="l07737"></a><span class="lineno"> 7737</span>&#160;    <span class="keywordflow">return</span> Alignment;</div><div class="line"><a name="l07738"></a><span class="lineno"> 7738</span>&#160;  }</div><div class="line"><a name="l07739"></a><span class="lineno"> 7739</span>&#160;<span class="comment"></span></div><div class="line"><a name="l07740"></a><span class="lineno"> 7740</span>&#160;<span class="comment">  /// \brief Check if this slice can be rewritten with legal operations.</span></div><div class="line"><a name="l07741"></a><span class="lineno"> 7741</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> isLegal()<span class="keyword"> const </span>{</div><div class="line"><a name="l07742"></a><span class="lineno"> 7742</span>&#160;    <span class="comment">// An invalid slice is not legal.</span></div><div class="line"><a name="l07743"></a><span class="lineno"> 7743</span>&#160;    <span class="keywordflow">if</span> (!Origin || !Inst || !DAG)</div><div class="line"><a name="l07744"></a><span class="lineno"> 7744</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l07745"></a><span class="lineno"> 7745</span>&#160;</div><div class="line"><a name="l07746"></a><span class="lineno"> 7746</span>&#160;    <span class="comment">// Offsets are for indexed load only, we do not handle that.</span></div><div class="line"><a name="l07747"></a><span class="lineno"> 7747</span>&#160;    <span class="keywordflow">if</span> (Origin-&gt;<a class="code" href="classllvm_1_1LoadSDNode.html#ae769a35bdc5f1748a40134166a312901">getOffset</a>().<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() != <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7c6d8f265e9e16e5debdb9a536b55d3d">ISD::UNDEF</a>)</div><div class="line"><a name="l07748"></a><span class="lineno"> 7748</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l07749"></a><span class="lineno"> 7749</span>&#160;</div><div class="line"><a name="l07750"></a><span class="lineno"> 7750</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetLowering.html">TargetLowering</a> &amp;TLI = DAG-&gt;<a class="code" href="classllvm_1_1SelectionDAG.html#a848b46af8fabd1ab34b28adbc3665609">getTargetLoweringInfo</a>();</div><div class="line"><a name="l07751"></a><span class="lineno"> 7751</span>&#160;</div><div class="line"><a name="l07752"></a><span class="lineno"> 7752</span>&#160;    <span class="comment">// Check that the type is legal.</span></div><div class="line"><a name="l07753"></a><span class="lineno"> 7753</span>&#160;    <a class="code" href="structllvm_1_1EVT.html">EVT</a> SliceType = getLoadedType();</div><div class="line"><a name="l07754"></a><span class="lineno"> 7754</span>&#160;    <span class="keywordflow">if</span> (!TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a861aaccc0f468493e76c011811548804">isTypeLegal</a>(SliceType))</div><div class="line"><a name="l07755"></a><span class="lineno"> 7755</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l07756"></a><span class="lineno"> 7756</span>&#160;</div><div class="line"><a name="l07757"></a><span class="lineno"> 7757</span>&#160;    <span class="comment">// Check that the load is legal for this type.</span></div><div class="line"><a name="l07758"></a><span class="lineno"> 7758</span>&#160;    <span class="keywordflow">if</span> (!TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a055b3905dbbc16fae11510b9ebd1e00c">isOperationLegal</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a269b81f007000306e3e69d0d290c2159">ISD::LOAD</a>, SliceType))</div><div class="line"><a name="l07759"></a><span class="lineno"> 7759</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l07760"></a><span class="lineno"> 7760</span>&#160;</div><div class="line"><a name="l07761"></a><span class="lineno"> 7761</span>&#160;    <span class="comment">// Check that the offset can be computed.</span></div><div class="line"><a name="l07762"></a><span class="lineno"> 7762</span>&#160;    <span class="comment">// 1. Check its type.</span></div><div class="line"><a name="l07763"></a><span class="lineno"> 7763</span>&#160;    <a class="code" href="structllvm_1_1EVT.html">EVT</a> PtrType = Origin-&gt;<a class="code" href="classllvm_1_1LoadSDNode.html#a3ded48ce66b58b7e7e143991df5dbfae">getBasePtr</a>().<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>();</div><div class="line"><a name="l07764"></a><span class="lineno"> 7764</span>&#160;    <span class="keywordflow">if</span> (PtrType == <a class="code" href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50ca707dc1fd6a4179316ffa6ca2516e18dc">MVT::Untyped</a> || PtrType.<a class="code" href="structllvm_1_1EVT.html#a0ca9e22c58f23f19b5c3eb010318b699">isExtended</a>())</div><div class="line"><a name="l07765"></a><span class="lineno"> 7765</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l07766"></a><span class="lineno"> 7766</span>&#160;</div><div class="line"><a name="l07767"></a><span class="lineno"> 7767</span>&#160;    <span class="comment">// 2. Check that it fits in the immediate.</span></div><div class="line"><a name="l07768"></a><span class="lineno"> 7768</span>&#160;    <span class="keywordflow">if</span> (!TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a62fd51d57f54699226813ca9b46c4d24">isLegalAddImmediate</a>(getOffsetFromBase()))</div><div class="line"><a name="l07769"></a><span class="lineno"> 7769</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l07770"></a><span class="lineno"> 7770</span>&#160;</div><div class="line"><a name="l07771"></a><span class="lineno"> 7771</span>&#160;    <span class="comment">// 3. Check that the computation is legal.</span></div><div class="line"><a name="l07772"></a><span class="lineno"> 7772</span>&#160;    <span class="keywordflow">if</span> (!TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a055b3905dbbc16fae11510b9ebd1e00c">isOperationLegal</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a269996b43a1f3e1d1f84a70fd4387535">ISD::ADD</a>, PtrType))</div><div class="line"><a name="l07773"></a><span class="lineno"> 7773</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l07774"></a><span class="lineno"> 7774</span>&#160;</div><div class="line"><a name="l07775"></a><span class="lineno"> 7775</span>&#160;    <span class="comment">// Check that the zext is legal if it needs one.</span></div><div class="line"><a name="l07776"></a><span class="lineno"> 7776</span>&#160;    <a class="code" href="structllvm_1_1EVT.html">EVT</a> TruncateType = Inst-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(0);</div><div class="line"><a name="l07777"></a><span class="lineno"> 7777</span>&#160;    <span class="keywordflow">if</span> (TruncateType != SliceType &amp;&amp;</div><div class="line"><a name="l07778"></a><span class="lineno"> 7778</span>&#160;        !TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a055b3905dbbc16fae11510b9ebd1e00c">isOperationLegal</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a93fdf85eff945f1a668b4915a051453e">ISD::ZERO_EXTEND</a>, TruncateType))</div><div class="line"><a name="l07779"></a><span class="lineno"> 7779</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l07780"></a><span class="lineno"> 7780</span>&#160;</div><div class="line"><a name="l07781"></a><span class="lineno"> 7781</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l07782"></a><span class="lineno"> 7782</span>&#160;  }</div><div class="line"><a name="l07783"></a><span class="lineno"> 7783</span>&#160;<span class="comment"></span></div><div class="line"><a name="l07784"></a><span class="lineno"> 7784</span>&#160;<span class="comment">  /// \brief Get the offset in bytes of this slice in the original chunk of</span></div><div class="line"><a name="l07785"></a><span class="lineno"> 7785</span>&#160;<span class="comment">  /// bits.</span></div><div class="line"><a name="l07786"></a><span class="lineno"> 7786</span>&#160;<span class="comment">  /// \pre DAG != NULL.</span></div><div class="line"><a name="l07787"></a><span class="lineno"> 7787</span>&#160;<span class="comment"></span>  uint64_t getOffsetFromBase()<span class="keyword"> const </span>{</div><div class="line"><a name="l07788"></a><span class="lineno"> 7788</span>&#160;    assert(DAG &amp;&amp; <span class="stringliteral">&quot;Missing context.&quot;</span>);</div><div class="line"><a name="l07789"></a><span class="lineno"> 7789</span>&#160;    <span class="keywordtype">bool</span> IsBigEndian =</div><div class="line"><a name="l07790"></a><span class="lineno"> 7790</span>&#160;        DAG-&gt;<a class="code" href="classllvm_1_1SelectionDAG.html#a848b46af8fabd1ab34b28adbc3665609">getTargetLoweringInfo</a>().<a class="code" href="classllvm_1_1TargetLoweringBase.html#adc25bcc279ccfb5b867c2b7b8eedaa9b">getDataLayout</a>()-&gt;<a class="code" href="classllvm_1_1DataLayout.html#a9b876cc57d1884621f481b26b0892633">isBigEndian</a>();</div><div class="line"><a name="l07791"></a><span class="lineno"> 7791</span>&#160;    assert(!(Shift &amp; 0x7) &amp;&amp; <span class="stringliteral">&quot;Shifts not aligned on Bytes are not supported.&quot;</span>);</div><div class="line"><a name="l07792"></a><span class="lineno"> 7792</span>&#160;    uint64_t Offset = Shift / 8;</div><div class="line"><a name="l07793"></a><span class="lineno"> 7793</span>&#160;    <span class="keywordtype">unsigned</span> TySizeInBytes = Origin-&gt;<a class="code" href="classllvm_1_1SDNode.html#a3e579897b3fc3d645d0eea2f3442cfa2">getValueSizeInBits</a>(0) / 8;</div><div class="line"><a name="l07794"></a><span class="lineno"> 7794</span>&#160;    assert(!(Origin-&gt;<a class="code" href="classllvm_1_1SDNode.html#a3e579897b3fc3d645d0eea2f3442cfa2">getValueSizeInBits</a>(0) &amp; 0x7) &amp;&amp;</div><div class="line"><a name="l07795"></a><span class="lineno"> 7795</span>&#160;           <span class="stringliteral">&quot;The size of the original loaded type is not a multiple of a&quot;</span></div><div class="line"><a name="l07796"></a><span class="lineno"> 7796</span>&#160;           <span class="stringliteral">&quot; byte.&quot;</span>);</div><div class="line"><a name="l07797"></a><span class="lineno"> 7797</span>&#160;    <span class="comment">// If Offset is bigger than TySizeInBytes, it means we are loading all</span></div><div class="line"><a name="l07798"></a><span class="lineno"> 7798</span>&#160;    <span class="comment">// zeros. This should have been optimized before in the process.</span></div><div class="line"><a name="l07799"></a><span class="lineno"> 7799</span>&#160;    assert(TySizeInBytes &gt; Offset &amp;&amp;</div><div class="line"><a name="l07800"></a><span class="lineno"> 7800</span>&#160;           <span class="stringliteral">&quot;Invalid shift amount for given loaded size&quot;</span>);</div><div class="line"><a name="l07801"></a><span class="lineno"> 7801</span>&#160;    <span class="keywordflow">if</span> (IsBigEndian)</div><div class="line"><a name="l07802"></a><span class="lineno"> 7802</span>&#160;      Offset = TySizeInBytes - Offset - getLoadedSize();</div><div class="line"><a name="l07803"></a><span class="lineno"> 7803</span>&#160;    <span class="keywordflow">return</span> Offset;</div><div class="line"><a name="l07804"></a><span class="lineno"> 7804</span>&#160;  }</div><div class="line"><a name="l07805"></a><span class="lineno"> 7805</span>&#160;<span class="comment"></span></div><div class="line"><a name="l07806"></a><span class="lineno"> 7806</span>&#160;<span class="comment">  /// \brief Generate the sequence of instructions to load the slice</span></div><div class="line"><a name="l07807"></a><span class="lineno"> 7807</span>&#160;<span class="comment">  /// represented by this object and redirect the uses of this slice to</span></div><div class="line"><a name="l07808"></a><span class="lineno"> 7808</span>&#160;<span class="comment">  /// this new sequence of instructions.</span></div><div class="line"><a name="l07809"></a><span class="lineno"> 7809</span>&#160;<span class="comment">  /// \pre this-&gt;Inst &amp;&amp; this-&gt;Origin are valid Instructions and this</span></div><div class="line"><a name="l07810"></a><span class="lineno"> 7810</span>&#160;<span class="comment">  /// object passed the legal check: LoadedSlice::isLegal returned true.</span></div><div class="line"><a name="l07811"></a><span class="lineno"> 7811</span>&#160;<span class="comment">  /// \return The last instruction of the sequence used to load the slice.</span></div><div class="line"><a name="l07812"></a><span class="lineno"> 7812</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> loadSlice()<span class="keyword"> const </span>{</div><div class="line"><a name="l07813"></a><span class="lineno"> 7813</span>&#160;    assert(Inst &amp;&amp; Origin &amp;&amp; <span class="stringliteral">&quot;Unable to replace a non-existing slice.&quot;</span>);</div><div class="line"><a name="l07814"></a><span class="lineno"> 7814</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> &amp;OldBaseAddr = Origin-&gt;<a class="code" href="classllvm_1_1LoadSDNode.html#a3ded48ce66b58b7e7e143991df5dbfae">getBasePtr</a>();</div><div class="line"><a name="l07815"></a><span class="lineno"> 7815</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> BaseAddr = OldBaseAddr;</div><div class="line"><a name="l07816"></a><span class="lineno"> 7816</span>&#160;    <span class="comment">// Get the offset in that chunk of bytes w.r.t. the endianess.</span></div><div class="line"><a name="l07817"></a><span class="lineno"> 7817</span>&#160;    int64_t Offset = <span class="keyword">static_cast&lt;</span>int64_t<span class="keyword">&gt;</span>(getOffsetFromBase());</div><div class="line"><a name="l07818"></a><span class="lineno"> 7818</span>&#160;    assert(Offset &gt;= 0 &amp;&amp; <span class="stringliteral">&quot;Offset too big to fit in int64_t!&quot;</span>);</div><div class="line"><a name="l07819"></a><span class="lineno"> 7819</span>&#160;    <span class="keywordflow">if</span> (Offset) {</div><div class="line"><a name="l07820"></a><span class="lineno"> 7820</span>&#160;      <span class="comment">// BaseAddr = BaseAddr + Offset.</span></div><div class="line"><a name="l07821"></a><span class="lineno"> 7821</span>&#160;      <a class="code" href="structllvm_1_1EVT.html">EVT</a> ArithType = BaseAddr.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>();</div><div class="line"><a name="l07822"></a><span class="lineno"> 7822</span>&#160;      BaseAddr = DAG-&gt;<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a269996b43a1f3e1d1f84a70fd4387535">ISD::ADD</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(Origin), ArithType, BaseAddr,</div><div class="line"><a name="l07823"></a><span class="lineno"> 7823</span>&#160;                              DAG-&gt;<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(Offset, ArithType));</div><div class="line"><a name="l07824"></a><span class="lineno"> 7824</span>&#160;    }</div><div class="line"><a name="l07825"></a><span class="lineno"> 7825</span>&#160;</div><div class="line"><a name="l07826"></a><span class="lineno"> 7826</span>&#160;    <span class="comment">// Create the type of the loaded slice according to its size.</span></div><div class="line"><a name="l07827"></a><span class="lineno"> 7827</span>&#160;    <a class="code" href="structllvm_1_1EVT.html">EVT</a> SliceType = getLoadedType();</div><div class="line"><a name="l07828"></a><span class="lineno"> 7828</span>&#160;</div><div class="line"><a name="l07829"></a><span class="lineno"> 7829</span>&#160;    <span class="comment">// Create the load for the slice.</span></div><div class="line"><a name="l07830"></a><span class="lineno"> 7830</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> LastInst = DAG-&gt;<a class="code" href="classllvm_1_1SelectionDAG.html#ab8395be5698f080c0036d866e121a478">getLoad</a>(</div><div class="line"><a name="l07831"></a><span class="lineno"> 7831</span>&#160;        SliceType, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(Origin), Origin-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#ae3cb6fbf8c8cb79e10ac61bd98c85211">getChain</a>(), BaseAddr,</div><div class="line"><a name="l07832"></a><span class="lineno"> 7832</span>&#160;        Origin-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a2fa8491ab36125d7f5dd38d3a4868934">getPointerInfo</a>().<a class="code" href="structllvm_1_1MachinePointerInfo.html#aa7b903b38006dd4cb8fcf8854af5b6b9">getWithOffset</a>(Offset), Origin-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#acd3bb9ee2ec53fa4be1fdf155b0b5a17">isVolatile</a>(),</div><div class="line"><a name="l07833"></a><span class="lineno"> 7833</span>&#160;        Origin-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a967ffaf77f64a5deb1e96951e4224112">isNonTemporal</a>(), Origin-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#ad8e64770a04af6b3da2099477e7c28de">isInvariant</a>(), getAlignment());</div><div class="line"><a name="l07834"></a><span class="lineno"> 7834</span>&#160;    <span class="comment">// If the final type is not the same as the loaded type, this means that</span></div><div class="line"><a name="l07835"></a><span class="lineno"> 7835</span>&#160;    <span class="comment">// we have to pad with zero. Create a zero extend for that.</span></div><div class="line"><a name="l07836"></a><span class="lineno"> 7836</span>&#160;    <a class="code" href="structllvm_1_1EVT.html">EVT</a> FinalType = Inst-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(0);</div><div class="line"><a name="l07837"></a><span class="lineno"> 7837</span>&#160;    <span class="keywordflow">if</span> (SliceType != FinalType)</div><div class="line"><a name="l07838"></a><span class="lineno"> 7838</span>&#160;      LastInst =</div><div class="line"><a name="l07839"></a><span class="lineno"> 7839</span>&#160;          DAG-&gt;<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a93fdf85eff945f1a668b4915a051453e">ISD::ZERO_EXTEND</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(LastInst), FinalType, LastInst);</div><div class="line"><a name="l07840"></a><span class="lineno"> 7840</span>&#160;    <span class="keywordflow">return</span> LastInst;</div><div class="line"><a name="l07841"></a><span class="lineno"> 7841</span>&#160;  }</div><div class="line"><a name="l07842"></a><span class="lineno"> 7842</span>&#160;<span class="comment"></span></div><div class="line"><a name="l07843"></a><span class="lineno"> 7843</span>&#160;<span class="comment">  /// \brief Check if this slice can be merged with an expensive cross register</span></div><div class="line"><a name="l07844"></a><span class="lineno"> 7844</span>&#160;<span class="comment">  /// bank copy. E.g.,</span></div><div class="line"><a name="l07845"></a><span class="lineno"> 7845</span>&#160;<span class="comment">  /// i = load i32</span></div><div class="line"><a name="l07846"></a><span class="lineno"> 7846</span>&#160;<span class="comment">  /// f = bitcast i32 i to float</span></div><div class="line"><a name="l07847"></a><span class="lineno"> 7847</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> canMergeExpensiveCrossRegisterBankCopy()<span class="keyword"> const </span>{</div><div class="line"><a name="l07848"></a><span class="lineno"> 7848</span>&#160;    <span class="keywordflow">if</span> (!Inst || !Inst-&gt;<a class="code" href="classllvm_1_1SDNode.html#a52753947fce3a01b1c18dd4713c587e8">hasOneUse</a>())</div><div class="line"><a name="l07849"></a><span class="lineno"> 7849</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l07850"></a><span class="lineno"> 7850</span>&#160;    <a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *<a class="code" href="classllvm_1_1Use.html">Use</a> = *Inst-&gt;<a class="code" href="classllvm_1_1SDNode.html#a8810bf428dcf84d48f39c8f5ba9a8c94">use_begin</a>();</div><div class="line"><a name="l07851"></a><span class="lineno"> 7851</span>&#160;    <span class="keywordflow">if</span> (Use-&gt;<a class="code" href="classllvm_1_1SDNode.html#af0d328f3f61168f4ea7d6e4044af4f97">getOpcode</a>() != <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a412ddf522b53f07690a86bffba1278e7">ISD::BITCAST</a>)</div><div class="line"><a name="l07852"></a><span class="lineno"> 7852</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l07853"></a><span class="lineno"> 7853</span>&#160;    assert(DAG &amp;&amp; <span class="stringliteral">&quot;Missing context&quot;</span>);</div><div class="line"><a name="l07854"></a><span class="lineno"> 7854</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetLowering.html">TargetLowering</a> &amp;TLI = DAG-&gt;<a class="code" href="classllvm_1_1SelectionDAG.html#a848b46af8fabd1ab34b28adbc3665609">getTargetLoweringInfo</a>();</div><div class="line"><a name="l07855"></a><span class="lineno"> 7855</span>&#160;    <a class="code" href="structllvm_1_1EVT.html">EVT</a> ResVT = Use-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(0);</div><div class="line"><a name="l07856"></a><span class="lineno"> 7856</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetRegisterClass.html">TargetRegisterClass</a> *ResRC = TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a71b07ff24aaa94d58e0e7c35551728d5">getRegClassFor</a>(ResVT.<a class="code" href="structllvm_1_1EVT.html#a5b45953b758fdfe88452530f7d8371bc">getSimpleVT</a>());</div><div class="line"><a name="l07857"></a><span class="lineno"> 7857</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetRegisterClass.html">TargetRegisterClass</a> *ArgRC =</div><div class="line"><a name="l07858"></a><span class="lineno"> 7858</span>&#160;        TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a71b07ff24aaa94d58e0e7c35551728d5">getRegClassFor</a>(Use-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>().<a class="code" href="structllvm_1_1EVT.html#a5b45953b758fdfe88452530f7d8371bc">getSimpleVT</a>());</div><div class="line"><a name="l07859"></a><span class="lineno"> 7859</span>&#160;    <span class="keywordflow">if</span> (ArgRC == ResRC || !TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a055b3905dbbc16fae11510b9ebd1e00c">isOperationLegal</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a269b81f007000306e3e69d0d290c2159">ISD::LOAD</a>, ResVT))</div><div class="line"><a name="l07860"></a><span class="lineno"> 7860</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l07861"></a><span class="lineno"> 7861</span>&#160;</div><div class="line"><a name="l07862"></a><span class="lineno"> 7862</span>&#160;    <span class="comment">// At this point, we know that we perform a cross-register-bank copy.</span></div><div class="line"><a name="l07863"></a><span class="lineno"> 7863</span>&#160;    <span class="comment">// Check if it is expensive.</span></div><div class="line"><a name="l07864"></a><span class="lineno"> 7864</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetRegisterInfo.html">TargetRegisterInfo</a> *TRI = TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#ada5f4a5dd489c777870538cdbb6da228">getTargetMachine</a>().<a class="code" href="classllvm_1_1TargetMachine.html#a70b47eca6a99c87b81f4c1b1455dc090">getRegisterInfo</a>();</div><div class="line"><a name="l07865"></a><span class="lineno"> 7865</span>&#160;    <span class="comment">// Assume bitcasts are cheap, unless both register classes do not</span></div><div class="line"><a name="l07866"></a><span class="lineno"> 7866</span>&#160;    <span class="comment">// explicitly share a common sub class.</span></div><div class="line"><a name="l07867"></a><span class="lineno"> 7867</span>&#160;    <span class="keywordflow">if</span> (!TRI || TRI-&gt;<a class="code" href="classllvm_1_1TargetRegisterInfo.html#a97605349dfd657633ef8afb8c1afa9a6">getCommonSubClass</a>(ArgRC, ResRC))</div><div class="line"><a name="l07868"></a><span class="lineno"> 7868</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l07869"></a><span class="lineno"> 7869</span>&#160;</div><div class="line"><a name="l07870"></a><span class="lineno"> 7870</span>&#160;    <span class="comment">// Check if it will be merged with the load.</span></div><div class="line"><a name="l07871"></a><span class="lineno"> 7871</span>&#160;    <span class="comment">// 1. Check the alignment constraint.</span></div><div class="line"><a name="l07872"></a><span class="lineno"> 7872</span>&#160;    <span class="keywordtype">unsigned</span> RequiredAlignment = TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#adc25bcc279ccfb5b867c2b7b8eedaa9b">getDataLayout</a>()-&gt;<a class="code" href="classllvm_1_1DataLayout.html#abb381519d34dcb9ccf673bf7689d0721">getABITypeAlignment</a>(</div><div class="line"><a name="l07873"></a><span class="lineno"> 7873</span>&#160;        ResVT.<a class="code" href="structllvm_1_1EVT.html#a226345d0c8262e9469d30a993d1656ff">getTypeForEVT</a>(*DAG-&gt;<a class="code" href="classllvm_1_1SelectionDAG.html#a39c6dff47b8dbd25cfaf6336c7056077">getContext</a>()));</div><div class="line"><a name="l07874"></a><span class="lineno"> 7874</span>&#160;</div><div class="line"><a name="l07875"></a><span class="lineno"> 7875</span>&#160;    <span class="keywordflow">if</span> (RequiredAlignment &gt; getAlignment())</div><div class="line"><a name="l07876"></a><span class="lineno"> 7876</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l07877"></a><span class="lineno"> 7877</span>&#160;</div><div class="line"><a name="l07878"></a><span class="lineno"> 7878</span>&#160;    <span class="comment">// 2. Check that the load is a legal operation for that type.</span></div><div class="line"><a name="l07879"></a><span class="lineno"> 7879</span>&#160;    <span class="keywordflow">if</span> (!TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a055b3905dbbc16fae11510b9ebd1e00c">isOperationLegal</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a269b81f007000306e3e69d0d290c2159">ISD::LOAD</a>, ResVT))</div><div class="line"><a name="l07880"></a><span class="lineno"> 7880</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l07881"></a><span class="lineno"> 7881</span>&#160;</div><div class="line"><a name="l07882"></a><span class="lineno"> 7882</span>&#160;    <span class="comment">// 3. Check that we do not have a zext in the way.</span></div><div class="line"><a name="l07883"></a><span class="lineno"> 7883</span>&#160;    <span class="keywordflow">if</span> (Inst-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(0) != getLoadedType())</div><div class="line"><a name="l07884"></a><span class="lineno"> 7884</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l07885"></a><span class="lineno"> 7885</span>&#160;</div><div class="line"><a name="l07886"></a><span class="lineno"> 7886</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l07887"></a><span class="lineno"> 7887</span>&#160;  }</div><div class="line"><a name="l07888"></a><span class="lineno"> 7888</span>&#160;};</div><div class="line"><a name="l07889"></a><span class="lineno"> 7889</span>&#160;}</div><div class="line"><a name="l07890"></a><span class="lineno"> 7890</span>&#160;<span class="comment"></span></div><div class="line"><a name="l07891"></a><span class="lineno"> 7891</span>&#160;<span class="comment">/// \brief Sorts LoadedSlice according to their offset.</span></div><div class="line"><a name="l07892"></a><span class="lineno"><a class="line" href="structLoadedSliceSorter.html"> 7892</a></span>&#160;<span class="comment"></span><span class="keyword">struct </span><a class="code" href="structLoadedSliceSorter.html">LoadedSliceSorter</a> {</div><div class="line"><a name="l07893"></a><span class="lineno"><a class="line" href="structLoadedSliceSorter.html#a687bdab842cbd2351ec1c4361766d6eb"> 7893</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="structLoadedSliceSorter.html#a687bdab842cbd2351ec1c4361766d6eb">operator()</a>(<span class="keyword">const</span> LoadedSlice &amp;LHS, <span class="keyword">const</span> LoadedSlice &amp;RHS) {</div><div class="line"><a name="l07894"></a><span class="lineno"> 7894</span>&#160;    assert(LHS.Origin == RHS.Origin &amp;&amp; <span class="stringliteral">&quot;Different bases not implemented.&quot;</span>);</div><div class="line"><a name="l07895"></a><span class="lineno"> 7895</span>&#160;    <span class="keywordflow">return</span> LHS.getOffsetFromBase() &lt; RHS.getOffsetFromBase();</div><div class="line"><a name="l07896"></a><span class="lineno"> 7896</span>&#160;  }</div><div class="line"><a name="l07897"></a><span class="lineno"> 7897</span>&#160;};</div><div class="line"><a name="l07898"></a><span class="lineno"> 7898</span>&#160;<span class="comment"></span></div><div class="line"><a name="l07899"></a><span class="lineno"> 7899</span>&#160;<span class="comment">/// \brief Check that all bits set in \p UsedBits form a dense region, i.e.,</span></div><div class="line"><a name="l07900"></a><span class="lineno"> 7900</span>&#160;<span class="comment">/// \p UsedBits looks like 0..0 1..1 0..0.</span></div><div class="line"><a name="l07901"></a><span class="lineno"><a class="line" href="DAGCombiner_8cpp.html#a4bef95512fa985102be74adbdb966f80"> 7901</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="DAGCombiner_8cpp.html#a4bef95512fa985102be74adbdb966f80">areUsedBitsDense</a>(<span class="keyword">const</span> <a class="code" href="classllvm_1_1APInt.html">APInt</a> &amp;UsedBits) {</div><div class="line"><a name="l07902"></a><span class="lineno"> 7902</span>&#160;  <span class="comment">// If all the bits are one, this is dense!</span></div><div class="line"><a name="l07903"></a><span class="lineno"> 7903</span>&#160;  <span class="keywordflow">if</span> (UsedBits.<a class="code" href="classllvm_1_1APInt.html#a21260f8037e665d235ace5718cf68bc4">isAllOnesValue</a>())</div><div class="line"><a name="l07904"></a><span class="lineno"> 7904</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l07905"></a><span class="lineno"> 7905</span>&#160;</div><div class="line"><a name="l07906"></a><span class="lineno"> 7906</span>&#160;  <span class="comment">// Get rid of the unused bits on the right.</span></div><div class="line"><a name="l07907"></a><span class="lineno"> 7907</span>&#160;  <a class="code" href="classllvm_1_1APInt.html">APInt</a> NarrowedUsedBits = UsedBits.<a class="code" href="classllvm_1_1APInt.html#aa1953b3ad7ef6aa87dc0205db0c2ea45">lshr</a>(UsedBits.<a class="code" href="classllvm_1_1APInt.html#aac277496191547e487eea07f09dffd4b">countTrailingZeros</a>());</div><div class="line"><a name="l07908"></a><span class="lineno"> 7908</span>&#160;  <span class="comment">// Get rid of the unused bits on the left.</span></div><div class="line"><a name="l07909"></a><span class="lineno"> 7909</span>&#160;  <span class="keywordflow">if</span> (NarrowedUsedBits.<a class="code" href="classllvm_1_1APInt.html#af0336ea4c7f7f56354b2ca7c8859c1f9">countLeadingZeros</a>())</div><div class="line"><a name="l07910"></a><span class="lineno"> 7910</span>&#160;    NarrowedUsedBits = NarrowedUsedBits.<a class="code" href="classllvm_1_1APInt.html#a8cf5475fb3e9c737112cc248194c1040">trunc</a>(NarrowedUsedBits.<a class="code" href="classllvm_1_1APInt.html#a65eb40bd8c732c997e156e14f6b461f4">getActiveBits</a>());</div><div class="line"><a name="l07911"></a><span class="lineno"> 7911</span>&#160;  <span class="comment">// Check that the chunk of bits is completely used.</span></div><div class="line"><a name="l07912"></a><span class="lineno"> 7912</span>&#160;  <span class="keywordflow">return</span> NarrowedUsedBits.<a class="code" href="classllvm_1_1APInt.html#a21260f8037e665d235ace5718cf68bc4">isAllOnesValue</a>();</div><div class="line"><a name="l07913"></a><span class="lineno"> 7913</span>&#160;}</div><div class="line"><a name="l07914"></a><span class="lineno"> 7914</span>&#160;<span class="comment"></span></div><div class="line"><a name="l07915"></a><span class="lineno"> 7915</span>&#160;<span class="comment">/// \brief Check whether or not \p First and \p Second are next to each other</span></div><div class="line"><a name="l07916"></a><span class="lineno"> 7916</span>&#160;<span class="comment">/// in memory. This means that there is no hole between the bits loaded</span></div><div class="line"><a name="l07917"></a><span class="lineno"> 7917</span>&#160;<span class="comment">/// by \p First and the bits loaded by \p Second.</span></div><div class="line"><a name="l07918"></a><span class="lineno"><a class="line" href="DAGCombiner_8cpp.html#a8e273c7ecabdcb608c3f893260097571"> 7918</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="DAGCombiner_8cpp.html#a8e273c7ecabdcb608c3f893260097571">areSlicesNextToEachOther</a>(<span class="keyword">const</span> LoadedSlice &amp;<a class="code" href="Target_2README_8txt.html#ab24db72f7bd10b13351812874015861b">First</a>,</div><div class="line"><a name="l07919"></a><span class="lineno"> 7919</span>&#160;                                     <span class="keyword">const</span> LoadedSlice &amp;Second) {</div><div class="line"><a name="l07920"></a><span class="lineno"> 7920</span>&#160;  assert(First.Origin == Second.Origin &amp;&amp; First.Origin &amp;&amp;</div><div class="line"><a name="l07921"></a><span class="lineno"> 7921</span>&#160;         <span class="stringliteral">&quot;Unable to match different memory origins.&quot;</span>);</div><div class="line"><a name="l07922"></a><span class="lineno"> 7922</span>&#160;  <a class="code" href="classllvm_1_1APInt.html">APInt</a> UsedBits = First.getUsedBits();</div><div class="line"><a name="l07923"></a><span class="lineno"> 7923</span>&#160;  assert((UsedBits &amp; Second.getUsedBits()) == 0 &amp;&amp;</div><div class="line"><a name="l07924"></a><span class="lineno"> 7924</span>&#160;         <span class="stringliteral">&quot;Slices are not supposed to overlap.&quot;</span>);</div><div class="line"><a name="l07925"></a><span class="lineno"> 7925</span>&#160;  UsedBits |= Second.getUsedBits();</div><div class="line"><a name="l07926"></a><span class="lineno"> 7926</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="DAGCombiner_8cpp.html#a4bef95512fa985102be74adbdb966f80">areUsedBitsDense</a>(UsedBits);</div><div class="line"><a name="l07927"></a><span class="lineno"> 7927</span>&#160;}</div><div class="line"><a name="l07928"></a><span class="lineno"> 7928</span>&#160;<span class="comment"></span></div><div class="line"><a name="l07929"></a><span class="lineno"> 7929</span>&#160;<span class="comment">/// \brief Adjust the \p GlobalLSCost according to the target</span></div><div class="line"><a name="l07930"></a><span class="lineno"> 7930</span>&#160;<span class="comment">/// paring capabilities and the layout of the slices.</span></div><div class="line"><a name="l07931"></a><span class="lineno"> 7931</span>&#160;<span class="comment">/// \pre \p GlobalLSCost should account for at least as many loads as</span></div><div class="line"><a name="l07932"></a><span class="lineno"> 7932</span>&#160;<span class="comment">/// there is in the slices in \p LoadedSlices.</span></div><div class="line"><a name="l07933"></a><span class="lineno"><a class="line" href="DAGCombiner_8cpp.html#a3ceb460ebf70a2fe9a7eb07de595b3d1"> 7933</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="DAGCombiner_8cpp.html#a3ceb460ebf70a2fe9a7eb07de595b3d1">adjustCostForPairing</a>(<a class="code" href="classllvm_1_1SmallVectorImpl.html">SmallVectorImpl&lt;LoadedSlice&gt;</a> &amp;LoadedSlices,</div><div class="line"><a name="l07934"></a><span class="lineno"> 7934</span>&#160;                                 LoadedSlice::Cost &amp;GlobalLSCost) {</div><div class="line"><a name="l07935"></a><span class="lineno"> 7935</span>&#160;  <span class="keywordtype">unsigned</span> NumberOfSlices = LoadedSlices.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#a22a311dfe4c28a897de8a9365a4f0a84">size</a>();</div><div class="line"><a name="l07936"></a><span class="lineno"> 7936</span>&#160;  <span class="comment">// If there is less than 2 elements, no pairing is possible.</span></div><div class="line"><a name="l07937"></a><span class="lineno"> 7937</span>&#160;  <span class="keywordflow">if</span> (NumberOfSlices &lt; 2)</div><div class="line"><a name="l07938"></a><span class="lineno"> 7938</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l07939"></a><span class="lineno"> 7939</span>&#160;</div><div class="line"><a name="l07940"></a><span class="lineno"> 7940</span>&#160;  <span class="comment">// Sort the slices so that elements that are likely to be next to each</span></div><div class="line"><a name="l07941"></a><span class="lineno"> 7941</span>&#160;  <span class="comment">// other in memory are next to each other in the list.</span></div><div class="line"><a name="l07942"></a><span class="lineno"> 7942</span>&#160;  std::sort(LoadedSlices.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#a8a045d250952c0867382a9840ee18fdf">begin</a>(), LoadedSlices.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#a075e34e98605d0e7c289763a104869ac">end</a>(), <a class="code" href="structLoadedSliceSorter.html">LoadedSliceSorter</a>());</div><div class="line"><a name="l07943"></a><span class="lineno"> 7943</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetLowering.html">TargetLowering</a> &amp;TLI = LoadedSlices[0].DAG-&gt;getTargetLoweringInfo();</div><div class="line"><a name="l07944"></a><span class="lineno"> 7944</span>&#160;  <span class="comment">// First (resp. Second) is the first (resp. Second) potentially candidate</span></div><div class="line"><a name="l07945"></a><span class="lineno"> 7945</span>&#160;  <span class="comment">// to be placed in a paired load.</span></div><div class="line"><a name="l07946"></a><span class="lineno"> 7946</span>&#160;  <span class="keyword">const</span> LoadedSlice *<a class="code" href="Target_2README_8txt.html#ab24db72f7bd10b13351812874015861b">First</a> = NULL;</div><div class="line"><a name="l07947"></a><span class="lineno"> 7947</span>&#160;  <span class="keyword">const</span> LoadedSlice *Second = NULL;</div><div class="line"><a name="l07948"></a><span class="lineno"> 7948</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> CurrSlice = 0; CurrSlice &lt; NumberOfSlices; ++CurrSlice,</div><div class="line"><a name="l07949"></a><span class="lineno"> 7949</span>&#160;                <span class="comment">// Set the beginning of the pair.</span></div><div class="line"><a name="l07950"></a><span class="lineno"> 7950</span>&#160;                                                           First = Second) {</div><div class="line"><a name="l07951"></a><span class="lineno"> 7951</span>&#160;</div><div class="line"><a name="l07952"></a><span class="lineno"> 7952</span>&#160;    Second = &amp;LoadedSlices[CurrSlice];</div><div class="line"><a name="l07953"></a><span class="lineno"> 7953</span>&#160;</div><div class="line"><a name="l07954"></a><span class="lineno"> 7954</span>&#160;    <span class="comment">// If First is NULL, it means we start a new pair.</span></div><div class="line"><a name="l07955"></a><span class="lineno"> 7955</span>&#160;    <span class="comment">// Get to the next slice.</span></div><div class="line"><a name="l07956"></a><span class="lineno"> 7956</span>&#160;    <span class="keywordflow">if</span> (!First)</div><div class="line"><a name="l07957"></a><span class="lineno"> 7957</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l07958"></a><span class="lineno"> 7958</span>&#160;</div><div class="line"><a name="l07959"></a><span class="lineno"> 7959</span>&#160;    <a class="code" href="structllvm_1_1EVT.html">EVT</a> LoadedType = First-&gt;getLoadedType();</div><div class="line"><a name="l07960"></a><span class="lineno"> 7960</span>&#160;</div><div class="line"><a name="l07961"></a><span class="lineno"> 7961</span>&#160;    <span class="comment">// If the types of the slices are different, we cannot pair them.</span></div><div class="line"><a name="l07962"></a><span class="lineno"> 7962</span>&#160;    <span class="keywordflow">if</span> (LoadedType != Second-&gt;getLoadedType())</div><div class="line"><a name="l07963"></a><span class="lineno"> 7963</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l07964"></a><span class="lineno"> 7964</span>&#160;</div><div class="line"><a name="l07965"></a><span class="lineno"> 7965</span>&#160;    <span class="comment">// Check if the target supplies paired loads for this type.</span></div><div class="line"><a name="l07966"></a><span class="lineno"> 7966</span>&#160;    <span class="keywordtype">unsigned</span> RequiredAlignment = 0;</div><div class="line"><a name="l07967"></a><span class="lineno"> 7967</span>&#160;    <span class="keywordflow">if</span> (!TLI.hasPairedLoad(LoadedType, RequiredAlignment)) {</div><div class="line"><a name="l07968"></a><span class="lineno"> 7968</span>&#160;      <span class="comment">// move to the next pair, this type is hopeless.</span></div><div class="line"><a name="l07969"></a><span class="lineno"> 7969</span>&#160;      Second = NULL;</div><div class="line"><a name="l07970"></a><span class="lineno"> 7970</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l07971"></a><span class="lineno"> 7971</span>&#160;    }</div><div class="line"><a name="l07972"></a><span class="lineno"> 7972</span>&#160;    <span class="comment">// Check if we meet the alignment requirement.</span></div><div class="line"><a name="l07973"></a><span class="lineno"> 7973</span>&#160;    <span class="keywordflow">if</span> (RequiredAlignment &gt; First-&gt;getAlignment())</div><div class="line"><a name="l07974"></a><span class="lineno"> 7974</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l07975"></a><span class="lineno"> 7975</span>&#160;</div><div class="line"><a name="l07976"></a><span class="lineno"> 7976</span>&#160;    <span class="comment">// Check that both loads are next to each other in memory.</span></div><div class="line"><a name="l07977"></a><span class="lineno"> 7977</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="DAGCombiner_8cpp.html#a8e273c7ecabdcb608c3f893260097571">areSlicesNextToEachOther</a>(*First, *Second))</div><div class="line"><a name="l07978"></a><span class="lineno"> 7978</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l07979"></a><span class="lineno"> 7979</span>&#160;</div><div class="line"><a name="l07980"></a><span class="lineno"> 7980</span>&#160;    assert(GlobalLSCost.Loads &gt; 0 &amp;&amp; <span class="stringliteral">&quot;We save more loads than we created!&quot;</span>);</div><div class="line"><a name="l07981"></a><span class="lineno"> 7981</span>&#160;    --GlobalLSCost.Loads;</div><div class="line"><a name="l07982"></a><span class="lineno"> 7982</span>&#160;    <span class="comment">// Move to the next pair.</span></div><div class="line"><a name="l07983"></a><span class="lineno"> 7983</span>&#160;    Second = NULL;</div><div class="line"><a name="l07984"></a><span class="lineno"> 7984</span>&#160;  }</div><div class="line"><a name="l07985"></a><span class="lineno"> 7985</span>&#160;}</div><div class="line"><a name="l07986"></a><span class="lineno"> 7986</span>&#160;<span class="comment"></span></div><div class="line"><a name="l07987"></a><span class="lineno"> 7987</span>&#160;<span class="comment">/// \brief Check the profitability of all involved LoadedSlice.</span></div><div class="line"><a name="l07988"></a><span class="lineno"> 7988</span>&#160;<span class="comment">/// Currently, it is considered profitable if there is exactly two</span></div><div class="line"><a name="l07989"></a><span class="lineno"> 7989</span>&#160;<span class="comment">/// involved slices (1) which are (2) next to each other in memory, and</span></div><div class="line"><a name="l07990"></a><span class="lineno"> 7990</span>&#160;<span class="comment">/// whose cost (\see LoadedSlice::Cost) is smaller than the original load (3).</span></div><div class="line"><a name="l07991"></a><span class="lineno"> 7991</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l07992"></a><span class="lineno"> 7992</span>&#160;<span class="comment">/// Note: The order of the elements in \p LoadedSlices may be modified, but not</span></div><div class="line"><a name="l07993"></a><span class="lineno"> 7993</span>&#160;<span class="comment">/// the elements themselves.</span></div><div class="line"><a name="l07994"></a><span class="lineno"> 7994</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l07995"></a><span class="lineno"> 7995</span>&#160;<span class="comment">/// FIXME: When the cost model will be mature enough, we can relax</span></div><div class="line"><a name="l07996"></a><span class="lineno"> 7996</span>&#160;<span class="comment">/// constraints (1) and (2).</span></div><div class="line"><a name="l07997"></a><span class="lineno"><a class="line" href="DAGCombiner_8cpp.html#af94365b75e01f45bde3699f009aa431e"> 7997</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="DAGCombiner_8cpp.html#af94365b75e01f45bde3699f009aa431e">isSlicingProfitable</a>(<a class="code" href="classllvm_1_1SmallVectorImpl.html">SmallVectorImpl&lt;LoadedSlice&gt;</a> &amp;LoadedSlices,</div><div class="line"><a name="l07998"></a><span class="lineno"> 7998</span>&#160;                                <span class="keyword">const</span> <a class="code" href="classllvm_1_1APInt.html">APInt</a> &amp;UsedBits, <span class="keywordtype">bool</span> ForCodeSize) {</div><div class="line"><a name="l07999"></a><span class="lineno"> 7999</span>&#160;  <span class="keywordtype">unsigned</span> NumberOfSlices = LoadedSlices.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#a22a311dfe4c28a897de8a9365a4f0a84">size</a>();</div><div class="line"><a name="l08000"></a><span class="lineno"> 8000</span>&#160;  <span class="keywordflow">if</span> (StressLoadSlicing)</div><div class="line"><a name="l08001"></a><span class="lineno"> 8001</span>&#160;    <span class="keywordflow">return</span> NumberOfSlices &gt; 1;</div><div class="line"><a name="l08002"></a><span class="lineno"> 8002</span>&#160;</div><div class="line"><a name="l08003"></a><span class="lineno"> 8003</span>&#160;  <span class="comment">// Check (1).</span></div><div class="line"><a name="l08004"></a><span class="lineno"> 8004</span>&#160;  <span class="keywordflow">if</span> (NumberOfSlices != 2)</div><div class="line"><a name="l08005"></a><span class="lineno"> 8005</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l08006"></a><span class="lineno"> 8006</span>&#160;</div><div class="line"><a name="l08007"></a><span class="lineno"> 8007</span>&#160;  <span class="comment">// Check (2).</span></div><div class="line"><a name="l08008"></a><span class="lineno"> 8008</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="DAGCombiner_8cpp.html#a4bef95512fa985102be74adbdb966f80">areUsedBitsDense</a>(UsedBits))</div><div class="line"><a name="l08009"></a><span class="lineno"> 8009</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l08010"></a><span class="lineno"> 8010</span>&#160;</div><div class="line"><a name="l08011"></a><span class="lineno"> 8011</span>&#160;  <span class="comment">// Check (3).</span></div><div class="line"><a name="l08012"></a><span class="lineno"> 8012</span>&#160;  LoadedSlice::Cost OrigCost(ForCodeSize), GlobalSlicingCost(ForCodeSize);</div><div class="line"><a name="l08013"></a><span class="lineno"> 8013</span>&#160;  <span class="comment">// The original code has one big load.</span></div><div class="line"><a name="l08014"></a><span class="lineno"> 8014</span>&#160;  OrigCost.Loads = 1;</div><div class="line"><a name="l08015"></a><span class="lineno"> 8015</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> CurrSlice = 0; CurrSlice &lt; NumberOfSlices; ++CurrSlice) {</div><div class="line"><a name="l08016"></a><span class="lineno"> 8016</span>&#160;    <span class="keyword">const</span> LoadedSlice &amp;<a class="code" href="namespacellvm_1_1A64CC.html#af5804bc0518be9568f73db566e4d6f46a262de230e8b3511eaf693762cabdc1ca">LS</a> = LoadedSlices[CurrSlice];</div><div class="line"><a name="l08017"></a><span class="lineno"> 8017</span>&#160;    <span class="comment">// Accumulate the cost of all the slices.</span></div><div class="line"><a name="l08018"></a><span class="lineno"> 8018</span>&#160;    LoadedSlice::Cost SliceCost(LS, ForCodeSize);</div><div class="line"><a name="l08019"></a><span class="lineno"> 8019</span>&#160;    GlobalSlicingCost += SliceCost;</div><div class="line"><a name="l08020"></a><span class="lineno"> 8020</span>&#160;</div><div class="line"><a name="l08021"></a><span class="lineno"> 8021</span>&#160;    <span class="comment">// Account as cost in the original configuration the gain obtained</span></div><div class="line"><a name="l08022"></a><span class="lineno"> 8022</span>&#160;    <span class="comment">// with the current slices.</span></div><div class="line"><a name="l08023"></a><span class="lineno"> 8023</span>&#160;    OrigCost.addSliceGain(LS);</div><div class="line"><a name="l08024"></a><span class="lineno"> 8024</span>&#160;  }</div><div class="line"><a name="l08025"></a><span class="lineno"> 8025</span>&#160;</div><div class="line"><a name="l08026"></a><span class="lineno"> 8026</span>&#160;  <span class="comment">// If the target supports paired load, adjust the cost accordingly.</span></div><div class="line"><a name="l08027"></a><span class="lineno"> 8027</span>&#160;  <a class="code" href="DAGCombiner_8cpp.html#a3ceb460ebf70a2fe9a7eb07de595b3d1">adjustCostForPairing</a>(LoadedSlices, GlobalSlicingCost);</div><div class="line"><a name="l08028"></a><span class="lineno"> 8028</span>&#160;  <span class="keywordflow">return</span> OrigCost &gt; GlobalSlicingCost;</div><div class="line"><a name="l08029"></a><span class="lineno"> 8029</span>&#160;}</div><div class="line"><a name="l08030"></a><span class="lineno"> 8030</span>&#160;<span class="comment"></span></div><div class="line"><a name="l08031"></a><span class="lineno"> 8031</span>&#160;<span class="comment">/// \brief If the given load, \p LI, is used only by trunc or trunc(lshr)</span></div><div class="line"><a name="l08032"></a><span class="lineno"> 8032</span>&#160;<span class="comment">/// operations, split it in the various pieces being extracted.</span></div><div class="line"><a name="l08033"></a><span class="lineno"> 8033</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l08034"></a><span class="lineno"> 8034</span>&#160;<span class="comment">/// This sort of thing is introduced by SROA.</span></div><div class="line"><a name="l08035"></a><span class="lineno"> 8035</span>&#160;<span class="comment">/// This slicing takes care not to insert overlapping loads.</span></div><div class="line"><a name="l08036"></a><span class="lineno"> 8036</span>&#160;<span class="comment">/// \pre LI is a simple load (i.e., not an atomic or volatile load).</span></div><div class="line"><a name="l08037"></a><span class="lineno"> 8037</span>&#160;<span class="comment"></span><span class="keywordtype">bool</span> DAGCombiner::SliceUpLoad(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N) {</div><div class="line"><a name="l08038"></a><span class="lineno"> 8038</span>&#160;  <span class="keywordflow">if</span> (Level &lt; <a class="code" href="namespacellvm.html#aa6d856e4879bb775617f8c3634773b7aa7fbaa966e5d5ac3bf03ba617b73bff5c">AfterLegalizeDAG</a>)</div><div class="line"><a name="l08039"></a><span class="lineno"> 8039</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l08040"></a><span class="lineno"> 8040</span>&#160;</div><div class="line"><a name="l08041"></a><span class="lineno"> 8041</span>&#160;  <a class="code" href="classllvm_1_1LoadSDNode.html">LoadSDNode</a> *<a class="code" href="namespacellvm_1_1A64DB.html#a6fce8157775f3ec93f326b52b0f1e0f5ad61b145eb8cbab18feb1b2e2ce269a7e">LD</a> = cast&lt;LoadSDNode&gt;(<a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>);</div><div class="line"><a name="l08042"></a><span class="lineno"> 8042</span>&#160;  <span class="keywordflow">if</span> (LD-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#acd3bb9ee2ec53fa4be1fdf155b0b5a17">isVolatile</a>() || !<a class="code" href="namespacellvm_1_1ISD.html#afaaeadcd82b42fc0d385a6247bf7bb52">ISD::isNormalLoad</a>(LD) ||</div><div class="line"><a name="l08043"></a><span class="lineno"> 8043</span>&#160;      !LD-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(0).<a class="code" href="structllvm_1_1EVT.html#a8cc407ac00df4edd4ec4d5168d6ecb26">isInteger</a>())</div><div class="line"><a name="l08044"></a><span class="lineno"> 8044</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l08045"></a><span class="lineno"> 8045</span>&#160;</div><div class="line"><a name="l08046"></a><span class="lineno"> 8046</span>&#160;  <span class="comment">// Keep track of already used bits to detect overlapping values.</span></div><div class="line"><a name="l08047"></a><span class="lineno"> 8047</span>&#160;  <span class="comment">// In that case, we will just abort the transformation.</span></div><div class="line"><a name="l08048"></a><span class="lineno"> 8048</span>&#160;  <a class="code" href="classllvm_1_1APInt.html">APInt</a> UsedBits(LD-&gt;<a class="code" href="classllvm_1_1SDNode.html#a3e579897b3fc3d645d0eea2f3442cfa2">getValueSizeInBits</a>(0), 0);</div><div class="line"><a name="l08049"></a><span class="lineno"> 8049</span>&#160;</div><div class="line"><a name="l08050"></a><span class="lineno"> 8050</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;LoadedSlice, 4&gt;</a> LoadedSlices;</div><div class="line"><a name="l08051"></a><span class="lineno"> 8051</span>&#160;</div><div class="line"><a name="l08052"></a><span class="lineno"> 8052</span>&#160;  <span class="comment">// Check if this load is used as several smaller chunks of bits.</span></div><div class="line"><a name="l08053"></a><span class="lineno"> 8053</span>&#160;  <span class="comment">// Basically, look for uses in trunc or trunc(lshr) and record a new chain</span></div><div class="line"><a name="l08054"></a><span class="lineno"> 8054</span>&#160;  <span class="comment">// of computation for each trunc.</span></div><div class="line"><a name="l08055"></a><span class="lineno"> 8055</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1SDNode_1_1use__iterator.html">SDNode::use_iterator</a> UI = LD-&gt;<a class="code" href="classllvm_1_1SDNode.html#a8810bf428dcf84d48f39c8f5ba9a8c94">use_begin</a>(), UIEnd = LD-&gt;<a class="code" href="classllvm_1_1SDNode.html#aef02f2c1bd12936a80611b134b24a47d">use_end</a>();</div><div class="line"><a name="l08056"></a><span class="lineno"> 8056</span>&#160;       UI != UIEnd; ++UI) {</div><div class="line"><a name="l08057"></a><span class="lineno"> 8057</span>&#160;    <span class="comment">// Skip the uses of the chain.</span></div><div class="line"><a name="l08058"></a><span class="lineno"> 8058</span>&#160;    <span class="keywordflow">if</span> (UI.getUse().getResNo() != 0)</div><div class="line"><a name="l08059"></a><span class="lineno"> 8059</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l08060"></a><span class="lineno"> 8060</span>&#160;</div><div class="line"><a name="l08061"></a><span class="lineno"> 8061</span>&#160;    <a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *<a class="code" href="classllvm_1_1User.html">User</a> = *UI;</div><div class="line"><a name="l08062"></a><span class="lineno"> 8062</span>&#160;    <span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#a8db36c82f32d6f6a4d35a00e55be03a8">Shift</a> = 0;</div><div class="line"><a name="l08063"></a><span class="lineno"> 8063</span>&#160;</div><div class="line"><a name="l08064"></a><span class="lineno"> 8064</span>&#160;    <span class="comment">// Check if this is a trunc(lshr).</span></div><div class="line"><a name="l08065"></a><span class="lineno"> 8065</span>&#160;    <span class="keywordflow">if</span> (User-&gt;<a class="code" href="classllvm_1_1SDNode.html#af0d328f3f61168f4ea7d6e4044af4f97">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a3c6553c8acebe1b57c211ee45e2d8f98">ISD::SRL</a> &amp;&amp; User-&gt;<a class="code" href="classllvm_1_1SDNode.html#a52753947fce3a01b1c18dd4713c587e8">hasOneUse</a>() &amp;&amp;</div><div class="line"><a name="l08066"></a><span class="lineno"> 8066</span>&#160;        isa&lt;ConstantSDNode&gt;(User-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(1))) {</div><div class="line"><a name="l08067"></a><span class="lineno"> 8067</span>&#160;      Shift = cast&lt;ConstantSDNode&gt;(User-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(1))-&gt;getZExtValue();</div><div class="line"><a name="l08068"></a><span class="lineno"> 8068</span>&#160;      User = *User-&gt;<a class="code" href="classllvm_1_1SDNode.html#a8810bf428dcf84d48f39c8f5ba9a8c94">use_begin</a>();</div><div class="line"><a name="l08069"></a><span class="lineno"> 8069</span>&#160;    }</div><div class="line"><a name="l08070"></a><span class="lineno"> 8070</span>&#160;</div><div class="line"><a name="l08071"></a><span class="lineno"> 8071</span>&#160;    <span class="comment">// At this point, User is a Truncate, iff we encountered, trunc or</span></div><div class="line"><a name="l08072"></a><span class="lineno"> 8072</span>&#160;    <span class="comment">// trunc(lshr).</span></div><div class="line"><a name="l08073"></a><span class="lineno"> 8073</span>&#160;    <span class="keywordflow">if</span> (User-&gt;<a class="code" href="classllvm_1_1SDNode.html#af0d328f3f61168f4ea7d6e4044af4f97">getOpcode</a>() != <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ae690127648393001a7d5b93dc23da7b3">ISD::TRUNCATE</a>)</div><div class="line"><a name="l08074"></a><span class="lineno"> 8074</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l08075"></a><span class="lineno"> 8075</span>&#160;</div><div class="line"><a name="l08076"></a><span class="lineno"> 8076</span>&#160;    <span class="comment">// The width of the type must be a power of 2 and greater than 8-bits.</span></div><div class="line"><a name="l08077"></a><span class="lineno"> 8077</span>&#160;    <span class="comment">// Otherwise the load cannot be represented in LLVM IR.</span></div><div class="line"><a name="l08078"></a><span class="lineno"> 8078</span>&#160;    <span class="comment">// Moreover, if we shifted with a non 8-bits multiple, the slice</span></div><div class="line"><a name="l08079"></a><span class="lineno"> 8079</span>&#160;    <span class="comment">// will be accross several bytes. We do not support that.</span></div><div class="line"><a name="l08080"></a><span class="lineno"> 8080</span>&#160;    <span class="keywordtype">unsigned</span> Width = User-&gt;<a class="code" href="classllvm_1_1SDNode.html#a3e579897b3fc3d645d0eea2f3442cfa2">getValueSizeInBits</a>(0);</div><div class="line"><a name="l08081"></a><span class="lineno"> 8081</span>&#160;    <span class="keywordflow">if</span> (Width &lt; 8 || !<a class="code" href="namespacellvm.html#af4d1a918800291e75b01ce1447be0e83">isPowerOf2_32</a>(Width) || (Shift &amp; 0x7))</div><div class="line"><a name="l08082"></a><span class="lineno"> 8082</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l08083"></a><span class="lineno"> 8083</span>&#160;</div><div class="line"><a name="l08084"></a><span class="lineno"> 8084</span>&#160;    <span class="comment">// Build the slice for this chain of computations.</span></div><div class="line"><a name="l08085"></a><span class="lineno"> 8085</span>&#160;    LoadedSlice <a class="code" href="namespacellvm_1_1A64CC.html#af5804bc0518be9568f73db566e4d6f46a262de230e8b3511eaf693762cabdc1ca">LS</a>(User, LD, Shift, &amp;DAG);</div><div class="line"><a name="l08086"></a><span class="lineno"> 8086</span>&#160;    <a class="code" href="classllvm_1_1APInt.html">APInt</a> CurrentUsedBits = LS.getUsedBits();</div><div class="line"><a name="l08087"></a><span class="lineno"> 8087</span>&#160;</div><div class="line"><a name="l08088"></a><span class="lineno"> 8088</span>&#160;    <span class="comment">// Check if this slice overlaps with another.</span></div><div class="line"><a name="l08089"></a><span class="lineno"> 8089</span>&#160;    <span class="keywordflow">if</span> ((CurrentUsedBits &amp; UsedBits) != 0)</div><div class="line"><a name="l08090"></a><span class="lineno"> 8090</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l08091"></a><span class="lineno"> 8091</span>&#160;    <span class="comment">// Update the bits used globally.</span></div><div class="line"><a name="l08092"></a><span class="lineno"> 8092</span>&#160;    UsedBits |= CurrentUsedBits;</div><div class="line"><a name="l08093"></a><span class="lineno"> 8093</span>&#160;</div><div class="line"><a name="l08094"></a><span class="lineno"> 8094</span>&#160;    <span class="comment">// Check if the new slice would be legal.</span></div><div class="line"><a name="l08095"></a><span class="lineno"> 8095</span>&#160;    <span class="keywordflow">if</span> (!LS.isLegal())</div><div class="line"><a name="l08096"></a><span class="lineno"> 8096</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l08097"></a><span class="lineno"> 8097</span>&#160;</div><div class="line"><a name="l08098"></a><span class="lineno"> 8098</span>&#160;    <span class="comment">// Record the slice.</span></div><div class="line"><a name="l08099"></a><span class="lineno"> 8099</span>&#160;    LoadedSlices.push_back(LS);</div><div class="line"><a name="l08100"></a><span class="lineno"> 8100</span>&#160;  }</div><div class="line"><a name="l08101"></a><span class="lineno"> 8101</span>&#160;</div><div class="line"><a name="l08102"></a><span class="lineno"> 8102</span>&#160;  <span class="comment">// Abort slicing if it does not seem to be profitable.</span></div><div class="line"><a name="l08103"></a><span class="lineno"> 8103</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="DAGCombiner_8cpp.html#af94365b75e01f45bde3699f009aa431e">isSlicingProfitable</a>(LoadedSlices, UsedBits, ForCodeSize))</div><div class="line"><a name="l08104"></a><span class="lineno"> 8104</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l08105"></a><span class="lineno"> 8105</span>&#160;</div><div class="line"><a name="l08106"></a><span class="lineno"> 8106</span>&#160;  ++SlicedLoads;</div><div class="line"><a name="l08107"></a><span class="lineno"> 8107</span>&#160;</div><div class="line"><a name="l08108"></a><span class="lineno"> 8108</span>&#160;  <span class="comment">// Rewrite each chain to use an independent load.</span></div><div class="line"><a name="l08109"></a><span class="lineno"> 8109</span>&#160;  <span class="comment">// By construction, each chain can be represented by a unique load.</span></div><div class="line"><a name="l08110"></a><span class="lineno"> 8110</span>&#160;</div><div class="line"><a name="l08111"></a><span class="lineno"> 8111</span>&#160;  <span class="comment">// Prepare the argument for the new token factor for all the slices.</span></div><div class="line"><a name="l08112"></a><span class="lineno"> 8112</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;SDValue, 8&gt;</a> ArgChains;</div><div class="line"><a name="l08113"></a><span class="lineno"> 8113</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1SmallVectorImpl.html">SmallVectorImpl&lt;LoadedSlice&gt;::const_iterator</a></div><div class="line"><a name="l08114"></a><span class="lineno"> 8114</span>&#160;           LSIt = LoadedSlices.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#a8a045d250952c0867382a9840ee18fdf">begin</a>(),</div><div class="line"><a name="l08115"></a><span class="lineno"> 8115</span>&#160;           LSItEnd = LoadedSlices.end();</div><div class="line"><a name="l08116"></a><span class="lineno"> 8116</span>&#160;       LSIt != LSItEnd; ++LSIt) {</div><div class="line"><a name="l08117"></a><span class="lineno"> 8117</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> SliceInst = LSIt-&gt;loadSlice();</div><div class="line"><a name="l08118"></a><span class="lineno"> 8118</span>&#160;    CombineTo(LSIt-&gt;Inst, SliceInst, <span class="keyword">true</span>);</div><div class="line"><a name="l08119"></a><span class="lineno"> 8119</span>&#160;    <span class="keywordflow">if</span> (SliceInst.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()-&gt;<a class="code" href="classllvm_1_1SDNode.html#af0d328f3f61168f4ea7d6e4044af4f97">getOpcode</a>() != <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a269b81f007000306e3e69d0d290c2159">ISD::LOAD</a>)</div><div class="line"><a name="l08120"></a><span class="lineno"> 8120</span>&#160;      SliceInst = SliceInst.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0);</div><div class="line"><a name="l08121"></a><span class="lineno"> 8121</span>&#160;    assert(SliceInst-&gt;<a class="code" href="classllvm_1_1SDNode.html#af0d328f3f61168f4ea7d6e4044af4f97">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a269b81f007000306e3e69d0d290c2159">ISD::LOAD</a> &amp;&amp;</div><div class="line"><a name="l08122"></a><span class="lineno"> 8122</span>&#160;           <span class="stringliteral">&quot;It takes more than a zext to get to the loaded slice!!&quot;</span>);</div><div class="line"><a name="l08123"></a><span class="lineno"> 8123</span>&#160;    ArgChains.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(SliceInst.<a class="code" href="classllvm_1_1SDValue.html#a040481b9bda32faa6b1435532405d88f">getValue</a>(1));</div><div class="line"><a name="l08124"></a><span class="lineno"> 8124</span>&#160;  }</div><div class="line"><a name="l08125"></a><span class="lineno"> 8125</span>&#160;</div><div class="line"><a name="l08126"></a><span class="lineno"> 8126</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Chain = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ad469508535ce2082a1ab1f0e429187b8">ISD::TokenFactor</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(LD), <a class="code" href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50ca62a222acce6360abd2726719fabc2797">MVT::Other</a>,</div><div class="line"><a name="l08127"></a><span class="lineno"> 8127</span>&#160;                              &amp;ArgChains[0], ArgChains.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#a22a311dfe4c28a897de8a9365a4f0a84">size</a>());</div><div class="line"><a name="l08128"></a><span class="lineno"> 8128</span>&#160;  DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#ac630ccda26fea2f45afa3fb89bc1a8f4">ReplaceAllUsesOfValueWith</a>(<a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(N, 1), Chain);</div><div class="line"><a name="l08129"></a><span class="lineno"> 8129</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l08130"></a><span class="lineno"> 8130</span>&#160;}</div><div class="line"><a name="l08131"></a><span class="lineno"> 8131</span>&#160;<span class="comment"></span></div><div class="line"><a name="l08132"></a><span class="lineno"> 8132</span>&#160;<span class="comment">/// CheckForMaskedLoad - Check to see if V is (and load (ptr), imm), where the</span></div><div class="line"><a name="l08133"></a><span class="lineno"> 8133</span>&#160;<span class="comment">/// load is having specific bytes cleared out.  If so, return the byte size</span></div><div class="line"><a name="l08134"></a><span class="lineno"> 8134</span>&#160;<span class="comment">/// being masked out and the shift amount.</span></div><div class="line"><a name="l08135"></a><span class="lineno"> 8135</span>&#160;<span class="comment"></span><span class="keyword">static</span> std::pair&lt;unsigned, unsigned&gt;</div><div class="line"><a name="l08136"></a><span class="lineno"><a class="line" href="DAGCombiner_8cpp.html#ab4dad3fc933e6caae6cffa219ea8797f"> 8136</a></span>&#160;<a class="code" href="DAGCombiner_8cpp.html#ab4dad3fc933e6caae6cffa219ea8797f">CheckForMaskedLoad</a>(<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> V, <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Ptr, <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Chain) {</div><div class="line"><a name="l08137"></a><span class="lineno"> 8137</span>&#160;  std::pair&lt;unsigned, unsigned&gt; Result(0, 0);</div><div class="line"><a name="l08138"></a><span class="lineno"> 8138</span>&#160;</div><div class="line"><a name="l08139"></a><span class="lineno"> 8139</span>&#160;  <span class="comment">// Check for the structure we&#39;re looking for.</span></div><div class="line"><a name="l08140"></a><span class="lineno"> 8140</span>&#160;  <span class="keywordflow">if</span> (V-&gt;<a class="code" href="classllvm_1_1SDNode.html#af0d328f3f61168f4ea7d6e4044af4f97">getOpcode</a>() != <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ac513a7da1bf74fb3e3c594da8534f2d2">ISD::AND</a> ||</div><div class="line"><a name="l08141"></a><span class="lineno"> 8141</span>&#160;      !isa&lt;ConstantSDNode&gt;(V-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(1)) ||</div><div class="line"><a name="l08142"></a><span class="lineno"> 8142</span>&#160;      !<a class="code" href="namespacellvm_1_1ISD.html#afaaeadcd82b42fc0d385a6247bf7bb52">ISD::isNormalLoad</a>(V-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()))</div><div class="line"><a name="l08143"></a><span class="lineno"> 8143</span>&#160;    <span class="keywordflow">return</span> Result;</div><div class="line"><a name="l08144"></a><span class="lineno"> 8144</span>&#160;</div><div class="line"><a name="l08145"></a><span class="lineno"> 8145</span>&#160;  <span class="comment">// Check the chain and pointer.</span></div><div class="line"><a name="l08146"></a><span class="lineno"> 8146</span>&#160;  <a class="code" href="classllvm_1_1LoadSDNode.html">LoadSDNode</a> *<a class="code" href="namespacellvm_1_1A64DB.html#a6fce8157775f3ec93f326b52b0f1e0f5ad61b145eb8cbab18feb1b2e2ce269a7e">LD</a> = cast&lt;LoadSDNode&gt;(V-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0));</div><div class="line"><a name="l08147"></a><span class="lineno"> 8147</span>&#160;  <span class="keywordflow">if</span> (LD-&gt;<a class="code" href="classllvm_1_1LoadSDNode.html#a3ded48ce66b58b7e7e143991df5dbfae">getBasePtr</a>() != Ptr) <span class="keywordflow">return</span> Result;  <span class="comment">// Not from same pointer.</span></div><div class="line"><a name="l08148"></a><span class="lineno"> 8148</span>&#160;</div><div class="line"><a name="l08149"></a><span class="lineno"> 8149</span>&#160;  <span class="comment">// The store should be chained directly to the load or be an operand of a</span></div><div class="line"><a name="l08150"></a><span class="lineno"> 8150</span>&#160;  <span class="comment">// tokenfactor.</span></div><div class="line"><a name="l08151"></a><span class="lineno"> 8151</span>&#160;  <span class="keywordflow">if</span> (LD == Chain.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>())</div><div class="line"><a name="l08152"></a><span class="lineno"> 8152</span>&#160;    ; <span class="comment">// ok.</span></div><div class="line"><a name="l08153"></a><span class="lineno"> 8153</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Chain-&gt;<a class="code" href="classllvm_1_1SDNode.html#af0d328f3f61168f4ea7d6e4044af4f97">getOpcode</a>() != <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ad469508535ce2082a1ab1f0e429187b8">ISD::TokenFactor</a>)</div><div class="line"><a name="l08154"></a><span class="lineno"> 8154</span>&#160;    <span class="keywordflow">return</span> Result; <span class="comment">// Fail.</span></div><div class="line"><a name="l08155"></a><span class="lineno"> 8155</span>&#160;  <span class="keywordflow">else</span> {</div><div class="line"><a name="l08156"></a><span class="lineno"> 8156</span>&#160;    <span class="keywordtype">bool</span> isOk = <span class="keyword">false</span>;</div><div class="line"><a name="l08157"></a><span class="lineno"> 8157</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0, e = Chain-&gt;<a class="code" href="classllvm_1_1SDNode.html#abc5c2f1d47a517373030133c6a102106">getNumOperands</a>(); <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != e; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div><div class="line"><a name="l08158"></a><span class="lineno"> 8158</span>&#160;      <span class="keywordflow">if</span> (Chain-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>).<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>() == <a class="code" href="namespacellvm_1_1A64DB.html#a6fce8157775f3ec93f326b52b0f1e0f5ad61b145eb8cbab18feb1b2e2ce269a7e">LD</a>) {</div><div class="line"><a name="l08159"></a><span class="lineno"> 8159</span>&#160;        isOk = <span class="keyword">true</span>;</div><div class="line"><a name="l08160"></a><span class="lineno"> 8160</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l08161"></a><span class="lineno"> 8161</span>&#160;      }</div><div class="line"><a name="l08162"></a><span class="lineno"> 8162</span>&#160;    <span class="keywordflow">if</span> (!isOk) <span class="keywordflow">return</span> Result;</div><div class="line"><a name="l08163"></a><span class="lineno"> 8163</span>&#160;  }</div><div class="line"><a name="l08164"></a><span class="lineno"> 8164</span>&#160;</div><div class="line"><a name="l08165"></a><span class="lineno"> 8165</span>&#160;  <span class="comment">// This only handles simple types.</span></div><div class="line"><a name="l08166"></a><span class="lineno"> 8166</span>&#160;  <span class="keywordflow">if</span> (V.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>() != <a class="code" href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50cab3be25b50efa0289a3c86fd50454b683">MVT::i16</a> &amp;&amp;</div><div class="line"><a name="l08167"></a><span class="lineno"> 8167</span>&#160;      V.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>() != <a class="code" href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50ca04cca8bc12888d0a7238f55a6c550ad0">MVT::i32</a> &amp;&amp;</div><div class="line"><a name="l08168"></a><span class="lineno"> 8168</span>&#160;      V.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>() != <a class="code" href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50ca97f56253625b3fe7b371ce76722de4b8">MVT::i64</a>)</div><div class="line"><a name="l08169"></a><span class="lineno"> 8169</span>&#160;    <span class="keywordflow">return</span> Result;</div><div class="line"><a name="l08170"></a><span class="lineno"> 8170</span>&#160;</div><div class="line"><a name="l08171"></a><span class="lineno"> 8171</span>&#160;  <span class="comment">// Check the constant mask.  Invert it so that the bits being masked out are</span></div><div class="line"><a name="l08172"></a><span class="lineno"> 8172</span>&#160;  <span class="comment">// 0 and the bits being kept are 1.  Use getSExtValue so that leading bits</span></div><div class="line"><a name="l08173"></a><span class="lineno"> 8173</span>&#160;  <span class="comment">// follow the sign bit for uniformity.</span></div><div class="line"><a name="l08174"></a><span class="lineno"> 8174</span>&#160;  uint64_t NotMask = ~cast&lt;ConstantSDNode&gt;(V-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(1))-&gt;getSExtValue();</div><div class="line"><a name="l08175"></a><span class="lineno"> 8175</span>&#160;  <span class="keywordtype">unsigned</span> NotMaskLZ = <a class="code" href="namespacellvm.html#a85acbc71797c5df4b82f6c527ff9ad1a">countLeadingZeros</a>(NotMask);</div><div class="line"><a name="l08176"></a><span class="lineno"> 8176</span>&#160;  <span class="keywordflow">if</span> (NotMaskLZ &amp; 7) <span class="keywordflow">return</span> Result;  <span class="comment">// Must be multiple of a byte.</span></div><div class="line"><a name="l08177"></a><span class="lineno"> 8177</span>&#160;  <span class="keywordtype">unsigned</span> NotMaskTZ = <a class="code" href="namespacellvm.html#abdaf1eaf6120421977095bd97eee892e">countTrailingZeros</a>(NotMask);</div><div class="line"><a name="l08178"></a><span class="lineno"> 8178</span>&#160;  <span class="keywordflow">if</span> (NotMaskTZ &amp; 7) <span class="keywordflow">return</span> Result;  <span class="comment">// Must be multiple of a byte.</span></div><div class="line"><a name="l08179"></a><span class="lineno"> 8179</span>&#160;  <span class="keywordflow">if</span> (NotMaskLZ == 64) <span class="keywordflow">return</span> Result;  <span class="comment">// All zero mask.</span></div><div class="line"><a name="l08180"></a><span class="lineno"> 8180</span>&#160;</div><div class="line"><a name="l08181"></a><span class="lineno"> 8181</span>&#160;  <span class="comment">// See if we have a continuous run of bits.  If so, we have 0*1+0*</span></div><div class="line"><a name="l08182"></a><span class="lineno"> 8182</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#a8da28d982a3c20fa6e57d94df3059f03">CountTrailingOnes_64</a>(NotMask &gt;&gt; NotMaskTZ)+NotMaskTZ+NotMaskLZ != 64)</div><div class="line"><a name="l08183"></a><span class="lineno"> 8183</span>&#160;    <span class="keywordflow">return</span> Result;</div><div class="line"><a name="l08184"></a><span class="lineno"> 8184</span>&#160;</div><div class="line"><a name="l08185"></a><span class="lineno"> 8185</span>&#160;  <span class="comment">// Adjust NotMaskLZ down to be from the actual size of the int instead of i64.</span></div><div class="line"><a name="l08186"></a><span class="lineno"> 8186</span>&#160;  <span class="keywordflow">if</span> (V.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>() != <a class="code" href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50ca97f56253625b3fe7b371ce76722de4b8">MVT::i64</a> &amp;&amp; NotMaskLZ)</div><div class="line"><a name="l08187"></a><span class="lineno"> 8187</span>&#160;    NotMaskLZ -= 64-V.<a class="code" href="classllvm_1_1SDValue.html#a70aa652293da070dfe5b9fae309d0112">getValueSizeInBits</a>();</div><div class="line"><a name="l08188"></a><span class="lineno"> 8188</span>&#160;</div><div class="line"><a name="l08189"></a><span class="lineno"> 8189</span>&#160;  <span class="keywordtype">unsigned</span> MaskedBytes = (V.<a class="code" href="classllvm_1_1SDValue.html#a70aa652293da070dfe5b9fae309d0112">getValueSizeInBits</a>()-NotMaskLZ-NotMaskTZ)/8;</div><div class="line"><a name="l08190"></a><span class="lineno"> 8190</span>&#160;  <span class="keywordflow">switch</span> (MaskedBytes) {</div><div class="line"><a name="l08191"></a><span class="lineno"> 8191</span>&#160;  <span class="keywordflow">case</span> 1:</div><div class="line"><a name="l08192"></a><span class="lineno"> 8192</span>&#160;  <span class="keywordflow">case</span> 2:</div><div class="line"><a name="l08193"></a><span class="lineno"> 8193</span>&#160;  <span class="keywordflow">case</span> 4: <span class="keywordflow">break</span>;</div><div class="line"><a name="l08194"></a><span class="lineno"> 8194</span>&#160;  <span class="keywordflow">default</span>: <span class="keywordflow">return</span> Result; <span class="comment">// All one mask, or 5-byte mask.</span></div><div class="line"><a name="l08195"></a><span class="lineno"> 8195</span>&#160;  }</div><div class="line"><a name="l08196"></a><span class="lineno"> 8196</span>&#160;</div><div class="line"><a name="l08197"></a><span class="lineno"> 8197</span>&#160;  <span class="comment">// Verify that the first bit starts at a multiple of mask so that the access</span></div><div class="line"><a name="l08198"></a><span class="lineno"> 8198</span>&#160;  <span class="comment">// is aligned the same as the access width.</span></div><div class="line"><a name="l08199"></a><span class="lineno"> 8199</span>&#160;  <span class="keywordflow">if</span> (NotMaskTZ &amp;&amp; NotMaskTZ/8 % MaskedBytes) <span class="keywordflow">return</span> Result;</div><div class="line"><a name="l08200"></a><span class="lineno"> 8200</span>&#160;</div><div class="line"><a name="l08201"></a><span class="lineno"> 8201</span>&#160;  Result.first = MaskedBytes;</div><div class="line"><a name="l08202"></a><span class="lineno"> 8202</span>&#160;  Result.second = NotMaskTZ/8;</div><div class="line"><a name="l08203"></a><span class="lineno"> 8203</span>&#160;  <span class="keywordflow">return</span> Result;</div><div class="line"><a name="l08204"></a><span class="lineno"> 8204</span>&#160;}</div><div class="line"><a name="l08205"></a><span class="lineno"> 8205</span>&#160;</div><div class="line"><a name="l08206"></a><span class="lineno"> 8206</span>&#160;<span class="comment"></span></div><div class="line"><a name="l08207"></a><span class="lineno"> 8207</span>&#160;<span class="comment">/// ShrinkLoadReplaceStoreWithStore - Check to see if IVal is something that</span></div><div class="line"><a name="l08208"></a><span class="lineno"> 8208</span>&#160;<span class="comment">/// provides a value as specified by MaskInfo.  If so, replace the specified</span></div><div class="line"><a name="l08209"></a><span class="lineno"> 8209</span>&#160;<span class="comment">/// store with a narrower store of truncated IVal.</span></div><div class="line"><a name="l08210"></a><span class="lineno"> 8210</span>&#160;<span class="comment"></span><span class="keyword">static</span> <a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *</div><div class="line"><a name="l08211"></a><span class="lineno"><a class="line" href="DAGCombiner_8cpp.html#ad7dc0568fb6af72bddba2345c5f477aa"> 8211</a></span>&#160;<a class="code" href="DAGCombiner_8cpp.html#ad7dc0568fb6af72bddba2345c5f477aa">ShrinkLoadReplaceStoreWithStore</a>(<span class="keyword">const</span> std::pair&lt;unsigned, unsigned&gt; &amp;MaskInfo,</div><div class="line"><a name="l08212"></a><span class="lineno"> 8212</span>&#160;                                <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> IVal, <a class="code" href="classllvm_1_1StoreSDNode.html">StoreSDNode</a> *St,</div><div class="line"><a name="l08213"></a><span class="lineno"> 8213</span>&#160;                                DAGCombiner *<a class="code" href="namespacellvm_1_1X86II.html#a97dc14052814702ba0e2b14fb14dd02da41e3661a4c59a694dcd9b978acdde1a9">DC</a>) {</div><div class="line"><a name="l08214"></a><span class="lineno"> 8214</span>&#160;  <span class="keywordtype">unsigned</span> NumBytes = MaskInfo.first;</div><div class="line"><a name="l08215"></a><span class="lineno"> 8215</span>&#160;  <span class="keywordtype">unsigned</span> ByteShift = MaskInfo.second;</div><div class="line"><a name="l08216"></a><span class="lineno"> 8216</span>&#160;  <a class="code" href="classllvm_1_1SelectionDAG.html">SelectionDAG</a> &amp;DAG = DC-&gt;getDAG();</div><div class="line"><a name="l08217"></a><span class="lineno"> 8217</span>&#160;</div><div class="line"><a name="l08218"></a><span class="lineno"> 8218</span>&#160;  <span class="comment">// Check to see if IVal is all zeros in the part being masked in by the &#39;or&#39;</span></div><div class="line"><a name="l08219"></a><span class="lineno"> 8219</span>&#160;  <span class="comment">// that uses this.  If not, this is not a replacement.</span></div><div class="line"><a name="l08220"></a><span class="lineno"> 8220</span>&#160;  <a class="code" href="classllvm_1_1APInt.html">APInt</a> Mask = ~<a class="code" href="classllvm_1_1APInt.html">APInt</a>::getBitsSet(IVal.<a class="code" href="classllvm_1_1SDValue.html#a70aa652293da070dfe5b9fae309d0112">getValueSizeInBits</a>(),</div><div class="line"><a name="l08221"></a><span class="lineno"> 8221</span>&#160;                                  ByteShift*8, (ByteShift+NumBytes)*8);</div><div class="line"><a name="l08222"></a><span class="lineno"> 8222</span>&#160;  <span class="keywordflow">if</span> (!DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af99f246db9e144fefd7a73b54ef0bbf7">MaskedValueIsZero</a>(IVal, Mask)) <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l08223"></a><span class="lineno"> 8223</span>&#160;</div><div class="line"><a name="l08224"></a><span class="lineno"> 8224</span>&#160;  <span class="comment">// Check that it is legal on the target to do this.  It is legal if the new</span></div><div class="line"><a name="l08225"></a><span class="lineno"> 8225</span>&#160;  <span class="comment">// VT we&#39;re shrinking to (i8/i16/i32) is legal or we&#39;re still before type</span></div><div class="line"><a name="l08226"></a><span class="lineno"> 8226</span>&#160;  <span class="comment">// legalization.</span></div><div class="line"><a name="l08227"></a><span class="lineno"> 8227</span>&#160;  <a class="code" href="classllvm_1_1MVT.html">MVT</a> VT = <a class="code" href="classllvm_1_1MVT.html#aded931e298cfa08b5038ca2b63c06bb8">MVT::getIntegerVT</a>(NumBytes*8);</div><div class="line"><a name="l08228"></a><span class="lineno"> 8228</span>&#160;  <span class="keywordflow">if</span> (!DC-&gt;isTypeLegal(VT))</div><div class="line"><a name="l08229"></a><span class="lineno"> 8229</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l08230"></a><span class="lineno"> 8230</span>&#160;</div><div class="line"><a name="l08231"></a><span class="lineno"> 8231</span>&#160;  <span class="comment">// Okay, we can do this!  Replace the &#39;St&#39; store with a store of IVal that is</span></div><div class="line"><a name="l08232"></a><span class="lineno"> 8232</span>&#160;  <span class="comment">// shifted by ByteShift and truncated down to NumBytes.</span></div><div class="line"><a name="l08233"></a><span class="lineno"> 8233</span>&#160;  <span class="keywordflow">if</span> (ByteShift)</div><div class="line"><a name="l08234"></a><span class="lineno"> 8234</span>&#160;    IVal = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a3c6553c8acebe1b57c211ee45e2d8f98">ISD::SRL</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(IVal), IVal.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>(), IVal,</div><div class="line"><a name="l08235"></a><span class="lineno"> 8235</span>&#160;                       DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(ByteShift*8,</div><div class="line"><a name="l08236"></a><span class="lineno"> 8236</span>&#160;                                    DC-&gt;getShiftAmountTy(IVal.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>())));</div><div class="line"><a name="l08237"></a><span class="lineno"> 8237</span>&#160;</div><div class="line"><a name="l08238"></a><span class="lineno"> 8238</span>&#160;  <span class="comment">// Figure out the offset for the store and the alignment of the access.</span></div><div class="line"><a name="l08239"></a><span class="lineno"> 8239</span>&#160;  <span class="keywordtype">unsigned</span> StOffset;</div><div class="line"><a name="l08240"></a><span class="lineno"> 8240</span>&#160;  <span class="keywordtype">unsigned</span> NewAlign = St-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a4f68cd016138440f215ad80c1d6c1e04">getAlignment</a>();</div><div class="line"><a name="l08241"></a><span class="lineno"> 8241</span>&#160;</div><div class="line"><a name="l08242"></a><span class="lineno"> 8242</span>&#160;  <span class="keywordflow">if</span> (DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a848b46af8fabd1ab34b28adbc3665609">getTargetLoweringInfo</a>().<a class="code" href="classllvm_1_1TargetLoweringBase.html#a7fe87806292e4bb35d59a51930f3ae0e">isLittleEndian</a>())</div><div class="line"><a name="l08243"></a><span class="lineno"> 8243</span>&#160;    StOffset = ByteShift;</div><div class="line"><a name="l08244"></a><span class="lineno"> 8244</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l08245"></a><span class="lineno"> 8245</span>&#160;    StOffset = IVal.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>().<a class="code" href="structllvm_1_1EVT.html#a451be47fed950157cb4c327bc9f91c2d">getStoreSize</a>() - ByteShift - NumBytes;</div><div class="line"><a name="l08246"></a><span class="lineno"> 8246</span>&#160;</div><div class="line"><a name="l08247"></a><span class="lineno"> 8247</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Ptr = St-&gt;<a class="code" href="classllvm_1_1StoreSDNode.html#aec453733fbb9f24036960fdc6b3b4b46">getBasePtr</a>();</div><div class="line"><a name="l08248"></a><span class="lineno"> 8248</span>&#160;  <span class="keywordflow">if</span> (StOffset) {</div><div class="line"><a name="l08249"></a><span class="lineno"> 8249</span>&#160;    Ptr = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a269996b43a1f3e1d1f84a70fd4387535">ISD::ADD</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(IVal), Ptr.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>(),</div><div class="line"><a name="l08250"></a><span class="lineno"> 8250</span>&#160;                      Ptr, DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(StOffset, Ptr.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>()));</div><div class="line"><a name="l08251"></a><span class="lineno"> 8251</span>&#160;    NewAlign = <a class="code" href="namespacellvm.html#af36d7e69ab16b64b2e3a48c83aa9f0f6">MinAlign</a>(NewAlign, StOffset);</div><div class="line"><a name="l08252"></a><span class="lineno"> 8252</span>&#160;  }</div><div class="line"><a name="l08253"></a><span class="lineno"> 8253</span>&#160;</div><div class="line"><a name="l08254"></a><span class="lineno"> 8254</span>&#160;  <span class="comment">// Truncate down to the new size.</span></div><div class="line"><a name="l08255"></a><span class="lineno"> 8255</span>&#160;  IVal = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ae690127648393001a7d5b93dc23da7b3">ISD::TRUNCATE</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(IVal), VT, IVal);</div><div class="line"><a name="l08256"></a><span class="lineno"> 8256</span>&#160;</div><div class="line"><a name="l08257"></a><span class="lineno"> 8257</span>&#160;  ++OpsNarrowed;</div><div class="line"><a name="l08258"></a><span class="lineno"> 8258</span>&#160;  <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a2bdce1dfec3bab37c9a38e516eba42e7">getStore</a>(St-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#ae3cb6fbf8c8cb79e10ac61bd98c85211">getChain</a>(), <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(St), IVal, Ptr,</div><div class="line"><a name="l08259"></a><span class="lineno"> 8259</span>&#160;                      St-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a2fa8491ab36125d7f5dd38d3a4868934">getPointerInfo</a>().<a class="code" href="structllvm_1_1MachinePointerInfo.html#aa7b903b38006dd4cb8fcf8854af5b6b9">getWithOffset</a>(StOffset),</div><div class="line"><a name="l08260"></a><span class="lineno"> 8260</span>&#160;                      <span class="keyword">false</span>, <span class="keyword">false</span>, NewAlign).getNode();</div><div class="line"><a name="l08261"></a><span class="lineno"> 8261</span>&#160;}</div><div class="line"><a name="l08262"></a><span class="lineno"> 8262</span>&#160;</div><div class="line"><a name="l08263"></a><span class="lineno"> 8263</span>&#160;<span class="comment"></span></div><div class="line"><a name="l08264"></a><span class="lineno"> 8264</span>&#160;<span class="comment">/// ReduceLoadOpStoreWidth - Look for sequence of load / op / store where op is</span></div><div class="line"><a name="l08265"></a><span class="lineno"> 8265</span>&#160;<span class="comment">/// one of &#39;or&#39;, &#39;xor&#39;, and &#39;and&#39; of immediates. If &#39;op&#39; is only touching some</span></div><div class="line"><a name="l08266"></a><span class="lineno"> 8266</span>&#160;<span class="comment">/// of the loaded bits, try narrowing the load and store if it would end up</span></div><div class="line"><a name="l08267"></a><span class="lineno"> 8267</span>&#160;<span class="comment">/// being a win for performance or code size.</span></div><div class="line"><a name="l08268"></a><span class="lineno"> 8268</span>&#160;<span class="comment"></span><a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::ReduceLoadOpStoreWidth(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N) {</div><div class="line"><a name="l08269"></a><span class="lineno"> 8269</span>&#160;  <a class="code" href="classllvm_1_1StoreSDNode.html">StoreSDNode</a> *<a class="code" href="namespacellvm_1_1A64DB.html#a6fce8157775f3ec93f326b52b0f1e0f5a4916e736d6b7cc68359b39d5eb50f6db">ST</a>  = cast&lt;StoreSDNode&gt;(<a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>);</div><div class="line"><a name="l08270"></a><span class="lineno"> 8270</span>&#160;  <span class="keywordflow">if</span> (ST-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#acd3bb9ee2ec53fa4be1fdf155b0b5a17">isVolatile</a>())</div><div class="line"><a name="l08271"></a><span class="lineno"> 8271</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l08272"></a><span class="lineno"> 8272</span>&#160;</div><div class="line"><a name="l08273"></a><span class="lineno"> 8273</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Chain = ST-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#ae3cb6fbf8c8cb79e10ac61bd98c85211">getChain</a>();</div><div class="line"><a name="l08274"></a><span class="lineno"> 8274</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> <a class="code" href="classllvm_1_1Value.html">Value</a> = ST-&gt;<a class="code" href="classllvm_1_1StoreSDNode.html#a7f9820a84907a5aa530d4dc36f841c76">getValue</a>();</div><div class="line"><a name="l08275"></a><span class="lineno"> 8275</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Ptr   = ST-&gt;<a class="code" href="classllvm_1_1StoreSDNode.html#aec453733fbb9f24036960fdc6b3b4b46">getBasePtr</a>();</div><div class="line"><a name="l08276"></a><span class="lineno"> 8276</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> VT = Value.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>();</div><div class="line"><a name="l08277"></a><span class="lineno"> 8277</span>&#160;</div><div class="line"><a name="l08278"></a><span class="lineno"> 8278</span>&#160;  <span class="keywordflow">if</span> (ST-&gt;<a class="code" href="classllvm_1_1StoreSDNode.html#a272cb283a679298b7e991db7daf823ed">isTruncatingStore</a>() || VT.<a class="code" href="structllvm_1_1EVT.html#a73f7c824cad61a47c21bf6d652ae2fd7">isVector</a>() || !Value.<a class="code" href="classllvm_1_1SDValue.html#a97b0f24f3e52f030830fca6fbfcbd37d">hasOneUse</a>())</div><div class="line"><a name="l08279"></a><span class="lineno"> 8279</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l08280"></a><span class="lineno"> 8280</span>&#160;</div><div class="line"><a name="l08281"></a><span class="lineno"> 8281</span>&#160;  <span class="keywordtype">unsigned</span> Opc = Value.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>();</div><div class="line"><a name="l08282"></a><span class="lineno"> 8282</span>&#160;</div><div class="line"><a name="l08283"></a><span class="lineno"> 8283</span>&#160;  <span class="comment">// If this is &quot;store (or X, Y), P&quot; and X is &quot;(and (load P), cst)&quot;, where cst</span></div><div class="line"><a name="l08284"></a><span class="lineno"> 8284</span>&#160;  <span class="comment">// is a byte mask indicating a consecutive number of bytes, check to see if</span></div><div class="line"><a name="l08285"></a><span class="lineno"> 8285</span>&#160;  <span class="comment">// Y is known to provide just those bytes.  If so, we try to replace the</span></div><div class="line"><a name="l08286"></a><span class="lineno"> 8286</span>&#160;  <span class="comment">// load + replace + store sequence with a single (narrower) store, which makes</span></div><div class="line"><a name="l08287"></a><span class="lineno"> 8287</span>&#160;  <span class="comment">// the load dead.</span></div><div class="line"><a name="l08288"></a><span class="lineno"> 8288</span>&#160;  <span class="keywordflow">if</span> (Opc == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7415ab9f2172c59a2ee7c7a02afa56a4">ISD::OR</a>) {</div><div class="line"><a name="l08289"></a><span class="lineno"> 8289</span>&#160;    std::pair&lt;unsigned, unsigned&gt; MaskedLoad;</div><div class="line"><a name="l08290"></a><span class="lineno"> 8290</span>&#160;    MaskedLoad = <a class="code" href="DAGCombiner_8cpp.html#ab4dad3fc933e6caae6cffa219ea8797f">CheckForMaskedLoad</a>(Value.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0), Ptr, Chain);</div><div class="line"><a name="l08291"></a><span class="lineno"> 8291</span>&#160;    <span class="keywordflow">if</span> (MaskedLoad.first)</div><div class="line"><a name="l08292"></a><span class="lineno"> 8292</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *NewST = <a class="code" href="DAGCombiner_8cpp.html#ad7dc0568fb6af72bddba2345c5f477aa">ShrinkLoadReplaceStoreWithStore</a>(MaskedLoad,</div><div class="line"><a name="l08293"></a><span class="lineno"> 8293</span>&#160;                                                  Value.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1), <a class="code" href="namespacellvm_1_1A64DB.html#a6fce8157775f3ec93f326b52b0f1e0f5a4916e736d6b7cc68359b39d5eb50f6db">ST</a>,<span class="keyword">this</span>))</div><div class="line"><a name="l08294"></a><span class="lineno"> 8294</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(NewST, 0);</div><div class="line"><a name="l08295"></a><span class="lineno"> 8295</span>&#160;</div><div class="line"><a name="l08296"></a><span class="lineno"> 8296</span>&#160;    <span class="comment">// Or is commutative, so try swapping X and Y.</span></div><div class="line"><a name="l08297"></a><span class="lineno"> 8297</span>&#160;    MaskedLoad = <a class="code" href="DAGCombiner_8cpp.html#ab4dad3fc933e6caae6cffa219ea8797f">CheckForMaskedLoad</a>(Value.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1), Ptr, Chain);</div><div class="line"><a name="l08298"></a><span class="lineno"> 8298</span>&#160;    <span class="keywordflow">if</span> (MaskedLoad.first)</div><div class="line"><a name="l08299"></a><span class="lineno"> 8299</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *NewST = <a class="code" href="DAGCombiner_8cpp.html#ad7dc0568fb6af72bddba2345c5f477aa">ShrinkLoadReplaceStoreWithStore</a>(MaskedLoad,</div><div class="line"><a name="l08300"></a><span class="lineno"> 8300</span>&#160;                                                  Value.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0), <a class="code" href="namespacellvm_1_1A64DB.html#a6fce8157775f3ec93f326b52b0f1e0f5a4916e736d6b7cc68359b39d5eb50f6db">ST</a>,<span class="keyword">this</span>))</div><div class="line"><a name="l08301"></a><span class="lineno"> 8301</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(NewST, 0);</div><div class="line"><a name="l08302"></a><span class="lineno"> 8302</span>&#160;  }</div><div class="line"><a name="l08303"></a><span class="lineno"> 8303</span>&#160;</div><div class="line"><a name="l08304"></a><span class="lineno"> 8304</span>&#160;  <span class="keywordflow">if</span> ((Opc != <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7415ab9f2172c59a2ee7c7a02afa56a4">ISD::OR</a> &amp;&amp; Opc != <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a92febb83e6ba116eb7aae8e7e3f70cc1">ISD::XOR</a> &amp;&amp; Opc != <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ac513a7da1bf74fb3e3c594da8534f2d2">ISD::AND</a>) ||</div><div class="line"><a name="l08305"></a><span class="lineno"> 8305</span>&#160;      Value.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1).<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() != <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110aac2f0a84dd2aa5ee4c3f1385e9565f5e">ISD::Constant</a>)</div><div class="line"><a name="l08306"></a><span class="lineno"> 8306</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l08307"></a><span class="lineno"> 8307</span>&#160;</div><div class="line"><a name="l08308"></a><span class="lineno"> 8308</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N0 = Value.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0);</div><div class="line"><a name="l08309"></a><span class="lineno"> 8309</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1ISD.html#afaaeadcd82b42fc0d385a6247bf7bb52">ISD::isNormalLoad</a>(N0.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()) &amp;&amp; N0.<a class="code" href="classllvm_1_1SDValue.html#a97b0f24f3e52f030830fca6fbfcbd37d">hasOneUse</a>() &amp;&amp;</div><div class="line"><a name="l08310"></a><span class="lineno"> 8310</span>&#160;      Chain == <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(N0.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>(), 1)) {</div><div class="line"><a name="l08311"></a><span class="lineno"> 8311</span>&#160;    <a class="code" href="classllvm_1_1LoadSDNode.html">LoadSDNode</a> *<a class="code" href="namespacellvm_1_1A64DB.html#a6fce8157775f3ec93f326b52b0f1e0f5ad61b145eb8cbab18feb1b2e2ce269a7e">LD</a> = cast&lt;LoadSDNode&gt;(N0);</div><div class="line"><a name="l08312"></a><span class="lineno"> 8312</span>&#160;    <span class="keywordflow">if</span> (LD-&gt;<a class="code" href="classllvm_1_1LoadSDNode.html#a3ded48ce66b58b7e7e143991df5dbfae">getBasePtr</a>() != Ptr ||</div><div class="line"><a name="l08313"></a><span class="lineno"> 8313</span>&#160;        LD-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a2fa8491ab36125d7f5dd38d3a4868934">getPointerInfo</a>().<a class="code" href="structllvm_1_1MachinePointerInfo.html#a23e5cd18f87dae8314d615484032d6a2">getAddrSpace</a>() !=</div><div class="line"><a name="l08314"></a><span class="lineno"> 8314</span>&#160;        ST-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a2fa8491ab36125d7f5dd38d3a4868934">getPointerInfo</a>().<a class="code" href="structllvm_1_1MachinePointerInfo.html#a23e5cd18f87dae8314d615484032d6a2">getAddrSpace</a>())</div><div class="line"><a name="l08315"></a><span class="lineno"> 8315</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l08316"></a><span class="lineno"> 8316</span>&#160;</div><div class="line"><a name="l08317"></a><span class="lineno"> 8317</span>&#160;    <span class="comment">// Find the type to narrow it the load / op / store to.</span></div><div class="line"><a name="l08318"></a><span class="lineno"> 8318</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N1 = Value.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1);</div><div class="line"><a name="l08319"></a><span class="lineno"> 8319</span>&#160;    <span class="keywordtype">unsigned</span> BitWidth = N1.<a class="code" href="classllvm_1_1SDValue.html#a70aa652293da070dfe5b9fae309d0112">getValueSizeInBits</a>();</div><div class="line"><a name="l08320"></a><span class="lineno"> 8320</span>&#160;    <a class="code" href="classllvm_1_1APInt.html">APInt</a> Imm = cast&lt;ConstantSDNode&gt;(N1)-&gt;getAPIntValue();</div><div class="line"><a name="l08321"></a><span class="lineno"> 8321</span>&#160;    <span class="keywordflow">if</span> (Opc == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ac513a7da1bf74fb3e3c594da8534f2d2">ISD::AND</a>)</div><div class="line"><a name="l08322"></a><span class="lineno"> 8322</span>&#160;      Imm ^= <a class="code" href="classllvm_1_1APInt.html#a539bdb4fdbf46e0bfcefebf5ac6d21dd">APInt::getAllOnesValue</a>(BitWidth);</div><div class="line"><a name="l08323"></a><span class="lineno"> 8323</span>&#160;    <span class="keywordflow">if</span> (Imm == 0 || Imm.<a class="code" href="classllvm_1_1APInt.html#a21260f8037e665d235ace5718cf68bc4">isAllOnesValue</a>())</div><div class="line"><a name="l08324"></a><span class="lineno"> 8324</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l08325"></a><span class="lineno"> 8325</span>&#160;    <span class="keywordtype">unsigned</span> ShAmt = Imm.<a class="code" href="classllvm_1_1APInt.html#aac277496191547e487eea07f09dffd4b">countTrailingZeros</a>();</div><div class="line"><a name="l08326"></a><span class="lineno"> 8326</span>&#160;    <span class="keywordtype">unsigned</span> MSB = BitWidth - Imm.<a class="code" href="classllvm_1_1APInt.html#af0336ea4c7f7f56354b2ca7c8859c1f9">countLeadingZeros</a>() - 1;</div><div class="line"><a name="l08327"></a><span class="lineno"> 8327</span>&#160;    <span class="keywordtype">unsigned</span> NewBW = <a class="code" href="namespacellvm.html#a0490c32aa8dd63ddc56bb046fd0258c7">NextPowerOf2</a>(MSB - ShAmt);</div><div class="line"><a name="l08328"></a><span class="lineno"> 8328</span>&#160;    <a class="code" href="structllvm_1_1EVT.html">EVT</a> NewVT = <a class="code" href="structllvm_1_1EVT.html#a752372e170e4e7c595bf8810bb52adf2">EVT::getIntegerVT</a>(*DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a39c6dff47b8dbd25cfaf6336c7056077">getContext</a>(), NewBW);</div><div class="line"><a name="l08329"></a><span class="lineno"> 8329</span>&#160;    <span class="keywordflow">while</span> (NewBW &lt; BitWidth &amp;&amp;</div><div class="line"><a name="l08330"></a><span class="lineno"> 8330</span>&#160;           !(TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a087dd0f9650e999b087c17cc7f46f2d0">isOperationLegalOrCustom</a>(Opc, NewVT) &amp;&amp;</div><div class="line"><a name="l08331"></a><span class="lineno"> 8331</span>&#160;             TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a52dbd9fc4ea2c0919913e74e003b2823">isNarrowingProfitable</a>(VT, NewVT))) {</div><div class="line"><a name="l08332"></a><span class="lineno"> 8332</span>&#160;      NewBW = <a class="code" href="namespacellvm.html#a0490c32aa8dd63ddc56bb046fd0258c7">NextPowerOf2</a>(NewBW);</div><div class="line"><a name="l08333"></a><span class="lineno"> 8333</span>&#160;      NewVT = <a class="code" href="structllvm_1_1EVT.html#a752372e170e4e7c595bf8810bb52adf2">EVT::getIntegerVT</a>(*DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a39c6dff47b8dbd25cfaf6336c7056077">getContext</a>(), NewBW);</div><div class="line"><a name="l08334"></a><span class="lineno"> 8334</span>&#160;    }</div><div class="line"><a name="l08335"></a><span class="lineno"> 8335</span>&#160;    <span class="keywordflow">if</span> (NewBW &gt;= BitWidth)</div><div class="line"><a name="l08336"></a><span class="lineno"> 8336</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l08337"></a><span class="lineno"> 8337</span>&#160;</div><div class="line"><a name="l08338"></a><span class="lineno"> 8338</span>&#160;    <span class="comment">// If the lsb changed does not start at the type bitwidth boundary,</span></div><div class="line"><a name="l08339"></a><span class="lineno"> 8339</span>&#160;    <span class="comment">// start at the previous one.</span></div><div class="line"><a name="l08340"></a><span class="lineno"> 8340</span>&#160;    <span class="keywordflow">if</span> (ShAmt % NewBW)</div><div class="line"><a name="l08341"></a><span class="lineno"> 8341</span>&#160;      ShAmt = (((ShAmt + NewBW - 1) / NewBW) * NewBW) - NewBW;</div><div class="line"><a name="l08342"></a><span class="lineno"> 8342</span>&#160;    <a class="code" href="classllvm_1_1APInt.html">APInt</a> Mask = <a class="code" href="classllvm_1_1APInt.html#a46ceedee591f92727b85641794a96061">APInt::getBitsSet</a>(BitWidth, ShAmt,</div><div class="line"><a name="l08343"></a><span class="lineno"> 8343</span>&#160;                                   std::min(BitWidth, ShAmt + NewBW));</div><div class="line"><a name="l08344"></a><span class="lineno"> 8344</span>&#160;    <span class="keywordflow">if</span> ((Imm &amp; Mask) == Imm) {</div><div class="line"><a name="l08345"></a><span class="lineno"> 8345</span>&#160;      <a class="code" href="classllvm_1_1APInt.html">APInt</a> NewImm = (Imm &amp; Mask).<a class="code" href="namespacellvm_1_1APIntOps.html#a75a71c5acb58449ea8a731e9caebf1fe">lshr</a>(ShAmt).<a class="code" href="classllvm_1_1APInt.html#a8cf5475fb3e9c737112cc248194c1040">trunc</a>(NewBW);</div><div class="line"><a name="l08346"></a><span class="lineno"> 8346</span>&#160;      <span class="keywordflow">if</span> (Opc == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ac513a7da1bf74fb3e3c594da8534f2d2">ISD::AND</a>)</div><div class="line"><a name="l08347"></a><span class="lineno"> 8347</span>&#160;        NewImm ^= <a class="code" href="classllvm_1_1APInt.html#a539bdb4fdbf46e0bfcefebf5ac6d21dd">APInt::getAllOnesValue</a>(NewBW);</div><div class="line"><a name="l08348"></a><span class="lineno"> 8348</span>&#160;      uint64_t PtrOff = ShAmt / 8;</div><div class="line"><a name="l08349"></a><span class="lineno"> 8349</span>&#160;      <span class="comment">// For big endian targets, we need to adjust the offset to the pointer to</span></div><div class="line"><a name="l08350"></a><span class="lineno"> 8350</span>&#160;      <span class="comment">// load the correct bytes.</span></div><div class="line"><a name="l08351"></a><span class="lineno"> 8351</span>&#160;      <span class="keywordflow">if</span> (TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a785a8016a792dbc65ec16688f180af71">isBigEndian</a>())</div><div class="line"><a name="l08352"></a><span class="lineno"> 8352</span>&#160;        PtrOff = (BitWidth + 7 - NewBW) / 8 - PtrOff;</div><div class="line"><a name="l08353"></a><span class="lineno"> 8353</span>&#160;</div><div class="line"><a name="l08354"></a><span class="lineno"> 8354</span>&#160;      <span class="keywordtype">unsigned</span> NewAlign = <a class="code" href="namespacellvm.html#af36d7e69ab16b64b2e3a48c83aa9f0f6">MinAlign</a>(LD-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a4f68cd016138440f215ad80c1d6c1e04">getAlignment</a>(), PtrOff);</div><div class="line"><a name="l08355"></a><span class="lineno"> 8355</span>&#160;      <a class="code" href="classllvm_1_1Type.html">Type</a> *NewVTTy = NewVT.<a class="code" href="structllvm_1_1EVT.html#a226345d0c8262e9469d30a993d1656ff">getTypeForEVT</a>(*DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a39c6dff47b8dbd25cfaf6336c7056077">getContext</a>());</div><div class="line"><a name="l08356"></a><span class="lineno"> 8356</span>&#160;      <span class="keywordflow">if</span> (NewAlign &lt; TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#adc25bcc279ccfb5b867c2b7b8eedaa9b">getDataLayout</a>()-&gt;<a class="code" href="classllvm_1_1DataLayout.html#abb381519d34dcb9ccf673bf7689d0721">getABITypeAlignment</a>(NewVTTy))</div><div class="line"><a name="l08357"></a><span class="lineno"> 8357</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l08358"></a><span class="lineno"> 8358</span>&#160;</div><div class="line"><a name="l08359"></a><span class="lineno"> 8359</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> NewPtr = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a269996b43a1f3e1d1f84a70fd4387535">ISD::ADD</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(LD),</div><div class="line"><a name="l08360"></a><span class="lineno"> 8360</span>&#160;                                   Ptr.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>(), Ptr,</div><div class="line"><a name="l08361"></a><span class="lineno"> 8361</span>&#160;                                   DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(PtrOff, Ptr.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>()));</div><div class="line"><a name="l08362"></a><span class="lineno"> 8362</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> NewLD = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#ab8395be5698f080c0036d866e121a478">getLoad</a>(NewVT, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N0),</div><div class="line"><a name="l08363"></a><span class="lineno"> 8363</span>&#160;                                  LD-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#ae3cb6fbf8c8cb79e10ac61bd98c85211">getChain</a>(), NewPtr,</div><div class="line"><a name="l08364"></a><span class="lineno"> 8364</span>&#160;                                  LD-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a2fa8491ab36125d7f5dd38d3a4868934">getPointerInfo</a>().<a class="code" href="structllvm_1_1MachinePointerInfo.html#aa7b903b38006dd4cb8fcf8854af5b6b9">getWithOffset</a>(PtrOff),</div><div class="line"><a name="l08365"></a><span class="lineno"> 8365</span>&#160;                                  LD-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#acd3bb9ee2ec53fa4be1fdf155b0b5a17">isVolatile</a>(), LD-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a967ffaf77f64a5deb1e96951e4224112">isNonTemporal</a>(),</div><div class="line"><a name="l08366"></a><span class="lineno"> 8366</span>&#160;                                  LD-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#ad8e64770a04af6b3da2099477e7c28de">isInvariant</a>(), NewAlign,</div><div class="line"><a name="l08367"></a><span class="lineno"> 8367</span>&#160;                                  LD-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a23670ceb5797afa3d45ca1a9b011fd87">getTBAAInfo</a>());</div><div class="line"><a name="l08368"></a><span class="lineno"> 8368</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> NewVal = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(Opc, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(Value), NewVT, NewLD,</div><div class="line"><a name="l08369"></a><span class="lineno"> 8369</span>&#160;                                   DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(NewImm, NewVT));</div><div class="line"><a name="l08370"></a><span class="lineno"> 8370</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> NewST = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a2bdce1dfec3bab37c9a38e516eba42e7">getStore</a>(Chain, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N),</div><div class="line"><a name="l08371"></a><span class="lineno"> 8371</span>&#160;                                   NewVal, NewPtr,</div><div class="line"><a name="l08372"></a><span class="lineno"> 8372</span>&#160;                                   ST-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a2fa8491ab36125d7f5dd38d3a4868934">getPointerInfo</a>().<a class="code" href="structllvm_1_1MachinePointerInfo.html#aa7b903b38006dd4cb8fcf8854af5b6b9">getWithOffset</a>(PtrOff),</div><div class="line"><a name="l08373"></a><span class="lineno"> 8373</span>&#160;                                   <span class="keyword">false</span>, <span class="keyword">false</span>, NewAlign);</div><div class="line"><a name="l08374"></a><span class="lineno"> 8374</span>&#160;</div><div class="line"><a name="l08375"></a><span class="lineno"> 8375</span>&#160;      AddToWorkList(NewPtr.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l08376"></a><span class="lineno"> 8376</span>&#160;      AddToWorkList(NewLD.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l08377"></a><span class="lineno"> 8377</span>&#160;      AddToWorkList(NewVal.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l08378"></a><span class="lineno"> 8378</span>&#160;      WorkListRemover DeadNodes(*<span class="keyword">this</span>);</div><div class="line"><a name="l08379"></a><span class="lineno"> 8379</span>&#160;      DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#ac630ccda26fea2f45afa3fb89bc1a8f4">ReplaceAllUsesOfValueWith</a>(N0.<a class="code" href="classllvm_1_1SDValue.html#a040481b9bda32faa6b1435532405d88f">getValue</a>(1), NewLD.<a class="code" href="classllvm_1_1SDValue.html#a040481b9bda32faa6b1435532405d88f">getValue</a>(1));</div><div class="line"><a name="l08380"></a><span class="lineno"> 8380</span>&#160;      ++OpsNarrowed;</div><div class="line"><a name="l08381"></a><span class="lineno"> 8381</span>&#160;      <span class="keywordflow">return</span> NewST;</div><div class="line"><a name="l08382"></a><span class="lineno"> 8382</span>&#160;    }</div><div class="line"><a name="l08383"></a><span class="lineno"> 8383</span>&#160;  }</div><div class="line"><a name="l08384"></a><span class="lineno"> 8384</span>&#160;</div><div class="line"><a name="l08385"></a><span class="lineno"> 8385</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l08386"></a><span class="lineno"> 8386</span>&#160;}</div><div class="line"><a name="l08387"></a><span class="lineno"> 8387</span>&#160;<span class="comment"></span></div><div class="line"><a name="l08388"></a><span class="lineno"> 8388</span>&#160;<span class="comment">/// TransformFPLoadStorePair - For a given floating point load / store pair,</span></div><div class="line"><a name="l08389"></a><span class="lineno"> 8389</span>&#160;<span class="comment">/// if the load value isn&#39;t used by any other operations, then consider</span></div><div class="line"><a name="l08390"></a><span class="lineno"> 8390</span>&#160;<span class="comment">/// transforming the pair to integer load / store operations if the target</span></div><div class="line"><a name="l08391"></a><span class="lineno"> 8391</span>&#160;<span class="comment">/// deems the transformation profitable.</span></div><div class="line"><a name="l08392"></a><span class="lineno"> 8392</span>&#160;<span class="comment"></span><a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::TransformFPLoadStorePair(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N) {</div><div class="line"><a name="l08393"></a><span class="lineno"> 8393</span>&#160;  <a class="code" href="classllvm_1_1StoreSDNode.html">StoreSDNode</a> *<a class="code" href="namespacellvm_1_1A64DB.html#a6fce8157775f3ec93f326b52b0f1e0f5a4916e736d6b7cc68359b39d5eb50f6db">ST</a>  = cast&lt;StoreSDNode&gt;(<a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>);</div><div class="line"><a name="l08394"></a><span class="lineno"> 8394</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Chain = ST-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#ae3cb6fbf8c8cb79e10ac61bd98c85211">getChain</a>();</div><div class="line"><a name="l08395"></a><span class="lineno"> 8395</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> <a class="code" href="classllvm_1_1Value.html">Value</a> = ST-&gt;<a class="code" href="classllvm_1_1StoreSDNode.html#a7f9820a84907a5aa530d4dc36f841c76">getValue</a>();</div><div class="line"><a name="l08396"></a><span class="lineno"> 8396</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1ISD.html#a308088c2d65f8f3955f5fb0f6aca7ccc">ISD::isNormalStore</a>(ST) &amp;&amp; <a class="code" href="namespacellvm_1_1ISD.html#afaaeadcd82b42fc0d385a6247bf7bb52">ISD::isNormalLoad</a>(Value.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()) &amp;&amp;</div><div class="line"><a name="l08397"></a><span class="lineno"> 8397</span>&#160;      Value.<a class="code" href="classllvm_1_1SDValue.html#a97b0f24f3e52f030830fca6fbfcbd37d">hasOneUse</a>() &amp;&amp;</div><div class="line"><a name="l08398"></a><span class="lineno"> 8398</span>&#160;      Chain == <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(Value.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>(), 1)) {</div><div class="line"><a name="l08399"></a><span class="lineno"> 8399</span>&#160;    <a class="code" href="classllvm_1_1LoadSDNode.html">LoadSDNode</a> *<a class="code" href="namespacellvm_1_1A64DB.html#a6fce8157775f3ec93f326b52b0f1e0f5ad61b145eb8cbab18feb1b2e2ce269a7e">LD</a> = cast&lt;LoadSDNode&gt;(Value);</div><div class="line"><a name="l08400"></a><span class="lineno"> 8400</span>&#160;    <a class="code" href="structllvm_1_1EVT.html">EVT</a> VT = LD-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a7cead3a2a7771e61083bcc6959915a13">getMemoryVT</a>();</div><div class="line"><a name="l08401"></a><span class="lineno"> 8401</span>&#160;    <span class="keywordflow">if</span> (!VT.isFloatingPoint() ||</div><div class="line"><a name="l08402"></a><span class="lineno"> 8402</span>&#160;        VT != ST-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a7cead3a2a7771e61083bcc6959915a13">getMemoryVT</a>() ||</div><div class="line"><a name="l08403"></a><span class="lineno"> 8403</span>&#160;        LD-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a967ffaf77f64a5deb1e96951e4224112">isNonTemporal</a>() ||</div><div class="line"><a name="l08404"></a><span class="lineno"> 8404</span>&#160;        ST-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a967ffaf77f64a5deb1e96951e4224112">isNonTemporal</a>() ||</div><div class="line"><a name="l08405"></a><span class="lineno"> 8405</span>&#160;        LD-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a2fa8491ab36125d7f5dd38d3a4868934">getPointerInfo</a>().<a class="code" href="structllvm_1_1MachinePointerInfo.html#a23e5cd18f87dae8314d615484032d6a2">getAddrSpace</a>() != 0 ||</div><div class="line"><a name="l08406"></a><span class="lineno"> 8406</span>&#160;        ST-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a2fa8491ab36125d7f5dd38d3a4868934">getPointerInfo</a>().<a class="code" href="structllvm_1_1MachinePointerInfo.html#a23e5cd18f87dae8314d615484032d6a2">getAddrSpace</a>() != 0)</div><div class="line"><a name="l08407"></a><span class="lineno"> 8407</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l08408"></a><span class="lineno"> 8408</span>&#160;</div><div class="line"><a name="l08409"></a><span class="lineno"> 8409</span>&#160;    <a class="code" href="structllvm_1_1EVT.html">EVT</a> IntVT = <a class="code" href="structllvm_1_1EVT.html#a752372e170e4e7c595bf8810bb52adf2">EVT::getIntegerVT</a>(*DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a39c6dff47b8dbd25cfaf6336c7056077">getContext</a>(), VT.getSizeInBits());</div><div class="line"><a name="l08410"></a><span class="lineno"> 8410</span>&#160;    <span class="keywordflow">if</span> (!TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a055b3905dbbc16fae11510b9ebd1e00c">isOperationLegal</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a269b81f007000306e3e69d0d290c2159">ISD::LOAD</a>, IntVT) ||</div><div class="line"><a name="l08411"></a><span class="lineno"> 8411</span>&#160;        !TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a055b3905dbbc16fae11510b9ebd1e00c">isOperationLegal</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a047178c3b2c6a5df40ae22a407b8aca9">ISD::STORE</a>, IntVT) ||</div><div class="line"><a name="l08412"></a><span class="lineno"> 8412</span>&#160;        !TLI.<a class="code" href="classllvm_1_1TargetLowering.html#afe39ddd0add24d96bfbbb2b3ab3df3de">isDesirableToTransformToIntegerOp</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a269b81f007000306e3e69d0d290c2159">ISD::LOAD</a>, VT) ||</div><div class="line"><a name="l08413"></a><span class="lineno"> 8413</span>&#160;        !TLI.<a class="code" href="classllvm_1_1TargetLowering.html#afe39ddd0add24d96bfbbb2b3ab3df3de">isDesirableToTransformToIntegerOp</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a047178c3b2c6a5df40ae22a407b8aca9">ISD::STORE</a>, VT))</div><div class="line"><a name="l08414"></a><span class="lineno"> 8414</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l08415"></a><span class="lineno"> 8415</span>&#160;</div><div class="line"><a name="l08416"></a><span class="lineno"> 8416</span>&#160;    <span class="keywordtype">unsigned</span> LDAlign = LD-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a4f68cd016138440f215ad80c1d6c1e04">getAlignment</a>();</div><div class="line"><a name="l08417"></a><span class="lineno"> 8417</span>&#160;    <span class="keywordtype">unsigned</span> STAlign = ST-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a4f68cd016138440f215ad80c1d6c1e04">getAlignment</a>();</div><div class="line"><a name="l08418"></a><span class="lineno"> 8418</span>&#160;    <a class="code" href="classllvm_1_1Type.html">Type</a> *IntVTTy = IntVT.<a class="code" href="structllvm_1_1EVT.html#a226345d0c8262e9469d30a993d1656ff">getTypeForEVT</a>(*DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a39c6dff47b8dbd25cfaf6336c7056077">getContext</a>());</div><div class="line"><a name="l08419"></a><span class="lineno"> 8419</span>&#160;    <span class="keywordtype">unsigned</span> ABIAlign = TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#adc25bcc279ccfb5b867c2b7b8eedaa9b">getDataLayout</a>()-&gt;<a class="code" href="classllvm_1_1DataLayout.html#abb381519d34dcb9ccf673bf7689d0721">getABITypeAlignment</a>(IntVTTy);</div><div class="line"><a name="l08420"></a><span class="lineno"> 8420</span>&#160;    <span class="keywordflow">if</span> (LDAlign &lt; ABIAlign || STAlign &lt; ABIAlign)</div><div class="line"><a name="l08421"></a><span class="lineno"> 8421</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l08422"></a><span class="lineno"> 8422</span>&#160;</div><div class="line"><a name="l08423"></a><span class="lineno"> 8423</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> NewLD = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#ab8395be5698f080c0036d866e121a478">getLoad</a>(IntVT, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(Value),</div><div class="line"><a name="l08424"></a><span class="lineno"> 8424</span>&#160;                                LD-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#ae3cb6fbf8c8cb79e10ac61bd98c85211">getChain</a>(), LD-&gt;<a class="code" href="classllvm_1_1LoadSDNode.html#a3ded48ce66b58b7e7e143991df5dbfae">getBasePtr</a>(),</div><div class="line"><a name="l08425"></a><span class="lineno"> 8425</span>&#160;                                LD-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a2fa8491ab36125d7f5dd38d3a4868934">getPointerInfo</a>(),</div><div class="line"><a name="l08426"></a><span class="lineno"> 8426</span>&#160;                                <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, LDAlign);</div><div class="line"><a name="l08427"></a><span class="lineno"> 8427</span>&#160;</div><div class="line"><a name="l08428"></a><span class="lineno"> 8428</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> NewST = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a2bdce1dfec3bab37c9a38e516eba42e7">getStore</a>(NewLD.<a class="code" href="classllvm_1_1SDValue.html#a040481b9bda32faa6b1435532405d88f">getValue</a>(1), <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N),</div><div class="line"><a name="l08429"></a><span class="lineno"> 8429</span>&#160;                                 NewLD, ST-&gt;<a class="code" href="classllvm_1_1StoreSDNode.html#aec453733fbb9f24036960fdc6b3b4b46">getBasePtr</a>(),</div><div class="line"><a name="l08430"></a><span class="lineno"> 8430</span>&#160;                                 ST-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a2fa8491ab36125d7f5dd38d3a4868934">getPointerInfo</a>(),</div><div class="line"><a name="l08431"></a><span class="lineno"> 8431</span>&#160;                                 <span class="keyword">false</span>, <span class="keyword">false</span>, STAlign);</div><div class="line"><a name="l08432"></a><span class="lineno"> 8432</span>&#160;</div><div class="line"><a name="l08433"></a><span class="lineno"> 8433</span>&#160;    AddToWorkList(NewLD.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l08434"></a><span class="lineno"> 8434</span>&#160;    AddToWorkList(NewST.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l08435"></a><span class="lineno"> 8435</span>&#160;    WorkListRemover DeadNodes(*<span class="keyword">this</span>);</div><div class="line"><a name="l08436"></a><span class="lineno"> 8436</span>&#160;    DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#ac630ccda26fea2f45afa3fb89bc1a8f4">ReplaceAllUsesOfValueWith</a>(Value.<a class="code" href="classllvm_1_1SDValue.html#a040481b9bda32faa6b1435532405d88f">getValue</a>(1), NewLD.<a class="code" href="classllvm_1_1SDValue.html#a040481b9bda32faa6b1435532405d88f">getValue</a>(1));</div><div class="line"><a name="l08437"></a><span class="lineno"> 8437</span>&#160;    ++LdStFP2Int;</div><div class="line"><a name="l08438"></a><span class="lineno"> 8438</span>&#160;    <span class="keywordflow">return</span> NewST;</div><div class="line"><a name="l08439"></a><span class="lineno"> 8439</span>&#160;  }</div><div class="line"><a name="l08440"></a><span class="lineno"> 8440</span>&#160;</div><div class="line"><a name="l08441"></a><span class="lineno"> 8441</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l08442"></a><span class="lineno"> 8442</span>&#160;}</div><div class="line"><a name="l08443"></a><span class="lineno"> 8443</span>&#160;<span class="comment"></span></div><div class="line"><a name="l08444"></a><span class="lineno"> 8444</span>&#160;<span class="comment">/// Helper struct to parse and store a memory address as base + index + offset.</span></div><div class="line"><a name="l08445"></a><span class="lineno"> 8445</span>&#160;<span class="comment">/// We ignore sign extensions when it is safe to do so.</span></div><div class="line"><a name="l08446"></a><span class="lineno"> 8446</span>&#160;<span class="comment">/// The following two expressions are not equivalent. To differentiate we need</span></div><div class="line"><a name="l08447"></a><span class="lineno"> 8447</span>&#160;<span class="comment">/// to store whether there was a sign extension involved in the index</span></div><div class="line"><a name="l08448"></a><span class="lineno"> 8448</span>&#160;<span class="comment">/// computation.</span></div><div class="line"><a name="l08449"></a><span class="lineno"> 8449</span>&#160;<span class="comment">///  (load (i64 add (i64 copyfromreg %c)</span></div><div class="line"><a name="l08450"></a><span class="lineno"> 8450</span>&#160;<span class="comment">///                 (i64 signextend (add (i8 load %index)</span></div><div class="line"><a name="l08451"></a><span class="lineno"> 8451</span>&#160;<span class="comment">///                                      (i8 1))))</span></div><div class="line"><a name="l08452"></a><span class="lineno"> 8452</span>&#160;<span class="comment">/// vs</span></div><div class="line"><a name="l08453"></a><span class="lineno"> 8453</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l08454"></a><span class="lineno"> 8454</span>&#160;<span class="comment">/// (load (i64 add (i64 copyfromreg %c)</span></div><div class="line"><a name="l08455"></a><span class="lineno"> 8455</span>&#160;<span class="comment">///                (i64 signextend (i32 add (i32 signextend (i8 load %index))</span></div><div class="line"><a name="l08456"></a><span class="lineno"> 8456</span>&#160;<span class="comment">///                                         (i32 1)))))</span></div><div class="line"><a name="l08457"></a><span class="lineno"><a class="line" href="structBaseIndexOffset.html"> 8457</a></span>&#160;<span class="comment"></span><span class="keyword">struct </span><a class="code" href="structBaseIndexOffset.html">BaseIndexOffset</a> {</div><div class="line"><a name="l08458"></a><span class="lineno"><a class="line" href="structBaseIndexOffset.html#a4620710c0fe361d718e7a522ce3df91b"> 8458</a></span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> <a class="code" href="structBaseIndexOffset.html#a4620710c0fe361d718e7a522ce3df91b">Base</a>;</div><div class="line"><a name="l08459"></a><span class="lineno"><a class="line" href="structBaseIndexOffset.html#a6e5bf0616e9eb55f6152532be1385543"> 8459</a></span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> <a class="code" href="structBaseIndexOffset.html#a6e5bf0616e9eb55f6152532be1385543">Index</a>;</div><div class="line"><a name="l08460"></a><span class="lineno"><a class="line" href="structBaseIndexOffset.html#a2c47325c74b1570d86010535fbdc710b"> 8460</a></span>&#160;  int64_t <a class="code" href="structBaseIndexOffset.html#a2c47325c74b1570d86010535fbdc710b">Offset</a>;</div><div class="line"><a name="l08461"></a><span class="lineno"><a class="line" href="structBaseIndexOffset.html#a151d2e3f42da1515dae215679844be6f"> 8461</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="structBaseIndexOffset.html#a151d2e3f42da1515dae215679844be6f">IsIndexSignExt</a>;</div><div class="line"><a name="l08462"></a><span class="lineno"> 8462</span>&#160;</div><div class="line"><a name="l08463"></a><span class="lineno"><a class="line" href="structBaseIndexOffset.html#a9083a41b0525809912f3e00ddba64ab9"> 8463</a></span>&#160;  <a class="code" href="structBaseIndexOffset.html#a9083a41b0525809912f3e00ddba64ab9">BaseIndexOffset</a>() : Offset(0), IsIndexSignExt(<a class="code" href="namespacefalse.html">false</a>) {}</div><div class="line"><a name="l08464"></a><span class="lineno"> 8464</span>&#160;</div><div class="line"><a name="l08465"></a><span class="lineno"><a class="line" href="structBaseIndexOffset.html#a2d206eb2d19831b2315cc904868fafb9"> 8465</a></span>&#160;  <a class="code" href="structBaseIndexOffset.html#a2d206eb2d19831b2315cc904868fafb9">BaseIndexOffset</a>(<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Base, <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Index, int64_t Offset,</div><div class="line"><a name="l08466"></a><span class="lineno"> 8466</span>&#160;                  <span class="keywordtype">bool</span> IsIndexSignExt) :</div><div class="line"><a name="l08467"></a><span class="lineno"> 8467</span>&#160;    Base(Base), Index(Index), Offset(Offset), IsIndexSignExt(IsIndexSignExt) {}</div><div class="line"><a name="l08468"></a><span class="lineno"> 8468</span>&#160;</div><div class="line"><a name="l08469"></a><span class="lineno"><a class="line" href="structBaseIndexOffset.html#acd3de374c9ae917fdc018643028ea28b"> 8469</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="structBaseIndexOffset.html#acd3de374c9ae917fdc018643028ea28b">equalBaseIndex</a>(<span class="keyword">const</span> <a class="code" href="structBaseIndexOffset.html">BaseIndexOffset</a> &amp;Other) {</div><div class="line"><a name="l08470"></a><span class="lineno"> 8470</span>&#160;    <span class="keywordflow">return</span> Other.<a class="code" href="structBaseIndexOffset.html#a4620710c0fe361d718e7a522ce3df91b">Base</a> == Base &amp;&amp; Other.<a class="code" href="structBaseIndexOffset.html#a6e5bf0616e9eb55f6152532be1385543">Index</a> == Index &amp;&amp;</div><div class="line"><a name="l08471"></a><span class="lineno"> 8471</span>&#160;      Other.<a class="code" href="structBaseIndexOffset.html#a151d2e3f42da1515dae215679844be6f">IsIndexSignExt</a> == IsIndexSignExt;</div><div class="line"><a name="l08472"></a><span class="lineno"> 8472</span>&#160;  }</div><div class="line"><a name="l08473"></a><span class="lineno"> 8473</span>&#160;<span class="comment"></span></div><div class="line"><a name="l08474"></a><span class="lineno"> 8474</span>&#160;<span class="comment">  /// Parses tree in Ptr for base, index, offset addresses.</span></div><div class="line"><a name="l08475"></a><span class="lineno"><a class="line" href="structBaseIndexOffset.html#ac5a5ed57c63f39652622f85207eb30f2"> 8475</a></span>&#160;<span class="comment"></span>  <span class="keyword">static</span> <a class="code" href="structBaseIndexOffset.html">BaseIndexOffset</a> <a class="code" href="structBaseIndexOffset.html#ac5a5ed57c63f39652622f85207eb30f2">match</a>(<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Ptr) {</div><div class="line"><a name="l08476"></a><span class="lineno"> 8476</span>&#160;    <span class="keywordtype">bool</span> IsIndexSignExt = <span class="keyword">false</span>;</div><div class="line"><a name="l08477"></a><span class="lineno"> 8477</span>&#160;</div><div class="line"><a name="l08478"></a><span class="lineno"> 8478</span>&#160;    <span class="comment">// We only can pattern match BASE + INDEX + OFFSET. If Ptr is not an ADD</span></div><div class="line"><a name="l08479"></a><span class="lineno"> 8479</span>&#160;    <span class="comment">// instruction, then it could be just the BASE or everything else we don&#39;t</span></div><div class="line"><a name="l08480"></a><span class="lineno"> 8480</span>&#160;    <span class="comment">// know how to handle. Just use Ptr as BASE and give up.</span></div><div class="line"><a name="l08481"></a><span class="lineno"> 8481</span>&#160;    <span class="keywordflow">if</span> (Ptr-&gt;<a class="code" href="classllvm_1_1SDNode.html#af0d328f3f61168f4ea7d6e4044af4f97">getOpcode</a>() != <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a269996b43a1f3e1d1f84a70fd4387535">ISD::ADD</a>)</div><div class="line"><a name="l08482"></a><span class="lineno"> 8482</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="structBaseIndexOffset.html">BaseIndexOffset</a>(Ptr, <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(), 0, IsIndexSignExt);</div><div class="line"><a name="l08483"></a><span class="lineno"> 8483</span>&#160;</div><div class="line"><a name="l08484"></a><span class="lineno"> 8484</span>&#160;    <span class="comment">// We know that we have at least an ADD instruction. Try to pattern match</span></div><div class="line"><a name="l08485"></a><span class="lineno"> 8485</span>&#160;    <span class="comment">// the simple case of BASE + OFFSET.</span></div><div class="line"><a name="l08486"></a><span class="lineno"> 8486</span>&#160;    <span class="keywordflow">if</span> (isa&lt;ConstantSDNode&gt;(Ptr-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(1))) {</div><div class="line"><a name="l08487"></a><span class="lineno"> 8487</span>&#160;      int64_t Offset = cast&lt;ConstantSDNode&gt;(Ptr-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(1))-&gt;getSExtValue();</div><div class="line"><a name="l08488"></a><span class="lineno"> 8488</span>&#160;      <span class="keywordflow">return</span>  <a class="code" href="structBaseIndexOffset.html">BaseIndexOffset</a>(Ptr-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0), <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(), Offset,</div><div class="line"><a name="l08489"></a><span class="lineno"> 8489</span>&#160;                              IsIndexSignExt);</div><div class="line"><a name="l08490"></a><span class="lineno"> 8490</span>&#160;    }</div><div class="line"><a name="l08491"></a><span class="lineno"> 8491</span>&#160;</div><div class="line"><a name="l08492"></a><span class="lineno"> 8492</span>&#160;    <span class="comment">// Inside a loop the current BASE pointer is calculated using an ADD and a</span></div><div class="line"><a name="l08493"></a><span class="lineno"> 8493</span>&#160;    <span class="comment">// MUL instruction. In this case Ptr is the actual BASE pointer.</span></div><div class="line"><a name="l08494"></a><span class="lineno"> 8494</span>&#160;    <span class="comment">// (i64 add (i64 %array_ptr)</span></div><div class="line"><a name="l08495"></a><span class="lineno"> 8495</span>&#160;    <span class="comment">//          (i64 mul (i64 %induction_var)</span></div><div class="line"><a name="l08496"></a><span class="lineno"> 8496</span>&#160;    <span class="comment">//                   (i64 %element_size)))</span></div><div class="line"><a name="l08497"></a><span class="lineno"> 8497</span>&#160;    <span class="keywordflow">if</span> (Ptr-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(1)-&gt;<a class="code" href="classllvm_1_1SDNode.html#af0d328f3f61168f4ea7d6e4044af4f97">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ad8aec9273962cf78d087090c11a1dd1c">ISD::MUL</a>)</div><div class="line"><a name="l08498"></a><span class="lineno"> 8498</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="structBaseIndexOffset.html">BaseIndexOffset</a>(Ptr, <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(), 0, IsIndexSignExt);</div><div class="line"><a name="l08499"></a><span class="lineno"> 8499</span>&#160;</div><div class="line"><a name="l08500"></a><span class="lineno"> 8500</span>&#160;    <span class="comment">// Look at Base + Index + Offset cases.</span></div><div class="line"><a name="l08501"></a><span class="lineno"> 8501</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Base = Ptr-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0);</div><div class="line"><a name="l08502"></a><span class="lineno"> 8502</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> IndexOffset = Ptr-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(1);</div><div class="line"><a name="l08503"></a><span class="lineno"> 8503</span>&#160;</div><div class="line"><a name="l08504"></a><span class="lineno"> 8504</span>&#160;    <span class="comment">// Skip signextends.</span></div><div class="line"><a name="l08505"></a><span class="lineno"> 8505</span>&#160;    <span class="keywordflow">if</span> (IndexOffset-&gt;<a class="code" href="classllvm_1_1SDNode.html#af0d328f3f61168f4ea7d6e4044af4f97">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a5183f3d72924bc7c77ba8d3f5de9f602">ISD::SIGN_EXTEND</a>) {</div><div class="line"><a name="l08506"></a><span class="lineno"> 8506</span>&#160;      IndexOffset = IndexOffset-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0);</div><div class="line"><a name="l08507"></a><span class="lineno"> 8507</span>&#160;      IsIndexSignExt = <span class="keyword">true</span>;</div><div class="line"><a name="l08508"></a><span class="lineno"> 8508</span>&#160;    }</div><div class="line"><a name="l08509"></a><span class="lineno"> 8509</span>&#160;</div><div class="line"><a name="l08510"></a><span class="lineno"> 8510</span>&#160;    <span class="comment">// Either the case of Base + Index (no offset) or something else.</span></div><div class="line"><a name="l08511"></a><span class="lineno"> 8511</span>&#160;    <span class="keywordflow">if</span> (IndexOffset-&gt;<a class="code" href="classllvm_1_1SDNode.html#af0d328f3f61168f4ea7d6e4044af4f97">getOpcode</a>() != <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a269996b43a1f3e1d1f84a70fd4387535">ISD::ADD</a>)</div><div class="line"><a name="l08512"></a><span class="lineno"> 8512</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="structBaseIndexOffset.html">BaseIndexOffset</a>(Base, IndexOffset, 0, IsIndexSignExt);</div><div class="line"><a name="l08513"></a><span class="lineno"> 8513</span>&#160;</div><div class="line"><a name="l08514"></a><span class="lineno"> 8514</span>&#160;    <span class="comment">// Now we have the case of Base + Index + offset.</span></div><div class="line"><a name="l08515"></a><span class="lineno"> 8515</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Index = IndexOffset-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0);</div><div class="line"><a name="l08516"></a><span class="lineno"> 8516</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Offset = IndexOffset-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(1);</div><div class="line"><a name="l08517"></a><span class="lineno"> 8517</span>&#160;</div><div class="line"><a name="l08518"></a><span class="lineno"> 8518</span>&#160;    <span class="keywordflow">if</span> (!isa&lt;ConstantSDNode&gt;(Offset))</div><div class="line"><a name="l08519"></a><span class="lineno"> 8519</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="structBaseIndexOffset.html">BaseIndexOffset</a>(Ptr, <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(), 0, IsIndexSignExt);</div><div class="line"><a name="l08520"></a><span class="lineno"> 8520</span>&#160;</div><div class="line"><a name="l08521"></a><span class="lineno"> 8521</span>&#160;    <span class="comment">// Ignore signextends.</span></div><div class="line"><a name="l08522"></a><span class="lineno"> 8522</span>&#160;    <span class="keywordflow">if</span> (Index-&gt;<a class="code" href="classllvm_1_1SDNode.html#af0d328f3f61168f4ea7d6e4044af4f97">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a5183f3d72924bc7c77ba8d3f5de9f602">ISD::SIGN_EXTEND</a>) {</div><div class="line"><a name="l08523"></a><span class="lineno"> 8523</span>&#160;      Index = Index-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0);</div><div class="line"><a name="l08524"></a><span class="lineno"> 8524</span>&#160;      IsIndexSignExt = <span class="keyword">true</span>;</div><div class="line"><a name="l08525"></a><span class="lineno"> 8525</span>&#160;    } <span class="keywordflow">else</span> IsIndexSignExt = <span class="keyword">false</span>;</div><div class="line"><a name="l08526"></a><span class="lineno"> 8526</span>&#160;</div><div class="line"><a name="l08527"></a><span class="lineno"> 8527</span>&#160;    int64_t Off = cast&lt;ConstantSDNode&gt;(Offset)-&gt;getSExtValue();</div><div class="line"><a name="l08528"></a><span class="lineno"> 8528</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="structBaseIndexOffset.html">BaseIndexOffset</a>(Base, Index, Off, IsIndexSignExt);</div><div class="line"><a name="l08529"></a><span class="lineno"> 8529</span>&#160;  }</div><div class="line"><a name="l08530"></a><span class="lineno"> 8530</span>&#160;};</div><div class="line"><a name="l08531"></a><span class="lineno"> 8531</span>&#160;<span class="comment"></span></div><div class="line"><a name="l08532"></a><span class="lineno"> 8532</span>&#160;<span class="comment">/// Holds a pointer to an LSBaseSDNode as well as information on where it</span></div><div class="line"><a name="l08533"></a><span class="lineno"> 8533</span>&#160;<span class="comment">/// is located in a sequence of memory operations connected by a chain.</span></div><div class="line"><a name="l08534"></a><span class="lineno"><a class="line" href="structMemOpLink.html"> 8534</a></span>&#160;<span class="comment"></span><span class="keyword">struct </span><a class="code" href="structMemOpLink.html">MemOpLink</a> {</div><div class="line"><a name="l08535"></a><span class="lineno"><a class="line" href="structMemOpLink.html#ac44d7f65c107349f8ce8a4b2fe417f04"> 8535</a></span>&#160;  <a class="code" href="structMemOpLink.html#ac44d7f65c107349f8ce8a4b2fe417f04">MemOpLink</a> (<a class="code" href="classllvm_1_1LSBaseSDNode.html">LSBaseSDNode</a> *N, int64_t Offset, <span class="keywordtype">unsigned</span> Seq):</div><div class="line"><a name="l08536"></a><span class="lineno"> 8536</span>&#160;    MemNode(N), OffsetFromBase(Offset), SequenceNum(Seq) { }</div><div class="line"><a name="l08537"></a><span class="lineno"> 8537</span>&#160;  <span class="comment">// Ptr to the mem node.</span></div><div class="line"><a name="l08538"></a><span class="lineno"><a class="line" href="structMemOpLink.html#ad7d8017dafe8cd2c41a5be8946dac71e"> 8538</a></span>&#160;  <a class="code" href="classllvm_1_1LSBaseSDNode.html">LSBaseSDNode</a> *<a class="code" href="structMemOpLink.html#ad7d8017dafe8cd2c41a5be8946dac71e">MemNode</a>;</div><div class="line"><a name="l08539"></a><span class="lineno"> 8539</span>&#160;  <span class="comment">// Offset from the base ptr.</span></div><div class="line"><a name="l08540"></a><span class="lineno"><a class="line" href="structMemOpLink.html#ad1b74377a2e70e691be7a8386e7ff97c"> 8540</a></span>&#160;  int64_t <a class="code" href="structMemOpLink.html#ad1b74377a2e70e691be7a8386e7ff97c">OffsetFromBase</a>;</div><div class="line"><a name="l08541"></a><span class="lineno"> 8541</span>&#160;  <span class="comment">// What is the sequence number of this mem node.</span></div><div class="line"><a name="l08542"></a><span class="lineno"> 8542</span>&#160;  <span class="comment">// Lowest mem operand in the DAG starts at zero.</span></div><div class="line"><a name="l08543"></a><span class="lineno"><a class="line" href="structMemOpLink.html#accb21e142bdf2938dff24f59d23b393c"> 8543</a></span>&#160;  <span class="keywordtype">unsigned</span> <a class="code" href="structMemOpLink.html#accb21e142bdf2938dff24f59d23b393c">SequenceNum</a>;</div><div class="line"><a name="l08544"></a><span class="lineno"> 8544</span>&#160;};</div><div class="line"><a name="l08545"></a><span class="lineno"> 8545</span>&#160;<span class="comment"></span></div><div class="line"><a name="l08546"></a><span class="lineno"> 8546</span>&#160;<span class="comment">/// Sorts store nodes in a link according to their offset from a shared</span></div><div class="line"><a name="l08547"></a><span class="lineno"> 8547</span>&#160;<span class="comment"></span><span class="comment">// base ptr.</span></div><div class="line"><a name="l08548"></a><span class="lineno"><a class="line" href="structConsecutiveMemoryChainSorter.html"> 8548</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structConsecutiveMemoryChainSorter.html">ConsecutiveMemoryChainSorter</a> {</div><div class="line"><a name="l08549"></a><span class="lineno"><a class="line" href="structConsecutiveMemoryChainSorter.html#a3c8ced0aab28365841780659ff19d744"> 8549</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="structConsecutiveMemoryChainSorter.html#a3c8ced0aab28365841780659ff19d744">operator()</a>(<a class="code" href="structMemOpLink.html">MemOpLink</a> LHS, <a class="code" href="structMemOpLink.html">MemOpLink</a> RHS) {</div><div class="line"><a name="l08550"></a><span class="lineno"> 8550</span>&#160;    <span class="keywordflow">return</span> LHS.<a class="code" href="structMemOpLink.html#ad1b74377a2e70e691be7a8386e7ff97c">OffsetFromBase</a> &lt; RHS.<a class="code" href="structMemOpLink.html#ad1b74377a2e70e691be7a8386e7ff97c">OffsetFromBase</a>;</div><div class="line"><a name="l08551"></a><span class="lineno"> 8551</span>&#160;  }</div><div class="line"><a name="l08552"></a><span class="lineno"> 8552</span>&#160;};</div><div class="line"><a name="l08553"></a><span class="lineno"> 8553</span>&#160;</div><div class="line"><a name="l08554"></a><span class="lineno"> 8554</span>&#160;<span class="keywordtype">bool</span> DAGCombiner::MergeConsecutiveStores(<a class="code" href="classllvm_1_1StoreSDNode.html">StoreSDNode</a>* St) {</div><div class="line"><a name="l08555"></a><span class="lineno"> 8555</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> MemVT = St-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a7cead3a2a7771e61083bcc6959915a13">getMemoryVT</a>();</div><div class="line"><a name="l08556"></a><span class="lineno"> 8556</span>&#160;  int64_t ElementSizeBytes = MemVT.<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>()/8;</div><div class="line"><a name="l08557"></a><span class="lineno"> 8557</span>&#160;  <span class="keywordtype">bool</span> NoVectors = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a95d3f899fd68931ed5fa42e012468bdb">getMachineFunction</a>().<a class="code" href="classllvm_1_1MachineFunction.html#ad784a6594990530bffb2018aeeed56f3">getFunction</a>()-&gt;<a class="code" href="classllvm_1_1Function.html#a72873ed64b7be01507a2248b8e756ec8">getAttributes</a>().</div><div class="line"><a name="l08558"></a><span class="lineno"> 8558</span>&#160;    hasAttribute(AttributeSet::FunctionIndex, <a class="code" href="classllvm_1_1Attribute.html#aab7ee4b8fd1d3e7e4cea87868855e60ea9e330fa070dd4bb79cbc6c74b41958a4">Attribute::NoImplicitFloat</a>);</div><div class="line"><a name="l08559"></a><span class="lineno"> 8559</span>&#160;</div><div class="line"><a name="l08560"></a><span class="lineno"> 8560</span>&#160;  <span class="comment">// Don&#39;t merge vectors into wider inputs.</span></div><div class="line"><a name="l08561"></a><span class="lineno"> 8561</span>&#160;  <span class="keywordflow">if</span> (MemVT.<a class="code" href="structllvm_1_1EVT.html#a73f7c824cad61a47c21bf6d652ae2fd7">isVector</a>() || !MemVT.<a class="code" href="structllvm_1_1EVT.html#ac6f053514ba29bdf3b7f051f643dabe5">isSimple</a>())</div><div class="line"><a name="l08562"></a><span class="lineno"> 8562</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l08563"></a><span class="lineno"> 8563</span>&#160;</div><div class="line"><a name="l08564"></a><span class="lineno"> 8564</span>&#160;  <span class="comment">// Perform an early exit check. Do not bother looking at stored values that</span></div><div class="line"><a name="l08565"></a><span class="lineno"> 8565</span>&#160;  <span class="comment">// are not constants or loads.</span></div><div class="line"><a name="l08566"></a><span class="lineno"> 8566</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> StoredVal = St-&gt;<a class="code" href="classllvm_1_1StoreSDNode.html#a7f9820a84907a5aa530d4dc36f841c76">getValue</a>();</div><div class="line"><a name="l08567"></a><span class="lineno"> 8567</span>&#160;  <span class="keywordtype">bool</span> IsLoadSrc = isa&lt;LoadSDNode&gt;(StoredVal);</div><div class="line"><a name="l08568"></a><span class="lineno"> 8568</span>&#160;  <span class="keywordflow">if</span> (!isa&lt;ConstantSDNode&gt;(StoredVal) &amp;&amp; !isa&lt;ConstantFPSDNode&gt;(StoredVal) &amp;&amp;</div><div class="line"><a name="l08569"></a><span class="lineno"> 8569</span>&#160;      !IsLoadSrc)</div><div class="line"><a name="l08570"></a><span class="lineno"> 8570</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l08571"></a><span class="lineno"> 8571</span>&#160;</div><div class="line"><a name="l08572"></a><span class="lineno"> 8572</span>&#160;  <span class="comment">// Only look at ends of store sequences.</span></div><div class="line"><a name="l08573"></a><span class="lineno"> 8573</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Chain = <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(St, 1);</div><div class="line"><a name="l08574"></a><span class="lineno"> 8574</span>&#160;  <span class="keywordflow">if</span> (Chain-&gt;<a class="code" href="classllvm_1_1SDNode.html#a52753947fce3a01b1c18dd4713c587e8">hasOneUse</a>() &amp;&amp; Chain-&gt;<a class="code" href="classllvm_1_1SDNode.html#a8810bf428dcf84d48f39c8f5ba9a8c94">use_begin</a>()-&gt;<a class="code" href="classllvm_1_1SDNode.html#af0d328f3f61168f4ea7d6e4044af4f97">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a047178c3b2c6a5df40ae22a407b8aca9">ISD::STORE</a>)</div><div class="line"><a name="l08575"></a><span class="lineno"> 8575</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l08576"></a><span class="lineno"> 8576</span>&#160;</div><div class="line"><a name="l08577"></a><span class="lineno"> 8577</span>&#160;  <span class="comment">// This holds the base pointer, index, and the offset in bytes from the base</span></div><div class="line"><a name="l08578"></a><span class="lineno"> 8578</span>&#160;  <span class="comment">// pointer.</span></div><div class="line"><a name="l08579"></a><span class="lineno"> 8579</span>&#160;  <a class="code" href="structBaseIndexOffset.html">BaseIndexOffset</a> BasePtr = <a class="code" href="structBaseIndexOffset.html#ac5a5ed57c63f39652622f85207eb30f2">BaseIndexOffset::match</a>(St-&gt;<a class="code" href="classllvm_1_1StoreSDNode.html#aec453733fbb9f24036960fdc6b3b4b46">getBasePtr</a>());</div><div class="line"><a name="l08580"></a><span class="lineno"> 8580</span>&#160;</div><div class="line"><a name="l08581"></a><span class="lineno"> 8581</span>&#160;  <span class="comment">// We must have a base and an offset.</span></div><div class="line"><a name="l08582"></a><span class="lineno"> 8582</span>&#160;  <span class="keywordflow">if</span> (!BasePtr.<a class="code" href="structBaseIndexOffset.html#a4620710c0fe361d718e7a522ce3df91b">Base</a>.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>())</div><div class="line"><a name="l08583"></a><span class="lineno"> 8583</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l08584"></a><span class="lineno"> 8584</span>&#160;</div><div class="line"><a name="l08585"></a><span class="lineno"> 8585</span>&#160;  <span class="comment">// Do not handle stores to undef base pointers.</span></div><div class="line"><a name="l08586"></a><span class="lineno"> 8586</span>&#160;  <span class="keywordflow">if</span> (BasePtr.<a class="code" href="structBaseIndexOffset.html#a4620710c0fe361d718e7a522ce3df91b">Base</a>.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7c6d8f265e9e16e5debdb9a536b55d3d">ISD::UNDEF</a>)</div><div class="line"><a name="l08587"></a><span class="lineno"> 8587</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l08588"></a><span class="lineno"> 8588</span>&#160;</div><div class="line"><a name="l08589"></a><span class="lineno"> 8589</span>&#160;  <span class="comment">// Save the LoadSDNodes that we find in the chain.</span></div><div class="line"><a name="l08590"></a><span class="lineno"> 8590</span>&#160;  <span class="comment">// We need to make sure that these nodes do not interfere with</span></div><div class="line"><a name="l08591"></a><span class="lineno"> 8591</span>&#160;  <span class="comment">// any of the store nodes.</span></div><div class="line"><a name="l08592"></a><span class="lineno"> 8592</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;LSBaseSDNode*, 8&gt;</a> AliasLoadNodes;</div><div class="line"><a name="l08593"></a><span class="lineno"> 8593</span>&#160;</div><div class="line"><a name="l08594"></a><span class="lineno"> 8594</span>&#160;  <span class="comment">// Save the StoreSDNodes that we find in the chain.</span></div><div class="line"><a name="l08595"></a><span class="lineno"> 8595</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;MemOpLink, 8&gt;</a> StoreNodes;</div><div class="line"><a name="l08596"></a><span class="lineno"> 8596</span>&#160;</div><div class="line"><a name="l08597"></a><span class="lineno"> 8597</span>&#160;  <span class="comment">// Walk up the chain and look for nodes with offsets from the same</span></div><div class="line"><a name="l08598"></a><span class="lineno"> 8598</span>&#160;  <span class="comment">// base pointer. Stop when reaching an instruction with a different kind</span></div><div class="line"><a name="l08599"></a><span class="lineno"> 8599</span>&#160;  <span class="comment">// or instruction which has a different base pointer.</span></div><div class="line"><a name="l08600"></a><span class="lineno"> 8600</span>&#160;  <span class="keywordtype">unsigned</span> Seq = 0;</div><div class="line"><a name="l08601"></a><span class="lineno"> 8601</span>&#160;  <a class="code" href="classllvm_1_1StoreSDNode.html">StoreSDNode</a> *Index = St;</div><div class="line"><a name="l08602"></a><span class="lineno"> 8602</span>&#160;  <span class="keywordflow">while</span> (Index) {</div><div class="line"><a name="l08603"></a><span class="lineno"> 8603</span>&#160;    <span class="comment">// If the chain has more than one use, then we can&#39;t reorder the mem ops.</span></div><div class="line"><a name="l08604"></a><span class="lineno"> 8604</span>&#160;    <span class="keywordflow">if</span> (Index != St &amp;&amp; !<a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(Index, 1)-&gt;<a class="code" href="classllvm_1_1SDNode.html#a52753947fce3a01b1c18dd4713c587e8">hasOneUse</a>())</div><div class="line"><a name="l08605"></a><span class="lineno"> 8605</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l08606"></a><span class="lineno"> 8606</span>&#160;</div><div class="line"><a name="l08607"></a><span class="lineno"> 8607</span>&#160;    <span class="comment">// Find the base pointer and offset for this memory node.</span></div><div class="line"><a name="l08608"></a><span class="lineno"> 8608</span>&#160;    <a class="code" href="structBaseIndexOffset.html">BaseIndexOffset</a> Ptr = <a class="code" href="structBaseIndexOffset.html#ac5a5ed57c63f39652622f85207eb30f2">BaseIndexOffset::match</a>(Index-&gt;<a class="code" href="classllvm_1_1StoreSDNode.html#aec453733fbb9f24036960fdc6b3b4b46">getBasePtr</a>());</div><div class="line"><a name="l08609"></a><span class="lineno"> 8609</span>&#160;</div><div class="line"><a name="l08610"></a><span class="lineno"> 8610</span>&#160;    <span class="comment">// Check that the base pointer is the same as the original one.</span></div><div class="line"><a name="l08611"></a><span class="lineno"> 8611</span>&#160;    <span class="keywordflow">if</span> (!Ptr.<a class="code" href="structBaseIndexOffset.html#acd3de374c9ae917fdc018643028ea28b">equalBaseIndex</a>(BasePtr))</div><div class="line"><a name="l08612"></a><span class="lineno"> 8612</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l08613"></a><span class="lineno"> 8613</span>&#160;</div><div class="line"><a name="l08614"></a><span class="lineno"> 8614</span>&#160;    <span class="comment">// Check that the alignment is the same.</span></div><div class="line"><a name="l08615"></a><span class="lineno"> 8615</span>&#160;    <span class="keywordflow">if</span> (Index-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a4f68cd016138440f215ad80c1d6c1e04">getAlignment</a>() != St-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a4f68cd016138440f215ad80c1d6c1e04">getAlignment</a>())</div><div class="line"><a name="l08616"></a><span class="lineno"> 8616</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l08617"></a><span class="lineno"> 8617</span>&#160;</div><div class="line"><a name="l08618"></a><span class="lineno"> 8618</span>&#160;    <span class="comment">// The memory operands must not be volatile.</span></div><div class="line"><a name="l08619"></a><span class="lineno"> 8619</span>&#160;    <span class="keywordflow">if</span> (Index-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#acd3bb9ee2ec53fa4be1fdf155b0b5a17">isVolatile</a>() || Index-&gt;<a class="code" href="classllvm_1_1LSBaseSDNode.html#a97fbe853685bec84672ff408d2cdca34">isIndexed</a>())</div><div class="line"><a name="l08620"></a><span class="lineno"> 8620</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l08621"></a><span class="lineno"> 8621</span>&#160;</div><div class="line"><a name="l08622"></a><span class="lineno"> 8622</span>&#160;    <span class="comment">// No truncation.</span></div><div class="line"><a name="l08623"></a><span class="lineno"> 8623</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1StoreSDNode.html">StoreSDNode</a> *St = dyn_cast&lt;StoreSDNode&gt;(Index))</div><div class="line"><a name="l08624"></a><span class="lineno"> 8624</span>&#160;      <span class="keywordflow">if</span> (St-&gt;<a class="code" href="classllvm_1_1StoreSDNode.html#a272cb283a679298b7e991db7daf823ed">isTruncatingStore</a>())</div><div class="line"><a name="l08625"></a><span class="lineno"> 8625</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l08626"></a><span class="lineno"> 8626</span>&#160;</div><div class="line"><a name="l08627"></a><span class="lineno"> 8627</span>&#160;    <span class="comment">// The stored memory type must be the same.</span></div><div class="line"><a name="l08628"></a><span class="lineno"> 8628</span>&#160;    <span class="keywordflow">if</span> (Index-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a7cead3a2a7771e61083bcc6959915a13">getMemoryVT</a>() != MemVT)</div><div class="line"><a name="l08629"></a><span class="lineno"> 8629</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l08630"></a><span class="lineno"> 8630</span>&#160;</div><div class="line"><a name="l08631"></a><span class="lineno"> 8631</span>&#160;    <span class="comment">// We do not allow unaligned stores because we want to prevent overriding</span></div><div class="line"><a name="l08632"></a><span class="lineno"> 8632</span>&#160;    <span class="comment">// stores.</span></div><div class="line"><a name="l08633"></a><span class="lineno"> 8633</span>&#160;    <span class="keywordflow">if</span> (Index-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a4f68cd016138440f215ad80c1d6c1e04">getAlignment</a>()*8 != MemVT.<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>())</div><div class="line"><a name="l08634"></a><span class="lineno"> 8634</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l08635"></a><span class="lineno"> 8635</span>&#160;</div><div class="line"><a name="l08636"></a><span class="lineno"> 8636</span>&#160;    <span class="comment">// We found a potential memory operand to merge.</span></div><div class="line"><a name="l08637"></a><span class="lineno"> 8637</span>&#160;    StoreNodes.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(<a class="code" href="structMemOpLink.html">MemOpLink</a>(Index, Ptr.<a class="code" href="structBaseIndexOffset.html#a2c47325c74b1570d86010535fbdc710b">Offset</a>, Seq++));</div><div class="line"><a name="l08638"></a><span class="lineno"> 8638</span>&#160;</div><div class="line"><a name="l08639"></a><span class="lineno"> 8639</span>&#160;    <span class="comment">// Find the next memory operand in the chain. If the next operand in the</span></div><div class="line"><a name="l08640"></a><span class="lineno"> 8640</span>&#160;    <span class="comment">// chain is a store then move up and continue the scan with the next</span></div><div class="line"><a name="l08641"></a><span class="lineno"> 8641</span>&#160;    <span class="comment">// memory operand. If the next operand is a load save it and use alias</span></div><div class="line"><a name="l08642"></a><span class="lineno"> 8642</span>&#160;    <span class="comment">// information to check if it interferes with anything.</span></div><div class="line"><a name="l08643"></a><span class="lineno"> 8643</span>&#160;    <a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *NextInChain = Index-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#ae3cb6fbf8c8cb79e10ac61bd98c85211">getChain</a>().<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>();</div><div class="line"><a name="l08644"></a><span class="lineno"> 8644</span>&#160;    <span class="keywordflow">while</span> (1) {</div><div class="line"><a name="l08645"></a><span class="lineno"> 8645</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1StoreSDNode.html">StoreSDNode</a> *STn = dyn_cast&lt;StoreSDNode&gt;(NextInChain)) {</div><div class="line"><a name="l08646"></a><span class="lineno"> 8646</span>&#160;        <span class="comment">// We found a store node. Use it for the next iteration.</span></div><div class="line"><a name="l08647"></a><span class="lineno"> 8647</span>&#160;        Index = STn;</div><div class="line"><a name="l08648"></a><span class="lineno"> 8648</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l08649"></a><span class="lineno"> 8649</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1LoadSDNode.html">LoadSDNode</a> *Ldn = dyn_cast&lt;LoadSDNode&gt;(NextInChain)) {</div><div class="line"><a name="l08650"></a><span class="lineno"> 8650</span>&#160;        <span class="keywordflow">if</span> (Ldn-&gt;isVolatile()) {</div><div class="line"><a name="l08651"></a><span class="lineno"> 8651</span>&#160;          Index = NULL;</div><div class="line"><a name="l08652"></a><span class="lineno"> 8652</span>&#160;          <span class="keywordflow">break</span>;</div><div class="line"><a name="l08653"></a><span class="lineno"> 8653</span>&#160;        }</div><div class="line"><a name="l08654"></a><span class="lineno"> 8654</span>&#160;</div><div class="line"><a name="l08655"></a><span class="lineno"> 8655</span>&#160;        <span class="comment">// Save the load node for later. Continue the scan.</span></div><div class="line"><a name="l08656"></a><span class="lineno"> 8656</span>&#160;        AliasLoadNodes.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(Ldn);</div><div class="line"><a name="l08657"></a><span class="lineno"> 8657</span>&#160;        NextInChain = Ldn-&gt;getChain().getNode();</div><div class="line"><a name="l08658"></a><span class="lineno"> 8658</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l08659"></a><span class="lineno"> 8659</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l08660"></a><span class="lineno"> 8660</span>&#160;        Index = NULL;</div><div class="line"><a name="l08661"></a><span class="lineno"> 8661</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l08662"></a><span class="lineno"> 8662</span>&#160;      }</div><div class="line"><a name="l08663"></a><span class="lineno"> 8663</span>&#160;    }</div><div class="line"><a name="l08664"></a><span class="lineno"> 8664</span>&#160;  }</div><div class="line"><a name="l08665"></a><span class="lineno"> 8665</span>&#160;</div><div class="line"><a name="l08666"></a><span class="lineno"> 8666</span>&#160;  <span class="comment">// Check if there is anything to merge.</span></div><div class="line"><a name="l08667"></a><span class="lineno"> 8667</span>&#160;  <span class="keywordflow">if</span> (StoreNodes.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#a22a311dfe4c28a897de8a9365a4f0a84">size</a>() &lt; 2)</div><div class="line"><a name="l08668"></a><span class="lineno"> 8668</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l08669"></a><span class="lineno"> 8669</span>&#160;</div><div class="line"><a name="l08670"></a><span class="lineno"> 8670</span>&#160;  <span class="comment">// Sort the memory operands according to their distance from the base pointer.</span></div><div class="line"><a name="l08671"></a><span class="lineno"> 8671</span>&#160;  std::sort(StoreNodes.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#a8a045d250952c0867382a9840ee18fdf">begin</a>(), StoreNodes.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#a075e34e98605d0e7c289763a104869ac">end</a>(),</div><div class="line"><a name="l08672"></a><span class="lineno"> 8672</span>&#160;            <a class="code" href="structConsecutiveMemoryChainSorter.html">ConsecutiveMemoryChainSorter</a>());</div><div class="line"><a name="l08673"></a><span class="lineno"> 8673</span>&#160;</div><div class="line"><a name="l08674"></a><span class="lineno"> 8674</span>&#160;  <span class="comment">// Scan the memory operations on the chain and find the first non-consecutive</span></div><div class="line"><a name="l08675"></a><span class="lineno"> 8675</span>&#160;  <span class="comment">// store memory address.</span></div><div class="line"><a name="l08676"></a><span class="lineno"> 8676</span>&#160;  <span class="keywordtype">unsigned</span> LastConsecutiveStore = 0;</div><div class="line"><a name="l08677"></a><span class="lineno"> 8677</span>&#160;  int64_t StartAddress = StoreNodes[0].OffsetFromBase;</div><div class="line"><a name="l08678"></a><span class="lineno"> 8678</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0, e = StoreNodes.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#a22a311dfe4c28a897de8a9365a4f0a84">size</a>(); <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; e; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l08679"></a><span class="lineno"> 8679</span>&#160;</div><div class="line"><a name="l08680"></a><span class="lineno"> 8680</span>&#160;    <span class="comment">// Check that the addresses are consecutive starting from the second</span></div><div class="line"><a name="l08681"></a><span class="lineno"> 8681</span>&#160;    <span class="comment">// element in the list of stores.</span></div><div class="line"><a name="l08682"></a><span class="lineno"> 8682</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> &gt; 0) {</div><div class="line"><a name="l08683"></a><span class="lineno"> 8683</span>&#160;      int64_t CurrAddress = StoreNodes[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>].OffsetFromBase;</div><div class="line"><a name="l08684"></a><span class="lineno"> 8684</span>&#160;      <span class="keywordflow">if</span> (CurrAddress - StartAddress != (ElementSizeBytes * <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>))</div><div class="line"><a name="l08685"></a><span class="lineno"> 8685</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l08686"></a><span class="lineno"> 8686</span>&#160;    }</div><div class="line"><a name="l08687"></a><span class="lineno"> 8687</span>&#160;</div><div class="line"><a name="l08688"></a><span class="lineno"> 8688</span>&#160;    <span class="keywordtype">bool</span> Alias = <span class="keyword">false</span>;</div><div class="line"><a name="l08689"></a><span class="lineno"> 8689</span>&#160;    <span class="comment">// Check if this store interferes with any of the loads that we found.</span></div><div class="line"><a name="l08690"></a><span class="lineno"> 8690</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> ld = 0, lde = AliasLoadNodes.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#a22a311dfe4c28a897de8a9365a4f0a84">size</a>(); ld &lt; lde; ++ld)</div><div class="line"><a name="l08691"></a><span class="lineno"> 8691</span>&#160;      <span class="keywordflow">if</span> (isAlias(AliasLoadNodes[ld], StoreNodes[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>].MemNode)) {</div><div class="line"><a name="l08692"></a><span class="lineno"> 8692</span>&#160;        Alias = <span class="keyword">true</span>;</div><div class="line"><a name="l08693"></a><span class="lineno"> 8693</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l08694"></a><span class="lineno"> 8694</span>&#160;      }</div><div class="line"><a name="l08695"></a><span class="lineno"> 8695</span>&#160;    <span class="comment">// We found a load that alias with this store. Stop the sequence.</span></div><div class="line"><a name="l08696"></a><span class="lineno"> 8696</span>&#160;    <span class="keywordflow">if</span> (Alias)</div><div class="line"><a name="l08697"></a><span class="lineno"> 8697</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l08698"></a><span class="lineno"> 8698</span>&#160;</div><div class="line"><a name="l08699"></a><span class="lineno"> 8699</span>&#160;    <span class="comment">// Mark this node as useful.</span></div><div class="line"><a name="l08700"></a><span class="lineno"> 8700</span>&#160;    LastConsecutiveStore = <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div><div class="line"><a name="l08701"></a><span class="lineno"> 8701</span>&#160;  }</div><div class="line"><a name="l08702"></a><span class="lineno"> 8702</span>&#160;</div><div class="line"><a name="l08703"></a><span class="lineno"> 8703</span>&#160;  <span class="comment">// The node with the lowest store address.</span></div><div class="line"><a name="l08704"></a><span class="lineno"> 8704</span>&#160;  <a class="code" href="classllvm_1_1LSBaseSDNode.html">LSBaseSDNode</a> *FirstInChain = StoreNodes[0].MemNode;</div><div class="line"><a name="l08705"></a><span class="lineno"> 8705</span>&#160;</div><div class="line"><a name="l08706"></a><span class="lineno"> 8706</span>&#160;  <span class="comment">// Store the constants into memory as one consecutive store.</span></div><div class="line"><a name="l08707"></a><span class="lineno"> 8707</span>&#160;  <span class="keywordflow">if</span> (!IsLoadSrc) {</div><div class="line"><a name="l08708"></a><span class="lineno"> 8708</span>&#160;    <span class="keywordtype">unsigned</span> LastLegalType = 0;</div><div class="line"><a name="l08709"></a><span class="lineno"> 8709</span>&#160;    <span class="keywordtype">unsigned</span> LastLegalVectorType = 0;</div><div class="line"><a name="l08710"></a><span class="lineno"> 8710</span>&#160;    <span class="keywordtype">bool</span> NonZero = <span class="keyword">false</span>;</div><div class="line"><a name="l08711"></a><span class="lineno"> 8711</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>=0; <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;LastConsecutiveStore+1; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l08712"></a><span class="lineno"> 8712</span>&#160;      <a class="code" href="classllvm_1_1StoreSDNode.html">StoreSDNode</a> *St  = cast&lt;StoreSDNode&gt;(StoreNodes[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>].MemNode);</div><div class="line"><a name="l08713"></a><span class="lineno"> 8713</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> StoredVal = St-&gt;<a class="code" href="classllvm_1_1StoreSDNode.html#a7f9820a84907a5aa530d4dc36f841c76">getValue</a>();</div><div class="line"><a name="l08714"></a><span class="lineno"> 8714</span>&#160;</div><div class="line"><a name="l08715"></a><span class="lineno"> 8715</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a> *<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = dyn_cast&lt;ConstantSDNode&gt;(StoredVal)) {</div><div class="line"><a name="l08716"></a><span class="lineno"> 8716</span>&#160;        NonZero |= !<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>-&gt;isNullValue();</div><div class="line"><a name="l08717"></a><span class="lineno"> 8717</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1ConstantFPSDNode.html">ConstantFPSDNode</a> *<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = dyn_cast&lt;ConstantFPSDNode&gt;(StoredVal)) {</div><div class="line"><a name="l08718"></a><span class="lineno"> 8718</span>&#160;        NonZero |= !<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>-&gt;getConstantFPValue()-&gt;isNullValue();</div><div class="line"><a name="l08719"></a><span class="lineno"> 8719</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l08720"></a><span class="lineno"> 8720</span>&#160;        <span class="comment">// Non constant.</span></div><div class="line"><a name="l08721"></a><span class="lineno"> 8721</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l08722"></a><span class="lineno"> 8722</span>&#160;      }</div><div class="line"><a name="l08723"></a><span class="lineno"> 8723</span>&#160;</div><div class="line"><a name="l08724"></a><span class="lineno"> 8724</span>&#160;      <span class="comment">// Find a legal type for the constant store.</span></div><div class="line"><a name="l08725"></a><span class="lineno"> 8725</span>&#160;      <span class="keywordtype">unsigned</span> StoreBW = (<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>+1) * ElementSizeBytes * 8;</div><div class="line"><a name="l08726"></a><span class="lineno"> 8726</span>&#160;      <a class="code" href="structllvm_1_1EVT.html">EVT</a> StoreTy = <a class="code" href="structllvm_1_1EVT.html#a752372e170e4e7c595bf8810bb52adf2">EVT::getIntegerVT</a>(*DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a39c6dff47b8dbd25cfaf6336c7056077">getContext</a>(), StoreBW);</div><div class="line"><a name="l08727"></a><span class="lineno"> 8727</span>&#160;      <span class="keywordflow">if</span> (TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a861aaccc0f468493e76c011811548804">isTypeLegal</a>(StoreTy))</div><div class="line"><a name="l08728"></a><span class="lineno"> 8728</span>&#160;        LastLegalType = <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>+1;</div><div class="line"><a name="l08729"></a><span class="lineno"> 8729</span>&#160;      <span class="comment">// Or check whether a truncstore is legal.</span></div><div class="line"><a name="l08730"></a><span class="lineno"> 8730</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a7b93b105a426bc0eda1eadd856aa195e">getTypeAction</a>(*DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a39c6dff47b8dbd25cfaf6336c7056077">getContext</a>(), StoreTy) ==</div><div class="line"><a name="l08731"></a><span class="lineno"> 8731</span>&#160;               <a class="code" href="classllvm_1_1TargetLoweringBase.html#a88a8b01d4dbc2ebd81244d1eb459b193a26f35604723482a1aee6514940c2987d">TargetLowering::TypePromoteInteger</a>) {</div><div class="line"><a name="l08732"></a><span class="lineno"> 8732</span>&#160;        <a class="code" href="structllvm_1_1EVT.html">EVT</a> LegalizedStoredValueTy =</div><div class="line"><a name="l08733"></a><span class="lineno"> 8733</span>&#160;          TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a76daffc43a9b516f4fe4999c7b680ca0">getTypeToTransformTo</a>(*DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a39c6dff47b8dbd25cfaf6336c7056077">getContext</a>(), StoredVal.getValueType());</div><div class="line"><a name="l08734"></a><span class="lineno"> 8734</span>&#160;        <span class="keywordflow">if</span> (TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#aaf6cf7bea7d0293cd174427f2ba6f50f">isTruncStoreLegal</a>(LegalizedStoredValueTy, StoreTy))</div><div class="line"><a name="l08735"></a><span class="lineno"> 8735</span>&#160;          LastLegalType = <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>+1;</div><div class="line"><a name="l08736"></a><span class="lineno"> 8736</span>&#160;      }</div><div class="line"><a name="l08737"></a><span class="lineno"> 8737</span>&#160;</div><div class="line"><a name="l08738"></a><span class="lineno"> 8738</span>&#160;      <span class="comment">// Find a legal type for the vector store.</span></div><div class="line"><a name="l08739"></a><span class="lineno"> 8739</span>&#160;      <a class="code" href="structllvm_1_1EVT.html">EVT</a> Ty = <a class="code" href="structllvm_1_1EVT.html#a18c2edf1939f6e87f1e586b815f398cd">EVT::getVectorVT</a>(*DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a39c6dff47b8dbd25cfaf6336c7056077">getContext</a>(), MemVT, <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>+1);</div><div class="line"><a name="l08740"></a><span class="lineno"> 8740</span>&#160;      <span class="keywordflow">if</span> (TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a861aaccc0f468493e76c011811548804">isTypeLegal</a>(Ty))</div><div class="line"><a name="l08741"></a><span class="lineno"> 8741</span>&#160;        LastLegalVectorType = <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> + 1;</div><div class="line"><a name="l08742"></a><span class="lineno"> 8742</span>&#160;    }</div><div class="line"><a name="l08743"></a><span class="lineno"> 8743</span>&#160;</div><div class="line"><a name="l08744"></a><span class="lineno"> 8744</span>&#160;    <span class="comment">// We only use vectors if the constant is known to be zero and the</span></div><div class="line"><a name="l08745"></a><span class="lineno"> 8745</span>&#160;    <span class="comment">// function is not marked with the noimplicitfloat attribute.</span></div><div class="line"><a name="l08746"></a><span class="lineno"> 8746</span>&#160;    <span class="keywordflow">if</span> (NonZero || NoVectors)</div><div class="line"><a name="l08747"></a><span class="lineno"> 8747</span>&#160;      LastLegalVectorType = 0;</div><div class="line"><a name="l08748"></a><span class="lineno"> 8748</span>&#160;</div><div class="line"><a name="l08749"></a><span class="lineno"> 8749</span>&#160;    <span class="comment">// Check if we found a legal integer type to store.</span></div><div class="line"><a name="l08750"></a><span class="lineno"> 8750</span>&#160;    <span class="keywordflow">if</span> (LastLegalType == 0 &amp;&amp; LastLegalVectorType == 0)</div><div class="line"><a name="l08751"></a><span class="lineno"> 8751</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l08752"></a><span class="lineno"> 8752</span>&#160;</div><div class="line"><a name="l08753"></a><span class="lineno"> 8753</span>&#160;    <span class="keywordtype">bool</span> UseVector = (LastLegalVectorType &gt; LastLegalType) &amp;&amp; !NoVectors;</div><div class="line"><a name="l08754"></a><span class="lineno"> 8754</span>&#160;    <span class="keywordtype">unsigned</span> NumElem = UseVector ? LastLegalVectorType : LastLegalType;</div><div class="line"><a name="l08755"></a><span class="lineno"> 8755</span>&#160;</div><div class="line"><a name="l08756"></a><span class="lineno"> 8756</span>&#160;    <span class="comment">// Make sure we have something to merge.</span></div><div class="line"><a name="l08757"></a><span class="lineno"> 8757</span>&#160;    <span class="keywordflow">if</span> (NumElem &lt; 2)</div><div class="line"><a name="l08758"></a><span class="lineno"> 8758</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l08759"></a><span class="lineno"> 8759</span>&#160;</div><div class="line"><a name="l08760"></a><span class="lineno"> 8760</span>&#160;    <span class="keywordtype">unsigned</span> EarliestNodeUsed = 0;</div><div class="line"><a name="l08761"></a><span class="lineno"> 8761</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>=0; <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; NumElem; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l08762"></a><span class="lineno"> 8762</span>&#160;      <span class="comment">// Find a chain for the new wide-store operand. Notice that some</span></div><div class="line"><a name="l08763"></a><span class="lineno"> 8763</span>&#160;      <span class="comment">// of the store nodes that we found may not be selected for inclusion</span></div><div class="line"><a name="l08764"></a><span class="lineno"> 8764</span>&#160;      <span class="comment">// in the wide store. The chain we use needs to be the chain of the</span></div><div class="line"><a name="l08765"></a><span class="lineno"> 8765</span>&#160;      <span class="comment">// earliest store node which is *used* and replaced by the wide store.</span></div><div class="line"><a name="l08766"></a><span class="lineno"> 8766</span>&#160;      <span class="keywordflow">if</span> (StoreNodes[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>].SequenceNum &gt; StoreNodes[EarliestNodeUsed].SequenceNum)</div><div class="line"><a name="l08767"></a><span class="lineno"> 8767</span>&#160;        EarliestNodeUsed = <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div><div class="line"><a name="l08768"></a><span class="lineno"> 8768</span>&#160;    }</div><div class="line"><a name="l08769"></a><span class="lineno"> 8769</span>&#160;</div><div class="line"><a name="l08770"></a><span class="lineno"> 8770</span>&#160;    <span class="comment">// The earliest Node in the DAG.</span></div><div class="line"><a name="l08771"></a><span class="lineno"> 8771</span>&#160;    <a class="code" href="classllvm_1_1LSBaseSDNode.html">LSBaseSDNode</a> *EarliestOp = StoreNodes[EarliestNodeUsed].MemNode;</div><div class="line"><a name="l08772"></a><span class="lineno"> 8772</span>&#160;    <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a> DL(StoreNodes[0].MemNode);</div><div class="line"><a name="l08773"></a><span class="lineno"> 8773</span>&#160;</div><div class="line"><a name="l08774"></a><span class="lineno"> 8774</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> StoredVal;</div><div class="line"><a name="l08775"></a><span class="lineno"> 8775</span>&#160;    <span class="keywordflow">if</span> (UseVector) {</div><div class="line"><a name="l08776"></a><span class="lineno"> 8776</span>&#160;      <span class="comment">// Find a legal type for the vector store.</span></div><div class="line"><a name="l08777"></a><span class="lineno"> 8777</span>&#160;      <a class="code" href="structllvm_1_1EVT.html">EVT</a> Ty = <a class="code" href="structllvm_1_1EVT.html#a18c2edf1939f6e87f1e586b815f398cd">EVT::getVectorVT</a>(*DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a39c6dff47b8dbd25cfaf6336c7056077">getContext</a>(), MemVT, NumElem);</div><div class="line"><a name="l08778"></a><span class="lineno"> 8778</span>&#160;      assert(TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a861aaccc0f468493e76c011811548804">isTypeLegal</a>(Ty) &amp;&amp; <span class="stringliteral">&quot;Illegal vector store&quot;</span>);</div><div class="line"><a name="l08779"></a><span class="lineno"> 8779</span>&#160;      StoredVal = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(0, Ty);</div><div class="line"><a name="l08780"></a><span class="lineno"> 8780</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l08781"></a><span class="lineno"> 8781</span>&#160;      <span class="keywordtype">unsigned</span> StoreBW = NumElem * ElementSizeBytes * 8;</div><div class="line"><a name="l08782"></a><span class="lineno"> 8782</span>&#160;      <a class="code" href="classllvm_1_1APInt.html">APInt</a> StoreInt(StoreBW, 0);</div><div class="line"><a name="l08783"></a><span class="lineno"> 8783</span>&#160;</div><div class="line"><a name="l08784"></a><span class="lineno"> 8784</span>&#160;      <span class="comment">// Construct a single integer constant which is made of the smaller</span></div><div class="line"><a name="l08785"></a><span class="lineno"> 8785</span>&#160;      <span class="comment">// constant inputs.</span></div><div class="line"><a name="l08786"></a><span class="lineno"> 8786</span>&#160;      <span class="keywordtype">bool</span> IsLE = TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a7fe87806292e4bb35d59a51930f3ae0e">isLittleEndian</a>();</div><div class="line"><a name="l08787"></a><span class="lineno"> 8787</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; NumElem ; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l08788"></a><span class="lineno"> 8788</span>&#160;        <span class="keywordtype">unsigned</span> Idx = IsLE ?(NumElem - 1 - <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) : <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div><div class="line"><a name="l08789"></a><span class="lineno"> 8789</span>&#160;        <a class="code" href="classllvm_1_1StoreSDNode.html">StoreSDNode</a> *St  = cast&lt;StoreSDNode&gt;(StoreNodes[Idx].MemNode);</div><div class="line"><a name="l08790"></a><span class="lineno"> 8790</span>&#160;        <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Val = St-&gt;getValue();</div><div class="line"><a name="l08791"></a><span class="lineno"> 8791</span>&#160;        StoreInt&lt;&lt;=ElementSizeBytes*8;</div><div class="line"><a name="l08792"></a><span class="lineno"> 8792</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a> *<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = dyn_cast&lt;ConstantSDNode&gt;(Val)) {</div><div class="line"><a name="l08793"></a><span class="lineno"> 8793</span>&#160;          StoreInt|=<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>-&gt;getAPIntValue().<a class="code" href="classllvm_1_1APInt.html#a6142fc5662411269a7ca0217f49f338c">zext</a>(StoreBW);</div><div class="line"><a name="l08794"></a><span class="lineno"> 8794</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1ConstantFPSDNode.html">ConstantFPSDNode</a> *<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = dyn_cast&lt;ConstantFPSDNode&gt;(Val)) {</div><div class="line"><a name="l08795"></a><span class="lineno"> 8795</span>&#160;          StoreInt|= <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>-&gt;getValueAPF().bitcastToAPInt().<a class="code" href="classllvm_1_1APInt.html#a6142fc5662411269a7ca0217f49f338c">zext</a>(StoreBW);</div><div class="line"><a name="l08796"></a><span class="lineno"> 8796</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l08797"></a><span class="lineno"> 8797</span>&#160;          assert(<span class="keyword">false</span> &amp;&amp; <span class="stringliteral">&quot;Invalid constant element type&quot;</span>);</div><div class="line"><a name="l08798"></a><span class="lineno"> 8798</span>&#160;        }</div><div class="line"><a name="l08799"></a><span class="lineno"> 8799</span>&#160;      }</div><div class="line"><a name="l08800"></a><span class="lineno"> 8800</span>&#160;</div><div class="line"><a name="l08801"></a><span class="lineno"> 8801</span>&#160;      <span class="comment">// Create the new Load and Store operations.</span></div><div class="line"><a name="l08802"></a><span class="lineno"> 8802</span>&#160;      <a class="code" href="structllvm_1_1EVT.html">EVT</a> StoreTy = <a class="code" href="structllvm_1_1EVT.html#a752372e170e4e7c595bf8810bb52adf2">EVT::getIntegerVT</a>(*DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a39c6dff47b8dbd25cfaf6336c7056077">getContext</a>(), StoreBW);</div><div class="line"><a name="l08803"></a><span class="lineno"> 8803</span>&#160;      StoredVal = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(StoreInt, StoreTy);</div><div class="line"><a name="l08804"></a><span class="lineno"> 8804</span>&#160;    }</div><div class="line"><a name="l08805"></a><span class="lineno"> 8805</span>&#160;</div><div class="line"><a name="l08806"></a><span class="lineno"> 8806</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> NewStore = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a2bdce1dfec3bab37c9a38e516eba42e7">getStore</a>(EarliestOp-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#ae3cb6fbf8c8cb79e10ac61bd98c85211">getChain</a>(), DL, StoredVal,</div><div class="line"><a name="l08807"></a><span class="lineno"> 8807</span>&#160;                                    FirstInChain-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a9330f807294a868461af12a3ed56a269">getBasePtr</a>(),</div><div class="line"><a name="l08808"></a><span class="lineno"> 8808</span>&#160;                                    FirstInChain-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a2fa8491ab36125d7f5dd38d3a4868934">getPointerInfo</a>(),</div><div class="line"><a name="l08809"></a><span class="lineno"> 8809</span>&#160;                                    <span class="keyword">false</span>, <span class="keyword">false</span>,</div><div class="line"><a name="l08810"></a><span class="lineno"> 8810</span>&#160;                                    FirstInChain-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a4f68cd016138440f215ad80c1d6c1e04">getAlignment</a>());</div><div class="line"><a name="l08811"></a><span class="lineno"> 8811</span>&#160;</div><div class="line"><a name="l08812"></a><span class="lineno"> 8812</span>&#160;    <span class="comment">// Replace the first store with the new store</span></div><div class="line"><a name="l08813"></a><span class="lineno"> 8813</span>&#160;    CombineTo(EarliestOp, NewStore);</div><div class="line"><a name="l08814"></a><span class="lineno"> 8814</span>&#160;    <span class="comment">// Erase all other stores.</span></div><div class="line"><a name="l08815"></a><span class="lineno"> 8815</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; NumElem ; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l08816"></a><span class="lineno"> 8816</span>&#160;      <span class="keywordflow">if</span> (StoreNodes[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>].MemNode == EarliestOp)</div><div class="line"><a name="l08817"></a><span class="lineno"> 8817</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l08818"></a><span class="lineno"> 8818</span>&#160;      <a class="code" href="classllvm_1_1StoreSDNode.html">StoreSDNode</a> *St = cast&lt;StoreSDNode&gt;(StoreNodes[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>].MemNode);</div><div class="line"><a name="l08819"></a><span class="lineno"> 8819</span>&#160;      <span class="comment">// ReplaceAllUsesWith will replace all uses that existed when it was</span></div><div class="line"><a name="l08820"></a><span class="lineno"> 8820</span>&#160;      <span class="comment">// called, but graph optimizations may cause new ones to appear. For</span></div><div class="line"><a name="l08821"></a><span class="lineno"> 8821</span>&#160;      <span class="comment">// example, the case in pr14333 looks like</span></div><div class="line"><a name="l08822"></a><span class="lineno"> 8822</span>&#160;      <span class="comment">//</span></div><div class="line"><a name="l08823"></a><span class="lineno"> 8823</span>&#160;      <span class="comment">//  St&#39;s chain -&gt; St -&gt; another store -&gt; X</span></div><div class="line"><a name="l08824"></a><span class="lineno"> 8824</span>&#160;      <span class="comment">//</span></div><div class="line"><a name="l08825"></a><span class="lineno"> 8825</span>&#160;      <span class="comment">// And the only difference from St to the other store is the chain.</span></div><div class="line"><a name="l08826"></a><span class="lineno"> 8826</span>&#160;      <span class="comment">// When we change it&#39;s chain to be St&#39;s chain they become identical,</span></div><div class="line"><a name="l08827"></a><span class="lineno"> 8827</span>&#160;      <span class="comment">// get CSEed and the net result is that X is now a use of St.</span></div><div class="line"><a name="l08828"></a><span class="lineno"> 8828</span>&#160;      <span class="comment">// Since we know that St is redundant, just iterate.</span></div><div class="line"><a name="l08829"></a><span class="lineno"> 8829</span>&#160;      <span class="keywordflow">while</span> (!St-&gt;<a class="code" href="classllvm_1_1SDNode.html#afc071edeb7e2007d000374eba843f76a">use_empty</a>())</div><div class="line"><a name="l08830"></a><span class="lineno"> 8830</span>&#160;        DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a307e5150c6c85f43348d2b09a69d7591">ReplaceAllUsesWith</a>(<a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(St, 0), St-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#ae3cb6fbf8c8cb79e10ac61bd98c85211">getChain</a>());</div><div class="line"><a name="l08831"></a><span class="lineno"> 8831</span>&#160;      removeFromWorkList(St);</div><div class="line"><a name="l08832"></a><span class="lineno"> 8832</span>&#160;      DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a5f57dcbedc16dced31c61f7bbbb06ded">DeleteNode</a>(St);</div><div class="line"><a name="l08833"></a><span class="lineno"> 8833</span>&#160;    }</div><div class="line"><a name="l08834"></a><span class="lineno"> 8834</span>&#160;</div><div class="line"><a name="l08835"></a><span class="lineno"> 8835</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l08836"></a><span class="lineno"> 8836</span>&#160;  }</div><div class="line"><a name="l08837"></a><span class="lineno"> 8837</span>&#160;</div><div class="line"><a name="l08838"></a><span class="lineno"> 8838</span>&#160;  <span class="comment">// Below we handle the case of multiple consecutive stores that</span></div><div class="line"><a name="l08839"></a><span class="lineno"> 8839</span>&#160;  <span class="comment">// come from multiple consecutive loads. We merge them into a single</span></div><div class="line"><a name="l08840"></a><span class="lineno"> 8840</span>&#160;  <span class="comment">// wide load and a single wide store.</span></div><div class="line"><a name="l08841"></a><span class="lineno"> 8841</span>&#160;</div><div class="line"><a name="l08842"></a><span class="lineno"> 8842</span>&#160;  <span class="comment">// Look for load nodes which are used by the stored values.</span></div><div class="line"><a name="l08843"></a><span class="lineno"> 8843</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;MemOpLink, 8&gt;</a> LoadNodes;</div><div class="line"><a name="l08844"></a><span class="lineno"> 8844</span>&#160;</div><div class="line"><a name="l08845"></a><span class="lineno"> 8845</span>&#160;  <span class="comment">// Find acceptable loads. Loads need to have the same chain (token factor),</span></div><div class="line"><a name="l08846"></a><span class="lineno"> 8846</span>&#160;  <span class="comment">// must not be zext, volatile, indexed, and they must be consecutive.</span></div><div class="line"><a name="l08847"></a><span class="lineno"> 8847</span>&#160;  <a class="code" href="structBaseIndexOffset.html">BaseIndexOffset</a> LdBasePtr;</div><div class="line"><a name="l08848"></a><span class="lineno"> 8848</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>=0; <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;LastConsecutiveStore+1; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l08849"></a><span class="lineno"> 8849</span>&#160;    <a class="code" href="classllvm_1_1StoreSDNode.html">StoreSDNode</a> *St  = cast&lt;StoreSDNode&gt;(StoreNodes[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>].MemNode);</div><div class="line"><a name="l08850"></a><span class="lineno"> 8850</span>&#160;    <a class="code" href="classllvm_1_1LoadSDNode.html">LoadSDNode</a> *Ld = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1LoadSDNode.html">LoadSDNode</a>&gt;(St-&gt;<a class="code" href="classllvm_1_1StoreSDNode.html#a7f9820a84907a5aa530d4dc36f841c76">getValue</a>());</div><div class="line"><a name="l08851"></a><span class="lineno"> 8851</span>&#160;    <span class="keywordflow">if</span> (!Ld) <span class="keywordflow">break</span>;</div><div class="line"><a name="l08852"></a><span class="lineno"> 8852</span>&#160;</div><div class="line"><a name="l08853"></a><span class="lineno"> 8853</span>&#160;    <span class="comment">// Loads must only have one use.</span></div><div class="line"><a name="l08854"></a><span class="lineno"> 8854</span>&#160;    <span class="keywordflow">if</span> (!Ld-&gt;hasNUsesOfValue(1, 0))</div><div class="line"><a name="l08855"></a><span class="lineno"> 8855</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l08856"></a><span class="lineno"> 8856</span>&#160;</div><div class="line"><a name="l08857"></a><span class="lineno"> 8857</span>&#160;    <span class="comment">// Check that the alignment is the same as the stores.</span></div><div class="line"><a name="l08858"></a><span class="lineno"> 8858</span>&#160;    <span class="keywordflow">if</span> (Ld-&gt;getAlignment() != St-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a4f68cd016138440f215ad80c1d6c1e04">getAlignment</a>())</div><div class="line"><a name="l08859"></a><span class="lineno"> 8859</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l08860"></a><span class="lineno"> 8860</span>&#160;</div><div class="line"><a name="l08861"></a><span class="lineno"> 8861</span>&#160;    <span class="comment">// The memory operands must not be volatile.</span></div><div class="line"><a name="l08862"></a><span class="lineno"> 8862</span>&#160;    <span class="keywordflow">if</span> (Ld-&gt;isVolatile() || Ld-&gt;isIndexed())</div><div class="line"><a name="l08863"></a><span class="lineno"> 8863</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l08864"></a><span class="lineno"> 8864</span>&#160;</div><div class="line"><a name="l08865"></a><span class="lineno"> 8865</span>&#160;    <span class="comment">// We do not accept ext loads.</span></div><div class="line"><a name="l08866"></a><span class="lineno"> 8866</span>&#160;    <span class="keywordflow">if</span> (Ld-&gt;getExtensionType() != <a class="code" href="namespacellvm_1_1ISD.html#ad4d48171b87ca51ff54c10a436bac4d7a6aacde2c67988b43a261a7f7ceac4be3">ISD::NON_EXTLOAD</a>)</div><div class="line"><a name="l08867"></a><span class="lineno"> 8867</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l08868"></a><span class="lineno"> 8868</span>&#160;</div><div class="line"><a name="l08869"></a><span class="lineno"> 8869</span>&#160;    <span class="comment">// The stored memory type must be the same.</span></div><div class="line"><a name="l08870"></a><span class="lineno"> 8870</span>&#160;    <span class="keywordflow">if</span> (Ld-&gt;getMemoryVT() != MemVT)</div><div class="line"><a name="l08871"></a><span class="lineno"> 8871</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l08872"></a><span class="lineno"> 8872</span>&#160;</div><div class="line"><a name="l08873"></a><span class="lineno"> 8873</span>&#160;    <a class="code" href="structBaseIndexOffset.html">BaseIndexOffset</a> LdPtr = <a class="code" href="structBaseIndexOffset.html#ac5a5ed57c63f39652622f85207eb30f2">BaseIndexOffset::match</a>(Ld-&gt;getBasePtr());</div><div class="line"><a name="l08874"></a><span class="lineno"> 8874</span>&#160;    <span class="comment">// If this is not the first ptr that we check.</span></div><div class="line"><a name="l08875"></a><span class="lineno"> 8875</span>&#160;    <span class="keywordflow">if</span> (LdBasePtr.<a class="code" href="structBaseIndexOffset.html#a4620710c0fe361d718e7a522ce3df91b">Base</a>.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()) {</div><div class="line"><a name="l08876"></a><span class="lineno"> 8876</span>&#160;      <span class="comment">// The base ptr must be the same.</span></div><div class="line"><a name="l08877"></a><span class="lineno"> 8877</span>&#160;      <span class="keywordflow">if</span> (!LdPtr.<a class="code" href="structBaseIndexOffset.html#acd3de374c9ae917fdc018643028ea28b">equalBaseIndex</a>(LdBasePtr))</div><div class="line"><a name="l08878"></a><span class="lineno"> 8878</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l08879"></a><span class="lineno"> 8879</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l08880"></a><span class="lineno"> 8880</span>&#160;      <span class="comment">// Check that all other base pointers are the same as this one.</span></div><div class="line"><a name="l08881"></a><span class="lineno"> 8881</span>&#160;      LdBasePtr = LdPtr;</div><div class="line"><a name="l08882"></a><span class="lineno"> 8882</span>&#160;    }</div><div class="line"><a name="l08883"></a><span class="lineno"> 8883</span>&#160;</div><div class="line"><a name="l08884"></a><span class="lineno"> 8884</span>&#160;    <span class="comment">// We found a potential memory operand to merge.</span></div><div class="line"><a name="l08885"></a><span class="lineno"> 8885</span>&#160;    LoadNodes.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(<a class="code" href="structMemOpLink.html">MemOpLink</a>(Ld, LdPtr.<a class="code" href="structBaseIndexOffset.html#a2c47325c74b1570d86010535fbdc710b">Offset</a>, 0));</div><div class="line"><a name="l08886"></a><span class="lineno"> 8886</span>&#160;  }</div><div class="line"><a name="l08887"></a><span class="lineno"> 8887</span>&#160;</div><div class="line"><a name="l08888"></a><span class="lineno"> 8888</span>&#160;  <span class="keywordflow">if</span> (LoadNodes.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#a22a311dfe4c28a897de8a9365a4f0a84">size</a>() &lt; 2)</div><div class="line"><a name="l08889"></a><span class="lineno"> 8889</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l08890"></a><span class="lineno"> 8890</span>&#160;</div><div class="line"><a name="l08891"></a><span class="lineno"> 8891</span>&#160;  <span class="comment">// Scan the memory operations on the chain and find the first non-consecutive</span></div><div class="line"><a name="l08892"></a><span class="lineno"> 8892</span>&#160;  <span class="comment">// load memory address. These variables hold the index in the store node</span></div><div class="line"><a name="l08893"></a><span class="lineno"> 8893</span>&#160;  <span class="comment">// array.</span></div><div class="line"><a name="l08894"></a><span class="lineno"> 8894</span>&#160;  <span class="keywordtype">unsigned</span> LastConsecutiveLoad = 0;</div><div class="line"><a name="l08895"></a><span class="lineno"> 8895</span>&#160;  <span class="comment">// This variable refers to the size and not index in the array.</span></div><div class="line"><a name="l08896"></a><span class="lineno"> 8896</span>&#160;  <span class="keywordtype">unsigned</span> LastLegalVectorType = 0;</div><div class="line"><a name="l08897"></a><span class="lineno"> 8897</span>&#160;  <span class="keywordtype">unsigned</span> LastLegalIntegerType = 0;</div><div class="line"><a name="l08898"></a><span class="lineno"> 8898</span>&#160;  StartAddress = LoadNodes[0].OffsetFromBase;</div><div class="line"><a name="l08899"></a><span class="lineno"> 8899</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> FirstChain = LoadNodes[0].MemNode-&gt;getChain();</div><div class="line"><a name="l08900"></a><span class="lineno"> 8900</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 1; <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; LoadNodes.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#a22a311dfe4c28a897de8a9365a4f0a84">size</a>(); ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l08901"></a><span class="lineno"> 8901</span>&#160;    <span class="comment">// All loads much share the same chain.</span></div><div class="line"><a name="l08902"></a><span class="lineno"> 8902</span>&#160;    <span class="keywordflow">if</span> (LoadNodes[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>].MemNode-&gt;getChain() != FirstChain)</div><div class="line"><a name="l08903"></a><span class="lineno"> 8903</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l08904"></a><span class="lineno"> 8904</span>&#160;</div><div class="line"><a name="l08905"></a><span class="lineno"> 8905</span>&#160;    int64_t CurrAddress = LoadNodes[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>].OffsetFromBase;</div><div class="line"><a name="l08906"></a><span class="lineno"> 8906</span>&#160;    <span class="keywordflow">if</span> (CurrAddress - StartAddress != (ElementSizeBytes * <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>))</div><div class="line"><a name="l08907"></a><span class="lineno"> 8907</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l08908"></a><span class="lineno"> 8908</span>&#160;    LastConsecutiveLoad = <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div><div class="line"><a name="l08909"></a><span class="lineno"> 8909</span>&#160;</div><div class="line"><a name="l08910"></a><span class="lineno"> 8910</span>&#160;    <span class="comment">// Find a legal type for the vector store.</span></div><div class="line"><a name="l08911"></a><span class="lineno"> 8911</span>&#160;    <a class="code" href="structllvm_1_1EVT.html">EVT</a> StoreTy = <a class="code" href="structllvm_1_1EVT.html#a18c2edf1939f6e87f1e586b815f398cd">EVT::getVectorVT</a>(*DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a39c6dff47b8dbd25cfaf6336c7056077">getContext</a>(), MemVT, i+1);</div><div class="line"><a name="l08912"></a><span class="lineno"> 8912</span>&#160;    <span class="keywordflow">if</span> (TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a861aaccc0f468493e76c011811548804">isTypeLegal</a>(StoreTy))</div><div class="line"><a name="l08913"></a><span class="lineno"> 8913</span>&#160;      LastLegalVectorType = i + 1;</div><div class="line"><a name="l08914"></a><span class="lineno"> 8914</span>&#160;</div><div class="line"><a name="l08915"></a><span class="lineno"> 8915</span>&#160;    <span class="comment">// Find a legal type for the integer store.</span></div><div class="line"><a name="l08916"></a><span class="lineno"> 8916</span>&#160;    <span class="keywordtype">unsigned</span> StoreBW = (i+1) * ElementSizeBytes * 8;</div><div class="line"><a name="l08917"></a><span class="lineno"> 8917</span>&#160;    StoreTy = <a class="code" href="structllvm_1_1EVT.html#a752372e170e4e7c595bf8810bb52adf2">EVT::getIntegerVT</a>(*DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a39c6dff47b8dbd25cfaf6336c7056077">getContext</a>(), StoreBW);</div><div class="line"><a name="l08918"></a><span class="lineno"> 8918</span>&#160;    <span class="keywordflow">if</span> (TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a861aaccc0f468493e76c011811548804">isTypeLegal</a>(StoreTy))</div><div class="line"><a name="l08919"></a><span class="lineno"> 8919</span>&#160;      LastLegalIntegerType = i + 1;</div><div class="line"><a name="l08920"></a><span class="lineno"> 8920</span>&#160;    <span class="comment">// Or check whether a truncstore and extload is legal.</span></div><div class="line"><a name="l08921"></a><span class="lineno"> 8921</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a7b93b105a426bc0eda1eadd856aa195e">getTypeAction</a>(*DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a39c6dff47b8dbd25cfaf6336c7056077">getContext</a>(), StoreTy) ==</div><div class="line"><a name="l08922"></a><span class="lineno"> 8922</span>&#160;             <a class="code" href="classllvm_1_1TargetLoweringBase.html#a88a8b01d4dbc2ebd81244d1eb459b193a26f35604723482a1aee6514940c2987d">TargetLowering::TypePromoteInteger</a>) {</div><div class="line"><a name="l08923"></a><span class="lineno"> 8923</span>&#160;      <a class="code" href="structllvm_1_1EVT.html">EVT</a> LegalizedStoredValueTy =</div><div class="line"><a name="l08924"></a><span class="lineno"> 8924</span>&#160;        TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a76daffc43a9b516f4fe4999c7b680ca0">getTypeToTransformTo</a>(*DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a39c6dff47b8dbd25cfaf6336c7056077">getContext</a>(), StoreTy);</div><div class="line"><a name="l08925"></a><span class="lineno"> 8925</span>&#160;      <span class="keywordflow">if</span> (TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#aaf6cf7bea7d0293cd174427f2ba6f50f">isTruncStoreLegal</a>(LegalizedStoredValueTy, StoreTy) &amp;&amp;</div><div class="line"><a name="l08926"></a><span class="lineno"> 8926</span>&#160;          TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#ad85f712b9e49629c2c160f16521fe91f">isLoadExtLegal</a>(<a class="code" href="namespacellvm_1_1ISD.html#ad4d48171b87ca51ff54c10a436bac4d7a8d89c7da4444d9ec11667aa369abc5f7">ISD::ZEXTLOAD</a>, StoreTy) &amp;&amp;</div><div class="line"><a name="l08927"></a><span class="lineno"> 8927</span>&#160;          TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#ad85f712b9e49629c2c160f16521fe91f">isLoadExtLegal</a>(<a class="code" href="namespacellvm_1_1ISD.html#ad4d48171b87ca51ff54c10a436bac4d7a6c61b6125c7901c549f90ee0e443a770">ISD::SEXTLOAD</a>, StoreTy) &amp;&amp;</div><div class="line"><a name="l08928"></a><span class="lineno"> 8928</span>&#160;          TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#ad85f712b9e49629c2c160f16521fe91f">isLoadExtLegal</a>(<a class="code" href="namespacellvm_1_1ISD.html#ad4d48171b87ca51ff54c10a436bac4d7afab3fffd153f7d7770fed81272e4b78f">ISD::EXTLOAD</a>, StoreTy))</div><div class="line"><a name="l08929"></a><span class="lineno"> 8929</span>&#160;        LastLegalIntegerType = i+1;</div><div class="line"><a name="l08930"></a><span class="lineno"> 8930</span>&#160;    }</div><div class="line"><a name="l08931"></a><span class="lineno"> 8931</span>&#160;  }</div><div class="line"><a name="l08932"></a><span class="lineno"> 8932</span>&#160;</div><div class="line"><a name="l08933"></a><span class="lineno"> 8933</span>&#160;  <span class="comment">// Only use vector types if the vector type is larger than the integer type.</span></div><div class="line"><a name="l08934"></a><span class="lineno"> 8934</span>&#160;  <span class="comment">// If they are the same, use integers.</span></div><div class="line"><a name="l08935"></a><span class="lineno"> 8935</span>&#160;  <span class="keywordtype">bool</span> UseVectorTy = LastLegalVectorType &gt; LastLegalIntegerType &amp;&amp; !NoVectors;</div><div class="line"><a name="l08936"></a><span class="lineno"> 8936</span>&#160;  <span class="keywordtype">unsigned</span> LastLegalType = std::max(LastLegalVectorType, LastLegalIntegerType);</div><div class="line"><a name="l08937"></a><span class="lineno"> 8937</span>&#160;</div><div class="line"><a name="l08938"></a><span class="lineno"> 8938</span>&#160;  <span class="comment">// We add +1 here because the LastXXX variables refer to location while</span></div><div class="line"><a name="l08939"></a><span class="lineno"> 8939</span>&#160;  <span class="comment">// the NumElem refers to array/index size.</span></div><div class="line"><a name="l08940"></a><span class="lineno"> 8940</span>&#160;  <span class="keywordtype">unsigned</span> NumElem = std::min(LastConsecutiveStore, LastConsecutiveLoad) + 1;</div><div class="line"><a name="l08941"></a><span class="lineno"> 8941</span>&#160;  NumElem = std::min(LastLegalType, NumElem);</div><div class="line"><a name="l08942"></a><span class="lineno"> 8942</span>&#160;</div><div class="line"><a name="l08943"></a><span class="lineno"> 8943</span>&#160;  <span class="keywordflow">if</span> (NumElem &lt; 2)</div><div class="line"><a name="l08944"></a><span class="lineno"> 8944</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l08945"></a><span class="lineno"> 8945</span>&#160;</div><div class="line"><a name="l08946"></a><span class="lineno"> 8946</span>&#160;  <span class="comment">// The earliest Node in the DAG.</span></div><div class="line"><a name="l08947"></a><span class="lineno"> 8947</span>&#160;  <span class="keywordtype">unsigned</span> EarliestNodeUsed = 0;</div><div class="line"><a name="l08948"></a><span class="lineno"> 8948</span>&#160;  <a class="code" href="classllvm_1_1LSBaseSDNode.html">LSBaseSDNode</a> *EarliestOp = StoreNodes[EarliestNodeUsed].MemNode;</div><div class="line"><a name="l08949"></a><span class="lineno"> 8949</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>=1; <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;NumElem; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l08950"></a><span class="lineno"> 8950</span>&#160;    <span class="comment">// Find a chain for the new wide-store operand. Notice that some</span></div><div class="line"><a name="l08951"></a><span class="lineno"> 8951</span>&#160;    <span class="comment">// of the store nodes that we found may not be selected for inclusion</span></div><div class="line"><a name="l08952"></a><span class="lineno"> 8952</span>&#160;    <span class="comment">// in the wide store. The chain we use needs to be the chain of the</span></div><div class="line"><a name="l08953"></a><span class="lineno"> 8953</span>&#160;    <span class="comment">// earliest store node which is *used* and replaced by the wide store.</span></div><div class="line"><a name="l08954"></a><span class="lineno"> 8954</span>&#160;    <span class="keywordflow">if</span> (StoreNodes[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>].SequenceNum &gt; StoreNodes[EarliestNodeUsed].SequenceNum)</div><div class="line"><a name="l08955"></a><span class="lineno"> 8955</span>&#160;      EarliestNodeUsed = <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div><div class="line"><a name="l08956"></a><span class="lineno"> 8956</span>&#160;  }</div><div class="line"><a name="l08957"></a><span class="lineno"> 8957</span>&#160;</div><div class="line"><a name="l08958"></a><span class="lineno"> 8958</span>&#160;  <span class="comment">// Find if it is better to use vectors or integers to load and store</span></div><div class="line"><a name="l08959"></a><span class="lineno"> 8959</span>&#160;  <span class="comment">// to memory.</span></div><div class="line"><a name="l08960"></a><span class="lineno"> 8960</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> JointMemOpVT;</div><div class="line"><a name="l08961"></a><span class="lineno"> 8961</span>&#160;  <span class="keywordflow">if</span> (UseVectorTy) {</div><div class="line"><a name="l08962"></a><span class="lineno"> 8962</span>&#160;    JointMemOpVT = <a class="code" href="structllvm_1_1EVT.html#a18c2edf1939f6e87f1e586b815f398cd">EVT::getVectorVT</a>(*DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a39c6dff47b8dbd25cfaf6336c7056077">getContext</a>(), MemVT, NumElem);</div><div class="line"><a name="l08963"></a><span class="lineno"> 8963</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l08964"></a><span class="lineno"> 8964</span>&#160;    <span class="keywordtype">unsigned</span> StoreBW = NumElem * ElementSizeBytes * 8;</div><div class="line"><a name="l08965"></a><span class="lineno"> 8965</span>&#160;    JointMemOpVT = <a class="code" href="structllvm_1_1EVT.html#a752372e170e4e7c595bf8810bb52adf2">EVT::getIntegerVT</a>(*DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a39c6dff47b8dbd25cfaf6336c7056077">getContext</a>(), StoreBW);</div><div class="line"><a name="l08966"></a><span class="lineno"> 8966</span>&#160;  }</div><div class="line"><a name="l08967"></a><span class="lineno"> 8967</span>&#160;</div><div class="line"><a name="l08968"></a><span class="lineno"> 8968</span>&#160;  <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a> LoadDL(LoadNodes[0].MemNode);</div><div class="line"><a name="l08969"></a><span class="lineno"> 8969</span>&#160;  <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a> StoreDL(StoreNodes[0].MemNode);</div><div class="line"><a name="l08970"></a><span class="lineno"> 8970</span>&#160;</div><div class="line"><a name="l08971"></a><span class="lineno"> 8971</span>&#160;  <a class="code" href="classllvm_1_1LoadSDNode.html">LoadSDNode</a> *FirstLoad = cast&lt;LoadSDNode&gt;(LoadNodes[0].MemNode);</div><div class="line"><a name="l08972"></a><span class="lineno"> 8972</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> NewLoad = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#ab8395be5698f080c0036d866e121a478">getLoad</a>(JointMemOpVT, LoadDL,</div><div class="line"><a name="l08973"></a><span class="lineno"> 8973</span>&#160;                                FirstLoad-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#ae3cb6fbf8c8cb79e10ac61bd98c85211">getChain</a>(),</div><div class="line"><a name="l08974"></a><span class="lineno"> 8974</span>&#160;                                FirstLoad-&gt;<a class="code" href="classllvm_1_1LoadSDNode.html#a3ded48ce66b58b7e7e143991df5dbfae">getBasePtr</a>(),</div><div class="line"><a name="l08975"></a><span class="lineno"> 8975</span>&#160;                                FirstLoad-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a2fa8491ab36125d7f5dd38d3a4868934">getPointerInfo</a>(),</div><div class="line"><a name="l08976"></a><span class="lineno"> 8976</span>&#160;                                <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>,</div><div class="line"><a name="l08977"></a><span class="lineno"> 8977</span>&#160;                                FirstLoad-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a4f68cd016138440f215ad80c1d6c1e04">getAlignment</a>());</div><div class="line"><a name="l08978"></a><span class="lineno"> 8978</span>&#160;</div><div class="line"><a name="l08979"></a><span class="lineno"> 8979</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> NewStore = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a2bdce1dfec3bab37c9a38e516eba42e7">getStore</a>(EarliestOp-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#ae3cb6fbf8c8cb79e10ac61bd98c85211">getChain</a>(), StoreDL, NewLoad,</div><div class="line"><a name="l08980"></a><span class="lineno"> 8980</span>&#160;                                  FirstInChain-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a9330f807294a868461af12a3ed56a269">getBasePtr</a>(),</div><div class="line"><a name="l08981"></a><span class="lineno"> 8981</span>&#160;                                  FirstInChain-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a2fa8491ab36125d7f5dd38d3a4868934">getPointerInfo</a>(), <span class="keyword">false</span>, <span class="keyword">false</span>,</div><div class="line"><a name="l08982"></a><span class="lineno"> 8982</span>&#160;                                  FirstInChain-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a4f68cd016138440f215ad80c1d6c1e04">getAlignment</a>());</div><div class="line"><a name="l08983"></a><span class="lineno"> 8983</span>&#160;</div><div class="line"><a name="l08984"></a><span class="lineno"> 8984</span>&#160;  <span class="comment">// Replace one of the loads with the new load.</span></div><div class="line"><a name="l08985"></a><span class="lineno"> 8985</span>&#160;  <a class="code" href="classllvm_1_1LoadSDNode.html">LoadSDNode</a> *Ld = cast&lt;LoadSDNode&gt;(LoadNodes[0].MemNode);</div><div class="line"><a name="l08986"></a><span class="lineno"> 8986</span>&#160;  DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#ac630ccda26fea2f45afa3fb89bc1a8f4">ReplaceAllUsesOfValueWith</a>(<a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(Ld, 1),</div><div class="line"><a name="l08987"></a><span class="lineno"> 8987</span>&#160;                                <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(NewLoad.getNode(), 1));</div><div class="line"><a name="l08988"></a><span class="lineno"> 8988</span>&#160;</div><div class="line"><a name="l08989"></a><span class="lineno"> 8989</span>&#160;  <span class="comment">// Remove the rest of the load chains.</span></div><div class="line"><a name="l08990"></a><span class="lineno"> 8990</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 1; <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; NumElem ; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l08991"></a><span class="lineno"> 8991</span>&#160;    <span class="comment">// Replace all chain users of the old load nodes with the chain of the new</span></div><div class="line"><a name="l08992"></a><span class="lineno"> 8992</span>&#160;    <span class="comment">// load node.</span></div><div class="line"><a name="l08993"></a><span class="lineno"> 8993</span>&#160;    <a class="code" href="classllvm_1_1LoadSDNode.html">LoadSDNode</a> *Ld = cast&lt;LoadSDNode&gt;(LoadNodes[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>].MemNode);</div><div class="line"><a name="l08994"></a><span class="lineno"> 8994</span>&#160;    DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#ac630ccda26fea2f45afa3fb89bc1a8f4">ReplaceAllUsesOfValueWith</a>(<a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(Ld, 1), Ld-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#ae3cb6fbf8c8cb79e10ac61bd98c85211">getChain</a>());</div><div class="line"><a name="l08995"></a><span class="lineno"> 8995</span>&#160;  }</div><div class="line"><a name="l08996"></a><span class="lineno"> 8996</span>&#160;</div><div class="line"><a name="l08997"></a><span class="lineno"> 8997</span>&#160;  <span class="comment">// Replace the first store with the new store.</span></div><div class="line"><a name="l08998"></a><span class="lineno"> 8998</span>&#160;  CombineTo(EarliestOp, NewStore);</div><div class="line"><a name="l08999"></a><span class="lineno"> 8999</span>&#160;  <span class="comment">// Erase all other stores.</span></div><div class="line"><a name="l09000"></a><span class="lineno"> 9000</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; NumElem ; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l09001"></a><span class="lineno"> 9001</span>&#160;    <span class="comment">// Remove all Store nodes.</span></div><div class="line"><a name="l09002"></a><span class="lineno"> 9002</span>&#160;    <span class="keywordflow">if</span> (StoreNodes[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>].MemNode == EarliestOp)</div><div class="line"><a name="l09003"></a><span class="lineno"> 9003</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l09004"></a><span class="lineno"> 9004</span>&#160;    <a class="code" href="classllvm_1_1StoreSDNode.html">StoreSDNode</a> *St = cast&lt;StoreSDNode&gt;(StoreNodes[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>].MemNode);</div><div class="line"><a name="l09005"></a><span class="lineno"> 9005</span>&#160;    DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#ac630ccda26fea2f45afa3fb89bc1a8f4">ReplaceAllUsesOfValueWith</a>(<a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(St, 0), St-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#ae3cb6fbf8c8cb79e10ac61bd98c85211">getChain</a>());</div><div class="line"><a name="l09006"></a><span class="lineno"> 9006</span>&#160;    removeFromWorkList(St);</div><div class="line"><a name="l09007"></a><span class="lineno"> 9007</span>&#160;    DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a5f57dcbedc16dced31c61f7bbbb06ded">DeleteNode</a>(St);</div><div class="line"><a name="l09008"></a><span class="lineno"> 9008</span>&#160;  }</div><div class="line"><a name="l09009"></a><span class="lineno"> 9009</span>&#160;</div><div class="line"><a name="l09010"></a><span class="lineno"> 9010</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l09011"></a><span class="lineno"> 9011</span>&#160;}</div><div class="line"><a name="l09012"></a><span class="lineno"> 9012</span>&#160;</div><div class="line"><a name="l09013"></a><span class="lineno"> 9013</span>&#160;<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::visitSTORE(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N) {</div><div class="line"><a name="l09014"></a><span class="lineno"> 9014</span>&#160;  <a class="code" href="classllvm_1_1StoreSDNode.html">StoreSDNode</a> *<a class="code" href="namespacellvm_1_1A64DB.html#a6fce8157775f3ec93f326b52b0f1e0f5a4916e736d6b7cc68359b39d5eb50f6db">ST</a>  = cast&lt;StoreSDNode&gt;(<a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>);</div><div class="line"><a name="l09015"></a><span class="lineno"> 9015</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Chain = ST-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#ae3cb6fbf8c8cb79e10ac61bd98c85211">getChain</a>();</div><div class="line"><a name="l09016"></a><span class="lineno"> 9016</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> <a class="code" href="classllvm_1_1Value.html">Value</a> = ST-&gt;<a class="code" href="classllvm_1_1StoreSDNode.html#a7f9820a84907a5aa530d4dc36f841c76">getValue</a>();</div><div class="line"><a name="l09017"></a><span class="lineno"> 9017</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Ptr   = ST-&gt;<a class="code" href="classllvm_1_1StoreSDNode.html#aec453733fbb9f24036960fdc6b3b4b46">getBasePtr</a>();</div><div class="line"><a name="l09018"></a><span class="lineno"> 9018</span>&#160;</div><div class="line"><a name="l09019"></a><span class="lineno"> 9019</span>&#160;  <span class="comment">// If this is a store of a bit convert, store the input value if the</span></div><div class="line"><a name="l09020"></a><span class="lineno"> 9020</span>&#160;  <span class="comment">// resultant store does not need a higher alignment than the original.</span></div><div class="line"><a name="l09021"></a><span class="lineno"> 9021</span>&#160;  <span class="keywordflow">if</span> (Value.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a412ddf522b53f07690a86bffba1278e7">ISD::BITCAST</a> &amp;&amp; !ST-&gt;<a class="code" href="classllvm_1_1StoreSDNode.html#a272cb283a679298b7e991db7daf823ed">isTruncatingStore</a>() &amp;&amp;</div><div class="line"><a name="l09022"></a><span class="lineno"> 9022</span>&#160;      ST-&gt;<a class="code" href="classllvm_1_1LSBaseSDNode.html#a958114b87bff3b4db5ae7766d44dc375">isUnindexed</a>()) {</div><div class="line"><a name="l09023"></a><span class="lineno"> 9023</span>&#160;    <span class="keywordtype">unsigned</span> OrigAlign = ST-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a4f68cd016138440f215ad80c1d6c1e04">getAlignment</a>();</div><div class="line"><a name="l09024"></a><span class="lineno"> 9024</span>&#160;    <a class="code" href="structllvm_1_1EVT.html">EVT</a> SVT = Value.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>();</div><div class="line"><a name="l09025"></a><span class="lineno"> 9025</span>&#160;    <span class="keywordtype">unsigned</span> <a class="code" href="ARMSubtarget_8cpp.html#a4bd80d4e433d9f72af26b364036900dc">Align</a> = TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#adc25bcc279ccfb5b867c2b7b8eedaa9b">getDataLayout</a>()-&gt;</div><div class="line"><a name="l09026"></a><span class="lineno"> 9026</span>&#160;      getABITypeAlignment(SVT.<a class="code" href="structllvm_1_1EVT.html#a226345d0c8262e9469d30a993d1656ff">getTypeForEVT</a>(*DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a39c6dff47b8dbd25cfaf6336c7056077">getContext</a>()));</div><div class="line"><a name="l09027"></a><span class="lineno"> 9027</span>&#160;    <span class="keywordflow">if</span> (Align &lt;= OrigAlign &amp;&amp;</div><div class="line"><a name="l09028"></a><span class="lineno"> 9028</span>&#160;        ((!LegalOperations &amp;&amp; !ST-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#acd3bb9ee2ec53fa4be1fdf155b0b5a17">isVolatile</a>()) ||</div><div class="line"><a name="l09029"></a><span class="lineno"> 9029</span>&#160;         TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a087dd0f9650e999b087c17cc7f46f2d0">isOperationLegalOrCustom</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a047178c3b2c6a5df40ae22a407b8aca9">ISD::STORE</a>, SVT)))</div><div class="line"><a name="l09030"></a><span class="lineno"> 9030</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a2bdce1dfec3bab37c9a38e516eba42e7">getStore</a>(Chain, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), Value.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0),</div><div class="line"><a name="l09031"></a><span class="lineno"> 9031</span>&#160;                          Ptr, ST-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a2fa8491ab36125d7f5dd38d3a4868934">getPointerInfo</a>(), ST-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#acd3bb9ee2ec53fa4be1fdf155b0b5a17">isVolatile</a>(),</div><div class="line"><a name="l09032"></a><span class="lineno"> 9032</span>&#160;                          ST-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a967ffaf77f64a5deb1e96951e4224112">isNonTemporal</a>(), OrigAlign,</div><div class="line"><a name="l09033"></a><span class="lineno"> 9033</span>&#160;                          ST-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a23670ceb5797afa3d45ca1a9b011fd87">getTBAAInfo</a>());</div><div class="line"><a name="l09034"></a><span class="lineno"> 9034</span>&#160;  }</div><div class="line"><a name="l09035"></a><span class="lineno"> 9035</span>&#160;</div><div class="line"><a name="l09036"></a><span class="lineno"> 9036</span>&#160;  <span class="comment">// Turn &#39;store undef, Ptr&#39; -&gt; nothing.</span></div><div class="line"><a name="l09037"></a><span class="lineno"> 9037</span>&#160;  <span class="keywordflow">if</span> (Value.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7c6d8f265e9e16e5debdb9a536b55d3d">ISD::UNDEF</a> &amp;&amp; ST-&gt;<a class="code" href="classllvm_1_1LSBaseSDNode.html#a958114b87bff3b4db5ae7766d44dc375">isUnindexed</a>())</div><div class="line"><a name="l09038"></a><span class="lineno"> 9038</span>&#160;    <span class="keywordflow">return</span> Chain;</div><div class="line"><a name="l09039"></a><span class="lineno"> 9039</span>&#160;</div><div class="line"><a name="l09040"></a><span class="lineno"> 9040</span>&#160;  <span class="comment">// Turn &#39;store float 1.0, Ptr&#39; -&gt; &#39;store int 0x12345678, Ptr&#39;</span></div><div class="line"><a name="l09041"></a><span class="lineno"> 9041</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1ConstantFPSDNode.html">ConstantFPSDNode</a> *CFP = dyn_cast&lt;ConstantFPSDNode&gt;(Value)) {</div><div class="line"><a name="l09042"></a><span class="lineno"> 9042</span>&#160;    <span class="comment">// NOTE: If the original store is volatile, this transform must not increase</span></div><div class="line"><a name="l09043"></a><span class="lineno"> 9043</span>&#160;    <span class="comment">// the number of stores.  For example, on x86-32 an f64 can be stored in one</span></div><div class="line"><a name="l09044"></a><span class="lineno"> 9044</span>&#160;    <span class="comment">// processor operation but an i64 (which is not legal) requires two.  So the</span></div><div class="line"><a name="l09045"></a><span class="lineno"> 9045</span>&#160;    <span class="comment">// transform should not be done in this case.</span></div><div class="line"><a name="l09046"></a><span class="lineno"> 9046</span>&#160;    <span class="keywordflow">if</span> (Value.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() != <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a95cd714ab601765342e2ec9f6ba2cb34">ISD::TargetConstantFP</a>) {</div><div class="line"><a name="l09047"></a><span class="lineno"> 9047</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Tmp;</div><div class="line"><a name="l09048"></a><span class="lineno"> 9048</span>&#160;      <span class="keywordflow">switch</span> (CFP-&gt;getSimpleValueType(0).SimpleTy) {</div><div class="line"><a name="l09049"></a><span class="lineno"> 9049</span>&#160;      <span class="keywordflow">default</span>: <a class="code" href="ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a>(<span class="stringliteral">&quot;Unknown FP type&quot;</span>);</div><div class="line"><a name="l09050"></a><span class="lineno"> 9050</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50ca1e0cfc795f0b068229dcec6eecb69499">MVT::f16</a>:    <span class="comment">// We don&#39;t do this for these yet.</span></div><div class="line"><a name="l09051"></a><span class="lineno"> 9051</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50ca6c5745e529b6b3534599c54d82bc4691">MVT::f80</a>:</div><div class="line"><a name="l09052"></a><span class="lineno"> 9052</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50caffc152986796ab57023f65116d2ee1b2">MVT::f128</a>:</div><div class="line"><a name="l09053"></a><span class="lineno"> 9053</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50ca497ebfc1d05b772bf14cd530c950cf80">MVT::ppcf128</a>:</div><div class="line"><a name="l09054"></a><span class="lineno"> 9054</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l09055"></a><span class="lineno"> 9055</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50ca586bae91020e6d8cccfe0995f527606f">MVT::f32</a>:</div><div class="line"><a name="l09056"></a><span class="lineno"> 9056</span>&#160;        <span class="keywordflow">if</span> ((isTypeLegal(<a class="code" href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50ca04cca8bc12888d0a7238f55a6c550ad0">MVT::i32</a>) &amp;&amp; !LegalOperations &amp;&amp; !ST-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#acd3bb9ee2ec53fa4be1fdf155b0b5a17">isVolatile</a>()) ||</div><div class="line"><a name="l09057"></a><span class="lineno"> 9057</span>&#160;            TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a087dd0f9650e999b087c17cc7f46f2d0">isOperationLegalOrCustom</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a047178c3b2c6a5df40ae22a407b8aca9">ISD::STORE</a>, <a class="code" href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50ca04cca8bc12888d0a7238f55a6c550ad0">MVT::i32</a>)) {</div><div class="line"><a name="l09058"></a><span class="lineno"> 9058</span>&#160;          Tmp = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>((uint32_t)CFP-&gt;getValueAPF().</div><div class="line"><a name="l09059"></a><span class="lineno"> 9059</span>&#160;                              bitcastToAPInt().getZExtValue(), <a class="code" href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50ca04cca8bc12888d0a7238f55a6c550ad0">MVT::i32</a>);</div><div class="line"><a name="l09060"></a><span class="lineno"> 9060</span>&#160;          <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a2bdce1dfec3bab37c9a38e516eba42e7">getStore</a>(Chain, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), Tmp,</div><div class="line"><a name="l09061"></a><span class="lineno"> 9061</span>&#160;                              Ptr, ST-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a89e2b5e3fb867b4040f893c6ae3d2132">getMemOperand</a>());</div><div class="line"><a name="l09062"></a><span class="lineno"> 9062</span>&#160;        }</div><div class="line"><a name="l09063"></a><span class="lineno"> 9063</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l09064"></a><span class="lineno"> 9064</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50cac661c912350e3095c85ba75b8dbc17b1">MVT::f64</a>:</div><div class="line"><a name="l09065"></a><span class="lineno"> 9065</span>&#160;        <span class="keywordflow">if</span> ((TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a861aaccc0f468493e76c011811548804">isTypeLegal</a>(<a class="code" href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50ca97f56253625b3fe7b371ce76722de4b8">MVT::i64</a>) &amp;&amp; !LegalOperations &amp;&amp;</div><div class="line"><a name="l09066"></a><span class="lineno"> 9066</span>&#160;             !ST-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#acd3bb9ee2ec53fa4be1fdf155b0b5a17">isVolatile</a>()) ||</div><div class="line"><a name="l09067"></a><span class="lineno"> 9067</span>&#160;            TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a087dd0f9650e999b087c17cc7f46f2d0">isOperationLegalOrCustom</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a047178c3b2c6a5df40ae22a407b8aca9">ISD::STORE</a>, <a class="code" href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50ca97f56253625b3fe7b371ce76722de4b8">MVT::i64</a>)) {</div><div class="line"><a name="l09068"></a><span class="lineno"> 9068</span>&#160;          Tmp = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(CFP-&gt;getValueAPF().bitcastToAPInt().</div><div class="line"><a name="l09069"></a><span class="lineno"> 9069</span>&#160;                                getZExtValue(), <a class="code" href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50ca97f56253625b3fe7b371ce76722de4b8">MVT::i64</a>);</div><div class="line"><a name="l09070"></a><span class="lineno"> 9070</span>&#160;          <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a2bdce1dfec3bab37c9a38e516eba42e7">getStore</a>(Chain, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), Tmp,</div><div class="line"><a name="l09071"></a><span class="lineno"> 9071</span>&#160;                              Ptr, ST-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a89e2b5e3fb867b4040f893c6ae3d2132">getMemOperand</a>());</div><div class="line"><a name="l09072"></a><span class="lineno"> 9072</span>&#160;        }</div><div class="line"><a name="l09073"></a><span class="lineno"> 9073</span>&#160;</div><div class="line"><a name="l09074"></a><span class="lineno"> 9074</span>&#160;        <span class="keywordflow">if</span> (!ST-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#acd3bb9ee2ec53fa4be1fdf155b0b5a17">isVolatile</a>() &amp;&amp;</div><div class="line"><a name="l09075"></a><span class="lineno"> 9075</span>&#160;            TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a087dd0f9650e999b087c17cc7f46f2d0">isOperationLegalOrCustom</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a047178c3b2c6a5df40ae22a407b8aca9">ISD::STORE</a>, <a class="code" href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50ca04cca8bc12888d0a7238f55a6c550ad0">MVT::i32</a>)) {</div><div class="line"><a name="l09076"></a><span class="lineno"> 9076</span>&#160;          <span class="comment">// Many FP stores are not made apparent until after legalize, e.g. for</span></div><div class="line"><a name="l09077"></a><span class="lineno"> 9077</span>&#160;          <span class="comment">// argument passing.  Since this is so common, custom legalize the</span></div><div class="line"><a name="l09078"></a><span class="lineno"> 9078</span>&#160;          <span class="comment">// 64-bit integer store into two 32-bit stores.</span></div><div class="line"><a name="l09079"></a><span class="lineno"> 9079</span>&#160;          uint64_t Val = CFP-&gt;getValueAPF().bitcastToAPInt().getZExtValue();</div><div class="line"><a name="l09080"></a><span class="lineno"> 9080</span>&#160;          <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> <a class="code" href="namespacellvm_1_1HexagonISD.html#aa640667f875feccdb3cc643baff441f1a144f7e8227378979bf13646688174ed9">Lo</a> = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(Val &amp; 0xFFFFFFFF, <a class="code" href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50ca04cca8bc12888d0a7238f55a6c550ad0">MVT::i32</a>);</div><div class="line"><a name="l09081"></a><span class="lineno"> 9081</span>&#160;          <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> <a class="code" href="namespacellvm_1_1HexagonISD.html#aa640667f875feccdb3cc643baff441f1ab53c716337bbeea9ba39b5fa32d60303">Hi</a> = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(Val &gt;&gt; 32, <a class="code" href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50ca04cca8bc12888d0a7238f55a6c550ad0">MVT::i32</a>);</div><div class="line"><a name="l09082"></a><span class="lineno"> 9082</span>&#160;          <span class="keywordflow">if</span> (TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a785a8016a792dbc65ec16688f180af71">isBigEndian</a>()) <a class="code" href="namespacestd.html#ab8424022895aee3e366fb9a32f2883cb">std::swap</a>(Lo, Hi);</div><div class="line"><a name="l09083"></a><span class="lineno"> 9083</span>&#160;</div><div class="line"><a name="l09084"></a><span class="lineno"> 9084</span>&#160;          <span class="keywordtype">unsigned</span> Alignment = ST-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a4f68cd016138440f215ad80c1d6c1e04">getAlignment</a>();</div><div class="line"><a name="l09085"></a><span class="lineno"> 9085</span>&#160;          <span class="keywordtype">bool</span> isVolatile = ST-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#acd3bb9ee2ec53fa4be1fdf155b0b5a17">isVolatile</a>();</div><div class="line"><a name="l09086"></a><span class="lineno"> 9086</span>&#160;          <span class="keywordtype">bool</span> isNonTemporal = ST-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a967ffaf77f64a5deb1e96951e4224112">isNonTemporal</a>();</div><div class="line"><a name="l09087"></a><span class="lineno"> 9087</span>&#160;          <span class="keyword">const</span> <a class="code" href="classllvm_1_1MDNode.html">MDNode</a> *TBAAInfo = ST-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a23670ceb5797afa3d45ca1a9b011fd87">getTBAAInfo</a>();</div><div class="line"><a name="l09088"></a><span class="lineno"> 9088</span>&#160;</div><div class="line"><a name="l09089"></a><span class="lineno"> 9089</span>&#160;          <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> St0 = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a2bdce1dfec3bab37c9a38e516eba42e7">getStore</a>(Chain, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(ST), Lo,</div><div class="line"><a name="l09090"></a><span class="lineno"> 9090</span>&#160;                                     Ptr, ST-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a2fa8491ab36125d7f5dd38d3a4868934">getPointerInfo</a>(),</div><div class="line"><a name="l09091"></a><span class="lineno"> 9091</span>&#160;                                     isVolatile, isNonTemporal,</div><div class="line"><a name="l09092"></a><span class="lineno"> 9092</span>&#160;                                     ST-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a4f68cd016138440f215ad80c1d6c1e04">getAlignment</a>(), TBAAInfo);</div><div class="line"><a name="l09093"></a><span class="lineno"> 9093</span>&#160;          Ptr = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a269996b43a1f3e1d1f84a70fd4387535">ISD::ADD</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), Ptr.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>(), Ptr,</div><div class="line"><a name="l09094"></a><span class="lineno"> 9094</span>&#160;                            DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(4, Ptr.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>()));</div><div class="line"><a name="l09095"></a><span class="lineno"> 9095</span>&#160;          Alignment = <a class="code" href="namespacellvm.html#af36d7e69ab16b64b2e3a48c83aa9f0f6">MinAlign</a>(Alignment, 4U);</div><div class="line"><a name="l09096"></a><span class="lineno"> 9096</span>&#160;          <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> St1 = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a2bdce1dfec3bab37c9a38e516eba42e7">getStore</a>(Chain, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(ST), Hi,</div><div class="line"><a name="l09097"></a><span class="lineno"> 9097</span>&#160;                                     Ptr, ST-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a2fa8491ab36125d7f5dd38d3a4868934">getPointerInfo</a>().<a class="code" href="structllvm_1_1MachinePointerInfo.html#aa7b903b38006dd4cb8fcf8854af5b6b9">getWithOffset</a>(4),</div><div class="line"><a name="l09098"></a><span class="lineno"> 9098</span>&#160;                                     isVolatile, isNonTemporal,</div><div class="line"><a name="l09099"></a><span class="lineno"> 9099</span>&#160;                                     Alignment, TBAAInfo);</div><div class="line"><a name="l09100"></a><span class="lineno"> 9100</span>&#160;          <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ad469508535ce2082a1ab1f0e429187b8">ISD::TokenFactor</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), <a class="code" href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50ca62a222acce6360abd2726719fabc2797">MVT::Other</a>,</div><div class="line"><a name="l09101"></a><span class="lineno"> 9101</span>&#160;                             St0, St1);</div><div class="line"><a name="l09102"></a><span class="lineno"> 9102</span>&#160;        }</div><div class="line"><a name="l09103"></a><span class="lineno"> 9103</span>&#160;</div><div class="line"><a name="l09104"></a><span class="lineno"> 9104</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l09105"></a><span class="lineno"> 9105</span>&#160;      }</div><div class="line"><a name="l09106"></a><span class="lineno"> 9106</span>&#160;    }</div><div class="line"><a name="l09107"></a><span class="lineno"> 9107</span>&#160;  }</div><div class="line"><a name="l09108"></a><span class="lineno"> 9108</span>&#160;</div><div class="line"><a name="l09109"></a><span class="lineno"> 9109</span>&#160;  <span class="comment">// Try to infer better alignment information than the store already has.</span></div><div class="line"><a name="l09110"></a><span class="lineno"> 9110</span>&#160;  <span class="keywordflow">if</span> (OptLevel != <a class="code" href="namespacellvm_1_1CodeGenOpt.html#a411055ea15209051c2370bbf655ec8d4a451bbac85aff02d070be3c17a6bef928">CodeGenOpt::None</a> &amp;&amp; ST-&gt;<a class="code" href="classllvm_1_1LSBaseSDNode.html#a958114b87bff3b4db5ae7766d44dc375">isUnindexed</a>()) {</div><div class="line"><a name="l09111"></a><span class="lineno"> 9111</span>&#160;    <span class="keywordflow">if</span> (<span class="keywordtype">unsigned</span> <a class="code" href="ARMSubtarget_8cpp.html#a4bd80d4e433d9f72af26b364036900dc">Align</a> = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a2bf689949a7a6c115298d4f8e4f637cd">InferPtrAlignment</a>(Ptr)) {</div><div class="line"><a name="l09112"></a><span class="lineno"> 9112</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="ARMSubtarget_8cpp.html#a4bd80d4e433d9f72af26b364036900dc">Align</a> &gt; ST-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a4f68cd016138440f215ad80c1d6c1e04">getAlignment</a>())</div><div class="line"><a name="l09113"></a><span class="lineno"> 9113</span>&#160;        <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a76ccaa8c8885072ba11aee5133865e36">getTruncStore</a>(Chain, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), Value,</div><div class="line"><a name="l09114"></a><span class="lineno"> 9114</span>&#160;                                 Ptr, ST-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a2fa8491ab36125d7f5dd38d3a4868934">getPointerInfo</a>(), ST-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a7cead3a2a7771e61083bcc6959915a13">getMemoryVT</a>(),</div><div class="line"><a name="l09115"></a><span class="lineno"> 9115</span>&#160;                                 ST-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#acd3bb9ee2ec53fa4be1fdf155b0b5a17">isVolatile</a>(), ST-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a967ffaf77f64a5deb1e96951e4224112">isNonTemporal</a>(), <a class="code" href="ARMSubtarget_8cpp.html#a4bd80d4e433d9f72af26b364036900dc">Align</a>,</div><div class="line"><a name="l09116"></a><span class="lineno"> 9116</span>&#160;                                 ST-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a23670ceb5797afa3d45ca1a9b011fd87">getTBAAInfo</a>());</div><div class="line"><a name="l09117"></a><span class="lineno"> 9117</span>&#160;    }</div><div class="line"><a name="l09118"></a><span class="lineno"> 9118</span>&#160;  }</div><div class="line"><a name="l09119"></a><span class="lineno"> 9119</span>&#160;</div><div class="line"><a name="l09120"></a><span class="lineno"> 9120</span>&#160;  <span class="comment">// Try transforming a pair floating point load / store ops to integer</span></div><div class="line"><a name="l09121"></a><span class="lineno"> 9121</span>&#160;  <span class="comment">// load / store ops.</span></div><div class="line"><a name="l09122"></a><span class="lineno"> 9122</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> NewST = TransformFPLoadStorePair(N);</div><div class="line"><a name="l09123"></a><span class="lineno"> 9123</span>&#160;  <span class="keywordflow">if</span> (NewST.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>())</div><div class="line"><a name="l09124"></a><span class="lineno"> 9124</span>&#160;    <span class="keywordflow">return</span> NewST;</div><div class="line"><a name="l09125"></a><span class="lineno"> 9125</span>&#160;</div><div class="line"><a name="l09126"></a><span class="lineno"> 9126</span>&#160;  <span class="keywordtype">bool</span> UseAA = CombinerAA.getNumOccurrences() &gt; 0 ? CombinerAA :</div><div class="line"><a name="l09127"></a><span class="lineno"> 9127</span>&#160;    TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#ada5f4a5dd489c777870538cdbb6da228">getTargetMachine</a>().<a class="code" href="classllvm_1_1TargetMachine.html#a5af2fed99951774b6a14d30ec6e73792">getSubtarget</a>&lt;<a class="code" href="classllvm_1_1TargetSubtargetInfo.html">TargetSubtargetInfo</a>&gt;().useAA();</div><div class="line"><a name="l09128"></a><span class="lineno"> 9128</span>&#160;  <span class="keywordflow">if</span> (UseAA) {</div><div class="line"><a name="l09129"></a><span class="lineno"> 9129</span>&#160;    <span class="comment">// Walk up chain skipping non-aliasing memory nodes.</span></div><div class="line"><a name="l09130"></a><span class="lineno"> 9130</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> BetterChain = FindBetterChain(N, Chain);</div><div class="line"><a name="l09131"></a><span class="lineno"> 9131</span>&#160;</div><div class="line"><a name="l09132"></a><span class="lineno"> 9132</span>&#160;    <span class="comment">// If there is a better chain.</span></div><div class="line"><a name="l09133"></a><span class="lineno"> 9133</span>&#160;    <span class="keywordflow">if</span> (Chain != BetterChain) {</div><div class="line"><a name="l09134"></a><span class="lineno"> 9134</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> ReplStore;</div><div class="line"><a name="l09135"></a><span class="lineno"> 9135</span>&#160;</div><div class="line"><a name="l09136"></a><span class="lineno"> 9136</span>&#160;      <span class="comment">// Replace the chain to avoid dependency.</span></div><div class="line"><a name="l09137"></a><span class="lineno"> 9137</span>&#160;      <span class="keywordflow">if</span> (ST-&gt;<a class="code" href="classllvm_1_1StoreSDNode.html#a272cb283a679298b7e991db7daf823ed">isTruncatingStore</a>()) {</div><div class="line"><a name="l09138"></a><span class="lineno"> 9138</span>&#160;        ReplStore = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a76ccaa8c8885072ba11aee5133865e36">getTruncStore</a>(BetterChain, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), Value, Ptr,</div><div class="line"><a name="l09139"></a><span class="lineno"> 9139</span>&#160;                                      ST-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a7cead3a2a7771e61083bcc6959915a13">getMemoryVT</a>(), ST-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a89e2b5e3fb867b4040f893c6ae3d2132">getMemOperand</a>());</div><div class="line"><a name="l09140"></a><span class="lineno"> 9140</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l09141"></a><span class="lineno"> 9141</span>&#160;        ReplStore = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a2bdce1dfec3bab37c9a38e516eba42e7">getStore</a>(BetterChain, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), Value, Ptr,</div><div class="line"><a name="l09142"></a><span class="lineno"> 9142</span>&#160;                                 ST-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a89e2b5e3fb867b4040f893c6ae3d2132">getMemOperand</a>());</div><div class="line"><a name="l09143"></a><span class="lineno"> 9143</span>&#160;      }</div><div class="line"><a name="l09144"></a><span class="lineno"> 9144</span>&#160;</div><div class="line"><a name="l09145"></a><span class="lineno"> 9145</span>&#160;      <span class="comment">// Create token to keep both nodes around.</span></div><div class="line"><a name="l09146"></a><span class="lineno"> 9146</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Token = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ad469508535ce2082a1ab1f0e429187b8">ISD::TokenFactor</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N),</div><div class="line"><a name="l09147"></a><span class="lineno"> 9147</span>&#160;                                  <a class="code" href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50ca62a222acce6360abd2726719fabc2797">MVT::Other</a>, Chain, ReplStore);</div><div class="line"><a name="l09148"></a><span class="lineno"> 9148</span>&#160;</div><div class="line"><a name="l09149"></a><span class="lineno"> 9149</span>&#160;      <span class="comment">// Make sure the new and old chains are cleaned up.</span></div><div class="line"><a name="l09150"></a><span class="lineno"> 9150</span>&#160;      AddToWorkList(Token.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l09151"></a><span class="lineno"> 9151</span>&#160;</div><div class="line"><a name="l09152"></a><span class="lineno"> 9152</span>&#160;      <span class="comment">// Don&#39;t add users to work list.</span></div><div class="line"><a name="l09153"></a><span class="lineno"> 9153</span>&#160;      <span class="keywordflow">return</span> CombineTo(N, Token, <span class="keyword">false</span>);</div><div class="line"><a name="l09154"></a><span class="lineno"> 9154</span>&#160;    }</div><div class="line"><a name="l09155"></a><span class="lineno"> 9155</span>&#160;  }</div><div class="line"><a name="l09156"></a><span class="lineno"> 9156</span>&#160;</div><div class="line"><a name="l09157"></a><span class="lineno"> 9157</span>&#160;  <span class="comment">// Try transforming N to an indexed store.</span></div><div class="line"><a name="l09158"></a><span class="lineno"> 9158</span>&#160;  <span class="keywordflow">if</span> (CombineToPreIndexedLoadStore(N) || CombineToPostIndexedLoadStore(N))</div><div class="line"><a name="l09159"></a><span class="lineno"> 9159</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(N, 0);</div><div class="line"><a name="l09160"></a><span class="lineno"> 9160</span>&#160;</div><div class="line"><a name="l09161"></a><span class="lineno"> 9161</span>&#160;  <span class="comment">// FIXME: is there such a thing as a truncating indexed store?</span></div><div class="line"><a name="l09162"></a><span class="lineno"> 9162</span>&#160;  <span class="keywordflow">if</span> (ST-&gt;<a class="code" href="classllvm_1_1StoreSDNode.html#a272cb283a679298b7e991db7daf823ed">isTruncatingStore</a>() &amp;&amp; ST-&gt;<a class="code" href="classllvm_1_1LSBaseSDNode.html#a958114b87bff3b4db5ae7766d44dc375">isUnindexed</a>() &amp;&amp;</div><div class="line"><a name="l09163"></a><span class="lineno"> 9163</span>&#160;      Value.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>().<a class="code" href="structllvm_1_1EVT.html#a8cc407ac00df4edd4ec4d5168d6ecb26">isInteger</a>()) {</div><div class="line"><a name="l09164"></a><span class="lineno"> 9164</span>&#160;    <span class="comment">// See if we can simplify the input to this truncstore with knowledge that</span></div><div class="line"><a name="l09165"></a><span class="lineno"> 9165</span>&#160;    <span class="comment">// only the low bits are being used.  For example:</span></div><div class="line"><a name="l09166"></a><span class="lineno"> 9166</span>&#160;    <span class="comment">// &quot;truncstore (or (shl x, 8), y), i8&quot;  -&gt; &quot;truncstore y, i8&quot;</span></div><div class="line"><a name="l09167"></a><span class="lineno"> 9167</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Shorter =</div><div class="line"><a name="l09168"></a><span class="lineno"> 9168</span>&#160;      GetDemandedBits(Value,</div><div class="line"><a name="l09169"></a><span class="lineno"> 9169</span>&#160;                      <a class="code" href="classllvm_1_1APInt.html#ad960e1ff48d25c382b6d28e7961f074e">APInt::getLowBitsSet</a>(</div><div class="line"><a name="l09170"></a><span class="lineno"> 9170</span>&#160;                        Value.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>().<a class="code" href="structllvm_1_1EVT.html#a15be9767d0aad93fe5dcb60b7b7a78da">getScalarType</a>().<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>(),</div><div class="line"><a name="l09171"></a><span class="lineno"> 9171</span>&#160;                        ST-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a7cead3a2a7771e61083bcc6959915a13">getMemoryVT</a>().<a class="code" href="structllvm_1_1EVT.html#a15be9767d0aad93fe5dcb60b7b7a78da">getScalarType</a>().<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>()));</div><div class="line"><a name="l09172"></a><span class="lineno"> 9172</span>&#160;    AddToWorkList(Value.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l09173"></a><span class="lineno"> 9173</span>&#160;    <span class="keywordflow">if</span> (Shorter.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>())</div><div class="line"><a name="l09174"></a><span class="lineno"> 9174</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a76ccaa8c8885072ba11aee5133865e36">getTruncStore</a>(Chain, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), Shorter,</div><div class="line"><a name="l09175"></a><span class="lineno"> 9175</span>&#160;                               Ptr, ST-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a7cead3a2a7771e61083bcc6959915a13">getMemoryVT</a>(), ST-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a89e2b5e3fb867b4040f893c6ae3d2132">getMemOperand</a>());</div><div class="line"><a name="l09176"></a><span class="lineno"> 9176</span>&#160;</div><div class="line"><a name="l09177"></a><span class="lineno"> 9177</span>&#160;    <span class="comment">// Otherwise, see if we can simplify the operation with</span></div><div class="line"><a name="l09178"></a><span class="lineno"> 9178</span>&#160;    <span class="comment">// SimplifyDemandedBits, which only works if the value has a single use.</span></div><div class="line"><a name="l09179"></a><span class="lineno"> 9179</span>&#160;    <span class="keywordflow">if</span> (SimplifyDemandedBits(Value,</div><div class="line"><a name="l09180"></a><span class="lineno"> 9180</span>&#160;                        <a class="code" href="classllvm_1_1APInt.html#ad960e1ff48d25c382b6d28e7961f074e">APInt::getLowBitsSet</a>(</div><div class="line"><a name="l09181"></a><span class="lineno"> 9181</span>&#160;                          Value.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>().<a class="code" href="structllvm_1_1EVT.html#a15be9767d0aad93fe5dcb60b7b7a78da">getScalarType</a>().<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>(),</div><div class="line"><a name="l09182"></a><span class="lineno"> 9182</span>&#160;                          ST-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a7cead3a2a7771e61083bcc6959915a13">getMemoryVT</a>().<a class="code" href="structllvm_1_1EVT.html#a15be9767d0aad93fe5dcb60b7b7a78da">getScalarType</a>().<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>())))</div><div class="line"><a name="l09183"></a><span class="lineno"> 9183</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(N, 0);</div><div class="line"><a name="l09184"></a><span class="lineno"> 9184</span>&#160;  }</div><div class="line"><a name="l09185"></a><span class="lineno"> 9185</span>&#160;</div><div class="line"><a name="l09186"></a><span class="lineno"> 9186</span>&#160;  <span class="comment">// If this is a load followed by a store to the same location, then the store</span></div><div class="line"><a name="l09187"></a><span class="lineno"> 9187</span>&#160;  <span class="comment">// is dead/noop.</span></div><div class="line"><a name="l09188"></a><span class="lineno"> 9188</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1LoadSDNode.html">LoadSDNode</a> *Ld = dyn_cast&lt;LoadSDNode&gt;(Value)) {</div><div class="line"><a name="l09189"></a><span class="lineno"> 9189</span>&#160;    <span class="keywordflow">if</span> (Ld-&gt;getBasePtr() == Ptr &amp;&amp; ST-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a7cead3a2a7771e61083bcc6959915a13">getMemoryVT</a>() == Ld-&gt;getMemoryVT() &amp;&amp;</div><div class="line"><a name="l09190"></a><span class="lineno"> 9190</span>&#160;        ST-&gt;<a class="code" href="classllvm_1_1LSBaseSDNode.html#a958114b87bff3b4db5ae7766d44dc375">isUnindexed</a>() &amp;&amp; !ST-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#acd3bb9ee2ec53fa4be1fdf155b0b5a17">isVolatile</a>() &amp;&amp;</div><div class="line"><a name="l09191"></a><span class="lineno"> 9191</span>&#160;        <span class="comment">// There can&#39;t be any side effects between the load and store, such as</span></div><div class="line"><a name="l09192"></a><span class="lineno"> 9192</span>&#160;        <span class="comment">// a call or store.</span></div><div class="line"><a name="l09193"></a><span class="lineno"> 9193</span>&#160;        Chain.reachesChainWithoutSideEffects(<a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(Ld, 1))) {</div><div class="line"><a name="l09194"></a><span class="lineno"> 9194</span>&#160;      <span class="comment">// The store is dead, remove it.</span></div><div class="line"><a name="l09195"></a><span class="lineno"> 9195</span>&#160;      <span class="keywordflow">return</span> Chain;</div><div class="line"><a name="l09196"></a><span class="lineno"> 9196</span>&#160;    }</div><div class="line"><a name="l09197"></a><span class="lineno"> 9197</span>&#160;  }</div><div class="line"><a name="l09198"></a><span class="lineno"> 9198</span>&#160;</div><div class="line"><a name="l09199"></a><span class="lineno"> 9199</span>&#160;  <span class="comment">// If this is an FP_ROUND or TRUNC followed by a store, fold this into a</span></div><div class="line"><a name="l09200"></a><span class="lineno"> 9200</span>&#160;  <span class="comment">// truncating store.  We can do this even if this is already a truncstore.</span></div><div class="line"><a name="l09201"></a><span class="lineno"> 9201</span>&#160;  <span class="keywordflow">if</span> ((Value.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110adaf9a3cb5c2ef5eb713bd6bf4ae23aeb">ISD::FP_ROUND</a> || Value.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ae690127648393001a7d5b93dc23da7b3">ISD::TRUNCATE</a>)</div><div class="line"><a name="l09202"></a><span class="lineno"> 9202</span>&#160;      &amp;&amp; Value.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()-&gt;<a class="code" href="classllvm_1_1SDNode.html#a52753947fce3a01b1c18dd4713c587e8">hasOneUse</a>() &amp;&amp; ST-&gt;<a class="code" href="classllvm_1_1LSBaseSDNode.html#a958114b87bff3b4db5ae7766d44dc375">isUnindexed</a>() &amp;&amp;</div><div class="line"><a name="l09203"></a><span class="lineno"> 9203</span>&#160;      TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#aaf6cf7bea7d0293cd174427f2ba6f50f">isTruncStoreLegal</a>(Value.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>(),</div><div class="line"><a name="l09204"></a><span class="lineno"> 9204</span>&#160;                            ST-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a7cead3a2a7771e61083bcc6959915a13">getMemoryVT</a>())) {</div><div class="line"><a name="l09205"></a><span class="lineno"> 9205</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a76ccaa8c8885072ba11aee5133865e36">getTruncStore</a>(Chain, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), Value.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0),</div><div class="line"><a name="l09206"></a><span class="lineno"> 9206</span>&#160;                             Ptr, ST-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a7cead3a2a7771e61083bcc6959915a13">getMemoryVT</a>(), ST-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a89e2b5e3fb867b4040f893c6ae3d2132">getMemOperand</a>());</div><div class="line"><a name="l09207"></a><span class="lineno"> 9207</span>&#160;  }</div><div class="line"><a name="l09208"></a><span class="lineno"> 9208</span>&#160;</div><div class="line"><a name="l09209"></a><span class="lineno"> 9209</span>&#160;  <span class="comment">// Only perform this optimization before the types are legal, because we</span></div><div class="line"><a name="l09210"></a><span class="lineno"> 9210</span>&#160;  <span class="comment">// don&#39;t want to perform this optimization on every DAGCombine invocation.</span></div><div class="line"><a name="l09211"></a><span class="lineno"> 9211</span>&#160;  <span class="keywordflow">if</span> (!LegalTypes) {</div><div class="line"><a name="l09212"></a><span class="lineno"> 9212</span>&#160;    <span class="keywordtype">bool</span> EverChanged = <span class="keyword">false</span>;</div><div class="line"><a name="l09213"></a><span class="lineno"> 9213</span>&#160;</div><div class="line"><a name="l09214"></a><span class="lineno"> 9214</span>&#160;    <span class="keywordflow">do</span> {</div><div class="line"><a name="l09215"></a><span class="lineno"> 9215</span>&#160;      <span class="comment">// There can be multiple store sequences on the same chain.</span></div><div class="line"><a name="l09216"></a><span class="lineno"> 9216</span>&#160;      <span class="comment">// Keep trying to merge store sequences until we are unable to do so</span></div><div class="line"><a name="l09217"></a><span class="lineno"> 9217</span>&#160;      <span class="comment">// or until we merge the last store on the chain.</span></div><div class="line"><a name="l09218"></a><span class="lineno"> 9218</span>&#160;      <span class="keywordtype">bool</span> Changed = MergeConsecutiveStores(ST);</div><div class="line"><a name="l09219"></a><span class="lineno"> 9219</span>&#160;      EverChanged |= Changed;</div><div class="line"><a name="l09220"></a><span class="lineno"> 9220</span>&#160;      <span class="keywordflow">if</span> (!Changed) <span class="keywordflow">break</span>;</div><div class="line"><a name="l09221"></a><span class="lineno"> 9221</span>&#160;    } <span class="keywordflow">while</span> (ST-&gt;<a class="code" href="classllvm_1_1SDNode.html#af0d328f3f61168f4ea7d6e4044af4f97">getOpcode</a>() != <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a062083eb3ff8c441c73d3bf42ca09bba">ISD::DELETED_NODE</a>);</div><div class="line"><a name="l09222"></a><span class="lineno"> 9222</span>&#160;</div><div class="line"><a name="l09223"></a><span class="lineno"> 9223</span>&#160;    <span class="keywordflow">if</span> (EverChanged)</div><div class="line"><a name="l09224"></a><span class="lineno"> 9224</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(N, 0);</div><div class="line"><a name="l09225"></a><span class="lineno"> 9225</span>&#160;  }</div><div class="line"><a name="l09226"></a><span class="lineno"> 9226</span>&#160;</div><div class="line"><a name="l09227"></a><span class="lineno"> 9227</span>&#160;  <span class="keywordflow">return</span> ReduceLoadOpStoreWidth(N);</div><div class="line"><a name="l09228"></a><span class="lineno"> 9228</span>&#160;}</div><div class="line"><a name="l09229"></a><span class="lineno"> 9229</span>&#160;</div><div class="line"><a name="l09230"></a><span class="lineno"> 9230</span>&#160;<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::visitINSERT_VECTOR_ELT(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N) {</div><div class="line"><a name="l09231"></a><span class="lineno"> 9231</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> InVec = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0);</div><div class="line"><a name="l09232"></a><span class="lineno"> 9232</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> InVal = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(1);</div><div class="line"><a name="l09233"></a><span class="lineno"> 9233</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> EltNo = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(2);</div><div class="line"><a name="l09234"></a><span class="lineno"> 9234</span>&#160;  <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a> dl(N);</div><div class="line"><a name="l09235"></a><span class="lineno"> 9235</span>&#160;</div><div class="line"><a name="l09236"></a><span class="lineno"> 9236</span>&#160;  <span class="comment">// If the inserted element is an UNDEF, just use the input vector.</span></div><div class="line"><a name="l09237"></a><span class="lineno"> 9237</span>&#160;  <span class="keywordflow">if</span> (InVal.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7c6d8f265e9e16e5debdb9a536b55d3d">ISD::UNDEF</a>)</div><div class="line"><a name="l09238"></a><span class="lineno"> 9238</span>&#160;    <span class="keywordflow">return</span> InVec;</div><div class="line"><a name="l09239"></a><span class="lineno"> 9239</span>&#160;</div><div class="line"><a name="l09240"></a><span class="lineno"> 9240</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> VT = InVec.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>();</div><div class="line"><a name="l09241"></a><span class="lineno"> 9241</span>&#160;</div><div class="line"><a name="l09242"></a><span class="lineno"> 9242</span>&#160;  <span class="comment">// If we can&#39;t generate a legal BUILD_VECTOR, exit</span></div><div class="line"><a name="l09243"></a><span class="lineno"> 9243</span>&#160;  <span class="keywordflow">if</span> (LegalOperations &amp;&amp; !TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a055b3905dbbc16fae11510b9ebd1e00c">isOperationLegal</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110aff6f73b624fecca7dbe94259f9437e32">ISD::BUILD_VECTOR</a>, VT))</div><div class="line"><a name="l09244"></a><span class="lineno"> 9244</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l09245"></a><span class="lineno"> 9245</span>&#160;</div><div class="line"><a name="l09246"></a><span class="lineno"> 9246</span>&#160;  <span class="comment">// Check that we know which element is being inserted</span></div><div class="line"><a name="l09247"></a><span class="lineno"> 9247</span>&#160;  <span class="keywordflow">if</span> (!isa&lt;ConstantSDNode&gt;(EltNo))</div><div class="line"><a name="l09248"></a><span class="lineno"> 9248</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l09249"></a><span class="lineno"> 9249</span>&#160;  <span class="keywordtype">unsigned</span> Elt = cast&lt;ConstantSDNode&gt;(EltNo)-&gt;getZExtValue();</div><div class="line"><a name="l09250"></a><span class="lineno"> 9250</span>&#160;</div><div class="line"><a name="l09251"></a><span class="lineno"> 9251</span>&#160;  <span class="comment">// Check that the operand is a BUILD_VECTOR (or UNDEF, which can essentially</span></div><div class="line"><a name="l09252"></a><span class="lineno"> 9252</span>&#160;  <span class="comment">// be converted to a BUILD_VECTOR).  Fill in the Ops vector with the</span></div><div class="line"><a name="l09253"></a><span class="lineno"> 9253</span>&#160;  <span class="comment">// vector elements.</span></div><div class="line"><a name="l09254"></a><span class="lineno"> 9254</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;SDValue, 8&gt;</a> Ops;</div><div class="line"><a name="l09255"></a><span class="lineno"> 9255</span>&#160;  <span class="comment">// Do not combine these two vectors if the output vector will not replace</span></div><div class="line"><a name="l09256"></a><span class="lineno"> 9256</span>&#160;  <span class="comment">// the input vector.</span></div><div class="line"><a name="l09257"></a><span class="lineno"> 9257</span>&#160;  <span class="keywordflow">if</span> (InVec.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110aff6f73b624fecca7dbe94259f9437e32">ISD::BUILD_VECTOR</a> &amp;&amp; InVec.<a class="code" href="classllvm_1_1SDValue.html#a97b0f24f3e52f030830fca6fbfcbd37d">hasOneUse</a>()) {</div><div class="line"><a name="l09258"></a><span class="lineno"> 9258</span>&#160;    Ops.<a class="code" href="classllvm_1_1SmallVectorImpl.html#a669d55980a7d4b6307b94596deeb0b1f">append</a>(InVec.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()-&gt;<a class="code" href="classllvm_1_1SDNode.html#a20f382e841761654032bf8b4712e805f">op_begin</a>(),</div><div class="line"><a name="l09259"></a><span class="lineno"> 9259</span>&#160;               InVec.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()-&gt;<a class="code" href="classllvm_1_1SDNode.html#a992906781101abb22f6e4d16622bbe24">op_end</a>());</div><div class="line"><a name="l09260"></a><span class="lineno"> 9260</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (InVec.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7c6d8f265e9e16e5debdb9a536b55d3d">ISD::UNDEF</a>) {</div><div class="line"><a name="l09261"></a><span class="lineno"> 9261</span>&#160;    <span class="keywordtype">unsigned</span> NElts = VT.<a class="code" href="structllvm_1_1EVT.html#a42bca41d2438197c12b6db2c710a959c">getVectorNumElements</a>();</div><div class="line"><a name="l09262"></a><span class="lineno"> 9262</span>&#160;    Ops.<a class="code" href="classllvm_1_1SmallVectorImpl.html#a669d55980a7d4b6307b94596deeb0b1f">append</a>(NElts, DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a5b0e59823444a55c295af279611a9d24">getUNDEF</a>(InVal.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>()));</div><div class="line"><a name="l09263"></a><span class="lineno"> 9263</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l09264"></a><span class="lineno"> 9264</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l09265"></a><span class="lineno"> 9265</span>&#160;  }</div><div class="line"><a name="l09266"></a><span class="lineno"> 9266</span>&#160;</div><div class="line"><a name="l09267"></a><span class="lineno"> 9267</span>&#160;  <span class="comment">// Insert the element</span></div><div class="line"><a name="l09268"></a><span class="lineno"> 9268</span>&#160;  <span class="keywordflow">if</span> (Elt &lt; Ops.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#a22a311dfe4c28a897de8a9365a4f0a84">size</a>()) {</div><div class="line"><a name="l09269"></a><span class="lineno"> 9269</span>&#160;    <span class="comment">// All the operands of BUILD_VECTOR must have the same type;</span></div><div class="line"><a name="l09270"></a><span class="lineno"> 9270</span>&#160;    <span class="comment">// we enforce that here.</span></div><div class="line"><a name="l09271"></a><span class="lineno"> 9271</span>&#160;    <a class="code" href="structllvm_1_1EVT.html">EVT</a> OpVT = Ops[0].getValueType();</div><div class="line"><a name="l09272"></a><span class="lineno"> 9272</span>&#160;    <span class="keywordflow">if</span> (InVal.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>() != OpVT)</div><div class="line"><a name="l09273"></a><span class="lineno"> 9273</span>&#160;      InVal = OpVT.<a class="code" href="structllvm_1_1EVT.html#ac267a86695d58fe541ef96f8c60c1b0f">bitsGT</a>(InVal.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>()) ?</div><div class="line"><a name="l09274"></a><span class="lineno"> 9274</span>&#160;                DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a27d5d8ef82302b739ba3ca8be1a5513d">ISD::ANY_EXTEND</a>, dl, OpVT, InVal) :</div><div class="line"><a name="l09275"></a><span class="lineno"> 9275</span>&#160;                DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ae690127648393001a7d5b93dc23da7b3">ISD::TRUNCATE</a>, dl, OpVT, InVal);</div><div class="line"><a name="l09276"></a><span class="lineno"> 9276</span>&#160;    Ops[Elt] = InVal;</div><div class="line"><a name="l09277"></a><span class="lineno"> 9277</span>&#160;  }</div><div class="line"><a name="l09278"></a><span class="lineno"> 9278</span>&#160;</div><div class="line"><a name="l09279"></a><span class="lineno"> 9279</span>&#160;  <span class="comment">// Return the new vector</span></div><div class="line"><a name="l09280"></a><span class="lineno"> 9280</span>&#160;  <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110aff6f73b624fecca7dbe94259f9437e32">ISD::BUILD_VECTOR</a>, dl,</div><div class="line"><a name="l09281"></a><span class="lineno"> 9281</span>&#160;                     VT, &amp;Ops[0], Ops.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#a22a311dfe4c28a897de8a9365a4f0a84">size</a>());</div><div class="line"><a name="l09282"></a><span class="lineno"> 9282</span>&#160;}</div><div class="line"><a name="l09283"></a><span class="lineno"> 9283</span>&#160;</div><div class="line"><a name="l09284"></a><span class="lineno"> 9284</span>&#160;<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::visitEXTRACT_VECTOR_ELT(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N) {</div><div class="line"><a name="l09285"></a><span class="lineno"> 9285</span>&#160;  <span class="comment">// (vextract (scalar_to_vector val, 0) -&gt; val</span></div><div class="line"><a name="l09286"></a><span class="lineno"> 9286</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> InVec = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0);</div><div class="line"><a name="l09287"></a><span class="lineno"> 9287</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> VT = InVec.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>();</div><div class="line"><a name="l09288"></a><span class="lineno"> 9288</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> NVT = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(0);</div><div class="line"><a name="l09289"></a><span class="lineno"> 9289</span>&#160;</div><div class="line"><a name="l09290"></a><span class="lineno"> 9290</span>&#160;  <span class="keywordflow">if</span> (InVec.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a576080a08ef1bbab0308eac9d5838f75">ISD::SCALAR_TO_VECTOR</a>) {</div><div class="line"><a name="l09291"></a><span class="lineno"> 9291</span>&#160;    <span class="comment">// Check if the result type doesn&#39;t match the inserted element type. A</span></div><div class="line"><a name="l09292"></a><span class="lineno"> 9292</span>&#160;    <span class="comment">// SCALAR_TO_VECTOR may truncate the inserted element and the</span></div><div class="line"><a name="l09293"></a><span class="lineno"> 9293</span>&#160;    <span class="comment">// EXTRACT_VECTOR_ELT may widen the extracted vector.</span></div><div class="line"><a name="l09294"></a><span class="lineno"> 9294</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> InOp = InVec.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0);</div><div class="line"><a name="l09295"></a><span class="lineno"> 9295</span>&#160;    <span class="keywordflow">if</span> (InOp.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>() != NVT) {</div><div class="line"><a name="l09296"></a><span class="lineno"> 9296</span>&#160;      assert(InOp.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>().<a class="code" href="structllvm_1_1EVT.html#a8cc407ac00df4edd4ec4d5168d6ecb26">isInteger</a>() &amp;&amp; NVT.<a class="code" href="structllvm_1_1EVT.html#a8cc407ac00df4edd4ec4d5168d6ecb26">isInteger</a>());</div><div class="line"><a name="l09297"></a><span class="lineno"> 9297</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a4c2e9947586d4e88ad61174b796a40d1">getSExtOrTrunc</a>(InOp, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(InVec), NVT);</div><div class="line"><a name="l09298"></a><span class="lineno"> 9298</span>&#160;    }</div><div class="line"><a name="l09299"></a><span class="lineno"> 9299</span>&#160;    <span class="keywordflow">return</span> InOp;</div><div class="line"><a name="l09300"></a><span class="lineno"> 9300</span>&#160;  }</div><div class="line"><a name="l09301"></a><span class="lineno"> 9301</span>&#160;</div><div class="line"><a name="l09302"></a><span class="lineno"> 9302</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> EltNo = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(1);</div><div class="line"><a name="l09303"></a><span class="lineno"> 9303</span>&#160;  <span class="keywordtype">bool</span> ConstEltNo = isa&lt;ConstantSDNode&gt;(EltNo);</div><div class="line"><a name="l09304"></a><span class="lineno"> 9304</span>&#160;</div><div class="line"><a name="l09305"></a><span class="lineno"> 9305</span>&#160;  <span class="comment">// Transform: (EXTRACT_VECTOR_ELT( VECTOR_SHUFFLE )) -&gt; EXTRACT_VECTOR_ELT.</span></div><div class="line"><a name="l09306"></a><span class="lineno"> 9306</span>&#160;  <span class="comment">// We only perform this optimization before the op legalization phase because</span></div><div class="line"><a name="l09307"></a><span class="lineno"> 9307</span>&#160;  <span class="comment">// we may introduce new vector instructions which are not backed by TD</span></div><div class="line"><a name="l09308"></a><span class="lineno"> 9308</span>&#160;  <span class="comment">// patterns. For example on AVX, extracting elements from a wide vector</span></div><div class="line"><a name="l09309"></a><span class="lineno"> 9309</span>&#160;  <span class="comment">// without using extract_subvector.</span></div><div class="line"><a name="l09310"></a><span class="lineno"> 9310</span>&#160;  <span class="keywordflow">if</span> (InVec.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a8d8773b28111d8898663d4a0f6223d68">ISD::VECTOR_SHUFFLE</a></div><div class="line"><a name="l09311"></a><span class="lineno"> 9311</span>&#160;      &amp;&amp; ConstEltNo &amp;&amp; !LegalOperations) {</div><div class="line"><a name="l09312"></a><span class="lineno"> 9312</span>&#160;    <span class="keywordtype">int</span> Elt = cast&lt;ConstantSDNode&gt;(EltNo)-&gt;getZExtValue();</div><div class="line"><a name="l09313"></a><span class="lineno"> 9313</span>&#160;    <span class="keywordtype">int</span> NumElem = VT.<a class="code" href="structllvm_1_1EVT.html#a42bca41d2438197c12b6db2c710a959c">getVectorNumElements</a>();</div><div class="line"><a name="l09314"></a><span class="lineno"> 9314</span>&#160;    <a class="code" href="classllvm_1_1ShuffleVectorSDNode.html">ShuffleVectorSDNode</a> *SVOp = cast&lt;ShuffleVectorSDNode&gt;(InVec);</div><div class="line"><a name="l09315"></a><span class="lineno"> 9315</span>&#160;    <span class="comment">// Find the new index to extract from.</span></div><div class="line"><a name="l09316"></a><span class="lineno"> 9316</span>&#160;    <span class="keywordtype">int</span> OrigElt = SVOp-&gt;<a class="code" href="classllvm_1_1ShuffleVectorSDNode.html#aae5468704c119f87dceb6728814b5502">getMaskElt</a>(Elt);</div><div class="line"><a name="l09317"></a><span class="lineno"> 9317</span>&#160;</div><div class="line"><a name="l09318"></a><span class="lineno"> 9318</span>&#160;    <span class="comment">// Extracting an undef index is undef.</span></div><div class="line"><a name="l09319"></a><span class="lineno"> 9319</span>&#160;    <span class="keywordflow">if</span> (OrigElt == -1)</div><div class="line"><a name="l09320"></a><span class="lineno"> 9320</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a5b0e59823444a55c295af279611a9d24">getUNDEF</a>(NVT);</div><div class="line"><a name="l09321"></a><span class="lineno"> 9321</span>&#160;</div><div class="line"><a name="l09322"></a><span class="lineno"> 9322</span>&#160;    <span class="comment">// Select the right vector half to extract from.</span></div><div class="line"><a name="l09323"></a><span class="lineno"> 9323</span>&#160;    <span class="keywordflow">if</span> (OrigElt &lt; NumElem) {</div><div class="line"><a name="l09324"></a><span class="lineno"> 9324</span>&#160;      InVec = InVec-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0);</div><div class="line"><a name="l09325"></a><span class="lineno"> 9325</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l09326"></a><span class="lineno"> 9326</span>&#160;      InVec = InVec-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(1);</div><div class="line"><a name="l09327"></a><span class="lineno"> 9327</span>&#160;      OrigElt -= NumElem;</div><div class="line"><a name="l09328"></a><span class="lineno"> 9328</span>&#160;    }</div><div class="line"><a name="l09329"></a><span class="lineno"> 9329</span>&#160;</div><div class="line"><a name="l09330"></a><span class="lineno"> 9330</span>&#160;    <a class="code" href="structllvm_1_1EVT.html">EVT</a> IndexTy = TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a867f81380094404dbe04ed9b7bc26a99">getVectorIdxTy</a>();</div><div class="line"><a name="l09331"></a><span class="lineno"> 9331</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9329e79f62e9ab9b41cfbcafd314bcbd">ISD::EXTRACT_VECTOR_ELT</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), NVT,</div><div class="line"><a name="l09332"></a><span class="lineno"> 9332</span>&#160;                       InVec, DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(OrigElt, IndexTy));</div><div class="line"><a name="l09333"></a><span class="lineno"> 9333</span>&#160;  }</div><div class="line"><a name="l09334"></a><span class="lineno"> 9334</span>&#160;</div><div class="line"><a name="l09335"></a><span class="lineno"> 9335</span>&#160;  <span class="comment">// Perform only after legalization to ensure build_vector / vector_shuffle</span></div><div class="line"><a name="l09336"></a><span class="lineno"> 9336</span>&#160;  <span class="comment">// optimizations have already been done.</span></div><div class="line"><a name="l09337"></a><span class="lineno"> 9337</span>&#160;  <span class="keywordflow">if</span> (!LegalOperations) <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l09338"></a><span class="lineno"> 9338</span>&#160;</div><div class="line"><a name="l09339"></a><span class="lineno"> 9339</span>&#160;  <span class="comment">// (vextract (v4f32 load $addr), c) -&gt; (f32 load $addr+c*size)</span></div><div class="line"><a name="l09340"></a><span class="lineno"> 9340</span>&#160;  <span class="comment">// (vextract (v4f32 s2v (f32 load $addr)), c) -&gt; (f32 load $addr+c*size)</span></div><div class="line"><a name="l09341"></a><span class="lineno"> 9341</span>&#160;  <span class="comment">// (vextract (v4f32 shuffle (load $addr), &lt;1,u,u,u&gt;), 0) -&gt; (f32 load $addr)</span></div><div class="line"><a name="l09342"></a><span class="lineno"> 9342</span>&#160;</div><div class="line"><a name="l09343"></a><span class="lineno"> 9343</span>&#160;  <span class="keywordflow">if</span> (ConstEltNo) {</div><div class="line"><a name="l09344"></a><span class="lineno"> 9344</span>&#160;    <span class="keywordtype">int</span> Elt = cast&lt;ConstantSDNode&gt;(EltNo)-&gt;getZExtValue();</div><div class="line"><a name="l09345"></a><span class="lineno"> 9345</span>&#160;    <span class="keywordtype">bool</span> NewLoad = <span class="keyword">false</span>;</div><div class="line"><a name="l09346"></a><span class="lineno"> 9346</span>&#160;    <span class="keywordtype">bool</span> BCNumEltsChanged = <span class="keyword">false</span>;</div><div class="line"><a name="l09347"></a><span class="lineno"> 9347</span>&#160;    <a class="code" href="structllvm_1_1EVT.html">EVT</a> ExtVT = VT.<a class="code" href="structllvm_1_1EVT.html#a3a07c062cc9330acd8e8c4e3930cbb25">getVectorElementType</a>();</div><div class="line"><a name="l09348"></a><span class="lineno"> 9348</span>&#160;    <a class="code" href="structllvm_1_1EVT.html">EVT</a> LVT = ExtVT;</div><div class="line"><a name="l09349"></a><span class="lineno"> 9349</span>&#160;</div><div class="line"><a name="l09350"></a><span class="lineno"> 9350</span>&#160;    <span class="comment">// If the result of load has to be truncated, then it&#39;s not necessarily</span></div><div class="line"><a name="l09351"></a><span class="lineno"> 9351</span>&#160;    <span class="comment">// profitable.</span></div><div class="line"><a name="l09352"></a><span class="lineno"> 9352</span>&#160;    <span class="keywordflow">if</span> (NVT.<a class="code" href="structllvm_1_1EVT.html#a5ebe5227fe53e0dcf4102a6ebf1594a2">bitsLT</a>(LVT) &amp;&amp; !TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a00856c52a5a67b38d8332c7842429153">isTruncateFree</a>(LVT, NVT))</div><div class="line"><a name="l09353"></a><span class="lineno"> 9353</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l09354"></a><span class="lineno"> 9354</span>&#160;</div><div class="line"><a name="l09355"></a><span class="lineno"> 9355</span>&#160;    <span class="keywordflow">if</span> (InVec.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a412ddf522b53f07690a86bffba1278e7">ISD::BITCAST</a>) {</div><div class="line"><a name="l09356"></a><span class="lineno"> 9356</span>&#160;      <span class="comment">// Don&#39;t duplicate a load with other uses.</span></div><div class="line"><a name="l09357"></a><span class="lineno"> 9357</span>&#160;      <span class="keywordflow">if</span> (!InVec.<a class="code" href="classllvm_1_1SDValue.html#a97b0f24f3e52f030830fca6fbfcbd37d">hasOneUse</a>())</div><div class="line"><a name="l09358"></a><span class="lineno"> 9358</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l09359"></a><span class="lineno"> 9359</span>&#160;</div><div class="line"><a name="l09360"></a><span class="lineno"> 9360</span>&#160;      <a class="code" href="structllvm_1_1EVT.html">EVT</a> BCVT = InVec.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>();</div><div class="line"><a name="l09361"></a><span class="lineno"> 9361</span>&#160;      <span class="keywordflow">if</span> (!BCVT.<a class="code" href="structllvm_1_1EVT.html#a73f7c824cad61a47c21bf6d652ae2fd7">isVector</a>() || ExtVT.<a class="code" href="structllvm_1_1EVT.html#ac267a86695d58fe541ef96f8c60c1b0f">bitsGT</a>(BCVT.<a class="code" href="structllvm_1_1EVT.html#a3a07c062cc9330acd8e8c4e3930cbb25">getVectorElementType</a>()))</div><div class="line"><a name="l09362"></a><span class="lineno"> 9362</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l09363"></a><span class="lineno"> 9363</span>&#160;      <span class="keywordflow">if</span> (VT.<a class="code" href="structllvm_1_1EVT.html#a42bca41d2438197c12b6db2c710a959c">getVectorNumElements</a>() != BCVT.<a class="code" href="structllvm_1_1EVT.html#a42bca41d2438197c12b6db2c710a959c">getVectorNumElements</a>())</div><div class="line"><a name="l09364"></a><span class="lineno"> 9364</span>&#160;        BCNumEltsChanged = <span class="keyword">true</span>;</div><div class="line"><a name="l09365"></a><span class="lineno"> 9365</span>&#160;      InVec = InVec.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0);</div><div class="line"><a name="l09366"></a><span class="lineno"> 9366</span>&#160;      ExtVT = BCVT.<a class="code" href="structllvm_1_1EVT.html#a3a07c062cc9330acd8e8c4e3930cbb25">getVectorElementType</a>();</div><div class="line"><a name="l09367"></a><span class="lineno"> 9367</span>&#160;      NewLoad = <span class="keyword">true</span>;</div><div class="line"><a name="l09368"></a><span class="lineno"> 9368</span>&#160;    }</div><div class="line"><a name="l09369"></a><span class="lineno"> 9369</span>&#160;</div><div class="line"><a name="l09370"></a><span class="lineno"> 9370</span>&#160;    <a class="code" href="classllvm_1_1LoadSDNode.html">LoadSDNode</a> *LN0 = NULL;</div><div class="line"><a name="l09371"></a><span class="lineno"> 9371</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1ShuffleVectorSDNode.html">ShuffleVectorSDNode</a> *SVN = NULL;</div><div class="line"><a name="l09372"></a><span class="lineno"> 9372</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1ISD.html#afaaeadcd82b42fc0d385a6247bf7bb52">ISD::isNormalLoad</a>(InVec.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>())) {</div><div class="line"><a name="l09373"></a><span class="lineno"> 9373</span>&#160;      LN0 = cast&lt;LoadSDNode&gt;(InVec);</div><div class="line"><a name="l09374"></a><span class="lineno"> 9374</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (InVec.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a576080a08ef1bbab0308eac9d5838f75">ISD::SCALAR_TO_VECTOR</a> &amp;&amp;</div><div class="line"><a name="l09375"></a><span class="lineno"> 9375</span>&#160;               InVec.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>() == ExtVT &amp;&amp;</div><div class="line"><a name="l09376"></a><span class="lineno"> 9376</span>&#160;               <a class="code" href="namespacellvm_1_1ISD.html#afaaeadcd82b42fc0d385a6247bf7bb52">ISD::isNormalLoad</a>(InVec.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>())) {</div><div class="line"><a name="l09377"></a><span class="lineno"> 9377</span>&#160;      <span class="comment">// Don&#39;t duplicate a load with other uses.</span></div><div class="line"><a name="l09378"></a><span class="lineno"> 9378</span>&#160;      <span class="keywordflow">if</span> (!InVec.<a class="code" href="classllvm_1_1SDValue.html#a97b0f24f3e52f030830fca6fbfcbd37d">hasOneUse</a>())</div><div class="line"><a name="l09379"></a><span class="lineno"> 9379</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l09380"></a><span class="lineno"> 9380</span>&#160;</div><div class="line"><a name="l09381"></a><span class="lineno"> 9381</span>&#160;      LN0 = cast&lt;LoadSDNode&gt;(InVec.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0));</div><div class="line"><a name="l09382"></a><span class="lineno"> 9382</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((SVN = dyn_cast&lt;ShuffleVectorSDNode&gt;(InVec))) {</div><div class="line"><a name="l09383"></a><span class="lineno"> 9383</span>&#160;      <span class="comment">// (vextract (vector_shuffle (load $addr), v2, &lt;1, u, u, u&gt;), 1)</span></div><div class="line"><a name="l09384"></a><span class="lineno"> 9384</span>&#160;      <span class="comment">// =&gt;</span></div><div class="line"><a name="l09385"></a><span class="lineno"> 9385</span>&#160;      <span class="comment">// (load $addr+1*size)</span></div><div class="line"><a name="l09386"></a><span class="lineno"> 9386</span>&#160;</div><div class="line"><a name="l09387"></a><span class="lineno"> 9387</span>&#160;      <span class="comment">// Don&#39;t duplicate a load with other uses.</span></div><div class="line"><a name="l09388"></a><span class="lineno"> 9388</span>&#160;      <span class="keywordflow">if</span> (!InVec.<a class="code" href="classllvm_1_1SDValue.html#a97b0f24f3e52f030830fca6fbfcbd37d">hasOneUse</a>())</div><div class="line"><a name="l09389"></a><span class="lineno"> 9389</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l09390"></a><span class="lineno"> 9390</span>&#160;</div><div class="line"><a name="l09391"></a><span class="lineno"> 9391</span>&#160;      <span class="comment">// If the bit convert changed the number of elements, it is unsafe</span></div><div class="line"><a name="l09392"></a><span class="lineno"> 9392</span>&#160;      <span class="comment">// to examine the mask.</span></div><div class="line"><a name="l09393"></a><span class="lineno"> 9393</span>&#160;      <span class="keywordflow">if</span> (BCNumEltsChanged)</div><div class="line"><a name="l09394"></a><span class="lineno"> 9394</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l09395"></a><span class="lineno"> 9395</span>&#160;</div><div class="line"><a name="l09396"></a><span class="lineno"> 9396</span>&#160;      <span class="comment">// Select the input vector, guarding against out of range extract vector.</span></div><div class="line"><a name="l09397"></a><span class="lineno"> 9397</span>&#160;      <span class="keywordtype">unsigned</span> NumElems = VT.<a class="code" href="structllvm_1_1EVT.html#a42bca41d2438197c12b6db2c710a959c">getVectorNumElements</a>();</div><div class="line"><a name="l09398"></a><span class="lineno"> 9398</span>&#160;      <span class="keywordtype">int</span> Idx = (Elt &gt; (<a class="code" href="Target_2README_8txt.html#a3217063f680fa8e35dea3c59b6e52b18">int</a>)NumElems) ? -1 : SVN-&gt;<a class="code" href="classllvm_1_1ShuffleVectorSDNode.html#aae5468704c119f87dceb6728814b5502">getMaskElt</a>(Elt);</div><div class="line"><a name="l09399"></a><span class="lineno"> 9399</span>&#160;      InVec = (Idx &lt; (<a class="code" href="Target_2README_8txt.html#a3217063f680fa8e35dea3c59b6e52b18">int</a>)NumElems) ? InVec.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0) : InVec.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1);</div><div class="line"><a name="l09400"></a><span class="lineno"> 9400</span>&#160;</div><div class="line"><a name="l09401"></a><span class="lineno"> 9401</span>&#160;      <span class="keywordflow">if</span> (InVec.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a412ddf522b53f07690a86bffba1278e7">ISD::BITCAST</a>) {</div><div class="line"><a name="l09402"></a><span class="lineno"> 9402</span>&#160;        <span class="comment">// Don&#39;t duplicate a load with other uses.</span></div><div class="line"><a name="l09403"></a><span class="lineno"> 9403</span>&#160;        <span class="keywordflow">if</span> (!InVec.<a class="code" href="classllvm_1_1SDValue.html#a97b0f24f3e52f030830fca6fbfcbd37d">hasOneUse</a>())</div><div class="line"><a name="l09404"></a><span class="lineno"> 9404</span>&#160;          <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l09405"></a><span class="lineno"> 9405</span>&#160;</div><div class="line"><a name="l09406"></a><span class="lineno"> 9406</span>&#160;        InVec = InVec.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0);</div><div class="line"><a name="l09407"></a><span class="lineno"> 9407</span>&#160;      }</div><div class="line"><a name="l09408"></a><span class="lineno"> 9408</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1ISD.html#afaaeadcd82b42fc0d385a6247bf7bb52">ISD::isNormalLoad</a>(InVec.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>())) {</div><div class="line"><a name="l09409"></a><span class="lineno"> 9409</span>&#160;        LN0 = cast&lt;LoadSDNode&gt;(InVec);</div><div class="line"><a name="l09410"></a><span class="lineno"> 9410</span>&#160;        Elt = (Idx &lt; (<a class="code" href="Target_2README_8txt.html#a3217063f680fa8e35dea3c59b6e52b18">int</a>)NumElems) ? Idx : Idx - (<a class="code" href="Target_2README_8txt.html#a3217063f680fa8e35dea3c59b6e52b18">int</a>)NumElems;</div><div class="line"><a name="l09411"></a><span class="lineno"> 9411</span>&#160;      }</div><div class="line"><a name="l09412"></a><span class="lineno"> 9412</span>&#160;    }</div><div class="line"><a name="l09413"></a><span class="lineno"> 9413</span>&#160;</div><div class="line"><a name="l09414"></a><span class="lineno"> 9414</span>&#160;    <span class="comment">// Make sure we found a non-volatile load and the extractelement is</span></div><div class="line"><a name="l09415"></a><span class="lineno"> 9415</span>&#160;    <span class="comment">// the only use.</span></div><div class="line"><a name="l09416"></a><span class="lineno"> 9416</span>&#160;    <span class="keywordflow">if</span> (!LN0 || !LN0-&gt;<a class="code" href="classllvm_1_1SDNode.html#a51dcb6414be6f4b441df7152e05de8f5">hasNUsesOfValue</a>(1,0) || LN0-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#acd3bb9ee2ec53fa4be1fdf155b0b5a17">isVolatile</a>())</div><div class="line"><a name="l09417"></a><span class="lineno"> 9417</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l09418"></a><span class="lineno"> 9418</span>&#160;</div><div class="line"><a name="l09419"></a><span class="lineno"> 9419</span>&#160;    <span class="comment">// If Idx was -1 above, Elt is going to be -1, so just return undef.</span></div><div class="line"><a name="l09420"></a><span class="lineno"> 9420</span>&#160;    <span class="keywordflow">if</span> (Elt == -1)</div><div class="line"><a name="l09421"></a><span class="lineno"> 9421</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a5b0e59823444a55c295af279611a9d24">getUNDEF</a>(LVT);</div><div class="line"><a name="l09422"></a><span class="lineno"> 9422</span>&#160;</div><div class="line"><a name="l09423"></a><span class="lineno"> 9423</span>&#160;    <span class="keywordtype">unsigned</span> <a class="code" href="ARMSubtarget_8cpp.html#a4bd80d4e433d9f72af26b364036900dc">Align</a> = LN0-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a4f68cd016138440f215ad80c1d6c1e04">getAlignment</a>();</div><div class="line"><a name="l09424"></a><span class="lineno"> 9424</span>&#160;    <span class="keywordflow">if</span> (NewLoad) {</div><div class="line"><a name="l09425"></a><span class="lineno"> 9425</span>&#160;      <span class="comment">// Check the resultant load doesn&#39;t need a higher alignment than the</span></div><div class="line"><a name="l09426"></a><span class="lineno"> 9426</span>&#160;      <span class="comment">// original load.</span></div><div class="line"><a name="l09427"></a><span class="lineno"> 9427</span>&#160;      <span class="keywordtype">unsigned</span> NewAlign =</div><div class="line"><a name="l09428"></a><span class="lineno"> 9428</span>&#160;        TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#adc25bcc279ccfb5b867c2b7b8eedaa9b">getDataLayout</a>()</div><div class="line"><a name="l09429"></a><span class="lineno"> 9429</span>&#160;            -&gt;<a class="code" href="classllvm_1_1DataLayout.html#abb381519d34dcb9ccf673bf7689d0721">getABITypeAlignment</a>(LVT.<a class="code" href="structllvm_1_1EVT.html#a226345d0c8262e9469d30a993d1656ff">getTypeForEVT</a>(*DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a39c6dff47b8dbd25cfaf6336c7056077">getContext</a>()));</div><div class="line"><a name="l09430"></a><span class="lineno"> 9430</span>&#160;</div><div class="line"><a name="l09431"></a><span class="lineno"> 9431</span>&#160;      <span class="keywordflow">if</span> (NewAlign &gt; Align || !TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a087dd0f9650e999b087c17cc7f46f2d0">isOperationLegalOrCustom</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a269b81f007000306e3e69d0d290c2159">ISD::LOAD</a>, LVT))</div><div class="line"><a name="l09432"></a><span class="lineno"> 9432</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l09433"></a><span class="lineno"> 9433</span>&#160;</div><div class="line"><a name="l09434"></a><span class="lineno"> 9434</span>&#160;      Align = NewAlign;</div><div class="line"><a name="l09435"></a><span class="lineno"> 9435</span>&#160;    }</div><div class="line"><a name="l09436"></a><span class="lineno"> 9436</span>&#160;</div><div class="line"><a name="l09437"></a><span class="lineno"> 9437</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> NewPtr = LN0-&gt;<a class="code" href="classllvm_1_1LoadSDNode.html#a3ded48ce66b58b7e7e143991df5dbfae">getBasePtr</a>();</div><div class="line"><a name="l09438"></a><span class="lineno"> 9438</span>&#160;    <span class="keywordtype">unsigned</span> PtrOff = 0;</div><div class="line"><a name="l09439"></a><span class="lineno"> 9439</span>&#160;</div><div class="line"><a name="l09440"></a><span class="lineno"> 9440</span>&#160;    <span class="keywordflow">if</span> (Elt) {</div><div class="line"><a name="l09441"></a><span class="lineno"> 9441</span>&#160;      PtrOff = LVT.<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>() * Elt / 8;</div><div class="line"><a name="l09442"></a><span class="lineno"> 9442</span>&#160;      <a class="code" href="structllvm_1_1EVT.html">EVT</a> PtrType = NewPtr.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>();</div><div class="line"><a name="l09443"></a><span class="lineno"> 9443</span>&#160;      <span class="keywordflow">if</span> (TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a785a8016a792dbc65ec16688f180af71">isBigEndian</a>())</div><div class="line"><a name="l09444"></a><span class="lineno"> 9444</span>&#160;        PtrOff = VT.<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>() / 8 - PtrOff;</div><div class="line"><a name="l09445"></a><span class="lineno"> 9445</span>&#160;      NewPtr = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a269996b43a1f3e1d1f84a70fd4387535">ISD::ADD</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), PtrType, NewPtr,</div><div class="line"><a name="l09446"></a><span class="lineno"> 9446</span>&#160;                           DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(PtrOff, PtrType));</div><div class="line"><a name="l09447"></a><span class="lineno"> 9447</span>&#160;    }</div><div class="line"><a name="l09448"></a><span class="lineno"> 9448</span>&#160;</div><div class="line"><a name="l09449"></a><span class="lineno"> 9449</span>&#160;    <span class="comment">// The replacement we need to do here is a little tricky: we need to</span></div><div class="line"><a name="l09450"></a><span class="lineno"> 9450</span>&#160;    <span class="comment">// replace an extractelement of a load with a load.</span></div><div class="line"><a name="l09451"></a><span class="lineno"> 9451</span>&#160;    <span class="comment">// Use ReplaceAllUsesOfValuesWith to do the replacement.</span></div><div class="line"><a name="l09452"></a><span class="lineno"> 9452</span>&#160;    <span class="comment">// Note that this replacement assumes that the extractvalue is the only</span></div><div class="line"><a name="l09453"></a><span class="lineno"> 9453</span>&#160;    <span class="comment">// use of the load; that&#39;s okay because we don&#39;t want to perform this</span></div><div class="line"><a name="l09454"></a><span class="lineno"> 9454</span>&#160;    <span class="comment">// transformation in other cases anyway.</span></div><div class="line"><a name="l09455"></a><span class="lineno"> 9455</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> <a class="code" href="namespacellvm_1_1SPII.html#a11e9b8fca4a074643a6a21f444e51406a5069619ca8fdce305534f3fe85091a0f">Load</a>;</div><div class="line"><a name="l09456"></a><span class="lineno"> 9456</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Chain;</div><div class="line"><a name="l09457"></a><span class="lineno"> 9457</span>&#160;    <span class="keywordflow">if</span> (NVT.<a class="code" href="structllvm_1_1EVT.html#ac267a86695d58fe541ef96f8c60c1b0f">bitsGT</a>(LVT)) {</div><div class="line"><a name="l09458"></a><span class="lineno"> 9458</span>&#160;      <span class="comment">// If the result type of vextract is wider than the load, then issue an</span></div><div class="line"><a name="l09459"></a><span class="lineno"> 9459</span>&#160;      <span class="comment">// extending load instead.</span></div><div class="line"><a name="l09460"></a><span class="lineno"> 9460</span>&#160;      <a class="code" href="namespacellvm_1_1ISD.html#ad4d48171b87ca51ff54c10a436bac4d7">ISD::LoadExtType</a> ExtType = TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#ad85f712b9e49629c2c160f16521fe91f">isLoadExtLegal</a>(<a class="code" href="namespacellvm_1_1ISD.html#ad4d48171b87ca51ff54c10a436bac4d7a8d89c7da4444d9ec11667aa369abc5f7">ISD::ZEXTLOAD</a>, LVT)</div><div class="line"><a name="l09461"></a><span class="lineno"> 9461</span>&#160;        ? <a class="code" href="namespacellvm_1_1ISD.html#ad4d48171b87ca51ff54c10a436bac4d7a8d89c7da4444d9ec11667aa369abc5f7">ISD::ZEXTLOAD</a> : <a class="code" href="namespacellvm_1_1ISD.html#ad4d48171b87ca51ff54c10a436bac4d7afab3fffd153f7d7770fed81272e4b78f">ISD::EXTLOAD</a>;</div><div class="line"><a name="l09462"></a><span class="lineno"> 9462</span>&#160;      Load = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#ad6ff413bea6f8195d8e6f29f4fc519c4">getExtLoad</a>(ExtType, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), NVT, LN0-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#ae3cb6fbf8c8cb79e10ac61bd98c85211">getChain</a>(),</div><div class="line"><a name="l09463"></a><span class="lineno"> 9463</span>&#160;                            NewPtr, LN0-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a2fa8491ab36125d7f5dd38d3a4868934">getPointerInfo</a>().<a class="code" href="structllvm_1_1MachinePointerInfo.html#aa7b903b38006dd4cb8fcf8854af5b6b9">getWithOffset</a>(PtrOff),</div><div class="line"><a name="l09464"></a><span class="lineno"> 9464</span>&#160;                            LVT, LN0-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#acd3bb9ee2ec53fa4be1fdf155b0b5a17">isVolatile</a>(), LN0-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a967ffaf77f64a5deb1e96951e4224112">isNonTemporal</a>(),</div><div class="line"><a name="l09465"></a><span class="lineno"> 9465</span>&#160;                            <a class="code" href="ARMSubtarget_8cpp.html#a4bd80d4e433d9f72af26b364036900dc">Align</a>, LN0-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a23670ceb5797afa3d45ca1a9b011fd87">getTBAAInfo</a>());</div><div class="line"><a name="l09466"></a><span class="lineno"> 9466</span>&#160;      Chain = Load.<a class="code" href="classllvm_1_1SDValue.html#a040481b9bda32faa6b1435532405d88f">getValue</a>(1);</div><div class="line"><a name="l09467"></a><span class="lineno"> 9467</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l09468"></a><span class="lineno"> 9468</span>&#160;      Load = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#ab8395be5698f080c0036d866e121a478">getLoad</a>(LVT, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), LN0-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#ae3cb6fbf8c8cb79e10ac61bd98c85211">getChain</a>(), NewPtr,</div><div class="line"><a name="l09469"></a><span class="lineno"> 9469</span>&#160;                         LN0-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a2fa8491ab36125d7f5dd38d3a4868934">getPointerInfo</a>().<a class="code" href="structllvm_1_1MachinePointerInfo.html#aa7b903b38006dd4cb8fcf8854af5b6b9">getWithOffset</a>(PtrOff),</div><div class="line"><a name="l09470"></a><span class="lineno"> 9470</span>&#160;                         LN0-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#acd3bb9ee2ec53fa4be1fdf155b0b5a17">isVolatile</a>(), LN0-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a967ffaf77f64a5deb1e96951e4224112">isNonTemporal</a>(),</div><div class="line"><a name="l09471"></a><span class="lineno"> 9471</span>&#160;                         LN0-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#ad8e64770a04af6b3da2099477e7c28de">isInvariant</a>(), <a class="code" href="ARMSubtarget_8cpp.html#a4bd80d4e433d9f72af26b364036900dc">Align</a>, LN0-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a23670ceb5797afa3d45ca1a9b011fd87">getTBAAInfo</a>());</div><div class="line"><a name="l09472"></a><span class="lineno"> 9472</span>&#160;      Chain = Load.<a class="code" href="classllvm_1_1SDValue.html#a040481b9bda32faa6b1435532405d88f">getValue</a>(1);</div><div class="line"><a name="l09473"></a><span class="lineno"> 9473</span>&#160;      <span class="keywordflow">if</span> (NVT.<a class="code" href="structllvm_1_1EVT.html#a5ebe5227fe53e0dcf4102a6ebf1594a2">bitsLT</a>(LVT))</div><div class="line"><a name="l09474"></a><span class="lineno"> 9474</span>&#160;        Load = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ae690127648393001a7d5b93dc23da7b3">ISD::TRUNCATE</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), NVT, Load);</div><div class="line"><a name="l09475"></a><span class="lineno"> 9475</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l09476"></a><span class="lineno"> 9476</span>&#160;        Load = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a412ddf522b53f07690a86bffba1278e7">ISD::BITCAST</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), NVT, Load);</div><div class="line"><a name="l09477"></a><span class="lineno"> 9477</span>&#160;    }</div><div class="line"><a name="l09478"></a><span class="lineno"> 9478</span>&#160;    WorkListRemover DeadNodes(*<span class="keyword">this</span>);</div><div class="line"><a name="l09479"></a><span class="lineno"> 9479</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> From[] = { <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(N, 0), <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(LN0,1) };</div><div class="line"><a name="l09480"></a><span class="lineno"> 9480</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> To[] = { <a class="code" href="namespacellvm_1_1SPII.html#a11e9b8fca4a074643a6a21f444e51406a5069619ca8fdce305534f3fe85091a0f">Load</a>, Chain };</div><div class="line"><a name="l09481"></a><span class="lineno"> 9481</span>&#160;    DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a2869d5459dca008c1c7a1e824e7faf5e">ReplaceAllUsesOfValuesWith</a>(From, To, 2);</div><div class="line"><a name="l09482"></a><span class="lineno"> 9482</span>&#160;    <span class="comment">// Since we&#39;re explcitly calling ReplaceAllUses, add the new node to the</span></div><div class="line"><a name="l09483"></a><span class="lineno"> 9483</span>&#160;    <span class="comment">// worklist explicitly as well.</span></div><div class="line"><a name="l09484"></a><span class="lineno"> 9484</span>&#160;    AddToWorkList(Load.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l09485"></a><span class="lineno"> 9485</span>&#160;    AddUsersToWorkList(Load.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()); <span class="comment">// Add users too</span></div><div class="line"><a name="l09486"></a><span class="lineno"> 9486</span>&#160;    <span class="comment">// Make sure to revisit this node to clean it up; it will usually be dead.</span></div><div class="line"><a name="l09487"></a><span class="lineno"> 9487</span>&#160;    AddToWorkList(N);</div><div class="line"><a name="l09488"></a><span class="lineno"> 9488</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(N, 0);</div><div class="line"><a name="l09489"></a><span class="lineno"> 9489</span>&#160;  }</div><div class="line"><a name="l09490"></a><span class="lineno"> 9490</span>&#160;</div><div class="line"><a name="l09491"></a><span class="lineno"> 9491</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l09492"></a><span class="lineno"> 9492</span>&#160;}</div><div class="line"><a name="l09493"></a><span class="lineno"> 9493</span>&#160;</div><div class="line"><a name="l09494"></a><span class="lineno"> 9494</span>&#160;<span class="comment">// Simplify (build_vec (ext )) to (bitcast (build_vec ))</span></div><div class="line"><a name="l09495"></a><span class="lineno"> 9495</span>&#160;<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::reduceBuildVecExtToExtBuildVec(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N) {</div><div class="line"><a name="l09496"></a><span class="lineno"> 9496</span>&#160;  <span class="comment">// We perform this optimization post type-legalization because</span></div><div class="line"><a name="l09497"></a><span class="lineno"> 9497</span>&#160;  <span class="comment">// the type-legalizer often scalarizes integer-promoted vectors.</span></div><div class="line"><a name="l09498"></a><span class="lineno"> 9498</span>&#160;  <span class="comment">// Performing this optimization before may create bit-casts which</span></div><div class="line"><a name="l09499"></a><span class="lineno"> 9499</span>&#160;  <span class="comment">// will be type-legalized to complex code sequences.</span></div><div class="line"><a name="l09500"></a><span class="lineno"> 9500</span>&#160;  <span class="comment">// We perform this optimization only before the operation legalizer because we</span></div><div class="line"><a name="l09501"></a><span class="lineno"> 9501</span>&#160;  <span class="comment">// may introduce illegal operations.</span></div><div class="line"><a name="l09502"></a><span class="lineno"> 9502</span>&#160;  <span class="keywordflow">if</span> (Level != <a class="code" href="namespacellvm.html#aa6d856e4879bb775617f8c3634773b7aa805f5e0d60c9ebc5b134bc9190569a50">AfterLegalizeVectorOps</a> &amp;&amp; Level != <a class="code" href="namespacellvm.html#aa6d856e4879bb775617f8c3634773b7aabfb921bbd2fd66e0a6b7524eb4b3dd9f">AfterLegalizeTypes</a>)</div><div class="line"><a name="l09503"></a><span class="lineno"> 9503</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l09504"></a><span class="lineno"> 9504</span>&#160;</div><div class="line"><a name="l09505"></a><span class="lineno"> 9505</span>&#160;  <span class="keywordtype">unsigned</span> NumInScalars = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#abc5c2f1d47a517373030133c6a102106">getNumOperands</a>();</div><div class="line"><a name="l09506"></a><span class="lineno"> 9506</span>&#160;  <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a> dl(N);</div><div class="line"><a name="l09507"></a><span class="lineno"> 9507</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> VT = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(0);</div><div class="line"><a name="l09508"></a><span class="lineno"> 9508</span>&#160;</div><div class="line"><a name="l09509"></a><span class="lineno"> 9509</span>&#160;  <span class="comment">// Check to see if this is a BUILD_VECTOR of a bunch of values</span></div><div class="line"><a name="l09510"></a><span class="lineno"> 9510</span>&#160;  <span class="comment">// which come from any_extend or zero_extend nodes. If so, we can create</span></div><div class="line"><a name="l09511"></a><span class="lineno"> 9511</span>&#160;  <span class="comment">// a new BUILD_VECTOR using bit-casts which may enable other BUILD_VECTOR</span></div><div class="line"><a name="l09512"></a><span class="lineno"> 9512</span>&#160;  <span class="comment">// optimizations. We do not handle sign-extend because we can&#39;t fill the sign</span></div><div class="line"><a name="l09513"></a><span class="lineno"> 9513</span>&#160;  <span class="comment">// using shuffles.</span></div><div class="line"><a name="l09514"></a><span class="lineno"> 9514</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> SourceType = <a class="code" href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50ca62a222acce6360abd2726719fabc2797">MVT::Other</a>;</div><div class="line"><a name="l09515"></a><span class="lineno"> 9515</span>&#160;  <span class="keywordtype">bool</span> AllAnyExt = <span class="keyword">true</span>;</div><div class="line"><a name="l09516"></a><span class="lineno"> 9516</span>&#160;</div><div class="line"><a name="l09517"></a><span class="lineno"> 9517</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != NumInScalars; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l09518"></a><span class="lineno"> 9518</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> <a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5a5fa7b4069ef3bd1ceb9f2caa315cf5ac">In</a> = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l09519"></a><span class="lineno"> 9519</span>&#160;    <span class="comment">// Ignore undef inputs.</span></div><div class="line"><a name="l09520"></a><span class="lineno"> 9520</span>&#160;    <span class="keywordflow">if</span> (In.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7c6d8f265e9e16e5debdb9a536b55d3d">ISD::UNDEF</a>) <span class="keywordflow">continue</span>;</div><div class="line"><a name="l09521"></a><span class="lineno"> 9521</span>&#160;</div><div class="line"><a name="l09522"></a><span class="lineno"> 9522</span>&#160;    <span class="keywordtype">bool</span> AnyExt  = In.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a27d5d8ef82302b739ba3ca8be1a5513d">ISD::ANY_EXTEND</a>;</div><div class="line"><a name="l09523"></a><span class="lineno"> 9523</span>&#160;    <span class="keywordtype">bool</span> ZeroExt = In.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a93fdf85eff945f1a668b4915a051453e">ISD::ZERO_EXTEND</a>;</div><div class="line"><a name="l09524"></a><span class="lineno"> 9524</span>&#160;</div><div class="line"><a name="l09525"></a><span class="lineno"> 9525</span>&#160;    <span class="comment">// Abort if the element is not an extension.</span></div><div class="line"><a name="l09526"></a><span class="lineno"> 9526</span>&#160;    <span class="keywordflow">if</span> (!ZeroExt &amp;&amp; !AnyExt) {</div><div class="line"><a name="l09527"></a><span class="lineno"> 9527</span>&#160;      SourceType = <a class="code" href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50ca62a222acce6360abd2726719fabc2797">MVT::Other</a>;</div><div class="line"><a name="l09528"></a><span class="lineno"> 9528</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l09529"></a><span class="lineno"> 9529</span>&#160;    }</div><div class="line"><a name="l09530"></a><span class="lineno"> 9530</span>&#160;</div><div class="line"><a name="l09531"></a><span class="lineno"> 9531</span>&#160;    <span class="comment">// The input is a ZeroExt or AnyExt. Check the original type.</span></div><div class="line"><a name="l09532"></a><span class="lineno"> 9532</span>&#160;    <a class="code" href="structllvm_1_1EVT.html">EVT</a> InTy = In.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>();</div><div class="line"><a name="l09533"></a><span class="lineno"> 9533</span>&#160;</div><div class="line"><a name="l09534"></a><span class="lineno"> 9534</span>&#160;    <span class="comment">// Check that all of the widened source types are the same.</span></div><div class="line"><a name="l09535"></a><span class="lineno"> 9535</span>&#160;    <span class="keywordflow">if</span> (SourceType == <a class="code" href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50ca62a222acce6360abd2726719fabc2797">MVT::Other</a>)</div><div class="line"><a name="l09536"></a><span class="lineno"> 9536</span>&#160;      <span class="comment">// First time.</span></div><div class="line"><a name="l09537"></a><span class="lineno"> 9537</span>&#160;      SourceType = InTy;</div><div class="line"><a name="l09538"></a><span class="lineno"> 9538</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (InTy != SourceType) {</div><div class="line"><a name="l09539"></a><span class="lineno"> 9539</span>&#160;      <span class="comment">// Multiple income types. Abort.</span></div><div class="line"><a name="l09540"></a><span class="lineno"> 9540</span>&#160;      SourceType = <a class="code" href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50ca62a222acce6360abd2726719fabc2797">MVT::Other</a>;</div><div class="line"><a name="l09541"></a><span class="lineno"> 9541</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l09542"></a><span class="lineno"> 9542</span>&#160;    }</div><div class="line"><a name="l09543"></a><span class="lineno"> 9543</span>&#160;</div><div class="line"><a name="l09544"></a><span class="lineno"> 9544</span>&#160;    <span class="comment">// Check if all of the extends are ANY_EXTENDs.</span></div><div class="line"><a name="l09545"></a><span class="lineno"> 9545</span>&#160;    AllAnyExt &amp;= AnyExt;</div><div class="line"><a name="l09546"></a><span class="lineno"> 9546</span>&#160;  }</div><div class="line"><a name="l09547"></a><span class="lineno"> 9547</span>&#160;</div><div class="line"><a name="l09548"></a><span class="lineno"> 9548</span>&#160;  <span class="comment">// In order to have valid types, all of the inputs must be extended from the</span></div><div class="line"><a name="l09549"></a><span class="lineno"> 9549</span>&#160;  <span class="comment">// same source type and all of the inputs must be any or zero extend.</span></div><div class="line"><a name="l09550"></a><span class="lineno"> 9550</span>&#160;  <span class="comment">// Scalar sizes must be a power of two.</span></div><div class="line"><a name="l09551"></a><span class="lineno"> 9551</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> OutScalarTy = VT.<a class="code" href="structllvm_1_1EVT.html#a15be9767d0aad93fe5dcb60b7b7a78da">getScalarType</a>();</div><div class="line"><a name="l09552"></a><span class="lineno"> 9552</span>&#160;  <span class="keywordtype">bool</span> ValidTypes = SourceType != <a class="code" href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50ca62a222acce6360abd2726719fabc2797">MVT::Other</a> &amp;&amp;</div><div class="line"><a name="l09553"></a><span class="lineno"> 9553</span>&#160;                 <a class="code" href="namespacellvm.html#af4d1a918800291e75b01ce1447be0e83">isPowerOf2_32</a>(OutScalarTy.<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>()) &amp;&amp;</div><div class="line"><a name="l09554"></a><span class="lineno"> 9554</span>&#160;                 <a class="code" href="namespacellvm.html#af4d1a918800291e75b01ce1447be0e83">isPowerOf2_32</a>(SourceType.<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>());</div><div class="line"><a name="l09555"></a><span class="lineno"> 9555</span>&#160;</div><div class="line"><a name="l09556"></a><span class="lineno"> 9556</span>&#160;  <span class="comment">// Create a new simpler BUILD_VECTOR sequence which other optimizations can</span></div><div class="line"><a name="l09557"></a><span class="lineno"> 9557</span>&#160;  <span class="comment">// turn into a single shuffle instruction.</span></div><div class="line"><a name="l09558"></a><span class="lineno"> 9558</span>&#160;  <span class="keywordflow">if</span> (!ValidTypes)</div><div class="line"><a name="l09559"></a><span class="lineno"> 9559</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l09560"></a><span class="lineno"> 9560</span>&#160;</div><div class="line"><a name="l09561"></a><span class="lineno"> 9561</span>&#160;  <span class="keywordtype">bool</span> isLE = TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a7fe87806292e4bb35d59a51930f3ae0e">isLittleEndian</a>();</div><div class="line"><a name="l09562"></a><span class="lineno"> 9562</span>&#160;  <span class="keywordtype">unsigned</span> ElemRatio = OutScalarTy.<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>()/SourceType.<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>();</div><div class="line"><a name="l09563"></a><span class="lineno"> 9563</span>&#160;  assert(ElemRatio &gt; 1 &amp;&amp; <span class="stringliteral">&quot;Invalid element size ratio&quot;</span>);</div><div class="line"><a name="l09564"></a><span class="lineno"> 9564</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Filler = AllAnyExt ? DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a5b0e59823444a55c295af279611a9d24">getUNDEF</a>(SourceType):</div><div class="line"><a name="l09565"></a><span class="lineno"> 9565</span>&#160;                               DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(0, SourceType);</div><div class="line"><a name="l09566"></a><span class="lineno"> 9566</span>&#160;</div><div class="line"><a name="l09567"></a><span class="lineno"> 9567</span>&#160;  <span class="keywordtype">unsigned</span> NewBVElems = ElemRatio * VT.<a class="code" href="structllvm_1_1EVT.html#a42bca41d2438197c12b6db2c710a959c">getVectorNumElements</a>();</div><div class="line"><a name="l09568"></a><span class="lineno"> 9568</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;SDValue, 8&gt;</a> Ops(NewBVElems, Filler);</div><div class="line"><a name="l09569"></a><span class="lineno"> 9569</span>&#160;</div><div class="line"><a name="l09570"></a><span class="lineno"> 9570</span>&#160;  <span class="comment">// Populate the new build_vector</span></div><div class="line"><a name="l09571"></a><span class="lineno"> 9571</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0, e = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#abc5c2f1d47a517373030133c6a102106">getNumOperands</a>(); <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != e; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l09572"></a><span class="lineno"> 9572</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Cast = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l09573"></a><span class="lineno"> 9573</span>&#160;    assert((Cast.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a27d5d8ef82302b739ba3ca8be1a5513d">ISD::ANY_EXTEND</a> ||</div><div class="line"><a name="l09574"></a><span class="lineno"> 9574</span>&#160;            Cast.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a93fdf85eff945f1a668b4915a051453e">ISD::ZERO_EXTEND</a> ||</div><div class="line"><a name="l09575"></a><span class="lineno"> 9575</span>&#160;            Cast.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7c6d8f265e9e16e5debdb9a536b55d3d">ISD::UNDEF</a>) &amp;&amp; <span class="stringliteral">&quot;Invalid cast opcode&quot;</span>);</div><div class="line"><a name="l09576"></a><span class="lineno"> 9576</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> <a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5a5fa7b4069ef3bd1ceb9f2caa315cf5ac">In</a>;</div><div class="line"><a name="l09577"></a><span class="lineno"> 9577</span>&#160;    <span class="keywordflow">if</span> (Cast.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7c6d8f265e9e16e5debdb9a536b55d3d">ISD::UNDEF</a>)</div><div class="line"><a name="l09578"></a><span class="lineno"> 9578</span>&#160;      In = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a5b0e59823444a55c295af279611a9d24">getUNDEF</a>(SourceType);</div><div class="line"><a name="l09579"></a><span class="lineno"> 9579</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l09580"></a><span class="lineno"> 9580</span>&#160;      In = Cast-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0);</div><div class="line"><a name="l09581"></a><span class="lineno"> 9581</span>&#160;    <span class="keywordtype">unsigned</span> Index = isLE ? (<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> * ElemRatio) :</div><div class="line"><a name="l09582"></a><span class="lineno"> 9582</span>&#160;                            (<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> * ElemRatio + (ElemRatio - 1));</div><div class="line"><a name="l09583"></a><span class="lineno"> 9583</span>&#160;</div><div class="line"><a name="l09584"></a><span class="lineno"> 9584</span>&#160;    assert(Index &lt; Ops.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#a22a311dfe4c28a897de8a9365a4f0a84">size</a>() &amp;&amp; <span class="stringliteral">&quot;Invalid index&quot;</span>);</div><div class="line"><a name="l09585"></a><span class="lineno"> 9585</span>&#160;    Ops[Index] = <a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5a5fa7b4069ef3bd1ceb9f2caa315cf5ac">In</a>;</div><div class="line"><a name="l09586"></a><span class="lineno"> 9586</span>&#160;  }</div><div class="line"><a name="l09587"></a><span class="lineno"> 9587</span>&#160;</div><div class="line"><a name="l09588"></a><span class="lineno"> 9588</span>&#160;  <span class="comment">// The type of the new BUILD_VECTOR node.</span></div><div class="line"><a name="l09589"></a><span class="lineno"> 9589</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> VecVT = <a class="code" href="structllvm_1_1EVT.html#a18c2edf1939f6e87f1e586b815f398cd">EVT::getVectorVT</a>(*DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a39c6dff47b8dbd25cfaf6336c7056077">getContext</a>(), SourceType, NewBVElems);</div><div class="line"><a name="l09590"></a><span class="lineno"> 9590</span>&#160;  assert(VecVT.<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>() == VT.<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>() &amp;&amp;</div><div class="line"><a name="l09591"></a><span class="lineno"> 9591</span>&#160;         <span class="stringliteral">&quot;Invalid vector size&quot;</span>);</div><div class="line"><a name="l09592"></a><span class="lineno"> 9592</span>&#160;  <span class="comment">// Check if the new vector type is legal.</span></div><div class="line"><a name="l09593"></a><span class="lineno"> 9593</span>&#160;  <span class="keywordflow">if</span> (!isTypeLegal(VecVT)) <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l09594"></a><span class="lineno"> 9594</span>&#160;</div><div class="line"><a name="l09595"></a><span class="lineno"> 9595</span>&#160;  <span class="comment">// Make the new BUILD_VECTOR.</span></div><div class="line"><a name="l09596"></a><span class="lineno"> 9596</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> BV = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110aff6f73b624fecca7dbe94259f9437e32">ISD::BUILD_VECTOR</a>, dl, VecVT, &amp;Ops[0], Ops.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#a22a311dfe4c28a897de8a9365a4f0a84">size</a>());</div><div class="line"><a name="l09597"></a><span class="lineno"> 9597</span>&#160;</div><div class="line"><a name="l09598"></a><span class="lineno"> 9598</span>&#160;  <span class="comment">// The new BUILD_VECTOR node has the potential to be further optimized.</span></div><div class="line"><a name="l09599"></a><span class="lineno"> 9599</span>&#160;  AddToWorkList(BV.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l09600"></a><span class="lineno"> 9600</span>&#160;  <span class="comment">// Bitcast to the desired type.</span></div><div class="line"><a name="l09601"></a><span class="lineno"> 9601</span>&#160;  <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a412ddf522b53f07690a86bffba1278e7">ISD::BITCAST</a>, dl, VT, BV);</div><div class="line"><a name="l09602"></a><span class="lineno"> 9602</span>&#160;}</div><div class="line"><a name="l09603"></a><span class="lineno"> 9603</span>&#160;</div><div class="line"><a name="l09604"></a><span class="lineno"> 9604</span>&#160;<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::reduceBuildVecConvertToConvertBuildVec(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N) {</div><div class="line"><a name="l09605"></a><span class="lineno"> 9605</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> VT = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(0);</div><div class="line"><a name="l09606"></a><span class="lineno"> 9606</span>&#160;</div><div class="line"><a name="l09607"></a><span class="lineno"> 9607</span>&#160;  <span class="keywordtype">unsigned</span> NumInScalars = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#abc5c2f1d47a517373030133c6a102106">getNumOperands</a>();</div><div class="line"><a name="l09608"></a><span class="lineno"> 9608</span>&#160;  <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a> dl(N);</div><div class="line"><a name="l09609"></a><span class="lineno"> 9609</span>&#160;</div><div class="line"><a name="l09610"></a><span class="lineno"> 9610</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> SrcVT = <a class="code" href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50ca62a222acce6360abd2726719fabc2797">MVT::Other</a>;</div><div class="line"><a name="l09611"></a><span class="lineno"> 9611</span>&#160;  <span class="keywordtype">unsigned</span> Opcode = <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a062083eb3ff8c441c73d3bf42ca09bba">ISD::DELETED_NODE</a>;</div><div class="line"><a name="l09612"></a><span class="lineno"> 9612</span>&#160;  <span class="keywordtype">unsigned</span> NumDefs = 0;</div><div class="line"><a name="l09613"></a><span class="lineno"> 9613</span>&#160;</div><div class="line"><a name="l09614"></a><span class="lineno"> 9614</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != NumInScalars; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l09615"></a><span class="lineno"> 9615</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> <a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5a5fa7b4069ef3bd1ceb9f2caa315cf5ac">In</a> = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l09616"></a><span class="lineno"> 9616</span>&#160;    <span class="keywordtype">unsigned</span> Opc = In.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>();</div><div class="line"><a name="l09617"></a><span class="lineno"> 9617</span>&#160;</div><div class="line"><a name="l09618"></a><span class="lineno"> 9618</span>&#160;    <span class="keywordflow">if</span> (Opc == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7c6d8f265e9e16e5debdb9a536b55d3d">ISD::UNDEF</a>)</div><div class="line"><a name="l09619"></a><span class="lineno"> 9619</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l09620"></a><span class="lineno"> 9620</span>&#160;</div><div class="line"><a name="l09621"></a><span class="lineno"> 9621</span>&#160;    <span class="comment">// If all scalar values are floats and converted from integers.</span></div><div class="line"><a name="l09622"></a><span class="lineno"> 9622</span>&#160;    <span class="keywordflow">if</span> (Opcode == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a062083eb3ff8c441c73d3bf42ca09bba">ISD::DELETED_NODE</a> &amp;&amp;</div><div class="line"><a name="l09623"></a><span class="lineno"> 9623</span>&#160;        (Opc == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a169032eecd015d4eeb869c457202a6c8">ISD::UINT_TO_FP</a> || Opc == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a315004656a75a3c3a9d7294f105a8da2">ISD::SINT_TO_FP</a>)) {</div><div class="line"><a name="l09624"></a><span class="lineno"> 9624</span>&#160;      Opcode = Opc;</div><div class="line"><a name="l09625"></a><span class="lineno"> 9625</span>&#160;    }</div><div class="line"><a name="l09626"></a><span class="lineno"> 9626</span>&#160;</div><div class="line"><a name="l09627"></a><span class="lineno"> 9627</span>&#160;    <span class="keywordflow">if</span> (Opc != Opcode)</div><div class="line"><a name="l09628"></a><span class="lineno"> 9628</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l09629"></a><span class="lineno"> 9629</span>&#160;</div><div class="line"><a name="l09630"></a><span class="lineno"> 9630</span>&#160;    <a class="code" href="structllvm_1_1EVT.html">EVT</a> InVT = In.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>();</div><div class="line"><a name="l09631"></a><span class="lineno"> 9631</span>&#160;</div><div class="line"><a name="l09632"></a><span class="lineno"> 9632</span>&#160;    <span class="comment">// If all scalar values are typed differently, bail out. It&#39;s chosen to</span></div><div class="line"><a name="l09633"></a><span class="lineno"> 9633</span>&#160;    <span class="comment">// simplify BUILD_VECTOR of integer types.</span></div><div class="line"><a name="l09634"></a><span class="lineno"> 9634</span>&#160;    <span class="keywordflow">if</span> (SrcVT == <a class="code" href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50ca62a222acce6360abd2726719fabc2797">MVT::Other</a>)</div><div class="line"><a name="l09635"></a><span class="lineno"> 9635</span>&#160;      SrcVT = InVT;</div><div class="line"><a name="l09636"></a><span class="lineno"> 9636</span>&#160;    <span class="keywordflow">if</span> (SrcVT != InVT)</div><div class="line"><a name="l09637"></a><span class="lineno"> 9637</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l09638"></a><span class="lineno"> 9638</span>&#160;    NumDefs++;</div><div class="line"><a name="l09639"></a><span class="lineno"> 9639</span>&#160;  }</div><div class="line"><a name="l09640"></a><span class="lineno"> 9640</span>&#160;</div><div class="line"><a name="l09641"></a><span class="lineno"> 9641</span>&#160;  <span class="comment">// If the vector has just one element defined, it&#39;s not worth to fold it into</span></div><div class="line"><a name="l09642"></a><span class="lineno"> 9642</span>&#160;  <span class="comment">// a vectorized one.</span></div><div class="line"><a name="l09643"></a><span class="lineno"> 9643</span>&#160;  <span class="keywordflow">if</span> (NumDefs &lt; 2)</div><div class="line"><a name="l09644"></a><span class="lineno"> 9644</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l09645"></a><span class="lineno"> 9645</span>&#160;</div><div class="line"><a name="l09646"></a><span class="lineno"> 9646</span>&#160;  assert((Opcode == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a169032eecd015d4eeb869c457202a6c8">ISD::UINT_TO_FP</a> || Opcode == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a315004656a75a3c3a9d7294f105a8da2">ISD::SINT_TO_FP</a>)</div><div class="line"><a name="l09647"></a><span class="lineno"> 9647</span>&#160;         &amp;&amp; <span class="stringliteral">&quot;Should only handle conversion from integer to float.&quot;</span>);</div><div class="line"><a name="l09648"></a><span class="lineno"> 9648</span>&#160;  assert(SrcVT != <a class="code" href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50ca62a222acce6360abd2726719fabc2797">MVT::Other</a> &amp;&amp; <span class="stringliteral">&quot;Cannot determine source type!&quot;</span>);</div><div class="line"><a name="l09649"></a><span class="lineno"> 9649</span>&#160;</div><div class="line"><a name="l09650"></a><span class="lineno"> 9650</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> NVT = <a class="code" href="structllvm_1_1EVT.html#a18c2edf1939f6e87f1e586b815f398cd">EVT::getVectorVT</a>(*DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a39c6dff47b8dbd25cfaf6336c7056077">getContext</a>(), SrcVT, NumInScalars);</div><div class="line"><a name="l09651"></a><span class="lineno"> 9651</span>&#160;</div><div class="line"><a name="l09652"></a><span class="lineno"> 9652</span>&#160;  <span class="keywordflow">if</span> (!TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a087dd0f9650e999b087c17cc7f46f2d0">isOperationLegalOrCustom</a>(Opcode, NVT))</div><div class="line"><a name="l09653"></a><span class="lineno"> 9653</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l09654"></a><span class="lineno"> 9654</span>&#160;</div><div class="line"><a name="l09655"></a><span class="lineno"> 9655</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;SDValue, 8&gt;</a> Opnds;</div><div class="line"><a name="l09656"></a><span class="lineno"> 9656</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != NumInScalars; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l09657"></a><span class="lineno"> 9657</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> <a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5a5fa7b4069ef3bd1ceb9f2caa315cf5ac">In</a> = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l09658"></a><span class="lineno"> 9658</span>&#160;</div><div class="line"><a name="l09659"></a><span class="lineno"> 9659</span>&#160;    <span class="keywordflow">if</span> (In.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7c6d8f265e9e16e5debdb9a536b55d3d">ISD::UNDEF</a>)</div><div class="line"><a name="l09660"></a><span class="lineno"> 9660</span>&#160;      Opnds.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a5b0e59823444a55c295af279611a9d24">getUNDEF</a>(SrcVT));</div><div class="line"><a name="l09661"></a><span class="lineno"> 9661</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l09662"></a><span class="lineno"> 9662</span>&#160;      Opnds.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(In.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0));</div><div class="line"><a name="l09663"></a><span class="lineno"> 9663</span>&#160;  }</div><div class="line"><a name="l09664"></a><span class="lineno"> 9664</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> BV = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110aff6f73b624fecca7dbe94259f9437e32">ISD::BUILD_VECTOR</a>, dl, NVT,</div><div class="line"><a name="l09665"></a><span class="lineno"> 9665</span>&#160;                           &amp;Opnds[0], Opnds.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#a22a311dfe4c28a897de8a9365a4f0a84">size</a>());</div><div class="line"><a name="l09666"></a><span class="lineno"> 9666</span>&#160;  AddToWorkList(BV.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l09667"></a><span class="lineno"> 9667</span>&#160;</div><div class="line"><a name="l09668"></a><span class="lineno"> 9668</span>&#160;  <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(Opcode, dl, VT, BV);</div><div class="line"><a name="l09669"></a><span class="lineno"> 9669</span>&#160;}</div><div class="line"><a name="l09670"></a><span class="lineno"> 9670</span>&#160;</div><div class="line"><a name="l09671"></a><span class="lineno"> 9671</span>&#160;<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::visitBUILD_VECTOR(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N) {</div><div class="line"><a name="l09672"></a><span class="lineno"> 9672</span>&#160;  <span class="keywordtype">unsigned</span> NumInScalars = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#abc5c2f1d47a517373030133c6a102106">getNumOperands</a>();</div><div class="line"><a name="l09673"></a><span class="lineno"> 9673</span>&#160;  <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a> dl(N);</div><div class="line"><a name="l09674"></a><span class="lineno"> 9674</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> VT = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(0);</div><div class="line"><a name="l09675"></a><span class="lineno"> 9675</span>&#160;</div><div class="line"><a name="l09676"></a><span class="lineno"> 9676</span>&#160;  <span class="comment">// A vector built entirely of undefs is undef.</span></div><div class="line"><a name="l09677"></a><span class="lineno"> 9677</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1ISD.html#a933d79e63e855d7c90bf161355c008ec">ISD::allOperandsUndef</a>(N))</div><div class="line"><a name="l09678"></a><span class="lineno"> 9678</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a5b0e59823444a55c295af279611a9d24">getUNDEF</a>(VT);</div><div class="line"><a name="l09679"></a><span class="lineno"> 9679</span>&#160;</div><div class="line"><a name="l09680"></a><span class="lineno"> 9680</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> V = reduceBuildVecExtToExtBuildVec(N);</div><div class="line"><a name="l09681"></a><span class="lineno"> 9681</span>&#160;  <span class="keywordflow">if</span> (V.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>())</div><div class="line"><a name="l09682"></a><span class="lineno"> 9682</span>&#160;    <span class="keywordflow">return</span> V;</div><div class="line"><a name="l09683"></a><span class="lineno"> 9683</span>&#160;</div><div class="line"><a name="l09684"></a><span class="lineno"> 9684</span>&#160;  V = reduceBuildVecConvertToConvertBuildVec(N);</div><div class="line"><a name="l09685"></a><span class="lineno"> 9685</span>&#160;  <span class="keywordflow">if</span> (V.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>())</div><div class="line"><a name="l09686"></a><span class="lineno"> 9686</span>&#160;    <span class="keywordflow">return</span> V;</div><div class="line"><a name="l09687"></a><span class="lineno"> 9687</span>&#160;</div><div class="line"><a name="l09688"></a><span class="lineno"> 9688</span>&#160;  <span class="comment">// Check to see if this is a BUILD_VECTOR of a bunch of EXTRACT_VECTOR_ELT</span></div><div class="line"><a name="l09689"></a><span class="lineno"> 9689</span>&#160;  <span class="comment">// operations.  If so, and if the EXTRACT_VECTOR_ELT vector inputs come from</span></div><div class="line"><a name="l09690"></a><span class="lineno"> 9690</span>&#160;  <span class="comment">// at most two distinct vectors, turn this into a shuffle node.</span></div><div class="line"><a name="l09691"></a><span class="lineno"> 9691</span>&#160;</div><div class="line"><a name="l09692"></a><span class="lineno"> 9692</span>&#160;  <span class="comment">// May only combine to shuffle after legalize if shuffle is legal.</span></div><div class="line"><a name="l09693"></a><span class="lineno"> 9693</span>&#160;  <span class="keywordflow">if</span> (LegalOperations &amp;&amp;</div><div class="line"><a name="l09694"></a><span class="lineno"> 9694</span>&#160;      !TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a087dd0f9650e999b087c17cc7f46f2d0">isOperationLegalOrCustom</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a8d8773b28111d8898663d4a0f6223d68">ISD::VECTOR_SHUFFLE</a>, VT))</div><div class="line"><a name="l09695"></a><span class="lineno"> 9695</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l09696"></a><span class="lineno"> 9696</span>&#160;</div><div class="line"><a name="l09697"></a><span class="lineno"> 9697</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> VecIn1, VecIn2;</div><div class="line"><a name="l09698"></a><span class="lineno"> 9698</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != NumInScalars; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l09699"></a><span class="lineno"> 9699</span>&#160;    <span class="comment">// Ignore undef inputs.</span></div><div class="line"><a name="l09700"></a><span class="lineno"> 9700</span>&#160;    <span class="keywordflow">if</span> (N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>).<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7c6d8f265e9e16e5debdb9a536b55d3d">ISD::UNDEF</a>) <span class="keywordflow">continue</span>;</div><div class="line"><a name="l09701"></a><span class="lineno"> 9701</span>&#160;</div><div class="line"><a name="l09702"></a><span class="lineno"> 9702</span>&#160;    <span class="comment">// If this input is something other than a EXTRACT_VECTOR_ELT with a</span></div><div class="line"><a name="l09703"></a><span class="lineno"> 9703</span>&#160;    <span class="comment">// constant index, bail out.</span></div><div class="line"><a name="l09704"></a><span class="lineno"> 9704</span>&#160;    <span class="keywordflow">if</span> (N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>).<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() != <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9329e79f62e9ab9b41cfbcafd314bcbd">ISD::EXTRACT_VECTOR_ELT</a> ||</div><div class="line"><a name="l09705"></a><span class="lineno"> 9705</span>&#160;        !isa&lt;ConstantSDNode&gt;(N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>).<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1))) {</div><div class="line"><a name="l09706"></a><span class="lineno"> 9706</span>&#160;      VecIn1 = VecIn2 = <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(0, 0);</div><div class="line"><a name="l09707"></a><span class="lineno"> 9707</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l09708"></a><span class="lineno"> 9708</span>&#160;    }</div><div class="line"><a name="l09709"></a><span class="lineno"> 9709</span>&#160;</div><div class="line"><a name="l09710"></a><span class="lineno"> 9710</span>&#160;    <span class="comment">// We allow up to two distinct input vectors.</span></div><div class="line"><a name="l09711"></a><span class="lineno"> 9711</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> ExtractedFromVec = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>).<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0);</div><div class="line"><a name="l09712"></a><span class="lineno"> 9712</span>&#160;    <span class="keywordflow">if</span> (ExtractedFromVec == VecIn1 || ExtractedFromVec == VecIn2)</div><div class="line"><a name="l09713"></a><span class="lineno"> 9713</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l09714"></a><span class="lineno"> 9714</span>&#160;</div><div class="line"><a name="l09715"></a><span class="lineno"> 9715</span>&#160;    <span class="keywordflow">if</span> (VecIn1.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>() == 0) {</div><div class="line"><a name="l09716"></a><span class="lineno"> 9716</span>&#160;      VecIn1 = ExtractedFromVec;</div><div class="line"><a name="l09717"></a><span class="lineno"> 9717</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (VecIn2.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>() == 0) {</div><div class="line"><a name="l09718"></a><span class="lineno"> 9718</span>&#160;      VecIn2 = ExtractedFromVec;</div><div class="line"><a name="l09719"></a><span class="lineno"> 9719</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l09720"></a><span class="lineno"> 9720</span>&#160;      <span class="comment">// Too many inputs.</span></div><div class="line"><a name="l09721"></a><span class="lineno"> 9721</span>&#160;      VecIn1 = VecIn2 = <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(0, 0);</div><div class="line"><a name="l09722"></a><span class="lineno"> 9722</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l09723"></a><span class="lineno"> 9723</span>&#160;    }</div><div class="line"><a name="l09724"></a><span class="lineno"> 9724</span>&#160;  }</div><div class="line"><a name="l09725"></a><span class="lineno"> 9725</span>&#160;</div><div class="line"><a name="l09726"></a><span class="lineno"> 9726</span>&#160;    <span class="comment">// If everything is good, we can make a shuffle operation.</span></div><div class="line"><a name="l09727"></a><span class="lineno"> 9727</span>&#160;  <span class="keywordflow">if</span> (VecIn1.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()) {</div><div class="line"><a name="l09728"></a><span class="lineno"> 9728</span>&#160;    <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;int, 8&gt;</a> Mask;</div><div class="line"><a name="l09729"></a><span class="lineno"> 9729</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != NumInScalars; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l09730"></a><span class="lineno"> 9730</span>&#160;      <span class="keywordflow">if</span> (N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>).<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7c6d8f265e9e16e5debdb9a536b55d3d">ISD::UNDEF</a>) {</div><div class="line"><a name="l09731"></a><span class="lineno"> 9731</span>&#160;        Mask.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(-1);</div><div class="line"><a name="l09732"></a><span class="lineno"> 9732</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l09733"></a><span class="lineno"> 9733</span>&#160;      }</div><div class="line"><a name="l09734"></a><span class="lineno"> 9734</span>&#160;</div><div class="line"><a name="l09735"></a><span class="lineno"> 9735</span>&#160;      <span class="comment">// If extracting from the first vector, just use the index directly.</span></div><div class="line"><a name="l09736"></a><span class="lineno"> 9736</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Extract = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l09737"></a><span class="lineno"> 9737</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> ExtVal = Extract.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1);</div><div class="line"><a name="l09738"></a><span class="lineno"> 9738</span>&#160;      <span class="keywordflow">if</span> (Extract.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0) == VecIn1) {</div><div class="line"><a name="l09739"></a><span class="lineno"> 9739</span>&#160;        <span class="keywordtype">unsigned</span> ExtIndex = cast&lt;ConstantSDNode&gt;(ExtVal)-&gt;getZExtValue();</div><div class="line"><a name="l09740"></a><span class="lineno"> 9740</span>&#160;        <span class="keywordflow">if</span> (ExtIndex &gt; VT.<a class="code" href="structllvm_1_1EVT.html#a42bca41d2438197c12b6db2c710a959c">getVectorNumElements</a>())</div><div class="line"><a name="l09741"></a><span class="lineno"> 9741</span>&#160;          <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l09742"></a><span class="lineno"> 9742</span>&#160;</div><div class="line"><a name="l09743"></a><span class="lineno"> 9743</span>&#160;        Mask.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(ExtIndex);</div><div class="line"><a name="l09744"></a><span class="lineno"> 9744</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l09745"></a><span class="lineno"> 9745</span>&#160;      }</div><div class="line"><a name="l09746"></a><span class="lineno"> 9746</span>&#160;</div><div class="line"><a name="l09747"></a><span class="lineno"> 9747</span>&#160;      <span class="comment">// Otherwise, use InIdx + VecSize</span></div><div class="line"><a name="l09748"></a><span class="lineno"> 9748</span>&#160;      <span class="keywordtype">unsigned</span> Idx = cast&lt;ConstantSDNode&gt;(ExtVal)-&gt;getZExtValue();</div><div class="line"><a name="l09749"></a><span class="lineno"> 9749</span>&#160;      Mask.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(Idx+NumInScalars);</div><div class="line"><a name="l09750"></a><span class="lineno"> 9750</span>&#160;    }</div><div class="line"><a name="l09751"></a><span class="lineno"> 9751</span>&#160;</div><div class="line"><a name="l09752"></a><span class="lineno"> 9752</span>&#160;    <span class="comment">// We can&#39;t generate a shuffle node with mismatched input and output types.</span></div><div class="line"><a name="l09753"></a><span class="lineno"> 9753</span>&#160;    <span class="comment">// Attempt to transform a single input vector to the correct type.</span></div><div class="line"><a name="l09754"></a><span class="lineno"> 9754</span>&#160;    <span class="keywordflow">if</span> ((VT != VecIn1.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>())) {</div><div class="line"><a name="l09755"></a><span class="lineno"> 9755</span>&#160;      <span class="comment">// We don&#39;t support shuffeling between TWO values of different types.</span></div><div class="line"><a name="l09756"></a><span class="lineno"> 9756</span>&#160;      <span class="keywordflow">if</span> (VecIn2.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>() != 0)</div><div class="line"><a name="l09757"></a><span class="lineno"> 9757</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l09758"></a><span class="lineno"> 9758</span>&#160;</div><div class="line"><a name="l09759"></a><span class="lineno"> 9759</span>&#160;      <span class="comment">// We only support widening of vectors which are half the size of the</span></div><div class="line"><a name="l09760"></a><span class="lineno"> 9760</span>&#160;      <span class="comment">// output registers. For example XMM-&gt;YMM widening on X86 with AVX.</span></div><div class="line"><a name="l09761"></a><span class="lineno"> 9761</span>&#160;      <span class="keywordflow">if</span> (VecIn1.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>().<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>()*2 != VT.<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>())</div><div class="line"><a name="l09762"></a><span class="lineno"> 9762</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l09763"></a><span class="lineno"> 9763</span>&#160;</div><div class="line"><a name="l09764"></a><span class="lineno"> 9764</span>&#160;      <span class="comment">// If the input vector type has a different base type to the output</span></div><div class="line"><a name="l09765"></a><span class="lineno"> 9765</span>&#160;      <span class="comment">// vector type, bail out.</span></div><div class="line"><a name="l09766"></a><span class="lineno"> 9766</span>&#160;      <span class="keywordflow">if</span> (VecIn1.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>().<a class="code" href="structllvm_1_1EVT.html#a3a07c062cc9330acd8e8c4e3930cbb25">getVectorElementType</a>() !=</div><div class="line"><a name="l09767"></a><span class="lineno"> 9767</span>&#160;          VT.<a class="code" href="structllvm_1_1EVT.html#a3a07c062cc9330acd8e8c4e3930cbb25">getVectorElementType</a>())</div><div class="line"><a name="l09768"></a><span class="lineno"> 9768</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l09769"></a><span class="lineno"> 9769</span>&#160;</div><div class="line"><a name="l09770"></a><span class="lineno"> 9770</span>&#160;      <span class="comment">// Widen the input vector by adding undef values.</span></div><div class="line"><a name="l09771"></a><span class="lineno"> 9771</span>&#160;      VecIn1 = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a320898056eadc3254fc601e1362eb9f5">ISD::CONCAT_VECTORS</a>, dl, VT,</div><div class="line"><a name="l09772"></a><span class="lineno"> 9772</span>&#160;                           VecIn1, DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a5b0e59823444a55c295af279611a9d24">getUNDEF</a>(VecIn1.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>()));</div><div class="line"><a name="l09773"></a><span class="lineno"> 9773</span>&#160;    }</div><div class="line"><a name="l09774"></a><span class="lineno"> 9774</span>&#160;</div><div class="line"><a name="l09775"></a><span class="lineno"> 9775</span>&#160;    <span class="comment">// If VecIn2 is unused then change it to undef.</span></div><div class="line"><a name="l09776"></a><span class="lineno"> 9776</span>&#160;    VecIn2 = VecIn2.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>() ? VecIn2 : DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a5b0e59823444a55c295af279611a9d24">getUNDEF</a>(VT);</div><div class="line"><a name="l09777"></a><span class="lineno"> 9777</span>&#160;</div><div class="line"><a name="l09778"></a><span class="lineno"> 9778</span>&#160;    <span class="comment">// Check that we were able to transform all incoming values to the same</span></div><div class="line"><a name="l09779"></a><span class="lineno"> 9779</span>&#160;    <span class="comment">// type.</span></div><div class="line"><a name="l09780"></a><span class="lineno"> 9780</span>&#160;    <span class="keywordflow">if</span> (VecIn2.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>() != VecIn1.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>() ||</div><div class="line"><a name="l09781"></a><span class="lineno"> 9781</span>&#160;        VecIn1.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>() != VT)</div><div class="line"><a name="l09782"></a><span class="lineno"> 9782</span>&#160;          <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l09783"></a><span class="lineno"> 9783</span>&#160;</div><div class="line"><a name="l09784"></a><span class="lineno"> 9784</span>&#160;    <span class="comment">// Only type-legal BUILD_VECTOR nodes are converted to shuffle nodes.</span></div><div class="line"><a name="l09785"></a><span class="lineno"> 9785</span>&#160;    <span class="keywordflow">if</span> (!isTypeLegal(VT))</div><div class="line"><a name="l09786"></a><span class="lineno"> 9786</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l09787"></a><span class="lineno"> 9787</span>&#160;</div><div class="line"><a name="l09788"></a><span class="lineno"> 9788</span>&#160;    <span class="comment">// Return the new VECTOR_SHUFFLE node.</span></div><div class="line"><a name="l09789"></a><span class="lineno"> 9789</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Ops[2];</div><div class="line"><a name="l09790"></a><span class="lineno"> 9790</span>&#160;    Ops[0] = VecIn1;</div><div class="line"><a name="l09791"></a><span class="lineno"> 9791</span>&#160;    Ops[1] = VecIn2;</div><div class="line"><a name="l09792"></a><span class="lineno"> 9792</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a819041d6f932a577122acfff723fe4af">getVectorShuffle</a>(VT, dl, Ops[0], Ops[1], &amp;Mask[0]);</div><div class="line"><a name="l09793"></a><span class="lineno"> 9793</span>&#160;  }</div><div class="line"><a name="l09794"></a><span class="lineno"> 9794</span>&#160;</div><div class="line"><a name="l09795"></a><span class="lineno"> 9795</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l09796"></a><span class="lineno"> 9796</span>&#160;}</div><div class="line"><a name="l09797"></a><span class="lineno"> 9797</span>&#160;</div><div class="line"><a name="l09798"></a><span class="lineno"> 9798</span>&#160;<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::visitCONCAT_VECTORS(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N) {</div><div class="line"><a name="l09799"></a><span class="lineno"> 9799</span>&#160;  <span class="comment">// TODO: Check to see if this is a CONCAT_VECTORS of a bunch of</span></div><div class="line"><a name="l09800"></a><span class="lineno"> 9800</span>&#160;  <span class="comment">// EXTRACT_SUBVECTOR operations.  If so, and if the EXTRACT_SUBVECTOR vector</span></div><div class="line"><a name="l09801"></a><span class="lineno"> 9801</span>&#160;  <span class="comment">// inputs come from at most two distinct vectors, turn this into a shuffle</span></div><div class="line"><a name="l09802"></a><span class="lineno"> 9802</span>&#160;  <span class="comment">// node.</span></div><div class="line"><a name="l09803"></a><span class="lineno"> 9803</span>&#160;</div><div class="line"><a name="l09804"></a><span class="lineno"> 9804</span>&#160;  <span class="comment">// If we only have one input vector, we don&#39;t need to do any concatenation.</span></div><div class="line"><a name="l09805"></a><span class="lineno"> 9805</span>&#160;  <span class="keywordflow">if</span> (N-&gt;<a class="code" href="classllvm_1_1SDNode.html#abc5c2f1d47a517373030133c6a102106">getNumOperands</a>() == 1)</div><div class="line"><a name="l09806"></a><span class="lineno"> 9806</span>&#160;    <span class="keywordflow">return</span> N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0);</div><div class="line"><a name="l09807"></a><span class="lineno"> 9807</span>&#160;</div><div class="line"><a name="l09808"></a><span class="lineno"> 9808</span>&#160;  <span class="comment">// Check if all of the operands are undefs.</span></div><div class="line"><a name="l09809"></a><span class="lineno"> 9809</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> VT = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(0);</div><div class="line"><a name="l09810"></a><span class="lineno"> 9810</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1ISD.html#a933d79e63e855d7c90bf161355c008ec">ISD::allOperandsUndef</a>(N))</div><div class="line"><a name="l09811"></a><span class="lineno"> 9811</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a5b0e59823444a55c295af279611a9d24">getUNDEF</a>(VT);</div><div class="line"><a name="l09812"></a><span class="lineno"> 9812</span>&#160;</div><div class="line"><a name="l09813"></a><span class="lineno"> 9813</span>&#160;  <span class="comment">// Optimize concat_vectors where one of the vectors is undef.</span></div><div class="line"><a name="l09814"></a><span class="lineno"> 9814</span>&#160;  <span class="keywordflow">if</span> (N-&gt;<a class="code" href="classllvm_1_1SDNode.html#abc5c2f1d47a517373030133c6a102106">getNumOperands</a>() == 2 &amp;&amp;</div><div class="line"><a name="l09815"></a><span class="lineno"> 9815</span>&#160;      N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(1)-&gt;<a class="code" href="classllvm_1_1SDNode.html#af0d328f3f61168f4ea7d6e4044af4f97">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7c6d8f265e9e16e5debdb9a536b55d3d">ISD::UNDEF</a>) {</div><div class="line"><a name="l09816"></a><span class="lineno"> 9816</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> <a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5a5fa7b4069ef3bd1ceb9f2caa315cf5ac">In</a> = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0);</div><div class="line"><a name="l09817"></a><span class="lineno"> 9817</span>&#160;    assert(In.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>().<a class="code" href="structllvm_1_1EVT.html#a73f7c824cad61a47c21bf6d652ae2fd7">isVector</a>() &amp;&amp; <span class="stringliteral">&quot;Must concat vectors&quot;</span>);</div><div class="line"><a name="l09818"></a><span class="lineno"> 9818</span>&#160;</div><div class="line"><a name="l09819"></a><span class="lineno"> 9819</span>&#160;    <span class="comment">// Transform: concat_vectors(scalar, undef) -&gt; scalar_to_vector(sclr).</span></div><div class="line"><a name="l09820"></a><span class="lineno"> 9820</span>&#160;    <span class="keywordflow">if</span> (In-&gt;<a class="code" href="classllvm_1_1SDNode.html#af0d328f3f61168f4ea7d6e4044af4f97">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a412ddf522b53f07690a86bffba1278e7">ISD::BITCAST</a> &amp;&amp;</div><div class="line"><a name="l09821"></a><span class="lineno"> 9821</span>&#160;        !In-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0)-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(0).<a class="code" href="structllvm_1_1EVT.html#a73f7c824cad61a47c21bf6d652ae2fd7">isVector</a>()) {</div><div class="line"><a name="l09822"></a><span class="lineno"> 9822</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> <a class="code" href="namespacellvm_1_1NVPTX_1_1PTXLdStInstCode.html#a91119cbee2be000c528a690252aee07ca09c68d67f7dbfa6cc77eaf73aa535217">Scalar</a> = In-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0);</div><div class="line"><a name="l09823"></a><span class="lineno"> 9823</span>&#160;      <a class="code" href="structllvm_1_1EVT.html">EVT</a> SclTy = Scalar-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(0);</div><div class="line"><a name="l09824"></a><span class="lineno"> 9824</span>&#160;</div><div class="line"><a name="l09825"></a><span class="lineno"> 9825</span>&#160;      <span class="keywordflow">if</span> (!SclTy.<a class="code" href="structllvm_1_1EVT.html#afc4147764cdb5599c67f747813ef9bdc">isFloatingPoint</a>() &amp;&amp; !SclTy.<a class="code" href="structllvm_1_1EVT.html#a8cc407ac00df4edd4ec4d5168d6ecb26">isInteger</a>())</div><div class="line"><a name="l09826"></a><span class="lineno"> 9826</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l09827"></a><span class="lineno"> 9827</span>&#160;</div><div class="line"><a name="l09828"></a><span class="lineno"> 9828</span>&#160;      <a class="code" href="structllvm_1_1EVT.html">EVT</a> NVT = <a class="code" href="structllvm_1_1EVT.html#a18c2edf1939f6e87f1e586b815f398cd">EVT::getVectorVT</a>(*DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a39c6dff47b8dbd25cfaf6336c7056077">getContext</a>(), SclTy,</div><div class="line"><a name="l09829"></a><span class="lineno"> 9829</span>&#160;                                 VT.<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>() / SclTy.<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>());</div><div class="line"><a name="l09830"></a><span class="lineno"> 9830</span>&#160;      <span class="keywordflow">if</span> (!TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a861aaccc0f468493e76c011811548804">isTypeLegal</a>(NVT) || !TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a861aaccc0f468493e76c011811548804">isTypeLegal</a>(Scalar.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>()))</div><div class="line"><a name="l09831"></a><span class="lineno"> 9831</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l09832"></a><span class="lineno"> 9832</span>&#160;</div><div class="line"><a name="l09833"></a><span class="lineno"> 9833</span>&#160;      <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a> dl = <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N);</div><div class="line"><a name="l09834"></a><span class="lineno"> 9834</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Res = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a576080a08ef1bbab0308eac9d5838f75">ISD::SCALAR_TO_VECTOR</a>, dl, NVT, Scalar);</div><div class="line"><a name="l09835"></a><span class="lineno"> 9835</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a412ddf522b53f07690a86bffba1278e7">ISD::BITCAST</a>, dl, VT, Res);</div><div class="line"><a name="l09836"></a><span class="lineno"> 9836</span>&#160;    }</div><div class="line"><a name="l09837"></a><span class="lineno"> 9837</span>&#160;  }</div><div class="line"><a name="l09838"></a><span class="lineno"> 9838</span>&#160;</div><div class="line"><a name="l09839"></a><span class="lineno"> 9839</span>&#160;  <span class="comment">// Type legalization of vectors and DAG canonicalization of SHUFFLE_VECTOR</span></div><div class="line"><a name="l09840"></a><span class="lineno"> 9840</span>&#160;  <span class="comment">// nodes often generate nop CONCAT_VECTOR nodes.</span></div><div class="line"><a name="l09841"></a><span class="lineno"> 9841</span>&#160;  <span class="comment">// Scan the CONCAT_VECTOR operands and look for a CONCAT operations that</span></div><div class="line"><a name="l09842"></a><span class="lineno"> 9842</span>&#160;  <span class="comment">// place the incoming vectors at the exact same location.</span></div><div class="line"><a name="l09843"></a><span class="lineno"> 9843</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> SingleSource = <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l09844"></a><span class="lineno"> 9844</span>&#160;  <span class="keywordtype">unsigned</span> PartNumElem = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>().<a class="code" href="structllvm_1_1EVT.html#a42bca41d2438197c12b6db2c710a959c">getVectorNumElements</a>();</div><div class="line"><a name="l09845"></a><span class="lineno"> 9845</span>&#160;</div><div class="line"><a name="l09846"></a><span class="lineno"> 9846</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0, e = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#abc5c2f1d47a517373030133c6a102106">getNumOperands</a>(); <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != e; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l09847"></a><span class="lineno"> 9847</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Op = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l09848"></a><span class="lineno"> 9848</span>&#160;</div><div class="line"><a name="l09849"></a><span class="lineno"> 9849</span>&#160;    <span class="keywordflow">if</span> (Op.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7c6d8f265e9e16e5debdb9a536b55d3d">ISD::UNDEF</a>)</div><div class="line"><a name="l09850"></a><span class="lineno"> 9850</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l09851"></a><span class="lineno"> 9851</span>&#160;</div><div class="line"><a name="l09852"></a><span class="lineno"> 9852</span>&#160;    <span class="comment">// Check if this is the identity extract:</span></div><div class="line"><a name="l09853"></a><span class="lineno"> 9853</span>&#160;    <span class="keywordflow">if</span> (Op.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() != <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9070de8a5c5b71851732c4c54e2ffedf">ISD::EXTRACT_SUBVECTOR</a>)</div><div class="line"><a name="l09854"></a><span class="lineno"> 9854</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l09855"></a><span class="lineno"> 9855</span>&#160;</div><div class="line"><a name="l09856"></a><span class="lineno"> 9856</span>&#160;    <span class="comment">// Find the single incoming vector for the extract_subvector.</span></div><div class="line"><a name="l09857"></a><span class="lineno"> 9857</span>&#160;    <span class="keywordflow">if</span> (SingleSource.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()) {</div><div class="line"><a name="l09858"></a><span class="lineno"> 9858</span>&#160;      <span class="keywordflow">if</span> (Op.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0) != SingleSource)</div><div class="line"><a name="l09859"></a><span class="lineno"> 9859</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l09860"></a><span class="lineno"> 9860</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l09861"></a><span class="lineno"> 9861</span>&#160;      SingleSource = Op.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0);</div><div class="line"><a name="l09862"></a><span class="lineno"> 9862</span>&#160;</div><div class="line"><a name="l09863"></a><span class="lineno"> 9863</span>&#160;      <span class="comment">// Check the source type is the same as the type of the result.</span></div><div class="line"><a name="l09864"></a><span class="lineno"> 9864</span>&#160;      <span class="comment">// If not, this concat may extend the vector, so we can not</span></div><div class="line"><a name="l09865"></a><span class="lineno"> 9865</span>&#160;      <span class="comment">// optimize it away.</span></div><div class="line"><a name="l09866"></a><span class="lineno"> 9866</span>&#160;      <span class="keywordflow">if</span> (SingleSource.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>() != N-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(0))</div><div class="line"><a name="l09867"></a><span class="lineno"> 9867</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l09868"></a><span class="lineno"> 9868</span>&#160;    }</div><div class="line"><a name="l09869"></a><span class="lineno"> 9869</span>&#160;</div><div class="line"><a name="l09870"></a><span class="lineno"> 9870</span>&#160;    <span class="keywordtype">unsigned</span> IdentityIndex = <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> * PartNumElem;</div><div class="line"><a name="l09871"></a><span class="lineno"> 9871</span>&#160;    <a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a> *CS = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a>&gt;(Op.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1));</div><div class="line"><a name="l09872"></a><span class="lineno"> 9872</span>&#160;    <span class="comment">// The extract index must be constant.</span></div><div class="line"><a name="l09873"></a><span class="lineno"> 9873</span>&#160;    <span class="keywordflow">if</span> (!CS)</div><div class="line"><a name="l09874"></a><span class="lineno"> 9874</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l09875"></a><span class="lineno"> 9875</span>&#160;</div><div class="line"><a name="l09876"></a><span class="lineno"> 9876</span>&#160;    <span class="comment">// Check that we are reading from the identity index.</span></div><div class="line"><a name="l09877"></a><span class="lineno"> 9877</span>&#160;    <span class="keywordflow">if</span> (CS-&gt;<a class="code" href="classllvm_1_1ConstantSDNode.html#a1e9365c991dd55e65e9d5ab5653812e4">getZExtValue</a>() != IdentityIndex)</div><div class="line"><a name="l09878"></a><span class="lineno"> 9878</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l09879"></a><span class="lineno"> 9879</span>&#160;  }</div><div class="line"><a name="l09880"></a><span class="lineno"> 9880</span>&#160;</div><div class="line"><a name="l09881"></a><span class="lineno"> 9881</span>&#160;  <span class="keywordflow">if</span> (SingleSource.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>())</div><div class="line"><a name="l09882"></a><span class="lineno"> 9882</span>&#160;    <span class="keywordflow">return</span> SingleSource;</div><div class="line"><a name="l09883"></a><span class="lineno"> 9883</span>&#160;</div><div class="line"><a name="l09884"></a><span class="lineno"> 9884</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l09885"></a><span class="lineno"> 9885</span>&#160;}</div><div class="line"><a name="l09886"></a><span class="lineno"> 9886</span>&#160;</div><div class="line"><a name="l09887"></a><span class="lineno"> 9887</span>&#160;<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::visitEXTRACT_SUBVECTOR(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a>* N) {</div><div class="line"><a name="l09888"></a><span class="lineno"> 9888</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> NVT = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(0);</div><div class="line"><a name="l09889"></a><span class="lineno"> 9889</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> V = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0);</div><div class="line"><a name="l09890"></a><span class="lineno"> 9890</span>&#160;</div><div class="line"><a name="l09891"></a><span class="lineno"> 9891</span>&#160;  <span class="keywordflow">if</span> (V-&gt;<a class="code" href="classllvm_1_1SDNode.html#af0d328f3f61168f4ea7d6e4044af4f97">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a320898056eadc3254fc601e1362eb9f5">ISD::CONCAT_VECTORS</a>) {</div><div class="line"><a name="l09892"></a><span class="lineno"> 9892</span>&#160;    <span class="comment">// Combine:</span></div><div class="line"><a name="l09893"></a><span class="lineno"> 9893</span>&#160;    <span class="comment">//    (extract_subvec (concat V1, V2, ...), i)</span></div><div class="line"><a name="l09894"></a><span class="lineno"> 9894</span>&#160;    <span class="comment">// Into:</span></div><div class="line"><a name="l09895"></a><span class="lineno"> 9895</span>&#160;    <span class="comment">//    Vi if possible</span></div><div class="line"><a name="l09896"></a><span class="lineno"> 9896</span>&#160;    <span class="comment">// Only operand 0 is checked as &#39;concat&#39; assumes all inputs of the same</span></div><div class="line"><a name="l09897"></a><span class="lineno"> 9897</span>&#160;    <span class="comment">// type.</span></div><div class="line"><a name="l09898"></a><span class="lineno"> 9898</span>&#160;    <span class="keywordflow">if</span> (V-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>() != NVT)</div><div class="line"><a name="l09899"></a><span class="lineno"> 9899</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l09900"></a><span class="lineno"> 9900</span>&#160;    <span class="keywordtype">unsigned</span> Idx = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a>&gt;(N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(1))-&gt;getZExtValue();</div><div class="line"><a name="l09901"></a><span class="lineno"> 9901</span>&#160;    <span class="keywordtype">unsigned</span> NumElems = NVT.<a class="code" href="structllvm_1_1EVT.html#a42bca41d2438197c12b6db2c710a959c">getVectorNumElements</a>();</div><div class="line"><a name="l09902"></a><span class="lineno"> 9902</span>&#160;    assert((Idx % NumElems) == 0 &amp;&amp;</div><div class="line"><a name="l09903"></a><span class="lineno"> 9903</span>&#160;           <span class="stringliteral">&quot;IDX in concat is not a multiple of the result vector length.&quot;</span>);</div><div class="line"><a name="l09904"></a><span class="lineno"> 9904</span>&#160;    <span class="keywordflow">return</span> V-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(Idx / NumElems);</div><div class="line"><a name="l09905"></a><span class="lineno"> 9905</span>&#160;  }</div><div class="line"><a name="l09906"></a><span class="lineno"> 9906</span>&#160;</div><div class="line"><a name="l09907"></a><span class="lineno"> 9907</span>&#160;  <span class="comment">// Skip bitcasting</span></div><div class="line"><a name="l09908"></a><span class="lineno"> 9908</span>&#160;  <span class="keywordflow">if</span> (V-&gt;<a class="code" href="classllvm_1_1SDNode.html#af0d328f3f61168f4ea7d6e4044af4f97">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a412ddf522b53f07690a86bffba1278e7">ISD::BITCAST</a>)</div><div class="line"><a name="l09909"></a><span class="lineno"> 9909</span>&#160;    V = V.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0);</div><div class="line"><a name="l09910"></a><span class="lineno"> 9910</span>&#160;</div><div class="line"><a name="l09911"></a><span class="lineno"> 9911</span>&#160;  <span class="keywordflow">if</span> (V-&gt;<a class="code" href="classllvm_1_1SDNode.html#af0d328f3f61168f4ea7d6e4044af4f97">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a1617abaedbb1d902bb3a5b3136684f9c">ISD::INSERT_SUBVECTOR</a>) {</div><div class="line"><a name="l09912"></a><span class="lineno"> 9912</span>&#160;    <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a> dl(N);</div><div class="line"><a name="l09913"></a><span class="lineno"> 9913</span>&#160;    <span class="comment">// Handle only simple case where vector being inserted and vector</span></div><div class="line"><a name="l09914"></a><span class="lineno"> 9914</span>&#160;    <span class="comment">// being extracted are of same type, and are half size of larger vectors.</span></div><div class="line"><a name="l09915"></a><span class="lineno"> 9915</span>&#160;    <a class="code" href="structllvm_1_1EVT.html">EVT</a> BigVT = V-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>();</div><div class="line"><a name="l09916"></a><span class="lineno"> 9916</span>&#160;    <a class="code" href="structllvm_1_1EVT.html">EVT</a> SmallVT = V-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(1).<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>();</div><div class="line"><a name="l09917"></a><span class="lineno"> 9917</span>&#160;    <span class="keywordflow">if</span> (!NVT.<a class="code" href="structllvm_1_1EVT.html#ab8f0e414facbed711a9754687bdcd23f">bitsEq</a>(SmallVT) || NVT.<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>()*2 != BigVT.<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>())</div><div class="line"><a name="l09918"></a><span class="lineno"> 9918</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l09919"></a><span class="lineno"> 9919</span>&#160;</div><div class="line"><a name="l09920"></a><span class="lineno"> 9920</span>&#160;    <span class="comment">// Only handle cases where both indexes are constants with the same type.</span></div><div class="line"><a name="l09921"></a><span class="lineno"> 9921</span>&#160;    <a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a> *ExtIdx = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a>&gt;(N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(1));</div><div class="line"><a name="l09922"></a><span class="lineno"> 9922</span>&#160;    <a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a> *InsIdx = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a>&gt;(V-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(2));</div><div class="line"><a name="l09923"></a><span class="lineno"> 9923</span>&#160;</div><div class="line"><a name="l09924"></a><span class="lineno"> 9924</span>&#160;    <span class="keywordflow">if</span> (InsIdx &amp;&amp; ExtIdx &amp;&amp;</div><div class="line"><a name="l09925"></a><span class="lineno"> 9925</span>&#160;        InsIdx-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(0).<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>() &lt;= 64 &amp;&amp;</div><div class="line"><a name="l09926"></a><span class="lineno"> 9926</span>&#160;        ExtIdx-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(0).<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>() &lt;= 64) {</div><div class="line"><a name="l09927"></a><span class="lineno"> 9927</span>&#160;      <span class="comment">// Combine:</span></div><div class="line"><a name="l09928"></a><span class="lineno"> 9928</span>&#160;      <span class="comment">//    (extract_subvec (insert_subvec V1, V2, InsIdx), ExtIdx)</span></div><div class="line"><a name="l09929"></a><span class="lineno"> 9929</span>&#160;      <span class="comment">// Into:</span></div><div class="line"><a name="l09930"></a><span class="lineno"> 9930</span>&#160;      <span class="comment">//    indices are equal or bit offsets are equal =&gt; V1</span></div><div class="line"><a name="l09931"></a><span class="lineno"> 9931</span>&#160;      <span class="comment">//    otherwise =&gt; (extract_subvec V1, ExtIdx)</span></div><div class="line"><a name="l09932"></a><span class="lineno"> 9932</span>&#160;      <span class="keywordflow">if</span> (InsIdx-&gt;getZExtValue() * SmallVT.<a class="code" href="structllvm_1_1EVT.html#a15be9767d0aad93fe5dcb60b7b7a78da">getScalarType</a>().<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>() ==</div><div class="line"><a name="l09933"></a><span class="lineno"> 9933</span>&#160;          ExtIdx-&gt;<a class="code" href="classllvm_1_1ConstantSDNode.html#a1e9365c991dd55e65e9d5ab5653812e4">getZExtValue</a>() * NVT.<a class="code" href="structllvm_1_1EVT.html#a15be9767d0aad93fe5dcb60b7b7a78da">getScalarType</a>().<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>())</div><div class="line"><a name="l09934"></a><span class="lineno"> 9934</span>&#160;        <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a412ddf522b53f07690a86bffba1278e7">ISD::BITCAST</a>, dl, NVT, V-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(1));</div><div class="line"><a name="l09935"></a><span class="lineno"> 9935</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9070de8a5c5b71851732c4c54e2ffedf">ISD::EXTRACT_SUBVECTOR</a>, dl, NVT,</div><div class="line"><a name="l09936"></a><span class="lineno"> 9936</span>&#160;                         DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a412ddf522b53f07690a86bffba1278e7">ISD::BITCAST</a>, dl,</div><div class="line"><a name="l09937"></a><span class="lineno"> 9937</span>&#160;                                     N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>(),</div><div class="line"><a name="l09938"></a><span class="lineno"> 9938</span>&#160;                                     V-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0)), N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(1));</div><div class="line"><a name="l09939"></a><span class="lineno"> 9939</span>&#160;    }</div><div class="line"><a name="l09940"></a><span class="lineno"> 9940</span>&#160;  }</div><div class="line"><a name="l09941"></a><span class="lineno"> 9941</span>&#160;</div><div class="line"><a name="l09942"></a><span class="lineno"> 9942</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l09943"></a><span class="lineno"> 9943</span>&#160;}</div><div class="line"><a name="l09944"></a><span class="lineno"> 9944</span>&#160;</div><div class="line"><a name="l09945"></a><span class="lineno"> 9945</span>&#160;<span class="comment">// Tries to turn a shuffle of two CONCAT_VECTORS into a single concat.</span></div><div class="line"><a name="l09946"></a><span class="lineno"><a class="line" href="DAGCombiner_8cpp.html#a466591fe7edc07ef1ffac406020984bd"> 9946</a></span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> <a class="code" href="DAGCombiner_8cpp.html#a466591fe7edc07ef1ffac406020984bd">partitionShuffleOfConcats</a>(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N, <a class="code" href="classllvm_1_1SelectionDAG.html">SelectionDAG</a> &amp;DAG) {</div><div class="line"><a name="l09947"></a><span class="lineno"> 9947</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> VT = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(0);</div><div class="line"><a name="l09948"></a><span class="lineno"> 9948</span>&#160;  <span class="keywordtype">unsigned</span> NumElts = VT.<a class="code" href="structllvm_1_1EVT.html#a42bca41d2438197c12b6db2c710a959c">getVectorNumElements</a>();</div><div class="line"><a name="l09949"></a><span class="lineno"> 9949</span>&#160;</div><div class="line"><a name="l09950"></a><span class="lineno"> 9950</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N0 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0);</div><div class="line"><a name="l09951"></a><span class="lineno"> 9951</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N1 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(1);</div><div class="line"><a name="l09952"></a><span class="lineno"> 9952</span>&#160;  <a class="code" href="classllvm_1_1ShuffleVectorSDNode.html">ShuffleVectorSDNode</a> *SVN = cast&lt;ShuffleVectorSDNode&gt;(<a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>);</div><div class="line"><a name="l09953"></a><span class="lineno"> 9953</span>&#160;</div><div class="line"><a name="l09954"></a><span class="lineno"> 9954</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;SDValue, 4&gt;</a> Ops;</div><div class="line"><a name="l09955"></a><span class="lineno"> 9955</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> ConcatVT = N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>();</div><div class="line"><a name="l09956"></a><span class="lineno"> 9956</span>&#160;  <span class="keywordtype">unsigned</span> NumElemsPerConcat = ConcatVT.<a class="code" href="structllvm_1_1EVT.html#a42bca41d2438197c12b6db2c710a959c">getVectorNumElements</a>();</div><div class="line"><a name="l09957"></a><span class="lineno"> 9957</span>&#160;  <span class="keywordtype">unsigned</span> NumConcats = NumElts / NumElemsPerConcat;</div><div class="line"><a name="l09958"></a><span class="lineno"> 9958</span>&#160;</div><div class="line"><a name="l09959"></a><span class="lineno"> 9959</span>&#160;  <span class="comment">// Look at every vector that&#39;s inserted. We&#39;re looking for exact</span></div><div class="line"><a name="l09960"></a><span class="lineno"> 9960</span>&#160;  <span class="comment">// subvector-sized copies from a concatenated vector</span></div><div class="line"><a name="l09961"></a><span class="lineno"> 9961</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = 0; <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> != NumConcats; ++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div><div class="line"><a name="l09962"></a><span class="lineno"> 9962</span>&#160;    <span class="comment">// Make sure we&#39;re dealing with a copy.</span></div><div class="line"><a name="l09963"></a><span class="lineno"> 9963</span>&#160;    <span class="keywordtype">unsigned</span> Begin = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> * NumElemsPerConcat;</div><div class="line"><a name="l09964"></a><span class="lineno"> 9964</span>&#160;    <span class="keywordtype">bool</span> AllUndef = <span class="keyword">true</span>, NoUndef = <span class="keyword">true</span>;</div><div class="line"><a name="l09965"></a><span class="lineno"> 9965</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> J = Begin; J != Begin + NumElemsPerConcat; ++J) {</div><div class="line"><a name="l09966"></a><span class="lineno"> 9966</span>&#160;      <span class="keywordflow">if</span> (SVN-&gt;<a class="code" href="classllvm_1_1ShuffleVectorSDNode.html#aae5468704c119f87dceb6728814b5502">getMaskElt</a>(J) &gt;= 0)</div><div class="line"><a name="l09967"></a><span class="lineno"> 9967</span>&#160;        AllUndef = <span class="keyword">false</span>;</div><div class="line"><a name="l09968"></a><span class="lineno"> 9968</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l09969"></a><span class="lineno"> 9969</span>&#160;        NoUndef = <span class="keyword">false</span>;</div><div class="line"><a name="l09970"></a><span class="lineno"> 9970</span>&#160;    }</div><div class="line"><a name="l09971"></a><span class="lineno"> 9971</span>&#160;</div><div class="line"><a name="l09972"></a><span class="lineno"> 9972</span>&#160;    <span class="keywordflow">if</span> (NoUndef) {</div><div class="line"><a name="l09973"></a><span class="lineno"> 9973</span>&#160;      <span class="keywordflow">if</span> (SVN-&gt;<a class="code" href="classllvm_1_1ShuffleVectorSDNode.html#aae5468704c119f87dceb6728814b5502">getMaskElt</a>(Begin) % NumElemsPerConcat != 0)</div><div class="line"><a name="l09974"></a><span class="lineno"> 9974</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l09975"></a><span class="lineno"> 9975</span>&#160;</div><div class="line"><a name="l09976"></a><span class="lineno"> 9976</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> J = 1; J != NumElemsPerConcat; ++J)</div><div class="line"><a name="l09977"></a><span class="lineno"> 9977</span>&#160;        <span class="keywordflow">if</span> (SVN-&gt;<a class="code" href="classllvm_1_1ShuffleVectorSDNode.html#aae5468704c119f87dceb6728814b5502">getMaskElt</a>(Begin + J - 1) + 1 != SVN-&gt;<a class="code" href="classllvm_1_1ShuffleVectorSDNode.html#aae5468704c119f87dceb6728814b5502">getMaskElt</a>(Begin + J))</div><div class="line"><a name="l09978"></a><span class="lineno"> 9978</span>&#160;          <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l09979"></a><span class="lineno"> 9979</span>&#160;</div><div class="line"><a name="l09980"></a><span class="lineno"> 9980</span>&#160;      <span class="keywordtype">unsigned</span> FirstElt = SVN-&gt;<a class="code" href="classllvm_1_1ShuffleVectorSDNode.html#aae5468704c119f87dceb6728814b5502">getMaskElt</a>(Begin) / NumElemsPerConcat;</div><div class="line"><a name="l09981"></a><span class="lineno"> 9981</span>&#160;      <span class="keywordflow">if</span> (FirstElt &lt; N0.<a class="code" href="classllvm_1_1SDValue.html#a5f0447ef8ec128563ad131b76e5062bd">getNumOperands</a>())</div><div class="line"><a name="l09982"></a><span class="lineno"> 9982</span>&#160;        Ops.push_back(N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(FirstElt));</div><div class="line"><a name="l09983"></a><span class="lineno"> 9983</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l09984"></a><span class="lineno"> 9984</span>&#160;        Ops.push_back(N1.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(FirstElt - N0.<a class="code" href="classllvm_1_1SDValue.html#a5f0447ef8ec128563ad131b76e5062bd">getNumOperands</a>()));</div><div class="line"><a name="l09985"></a><span class="lineno"> 9985</span>&#160;</div><div class="line"><a name="l09986"></a><span class="lineno"> 9986</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (AllUndef) {</div><div class="line"><a name="l09987"></a><span class="lineno"> 9987</span>&#160;      Ops.push_back(DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a5b0e59823444a55c295af279611a9d24">getUNDEF</a>(N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>()));</div><div class="line"><a name="l09988"></a><span class="lineno"> 9988</span>&#160;    } <span class="keywordflow">else</span> { <span class="comment">// Mixed with general masks and undefs, can&#39;t do optimization.</span></div><div class="line"><a name="l09989"></a><span class="lineno"> 9989</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l09990"></a><span class="lineno"> 9990</span>&#160;    }</div><div class="line"><a name="l09991"></a><span class="lineno"> 9991</span>&#160;  }</div><div class="line"><a name="l09992"></a><span class="lineno"> 9992</span>&#160;</div><div class="line"><a name="l09993"></a><span class="lineno"> 9993</span>&#160;  <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a320898056eadc3254fc601e1362eb9f5">ISD::CONCAT_VECTORS</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, Ops.data(),</div><div class="line"><a name="l09994"></a><span class="lineno"> 9994</span>&#160;                     Ops.size());</div><div class="line"><a name="l09995"></a><span class="lineno"> 9995</span>&#160;}</div><div class="line"><a name="l09996"></a><span class="lineno"> 9996</span>&#160;</div><div class="line"><a name="l09997"></a><span class="lineno"> 9997</span>&#160;<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::visitVECTOR_SHUFFLE(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N) {</div><div class="line"><a name="l09998"></a><span class="lineno"> 9998</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> VT = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(0);</div><div class="line"><a name="l09999"></a><span class="lineno"> 9999</span>&#160;  <span class="keywordtype">unsigned</span> NumElts = VT.<a class="code" href="structllvm_1_1EVT.html#a42bca41d2438197c12b6db2c710a959c">getVectorNumElements</a>();</div><div class="line"><a name="l10000"></a><span class="lineno">10000</span>&#160;</div><div class="line"><a name="l10001"></a><span class="lineno">10001</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N0 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0);</div><div class="line"><a name="l10002"></a><span class="lineno">10002</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N1 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(1);</div><div class="line"><a name="l10003"></a><span class="lineno">10003</span>&#160;</div><div class="line"><a name="l10004"></a><span class="lineno">10004</span>&#160;  assert(N0.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>() == VT &amp;&amp; <span class="stringliteral">&quot;Vector shuffle must be normalized in DAG&quot;</span>);</div><div class="line"><a name="l10005"></a><span class="lineno">10005</span>&#160;</div><div class="line"><a name="l10006"></a><span class="lineno">10006</span>&#160;  <span class="comment">// Canonicalize shuffle undef, undef -&gt; undef</span></div><div class="line"><a name="l10007"></a><span class="lineno">10007</span>&#160;  <span class="keywordflow">if</span> (N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7c6d8f265e9e16e5debdb9a536b55d3d">ISD::UNDEF</a> &amp;&amp; N1.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7c6d8f265e9e16e5debdb9a536b55d3d">ISD::UNDEF</a>)</div><div class="line"><a name="l10008"></a><span class="lineno">10008</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a5b0e59823444a55c295af279611a9d24">getUNDEF</a>(VT);</div><div class="line"><a name="l10009"></a><span class="lineno">10009</span>&#160;</div><div class="line"><a name="l10010"></a><span class="lineno">10010</span>&#160;  <a class="code" href="classllvm_1_1ShuffleVectorSDNode.html">ShuffleVectorSDNode</a> *SVN = cast&lt;ShuffleVectorSDNode&gt;(<a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>);</div><div class="line"><a name="l10011"></a><span class="lineno">10011</span>&#160;</div><div class="line"><a name="l10012"></a><span class="lineno">10012</span>&#160;  <span class="comment">// Canonicalize shuffle v, v -&gt; v, undef</span></div><div class="line"><a name="l10013"></a><span class="lineno">10013</span>&#160;  <span class="keywordflow">if</span> (N0 == N1) {</div><div class="line"><a name="l10014"></a><span class="lineno">10014</span>&#160;    <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;int, 8&gt;</a> NewMask;</div><div class="line"><a name="l10015"></a><span class="lineno">10015</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != NumElts; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l10016"></a><span class="lineno">10016</span>&#160;      <span class="keywordtype">int</span> Idx = SVN-&gt;<a class="code" href="classllvm_1_1ShuffleVectorSDNode.html#aae5468704c119f87dceb6728814b5502">getMaskElt</a>(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l10017"></a><span class="lineno">10017</span>&#160;      <span class="keywordflow">if</span> (Idx &gt;= (<span class="keywordtype">int</span>)NumElts) Idx -= NumElts;</div><div class="line"><a name="l10018"></a><span class="lineno">10018</span>&#160;      NewMask.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(Idx);</div><div class="line"><a name="l10019"></a><span class="lineno">10019</span>&#160;    }</div><div class="line"><a name="l10020"></a><span class="lineno">10020</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a819041d6f932a577122acfff723fe4af">getVectorShuffle</a>(VT, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), N0, DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a5b0e59823444a55c295af279611a9d24">getUNDEF</a>(VT),</div><div class="line"><a name="l10021"></a><span class="lineno">10021</span>&#160;                                &amp;NewMask[0]);</div><div class="line"><a name="l10022"></a><span class="lineno">10022</span>&#160;  }</div><div class="line"><a name="l10023"></a><span class="lineno">10023</span>&#160;</div><div class="line"><a name="l10024"></a><span class="lineno">10024</span>&#160;  <span class="comment">// Canonicalize shuffle undef, v -&gt; v, undef.  Commute the shuffle mask.</span></div><div class="line"><a name="l10025"></a><span class="lineno">10025</span>&#160;  <span class="keywordflow">if</span> (N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7c6d8f265e9e16e5debdb9a536b55d3d">ISD::UNDEF</a>) {</div><div class="line"><a name="l10026"></a><span class="lineno">10026</span>&#160;    <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;int, 8&gt;</a> NewMask;</div><div class="line"><a name="l10027"></a><span class="lineno">10027</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != NumElts; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l10028"></a><span class="lineno">10028</span>&#160;      <span class="keywordtype">int</span> Idx = SVN-&gt;<a class="code" href="classllvm_1_1ShuffleVectorSDNode.html#aae5468704c119f87dceb6728814b5502">getMaskElt</a>(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l10029"></a><span class="lineno">10029</span>&#160;      <span class="keywordflow">if</span> (Idx &gt;= 0) {</div><div class="line"><a name="l10030"></a><span class="lineno">10030</span>&#160;        <span class="keywordflow">if</span> (Idx &gt;= (<span class="keywordtype">int</span>)NumElts)</div><div class="line"><a name="l10031"></a><span class="lineno">10031</span>&#160;          Idx -= NumElts;</div><div class="line"><a name="l10032"></a><span class="lineno">10032</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l10033"></a><span class="lineno">10033</span>&#160;          Idx = -1; <span class="comment">// remove reference to lhs</span></div><div class="line"><a name="l10034"></a><span class="lineno">10034</span>&#160;      }</div><div class="line"><a name="l10035"></a><span class="lineno">10035</span>&#160;      NewMask.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(Idx);</div><div class="line"><a name="l10036"></a><span class="lineno">10036</span>&#160;    }</div><div class="line"><a name="l10037"></a><span class="lineno">10037</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a819041d6f932a577122acfff723fe4af">getVectorShuffle</a>(VT, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), N1, DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a5b0e59823444a55c295af279611a9d24">getUNDEF</a>(VT),</div><div class="line"><a name="l10038"></a><span class="lineno">10038</span>&#160;                                &amp;NewMask[0]);</div><div class="line"><a name="l10039"></a><span class="lineno">10039</span>&#160;  }</div><div class="line"><a name="l10040"></a><span class="lineno">10040</span>&#160;</div><div class="line"><a name="l10041"></a><span class="lineno">10041</span>&#160;  <span class="comment">// Remove references to rhs if it is undef</span></div><div class="line"><a name="l10042"></a><span class="lineno">10042</span>&#160;  <span class="keywordflow">if</span> (N1.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7c6d8f265e9e16e5debdb9a536b55d3d">ISD::UNDEF</a>) {</div><div class="line"><a name="l10043"></a><span class="lineno">10043</span>&#160;    <span class="keywordtype">bool</span> Changed = <span class="keyword">false</span>;</div><div class="line"><a name="l10044"></a><span class="lineno">10044</span>&#160;    <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;int, 8&gt;</a> NewMask;</div><div class="line"><a name="l10045"></a><span class="lineno">10045</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != NumElts; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l10046"></a><span class="lineno">10046</span>&#160;      <span class="keywordtype">int</span> Idx = SVN-&gt;<a class="code" href="classllvm_1_1ShuffleVectorSDNode.html#aae5468704c119f87dceb6728814b5502">getMaskElt</a>(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l10047"></a><span class="lineno">10047</span>&#160;      <span class="keywordflow">if</span> (Idx &gt;= (<span class="keywordtype">int</span>)NumElts) {</div><div class="line"><a name="l10048"></a><span class="lineno">10048</span>&#160;        Idx = -1;</div><div class="line"><a name="l10049"></a><span class="lineno">10049</span>&#160;        Changed = <span class="keyword">true</span>;</div><div class="line"><a name="l10050"></a><span class="lineno">10050</span>&#160;      }</div><div class="line"><a name="l10051"></a><span class="lineno">10051</span>&#160;      NewMask.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(Idx);</div><div class="line"><a name="l10052"></a><span class="lineno">10052</span>&#160;    }</div><div class="line"><a name="l10053"></a><span class="lineno">10053</span>&#160;    <span class="keywordflow">if</span> (Changed)</div><div class="line"><a name="l10054"></a><span class="lineno">10054</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a819041d6f932a577122acfff723fe4af">getVectorShuffle</a>(VT, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), N0, N1, &amp;NewMask[0]);</div><div class="line"><a name="l10055"></a><span class="lineno">10055</span>&#160;  }</div><div class="line"><a name="l10056"></a><span class="lineno">10056</span>&#160;</div><div class="line"><a name="l10057"></a><span class="lineno">10057</span>&#160;  <span class="comment">// If it is a splat, check if the argument vector is another splat or a</span></div><div class="line"><a name="l10058"></a><span class="lineno">10058</span>&#160;  <span class="comment">// build_vector with all scalar elements the same.</span></div><div class="line"><a name="l10059"></a><span class="lineno">10059</span>&#160;  <span class="keywordflow">if</span> (SVN-&gt;<a class="code" href="classllvm_1_1ShuffleVectorSDNode.html#af2ab7a57d7c0b11e2c3a28e28cc4a46d">isSplat</a>() &amp;&amp; SVN-&gt;<a class="code" href="classllvm_1_1ShuffleVectorSDNode.html#a216b27e62fea4f0ea71d40e28a1523b6">getSplatIndex</a>() &lt; (<a class="code" href="Target_2README_8txt.html#a3217063f680fa8e35dea3c59b6e52b18">int</a>)NumElts) {</div><div class="line"><a name="l10060"></a><span class="lineno">10060</span>&#160;    <a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *V = N0.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>();</div><div class="line"><a name="l10061"></a><span class="lineno">10061</span>&#160;</div><div class="line"><a name="l10062"></a><span class="lineno">10062</span>&#160;    <span class="comment">// If this is a bit convert that changes the element type of the vector but</span></div><div class="line"><a name="l10063"></a><span class="lineno">10063</span>&#160;    <span class="comment">// not the number of vector elements, look through it.  Be careful not to</span></div><div class="line"><a name="l10064"></a><span class="lineno">10064</span>&#160;    <span class="comment">// look though conversions that change things like v4f32 to v2f64.</span></div><div class="line"><a name="l10065"></a><span class="lineno">10065</span>&#160;    <span class="keywordflow">if</span> (V-&gt;<a class="code" href="classllvm_1_1SDNode.html#af0d328f3f61168f4ea7d6e4044af4f97">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a412ddf522b53f07690a86bffba1278e7">ISD::BITCAST</a>) {</div><div class="line"><a name="l10066"></a><span class="lineno">10066</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> ConvInput = V-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0);</div><div class="line"><a name="l10067"></a><span class="lineno">10067</span>&#160;      <span class="keywordflow">if</span> (ConvInput.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>().<a class="code" href="structllvm_1_1EVT.html#a73f7c824cad61a47c21bf6d652ae2fd7">isVector</a>() &amp;&amp;</div><div class="line"><a name="l10068"></a><span class="lineno">10068</span>&#160;          ConvInput.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>().<a class="code" href="structllvm_1_1EVT.html#a42bca41d2438197c12b6db2c710a959c">getVectorNumElements</a>() == NumElts)</div><div class="line"><a name="l10069"></a><span class="lineno">10069</span>&#160;        V = ConvInput.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>();</div><div class="line"><a name="l10070"></a><span class="lineno">10070</span>&#160;    }</div><div class="line"><a name="l10071"></a><span class="lineno">10071</span>&#160;</div><div class="line"><a name="l10072"></a><span class="lineno">10072</span>&#160;    <span class="keywordflow">if</span> (V-&gt;<a class="code" href="classllvm_1_1SDNode.html#af0d328f3f61168f4ea7d6e4044af4f97">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110aff6f73b624fecca7dbe94259f9437e32">ISD::BUILD_VECTOR</a>) {</div><div class="line"><a name="l10073"></a><span class="lineno">10073</span>&#160;      assert(V-&gt;<a class="code" href="classllvm_1_1SDNode.html#abc5c2f1d47a517373030133c6a102106">getNumOperands</a>() == NumElts &amp;&amp;</div><div class="line"><a name="l10074"></a><span class="lineno">10074</span>&#160;             <span class="stringliteral">&quot;BUILD_VECTOR has wrong number of operands&quot;</span>);</div><div class="line"><a name="l10075"></a><span class="lineno">10075</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Base;</div><div class="line"><a name="l10076"></a><span class="lineno">10076</span>&#160;      <span class="keywordtype">bool</span> AllSame = <span class="keyword">true</span>;</div><div class="line"><a name="l10077"></a><span class="lineno">10077</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != NumElts; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l10078"></a><span class="lineno">10078</span>&#160;        <span class="keywordflow">if</span> (V-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>).<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() != <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7c6d8f265e9e16e5debdb9a536b55d3d">ISD::UNDEF</a>) {</div><div class="line"><a name="l10079"></a><span class="lineno">10079</span>&#160;          Base = V-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l10080"></a><span class="lineno">10080</span>&#160;          <span class="keywordflow">break</span>;</div><div class="line"><a name="l10081"></a><span class="lineno">10081</span>&#160;        }</div><div class="line"><a name="l10082"></a><span class="lineno">10082</span>&#160;      }</div><div class="line"><a name="l10083"></a><span class="lineno">10083</span>&#160;      <span class="comment">// Splat of &lt;u, u, u, u&gt;, return &lt;u, u, u, u&gt;</span></div><div class="line"><a name="l10084"></a><span class="lineno">10084</span>&#160;      <span class="keywordflow">if</span> (!Base.getNode())</div><div class="line"><a name="l10085"></a><span class="lineno">10085</span>&#160;        <span class="keywordflow">return</span> N0;</div><div class="line"><a name="l10086"></a><span class="lineno">10086</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != NumElts; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l10087"></a><span class="lineno">10087</span>&#160;        <span class="keywordflow">if</span> (V-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) != Base) {</div><div class="line"><a name="l10088"></a><span class="lineno">10088</span>&#160;          AllSame = <span class="keyword">false</span>;</div><div class="line"><a name="l10089"></a><span class="lineno">10089</span>&#160;          <span class="keywordflow">break</span>;</div><div class="line"><a name="l10090"></a><span class="lineno">10090</span>&#160;        }</div><div class="line"><a name="l10091"></a><span class="lineno">10091</span>&#160;      }</div><div class="line"><a name="l10092"></a><span class="lineno">10092</span>&#160;      <span class="comment">// Splat of &lt;x, x, x, x&gt;, return &lt;x, x, x, x&gt;</span></div><div class="line"><a name="l10093"></a><span class="lineno">10093</span>&#160;      <span class="keywordflow">if</span> (AllSame)</div><div class="line"><a name="l10094"></a><span class="lineno">10094</span>&#160;        <span class="keywordflow">return</span> N0;</div><div class="line"><a name="l10095"></a><span class="lineno">10095</span>&#160;    }</div><div class="line"><a name="l10096"></a><span class="lineno">10096</span>&#160;  }</div><div class="line"><a name="l10097"></a><span class="lineno">10097</span>&#160;</div><div class="line"><a name="l10098"></a><span class="lineno">10098</span>&#160;  <span class="keywordflow">if</span> (N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a320898056eadc3254fc601e1362eb9f5">ISD::CONCAT_VECTORS</a> &amp;&amp;</div><div class="line"><a name="l10099"></a><span class="lineno">10099</span>&#160;      Level &lt; <a class="code" href="namespacellvm.html#aa6d856e4879bb775617f8c3634773b7aa805f5e0d60c9ebc5b134bc9190569a50">AfterLegalizeVectorOps</a> &amp;&amp;</div><div class="line"><a name="l10100"></a><span class="lineno">10100</span>&#160;      (N1.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7c6d8f265e9e16e5debdb9a536b55d3d">ISD::UNDEF</a> ||</div><div class="line"><a name="l10101"></a><span class="lineno">10101</span>&#160;      (N1.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a320898056eadc3254fc601e1362eb9f5">ISD::CONCAT_VECTORS</a> &amp;&amp;</div><div class="line"><a name="l10102"></a><span class="lineno">10102</span>&#160;       N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>() == N1.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>()))) {</div><div class="line"><a name="l10103"></a><span class="lineno">10103</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> V = <a class="code" href="DAGCombiner_8cpp.html#a466591fe7edc07ef1ffac406020984bd">partitionShuffleOfConcats</a>(N, DAG);</div><div class="line"><a name="l10104"></a><span class="lineno">10104</span>&#160;</div><div class="line"><a name="l10105"></a><span class="lineno">10105</span>&#160;    <span class="keywordflow">if</span> (V.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>())</div><div class="line"><a name="l10106"></a><span class="lineno">10106</span>&#160;      <span class="keywordflow">return</span> V;</div><div class="line"><a name="l10107"></a><span class="lineno">10107</span>&#160;  }</div><div class="line"><a name="l10108"></a><span class="lineno">10108</span>&#160;</div><div class="line"><a name="l10109"></a><span class="lineno">10109</span>&#160;  <span class="comment">// If this shuffle node is simply a swizzle of another shuffle node,</span></div><div class="line"><a name="l10110"></a><span class="lineno">10110</span>&#160;  <span class="comment">// and it reverses the swizzle of the previous shuffle then we can</span></div><div class="line"><a name="l10111"></a><span class="lineno">10111</span>&#160;  <span class="comment">// optimize shuffle(shuffle(x, undef), undef) -&gt; x.</span></div><div class="line"><a name="l10112"></a><span class="lineno">10112</span>&#160;  <span class="keywordflow">if</span> (N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a8d8773b28111d8898663d4a0f6223d68">ISD::VECTOR_SHUFFLE</a> &amp;&amp; Level &lt; <a class="code" href="namespacellvm.html#aa6d856e4879bb775617f8c3634773b7aa7fbaa966e5d5ac3bf03ba617b73bff5c">AfterLegalizeDAG</a> &amp;&amp;</div><div class="line"><a name="l10113"></a><span class="lineno">10113</span>&#160;      N1.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7c6d8f265e9e16e5debdb9a536b55d3d">ISD::UNDEF</a>) {</div><div class="line"><a name="l10114"></a><span class="lineno">10114</span>&#160;</div><div class="line"><a name="l10115"></a><span class="lineno">10115</span>&#160;    <a class="code" href="classllvm_1_1ShuffleVectorSDNode.html">ShuffleVectorSDNode</a> *OtherSV = cast&lt;ShuffleVectorSDNode&gt;(N0);</div><div class="line"><a name="l10116"></a><span class="lineno">10116</span>&#160;</div><div class="line"><a name="l10117"></a><span class="lineno">10117</span>&#160;    <span class="comment">// Shuffle nodes can only reverse shuffles with a single non-undef value.</span></div><div class="line"><a name="l10118"></a><span class="lineno">10118</span>&#160;    <span class="keywordflow">if</span> (N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1).<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() != <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7c6d8f265e9e16e5debdb9a536b55d3d">ISD::UNDEF</a>)</div><div class="line"><a name="l10119"></a><span class="lineno">10119</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l10120"></a><span class="lineno">10120</span>&#160;</div><div class="line"><a name="l10121"></a><span class="lineno">10121</span>&#160;    <span class="comment">// The incoming shuffle must be of the same type as the result of the</span></div><div class="line"><a name="l10122"></a><span class="lineno">10122</span>&#160;    <span class="comment">// current shuffle.</span></div><div class="line"><a name="l10123"></a><span class="lineno">10123</span>&#160;    assert(OtherSV-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>() == VT &amp;&amp;</div><div class="line"><a name="l10124"></a><span class="lineno">10124</span>&#160;           <span class="stringliteral">&quot;Shuffle types don&#39;t match&quot;</span>);</div><div class="line"><a name="l10125"></a><span class="lineno">10125</span>&#160;</div><div class="line"><a name="l10126"></a><span class="lineno">10126</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != NumElts; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l10127"></a><span class="lineno">10127</span>&#160;      <span class="keywordtype">int</span> Idx = SVN-&gt;<a class="code" href="classllvm_1_1ShuffleVectorSDNode.html#aae5468704c119f87dceb6728814b5502">getMaskElt</a>(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l10128"></a><span class="lineno">10128</span>&#160;      assert(Idx &lt; (<span class="keywordtype">int</span>)NumElts &amp;&amp; <span class="stringliteral">&quot;Index references undef operand&quot;</span>);</div><div class="line"><a name="l10129"></a><span class="lineno">10129</span>&#160;      <span class="comment">// Next, this index comes from the first value, which is the incoming</span></div><div class="line"><a name="l10130"></a><span class="lineno">10130</span>&#160;      <span class="comment">// shuffle. Adopt the incoming index.</span></div><div class="line"><a name="l10131"></a><span class="lineno">10131</span>&#160;      <span class="keywordflow">if</span> (Idx &gt;= 0)</div><div class="line"><a name="l10132"></a><span class="lineno">10132</span>&#160;        Idx = OtherSV-&gt;<a class="code" href="classllvm_1_1ShuffleVectorSDNode.html#aae5468704c119f87dceb6728814b5502">getMaskElt</a>(Idx);</div><div class="line"><a name="l10133"></a><span class="lineno">10133</span>&#160;</div><div class="line"><a name="l10134"></a><span class="lineno">10134</span>&#160;      <span class="comment">// The combined shuffle must map each index to itself.</span></div><div class="line"><a name="l10135"></a><span class="lineno">10135</span>&#160;      <span class="keywordflow">if</span> (Idx &gt;= 0 &amp;&amp; (<span class="keywordtype">unsigned</span>)Idx != <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div><div class="line"><a name="l10136"></a><span class="lineno">10136</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l10137"></a><span class="lineno">10137</span>&#160;    }</div><div class="line"><a name="l10138"></a><span class="lineno">10138</span>&#160;</div><div class="line"><a name="l10139"></a><span class="lineno">10139</span>&#160;    <span class="keywordflow">return</span> OtherSV-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0);</div><div class="line"><a name="l10140"></a><span class="lineno">10140</span>&#160;  }</div><div class="line"><a name="l10141"></a><span class="lineno">10141</span>&#160;</div><div class="line"><a name="l10142"></a><span class="lineno">10142</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l10143"></a><span class="lineno">10143</span>&#160;}</div><div class="line"><a name="l10144"></a><span class="lineno">10144</span>&#160;<span class="comment"></span></div><div class="line"><a name="l10145"></a><span class="lineno">10145</span>&#160;<span class="comment">/// XformToShuffleWithZero - Returns a vector_shuffle if it able to transform</span></div><div class="line"><a name="l10146"></a><span class="lineno">10146</span>&#160;<span class="comment">/// an AND to a vector_shuffle with the destination vector and a zero vector.</span></div><div class="line"><a name="l10147"></a><span class="lineno">10147</span>&#160;<span class="comment">/// e.g. AND V, &lt;0xffffffff, 0, 0xffffffff, 0&gt;. ==&gt;</span></div><div class="line"><a name="l10148"></a><span class="lineno">10148</span>&#160;<span class="comment">///      vector_shuffle V, Zero, &lt;0, 4, 2, 4&gt;</span></div><div class="line"><a name="l10149"></a><span class="lineno">10149</span>&#160;<span class="comment"></span><a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::XformToShuffleWithZero(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N) {</div><div class="line"><a name="l10150"></a><span class="lineno">10150</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> VT = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(0);</div><div class="line"><a name="l10151"></a><span class="lineno">10151</span>&#160;  <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a> dl(N);</div><div class="line"><a name="l10152"></a><span class="lineno">10152</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> LHS = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0);</div><div class="line"><a name="l10153"></a><span class="lineno">10153</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> RHS = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(1);</div><div class="line"><a name="l10154"></a><span class="lineno">10154</span>&#160;  <span class="keywordflow">if</span> (N-&gt;<a class="code" href="classllvm_1_1SDNode.html#af0d328f3f61168f4ea7d6e4044af4f97">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ac513a7da1bf74fb3e3c594da8534f2d2">ISD::AND</a>) {</div><div class="line"><a name="l10155"></a><span class="lineno">10155</span>&#160;    <span class="keywordflow">if</span> (RHS.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a412ddf522b53f07690a86bffba1278e7">ISD::BITCAST</a>)</div><div class="line"><a name="l10156"></a><span class="lineno">10156</span>&#160;      RHS = RHS.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0);</div><div class="line"><a name="l10157"></a><span class="lineno">10157</span>&#160;    <span class="keywordflow">if</span> (RHS.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110aff6f73b624fecca7dbe94259f9437e32">ISD::BUILD_VECTOR</a>) {</div><div class="line"><a name="l10158"></a><span class="lineno">10158</span>&#160;      <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;int, 8&gt;</a> Indices;</div><div class="line"><a name="l10159"></a><span class="lineno">10159</span>&#160;      <span class="keywordtype">unsigned</span> NumElts = RHS.<a class="code" href="classllvm_1_1SDValue.html#a5f0447ef8ec128563ad131b76e5062bd">getNumOperands</a>();</div><div class="line"><a name="l10160"></a><span class="lineno">10160</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != NumElts; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l10161"></a><span class="lineno">10161</span>&#160;        <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Elt = RHS.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l10162"></a><span class="lineno">10162</span>&#160;        <span class="keywordflow">if</span> (!isa&lt;ConstantSDNode&gt;(Elt))</div><div class="line"><a name="l10163"></a><span class="lineno">10163</span>&#160;          <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l10164"></a><span class="lineno">10164</span>&#160;</div><div class="line"><a name="l10165"></a><span class="lineno">10165</span>&#160;        <span class="keywordflow">if</span> (cast&lt;ConstantSDNode&gt;(Elt)-&gt;isAllOnesValue())</div><div class="line"><a name="l10166"></a><span class="lineno">10166</span>&#160;          Indices.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l10167"></a><span class="lineno">10167</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (cast&lt;ConstantSDNode&gt;(Elt)-&gt;isNullValue())</div><div class="line"><a name="l10168"></a><span class="lineno">10168</span>&#160;          Indices.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(NumElts);</div><div class="line"><a name="l10169"></a><span class="lineno">10169</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l10170"></a><span class="lineno">10170</span>&#160;          <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l10171"></a><span class="lineno">10171</span>&#160;      }</div><div class="line"><a name="l10172"></a><span class="lineno">10172</span>&#160;</div><div class="line"><a name="l10173"></a><span class="lineno">10173</span>&#160;      <span class="comment">// Let&#39;s see if the target supports this vector_shuffle.</span></div><div class="line"><a name="l10174"></a><span class="lineno">10174</span>&#160;      <a class="code" href="structllvm_1_1EVT.html">EVT</a> RVT = RHS.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>();</div><div class="line"><a name="l10175"></a><span class="lineno">10175</span>&#160;      <span class="keywordflow">if</span> (!TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a8612b7f63f97d7056a6c0858272e9edf">isVectorClearMaskLegal</a>(Indices, RVT))</div><div class="line"><a name="l10176"></a><span class="lineno">10176</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l10177"></a><span class="lineno">10177</span>&#160;</div><div class="line"><a name="l10178"></a><span class="lineno">10178</span>&#160;      <span class="comment">// Return the new VECTOR_SHUFFLE node.</span></div><div class="line"><a name="l10179"></a><span class="lineno">10179</span>&#160;      <a class="code" href="structllvm_1_1EVT.html">EVT</a> EltVT = RVT.<a class="code" href="structllvm_1_1EVT.html#a3a07c062cc9330acd8e8c4e3930cbb25">getVectorElementType</a>();</div><div class="line"><a name="l10180"></a><span class="lineno">10180</span>&#160;      <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;SDValue,8&gt;</a> ZeroOps(RVT.<a class="code" href="structllvm_1_1EVT.html#a42bca41d2438197c12b6db2c710a959c">getVectorNumElements</a>(),</div><div class="line"><a name="l10181"></a><span class="lineno">10181</span>&#160;                                     DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(0, EltVT));</div><div class="line"><a name="l10182"></a><span class="lineno">10182</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Zero = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110aff6f73b624fecca7dbe94259f9437e32">ISD::BUILD_VECTOR</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N),</div><div class="line"><a name="l10183"></a><span class="lineno">10183</span>&#160;                                 RVT, &amp;ZeroOps[0], ZeroOps.size());</div><div class="line"><a name="l10184"></a><span class="lineno">10184</span>&#160;      LHS = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a412ddf522b53f07690a86bffba1278e7">ISD::BITCAST</a>, dl, RVT, LHS);</div><div class="line"><a name="l10185"></a><span class="lineno">10185</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Shuf = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a819041d6f932a577122acfff723fe4af">getVectorShuffle</a>(RVT, dl, LHS, Zero, &amp;Indices[0]);</div><div class="line"><a name="l10186"></a><span class="lineno">10186</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a412ddf522b53f07690a86bffba1278e7">ISD::BITCAST</a>, dl, VT, Shuf);</div><div class="line"><a name="l10187"></a><span class="lineno">10187</span>&#160;    }</div><div class="line"><a name="l10188"></a><span class="lineno">10188</span>&#160;  }</div><div class="line"><a name="l10189"></a><span class="lineno">10189</span>&#160;</div><div class="line"><a name="l10190"></a><span class="lineno">10190</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l10191"></a><span class="lineno">10191</span>&#160;}</div><div class="line"><a name="l10192"></a><span class="lineno">10192</span>&#160;<span class="comment"></span></div><div class="line"><a name="l10193"></a><span class="lineno">10193</span>&#160;<span class="comment">/// SimplifyVBinOp - Visit a binary vector operation, like ADD.</span></div><div class="line"><a name="l10194"></a><span class="lineno">10194</span>&#160;<span class="comment"></span><a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::SimplifyVBinOp(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N) {</div><div class="line"><a name="l10195"></a><span class="lineno">10195</span>&#160;  assert(N-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(0).<a class="code" href="structllvm_1_1EVT.html#a73f7c824cad61a47c21bf6d652ae2fd7">isVector</a>() &amp;&amp;</div><div class="line"><a name="l10196"></a><span class="lineno">10196</span>&#160;         <span class="stringliteral">&quot;SimplifyVBinOp only works on vectors!&quot;</span>);</div><div class="line"><a name="l10197"></a><span class="lineno">10197</span>&#160;</div><div class="line"><a name="l10198"></a><span class="lineno">10198</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> LHS = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0);</div><div class="line"><a name="l10199"></a><span class="lineno">10199</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> RHS = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(1);</div><div class="line"><a name="l10200"></a><span class="lineno">10200</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Shuffle = XformToShuffleWithZero(N);</div><div class="line"><a name="l10201"></a><span class="lineno">10201</span>&#160;  <span class="keywordflow">if</span> (Shuffle.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()) <span class="keywordflow">return</span> Shuffle;</div><div class="line"><a name="l10202"></a><span class="lineno">10202</span>&#160;</div><div class="line"><a name="l10203"></a><span class="lineno">10203</span>&#160;  <span class="comment">// If the LHS and RHS are BUILD_VECTOR nodes, see if we can constant fold</span></div><div class="line"><a name="l10204"></a><span class="lineno">10204</span>&#160;  <span class="comment">// this operation.</span></div><div class="line"><a name="l10205"></a><span class="lineno">10205</span>&#160;  <span class="keywordflow">if</span> (LHS.getOpcode() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110aff6f73b624fecca7dbe94259f9437e32">ISD::BUILD_VECTOR</a> &amp;&amp;</div><div class="line"><a name="l10206"></a><span class="lineno">10206</span>&#160;      RHS.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110aff6f73b624fecca7dbe94259f9437e32">ISD::BUILD_VECTOR</a>) {</div><div class="line"><a name="l10207"></a><span class="lineno">10207</span>&#160;    <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;SDValue, 8&gt;</a> Ops;</div><div class="line"><a name="l10208"></a><span class="lineno">10208</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0, e = LHS.getNumOperands(); <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != e; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l10209"></a><span class="lineno">10209</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> LHSOp = LHS.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l10210"></a><span class="lineno">10210</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> RHSOp = RHS.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l10211"></a><span class="lineno">10211</span>&#160;      <span class="comment">// If these two elements can&#39;t be folded, bail out.</span></div><div class="line"><a name="l10212"></a><span class="lineno">10212</span>&#160;      <span class="keywordflow">if</span> ((LHSOp.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() != <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7c6d8f265e9e16e5debdb9a536b55d3d">ISD::UNDEF</a> &amp;&amp;</div><div class="line"><a name="l10213"></a><span class="lineno">10213</span>&#160;           LHSOp.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() != <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110aac2f0a84dd2aa5ee4c3f1385e9565f5e">ISD::Constant</a> &amp;&amp;</div><div class="line"><a name="l10214"></a><span class="lineno">10214</span>&#160;           LHSOp.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() != <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a1be4c8da7c68a4c683de1a98b5cc5b9d">ISD::ConstantFP</a>) ||</div><div class="line"><a name="l10215"></a><span class="lineno">10215</span>&#160;          (RHSOp.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() != <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7c6d8f265e9e16e5debdb9a536b55d3d">ISD::UNDEF</a> &amp;&amp;</div><div class="line"><a name="l10216"></a><span class="lineno">10216</span>&#160;           RHSOp.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() != <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110aac2f0a84dd2aa5ee4c3f1385e9565f5e">ISD::Constant</a> &amp;&amp;</div><div class="line"><a name="l10217"></a><span class="lineno">10217</span>&#160;           RHSOp.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() != <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a1be4c8da7c68a4c683de1a98b5cc5b9d">ISD::ConstantFP</a>))</div><div class="line"><a name="l10218"></a><span class="lineno">10218</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l10219"></a><span class="lineno">10219</span>&#160;</div><div class="line"><a name="l10220"></a><span class="lineno">10220</span>&#160;      <span class="comment">// Can&#39;t fold divide by zero.</span></div><div class="line"><a name="l10221"></a><span class="lineno">10221</span>&#160;      <span class="keywordflow">if</span> (N-&gt;<a class="code" href="classllvm_1_1SDNode.html#af0d328f3f61168f4ea7d6e4044af4f97">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a1f61c2422057e10403b2f6003543c300">ISD::SDIV</a> || N-&gt;<a class="code" href="classllvm_1_1SDNode.html#af0d328f3f61168f4ea7d6e4044af4f97">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a15637879021fa7d5226045c0668a99a8">ISD::UDIV</a> ||</div><div class="line"><a name="l10222"></a><span class="lineno">10222</span>&#160;          N-&gt;<a class="code" href="classllvm_1_1SDNode.html#af0d328f3f61168f4ea7d6e4044af4f97">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110abc6c09c7af98236460f0b020eb3be94e">ISD::FDIV</a>) {</div><div class="line"><a name="l10223"></a><span class="lineno">10223</span>&#160;        <span class="keywordflow">if</span> ((RHSOp.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110aac2f0a84dd2aa5ee4c3f1385e9565f5e">ISD::Constant</a> &amp;&amp;</div><div class="line"><a name="l10224"></a><span class="lineno">10224</span>&#160;             cast&lt;ConstantSDNode&gt;(RHSOp.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>())-&gt;isNullValue()) ||</div><div class="line"><a name="l10225"></a><span class="lineno">10225</span>&#160;            (RHSOp.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a1be4c8da7c68a4c683de1a98b5cc5b9d">ISD::ConstantFP</a> &amp;&amp;</div><div class="line"><a name="l10226"></a><span class="lineno">10226</span>&#160;             cast&lt;ConstantFPSDNode&gt;(RHSOp.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>())-&gt;getValueAPF().isZero()))</div><div class="line"><a name="l10227"></a><span class="lineno">10227</span>&#160;          <span class="keywordflow">break</span>;</div><div class="line"><a name="l10228"></a><span class="lineno">10228</span>&#160;      }</div><div class="line"><a name="l10229"></a><span class="lineno">10229</span>&#160;</div><div class="line"><a name="l10230"></a><span class="lineno">10230</span>&#160;      <a class="code" href="structllvm_1_1EVT.html">EVT</a> VT = LHSOp.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>();</div><div class="line"><a name="l10231"></a><span class="lineno">10231</span>&#160;      <a class="code" href="structllvm_1_1EVT.html">EVT</a> RVT = RHSOp.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>();</div><div class="line"><a name="l10232"></a><span class="lineno">10232</span>&#160;      <span class="keywordflow">if</span> (RVT != VT) {</div><div class="line"><a name="l10233"></a><span class="lineno">10233</span>&#160;        <span class="comment">// Integer BUILD_VECTOR operands may have types larger than the element</span></div><div class="line"><a name="l10234"></a><span class="lineno">10234</span>&#160;        <span class="comment">// size (e.g., when the element type is not legal).  Prior to type</span></div><div class="line"><a name="l10235"></a><span class="lineno">10235</span>&#160;        <span class="comment">// legalization, the types may not match between the two BUILD_VECTORS.</span></div><div class="line"><a name="l10236"></a><span class="lineno">10236</span>&#160;        <span class="comment">// Truncate one of the operands to make them match.</span></div><div class="line"><a name="l10237"></a><span class="lineno">10237</span>&#160;        <span class="keywordflow">if</span> (RVT.<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>() &gt; VT.<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>()) {</div><div class="line"><a name="l10238"></a><span class="lineno">10238</span>&#160;          RHSOp = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ae690127648393001a7d5b93dc23da7b3">ISD::TRUNCATE</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), VT, RHSOp);</div><div class="line"><a name="l10239"></a><span class="lineno">10239</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l10240"></a><span class="lineno">10240</span>&#160;          LHSOp = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ae690127648393001a7d5b93dc23da7b3">ISD::TRUNCATE</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), RVT, LHSOp);</div><div class="line"><a name="l10241"></a><span class="lineno">10241</span>&#160;          VT = RVT;</div><div class="line"><a name="l10242"></a><span class="lineno">10242</span>&#160;        }</div><div class="line"><a name="l10243"></a><span class="lineno">10243</span>&#160;      }</div><div class="line"><a name="l10244"></a><span class="lineno">10244</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> FoldOp = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(N-&gt;<a class="code" href="classllvm_1_1SDNode.html#af0d328f3f61168f4ea7d6e4044af4f97">getOpcode</a>(), <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(LHS), VT,</div><div class="line"><a name="l10245"></a><span class="lineno">10245</span>&#160;                                   LHSOp, RHSOp);</div><div class="line"><a name="l10246"></a><span class="lineno">10246</span>&#160;      <span class="keywordflow">if</span> (FoldOp.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() != <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7c6d8f265e9e16e5debdb9a536b55d3d">ISD::UNDEF</a> &amp;&amp;</div><div class="line"><a name="l10247"></a><span class="lineno">10247</span>&#160;          FoldOp.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() != <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110aac2f0a84dd2aa5ee4c3f1385e9565f5e">ISD::Constant</a> &amp;&amp;</div><div class="line"><a name="l10248"></a><span class="lineno">10248</span>&#160;          FoldOp.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() != <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a1be4c8da7c68a4c683de1a98b5cc5b9d">ISD::ConstantFP</a>)</div><div class="line"><a name="l10249"></a><span class="lineno">10249</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l10250"></a><span class="lineno">10250</span>&#160;      Ops.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(FoldOp);</div><div class="line"><a name="l10251"></a><span class="lineno">10251</span>&#160;      AddToWorkList(FoldOp.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l10252"></a><span class="lineno">10252</span>&#160;    }</div><div class="line"><a name="l10253"></a><span class="lineno">10253</span>&#160;</div><div class="line"><a name="l10254"></a><span class="lineno">10254</span>&#160;    <span class="keywordflow">if</span> (Ops.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#a22a311dfe4c28a897de8a9365a4f0a84">size</a>() == LHS.getNumOperands())</div><div class="line"><a name="l10255"></a><span class="lineno">10255</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110aff6f73b624fecca7dbe94259f9437e32">ISD::BUILD_VECTOR</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N),</div><div class="line"><a name="l10256"></a><span class="lineno">10256</span>&#160;                         LHS.getValueType(), &amp;Ops[0], Ops.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#a22a311dfe4c28a897de8a9365a4f0a84">size</a>());</div><div class="line"><a name="l10257"></a><span class="lineno">10257</span>&#160;  }</div><div class="line"><a name="l10258"></a><span class="lineno">10258</span>&#160;</div><div class="line"><a name="l10259"></a><span class="lineno">10259</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l10260"></a><span class="lineno">10260</span>&#160;}</div><div class="line"><a name="l10261"></a><span class="lineno">10261</span>&#160;<span class="comment"></span></div><div class="line"><a name="l10262"></a><span class="lineno">10262</span>&#160;<span class="comment">/// SimplifyVUnaryOp - Visit a binary vector operation, like FABS/FNEG.</span></div><div class="line"><a name="l10263"></a><span class="lineno">10263</span>&#160;<span class="comment"></span><a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::SimplifyVUnaryOp(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N) {</div><div class="line"><a name="l10264"></a><span class="lineno">10264</span>&#160;  assert(N-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(0).<a class="code" href="structllvm_1_1EVT.html#a73f7c824cad61a47c21bf6d652ae2fd7">isVector</a>() &amp;&amp;</div><div class="line"><a name="l10265"></a><span class="lineno">10265</span>&#160;         <span class="stringliteral">&quot;SimplifyVUnaryOp only works on vectors!&quot;</span>);</div><div class="line"><a name="l10266"></a><span class="lineno">10266</span>&#160;</div><div class="line"><a name="l10267"></a><span class="lineno">10267</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N0 = N-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0);</div><div class="line"><a name="l10268"></a><span class="lineno">10268</span>&#160;</div><div class="line"><a name="l10269"></a><span class="lineno">10269</span>&#160;  <span class="keywordflow">if</span> (N0.getOpcode() != <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110aff6f73b624fecca7dbe94259f9437e32">ISD::BUILD_VECTOR</a>)</div><div class="line"><a name="l10270"></a><span class="lineno">10270</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l10271"></a><span class="lineno">10271</span>&#160;</div><div class="line"><a name="l10272"></a><span class="lineno">10272</span>&#160;  <span class="comment">// Operand is a BUILD_VECTOR node, see if we can constant fold it.</span></div><div class="line"><a name="l10273"></a><span class="lineno">10273</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;SDValue, 8&gt;</a> Ops;</div><div class="line"><a name="l10274"></a><span class="lineno">10274</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0, e = N0.getNumOperands(); <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != e; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l10275"></a><span class="lineno">10275</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Op = N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l10276"></a><span class="lineno">10276</span>&#160;    <span class="keywordflow">if</span> (Op.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() != <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7c6d8f265e9e16e5debdb9a536b55d3d">ISD::UNDEF</a> &amp;&amp;</div><div class="line"><a name="l10277"></a><span class="lineno">10277</span>&#160;        Op.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() != <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a1be4c8da7c68a4c683de1a98b5cc5b9d">ISD::ConstantFP</a>)</div><div class="line"><a name="l10278"></a><span class="lineno">10278</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l10279"></a><span class="lineno">10279</span>&#160;    <a class="code" href="structllvm_1_1EVT.html">EVT</a> EltVT = Op.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>();</div><div class="line"><a name="l10280"></a><span class="lineno">10280</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> FoldOp = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(N-&gt;<a class="code" href="classllvm_1_1SDNode.html#af0d328f3f61168f4ea7d6e4044af4f97">getOpcode</a>(), <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N0), EltVT, Op);</div><div class="line"><a name="l10281"></a><span class="lineno">10281</span>&#160;    <span class="keywordflow">if</span> (FoldOp.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() != <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7c6d8f265e9e16e5debdb9a536b55d3d">ISD::UNDEF</a> &amp;&amp;</div><div class="line"><a name="l10282"></a><span class="lineno">10282</span>&#160;        FoldOp.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() != <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a1be4c8da7c68a4c683de1a98b5cc5b9d">ISD::ConstantFP</a>)</div><div class="line"><a name="l10283"></a><span class="lineno">10283</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l10284"></a><span class="lineno">10284</span>&#160;    Ops.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(FoldOp);</div><div class="line"><a name="l10285"></a><span class="lineno">10285</span>&#160;    AddToWorkList(FoldOp.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l10286"></a><span class="lineno">10286</span>&#160;  }</div><div class="line"><a name="l10287"></a><span class="lineno">10287</span>&#160;</div><div class="line"><a name="l10288"></a><span class="lineno">10288</span>&#160;  <span class="keywordflow">if</span> (Ops.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#a22a311dfe4c28a897de8a9365a4f0a84">size</a>() != N0.getNumOperands())</div><div class="line"><a name="l10289"></a><span class="lineno">10289</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l10290"></a><span class="lineno">10290</span>&#160;</div><div class="line"><a name="l10291"></a><span class="lineno">10291</span>&#160;  <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110aff6f73b624fecca7dbe94259f9437e32">ISD::BUILD_VECTOR</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N),</div><div class="line"><a name="l10292"></a><span class="lineno">10292</span>&#160;                     N0.getValueType(), &amp;Ops[0], Ops.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#a22a311dfe4c28a897de8a9365a4f0a84">size</a>());</div><div class="line"><a name="l10293"></a><span class="lineno">10293</span>&#160;}</div><div class="line"><a name="l10294"></a><span class="lineno">10294</span>&#160;</div><div class="line"><a name="l10295"></a><span class="lineno">10295</span>&#160;<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::SimplifySelect(<a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a> DL, <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N0,</div><div class="line"><a name="l10296"></a><span class="lineno">10296</span>&#160;                                    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N1, <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N2){</div><div class="line"><a name="l10297"></a><span class="lineno">10297</span>&#160;  assert(N0.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() ==<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a0158ee47dfa868be5d28e2cbef70d5d0">ISD::SETCC</a> &amp;&amp; <span class="stringliteral">&quot;First argument must be a SetCC node!&quot;</span>);</div><div class="line"><a name="l10298"></a><span class="lineno">10298</span>&#160;</div><div class="line"><a name="l10299"></a><span class="lineno">10299</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> SCC = SimplifySelectCC(DL, N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0), N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1), N1, N2,</div><div class="line"><a name="l10300"></a><span class="lineno">10300</span>&#160;                                 cast&lt;CondCodeSDNode&gt;(N0.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(2))-&gt;<span class="keyword">get</span>());</div><div class="line"><a name="l10301"></a><span class="lineno">10301</span>&#160;</div><div class="line"><a name="l10302"></a><span class="lineno">10302</span>&#160;  <span class="comment">// If we got a simplified select_cc node back from SimplifySelectCC, then</span></div><div class="line"><a name="l10303"></a><span class="lineno">10303</span>&#160;  <span class="comment">// break it down into a new SETCC node, and a new SELECT node, and then return</span></div><div class="line"><a name="l10304"></a><span class="lineno">10304</span>&#160;  <span class="comment">// the SELECT node, since we were called with a SELECT node.</span></div><div class="line"><a name="l10305"></a><span class="lineno">10305</span>&#160;  <span class="keywordflow">if</span> (SCC.getNode()) {</div><div class="line"><a name="l10306"></a><span class="lineno">10306</span>&#160;    <span class="comment">// Check to see if we got a select_cc back (to turn into setcc/select).</span></div><div class="line"><a name="l10307"></a><span class="lineno">10307</span>&#160;    <span class="comment">// Otherwise, just return whatever node we got back, like fabs.</span></div><div class="line"><a name="l10308"></a><span class="lineno">10308</span>&#160;    <span class="keywordflow">if</span> (SCC.getOpcode() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a99ad6b342b7457df56b91d24e66016b3">ISD::SELECT_CC</a>) {</div><div class="line"><a name="l10309"></a><span class="lineno">10309</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a0158ee47dfa868be5d28e2cbef70d5d0">SETCC</a> = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a0158ee47dfa868be5d28e2cbef70d5d0">ISD::SETCC</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N0),</div><div class="line"><a name="l10310"></a><span class="lineno">10310</span>&#160;                                  N0.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>(),</div><div class="line"><a name="l10311"></a><span class="lineno">10311</span>&#160;                                  SCC.getOperand(0), SCC.getOperand(1),</div><div class="line"><a name="l10312"></a><span class="lineno">10312</span>&#160;                                  SCC.getOperand(4));</div><div class="line"><a name="l10313"></a><span class="lineno">10313</span>&#160;      AddToWorkList(SETCC.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l10314"></a><span class="lineno">10314</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a78990d91dd364f8bb9e7008d85fd73b8">getSelect</a>(<a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(SCC), SCC.getValueType(),</div><div class="line"><a name="l10315"></a><span class="lineno">10315</span>&#160;                           SCC.getOperand(2), SCC.getOperand(3), <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a0158ee47dfa868be5d28e2cbef70d5d0">SETCC</a>);</div><div class="line"><a name="l10316"></a><span class="lineno">10316</span>&#160;    }</div><div class="line"><a name="l10317"></a><span class="lineno">10317</span>&#160;</div><div class="line"><a name="l10318"></a><span class="lineno">10318</span>&#160;    <span class="keywordflow">return</span> SCC;</div><div class="line"><a name="l10319"></a><span class="lineno">10319</span>&#160;  }</div><div class="line"><a name="l10320"></a><span class="lineno">10320</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l10321"></a><span class="lineno">10321</span>&#160;}</div><div class="line"><a name="l10322"></a><span class="lineno">10322</span>&#160;<span class="comment"></span></div><div class="line"><a name="l10323"></a><span class="lineno">10323</span>&#160;<span class="comment">/// SimplifySelectOps - Given a SELECT or a SELECT_CC node, where LHS and RHS</span></div><div class="line"><a name="l10324"></a><span class="lineno">10324</span>&#160;<span class="comment">/// are the two values being selected between, see if we can simplify the</span></div><div class="line"><a name="l10325"></a><span class="lineno">10325</span>&#160;<span class="comment">/// select.  Callers of this should assume that TheSelect is deleted if this</span></div><div class="line"><a name="l10326"></a><span class="lineno">10326</span>&#160;<span class="comment">/// returns true.  As such, they should return the appropriate thing (e.g. the</span></div><div class="line"><a name="l10327"></a><span class="lineno">10327</span>&#160;<span class="comment">/// node) back to the top-level of the DAG combiner loop to avoid it being</span></div><div class="line"><a name="l10328"></a><span class="lineno">10328</span>&#160;<span class="comment">/// looked at.</span></div><div class="line"><a name="l10329"></a><span class="lineno">10329</span>&#160;<span class="comment"></span><span class="keywordtype">bool</span> DAGCombiner::SimplifySelectOps(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *TheSelect, <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> LHS,</div><div class="line"><a name="l10330"></a><span class="lineno">10330</span>&#160;                                    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> RHS) {</div><div class="line"><a name="l10331"></a><span class="lineno">10331</span>&#160;</div><div class="line"><a name="l10332"></a><span class="lineno">10332</span>&#160;  <span class="comment">// Cannot simplify select with vector condition</span></div><div class="line"><a name="l10333"></a><span class="lineno">10333</span>&#160;  <span class="keywordflow">if</span> (TheSelect-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>().<a class="code" href="structllvm_1_1EVT.html#a73f7c824cad61a47c21bf6d652ae2fd7">isVector</a>()) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l10334"></a><span class="lineno">10334</span>&#160;</div><div class="line"><a name="l10335"></a><span class="lineno">10335</span>&#160;  <span class="comment">// If this is a select from two identical things, try to pull the operation</span></div><div class="line"><a name="l10336"></a><span class="lineno">10336</span>&#160;  <span class="comment">// through the select.</span></div><div class="line"><a name="l10337"></a><span class="lineno">10337</span>&#160;  <span class="keywordflow">if</span> (LHS.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() != RHS.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() ||</div><div class="line"><a name="l10338"></a><span class="lineno">10338</span>&#160;      !LHS.<a class="code" href="classllvm_1_1SDValue.html#a97b0f24f3e52f030830fca6fbfcbd37d">hasOneUse</a>() || !RHS.<a class="code" href="classllvm_1_1SDValue.html#a97b0f24f3e52f030830fca6fbfcbd37d">hasOneUse</a>())</div><div class="line"><a name="l10339"></a><span class="lineno">10339</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l10340"></a><span class="lineno">10340</span>&#160;</div><div class="line"><a name="l10341"></a><span class="lineno">10341</span>&#160;  <span class="comment">// If this is a load and the token chain is identical, replace the select</span></div><div class="line"><a name="l10342"></a><span class="lineno">10342</span>&#160;  <span class="comment">// of two loads with a load through a select of the address to load from.</span></div><div class="line"><a name="l10343"></a><span class="lineno">10343</span>&#160;  <span class="comment">// This triggers in things like &quot;select bool X, 10.0, 123.0&quot; after the FP</span></div><div class="line"><a name="l10344"></a><span class="lineno">10344</span>&#160;  <span class="comment">// constants have been dropped into the constant pool.</span></div><div class="line"><a name="l10345"></a><span class="lineno">10345</span>&#160;  <span class="keywordflow">if</span> (LHS.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a269b81f007000306e3e69d0d290c2159">ISD::LOAD</a>) {</div><div class="line"><a name="l10346"></a><span class="lineno">10346</span>&#160;    <a class="code" href="classllvm_1_1LoadSDNode.html">LoadSDNode</a> *LLD = cast&lt;LoadSDNode&gt;(LHS);</div><div class="line"><a name="l10347"></a><span class="lineno">10347</span>&#160;    <a class="code" href="classllvm_1_1LoadSDNode.html">LoadSDNode</a> *RLD = cast&lt;LoadSDNode&gt;(RHS);</div><div class="line"><a name="l10348"></a><span class="lineno">10348</span>&#160;</div><div class="line"><a name="l10349"></a><span class="lineno">10349</span>&#160;    <span class="comment">// Token chains must be identical.</span></div><div class="line"><a name="l10350"></a><span class="lineno">10350</span>&#160;    <span class="keywordflow">if</span> (LHS.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0) != RHS.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0) ||</div><div class="line"><a name="l10351"></a><span class="lineno">10351</span>&#160;        <span class="comment">// Do not let this transformation reduce the number of volatile loads.</span></div><div class="line"><a name="l10352"></a><span class="lineno">10352</span>&#160;        LLD-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#acd3bb9ee2ec53fa4be1fdf155b0b5a17">isVolatile</a>() || RLD-&gt;isVolatile() ||</div><div class="line"><a name="l10353"></a><span class="lineno">10353</span>&#160;        <span class="comment">// If this is an EXTLOAD, the VT&#39;s must match.</span></div><div class="line"><a name="l10354"></a><span class="lineno">10354</span>&#160;        LLD-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a7cead3a2a7771e61083bcc6959915a13">getMemoryVT</a>() != RLD-&gt;getMemoryVT() ||</div><div class="line"><a name="l10355"></a><span class="lineno">10355</span>&#160;        <span class="comment">// If this is an EXTLOAD, the kind of extension must match.</span></div><div class="line"><a name="l10356"></a><span class="lineno">10356</span>&#160;        (LLD-&gt;<a class="code" href="classllvm_1_1LoadSDNode.html#af15fb8b2d4c9f295bdcf85a1eb506702">getExtensionType</a>() != RLD-&gt;getExtensionType() &amp;&amp;</div><div class="line"><a name="l10357"></a><span class="lineno">10357</span>&#160;         <span class="comment">// The only exception is if one of the extensions is anyext.</span></div><div class="line"><a name="l10358"></a><span class="lineno">10358</span>&#160;         LLD-&gt;<a class="code" href="classllvm_1_1LoadSDNode.html#af15fb8b2d4c9f295bdcf85a1eb506702">getExtensionType</a>() != <a class="code" href="namespacellvm_1_1ISD.html#ad4d48171b87ca51ff54c10a436bac4d7afab3fffd153f7d7770fed81272e4b78f">ISD::EXTLOAD</a> &amp;&amp;</div><div class="line"><a name="l10359"></a><span class="lineno">10359</span>&#160;         RLD-&gt;getExtensionType() != <a class="code" href="namespacellvm_1_1ISD.html#ad4d48171b87ca51ff54c10a436bac4d7afab3fffd153f7d7770fed81272e4b78f">ISD::EXTLOAD</a>) ||</div><div class="line"><a name="l10360"></a><span class="lineno">10360</span>&#160;        <span class="comment">// FIXME: this discards src value information.  This is</span></div><div class="line"><a name="l10361"></a><span class="lineno">10361</span>&#160;        <span class="comment">// over-conservative. It would be beneficial to be able to remember</span></div><div class="line"><a name="l10362"></a><span class="lineno">10362</span>&#160;        <span class="comment">// both potential memory locations.  Since we are discarding</span></div><div class="line"><a name="l10363"></a><span class="lineno">10363</span>&#160;        <span class="comment">// src value info, don&#39;t do the transformation if the memory</span></div><div class="line"><a name="l10364"></a><span class="lineno">10364</span>&#160;        <span class="comment">// locations are not in the default address space.</span></div><div class="line"><a name="l10365"></a><span class="lineno">10365</span>&#160;        LLD-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a2fa8491ab36125d7f5dd38d3a4868934">getPointerInfo</a>().<a class="code" href="structllvm_1_1MachinePointerInfo.html#a23e5cd18f87dae8314d615484032d6a2">getAddrSpace</a>() != 0 ||</div><div class="line"><a name="l10366"></a><span class="lineno">10366</span>&#160;        RLD-&gt;getPointerInfo().getAddrSpace() != 0 ||</div><div class="line"><a name="l10367"></a><span class="lineno">10367</span>&#160;        !TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a087dd0f9650e999b087c17cc7f46f2d0">isOperationLegalOrCustom</a>(TheSelect-&gt;<a class="code" href="classllvm_1_1SDNode.html#af0d328f3f61168f4ea7d6e4044af4f97">getOpcode</a>(),</div><div class="line"><a name="l10368"></a><span class="lineno">10368</span>&#160;                                      LLD-&gt;<a class="code" href="classllvm_1_1LoadSDNode.html#a3ded48ce66b58b7e7e143991df5dbfae">getBasePtr</a>().<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>()))</div><div class="line"><a name="l10369"></a><span class="lineno">10369</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l10370"></a><span class="lineno">10370</span>&#160;</div><div class="line"><a name="l10371"></a><span class="lineno">10371</span>&#160;    <span class="comment">// Check that the select condition doesn&#39;t reach either load.  If so,</span></div><div class="line"><a name="l10372"></a><span class="lineno">10372</span>&#160;    <span class="comment">// folding this will induce a cycle into the DAG.  If not, this is safe to</span></div><div class="line"><a name="l10373"></a><span class="lineno">10373</span>&#160;    <span class="comment">// xform, so create a select of the addresses.</span></div><div class="line"><a name="l10374"></a><span class="lineno">10374</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Addr;</div><div class="line"><a name="l10375"></a><span class="lineno">10375</span>&#160;    <span class="keywordflow">if</span> (TheSelect-&gt;<a class="code" href="classllvm_1_1SDNode.html#af0d328f3f61168f4ea7d6e4044af4f97">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a78d0f198115bfe3331ab7cfcf7a40a97">ISD::SELECT</a>) {</div><div class="line"><a name="l10376"></a><span class="lineno">10376</span>&#160;      <a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *CondNode = TheSelect-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>();</div><div class="line"><a name="l10377"></a><span class="lineno">10377</span>&#160;      <span class="keywordflow">if</span> ((LLD-&gt;<a class="code" href="classllvm_1_1SDNode.html#ae4cb676e77b9f238058c70faa609a5d7">hasAnyUseOfValue</a>(1) &amp;&amp; LLD-&gt;<a class="code" href="classllvm_1_1SDNode.html#a7ee80bb807d0f88ecbfbc44607228ef6">isPredecessorOf</a>(CondNode)) ||</div><div class="line"><a name="l10378"></a><span class="lineno">10378</span>&#160;          (RLD-&gt;hasAnyUseOfValue(1) &amp;&amp; RLD-&gt;isPredecessorOf(CondNode)))</div><div class="line"><a name="l10379"></a><span class="lineno">10379</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l10380"></a><span class="lineno">10380</span>&#160;      <span class="comment">// The loads must not depend on one another.</span></div><div class="line"><a name="l10381"></a><span class="lineno">10381</span>&#160;      <span class="keywordflow">if</span> (LLD-&gt;<a class="code" href="classllvm_1_1SDNode.html#a7ee80bb807d0f88ecbfbc44607228ef6">isPredecessorOf</a>(RLD) ||</div><div class="line"><a name="l10382"></a><span class="lineno">10382</span>&#160;          RLD-&gt;isPredecessorOf(LLD))</div><div class="line"><a name="l10383"></a><span class="lineno">10383</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l10384"></a><span class="lineno">10384</span>&#160;      Addr = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a78990d91dd364f8bb9e7008d85fd73b8">getSelect</a>(<a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(TheSelect),</div><div class="line"><a name="l10385"></a><span class="lineno">10385</span>&#160;                           LLD-&gt;<a class="code" href="classllvm_1_1LoadSDNode.html#a3ded48ce66b58b7e7e143991df5dbfae">getBasePtr</a>().<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>(),</div><div class="line"><a name="l10386"></a><span class="lineno">10386</span>&#160;                           TheSelect-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0), LLD-&gt;<a class="code" href="classllvm_1_1LoadSDNode.html#a3ded48ce66b58b7e7e143991df5dbfae">getBasePtr</a>(),</div><div class="line"><a name="l10387"></a><span class="lineno">10387</span>&#160;                           RLD-&gt;getBasePtr());</div><div class="line"><a name="l10388"></a><span class="lineno">10388</span>&#160;    } <span class="keywordflow">else</span> {  <span class="comment">// Otherwise SELECT_CC</span></div><div class="line"><a name="l10389"></a><span class="lineno">10389</span>&#160;      <a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *CondLHS = TheSelect-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0).<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>();</div><div class="line"><a name="l10390"></a><span class="lineno">10390</span>&#160;      <a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *CondRHS = TheSelect-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(1).<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>();</div><div class="line"><a name="l10391"></a><span class="lineno">10391</span>&#160;</div><div class="line"><a name="l10392"></a><span class="lineno">10392</span>&#160;      <span class="keywordflow">if</span> ((LLD-&gt;<a class="code" href="classllvm_1_1SDNode.html#ae4cb676e77b9f238058c70faa609a5d7">hasAnyUseOfValue</a>(1) &amp;&amp;</div><div class="line"><a name="l10393"></a><span class="lineno">10393</span>&#160;           (LLD-&gt;<a class="code" href="classllvm_1_1SDNode.html#a7ee80bb807d0f88ecbfbc44607228ef6">isPredecessorOf</a>(CondLHS) || LLD-&gt;<a class="code" href="classllvm_1_1SDNode.html#a7ee80bb807d0f88ecbfbc44607228ef6">isPredecessorOf</a>(CondRHS))) ||</div><div class="line"><a name="l10394"></a><span class="lineno">10394</span>&#160;          (RLD-&gt;hasAnyUseOfValue(1) &amp;&amp;</div><div class="line"><a name="l10395"></a><span class="lineno">10395</span>&#160;           (RLD-&gt;isPredecessorOf(CondLHS) || RLD-&gt;isPredecessorOf(CondRHS))))</div><div class="line"><a name="l10396"></a><span class="lineno">10396</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l10397"></a><span class="lineno">10397</span>&#160;</div><div class="line"><a name="l10398"></a><span class="lineno">10398</span>&#160;      Addr = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a99ad6b342b7457df56b91d24e66016b3">ISD::SELECT_CC</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(TheSelect),</div><div class="line"><a name="l10399"></a><span class="lineno">10399</span>&#160;                         LLD-&gt;<a class="code" href="classllvm_1_1LoadSDNode.html#a3ded48ce66b58b7e7e143991df5dbfae">getBasePtr</a>().<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>(),</div><div class="line"><a name="l10400"></a><span class="lineno">10400</span>&#160;                         TheSelect-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0),</div><div class="line"><a name="l10401"></a><span class="lineno">10401</span>&#160;                         TheSelect-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(1),</div><div class="line"><a name="l10402"></a><span class="lineno">10402</span>&#160;                         LLD-&gt;<a class="code" href="classllvm_1_1LoadSDNode.html#a3ded48ce66b58b7e7e143991df5dbfae">getBasePtr</a>(), RLD-&gt;getBasePtr(),</div><div class="line"><a name="l10403"></a><span class="lineno">10403</span>&#160;                         TheSelect-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(4));</div><div class="line"><a name="l10404"></a><span class="lineno">10404</span>&#160;    }</div><div class="line"><a name="l10405"></a><span class="lineno">10405</span>&#160;</div><div class="line"><a name="l10406"></a><span class="lineno">10406</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> <a class="code" href="namespacellvm_1_1SPII.html#a11e9b8fca4a074643a6a21f444e51406a5069619ca8fdce305534f3fe85091a0f">Load</a>;</div><div class="line"><a name="l10407"></a><span class="lineno">10407</span>&#160;    <span class="keywordflow">if</span> (LLD-&gt;<a class="code" href="classllvm_1_1LoadSDNode.html#af15fb8b2d4c9f295bdcf85a1eb506702">getExtensionType</a>() == <a class="code" href="namespacellvm_1_1ISD.html#ad4d48171b87ca51ff54c10a436bac4d7a6aacde2c67988b43a261a7f7ceac4be3">ISD::NON_EXTLOAD</a>) {</div><div class="line"><a name="l10408"></a><span class="lineno">10408</span>&#160;      Load = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#ab8395be5698f080c0036d866e121a478">getLoad</a>(TheSelect-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(0),</div><div class="line"><a name="l10409"></a><span class="lineno">10409</span>&#160;                         <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(TheSelect),</div><div class="line"><a name="l10410"></a><span class="lineno">10410</span>&#160;                         <span class="comment">// FIXME: Discards pointer and TBAA info.</span></div><div class="line"><a name="l10411"></a><span class="lineno">10411</span>&#160;                         LLD-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#ae3cb6fbf8c8cb79e10ac61bd98c85211">getChain</a>(), Addr, <a class="code" href="structllvm_1_1MachinePointerInfo.html">MachinePointerInfo</a>(),</div><div class="line"><a name="l10412"></a><span class="lineno">10412</span>&#160;                         LLD-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#acd3bb9ee2ec53fa4be1fdf155b0b5a17">isVolatile</a>(), LLD-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a967ffaf77f64a5deb1e96951e4224112">isNonTemporal</a>(),</div><div class="line"><a name="l10413"></a><span class="lineno">10413</span>&#160;                         LLD-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#ad8e64770a04af6b3da2099477e7c28de">isInvariant</a>(), LLD-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a4f68cd016138440f215ad80c1d6c1e04">getAlignment</a>());</div><div class="line"><a name="l10414"></a><span class="lineno">10414</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l10415"></a><span class="lineno">10415</span>&#160;      Load = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#ad6ff413bea6f8195d8e6f29f4fc519c4">getExtLoad</a>(LLD-&gt;<a class="code" href="classllvm_1_1LoadSDNode.html#af15fb8b2d4c9f295bdcf85a1eb506702">getExtensionType</a>() == <a class="code" href="namespacellvm_1_1ISD.html#ad4d48171b87ca51ff54c10a436bac4d7afab3fffd153f7d7770fed81272e4b78f">ISD::EXTLOAD</a> ?</div><div class="line"><a name="l10416"></a><span class="lineno">10416</span>&#160;                            RLD-&gt;getExtensionType() : LLD-&gt;<a class="code" href="classllvm_1_1LoadSDNode.html#af15fb8b2d4c9f295bdcf85a1eb506702">getExtensionType</a>(),</div><div class="line"><a name="l10417"></a><span class="lineno">10417</span>&#160;                            <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(TheSelect),</div><div class="line"><a name="l10418"></a><span class="lineno">10418</span>&#160;                            TheSelect-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(0),</div><div class="line"><a name="l10419"></a><span class="lineno">10419</span>&#160;                            <span class="comment">// FIXME: Discards pointer and TBAA info.</span></div><div class="line"><a name="l10420"></a><span class="lineno">10420</span>&#160;                            LLD-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#ae3cb6fbf8c8cb79e10ac61bd98c85211">getChain</a>(), Addr, <a class="code" href="structllvm_1_1MachinePointerInfo.html">MachinePointerInfo</a>(),</div><div class="line"><a name="l10421"></a><span class="lineno">10421</span>&#160;                            LLD-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a7cead3a2a7771e61083bcc6959915a13">getMemoryVT</a>(), LLD-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#acd3bb9ee2ec53fa4be1fdf155b0b5a17">isVolatile</a>(),</div><div class="line"><a name="l10422"></a><span class="lineno">10422</span>&#160;                            LLD-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a967ffaf77f64a5deb1e96951e4224112">isNonTemporal</a>(), LLD-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a4f68cd016138440f215ad80c1d6c1e04">getAlignment</a>());</div><div class="line"><a name="l10423"></a><span class="lineno">10423</span>&#160;    }</div><div class="line"><a name="l10424"></a><span class="lineno">10424</span>&#160;</div><div class="line"><a name="l10425"></a><span class="lineno">10425</span>&#160;    <span class="comment">// Users of the select now use the result of the load.</span></div><div class="line"><a name="l10426"></a><span class="lineno">10426</span>&#160;    CombineTo(TheSelect, Load);</div><div class="line"><a name="l10427"></a><span class="lineno">10427</span>&#160;</div><div class="line"><a name="l10428"></a><span class="lineno">10428</span>&#160;    <span class="comment">// Users of the old loads now use the new load&#39;s chain.  We know the</span></div><div class="line"><a name="l10429"></a><span class="lineno">10429</span>&#160;    <span class="comment">// old-load value is dead now.</span></div><div class="line"><a name="l10430"></a><span class="lineno">10430</span>&#160;    CombineTo(LHS.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>(), Load.<a class="code" href="classllvm_1_1SDValue.html#a040481b9bda32faa6b1435532405d88f">getValue</a>(0), Load.<a class="code" href="classllvm_1_1SDValue.html#a040481b9bda32faa6b1435532405d88f">getValue</a>(1));</div><div class="line"><a name="l10431"></a><span class="lineno">10431</span>&#160;    CombineTo(RHS.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>(), Load.<a class="code" href="classllvm_1_1SDValue.html#a040481b9bda32faa6b1435532405d88f">getValue</a>(0), Load.<a class="code" href="classllvm_1_1SDValue.html#a040481b9bda32faa6b1435532405d88f">getValue</a>(1));</div><div class="line"><a name="l10432"></a><span class="lineno">10432</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l10433"></a><span class="lineno">10433</span>&#160;  }</div><div class="line"><a name="l10434"></a><span class="lineno">10434</span>&#160;</div><div class="line"><a name="l10435"></a><span class="lineno">10435</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l10436"></a><span class="lineno">10436</span>&#160;}</div><div class="line"><a name="l10437"></a><span class="lineno">10437</span>&#160;<span class="comment"></span></div><div class="line"><a name="l10438"></a><span class="lineno">10438</span>&#160;<span class="comment">/// SimplifySelectCC - Simplify an expression of the form (N0 cond N1) ? N2 : N3</span></div><div class="line"><a name="l10439"></a><span class="lineno">10439</span>&#160;<span class="comment">/// where &#39;cond&#39; is the comparison specified by CC.</span></div><div class="line"><a name="l10440"></a><span class="lineno">10440</span>&#160;<span class="comment"></span><a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::SimplifySelectCC(<a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a> DL, <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N0, <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N1,</div><div class="line"><a name="l10441"></a><span class="lineno">10441</span>&#160;                                      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N2, <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N3,</div><div class="line"><a name="l10442"></a><span class="lineno">10442</span>&#160;                                      <a class="code" href="namespacellvm_1_1ISD.html#ac3c3cf58d6d631af6a172457304d3d07">ISD::CondCode</a> <a class="code" href="Target_2PowerPC_2README_8txt.html#afc7ca55ad1da67847ecd4b99ef64dc84">CC</a>, <span class="keywordtype">bool</span> NotExtCompare) {</div><div class="line"><a name="l10443"></a><span class="lineno">10443</span>&#160;  <span class="comment">// (x ? y : y) -&gt; y.</span></div><div class="line"><a name="l10444"></a><span class="lineno">10444</span>&#160;  <span class="keywordflow">if</span> (N2 == N3) <span class="keywordflow">return</span> N2;</div><div class="line"><a name="l10445"></a><span class="lineno">10445</span>&#160;</div><div class="line"><a name="l10446"></a><span class="lineno">10446</span>&#160;  <a class="code" href="structllvm_1_1EVT.html">EVT</a> VT = N2.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>();</div><div class="line"><a name="l10447"></a><span class="lineno">10447</span>&#160;  <a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a> *N1C = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a>&gt;(N1.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l10448"></a><span class="lineno">10448</span>&#160;  <a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a> *N2C = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a>&gt;(N2.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l10449"></a><span class="lineno">10449</span>&#160;  <a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a> *N3C = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a>&gt;(N3.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l10450"></a><span class="lineno">10450</span>&#160;</div><div class="line"><a name="l10451"></a><span class="lineno">10451</span>&#160;  <span class="comment">// Determine if the condition we&#39;re dealing with is constant</span></div><div class="line"><a name="l10452"></a><span class="lineno">10452</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> SCC = SimplifySetCC(getSetCCResultType(N0.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>()),</div><div class="line"><a name="l10453"></a><span class="lineno">10453</span>&#160;                              N0, N1, CC, DL, <span class="keyword">false</span>);</div><div class="line"><a name="l10454"></a><span class="lineno">10454</span>&#160;  <span class="keywordflow">if</span> (SCC.getNode()) AddToWorkList(SCC.getNode());</div><div class="line"><a name="l10455"></a><span class="lineno">10455</span>&#160;  <a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a> *SCCC = dyn_cast_or_null&lt;ConstantSDNode&gt;(SCC.getNode());</div><div class="line"><a name="l10456"></a><span class="lineno">10456</span>&#160;</div><div class="line"><a name="l10457"></a><span class="lineno">10457</span>&#160;  <span class="comment">// fold select_cc true, x, y -&gt; x</span></div><div class="line"><a name="l10458"></a><span class="lineno">10458</span>&#160;  <span class="keywordflow">if</span> (SCCC &amp;&amp; !SCCC-&gt;<a class="code" href="classllvm_1_1ConstantSDNode.html#a702de70a3d9e57c3ffe65bc3fab3e087">isNullValue</a>())</div><div class="line"><a name="l10459"></a><span class="lineno">10459</span>&#160;    <span class="keywordflow">return</span> N2;</div><div class="line"><a name="l10460"></a><span class="lineno">10460</span>&#160;  <span class="comment">// fold select_cc false, x, y -&gt; y</span></div><div class="line"><a name="l10461"></a><span class="lineno">10461</span>&#160;  <span class="keywordflow">if</span> (SCCC &amp;&amp; SCCC-&gt;<a class="code" href="classllvm_1_1ConstantSDNode.html#a702de70a3d9e57c3ffe65bc3fab3e087">isNullValue</a>())</div><div class="line"><a name="l10462"></a><span class="lineno">10462</span>&#160;    <span class="keywordflow">return</span> N3;</div><div class="line"><a name="l10463"></a><span class="lineno">10463</span>&#160;</div><div class="line"><a name="l10464"></a><span class="lineno">10464</span>&#160;  <span class="comment">// Check to see if we can simplify the select into an fabs node</span></div><div class="line"><a name="l10465"></a><span class="lineno">10465</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1ConstantFPSDNode.html">ConstantFPSDNode</a> *CFP = dyn_cast&lt;ConstantFPSDNode&gt;(N1)) {</div><div class="line"><a name="l10466"></a><span class="lineno">10466</span>&#160;    <span class="comment">// Allow either -0.0 or 0.0</span></div><div class="line"><a name="l10467"></a><span class="lineno">10467</span>&#160;    <span class="keywordflow">if</span> (CFP-&gt;getValueAPF().isZero()) {</div><div class="line"><a name="l10468"></a><span class="lineno">10468</span>&#160;      <span class="comment">// select (setg[te] X, +/-0.0), X, fneg(X) -&gt; fabs</span></div><div class="line"><a name="l10469"></a><span class="lineno">10469</span>&#160;      <span class="keywordflow">if</span> ((CC == <a class="code" href="namespacellvm_1_1ISD.html#ac3c3cf58d6d631af6a172457304d3d07a7f47862de23f7210f88ccf98ae1efbe4">ISD::SETGE</a> || CC == <a class="code" href="namespacellvm_1_1ISD.html#ac3c3cf58d6d631af6a172457304d3d07a5ad12b466e3a5900d0c307b301465d25">ISD::SETGT</a>) &amp;&amp;</div><div class="line"><a name="l10470"></a><span class="lineno">10470</span>&#160;          N0 == N2 &amp;&amp; N3.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a6d26c45c040d8f85d577a5f645261d1a">ISD::FNEG</a> &amp;&amp;</div><div class="line"><a name="l10471"></a><span class="lineno">10471</span>&#160;          N2 == N3.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0))</div><div class="line"><a name="l10472"></a><span class="lineno">10472</span>&#160;        <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a2b4d07600495a563319d6a3dda8dc44d">ISD::FABS</a>, DL, VT, N0);</div><div class="line"><a name="l10473"></a><span class="lineno">10473</span>&#160;</div><div class="line"><a name="l10474"></a><span class="lineno">10474</span>&#160;      <span class="comment">// select (setl[te] X, +/-0.0), fneg(X), X -&gt; fabs</span></div><div class="line"><a name="l10475"></a><span class="lineno">10475</span>&#160;      <span class="keywordflow">if</span> ((CC == <a class="code" href="namespacellvm_1_1ISD.html#ac3c3cf58d6d631af6a172457304d3d07a6f05a09edb671910f85f8665981cbde9">ISD::SETLT</a> || CC == <a class="code" href="namespacellvm_1_1ISD.html#ac3c3cf58d6d631af6a172457304d3d07ab49f81c2ecbbff3d0fbe55dd46353774">ISD::SETLE</a>) &amp;&amp;</div><div class="line"><a name="l10476"></a><span class="lineno">10476</span>&#160;          N0 == N3 &amp;&amp; N2.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a6d26c45c040d8f85d577a5f645261d1a">ISD::FNEG</a> &amp;&amp;</div><div class="line"><a name="l10477"></a><span class="lineno">10477</span>&#160;          N2.getOperand(0) == N3)</div><div class="line"><a name="l10478"></a><span class="lineno">10478</span>&#160;        <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a2b4d07600495a563319d6a3dda8dc44d">ISD::FABS</a>, DL, VT, N3);</div><div class="line"><a name="l10479"></a><span class="lineno">10479</span>&#160;    }</div><div class="line"><a name="l10480"></a><span class="lineno">10480</span>&#160;  }</div><div class="line"><a name="l10481"></a><span class="lineno">10481</span>&#160;</div><div class="line"><a name="l10482"></a><span class="lineno">10482</span>&#160;  <span class="comment">// Turn &quot;(a cond b) ? 1.0f : 2.0f&quot; into &quot;load (tmp + ((a cond b) ? 0 : 4)&quot;</span></div><div class="line"><a name="l10483"></a><span class="lineno">10483</span>&#160;  <span class="comment">// where &quot;tmp&quot; is a constant pool entry containing an array with 1.0 and 2.0</span></div><div class="line"><a name="l10484"></a><span class="lineno">10484</span>&#160;  <span class="comment">// in it.  This is a win when the constant is not otherwise available because</span></div><div class="line"><a name="l10485"></a><span class="lineno">10485</span>&#160;  <span class="comment">// it replaces two constant pool loads with one.  We only do this if the FP</span></div><div class="line"><a name="l10486"></a><span class="lineno">10486</span>&#160;  <span class="comment">// type is known to be legal, because if it isn&#39;t, then we are before legalize</span></div><div class="line"><a name="l10487"></a><span class="lineno">10487</span>&#160;  <span class="comment">// types an we want the other legalization to happen first (e.g. to avoid</span></div><div class="line"><a name="l10488"></a><span class="lineno">10488</span>&#160;  <span class="comment">// messing with soft float) and if the ConstantFP is not legal, because if</span></div><div class="line"><a name="l10489"></a><span class="lineno">10489</span>&#160;  <span class="comment">// it is legal, we may not need to store the FP constant in a constant pool.</span></div><div class="line"><a name="l10490"></a><span class="lineno">10490</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1ConstantFPSDNode.html">ConstantFPSDNode</a> *TV = dyn_cast&lt;ConstantFPSDNode&gt;(N2))</div><div class="line"><a name="l10491"></a><span class="lineno">10491</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1ConstantFPSDNode.html">ConstantFPSDNode</a> *FV = dyn_cast&lt;ConstantFPSDNode&gt;(N3)) {</div><div class="line"><a name="l10492"></a><span class="lineno">10492</span>&#160;      <span class="keywordflow">if</span> (TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a861aaccc0f468493e76c011811548804">isTypeLegal</a>(N2.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>()) &amp;&amp;</div><div class="line"><a name="l10493"></a><span class="lineno">10493</span>&#160;          (TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#ae7ff3b0592782cde529b9a16833b44d0">getOperationAction</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a1be4c8da7c68a4c683de1a98b5cc5b9d">ISD::ConstantFP</a>, N2.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>()) !=</div><div class="line"><a name="l10494"></a><span class="lineno">10494</span>&#160;           <a class="code" href="classllvm_1_1TargetLoweringBase.html#a2856b7fb24e0784cfc29ddfd5be74d1bad7ff2d7a7c03a214dda559fac717cd99">TargetLowering::Legal</a>) &amp;&amp;</div><div class="line"><a name="l10495"></a><span class="lineno">10495</span>&#160;          <span class="comment">// If both constants have multiple uses, then we won&#39;t need to do an</span></div><div class="line"><a name="l10496"></a><span class="lineno">10496</span>&#160;          <span class="comment">// extra load, they are likely around in registers for other users.</span></div><div class="line"><a name="l10497"></a><span class="lineno">10497</span>&#160;          (TV-&gt;hasOneUse() || FV-&gt;hasOneUse())) {</div><div class="line"><a name="l10498"></a><span class="lineno">10498</span>&#160;        <a class="code" href="classllvm_1_1Constant.html">Constant</a> *Elts[] = {</div><div class="line"><a name="l10499"></a><span class="lineno">10499</span>&#160;          <span class="keyword">const_cast&lt;</span><a class="code" href="classllvm_1_1ConstantFP.html">ConstantFP</a>*<span class="keyword">&gt;</span>(FV-&gt;getConstantFPValue()),</div><div class="line"><a name="l10500"></a><span class="lineno">10500</span>&#160;          const_cast&lt;ConstantFP*&gt;(TV-&gt;getConstantFPValue())</div><div class="line"><a name="l10501"></a><span class="lineno">10501</span>&#160;        };</div><div class="line"><a name="l10502"></a><span class="lineno">10502</span>&#160;        <a class="code" href="classllvm_1_1Type.html">Type</a> *FPTy = Elts[0]-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>();</div><div class="line"><a name="l10503"></a><span class="lineno">10503</span>&#160;        <span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> &amp;TD = *TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#adc25bcc279ccfb5b867c2b7b8eedaa9b">getDataLayout</a>();</div><div class="line"><a name="l10504"></a><span class="lineno">10504</span>&#160;</div><div class="line"><a name="l10505"></a><span class="lineno">10505</span>&#160;        <span class="comment">// Create a ConstantArray of the two constants.</span></div><div class="line"><a name="l10506"></a><span class="lineno">10506</span>&#160;        <a class="code" href="classllvm_1_1Constant.html">Constant</a> *CA = <a class="code" href="classllvm_1_1ConstantArray.html#a0900dacdc7ad8e3ea0cc92993c7fd422">ConstantArray::get</a>(<a class="code" href="classllvm_1_1ArrayType.html#adf411edc4f135b570ab218079474ce77">ArrayType::get</a>(FPTy, 2), Elts);</div><div class="line"><a name="l10507"></a><span class="lineno">10507</span>&#160;        <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> CPIdx = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#ad5bba8f4524b49efbace42884b38fe7e">getConstantPool</a>(CA, TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a2824c264a25f2f03586588c7020b7a5d">getPointerTy</a>(),</div><div class="line"><a name="l10508"></a><span class="lineno">10508</span>&#160;                                            TD.<a class="code" href="classllvm_1_1DataLayout.html#adfb7610cbc23430a7d4077a3cf9c22d3">getPrefTypeAlignment</a>(FPTy));</div><div class="line"><a name="l10509"></a><span class="lineno">10509</span>&#160;        <span class="keywordtype">unsigned</span> Alignment = cast&lt;ConstantPoolSDNode&gt;(CPIdx)-&gt;getAlignment();</div><div class="line"><a name="l10510"></a><span class="lineno">10510</span>&#160;</div><div class="line"><a name="l10511"></a><span class="lineno">10511</span>&#160;        <span class="comment">// Get the offsets to the 0 and 1 element of the array so that we can</span></div><div class="line"><a name="l10512"></a><span class="lineno">10512</span>&#160;        <span class="comment">// select between them.</span></div><div class="line"><a name="l10513"></a><span class="lineno">10513</span>&#160;        <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Zero = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a9a66b00ea9db7d80bf1bcbbcaa108239">getIntPtrConstant</a>(0);</div><div class="line"><a name="l10514"></a><span class="lineno">10514</span>&#160;        <span class="keywordtype">unsigned</span> EltSize = (unsigned)TD.<a class="code" href="classllvm_1_1DataLayout.html#a1d6fcc02e91ba24510aba42660c90e29">getTypeAllocSize</a>(Elts[0]-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>());</div><div class="line"><a name="l10515"></a><span class="lineno">10515</span>&#160;        <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> One = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a9a66b00ea9db7d80bf1bcbbcaa108239">getIntPtrConstant</a>(EltSize);</div><div class="line"><a name="l10516"></a><span class="lineno">10516</span>&#160;</div><div class="line"><a name="l10517"></a><span class="lineno">10517</span>&#160;        <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Cond = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a2650d530046f9ddfc602dc7383ba0730">getSetCC</a>(DL,</div><div class="line"><a name="l10518"></a><span class="lineno">10518</span>&#160;                                    getSetCCResultType(N0.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>()),</div><div class="line"><a name="l10519"></a><span class="lineno">10519</span>&#160;                                    N0, N1, CC);</div><div class="line"><a name="l10520"></a><span class="lineno">10520</span>&#160;        AddToWorkList(Cond.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l10521"></a><span class="lineno">10521</span>&#160;        <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> CstOffset = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a78990d91dd364f8bb9e7008d85fd73b8">getSelect</a>(DL, Zero.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>(),</div><div class="line"><a name="l10522"></a><span class="lineno">10522</span>&#160;                                          Cond, One, Zero);</div><div class="line"><a name="l10523"></a><span class="lineno">10523</span>&#160;        AddToWorkList(CstOffset.getNode());</div><div class="line"><a name="l10524"></a><span class="lineno">10524</span>&#160;        CPIdx = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a269996b43a1f3e1d1f84a70fd4387535">ISD::ADD</a>, DL, CPIdx.getValueType(), CPIdx,</div><div class="line"><a name="l10525"></a><span class="lineno">10525</span>&#160;                            CstOffset);</div><div class="line"><a name="l10526"></a><span class="lineno">10526</span>&#160;        AddToWorkList(CPIdx.getNode());</div><div class="line"><a name="l10527"></a><span class="lineno">10527</span>&#160;        <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#ab8395be5698f080c0036d866e121a478">getLoad</a>(TV-&gt;getValueType(0), DL, DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#ad755b1a25cf0c4507d5f615f64471ae9">getEntryNode</a>(), CPIdx,</div><div class="line"><a name="l10528"></a><span class="lineno">10528</span>&#160;                           <a class="code" href="structllvm_1_1MachinePointerInfo.html#aa08f2339c536714c3cef4e56cb0f33b2">MachinePointerInfo::getConstantPool</a>(), <span class="keyword">false</span>,</div><div class="line"><a name="l10529"></a><span class="lineno">10529</span>&#160;                           <span class="keyword">false</span>, <span class="keyword">false</span>, Alignment);</div><div class="line"><a name="l10530"></a><span class="lineno">10530</span>&#160;</div><div class="line"><a name="l10531"></a><span class="lineno">10531</span>&#160;      }</div><div class="line"><a name="l10532"></a><span class="lineno">10532</span>&#160;    }</div><div class="line"><a name="l10533"></a><span class="lineno">10533</span>&#160;</div><div class="line"><a name="l10534"></a><span class="lineno">10534</span>&#160;  <span class="comment">// Check to see if we can perform the &quot;gzip trick&quot;, transforming</span></div><div class="line"><a name="l10535"></a><span class="lineno">10535</span>&#160;  <span class="comment">// (select_cc setlt X, 0, A, 0) -&gt; (and (sra X, (sub size(X), 1), A)</span></div><div class="line"><a name="l10536"></a><span class="lineno">10536</span>&#160;  <span class="keywordflow">if</span> (N1C &amp;&amp; N3C &amp;&amp; N3C-&gt;<a class="code" href="classllvm_1_1ConstantSDNode.html#a702de70a3d9e57c3ffe65bc3fab3e087">isNullValue</a>() &amp;&amp; CC == <a class="code" href="namespacellvm_1_1ISD.html#ac3c3cf58d6d631af6a172457304d3d07a6f05a09edb671910f85f8665981cbde9">ISD::SETLT</a> &amp;&amp;</div><div class="line"><a name="l10537"></a><span class="lineno">10537</span>&#160;      (N1C-&gt;<a class="code" href="classllvm_1_1ConstantSDNode.html#a702de70a3d9e57c3ffe65bc3fab3e087">isNullValue</a>() ||                         <span class="comment">// (a &lt; 0) ? b : 0</span></div><div class="line"><a name="l10538"></a><span class="lineno">10538</span>&#160;       (N1C-&gt;<a class="code" href="classllvm_1_1ConstantSDNode.html#a7951626d3fc3c89c4efee59ed9c3d8bf">getAPIntValue</a>() == 1 &amp;&amp; N0 == N2))) {   <span class="comment">// (a &lt; 1) ? a : 0</span></div><div class="line"><a name="l10539"></a><span class="lineno">10539</span>&#160;    <a class="code" href="structllvm_1_1EVT.html">EVT</a> XType = N0.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>();</div><div class="line"><a name="l10540"></a><span class="lineno">10540</span>&#160;    <a class="code" href="structllvm_1_1EVT.html">EVT</a> AType = N2.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>();</div><div class="line"><a name="l10541"></a><span class="lineno">10541</span>&#160;    <span class="keywordflow">if</span> (XType.<a class="code" href="structllvm_1_1EVT.html#a7027dbab36b90c5ccc2a34323c41bdfe">bitsGE</a>(AType)) {</div><div class="line"><a name="l10542"></a><span class="lineno">10542</span>&#160;      <span class="comment">// and (sra X, size(X)-1, A) -&gt; &quot;and (srl X, C2), A&quot; iff A is a</span></div><div class="line"><a name="l10543"></a><span class="lineno">10543</span>&#160;      <span class="comment">// single-bit constant.</span></div><div class="line"><a name="l10544"></a><span class="lineno">10544</span>&#160;      <span class="keywordflow">if</span> (N2C &amp;&amp; ((N2C-&gt;getAPIntValue() &amp; (N2C-&gt;getAPIntValue()-1)) == 0)) {</div><div class="line"><a name="l10545"></a><span class="lineno">10545</span>&#160;        <span class="keywordtype">unsigned</span> ShCtV = N2C-&gt;getAPIntValue().logBase2();</div><div class="line"><a name="l10546"></a><span class="lineno">10546</span>&#160;        ShCtV = XType.<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>()-ShCtV-1;</div><div class="line"><a name="l10547"></a><span class="lineno">10547</span>&#160;        <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> ShCt = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(ShCtV,</div><div class="line"><a name="l10548"></a><span class="lineno">10548</span>&#160;                                       getShiftAmountTy(N0.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>()));</div><div class="line"><a name="l10549"></a><span class="lineno">10549</span>&#160;        <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> <a class="code" href="Target_2README_8txt.html#a8db36c82f32d6f6a4d35a00e55be03a8">Shift</a> = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a3c6553c8acebe1b57c211ee45e2d8f98">ISD::SRL</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N0),</div><div class="line"><a name="l10550"></a><span class="lineno">10550</span>&#160;                                    XType, N0, ShCt);</div><div class="line"><a name="l10551"></a><span class="lineno">10551</span>&#160;        AddToWorkList(Shift.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l10552"></a><span class="lineno">10552</span>&#160;</div><div class="line"><a name="l10553"></a><span class="lineno">10553</span>&#160;        <span class="keywordflow">if</span> (XType.<a class="code" href="structllvm_1_1EVT.html#ac267a86695d58fe541ef96f8c60c1b0f">bitsGT</a>(AType)) {</div><div class="line"><a name="l10554"></a><span class="lineno">10554</span>&#160;          Shift = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ae690127648393001a7d5b93dc23da7b3">ISD::TRUNCATE</a>, DL, AType, Shift);</div><div class="line"><a name="l10555"></a><span class="lineno">10555</span>&#160;          AddToWorkList(Shift.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l10556"></a><span class="lineno">10556</span>&#160;        }</div><div class="line"><a name="l10557"></a><span class="lineno">10557</span>&#160;</div><div class="line"><a name="l10558"></a><span class="lineno">10558</span>&#160;        <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ac513a7da1bf74fb3e3c594da8534f2d2">ISD::AND</a>, DL, AType, Shift, N2);</div><div class="line"><a name="l10559"></a><span class="lineno">10559</span>&#160;      }</div><div class="line"><a name="l10560"></a><span class="lineno">10560</span>&#160;</div><div class="line"><a name="l10561"></a><span class="lineno">10561</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> <a class="code" href="Target_2README_8txt.html#a8db36c82f32d6f6a4d35a00e55be03a8">Shift</a> = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a4a055321c361a0f6ee77ed764730ffc1">ISD::SRA</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N0),</div><div class="line"><a name="l10562"></a><span class="lineno">10562</span>&#160;                                  XType, N0,</div><div class="line"><a name="l10563"></a><span class="lineno">10563</span>&#160;                                  DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(XType.<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>()-1,</div><div class="line"><a name="l10564"></a><span class="lineno">10564</span>&#160;                                         getShiftAmountTy(N0.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>())));</div><div class="line"><a name="l10565"></a><span class="lineno">10565</span>&#160;      AddToWorkList(Shift.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l10566"></a><span class="lineno">10566</span>&#160;</div><div class="line"><a name="l10567"></a><span class="lineno">10567</span>&#160;      <span class="keywordflow">if</span> (XType.<a class="code" href="structllvm_1_1EVT.html#ac267a86695d58fe541ef96f8c60c1b0f">bitsGT</a>(AType)) {</div><div class="line"><a name="l10568"></a><span class="lineno">10568</span>&#160;        Shift = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ae690127648393001a7d5b93dc23da7b3">ISD::TRUNCATE</a>, DL, AType, Shift);</div><div class="line"><a name="l10569"></a><span class="lineno">10569</span>&#160;        AddToWorkList(Shift.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l10570"></a><span class="lineno">10570</span>&#160;      }</div><div class="line"><a name="l10571"></a><span class="lineno">10571</span>&#160;</div><div class="line"><a name="l10572"></a><span class="lineno">10572</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ac513a7da1bf74fb3e3c594da8534f2d2">ISD::AND</a>, DL, AType, Shift, N2);</div><div class="line"><a name="l10573"></a><span class="lineno">10573</span>&#160;    }</div><div class="line"><a name="l10574"></a><span class="lineno">10574</span>&#160;  }</div><div class="line"><a name="l10575"></a><span class="lineno">10575</span>&#160;</div><div class="line"><a name="l10576"></a><span class="lineno">10576</span>&#160;  <span class="comment">// fold (select_cc seteq (and x, y), 0, 0, A) -&gt; (and (shr (shl x)) A)</span></div><div class="line"><a name="l10577"></a><span class="lineno">10577</span>&#160;  <span class="comment">// where y is has a single bit set.</span></div><div class="line"><a name="l10578"></a><span class="lineno">10578</span>&#160;  <span class="comment">// A plaintext description would be, we can turn the SELECT_CC into an AND</span></div><div class="line"><a name="l10579"></a><span class="lineno">10579</span>&#160;  <span class="comment">// when the condition can be materialized as an all-ones register.  Any</span></div><div class="line"><a name="l10580"></a><span class="lineno">10580</span>&#160;  <span class="comment">// single bit-test can be materialized as an all-ones register with</span></div><div class="line"><a name="l10581"></a><span class="lineno">10581</span>&#160;  <span class="comment">// shift-left and shift-right-arith.</span></div><div class="line"><a name="l10582"></a><span class="lineno">10582</span>&#160;  <span class="keywordflow">if</span> (CC == <a class="code" href="namespacellvm_1_1ISD.html#ac3c3cf58d6d631af6a172457304d3d07ae2e6a5e32087b9f65bd51585a6a5afb4">ISD::SETEQ</a> &amp;&amp; N0-&gt;<a class="code" href="classllvm_1_1SDNode.html#af0d328f3f61168f4ea7d6e4044af4f97">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ac513a7da1bf74fb3e3c594da8534f2d2">ISD::AND</a> &amp;&amp;</div><div class="line"><a name="l10583"></a><span class="lineno">10583</span>&#160;      N0-&gt;<a class="code" href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">getValueType</a>(0) == VT &amp;&amp;</div><div class="line"><a name="l10584"></a><span class="lineno">10584</span>&#160;      N1C &amp;&amp; N1C-&gt;<a class="code" href="classllvm_1_1ConstantSDNode.html#a702de70a3d9e57c3ffe65bc3fab3e087">isNullValue</a>() &amp;&amp;</div><div class="line"><a name="l10585"></a><span class="lineno">10585</span>&#160;      N2C &amp;&amp; N2C-&gt;isNullValue()) {</div><div class="line"><a name="l10586"></a><span class="lineno">10586</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> AndLHS = N0-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0);</div><div class="line"><a name="l10587"></a><span class="lineno">10587</span>&#160;    <a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a> *ConstAndRHS = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a>&gt;(N0-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(1));</div><div class="line"><a name="l10588"></a><span class="lineno">10588</span>&#160;    <span class="keywordflow">if</span> (ConstAndRHS &amp;&amp; ConstAndRHS-&gt;<a class="code" href="classllvm_1_1ConstantSDNode.html#a7951626d3fc3c89c4efee59ed9c3d8bf">getAPIntValue</a>().<a class="code" href="classllvm_1_1APInt.html#ac9d5eb700dcdf604653d12d8caf4a0fb">countPopulation</a>() == 1) {</div><div class="line"><a name="l10589"></a><span class="lineno">10589</span>&#160;      <span class="comment">// Shift the tested bit over the sign bit.</span></div><div class="line"><a name="l10590"></a><span class="lineno">10590</span>&#160;      <a class="code" href="classllvm_1_1APInt.html">APInt</a> AndMask = ConstAndRHS-&gt;<a class="code" href="classllvm_1_1ConstantSDNode.html#a7951626d3fc3c89c4efee59ed9c3d8bf">getAPIntValue</a>();</div><div class="line"><a name="l10591"></a><span class="lineno">10591</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> ShlAmt =</div><div class="line"><a name="l10592"></a><span class="lineno">10592</span>&#160;        DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(AndMask.<a class="code" href="classllvm_1_1APInt.html#af0336ea4c7f7f56354b2ca7c8859c1f9">countLeadingZeros</a>(),</div><div class="line"><a name="l10593"></a><span class="lineno">10593</span>&#160;                        getShiftAmountTy(AndLHS.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>()));</div><div class="line"><a name="l10594"></a><span class="lineno">10594</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Shl = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a8cc94e03dea594863073a02f5bb94997">ISD::SHL</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N0), VT, AndLHS, ShlAmt);</div><div class="line"><a name="l10595"></a><span class="lineno">10595</span>&#160;</div><div class="line"><a name="l10596"></a><span class="lineno">10596</span>&#160;      <span class="comment">// Now arithmetic right shift it all the way over, so the result is either</span></div><div class="line"><a name="l10597"></a><span class="lineno">10597</span>&#160;      <span class="comment">// all-ones, or zero.</span></div><div class="line"><a name="l10598"></a><span class="lineno">10598</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> ShrAmt =</div><div class="line"><a name="l10599"></a><span class="lineno">10599</span>&#160;        DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(AndMask.<a class="code" href="classllvm_1_1APInt.html#ad081689e23a8f5dea78dedd623d6a8f8">getBitWidth</a>()-1,</div><div class="line"><a name="l10600"></a><span class="lineno">10600</span>&#160;                        getShiftAmountTy(Shl.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>()));</div><div class="line"><a name="l10601"></a><span class="lineno">10601</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Shr = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a4a055321c361a0f6ee77ed764730ffc1">ISD::SRA</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N0), VT, Shl, ShrAmt);</div><div class="line"><a name="l10602"></a><span class="lineno">10602</span>&#160;</div><div class="line"><a name="l10603"></a><span class="lineno">10603</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ac513a7da1bf74fb3e3c594da8534f2d2">ISD::AND</a>, DL, VT, Shr, N3);</div><div class="line"><a name="l10604"></a><span class="lineno">10604</span>&#160;    }</div><div class="line"><a name="l10605"></a><span class="lineno">10605</span>&#160;  }</div><div class="line"><a name="l10606"></a><span class="lineno">10606</span>&#160;</div><div class="line"><a name="l10607"></a><span class="lineno">10607</span>&#160;  <span class="comment">// fold select C, 16, 0 -&gt; shl C, 4</span></div><div class="line"><a name="l10608"></a><span class="lineno">10608</span>&#160;  <span class="keywordflow">if</span> (N2C &amp;&amp; N3C &amp;&amp; N3C-&gt;isNullValue() &amp;&amp; N2C-&gt;getAPIntValue().isPowerOf2() &amp;&amp;</div><div class="line"><a name="l10609"></a><span class="lineno">10609</span>&#160;    TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a09bdc91589b715806d421ccbc540347d">getBooleanContents</a>(N0.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>().<a class="code" href="structllvm_1_1EVT.html#a73f7c824cad61a47c21bf6d652ae2fd7">isVector</a>()) ==</div><div class="line"><a name="l10610"></a><span class="lineno">10610</span>&#160;      <a class="code" href="classllvm_1_1TargetLoweringBase.html#aa61af767c51a95e2dd0dff2001168755a0e2d72cfdcc49d2d189f440b3cc31dff">TargetLowering::ZeroOrOneBooleanContent</a>) {</div><div class="line"><a name="l10611"></a><span class="lineno">10611</span>&#160;</div><div class="line"><a name="l10612"></a><span class="lineno">10612</span>&#160;    <span class="comment">// If the caller doesn&#39;t want us to simplify this into a zext of a compare,</span></div><div class="line"><a name="l10613"></a><span class="lineno">10613</span>&#160;    <span class="comment">// don&#39;t do it.</span></div><div class="line"><a name="l10614"></a><span class="lineno">10614</span>&#160;    <span class="keywordflow">if</span> (NotExtCompare &amp;&amp; N2C-&gt;getAPIntValue() == 1)</div><div class="line"><a name="l10615"></a><span class="lineno">10615</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l10616"></a><span class="lineno">10616</span>&#160;</div><div class="line"><a name="l10617"></a><span class="lineno">10617</span>&#160;    <span class="comment">// Get a SetCC of the condition</span></div><div class="line"><a name="l10618"></a><span class="lineno">10618</span>&#160;    <span class="comment">// NOTE: Don&#39;t create a SETCC if it&#39;s not legal on this target.</span></div><div class="line"><a name="l10619"></a><span class="lineno">10619</span>&#160;    <span class="keywordflow">if</span> (!LegalOperations ||</div><div class="line"><a name="l10620"></a><span class="lineno">10620</span>&#160;        TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a055b3905dbbc16fae11510b9ebd1e00c">isOperationLegal</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a0158ee47dfa868be5d28e2cbef70d5d0">ISD::SETCC</a>,</div><div class="line"><a name="l10621"></a><span class="lineno">10621</span>&#160;          LegalTypes ? getSetCCResultType(N0.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>()) : <a class="code" href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50ca85440bbdbba12de574c02e515444d3f4">MVT::i1</a>)) {</div><div class="line"><a name="l10622"></a><span class="lineno">10622</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Temp, SCC;</div><div class="line"><a name="l10623"></a><span class="lineno">10623</span>&#160;      <span class="comment">// cast from setcc result type to select result type</span></div><div class="line"><a name="l10624"></a><span class="lineno">10624</span>&#160;      <span class="keywordflow">if</span> (LegalTypes) {</div><div class="line"><a name="l10625"></a><span class="lineno">10625</span>&#160;        SCC  = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a2650d530046f9ddfc602dc7383ba0730">getSetCC</a>(DL, getSetCCResultType(N0.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>()),</div><div class="line"><a name="l10626"></a><span class="lineno">10626</span>&#160;                            N0, N1, CC);</div><div class="line"><a name="l10627"></a><span class="lineno">10627</span>&#160;        <span class="keywordflow">if</span> (N2.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>().<a class="code" href="structllvm_1_1EVT.html#a5ebe5227fe53e0dcf4102a6ebf1594a2">bitsLT</a>(SCC.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>()))</div><div class="line"><a name="l10628"></a><span class="lineno">10628</span>&#160;          Temp = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#ad03d69f873a948a3de21ba504364d352">getZeroExtendInReg</a>(SCC, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N2),</div><div class="line"><a name="l10629"></a><span class="lineno">10629</span>&#160;                                        N2.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>());</div><div class="line"><a name="l10630"></a><span class="lineno">10630</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l10631"></a><span class="lineno">10631</span>&#160;          Temp = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a93fdf85eff945f1a668b4915a051453e">ISD::ZERO_EXTEND</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N2),</div><div class="line"><a name="l10632"></a><span class="lineno">10632</span>&#160;                             N2.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>(), SCC);</div><div class="line"><a name="l10633"></a><span class="lineno">10633</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l10634"></a><span class="lineno">10634</span>&#160;        SCC  = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a2650d530046f9ddfc602dc7383ba0730">getSetCC</a>(<a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N0), <a class="code" href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50ca85440bbdbba12de574c02e515444d3f4">MVT::i1</a>, N0, N1, CC);</div><div class="line"><a name="l10635"></a><span class="lineno">10635</span>&#160;        Temp = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a93fdf85eff945f1a668b4915a051453e">ISD::ZERO_EXTEND</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N2),</div><div class="line"><a name="l10636"></a><span class="lineno">10636</span>&#160;                           N2.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>(), SCC);</div><div class="line"><a name="l10637"></a><span class="lineno">10637</span>&#160;      }</div><div class="line"><a name="l10638"></a><span class="lineno">10638</span>&#160;</div><div class="line"><a name="l10639"></a><span class="lineno">10639</span>&#160;      AddToWorkList(SCC.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l10640"></a><span class="lineno">10640</span>&#160;      AddToWorkList(Temp.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l10641"></a><span class="lineno">10641</span>&#160;</div><div class="line"><a name="l10642"></a><span class="lineno">10642</span>&#160;      <span class="keywordflow">if</span> (N2C-&gt;getAPIntValue() == 1)</div><div class="line"><a name="l10643"></a><span class="lineno">10643</span>&#160;        <span class="keywordflow">return</span> Temp;</div><div class="line"><a name="l10644"></a><span class="lineno">10644</span>&#160;</div><div class="line"><a name="l10645"></a><span class="lineno">10645</span>&#160;      <span class="comment">// shl setcc result by log2 n2c</span></div><div class="line"><a name="l10646"></a><span class="lineno">10646</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(</div><div class="line"><a name="l10647"></a><span class="lineno">10647</span>&#160;          <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a8cc94e03dea594863073a02f5bb94997">ISD::SHL</a>, DL, N2.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>(), Temp,</div><div class="line"><a name="l10648"></a><span class="lineno">10648</span>&#160;          DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(N2C-&gt;getAPIntValue().logBase2(),</div><div class="line"><a name="l10649"></a><span class="lineno">10649</span>&#160;                          getShiftAmountTy(Temp.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>())));</div><div class="line"><a name="l10650"></a><span class="lineno">10650</span>&#160;    }</div><div class="line"><a name="l10651"></a><span class="lineno">10651</span>&#160;  }</div><div class="line"><a name="l10652"></a><span class="lineno">10652</span>&#160;</div><div class="line"><a name="l10653"></a><span class="lineno">10653</span>&#160;  <span class="comment">// Check to see if this is the equivalent of setcc</span></div><div class="line"><a name="l10654"></a><span class="lineno">10654</span>&#160;  <span class="comment">// FIXME: Turn all of these into setcc if setcc if setcc is legal</span></div><div class="line"><a name="l10655"></a><span class="lineno">10655</span>&#160;  <span class="comment">// otherwise, go ahead with the folds.</span></div><div class="line"><a name="l10656"></a><span class="lineno">10656</span>&#160;  <span class="keywordflow">if</span> (0 &amp;&amp; N3C &amp;&amp; N3C-&gt;isNullValue() &amp;&amp; N2C &amp;&amp; (N2C-&gt;getAPIntValue() == 1ULL)) {</div><div class="line"><a name="l10657"></a><span class="lineno">10657</span>&#160;    <a class="code" href="structllvm_1_1EVT.html">EVT</a> XType = N0.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>();</div><div class="line"><a name="l10658"></a><span class="lineno">10658</span>&#160;    <span class="keywordflow">if</span> (!LegalOperations ||</div><div class="line"><a name="l10659"></a><span class="lineno">10659</span>&#160;        TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a055b3905dbbc16fae11510b9ebd1e00c">isOperationLegal</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a0158ee47dfa868be5d28e2cbef70d5d0">ISD::SETCC</a>, getSetCCResultType(XType))) {</div><div class="line"><a name="l10660"></a><span class="lineno">10660</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Res = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a2650d530046f9ddfc602dc7383ba0730">getSetCC</a>(DL, getSetCCResultType(XType), N0, N1, CC);</div><div class="line"><a name="l10661"></a><span class="lineno">10661</span>&#160;      <span class="keywordflow">if</span> (Res.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>() != VT)</div><div class="line"><a name="l10662"></a><span class="lineno">10662</span>&#160;        Res = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a93fdf85eff945f1a668b4915a051453e">ISD::ZERO_EXTEND</a>, DL, VT, Res);</div><div class="line"><a name="l10663"></a><span class="lineno">10663</span>&#160;      <span class="keywordflow">return</span> Res;</div><div class="line"><a name="l10664"></a><span class="lineno">10664</span>&#160;    }</div><div class="line"><a name="l10665"></a><span class="lineno">10665</span>&#160;</div><div class="line"><a name="l10666"></a><span class="lineno">10666</span>&#160;    <span class="comment">// fold (seteq X, 0) -&gt; (srl (ctlz X, log2(size(X))))</span></div><div class="line"><a name="l10667"></a><span class="lineno">10667</span>&#160;    <span class="keywordflow">if</span> (N1C &amp;&amp; N1C-&gt;<a class="code" href="classllvm_1_1ConstantSDNode.html#a702de70a3d9e57c3ffe65bc3fab3e087">isNullValue</a>() &amp;&amp; CC == <a class="code" href="namespacellvm_1_1ISD.html#ac3c3cf58d6d631af6a172457304d3d07ae2e6a5e32087b9f65bd51585a6a5afb4">ISD::SETEQ</a> &amp;&amp;</div><div class="line"><a name="l10668"></a><span class="lineno">10668</span>&#160;        (!LegalOperations ||</div><div class="line"><a name="l10669"></a><span class="lineno">10669</span>&#160;         TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a055b3905dbbc16fae11510b9ebd1e00c">isOperationLegal</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110add33c0ae9a63902e573fc1f92fc33f1c">ISD::CTLZ</a>, XType))) {</div><div class="line"><a name="l10670"></a><span class="lineno">10670</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Ctlz = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110add33c0ae9a63902e573fc1f92fc33f1c">ISD::CTLZ</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N0), XType, N0);</div><div class="line"><a name="l10671"></a><span class="lineno">10671</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a3c6553c8acebe1b57c211ee45e2d8f98">ISD::SRL</a>, DL, XType, Ctlz,</div><div class="line"><a name="l10672"></a><span class="lineno">10672</span>&#160;                         DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(<a class="code" href="namespacellvm.html#a646986783f35e0fef8988f0f28d2589f">Log2_32</a>(XType.<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>()),</div><div class="line"><a name="l10673"></a><span class="lineno">10673</span>&#160;                                       getShiftAmountTy(Ctlz.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>())));</div><div class="line"><a name="l10674"></a><span class="lineno">10674</span>&#160;    }</div><div class="line"><a name="l10675"></a><span class="lineno">10675</span>&#160;    <span class="comment">// fold (setgt X, 0) -&gt; (srl (and (-X, ~X), size(X)-1))</span></div><div class="line"><a name="l10676"></a><span class="lineno">10676</span>&#160;    <span class="keywordflow">if</span> (N1C &amp;&amp; N1C-&gt;<a class="code" href="classllvm_1_1ConstantSDNode.html#a702de70a3d9e57c3ffe65bc3fab3e087">isNullValue</a>() &amp;&amp; CC == <a class="code" href="namespacellvm_1_1ISD.html#ac3c3cf58d6d631af6a172457304d3d07a5ad12b466e3a5900d0c307b301465d25">ISD::SETGT</a>) {</div><div class="line"><a name="l10677"></a><span class="lineno">10677</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> NegN0 = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9fa617e5567c3c2638938f7b9ddc3f1c">ISD::SUB</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N0),</div><div class="line"><a name="l10678"></a><span class="lineno">10678</span>&#160;                                  XType, DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(0, XType), N0);</div><div class="line"><a name="l10679"></a><span class="lineno">10679</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> NotN0 = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a17becda56598e1d6b0d8fda77cd2fbe7">getNOT</a>(<a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N0), N0, XType);</div><div class="line"><a name="l10680"></a><span class="lineno">10680</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a3c6553c8acebe1b57c211ee45e2d8f98">ISD::SRL</a>, DL, XType,</div><div class="line"><a name="l10681"></a><span class="lineno">10681</span>&#160;                         DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ac513a7da1bf74fb3e3c594da8534f2d2">ISD::AND</a>, DL, XType, NegN0, NotN0),</div><div class="line"><a name="l10682"></a><span class="lineno">10682</span>&#160;                         DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(XType.<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>()-1,</div><div class="line"><a name="l10683"></a><span class="lineno">10683</span>&#160;                                         getShiftAmountTy(XType)));</div><div class="line"><a name="l10684"></a><span class="lineno">10684</span>&#160;    }</div><div class="line"><a name="l10685"></a><span class="lineno">10685</span>&#160;    <span class="comment">// fold (setgt X, -1) -&gt; (xor (srl (X, size(X)-1), 1))</span></div><div class="line"><a name="l10686"></a><span class="lineno">10686</span>&#160;    <span class="keywordflow">if</span> (N1C &amp;&amp; N1C-&gt;<a class="code" href="classllvm_1_1ConstantSDNode.html#aa5c86745e9f101eabafef104239b9677">isAllOnesValue</a>() &amp;&amp; CC == <a class="code" href="namespacellvm_1_1ISD.html#ac3c3cf58d6d631af6a172457304d3d07a5ad12b466e3a5900d0c307b301465d25">ISD::SETGT</a>) {</div><div class="line"><a name="l10687"></a><span class="lineno">10687</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Sign = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a3c6553c8acebe1b57c211ee45e2d8f98">ISD::SRL</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N0), XType, N0,</div><div class="line"><a name="l10688"></a><span class="lineno">10688</span>&#160;                                 DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(XType.<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>()-1,</div><div class="line"><a name="l10689"></a><span class="lineno">10689</span>&#160;                                         getShiftAmountTy(N0.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>())));</div><div class="line"><a name="l10690"></a><span class="lineno">10690</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a92febb83e6ba116eb7aae8e7e3f70cc1">ISD::XOR</a>, DL, XType, Sign, DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(1, XType));</div><div class="line"><a name="l10691"></a><span class="lineno">10691</span>&#160;    }</div><div class="line"><a name="l10692"></a><span class="lineno">10692</span>&#160;  }</div><div class="line"><a name="l10693"></a><span class="lineno">10693</span>&#160;</div><div class="line"><a name="l10694"></a><span class="lineno">10694</span>&#160;  <span class="comment">// Check to see if this is an integer abs.</span></div><div class="line"><a name="l10695"></a><span class="lineno">10695</span>&#160;  <span class="comment">// select_cc setg[te] X,  0,  X, -X -&gt;</span></div><div class="line"><a name="l10696"></a><span class="lineno">10696</span>&#160;  <span class="comment">// select_cc setgt    X, -1,  X, -X -&gt;</span></div><div class="line"><a name="l10697"></a><span class="lineno">10697</span>&#160;  <span class="comment">// select_cc setl[te] X,  0, -X,  X -&gt;</span></div><div class="line"><a name="l10698"></a><span class="lineno">10698</span>&#160;  <span class="comment">// select_cc setlt    X,  1, -X,  X -&gt;</span></div><div class="line"><a name="l10699"></a><span class="lineno">10699</span>&#160;  <span class="comment">// Y = sra (X, size(X)-1); xor (add (X, Y), Y)</span></div><div class="line"><a name="l10700"></a><span class="lineno">10700</span>&#160;  <span class="keywordflow">if</span> (N1C) {</div><div class="line"><a name="l10701"></a><span class="lineno">10701</span>&#160;    <a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a> *SubC = NULL;</div><div class="line"><a name="l10702"></a><span class="lineno">10702</span>&#160;    <span class="keywordflow">if</span> (((N1C-&gt;<a class="code" href="classllvm_1_1ConstantSDNode.html#a702de70a3d9e57c3ffe65bc3fab3e087">isNullValue</a>() &amp;&amp; (CC == <a class="code" href="namespacellvm_1_1ISD.html#ac3c3cf58d6d631af6a172457304d3d07a5ad12b466e3a5900d0c307b301465d25">ISD::SETGT</a> || CC == <a class="code" href="namespacellvm_1_1ISD.html#ac3c3cf58d6d631af6a172457304d3d07a7f47862de23f7210f88ccf98ae1efbe4">ISD::SETGE</a>)) ||</div><div class="line"><a name="l10703"></a><span class="lineno">10703</span>&#160;         (N1C-&gt;<a class="code" href="classllvm_1_1ConstantSDNode.html#aa5c86745e9f101eabafef104239b9677">isAllOnesValue</a>() &amp;&amp; CC == <a class="code" href="namespacellvm_1_1ISD.html#ac3c3cf58d6d631af6a172457304d3d07a5ad12b466e3a5900d0c307b301465d25">ISD::SETGT</a>)) &amp;&amp;</div><div class="line"><a name="l10704"></a><span class="lineno">10704</span>&#160;        N0 == N2 &amp;&amp; N3.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9fa617e5567c3c2638938f7b9ddc3f1c">ISD::SUB</a> &amp;&amp; N0 == N3.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1))</div><div class="line"><a name="l10705"></a><span class="lineno">10705</span>&#160;      SubC = dyn_cast&lt;ConstantSDNode&gt;(N3.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0));</div><div class="line"><a name="l10706"></a><span class="lineno">10706</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (((N1C-&gt;<a class="code" href="classllvm_1_1ConstantSDNode.html#a702de70a3d9e57c3ffe65bc3fab3e087">isNullValue</a>() &amp;&amp; (CC == <a class="code" href="namespacellvm_1_1ISD.html#ac3c3cf58d6d631af6a172457304d3d07a6f05a09edb671910f85f8665981cbde9">ISD::SETLT</a> || CC == <a class="code" href="namespacellvm_1_1ISD.html#ac3c3cf58d6d631af6a172457304d3d07ab49f81c2ecbbff3d0fbe55dd46353774">ISD::SETLE</a>)) ||</div><div class="line"><a name="l10707"></a><span class="lineno">10707</span>&#160;              (N1C-&gt;<a class="code" href="classllvm_1_1ConstantSDNode.html#ac27741dc62185494433dec7a5f723f70">isOne</a>() &amp;&amp; CC == <a class="code" href="namespacellvm_1_1ISD.html#ac3c3cf58d6d631af6a172457304d3d07a6f05a09edb671910f85f8665981cbde9">ISD::SETLT</a>)) &amp;&amp;</div><div class="line"><a name="l10708"></a><span class="lineno">10708</span>&#160;             N0 == N3 &amp;&amp; N2.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9fa617e5567c3c2638938f7b9ddc3f1c">ISD::SUB</a> &amp;&amp; N0 == N2.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1))</div><div class="line"><a name="l10709"></a><span class="lineno">10709</span>&#160;      SubC = dyn_cast&lt;ConstantSDNode&gt;(N2.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0));</div><div class="line"><a name="l10710"></a><span class="lineno">10710</span>&#160;</div><div class="line"><a name="l10711"></a><span class="lineno">10711</span>&#160;    <a class="code" href="structllvm_1_1EVT.html">EVT</a> XType = N0.getValueType();</div><div class="line"><a name="l10712"></a><span class="lineno">10712</span>&#160;    <span class="keywordflow">if</span> (SubC &amp;&amp; SubC-&gt;<a class="code" href="classllvm_1_1ConstantSDNode.html#a702de70a3d9e57c3ffe65bc3fab3e087">isNullValue</a>() &amp;&amp; XType.<a class="code" href="structllvm_1_1EVT.html#a8cc407ac00df4edd4ec4d5168d6ecb26">isInteger</a>()) {</div><div class="line"><a name="l10713"></a><span class="lineno">10713</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> <a class="code" href="Target_2README_8txt.html#a8db36c82f32d6f6a4d35a00e55be03a8">Shift</a> = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a4a055321c361a0f6ee77ed764730ffc1">ISD::SRA</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N0), XType,</div><div class="line"><a name="l10714"></a><span class="lineno">10714</span>&#160;                                  N0,</div><div class="line"><a name="l10715"></a><span class="lineno">10715</span>&#160;                                  DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">getConstant</a>(XType.<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>()-1,</div><div class="line"><a name="l10716"></a><span class="lineno">10716</span>&#160;                                         getShiftAmountTy(N0.getValueType())));</div><div class="line"><a name="l10717"></a><span class="lineno">10717</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Add = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a269996b43a1f3e1d1f84a70fd4387535">ISD::ADD</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N0),</div><div class="line"><a name="l10718"></a><span class="lineno">10718</span>&#160;                                XType, N0, Shift);</div><div class="line"><a name="l10719"></a><span class="lineno">10719</span>&#160;      AddToWorkList(Shift.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l10720"></a><span class="lineno">10720</span>&#160;      AddToWorkList(Add.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div><div class="line"><a name="l10721"></a><span class="lineno">10721</span>&#160;      <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a92febb83e6ba116eb7aae8e7e3f70cc1">ISD::XOR</a>, DL, XType, Add, Shift);</div><div class="line"><a name="l10722"></a><span class="lineno">10722</span>&#160;    }</div><div class="line"><a name="l10723"></a><span class="lineno">10723</span>&#160;  }</div><div class="line"><a name="l10724"></a><span class="lineno">10724</span>&#160;</div><div class="line"><a name="l10725"></a><span class="lineno">10725</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>();</div><div class="line"><a name="l10726"></a><span class="lineno">10726</span>&#160;}</div><div class="line"><a name="l10727"></a><span class="lineno">10727</span>&#160;<span class="comment"></span></div><div class="line"><a name="l10728"></a><span class="lineno">10728</span>&#160;<span class="comment">/// SimplifySetCC - This is a stub for TargetLowering::SimplifySetCC.</span></div><div class="line"><a name="l10729"></a><span class="lineno">10729</span>&#160;<span class="comment"></span><a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::SimplifySetCC(<a class="code" href="structllvm_1_1EVT.html">EVT</a> VT, <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N0,</div><div class="line"><a name="l10730"></a><span class="lineno">10730</span>&#160;                                   <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> N1, <a class="code" href="namespacellvm_1_1ISD.html#ac3c3cf58d6d631af6a172457304d3d07">ISD::CondCode</a> Cond,</div><div class="line"><a name="l10731"></a><span class="lineno">10731</span>&#160;                                   <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a> DL, <span class="keywordtype">bool</span> foldBooleans) {</div><div class="line"><a name="l10732"></a><span class="lineno">10732</span>&#160;  <a class="code" href="structllvm_1_1TargetLowering_1_1DAGCombinerInfo.html">TargetLowering::DAGCombinerInfo</a></div><div class="line"><a name="l10733"></a><span class="lineno">10733</span>&#160;    DagCombineInfo(DAG, Level, <span class="keyword">false</span>, <span class="keyword">this</span>);</div><div class="line"><a name="l10734"></a><span class="lineno">10734</span>&#160;  <span class="keywordflow">return</span> TLI.<a class="code" href="classllvm_1_1TargetLowering.html#a8a9fc84a7385e8d42a0994df86eb50ec">SimplifySetCC</a>(VT, N0, N1, Cond, foldBooleans, DagCombineInfo, DL);</div><div class="line"><a name="l10735"></a><span class="lineno">10735</span>&#160;}</div><div class="line"><a name="l10736"></a><span class="lineno">10736</span>&#160;<span class="comment"></span></div><div class="line"><a name="l10737"></a><span class="lineno">10737</span>&#160;<span class="comment">/// BuildSDIVSequence - Given an ISD::SDIV node expressing a divide by constant,</span></div><div class="line"><a name="l10738"></a><span class="lineno">10738</span>&#160;<span class="comment">/// return a DAG expression to select that will generate the same value by</span></div><div class="line"><a name="l10739"></a><span class="lineno">10739</span>&#160;<span class="comment">/// multiplying by a magic number.  See:</span></div><div class="line"><a name="l10740"></a><span class="lineno">10740</span>&#160;<span class="comment">/// &lt;http://the.wall.riscom.net/books/proc/ppc/cwg/code2.html&gt;</span></div><div class="line"><a name="l10741"></a><span class="lineno">10741</span>&#160;<span class="comment"></span><a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::BuildSDIV(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N) {</div><div class="line"><a name="l10742"></a><span class="lineno">10742</span>&#160;  std::vector&lt;SDNode*&gt; Built;</div><div class="line"><a name="l10743"></a><span class="lineno">10743</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> <a class="code" href="Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a> = TLI.<a class="code" href="classllvm_1_1TargetLowering.html#a84124dc2319e755656a9d117239ef46a">BuildSDIV</a>(N, DAG, LegalOperations, &amp;Built);</div><div class="line"><a name="l10744"></a><span class="lineno">10744</span>&#160;</div><div class="line"><a name="l10745"></a><span class="lineno">10745</span>&#160;  <span class="keywordflow">for</span> (std::vector&lt;SDNode*&gt;::iterator ii = Built.begin(), ee = Built.end();</div><div class="line"><a name="l10746"></a><span class="lineno">10746</span>&#160;       ii != ee; ++ii)</div><div class="line"><a name="l10747"></a><span class="lineno">10747</span>&#160;    AddToWorkList(*ii);</div><div class="line"><a name="l10748"></a><span class="lineno">10748</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>;</div><div class="line"><a name="l10749"></a><span class="lineno">10749</span>&#160;}</div><div class="line"><a name="l10750"></a><span class="lineno">10750</span>&#160;<span class="comment"></span></div><div class="line"><a name="l10751"></a><span class="lineno">10751</span>&#160;<span class="comment">/// BuildUDIVSequence - Given an ISD::UDIV node expressing a divide by constant,</span></div><div class="line"><a name="l10752"></a><span class="lineno">10752</span>&#160;<span class="comment">/// return a DAG expression to select that will generate the same value by</span></div><div class="line"><a name="l10753"></a><span class="lineno">10753</span>&#160;<span class="comment">/// multiplying by a magic number.  See:</span></div><div class="line"><a name="l10754"></a><span class="lineno">10754</span>&#160;<span class="comment">/// &lt;http://the.wall.riscom.net/books/proc/ppc/cwg/code2.html&gt;</span></div><div class="line"><a name="l10755"></a><span class="lineno">10755</span>&#160;<span class="comment"></span><a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::BuildUDIV(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N) {</div><div class="line"><a name="l10756"></a><span class="lineno">10756</span>&#160;  std::vector&lt;SDNode*&gt; Built;</div><div class="line"><a name="l10757"></a><span class="lineno">10757</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> <a class="code" href="Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a> = TLI.<a class="code" href="classllvm_1_1TargetLowering.html#a241851c27ed9099a903c7ab9c7a8675f">BuildUDIV</a>(N, DAG, LegalOperations, &amp;Built);</div><div class="line"><a name="l10758"></a><span class="lineno">10758</span>&#160;</div><div class="line"><a name="l10759"></a><span class="lineno">10759</span>&#160;  <span class="keywordflow">for</span> (std::vector&lt;SDNode*&gt;::iterator ii = Built.begin(), ee = Built.end();</div><div class="line"><a name="l10760"></a><span class="lineno">10760</span>&#160;       ii != ee; ++ii)</div><div class="line"><a name="l10761"></a><span class="lineno">10761</span>&#160;    AddToWorkList(*ii);</div><div class="line"><a name="l10762"></a><span class="lineno">10762</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>;</div><div class="line"><a name="l10763"></a><span class="lineno">10763</span>&#160;}</div><div class="line"><a name="l10764"></a><span class="lineno">10764</span>&#160;<span class="comment"></span></div><div class="line"><a name="l10765"></a><span class="lineno">10765</span>&#160;<span class="comment">/// FindBaseOffset - Return true if base is a frame index, which is known not</span></div><div class="line"><a name="l10766"></a><span class="lineno">10766</span>&#160;<span class="comment"></span><span class="comment">// to alias with anything but itself.  Provides base object and offset as</span></div><div class="line"><a name="l10767"></a><span class="lineno">10767</span>&#160;<span class="comment">// results.</span></div><div class="line"><a name="l10768"></a><span class="lineno"><a class="line" href="DAGCombiner_8cpp.html#a31be5288def7545189cab5401fe3a1b0">10768</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="DAGCombiner_8cpp.html#a31be5288def7545189cab5401fe3a1b0">FindBaseOffset</a>(<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Ptr, <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> &amp;Base, int64_t &amp;Offset,</div><div class="line"><a name="l10769"></a><span class="lineno">10769</span>&#160;                           <span class="keyword">const</span> <a class="code" href="classllvm_1_1GlobalValue.html">GlobalValue</a> *&amp;GV, <span class="keyword">const</span> <span class="keywordtype">void</span> *&amp;CV) {</div><div class="line"><a name="l10770"></a><span class="lineno">10770</span>&#160;  <span class="comment">// Assume it is a primitive operation.</span></div><div class="line"><a name="l10771"></a><span class="lineno">10771</span>&#160;  Base = Ptr; Offset = 0; GV = 0; CV = 0;</div><div class="line"><a name="l10772"></a><span class="lineno">10772</span>&#160;</div><div class="line"><a name="l10773"></a><span class="lineno">10773</span>&#160;  <span class="comment">// If it&#39;s an adding a simple constant then integrate the offset.</span></div><div class="line"><a name="l10774"></a><span class="lineno">10774</span>&#160;  <span class="keywordflow">if</span> (Base.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a269996b43a1f3e1d1f84a70fd4387535">ISD::ADD</a>) {</div><div class="line"><a name="l10775"></a><span class="lineno">10775</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a> *<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = dyn_cast&lt;ConstantSDNode&gt;(Base.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(1))) {</div><div class="line"><a name="l10776"></a><span class="lineno">10776</span>&#160;      Base = Base.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0);</div><div class="line"><a name="l10777"></a><span class="lineno">10777</span>&#160;      Offset += <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>-&gt;getZExtValue();</div><div class="line"><a name="l10778"></a><span class="lineno">10778</span>&#160;    }</div><div class="line"><a name="l10779"></a><span class="lineno">10779</span>&#160;  }</div><div class="line"><a name="l10780"></a><span class="lineno">10780</span>&#160;</div><div class="line"><a name="l10781"></a><span class="lineno">10781</span>&#160;  <span class="comment">// Return the underlying GlobalValue, and update the Offset.  Return false</span></div><div class="line"><a name="l10782"></a><span class="lineno">10782</span>&#160;  <span class="comment">// for GlobalAddressSDNode since the same GlobalAddress may be represented</span></div><div class="line"><a name="l10783"></a><span class="lineno">10783</span>&#160;  <span class="comment">// by multiple nodes with different offsets.</span></div><div class="line"><a name="l10784"></a><span class="lineno">10784</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1GlobalAddressSDNode.html">GlobalAddressSDNode</a> *<a class="code" href="MD5_8cpp.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a> = dyn_cast&lt;GlobalAddressSDNode&gt;(Base)) {</div><div class="line"><a name="l10785"></a><span class="lineno">10785</span>&#160;    GV = <a class="code" href="MD5_8cpp.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>-&gt;getGlobal();</div><div class="line"><a name="l10786"></a><span class="lineno">10786</span>&#160;    Offset += <a class="code" href="MD5_8cpp.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>-&gt;getOffset();</div><div class="line"><a name="l10787"></a><span class="lineno">10787</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l10788"></a><span class="lineno">10788</span>&#160;  }</div><div class="line"><a name="l10789"></a><span class="lineno">10789</span>&#160;</div><div class="line"><a name="l10790"></a><span class="lineno">10790</span>&#160;  <span class="comment">// Return the underlying Constant value, and update the Offset.  Return false</span></div><div class="line"><a name="l10791"></a><span class="lineno">10791</span>&#160;  <span class="comment">// for ConstantSDNodes since the same constant pool entry may be represented</span></div><div class="line"><a name="l10792"></a><span class="lineno">10792</span>&#160;  <span class="comment">// by multiple nodes with different offsets.</span></div><div class="line"><a name="l10793"></a><span class="lineno">10793</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1ConstantPoolSDNode.html">ConstantPoolSDNode</a> *<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = dyn_cast&lt;ConstantPoolSDNode&gt;(Base)) {</div><div class="line"><a name="l10794"></a><span class="lineno">10794</span>&#160;    CV = <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>-&gt;isMachineConstantPoolEntry() ? (<span class="keyword">const</span> <span class="keywordtype">void</span> *)<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>-&gt;getMachineCPVal()</div><div class="line"><a name="l10795"></a><span class="lineno">10795</span>&#160;                                         : (<span class="keyword">const</span> <span class="keywordtype">void</span> *)<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>-&gt;getConstVal();</div><div class="line"><a name="l10796"></a><span class="lineno">10796</span>&#160;    Offset += <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>-&gt;getOffset();</div><div class="line"><a name="l10797"></a><span class="lineno">10797</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l10798"></a><span class="lineno">10798</span>&#160;  }</div><div class="line"><a name="l10799"></a><span class="lineno">10799</span>&#160;  <span class="comment">// If it&#39;s any of the following then it can&#39;t alias with anything but itself.</span></div><div class="line"><a name="l10800"></a><span class="lineno">10800</span>&#160;  <span class="keywordflow">return</span> isa&lt;FrameIndexSDNode&gt;(Base);</div><div class="line"><a name="l10801"></a><span class="lineno">10801</span>&#160;}</div><div class="line"><a name="l10802"></a><span class="lineno">10802</span>&#160;<span class="comment"></span></div><div class="line"><a name="l10803"></a><span class="lineno">10803</span>&#160;<span class="comment">/// isAlias - Return true if there is any possibility that the two addresses</span></div><div class="line"><a name="l10804"></a><span class="lineno">10804</span>&#160;<span class="comment">/// overlap.</span></div><div class="line"><a name="l10805"></a><span class="lineno">10805</span>&#160;<span class="comment"></span><span class="keywordtype">bool</span> DAGCombiner::isAlias(<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Ptr1, int64_t Size1, <span class="keywordtype">bool</span> IsVolatile1,</div><div class="line"><a name="l10806"></a><span class="lineno">10806</span>&#160;                          <span class="keyword">const</span> <a class="code" href="classllvm_1_1Value.html">Value</a> *SrcValue1, <span class="keywordtype">int</span> SrcValueOffset1,</div><div class="line"><a name="l10807"></a><span class="lineno">10807</span>&#160;                          <span class="keywordtype">unsigned</span> SrcValueAlign1,</div><div class="line"><a name="l10808"></a><span class="lineno">10808</span>&#160;                          <span class="keyword">const</span> <a class="code" href="classllvm_1_1MDNode.html">MDNode</a> *TBAAInfo1,</div><div class="line"><a name="l10809"></a><span class="lineno">10809</span>&#160;                          <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Ptr2, int64_t Size2, <span class="keywordtype">bool</span> IsVolatile2,</div><div class="line"><a name="l10810"></a><span class="lineno">10810</span>&#160;                          <span class="keyword">const</span> <a class="code" href="classllvm_1_1Value.html">Value</a> *SrcValue2, <span class="keywordtype">int</span> SrcValueOffset2,</div><div class="line"><a name="l10811"></a><span class="lineno">10811</span>&#160;                          <span class="keywordtype">unsigned</span> SrcValueAlign2,</div><div class="line"><a name="l10812"></a><span class="lineno">10812</span>&#160;                          <span class="keyword">const</span> <a class="code" href="classllvm_1_1MDNode.html">MDNode</a> *TBAAInfo2)<span class="keyword"> const </span>{</div><div class="line"><a name="l10813"></a><span class="lineno">10813</span>&#160;  <span class="comment">// If they are the same then they must be aliases.</span></div><div class="line"><a name="l10814"></a><span class="lineno">10814</span>&#160;  <span class="keywordflow">if</span> (Ptr1 == Ptr2) <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l10815"></a><span class="lineno">10815</span>&#160;</div><div class="line"><a name="l10816"></a><span class="lineno">10816</span>&#160;  <span class="comment">// If they are both volatile then they cannot be reordered.</span></div><div class="line"><a name="l10817"></a><span class="lineno">10817</span>&#160;  <span class="keywordflow">if</span> (IsVolatile1 &amp;&amp; IsVolatile2) <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l10818"></a><span class="lineno">10818</span>&#160;</div><div class="line"><a name="l10819"></a><span class="lineno">10819</span>&#160;  <span class="comment">// Gather base node and offset information.</span></div><div class="line"><a name="l10820"></a><span class="lineno">10820</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Base1, Base2;</div><div class="line"><a name="l10821"></a><span class="lineno">10821</span>&#160;  int64_t Offset1, Offset2;</div><div class="line"><a name="l10822"></a><span class="lineno">10822</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1GlobalValue.html">GlobalValue</a> *GV1, *GV2;</div><div class="line"><a name="l10823"></a><span class="lineno">10823</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">void</span> *CV1, *CV2;</div><div class="line"><a name="l10824"></a><span class="lineno">10824</span>&#160;  <span class="keywordtype">bool</span> isFrameIndex1 = <a class="code" href="DAGCombiner_8cpp.html#a31be5288def7545189cab5401fe3a1b0">FindBaseOffset</a>(Ptr1, Base1, Offset1, GV1, CV1);</div><div class="line"><a name="l10825"></a><span class="lineno">10825</span>&#160;  <span class="keywordtype">bool</span> isFrameIndex2 = <a class="code" href="DAGCombiner_8cpp.html#a31be5288def7545189cab5401fe3a1b0">FindBaseOffset</a>(Ptr2, Base2, Offset2, GV2, CV2);</div><div class="line"><a name="l10826"></a><span class="lineno">10826</span>&#160;</div><div class="line"><a name="l10827"></a><span class="lineno">10827</span>&#160;  <span class="comment">// If they have a same base address then check to see if they overlap.</span></div><div class="line"><a name="l10828"></a><span class="lineno">10828</span>&#160;  <span class="keywordflow">if</span> (Base1 == Base2 || (GV1 &amp;&amp; (GV1 == GV2)) || (CV1 &amp;&amp; (CV1 == CV2)))</div><div class="line"><a name="l10829"></a><span class="lineno">10829</span>&#160;    <span class="keywordflow">return</span> !((Offset1 + Size1) &lt;= Offset2 || (Offset2 + Size2) &lt;= Offset1);</div><div class="line"><a name="l10830"></a><span class="lineno">10830</span>&#160;</div><div class="line"><a name="l10831"></a><span class="lineno">10831</span>&#160;  <span class="comment">// It is possible for different frame indices to alias each other, mostly</span></div><div class="line"><a name="l10832"></a><span class="lineno">10832</span>&#160;  <span class="comment">// when tail call optimization reuses return address slots for arguments.</span></div><div class="line"><a name="l10833"></a><span class="lineno">10833</span>&#160;  <span class="comment">// To catch this case, look up the actual index of frame indices to compute</span></div><div class="line"><a name="l10834"></a><span class="lineno">10834</span>&#160;  <span class="comment">// the real alias relationship.</span></div><div class="line"><a name="l10835"></a><span class="lineno">10835</span>&#160;  <span class="keywordflow">if</span> (isFrameIndex1 &amp;&amp; isFrameIndex2) {</div><div class="line"><a name="l10836"></a><span class="lineno">10836</span>&#160;    <a class="code" href="classllvm_1_1MachineFrameInfo.html">MachineFrameInfo</a> *MFI = DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#a95d3f899fd68931ed5fa42e012468bdb">getMachineFunction</a>().<a class="code" href="classllvm_1_1MachineFunction.html#a4ad4295a88187ea1ae12ecfcfa18a70f">getFrameInfo</a>();</div><div class="line"><a name="l10837"></a><span class="lineno">10837</span>&#160;    Offset1 += MFI-&gt;<a class="code" href="classllvm_1_1MachineFrameInfo.html#aefac52e417d31959e35868879aba672b">getObjectOffset</a>(cast&lt;FrameIndexSDNode&gt;(Base1)-&gt;getIndex());</div><div class="line"><a name="l10838"></a><span class="lineno">10838</span>&#160;    Offset2 += MFI-&gt;<a class="code" href="classllvm_1_1MachineFrameInfo.html#aefac52e417d31959e35868879aba672b">getObjectOffset</a>(cast&lt;FrameIndexSDNode&gt;(Base2)-&gt;getIndex());</div><div class="line"><a name="l10839"></a><span class="lineno">10839</span>&#160;    <span class="keywordflow">return</span> !((Offset1 + Size1) &lt;= Offset2 || (Offset2 + Size2) &lt;= Offset1);</div><div class="line"><a name="l10840"></a><span class="lineno">10840</span>&#160;  }</div><div class="line"><a name="l10841"></a><span class="lineno">10841</span>&#160;</div><div class="line"><a name="l10842"></a><span class="lineno">10842</span>&#160;  <span class="comment">// Otherwise, if we know what the bases are, and they aren&#39;t identical, then</span></div><div class="line"><a name="l10843"></a><span class="lineno">10843</span>&#160;  <span class="comment">// we know they cannot alias.</span></div><div class="line"><a name="l10844"></a><span class="lineno">10844</span>&#160;  <span class="keywordflow">if</span> ((isFrameIndex1 || CV1 || GV1) &amp;&amp; (isFrameIndex2 || CV2 || GV2))</div><div class="line"><a name="l10845"></a><span class="lineno">10845</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l10846"></a><span class="lineno">10846</span>&#160;</div><div class="line"><a name="l10847"></a><span class="lineno">10847</span>&#160;  <span class="comment">// If we know required SrcValue1 and SrcValue2 have relatively large alignment</span></div><div class="line"><a name="l10848"></a><span class="lineno">10848</span>&#160;  <span class="comment">// compared to the size and offset of the access, we may be able to prove they</span></div><div class="line"><a name="l10849"></a><span class="lineno">10849</span>&#160;  <span class="comment">// do not alias.  This check is conservative for now to catch cases created by</span></div><div class="line"><a name="l10850"></a><span class="lineno">10850</span>&#160;  <span class="comment">// splitting vector types.</span></div><div class="line"><a name="l10851"></a><span class="lineno">10851</span>&#160;  <span class="keywordflow">if</span> ((SrcValueAlign1 == SrcValueAlign2) &amp;&amp;</div><div class="line"><a name="l10852"></a><span class="lineno">10852</span>&#160;      (SrcValueOffset1 != SrcValueOffset2) &amp;&amp;</div><div class="line"><a name="l10853"></a><span class="lineno">10853</span>&#160;      (Size1 == Size2) &amp;&amp; (SrcValueAlign1 &gt; Size1)) {</div><div class="line"><a name="l10854"></a><span class="lineno">10854</span>&#160;    int64_t OffAlign1 = SrcValueOffset1 % SrcValueAlign1;</div><div class="line"><a name="l10855"></a><span class="lineno">10855</span>&#160;    int64_t OffAlign2 = SrcValueOffset2 % SrcValueAlign1;</div><div class="line"><a name="l10856"></a><span class="lineno">10856</span>&#160;</div><div class="line"><a name="l10857"></a><span class="lineno">10857</span>&#160;    <span class="comment">// There is no overlap between these relatively aligned accesses of similar</span></div><div class="line"><a name="l10858"></a><span class="lineno">10858</span>&#160;    <span class="comment">// size, return no alias.</span></div><div class="line"><a name="l10859"></a><span class="lineno">10859</span>&#160;    <span class="keywordflow">if</span> ((OffAlign1 + Size1) &lt;= OffAlign2 || (OffAlign2 + Size2) &lt;= OffAlign1)</div><div class="line"><a name="l10860"></a><span class="lineno">10860</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l10861"></a><span class="lineno">10861</span>&#160;  }</div><div class="line"><a name="l10862"></a><span class="lineno">10862</span>&#160;</div><div class="line"><a name="l10863"></a><span class="lineno">10863</span>&#160;  <span class="keywordtype">bool</span> UseAA = CombinerGlobalAA.getNumOccurrences() &gt; 0 ? CombinerGlobalAA :</div><div class="line"><a name="l10864"></a><span class="lineno">10864</span>&#160;    TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#ada5f4a5dd489c777870538cdbb6da228">getTargetMachine</a>().<a class="code" href="classllvm_1_1TargetMachine.html#a5af2fed99951774b6a14d30ec6e73792">getSubtarget</a>&lt;<a class="code" href="classllvm_1_1TargetSubtargetInfo.html">TargetSubtargetInfo</a>&gt;().useAA();</div><div class="line"><a name="l10865"></a><span class="lineno">10865</span>&#160;  <span class="keywordflow">if</span> (UseAA &amp;&amp; SrcValue1 &amp;&amp; SrcValue2) {</div><div class="line"><a name="l10866"></a><span class="lineno">10866</span>&#160;    <span class="comment">// Use alias analysis information.</span></div><div class="line"><a name="l10867"></a><span class="lineno">10867</span>&#160;    int64_t MinOffset = std::min(SrcValueOffset1, SrcValueOffset2);</div><div class="line"><a name="l10868"></a><span class="lineno">10868</span>&#160;    int64_t Overlap1 = Size1 + SrcValueOffset1 - MinOffset;</div><div class="line"><a name="l10869"></a><span class="lineno">10869</span>&#160;    int64_t Overlap2 = Size2 + SrcValueOffset2 - MinOffset;</div><div class="line"><a name="l10870"></a><span class="lineno">10870</span>&#160;    <a class="code" href="classllvm_1_1AliasAnalysis.html#aa96743b70089c7a0ef5d935f34173826">AliasAnalysis::AliasResult</a> AAResult =</div><div class="line"><a name="l10871"></a><span class="lineno">10871</span>&#160;      AA.<a class="code" href="classllvm_1_1AliasAnalysis.html#a59949d72986d3e9fdb7e7c9272c02f0f">alias</a>(<a class="code" href="structllvm_1_1AliasAnalysis_1_1Location.html">AliasAnalysis::Location</a>(SrcValue1, Overlap1, TBAAInfo1),</div><div class="line"><a name="l10872"></a><span class="lineno">10872</span>&#160;               <a class="code" href="structllvm_1_1AliasAnalysis_1_1Location.html">AliasAnalysis::Location</a>(SrcValue2, Overlap2, TBAAInfo2));</div><div class="line"><a name="l10873"></a><span class="lineno">10873</span>&#160;    <span class="keywordflow">if</span> (AAResult == <a class="code" href="classllvm_1_1AliasAnalysis.html#aa96743b70089c7a0ef5d935f34173826a43c7577d5f7b09c310e42a6ab471610b">AliasAnalysis::NoAlias</a>)</div><div class="line"><a name="l10874"></a><span class="lineno">10874</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l10875"></a><span class="lineno">10875</span>&#160;  }</div><div class="line"><a name="l10876"></a><span class="lineno">10876</span>&#160;</div><div class="line"><a name="l10877"></a><span class="lineno">10877</span>&#160;  <span class="comment">// Otherwise we have to assume they alias.</span></div><div class="line"><a name="l10878"></a><span class="lineno">10878</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l10879"></a><span class="lineno">10879</span>&#160;}</div><div class="line"><a name="l10880"></a><span class="lineno">10880</span>&#160;</div><div class="line"><a name="l10881"></a><span class="lineno">10881</span>&#160;<span class="keywordtype">bool</span> DAGCombiner::isAlias(<a class="code" href="classllvm_1_1LSBaseSDNode.html">LSBaseSDNode</a> *Op0, <a class="code" href="classllvm_1_1LSBaseSDNode.html">LSBaseSDNode</a> *Op1) {</div><div class="line"><a name="l10882"></a><span class="lineno">10882</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Ptr0, Ptr1;</div><div class="line"><a name="l10883"></a><span class="lineno">10883</span>&#160;  int64_t Size0, Size1;</div><div class="line"><a name="l10884"></a><span class="lineno">10884</span>&#160;  <span class="keywordtype">bool</span> IsVolatile0, IsVolatile1;</div><div class="line"><a name="l10885"></a><span class="lineno">10885</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1Value.html">Value</a> *SrcValue0, *SrcValue1;</div><div class="line"><a name="l10886"></a><span class="lineno">10886</span>&#160;  <span class="keywordtype">int</span> SrcValueOffset0, SrcValueOffset1;</div><div class="line"><a name="l10887"></a><span class="lineno">10887</span>&#160;  <span class="keywordtype">unsigned</span> SrcValueAlign0, SrcValueAlign1;</div><div class="line"><a name="l10888"></a><span class="lineno">10888</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1MDNode.html">MDNode</a> *SrcTBAAInfo0, *SrcTBAAInfo1;</div><div class="line"><a name="l10889"></a><span class="lineno">10889</span>&#160;  FindAliasInfo(Op0, Ptr0, Size0, IsVolatile0, SrcValue0, SrcValueOffset0,</div><div class="line"><a name="l10890"></a><span class="lineno">10890</span>&#160;                SrcValueAlign0, SrcTBAAInfo0);</div><div class="line"><a name="l10891"></a><span class="lineno">10891</span>&#160;  FindAliasInfo(Op1, Ptr1, Size1, IsVolatile1, SrcValue1, SrcValueOffset1,</div><div class="line"><a name="l10892"></a><span class="lineno">10892</span>&#160;                SrcValueAlign1, SrcTBAAInfo1);</div><div class="line"><a name="l10893"></a><span class="lineno">10893</span>&#160;  <span class="keywordflow">return</span> isAlias(Ptr0, Size0, IsVolatile0, SrcValue0, SrcValueOffset0,</div><div class="line"><a name="l10894"></a><span class="lineno">10894</span>&#160;                 SrcValueAlign0, SrcTBAAInfo0,</div><div class="line"><a name="l10895"></a><span class="lineno">10895</span>&#160;                 Ptr1, Size1, IsVolatile1, SrcValue1, SrcValueOffset1,</div><div class="line"><a name="l10896"></a><span class="lineno">10896</span>&#160;                 SrcValueAlign1, SrcTBAAInfo1);</div><div class="line"><a name="l10897"></a><span class="lineno">10897</span>&#160;}</div><div class="line"><a name="l10898"></a><span class="lineno">10898</span>&#160;<span class="comment"></span></div><div class="line"><a name="l10899"></a><span class="lineno">10899</span>&#160;<span class="comment">/// FindAliasInfo - Extracts the relevant alias information from the memory</span></div><div class="line"><a name="l10900"></a><span class="lineno">10900</span>&#160;<span class="comment">/// node.  Returns true if the operand was a nonvolatile load.</span></div><div class="line"><a name="l10901"></a><span class="lineno">10901</span>&#160;<span class="comment"></span><span class="keywordtype">bool</span> DAGCombiner::FindAliasInfo(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N,</div><div class="line"><a name="l10902"></a><span class="lineno">10902</span>&#160;                                <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> &amp;Ptr, int64_t &amp;Size, <span class="keywordtype">bool</span> &amp;IsVolatile,</div><div class="line"><a name="l10903"></a><span class="lineno">10903</span>&#160;                                <span class="keyword">const</span> <a class="code" href="classllvm_1_1Value.html">Value</a> *&amp;SrcValue,</div><div class="line"><a name="l10904"></a><span class="lineno">10904</span>&#160;                                <span class="keywordtype">int</span> &amp;SrcValueOffset,</div><div class="line"><a name="l10905"></a><span class="lineno">10905</span>&#160;                                <span class="keywordtype">unsigned</span> &amp;SrcValueAlign,</div><div class="line"><a name="l10906"></a><span class="lineno">10906</span>&#160;                                <span class="keyword">const</span> <a class="code" href="classllvm_1_1MDNode.html">MDNode</a> *&amp;TBAAInfo)<span class="keyword"> const </span>{</div><div class="line"><a name="l10907"></a><span class="lineno">10907</span>&#160;  <a class="code" href="classllvm_1_1LSBaseSDNode.html">LSBaseSDNode</a> *<a class="code" href="namespacellvm_1_1A64CC.html#af5804bc0518be9568f73db566e4d6f46a262de230e8b3511eaf693762cabdc1ca">LS</a> = cast&lt;LSBaseSDNode&gt;(<a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>);</div><div class="line"><a name="l10908"></a><span class="lineno">10908</span>&#160;</div><div class="line"><a name="l10909"></a><span class="lineno">10909</span>&#160;  Ptr = LS-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a9330f807294a868461af12a3ed56a269">getBasePtr</a>();</div><div class="line"><a name="l10910"></a><span class="lineno">10910</span>&#160;  Size = LS-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a7cead3a2a7771e61083bcc6959915a13">getMemoryVT</a>().<a class="code" href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">getSizeInBits</a>() &gt;&gt; 3;</div><div class="line"><a name="l10911"></a><span class="lineno">10911</span>&#160;  IsVolatile = LS-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#acd3bb9ee2ec53fa4be1fdf155b0b5a17">isVolatile</a>();</div><div class="line"><a name="l10912"></a><span class="lineno">10912</span>&#160;  SrcValue = LS-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a32aae058f77e7cb4675d3fcb33c93d76">getSrcValue</a>();</div><div class="line"><a name="l10913"></a><span class="lineno">10913</span>&#160;  SrcValueOffset = LS-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a90e167cf9e2716b28452b40772c8db5a">getSrcValueOffset</a>();</div><div class="line"><a name="l10914"></a><span class="lineno">10914</span>&#160;  SrcValueAlign = LS-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a9c2ed40a765beab830932e12f5eb82d0">getOriginalAlignment</a>();</div><div class="line"><a name="l10915"></a><span class="lineno">10915</span>&#160;  TBAAInfo = LS-&gt;<a class="code" href="classllvm_1_1MemSDNode.html#a23670ceb5797afa3d45ca1a9b011fd87">getTBAAInfo</a>();</div><div class="line"><a name="l10916"></a><span class="lineno">10916</span>&#160;  <span class="keywordflow">return</span> isa&lt;LoadSDNode&gt;(<a class="code" href="namespacellvm_1_1A64CC.html#af5804bc0518be9568f73db566e4d6f46a262de230e8b3511eaf693762cabdc1ca">LS</a>) &amp;&amp; !IsVolatile;</div><div class="line"><a name="l10917"></a><span class="lineno">10917</span>&#160;}</div><div class="line"><a name="l10918"></a><span class="lineno">10918</span>&#160;<span class="comment"></span></div><div class="line"><a name="l10919"></a><span class="lineno">10919</span>&#160;<span class="comment">/// GatherAllAliases - Walk up chain skipping non-aliasing memory nodes,</span></div><div class="line"><a name="l10920"></a><span class="lineno">10920</span>&#160;<span class="comment">/// looking for aliasing nodes and adding them to the Aliases vector.</span></div><div class="line"><a name="l10921"></a><span class="lineno">10921</span>&#160;<span class="comment"></span><span class="keywordtype">void</span> DAGCombiner::GatherAllAliases(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N, <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> OriginalChain,</div><div class="line"><a name="l10922"></a><span class="lineno">10922</span>&#160;                                   <a class="code" href="classllvm_1_1SmallVectorImpl.html">SmallVectorImpl&lt;SDValue&gt;</a> &amp;Aliases) {</div><div class="line"><a name="l10923"></a><span class="lineno">10923</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;SDValue, 8&gt;</a> Chains;     <span class="comment">// List of chains to visit.</span></div><div class="line"><a name="l10924"></a><span class="lineno">10924</span>&#160;  <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;SDNode *, 16&gt;</a> Visited;  <span class="comment">// Visited node set.</span></div><div class="line"><a name="l10925"></a><span class="lineno">10925</span>&#160;</div><div class="line"><a name="l10926"></a><span class="lineno">10926</span>&#160;  <span class="comment">// Get alias information for node.</span></div><div class="line"><a name="l10927"></a><span class="lineno">10927</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Ptr;</div><div class="line"><a name="l10928"></a><span class="lineno">10928</span>&#160;  int64_t Size;</div><div class="line"><a name="l10929"></a><span class="lineno">10929</span>&#160;  <span class="keywordtype">bool</span> IsVolatile;</div><div class="line"><a name="l10930"></a><span class="lineno">10930</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1Value.html">Value</a> *SrcValue;</div><div class="line"><a name="l10931"></a><span class="lineno">10931</span>&#160;  <span class="keywordtype">int</span> SrcValueOffset;</div><div class="line"><a name="l10932"></a><span class="lineno">10932</span>&#160;  <span class="keywordtype">unsigned</span> SrcValueAlign;</div><div class="line"><a name="l10933"></a><span class="lineno">10933</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1MDNode.html">MDNode</a> *SrcTBAAInfo;</div><div class="line"><a name="l10934"></a><span class="lineno">10934</span>&#160;  <span class="keywordtype">bool</span> IsLoad = FindAliasInfo(N, Ptr, Size, IsVolatile, SrcValue,</div><div class="line"><a name="l10935"></a><span class="lineno">10935</span>&#160;                              SrcValueOffset, SrcValueAlign, SrcTBAAInfo);</div><div class="line"><a name="l10936"></a><span class="lineno">10936</span>&#160;</div><div class="line"><a name="l10937"></a><span class="lineno">10937</span>&#160;  <span class="comment">// Starting off.</span></div><div class="line"><a name="l10938"></a><span class="lineno">10938</span>&#160;  Chains.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(OriginalChain);</div><div class="line"><a name="l10939"></a><span class="lineno">10939</span>&#160;  <span class="keywordtype">unsigned</span> Depth = 0;</div><div class="line"><a name="l10940"></a><span class="lineno">10940</span>&#160;</div><div class="line"><a name="l10941"></a><span class="lineno">10941</span>&#160;  <span class="comment">// Look at each chain and determine if it is an alias.  If so, add it to the</span></div><div class="line"><a name="l10942"></a><span class="lineno">10942</span>&#160;  <span class="comment">// aliases list.  If not, then continue up the chain looking for the next</span></div><div class="line"><a name="l10943"></a><span class="lineno">10943</span>&#160;  <span class="comment">// candidate.</span></div><div class="line"><a name="l10944"></a><span class="lineno">10944</span>&#160;  <span class="keywordflow">while</span> (!Chains.<a class="code" href="classllvm_1_1SmallVectorBase.html#a8a8df4d85555c7954a95f86080cd3b64">empty</a>()) {</div><div class="line"><a name="l10945"></a><span class="lineno">10945</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Chain = Chains.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#acd9e771a3296c6b24146955754620557">back</a>();</div><div class="line"><a name="l10946"></a><span class="lineno">10946</span>&#160;    Chains.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#a1f2303df9bbee2233c11d61c2f6f7930">pop_back</a>();</div><div class="line"><a name="l10947"></a><span class="lineno">10947</span>&#160;</div><div class="line"><a name="l10948"></a><span class="lineno">10948</span>&#160;    <span class="comment">// For TokenFactor nodes, look at each operand and only continue up the</span></div><div class="line"><a name="l10949"></a><span class="lineno">10949</span>&#160;    <span class="comment">// chain until we find two aliases.  If we&#39;ve seen two aliases, assume we&#39;ll</span></div><div class="line"><a name="l10950"></a><span class="lineno">10950</span>&#160;    <span class="comment">// find more and revert to original chain since the xform is unlikely to be</span></div><div class="line"><a name="l10951"></a><span class="lineno">10951</span>&#160;    <span class="comment">// profitable.</span></div><div class="line"><a name="l10952"></a><span class="lineno">10952</span>&#160;    <span class="comment">//</span></div><div class="line"><a name="l10953"></a><span class="lineno">10953</span>&#160;    <span class="comment">// FIXME: The depth check could be made to return the last non-aliasing</span></div><div class="line"><a name="l10954"></a><span class="lineno">10954</span>&#160;    <span class="comment">// chain we found before we hit a tokenfactor rather than the original</span></div><div class="line"><a name="l10955"></a><span class="lineno">10955</span>&#160;    <span class="comment">// chain.</span></div><div class="line"><a name="l10956"></a><span class="lineno">10956</span>&#160;    <span class="keywordflow">if</span> (Depth &gt; 6 || Aliases.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#a22a311dfe4c28a897de8a9365a4f0a84">size</a>() == 2) {</div><div class="line"><a name="l10957"></a><span class="lineno">10957</span>&#160;      Aliases.<a class="code" href="classllvm_1_1SmallVectorImpl.html#aac0ea55010b7b1a301e65a0baea057aa">clear</a>();</div><div class="line"><a name="l10958"></a><span class="lineno">10958</span>&#160;      Aliases.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(OriginalChain);</div><div class="line"><a name="l10959"></a><span class="lineno">10959</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l10960"></a><span class="lineno">10960</span>&#160;    }</div><div class="line"><a name="l10961"></a><span class="lineno">10961</span>&#160;</div><div class="line"><a name="l10962"></a><span class="lineno">10962</span>&#160;    <span class="comment">// Don&#39;t bother if we&#39;ve been before.</span></div><div class="line"><a name="l10963"></a><span class="lineno">10963</span>&#160;    <span class="keywordflow">if</span> (!Visited.<a class="code" href="classllvm_1_1SmallPtrSet.html#a9b6dd0fc7a648a939e571246045b673e">insert</a>(Chain.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()))</div><div class="line"><a name="l10964"></a><span class="lineno">10964</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l10965"></a><span class="lineno">10965</span>&#160;</div><div class="line"><a name="l10966"></a><span class="lineno">10966</span>&#160;    <span class="keywordflow">switch</span> (Chain.<a class="code" href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">getOpcode</a>()) {</div><div class="line"><a name="l10967"></a><span class="lineno">10967</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a926013f6dca240eca95aca66c8d3e74b">ISD::EntryToken</a>:</div><div class="line"><a name="l10968"></a><span class="lineno">10968</span>&#160;      <span class="comment">// Entry token is ideal chain operand, but handled in FindBetterChain.</span></div><div class="line"><a name="l10969"></a><span class="lineno">10969</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l10970"></a><span class="lineno">10970</span>&#160;</div><div class="line"><a name="l10971"></a><span class="lineno">10971</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a269b81f007000306e3e69d0d290c2159">ISD::LOAD</a>:</div><div class="line"><a name="l10972"></a><span class="lineno">10972</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a047178c3b2c6a5df40ae22a407b8aca9">ISD::STORE</a>: {</div><div class="line"><a name="l10973"></a><span class="lineno">10973</span>&#160;      <span class="comment">// Get alias information for Chain.</span></div><div class="line"><a name="l10974"></a><span class="lineno">10974</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> OpPtr;</div><div class="line"><a name="l10975"></a><span class="lineno">10975</span>&#160;      int64_t <a class="code" href="namespacellvm_1_1X86II.html#a97dc14052814702ba0e2b14fb14dd02dad11797b0ad89e5eb13f16d7a2ba9741e">OpSize</a>;</div><div class="line"><a name="l10976"></a><span class="lineno">10976</span>&#160;      <span class="keywordtype">bool</span> OpIsVolatile;</div><div class="line"><a name="l10977"></a><span class="lineno">10977</span>&#160;      <span class="keyword">const</span> <a class="code" href="classllvm_1_1Value.html">Value</a> *OpSrcValue;</div><div class="line"><a name="l10978"></a><span class="lineno">10978</span>&#160;      <span class="keywordtype">int</span> OpSrcValueOffset;</div><div class="line"><a name="l10979"></a><span class="lineno">10979</span>&#160;      <span class="keywordtype">unsigned</span> OpSrcValueAlign;</div><div class="line"><a name="l10980"></a><span class="lineno">10980</span>&#160;      <span class="keyword">const</span> <a class="code" href="classllvm_1_1MDNode.html">MDNode</a> *OpSrcTBAAInfo;</div><div class="line"><a name="l10981"></a><span class="lineno">10981</span>&#160;      <span class="keywordtype">bool</span> IsOpLoad = FindAliasInfo(Chain.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>(), OpPtr, <a class="code" href="namespacellvm_1_1X86II.html#a97dc14052814702ba0e2b14fb14dd02dad11797b0ad89e5eb13f16d7a2ba9741e">OpSize</a>,</div><div class="line"><a name="l10982"></a><span class="lineno">10982</span>&#160;                                    OpIsVolatile, OpSrcValue, OpSrcValueOffset,</div><div class="line"><a name="l10983"></a><span class="lineno">10983</span>&#160;                                    OpSrcValueAlign,</div><div class="line"><a name="l10984"></a><span class="lineno">10984</span>&#160;                                    OpSrcTBAAInfo);</div><div class="line"><a name="l10985"></a><span class="lineno">10985</span>&#160;</div><div class="line"><a name="l10986"></a><span class="lineno">10986</span>&#160;      <span class="comment">// If chain is alias then stop here.</span></div><div class="line"><a name="l10987"></a><span class="lineno">10987</span>&#160;      <span class="keywordflow">if</span> (!(IsLoad &amp;&amp; IsOpLoad) &amp;&amp;</div><div class="line"><a name="l10988"></a><span class="lineno">10988</span>&#160;          isAlias(Ptr, Size, IsVolatile, SrcValue, SrcValueOffset,</div><div class="line"><a name="l10989"></a><span class="lineno">10989</span>&#160;                  SrcValueAlign, SrcTBAAInfo,</div><div class="line"><a name="l10990"></a><span class="lineno">10990</span>&#160;                  OpPtr, OpSize, OpIsVolatile, OpSrcValue, OpSrcValueOffset,</div><div class="line"><a name="l10991"></a><span class="lineno">10991</span>&#160;                  OpSrcValueAlign, OpSrcTBAAInfo)) {</div><div class="line"><a name="l10992"></a><span class="lineno">10992</span>&#160;        Aliases.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(Chain);</div><div class="line"><a name="l10993"></a><span class="lineno">10993</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l10994"></a><span class="lineno">10994</span>&#160;        <span class="comment">// Look further up the chain.</span></div><div class="line"><a name="l10995"></a><span class="lineno">10995</span>&#160;        Chains.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(Chain.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(0));</div><div class="line"><a name="l10996"></a><span class="lineno">10996</span>&#160;        ++Depth;</div><div class="line"><a name="l10997"></a><span class="lineno">10997</span>&#160;      }</div><div class="line"><a name="l10998"></a><span class="lineno">10998</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l10999"></a><span class="lineno">10999</span>&#160;    }</div><div class="line"><a name="l11000"></a><span class="lineno">11000</span>&#160;</div><div class="line"><a name="l11001"></a><span class="lineno">11001</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ad469508535ce2082a1ab1f0e429187b8">ISD::TokenFactor</a>:</div><div class="line"><a name="l11002"></a><span class="lineno">11002</span>&#160;      <span class="comment">// We have to check each of the operands of the token factor for &quot;small&quot;</span></div><div class="line"><a name="l11003"></a><span class="lineno">11003</span>&#160;      <span class="comment">// token factors, so we queue them up.  Adding the operands to the queue</span></div><div class="line"><a name="l11004"></a><span class="lineno">11004</span>&#160;      <span class="comment">// (stack) in reverse order maintains the original order and increases the</span></div><div class="line"><a name="l11005"></a><span class="lineno">11005</span>&#160;      <span class="comment">// likelihood that getNode will find a matching token factor (CSE.)</span></div><div class="line"><a name="l11006"></a><span class="lineno">11006</span>&#160;      <span class="keywordflow">if</span> (Chain.<a class="code" href="classllvm_1_1SDValue.html#a5f0447ef8ec128563ad131b76e5062bd">getNumOperands</a>() &gt; 16) {</div><div class="line"><a name="l11007"></a><span class="lineno">11007</span>&#160;        Aliases.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(Chain);</div><div class="line"><a name="l11008"></a><span class="lineno">11008</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l11009"></a><span class="lineno">11009</span>&#160;      }</div><div class="line"><a name="l11010"></a><span class="lineno">11010</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#ab335e668fd33542ea14a2c7b527e64d3">n</a> = Chain.<a class="code" href="classllvm_1_1SDValue.html#a5f0447ef8ec128563ad131b76e5062bd">getNumOperands</a>(); <a class="code" href="Target_2README_8txt.html#ab335e668fd33542ea14a2c7b527e64d3">n</a>;)</div><div class="line"><a name="l11011"></a><span class="lineno">11011</span>&#160;        Chains.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(Chain.<a class="code" href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">getOperand</a>(--<a class="code" href="Target_2README_8txt.html#ab335e668fd33542ea14a2c7b527e64d3">n</a>));</div><div class="line"><a name="l11012"></a><span class="lineno">11012</span>&#160;      ++Depth;</div><div class="line"><a name="l11013"></a><span class="lineno">11013</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l11014"></a><span class="lineno">11014</span>&#160;</div><div class="line"><a name="l11015"></a><span class="lineno">11015</span>&#160;    <span class="keywordflow">default</span>:</div><div class="line"><a name="l11016"></a><span class="lineno">11016</span>&#160;      <span class="comment">// For all other instructions we will just have to take what we can get.</span></div><div class="line"><a name="l11017"></a><span class="lineno">11017</span>&#160;      Aliases.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(Chain);</div><div class="line"><a name="l11018"></a><span class="lineno">11018</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l11019"></a><span class="lineno">11019</span>&#160;    }</div><div class="line"><a name="l11020"></a><span class="lineno">11020</span>&#160;  }</div><div class="line"><a name="l11021"></a><span class="lineno">11021</span>&#160;}</div><div class="line"><a name="l11022"></a><span class="lineno">11022</span>&#160;<span class="comment"></span></div><div class="line"><a name="l11023"></a><span class="lineno">11023</span>&#160;<span class="comment">/// FindBetterChain - Walk up chain skipping non-aliasing memory nodes, looking</span></div><div class="line"><a name="l11024"></a><span class="lineno">11024</span>&#160;<span class="comment">/// for a better chain (aliasing node.)</span></div><div class="line"><a name="l11025"></a><span class="lineno">11025</span>&#160;<span class="comment"></span><a class="code" href="classllvm_1_1SDValue.html">SDValue</a> DAGCombiner::FindBetterChain(<a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *N, <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> OldChain) {</div><div class="line"><a name="l11026"></a><span class="lineno">11026</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;SDValue, 8&gt;</a> Aliases;  <span class="comment">// Ops for replacing token factor.</span></div><div class="line"><a name="l11027"></a><span class="lineno">11027</span>&#160;</div><div class="line"><a name="l11028"></a><span class="lineno">11028</span>&#160;  <span class="comment">// Accumulate all the aliases to this node.</span></div><div class="line"><a name="l11029"></a><span class="lineno">11029</span>&#160;  GatherAllAliases(N, OldChain, Aliases);</div><div class="line"><a name="l11030"></a><span class="lineno">11030</span>&#160;</div><div class="line"><a name="l11031"></a><span class="lineno">11031</span>&#160;  <span class="comment">// If no operands then chain to entry token.</span></div><div class="line"><a name="l11032"></a><span class="lineno">11032</span>&#160;  <span class="keywordflow">if</span> (Aliases.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#a22a311dfe4c28a897de8a9365a4f0a84">size</a>() == 0)</div><div class="line"><a name="l11033"></a><span class="lineno">11033</span>&#160;    <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#ad755b1a25cf0c4507d5f615f64471ae9">getEntryNode</a>();</div><div class="line"><a name="l11034"></a><span class="lineno">11034</span>&#160;</div><div class="line"><a name="l11035"></a><span class="lineno">11035</span>&#160;  <span class="comment">// If a single operand then chain to it.  We don&#39;t need to revisit it.</span></div><div class="line"><a name="l11036"></a><span class="lineno">11036</span>&#160;  <span class="keywordflow">if</span> (Aliases.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#a22a311dfe4c28a897de8a9365a4f0a84">size</a>() == 1)</div><div class="line"><a name="l11037"></a><span class="lineno">11037</span>&#160;    <span class="keywordflow">return</span> Aliases[0];</div><div class="line"><a name="l11038"></a><span class="lineno">11038</span>&#160;</div><div class="line"><a name="l11039"></a><span class="lineno">11039</span>&#160;  <span class="comment">// Construct a custom tailored token factor.</span></div><div class="line"><a name="l11040"></a><span class="lineno">11040</span>&#160;  <span class="keywordflow">return</span> DAG.<a class="code" href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">getNode</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ad469508535ce2082a1ab1f0e429187b8">ISD::TokenFactor</a>, <a class="code" href="classllvm_1_1SDLoc.html">SDLoc</a>(N), <a class="code" href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50ca62a222acce6360abd2726719fabc2797">MVT::Other</a>,</div><div class="line"><a name="l11041"></a><span class="lineno">11041</span>&#160;                     &amp;Aliases[0], Aliases.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#a22a311dfe4c28a897de8a9365a4f0a84">size</a>());</div><div class="line"><a name="l11042"></a><span class="lineno">11042</span>&#160;}</div><div class="line"><a name="l11043"></a><span class="lineno">11043</span>&#160;</div><div class="line"><a name="l11044"></a><span class="lineno">11044</span>&#160;<span class="comment">// SelectionDAG::Combine - This is the entry point for the file.</span></div><div class="line"><a name="l11045"></a><span class="lineno">11045</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l11046"></a><span class="lineno"><a class="line" href="classllvm_1_1SelectionDAG.html#abe7bd3138ea3703376dc622650b20ff3">11046</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classllvm_1_1SelectionDAG.html#abe7bd3138ea3703376dc622650b20ff3">SelectionDAG::Combine</a>(<a class="code" href="namespacellvm.html#aa6d856e4879bb775617f8c3634773b7a">CombineLevel</a> Level, <a class="code" href="classllvm_1_1AliasAnalysis.html">AliasAnalysis</a> &amp;AA,</div><div class="line"><a name="l11047"></a><span class="lineno">11047</span>&#160;                           <a class="code" href="namespacellvm_1_1CodeGenOpt.html#a411055ea15209051c2370bbf655ec8d4">CodeGenOpt::Level</a> OptLevel) {<span class="comment"></span></div><div class="line"><a name="l11048"></a><span class="lineno">11048</span>&#160;<span class="comment">  /// run - This is the main entry point to this class.</span></div><div class="line"><a name="l11049"></a><span class="lineno">11049</span>&#160;<span class="comment">  ///</span></div><div class="line"><a name="l11050"></a><span class="lineno">11050</span>&#160;<span class="comment"></span>  DAGCombiner(*<span class="keyword">this</span>, AA, OptLevel).Run(Level);</div><div class="line"><a name="l11051"></a><span class="lineno">11051</span>&#160;}</div><div class="ttc" id="classllvm_1_1SDValue_html_a8bc8606044f2c3cdb6271c0378e0f9cf"><div class="ttname"><a href="classllvm_1_1SDValue.html#a8bc8606044f2c3cdb6271c0378e0f9cf">llvm::SDValue::getSimpleValueType</a></div><div class="ttdeci">MVT getSimpleValueType() const </div><div class="ttdoc">Return the simple ValueType of the referenced return value. </div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l00134">SelectionDAGNodes.h:134</a></div></div>
<div class="ttc" id="classllvm_1_1SmallVectorTemplateCommon_html_a075e34e98605d0e7c289763a104869ac"><div class="ttname"><a href="classllvm_1_1SmallVectorTemplateCommon.html#a075e34e98605d0e7c289763a104869ac">llvm::SmallVectorTemplateCommon&lt; T &gt;::end</a></div><div class="ttdeci">iterator end()</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00114">SmallVector.h:114</a></div></div>
<div class="ttc" id="TargetSubtargetInfo_8h_html"><div class="ttname"><a href="TargetSubtargetInfo_8h.html">TargetSubtargetInfo.h</a></div></div>
<div class="ttc" id="classllvm_1_1SmallVectorTemplateCommon_html_a22a311dfe4c28a897de8a9365a4f0a84"><div class="ttname"><a href="classllvm_1_1SmallVectorTemplateCommon.html#a22a311dfe4c28a897de8a9365a4f0a84">llvm::SmallVectorTemplateCommon&lt; T &gt;::size</a></div><div class="ttdeci">size_type size() const</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00127">SmallVector.h:127</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110a412ddf522b53f07690a86bffba1278e7"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a412ddf522b53f07690a86bffba1278e7">llvm::ISD::BITCAST</a></div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00420">ISDOpcodes.h:420</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110adaf9a3cb5c2ef5eb713bd6bf4ae23aeb"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110adaf9a3cb5c2ef5eb713bd6bf4ae23aeb">llvm::ISD::FP_ROUND</a></div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00393">ISDOpcodes.h:393</a></div></div>
<div class="ttc" id="classllvm_1_1SDNode_html_a3e579897b3fc3d645d0eea2f3442cfa2"><div class="ttname"><a href="classllvm_1_1SDNode.html#a3e579897b3fc3d645d0eea2f3442cfa2">llvm::SDNode::getValueSizeInBits</a></div><div class="ttdeci">unsigned getValueSizeInBits(unsigned ResNo) const </div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l00622">SelectionDAGNodes.h:622</a></div></div>
<div class="ttc" id="classllvm_1_1SDNode_html_afc071edeb7e2007d000374eba843f76a"><div class="ttname"><a href="classllvm_1_1SDNode.html#afc071edeb7e2007d000374eba843f76a">llvm::SDNode::use_empty</a></div><div class="ttdeci">bool use_empty() const </div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l00402">SelectionDAGNodes.h:402</a></div></div>
<div class="ttc" id="classllvm_1_1APFloat_html_a7b22f406d0d5381bae105045caca60ea"><div class="ttname"><a href="classllvm_1_1APFloat.html#a7b22f406d0d5381bae105045caca60ea">llvm::APFloat::divide</a></div><div class="ttdeci">opStatus divide(const APFloat &amp;, roundingMode)</div><div class="ttdef"><b>Definition:</b> <a href="APFloat_8cpp_source.html#l01675">APFloat.cpp:1675</a></div></div>
<div class="ttc" id="classllvm_1_1MVT_html_aded931e298cfa08b5038ca2b63c06bb8"><div class="ttname"><a href="classllvm_1_1MVT.html#aded931e298cfa08b5038ca2b63c06bb8">llvm::MVT::getIntegerVT</a></div><div class="ttdeci">static MVT getIntegerVT(unsigned BitWidth)</div><div class="ttdef"><b>Definition:</b> <a href="ValueTypes_8h_source.html#l00481">ValueTypes.h:481</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_abee7ecb577fcade34eb16ccb7f503e31ab5bb854fadd42503c849c4a48d7f3d90"><div class="ttname"><a href="namespacellvm_1_1ISD.html#abee7ecb577fcade34eb16ccb7f503e31ab5bb854fadd42503c849c4a48d7f3d90">llvm::ISD::PRE_INC</a></div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00680">ISDOpcodes.h:680</a></div></div>
<div class="ttc" id="namespacellvm_html_a0068da90e0fe51c9645b75e2a2235dc1"><div class="ttname"><a href="namespacellvm.html#a0068da90e0fe51c9645b75e2a2235dc1">llvm::operator+=</a></div><div class="ttdeci">std::string &amp; operator+=(std::string &amp;buffer, StringRef string)</div><div class="ttdef"><b>Definition:</b> <a href="StringRef_8h_source.html#l00544">StringRef.h:544</a></div></div>
<div class="ttc" id="classllvm_1_1SmallVectorTemplateBase_html_ae1a10b90f22c0478960fb5798ff73916"><div class="ttname"><a href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">llvm::SmallVectorTemplateBase&lt; T, isPodLike&lt; T &gt;::value &gt;::push_back</a></div><div class="ttdeci">void push_back(const T &amp;Elt)</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00236">SmallVector.h:236</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110a477ef80c70c7359199eace0e5d3133b1"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a477ef80c70c7359199eace0e5d3133b1">llvm::ISD::BUILTIN_OP_END</a></div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00641">ISDOpcodes.h:641</a></div></div>
<div class="ttc" id="classllvm_1_1DataLayout_html"><div class="ttname"><a href="classllvm_1_1DataLayout.html">llvm::DataLayout</a></div><div class="ttdef"><b>Definition:</b> <a href="DataLayout_8h_source.html#l00098">DataLayout.h:98</a></div></div>
<div class="ttc" id="classllvm_1_1SelectionDAG_html_a13ad902229b8b6b3a7a1d29dedac01e0"><div class="ttname"><a href="classllvm_1_1SelectionDAG.html#a13ad902229b8b6b3a7a1d29dedac01e0">llvm::SelectionDAG::getConstant</a></div><div class="ttdeci">SDValue getConstant(uint64_t Val, EVT VT, bool isTarget=false)</div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAG_8cpp_source.html#l00959">SelectionDAG.cpp:959</a></div></div>
<div class="ttc" id="classllvm_1_1TargetOptions_html"><div class="ttname"><a href="classllvm_1_1TargetOptions.html">llvm::TargetOptions</a></div><div class="ttdef"><b>Definition:</b> <a href="TargetOptions_8h_source.html#l00041">TargetOptions.h:41</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110a2852a5b6baa80b1589a46737210a8cad"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a2852a5b6baa80b1589a46737210a8cad">llvm::ISD::FSUB</a></div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00222">ISDOpcodes.h:222</a></div></div>
<div class="ttc" id="classllvm_1_1SDValue_html_a040481b9bda32faa6b1435532405d88f"><div class="ttname"><a href="classllvm_1_1SDValue.html#a040481b9bda32faa6b1435532405d88f">llvm::SDValue::getValue</a></div><div class="ttdeci">SDValue getValue(unsigned R) const </div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l00122">SelectionDAGNodes.h:122</a></div></div>
<div class="ttc" id="classllvm_1_1TargetMachine_html_ac962b1af600c2e418625a5fecc5e0f95"><div class="ttname"><a href="classllvm_1_1TargetMachine.html#ac962b1af600c2e418625a5fecc5e0f95">llvm::TargetMachine::getTargetLowering</a></div><div class="ttdeci">virtual const TargetLowering * getTargetLowering() const </div><div class="ttdef"><b>Definition:</b> <a href="Target_2TargetMachine_8h_source.html#l00121">Target/TargetMachine.h:121</a></div></div>
<div class="ttc" id="namespacellvm_1_1ARM__PROC_html_aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5"><div class="ttname"><a href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">llvm::ARM_PROC::A</a></div><div class="ttdef"><b>Definition:</b> <a href="ARMBaseInfo_8h_source.html#l00098">ARMBaseInfo.h:98</a></div></div>
<div class="ttc" id="classllvm_1_1APInt_html_a2e5e9f65d911e80a46d3098933794056"><div class="ttname"><a href="classllvm_1_1APInt.html#a2e5e9f65d911e80a46d3098933794056">llvm::APInt::getSignBit</a></div><div class="ttdeci">static APInt getSignBit(unsigned BitWidth)</div><div class="ttdoc">Get the SignBit for a specific bit width. </div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l00443">APInt.h:443</a></div></div>
<div class="ttc" id="classllvm_1_1ConstantPoolSDNode_html"><div class="ttname"><a href="classllvm_1_1ConstantPoolSDNode.html">llvm::ConstantPoolSDNode</a></div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l01373">SelectionDAGNodes.h:1373</a></div></div>
<div class="ttc" id="namespacellvm_1_1tgtok_html_abbc5259d649363016626e2529fabe0c5a5fa7b4069ef3bd1ceb9f2caa315cf5ac"><div class="ttname"><a href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5a5fa7b4069ef3bd1ceb9f2caa315cf5ac">llvm::tgtok::In</a></div><div class="ttdef"><b>Definition:</b> <a href="TGLexer_8h_source.html#l00046">TGLexer.h:46</a></div></div>
<div class="ttc" id="classllvm_1_1TargetLoweringBase_html_a4fe606f87214ac58150a6c99bde8db84"><div class="ttname"><a href="classllvm_1_1TargetLoweringBase.html#a4fe606f87214ac58150a6c99bde8db84">llvm::TargetLoweringBase::isIndexedStoreLegal</a></div><div class="ttdeci">bool isIndexedStoreLegal(unsigned IdxMode, EVT VT) const </div><div class="ttdoc">Return true if the specified indexed load is legal on this target. </div><div class="ttdef"><b>Definition:</b> <a href="TargetLowering_8h_source.html#l00523">TargetLowering.h:523</a></div></div>
<div class="ttc" id="structMemOpLink_html_ad1b74377a2e70e691be7a8386e7ff97c"><div class="ttname"><a href="structMemOpLink.html#ad1b74377a2e70e691be7a8386e7ff97c">MemOpLink::OffsetFromBase</a></div><div class="ttdeci">int64_t OffsetFromBase</div><div class="ttdef"><b>Definition:</b> <a href="DAGCombiner_8cpp_source.html#l08540">DAGCombiner.cpp:8540</a></div></div>
<div class="ttc" id="classllvm_1_1MVT_html_afd69b4f2dff97a2d7c0192cc769ef50ca59a1908cf136662bcfdc11ed49515ca9"><div class="ttname"><a href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50ca59a1908cf136662bcfdc11ed49515ca9">llvm::MVT::Glue</a></div><div class="ttdef"><b>Definition:</b> <a href="ValueTypes_8h_source.html#l00118">ValueTypes.h:118</a></div></div>
<div class="ttc" id="classllvm_1_1ConstantFPSDNode_html_ae99f0c21a471750e1d75243898837001"><div class="ttname"><a href="classllvm_1_1ConstantFPSDNode.html#ae99f0c21a471750e1d75243898837001">llvm::ConstantFPSDNode::isExactlyValue</a></div><div class="ttdeci">bool isExactlyValue(double V) const </div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l01296">SelectionDAGNodes.h:1296</a></div></div>
<div class="ttc" id="DAGCombiner_8cpp_html_a8e273c7ecabdcb608c3f893260097571"><div class="ttname"><a href="DAGCombiner_8cpp.html#a8e273c7ecabdcb608c3f893260097571">areSlicesNextToEachOther</a></div><div class="ttdeci">static bool areSlicesNextToEachOther(const LoadedSlice &amp;First, const LoadedSlice &amp;Second)</div><div class="ttdoc">Check whether or not First and Second are next to each other in memory. This means that there is no h...</div><div class="ttdef"><b>Definition:</b> <a href="DAGCombiner_8cpp_source.html#l07918">DAGCombiner.cpp:7918</a></div></div>
<div class="ttc" id="namespacellvm_1_1SPII_html_a11e9b8fca4a074643a6a21f444e51406a5069619ca8fdce305534f3fe85091a0f"><div class="ttname"><a href="namespacellvm_1_1SPII.html#a11e9b8fca4a074643a6a21f444e51406a5069619ca8fdce305534f3fe85091a0f">llvm::SPII::Load</a></div><div class="ttdef"><b>Definition:</b> <a href="SparcInstrInfo_8h_source.html#l00031">SparcInstrInfo.h:31</a></div></div>
<div class="ttc" id="classllvm_1_1APInt_html_a539bdb4fdbf46e0bfcefebf5ac6d21dd"><div class="ttname"><a href="classllvm_1_1APInt.html#a539bdb4fdbf46e0bfcefebf5ac6d21dd">llvm::APInt::getAllOnesValue</a></div><div class="ttdeci">static APInt getAllOnesValue(unsigned numBits)</div><div class="ttdoc">Get the all-ones value. </div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l00450">APInt.h:450</a></div></div>
<div class="ttc" id="classllvm_1_1SelectionDAG_html_a39c6dff47b8dbd25cfaf6336c7056077"><div class="ttname"><a href="classllvm_1_1SelectionDAG.html#a39c6dff47b8dbd25cfaf6336c7056077">llvm::SelectionDAG::getContext</a></div><div class="ttdeci">LLVMContext * getContext() const </div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAG_8h_source.html#l00285">SelectionDAG.h:285</a></div></div>
<div class="ttc" id="structBaseIndexOffset_html"><div class="ttname"><a href="structBaseIndexOffset.html">BaseIndexOffset</a></div><div class="ttdef"><b>Definition:</b> <a href="DAGCombiner_8cpp_source.html#l08457">DAGCombiner.cpp:8457</a></div></div>
<div class="ttc" id="classllvm_1_1MVT_html_afd69b4f2dff97a2d7c0192cc769ef50ca97f56253625b3fe7b371ce76722de4b8"><div class="ttname"><a href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50ca97f56253625b3fe7b371ce76722de4b8">llvm::MVT::i64</a></div><div class="ttdef"><b>Definition:</b> <a href="ValueTypes_8h_source.html#l00047">ValueTypes.h:47</a></div></div>
<div class="ttc" id="namespacellvm_1_1NVPTXISD_html_a594ac167d52343b1fe4cec37bb7dc31ca7cff9cc4a40fe2b19129ee8e9b0ec645"><div class="ttname"><a href="namespacellvm_1_1NVPTXISD.html#a594ac167d52343b1fe4cec37bb7dc31ca7cff9cc4a40fe2b19129ee8e9b0ec645">llvm::NVPTXISD::Dummy</a></div><div class="ttdef"><b>Definition:</b> <a href="NVPTXISelLowering_8h_source.html#l00053">NVPTXISelLowering.h:53</a></div></div>
<div class="ttc" id="classllvm_1_1SelectionDAG_html_ac1f26ebe6fcefcb117d3a6fd1fe32e67"><div class="ttname"><a href="classllvm_1_1SelectionDAG.html#ac1f26ebe6fcefcb117d3a6fd1fe32e67">llvm::SelectionDAG::getIndexedLoad</a></div><div class="ttdeci">SDValue getIndexedLoad(SDValue OrigLoad, SDLoc dl, SDValue Base, SDValue Offset, ISD::MemIndexedMode AM)</div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAG_8cpp_source.html#l04607">SelectionDAG.cpp:4607</a></div></div>
<div class="ttc" id="classllvm_1_1SDNode_html_a535ca517df1b4ae62e75475141e65787"><div class="ttname"><a href="classllvm_1_1SDNode.html#a535ca517df1b4ae62e75475141e65787">llvm::SDNode::dump</a></div><div class="ttdeci">void dump() const </div><div class="ttdoc">dump - Dump this node, for debugging. </div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGDumper_8cpp_source.html#l00328">SelectionDAGDumper.cpp:328</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110a062083eb3ff8c441c73d3bf42ca09bba"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a062083eb3ff8c441c73d3bf42ca09bba">llvm::ISD::DELETED_NODE</a></div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00042">ISDOpcodes.h:42</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110a9070de8a5c5b71851732c4c54e2ffedf"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9070de8a5c5b71851732c4c54e2ffedf">llvm::ISD::EXTRACT_SUBVECTOR</a></div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00270">ISDOpcodes.h:270</a></div></div>
<div class="ttc" id="classllvm_1_1TargetLoweringBase_html_a7b93b105a426bc0eda1eadd856aa195e"><div class="ttname"><a href="classllvm_1_1TargetLoweringBase.html#a7b93b105a426bc0eda1eadd856aa195e">llvm::TargetLoweringBase::getTypeAction</a></div><div class="ttdeci">LegalizeTypeAction getTypeAction(LLVMContext &amp;Context, EVT VT) const </div><div class="ttdef"><b>Definition:</b> <a href="TargetLowering_8h_source.html#l00319">TargetLowering.h:319</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110a6d5e322b263f0d5ea4204efafc1d78bb"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a6d5e322b263f0d5ea4204efafc1d78bb">llvm::ISD::BR_CC</a></div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00496">ISDOpcodes.h:496</a></div></div>
<div class="ttc" id="namespacellvm_html"><div class="ttname"><a href="namespacellvm.html">llvm</a></div><div class="ttdoc">List of target independent CodeGen pass IDs. </div><div class="ttdef"><b>Definition:</b> <a href="APFloat_8h_source.html#l00022">APFloat.h:22</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_abfb4d7af9b241a75a155d468678c4fc1"><div class="ttname"><a href="namespacellvm_1_1ISD.html#abfb4d7af9b241a75a155d468678c4fc1">llvm::ISD::isNON_TRUNCStore</a></div><div class="ttdeci">bool isNON_TRUNCStore(const SDNode *N)</div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l01937">SelectionDAGNodes.h:1937</a></div></div>
<div class="ttc" id="structLoadedSliceSorter_html"><div class="ttname"><a href="structLoadedSliceSorter.html">LoadedSliceSorter</a></div><div class="ttdoc">Sorts LoadedSlice according to their offset. </div><div class="ttdef"><b>Definition:</b> <a href="DAGCombiner_8cpp_source.html#l07892">DAGCombiner.cpp:7892</a></div></div>
<div class="ttc" id="classllvm_1_1SDNode_html_a52753947fce3a01b1c18dd4713c587e8"><div class="ttname"><a href="classllvm_1_1SDNode.html#a52753947fce3a01b1c18dd4713c587e8">llvm::SDNode::hasOneUse</a></div><div class="ttdeci">bool hasOneUse() const </div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l00406">SelectionDAGNodes.h:406</a></div></div>
<div class="ttc" id="classllvm_1_1SDNode_html_a51dcb6414be6f4b441df7152e05de8f5"><div class="ttname"><a href="classllvm_1_1SDNode.html#a51dcb6414be6f4b441df7152e05de8f5">llvm::SDNode::hasNUsesOfValue</a></div><div class="ttdeci">bool hasNUsesOfValue(unsigned NUses, unsigned Value) const </div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAG_8cpp_source.html#l06119">SelectionDAG.cpp:6119</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110a8d8773b28111d8898663d4a0f6223d68"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a8d8773b28111d8898663d4a0f6223d68">llvm::ISD::VECTOR_SHUFFLE</a></div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00279">ISDOpcodes.h:279</a></div></div>
<div class="ttc" id="DerivedTypes_8h_html"><div class="ttname"><a href="DerivedTypes_8h.html">DerivedTypes.h</a></div></div>
<div class="ttc" id="classllvm_1_1TargetLoweringBase_html_aa61af767c51a95e2dd0dff2001168755a695a19c9c3ae14638be151add82755cb"><div class="ttname"><a href="classllvm_1_1TargetLoweringBase.html#aa61af767c51a95e2dd0dff2001168755a695a19c9c3ae14638be151add82755cb">llvm::TargetLoweringBase::ZeroOrNegativeOneBooleanContent</a></div><div class="ttdef"><b>Definition:</b> <a href="TargetLowering_8h_source.html#l00108">TargetLowering.h:108</a></div></div>
<div class="ttc" id="classllvm_1_1SDValue_html_a97b0f24f3e52f030830fca6fbfcbd37d"><div class="ttname"><a href="classllvm_1_1SDValue.html#a97b0f24f3e52f030830fca6fbfcbd37d">llvm::SDValue::hasOneUse</a></div><div class="ttdeci">bool hasOneUse() const </div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l00870">SelectionDAGNodes.h:870</a></div></div>
<div class="ttc" id="classllvm_1_1TargetLoweringBase_html_ab119bc60a5d16c72edff3e7c21f05278"><div class="ttname"><a href="classllvm_1_1TargetLoweringBase.html#ab119bc60a5d16c72edff3e7c21f05278">llvm::TargetLoweringBase::isPow2DivCheap</a></div><div class="ttdeci">bool isPow2DivCheap() const </div><div class="ttdoc">Return true if pow2 div is cheaper than a chain of srl/add/sra. </div><div class="ttdef"><b>Definition:</b> <a href="TargetLowering_8h_source.html#l00195">TargetLowering.h:195</a></div></div>
<div class="ttc" id="classllvm_1_1TargetLoweringBase_html_ada5f4a5dd489c777870538cdbb6da228"><div class="ttname"><a href="classllvm_1_1TargetLoweringBase.html#ada5f4a5dd489c777870538cdbb6da228">llvm::TargetLoweringBase::getTargetMachine</a></div><div class="ttdeci">const TargetMachine &amp; getTargetMachine() const </div><div class="ttdef"><b>Definition:</b> <a href="TargetLowering_8h_source.html#l00145">TargetLowering.h:145</a></div></div>
<div class="ttc" id="classllvm_1_1SDNode_html_a1aac28ffadab16f6cfbadfc2ddccd8a1"><div class="ttname"><a href="classllvm_1_1SDNode.html#a1aac28ffadab16f6cfbadfc2ddccd8a1">llvm::SDNode::getVTList</a></div><div class="ttdeci">SDVTList getVTList() const </div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l00563">SelectionDAGNodes.h:563</a></div></div>
<div class="ttc" id="classllvm_1_1MVT_html_afd69b4f2dff97a2d7c0192cc769ef50ca6c5745e529b6b3534599c54d82bc4691"><div class="ttname"><a href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50ca6c5745e529b6b3534599c54d82bc4691">llvm::MVT::f80</a></div><div class="ttdef"><b>Definition:</b> <a href="ValueTypes_8h_source.html#l00056">ValueTypes.h:56</a></div></div>
<div class="ttc" id="structBaseIndexOffset_html_acd3de374c9ae917fdc018643028ea28b"><div class="ttname"><a href="structBaseIndexOffset.html#acd3de374c9ae917fdc018643028ea28b">BaseIndexOffset::equalBaseIndex</a></div><div class="ttdeci">bool equalBaseIndex(const BaseIndexOffset &amp;Other)</div><div class="ttdef"><b>Definition:</b> <a href="DAGCombiner_8cpp_source.html#l08469">DAGCombiner.cpp:8469</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110a79c959df09509d7ff66d9b04bc40d18d"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a79c959df09509d7ff66d9b04bc40d18d">llvm::ISD::UMUL_LOHI</a></div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00181">ISDOpcodes.h:181</a></div></div>
<div class="ttc" id="DAGCombiner_8cpp_html_aac1d4a23814f56ced0003697d241efb6"><div class="ttname"><a href="DAGCombiner_8cpp.html#aac1d4a23814f56ced0003697d241efb6">MatchRotateHalf</a></div><div class="ttdeci">static bool MatchRotateHalf(SDValue Op, SDValue &amp;Shift, SDValue &amp;Mask)</div><div class="ttdoc">MatchRotateHalf - Match &quot;(X shl/srl V1) &amp; V2&quot; where V2 may not be present. </div><div class="ttdef"><b>Definition:</b> <a href="DAGCombiner_8cpp_source.html#l03287">DAGCombiner.cpp:3287</a></div></div>
<div class="ttc" id="namespacellvm_1_1tgtok_html_abbc5259d649363016626e2529fabe0c5abb824e612ba80ddfd262b018bf537595"><div class="ttname"><a href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5abb824e612ba80ddfd262b018bf537595">llvm::tgtok::Int</a></div><div class="ttdef"><b>Definition:</b> <a href="TGLexer_8h_source.html#l00046">TGLexer.h:46</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_abee7ecb577fcade34eb16ccb7f503e31ade1c53e7b8a373e22ec53ff7bcbace9f"><div class="ttname"><a href="namespacellvm_1_1ISD.html#abee7ecb577fcade34eb16ccb7f503e31ade1c53e7b8a373e22ec53ff7bcbace9f">llvm::ISD::UNINDEXED</a></div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00679">ISDOpcodes.h:679</a></div></div>
<div class="ttc" id="namespacellvm_html_a3f2f98c2a67c9e79f58aad9150a62e42"><div class="ttname"><a href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">llvm::dyn_cast</a></div><div class="ttdeci">enable_if_c&lt;!is_simple_type&lt; Y &gt;::value, typename cast_retty&lt; X, const Y &gt;::ret_type &gt;::type dyn_cast(const Y &amp;Val)</div><div class="ttdef"><b>Definition:</b> <a href="Casting_8h_source.html#l00266">Casting.h:266</a></div></div>
<div class="ttc" id="classllvm_1_1ShuffleVectorSDNode_html_a216b27e62fea4f0ea71d40e28a1523b6"><div class="ttname"><a href="classllvm_1_1ShuffleVectorSDNode.html#a216b27e62fea4f0ea71d40e28a1523b6">llvm::ShuffleVectorSDNode::getSplatIndex</a></div><div class="ttdeci">int getSplatIndex() const </div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l01230">SelectionDAGNodes.h:1230</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110a20084f62caecb0db80ad71bdabda73c2"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a20084f62caecb0db80ad71bdabda73c2">llvm::ISD::ADDC</a></div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00195">ISDOpcodes.h:195</a></div></div>
<div class="ttc" id="classllvm_1_1TargetLoweringBase_html_adb45e7ad0a527824d12e1705864e577e"><div class="ttname"><a href="classllvm_1_1TargetLoweringBase.html#adb45e7ad0a527824d12e1705864e577e">llvm::TargetLoweringBase::isIntDivCheap</a></div><div class="ttdeci">bool isIntDivCheap() const </div><div class="ttdef"><b>Definition:</b> <a href="TargetLowering_8h_source.html#l00183">TargetLowering.h:183</a></div></div>
<div class="ttc" id="X86ISelDAGToDAG_8cpp_html_afc4e10b4f2ab2d548ab80b30f3b712e9acfcf145f2788bf340ff3f3098bc54909"><div class="ttname"><a href="X86ISelDAGToDAG_8cpp.html#afc4e10b4f2ab2d548ab80b30f3b712e9acfcf145f2788bf340ff3f3098bc54909">ADD</a></div><div class="ttdef"><b>Definition:</b> <a href="X86ISelDAGToDAG_8cpp_source.html#l01583">X86ISelDAGToDAG.cpp:1583</a></div></div>
<div class="ttc" id="classllvm_1_1SelectionDAG_html_a6b60694d1d9d7f634e7638856898e20d"><div class="ttname"><a href="classllvm_1_1SelectionDAG.html#a6b60694d1d9d7f634e7638856898e20d">llvm::SelectionDAG::getTarget</a></div><div class="ttdeci">const TargetMachine &amp; getTarget() const </div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAG_8h_source.html#l00281">SelectionDAG.h:281</a></div></div>
<div class="ttc" id="structllvm_1_1EVT_html_a0ca9e22c58f23f19b5c3eb010318b699"><div class="ttname"><a href="structllvm_1_1EVT.html#a0ca9e22c58f23f19b5c3eb010318b699">llvm::EVT::isExtended</a></div><div class="ttdeci">bool isExtended() const </div><div class="ttdef"><b>Definition:</b> <a href="ValueTypes_8h_source.html#l00646">ValueTypes.h:646</a></div></div>
<div class="ttc" id="DataLayout_8h_html"><div class="ttname"><a href="DataLayout_8h.html">DataLayout.h</a></div></div>
<div class="ttc" id="classllvm_1_1DataLayout_html_adfb7610cbc23430a7d4077a3cf9c22d3"><div class="ttname"><a href="classllvm_1_1DataLayout.html#adfb7610cbc23430a7d4077a3cf9c22d3">llvm::DataLayout::getPrefTypeAlignment</a></div><div class="ttdeci">unsigned getPrefTypeAlignment(Type *Ty) const </div><div class="ttdef"><b>Definition:</b> <a href="DataLayout_8cpp_source.html#l00600">DataLayout.cpp:600</a></div></div>
<div class="ttc" id="classllvm_1_1TargetLoweringBase_html_aebbd7a2d93f67bd693cdac43795dc9d4"><div class="ttname"><a href="classllvm_1_1TargetLoweringBase.html#aebbd7a2d93f67bd693cdac43795dc9d4">llvm::TargetLoweringBase::isLoadBitCastBeneficial</a></div><div class="ttdeci">virtual bool isLoadBitCastBeneficial(EVT, EVT) const </div><div class="ttdef"><b>Definition:</b> <a href="TargetLowering_8h_source.html#l00214">TargetLowering.h:214</a></div></div>
<div class="ttc" id="structllvm_1_1SelectionDAG_1_1DAGUpdateListener_html"><div class="ttname"><a href="structllvm_1_1SelectionDAG_1_1DAGUpdateListener.html">llvm::SelectionDAG::DAGUpdateListener</a></div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAG_8h_source.html#l00217">SelectionDAG.h:217</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110a9ab5860c97a00c4627a08cab7b0c8178"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9ab5860c97a00c4627a08cab7b0c8178">llvm::ISD::FMUL</a></div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00222">ISDOpcodes.h:222</a></div></div>
<div class="ttc" id="Debug_8h_html"><div class="ttname"><a href="Debug_8h.html">Debug.h</a></div></div>
<div class="ttc" id="Target_2README_8txt_html_a3a76669632041022e6976766a22bd2b0"><div class="ttname"><a href="Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a></div><div class="ttdeci">return j(j&lt;&lt; 16)</div></div>
<div class="ttc" id="classllvm_1_1SelectionDAG_html_a2bf689949a7a6c115298d4f8e4f637cd"><div class="ttname"><a href="classllvm_1_1SelectionDAG.html#a2bf689949a7a6c115298d4f8e4f637cd">llvm::SelectionDAG::InferPtrAlignment</a></div><div class="ttdeci">unsigned InferPtrAlignment(SDValue Ptr) const </div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAG_8cpp_source.html#l06372">SelectionDAG.cpp:6372</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_ad4d48171b87ca51ff54c10a436bac4d7a6aacde2c67988b43a261a7f7ceac4be3"><div class="ttname"><a href="namespacellvm_1_1ISD.html#ad4d48171b87ca51ff54c10a436bac4d7a6aacde2c67988b43a261a7f7ceac4be3">llvm::ISD::NON_EXTLOAD</a></div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00698">ISDOpcodes.h:698</a></div></div>
<div class="ttc" id="classllvm_1_1SelectionDAG_html_a69a858247fbce6bd8035a1dbeb770f24"><div class="ttname"><a href="classllvm_1_1SelectionDAG.html#a69a858247fbce6bd8035a1dbeb770f24">llvm::SelectionDAG::GetSplitDestVTs</a></div><div class="ttdeci">std::pair&lt; EVT, EVT &gt; GetSplitDestVTs(const EVT &amp;VT) const </div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAG_8cpp_source.html#l06413">SelectionDAG.cpp:6413</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a9cd461f4281b55121d79d03d883fc060"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a9cd461f4281b55121d79d03d883fc060">llvm::ISD::getSetCCAndOperation</a></div><div class="ttdeci">CondCode getSetCCAndOperation(CondCode Op1, CondCode Op2, bool isInteger)</div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAG_8cpp_source.html#l00295">SelectionDAG.cpp:295</a></div></div>
<div class="ttc" id="classllvm_1_1APInt_html_ad960e1ff48d25c382b6d28e7961f074e"><div class="ttname"><a href="classllvm_1_1APInt.html#ad960e1ff48d25c382b6d28e7961f074e">llvm::APInt::getLowBitsSet</a></div><div class="ttdeci">static APInt getLowBitsSet(unsigned numBits, unsigned loBitsSet)</div><div class="ttdoc">Get a value with low bits set. </div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l00528">APInt.h:528</a></div></div>
<div class="ttc" id="classllvm_1_1TargetLowering_html_a0494f569df118d504e92cbe003d96319"><div class="ttname"><a href="classllvm_1_1TargetLowering.html#a0494f569df118d504e92cbe003d96319">llvm::TargetLowering::getPreIndexedAddressParts</a></div><div class="ttdeci">virtual bool getPreIndexedAddressParts(SDNode *, SDValue &amp;, SDValue &amp;, ISD::MemIndexedMode &amp;, SelectionDAG &amp;) const </div><div class="ttdef"><b>Definition:</b> <a href="TargetLowering_8h_source.html#l01707">TargetLowering.h:1707</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110a863ec6ebb75bf89cfea14da646d77e92"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a863ec6ebb75bf89cfea14da646d77e92">llvm::ISD::SADDO</a></div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00213">ISDOpcodes.h:213</a></div></div>
<div class="ttc" id="classllvm_1_1SmallPtrSet_html_a9b6dd0fc7a648a939e571246045b673e"><div class="ttname"><a href="classllvm_1_1SmallPtrSet.html#a9b6dd0fc7a648a939e571246045b673e">llvm::SmallPtrSet::insert</a></div><div class="ttdeci">bool insert(PtrType Ptr)</div><div class="ttdef"><b>Definition:</b> <a href="SmallPtrSet_8h_source.html#l00253">SmallPtrSet.h:253</a></div></div>
<div class="ttc" id="Target_2TargetMachine_8h_html"><div class="ttname"><a href="Target_2TargetMachine_8h.html">TargetMachine.h</a></div></div>
<div class="ttc" id="classllvm_1_1SDNode_html_af0d328f3f61168f4ea7d6e4044af4f97"><div class="ttname"><a href="classllvm_1_1SDNode.html#af0d328f3f61168f4ea7d6e4044af4f97">llvm::SDNode::getOpcode</a></div><div class="ttdeci">unsigned getOpcode() const </div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l00369">SelectionDAGNodes.h:369</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110a169032eecd015d4eeb869c457202a6c8"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a169032eecd015d4eeb869c457202a6c8">llvm::ISD::UINT_TO_FP</a></div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00368">ISDOpcodes.h:368</a></div></div>
<div class="ttc" id="namespacellvm_html_a8773fab32deb314deb5c6ad78bc8ec99"><div class="ttname"><a href="namespacellvm.html#a8773fab32deb314deb5c6ad78bc8ec99">llvm::operator&gt;</a></div><div class="ttdeci">void operator&gt;(const Optional&lt; T &gt; &amp;X, const Optional&lt; U &gt; &amp;Y)</div><div class="ttdoc">Poison comparison between two Optional objects. Clients needs to explicitly compare the underlying va...</div></div>
<div class="ttc" id="classllvm_1_1SelectionDAG_html_ac5049f4bc4c1d0322abab27481d30c37"><div class="ttname"><a href="classllvm_1_1SelectionDAG.html#ac5049f4bc4c1d0322abab27481d30c37">llvm::SelectionDAG::getSelectCC</a></div><div class="ttdeci">SDValue getSelectCC(SDLoc DL, SDValue LHS, SDValue RHS, SDValue True, SDValue False, ISD::CondCode Cond)</div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAG_8h_source.html#l00679">SelectionDAG.h:679</a></div></div>
<div class="ttc" id="namespacellvm_html_a7c469a194119a14e5a018ebb9b847cf0"><div class="ttname"><a href="namespacellvm.html#a7c469a194119a14e5a018ebb9b847cf0">llvm::operator&lt;</a></div><div class="ttdeci">void operator&lt;(const Optional&lt; T &gt; &amp;X, const Optional&lt; U &gt; &amp;Y)</div><div class="ttdoc">Poison comparison between two Optional objects. Clients needs to explicitly compare the underlying va...</div></div>
<div class="ttc" id="classllvm_1_1TargetLoweringBase_html_a03d795b93578bd5b530aa998869fb1ac"><div class="ttname"><a href="classllvm_1_1TargetLoweringBase.html#a03d795b93578bd5b530aa998869fb1ac">llvm::TargetLoweringBase::isFAbsFree</a></div><div class="ttdeci">virtual bool isFAbsFree(EVT VT) const </div><div class="ttdef"><b>Definition:</b> <a href="TargetLowering_8h_source.html#l01252">TargetLowering.h:1252</a></div></div>
<div class="ttc" id="structllvm_1_1EVT_html_a226345d0c8262e9469d30a993d1656ff"><div class="ttname"><a href="structllvm_1_1EVT.html#a226345d0c8262e9469d30a993d1656ff">llvm::EVT::getTypeForEVT</a></div><div class="ttdeci">Type * getTypeForEVT(LLVMContext &amp;Context) const </div><div class="ttdef"><b>Definition:</b> <a href="ValueTypes_8cpp_source.html#l00180">ValueTypes.cpp:180</a></div></div>
<div class="ttc" id="classllvm_1_1MVT_html_a423166b2b5d1010162dde0003e5ad09c"><div class="ttname"><a href="classllvm_1_1MVT.html#a423166b2b5d1010162dde0003e5ad09c">llvm::MVT::getSizeInBits</a></div><div class="ttdeci">unsigned getSizeInBits() const </div><div class="ttdef"><b>Definition:</b> <a href="ValueTypes_8h_source.html#l00359">ValueTypes.h:359</a></div></div>
<div class="ttc" id="classllvm_1_1APFloat_html_a42fe920c8131569bb30114d7f294c8f8"><div class="ttname"><a href="classllvm_1_1APFloat.html#a42fe920c8131569bb30114d7f294c8f8">llvm::APFloat::opStatus</a></div><div class="ttdeci">opStatus</div><div class="ttdef"><b>Definition:</b> <a href="APFloat_8h_source.html#l00166">APFloat.h:166</a></div></div>
<div class="ttc" id="classllvm_1_1SelectionDAG_html_ad03d69f873a948a3de21ba504364d352"><div class="ttname"><a href="classllvm_1_1SelectionDAG.html#ad03d69f873a948a3de21ba504364d352">llvm::SelectionDAG::getZeroExtendInReg</a></div><div class="ttdeci">SDValue getZeroExtendInReg(SDValue Op, SDLoc DL, EVT SrcTy)</div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAG_8cpp_source.html#l00938">SelectionDAG.cpp:938</a></div></div>
<div class="ttc" id="classllvm_1_1LSBaseSDNode_html_a958114b87bff3b4db5ae7766d44dc375"><div class="ttname"><a href="classllvm_1_1LSBaseSDNode.html#a958114b87bff3b4db5ae7766d44dc375">llvm::LSBaseSDNode::isUnindexed</a></div><div class="ttdeci">bool isUnindexed() const </div><div class="ttdoc">isUnindexed - Return true if this is NOT a pre/post inc/dec load/store. </div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l01710">SelectionDAGNodes.h:1710</a></div></div>
<div class="ttc" id="namespacellvm_1_1APIntOps_html_a3deb6e6ca37ab496c0ee8996cb06825c"><div class="ttname"><a href="namespacellvm_1_1APIntOps.html#a3deb6e6ca37ab496c0ee8996cb06825c">llvm::APIntOps::isMask</a></div><div class="ttdeci">bool isMask(unsigned numBits, const APInt &amp;APIVal)</div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l01717">APInt.h:1717</a></div></div>
<div class="ttc" id="namespacellvm_1_1NVPTX_1_1PTXLdStInstCode_html_a91119cbee2be000c528a690252aee07ca09c68d67f7dbfa6cc77eaf73aa535217"><div class="ttname"><a href="namespacellvm_1_1NVPTX_1_1PTXLdStInstCode.html#a91119cbee2be000c528a690252aee07ca09c68d67f7dbfa6cc77eaf73aa535217">llvm::NVPTX::PTXLdStInstCode::Scalar</a></div><div class="ttdef"><b>Definition:</b> <a href="NVPTX_8h_source.html#l00126">NVPTX.h:126</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110a2b4d07600495a563319d6a3dda8dc44d"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a2b4d07600495a563319d6a3dda8dc44d">llvm::ISD::FABS</a></div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00449">ISDOpcodes.h:449</a></div></div>
<div class="ttc" id="classllvm_1_1SDNode_html_abc5c2f1d47a517373030133c6a102106"><div class="ttname"><a href="classllvm_1_1SDNode.html#abc5c2f1d47a517373030133c6a102106">llvm::SDNode::getNumOperands</a></div><div class="ttdeci">unsigned getNumOperands() const </div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l00548">SelectionDAGNodes.h:548</a></div></div>
<div class="ttc" id="classllvm_1_1APInt_html_ab6fff8a97bcb55e50e9be0ecf0c99b63"><div class="ttname"><a href="classllvm_1_1APInt.html#ab6fff8a97bcb55e50e9be0ecf0c99b63">llvm::APInt::setAllBits</a></div><div class="ttdeci">void setAllBits()</div><div class="ttdoc">Set every bit to 1. </div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l01200">APInt.h:1200</a></div></div>
<div class="ttc" id="classllvm_1_1TargetRegisterInfo_html_a97605349dfd657633ef8afb8c1afa9a6"><div class="ttname"><a href="classllvm_1_1TargetRegisterInfo.html#a97605349dfd657633ef8afb8c1afa9a6">llvm::TargetRegisterInfo::getCommonSubClass</a></div><div class="ttdeci">const TargetRegisterClass * getCommonSubClass(const TargetRegisterClass *A, const TargetRegisterClass *B) const </div><div class="ttdef"><b>Definition:</b> <a href="TargetRegisterInfo_8cpp_source.html#l00171">TargetRegisterInfo.cpp:171</a></div></div>
<div class="ttc" id="classllvm_1_1SDValue_html_a5f0447ef8ec128563ad131b76e5062bd"><div class="ttname"><a href="classllvm_1_1SDValue.html#a5f0447ef8ec128563ad131b76e5062bd">llvm::SDValue::getNumOperands</a></div><div class="ttdeci">unsigned getNumOperands() const </div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l00846">SelectionDAGNodes.h:846</a></div></div>
<div class="ttc" id="classllvm_1_1SDValue_html_a70aa652293da070dfe5b9fae309d0112"><div class="ttname"><a href="classllvm_1_1SDValue.html#a70aa652293da070dfe5b9fae309d0112">llvm::SDValue::getValueSizeInBits</a></div><div class="ttdeci">unsigned getValueSizeInBits() const </div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l00140">SelectionDAGNodes.h:140</a></div></div>
<div class="ttc" id="classllvm_1_1TargetLoweringBase_html_ae40dacbf39edf0d87f07cc4389deaa67"><div class="ttname"><a href="classllvm_1_1TargetLoweringBase.html#ae40dacbf39edf0d87f07cc4389deaa67">llvm::TargetLoweringBase::isZExtFree</a></div><div class="ttdeci">virtual bool isZExtFree(Type *, Type *) const </div><div class="ttdef"><b>Definition:</b> <a href="TargetLowering_8h_source.html#l01197">TargetLowering.h:1197</a></div></div>
<div class="ttc" id="classllvm_1_1MDNode_html"><div class="ttname"><a href="classllvm_1_1MDNode.html">llvm::MDNode</a></div><div class="ttdoc">MDNode - a tuple of other values. </div><div class="ttdef"><b>Definition:</b> <a href="Metadata_8h_source.html#l00073">Metadata.h:73</a></div></div>
<div class="ttc" id="classllvm_1_1SDNode_html_a836c27481205f56e708fe0c15538d5ff"><div class="ttname"><a href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">llvm::SDNode::getOperand</a></div><div class="ttdeci">const SDValue &amp; getOperand(unsigned Num) const </div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l00554">SelectionDAGNodes.h:554</a></div></div>
<div class="ttc" id="classllvm_1_1MachineFunction_html_ad784a6594990530bffb2018aeeed56f3"><div class="ttname"><a href="classllvm_1_1MachineFunction.html#ad784a6594990530bffb2018aeeed56f3">llvm::MachineFunction::getFunction</a></div><div class="ttdeci">const Function * getFunction() const </div><div class="ttdef"><b>Definition:</b> <a href="MachineFunction_8h_source.html#l00151">MachineFunction.h:151</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_ac3c3cf58d6d631af6a172457304d3d07ae2e6a5e32087b9f65bd51585a6a5afb4"><div class="ttname"><a href="namespacellvm_1_1ISD.html#ac3c3cf58d6d631af6a172457304d3d07ae2e6a5e32087b9f65bd51585a6a5afb4">llvm::ISD::SETEQ</a></div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00739">ISDOpcodes.h:739</a></div></div>
<div class="ttc" id="structllvm_1_1MachinePointerInfo_html_aa08f2339c536714c3cef4e56cb0f33b2"><div class="ttname"><a href="structllvm_1_1MachinePointerInfo.html#aa08f2339c536714c3cef4e56cb0f33b2">llvm::MachinePointerInfo::getConstantPool</a></div><div class="ttdeci">static MachinePointerInfo getConstantPool()</div><div class="ttdef"><b>Definition:</b> <a href="MachineInstr_8cpp_source.html#l00398">MachineInstr.cpp:398</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110a9fa617e5567c3c2638938f7b9ddc3f1c"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9fa617e5567c3c2638938f7b9ddc3f1c">llvm::ISD::SUB</a></div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00176">ISDOpcodes.h:176</a></div></div>
<div class="ttc" id="classllvm_1_1User_html"><div class="ttname"><a href="classllvm_1_1User.html">llvm::User</a></div><div class="ttdef"><b>Definition:</b> <a href="User_8h_source.html#l00033">User.h:33</a></div></div>
<div class="ttc" id="classllvm_1_1SelectionDAG_html_acb93eca900026b60350adc23973c2262"><div class="ttname"><a href="classllvm_1_1SelectionDAG.html#acb93eca900026b60350adc23973c2262">llvm::SelectionDAG::isCommutativeBinOp</a></div><div class="ttdeci">static bool isCommutativeBinOp(unsigned Opcode)</div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAG_8h_source.html#l00988">SelectionDAG.h:988</a></div></div>
<div class="ttc" id="classllvm_1_1SelectionDAG_html_ad06ca140783fd9f03eed498e8485fc3d"><div class="ttname"><a href="classllvm_1_1SelectionDAG.html#ad06ca140783fd9f03eed498e8485fc3d">llvm::SelectionDAG::ComputeMaskedBits</a></div><div class="ttdeci">void ComputeMaskedBits(SDValue Op, APInt &amp;KnownZero, APInt &amp;KnownOne, unsigned Depth=0) const </div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAG_8cpp_source.html#l01759">SelectionDAG.cpp:1759</a></div></div>
<div class="ttc" id="classllvm_1_1SelectionDAG_html_a3d2e079387a6e69ce2c8bb27bf7c2f32"><div class="ttname"><a href="classllvm_1_1SelectionDAG.html#a3d2e079387a6e69ce2c8bb27bf7c2f32">llvm::SelectionDAG::setRoot</a></div><div class="ttdeci">const SDValue &amp; setRoot(SDValue N)</div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAG_8h_source.html#l00338">SelectionDAG.h:338</a></div></div>
<div class="ttc" id="structllvm_1_1TargetLowering_1_1TargetLoweringOpt_html_af62539995977e2e2b411bbb87378e894"><div class="ttname"><a href="structllvm_1_1TargetLowering_1_1TargetLoweringOpt.html#af62539995977e2e2b411bbb87378e894">llvm::TargetLowering::TargetLoweringOpt::Old</a></div><div class="ttdeci">SDValue Old</div><div class="ttdef"><b>Definition:</b> <a href="TargetLowering_8h_source.html#l01775">TargetLowering.h:1775</a></div></div>
<div class="ttc" id="DAGCombiner_8cpp_html_a31be5288def7545189cab5401fe3a1b0"><div class="ttname"><a href="DAGCombiner_8cpp.html#a31be5288def7545189cab5401fe3a1b0">FindBaseOffset</a></div><div class="ttdeci">static bool FindBaseOffset(SDValue Ptr, SDValue &amp;Base, int64_t &amp;Offset, const GlobalValue *&amp;GV, const void *&amp;CV)</div><div class="ttdoc">FindBaseOffset - Return true if base is a frame index, which is known not. </div><div class="ttdef"><b>Definition:</b> <a href="DAGCombiner_8cpp_source.html#l10768">DAGCombiner.cpp:10768</a></div></div>
<div class="ttc" id="classllvm_1_1TargetLoweringBase_html_ae7ff3b0592782cde529b9a16833b44d0"><div class="ttname"><a href="classllvm_1_1TargetLoweringBase.html#ae7ff3b0592782cde529b9a16833b44d0">llvm::TargetLoweringBase::getOperationAction</a></div><div class="ttdeci">LegalizeAction getOperationAction(unsigned Op, EVT VT) const </div><div class="ttdef"><b>Definition:</b> <a href="TargetLowering_8h_source.html#l00421">TargetLowering.h:421</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110ad46ae9fdfe20cd04f7fda7ccbb937543"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ad46ae9fdfe20cd04f7fda7ccbb937543">llvm::ISD::FSIN</a></div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00449">ISDOpcodes.h:449</a></div></div>
<div class="ttc" id="classllvm_1_1AttributeSet_html_a54abbe67d4a53c92652f1666dc19281f"><div class="ttname"><a href="classllvm_1_1AttributeSet.html#a54abbe67d4a53c92652f1666dc19281f">llvm::AttributeSet::hasAttribute</a></div><div class="ttdeci">bool hasAttribute(unsigned Index, Attribute::AttrKind Kind) const </div><div class="ttdoc">Return true if the attribute exists at the given index. </div><div class="ttdef"><b>Definition:</b> <a href="Attributes_8cpp_source.html#l00818">Attributes.cpp:818</a></div></div>
<div class="ttc" id="Statistic_8h_html"><div class="ttname"><a href="Statistic_8h.html">Statistic.h</a></div></div>
<div class="ttc" id="classllvm_1_1SelectionDAG_html_a5f57dcbedc16dced31c61f7bbbb06ded"><div class="ttname"><a href="classllvm_1_1SelectionDAG.html#a5f57dcbedc16dced31c61f7bbbb06ded">llvm::SelectionDAG::DeleteNode</a></div><div class="ttdeci">void DeleteNode(SDNode *N)</div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAG_8cpp_source.html#l00609">SelectionDAG.cpp:609</a></div></div>
<div class="ttc" id="classllvm_1_1LoadSDNode_html_a3ded48ce66b58b7e7e143991df5dbfae"><div class="ttname"><a href="classllvm_1_1LoadSDNode.html#a3ded48ce66b58b7e7e143991df5dbfae">llvm::LoadSDNode::getBasePtr</a></div><div class="ttdeci">const SDValue &amp; getBasePtr() const </div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l01739">SelectionDAGNodes.h:1739</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110a1617abaedbb1d902bb3a5b3136684f9c"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a1617abaedbb1d902bb3a5b3136684f9c">llvm::ISD::INSERT_SUBVECTOR</a></div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00265">ISDOpcodes.h:265</a></div></div>
<div class="ttc" id="classllvm_1_1SelectionDAG_html_ad5bba8f4524b49efbace42884b38fe7e"><div class="ttname"><a href="classllvm_1_1SelectionDAG.html#ad5bba8f4524b49efbace42884b38fe7e">llvm::SelectionDAG::getConstantPool</a></div><div class="ttdeci">SDValue getConstantPool(const Constant *C, EVT VT, unsigned Align=0, int Offs=0, bool isT=false, unsigned char TargetFlags=0)</div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAG_8cpp_source.html#l01204">SelectionDAG.cpp:1204</a></div></div>
<div class="ttc" id="classllvm_1_1APInt_html_a7fe47410bb825eccb20f010dab13c72f"><div class="ttname"><a href="classllvm_1_1APInt.html#a7fe47410bb825eccb20f010dab13c72f">llvm::APInt::zextOrTrunc</a></div><div class="ttdeci">APInt LLVM_ATTRIBUTE_UNUSED_RESULT zextOrTrunc(unsigned width) const </div><div class="ttdoc">Zero extend or truncate to width. </div><div class="ttdef"><b>Definition:</b> <a href="APInt_8cpp_source.html#l01002">APInt.cpp:1002</a></div></div>
<div class="ttc" id="classllvm_1_1MVT_html_afd69b4f2dff97a2d7c0192cc769ef50ca1e0cfc795f0b068229dcec6eecb69499"><div class="ttname"><a href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50ca1e0cfc795f0b068229dcec6eecb69499">llvm::MVT::f16</a></div><div class="ttdef"><b>Definition:</b> <a href="ValueTypes_8h_source.html#l00053">ValueTypes.h:53</a></div></div>
<div class="ttc" id="classllvm_1_1TargetLoweringBase_html_a0a5f9cfaec7239ea289716ff11c8e56a"><div class="ttname"><a href="classllvm_1_1TargetLoweringBase.html#a0a5f9cfaec7239ea289716ff11c8e56a">llvm::TargetLoweringBase::getScalarShiftAmountTy</a></div><div class="ttdeci">virtual MVT getScalarShiftAmountTy(EVT LHSTy) const </div><div class="ttdef"><b>Definition:</b> <a href="TargetLoweringBase_8cpp_source.html#l00810">TargetLoweringBase.cpp:810</a></div></div>
<div class="ttc" id="DAGCombiner_8cpp_html_ad7dc0568fb6af72bddba2345c5f477aa"><div class="ttname"><a href="DAGCombiner_8cpp.html#ad7dc0568fb6af72bddba2345c5f477aa">ShrinkLoadReplaceStoreWithStore</a></div><div class="ttdeci">static SDNode * ShrinkLoadReplaceStoreWithStore(const std::pair&lt; unsigned, unsigned &gt; &amp;MaskInfo, SDValue IVal, StoreSDNode *St, DAGCombiner *DC)</div><div class="ttdef"><b>Definition:</b> <a href="DAGCombiner_8cpp_source.html#l08211">DAGCombiner.cpp:8211</a></div></div>
<div class="ttc" id="classllvm_1_1TargetLoweringBase_html_a36072d8d2e3e7ffbb69fbdad448fcad3"><div class="ttname"><a href="classllvm_1_1TargetLoweringBase.html#a36072d8d2e3e7ffbb69fbdad448fcad3">llvm::TargetLoweringBase::isFPImmLegal</a></div><div class="ttdeci">virtual bool isFPImmLegal(const APFloat &amp;, EVT) const </div><div class="ttdef"><b>Definition:</b> <a href="TargetLowering_8h_source.html#l00391">TargetLowering.h:391</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110a926013f6dca240eca95aca66c8d3e74b"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a926013f6dca240eca95aca66c8d3e74b">llvm::ISD::EntryToken</a></div><div class="ttdoc">EntryToken - This is the marker used to indicate the start of a region. </div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00045">ISDOpcodes.h:45</a></div></div>
<div class="ttc" id="classllvm_1_1TargetLowering_html_ab945eaf78cbe0a5e7cd0dbc3a6b92ae4"><div class="ttname"><a href="classllvm_1_1TargetLowering.html#ab945eaf78cbe0a5e7cd0dbc3a6b92ae4">llvm::TargetLowering::isTypeDesirableForOp</a></div><div class="ttdeci">virtual bool isTypeDesirableForOp(unsigned, EVT VT) const </div><div class="ttdef"><b>Definition:</b> <a href="TargetLowering_8h_source.html#l01886">TargetLowering.h:1886</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110a99ad6b342b7457df56b91d24e66016b3"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a99ad6b342b7457df56b91d24e66016b3">llvm::ISD::SELECT_CC</a></div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00331">ISDOpcodes.h:331</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110">llvm::ISD::NodeType</a></div><div class="ttdeci">NodeType</div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00039">ISDOpcodes.h:39</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_abee7ecb577fcade34eb16ccb7f503e31a10a4094c81c0b9cd5e82e53b48932203"><div class="ttname"><a href="namespacellvm_1_1ISD.html#abee7ecb577fcade34eb16ccb7f503e31a10a4094c81c0b9cd5e82e53b48932203">llvm::ISD::POST_DEC</a></div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00683">ISDOpcodes.h:683</a></div></div>
<div class="ttc" id="classllvm_1_1SDValue_html_a64881a6ca7154fccaeb92cdb1e1e745e"><div class="ttname"><a href="classllvm_1_1SDValue.html#a64881a6ca7154fccaeb92cdb1e1e745e">llvm::SDValue::getResNo</a></div><div class="ttdeci">unsigned getResNo() const </div><div class="ttdoc">get the index which selects a specific result in the SDNode </div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l00102">SelectionDAGNodes.h:102</a></div></div>
<div class="ttc" id="classllvm_1_1SelectionDAG_html_a2869d5459dca008c1c7a1e824e7faf5e"><div class="ttname"><a href="classllvm_1_1SelectionDAG.html#a2869d5459dca008c1c7a1e824e7faf5e">llvm::SelectionDAG::ReplaceAllUsesOfValuesWith</a></div><div class="ttdeci">void ReplaceAllUsesOfValuesWith(const SDValue *From, const SDValue *To, unsigned Num)</div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAG_8cpp_source.html#l05865">SelectionDAG.cpp:5865</a></div></div>
<div class="ttc" id="structllvm_1_1EVT_html_a5ebe5227fe53e0dcf4102a6ebf1594a2"><div class="ttname"><a href="structllvm_1_1EVT.html#a5ebe5227fe53e0dcf4102a6ebf1594a2">llvm::EVT::bitsLT</a></div><div class="ttdeci">bool bitsLT(EVT VT) const </div><div class="ttdoc">bitsLT - Return true if this has less bits than VT. </div><div class="ttdef"><b>Definition:</b> <a href="ValueTypes_8h_source.html#l00735">ValueTypes.h:735</a></div></div>
<div class="ttc" id="classllvm_1_1TargetLowering_html_acfbda80cc07884ccb7b267aaea403141"><div class="ttname"><a href="classllvm_1_1TargetLowering.html#acfbda80cc07884ccb7b267aaea403141">llvm::TargetLowering::SimplifyDemandedBits</a></div><div class="ttdeci">bool SimplifyDemandedBits(SDValue Op, const APInt &amp;DemandedMask, APInt &amp;KnownZero, APInt &amp;KnownOne, TargetLoweringOpt &amp;TLO, unsigned Depth=0) const </div><div class="ttdef"><b>Definition:</b> <a href="TargetLowering_8cpp_source.html#l00367">TargetLowering.cpp:367</a></div></div>
<div class="ttc" id="namespacellvm_1_1cl_html_a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6"><div class="ttname"><a href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">llvm::cl::Hidden</a></div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l00109">CommandLine.h:109</a></div></div>
<div class="ttc" id="classllvm_1_1GlobalAddressSDNode_html"><div class="ttname"><a href="classllvm_1_1GlobalAddressSDNode.html">llvm::GlobalAddressSDNode</a></div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l01313">SelectionDAGNodes.h:1313</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110a71640703ec096a8b07111e85cfff6987"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a71640703ec096a8b07111e85cfff6987">llvm::ISD::FP_TO_UINT</a></div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00380">ISDOpcodes.h:380</a></div></div>
<div class="ttc" id="classllvm_1_1MemSDNode_html_a90e167cf9e2716b28452b40772c8db5a"><div class="ttname"><a href="classllvm_1_1MemSDNode.html#a90e167cf9e2716b28452b40772c8db5a">llvm::MemSDNode::getSrcValueOffset</a></div><div class="ttdeci">int64_t getSrcValueOffset() const </div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l01021">SelectionDAGNodes.h:1021</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110add33c0ae9a63902e573fc1f92fc33f1c"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110add33c0ae9a63902e573fc1f92fc33f1c">llvm::ISD::CTLZ</a></div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00309">ISDOpcodes.h:309</a></div></div>
<div class="ttc" id="classllvm_1_1ShuffleVectorSDNode_html"><div class="ttname"><a href="classllvm_1_1ShuffleVectorSDNode.html">llvm::ShuffleVectorSDNode</a></div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l01205">SelectionDAGNodes.h:1205</a></div></div>
<div class="ttc" id="classllvm_1_1ConstantSDNode_html_aa5c86745e9f101eabafef104239b9677"><div class="ttname"><a href="classllvm_1_1ConstantSDNode.html#aa5c86745e9f101eabafef104239b9677">llvm::ConstantSDNode::isAllOnesValue</a></div><div class="ttdeci">bool isAllOnesValue() const </div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l01262">SelectionDAGNodes.h:1262</a></div></div>
<div class="ttc" id="classllvm_1_1TargetLoweringBase_html_a9c8b7aaed941ee853da98aafd6739af6"><div class="ttname"><a href="classllvm_1_1TargetLoweringBase.html#a9c8b7aaed941ee853da98aafd6739af6">llvm::TargetLoweringBase::isIndexedLoadLegal</a></div><div class="ttdeci">bool isIndexedLoadLegal(unsigned IdxMode, EVT VT) const </div><div class="ttdoc">Return true if the specified indexed load is legal on this target. </div><div class="ttdef"><b>Definition:</b> <a href="TargetLowering_8h_source.html#l00505">TargetLowering.h:505</a></div></div>
<div class="ttc" id="structllvm_1_1TargetLowering_1_1TargetLoweringOpt_html"><div class="ttname"><a href="structllvm_1_1TargetLowering_1_1TargetLoweringOpt.html">llvm::TargetLowering::TargetLoweringOpt</a></div><div class="ttdef"><b>Definition:</b> <a href="TargetLowering_8h_source.html#l01771">TargetLowering.h:1771</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_ad4d48171b87ca51ff54c10a436bac4d7afab3fffd153f7d7770fed81272e4b78f"><div class="ttname"><a href="namespacellvm_1_1ISD.html#ad4d48171b87ca51ff54c10a436bac4d7afab3fffd153f7d7770fed81272e4b78f">llvm::ISD::EXTLOAD</a></div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00699">ISDOpcodes.h:699</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110a3a874f66e1efe5be79552bbe7ee3121a"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a3a874f66e1efe5be79552bbe7ee3121a">llvm::ISD::SDIVREM</a></div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00185">ISDOpcodes.h:185</a></div></div>
<div class="ttc" id="classllvm_1_1APInt_html_a0e9a2d7ec903d191ef029589ec647cb6"><div class="ttname"><a href="classllvm_1_1APInt.html#a0e9a2d7ec903d191ef029589ec647cb6">llvm::APInt::isNegative</a></div><div class="ttdeci">bool isNegative() const </div><div class="ttdoc">Determine sign of this APInt. </div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l00322">APInt.h:322</a></div></div>
<div class="ttc" id="classllvm_1_1SelectionDAG_html_ab8395be5698f080c0036d866e121a478"><div class="ttname"><a href="classllvm_1_1SelectionDAG.html#ab8395be5698f080c0036d866e121a478">llvm::SelectionDAG::getLoad</a></div><div class="ttdeci">SDValue getLoad(EVT VT, SDLoc dl, SDValue Chain, SDValue Ptr, MachinePointerInfo PtrInfo, bool isVolatile, bool isNonTemporal, bool isInvariant, unsigned Alignment, const MDNode *TBAAInfo=0, const MDNode *Ranges=0)</div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAG_8cpp_source.html#l04565">SelectionDAG.cpp:4565</a></div></div>
<div class="ttc" id="classllvm_1_1ConstantSDNode_html_a702de70a3d9e57c3ffe65bc3fab3e087"><div class="ttname"><a href="classllvm_1_1ConstantSDNode.html#a702de70a3d9e57c3ffe65bc3fab3e087">llvm::ConstantSDNode::isNullValue</a></div><div class="ttdeci">bool isNullValue() const </div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l01261">SelectionDAGNodes.h:1261</a></div></div>
<div class="ttc" id="structllvm_1_1EVT_html_a73f7c824cad61a47c21bf6d652ae2fd7"><div class="ttname"><a href="structllvm_1_1EVT.html#a73f7c824cad61a47c21bf6d652ae2fd7">llvm::EVT::isVector</a></div><div class="ttdeci">bool isVector() const </div><div class="ttdoc">isVector - Return true if this is a vector value type. </div><div class="ttdef"><b>Definition:</b> <a href="ValueTypes_8h_source.html#l00661">ValueTypes.h:661</a></div></div>
<div class="ttc" id="namespacellvm_1_1FPOpFusion_html_a9c71bae9f02af273833fde586d529fc5aa9dfaae1f5b7d4ebb31ccf9aee1aacce"><div class="ttname"><a href="namespacellvm_1_1FPOpFusion.html#a9c71bae9f02af273833fde586d529fc5aa9dfaae1f5b7d4ebb31ccf9aee1aacce">llvm::FPOpFusion::Fast</a></div><div class="ttdef"><b>Definition:</b> <a href="TargetOptions_8h_source.html#l00035">TargetOptions.h:35</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_ac174dc465cbe0e04a0f5e41c0a422124"><div class="ttname"><a href="namespacellvm_1_1ISD.html#ac174dc465cbe0e04a0f5e41c0a422124">llvm::ISD::isSEXTLoad</a></div><div class="ttdeci">bool isSEXTLoad(const SDNode *N)</div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l01908">SelectionDAGNodes.h:1908</a></div></div>
<div class="ttc" id="Target_2README_8txt_html_a3217063f680fa8e35dea3c59b6e52b18"><div class="ttname"><a href="Target_2README_8txt.html#a3217063f680fa8e35dea3c59b6e52b18">int</a></div><div class="ttdeci">Clang compiles this i1 i64 store i64 i64 store i64 i64 store i64 i64 store i64 align Which gets codegen d xmm0 movaps rbp movaps rbp movaps rbp movaps rbp rbp rbp rbp rbp It would be better to have movq s of instead of the movaps s LLVM produces ret int</div><div class="ttdef"><b>Definition:</b> <a href="Target_2README_8txt_source.html#l00549">Target/README.txt:549</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_ac3c3cf58d6d631af6a172457304d3d07a2887cc8b39915a25180f4bca0026a15e"><div class="ttname"><a href="namespacellvm_1_1ISD.html#ac3c3cf58d6d631af6a172457304d3d07a2887cc8b39915a25180f4bca0026a15e">llvm::ISD::SETNE</a></div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00744">ISDOpcodes.h:744</a></div></div>
<div class="ttc" id="classllvm_1_1APFloat_html_a26f3c979ec46a5d2d9bccd300eb606fea3a561d1750cb3c30d5deb1193c8e1ec5"><div class="ttname"><a href="classllvm_1_1APFloat.html#a26f3c979ec46a5d2d9bccd300eb606fea3a561d1750cb3c30d5deb1193c8e1ec5">llvm::APFloat::rmNearestTiesToEven</a></div><div class="ttdef"><b>Definition:</b> <a href="APFloat_8h_source.html#l00156">APFloat.h:156</a></div></div>
<div class="ttc" id="classllvm_1_1TargetLoweringBase_html_a7fe87806292e4bb35d59a51930f3ae0e"><div class="ttname"><a href="classllvm_1_1TargetLoweringBase.html#a7fe87806292e4bb35d59a51930f3ae0e">llvm::TargetLoweringBase::isLittleEndian</a></div><div class="ttdeci">bool isLittleEndian() const </div><div class="ttdef"><b>Definition:</b> <a href="TargetLowering_8h_source.html#l00150">TargetLowering.h:150</a></div></div>
<div class="ttc" id="MachineFunction_8h_html"><div class="ttname"><a href="MachineFunction_8h.html">MachineFunction.h</a></div></div>
<div class="ttc" id="namespacellvm_1_1RegState_html_a079b254e749130fbe5d740f314ca92daab502f975742e9bff6d6dd7b49439b806"><div class="ttname"><a href="namespacellvm_1_1RegState.html#a079b254e749130fbe5d740f314ca92daab502f975742e9bff6d6dd7b49439b806">llvm::RegState::Undef</a></div><div class="ttdef"><b>Definition:</b> <a href="MachineInstrBuilder_8h_source.html#l00035">MachineInstrBuilder.h:35</a></div></div>
<div class="ttc" id="classllvm_1_1AttributeSet_html"><div class="ttname"><a href="classllvm_1_1AttributeSet.html">llvm::AttributeSet</a></div><div class="ttdef"><b>Definition:</b> <a href="Attributes_8h_source.html#l00202">Attributes.h:202</a></div></div>
<div class="ttc" id="namespacellvm_html_a8da28d982a3c20fa6e57d94df3059f03"><div class="ttname"><a href="namespacellvm.html#a8da28d982a3c20fa6e57d94df3059f03">llvm::CountTrailingOnes_64</a></div><div class="ttdeci">unsigned CountTrailingOnes_64(uint64_t Value)</div><div class="ttdef"><b>Definition:</b> <a href="MathExtras_8h_source.html#l00410">MathExtras.h:410</a></div></div>
<div class="ttc" id="classllvm_1_1MVT_html_afd69b4f2dff97a2d7c0192cc769ef50ca85440bbdbba12de574c02e515444d3f4"><div class="ttname"><a href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50ca85440bbdbba12de574c02e515444d3f4">llvm::MVT::i1</a></div><div class="ttdef"><b>Definition:</b> <a href="ValueTypes_8h_source.html#l00043">ValueTypes.h:43</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110a2ab6db512a611d1ef4ff8069e2bbfd0d"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a2ab6db512a611d1ef4ff8069e2bbfd0d">llvm::ISD::SUBC</a></div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00195">ISDOpcodes.h:195</a></div></div>
<div class="ttc" id="classllvm_1_1SelectionDAG_html_a2bdce1dfec3bab37c9a38e516eba42e7"><div class="ttname"><a href="classllvm_1_1SelectionDAG.html#a2bdce1dfec3bab37c9a38e516eba42e7">llvm::SelectionDAG::getStore</a></div><div class="ttdeci">SDValue getStore(SDValue Chain, SDLoc dl, SDValue Val, SDValue Ptr, MachinePointerInfo PtrInfo, bool isVolatile, bool isNonTemporal, unsigned Alignment, const MDNode *TBAAInfo=0)</div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAG_8cpp_source.html#l04618">SelectionDAG.cpp:4618</a></div></div>
<div class="ttc" id="structllvm_1_1EVT_html_af5afc8257ed5adc0f55be3a9f7587267"><div class="ttname"><a href="structllvm_1_1EVT.html#af5afc8257ed5adc0f55be3a9f7587267">llvm::EVT::isRound</a></div><div class="ttdeci">bool isRound() const </div><div class="ttdoc">isRound - Return true if the size is a power-of-two number of bytes. </div><div class="ttdef"><b>Definition:</b> <a href="ValueTypes_8h_source.html#l00711">ValueTypes.h:711</a></div></div>
<div class="ttc" id="namespacellvm_html_aa6d856e4879bb775617f8c3634773b7aabfb921bbd2fd66e0a6b7524eb4b3dd9f"><div class="ttname"><a href="namespacellvm.html#aa6d856e4879bb775617f8c3634773b7aabfb921bbd2fd66e0a6b7524eb4b3dd9f">llvm::AfterLegalizeTypes</a></div><div class="ttdef"><b>Definition:</b> <a href="DAGCombine_8h_source.html#l00018">DAGCombine.h:18</a></div></div>
<div class="ttc" id="classllvm_1_1TargetLowering_html_a23088f6e5065a437e6448022592ad85c"><div class="ttname"><a href="classllvm_1_1TargetLowering.html#a23088f6e5065a437e6448022592ad85c">llvm::TargetLowering::PerformDAGCombine</a></div><div class="ttdeci">virtual SDValue PerformDAGCombine(SDNode *N, DAGCombinerInfo &amp;DCI) const </div><div class="ttdef"><b>Definition:</b> <a href="TargetLowering_8cpp_source.html#l01932">TargetLowering.cpp:1932</a></div></div>
<div class="ttc" id="namespacellvm_html_aa6d856e4879bb775617f8c3634773b7aa9386e6e4a4c86dabf136bc0fc9f6cf3b"><div class="ttname"><a href="namespacellvm.html#aa6d856e4879bb775617f8c3634773b7aa9386e6e4a4c86dabf136bc0fc9f6cf3b">llvm::BeforeLegalizeTypes</a></div><div class="ttdef"><b>Definition:</b> <a href="DAGCombine_8h_source.html#l00017">DAGCombine.h:17</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110a8cc94e03dea594863073a02f5bb94997"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a8cc94e03dea594863073a02f5bb94997">llvm::ISD::SHL</a></div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00306">ISDOpcodes.h:306</a></div></div>
<div class="ttc" id="classllvm_1_1TargetLoweringBase_html_a62fd51d57f54699226813ca9b46c4d24"><div class="ttname"><a href="classllvm_1_1TargetLoweringBase.html#a62fd51d57f54699226813ca9b46c4d24">llvm::TargetLoweringBase::isLegalAddImmediate</a></div><div class="ttdeci">virtual bool isLegalAddImmediate(int64_t) const </div><div class="ttdef"><b>Definition:</b> <a href="TargetLowering_8h_source.html#l01165">TargetLowering.h:1165</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a308088c2d65f8f3955f5fb0f6aca7ccc"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a308088c2d65f8f3955f5fb0f6aca7ccc">llvm::ISD::isNormalStore</a></div><div class="ttdeci">bool isNormalStore(const SDNode *N)</div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l01929">SelectionDAGNodes.h:1929</a></div></div>
<div class="ttc" id="classllvm_1_1SmallVectorImpl_html_a400eaca9881c8dcab97e9f42b1ab1815"><div class="ttname"><a href="classllvm_1_1SmallVectorImpl.html#a400eaca9881c8dcab97e9f42b1ab1815">llvm::SmallVectorImpl::pop_back_val</a></div><div class="ttdeci">T LLVM_ATTRIBUTE_UNUSED_RESULT pop_back_val()</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00430">SmallVector.h:430</a></div></div>
<div class="ttc" id="classllvm_1_1AliasAnalysis_html_aa96743b70089c7a0ef5d935f34173826"><div class="ttname"><a href="classllvm_1_1AliasAnalysis.html#aa96743b70089c7a0ef5d935f34173826">llvm::AliasAnalysis::AliasResult</a></div><div class="ttdeci">AliasResult</div><div class="ttdef"><b>Definition:</b> <a href="AliasAnalysis_8h_source.html#l00161">AliasAnalysis.h:161</a></div></div>
<div class="ttc" id="classllvm_1_1LSBaseSDNode_html"><div class="ttname"><a href="classllvm_1_1LSBaseSDNode.html">llvm::LSBaseSDNode</a></div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l01675">SelectionDAGNodes.h:1675</a></div></div>
<div class="ttc" id="ErrorHandling_8h_html_ace243f5c25697a1107cce46626b3dc94"><div class="ttname"><a href="ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a></div><div class="ttdeci">#define llvm_unreachable(msg)</div><div class="ttdef"><b>Definition:</b> <a href="ErrorHandling_8h_source.html#l00103">ErrorHandling.h:103</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_aaac3e239cbdfe15a8e9bad4f8e1e3a95"><div class="ttname"><a href="namespacellvm_1_1ISD.html#aaac3e239cbdfe15a8e9bad4f8e1e3a95">llvm::ISD::isBuildVectorAllZeros</a></div><div class="ttdeci">bool isBuildVectorAllZeros(const SDNode *N)</div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAG_8cpp_source.html#l00145">SelectionDAG.cpp:145</a></div></div>
<div class="ttc" id="classllvm_1_1SDNode_html_aed0958deb6d25f9fdccd7518e26b50f8"><div class="ttname"><a href="classllvm_1_1SDNode.html#aed0958deb6d25f9fdccd7518e26b50f8">llvm::SDNode::getValueType</a></div><div class="ttdeci">EVT getValueType(unsigned ResNo) const </div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l00609">SelectionDAGNodes.h:609</a></div></div>
<div class="ttc" id="classllvm_1_1Use_html"><div class="ttname"><a href="classllvm_1_1Use.html">llvm::Use</a></div><div class="ttdef"><b>Definition:</b> <a href="Use_8h_source.html#l00060">Use.h:60</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110a3a257ffa49107e2db978e8a6e2688ada"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a3a257ffa49107e2db978e8a6e2688ada">llvm::ISD::UDIVREM</a></div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00185">ISDOpcodes.h:185</a></div></div>
<div class="ttc" id="classllvm_1_1SelectionDAG_html_a95d3f899fd68931ed5fa42e012468bdb"><div class="ttname"><a href="classllvm_1_1SelectionDAG.html#a95d3f899fd68931ed5fa42e012468bdb">llvm::SelectionDAG::getMachineFunction</a></div><div class="ttdeci">MachineFunction &amp; getMachineFunction() const </div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAG_8h_source.html#l00280">SelectionDAG.h:280</a></div></div>
<div class="ttc" id="classllvm_1_1SelectionDAG_html_a02ff977a0e8963fcbb3c448dcd3a81ea"><div class="ttname"><a href="classllvm_1_1SelectionDAG.html#a02ff977a0e8963fcbb3c448dcd3a81ea">llvm::SelectionDAG::isConsecutiveLoad</a></div><div class="ttdeci">bool isConsecutiveLoad(LoadSDNode *LD, LoadSDNode *Base, unsigned Bytes, int Dist) const </div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAG_8cpp_source.html#l06330">SelectionDAG.cpp:6330</a></div></div>
<div class="ttc" id="classllvm_1_1TargetOptions_html_ac63543526e222ba0596e421e21189a86"><div class="ttname"><a href="classllvm_1_1TargetOptions.html#ac63543526e222ba0596e421e21189a86">llvm::TargetOptions::HonorSignDependentRoundingFPMath</a></div><div class="ttdeci">bool HonorSignDependentRoundingFPMath() const </div><div class="ttdef"><b>Definition:</b> <a href="TargetOptionsImpl_8cpp_source.html#l00044">TargetOptionsImpl.cpp:44</a></div></div>
<div class="ttc" id="classllvm_1_1APInt_html_aa1953b3ad7ef6aa87dc0205db0c2ea45"><div class="ttname"><a href="classllvm_1_1APInt.html#aa1953b3ad7ef6aa87dc0205db0c2ea45">llvm::APInt::lshr</a></div><div class="ttdeci">APInt LLVM_ATTRIBUTE_UNUSED_RESULT lshr(unsigned shiftAmt) const </div><div class="ttdoc">Logical right-shift function. </div><div class="ttdef"><b>Definition:</b> <a href="APInt_8cpp_source.html#l01127">APInt.cpp:1127</a></div></div>
<div class="ttc" id="classllvm_1_1TargetLoweringBase_html_a6bae2f7f49a5438c150cbd4cbdda11f9"><div class="ttname"><a href="classllvm_1_1TargetLoweringBase.html#a6bae2f7f49a5438c150cbd4cbdda11f9">llvm::TargetLoweringBase::getSetCCResultType</a></div><div class="ttdeci">virtual EVT getSetCCResultType(LLVMContext &amp;Context, EVT VT) const </div><div class="ttdef"><b>Definition:</b> <a href="TargetLoweringBase_8cpp_source.html#l01096">TargetLoweringBase.cpp:1096</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110a41bd84b853e2c03fb1af1f4ca9ebdcaf"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a41bd84b853e2c03fb1af1f4ca9ebdcaf">llvm::ISD::BUILD_PAIR</a></div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00166">ISDOpcodes.h:166</a></div></div>
<div class="ttc" id="classllvm_1_1SmallVectorImpl_html"><div class="ttname"><a href="classllvm_1_1SmallVectorImpl.html">llvm::SmallVectorImpl</a></div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l00035">APInt.h:35</a></div></div>
<div class="ttc" id="MachineFrameInfo_8h_html"><div class="ttname"><a href="MachineFrameInfo_8h.html">MachineFrameInfo.h</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110a93bc27ca4d9e211c54b0d9efb660f080"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a93bc27ca4d9e211c54b0d9efb660f080">llvm::ISD::CopyToReg</a></div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00146">ISDOpcodes.h:146</a></div></div>
<div class="ttc" id="classllvm_1_1TargetRegisterClass_html"><div class="ttname"><a href="classllvm_1_1TargetRegisterClass.html">llvm::TargetRegisterClass</a></div><div class="ttdef"><b>Definition:</b> <a href="TargetRegisterInfo_8h_source.html#l00036">TargetRegisterInfo.h:36</a></div></div>
<div class="ttc" id="namespacellvm_1_1APIntOps_html_a4a8fe7a278424a14cecbea8b3cbaef5d"><div class="ttname"><a href="namespacellvm_1_1APIntOps.html#a4a8fe7a278424a14cecbea8b3cbaef5d">llvm::APIntOps::logBase2</a></div><div class="ttdeci">unsigned logBase2(const APInt &amp;APIVal)</div><div class="ttdoc">Returns the floor log base 2 of the specified APInt value. </div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l01732">APInt.h:1732</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110ac9246c101c0cc9232e37b3941194bb13"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ac9246c101c0cc9232e37b3941194bb13">llvm::ISD::SUBE</a></div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00204">ISDOpcodes.h:204</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a35edacef22fcaed7a8681fa573476131"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a35edacef22fcaed7a8681fa573476131">llvm::ISD::isZEXTLoad</a></div><div class="ttdeci">bool isZEXTLoad(const SDNode *N)</div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l01915">SelectionDAGNodes.h:1915</a></div></div>
<div class="ttc" id="structllvm_1_1MachinePointerInfo_html_aa7b903b38006dd4cb8fcf8854af5b6b9"><div class="ttname"><a href="structllvm_1_1MachinePointerInfo.html#aa7b903b38006dd4cb8fcf8854af5b6b9">llvm::MachinePointerInfo::getWithOffset</a></div><div class="ttdeci">MachinePointerInfo getWithOffset(int64_t O) const </div><div class="ttdef"><b>Definition:</b> <a href="MachineMemOperand_8h_source.html#l00044">MachineMemOperand.h:44</a></div></div>
<div class="ttc" id="classllvm_1_1AliasAnalysis_html"><div class="ttname"><a href="classllvm_1_1AliasAnalysis.html">llvm::AliasAnalysis</a></div><div class="ttdef"><b>Definition:</b> <a href="AliasAnalysis_8h_source.html#l00056">AliasAnalysis.h:56</a></div></div>
<div class="ttc" id="structllvm_1_1EVT_html_a15be9767d0aad93fe5dcb60b7b7a78da"><div class="ttname"><a href="structllvm_1_1EVT.html#a15be9767d0aad93fe5dcb60b7b7a78da">llvm::EVT::getScalarType</a></div><div class="ttdeci">EVT getScalarType() const </div><div class="ttdef"><b>Definition:</b> <a href="ValueTypes_8h_source.html#l00756">ValueTypes.h:756</a></div></div>
<div class="ttc" id="classllvm_1_1MachineFrameInfo_html"><div class="ttname"><a href="classllvm_1_1MachineFrameInfo.html">llvm::MachineFrameInfo</a></div><div class="ttdoc">Abstract Stack Frame Information. </div><div class="ttdef"><b>Definition:</b> <a href="MachineFrameInfo_8h_source.html#l00080">MachineFrameInfo.h:80</a></div></div>
<div class="ttc" id="ErrorHandling_8h_html"><div class="ttname"><a href="ErrorHandling_8h.html">ErrorHandling.h</a></div></div>
<div class="ttc" id="classllvm_1_1AliasAnalysis_html_aa96743b70089c7a0ef5d935f34173826a43c7577d5f7b09c310e42a6ab471610b"><div class="ttname"><a href="classllvm_1_1AliasAnalysis.html#aa96743b70089c7a0ef5d935f34173826a43c7577d5f7b09c310e42a6ab471610b">llvm::AliasAnalysis::NoAlias</a></div><div class="ttdoc">No dependencies. </div><div class="ttdef"><b>Definition:</b> <a href="AliasAnalysis_8h_source.html#l00162">AliasAnalysis.h:162</a></div></div>
<div class="ttc" id="classllvm_1_1SelectionDAG_html_a21c371ac00fe037f24e3f48cb62d2048"><div class="ttname"><a href="classllvm_1_1SelectionDAG.html#a21c371ac00fe037f24e3f48cb62d2048">llvm::SelectionDAG::allnodes_end</a></div><div class="ttdeci">allnodes_const_iterator allnodes_end() const </div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAG_8h_source.html#l00318">SelectionDAG.h:318</a></div></div>
<div class="ttc" id="namespacefalse_html"><div class="ttname"><a href="namespacefalse.html">false</a></div><div class="ttdef"><b>Definition:</b> <a href="StackSlotColoring_8cpp_source.html#l00126">StackSlotColoring.cpp:126</a></div></div>
<div class="ttc" id="structllvm_1_1EVT_html_a7027dbab36b90c5ccc2a34323c41bdfe"><div class="ttname"><a href="structllvm_1_1EVT.html#a7027dbab36b90c5ccc2a34323c41bdfe">llvm::EVT::bitsGE</a></div><div class="ttdeci">bool bitsGE(EVT VT) const </div><div class="ttdoc">bitsGE - Return true if this has no less bits than VT. </div><div class="ttdef"><b>Definition:</b> <a href="ValueTypes_8h_source.html#l00729">ValueTypes.h:729</a></div></div>
<div class="ttc" id="classllvm_1_1SelectionDAG_html_af50a5a79c7e192fa4ee098033d8246ac"><div class="ttname"><a href="classllvm_1_1SelectionDAG.html#af50a5a79c7e192fa4ee098033d8246ac">llvm::SelectionDAG::getNodeIfExists</a></div><div class="ttdeci">SDNode * getNodeIfExists(unsigned Opcode, SDVTList VTs, const SDValue *Ops, unsigned NumOps)</div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAG_8cpp_source.html#l05594">SelectionDAG.cpp:5594</a></div></div>
<div class="ttc" id="classllvm_1_1ShuffleVectorSDNode_html_aae5468704c119f87dceb6728814b5502"><div class="ttname"><a href="classllvm_1_1ShuffleVectorSDNode.html#aae5468704c119f87dceb6728814b5502">llvm::ShuffleVectorSDNode::getMaskElt</a></div><div class="ttdeci">int getMaskElt(unsigned Idx) const </div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l01224">SelectionDAGNodes.h:1224</a></div></div>
<div class="ttc" id="classllvm_1_1TargetLoweringBase_html_a2824c264a25f2f03586588c7020b7a5d"><div class="ttname"><a href="classllvm_1_1TargetLoweringBase.html#a2824c264a25f2f03586588c7020b7a5d">llvm::TargetLoweringBase::getPointerTy</a></div><div class="ttdeci">virtual MVT getPointerTy(uint32_t=0) const </div><div class="ttdef"><b>Definition:</b> <a href="TargetLoweringBase_8cpp_source.html#l00797">TargetLoweringBase.cpp:797</a></div></div>
<div class="ttc" id="namespacellvm_html_a85acbc71797c5df4b82f6c527ff9ad1a"><div class="ttname"><a href="namespacellvm.html#a85acbc71797c5df4b82f6c527ff9ad1a">llvm::countLeadingZeros</a></div><div class="ttdeci">enable_if_c&lt; std::numeric_limits&lt; T &gt;::is_integer &amp;&amp;!std::numeric_limits&lt; T &gt;::is_signed, std::size_t &gt;::type countLeadingZeros(T Val, ZeroBehavior ZB=ZB_Width)</div><div class="ttdoc">Count number of 0&amp;#39;s from the most significant bit to the least stopping at the first 1...</div><div class="ttdef"><b>Definition:</b> <a href="MathExtras_8h_source.html#l00120">MathExtras.h:120</a></div></div>
<div class="ttc" id="classllvm_1_1TargetLowering_html_a8a9fc84a7385e8d42a0994df86eb50ec"><div class="ttname"><a href="classllvm_1_1TargetLowering.html#a8a9fc84a7385e8d42a0994df86eb50ec">llvm::TargetLowering::SimplifySetCC</a></div><div class="ttdeci">SDValue SimplifySetCC(EVT VT, SDValue N0, SDValue N1, ISD::CondCode Cond, bool foldBooleans, DAGCombinerInfo &amp;DCI, SDLoc dl) const </div><div class="ttdef"><b>Definition:</b> <a href="TargetLowering_8cpp_source.html#l01121">TargetLowering.cpp:1121</a></div></div>
<div class="ttc" id="classllvm_1_1TargetLowering_html"><div class="ttname"><a href="classllvm_1_1TargetLowering.html">llvm::TargetLowering</a></div><div class="ttdef"><b>Definition:</b> <a href="TargetLowering_8h_source.html#l01695">TargetLowering.h:1695</a></div></div>
<div class="ttc" id="MD5_8cpp_html_ad96b7cf3182ce2ba85e5a7a93b12c441"><div class="ttname"><a href="MD5_8cpp.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a></div><div class="ttdeci">#define G(x, y, z)</div><div class="ttdef"><b>Definition:</b> <a href="MD5_8cpp_source.html#l00052">MD5.cpp:52</a></div></div>
<div class="ttc" id="structllvm_1_1EVT_html_a8cc407ac00df4edd4ec4d5168d6ecb26"><div class="ttname"><a href="structllvm_1_1EVT.html#a8cc407ac00df4edd4ec4d5168d6ecb26">llvm::EVT::isInteger</a></div><div class="ttdeci">bool isInteger() const </div><div class="ttdoc">isInteger - Return true if this is an integer, or a vector integer type. </div><div class="ttdef"><b>Definition:</b> <a href="ValueTypes_8h_source.html#l00656">ValueTypes.h:656</a></div></div>
<div class="ttc" id="classllvm_1_1APInt_html_ac8be1ee0c47d9e47e567fa353f987ed5"><div class="ttname"><a href="classllvm_1_1APInt.html#ac8be1ee0c47d9e47e567fa353f987ed5">llvm::APInt::getBoolValue</a></div><div class="ttdeci">bool getBoolValue() const </div><div class="ttdoc">Convert APInt to a boolean value. </div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l00404">APInt.h:404</a></div></div>
<div class="ttc" id="classllvm_1_1SelectionDAG_html_a268e5bc7dd40a28712a33ca6c9c91c6f"><div class="ttname"><a href="classllvm_1_1SelectionDAG.html#a268e5bc7dd40a28712a33ca6c9c91c6f">llvm::SelectionDAG::getConstantFP</a></div><div class="ttdeci">SDValue getConstantFP(double Val, EVT VT, bool isTarget=false)</div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAG_8cpp_source.html#l01108">SelectionDAG.cpp:1108</a></div></div>
<div class="ttc" id="namespacellvm_1_1APIntOps_html_a75a71c5acb58449ea8a731e9caebf1fe"><div class="ttname"><a href="namespacellvm_1_1APIntOps.html#a75a71c5acb58449ea8a731e9caebf1fe">llvm::APIntOps::lshr</a></div><div class="ttdeci">APInt lshr(const APInt &amp;LHS, unsigned shiftAmt)</div><div class="ttdoc">Logical right-shift function. </div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l01790">APInt.h:1790</a></div></div>
<div class="ttc" id="structllvm_1_1EVT_html_a3a07c062cc9330acd8e8c4e3930cbb25"><div class="ttname"><a href="structllvm_1_1EVT.html#a3a07c062cc9330acd8e8c4e3930cbb25">llvm::EVT::getVectorElementType</a></div><div class="ttdeci">EVT getVectorElementType() const </div><div class="ttdef"><b>Definition:</b> <a href="ValueTypes_8h_source.html#l00762">ValueTypes.h:762</a></div></div>
<div class="ttc" id="classllvm_1_1TargetLowering_html_af5b4e842b91ce6dce0e96ea576ef8517"><div class="ttname"><a href="classllvm_1_1TargetLowering.html#af5b4e842b91ce6dce0e96ea576ef8517">llvm::TargetLowering::getPostIndexedAddressParts</a></div><div class="ttdeci">virtual bool getPostIndexedAddressParts(SDNode *, SDNode *, SDValue &amp;, SDValue &amp;, ISD::MemIndexedMode &amp;, SelectionDAG &amp;) const </div><div class="ttdef"><b>Definition:</b> <a href="TargetLowering_8h_source.html#l01717">TargetLowering.h:1717</a></div></div>
<div class="ttc" id="classllvm_1_1ConstantFPSDNode_html"><div class="ttname"><a href="classllvm_1_1ConstantFPSDNode.html">llvm::ConstantFPSDNode</a></div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l01270">SelectionDAGNodes.h:1270</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110abc6c09c7af98236460f0b020eb3be94e"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110abc6c09c7af98236460f0b020eb3be94e">llvm::ISD::FDIV</a></div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00222">ISDOpcodes.h:222</a></div></div>
<div class="ttc" id="DAGCombiner_8cpp_html_a2ca1d07b97e41f047418b6428ce0f31d"><div class="ttname"><a href="DAGCombiner_8cpp.html#a2ca1d07b97e41f047418b6428ce0f31d">STATISTIC</a></div><div class="ttdeci">STATISTIC(NodesCombined,&quot;Number of dag nodes combined&quot;)</div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110a315004656a75a3c3a9d7294f105a8da2"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a315004656a75a3c3a9d7294f105a8da2">llvm::ISD::SINT_TO_FP</a></div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00367">ISDOpcodes.h:367</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110a7800622851751b8ae318b41f4096830e"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7800622851751b8ae318b41f4096830e">llvm::ISD::UMULO</a></div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00219">ISDOpcodes.h:219</a></div></div>
<div class="ttc" id="Target_2README_8txt_html_a8db36c82f32d6f6a4d35a00e55be03a8"><div class="ttname"><a href="Target_2README_8txt.html#a8db36c82f32d6f6a4d35a00e55be03a8">Shift</a></div><div class="ttdeci">bool Shift</div><div class="ttdef"><b>Definition:</b> <a href="Target_2README_8txt_source.html#l00506">Target/README.txt:506</a></div></div>
<div class="ttc" id="classllvm_1_1SDNode_html_ab319fc51db27ec95fd50a910c7ccec94"><div class="ttname"><a href="classllvm_1_1SDNode.html#ab319fc51db27ec95fd50a910c7ccec94">llvm::SDNode::getNumValues</a></div><div class="ttdeci">unsigned getNumValues() const </div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l00605">SelectionDAGNodes.h:605</a></div></div>
<div class="ttc" id="classllvm_1_1SmallVectorBase_html_a8a8df4d85555c7954a95f86080cd3b64"><div class="ttname"><a href="classllvm_1_1SmallVectorBase.html#a8a8df4d85555c7954a95f86080cd3b64">llvm::SmallVectorBase::empty</a></div><div class="ttdeci">bool LLVM_ATTRIBUTE_UNUSED_RESULT empty() const </div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00056">SmallVector.h:56</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110ab0b7d2c769fd0fbaab3c4a2fc8e7ea0c"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ab0b7d2c769fd0fbaab3c4a2fc8e7ea0c">llvm::ISD::VSELECT</a></div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00325">ISDOpcodes.h:325</a></div></div>
<div class="ttc" id="namespacellvm_html_abdaf1eaf6120421977095bd97eee892e"><div class="ttname"><a href="namespacellvm.html#abdaf1eaf6120421977095bd97eee892e">llvm::countTrailingZeros</a></div><div class="ttdeci">enable_if_c&lt; std::numeric_limits&lt; T &gt;::is_integer &amp;&amp;!std::numeric_limits&lt; T &gt;::is_signed, std::size_t &gt;::type countTrailingZeros(T Val, ZeroBehavior ZB=ZB_Width)</div><div class="ttdoc">Count number of 0&amp;#39;s from the least significant bit to the most stopping at the first 1...</div><div class="ttdef"><b>Definition:</b> <a href="MathExtras_8h_source.html#l00049">MathExtras.h:49</a></div></div>
<div class="ttc" id="structllvm_1_1TargetLowering_1_1DAGCombinerInfo_html_a00151b714ce26a44b0c8288bf93696cf"><div class="ttname"><a href="structllvm_1_1TargetLowering_1_1DAGCombinerInfo.html#a00151b714ce26a44b0c8288bf93696cf">llvm::TargetLowering::DAGCombinerInfo::CombineTo</a></div><div class="ttdeci">SDValue CombineTo(SDNode *N, const std::vector&lt; SDValue &gt; &amp;To, bool AddTo=true)</div><div class="ttdef"><b>Definition:</b> <a href="DAGCombiner_8cpp_source.html#l00400">DAGCombiner.cpp:400</a></div></div>
<div class="ttc" id="namespacellvm_1_1CodeGenOpt_html_a411055ea15209051c2370bbf655ec8d4"><div class="ttname"><a href="namespacellvm_1_1CodeGenOpt.html#a411055ea15209051c2370bbf655ec8d4">llvm::CodeGenOpt::Level</a></div><div class="ttdeci">Level</div><div class="ttdef"><b>Definition:</b> <a href="CodeGen_8h_source.html#l00045">CodeGen.h:45</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110a269996b43a1f3e1d1f84a70fd4387535"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a269996b43a1f3e1d1f84a70fd4387535">llvm::ISD::ADD</a></div><div class="ttdoc">Simple integer binary arithmetic operators. </div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00176">ISDOpcodes.h:176</a></div></div>
<div class="ttc" id="classllvm_1_1SelectionDAG_html_a819041d6f932a577122acfff723fe4af"><div class="ttname"><a href="classllvm_1_1SelectionDAG.html#a819041d6f932a577122acfff723fe4af">llvm::SelectionDAG::getVectorShuffle</a></div><div class="ttdeci">SDValue getVectorShuffle(EVT VT, SDLoc dl, SDValue N1, SDValue N2, const int *MaskElts)</div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAG_8cpp_source.html#l01351">SelectionDAG.cpp:1351</a></div></div>
<div class="ttc" id="SmallPtrSet_8h_html"><div class="ttname"><a href="SmallPtrSet_8h.html">SmallPtrSet.h</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_ac3c3cf58d6d631af6a172457304d3d07a6f05a09edb671910f85f8665981cbde9"><div class="ttname"><a href="namespacellvm_1_1ISD.html#ac3c3cf58d6d631af6a172457304d3d07a6f05a09edb671910f85f8665981cbde9">llvm::ISD::SETLT</a></div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00742">ISDOpcodes.h:742</a></div></div>
<div class="ttc" id="classllvm_1_1MVT_html_afd69b4f2dff97a2d7c0192cc769ef50ca04cca8bc12888d0a7238f55a6c550ad0"><div class="ttname"><a href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50ca04cca8bc12888d0a7238f55a6c550ad0">llvm::MVT::i32</a></div><div class="ttdef"><b>Definition:</b> <a href="ValueTypes_8h_source.html#l00046">ValueTypes.h:46</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110a15637879021fa7d5226045c0668a99a8"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a15637879021fa7d5226045c0668a99a8">llvm::ISD::UDIV</a></div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00176">ISDOpcodes.h:176</a></div></div>
<div class="ttc" id="classllvm_1_1APInt_html_a65eb40bd8c732c997e156e14f6b461f4"><div class="ttname"><a href="classllvm_1_1APInt.html#a65eb40bd8c732c997e156e14f6b461f4">llvm::APInt::getActiveBits</a></div><div class="ttdeci">unsigned getActiveBits() const </div><div class="ttdoc">Compute the number of active bits in the value. </div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l01276">APInt.h:1276</a></div></div>
<div class="ttc" id="classllvm_1_1StoreSDNode_html_aec453733fbb9f24036960fdc6b3b4b46"><div class="ttname"><a href="classllvm_1_1StoreSDNode.html#aec453733fbb9f24036960fdc6b3b4b46">llvm::StoreSDNode::getBasePtr</a></div><div class="ttdeci">const SDValue &amp; getBasePtr() const </div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l01769">SelectionDAGNodes.h:1769</a></div></div>
<div class="ttc" id="classllvm_1_1SelectionDAG_html_a5b0e59823444a55c295af279611a9d24"><div class="ttname"><a href="classllvm_1_1SelectionDAG.html#a5b0e59823444a55c295af279611a9d24">llvm::SelectionDAG::getUNDEF</a></div><div class="ttdeci">SDValue getUNDEF(EVT VT)</div><div class="ttdoc">getUNDEF - Return an UNDEF node. UNDEF does not have a useful SDLoc. </div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAG_8h_source.html#l00585">SelectionDAG.h:585</a></div></div>
<div class="ttc" id="DAGCombiner_8cpp_html_a000e05d8e2f060e7854793e6e9a52190"><div class="ttname"><a href="DAGCombiner_8cpp.html#a000e05d8e2f060e7854793e6e9a52190">isConstantSplatVector</a></div><div class="ttdeci">static bool isConstantSplatVector(SDNode *N, APInt &amp;SplatValue)</div><div class="ttdef"><b>Definition:</b> <a href="DAGCombiner_8cpp_source.html#l01783">DAGCombiner.cpp:1783</a></div></div>
<div class="ttc" id="structConsecutiveMemoryChainSorter_html"><div class="ttname"><a href="structConsecutiveMemoryChainSorter.html">ConsecutiveMemoryChainSorter</a></div><div class="ttdoc">Sorts store nodes in a link according to their offset from a shared. </div><div class="ttdef"><b>Definition:</b> <a href="DAGCombiner_8cpp_source.html#l08548">DAGCombiner.cpp:8548</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_ac3c3cf58d6d631af6a172457304d3d07"><div class="ttname"><a href="namespacellvm_1_1ISD.html#ac3c3cf58d6d631af6a172457304d3d07">llvm::ISD::CondCode</a></div><div class="ttdeci">CondCode</div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00719">ISDOpcodes.h:719</a></div></div>
<div class="ttc" id="classllvm_1_1ConstantSDNode_html_a7951626d3fc3c89c4efee59ed9c3d8bf"><div class="ttname"><a href="classllvm_1_1ConstantSDNode.html#a7951626d3fc3c89c4efee59ed9c3d8bf">llvm::ConstantSDNode::getAPIntValue</a></div><div class="ttdeci">const APInt &amp; getAPIntValue() const </div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l01256">SelectionDAGNodes.h:1256</a></div></div>
<div class="ttc" id="classllvm_1_1TargetLoweringBase_html_ad85f712b9e49629c2c160f16521fe91f"><div class="ttname"><a href="classllvm_1_1TargetLoweringBase.html#ad85f712b9e49629c2c160f16521fe91f">llvm::TargetLoweringBase::isLoadExtLegal</a></div><div class="ttdeci">bool isLoadExtLegal(unsigned ExtType, EVT VT) const </div><div class="ttdoc">Return true if the specified load with extension is legal on this target. </div><div class="ttdef"><b>Definition:</b> <a href="TargetLowering_8h_source.html#l00471">TargetLowering.h:471</a></div></div>
<div class="ttc" id="classllvm_1_1APInt_html_a45266d6f33cd3d34f75842ddf4029a9d"><div class="ttname"><a href="classllvm_1_1APInt.html#a45266d6f33cd3d34f75842ddf4029a9d">llvm::APInt::shl</a></div><div class="ttdeci">APInt LLVM_ATTRIBUTE_UNUSED_RESULT shl(unsigned shiftAmt) const </div><div class="ttdoc">Left-shift function. </div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l00856">APInt.h:856</a></div></div>
<div class="ttc" id="classllvm_1_1TargetLowering_html_afe39ddd0add24d96bfbbb2b3ab3df3de"><div class="ttname"><a href="classllvm_1_1TargetLowering.html#afe39ddd0add24d96bfbbb2b3ab3df3de">llvm::TargetLowering::isDesirableToTransformToIntegerOp</a></div><div class="ttdeci">virtual bool isDesirableToTransformToIntegerOp(unsigned, EVT) const </div><div class="ttdef"><b>Definition:</b> <a href="TargetLowering_8h_source.html#l01894">TargetLowering.h:1894</a></div></div>
<div class="ttc" id="classllvm_1_1MemSDNode_html_a7cead3a2a7771e61083bcc6959915a13"><div class="ttname"><a href="classllvm_1_1MemSDNode.html#a7cead3a2a7771e61083bcc6959915a13">llvm::MemSDNode::getMemoryVT</a></div><div class="ttdeci">EVT getMemoryVT() const </div><div class="ttdoc">getMemoryVT - Return the type of the in-memory value. </div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l01030">SelectionDAGNodes.h:1030</a></div></div>
<div class="ttc" id="classllvm_1_1TargetLowering_html_a84124dc2319e755656a9d117239ef46a"><div class="ttname"><a href="classllvm_1_1TargetLowering.html#a84124dc2319e755656a9d117239ef46a">llvm::TargetLowering::BuildSDIV</a></div><div class="ttdeci">SDValue BuildSDIV(SDNode *N, SelectionDAG &amp;DAG, bool IsAfterLegalization, std::vector&lt; SDNode * &gt; *Created) const </div><div class="ttdoc">Given an ISD::SDIV node expressing a divide by constant, return a DAG expression to select that will ...</div><div class="ttdef"><b>Definition:</b> <a href="TargetLowering_8cpp_source.html#l02541">TargetLowering.cpp:2541</a></div></div>
<div class="ttc" id="MathExtras_8h_html"><div class="ttname"><a href="MathExtras_8h.html">MathExtras.h</a></div></div>
<div class="ttc" id="classllvm_1_1ConstantSDNode_html_ac27741dc62185494433dec7a5f723f70"><div class="ttname"><a href="classllvm_1_1ConstantSDNode.html#ac27741dc62185494433dec7a5f723f70">llvm::ConstantSDNode::isOne</a></div><div class="ttdeci">bool isOne() const </div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l01260">SelectionDAGNodes.h:1260</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_aae86ddfa346964171caa61f29d46294b"><div class="ttname"><a href="namespacellvm_1_1ISD.html#aae86ddfa346964171caa61f29d46294b">llvm::ISD::isSignedIntSetCC</a></div><div class="ttdeci">bool isSignedIntSetCC(CondCode Code)</div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00752">ISDOpcodes.h:752</a></div></div>
<div class="ttc" id="classllvm_1_1TargetLoweringBase_html_a867f81380094404dbe04ed9b7bc26a99"><div class="ttname"><a href="classllvm_1_1TargetLoweringBase.html#a867f81380094404dbe04ed9b7bc26a99">llvm::TargetLoweringBase::getVectorIdxTy</a></div><div class="ttdeci">virtual MVT getVectorIdxTy() const </div><div class="ttdef"><b>Definition:</b> <a href="TargetLowering_8h_source.html#l00165">TargetLowering.h:165</a></div></div>
<div class="ttc" id="DAGCombiner_8cpp_html_a1bf26a30c4b6721cd55dbb3b4d7bfc77"><div class="ttname"><a href="DAGCombiner_8cpp.html#a1bf26a30c4b6721cd55dbb3b4d7bfc77">isTruncateOf</a></div><div class="ttdeci">static bool isTruncateOf(SelectionDAG &amp;DAG, SDValue N, SDValue &amp;Op, APInt &amp;KnownZero)</div><div class="ttdef"><b>Definition:</b> <a href="DAGCombiner_8cpp_source.html#l04707">DAGCombiner.cpp:4707</a></div></div>
<div class="ttc" id="structBaseIndexOffset_html_a6e5bf0616e9eb55f6152532be1385543"><div class="ttname"><a href="structBaseIndexOffset.html#a6e5bf0616e9eb55f6152532be1385543">BaseIndexOffset::Index</a></div><div class="ttdeci">SDValue Index</div><div class="ttdef"><b>Definition:</b> <a href="DAGCombiner_8cpp_source.html#l08459">DAGCombiner.cpp:8459</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110a95cd714ab601765342e2ec9f6ba2cb34"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a95cd714ab601765342e2ec9f6ba2cb34">llvm::ISD::TargetConstantFP</a></div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00104">ISDOpcodes.h:104</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110a7c6d8f265e9e16e5debdb9a536b55d3d"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7c6d8f265e9e16e5debdb9a536b55d3d">llvm::ISD::UNDEF</a></div><div class="ttdoc">UNDEF - An undefined node. </div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00154">ISDOpcodes.h:154</a></div></div>
<div class="ttc" id="classllvm_1_1StoreSDNode_html"><div class="ttname"><a href="classllvm_1_1StoreSDNode.html">llvm::StoreSDNode</a></div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l01749">SelectionDAGNodes.h:1749</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110ac3f8f8d8437c64b2e2e9f978e2707210"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ac3f8f8d8437c64b2e2e9f978e2707210">llvm::ISD::FP_TO_SINT</a></div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00379">ISDOpcodes.h:379</a></div></div>
<div class="ttc" id="DAGCombiner_8cpp_html_ae17ca2c848149cf9af40c6df29296a77"><div class="ttname"><a href="DAGCombiner_8cpp.html#ae17ca2c848149cf9af40c6df29296a77">isBSwapHWordElement</a></div><div class="ttdeci">static bool isBSwapHWordElement(SDValue N, SmallVectorImpl&lt; SDNode * &gt; &amp;Parts)</div><div class="ttdef"><b>Definition:</b> <a href="DAGCombiner_8cpp_source.html#l02990">DAGCombiner.cpp:2990</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_ac3c3cf58d6d631af6a172457304d3d07a9dff1dcbac65852b71473818c11869b1"><div class="ttname"><a href="namespacellvm_1_1ISD.html#ac3c3cf58d6d631af6a172457304d3d07a9dff1dcbac65852b71473818c11869b1">llvm::ISD::SETUGE</a></div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00732">ISDOpcodes.h:732</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110aff6f73b624fecca7dbe94259f9437e32"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110aff6f73b624fecca7dbe94259f9437e32">llvm::ISD::BUILD_VECTOR</a></div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00240">ISDOpcodes.h:240</a></div></div>
<div class="ttc" id="classllvm_1_1APInt_html_adcb96bd09d7c75c7669fa5f9d1190899"><div class="ttname"><a href="classllvm_1_1APInt.html#adcb96bd09d7c75c7669fa5f9d1190899">llvm::APInt::getHighBitsSet</a></div><div class="ttdeci">static APInt getHighBitsSet(unsigned numBits, unsigned hiBitsSet)</div><div class="ttdoc">Get a value with high bits set. </div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l00510">APInt.h:510</a></div></div>
<div class="ttc" id="classllvm_1_1BuildVectorSDNode_html_a0d1aedc8b57ec58e82db037ccb38c2a2"><div class="ttname"><a href="classllvm_1_1BuildVectorSDNode.html#a0d1aedc8b57ec58e82db037ccb38c2a2">llvm::BuildVectorSDNode::isConstantSplat</a></div><div class="ttdeci">bool isConstantSplat(APInt &amp;SplatValue, APInt &amp;SplatUndef, unsigned &amp;SplatBitSize, bool &amp;HasAnyUndefs, unsigned MinSplatBits=0, bool isBigEndian=false)</div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAG_8cpp_source.html#l06455">SelectionDAG.cpp:6455</a></div></div>
<div class="ttc" id="classllvm_1_1SDValue_html_a3fad042e27ba626acf5366c845b352d3"><div class="ttname"><a href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">llvm::SDValue::getNode</a></div><div class="ttdeci">SDNode * getNode() const </div><div class="ttdoc">get the SDNode which holds the desired result </div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l00105">SelectionDAGNodes.h:105</a></div></div>
<div class="ttc" id="namespacellvm_html_a191214269543e01221529a5d127c3bcd"><div class="ttname"><a href="namespacellvm.html#a191214269543e01221529a5d127c3bcd">llvm::operator&lt;=</a></div><div class="ttdeci">void operator&lt;=(const Optional&lt; T &gt; &amp;X, const Optional&lt; U &gt; &amp;Y)</div><div class="ttdoc">Poison comparison between two Optional objects. Clients needs to explicitly compare the underlying va...</div></div>
<div class="ttc" id="classllvm_1_1TargetLoweringBase_html_aaf6cf7bea7d0293cd174427f2ba6f50f"><div class="ttname"><a href="classllvm_1_1TargetLoweringBase.html#aaf6cf7bea7d0293cd174427f2ba6f50f">llvm::TargetLoweringBase::isTruncStoreLegal</a></div><div class="ttdeci">bool isTruncStoreLegal(EVT ValVT, EVT MemVT) const </div><div class="ttdef"><b>Definition:</b> <a href="TargetLowering_8h_source.html#l00488">TargetLowering.h:488</a></div></div>
<div class="ttc" id="classllvm_1_1APFloat_html"><div class="ttname"><a href="classllvm_1_1APFloat.html">llvm::APFloat</a></div><div class="ttdoc">A self-contained host- and target-independent arbitrary-precision floating-point software implementat...</div><div class="ttdef"><b>Definition:</b> <a href="APFloat_8h_source.html#l00122">APFloat.h:122</a></div></div>
<div class="ttc" id="namespacellvm_1_1A64DB_html_a6fce8157775f3ec93f326b52b0f1e0f5a4916e736d6b7cc68359b39d5eb50f6db"><div class="ttname"><a href="namespacellvm_1_1A64DB.html#a6fce8157775f3ec93f326b52b0f1e0f5a4916e736d6b7cc68359b39d5eb50f6db">llvm::A64DB::ST</a></div><div class="ttdef"><b>Definition:</b> <a href="AArch64BaseInfo_8h_source.html#l00178">AArch64BaseInfo.h:178</a></div></div>
<div class="ttc" id="structBaseIndexOffset_html_a151d2e3f42da1515dae215679844be6f"><div class="ttname"><a href="structBaseIndexOffset.html#a151d2e3f42da1515dae215679844be6f">BaseIndexOffset::IsIndexSignExt</a></div><div class="ttdeci">bool IsIndexSignExt</div><div class="ttdef"><b>Definition:</b> <a href="DAGCombiner_8cpp_source.html#l08461">DAGCombiner.cpp:8461</a></div></div>
<div class="ttc" id="structllvm_1_1EVT_html_a451be47fed950157cb4c327bc9f91c2d"><div class="ttname"><a href="structllvm_1_1EVT.html#a451be47fed950157cb4c327bc9f91c2d">llvm::EVT::getStoreSize</a></div><div class="ttdeci">unsigned getStoreSize() const </div><div class="ttdef"><b>Definition:</b> <a href="ValueTypes_8h_source.html#l00787">ValueTypes.h:787</a></div></div>
<div class="ttc" id="README__ALTIVEC_8txt_html_a9aacd9146afe44bf656cd664e2a88c8c"><div class="ttname"><a href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a></div><div class="ttdeci">(vector float) vec_cmpeq(*A,*B) C</div><div class="ttdef"><b>Definition:</b> <a href="README__ALTIVEC_8txt_source.html#l00091">README_ALTIVEC.txt:91</a></div></div>
<div class="ttc" id="DAGCombiner_8cpp_html_a64f519aaefc431e6e9f2e15e921fb540"><div class="ttname"><a href="DAGCombiner_8cpp.html#a64f519aaefc431e6e9f2e15e921fb540">ExtendUsesToFormExtLoad</a></div><div class="ttdeci">static bool ExtendUsesToFormExtLoad(SDNode *N, SDValue N0, unsigned ExtOpc, SmallVectorImpl&lt; SDNode * &gt; &amp;ExtendNodes, const TargetLowering &amp;TLI)</div><div class="ttdef"><b>Definition:</b> <a href="DAGCombiner_8cpp_source.html#l04409">DAGCombiner.cpp:4409</a></div></div>
<div class="ttc" id="classllvm_1_1TargetLoweringBase_html_a861aaccc0f468493e76c011811548804"><div class="ttname"><a href="classllvm_1_1TargetLoweringBase.html#a861aaccc0f468493e76c011811548804">llvm::TargetLoweringBase::isTypeLegal</a></div><div class="ttdeci">bool isTypeLegal(EVT VT) const </div><div class="ttdef"><b>Definition:</b> <a href="TargetLowering_8h_source.html#l00285">TargetLowering.h:285</a></div></div>
<div class="ttc" id="CommandLine_8h_html"><div class="ttname"><a href="CommandLine_8h.html">CommandLine.h</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110a991d07d163bd4d9984cf1ef36e92c214"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a991d07d163bd4d9984cf1ef36e92c214">llvm::ISD::CTPOP</a></div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00309">ISDOpcodes.h:309</a></div></div>
<div class="ttc" id="namespacellvm_1_1cl_html_a10a041239ae1870cfcc064bfaa79fb65"><div class="ttname"><a href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">llvm::cl::init</a></div><div class="ttdeci">initializer&lt; Ty &gt; init(const Ty &amp;Val)</div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l00314">CommandLine.h:314</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_afaaeadcd82b42fc0d385a6247bf7bb52"><div class="ttname"><a href="namespacellvm_1_1ISD.html#afaaeadcd82b42fc0d385a6247bf7bb52">llvm::ISD::isNormalLoad</a></div><div class="ttdeci">bool isNormalLoad(const SDNode *N)</div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l01886">SelectionDAGNodes.h:1886</a></div></div>
<div class="ttc" id="classllvm_1_1TargetOptions_html_a0544e2966374684ff74255e5a4290fa7"><div class="ttname"><a href="classllvm_1_1TargetOptions.html#a0544e2966374684ff74255e5a4290fa7">llvm::TargetOptions::UnsafeFPMath</a></div><div class="ttdeci">unsigned UnsafeFPMath</div><div class="ttdef"><b>Definition:</b> <a href="TargetOptions_8h_source.html#l00085">TargetOptions.h:85</a></div></div>
<div class="ttc" id="classllvm_1_1MVT_html_afd69b4f2dff97a2d7c0192cc769ef50ca62a222acce6360abd2726719fabc2797"><div class="ttname"><a href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50ca62a222acce6360abd2726719fabc2797">llvm::MVT::Other</a></div><div class="ttdef"><b>Definition:</b> <a href="ValueTypes_8h_source.html#l00042">ValueTypes.h:42</a></div></div>
<div class="ttc" id="classllvm_1_1ConstantSDNode_html"><div class="ttname"><a href="classllvm_1_1ConstantSDNode.html">llvm::ConstantSDNode</a></div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l01246">SelectionDAGNodes.h:1246</a></div></div>
<div class="ttc" id="structllvm_1_1EVT_html_a9b1d12f467b88f8da64a1d6841910193"><div class="ttname"><a href="structllvm_1_1EVT.html#a9b1d12f467b88f8da64a1d6841910193">llvm::EVT::getStoreSizeInBits</a></div><div class="ttdeci">unsigned getStoreSizeInBits() const </div><div class="ttdef"><b>Definition:</b> <a href="ValueTypes_8h_source.html#l00793">ValueTypes.h:793</a></div></div>
<div class="ttc" id="classllvm_1_1TargetOptions_html_affeb69a55c900f2d333c385955676931"><div class="ttname"><a href="classllvm_1_1TargetOptions.html#affeb69a55c900f2d333c385955676931">llvm::TargetOptions::AllowFPOpFusion</a></div><div class="ttdeci">FPOpFusion::FPOpFusionMode AllowFPOpFusion</div><div class="ttdef"><b>Definition:</b> <a href="TargetOptions_8h_source.html#l00191">TargetOptions.h:191</a></div></div>
<div class="ttc" id="classllvm_1_1MemSDNode_html_a9330f807294a868461af12a3ed56a269"><div class="ttname"><a href="classllvm_1_1MemSDNode.html#a9330f807294a868461af12a3ed56a269">llvm::MemSDNode::getBasePtr</a></div><div class="ttdeci">const SDValue &amp; getBasePtr() const </div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l01054">SelectionDAGNodes.h:1054</a></div></div>
<div class="ttc" id="namespacellvm_1_1HexagonISD_html_aa640667f875feccdb3cc643baff441f1a144f7e8227378979bf13646688174ed9"><div class="ttname"><a href="namespacellvm_1_1HexagonISD.html#aa640667f875feccdb3cc643baff441f1a144f7e8227378979bf13646688174ed9">llvm::HexagonISD::Lo</a></div><div class="ttdef"><b>Definition:</b> <a href="HexagonISelLowering_8h_source.html#l00043">HexagonISelLowering.h:43</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110a047178c3b2c6a5df40ae22a407b8aca9"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a047178c3b2c6a5df40ae22a407b8aca9">llvm::ISD::STORE</a></div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00460">ISDOpcodes.h:460</a></div></div>
<div class="ttc" id="classllvm_1_1ConstantFPSDNode_html_a97d4ef979a8e5004f23bd340bcb222f0"><div class="ttname"><a href="classllvm_1_1ConstantFPSDNode.html#a97d4ef979a8e5004f23bd340bcb222f0">llvm::ConstantFPSDNode::isZero</a></div><div class="ttdeci">bool isZero() const </div><div class="ttdoc">isZero - Return true if the value is positive or negative zero. </div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l01283">SelectionDAGNodes.h:1283</a></div></div>
<div class="ttc" id="classllvm_1_1APInt_html_a8cf5475fb3e9c737112cc248194c1040"><div class="ttname"><a href="classllvm_1_1APInt.html#a8cf5475fb3e9c737112cc248194c1040">llvm::APInt::trunc</a></div><div class="ttdeci">APInt LLVM_ATTRIBUTE_UNUSED_RESULT trunc(unsigned width) const </div><div class="ttdoc">Truncate to new width. </div><div class="ttdef"><b>Definition:</b> <a href="APInt_8cpp_source.html#l00919">APInt.cpp:919</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110ad56e9199ae3993a09af36ff41d327a11"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ad56e9199ae3993a09af36ff41d327a11">llvm::ISD::FCEIL</a></div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00451">ISDOpcodes.h:451</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110a3c6553c8acebe1b57c211ee45e2d8f98"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a3c6553c8acebe1b57c211ee45e2d8f98">llvm::ISD::SRL</a></div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00306">ISDOpcodes.h:306</a></div></div>
<div class="ttc" id="classllvm_1_1SmallVectorTemplateCommon_html_acd9e771a3296c6b24146955754620557"><div class="ttname"><a href="classllvm_1_1SmallVectorTemplateCommon.html#acd9e771a3296c6b24146955754620557">llvm::SmallVectorTemplateCommon&lt; T &gt;::back</a></div><div class="ttdeci">reference back()</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00157">SmallVector.h:157</a></div></div>
<div class="ttc" id="classllvm_1_1MVT_html"><div class="ttname"><a href="classllvm_1_1MVT.html">llvm::MVT</a></div><div class="ttdef"><b>Definition:</b> <a href="ValueTypes_8h_source.html#l00033">ValueTypes.h:33</a></div></div>
<div class="ttc" id="classllvm_1_1SmallVectorImpl_html_aac0ea55010b7b1a301e65a0baea057aa"><div class="ttname"><a href="classllvm_1_1SmallVectorImpl.html#aac0ea55010b7b1a301e65a0baea057aa">llvm::SmallVectorImpl::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00396">SmallVector.h:396</a></div></div>
<div class="ttc" id="classllvm_1_1SDValue_html_a5891be2cd50b5b7f01eb7c1cb0e7a682"><div class="ttname"><a href="classllvm_1_1SDValue.html#a5891be2cd50b5b7f01eb7c1cb0e7a682">llvm::SDValue::getOperand</a></div><div class="ttdeci">const SDValue &amp; getOperand(unsigned i) const </div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l00849">SelectionDAGNodes.h:849</a></div></div>
<div class="ttc" id="classllvm_1_1Type_html"><div class="ttname"><a href="classllvm_1_1Type.html">llvm::Type</a></div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00044">Type.h:44</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110a6da41a113af0909470baea7486b3386b"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a6da41a113af0909470baea7486b3386b">llvm::ISD::CTTZ</a></div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00309">ISDOpcodes.h:309</a></div></div>
<div class="ttc" id="classllvm_1_1LLVMContext_html"><div class="ttname"><a href="classllvm_1_1LLVMContext.html">llvm::LLVMContext</a></div><div class="ttdef"><b>Definition:</b> <a href="LLVMContext_8h_source.html#l00037">LLVMContext.h:37</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110a32ec12017722f5b42a295fe5eb0b0bdf"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a32ec12017722f5b42a295fe5eb0b0bdf">llvm::ISD::FADD</a></div><div class="ttdoc">Simple binary floating point operators. </div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00222">ISDOpcodes.h:222</a></div></div>
<div class="ttc" id="Target_2README_8txt_html_ab24db72f7bd10b13351812874015861b"><div class="ttname"><a href="Target_2README_8txt.html#ab24db72f7bd10b13351812874015861b">First</a></div><div class="ttdeci">into llvm powi allowing the code generator to produce balanced multiplication trees First</div><div class="ttdef"><b>Definition:</b> <a href="Target_2README_8txt_source.html#l00051">Target/README.txt:51</a></div></div>
<div class="ttc" id="classllvm_1_1MemSDNode_html_a967ffaf77f64a5deb1e96951e4224112"><div class="ttname"><a href="classllvm_1_1MemSDNode.html#a967ffaf77f64a5deb1e96951e4224112">llvm::MemSDNode::isNonTemporal</a></div><div class="ttdeci">bool isNonTemporal() const </div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l01009">SelectionDAGNodes.h:1009</a></div></div>
<div class="ttc" id="classllvm_1_1TargetLoweringBase_html_a087dd0f9650e999b087c17cc7f46f2d0"><div class="ttname"><a href="classllvm_1_1TargetLoweringBase.html#a087dd0f9650e999b087c17cc7f46f2d0">llvm::TargetLoweringBase::isOperationLegalOrCustom</a></div><div class="ttdeci">bool isOperationLegalOrCustom(unsigned Op, EVT VT) const </div><div class="ttdef"><b>Definition:</b> <a href="TargetLowering_8h_source.html#l00433">TargetLowering.h:433</a></div></div>
<div class="ttc" id="classllvm_1_1AliasAnalysis_html_a59949d72986d3e9fdb7e7c9272c02f0f"><div class="ttname"><a href="classllvm_1_1AliasAnalysis.html#a59949d72986d3e9fdb7e7c9272c02f0f">llvm::AliasAnalysis::alias</a></div><div class="ttdeci">virtual AliasResult alias(const Location &amp;LocA, const Location &amp;LocB)</div><div class="ttdef"><b>Definition:</b> <a href="AliasAnalysis_8cpp_source.html#l00052">AliasAnalysis.cpp:52</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110a1e92ea554489509b0ad970901bcc715b"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a1e92ea554489509b0ad970901bcc715b">llvm::ISD::FTRUNC</a></div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00451">ISDOpcodes.h:451</a></div></div>
<div class="ttc" id="namespacellvm_html_aa6d856e4879bb775617f8c3634773b7aa7fbaa966e5d5ac3bf03ba617b73bff5c"><div class="ttname"><a href="namespacellvm.html#aa6d856e4879bb775617f8c3634773b7aa7fbaa966e5d5ac3bf03ba617b73bff5c">llvm::AfterLegalizeDAG</a></div><div class="ttdef"><b>Definition:</b> <a href="DAGCombine_8h_source.html#l00020">DAGCombine.h:20</a></div></div>
<div class="ttc" id="classllvm_1_1SelectionDAG_html_abe7bd3138ea3703376dc622650b20ff3"><div class="ttname"><a href="classllvm_1_1SelectionDAG.html#abe7bd3138ea3703376dc622650b20ff3">llvm::SelectionDAG::Combine</a></div><div class="ttdeci">void Combine(CombineLevel Level, AliasAnalysis &amp;AA, CodeGenOpt::Level OptLevel)</div><div class="ttdef"><b>Definition:</b> <a href="DAGCombiner_8cpp_source.html#l11046">DAGCombiner.cpp:11046</a></div></div>
<div class="ttc" id="classllvm_1_1Constant_html"><div class="ttname"><a href="classllvm_1_1Constant.html">llvm::Constant</a></div><div class="ttdoc">LLVM Constant Representation. </div><div class="ttdef"><b>Definition:</b> <a href="Constant_8h_source.html#l00041">Constant.h:41</a></div></div>
<div class="ttc" id="classllvm_1_1TargetLoweringBase_html_a785a8016a792dbc65ec16688f180af71"><div class="ttname"><a href="classllvm_1_1TargetLoweringBase.html#a785a8016a792dbc65ec16688f180af71">llvm::TargetLoweringBase::isBigEndian</a></div><div class="ttdeci">bool isBigEndian() const </div><div class="ttdef"><b>Definition:</b> <a href="TargetLowering_8h_source.html#l00149">TargetLowering.h:149</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_ad4d48171b87ca51ff54c10a436bac4d7"><div class="ttname"><a href="namespacellvm_1_1ISD.html#ad4d48171b87ca51ff54c10a436bac4d7">llvm::ISD::LoadExtType</a></div><div class="ttdeci">LoadExtType</div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00697">ISDOpcodes.h:697</a></div></div>
<div class="ttc" id="classllvm_1_1APInt_html_a7189a37206963029447c31d57771b997"><div class="ttname"><a href="classllvm_1_1APInt.html#a7189a37206963029447c31d57771b997">llvm::APInt::getSExtValue</a></div><div class="ttdeci">int64_t getSExtValue() const </div><div class="ttdoc">Get sign extended value. </div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l01318">APInt.h:1318</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110ad3bc7c2d379fbfdc2f8eaca038690ec9"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ad3bc7c2d379fbfdc2f8eaca038690ec9">llvm::ISD::INSERT_VECTOR_ELT</a></div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00245">ISDOpcodes.h:245</a></div></div>
<div class="ttc" id="structBaseIndexOffset_html_ac5a5ed57c63f39652622f85207eb30f2"><div class="ttname"><a href="structBaseIndexOffset.html#ac5a5ed57c63f39652622f85207eb30f2">BaseIndexOffset::match</a></div><div class="ttdeci">static BaseIndexOffset match(SDValue Ptr)</div><div class="ttdoc">Parses tree in Ptr for base, index, offset addresses. </div><div class="ttdef"><b>Definition:</b> <a href="DAGCombiner_8cpp_source.html#l08475">DAGCombiner.cpp:8475</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110ad116e32876f2275acf60ffb1651c9256"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ad116e32876f2275acf60ffb1651c9256">llvm::ISD::ADDE</a></div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00204">ISDOpcodes.h:204</a></div></div>
<div class="ttc" id="classllvm_1_1TargetLoweringBase_html_a055b3905dbbc16fae11510b9ebd1e00c"><div class="ttname"><a href="classllvm_1_1TargetLoweringBase.html#a055b3905dbbc16fae11510b9ebd1e00c">llvm::TargetLoweringBase::isOperationLegal</a></div><div class="ttdeci">bool isOperationLegal(unsigned Op, EVT VT) const </div><div class="ttdoc">Return true if the specified operation is legal on this target. </div><div class="ttdef"><b>Definition:</b> <a href="TargetLowering_8h_source.html#l00456">TargetLowering.h:456</a></div></div>
<div class="ttc" id="namespacellvm_1_1HexagonISD_html_aa640667f875feccdb3cc643baff441f1ab53c716337bbeea9ba39b5fa32d60303"><div class="ttname"><a href="namespacellvm_1_1HexagonISD.html#aa640667f875feccdb3cc643baff441f1ab53c716337bbeea9ba39b5fa32d60303">llvm::HexagonISD::Hi</a></div><div class="ttdef"><b>Definition:</b> <a href="HexagonISelLowering_8h_source.html#l00043">HexagonISelLowering.h:43</a></div></div>
<div class="ttc" id="classllvm_1_1ConstantArray_html_a0900dacdc7ad8e3ea0cc92993c7fd422"><div class="ttname"><a href="classllvm_1_1ConstantArray.html#a0900dacdc7ad8e3ea0cc92993c7fd422">llvm::ConstantArray::get</a></div><div class="ttdeci">static Constant * get(ArrayType *T, ArrayRef&lt; Constant * &gt; V)</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l00745">Constants.cpp:745</a></div></div>
<div class="ttc" id="classllvm_1_1ConstantFP_html"><div class="ttname"><a href="classllvm_1_1ConstantFP.html">llvm::ConstantFP</a></div><div class="ttdef"><b>Definition:</b> <a href="Constants_8h_source.html#l00232">Constants.h:232</a></div></div>
<div class="ttc" id="structllvm_1_1cl_1_1desc_html"><div class="ttname"><a href="structllvm_1_1cl_1_1desc.html">llvm::cl::desc</a></div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l00286">CommandLine.h:286</a></div></div>
<div class="ttc" id="classllvm_1_1SelectionDAG_html_a56a2102423fcb39c2683a7e67bddf537"><div class="ttname"><a href="classllvm_1_1SelectionDAG.html#a56a2102423fcb39c2683a7e67bddf537">llvm::SelectionDAG::SplitVectorOperand</a></div><div class="ttdeci">std::pair&lt; SDValue, SDValue &gt; SplitVectorOperand(const SDNode *N, unsigned OpNo)</div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAG_8h_source.html#l01152">SelectionDAG.h:1152</a></div></div>
<div class="ttc" id="structBaseIndexOffset_html_a4620710c0fe361d718e7a522ce3df91b"><div class="ttname"><a href="structBaseIndexOffset.html#a4620710c0fe361d718e7a522ce3df91b">BaseIndexOffset::Base</a></div><div class="ttdeci">SDValue Base</div><div class="ttdef"><b>Definition:</b> <a href="DAGCombiner_8cpp_source.html#l08458">DAGCombiner.cpp:8458</a></div></div>
<div class="ttc" id="structllvm_1_1TargetLowering_1_1DAGCombinerInfo_html_a9e3e1453357b1b1cd870a4ac3528f918"><div class="ttname"><a href="structllvm_1_1TargetLowering_1_1DAGCombinerInfo.html#a9e3e1453357b1b1cd870a4ac3528f918">llvm::TargetLowering::DAGCombinerInfo::AddToWorklist</a></div><div class="ttdeci">void AddToWorklist(SDNode *N)</div><div class="ttdef"><b>Definition:</b> <a href="DAGCombiner_8cpp_source.html#l00391">DAGCombiner.cpp:391</a></div></div>
<div class="ttc" id="namespacellvm_html_aa6d856e4879bb775617f8c3634773b7a"><div class="ttname"><a href="namespacellvm.html#aa6d856e4879bb775617f8c3634773b7a">llvm::CombineLevel</a></div><div class="ttdeci">CombineLevel</div><div class="ttdef"><b>Definition:</b> <a href="DAGCombine_8h_source.html#l00016">DAGCombine.h:16</a></div></div>
<div class="ttc" id="classllvm_1_1APInt_html_aa3464694bcec68b89b4bffd71360b897"><div class="ttname"><a href="classllvm_1_1APInt.html#aa3464694bcec68b89b4bffd71360b897">llvm::APInt::sext</a></div><div class="ttdeci">APInt LLVM_ATTRIBUTE_UNUSED_RESULT sext(unsigned width) const </div><div class="ttdoc">Sign extend to a new width. </div><div class="ttdef"><b>Definition:</b> <a href="APInt_8cpp_source.html#l00942">APInt.cpp:942</a></div></div>
<div class="ttc" id="classllvm_1_1SelectionDAG_html_a92c8c043c2a2d8db5b6cf9767394b747"><div class="ttname"><a href="classllvm_1_1SelectionDAG.html#a92c8c043c2a2d8db5b6cf9767394b747">llvm::SelectionDAG::RemoveDeadNodes</a></div><div class="ttdeci">void RemoveDeadNodes()</div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAG_8cpp_source.html#l00549">SelectionDAG.cpp:549</a></div></div>
<div class="ttc" id="classllvm_1_1TargetLoweringBase_html_a00856c52a5a67b38d8332c7842429153"><div class="ttname"><a href="classllvm_1_1TargetLoweringBase.html#a00856c52a5a67b38d8332c7842429153">llvm::TargetLoweringBase::isTruncateFree</a></div><div class="ttdeci">virtual bool isTruncateFree(Type *, Type *) const </div><div class="ttdef"><b>Definition:</b> <a href="TargetLowering_8h_source.html#l01172">TargetLowering.h:1172</a></div></div>
<div class="ttc" id="classllvm_1_1SDNode_1_1use__iterator_html"><div class="ttname"><a href="classllvm_1_1SDNode_1_1use__iterator.html">llvm::SDNode::use_iterator</a></div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l00439">SelectionDAGNodes.h:439</a></div></div>
<div class="ttc" id="classllvm_1_1MemSDNode_html_a9c2ed40a765beab830932e12f5eb82d0"><div class="ttname"><a href="classllvm_1_1MemSDNode.html#a9c2ed40a765beab830932e12f5eb82d0">llvm::MemSDNode::getOriginalAlignment</a></div><div class="ttdeci">unsigned getOriginalAlignment() const </div><div class="ttdoc">Returns alignment and volatility of the memory access. </div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l00992">SelectionDAGNodes.h:992</a></div></div>
<div class="ttc" id="classllvm_1_1SelectionDAG_html_a4c2e9947586d4e88ad61174b796a40d1"><div class="ttname"><a href="classllvm_1_1SelectionDAG.html#a4c2e9947586d4e88ad61174b796a40d1">llvm::SelectionDAG::getSExtOrTrunc</a></div><div class="ttdeci">SDValue getSExtOrTrunc(SDValue Op, SDLoc DL, EVT VT)</div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAG_8cpp_source.html#l00926">SelectionDAG.cpp:926</a></div></div>
<div class="ttc" id="classllvm_1_1TargetLoweringBase_html_adc25bcc279ccfb5b867c2b7b8eedaa9b"><div class="ttname"><a href="classllvm_1_1TargetLoweringBase.html#adc25bcc279ccfb5b867c2b7b8eedaa9b">llvm::TargetLoweringBase::getDataLayout</a></div><div class="ttdeci">const DataLayout * getDataLayout() const </div><div class="ttdef"><b>Definition:</b> <a href="TargetLowering_8h_source.html#l00146">TargetLowering.h:146</a></div></div>
<div class="ttc" id="classllvm_1_1TargetLoweringBase_html_a8cbe090e0985c49fdc3d9b27b42788f0"><div class="ttname"><a href="classllvm_1_1TargetLoweringBase.html#a8cbe090e0985c49fdc3d9b27b42788f0">llvm::TargetLoweringBase::isFMAFasterThanFMulAndFAdd</a></div><div class="ttdeci">virtual bool isFMAFasterThanFMulAndFAdd(EVT) const </div><div class="ttdef"><b>Definition:</b> <a href="TargetLowering_8h_source.html#l01265">TargetLowering.h:1265</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_ac3c3cf58d6d631af6a172457304d3d07a5ad12b466e3a5900d0c307b301465d25"><div class="ttname"><a href="namespacellvm_1_1ISD.html#ac3c3cf58d6d631af6a172457304d3d07a5ad12b466e3a5900d0c307b301465d25">llvm::ISD::SETGT</a></div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00740">ISDOpcodes.h:740</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110abdd7bbb76dac7962dda6e116e33699da"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110abdd7bbb76dac7962dda6e116e33699da">llvm::ISD::FREM</a></div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00222">ISDOpcodes.h:222</a></div></div>
<div class="ttc" id="classllvm_1_1APFloat_html_a42fe920c8131569bb30114d7f294c8f8a527f71be1f3fdab1f3354020d5bec081"><div class="ttname"><a href="classllvm_1_1APFloat.html#a42fe920c8131569bb30114d7f294c8f8a527f71be1f3fdab1f3354020d5bec081">llvm::APFloat::opOK</a></div><div class="ttdef"><b>Definition:</b> <a href="APFloat_8h_source.html#l00167">APFloat.h:167</a></div></div>
<div class="ttc" id="classllvm_1_1APInt_html_ad081689e23a8f5dea78dedd623d6a8f8"><div class="ttname"><a href="classllvm_1_1APInt.html#ad081689e23a8f5dea78dedd623d6a8f8">llvm::APInt::getBitWidth</a></div><div class="ttdeci">unsigned getBitWidth() const </div><div class="ttdoc">Return the number of bits in the APInt. </div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l01252">APInt.h:1252</a></div></div>
<div class="ttc" id="classllvm_1_1SDValue_html_a0caf6a31d8034336a9ba7791a5f583f1"><div class="ttname"><a href="classllvm_1_1SDValue.html#a0caf6a31d8034336a9ba7791a5f583f1">llvm::SDValue::getOpcode</a></div><div class="ttdeci">unsigned getOpcode() const </div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l00840">SelectionDAGNodes.h:840</a></div></div>
<div class="ttc" id="Target_2X86_2README_8txt_html_a0ed5c5d6ff68f354e354920a3680185c"><div class="ttname"><a href="Target_2X86_2README_8txt.html#a0ed5c5d6ff68f354e354920a3680185c">Sum</a></div><div class="ttdeci">return Sum</div><div class="ttdef"><b>Definition:</b> <a href="Target_2X86_2README_8txt_source.html#l00112">Target/X86/README.txt:112</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_ad4d48171b87ca51ff54c10a436bac4d7a6c61b6125c7901c549f90ee0e443a770"><div class="ttname"><a href="namespacellvm_1_1ISD.html#ad4d48171b87ca51ff54c10a436bac4d7a6c61b6125c7901c549f90ee0e443a770">llvm::ISD::SEXTLOAD</a></div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00700">ISDOpcodes.h:700</a></div></div>
<div class="ttc" id="namespacellvm_1_1CodeGenOpt_html_a411055ea15209051c2370bbf655ec8d4a451bbac85aff02d070be3c17a6bef928"><div class="ttname"><a href="namespacellvm_1_1CodeGenOpt.html#a411055ea15209051c2370bbf655ec8d4a451bbac85aff02d070be3c17a6bef928">llvm::CodeGenOpt::None</a></div><div class="ttdef"><b>Definition:</b> <a href="CodeGen_8h_source.html#l00046">CodeGen.h:46</a></div></div>
<div class="ttc" id="classllvm_1_1TargetLoweringBase_html_a52dbd9fc4ea2c0919913e74e003b2823"><div class="ttname"><a href="classllvm_1_1TargetLoweringBase.html#a52dbd9fc4ea2c0919913e74e003b2823">llvm::TargetLoweringBase::isNarrowingProfitable</a></div><div class="ttdeci">virtual bool isNarrowingProfitable(EVT, EVT) const </div><div class="ttdef"><b>Definition:</b> <a href="TargetLowering_8h_source.html#l01272">TargetLowering.h:1272</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110aee4f13218bdbb5c5697f7e786618ecb2"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110aee4f13218bdbb5c5697f7e786618ecb2">llvm::ISD::AssertSext</a></div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00057">ISDOpcodes.h:57</a></div></div>
<div class="ttc" id="classllvm_1_1APFloat_html_ab5131b6b960e5e4687016d5b6f64069b"><div class="ttname"><a href="classllvm_1_1APFloat.html#ab5131b6b960e5e4687016d5b6f64069b">llvm::APFloat::changeSign</a></div><div class="ttdeci">void changeSign()</div><div class="ttdef"><b>Definition:</b> <a href="APFloat_8cpp_source.html#l01589">APFloat.cpp:1589</a></div></div>
<div class="ttc" id="structMemOpLink_html"><div class="ttname"><a href="structMemOpLink.html">MemOpLink</a></div><div class="ttdef"><b>Definition:</b> <a href="DAGCombiner_8cpp_source.html#l08534">DAGCombiner.cpp:8534</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110a0340c8d57d1dcebc43a00412989583d3"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a0340c8d57d1dcebc43a00412989583d3">llvm::ISD::CTLZ_ZERO_UNDEF</a></div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00312">ISDOpcodes.h:312</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a9cc23aed232ccdeadbd8648c349236a6"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a9cc23aed232ccdeadbd8648c349236a6">llvm::ISD::getSetCCSwappedOperands</a></div><div class="ttdeci">CondCode getSetCCSwappedOperands(CondCode Operation)</div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAG_8cpp_source.html#l00222">SelectionDAG.cpp:222</a></div></div>
<div class="ttc" id="Target_2PowerPC_2README_8txt_html_afc7ca55ad1da67847ecd4b99ef64dc84"><div class="ttname"><a href="Target_2PowerPC_2README_8txt.html#afc7ca55ad1da67847ecd4b99ef64dc84">CC</a></div><div class="ttdeci">which only computes the address of bar double int Z void if you have a function since the bit double ate up the argument bytes for r4 and r5 The trick then would be to shuffle the argument order for functions we can internalize so that the maximum number of integers pointers get passed in regs before you see any of the fp arguments Instead of implementing it would actually probably be easier to just implement a PPC where we could do whatever we wanted to the CC</div><div class="ttdef"><b>Definition:</b> <a href="Target_2PowerPC_2README_8txt_source.html#l00247">Target/PowerPC/README.txt:247</a></div></div>
<div class="ttc" id="classllvm_1_1APInt_html_ac9d5eb700dcdf604653d12d8caf4a0fb"><div class="ttname"><a href="classllvm_1_1APInt.html#ac9d5eb700dcdf604653d12d8caf4a0fb">llvm::APInt::countPopulation</a></div><div class="ttdeci">unsigned countPopulation() const </div><div class="ttdoc">Count the number of bits set. </div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l01394">APInt.h:1394</a></div></div>
<div class="ttc" id="classllvm_1_1SDNode_html_a8810bf428dcf84d48f39c8f5ba9a8c94"><div class="ttname"><a href="classllvm_1_1SDNode.html#a8810bf428dcf84d48f39c8f5ba9a8c94">llvm::SDNode::use_begin</a></div><div class="ttdeci">use_iterator use_begin() const </div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l00496">SelectionDAGNodes.h:496</a></div></div>
<div class="ttc" id="classllvm_1_1MemSDNode_html_acd3bb9ee2ec53fa4be1fdf155b0b5a17"><div class="ttname"><a href="classllvm_1_1MemSDNode.html#acd3bb9ee2ec53fa4be1fdf155b0b5a17">llvm::MemSDNode::isVolatile</a></div><div class="ttdeci">bool isVolatile() const </div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l01008">SelectionDAGNodes.h:1008</a></div></div>
<div class="ttc" id="classllvm_1_1StoreSDNode_html_a7f9820a84907a5aa530d4dc36f841c76"><div class="ttname"><a href="classllvm_1_1StoreSDNode.html#a7f9820a84907a5aa530d4dc36f841c76">llvm::StoreSDNode::getValue</a></div><div class="ttdeci">const SDValue &amp; getValue() const </div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l01768">SelectionDAGNodes.h:1768</a></div></div>
<div class="ttc" id="structllvm_1_1AliasAnalysis_1_1Location_html"><div class="ttname"><a href="structllvm_1_1AliasAnalysis_1_1Location.html">llvm::AliasAnalysis::Location</a></div><div class="ttdoc">Location - A description of a memory location. </div><div class="ttdef"><b>Definition:</b> <a href="AliasAnalysis_8h_source.html#l00106">AliasAnalysis.h:106</a></div></div>
<div class="ttc" id="classllvm_1_1SmallPtrSetImpl_html_a095445850ef2c64e96b4c05120cecf66"><div class="ttname"><a href="classllvm_1_1SmallPtrSetImpl.html#a095445850ef2c64e96b4c05120cecf66">llvm::SmallPtrSetImpl::empty</a></div><div class="ttdeci">bool LLVM_ATTRIBUTE_UNUSED_RESULT empty() const </div><div class="ttdef"><b>Definition:</b> <a href="SmallPtrSet_8h_source.html#l00074">SmallPtrSet.h:74</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110a601e66a26efd05520f7cb26aef3af340"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a601e66a26efd05520f7cb26aef3af340">llvm::ISD::CTTZ_ZERO_UNDEF</a></div><div class="ttdoc">Bit counting operators with an undefined result for zero inputs. </div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00312">ISDOpcodes.h:312</a></div></div>
<div class="ttc" id="classllvm_1_1SelectionDAG_html_af99f246db9e144fefd7a73b54ef0bbf7"><div class="ttname"><a href="classllvm_1_1SelectionDAG.html#af99f246db9e144fefd7a73b54ef0bbf7">llvm::SelectionDAG::MaskedValueIsZero</a></div><div class="ttdeci">bool MaskedValueIsZero(SDValue Op, const APInt &amp;Mask, unsigned Depth=0) const </div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAG_8cpp_source.html#l01747">SelectionDAG.cpp:1747</a></div></div>
<div class="ttc" id="README__ALTIVEC_8txt_html_afb354c8aea0150628f8aa06c7f4a4168"><div class="ttname"><a href="README__ALTIVEC_8txt.html#afb354c8aea0150628f8aa06c7f4a4168">f</a></div><div class="ttdeci">vector float f(vector float a, vector float b)</div><div class="ttdef"><b>Definition:</b> <a href="README__ALTIVEC_8txt_source.html#l00205">README_ALTIVEC.txt:205</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110aadfdefcb133a7f0262a05934aba8ce5d"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110aadfdefcb133a7f0262a05934aba8ce5d">llvm::ISD::FP_EXTEND</a></div><div class="ttdoc">X = FP_EXTEND(Y) - Extend a smaller FP type into a larger FP type. </div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00411">ISDOpcodes.h:411</a></div></div>
<div class="ttc" id="classllvm_1_1SmallVectorImpl_html_a669d55980a7d4b6307b94596deeb0b1f"><div class="ttname"><a href="classllvm_1_1SmallVectorImpl.html#a669d55980a7d4b6307b94596deeb0b1f">llvm::SmallVectorImpl::append</a></div><div class="ttdeci">void append(in_iter in_start, in_iter in_end)</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00445">SmallVector.h:445</a></div></div>
<div class="ttc" id="structllvm_1_1EVT_html"><div class="ttname"><a href="structllvm_1_1EVT.html">llvm::EVT</a></div><div class="ttdef"><b>Definition:</b> <a href="ValueTypes_8h_source.html#l00576">ValueTypes.h:576</a></div></div>
<div class="ttc" id="structMemOpLink_html_accb21e142bdf2938dff24f59d23b393c"><div class="ttname"><a href="structMemOpLink.html#accb21e142bdf2938dff24f59d23b393c">MemOpLink::SequenceNum</a></div><div class="ttdeci">unsigned SequenceNum</div><div class="ttdef"><b>Definition:</b> <a href="DAGCombiner_8cpp_source.html#l08543">DAGCombiner.cpp:8543</a></div></div>
<div class="ttc" id="namespacellvm_html_a0490c32aa8dd63ddc56bb046fd0258c7"><div class="ttname"><a href="namespacellvm.html#a0490c32aa8dd63ddc56bb046fd0258c7">llvm::NextPowerOf2</a></div><div class="ttdeci">uint64_t NextPowerOf2(uint64_t A)</div><div class="ttdef"><b>Definition:</b> <a href="MathExtras_8h_source.html#l00546">MathExtras.h:546</a></div></div>
<div class="ttc" id="DAGCombiner_8cpp_html_ae5856aabdc0d5eeaec3cf71f93c771a9"><div class="ttname"><a href="DAGCombiner_8cpp.html#ae5856aabdc0d5eeaec3cf71f93c771a9">tryFoldToZero</a></div><div class="ttdeci">static SDValue tryFoldToZero(SDLoc DL, const TargetLowering &amp;TLI, EVT VT, SelectionDAG &amp;DAG, bool LegalOperations, bool LegalTypes)</div><div class="ttdef"><b>Definition:</b> <a href="DAGCombiner_8cpp_source.html#l01633">DAGCombiner.cpp:1633</a></div></div>
<div class="ttc" id="classllvm_1_1ConstantFPSDNode_html_a31c374d2e45ef09b957dce7356380ccd"><div class="ttname"><a href="classllvm_1_1ConstantFPSDNode.html#a31c374d2e45ef09b957dce7356380ccd">llvm::ConstantFPSDNode::getValueAPF</a></div><div class="ttdeci">const APFloat &amp; getValueAPF() const </div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l01279">SelectionDAGNodes.h:1279</a></div></div>
<div class="ttc" id="structllvm_1_1EVT_html_ab8f0e414facbed711a9754687bdcd23f"><div class="ttname"><a href="structllvm_1_1EVT.html#ab8f0e414facbed711a9754687bdcd23f">llvm::EVT::bitsEq</a></div><div class="ttdeci">bool bitsEq(EVT VT) const </div><div class="ttdoc">bitsEq - Return true if this has the same number of bits as VT. </div><div class="ttdef"><b>Definition:</b> <a href="ValueTypes_8h_source.html#l00717">ValueTypes.h:717</a></div></div>
<div class="ttc" id="classllvm_1_1ConstantFPSDNode_html_a9e6e07caea417920f3f2a755ea5f06db"><div class="ttname"><a href="classllvm_1_1ConstantFPSDNode.html#a9e6e07caea417920f3f2a755ea5f06db">llvm::ConstantFPSDNode::getConstantFPValue</a></div><div class="ttdeci">const ConstantFP * getConstantFPValue() const </div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l01280">SelectionDAGNodes.h:1280</a></div></div>
<div class="ttc" id="DAGCombiner_8cpp_html_a4bef95512fa985102be74adbdb966f80"><div class="ttname"><a href="DAGCombiner_8cpp.html#a4bef95512fa985102be74adbdb966f80">areUsedBitsDense</a></div><div class="ttdeci">static bool areUsedBitsDense(const APInt &amp;UsedBits)</div><div class="ttdoc">Check that all bits set in UsedBits form a dense region, i.e., UsedBits looks like 0...</div><div class="ttdef"><b>Definition:</b> <a href="DAGCombiner_8cpp_source.html#l07901">DAGCombiner.cpp:7901</a></div></div>
<div class="ttc" id="classllvm_1_1SelectionDAG_html_a0ee11b567d80b84aafb68339dbb3923c"><div class="ttname"><a href="classllvm_1_1SelectionDAG.html#a0ee11b567d80b84aafb68339dbb3923c">llvm::SelectionDAG::getGlobalAddress</a></div><div class="ttdeci">SDValue getGlobalAddress(const GlobalValue *GV, SDLoc DL, EVT VT, int64_t offset=0, bool isTargetGA=false, unsigned char TargetFlags=0)</div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAG_8cpp_source.html#l01125">SelectionDAG.cpp:1125</a></div></div>
<div class="ttc" id="classllvm_1_1TargetRegisterInfo_html"><div class="ttname"><a href="classllvm_1_1TargetRegisterInfo.html">llvm::TargetRegisterInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="TargetRegisterInfo_8h_source.html#l00219">TargetRegisterInfo.h:219</a></div></div>
<div class="ttc" id="DAGCombiner_8cpp_html_a3ceb460ebf70a2fe9a7eb07de595b3d1"><div class="ttname"><a href="DAGCombiner_8cpp.html#a3ceb460ebf70a2fe9a7eb07de595b3d1">adjustCostForPairing</a></div><div class="ttdeci">static void adjustCostForPairing(SmallVectorImpl&lt; LoadedSlice &gt; &amp;LoadedSlices, LoadedSlice::Cost &amp;GlobalLSCost)</div><div class="ttdoc">Adjust the GlobalLSCost according to the target paring capabilities and the layout of the slices...</div><div class="ttdef"><b>Definition:</b> <a href="DAGCombiner_8cpp_source.html#l07933">DAGCombiner.cpp:7933</a></div></div>
<div class="ttc" id="classllvm_1_1LSBaseSDNode_html_a76f8f644c33a885eaff35f94c39d5048"><div class="ttname"><a href="classllvm_1_1LSBaseSDNode.html#a76f8f644c33a885eaff35f94c39d5048">llvm::LSBaseSDNode::getAddressingMode</a></div><div class="ttdeci">ISD::MemIndexedMode getAddressingMode() const </div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l01702">SelectionDAGNodes.h:1702</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110ad8aec9273962cf78d087090c11a1dd1c"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ad8aec9273962cf78d087090c11a1dd1c">llvm::ISD::MUL</a></div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00176">ISDOpcodes.h:176</a></div></div>
<div class="ttc" id="structllvm_1_1EVT_html_a18c2edf1939f6e87f1e586b815f398cd"><div class="ttname"><a href="structllvm_1_1EVT.html#a18c2edf1939f6e87f1e586b815f398cd">llvm::EVT::getVectorVT</a></div><div class="ttdeci">static EVT getVectorVT(LLVMContext &amp;Context, EVT VT, unsigned NumElements)</div><div class="ttdef"><b>Definition:</b> <a href="ValueTypes_8h_source.html#l00616">ValueTypes.h:616</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_ac3c3cf58d6d631af6a172457304d3d07a7f47862de23f7210f88ccf98ae1efbe4"><div class="ttname"><a href="namespacellvm_1_1ISD.html#ac3c3cf58d6d631af6a172457304d3d07a7f47862de23f7210f88ccf98ae1efbe4">llvm::ISD::SETGE</a></div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00741">ISDOpcodes.h:741</a></div></div>
<div class="ttc" id="structllvm_1_1MachinePointerInfo_html"><div class="ttname"><a href="structllvm_1_1MachinePointerInfo.html">llvm::MachinePointerInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="MachineMemOperand_8h_source.html#l00032">MachineMemOperand.h:32</a></div></div>
<div class="ttc" id="classllvm_1_1SDNode_html_aff84cd98daca4f1901020fb99845fcfc"><div class="ttname"><a href="classllvm_1_1SDNode.html#aff84cd98daca4f1901020fb99845fcfc">llvm::SDNode::getConstantOperandVal</a></div><div class="ttdeci">uint64_t getConstantOperandVal(unsigned Num) const </div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAG_8cpp_source.html#l06248">SelectionDAG.cpp:6248</a></div></div>
<div class="ttc" id="classllvm_1_1APInt_html_af3deb6522c4fe2043fe07af2ec90190c"><div class="ttname"><a href="classllvm_1_1APInt.html#af3deb6522c4fe2043fe07af2ec90190c">llvm::APInt::isPowerOf2</a></div><div class="ttdeci">bool isPowerOf2() const </div><div class="ttdoc">Check if this APInt&amp;#39;s value is a power of two greater than zero. </div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l00390">APInt.h:390</a></div></div>
<div class="ttc" id="Target_2README_8txt_html_ab335e668fd33542ea14a2c7b527e64d3"><div class="ttname"><a href="Target_2README_8txt.html#ab335e668fd33542ea14a2c7b527e64d3">n</a></div><div class="ttdeci">The same transformation can work with an even modulo with the addition of a and shrink the compare RHS by the same amount Unless the target supports that transformation probably isn t worthwhile The transformation can also easily be made to work with non zero equality for n</div><div class="ttdef"><b>Definition:</b> <a href="Target_2README_8txt_source.html#l00723">Target/README.txt:723</a></div></div>
<div class="ttc" id="classllvm_1_1SelectionDAG_html_a2afe36f1344e00c9ef5f8cdb39d21890"><div class="ttname"><a href="classllvm_1_1SelectionDAG.html#a2afe36f1344e00c9ef5f8cdb39d21890">llvm::SelectionDAG::getRoot</a></div><div class="ttdeci">const SDValue &amp; getRoot() const </div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAG_8h_source.html#l00328">SelectionDAG.h:328</a></div></div>
<div class="ttc" id="DAGCombiner_8cpp_html_aec1e6891acbf695c615301db72893862"><div class="ttname"><a href="DAGCombiner_8cpp.html#aec1e6891acbf695c615301db72893862">isNegatibleForFree</a></div><div class="ttdeci">static char isNegatibleForFree(SDValue Op, bool LegalOperations, const TargetLowering &amp;TLI, const TargetOptions *Options, unsigned Depth=0)</div><div class="ttdef"><b>Definition:</b> <a href="DAGCombiner_8cpp_source.html#l00427">DAGCombiner.cpp:427</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110ad1657dbc1957901a6d9cd224efbc0f28"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ad1657dbc1957901a6d9cd224efbc0f28">llvm::ISD::UREM</a></div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00176">ISDOpcodes.h:176</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110a19cd524269b035941434cce28b585715"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a19cd524269b035941434cce28b585715">llvm::ISD::ROTR</a></div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00306">ISDOpcodes.h:306</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a910795e8d77c1545da0683c0e1cb81ee"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a910795e8d77c1545da0683c0e1cb81ee">llvm::ISD::isEXTLoad</a></div><div class="ttdeci">bool isEXTLoad(const SDNode *N)</div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l01901">SelectionDAGNodes.h:1901</a></div></div>
<div class="ttc" id="classllvm_1_1MemSDNode_html_a2fa8491ab36125d7f5dd38d3a4868934"><div class="ttname"><a href="classllvm_1_1MemSDNode.html#a2fa8491ab36125d7f5dd38d3a4868934">llvm::MemSDNode::getPointerInfo</a></div><div class="ttdeci">const MachinePointerInfo &amp; getPointerInfo() const </div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l01036">SelectionDAGNodes.h:1036</a></div></div>
<div class="ttc" id="classllvm_1_1MachineFrameInfo_html_aefac52e417d31959e35868879aba672b"><div class="ttname"><a href="classllvm_1_1MachineFrameInfo.html#aefac52e417d31959e35868879aba672b">llvm::MachineFrameInfo::getObjectOffset</a></div><div class="ttdeci">int64_t getObjectOffset(int ObjectIdx) const </div><div class="ttdef"><b>Definition:</b> <a href="MachineFrameInfo_8h_source.html#l00394">MachineFrameInfo.h:394</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a7da84980dd2ee06405d74303cfb90485"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a7da84980dd2ee06405d74303cfb90485">llvm::ISD::isUNINDEXEDLoad</a></div><div class="ttdeci">bool isUNINDEXEDLoad(const SDNode *N)</div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l01922">SelectionDAGNodes.h:1922</a></div></div>
<div class="ttc" id="classllvm_1_1LoadSDNode_html_ae769a35bdc5f1748a40134166a312901"><div class="ttname"><a href="classllvm_1_1LoadSDNode.html#ae769a35bdc5f1748a40134166a312901">llvm::LoadSDNode::getOffset</a></div><div class="ttdeci">const SDValue &amp; getOffset() const </div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l01740">SelectionDAGNodes.h:1740</a></div></div>
<div class="ttc" id="structllvm_1_1EVT_html_ac267a86695d58fe541ef96f8c60c1b0f"><div class="ttname"><a href="structllvm_1_1EVT.html#ac267a86695d58fe541ef96f8c60c1b0f">llvm::EVT::bitsGT</a></div><div class="ttdeci">bool bitsGT(EVT VT) const </div><div class="ttdoc">bitsGT - Return true if this has more bits than VT. </div><div class="ttdef"><b>Definition:</b> <a href="ValueTypes_8h_source.html#l00723">ValueTypes.h:723</a></div></div>
<div class="ttc" id="classllvm_1_1ShuffleVectorSDNode_html_a6fe922cdd5bea1aee12d8719bac484d3"><div class="ttname"><a href="classllvm_1_1ShuffleVectorSDNode.html#a6fe922cdd5bea1aee12d8719bac484d3">llvm::ShuffleVectorSDNode::getMask</a></div><div class="ttdeci">ArrayRef&lt; int &gt; getMask() const </div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l01220">SelectionDAGNodes.h:1220</a></div></div>
<div class="ttc" id="classllvm_1_1APInt_html_aac277496191547e487eea07f09dffd4b"><div class="ttname"><a href="classllvm_1_1APInt.html#aac277496191547e487eea07f09dffd4b">llvm::APInt::countTrailingZeros</a></div><div class="ttdeci">unsigned countTrailingZeros() const </div><div class="ttdoc">Count the number of trailing zero bits. </div><div class="ttdef"><b>Definition:</b> <a href="APInt_8cpp_source.html#l00736">APInt.cpp:736</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110ad469508535ce2082a1ab1f0e429187b8"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ad469508535ce2082a1ab1f0e429187b8">llvm::ISD::TokenFactor</a></div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00050">ISDOpcodes.h:50</a></div></div>
<div class="ttc" id="classllvm_1_1DataLayout_html_abb381519d34dcb9ccf673bf7689d0721"><div class="ttname"><a href="classllvm_1_1DataLayout.html#abb381519d34dcb9ccf673bf7689d0721">llvm::DataLayout::getABITypeAlignment</a></div><div class="ttdeci">unsigned getABITypeAlignment(Type *Ty) const </div><div class="ttdef"><b>Definition:</b> <a href="DataLayout_8cpp_source.html#l00582">DataLayout.cpp:582</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_ac78d4df51ca05e4fb1630a01e07de434"><div class="ttname"><a href="namespacellvm_1_1ISD.html#ac78d4df51ca05e4fb1630a01e07de434">llvm::ISD::isBuildVectorAllOnes</a></div><div class="ttdeci">bool isBuildVectorAllOnes(const SDNode *N)</div><div class="ttdoc">Node predicates. </div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAG_8cpp_source.html#l00097">SelectionDAG.cpp:97</a></div></div>
<div class="ttc" id="DAGCombiner_8cpp_html_a631357f1796c922cce73dae4bff6018f"><div class="ttname"><a href="DAGCombiner_8cpp.html#a631357f1796c922cce73dae4bff6018f">canFoldInAddressingMode</a></div><div class="ttdeci">static bool canFoldInAddressingMode(SDNode *N, SDNode *Use, SelectionDAG &amp;DAG, const TargetLowering &amp;TLI)</div><div class="ttdef"><b>Definition:</b> <a href="DAGCombiner_8cpp_source.html#l07055">DAGCombiner.cpp:7055</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110a4a055321c361a0f6ee77ed764730ffc1"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a4a055321c361a0f6ee77ed764730ffc1">llvm::ISD::SRA</a></div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00306">ISDOpcodes.h:306</a></div></div>
<div class="ttc" id="classllvm_1_1GlobalValue_html"><div class="ttname"><a href="classllvm_1_1GlobalValue.html">llvm::GlobalValue</a></div><div class="ttdef"><b>Definition:</b> <a href="GlobalValue_8h_source.html#l00029">GlobalValue.h:29</a></div></div>
<div class="ttc" id="namespacellvm_1_1X86II_html_a97dc14052814702ba0e2b14fb14dd02da41e3661a4c59a694dcd9b978acdde1a9"><div class="ttname"><a href="namespacellvm_1_1X86II.html#a97dc14052814702ba0e2b14fb14dd02da41e3661a4c59a694dcd9b978acdde1a9">llvm::X86II::DC</a></div><div class="ttdef"><b>Definition:</b> <a href="X86BaseInfo_8h_source.html#l00331">X86BaseInfo.h:331</a></div></div>
<div class="ttc" id="classllvm_1_1SelectionDAG_html_a17becda56598e1d6b0d8fda77cd2fbe7"><div class="ttname"><a href="classllvm_1_1SelectionDAG.html#a17becda56598e1d6b0d8fda77cd2fbe7">llvm::SelectionDAG::getNOT</a></div><div class="ttdeci">SDValue getNOT(SDLoc DL, SDValue Val, EVT VT)</div><div class="ttdoc">getNOT - Create a bitwise NOT operation as (XOR Val, -1). </div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAG_8cpp_source.html#l00952">SelectionDAG.cpp:952</a></div></div>
<div class="ttc" id="classllvm_1_1ilist__iterator_html"><div class="ttname"><a href="classllvm_1_1ilist__iterator.html">llvm::ilist_iterator</a></div><div class="ttdef"><b>Definition:</b> <a href="ilist_8h_source.html#l00050">ilist.h:50</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110a1ddf36330110b4abea43fe390bea9ef9"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a1ddf36330110b4abea43fe390bea9ef9">llvm::ISD::UADDO</a></div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00213">ISDOpcodes.h:213</a></div></div>
<div class="ttc" id="Target_2ARM_2README_8txt_html_a1b45f45820a60c09244a87eb59824aec"><div class="ttname"><a href="Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a></div><div class="ttdeci">add sub stmia L5 ldr r0 bl L_printf $stub Instead of a and a wouldn t it be better to do three moves *Return an aggregate type is even return S</div><div class="ttdef"><b>Definition:</b> <a href="Target_2ARM_2README_8txt_source.html#l00197">Target/ARM/README.txt:197</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_ad4d48171b87ca51ff54c10a436bac4d7a8d89c7da4444d9ec11667aa369abc5f7"><div class="ttname"><a href="namespacellvm_1_1ISD.html#ad4d48171b87ca51ff54c10a436bac4d7a8d89c7da4444d9ec11667aa369abc5f7">llvm::ISD::ZEXTLOAD</a></div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00701">ISDOpcodes.h:701</a></div></div>
<div class="ttc" id="classllvm_1_1SmallPtrSet_html"><div class="ttname"><a href="classllvm_1_1SmallPtrSet.html">llvm::SmallPtrSet</a></div><div class="ttdef"><b>Definition:</b> <a href="SmallPtrSet_8h_source.html#l00236">SmallPtrSet.h:236</a></div></div>
<div class="ttc" id="classllvm_1_1SmallPtrSet_html_a2ce650c1d4a48661b501206d04b6ab04"><div class="ttname"><a href="classllvm_1_1SmallPtrSet.html#a2ce650c1d4a48661b501206d04b6ab04">llvm::SmallPtrSet::erase</a></div><div class="ttdeci">bool erase(PtrType Ptr)</div><div class="ttdef"><b>Definition:</b> <a href="SmallPtrSet_8h_source.html#l00259">SmallPtrSet.h:259</a></div></div>
<div class="ttc" id="classllvm_1_1TargetMachine_html_a5af2fed99951774b6a14d30ec6e73792"><div class="ttname"><a href="classllvm_1_1TargetMachine.html#a5af2fed99951774b6a14d30ec6e73792">llvm::TargetMachine::getSubtarget</a></div><div class="ttdeci">const STC &amp; getSubtarget() const </div><div class="ttdef"><b>Definition:</b> <a href="Target_2TargetMachine_8h_source.html#l00132">Target/TargetMachine.h:132</a></div></div>
<div class="ttc" id="classllvm_1_1SelectionDAG_html_ac493b7df1666d70c1b355c82028148f0"><div class="ttname"><a href="classllvm_1_1SelectionDAG.html#ac493b7df1666d70c1b355c82028148f0">llvm::SelectionDAG::allnodes_begin</a></div><div class="ttdeci">allnodes_const_iterator allnodes_begin() const </div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAG_8h_source.html#l00317">SelectionDAG.h:317</a></div></div>
<div class="ttc" id="structllvm_1_1TargetLowering_1_1DAGCombinerInfo_html_a2e1d73eb122a4b894d4f2b08ef46ffdf"><div class="ttname"><a href="structllvm_1_1TargetLowering_1_1DAGCombinerInfo.html#a2e1d73eb122a4b894d4f2b08ef46ffdf">llvm::TargetLowering::DAGCombinerInfo::RemoveFromWorklist</a></div><div class="ttdeci">void RemoveFromWorklist(SDNode *N)</div><div class="ttdef"><b>Definition:</b> <a href="DAGCombiner_8cpp_source.html#l00395">DAGCombiner.cpp:395</a></div></div>
<div class="ttc" id="TargetOptions_8h_html"><div class="ttname"><a href="TargetOptions_8h.html">TargetOptions.h</a></div></div>
<div class="ttc" id="classllvm_1_1APFloat_html_aec02d46854c76f20a6da7002e390f612"><div class="ttname"><a href="classllvm_1_1APFloat.html#aec02d46854c76f20a6da7002e390f612">llvm::APFloat::isNegative</a></div><div class="ttdeci">bool isNegative() const </div><div class="ttdef"><b>Definition:</b> <a href="APFloat_8h_source.html#l00361">APFloat.h:361</a></div></div>
<div class="ttc" id="namespacellvm_html_aa6d856e4879bb775617f8c3634773b7aa805f5e0d60c9ebc5b134bc9190569a50"><div class="ttname"><a href="namespacellvm.html#aa6d856e4879bb775617f8c3634773b7aa805f5e0d60c9ebc5b134bc9190569a50">llvm::AfterLegalizeVectorOps</a></div><div class="ttdef"><b>Definition:</b> <a href="DAGCombine_8h_source.html#l00019">DAGCombine.h:19</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110a7415ab9f2172c59a2ee7c7a02afa56a4"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7415ab9f2172c59a2ee7c7a02afa56a4">llvm::ISD::OR</a></div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00295">ISDOpcodes.h:295</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110a9329e79f62e9ab9b41cfbcafd314bcbd"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a9329e79f62e9ab9b41cfbcafd314bcbd">llvm::ISD::EXTRACT_VECTOR_ELT</a></div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00251">ISDOpcodes.h:251</a></div></div>
<div class="ttc" id="classllvm_1_1DataLayout_html_a1d6fcc02e91ba24510aba42660c90e29"><div class="ttname"><a href="classllvm_1_1DataLayout.html#a1d6fcc02e91ba24510aba42660c90e29">llvm::DataLayout::getTypeAllocSize</a></div><div class="ttdeci">uint64_t getTypeAllocSize(Type *Ty) const </div><div class="ttdef"><b>Definition:</b> <a href="DataLayout_8h_source.html#l00326">DataLayout.h:326</a></div></div>
<div class="ttc" id="classllvm_1_1MemSDNode_html_ad8e64770a04af6b3da2099477e7c28de"><div class="ttname"><a href="classllvm_1_1MemSDNode.html#ad8e64770a04af6b3da2099477e7c28de">llvm::MemSDNode::isInvariant</a></div><div class="ttdeci">bool isInvariant() const </div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l01010">SelectionDAGNodes.h:1010</a></div></div>
<div class="ttc" id="Target_2README_8txt_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">i</div><div class="ttdef"><b>Definition:</b> <a href="Target_2README_8txt_source.html#l00029">Target/README.txt:29</a></div></div>
<div class="ttc" id="classllvm_1_1TargetLoweringBase_html_a09bdc91589b715806d421ccbc540347d"><div class="ttname"><a href="classllvm_1_1TargetLoweringBase.html#a09bdc91589b715806d421ccbc540347d">llvm::TargetLoweringBase::getBooleanContents</a></div><div class="ttdeci">BooleanContent getBooleanContents(bool isVec) const </div><div class="ttdef"><b>Definition:</b> <a href="TargetLowering_8h_source.html#l00240">TargetLowering.h:240</a></div></div>
<div class="ttc" id="Target_2README_8txt_html_a2a2df5a25b9c703e74e82b48a75d0c3d"><div class="ttname"><a href="Target_2README_8txt.html#a2a2df5a25b9c703e74e82b48a75d0c3d">C1</a></div><div class="ttdeci">instcombine should handle this C2 when C1</div><div class="ttdef"><b>Definition:</b> <a href="Target_2README_8txt_source.html#l00300">Target/README.txt:300</a></div></div>
<div class="ttc" id="classllvm_1_1TargetLoweringBase_html_a8612b7f63f97d7056a6c0858272e9edf"><div class="ttname"><a href="classllvm_1_1TargetLoweringBase.html#a8612b7f63f97d7056a6c0858272e9edf">llvm::TargetLoweringBase::isVectorClearMaskLegal</a></div><div class="ttdeci">virtual bool isVectorClearMaskLegal(const SmallVectorImpl&lt; int &gt; &amp;, EVT) const </div><div class="ttdef"><b>Definition:</b> <a href="TargetLowering_8h_source.html#l00413">TargetLowering.h:413</a></div></div>
<div class="ttc" id="structMemOpLink_html_ad7d8017dafe8cd2c41a5be8946dac71e"><div class="ttname"><a href="structMemOpLink.html#ad7d8017dafe8cd2c41a5be8946dac71e">MemOpLink::MemNode</a></div><div class="ttdeci">LSBaseSDNode * MemNode</div><div class="ttdef"><b>Definition:</b> <a href="DAGCombiner_8cpp_source.html#l08538">DAGCombiner.cpp:8538</a></div></div>
<div class="ttc" id="classllvm_1_1SelectionDAG_html"><div class="ttname"><a href="classllvm_1_1SelectionDAG.html">llvm::SelectionDAG</a></div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAG_8h_source.html#l00169">SelectionDAG.h:169</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110a8745901e68ed76ceaf48791715cefcb4"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a8745901e68ed76ceaf48791715cefcb4">llvm::ISD::FP_ROUND_INREG</a></div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00408">ISDOpcodes.h:408</a></div></div>
<div class="ttc" id="classllvm_1_1APInt_html_a474f562a4871689af74b0fd1ae42daa1"><div class="ttname"><a href="classllvm_1_1APInt.html#a474f562a4871689af74b0fd1ae42daa1">llvm::APInt::logBase2</a></div><div class="ttdeci">unsigned logBase2() const </div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l01500">APInt.h:1500</a></div></div>
<div class="ttc" id="classllvm_1_1SDNode_html_a7ee80bb807d0f88ecbfbc44607228ef6"><div class="ttname"><a href="classllvm_1_1SDNode.html#a7ee80bb807d0f88ecbfbc44607228ef6">llvm::SDNode::isPredecessorOf</a></div><div class="ttdeci">bool isPredecessorOf(const SDNode *N) const </div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l00523">SelectionDAGNodes.h:523</a></div></div>
<div class="ttc" id="classllvm_1_1SmallVector_html"><div class="ttname"><a href="classllvm_1_1SmallVector.html">llvm::SmallVector</a></div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00880">SmallVector.h:880</a></div></div>
<div class="ttc" id="classllvm_1_1Attribute_html_aab7ee4b8fd1d3e7e4cea87868855e60ea2ac83e0612ce8f8d69651cd529061feb"><div class="ttname"><a href="classllvm_1_1Attribute.html#aab7ee4b8fd1d3e7e4cea87868855e60ea2ac83e0612ce8f8d69651cd529061feb">llvm::Attribute::OptimizeForSize</a></div><div class="ttdoc">opt_size </div><div class="ttdef"><b>Definition:</b> <a href="Attributes_8h_source.html#l00091">Attributes.h:91</a></div></div>
<div class="ttc" id="classllvm_1_1SelectionDAG_html_ad6ff413bea6f8195d8e6f29f4fc519c4"><div class="ttname"><a href="classllvm_1_1SelectionDAG.html#ad6ff413bea6f8195d8e6f29f4fc519c4">llvm::SelectionDAG::getExtLoad</a></div><div class="ttdeci">SDValue getExtLoad(ISD::LoadExtType ExtType, SDLoc dl, EVT VT, SDValue Chain, SDValue Ptr, MachinePointerInfo PtrInfo, EVT MemVT, bool isVolatile, bool isNonTemporal, unsigned Alignment, const MDNode *TBAAInfo=0)</div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAG_8cpp_source.html#l04586">SelectionDAG.cpp:4586</a></div></div>
<div class="ttc" id="classllvm_1_1MVT_html_afd69b4f2dff97a2d7c0192cc769ef50caffc152986796ab57023f65116d2ee1b2"><div class="ttname"><a href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50caffc152986796ab57023f65116d2ee1b2">llvm::MVT::f128</a></div><div class="ttdef"><b>Definition:</b> <a href="ValueTypes_8h_source.html#l00057">ValueTypes.h:57</a></div></div>
<div class="ttc" id="classllvm_1_1Value_html_a0cf3748dba54f931bb1241ae4adc76bc"><div class="ttname"><a href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">llvm::Value::getType</a></div><div class="ttdeci">Type * getType() const </div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00111">Value.h:111</a></div></div>
<div class="ttc" id="classllvm_1_1MVT_html_afd69b4f2dff97a2d7c0192cc769ef50ca586bae91020e6d8cccfe0995f527606f"><div class="ttname"><a href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50ca586bae91020e6d8cccfe0995f527606f">llvm::MVT::f32</a></div><div class="ttdef"><b>Definition:</b> <a href="ValueTypes_8h_source.html#l00054">ValueTypes.h:54</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a933d79e63e855d7c90bf161355c008ec"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a933d79e63e855d7c90bf161355c008ec">llvm::ISD::allOperandsUndef</a></div><div class="ttdeci">bool allOperandsUndef(const SDNode *N)</div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAG_8cpp_source.html#l00206">SelectionDAG.cpp:206</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110ae8167e4f6fa1bfb30f074ba620b81782"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ae8167e4f6fa1bfb30f074ba620b81782">llvm::ISD::BRCOND</a></div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00490">ISDOpcodes.h:490</a></div></div>
<div class="ttc" id="classllvm_1_1SelectionDAG_html_a9a66b00ea9db7d80bf1bcbbcaa108239"><div class="ttname"><a href="classllvm_1_1SelectionDAG.html#a9a66b00ea9db7d80bf1bcbbcaa108239">llvm::SelectionDAG::getIntPtrConstant</a></div><div class="ttdeci">SDValue getIntPtrConstant(uint64_t Val, bool isTarget=false)</div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAG_8cpp_source.html#l01065">SelectionDAG.cpp:1065</a></div></div>
<div class="ttc" id="classllvm_1_1MemSDNode_html_ae3cb6fbf8c8cb79e10ac61bd98c85211"><div class="ttname"><a href="classllvm_1_1MemSDNode.html#ae3cb6fbf8c8cb79e10ac61bd98c85211">llvm::MemSDNode::getChain</a></div><div class="ttdeci">const SDValue &amp; getChain() const </div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l01053">SelectionDAGNodes.h:1053</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_ac3c3cf58d6d631af6a172457304d3d07aeded54fe1be320194e9ff0f5825df0e5"><div class="ttname"><a href="namespacellvm_1_1ISD.html#ac3c3cf58d6d631af6a172457304d3d07aeded54fe1be320194e9ff0f5825df0e5">llvm::ISD::SETCC_INVALID</a></div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00747">ISDOpcodes.h:747</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110a19328c462764af5f4699fb1698dad994"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a19328c462764af5f4699fb1698dad994">llvm::ISD::BSWAP</a></div><div class="ttdoc">Byte Swap and Counting operators. </div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00309">ISDOpcodes.h:309</a></div></div>
<div class="ttc" id="classllvm_1_1MemSDNode_html_a89e2b5e3fb867b4040f893c6ae3d2132"><div class="ttname"><a href="classllvm_1_1MemSDNode.html#a89e2b5e3fb867b4040f893c6ae3d2132">llvm::MemSDNode::getMemOperand</a></div><div class="ttdeci">MachineMemOperand * getMemOperand() const </div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l01034">SelectionDAGNodes.h:1034</a></div></div>
<div class="ttc" id="classllvm_1_1CondCodeSDNode_html"><div class="ttname"><a href="classllvm_1_1CondCodeSDNode.html">llvm::CondCodeSDNode</a></div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l01619">SelectionDAGNodes.h:1619</a></div></div>
<div class="ttc" id="classllvm_1_1SDLoc_html"><div class="ttname"><a href="classllvm_1_1SDLoc.html">llvm::SDLoc</a></div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l00799">SelectionDAGNodes.h:799</a></div></div>
<div class="ttc" id="namespacellvm_html_aeefd21a8a609ad0811323352e2576a28"><div class="ttname"><a href="namespacellvm.html#aeefd21a8a609ad0811323352e2576a28">llvm::operator&gt;=</a></div><div class="ttdeci">void operator&gt;=(const Optional&lt; T &gt; &amp;X, const Optional&lt; U &gt; &amp;Y)</div><div class="ttdoc">Poison comparison between two Optional objects. Clients needs to explicitly compare the underlying va...</div></div>
<div class="ttc" id="structllvm_1_1MachinePointerInfo_html_a23e5cd18f87dae8314d615484032d6a2"><div class="ttname"><a href="structllvm_1_1MachinePointerInfo.html#a23e5cd18f87dae8314d615484032d6a2">llvm::MachinePointerInfo::getAddrSpace</a></div><div class="ttdeci">unsigned getAddrSpace() const </div><div class="ttdef"><b>Definition:</b> <a href="MachineInstr_8cpp_source.html#l00391">MachineInstr.cpp:391</a></div></div>
<div class="ttc" id="namespacellvm_1_1A64SE_html_a01fd45cc55587b985e98c297348da443a83395d5a6e29fac625c8166616402236"><div class="ttname"><a href="namespacellvm_1_1A64SE.html#a01fd45cc55587b985e98c297348da443a83395d5a6e29fac625c8166616402236">llvm::A64SE::ROR</a></div><div class="ttdef"><b>Definition:</b> <a href="AArch64BaseInfo_8h_source.html#l00295">AArch64BaseInfo.h:295</a></div></div>
<div class="ttc" id="classllvm_1_1MachineFunction_html_a4ad4295a88187ea1ae12ecfcfa18a70f"><div class="ttname"><a href="classllvm_1_1MachineFunction.html#a4ad4295a88187ea1ae12ecfcfa18a70f">llvm::MachineFunction::getFrameInfo</a></div><div class="ttdeci">MachineFrameInfo * getFrameInfo()</div><div class="ttdef"><b>Definition:</b> <a href="MachineFunction_8h_source.html#l00174">MachineFunction.h:174</a></div></div>
<div class="ttc" id="classllvm_1_1SDNode_html"><div class="ttname"><a href="classllvm_1_1SDNode.html">llvm::SDNode</a></div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l00306">SelectionDAGNodes.h:306</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_ab0a32eac8dc8dc257cf19864daa8c04f"><div class="ttname"><a href="namespacellvm_1_1ISD.html#ab0a32eac8dc8dc257cf19864daa8c04f">llvm::ISD::getSetCCInverse</a></div><div class="ttdeci">CondCode getSetCCInverse(CondCode Operation, bool isInteger)</div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAG_8cpp_source.html#l00234">SelectionDAG.cpp:234</a></div></div>
<div class="ttc" id="namespacellvm_1_1A64DB_html_a6fce8157775f3ec93f326b52b0f1e0f5ad61b145eb8cbab18feb1b2e2ce269a7e"><div class="ttname"><a href="namespacellvm_1_1A64DB.html#a6fce8157775f3ec93f326b52b0f1e0f5ad61b145eb8cbab18feb1b2e2ce269a7e">llvm::A64DB::LD</a></div><div class="ttdef"><b>Definition:</b> <a href="AArch64BaseInfo_8h_source.html#l00177">AArch64BaseInfo.h:177</a></div></div>
<div class="ttc" id="classllvm_1_1TargetLoweringBase_html_a88a8b01d4dbc2ebd81244d1eb459b193a26f35604723482a1aee6514940c2987d"><div class="ttname"><a href="classllvm_1_1TargetLoweringBase.html#a88a8b01d4dbc2ebd81244d1eb459b193a26f35604723482a1aee6514940c2987d">llvm::TargetLoweringBase::TypePromoteInteger</a></div><div class="ttdef"><b>Definition:</b> <a href="TargetLowering_8h_source.html#l00091">TargetLowering.h:91</a></div></div>
<div class="ttc" id="DAGCombiner_8cpp_html_a7de4946ef46274f66c2c0d0e41abf552"><div class="ttname"><a href="DAGCombiner_8cpp.html#a7de4946ef46274f66c2c0d0e41abf552">SplitVSETCC</a></div><div class="ttdeci">static std::pair&lt; SDValue, SDValue &gt; SplitVSETCC(const SDNode *N, SelectionDAG &amp;DAG)</div><div class="ttdef"><b>Definition:</b> <a href="DAGCombiner_8cpp_source.html#l04275">DAGCombiner.cpp:4275</a></div></div>
<div class="ttc" id="namespacellvm_html_a7c46c742c31be54870e2038048e6b391"><div class="ttname"><a href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">llvm::dbgs</a></div><div class="ttdeci">raw_ostream &amp; dbgs()</div><div class="ttdoc">dbgs - Return a circular-buffered debug stream. </div><div class="ttdef"><b>Definition:</b> <a href="Debug_8cpp_source.html#l00101">Debug.cpp:101</a></div></div>
<div class="ttc" id="namespacellvm_html_a646986783f35e0fef8988f0f28d2589f"><div class="ttname"><a href="namespacellvm.html#a646986783f35e0fef8988f0f28d2589f">llvm::Log2_32</a></div><div class="ttdeci">unsigned Log2_32(uint32_t Value)</div><div class="ttdef"><b>Definition:</b> <a href="MathExtras_8h_source.html#l00443">MathExtras.h:443</a></div></div>
<div class="ttc" id="namespacestd_html_ab8424022895aee3e366fb9a32f2883cb"><div class="ttname"><a href="namespacestd.html#ab8424022895aee3e366fb9a32f2883cb">std::swap</a></div><div class="ttdeci">void swap(llvm::BitVector &amp;LHS, llvm::BitVector &amp;RHS)</div><div class="ttdoc">Implement std::swap in terms of BitVector swap. </div><div class="ttdef"><b>Definition:</b> <a href="BitVector_8h_source.html#l00591">BitVector.h:591</a></div></div>
<div class="ttc" id="classllvm_1_1Function_html_a72873ed64b7be01507a2248b8e756ec8"><div class="ttname"><a href="classllvm_1_1Function.html#a72873ed64b7be01507a2248b8e756ec8">llvm::Function::getAttributes</a></div><div class="ttdeci">AttributeSet getAttributes() const </div><div class="ttdoc">Return the attribute list for this Function. </div><div class="ttdef"><b>Definition:</b> <a href="Function_8h_source.html#l00170">Function.h:170</a></div></div>
<div class="ttc" id="classllvm_1_1MemSDNode_html_a23670ceb5797afa3d45ca1a9b011fd87"><div class="ttname"><a href="classllvm_1_1MemSDNode.html#a23670ceb5797afa3d45ca1a9b011fd87">llvm::MemSDNode::getTBAAInfo</a></div><div class="ttdeci">const MDNode * getTBAAInfo() const </div><div class="ttdoc">Returns the TBAAInfo that describes the dereference. </div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l01024">SelectionDAGNodes.h:1024</a></div></div>
<div class="ttc" id="classllvm_1_1LoadSDNode_html_af15fb8b2d4c9f295bdcf85a1eb506702"><div class="ttname"><a href="classllvm_1_1LoadSDNode.html#af15fb8b2d4c9f295bdcf85a1eb506702">llvm::LoadSDNode::getExtensionType</a></div><div class="ttdeci">ISD::LoadExtType getExtensionType() const </div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l01735">SelectionDAGNodes.h:1735</a></div></div>
<div class="ttc" id="classllvm_1_1APInt_html"><div class="ttname"><a href="classllvm_1_1APInt.html">llvm::APInt</a></div><div class="ttdoc">Class for arbitrary precision integers. </div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l00075">APInt.h:75</a></div></div>
<div class="ttc" id="DAGCombiner_8cpp_html_af44b8fb65d2366f4cacc6845f751c5ba"><div class="ttname"><a href="DAGCombiner_8cpp.html#af44b8fb65d2366f4cacc6845f751c5ba">isOneUseSetCC</a></div><div class="ttdeci">static bool isOneUseSetCC(SDValue N)</div><div class="ttdef"><b>Definition:</b> <a href="DAGCombiner_8cpp_source.html#l00599">DAGCombiner.cpp:599</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110a124ba0f5b2887879212c74a68bc230a3"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a124ba0f5b2887879212c74a68bc230a3">llvm::ISD::SREM</a></div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00176">ISDOpcodes.h:176</a></div></div>
<div class="ttc" id="classllvm_1_1TargetLowering_html_ae66d05287096fa4d278d0c5b763fd639"><div class="ttname"><a href="classllvm_1_1TargetLowering.html#ae66d05287096fa4d278d0c5b763fd639">llvm::TargetLowering::IsDesirableToPromoteOp</a></div><div class="ttdeci">virtual bool IsDesirableToPromoteOp(SDValue, EVT &amp;) const </div><div class="ttdef"><b>Definition:</b> <a href="TargetLowering_8h_source.html#l01902">TargetLowering.h:1902</a></div></div>
<div class="ttc" id="DAGCombiner_8cpp_html_ab765652bbe47da8cc58c7f449d8f5fd7"><div class="ttname"><a href="DAGCombiner_8cpp.html#ab765652bbe47da8cc58c7f449d8f5fd7">getBuildPairElt</a></div><div class="ttdeci">static SDNode * getBuildPairElt(SDNode *N, unsigned i)</div><div class="ttdef"><b>Definition:</b> <a href="DAGCombiner_8cpp_source.html#l05642">DAGCombiner.cpp:5642</a></div></div>
<div class="ttc" id="classllvm_1_1BuildVectorSDNode_html"><div class="ttname"><a href="classllvm_1_1BuildVectorSDNode.html">llvm::BuildVectorSDNode</a></div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l01474">SelectionDAGNodes.h:1474</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110a78d0f198115bfe3331ab7cfcf7a40a97"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a78d0f198115bfe3331ab7cfcf7a40a97">llvm::ISD::SELECT</a></div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00316">ISDOpcodes.h:316</a></div></div>
<div class="ttc" id="classllvm_1_1ConstantSDNode_html_ae52ea754f0f064b6440e99103abea366"><div class="ttname"><a href="classllvm_1_1ConstantSDNode.html#ae52ea754f0f064b6440e99103abea366">llvm::ConstantSDNode::getSExtValue</a></div><div class="ttdeci">int64_t getSExtValue() const </div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l01258">SelectionDAGNodes.h:1258</a></div></div>
<div class="ttc" id="classllvm_1_1SDNode_html_a20f382e841761654032bf8b4712e805f"><div class="ttname"><a href="classllvm_1_1SDNode.html#a20f382e841761654032bf8b4712e805f">llvm::SDNode::op_begin</a></div><div class="ttdeci">op_iterator op_begin() const </div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l00560">SelectionDAGNodes.h:560</a></div></div>
<div class="ttc" id="classllvm_1_1TargetLoweringBase_html_a71b07ff24aaa94d58e0e7c35551728d5"><div class="ttname"><a href="classllvm_1_1TargetLoweringBase.html#a71b07ff24aaa94d58e0e7c35551728d5">llvm::TargetLoweringBase::getRegClassFor</a></div><div class="ttdeci">virtual const TargetRegisterClass * getRegClassFor(MVT VT) const </div><div class="ttdef"><b>Definition:</b> <a href="TargetLowering_8h_source.html#l00258">TargetLowering.h:258</a></div></div>
<div class="ttc" id="DAGCombiner_8cpp_html_a55d3de0deed33d70188b2b5a9cab8f00"><div class="ttname"><a href="DAGCombiner_8cpp.html#a55d3de0deed33d70188b2b5a9cab8f00">GetNegatedExpression</a></div><div class="ttdeci">static SDValue GetNegatedExpression(SDValue Op, SelectionDAG &amp;DAG, bool LegalOperations, unsigned Depth=0)</div><div class="ttdef"><b>Definition:</b> <a href="DAGCombiner_8cpp_source.html#l00491">DAGCombiner.cpp:491</a></div></div>
<div class="ttc" id="classllvm_1_1SDNode_html_aef02f2c1bd12936a80611b134b24a47d"><div class="ttname"><a href="classllvm_1_1SDNode.html#aef02f2c1bd12936a80611b134b24a47d">llvm::SDNode::use_end</a></div><div class="ttdeci">static use_iterator use_end()</div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l00500">SelectionDAGNodes.h:500</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110a93fdf85eff945f1a668b4915a051453e"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a93fdf85eff945f1a668b4915a051453e">llvm::ISD::ZERO_EXTEND</a></div><div class="ttdoc">ZERO_EXTEND - Used for integer types, zeroing the new bits. </div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00357">ISDOpcodes.h:357</a></div></div>
<div class="ttc" id="namespacellvm_1_1ARMII_html_ace99f086a3cd38c7477a8f038dae7ff4"><div class="ttname"><a href="namespacellvm_1_1ARMII.html#ace99f086a3cd38c7477a8f038dae7ff4">llvm::ARMII::AddrMode</a></div><div class="ttdeci">AddrMode</div><div class="ttdoc">ARM Addressing Modes. </div><div class="ttdef"><b>Definition:</b> <a href="ARMBaseInfo_8h_source.html#l00234">ARMBaseInfo.h:234</a></div></div>
<div class="ttc" id="classllvm_1_1SelectionDAG_html_af5d5ed0a2c2186ec77b8dd9c38474d3e"><div class="ttname"><a href="classllvm_1_1SelectionDAG.html#af5d5ed0a2c2186ec77b8dd9c38474d3e">llvm::SelectionDAG::getNode</a></div><div class="ttdeci">SDValue getNode(unsigned Opcode, SDLoc DL, EVT VT)</div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAG_8cpp_source.html#l02485">SelectionDAG.cpp:2485</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110a27d5d8ef82302b739ba3ca8be1a5513d"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a27d5d8ef82302b739ba3ca8be1a5513d">llvm::ISD::ANY_EXTEND</a></div><div class="ttdoc">ANY_EXTEND - Used for integer types. The high bits are undefined. </div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00360">ISDOpcodes.h:360</a></div></div>
<div class="ttc" id="DAGCombiner_8cpp_html_ab4dad3fc933e6caae6cffa219ea8797f"><div class="ttname"><a href="DAGCombiner_8cpp.html#ab4dad3fc933e6caae6cffa219ea8797f">CheckForMaskedLoad</a></div><div class="ttdeci">static std::pair&lt; unsigned, unsigned &gt; CheckForMaskedLoad(SDValue V, SDValue Ptr, SDValue Chain)</div><div class="ttdef"><b>Definition:</b> <a href="DAGCombiner_8cpp_source.html#l08136">DAGCombiner.cpp:8136</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110ae8f8f81d8e8d7a557d67622c05786f1d"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ae8f8f81d8e8d7a557d67622c05786f1d">llvm::ISD::ROTL</a></div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00306">ISDOpcodes.h:306</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_aab586f6d9a8433b0121bda4aca5366d5"><div class="ttname"><a href="namespacellvm_1_1ISD.html#aab586f6d9a8433b0121bda4aca5366d5">llvm::ISD::getSetCCOrOperation</a></div><div class="ttdeci">CondCode getSetCCOrOperation(CondCode Op1, CondCode Op2, bool isInteger)</div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAG_8cpp_source.html#l00271">SelectionDAG.cpp:271</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110aeffc3319657e213a530ce583603f7221"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110aeffc3319657e213a530ce583603f7221">llvm::ISD::FCOPYSIGN</a></div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00228">ISDOpcodes.h:228</a></div></div>
<div class="ttc" id="structllvm_1_1TargetLowering_1_1TargetLoweringOpt_html_aa59ebff339822e9d6912a36acbeff118"><div class="ttname"><a href="structllvm_1_1TargetLowering_1_1TargetLoweringOpt.html#aa59ebff339822e9d6912a36acbeff118">llvm::TargetLowering::TargetLoweringOpt::New</a></div><div class="ttdeci">SDValue New</div><div class="ttdef"><b>Definition:</b> <a href="TargetLowering_8h_source.html#l01776">TargetLowering.h:1776</a></div></div>
<div class="ttc" id="DAGCombiner_8cpp_html_a466591fe7edc07ef1ffac406020984bd"><div class="ttname"><a href="DAGCombiner_8cpp.html#a466591fe7edc07ef1ffac406020984bd">partitionShuffleOfConcats</a></div><div class="ttdeci">static SDValue partitionShuffleOfConcats(SDNode *N, SelectionDAG &amp;DAG)</div><div class="ttdef"><b>Definition:</b> <a href="DAGCombiner_8cpp_source.html#l09946">DAGCombiner.cpp:9946</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110a1f61c2422057e10403b2f6003543c300"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a1f61c2422057e10403b2f6003543c300">llvm::ISD::SDIV</a></div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00176">ISDOpcodes.h:176</a></div></div>
<div class="ttc" id="Function_8h_html"><div class="ttname"><a href="Function_8h.html">Function.h</a></div></div>
<div class="ttc" id="structLoadedSliceSorter_html_a687bdab842cbd2351ec1c4361766d6eb"><div class="ttname"><a href="structLoadedSliceSorter.html#a687bdab842cbd2351ec1c4361766d6eb">LoadedSliceSorter::operator()</a></div><div class="ttdeci">bool operator()(const LoadedSlice &amp;LHS, const LoadedSlice &amp;RHS)</div><div class="ttdef"><b>Definition:</b> <a href="DAGCombiner_8cpp_source.html#l07893">DAGCombiner.cpp:7893</a></div></div>
<div class="ttc" id="structMemOpLink_html_ac44d7f65c107349f8ce8a4b2fe417f04"><div class="ttname"><a href="structMemOpLink.html#ac44d7f65c107349f8ce8a4b2fe417f04">MemOpLink::MemOpLink</a></div><div class="ttdeci">MemOpLink(LSBaseSDNode *N, int64_t Offset, unsigned Seq)</div><div class="ttdef"><b>Definition:</b> <a href="DAGCombiner_8cpp_source.html#l08535">DAGCombiner.cpp:8535</a></div></div>
<div class="ttc" id="namespacellvm_1_1APIntOps_html_a684cfe02c582e8d75cd6d457e63e6c25"><div class="ttname"><a href="namespacellvm_1_1APIntOps.html#a684cfe02c582e8d75cd6d457e63e6c25">llvm::APIntOps::And</a></div><div class="ttdeci">APInt And(const APInt &amp;LHS, const APInt &amp;RHS)</div><div class="ttdoc">Bitwise AND function for APInt. </div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l01840">APInt.h:1840</a></div></div>
<div class="ttc" id="classllvm_1_1APInt_html_a46ceedee591f92727b85641794a96061"><div class="ttname"><a href="classllvm_1_1APInt.html#a46ceedee591f92727b85641794a96061">llvm::APInt::getBitsSet</a></div><div class="ttdeci">static APInt getBitsSet(unsigned numBits, unsigned loBit, unsigned hiBit)</div><div class="ttdoc">Get a value with a block of bits set. </div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l00495">APInt.h:495</a></div></div>
<div class="ttc" id="structBaseIndexOffset_html_a9083a41b0525809912f3e00ddba64ab9"><div class="ttname"><a href="structBaseIndexOffset.html#a9083a41b0525809912f3e00ddba64ab9">BaseIndexOffset::BaseIndexOffset</a></div><div class="ttdeci">BaseIndexOffset()</div><div class="ttdef"><b>Definition:</b> <a href="DAGCombiner_8cpp_source.html#l08463">DAGCombiner.cpp:8463</a></div></div>
<div class="ttc" id="classllvm_1_1TargetSubtargetInfo_html"><div class="ttname"><a href="classllvm_1_1TargetSubtargetInfo.html">llvm::TargetSubtargetInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="TargetSubtargetInfo_8h_source.html#l00037">TargetSubtargetInfo.h:37</a></div></div>
<div class="ttc" id="classllvm_1_1SmallVectorTemplateCommon_html_a8a045d250952c0867382a9840ee18fdf"><div class="ttname"><a href="classllvm_1_1SmallVectorTemplateCommon.html#a8a045d250952c0867382a9840ee18fdf">llvm::SmallVectorTemplateCommon&lt; T &gt;::begin</a></div><div class="ttdeci">iterator begin()</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00112">SmallVector.h:112</a></div></div>
<div class="ttc" id="classllvm_1_1MVT_html_afd69b4f2dff97a2d7c0192cc769ef50cac661c912350e3095c85ba75b8dbc17b1"><div class="ttname"><a href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50cac661c912350e3095c85ba75b8dbc17b1">llvm::MVT::f64</a></div><div class="ttdef"><b>Definition:</b> <a href="ValueTypes_8h_source.html#l00055">ValueTypes.h:55</a></div></div>
<div class="ttc" id="namespacellvm_html_a2f883c895f4d244f4ed56ed8a8c160c1"><div class="ttname"><a href="namespacellvm.html#a2f883c895f4d244f4ed56ed8a8c160c1">llvm::operator!=</a></div><div class="ttdeci">bool operator!=(uint64_t V1, const APInt &amp;V2)</div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l01686">APInt.h:1686</a></div></div>
<div class="ttc" id="classllvm_1_1APInt_html_a21260f8037e665d235ace5718cf68bc4"><div class="ttname"><a href="classllvm_1_1APInt.html#a21260f8037e665d235ace5718cf68bc4">llvm::APInt::isAllOnesValue</a></div><div class="ttdeci">bool isAllOnesValue() const </div><div class="ttdoc">Determine if all bits are set. </div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l00340">APInt.h:340</a></div></div>
<div class="ttc" id="AliasAnalysis_8h_html"><div class="ttname"><a href="AliasAnalysis_8h.html">AliasAnalysis.h</a></div></div>
<div class="ttc" id="namespacellvm_html_af36d7e69ab16b64b2e3a48c83aa9f0f6"><div class="ttname"><a href="namespacellvm.html#af36d7e69ab16b64b2e3a48c83aa9f0f6">llvm::MinAlign</a></div><div class="ttdeci">uint64_t MinAlign(uint64_t A, uint64_t B)</div><div class="ttdef"><b>Definition:</b> <a href="MathExtras_8h_source.html#l00535">MathExtras.h:535</a></div></div>
<div class="ttc" id="structBaseIndexOffset_html_a2d206eb2d19831b2315cc904868fafb9"><div class="ttname"><a href="structBaseIndexOffset.html#a2d206eb2d19831b2315cc904868fafb9">BaseIndexOffset::BaseIndexOffset</a></div><div class="ttdeci">BaseIndexOffset(SDValue Base, SDValue Index, int64_t Offset, bool IsIndexSignExt)</div><div class="ttdef"><b>Definition:</b> <a href="DAGCombiner_8cpp_source.html#l08465">DAGCombiner.cpp:8465</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a0a31c08480b7e1029f824c35671f96b4"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a0a31c08480b7e1029f824c35671f96b4">llvm::ISD::isScalarToVector</a></div><div class="ttdeci">bool isScalarToVector(const SDNode *N)</div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAG_8cpp_source.html#l00185">SelectionDAG.cpp:185</a></div></div>
<div class="ttc" id="classllvm_1_1SDUse_html"><div class="ttname"><a href="classllvm_1_1SDUse.html">llvm::SDUse</a></div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l00215">SelectionDAGNodes.h:215</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110a1be4c8da7c68a4c683de1a98b5cc5b9d"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a1be4c8da7c68a4c683de1a98b5cc5b9d">llvm::ISD::ConstantFP</a></div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00061">ISDOpcodes.h:61</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_abee7ecb577fcade34eb16ccb7f503e31a866c29237765ff291c9503abbdca60e1"><div class="ttname"><a href="namespacellvm_1_1ISD.html#abee7ecb577fcade34eb16ccb7f503e31a866c29237765ff291c9503abbdca60e1">llvm::ISD::POST_INC</a></div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00682">ISDOpcodes.h:682</a></div></div>
<div class="ttc" id="classllvm_1_1cl_1_1opt_html"><div class="ttname"><a href="classllvm_1_1cl_1_1opt.html">llvm::cl::opt</a></div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l01149">CommandLine.h:1149</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110ac513a7da1bf74fb3e3c594da8534f2d2"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ac513a7da1bf74fb3e3c594da8534f2d2">llvm::ISD::AND</a></div><div class="ttdoc">Bitwise operators - logical and, logical or, logical xor. </div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00295">ISDOpcodes.h:295</a></div></div>
<div class="ttc" id="classllvm_1_1SDNode_html_ae4cb676e77b9f238058c70faa609a5d7"><div class="ttname"><a href="classllvm_1_1SDNode.html#ae4cb676e77b9f238058c70faa609a5d7">llvm::SDNode::hasAnyUseOfValue</a></div><div class="ttdeci">bool hasAnyUseOfValue(unsigned Value) const </div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAG_8cpp_source.html#l06138">SelectionDAG.cpp:6138</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110a1354c6f8508d6cd697dc89a5d9a52dfd"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a1354c6f8508d6cd697dc89a5d9a52dfd">llvm::ISD::SMUL_LOHI</a></div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00181">ISDOpcodes.h:181</a></div></div>
<div class="ttc" id="classllvm_1_1SelectionDAG_html_a8503b91b7bbfb128a42fa582857f8828"><div class="ttname"><a href="classllvm_1_1SelectionDAG.html#a8503b91b7bbfb128a42fa582857f8828">llvm::SelectionDAG::FoldConstantArithmetic</a></div><div class="ttdeci">SDValue FoldConstantArithmetic(unsigned Opcode, EVT VT, SDNode *Cst1, SDNode *Cst2)</div><div class="ttdoc">FoldConstantArithmetic -. </div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAG_8cpp_source.html#l02769">SelectionDAG.cpp:2769</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110aaa59dd5ec37f21905436b354c0292d9e"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110aaa59dd5ec37f21905436b354c0292d9e">llvm::ISD::SIGN_EXTEND_INREG</a></div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00375">ISDOpcodes.h:375</a></div></div>
<div class="ttc" id="namespacellvm_1_1X86II_html_a97dc14052814702ba0e2b14fb14dd02dad11797b0ad89e5eb13f16d7a2ba9741e"><div class="ttname"><a href="namespacellvm_1_1X86II.html#a97dc14052814702ba0e2b14fb14dd02dad11797b0ad89e5eb13f16d7a2ba9741e">llvm::X86II::OpSize</a></div><div class="ttdef"><b>Definition:</b> <a href="X86BaseInfo_8h_source.html#l00303">X86BaseInfo.h:303</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110a269b81f007000306e3e69d0d290c2159"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a269b81f007000306e3e69d0d290c2159">llvm::ISD::LOAD</a></div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00460">ISDOpcodes.h:460</a></div></div>
<div class="ttc" id="classllvm_1_1TargetMachine_html_ab1fb67187fc37e569cc5171cbebba873"><div class="ttname"><a href="classllvm_1_1TargetMachine.html#ab1fb67187fc37e569cc5171cbebba873">llvm::TargetMachine::Options</a></div><div class="ttdeci">TargetOptions Options</div><div class="ttdef"><b>Definition:</b> <a href="Target_2TargetMachine_8h_source.html#l00105">Target/TargetMachine.h:105</a></div></div>
<div class="ttc" id="structllvm_1_1EVT_html_a8cca25ddb3be86ad23567dc8d36dacd3"><div class="ttname"><a href="structllvm_1_1EVT.html#a8cca25ddb3be86ad23567dc8d36dacd3">llvm::EVT::getSizeInBits</a></div><div class="ttdeci">unsigned getSizeInBits() const </div><div class="ttdoc">getSizeInBits - Return the size of the specified value type in bits. </div><div class="ttdef"><b>Definition:</b> <a href="ValueTypes_8h_source.html#l00779">ValueTypes.h:779</a></div></div>
<div class="ttc" id="DAGCombiner_8cpp_html_aad9b27fb736faf90f342b3fcabf413fb"><div class="ttname"><a href="DAGCombiner_8cpp.html#aad9b27fb736faf90f342b3fcabf413fb">isSetCCEquivalent</a></div><div class="ttdeci">static bool isSetCCEquivalent(SDValue N, SDValue &amp;LHS, SDValue &amp;RHS, SDValue &amp;CC)</div><div class="ttdef"><b>Definition:</b> <a href="DAGCombiner_8cpp_source.html#l00575">DAGCombiner.cpp:575</a></div></div>
<div class="ttc" id="classllvm_1_1SelectionDAG_html_a307e5150c6c85f43348d2b09a69d7591"><div class="ttname"><a href="classllvm_1_1SelectionDAG.html#a307e5150c6c85f43348d2b09a69d7591">llvm::SelectionDAG::ReplaceAllUsesWith</a></div><div class="ttdeci">void ReplaceAllUsesWith(SDValue From, SDValue Op)</div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAG_8cpp_source.html#l05656">SelectionDAG.cpp:5656</a></div></div>
<div class="ttc" id="classllvm_1_1SelectionDAG_html_a5be091659170a3bf7a2cbbd819cfd9ac"><div class="ttname"><a href="classllvm_1_1SelectionDAG.html#a5be091659170a3bf7a2cbbd819cfd9ac">llvm::SelectionDAG::getIndexedStore</a></div><div class="ttdeci">SDValue getIndexedStore(SDValue OrigStoe, SDLoc dl, SDValue Base, SDValue Offset, ISD::MemIndexedMode AM)</div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAG_8cpp_source.html#l04742">SelectionDAG.cpp:4742</a></div></div>
<div class="ttc" id="TargetRegisterInfo_8h_html"><div class="ttname"><a href="TargetRegisterInfo_8h.html">TargetRegisterInfo.h</a></div></div>
<div class="ttc" id="MD5_8cpp_html_ac0eafdc9ee161b71e7af98af736952fd"><div class="ttname"><a href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a></div><div class="ttdeci">#define I(x, y, z)</div><div class="ttdef"><b>Definition:</b> <a href="MD5_8cpp_source.html#l00054">MD5.cpp:54</a></div></div>
<div class="ttc" id="regcomp_8c_html_a0240ac851181b84ac374872dc5434ee4"><div class="ttname"><a href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a></div><div class="ttdeci">#define N</div></div>
<div class="ttc" id="classllvm_1_1LSBaseSDNode_html_a97fbe853685bec84672ff408d2cdca34"><div class="ttname"><a href="classllvm_1_1LSBaseSDNode.html#a97fbe853685bec84672ff408d2cdca34">llvm::LSBaseSDNode::isIndexed</a></div><div class="ttdeci">bool isIndexed() const </div><div class="ttdoc">isIndexed - Return true if this is a pre/post inc/dec load/store. </div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l01707">SelectionDAGNodes.h:1707</a></div></div>
<div class="ttc" id="classllvm_1_1TargetLoweringBase_html_aa61af767c51a95e2dd0dff2001168755a0e2d72cfdcc49d2d189f440b3cc31dff"><div class="ttname"><a href="classllvm_1_1TargetLoweringBase.html#aa61af767c51a95e2dd0dff2001168755a0e2d72cfdcc49d2d189f440b3cc31dff">llvm::TargetLoweringBase::ZeroOrOneBooleanContent</a></div><div class="ttdef"><b>Definition:</b> <a href="TargetLowering_8h_source.html#l00107">TargetLowering.h:107</a></div></div>
<div class="ttc" id="classllvm_1_1SelectionDAG_html_a76ccaa8c8885072ba11aee5133865e36"><div class="ttname"><a href="classllvm_1_1SelectionDAG.html#a76ccaa8c8885072ba11aee5133865e36">llvm::SelectionDAG::getTruncStore</a></div><div class="ttdeci">SDValue getTruncStore(SDValue Chain, SDLoc dl, SDValue Val, SDValue Ptr, MachinePointerInfo PtrInfo, EVT TVT, bool isNonTemporal, bool isVolatile, unsigned Alignment, const MDNode *TBAAInfo=0)</div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAG_8cpp_source.html#l04672">SelectionDAG.cpp:4672</a></div></div>
<div class="ttc" id="classllvm_1_1SDNode_html_a992906781101abb22f6e4d16622bbe24"><div class="ttname"><a href="classllvm_1_1SDNode.html#a992906781101abb22f6e4d16622bbe24">llvm::SDNode::op_end</a></div><div class="ttdeci">op_iterator op_end() const </div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l00561">SelectionDAGNodes.h:561</a></div></div>
<div class="ttc" id="classllvm_1_1ArrayType_html_adf411edc4f135b570ab218079474ce77"><div class="ttname"><a href="classllvm_1_1ArrayType.html#adf411edc4f135b570ab218079474ce77">llvm::ArrayType::get</a></div><div class="ttdeci">static ArrayType * get(Type *ElementType, uint64_t NumElements)</div><div class="ttdef"><b>Definition:</b> <a href="Type_8cpp_source.html#l00679">Type.cpp:679</a></div></div>
<div class="ttc" id="classllvm_1_1SmallVectorTemplateBase_html_a1f2303df9bbee2233c11d61c2f6f7930"><div class="ttname"><a href="classllvm_1_1SmallVectorTemplateBase.html#a1f2303df9bbee2233c11d61c2f6f7930">llvm::SmallVectorTemplateBase&lt; T, isPodLike&lt; T &gt;::value &gt;::pop_back</a></div><div class="ttdeci">void pop_back()</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00260">SmallVector.h:260</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_abee7ecb577fcade34eb16ccb7f503e31a57c3822f99653c422d5a21206adc6e42"><div class="ttname"><a href="namespacellvm_1_1ISD.html#abee7ecb577fcade34eb16ccb7f503e31a57c3822f99653c422d5a21206adc6e42">llvm::ISD::PRE_DEC</a></div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00681">ISDOpcodes.h:681</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110aa35d0a58fdded3d225d512a60aea0951"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110aa35d0a58fdded3d225d512a60aea0951">llvm::ISD::SMULO</a></div><div class="ttdoc">Same for multiplication. </div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00219">ISDOpcodes.h:219</a></div></div>
<div class="ttc" id="classllvm_1_1TargetMachine_html_a70b47eca6a99c87b81f4c1b1455dc090"><div class="ttname"><a href="classllvm_1_1TargetMachine.html#a70b47eca6a99c87b81f4c1b1455dc090">llvm::TargetMachine::getRegisterInfo</a></div><div class="ttdeci">virtual const TargetRegisterInfo * getRegisterInfo() const </div><div class="ttdef"><b>Definition:</b> <a href="Target_2TargetMachine_8h_source.html#l00140">Target/TargetMachine.h:140</a></div></div>
<div class="ttc" id="DAGCombiner_8cpp_html_a4fb41e4d2abb178c37b2a3615e36d877"><div class="ttname"><a href="DAGCombiner_8cpp.html#a4fb41e4d2abb178c37b2a3615e36d877">getInputChainForNode</a></div><div class="ttdeci">static SDValue getInputChainForNode(SDNode *N)</div><div class="ttdef"><b>Definition:</b> <a href="DAGCombiner_8cpp_source.html#l01271">DAGCombiner.cpp:1271</a></div></div>
<div class="ttc" id="namespacellvm_1_1A64CC_html_af5804bc0518be9568f73db566e4d6f46a2a6c4724226f9ccea96d35fd4c131af8"><div class="ttname"><a href="namespacellvm_1_1A64CC.html#af5804bc0518be9568f73db566e4d6f46a2a6c4724226f9ccea96d35fd4c131af8">llvm::A64CC::NV</a></div><div class="ttdef"><b>Definition:</b> <a href="AArch64BaseInfo_8h_source.html#l00046">AArch64BaseInfo.h:46</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a15623094a1ed0cd7163dc786e44c87c9"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a15623094a1ed0cd7163dc786e44c87c9">llvm::ISD::isNON_EXTLoad</a></div><div class="ttdeci">bool isNON_EXTLoad(const SDNode *N)</div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l01894">SelectionDAGNodes.h:1894</a></div></div>
<div class="ttc" id="classllvm_1_1MemSDNode_html_a32aae058f77e7cb4675d3fcb33c93d76"><div class="ttname"><a href="classllvm_1_1MemSDNode.html#a32aae058f77e7cb4675d3fcb33c93d76">llvm::MemSDNode::getSrcValue</a></div><div class="ttdeci">const Value * getSrcValue() const </div><div class="ttdoc">Returns the SrcValue and offset that describes the location of the access. </div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l01020">SelectionDAGNodes.h:1020</a></div></div>
<div class="ttc" id="README-SSE_8txt_html_aadea95510755202aaa1c5ebfe4fcde48"><div class="ttname"><a href="README-SSE_8txt.html#aadea95510755202aaa1c5ebfe4fcde48">c2</a></div><div class="ttdeci">This might compile to this xmm1 xorps xmm0 movss xmm0 ret Now consider if the code caused xmm1 to get spilled This might produce this xmm1 movaps c2(%esp)...xorps%xmm0</div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110af23301e60475124fd80a2cb51f6ba863"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110af23301e60475124fd80a2cb51f6ba863">llvm::ISD::AssertZext</a></div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00057">ISDOpcodes.h:57</a></div></div>
<div class="ttc" id="structConsecutiveMemoryChainSorter_html_a3c8ced0aab28365841780659ff19d744"><div class="ttname"><a href="structConsecutiveMemoryChainSorter.html#a3c8ced0aab28365841780659ff19d744">ConsecutiveMemoryChainSorter::operator()</a></div><div class="ttdeci">bool operator()(MemOpLink LHS, MemOpLink RHS)</div><div class="ttdef"><b>Definition:</b> <a href="DAGCombiner_8cpp_source.html#l08549">DAGCombiner.cpp:8549</a></div></div>
<div class="ttc" id="classllvm_1_1ShuffleVectorSDNode_html_af2ab7a57d7c0b11e2c3a28e28cc4a46d"><div class="ttname"><a href="classllvm_1_1ShuffleVectorSDNode.html#af2ab7a57d7c0b11e2c3a28e28cc4a46d">llvm::ShuffleVectorSDNode::isSplat</a></div><div class="ttdeci">bool isSplat() const </div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l01229">SelectionDAGNodes.h:1229</a></div></div>
<div class="ttc" id="classllvm_1_1SDValue_html_a7d2ad4aa4277eb4e1138ff9791c8fbb7"><div class="ttname"><a href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">llvm::SDValue::getValueType</a></div><div class="ttdeci">EVT getValueType() const </div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l00843">SelectionDAGNodes.h:843</a></div></div>
<div class="ttc" id="classllvm_1_1MVT_html_afd69b4f2dff97a2d7c0192cc769ef50ca707dc1fd6a4179316ffa6ca2516e18dc"><div class="ttname"><a href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50ca707dc1fd6a4179316ffa6ca2516e18dc">llvm::MVT::Untyped</a></div><div class="ttdef"><b>Definition:</b> <a href="ValueTypes_8h_source.html#l00122">ValueTypes.h:122</a></div></div>
<div class="ttc" id="SelectionDAG_8h_html"><div class="ttname"><a href="SelectionDAG_8h.html">SelectionDAG.h</a></div></div>
<div class="ttc" id="LLVMContext_8h_html"><div class="ttname"><a href="LLVMContext_8h.html">LLVMContext.h</a></div></div>
<div class="ttc" id="structllvm_1_1EVT_html_a0e47d5994d9b6fd12125d13d20867ceb"><div class="ttname"><a href="structllvm_1_1EVT.html#a0e47d5994d9b6fd12125d13d20867ceb">llvm::EVT::isByteSized</a></div><div class="ttdeci">bool isByteSized() const </div><div class="ttdoc">isByteSized - Return true if the bit size is a multiple of 8. </div><div class="ttdef"><b>Definition:</b> <a href="ValueTypes_8h_source.html#l00706">ValueTypes.h:706</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110a320898056eadc3254fc601e1362eb9f5"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a320898056eadc3254fc601e1362eb9f5">llvm::ISD::CONCAT_VECTORS</a></div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00257">ISDOpcodes.h:257</a></div></div>
<div class="ttc" id="classllvm_1_1SelectionDAG_html_a78990d91dd364f8bb9e7008d85fd73b8"><div class="ttname"><a href="classllvm_1_1SelectionDAG.html#a78990d91dd364f8bb9e7008d85fd73b8">llvm::SelectionDAG::getSelect</a></div><div class="ttdeci">SDValue getSelect(SDLoc DL, EVT VT, SDValue Cond, SDValue LHS, SDValue RHS)</div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAG_8h_source.html#l00666">SelectionDAG.h:666</a></div></div>
<div class="ttc" id="structllvm_1_1EVT_html_afc4147764cdb5599c67f747813ef9bdc"><div class="ttname"><a href="structllvm_1_1EVT.html#afc4147764cdb5599c67f747813ef9bdc">llvm::EVT::isFloatingPoint</a></div><div class="ttdeci">bool isFloatingPoint() const </div><div class="ttdoc">isFloatingPoint - Return true if this is a FP, or a vector FP type. </div><div class="ttdef"><b>Definition:</b> <a href="ValueTypes_8h_source.html#l00651">ValueTypes.h:651</a></div></div>
<div class="ttc" id="structllvm_1_1TargetLowering_1_1DAGCombinerInfo_html"><div class="ttname"><a href="structllvm_1_1TargetLowering_1_1DAGCombinerInfo.html">llvm::TargetLowering::DAGCombinerInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="TargetLowering_8h_source.html#l01828">TargetLowering.h:1828</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110a4336c27826676e1ef61383cafa999219"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a4336c27826676e1ef61383cafa999219">llvm::ISD::FFLOOR</a></div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00451">ISDOpcodes.h:451</a></div></div>
<div class="ttc" id="classllvm_1_1SDNode_html_a7a49f347b7c1be27687d82d066b2b625"><div class="ttname"><a href="classllvm_1_1SDNode.html#a7a49f347b7c1be27687d82d066b2b625">llvm::SDNode::hasPredecessorHelper</a></div><div class="ttdeci">bool hasPredecessorHelper(const SDNode *N, SmallPtrSet&lt; const SDNode *, 32 &gt; &amp;Visited, SmallVectorImpl&lt; const SDNode * &gt; &amp;Worklist) const </div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAG_8cpp_source.html#l06221">SelectionDAG.cpp:6221</a></div></div>
<div class="ttc" id="classllvm_1_1HandleSDNode_html"><div class="ttname"><a href="classllvm_1_1HandleSDNode.html">llvm::HandleSDNode</a></div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l00942">SelectionDAGNodes.h:942</a></div></div>
<div class="ttc" id="ARMSubtarget_8cpp_html_a4bd80d4e433d9f72af26b364036900dc"><div class="ttname"><a href="ARMSubtarget_8cpp.html#a4bd80d4e433d9f72af26b364036900dc">Align</a></div><div class="ttdeci">static cl::opt&lt; AlignMode &gt; Align(cl::desc(&quot;Load/store alignment support&quot;), cl::Hidden, cl::init(DefaultAlign), cl::values(clEnumValN(DefaultAlign,&quot;arm-default-align&quot;,&quot;Generate unaligned accesses only on hardware/OS &quot;&quot;combinations that are known to support them&quot;), clEnumValN(StrictAlign,&quot;arm-strict-align&quot;,&quot;Disallow all unaligned memory accesses&quot;), clEnumValN(NoStrictAlign,&quot;arm-no-strict-align&quot;,&quot;Allow unaligned memory accesses&quot;), clEnumValEnd))</div></div>
<div class="ttc" id="namespacellvm_1_1A64CC_html_af5804bc0518be9568f73db566e4d6f46a262de230e8b3511eaf693762cabdc1ca"><div class="ttname"><a href="namespacellvm_1_1A64CC.html#af5804bc0518be9568f73db566e4d6f46a262de230e8b3511eaf693762cabdc1ca">llvm::A64CC::LS</a></div><div class="ttdef"><b>Definition:</b> <a href="AArch64BaseInfo_8h_source.html#l00040">AArch64BaseInfo.h:40</a></div></div>
<div class="ttc" id="classllvm_1_1TargetLoweringBase_html_a88a8b01d4dbc2ebd81244d1eb459b193a40cd81ebfaf97cef327ad65d37b816da"><div class="ttname"><a href="classllvm_1_1TargetLoweringBase.html#a88a8b01d4dbc2ebd81244d1eb459b193a40cd81ebfaf97cef327ad65d37b816da">llvm::TargetLoweringBase::TypeSplitVector</a></div><div class="ttdef"><b>Definition:</b> <a href="TargetLowering_8h_source.html#l00096">TargetLowering.h:96</a></div></div>
<div class="ttc" id="structllvm_1_1EVT_html_ac6f053514ba29bdf3b7f051f643dabe5"><div class="ttname"><a href="structllvm_1_1EVT.html#ac6f053514ba29bdf3b7f051f643dabe5">llvm::EVT::isSimple</a></div><div class="ttdeci">bool isSimple() const </div><div class="ttdef"><b>Definition:</b> <a href="ValueTypes_8h_source.html#l00640">ValueTypes.h:640</a></div></div>
<div class="ttc" id="classllvm_1_1MVT_html_afd69b4f2dff97a2d7c0192cc769ef50cab3be25b50efa0289a3c86fd50454b683"><div class="ttname"><a href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50cab3be25b50efa0289a3c86fd50454b683">llvm::MVT::i16</a></div><div class="ttdef"><b>Definition:</b> <a href="ValueTypes_8h_source.html#l00045">ValueTypes.h:45</a></div></div>
<div class="ttc" id="classllvm_1_1TargetLoweringBase_html_a76daffc43a9b516f4fe4999c7b680ca0"><div class="ttname"><a href="classllvm_1_1TargetLoweringBase.html#a76daffc43a9b516f4fe4999c7b680ca0">llvm::TargetLoweringBase::getTypeToTransformTo</a></div><div class="ttdeci">EVT getTypeToTransformTo(LLVMContext &amp;Context, EVT VT) const </div><div class="ttdef"><b>Definition:</b> <a href="TargetLowering_8h_source.html#l00332">TargetLowering.h:332</a></div></div>
<div class="ttc" id="classllvm_1_1Value_html"><div class="ttname"><a href="classllvm_1_1Value.html">llvm::Value</a></div><div class="ttdoc">LLVM Value Representation. </div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00066">Value.h:66</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110a293ca68b3b2ce80eef991de822822254"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a293ca68b3b2ce80eef991de822822254">llvm::ISD::FMA</a></div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00222">ISDOpcodes.h:222</a></div></div>
<div class="ttc" id="DAGCombiner_8cpp_html_af94365b75e01f45bde3699f009aa431e"><div class="ttname"><a href="DAGCombiner_8cpp.html#af94365b75e01f45bde3699f009aa431e">isSlicingProfitable</a></div><div class="ttdeci">static bool isSlicingProfitable(SmallVectorImpl&lt; LoadedSlice &gt; &amp;LoadedSlices, const APInt &amp;UsedBits, bool ForCodeSize)</div><div class="ttdoc">Check the profitability of all involved LoadedSlice. Currently, it is considered profitable if there ...</div><div class="ttdef"><b>Definition:</b> <a href="DAGCombiner_8cpp_source.html#l07997">DAGCombiner.cpp:7997</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110a92febb83e6ba116eb7aae8e7e3f70cc1"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a92febb83e6ba116eb7aae8e7e3f70cc1">llvm::ISD::XOR</a></div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00295">ISDOpcodes.h:295</a></div></div>
<div class="ttc" id="classllvm_1_1APFloat_html_a30b29f2be19eb73f6225de032a1fafb3"><div class="ttname"><a href="classllvm_1_1APFloat.html#a30b29f2be19eb73f6225de032a1fafb3">llvm::APFloat::isZero</a></div><div class="ttdeci">bool isZero() const </div><div class="ttdoc">Returns true if and only if the float is plus or minus zero. </div><div class="ttdef"><b>Definition:</b> <a href="APFloat_8h_source.html#l00376">APFloat.h:376</a></div></div>
<div class="ttc" id="classllvm_1_1TargetLoweringBase_html_a813157446ae8d1335ffcb82161f40f84"><div class="ttname"><a href="classllvm_1_1TargetLoweringBase.html#a813157446ae8d1335ffcb82161f40f84">llvm::TargetLoweringBase::hasTargetDAGCombine</a></div><div class="ttdeci">bool hasTargetDAGCombine(ISD::NodeType NT) const </div><div class="ttdef"><b>Definition:</b> <a href="TargetLowering_8h_source.html#l00673">TargetLowering.h:673</a></div></div>
<div class="ttc" id="classllvm_1_1StoreSDNode_html_a272cb283a679298b7e991db7daf823ed"><div class="ttname"><a href="classllvm_1_1StoreSDNode.html#a272cb283a679298b7e991db7daf823ed">llvm::StoreSDNode::isTruncatingStore</a></div><div class="ttdeci">bool isTruncatingStore() const </div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l01766">SelectionDAGNodes.h:1766</a></div></div>
<div class="ttc" id="classllvm_1_1SelectionDAG_html_ab8ba6b05ad4fa7517f2e23b26f84ae1b"><div class="ttname"><a href="classllvm_1_1SelectionDAG.html#ab8ba6b05ad4fa7517f2e23b26f84ae1b">llvm::SelectionDAG::getValueType</a></div><div class="ttdeci">SDValue getValueType(EVT)</div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAG_8cpp_source.html#l01291">SelectionDAG.cpp:1291</a></div></div>
<div class="ttc" id="classllvm_1_1Attribute_html_aab7ee4b8fd1d3e7e4cea87868855e60ea9e330fa070dd4bb79cbc6c74b41958a4"><div class="ttname"><a href="classllvm_1_1Attribute.html#aab7ee4b8fd1d3e7e4cea87868855e60ea9e330fa070dd4bb79cbc6c74b41958a4">llvm::Attribute::NoImplicitFloat</a></div><div class="ttdoc">Disable implicit floating point insts. </div><div class="ttdef"><b>Definition:</b> <a href="Attributes_8h_source.html#l00084">Attributes.h:84</a></div></div>
<div class="ttc" id="classllvm_1_1TargetLowering_html_a241851c27ed9099a903c7ab9c7a8675f"><div class="ttname"><a href="classllvm_1_1TargetLowering.html#a241851c27ed9099a903c7ab9c7a8675f">llvm::TargetLowering::BuildUDIV</a></div><div class="ttdeci">SDValue BuildUDIV(SDNode *N, SelectionDAG &amp;DAG, bool IsAfterLegalization, std::vector&lt; SDNode * &gt; *Created) const </div><div class="ttdoc">Given an ISD::UDIV node expressing a divide by constant, return a DAG expression to select that will ...</div><div class="ttdef"><b>Definition:</b> <a href="TargetLowering_8cpp_source.html#l02601">TargetLowering.cpp:2601</a></div></div>
<div class="ttc" id="classllvm_1_1SelectionDAG_html_a01e15fa872bbde36ed8a394a01b200b9"><div class="ttname"><a href="classllvm_1_1SelectionDAG.html#a01e15fa872bbde36ed8a394a01b200b9">llvm::SelectionDAG::ComputeNumSignBits</a></div><div class="ttdeci">unsigned ComputeNumSignBits(SDValue Op, unsigned Depth=0) const </div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAG_8cpp_source.html#l02204">SelectionDAG.cpp:2204</a></div></div>
<div class="ttc" id="classllvm_1_1SelectionDAG_html_a848b46af8fabd1ab34b28adbc3665609"><div class="ttname"><a href="classllvm_1_1SelectionDAG.html#a848b46af8fabd1ab34b28adbc3665609">llvm::SelectionDAG::getTargetLoweringInfo</a></div><div class="ttdeci">const TargetLowering &amp; getTargetLoweringInfo() const </div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAG_8h_source.html#l00282">SelectionDAG.h:282</a></div></div>
<div class="ttc" id="classllvm_1_1SelectionDAG_html_ac630ccda26fea2f45afa3fb89bc1a8f4"><div class="ttname"><a href="classllvm_1_1SelectionDAG.html#ac630ccda26fea2f45afa3fb89bc1a8f4">llvm::SelectionDAG::ReplaceAllUsesOfValueWith</a></div><div class="ttdeci">void ReplaceAllUsesOfValueWith(SDValue From, SDValue To)</div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAG_8cpp_source.html#l05788">SelectionDAG.cpp:5788</a></div></div>
<div class="ttc" id="Debug_8h_html_aef41e8aaf4c60819b30faf396cdf4978"><div class="ttname"><a href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a></div><div class="ttdeci">#define DEBUG(X)</div><div class="ttdef"><b>Definition:</b> <a href="Debug_8h_source.html#l00097">Debug.h:97</a></div></div>
<div class="ttc" id="namespacellvm_html_ac855c00dc7fe6cc64f4875f69479e9b4"><div class="ttname"><a href="namespacellvm.html#ac855c00dc7fe6cc64f4875f69479e9b4">llvm::isInt</a></div><div class="ttdeci">bool isInt(int64_t x)</div><div class="ttdoc">isInt - Checks if an integer fits into the given bit width. </div><div class="ttdef"><b>Definition:</b> <a href="MathExtras_8h_source.html#l00263">MathExtras.h:263</a></div></div>
<div class="ttc" id="classllvm_1_1MVT_html_afd69b4f2dff97a2d7c0192cc769ef50ca497ebfc1d05b772bf14cd530c950cf80"><div class="ttname"><a href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50ca497ebfc1d05b772bf14cd530c950cf80">llvm::MVT::ppcf128</a></div><div class="ttdef"><b>Definition:</b> <a href="ValueTypes_8h_source.html#l00058">ValueTypes.h:58</a></div></div>
<div class="ttc" id="classllvm_1_1APInt_html_af0336ea4c7f7f56354b2ca7c8859c1f9"><div class="ttname"><a href="classllvm_1_1APInt.html#af0336ea4c7f7f56354b2ca7c8859c1f9">llvm::APInt::countLeadingZeros</a></div><div class="ttdeci">unsigned countLeadingZeros() const </div><div class="ttdoc">The APInt version of the countLeadingZeros functions in MathExtras.h. </div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l01340">APInt.h:1340</a></div></div>
<div class="ttc" id="classllvm_1_1TargetLoweringBase_html_ab6b8ec6add84f851e922b6e5844ca1a1"><div class="ttname"><a href="classllvm_1_1TargetLoweringBase.html#ab6b8ec6add84f851e922b6e5844ca1a1">llvm::TargetLoweringBase::isLegalAddressingMode</a></div><div class="ttdeci">virtual bool isLegalAddressingMode(const AddrMode &amp;AM, Type *Ty) const </div><div class="ttdef"><b>Definition:</b> <a href="TargetLoweringBase_8cpp_source.html#l01340">TargetLoweringBase.cpp:1340</a></div></div>
<div class="ttc" id="namespacellvm_html_af4d1a918800291e75b01ce1447be0e83"><div class="ttname"><a href="namespacellvm.html#af4d1a918800291e75b01ce1447be0e83">llvm::isPowerOf2_32</a></div><div class="ttdeci">bool isPowerOf2_32(uint32_t Value)</div><div class="ttdef"><b>Definition:</b> <a href="MathExtras_8h_source.html#l00354">MathExtras.h:354</a></div></div>
<div class="ttc" id="classllvm_1_1APInt_html_a6142fc5662411269a7ca0217f49f338c"><div class="ttname"><a href="classllvm_1_1APInt.html#a6142fc5662411269a7ca0217f49f338c">llvm::APInt::zext</a></div><div class="ttdeci">APInt LLVM_ATTRIBUTE_UNUSED_RESULT zext(unsigned width) const </div><div class="ttdoc">Zero extend to a new width. </div><div class="ttdef"><b>Definition:</b> <a href="APInt_8cpp_source.html#l00983">APInt.cpp:983</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110a0158ee47dfa868be5d28e2cbef70d5d0"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a0158ee47dfa868be5d28e2cbef70d5d0">llvm::ISD::SETCC</a></div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00339">ISDOpcodes.h:339</a></div></div>
<div class="ttc" id="classllvm_1_1TargetLowering_html_a6634fc60337427fd6c33e851a4ff45ad"><div class="ttname"><a href="classllvm_1_1TargetLowering.html#a6634fc60337427fd6c33e851a4ff45ad">llvm::TargetLowering::isOffsetFoldingLegal</a></div><div class="ttdeci">virtual bool isOffsetFoldingLegal(const GlobalAddressSDNode *GA) const </div><div class="ttdef"><b>Definition:</b> <a href="TargetLowering_8cpp_source.html#l00257">TargetLowering.cpp:257</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_ac3c3cf58d6d631af6a172457304d3d07ab49f81c2ecbbff3d0fbe55dd46353774"><div class="ttname"><a href="namespacellvm_1_1ISD.html#ac3c3cf58d6d631af6a172457304d3d07ab49f81c2ecbbff3d0fbe55dd46353774">llvm::ISD::SETLE</a></div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00743">ISDOpcodes.h:743</a></div></div>
<div class="ttc" id="raw__ostream_8h_html"><div class="ttname"><a href="raw__ostream_8h.html">raw_ostream.h</a></div></div>
<div class="ttc" id="OcamlGCPrinter_8cpp_html_a1bdbcdc4205781eefd549946d40ff378"><div class="ttname"><a href="OcamlGCPrinter_8cpp.html#a1bdbcdc4205781eefd549946d40ff378">Y</a></div><div class="ttdeci">static GCMetadataPrinterRegistry::Add&lt; OcamlGCMetadataPrinter &gt; Y(&quot;ocaml&quot;,&quot;ocaml 3.10-compatible collector&quot;)</div></div>
<div class="ttc" id="namespacellvm_html_a162c90bc179a6359438d060722bee35f"><div class="ttname"><a href="namespacellvm.html#a162c90bc179a6359438d060722bee35f">llvm::operator==</a></div><div class="ttdeci">bool operator==(uint64_t V1, const APInt &amp;V2)</div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l01684">APInt.h:1684</a></div></div>
<div class="ttc" id="classllvm_1_1SelectionDAG_html_a2650d530046f9ddfc602dc7383ba0730"><div class="ttname"><a href="classllvm_1_1SelectionDAG.html#a2650d530046f9ddfc602dc7383ba0730">llvm::SelectionDAG::getSetCC</a></div><div class="ttdeci">SDValue getSetCC(SDLoc DL, EVT VT, SDValue LHS, SDValue RHS, ISD::CondCode Cond)</div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAG_8h_source.html#l00653">SelectionDAG.h:653</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110a01c94937492f3ac3fb1e0be8eb0b9ef1"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a01c94937492f3ac3fb1e0be8eb0b9ef1">llvm::ISD::MERGE_VALUES</a></div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00173">ISDOpcodes.h:173</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110a5183f3d72924bc7c77ba8d3f5de9f602"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a5183f3d72924bc7c77ba8d3f5de9f602">llvm::ISD::SIGN_EXTEND</a></div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00354">ISDOpcodes.h:354</a></div></div>
<div class="ttc" id="classllvm_1_1APInt_html_a4ba7d7f0a1e911c8384e236b5f6c1959"><div class="ttname"><a href="classllvm_1_1APInt.html#a4ba7d7f0a1e911c8384e236b5f6c1959">llvm::APInt::getNullValue</a></div><div class="ttdeci">static APInt getNullValue(unsigned numBits)</div><div class="ttdoc">Get the &amp;#39;0&amp;#39; value. </div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l00457">APInt.h:457</a></div></div>
<div class="ttc" id="classllvm_1_1SelectionDAG_html_ad755b1a25cf0c4507d5f615f64471ae9"><div class="ttname"><a href="classllvm_1_1SelectionDAG.html#ad755b1a25cf0c4507d5f615f64471ae9">llvm::SelectionDAG::getEntryNode</a></div><div class="ttdeci">SDValue getEntryNode() const </div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAG_8h_source.html#l00332">SelectionDAG.h:332</a></div></div>
<div class="ttc" id="DAGCombiner_8cpp_html_a17ebad91761318291cebf272abf95e6d"><div class="ttname"><a href="DAGCombiner_8cpp.html#a17ebad91761318291cebf272abf95e6d">combineShlAddConstant</a></div><div class="ttdeci">static SDValue combineShlAddConstant(SDLoc DL, SDValue N0, SDValue N1, SelectionDAG &amp;DAG)</div><div class="ttdef"><b>Definition:</b> <a href="DAGCombiner_8cpp_source.html#l01380">DAGCombiner.cpp:1380</a></div></div>
<div class="ttc" id="classllvm_1_1SDUse_html_a469c58f8a39344294563f11514c352de"><div class="ttname"><a href="classllvm_1_1SDUse.html#a469c58f8a39344294563f11514c352de">llvm::SDUse::getUser</a></div><div class="ttdeci">SDNode * getUser()</div><div class="ttdoc">getUser - This returns the SDNode that contains this Use. </div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l00238">SelectionDAGNodes.h:238</a></div></div>
<div class="ttc" id="classllvm_1_1SelectionDAG_html_af52a1ca20308888443767831a21352ca"><div class="ttname"><a href="classllvm_1_1SelectionDAG.html#af52a1ca20308888443767831a21352ca">llvm::SelectionDAG::SignBitIsZero</a></div><div class="ttdeci">bool SignBitIsZero(SDValue Op, unsigned Depth=0) const </div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAG_8cpp_source.html#l01735">SelectionDAG.cpp:1735</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110ae690127648393001a7d5b93dc23da7b3"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ae690127648393001a7d5b93dc23da7b3">llvm::ISD::TRUNCATE</a></div><div class="ttdoc">TRUNCATE - Completely drop the high bits. </div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00363">ISDOpcodes.h:363</a></div></div>
<div class="ttc" id="namespacellvm_html_a1a995470163b6d76695cba5bc8dfb529"><div class="ttname"><a href="namespacellvm.html#a1a995470163b6d76695cba5bc8dfb529">llvm::isUIntN</a></div><div class="ttdeci">bool isUIntN(unsigned N, uint64_t x)</div><div class="ttdef"><b>Definition:</b> <a href="MathExtras_8h_source.html#l00315">MathExtras.h:315</a></div></div>
<div class="ttc" id="classllvm_1_1MemSDNode_html_a4f68cd016138440f215ad80c1d6c1e04"><div class="ttname"><a href="classllvm_1_1MemSDNode.html#a4f68cd016138440f215ad80c1d6c1e04">llvm::MemSDNode::getAlignment</a></div><div class="ttdeci">unsigned getAlignment() const </div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l00995">SelectionDAGNodes.h:995</a></div></div>
<div class="ttc" id="classllvm_1_1APFloat_html_a42fe920c8131569bb30114d7f294c8f8a9b6cce9cb9cdb5ceca4b5cf796eb7cd2"><div class="ttname"><a href="classllvm_1_1APFloat.html#a42fe920c8131569bb30114d7f294c8f8a9b6cce9cb9cdb5ceca4b5cf796eb7cd2">llvm::APFloat::opInexact</a></div><div class="ttdef"><b>Definition:</b> <a href="APFloat_8h_source.html#l00172">APFloat.h:172</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110aa2a7c3eccf06b41e4275bbeadb46d22e"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110aa2a7c3eccf06b41e4275bbeadb46d22e">llvm::ISD::MULHS</a></div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00292">ISDOpcodes.h:292</a></div></div>
<div class="ttc" id="classllvm_1_1SelectionDAG_html_a1ac87b6585263c774b2b350d3a98702b"><div class="ttname"><a href="classllvm_1_1SelectionDAG.html#a1ac87b6585263c774b2b350d3a98702b">llvm::SelectionDAG::TransferDbgValues</a></div><div class="ttdeci">void TransferDbgValues(SDValue From, SDValue To)</div><div class="ttdoc">TransferDbgValues - Transfer SDDbgValues. </div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAG_8cpp_source.html#l06016">SelectionDAG.cpp:6016</a></div></div>
<div class="ttc" id="classllvm_1_1TargetLoweringBase_html_a5915acdb20d31a79440117652c5232ec"><div class="ttname"><a href="classllvm_1_1TargetLoweringBase.html#a5915acdb20d31a79440117652c5232ec">llvm::TargetLoweringBase::isCondCodeLegal</a></div><div class="ttdeci">bool isCondCodeLegal(ISD::CondCode CC, MVT VT) const </div><div class="ttdoc">Return true if the specified condition code is legal on this target. </div><div class="ttdef"><b>Definition:</b> <a href="TargetLowering_8h_source.html#l00546">TargetLowering.h:546</a></div></div>
<div class="ttc" id="classllvm_1_1SDValue_html"><div class="ttname"><a href="classllvm_1_1SDValue.html">llvm::SDValue</a></div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l00094">SelectionDAGNodes.h:94</a></div></div>
<div class="ttc" id="classllvm_1_1DataLayout_html_a9b876cc57d1884621f481b26b0892633"><div class="ttname"><a href="classllvm_1_1DataLayout.html#a9b876cc57d1884621f481b26b0892633">llvm::DataLayout::isBigEndian</a></div><div class="ttdeci">bool isBigEndian() const </div><div class="ttdef"><b>Definition:</b> <a href="DataLayout_8h_source.html#l00196">DataLayout.h:196</a></div></div>
<div class="ttc" id="Target_2ARM_2README_8txt_html_a90cca76dd78688687e0d697679dbc799"><div class="ttname"><a href="Target_2ARM_2README_8txt.html#a90cca76dd78688687e0d697679dbc799">B</a></div><div class="ttdeci">compiles ldr LCPI1_0 ldr ldr mov lsr tst moveq r1 ldr LCPI1_1 and r0 bx lr It would be better to do something like to fold the shift into the conditional ldr LCPI1_0 ldr ldr tst movne lsr ldr LCPI1_1 and r0 bx lr it saves an instruction and a register It might be profitable to cse MOVi16 if there are lots of bit immediates with the same bottom half Robert Muth started working on an alternate jump table implementation that does not put the tables in line in the text This is more like the llvm default jump table implementation This might be useful sometime Several revisions of patches are on the mailing beginning while CMP sets them like a subtract Therefore to be able to use CMN for comparisons other than the Z we ll need additional logic to reverse the conditionals associated with the comparison Perhaps a pseudo instruction for the with a post codegen pass to clean up and handle the condition codes See PR5694 for testcase Given the following on int B</div><div class="ttdef"><b>Definition:</b> <a href="Target_2ARM_2README_8txt_source.html#l00592">Target/ARM/README.txt:592</a></div></div>
<div class="ttc" id="namespacellvm_html_a7dc3e2c002713fec56bdbf16aa704576"><div class="ttname"><a href="namespacellvm.html#a7dc3e2c002713fec56bdbf16aa704576">llvm::tie</a></div><div class="ttdeci">tier&lt; T1, T2 &gt; tie(T1 &amp;f, T2 &amp;s)</div><div class="ttdef"><b>Definition:</b> <a href="STLExtras_8h_source.html#l00216">STLExtras.h:216</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110a6d26c45c040d8f85d577a5f645261d1a"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a6d26c45c040d8f85d577a5f645261d1a">llvm::ISD::FNEG</a></div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00449">ISDOpcodes.h:449</a></div></div>
<div class="ttc" id="classllvm_1_1TargetLoweringBase_html_a2856b7fb24e0784cfc29ddfd5be74d1bad7ff2d7a7c03a214dda559fac717cd99"><div class="ttname"><a href="classllvm_1_1TargetLoweringBase.html#a2856b7fb24e0784cfc29ddfd5be74d1bad7ff2d7a7c03a214dda559fac717cd99">llvm::TargetLoweringBase::Legal</a></div><div class="ttdef"><b>Definition:</b> <a href="TargetLowering_8h_source.html#l00081">TargetLowering.h:81</a></div></div>
<div class="ttc" id="structllvm_1_1EVT_html_a752372e170e4e7c595bf8810bb52adf2"><div class="ttname"><a href="structllvm_1_1EVT.html#a752372e170e4e7c595bf8810bb52adf2">llvm::EVT::getIntegerVT</a></div><div class="ttdeci">static EVT getIntegerVT(LLVMContext &amp;Context, unsigned BitWidth)</div><div class="ttdef"><b>Definition:</b> <a href="ValueTypes_8h_source.html#l00607">ValueTypes.h:607</a></div></div>
<div class="ttc" id="classllvm_1_1TargetLoweringBase_html_a814573c6f6263d6f7b463ce0a591781a"><div class="ttname"><a href="classllvm_1_1TargetLoweringBase.html#a814573c6f6263d6f7b463ce0a591781a">llvm::TargetLoweringBase::isFNegFree</a></div><div class="ttdeci">virtual bool isFNegFree(EVT VT) const </div><div class="ttdef"><b>Definition:</b> <a href="TargetLowering_8h_source.html#l01245">TargetLowering.h:1245</a></div></div>
<div class="ttc" id="classllvm_1_1APFloat_html_a4f9fe1ca06b44499c16742431c00cb34"><div class="ttname"><a href="classllvm_1_1APFloat.html#a4f9fe1ca06b44499c16742431c00cb34">llvm::APFloat::getSemantics</a></div><div class="ttdeci">const fltSemantics &amp; getSemantics() const </div><div class="ttdef"><b>Definition:</b> <a href="APFloat_8h_source.html#l00397">APFloat.h:397</a></div></div>
<div class="ttc" id="namespacellvm_html_a6569d00d31a5d74e563e2f39f82271ab"><div class="ttname"><a href="namespacellvm.html#a6569d00d31a5d74e563e2f39f82271ab">llvm::X</a></div><div class="ttdeci">static RegisterPass&lt; NVPTXAllocaHoisting &gt; X(&quot;alloca-hoisting&quot;,&quot;Hoisting alloca instructions in non-entry &quot;&quot;blocks to the entry block&quot;)</div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110a576080a08ef1bbab0308eac9d5838f75"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a576080a08ef1bbab0308eac9d5838f75">llvm::ISD::SCALAR_TO_VECTOR</a></div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00287">ISDOpcodes.h:287</a></div></div>
<div class="ttc" id="structllvm_1_1EVT_html_a2eed75ff7477295264c8320af1630bbb"><div class="ttname"><a href="structllvm_1_1EVT.html#a2eed75ff7477295264c8320af1630bbb">llvm::EVT::changeVectorElementTypeToInteger</a></div><div class="ttdeci">EVT changeVectorElementTypeToInteger() const </div><div class="ttdef"><b>Definition:</b> <a href="ValueTypes_8h_source.html#l00626">ValueTypes.h:626</a></div></div>
<div class="ttc" id="classllvm_1_1SDUse_html_a837a4522010445da3f5161dcd2b95880"><div class="ttname"><a href="classllvm_1_1SDUse.html#a837a4522010445da3f5161dcd2b95880">llvm::SDUse::getResNo</a></div><div class="ttdeci">unsigned getResNo() const </div><div class="ttdoc">getResNo - Convenience function for get().getResNo(). </div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l00246">SelectionDAGNodes.h:246</a></div></div>
<div class="ttc" id="structBaseIndexOffset_html_a2c47325c74b1570d86010535fbdc710b"><div class="ttname"><a href="structBaseIndexOffset.html#a2c47325c74b1570d86010535fbdc710b">BaseIndexOffset::Offset</a></div><div class="ttdeci">int64_t Offset</div><div class="ttdef"><b>Definition:</b> <a href="DAGCombiner_8cpp_source.html#l08460">DAGCombiner.cpp:8460</a></div></div>
<div class="ttc" id="structllvm_1_1EVT_html_a5b45953b758fdfe88452530f7d8371bc"><div class="ttname"><a href="structllvm_1_1EVT.html#a5b45953b758fdfe88452530f7d8371bc">llvm::EVT::getSimpleVT</a></div><div class="ttdeci">MVT getSimpleVT() const </div><div class="ttdef"><b>Definition:</b> <a href="ValueTypes_8h_source.html#l00749">ValueTypes.h:749</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110acc20c926003b2af97ba08689176e7130"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110acc20c926003b2af97ba08689176e7130">llvm::ISD::CARRY_FALSE</a></div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00189">ISDOpcodes.h:189</a></div></div>
<div class="ttc" id="TargetLowering_8h_html"><div class="ttname"><a href="TargetLowering_8h.html">TargetLowering.h</a></div></div>
<div class="ttc" id="structllvm_1_1TargetLowering_1_1DAGCombinerInfo_html_aeecdb6a29a24d717a83fc1c948e00d98"><div class="ttname"><a href="structllvm_1_1TargetLowering_1_1DAGCombinerInfo.html#aeecdb6a29a24d717a83fc1c948e00d98">llvm::TargetLowering::DAGCombinerInfo::CommitTargetLoweringOpt</a></div><div class="ttdeci">void CommitTargetLoweringOpt(const TargetLoweringOpt &amp;TLO)</div><div class="ttdef"><b>Definition:</b> <a href="DAGCombiner_8cpp_source.html#l00416">DAGCombiner.cpp:416</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110aac2f0a84dd2aa5ee4c3f1385e9565f5e"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110aac2f0a84dd2aa5ee4c3f1385e9565f5e">llvm::ISD::Constant</a></div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00061">ISDOpcodes.h:61</a></div></div>
<div class="ttc" id="classllvm_1_1MachineMemOperand_html_a9700a86585614c5beedfdf3e8d7fb9d1"><div class="ttname"><a href="classllvm_1_1MachineMemOperand.html#a9700a86585614c5beedfdf3e8d7fb9d1">llvm::MachineMemOperand::getBaseAlignment</a></div><div class="ttdeci">uint64_t getBaseAlignment() const </div><div class="ttdef"><b>Definition:</b> <a href="MachineMemOperand_8h_source.html#l00146">MachineMemOperand.h:146</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110a30316f8f9985260c49d7c26bc70a6cad"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a30316f8f9985260c49d7c26bc70a6cad">llvm::ISD::GlobalAddress</a></div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00062">ISDOpcodes.h:62</a></div></div>
<div class="ttc" id="classllvm_1_1CondCodeSDNode_html_a6c3eefd310631cda3dd266e224bc1492"><div class="ttname"><a href="classllvm_1_1CondCodeSDNode.html#a6c3eefd310631cda3dd266e224bc1492">llvm::CondCodeSDNode::get</a></div><div class="ttdeci">ISD::CondCode get() const </div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l01628">SelectionDAGNodes.h:1628</a></div></div>
<div class="ttc" id="classllvm_1_1ConstantSDNode_html_a1e9365c991dd55e65e9d5ab5653812e4"><div class="ttname"><a href="classllvm_1_1ConstantSDNode.html#a1e9365c991dd55e65e9d5ab5653812e4">llvm::ConstantSDNode::getZExtValue</a></div><div class="ttdeci">uint64_t getZExtValue() const </div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l01257">SelectionDAGNodes.h:1257</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_abee7ecb577fcade34eb16ccb7f503e31"><div class="ttname"><a href="namespacellvm_1_1ISD.html#abee7ecb577fcade34eb16ccb7f503e31">llvm::ISD::MemIndexedMode</a></div><div class="ttdeci">MemIndexedMode</div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00678">ISDOpcodes.h:678</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110a8a80d3b085af08f0dce1724207ef99b5"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a8a80d3b085af08f0dce1724207ef99b5">llvm::ISD::MULHU</a></div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00292">ISDOpcodes.h:292</a></div></div>
<div class="ttc" id="structllvm_1_1EVT_html_a42bca41d2438197c12b6db2c710a959c"><div class="ttname"><a href="structllvm_1_1EVT.html#a42bca41d2438197c12b6db2c710a959c">llvm::EVT::getVectorNumElements</a></div><div class="ttdeci">unsigned getVectorNumElements() const </div><div class="ttdef"><b>Definition:</b> <a href="ValueTypes_8h_source.html#l00771">ValueTypes.h:771</a></div></div>
<div class="ttc" id="classllvm_1_1LoadSDNode_html"><div class="ttname"><a href="classllvm_1_1LoadSDNode.html">llvm::LoadSDNode</a></div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l01720">SelectionDAGNodes.h:1720</a></div></div>
<div class="ttc" id="classllvm_1_1Attribute_html_aab7ee4b8fd1d3e7e4cea87868855e60ea490ee0eef953b867ec5f39859c6a03bf"><div class="ttname"><a href="classllvm_1_1Attribute.html#aab7ee4b8fd1d3e7e4cea87868855e60ea490ee0eef953b867ec5f39859c6a03bf">llvm::Attribute::MinSize</a></div><div class="ttdoc">Function must be optimized for size first. </div><div class="ttdef"><b>Definition:</b> <a href="Attributes_8h_source.html#l00077">Attributes.h:77</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<hr>
<p class="footer">
Generated on Sat Nov 10 2018 22:58:26 for <a href="http://llvm.org/">LLVM</a> by
<a href="http://www.doxygen.org"><img src="doxygen.png" alt="Doxygen"
align="middle" border="0"/>1.8.11</a><br>
Copyright &copy; 2003-2013 University of Illinois at Urbana-Champaign.
All Rights Reserved.</p>
<hr>
<!--#include virtual="/attrib.incl" -->
</body>
</html>
