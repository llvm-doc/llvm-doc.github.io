<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head>
<meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1"/>
<meta name="keywords" content="LLVM,Low Level Virtual Machine,C++,doxygen,API,documentation"/>
<meta name="description" content="C++ source code API documentation for LLVM."/>
<title>LLVM: ShadowStackGC.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head><body>
<p class="title">LLVM API Documentation</p>
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('ShadowStackGC_8cpp_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">ShadowStackGC.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="ShadowStackGC_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//===-- ShadowStackGC.cpp - GC support for uncooperative targets ----------===//</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">//                     The LLVM Compiler Infrastructure</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// This file is distributed under the University of Illinois Open Source</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">// License. See LICENSE.TXT for details.</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">// This file implements lowering for the llvm.gc* intrinsics for targets that do</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">// not natively support them (which includes the C backend). Note that the code</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">// generated is not quite as efficient as algorithms which generate stack maps</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">// to identify roots.</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">// This pass implements the code transformation described in this paper:</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">//   &quot;Accurate Garbage Collection in an Uncooperative Environment&quot;</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">//   Fergus Henderson, ISMM, 2002</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">// In runtime/GC/SemiSpace.cpp is a prototype runtime which is compatible with</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">// ShadowStackGC.</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">// In order to support this particular transformation, all stack roots are</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">// coallocated in the stack. This allows a fully target-independent stack map</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">// while introducing only minor runtime overhead.</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;</div><div class="line"><a name="l00028"></a><span class="lineno"><a class="line" href="ShadowStackGC_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">   28</a></span>&#160;<span class="preprocessor">#define DEBUG_TYPE &quot;shadowstackgc&quot;</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="GCs_8h.html">llvm/CodeGen/GCs.h</a>&quot;</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="StringExtras_8h.html">llvm/ADT/StringExtras.h</a>&quot;</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="GCStrategy_8h.html">llvm/CodeGen/GCStrategy.h</a>&quot;</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="IRBuilder_8h.html">llvm/IR/IRBuilder.h</a>&quot;</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="IntrinsicInst_8h.html">llvm/IR/IntrinsicInst.h</a>&quot;</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Module_8h.html">llvm/IR/Module.h</a>&quot;</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="CallSite_8h.html">llvm/Support/CallSite.h</a>&quot;</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespacellvm.html">llvm</a>;</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="keyword">namespace </span>{</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  <span class="keyword">class </span>ShadowStackGC : <span class="keyword">public</span> <a class="code" href="classllvm_1_1GCStrategy.html">GCStrategy</a> {<span class="comment"></span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">    /// RootChain - This is the global linked-list that contains the chain of GC</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">    /// roots.</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment"></span>    <a class="code" href="classllvm_1_1GlobalVariable.html">GlobalVariable</a> *Head;</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">    /// StackEntryTy - Abstract type of a link in the shadow stack.</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">    ///</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment"></span>    <a class="code" href="classllvm_1_1StructType.html">StructType</a> *StackEntryTy;</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <a class="code" href="classllvm_1_1StructType.html">StructType</a> *FrameMapTy;</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">    /// Roots - GC roots in the current function. Each is a pair of the</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">    /// intrinsic call and its corresponding alloca.</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment"></span>    std::vector&lt;std::pair&lt;CallInst*,AllocaInst*&gt; &gt; Roots;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  <span class="keyword">public</span>:</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    ShadowStackGC();</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <span class="keywordtype">bool</span> initializeCustomLowering(<a class="code" href="classllvm_1_1Module.html">Module</a> &amp;<a class="code" href="Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>);</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <span class="keywordtype">bool</span> performCustomLowering(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="LLParser_8cpp.html#a33ece1ef8074506a15d7f86eb76dbae6">F</a>);</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  <span class="keyword">private</span>:</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="keywordtype">bool</span> IsNullValue(<a class="code" href="classllvm_1_1Value.html">Value</a> *V);</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <a class="code" href="classllvm_1_1Constant.html">Constant</a> *GetFrameMap(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;F);</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <a class="code" href="classllvm_1_1Type.html">Type</a>* GetConcreteStackEntryType(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;F);</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <span class="keywordtype">void</span> CollectRoots(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;F);</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="keyword">static</span> <a class="code" href="classllvm_1_1GetElementPtrInst.html">GetElementPtrInst</a> *CreateGEP(<a class="code" href="classllvm_1_1LLVMContext.html">LLVMContext</a> &amp;Context, </div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;                                        <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> &amp;<a class="code" href="Target_2ARM_2README_8txt.html#a90cca76dd78688687e0d697679dbc799">B</a>, <a class="code" href="classllvm_1_1Value.html">Value</a> *BasePtr,</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;                                        <span class="keywordtype">int</span> Idx1, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="namespacellvm_1_1GraphProgram.html#a0ad4685976f8c4d4a697a53fbe05d10b">Name</a>);</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="keyword">static</span> <a class="code" href="classllvm_1_1GetElementPtrInst.html">GetElementPtrInst</a> *CreateGEP(<a class="code" href="classllvm_1_1LLVMContext.html">LLVMContext</a> &amp;Context,</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;                                        <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> &amp;B, <a class="code" href="classllvm_1_1Value.html">Value</a> *BasePtr,</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;                                        <span class="keywordtype">int</span> Idx1, <span class="keywordtype">int</span> Idx2, <span class="keyword">const</span> <span class="keywordtype">char</span> *Name);</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  };</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;}</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1Registry_1_1Add.html">GCRegistry::Add&lt;ShadowStackGC&gt;</a></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<a class="code" href="namespacellvm.html#a6569d00d31a5d74e563e2f39f82271ab">X</a>(<span class="stringliteral">&quot;shadow-stack&quot;</span>, <span class="stringliteral">&quot;Very portable GC for uncooperative code generators&quot;</span>);</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="keyword">namespace </span>{<span class="comment"></span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">  /// EscapeEnumerator - This is a little algorithm to find all escape points</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">  /// from a function so that &quot;finally&quot;-style code can be inserted. In addition</span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">  /// to finding the existing return and unwind instructions, it also (if</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">  /// necessary) transforms any call instructions into invokes and sends them to</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment">  /// a landing pad.</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment">  ///</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">  /// It&#39;s wrapped up in a state machine using the same transform C# uses for</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment">  /// &#39;yield return&#39; enumerators, This transform allows it to be non-allocating.</span></div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment"></span>  <span class="keyword">class </span>EscapeEnumerator {</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="LLParser_8cpp.html#a33ece1ef8074506a15d7f86eb76dbae6">F</a>;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *CleanupBBName;</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="comment">// State.</span></div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="keywordtype">int</span> State;</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <a class="code" href="classllvm_1_1ilist__iterator.html">Function::iterator</a> StateBB, StateE;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> Builder;</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <span class="keyword">public</span>:</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    EscapeEnumerator(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;F, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a> = <span class="stringliteral">&quot;cleanup&quot;</span>)</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;      : <a class="code" href="LLParser_8cpp.html#a33ece1ef8074506a15d7f86eb76dbae6">F</a>(F), CleanupBBName(<a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>), State(0), Builder(F.<a class="code" href="classllvm_1_1Function.html#a2da53ac53516a3f16191f4c8a8eaa3e5">getContext</a>()) {}</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> *Next() {</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;      <span class="keywordflow">switch</span> (State) {</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;      <span class="keywordflow">default</span>:</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;      <span class="keywordflow">case</span> 0:</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        StateBB = F.<a class="code" href="classllvm_1_1Function.html#a88a5e60837674780a9d812d661897ac5">begin</a>();</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        StateE = F.<a class="code" href="classllvm_1_1Function.html#ae4ca2261b8b901e415fda7feac5051ea">end</a>();</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        State = 1;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;      <span class="keywordflow">case</span> 1:</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        <span class="comment">// Find all &#39;return&#39;, &#39;resume&#39;, and &#39;unwind&#39; instructions.</span></div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        <span class="keywordflow">while</span> (StateBB != StateE) {</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;          <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *CurBB = StateBB++;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;          <span class="comment">// Branches and invokes do not escape, only unwind, resume, and return</span></div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;          <span class="comment">// do.</span></div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;          <a class="code" href="classllvm_1_1TerminatorInst.html">TerminatorInst</a> *TI = CurBB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a5cb76a65b6524dba1493dd2b9dc3abbe">getTerminator</a>();</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;          <span class="keywordflow">if</span> (!isa&lt;ReturnInst&gt;(TI) &amp;&amp; !isa&lt;ResumeInst&gt;(TI))</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;          Builder.<a class="code" href="classllvm_1_1IRBuilderBase.html#ace45cae6925c65e9d6916e09dd5b17cc">SetInsertPoint</a>(TI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a9cd49851904f15060edb782ef4dd1b2d">getParent</a>(), TI);</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;          <span class="keywordflow">return</span> &amp;Builder;</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        }</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        State = 2;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        <span class="comment">// Find all &#39;call&#39; instructions.</span></div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Instruction*,16&gt;</a> Calls;</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1ilist__iterator.html">Function::iterator</a> <a class="code" href="CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> = F.<a class="code" href="classllvm_1_1Function.html#a88a5e60837674780a9d812d661897ac5">begin</a>(),</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                                E = F.<a class="code" href="classllvm_1_1Function.html#ae4ca2261b8b901e415fda7feac5051ea">end</a>(); <a class="code" href="CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> != E; ++<a class="code" href="CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>)</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;          <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1ilist__iterator.html">BasicBlock::iterator</a> II = <a class="code" href="CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>-&gt;begin(),</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;                                    EE = <a class="code" href="CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>-&gt;end(); II != EE; ++II)</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI = dyn_cast&lt;CallInst&gt;(II))</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;              <span class="keywordflow">if</span> (!CI-&gt;getCalledFunction() ||</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;                  !CI-&gt;getCalledFunction()-&gt;getIntrinsicID())</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                Calls.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(CI);</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        <span class="keywordflow">if</span> (Calls.<a class="code" href="classllvm_1_1SmallVectorBase.html#a8a8df4d85555c7954a95f86080cd3b64">empty</a>())</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;          <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        <span class="comment">// Create a cleanup block.</span></div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        <a class="code" href="classllvm_1_1LLVMContext.html">LLVMContext</a> &amp;<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = F.<a class="code" href="classllvm_1_1Function.html#a2da53ac53516a3f16191f4c8a8eaa3e5">getContext</a>();</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *CleanupBB = <a class="code" href="classllvm_1_1BasicBlock.html#ae1d53a21892854816885c7288f8b46f1">BasicBlock::Create</a>(C, CleanupBBName, &amp;F);</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        <a class="code" href="classllvm_1_1Type.html">Type</a> *ExnTy = <a class="code" href="classllvm_1_1StructType.html#a18fc4545474c6ebb6f7c547f64f4fb31">StructType::get</a>(<a class="code" href="classllvm_1_1Type.html#a7fe9ccd4893f4e2caa826126c09545ea">Type::getInt8PtrTy</a>(C),</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;                                      <a class="code" href="classllvm_1_1Type.html#a30dd396c5b40cd86c1591872e574ccdf">Type::getInt32Ty</a>(C), NULL);</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        <a class="code" href="classllvm_1_1Constant.html">Constant</a> *PersFn =</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;          F.<a class="code" href="classllvm_1_1GlobalValue.html#a9e1fc23a17e97d2d1732e753ae9251ac">getParent</a>()-&gt;</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;          getOrInsertFunction(<span class="stringliteral">&quot;__gcc_personality_v0&quot;</span>,</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                              <a class="code" href="classllvm_1_1FunctionType.html#a7e89b55242c964ae61b7850e99cacef0">FunctionType::get</a>(<a class="code" href="classllvm_1_1Type.html#a30dd396c5b40cd86c1591872e574ccdf">Type::getInt32Ty</a>(C), <span class="keyword">true</span>));</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        <a class="code" href="classllvm_1_1LandingPadInst.html">LandingPadInst</a> *LPad = <a class="code" href="classllvm_1_1LandingPadInst.html#ab79ff0e2579505f12d7eee951335e5ff">LandingPadInst::Create</a>(ExnTy, PersFn, 1,</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;                                                      <span class="stringliteral">&quot;cleanup.lpad&quot;</span>,</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;                                                      CleanupBB);</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        LPad-&gt;<a class="code" href="classllvm_1_1LandingPadInst.html#a97bc0afbd46cc7b3539e1cba861ac350">setCleanup</a>(<span class="keyword">true</span>);</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        <a class="code" href="classllvm_1_1ResumeInst.html">ResumeInst</a> *RI = <a class="code" href="classllvm_1_1ResumeInst.html#ae19fa1bc5cc4ee2e94277d9db6ed1768">ResumeInst::Create</a>(LPad, CleanupBB);</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        <span class="comment">// Transform the &#39;call&#39; instructions into &#39;invoke&#39;s branching to the</span></div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        <span class="comment">// cleanup block. Go in reverse order to make prettier BB names.</span></div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Value*,16&gt;</a> Args;</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = Calls.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#a22a311dfe4c28a897de8a9365a4f0a84">size</a>(); <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> != 0; ) {</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;          <a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI = cast&lt;CallInst&gt;(Calls[--<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>]);</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;          <span class="comment">// Split the basic block containing the function call.</span></div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;          <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *CallBB = CI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a9cd49851904f15060edb782ef4dd1b2d">getParent</a>();</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;          <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *NewBB =</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;            CallBB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a19445f836d9e1ecb32cba27ec4338fff">splitBasicBlock</a>(CI, CallBB-&gt;<a class="code" href="classllvm_1_1Value.html#ad452febc1ac0b394876e640ec03ffa38">getName</a>() + <span class="stringliteral">&quot;.cont&quot;</span>);</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;          <span class="comment">// Remove the unconditional branch inserted at the end of CallBB.</span></div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;          CallBB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a531d11ba36ed48d86057d507cc8d5567">getInstList</a>().<a class="code" href="classllvm_1_1iplist.html#a7d1d4ff826882f1d65929653c293e5cc">pop_back</a>();</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;          NewBB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a531d11ba36ed48d86057d507cc8d5567">getInstList</a>().<a class="code" href="classllvm_1_1iplist.html#ae22a2be6e82505d5de7d1ca296a10cce">remove</a>(CI);</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;          <span class="comment">// Create a new invoke instruction.</span></div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;          Args.<a class="code" href="classllvm_1_1SmallVectorImpl.html#aac0ea55010b7b1a301e65a0baea057aa">clear</a>();</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;          <a class="code" href="classllvm_1_1CallSite.html">CallSite</a> CS(CI);</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;          Args.<a class="code" href="classllvm_1_1SmallVectorImpl.html#a669d55980a7d4b6307b94596deeb0b1f">append</a>(CS.<a class="code" href="classllvm_1_1CallSiteBase.html#affa0f3ae92ab8696fccd107c0addf5a2">arg_begin</a>(), CS.<a class="code" href="classllvm_1_1CallSiteBase.html#acc2eeccdf71d83b3c08d6218317a1430">arg_end</a>());</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;          <a class="code" href="classllvm_1_1InvokeInst.html">InvokeInst</a> *II = <a class="code" href="classllvm_1_1InvokeInst.html#a03007b982a936464f7116e3c47df89ee">InvokeInst::Create</a>(CI-&gt;<a class="code" href="classllvm_1_1CallInst.html#a6917dcd78ac6655e9640ac3a96175e39">getCalledValue</a>(),</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                                              NewBB, CleanupBB,</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                                              Args, CI-&gt;<a class="code" href="classllvm_1_1Value.html#ad452febc1ac0b394876e640ec03ffa38">getName</a>(), CallBB);</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;          II-&gt;<a class="code" href="classllvm_1_1InvokeInst.html#a8c80836c6d88742318f534c254abdee3">setCallingConv</a>(CI-&gt;<a class="code" href="classllvm_1_1CallInst.html#a2a65eaf09953a013c2820f6857c647f0">getCallingConv</a>());</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;          II-&gt;<a class="code" href="classllvm_1_1InvokeInst.html#a0ac43fb5c325583e49d892c023c9b7f8">setAttributes</a>(CI-&gt;<a class="code" href="classllvm_1_1CallInst.html#a39fed9e3fb9323a7eb73cb65409f5586">getAttributes</a>());</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;          CI-&gt;<a class="code" href="classllvm_1_1Value.html#a3ab5fc45117b450e8bb04e564cb6e5f2">replaceAllUsesWith</a>(II);</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;          <span class="keyword">delete</span> CI;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        }</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        Builder.<a class="code" href="classllvm_1_1IRBuilderBase.html#ace45cae6925c65e9d6916e09dd5b17cc">SetInsertPoint</a>(RI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a9cd49851904f15060edb782ef4dd1b2d">getParent</a>(), RI);</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        <span class="keywordflow">return</span> &amp;Builder;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;      }</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    }</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  };</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;}</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;</div><div class="line"><a name="l00195"></a><span class="lineno"><a class="line" href="namespacellvm.html#aac42ef404bc7910d17a8bfec923e2d4b">  195</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespacellvm.html#aac42ef404bc7910d17a8bfec923e2d4b">llvm::linkShadowStackGC</a>() { }</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;ShadowStackGC::ShadowStackGC() : Head(0), StackEntryTy(0) {</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  InitRoots = <span class="keyword">true</span>;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  CustomRoots = <span class="keyword">true</span>;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;}</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<a class="code" href="classllvm_1_1Constant.html">Constant</a> *ShadowStackGC::GetFrameMap(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="LLParser_8cpp.html#a33ece1ef8074506a15d7f86eb76dbae6">F</a>) {</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  <span class="comment">// doInitialization creates the abstract type of this value.</span></div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *VoidPtr = <a class="code" href="classllvm_1_1Type.html#a7fe9ccd4893f4e2caa826126c09545ea">Type::getInt8PtrTy</a>(F.<a class="code" href="classllvm_1_1Function.html#a2da53ac53516a3f16191f4c8a8eaa3e5">getContext</a>());</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  <span class="comment">// Truncate the ShadowStackDescriptor if some metadata is null.</span></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  <span class="keywordtype">unsigned</span> NumMeta = 0;</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Constant*, 16&gt;</a> Metadata;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = 0; <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> != Roots.size(); ++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <a class="code" href="classllvm_1_1Constant.html">Constant</a> *<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = cast&lt;Constant&gt;(Roots[<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>].first-&gt;getArgOperand(1));</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <span class="keywordflow">if</span> (!C-&gt;<a class="code" href="classllvm_1_1Constant.html#ad7ec8482f19e8e86e3de573b060a17e5">isNullValue</a>())</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;      NumMeta = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> + 1;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    Metadata.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(<a class="code" href="classllvm_1_1ConstantExpr.html#aba93ec4079f8d709a1d5b4745310782e">ConstantExpr::getBitCast</a>(C, VoidPtr));</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  }</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  Metadata.<a class="code" href="classllvm_1_1SmallVectorImpl.html#a102d0ad36060677286c3aefb812e5512">resize</a>(NumMeta);</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *Int32Ty = <a class="code" href="classllvm_1_1Type.html#a30dd396c5b40cd86c1591872e574ccdf">Type::getInt32Ty</a>(F.<a class="code" href="classllvm_1_1Function.html#a2da53ac53516a3f16191f4c8a8eaa3e5">getContext</a>());</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;  </div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  <a class="code" href="classllvm_1_1Constant.html">Constant</a> *BaseElts[] = {</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <a class="code" href="classllvm_1_1ConstantInt.html#a9105541412dab869e18b3cceebfff07d">ConstantInt::get</a>(Int32Ty, Roots.size(), <span class="keyword">false</span>),</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <a class="code" href="classllvm_1_1ConstantInt.html#a9105541412dab869e18b3cceebfff07d">ConstantInt::get</a>(Int32Ty, NumMeta, <span class="keyword">false</span>),</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  };</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  <a class="code" href="classllvm_1_1Constant.html">Constant</a> *DescriptorElts[] = {</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <a class="code" href="classllvm_1_1ConstantStruct.html#a54fcfa620deb80373f489ba2fdad7643">ConstantStruct::get</a>(FrameMapTy, BaseElts),</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <a class="code" href="classllvm_1_1ConstantArray.html#a0900dacdc7ad8e3ea0cc92993c7fd422">ConstantArray::get</a>(<a class="code" href="classllvm_1_1ArrayType.html#adf411edc4f135b570ab218079474ce77">ArrayType::get</a>(VoidPtr, NumMeta), Metadata)</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  };</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *EltTys[] = { DescriptorElts[0]-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>(),DescriptorElts[1]-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>()};</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  <a class="code" href="classllvm_1_1StructType.html">StructType</a> *STy = <a class="code" href="classllvm_1_1StructType.html#a82648246c07eb8a33f628eea28cb988c">StructType::create</a>(EltTys, <span class="stringliteral">&quot;gc_map.&quot;</span>+<a class="code" href="namespacellvm.html#ae094b310153c30b08dcec1b40459d385">utostr</a>(NumMeta));</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  </div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  <a class="code" href="classllvm_1_1Constant.html">Constant</a> *FrameMap = <a class="code" href="classllvm_1_1ConstantStruct.html#a54fcfa620deb80373f489ba2fdad7643">ConstantStruct::get</a>(STy, DescriptorElts);</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  <span class="comment">// FIXME: Is this actually dangerous as WritingAnLLVMPass.html claims? Seems</span></div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  <span class="comment">//        that, short of multithreaded LLVM, it should be safe; all that is</span></div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  <span class="comment">//        necessary is that a simple Module::iterator loop not be invalidated.</span></div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  <span class="comment">//        Appending to the GlobalVariable list is safe in that sense.</span></div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  <span class="comment">//</span></div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;  <span class="comment">//        All of the output passes emit globals last. The ExecutionEngine</span></div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  <span class="comment">//        explicitly supports adding globals to the module after</span></div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  <span class="comment">//        initialization.</span></div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  <span class="comment">//</span></div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;  <span class="comment">//        Still, if it isn&#39;t deemed acceptable, then this transformation needs</span></div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;  <span class="comment">//        to be a ModulePass (which means it cannot be in the &#39;llc&#39; pipeline</span></div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;  <span class="comment">//        (which uses a FunctionPassManager (which segfaults (not asserts) if</span></div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  <span class="comment">//        provided a ModulePass))).</span></div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  <a class="code" href="classllvm_1_1Constant.html">Constant</a> *GV = <span class="keyword">new</span> <a class="code" href="classllvm_1_1GlobalVariable.html">GlobalVariable</a>(*F.<a class="code" href="classllvm_1_1GlobalValue.html#a9e1fc23a17e97d2d1732e753ae9251ac">getParent</a>(), FrameMap-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>(), <span class="keyword">true</span>,</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                                    <a class="code" href="classllvm_1_1GlobalValue.html#aedfa75f0c85c4aa85b257f066fbea57ca1511edd03e02d1f3dd277a3c6abf6ad5">GlobalVariable::InternalLinkage</a>,</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;                                    FrameMap, <span class="stringliteral">&quot;__gc_&quot;</span> + F.<a class="code" href="classllvm_1_1Value.html#ad452febc1ac0b394876e640ec03ffa38">getName</a>());</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  <a class="code" href="classllvm_1_1Constant.html">Constant</a> *GEPIndices[2] = {</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                          <a class="code" href="classllvm_1_1ConstantInt.html#a9105541412dab869e18b3cceebfff07d">ConstantInt::get</a>(<a class="code" href="classllvm_1_1Type.html#a30dd396c5b40cd86c1591872e574ccdf">Type::getInt32Ty</a>(F.<a class="code" href="classllvm_1_1Function.html#a2da53ac53516a3f16191f4c8a8eaa3e5">getContext</a>()), 0),</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                          <a class="code" href="classllvm_1_1ConstantInt.html#a9105541412dab869e18b3cceebfff07d">ConstantInt::get</a>(<a class="code" href="classllvm_1_1Type.html#a30dd396c5b40cd86c1591872e574ccdf">Type::getInt32Ty</a>(F.<a class="code" href="classllvm_1_1Function.html#a2da53ac53516a3f16191f4c8a8eaa3e5">getContext</a>()), 0)</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;                          };</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1ConstantExpr.html#a51940249c228e46f1f97932e5f4b8450">ConstantExpr::getGetElementPtr</a>(GV, GEPIndices);</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;}</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<a class="code" href="classllvm_1_1Type.html">Type</a>* ShadowStackGC::GetConcreteStackEntryType(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;F) {</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;  <span class="comment">// doInitialization creates the generic version of this type.</span></div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;  std::vector&lt;Type*&gt; EltTys;</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;  EltTys.push_back(StackEntryTy);</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = 0; <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> != Roots.size(); <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>++)</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    EltTys.push_back(Roots[<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>].second-&gt;getAllocatedType());</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;  </div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1StructType.html#a82648246c07eb8a33f628eea28cb988c">StructType::create</a>(EltTys, <span class="stringliteral">&quot;gc_stackentry.&quot;</span>+F.<a class="code" href="classllvm_1_1Value.html#ad452febc1ac0b394876e640ec03ffa38">getName</a>().<a class="code" href="classllvm_1_1StringRef.html#ab02cb6f4884b5c788efb97b6741dccaf">str</a>());</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;}</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="comment">/// doInitialization - If this module uses the GC intrinsics, find them now. If</span></div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="comment">/// not, exit fast.</span></div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="comment"></span><span class="keywordtype">bool</span> ShadowStackGC::initializeCustomLowering(<a class="code" href="classllvm_1_1Module.html">Module</a> &amp;<a class="code" href="Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>) {</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  <span class="comment">// struct FrameMap {</span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  <span class="comment">//   int32_t NumRoots; // Number of roots in stack frame.</span></div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  <span class="comment">//   int32_t NumMeta;  // Number of metadata descriptors. May be &lt; NumRoots.</span></div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;  <span class="comment">//   void *Meta[];     // May be absent for roots without metadata.</span></div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  <span class="comment">// };</span></div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  std::vector&lt;Type*&gt; EltTys;</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;  <span class="comment">// 32 bits is ok up to a 32GB stack frame. :)</span></div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;  EltTys.push_back(<a class="code" href="classllvm_1_1Type.html#a30dd396c5b40cd86c1591872e574ccdf">Type::getInt32Ty</a>(M.<a class="code" href="classllvm_1_1Module.html#a0e74af4b7c739f3a14e737c3042b6617">getContext</a>()));</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  <span class="comment">// Specifies length of variable length array. </span></div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  EltTys.push_back(<a class="code" href="classllvm_1_1Type.html#a30dd396c5b40cd86c1591872e574ccdf">Type::getInt32Ty</a>(M.<a class="code" href="classllvm_1_1Module.html#a0e74af4b7c739f3a14e737c3042b6617">getContext</a>()));</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  FrameMapTy = <a class="code" href="classllvm_1_1StructType.html#a82648246c07eb8a33f628eea28cb988c">StructType::create</a>(EltTys, <span class="stringliteral">&quot;gc_map&quot;</span>);</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;  <a class="code" href="classllvm_1_1PointerType.html">PointerType</a> *FrameMapPtrTy = <a class="code" href="classllvm_1_1PointerType.html#a8db49fd5069f21d514e7bb0fd11f0902">PointerType::getUnqual</a>(FrameMapTy);</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;  <span class="comment">// struct StackEntry {</span></div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;  <span class="comment">//   ShadowStackEntry *Next; // Caller&#39;s stack entry.</span></div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  <span class="comment">//   FrameMap *Map;          // Pointer to constant FrameMap.</span></div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;  <span class="comment">//   void *Roots[];          // Stack roots (in-place array, so we pretend).</span></div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;  <span class="comment">// };</span></div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;  </div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  StackEntryTy = <a class="code" href="classllvm_1_1StructType.html#a82648246c07eb8a33f628eea28cb988c">StructType::create</a>(M.<a class="code" href="classllvm_1_1Module.html#a0e74af4b7c739f3a14e737c3042b6617">getContext</a>(), <span class="stringliteral">&quot;gc_stackentry&quot;</span>);</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  </div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;  EltTys.clear();</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  EltTys.push_back(<a class="code" href="classllvm_1_1PointerType.html#a8db49fd5069f21d514e7bb0fd11f0902">PointerType::getUnqual</a>(StackEntryTy));</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;  EltTys.push_back(FrameMapPtrTy);</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  StackEntryTy-&gt;<a class="code" href="classllvm_1_1StructType.html#a3861d2f045e00a8114f99f751371ec68">setBody</a>(EltTys);</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;  <a class="code" href="classllvm_1_1PointerType.html">PointerType</a> *StackEntryPtrTy = <a class="code" href="classllvm_1_1PointerType.html#a8db49fd5069f21d514e7bb0fd11f0902">PointerType::getUnqual</a>(StackEntryTy);</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;  <span class="comment">// Get the root chain if it already exists.</span></div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  Head = M.<a class="code" href="classllvm_1_1Module.html#a17ebd56685ee19e7761ae577cd511e25">getGlobalVariable</a>(<span class="stringliteral">&quot;llvm_gc_root_chain&quot;</span>);</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;  <span class="keywordflow">if</span> (!Head) {</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <span class="comment">// If the root chain does not exist, insert a new one with linkonce</span></div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <span class="comment">// linkage!</span></div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    Head = <span class="keyword">new</span> <a class="code" href="classllvm_1_1GlobalVariable.html">GlobalVariable</a>(M, StackEntryPtrTy, <span class="keyword">false</span>,</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;                              <a class="code" href="classllvm_1_1GlobalValue.html#aedfa75f0c85c4aa85b257f066fbea57ca5ebf288ceb5bbeb7025564727db6d705">GlobalValue::LinkOnceAnyLinkage</a>,</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                              <a class="code" href="classllvm_1_1Constant.html#aa6574d526b3e38a28f688a7bb4325c2c">Constant::getNullValue</a>(StackEntryPtrTy),</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                              <span class="stringliteral">&quot;llvm_gc_root_chain&quot;</span>);</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Head-&gt;hasExternalLinkage() &amp;&amp; Head-&gt;isDeclaration()) {</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    Head-&gt;setInitializer(<a class="code" href="classllvm_1_1Constant.html#aa6574d526b3e38a28f688a7bb4325c2c">Constant::getNullValue</a>(StackEntryPtrTy));</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    Head-&gt;setLinkage(<a class="code" href="classllvm_1_1GlobalValue.html#aedfa75f0c85c4aa85b257f066fbea57ca5ebf288ceb5bbeb7025564727db6d705">GlobalValue::LinkOnceAnyLinkage</a>);</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  }</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;}</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="keywordtype">bool</span> ShadowStackGC::IsNullValue(<a class="code" href="classllvm_1_1Value.html">Value</a> *V) {</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Constant.html">Constant</a> *<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = dyn_cast&lt;Constant&gt;(V))</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>-&gt;isNullValue();</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;}</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="keywordtype">void</span> ShadowStackGC::CollectRoots(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;F) {</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;  <span class="comment">// FIXME: Account for original alignment. Could fragment the root array.</span></div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  <span class="comment">//   Approach 1: Null initialize empty slots at runtime. Yuck.</span></div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;  <span class="comment">//   Approach 2: Emit a map of the array instead of just a count.</span></div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;  assert(Roots.empty() &amp;&amp; <span class="stringliteral">&quot;Not cleaned up?&quot;</span>);</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;std::pair&lt;CallInst*, AllocaInst*&gt;</a>, 16&gt; MetaRoots;</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1ilist__iterator.html">Function::iterator</a> <a class="code" href="CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> = F.<a class="code" href="classllvm_1_1Function.html#a88a5e60837674780a9d812d661897ac5">begin</a>(), E = F.<a class="code" href="classllvm_1_1Function.html#ae4ca2261b8b901e415fda7feac5051ea">end</a>(); <a class="code" href="CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> != E; ++<a class="code" href="CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>)</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1ilist__iterator.html">BasicBlock::iterator</a> II = <a class="code" href="CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>-&gt;begin(), E = <a class="code" href="CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>-&gt;end(); II != E;)</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1IntrinsicInst.html">IntrinsicInst</a> *CI = dyn_cast&lt;IntrinsicInst&gt;(II++))</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Function.html">Function</a> *F = CI-&gt;getCalledFunction())</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;          <span class="keywordflow">if</span> (F-&gt;<a class="code" href="classllvm_1_1Function.html#a7e47131185becc5c96731a2e28441b77">getIntrinsicID</a>() == <a class="code" href="namespacellvm_1_1Intrinsic.html#a73349916f7e54a6b988a3646c7a02e90a8aaebe2c6906f0319af14ecd5f20dea9">Intrinsic::gcroot</a>) {</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;            std::pair&lt;CallInst*, AllocaInst*&gt; Pair = std::make_pair(</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;              CI, cast&lt;AllocaInst&gt;(CI-&gt;getArgOperand(0)-&gt;stripPointerCasts()));</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;            <span class="keywordflow">if</span> (IsNullValue(CI-&gt;getArgOperand(1)))</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;              Roots.push_back(Pair);</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;              MetaRoots.push_back(Pair);</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;          }</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;  <span class="comment">// Number roots with metadata (usually empty) at the beginning, so that the</span></div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;  <span class="comment">// FrameMap::Meta array can be elided.</span></div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;  Roots.insert(Roots.begin(), MetaRoots.begin(), MetaRoots.end());</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;}</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<a class="code" href="classllvm_1_1GetElementPtrInst.html">GetElementPtrInst</a> *</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;ShadowStackGC::CreateGEP(<a class="code" href="classllvm_1_1LLVMContext.html">LLVMContext</a> &amp;Context, <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> &amp;<a class="code" href="Target_2ARM_2README_8txt.html#a90cca76dd78688687e0d697679dbc799">B</a>, <a class="code" href="classllvm_1_1Value.html">Value</a> *BasePtr,</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;                         <span class="keywordtype">int</span> Idx, <span class="keywordtype">int</span> Idx2, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="namespacellvm_1_1GraphProgram.html#a0ad4685976f8c4d4a697a53fbe05d10b">Name</a>) {</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Indices[] = { <a class="code" href="classllvm_1_1ConstantInt.html#a9105541412dab869e18b3cceebfff07d">ConstantInt::get</a>(<a class="code" href="classllvm_1_1Type.html#a30dd396c5b40cd86c1591872e574ccdf">Type::getInt32Ty</a>(Context), 0),</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;                       <a class="code" href="classllvm_1_1ConstantInt.html#a9105541412dab869e18b3cceebfff07d">ConstantInt::get</a>(<a class="code" href="classllvm_1_1Type.html#a30dd396c5b40cd86c1591872e574ccdf">Type::getInt32Ty</a>(Context), Idx),</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;                       <a class="code" href="classllvm_1_1ConstantInt.html#a9105541412dab869e18b3cceebfff07d">ConstantInt::get</a>(<a class="code" href="classllvm_1_1Type.html#a30dd396c5b40cd86c1591872e574ccdf">Type::getInt32Ty</a>(Context), Idx2) };</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a>* Val = B.<a class="code" href="classllvm_1_1IRBuilder.html#ac46176b523c8a76a9ccdb5683279db94">CreateGEP</a>(BasePtr, Indices, Name);</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;  assert(isa&lt;GetElementPtrInst&gt;(Val) &amp;&amp; <span class="stringliteral">&quot;Unexpected folded constant&quot;</span>);</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1GetElementPtrInst.html">GetElementPtrInst</a>&gt;(Val);</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;}</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<a class="code" href="classllvm_1_1GetElementPtrInst.html">GetElementPtrInst</a> *</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;ShadowStackGC::CreateGEP(<a class="code" href="classllvm_1_1LLVMContext.html">LLVMContext</a> &amp;Context, <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> &amp;B, <a class="code" href="classllvm_1_1Value.html">Value</a> *BasePtr,</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;                         <span class="keywordtype">int</span> Idx, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="namespacellvm_1_1GraphProgram.html#a0ad4685976f8c4d4a697a53fbe05d10b">Name</a>) {</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Indices[] = { <a class="code" href="classllvm_1_1ConstantInt.html#a9105541412dab869e18b3cceebfff07d">ConstantInt::get</a>(<a class="code" href="classllvm_1_1Type.html#a30dd396c5b40cd86c1591872e574ccdf">Type::getInt32Ty</a>(Context), 0),</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;                       <a class="code" href="classllvm_1_1ConstantInt.html#a9105541412dab869e18b3cceebfff07d">ConstantInt::get</a>(<a class="code" href="classllvm_1_1Type.html#a30dd396c5b40cd86c1591872e574ccdf">Type::getInt32Ty</a>(Context), Idx) };</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Val = B.<a class="code" href="classllvm_1_1IRBuilder.html#ac46176b523c8a76a9ccdb5683279db94">CreateGEP</a>(BasePtr, Indices, Name);</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;  assert(isa&lt;GetElementPtrInst&gt;(Val) &amp;&amp; <span class="stringliteral">&quot;Unexpected folded constant&quot;</span>);</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1GetElementPtrInst.html">GetElementPtrInst</a>&gt;(Val);</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;}</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="comment">/// runOnFunction - Insert code to maintain the shadow stack.</span></div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="comment"></span><span class="keywordtype">bool</span> ShadowStackGC::performCustomLowering(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;F) {</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;  <a class="code" href="classllvm_1_1LLVMContext.html">LLVMContext</a> &amp;Context = F.<a class="code" href="classllvm_1_1Function.html#a2da53ac53516a3f16191f4c8a8eaa3e5">getContext</a>();</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;  </div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;  <span class="comment">// Find calls to llvm.gcroot.</span></div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;  CollectRoots(F);</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;  <span class="comment">// If there are no roots in this function, then there is no need to add a</span></div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;  <span class="comment">// stack map entry for it.</span></div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;  <span class="keywordflow">if</span> (Roots.empty())</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;  <span class="comment">// Build the constant map and figure the type of the shadow stack entry.</span></div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *FrameMap = GetFrameMap(F);</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *ConcreteStackEntryTy = GetConcreteStackEntryType(F);</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;  <span class="comment">// Build the shadow stack entry at the very start of the function.</span></div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;  <a class="code" href="classllvm_1_1ilist__iterator.html">BasicBlock::iterator</a> IP = F.<a class="code" href="classllvm_1_1Function.html#a30f2c362631e3728d2f47a8203071ade">getEntryBlock</a>().<a class="code" href="classllvm_1_1BasicBlock.html#a0ed5f3ab3c2e4196ee0cffffa080c062">begin</a>();</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;  <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> AtEntry(IP-&gt;getParent(), IP);</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *StackEntry   = AtEntry.CreateAlloca(ConcreteStackEntryTy, 0,</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;                                                   <span class="stringliteral">&quot;gc_frame&quot;</span>);</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  <span class="keywordflow">while</span> (isa&lt;AllocaInst&gt;(IP)) ++IP;</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;  AtEntry.SetInsertPoint(IP-&gt;getParent(), IP);</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;  <span class="comment">// Initialize the map pointer and load the current head of the shadow stack.</span></div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *CurrentHead  = AtEntry.CreateLoad(Head, <span class="stringliteral">&quot;gc_currhead&quot;</span>);</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *EntryMapPtr  = CreateGEP(Context, AtEntry, StackEntry,</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;                                        0,1,<span class="stringliteral">&quot;gc_frame.map&quot;</span>);</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;  AtEntry.CreateStore(FrameMap, EntryMapPtr);</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;  <span class="comment">// After all the allocas...</span></div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = 0, E = Roots.size(); <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> != E; ++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    <span class="comment">// For each root, find the corresponding slot in the aggregate...</span></div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *SlotPtr = CreateGEP(Context, AtEntry, StackEntry, 1 + <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <span class="stringliteral">&quot;gc_root&quot;</span>);</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    <span class="comment">// And use it in lieu of the alloca.</span></div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    <a class="code" href="classllvm_1_1AllocaInst.html">AllocaInst</a> *OriginalAlloca = Roots[<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>].second;</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    SlotPtr-&gt;<a class="code" href="classllvm_1_1Value.html#ae855357b6c5e6e7ed1869272708a3a84">takeName</a>(OriginalAlloca);</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    OriginalAlloca-&gt;<a class="code" href="classllvm_1_1Value.html#a3ab5fc45117b450e8bb04e564cb6e5f2">replaceAllUsesWith</a>(SlotPtr);</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;  }</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;  <span class="comment">// Move past the original stores inserted by GCStrategy::InitRoots. This isn&#39;t</span></div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;  <span class="comment">// really necessary (the collector would never see the intermediate state at</span></div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;  <span class="comment">// runtime), but it&#39;s nicer not to push the half-initialized entry onto the</span></div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;  <span class="comment">// shadow stack.</span></div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;  <span class="keywordflow">while</span> (isa&lt;StoreInst&gt;(IP)) ++IP;</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;  AtEntry.SetInsertPoint(IP-&gt;getParent(), IP);</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;  <span class="comment">// Push the entry onto the shadow stack.</span></div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *EntryNextPtr = CreateGEP(Context, AtEntry,</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;                                        StackEntry,0,0,<span class="stringliteral">&quot;gc_frame.next&quot;</span>);</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *NewHeadVal   = CreateGEP(Context, AtEntry, </div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;                                        StackEntry, 0, <span class="stringliteral">&quot;gc_newhead&quot;</span>);</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;  AtEntry.CreateStore(CurrentHead, EntryNextPtr);</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;  AtEntry.CreateStore(NewHeadVal, Head);</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;  <span class="comment">// For each instruction that escapes...</span></div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;  EscapeEnumerator EE(F, <span class="stringliteral">&quot;gc_cleanup&quot;</span>);</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;  <span class="keywordflow">while</span> (<a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> *AtExit = EE.Next()) {</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <span class="comment">// Pop the entry from the shadow stack. Don&#39;t reuse CurrentHead from</span></div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    <span class="comment">// AtEntry, since that would make the value live for the entire function.</span></div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *EntryNextPtr2 = CreateGEP(Context, *AtExit, StackEntry, 0, 0,</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;                                           <span class="stringliteral">&quot;gc_frame.next&quot;</span>);</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *SavedHead = AtExit-&gt;CreateLoad(EntryNextPtr2, <span class="stringliteral">&quot;gc_savedhead&quot;</span>);</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;                       AtExit-&gt;CreateStore(SavedHead, Head);</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;  }</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;  <span class="comment">// Delete the original allocas (which are no longer used) and the intrinsic</span></div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;  <span class="comment">// calls (which are no longer valid). Doing this last avoids invalidating</span></div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;  <span class="comment">// iterators.</span></div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = 0, E = Roots.size(); <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> != E; ++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    Roots[<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>].first-&gt;eraseFromParent();</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    Roots[<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>].second-&gt;eraseFromParent();</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;  }</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;  Roots.clear();</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;}</div><div class="ttc" id="classllvm_1_1IRBuilder_html_ac46176b523c8a76a9ccdb5683279db94"><div class="ttname"><a href="classllvm_1_1IRBuilder.html#ac46176b523c8a76a9ccdb5683279db94">llvm::IRBuilder::CreateGEP</a></div><div class="ttdeci">Value * CreateGEP(Value *Ptr, ArrayRef&lt; Value * &gt; IdxList, const Twine &amp;Name=&quot;&quot;)</div><div class="ttdef"><b>Definition:</b> <a href="IRBuilder_8h_source.html#l00931">IRBuilder.h:931</a></div></div>
<div class="ttc" id="classllvm_1_1SmallVectorTemplateCommon_html_a22a311dfe4c28a897de8a9365a4f0a84"><div class="ttname"><a href="classllvm_1_1SmallVectorTemplateCommon.html#a22a311dfe4c28a897de8a9365a4f0a84">llvm::SmallVectorTemplateCommon&lt; T &gt;::size</a></div><div class="ttdeci">size_type size() const</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00127">SmallVector.h:127</a></div></div>
<div class="ttc" id="classllvm_1_1CallInst_html_a6917dcd78ac6655e9640ac3a96175e39"><div class="ttname"><a href="classllvm_1_1CallInst.html#a6917dcd78ac6655e9640ac3a96175e39">llvm::CallInst::getCalledValue</a></div><div class="ttdeci">const Value * getCalledValue() const </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l01363">Instructions.h:1363</a></div></div>
<div class="ttc" id="classllvm_1_1InvokeInst_html_a0ac43fb5c325583e49d892c023c9b7f8"><div class="ttname"><a href="classllvm_1_1InvokeInst.html#a0ac43fb5c325583e49d892c023c9b7f8">llvm::InvokeInst::setAttributes</a></div><div class="ttdeci">void setAttributes(const AttributeSet &amp;Attrs)</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02907">Instructions.h:2907</a></div></div>
<div class="ttc" id="classllvm_1_1SmallVectorTemplateBase_html_ae1a10b90f22c0478960fb5798ff73916"><div class="ttname"><a href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">llvm::SmallVectorTemplateBase&lt; T, isPodLike&lt; T &gt;::value &gt;::push_back</a></div><div class="ttdeci">void push_back(const T &amp;Elt)</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00236">SmallVector.h:236</a></div></div>
<div class="ttc" id="classllvm_1_1Function_html_a2da53ac53516a3f16191f4c8a8eaa3e5"><div class="ttname"><a href="classllvm_1_1Function.html#a2da53ac53516a3f16191f4c8a8eaa3e5">llvm::Function::getContext</a></div><div class="ttdeci">LLVMContext &amp; getContext() const </div><div class="ttdef"><b>Definition:</b> <a href="Function_8cpp_source.html#l00167">Function.cpp:167</a></div></div>
<div class="ttc" id="namespacellvm_html"><div class="ttname"><a href="namespacellvm.html">llvm</a></div><div class="ttdoc">List of target independent CodeGen pass IDs. </div><div class="ttdef"><b>Definition:</b> <a href="APFloat_8h_source.html#l00022">APFloat.h:22</a></div></div>
<div class="ttc" id="classllvm_1_1iplist_html_a7d1d4ff826882f1d65929653c293e5cc"><div class="ttname"><a href="classllvm_1_1iplist.html#a7d1d4ff826882f1d65929653c293e5cc">llvm::iplist::pop_back</a></div><div class="ttdeci">void pop_back()</div><div class="ttdef"><b>Definition:</b> <a href="ilist_8h_source.html#l00559">ilist.h:559</a></div></div>
<div class="ttc" id="classllvm_1_1Module_html"><div class="ttname"><a href="classllvm_1_1Module.html">llvm::Module</a></div><div class="ttdoc">The main container class for the LLVM Intermediate Representation. </div><div class="ttdef"><b>Definition:</b> <a href="Module_8h_source.html#l00112">Module.h:112</a></div></div>
<div class="ttc" id="classllvm_1_1CallSiteBase_html_acc2eeccdf71d83b3c08d6218317a1430"><div class="ttname"><a href="classllvm_1_1CallSiteBase.html#acc2eeccdf71d83b3c08d6218317a1430">llvm::CallSiteBase::arg_end</a></div><div class="ttdeci">IterTy arg_end() const </div><div class="ttdef"><b>Definition:</b> <a href="CallSite_8h_source.html#l00143">CallSite.h:143</a></div></div>
<div class="ttc" id="classllvm_1_1Function_html_ae4ca2261b8b901e415fda7feac5051ea"><div class="ttname"><a href="classllvm_1_1Function.html#ae4ca2261b8b901e415fda7feac5051ea">llvm::Function::end</a></div><div class="ttdeci">iterator end()</div><div class="ttdef"><b>Definition:</b> <a href="Function_8h_source.html#l00397">Function.h:397</a></div></div>
<div class="ttc" id="IntrinsicInst_8h_html"><div class="ttname"><a href="IntrinsicInst_8h.html">IntrinsicInst.h</a></div></div>
<div class="ttc" id="namespacellvm_html_a3f2f98c2a67c9e79f58aad9150a62e42"><div class="ttname"><a href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">llvm::dyn_cast</a></div><div class="ttdeci">enable_if_c&lt;!is_simple_type&lt; Y &gt;::value, typename cast_retty&lt; X, const Y &gt;::ret_type &gt;::type dyn_cast(const Y &amp;Val)</div><div class="ttdef"><b>Definition:</b> <a href="Casting_8h_source.html#l00266">Casting.h:266</a></div></div>
<div class="ttc" id="classllvm_1_1ConstantExpr_html_a51940249c228e46f1f97932e5f4b8450"><div class="ttname"><a href="classllvm_1_1ConstantExpr.html#a51940249c228e46f1f97932e5f4b8450">llvm::ConstantExpr::getGetElementPtr</a></div><div class="ttdeci">static Constant * getGetElementPtr(Constant *C, ArrayRef&lt; Constant * &gt; IdxList, bool InBounds=false)</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8h_source.html#l01012">Constants.h:1012</a></div></div>
<div class="ttc" id="classllvm_1_1CallInst_html"><div class="ttname"><a href="classllvm_1_1CallInst.html">llvm::CallInst</a></div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l01161">Instructions.h:1161</a></div></div>
<div class="ttc" id="classllvm_1_1StringRef_html_ab02cb6f4884b5c788efb97b6741dccaf"><div class="ttname"><a href="classllvm_1_1StringRef.html#ab02cb6f4884b5c788efb97b6741dccaf">llvm::StringRef::str</a></div><div class="ttdeci">std::string str() const </div><div class="ttdoc">str - Get the contents as an std::string. </div><div class="ttdef"><b>Definition:</b> <a href="StringRef_8h_source.html#l00181">StringRef.h:181</a></div></div>
<div class="ttc" id="LLParser_8cpp_html_a33ece1ef8074506a15d7f86eb76dbae6"><div class="ttname"><a href="LLParser_8cpp.html#a33ece1ef8074506a15d7f86eb76dbae6">F</a></div><div class="ttdeci">F(f)</div></div>
<div class="ttc" id="classllvm_1_1Function_html"><div class="ttname"><a href="classllvm_1_1Function.html">llvm::Function</a></div><div class="ttdef"><b>Definition:</b> <a href="Function_8h_source.html#l00070">Function.h:70</a></div></div>
<div class="ttc" id="classllvm_1_1Module_html_a17ebd56685ee19e7761ae577cd511e25"><div class="ttname"><a href="classllvm_1_1Module.html#a17ebd56685ee19e7761ae577cd511e25">llvm::Module::getGlobalVariable</a></div><div class="ttdeci">const GlobalVariable * getGlobalVariable(StringRef Name, bool AllowInternal=false) const </div><div class="ttdef"><b>Definition:</b> <a href="Module_8h_source.html#l00355">Module.h:355</a></div></div>
<div class="ttc" id="CallSite_8h_html"><div class="ttname"><a href="CallSite_8h.html">CallSite.h</a></div></div>
<div class="ttc" id="classllvm_1_1Constant_html_aa6574d526b3e38a28f688a7bb4325c2c"><div class="ttname"><a href="classllvm_1_1Constant.html#aa6574d526b3e38a28f688a7bb4325c2c">llvm::Constant::getNullValue</a></div><div class="ttdeci">static Constant * getNullValue(Type *Ty)</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l00111">Constants.cpp:111</a></div></div>
<div class="ttc" id="classllvm_1_1Value_html_ad452febc1ac0b394876e640ec03ffa38"><div class="ttname"><a href="classllvm_1_1Value.html#ad452febc1ac0b394876e640ec03ffa38">llvm::Value::getName</a></div><div class="ttdeci">StringRef getName() const </div><div class="ttdef"><b>Definition:</b> <a href="Value_8cpp_source.html#l00167">Value.cpp:167</a></div></div>
<div class="ttc" id="classllvm_1_1BasicBlock_html_a0ed5f3ab3c2e4196ee0cffffa080c062"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a0ed5f3ab3c2e4196ee0cffffa080c062">llvm::BasicBlock::begin</a></div><div class="ttdeci">iterator begin()</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00193">BasicBlock.h:193</a></div></div>
<div class="ttc" id="namespacellvm_1_1GraphProgram_html_a0ad4685976f8c4d4a697a53fbe05d10b"><div class="ttname"><a href="namespacellvm_1_1GraphProgram.html#a0ad4685976f8c4d4a697a53fbe05d10b">llvm::GraphProgram::Name</a></div><div class="ttdeci">Name</div><div class="ttdef"><b>Definition:</b> <a href="GraphWriter_8h_source.html#l00044">GraphWriter.h:44</a></div></div>
<div class="ttc" id="classllvm_1_1StructType_html"><div class="ttname"><a href="classllvm_1_1StructType.html">llvm::StructType</a></div><div class="ttdef"><b>Definition:</b> <a href="DerivedTypes_8h_source.html#l00187">DerivedTypes.h:187</a></div></div>
<div class="ttc" id="classllvm_1_1IRBuilder_html"><div class="ttname"><a href="classllvm_1_1IRBuilder.html">llvm::IRBuilder</a></div><div class="ttdoc">This provides a uniform API for creating instructions and inserting them into a basic block: either a...</div><div class="ttdef"><b>Definition:</b> <a href="IRBuilder_8h_source.html#l00421">IRBuilder.h:421</a></div></div>
<div class="ttc" id="classllvm_1_1Instruction_html"><div class="ttname"><a href="classllvm_1_1Instruction.html">llvm::Instruction</a></div><div class="ttdef"><b>Definition:</b> <a href="Instruction_8h_source.html#l00031">Instruction.h:31</a></div></div>
<div class="ttc" id="classllvm_1_1LandingPadInst_html_a97bc0afbd46cc7b3539e1cba861ac350"><div class="ttname"><a href="classllvm_1_1LandingPadInst.html#a97bc0afbd46cc7b3539e1cba861ac350">llvm::LandingPadInst::setCleanup</a></div><div class="ttdeci">void setCleanup(bool V)</div><div class="ttdoc">setCleanup - Indicate that this landingpad instruction is a cleanup. </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02227">Instructions.h:2227</a></div></div>
<div class="ttc" id="classllvm_1_1SmallVectorBase_html_a8a8df4d85555c7954a95f86080cd3b64"><div class="ttname"><a href="classllvm_1_1SmallVectorBase.html#a8a8df4d85555c7954a95f86080cd3b64">llvm::SmallVectorBase::empty</a></div><div class="ttdeci">bool LLVM_ATTRIBUTE_UNUSED_RESULT empty() const </div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00056">SmallVector.h:56</a></div></div>
<div class="ttc" id="GCs_8h_html"><div class="ttname"><a href="GCs_8h.html">GCs.h</a></div></div>
<div class="ttc" id="classllvm_1_1LandingPadInst_html_ab79ff0e2579505f12d7eee951335e5ff"><div class="ttname"><a href="classllvm_1_1LandingPadInst.html#ab79ff0e2579505f12d7eee951335e5ff">llvm::LandingPadInst::Create</a></div><div class="ttdeci">static LandingPadInst * Create(Type *RetTy, Value *PersonalityFn, unsigned NumReservedClauses, const Twine &amp;NameStr=&quot;&quot;, Instruction *InsertBefore=0)</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8cpp_source.html#l00209">Instructions.cpp:209</a></div></div>
<div class="ttc" id="classllvm_1_1FunctionType_html_a7e89b55242c964ae61b7850e99cacef0"><div class="ttname"><a href="classllvm_1_1FunctionType.html#a7e89b55242c964ae61b7850e99cacef0">llvm::FunctionType::get</a></div><div class="ttdeci">static FunctionType * get(Type *Result, ArrayRef&lt; Type * &gt; Params, bool isVarArg)</div><div class="ttdef"><b>Definition:</b> <a href="Type_8cpp_source.html#l00361">Type.cpp:361</a></div></div>
<div class="ttc" id="namespacellvm_html_ae094b310153c30b08dcec1b40459d385"><div class="ttname"><a href="namespacellvm.html#ae094b310153c30b08dcec1b40459d385">llvm::utostr</a></div><div class="ttdeci">static std::string utostr(uint64_t X, bool isNeg=false)</div><div class="ttdef"><b>Definition:</b> <a href="StringExtras_8h_source.html#l00088">StringExtras.h:88</a></div></div>
<div class="ttc" id="classllvm_1_1Value_html_a3ab5fc45117b450e8bb04e564cb6e5f2"><div class="ttname"><a href="classllvm_1_1Value.html#a3ab5fc45117b450e8bb04e564cb6e5f2">llvm::Value::replaceAllUsesWith</a></div><div class="ttdeci">void replaceAllUsesWith(Value *V)</div><div class="ttdef"><b>Definition:</b> <a href="Value_8cpp_source.html#l00303">Value.cpp:303</a></div></div>
<div class="ttc" id="classllvm_1_1Value_html_ae855357b6c5e6e7ed1869272708a3a84"><div class="ttname"><a href="classllvm_1_1Value.html#ae855357b6c5e6e7ed1869272708a3a84">llvm::Value::takeName</a></div><div class="ttdeci">void takeName(Value *V)</div><div class="ttdef"><b>Definition:</b> <a href="Value_8cpp_source.html#l00239">Value.cpp:239</a></div></div>
<div class="ttc" id="classllvm_1_1Function_html_a88a5e60837674780a9d812d661897ac5"><div class="ttname"><a href="classllvm_1_1Function.html#a88a5e60837674780a9d812d661897ac5">llvm::Function::begin</a></div><div class="ttdeci">iterator begin()</div><div class="ttdef"><b>Definition:</b> <a href="Function_8h_source.html#l00395">Function.h:395</a></div></div>
<div class="ttc" id="classllvm_1_1IRBuilderBase_html_ace45cae6925c65e9d6916e09dd5b17cc"><div class="ttname"><a href="classllvm_1_1IRBuilderBase.html#ace45cae6925c65e9d6916e09dd5b17cc">llvm::IRBuilderBase::SetInsertPoint</a></div><div class="ttdeci">void SetInsertPoint(BasicBlock *TheBB)</div><div class="ttdoc">This specifies that created instructions should be appended to the end of the specified block...</div><div class="ttdef"><b>Definition:</b> <a href="IRBuilder_8h_source.html#l00083">IRBuilder.h:83</a></div></div>
<div class="ttc" id="classllvm_1_1PointerType_html"><div class="ttname"><a href="classllvm_1_1PointerType.html">llvm::PointerType</a></div><div class="ttdef"><b>Definition:</b> <a href="DerivedTypes_8h_source.html#l00425">DerivedTypes.h:425</a></div></div>
<div class="ttc" id="classllvm_1_1GetElementPtrInst_html"><div class="ttname"><a href="classllvm_1_1GetElementPtrInst.html">llvm::GetElementPtrInst</a></div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00709">Instructions.h:709</a></div></div>
<div class="ttc" id="GCStrategy_8h_html"><div class="ttname"><a href="GCStrategy_8h.html">GCStrategy.h</a></div></div>
<div class="ttc" id="README__ALTIVEC_8txt_html_a9aacd9146afe44bf656cd664e2a88c8c"><div class="ttname"><a href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a></div><div class="ttdeci">(vector float) vec_cmpeq(*A,*B) C</div><div class="ttdef"><b>Definition:</b> <a href="README__ALTIVEC_8txt_source.html#l00091">README_ALTIVEC.txt:91</a></div></div>
<div class="ttc" id="classllvm_1_1LandingPadInst_html"><div class="ttname"><a href="classllvm_1_1LandingPadInst.html">llvm::LandingPadInst</a></div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02178">Instructions.h:2178</a></div></div>
<div class="ttc" id="classllvm_1_1TerminatorInst_html"><div class="ttname"><a href="classllvm_1_1TerminatorInst.html">llvm::TerminatorInst</a></div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00035">InstrTypes.h:35</a></div></div>
<div class="ttc" id="classllvm_1_1SmallVectorImpl_html_aac0ea55010b7b1a301e65a0baea057aa"><div class="ttname"><a href="classllvm_1_1SmallVectorImpl.html#aac0ea55010b7b1a301e65a0baea057aa">llvm::SmallVectorImpl::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00396">SmallVector.h:396</a></div></div>
<div class="ttc" id="classllvm_1_1BasicBlock_html"><div class="ttname"><a href="classllvm_1_1BasicBlock.html">llvm::BasicBlock</a></div><div class="ttdoc">LLVM Basic Block Representation. </div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00072">BasicBlock.h:72</a></div></div>
<div class="ttc" id="classllvm_1_1Type_html"><div class="ttname"><a href="classllvm_1_1Type.html">llvm::Type</a></div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00044">Type.h:44</a></div></div>
<div class="ttc" id="classllvm_1_1LLVMContext_html"><div class="ttname"><a href="classllvm_1_1LLVMContext.html">llvm::LLVMContext</a></div><div class="ttdef"><b>Definition:</b> <a href="LLVMContext_8h_source.html#l00037">LLVMContext.h:37</a></div></div>
<div class="ttc" id="classllvm_1_1Function_html_a7e47131185becc5c96731a2e28441b77"><div class="ttname"><a href="classllvm_1_1Function.html#a7e47131185becc5c96731a2e28441b77">llvm::Function::getIntrinsicID</a></div><div class="ttdeci">unsigned getIntrinsicID() const LLVM_READONLY</div><div class="ttdef"><b>Definition:</b> <a href="Function_8cpp_source.html#l00371">Function.cpp:371</a></div></div>
<div class="ttc" id="classllvm_1_1Constant_html"><div class="ttname"><a href="classllvm_1_1Constant.html">llvm::Constant</a></div><div class="ttdoc">LLVM Constant Representation. </div><div class="ttdef"><b>Definition:</b> <a href="Constant_8h_source.html#l00041">Constant.h:41</a></div></div>
<div class="ttc" id="classllvm_1_1ResumeInst_html"><div class="ttname"><a href="classllvm_1_1ResumeInst.html">llvm::ResumeInst</a></div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l03090">Instructions.h:3090</a></div></div>
<div class="ttc" id="classllvm_1_1ConstantArray_html_a0900dacdc7ad8e3ea0cc92993c7fd422"><div class="ttname"><a href="classllvm_1_1ConstantArray.html#a0900dacdc7ad8e3ea0cc92993c7fd422">llvm::ConstantArray::get</a></div><div class="ttdeci">static Constant * get(ArrayType *T, ArrayRef&lt; Constant * &gt; V)</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l00745">Constants.cpp:745</a></div></div>
<div class="ttc" id="classllvm_1_1InvokeInst_html_a03007b982a936464f7116e3c47df89ee"><div class="ttname"><a href="classllvm_1_1InvokeInst.html#a03007b982a936464f7116e3c47df89ee">llvm::InvokeInst::Create</a></div><div class="ttdeci">static InvokeInst * Create(Value *Func, BasicBlock *IfNormal, BasicBlock *IfException, ArrayRef&lt; Value * &gt; Args, const Twine &amp;NameStr=&quot;&quot;, Instruction *InsertBefore=0)</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02863">Instructions.h:2863</a></div></div>
<div class="ttc" id="classllvm_1_1BasicBlock_html_a531d11ba36ed48d86057d507cc8d5567"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a531d11ba36ed48d86057d507cc8d5567">llvm::BasicBlock::getInstList</a></div><div class="ttdeci">const InstListType &amp; getInstList() const </div><div class="ttdoc">Return the underlying instruction list container. </div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00214">BasicBlock.h:214</a></div></div>
<div class="ttc" id="classllvm_1_1ConstantStruct_html_a54fcfa620deb80373f489ba2fdad7643"><div class="ttname"><a href="classllvm_1_1ConstantStruct.html#a54fcfa620deb80373f489ba2fdad7643">llvm::ConstantStruct::get</a></div><div class="ttdeci">static Constant * get(StructType *T, ArrayRef&lt; Constant * &gt; V)</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l00874">Constants.cpp:874</a></div></div>
<div class="ttc" id="classllvm_1_1SmallVectorImpl_html_a669d55980a7d4b6307b94596deeb0b1f"><div class="ttname"><a href="classllvm_1_1SmallVectorImpl.html#a669d55980a7d4b6307b94596deeb0b1f">llvm::SmallVectorImpl::append</a></div><div class="ttdeci">void append(in_iter in_start, in_iter in_end)</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00445">SmallVector.h:445</a></div></div>
<div class="ttc" id="namespacellvm_html_aac42ef404bc7910d17a8bfec923e2d4b"><div class="ttname"><a href="namespacellvm.html#aac42ef404bc7910d17a8bfec923e2d4b">llvm::linkShadowStackGC</a></div><div class="ttdeci">void linkShadowStackGC()</div><div class="ttdef"><b>Definition:</b> <a href="ShadowStackGC_8cpp_source.html#l00195">ShadowStackGC.cpp:195</a></div></div>
<div class="ttc" id="classllvm_1_1GlobalVariable_html"><div class="ttname"><a href="classllvm_1_1GlobalVariable.html">llvm::GlobalVariable</a></div><div class="ttdef"><b>Definition:</b> <a href="GlobalVariable_8h_source.html#l00035">GlobalVariable.h:35</a></div></div>
<div class="ttc" id="classllvm_1_1Type_html_a7fe9ccd4893f4e2caa826126c09545ea"><div class="ttname"><a href="classllvm_1_1Type.html#a7fe9ccd4893f4e2caa826126c09545ea">llvm::Type::getInt8PtrTy</a></div><div class="ttdeci">static PointerType * getInt8PtrTy(LLVMContext &amp;C, unsigned AS=0)</div><div class="ttdef"><b>Definition:</b> <a href="Type_8cpp_source.html#l00284">Type.cpp:284</a></div></div>
<div class="ttc" id="classllvm_1_1StructType_html_a3861d2f045e00a8114f99f751371ec68"><div class="ttname"><a href="classllvm_1_1StructType.html#a3861d2f045e00a8114f99f751371ec68">llvm::StructType::setBody</a></div><div class="ttdeci">void setBody(ArrayRef&lt; Type * &gt; Elements, bool isPacked=false)</div><div class="ttdoc">setBody - Specify a body for an opaque identified type. </div><div class="ttdef"><b>Definition:</b> <a href="Type_8cpp_source.html#l00426">Type.cpp:426</a></div></div>
<div class="ttc" id="classllvm_1_1ConstantExpr_html_aba93ec4079f8d709a1d5b4745310782e"><div class="ttname"><a href="classllvm_1_1ConstantExpr.html#aba93ec4079f8d709a1d5b4745310782e">llvm::ConstantExpr::getBitCast</a></div><div class="ttdeci">static Constant * getBitCast(Constant *C, Type *Ty)</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l01672">Constants.cpp:1672</a></div></div>
<div class="ttc" id="classllvm_1_1ilist__iterator_html"><div class="ttname"><a href="classllvm_1_1ilist__iterator.html">llvm::ilist_iterator</a></div><div class="ttdef"><b>Definition:</b> <a href="ilist_8h_source.html#l00050">ilist.h:50</a></div></div>
<div class="ttc" id="classllvm_1_1PointerType_html_a8db49fd5069f21d514e7bb0fd11f0902"><div class="ttname"><a href="classllvm_1_1PointerType.html#a8db49fd5069f21d514e7bb0fd11f0902">llvm::PointerType::getUnqual</a></div><div class="ttdeci">static PointerType * getUnqual(Type *ElementType)</div><div class="ttdef"><b>Definition:</b> <a href="DerivedTypes_8h_source.html#l00436">DerivedTypes.h:436</a></div></div>
<div class="ttc" id="classllvm_1_1StructType_html_a18fc4545474c6ebb6f7c547f64f4fb31"><div class="ttname"><a href="classllvm_1_1StructType.html#a18fc4545474c6ebb6f7c547f64f4fb31">llvm::StructType::get</a></div><div class="ttdeci">static StructType * get(LLVMContext &amp;Context, ArrayRef&lt; Type * &gt; Elements, bool isPacked=false)</div><div class="ttdef"><b>Definition:</b> <a href="Type_8cpp_source.html#l00405">Type.cpp:405</a></div></div>
<div class="ttc" id="classllvm_1_1SmallVector_html"><div class="ttname"><a href="classllvm_1_1SmallVector.html">llvm::SmallVector</a></div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00880">SmallVector.h:880</a></div></div>
<div class="ttc" id="classllvm_1_1GlobalValue_html_aedfa75f0c85c4aa85b257f066fbea57ca5ebf288ceb5bbeb7025564727db6d705"><div class="ttname"><a href="classllvm_1_1GlobalValue.html#aedfa75f0c85c4aa85b257f066fbea57ca5ebf288ceb5bbeb7025564727db6d705">llvm::GlobalValue::LinkOnceAnyLinkage</a></div><div class="ttdoc">Keep one copy of function when linking (inline) </div><div class="ttdef"><b>Definition:</b> <a href="GlobalValue_8h_source.html#l00036">GlobalValue.h:36</a></div></div>
<div class="ttc" id="Module_8h_html"><div class="ttname"><a href="Module_8h.html">Module.h</a></div></div>
<div class="ttc" id="classllvm_1_1Value_html_a0cf3748dba54f931bb1241ae4adc76bc"><div class="ttname"><a href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">llvm::Value::getType</a></div><div class="ttdeci">Type * getType() const </div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00111">Value.h:111</a></div></div>
<div class="ttc" id="namespacellvm_1_1Intrinsic_html_a73349916f7e54a6b988a3646c7a02e90a8aaebe2c6906f0319af14ecd5f20dea9"><div class="ttname"><a href="namespacellvm_1_1Intrinsic.html#a73349916f7e54a6b988a3646c7a02e90a8aaebe2c6906f0319af14ecd5f20dea9">llvm::Intrinsic::gcroot</a></div><div class="ttdef"><b>Definition:</b> <a href="Intrinsics_8h_source.html#l00396">Intrinsics.h:396</a></div></div>
<div class="ttc" id="classllvm_1_1ConstantInt_html_a9105541412dab869e18b3cceebfff07d"><div class="ttname"><a href="classllvm_1_1ConstantInt.html#a9105541412dab869e18b3cceebfff07d">llvm::ConstantInt::get</a></div><div class="ttdeci">static Constant * get(Type *Ty, uint64_t V, bool isSigned=false)</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l00492">Constants.cpp:492</a></div></div>
<div class="ttc" id="classllvm_1_1Function_html_a30f2c362631e3728d2f47a8203071ade"><div class="ttname"><a href="classllvm_1_1Function.html#a30f2c362631e3728d2f47a8203071ade">llvm::Function::getEntryBlock</a></div><div class="ttdeci">const BasicBlock &amp; getEntryBlock() const </div><div class="ttdef"><b>Definition:</b> <a href="Function_8h_source.html#l00380">Function.h:380</a></div></div>
<div class="ttc" id="classllvm_1_1Constant_html_ad7ec8482f19e8e86e3de573b060a17e5"><div class="ttname"><a href="classllvm_1_1Constant.html#ad7ec8482f19e8e86e3de573b060a17e5">llvm::Constant::isNullValue</a></div><div class="ttdeci">bool isNullValue() const </div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l00075">Constants.cpp:75</a></div></div>
<div class="ttc" id="CodeGen_2README_8txt_html_a09776db24cf586ec9f1e18f3bae14099"><div class="ttname"><a href="CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a></div><div class="ttdeci">Common register allocation spilling lr str ldr sxth r3 ldr mla r4 can lr mov lr str ldr sxth r3 mla r4 and then merge mul and lr str ldr sxth r3 mla r4 It also increase the likelihood the store may become dead bb27 Successors according to LLVM BB</div><div class="ttdef"><b>Definition:</b> <a href="CodeGen_2README_8txt_source.html#l00036">CodeGen/README.txt:36</a></div></div>
<div class="ttc" id="classllvm_1_1CallInst_html_a39fed9e3fb9323a7eb73cb65409f5586"><div class="ttname"><a href="classllvm_1_1CallInst.html#a39fed9e3fb9323a7eb73cb65409f5586">llvm::CallInst::getAttributes</a></div><div class="ttdeci">const AttributeSet &amp; getAttributes() const </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l01260">Instructions.h:1260</a></div></div>
<div class="ttc" id="StringExtras_8h_html"><div class="ttname"><a href="StringExtras_8h.html">StringExtras.h</a></div></div>
<div class="ttc" id="classllvm_1_1GCStrategy_html"><div class="ttname"><a href="classllvm_1_1GCStrategy.html">llvm::GCStrategy</a></div><div class="ttdef"><b>Definition:</b> <a href="GCStrategy_8h_source.html#l00055">GCStrategy.h:55</a></div></div>
<div class="ttc" id="classllvm_1_1Type_html_a30dd396c5b40cd86c1591872e574ccdf"><div class="ttname"><a href="classllvm_1_1Type.html#a30dd396c5b40cd86c1591872e574ccdf">llvm::Type::getInt32Ty</a></div><div class="ttdeci">static IntegerType * getInt32Ty(LLVMContext &amp;C)</div><div class="ttdef"><b>Definition:</b> <a href="Type_8cpp_source.html#l00241">Type.cpp:241</a></div></div>
<div class="ttc" id="MD5_8cpp_html_ac0eafdc9ee161b71e7af98af736952fd"><div class="ttname"><a href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a></div><div class="ttdeci">#define I(x, y, z)</div><div class="ttdef"><b>Definition:</b> <a href="MD5_8cpp_source.html#l00054">MD5.cpp:54</a></div></div>
<div class="ttc" id="regcomp_8c_html_a0240ac851181b84ac374872dc5434ee4"><div class="ttname"><a href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a></div><div class="ttdeci">#define N</div></div>
<div class="ttc" id="classllvm_1_1BasicBlock_html_a5cb76a65b6524dba1493dd2b9dc3abbe"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a5cb76a65b6524dba1493dd2b9dc3abbe">llvm::BasicBlock::getTerminator</a></div><div class="ttdeci">TerminatorInst * getTerminator()</div><div class="ttdoc">Returns the terminator instruction if the block is well formed or null if the block is not well forme...</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8cpp_source.html#l00120">BasicBlock.cpp:120</a></div></div>
<div class="ttc" id="classllvm_1_1SmallVectorImpl_html_a102d0ad36060677286c3aefb812e5512"><div class="ttname"><a href="classllvm_1_1SmallVectorImpl.html#a102d0ad36060677286c3aefb812e5512">llvm::SmallVectorImpl::resize</a></div><div class="ttdeci">void resize(unsigned N)</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00401">SmallVector.h:401</a></div></div>
<div class="ttc" id="classllvm_1_1BasicBlock_html_ae1d53a21892854816885c7288f8b46f1"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#ae1d53a21892854816885c7288f8b46f1">llvm::BasicBlock::Create</a></div><div class="ttdeci">static BasicBlock * Create(LLVMContext &amp;Context, const Twine &amp;Name=&quot;&quot;, Function *Parent=0, BasicBlock *InsertBefore=0)</div><div class="ttdoc">Creates a new BasicBlock. </div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00109">BasicBlock.h:109</a></div></div>
<div class="ttc" id="classllvm_1_1ArrayType_html_adf411edc4f135b570ab218079474ce77"><div class="ttname"><a href="classllvm_1_1ArrayType.html#adf411edc4f135b570ab218079474ce77">llvm::ArrayType::get</a></div><div class="ttdeci">static ArrayType * get(Type *ElementType, uint64_t NumElements)</div><div class="ttdef"><b>Definition:</b> <a href="Type_8cpp_source.html#l00679">Type.cpp:679</a></div></div>
<div class="ttc" id="classllvm_1_1GlobalValue_html_aedfa75f0c85c4aa85b257f066fbea57ca1511edd03e02d1f3dd277a3c6abf6ad5"><div class="ttname"><a href="classllvm_1_1GlobalValue.html#aedfa75f0c85c4aa85b257f066fbea57ca1511edd03e02d1f3dd277a3c6abf6ad5">llvm::GlobalValue::InternalLinkage</a></div><div class="ttdoc">Rename collisions when linking (static functions). </div><div class="ttdef"><b>Definition:</b> <a href="GlobalValue_8h_source.html#l00041">GlobalValue.h:41</a></div></div>
<div class="ttc" id="classllvm_1_1BasicBlock_html_a19445f836d9e1ecb32cba27ec4338fff"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a19445f836d9e1ecb32cba27ec4338fff">llvm::BasicBlock::splitBasicBlock</a></div><div class="ttdeci">BasicBlock * splitBasicBlock(iterator I, const Twine &amp;BBName=&quot;&quot;)</div><div class="ttdoc">Split the basic block into two basic blocks at the specified instruction. </div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8cpp_source.html#l00298">BasicBlock.cpp:298</a></div></div>
<div class="ttc" id="classllvm_1_1CallSiteBase_html_affa0f3ae92ab8696fccd107c0addf5a2"><div class="ttname"><a href="classllvm_1_1CallSiteBase.html#affa0f3ae92ab8696fccd107c0addf5a2">llvm::CallSiteBase::arg_begin</a></div><div class="ttdeci">IterTy arg_begin() const </div><div class="ttdef"><b>Definition:</b> <a href="CallSite_8h_source.html#l00137">CallSite.h:137</a></div></div>
<div class="ttc" id="IRBuilder_8h_html"><div class="ttname"><a href="IRBuilder_8h.html">IRBuilder.h</a></div></div>
<div class="ttc" id="classllvm_1_1GlobalValue_html_a9e1fc23a17e97d2d1732e753ae9251ac"><div class="ttname"><a href="classllvm_1_1GlobalValue.html#a9e1fc23a17e97d2d1732e753ae9251ac">llvm::GlobalValue::getParent</a></div><div class="ttdeci">Module * getParent()</div><div class="ttdef"><b>Definition:</b> <a href="GlobalValue_8h_source.html#l00286">GlobalValue.h:286</a></div></div>
<div class="ttc" id="classllvm_1_1Value_html"><div class="ttname"><a href="classllvm_1_1Value.html">llvm::Value</a></div><div class="ttdoc">LLVM Value Representation. </div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00066">Value.h:66</a></div></div>
<div class="ttc" id="Target_2X86_2README_8txt_html_ac88fe1d3a61b056a4f64fbbb156a62ff"><div class="ttname"><a href="Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a></div><div class="ttdeci">We currently emits eax Perhaps this is what we really should generate is Is imull three or four cycles eax eax The current instruction priority is based on pattern complexity The former is more complex because it folds a load so the latter will not be emitted Perhaps we should use AddedComplexity to give LEA32r a higher priority We should always try to match LEA first since the LEA matching code does some estimate to determine whether the match is profitable if we care more about code then imull is better It s two bytes shorter than movl leal On a Pentium M</div><div class="ttdef"><b>Definition:</b> <a href="Target_2X86_2README_8txt_source.html#l00297">Target/X86/README.txt:297</a></div></div>
<div class="ttc" id="classllvm_1_1StructType_html_a82648246c07eb8a33f628eea28cb988c"><div class="ttname"><a href="classllvm_1_1StructType.html#a82648246c07eb8a33f628eea28cb988c">llvm::StructType::create</a></div><div class="ttdeci">static StructType * create(LLVMContext &amp;Context, StringRef Name)</div><div class="ttdoc">StructType::create - This creates an identified struct. </div><div class="ttdef"><b>Definition:</b> <a href="Type_8cpp_source.html#l00494">Type.cpp:494</a></div></div>
<div class="ttc" id="classllvm_1_1InvokeInst_html_a8c80836c6d88742318f534c254abdee3"><div class="ttname"><a href="classllvm_1_1InvokeInst.html#a8c80836c6d88742318f534c254abdee3">llvm::InvokeInst::setCallingConv</a></div><div class="ttdeci">void setCallingConv(CallingConv::ID CC)</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02897">Instructions.h:2897</a></div></div>
<div class="ttc" id="classllvm_1_1InvokeInst_html"><div class="ttname"><a href="classllvm_1_1InvokeInst.html">llvm::InvokeInst</a></div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02841">Instructions.h:2841</a></div></div>
<div class="ttc" id="classllvm_1_1CallInst_html_a2a65eaf09953a013c2820f6857c647f0"><div class="ttname"><a href="classllvm_1_1CallInst.html#a2a65eaf09953a013c2820f6857c647f0">llvm::CallInst::getCallingConv</a></div><div class="ttdeci">CallingConv::ID getCallingConv() const </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l01250">Instructions.h:1250</a></div></div>
<div class="ttc" id="classllvm_1_1CallSite_html"><div class="ttname"><a href="classllvm_1_1CallSite.html">llvm::CallSite</a></div><div class="ttdef"><b>Definition:</b> <a href="CallSite_8h_source.html#l00295">CallSite.h:295</a></div></div>
<div class="ttc" id="Target_2ARM_2README_8txt_html_a90cca76dd78688687e0d697679dbc799"><div class="ttname"><a href="Target_2ARM_2README_8txt.html#a90cca76dd78688687e0d697679dbc799">B</a></div><div class="ttdeci">compiles ldr LCPI1_0 ldr ldr mov lsr tst moveq r1 ldr LCPI1_1 and r0 bx lr It would be better to do something like to fold the shift into the conditional ldr LCPI1_0 ldr ldr tst movne lsr ldr LCPI1_1 and r0 bx lr it saves an instruction and a register It might be profitable to cse MOVi16 if there are lots of bit immediates with the same bottom half Robert Muth started working on an alternate jump table implementation that does not put the tables in line in the text This is more like the llvm default jump table implementation This might be useful sometime Several revisions of patches are on the mailing beginning while CMP sets them like a subtract Therefore to be able to use CMN for comparisons other than the Z we ll need additional logic to reverse the conditionals associated with the comparison Perhaps a pseudo instruction for the with a post codegen pass to clean up and handle the condition codes See PR5694 for testcase Given the following on int B</div><div class="ttdef"><b>Definition:</b> <a href="Target_2ARM_2README_8txt_source.html#l00592">Target/ARM/README.txt:592</a></div></div>
<div class="ttc" id="classllvm_1_1iplist_html_ae22a2be6e82505d5de7d1ca296a10cce"><div class="ttname"><a href="classllvm_1_1iplist.html#ae22a2be6e82505d5de7d1ca296a10cce">llvm::iplist::remove</a></div><div class="ttdeci">NodeTy * remove(iterator &amp;IT)</div><div class="ttdef"><b>Definition:</b> <a href="ilist_8h_source.html#l00435">ilist.h:435</a></div></div>
<div class="ttc" id="classllvm_1_1ResumeInst_html_ae19fa1bc5cc4ee2e94277d9db6ed1768"><div class="ttname"><a href="classllvm_1_1ResumeInst.html#ae19fa1bc5cc4ee2e94277d9db6ed1768">llvm::ResumeInst::Create</a></div><div class="ttdeci">static ResumeInst * Create(Value *Exn, Instruction *InsertBefore=0)</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l03098">Instructions.h:3098</a></div></div>
<div class="ttc" id="namespacellvm_html_a6569d00d31a5d74e563e2f39f82271ab"><div class="ttname"><a href="namespacellvm.html#a6569d00d31a5d74e563e2f39f82271ab">llvm::X</a></div><div class="ttdeci">static RegisterPass&lt; NVPTXAllocaHoisting &gt; X(&quot;alloca-hoisting&quot;,&quot;Hoisting alloca instructions in non-entry &quot;&quot;blocks to the entry block&quot;)</div></div>
<div class="ttc" id="classllvm_1_1Instruction_html_a9cd49851904f15060edb782ef4dd1b2d"><div class="ttname"><a href="classllvm_1_1Instruction.html#a9cd49851904f15060edb782ef4dd1b2d">llvm::Instruction::getParent</a></div><div class="ttdeci">const BasicBlock * getParent() const </div><div class="ttdef"><b>Definition:</b> <a href="Instruction_8h_source.html#l00052">Instruction.h:52</a></div></div>
<div class="ttc" id="classllvm_1_1Registry_1_1Add_html"><div class="ttname"><a href="classllvm_1_1Registry_1_1Add.html">llvm::Registry::Add</a></div><div class="ttdef"><b>Definition:</b> <a href="Registry_8h_source.html#l00194">Registry.h:194</a></div></div>
<div class="ttc" id="classllvm_1_1IntrinsicInst_html"><div class="ttname"><a href="classllvm_1_1IntrinsicInst.html">llvm::IntrinsicInst</a></div><div class="ttdef"><b>Definition:</b> <a href="IntrinsicInst_8h_source.html#l00036">IntrinsicInst.h:36</a></div></div>
<div class="ttc" id="classllvm_1_1Module_html_a0e74af4b7c739f3a14e737c3042b6617"><div class="ttname"><a href="classllvm_1_1Module.html#a0e74af4b7c739f3a14e737c3042b6617">llvm::Module::getContext</a></div><div class="ttdeci">LLVMContext &amp; getContext() const </div><div class="ttdef"><b>Definition:</b> <a href="Module_8h_source.html#l00249">Module.h:249</a></div></div>
<div class="ttc" id="classllvm_1_1AllocaInst_html"><div class="ttname"><a href="classllvm_1_1AllocaInst.html">llvm::AllocaInst</a></div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00058">Instructions.h:58</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<hr>
<p class="footer">
Generated on Sat Nov 10 2018 23:02:02 for <a href="http://llvm.org/">LLVM</a> by
<a href="http://www.doxygen.org"><img src="doxygen.png" alt="Doxygen"
align="middle" border="0"/>1.8.11</a><br>
Copyright &copy; 2003-2013 University of Illinois at Urbana-Champaign.
All Rights Reserved.</p>
<hr>
<!--#include virtual="/attrib.incl" -->
</body>
</html>
