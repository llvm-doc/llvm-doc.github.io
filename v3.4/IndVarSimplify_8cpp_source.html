<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head>
<meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1"/>
<meta name="keywords" content="LLVM,Low Level Virtual Machine,C++,doxygen,API,documentation"/>
<meta name="description" content="C++ source code API documentation for LLVM."/>
<title>LLVM: IndVarSimplify.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head><body>
<p class="title">LLVM API Documentation</p>
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('IndVarSimplify_8cpp_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">IndVarSimplify.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="IndVarSimplify_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//===- IndVarSimplify.cpp - Induction Variable Elimination ----------------===//</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">//                     The LLVM Compiler Infrastructure</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// This file is distributed under the University of Illinois Open Source</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">// License. See LICENSE.TXT for details.</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">// This transformation analyzes and transforms the induction variables (and</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">// computations derived from them) into simpler forms suitable for subsequent</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">// analysis and transformation.</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">// If the trip count of a loop is computable, this pass also makes the following</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">// changes:</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">//   1. The exit condition for the loop is canonicalized to compare the</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">//      induction value against the exit value.  This turns loops like:</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">//        &#39;for (i = 7; i*i &lt; 1000; ++i)&#39; into &#39;for (i = 0; i != 25; ++i)&#39;</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">//   2. Any use outside of the loop of an expression derived from the indvar</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">//      is changed to compute the derived value outside of the loop, eliminating</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">//      the dependence on the exit value of the induction variable.  If the only</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">//      purpose of the loop is to compute the exit value of some derived</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">//      expression, this transformation will make the loop dead.</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;</div><div class="line"><a name="l00027"></a><span class="lineno"><a class="line" href="IndVarSimplify_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">   27</a></span>&#160;<span class="preprocessor">#define DEBUG_TYPE &quot;indvars&quot;</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Transforms_2Scalar_8h.html">llvm/Transforms/Scalar.h</a>&quot;</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="DenseMap_8h.html">llvm/ADT/DenseMap.h</a>&quot;</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="SmallVector_8h.html">llvm/ADT/SmallVector.h</a>&quot;</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Statistic_8h.html">llvm/ADT/Statistic.h</a>&quot;</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Dominators_8h.html">llvm/Analysis/Dominators.h</a>&quot;</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="LoopInfo_8h.html">llvm/Analysis/LoopInfo.h</a>&quot;</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="LoopPass_8h.html">llvm/Analysis/LoopPass.h</a>&quot;</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ScalarEvolutionExpander_8h.html">llvm/Analysis/ScalarEvolutionExpander.h</a>&quot;</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="BasicBlock_8h.html">llvm/IR/BasicBlock.h</a>&quot;</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Constants_8h.html">llvm/IR/Constants.h</a>&quot;</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="DataLayout_8h.html">llvm/IR/DataLayout.h</a>&quot;</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Instructions_8h.html">llvm/IR/Instructions.h</a>&quot;</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="IntrinsicInst_8h.html">llvm/IR/IntrinsicInst.h</a>&quot;</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="LLVMContext_8h.html">llvm/IR/LLVMContext.h</a>&quot;</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Type_8h.html">llvm/IR/Type.h</a>&quot;</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Support_2CFG_8h.html">llvm/Support/CFG.h</a>&quot;</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="CommandLine_8h.html">llvm/Support/CommandLine.h</a>&quot;</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Debug_8h.html">llvm/Support/Debug.h</a>&quot;</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="raw__ostream_8h.html">llvm/Support/raw_ostream.h</a>&quot;</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TargetLibraryInfo_8h.html">llvm/Target/TargetLibraryInfo.h</a>&quot;</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="BasicBlockUtils_8h.html">llvm/Transforms/Utils/BasicBlockUtils.h</a>&quot;</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Local_8h.html">llvm/Transforms/Utils/Local.h</a>&quot;</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="SimplifyIndVar_8h.html">llvm/Transforms/Utils/SimplifyIndVar.h</a>&quot;</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespacellvm.html">llvm</a>;</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<a class="code" href="IndVarSimplify_8cpp.html#aba556f596da7fa80d6e9bb43b7d2c1f5">STATISTIC</a>(NumWidened     , <span class="stringliteral">&quot;Number of indvars widened&quot;</span>);</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<a class="code" href="IndVarSimplify_8cpp.html#aba556f596da7fa80d6e9bb43b7d2c1f5">STATISTIC</a>(NumReplaced    , <span class="stringliteral">&quot;Number of exit values replaced&quot;</span>);</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<a class="code" href="IndVarSimplify_8cpp.html#aba556f596da7fa80d6e9bb43b7d2c1f5">STATISTIC</a>(NumLFTR        , <span class="stringliteral">&quot;Number of loop exit tests replaced&quot;</span>);</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<a class="code" href="IndVarSimplify_8cpp.html#aba556f596da7fa80d6e9bb43b7d2c1f5">STATISTIC</a>(NumElimExt     , <span class="stringliteral">&quot;Number of IV sign/zero extends eliminated&quot;</span>);</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<a class="code" href="IndVarSimplify_8cpp.html#aba556f596da7fa80d6e9bb43b7d2c1f5">STATISTIC</a>(NumElimIV      , <span class="stringliteral">&quot;Number of congruent IVs eliminated&quot;</span>);</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">// Trip count verification can be enabled by default under NDEBUG if we</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">// implement a strong expression equivalence checker in SCEV. Until then, we</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">// use the verify-indvars flag, which may assert in some cases.</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;bool&gt;</a> <a class="code" href="IndVarSimplify_8cpp.html#a7dd1919a4d3379a4810f52ee7bbcd3c8">VerifyIndvars</a>(</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  <span class="stringliteral">&quot;verify-indvars&quot;</span>, <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>,</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Verify the ScalarEvolution result after running indvars&quot;</span>));</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="keyword">namespace </span>{</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  <span class="keyword">class </span>IndVarSimplify : <span class="keyword">public</span> <a class="code" href="classllvm_1_1LoopPass.html">LoopPass</a> {</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <a class="code" href="classllvm_1_1LoopInfo.html">LoopInfo</a>        *LI;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <a class="code" href="classllvm_1_1ScalarEvolution.html">ScalarEvolution</a> *SE;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <a class="code" href="classllvm_1_1DominatorTree.html">DominatorTree</a>   *DT;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a>      *TD;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <a class="code" href="classllvm_1_1TargetLibraryInfo.html">TargetLibraryInfo</a> *TLI;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;WeakVH, 16&gt;</a> DeadInsts;</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="keywordtype">bool</span> Changed;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <span class="keyword">public</span>:</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="keyword">static</span> <span class="keywordtype">char</span> <a class="code" href="namespacellvm_1_1CallingConv.html#a4f861731fc6dbfdccc05af5968d98974">ID</a>; <span class="comment">// Pass identification, replacement for typeid</span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    IndVarSimplify() : <a class="code" href="classllvm_1_1LoopPass.html">LoopPass</a>(ID), LI(0), SE(0), DT(0), TD(0),</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;                       Changed(<a class="code" href="namespacefalse.html">false</a>) {</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;      <a class="code" href="namespacellvm.html#affe1d140e344b6ab0c607f6310ad8ac3">initializeIndVarSimplifyPass</a>(*<a class="code" href="classllvm_1_1PassRegistry.html#a05a729900b76c89e808c6c3094921b2f">PassRegistry::getPassRegistry</a>());</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    }</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">bool</span> runOnLoop(<a class="code" href="classllvm_1_1Loop.html">Loop</a> *L, <a class="code" href="classllvm_1_1LPPassManager.html">LPPassManager</a> &amp;LPM);</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">void</span> getAnalysisUsage(<a class="code" href="classllvm_1_1AnalysisUsage.html">AnalysisUsage</a> &amp;AU)<span class="keyword"> const </span>{</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;      AU.<a class="code" href="classllvm_1_1AnalysisUsage.html#ae5c60fd282ee894c87ea02c3f0fcb6d0">addRequired</a>&lt;<a class="code" href="classllvm_1_1DominatorTree.html">DominatorTree</a>&gt;();</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;      AU.<a class="code" href="classllvm_1_1AnalysisUsage.html#ae5c60fd282ee894c87ea02c3f0fcb6d0">addRequired</a>&lt;<a class="code" href="classllvm_1_1LoopInfo.html">LoopInfo</a>&gt;();</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;      AU.<a class="code" href="classllvm_1_1AnalysisUsage.html#ae5c60fd282ee894c87ea02c3f0fcb6d0">addRequired</a>&lt;<a class="code" href="classllvm_1_1ScalarEvolution.html">ScalarEvolution</a>&gt;();</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;      AU.<a class="code" href="classllvm_1_1AnalysisUsage.html#a053677ebc731b47a534f841b11b5cf0c">addRequiredID</a>(<a class="code" href="namespacellvm.html#a472515fc67a5fb572afeb00aa2609cca">LoopSimplifyID</a>);</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;      AU.<a class="code" href="classllvm_1_1AnalysisUsage.html#a053677ebc731b47a534f841b11b5cf0c">addRequiredID</a>(<a class="code" href="namespacellvm.html#a3e3d3c6d4e33a4f5ca579ee7939f0349">LCSSAID</a>);</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;      AU.<a class="code" href="classllvm_1_1AnalysisUsage.html#a884f90190bca4bd354f2d5c91c264028">addPreserved</a>&lt;<a class="code" href="classllvm_1_1ScalarEvolution.html">ScalarEvolution</a>&gt;();</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;      AU.<a class="code" href="classllvm_1_1AnalysisUsage.html#a40970e5d42646fb2d9aa5f7a2c879516">addPreservedID</a>(<a class="code" href="namespacellvm.html#a472515fc67a5fb572afeb00aa2609cca">LoopSimplifyID</a>);</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;      AU.<a class="code" href="classllvm_1_1AnalysisUsage.html#a40970e5d42646fb2d9aa5f7a2c879516">addPreservedID</a>(<a class="code" href="namespacellvm.html#a3e3d3c6d4e33a4f5ca579ee7939f0349">LCSSAID</a>);</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;      AU.<a class="code" href="classllvm_1_1AnalysisUsage.html#af11a6ebf7ab3c388234cb6d5378439a3">setPreservesCFG</a>();</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    }</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  <span class="keyword">private</span>:</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">void</span> releaseMemory() {</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;      DeadInsts.<a class="code" href="classllvm_1_1SmallVectorImpl.html#aac0ea55010b7b1a301e65a0baea057aa">clear</a>();</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    }</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="keywordtype">bool</span> isValidRewrite(<a class="code" href="classllvm_1_1Value.html">Value</a> *FromVal, <a class="code" href="classllvm_1_1Value.html">Value</a> *ToVal);</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="keywordtype">void</span> HandleFloatingPointIV(<a class="code" href="classllvm_1_1Loop.html">Loop</a> *L, <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *PH);</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="keywordtype">void</span> RewriteNonIntegerIVs(<a class="code" href="classllvm_1_1Loop.html">Loop</a> *L);</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="keywordtype">void</span> SimplifyAndExtend(<a class="code" href="classllvm_1_1Loop.html">Loop</a> *L, <a class="code" href="classllvm_1_1SCEVExpander.html">SCEVExpander</a> &amp;<a class="code" href="VirtRegMap_8cpp.html#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a>, <a class="code" href="classllvm_1_1LPPassManager.html">LPPassManager</a> &amp;LPM);</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="keywordtype">void</span> RewriteLoopExitValues(<a class="code" href="classllvm_1_1Loop.html">Loop</a> *L, <a class="code" href="classllvm_1_1SCEVExpander.html">SCEVExpander</a> &amp;<a class="code" href="VirtRegMap_8cpp.html#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a>);</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *LinearFunctionTestReplace(<a class="code" href="classllvm_1_1Loop.html">Loop</a> *L, <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *BackedgeTakenCount,</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;                                     <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *IndVar, <a class="code" href="classllvm_1_1SCEVExpander.html">SCEVExpander</a> &amp;<a class="code" href="VirtRegMap_8cpp.html#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a>);</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="keywordtype">void</span> SinkUnusedInvariants(<a class="code" href="classllvm_1_1Loop.html">Loop</a> *L);</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  };</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;}</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="keywordtype">char</span> <a class="code" href="namespacellvm_1_1CallingConv.html#a4f861731fc6dbfdccc05af5968d98974">IndVarSimplify::ID</a> = 0;</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<a class="code" href="IndVarSimplify_8cpp.html#ace9625ac60c2f0bcc7b6aadbb73f57b6">INITIALIZE_PASS_BEGIN</a>(IndVarSimplify, <span class="stringliteral">&quot;indvars&quot;</span>,</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;                <span class="stringliteral">&quot;Induction Variable Simplification&quot;</span>, <span class="keyword">false</span>, <span class="keyword">false</span>)</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<a class="code" href="PassSupport_8h.html#a14724f1ccf528e73bb29bc9230737967">INITIALIZE_PASS_DEPENDENCY</a>(<a class="code" href="classllvm_1_1DominatorTree.html">DominatorTree</a>)</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<a class="code" href="PassSupport_8h.html#a14724f1ccf528e73bb29bc9230737967">INITIALIZE_PASS_DEPENDENCY</a>(<a class="code" href="classllvm_1_1LoopInfo.html">LoopInfo</a>)</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<a class="code" href="PassSupport_8h.html#a14724f1ccf528e73bb29bc9230737967">INITIALIZE_PASS_DEPENDENCY</a>(<a class="code" href="classllvm_1_1ScalarEvolution.html">ScalarEvolution</a>)</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<a class="code" href="PassSupport_8h.html#a14724f1ccf528e73bb29bc9230737967">INITIALIZE_PASS_DEPENDENCY</a>(LoopSimplify)</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<a class="code" href="PassSupport_8h.html#a14724f1ccf528e73bb29bc9230737967">INITIALIZE_PASS_DEPENDENCY</a>(LCSSA)</div><div class="line"><a name="l00127"></a><span class="lineno"><a class="line" href="IndVarSimplify_8cpp.html#ab5371a4f4e29460339200c446c423284">  127</a></span>&#160;<a class="code" href="PassSupport_8h.html#a74ce8276b89067e806f67c45a6d92575">INITIALIZE_PASS_END</a>(IndVarSimplify, &quot;<a class="code" href="IndVarSimplify_8cpp.html#a566d8ea0c046e39ce95437e5c8390b8f">indvars</a>&quot;,</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;                &quot;Induction Variable <a class="code" href="IndVarSimplify_8cpp.html#ab5371a4f4e29460339200c446c423284">Simplification</a>&quot;, <a class="code" href="namespacefalse.html">false</a>, false)</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;</div><div class="line"><a name="l00130"></a><span class="lineno"><a class="line" href="namespacellvm.html#adcea5fcebbb3724d8b561ce175e8e65c">  130</a></span>&#160;<a class="code" href="classllvm_1_1Pass.html">Pass</a> *<a class="code" href="namespacellvm.html">llvm</a>::<a class="code" href="namespacellvm.html#adcea5fcebbb3724d8b561ce175e8e65c">createIndVarSimplifyPass</a>() {</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">new</span> IndVarSimplify();</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;}</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment">/// isValidRewrite - Return true if the SCEV expansion generated by the</span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment">/// rewriter can replace the original value. SCEV guarantees that it</span></div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment">/// produces the same value, but the way it is produced may be illegal IR.</span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="comment">/// Ideally, this function will only be called for verification.</span></div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment"></span><span class="keywordtype">bool</span> IndVarSimplify::isValidRewrite(<a class="code" href="classllvm_1_1Value.html">Value</a> *FromVal, <a class="code" href="classllvm_1_1Value.html">Value</a> *ToVal) {</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  <span class="comment">// If an SCEV expression subsumed multiple pointers, its expansion could</span></div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  <span class="comment">// reassociate the GEP changing the base pointer. This is illegal because the</span></div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  <span class="comment">// final address produced by a GEP chain must be inbounds relative to its</span></div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  <span class="comment">// underlying object. Otherwise basic alias analysis, among other things,</span></div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  <span class="comment">// could fail in a dangerous way. Ultimately, SCEV will be improved to avoid</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  <span class="comment">// producing an expression involving multiple pointers. Until then, we must</span></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  <span class="comment">// bail out here.</span></div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  <span class="comment">//</span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  <span class="comment">// Retrieve the pointer operand of the GEP. Don&#39;t use GetUnderlyingObject</span></div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  <span class="comment">// because it understands lcssa phis while SCEV does not.</span></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *FromPtr = FromVal;</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *ToPtr = ToVal;</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1GEPOperator.html">GEPOperator</a> *GEP = dyn_cast&lt;GEPOperator&gt;(FromVal)) {</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    FromPtr = GEP-&gt;getPointerOperand();</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  }</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1GEPOperator.html">GEPOperator</a> *GEP = dyn_cast&lt;GEPOperator&gt;(ToVal)) {</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    ToPtr = GEP-&gt;getPointerOperand();</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  }</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  <span class="keywordflow">if</span> (FromPtr != FromVal || ToPtr != ToVal) {</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="comment">// Quickly check the common case</span></div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <span class="keywordflow">if</span> (FromPtr == ToPtr)</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="comment">// SCEV may have rewritten an expression that produces the GEP&#39;s pointer</span></div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <span class="comment">// operand. That&#39;s ok as long as the pointer operand has the same base</span></div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <span class="comment">// pointer. Unlike GetUnderlyingObject(), getPointerBase() will find the</span></div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="comment">// base of a recurrence. This handles the case in which SCEV expansion</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <span class="comment">// converts a pointer type recurrence into a nonrecurrent pointer base</span></div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="comment">// indexed by an integer recurrence.</span></div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <span class="comment">// If the GEP base pointer is a vector of pointers, abort.</span></div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="keywordflow">if</span> (!FromPtr-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a2eba483f5cc876e824aa6c085736086b">isPointerTy</a>() || !ToPtr-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a2eba483f5cc876e824aa6c085736086b">isPointerTy</a>())</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *FromBase = SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#ac276ea1907c780c43d3637ae9bd1989e">getPointerBase</a>(SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a30bd18ac905eacf3601bc6a553a9ff49">getSCEV</a>(FromPtr));</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *ToBase = SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#ac276ea1907c780c43d3637ae9bd1989e">getPointerBase</a>(SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a30bd18ac905eacf3601bc6a553a9ff49">getSCEV</a>(ToPtr));</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="keywordflow">if</span> (FromBase == ToBase)</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;INDVARS: GEP rewrite bail out &quot;</span></div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;          &lt;&lt; *FromBase &lt;&lt; <span class="stringliteral">&quot; != &quot;</span> &lt;&lt; *ToBase &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  }</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;}</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment">/// Determine the insertion point for this user. By default, insert immediately</span></div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="comment">/// before the user. SCEVExpander or LICM will hoist loop invariants out of the</span></div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="comment">/// loop. For PHI nodes, there may be multiple uses, so compute the nearest</span></div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="comment">/// common dominator for the incoming blocks.</span></div><div class="line"><a name="l00190"></a><span class="lineno"><a class="line" href="IndVarSimplify_8cpp.html#a2831ebb1b1d686d2841c7bb2aeed5ade">  190</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="IndVarSimplify_8cpp.html#a2831ebb1b1d686d2841c7bb2aeed5ade">getInsertPointForUses</a>(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="classllvm_1_1User.html">User</a>, <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5aceb138f68fe183995736614928e3394a">Def</a>,</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;                                          <a class="code" href="classllvm_1_1DominatorTree.html">DominatorTree</a> *DT) {</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;  <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *<a class="code" href="namespacellvm_1_1TargetOpcode.html#a348d4259b5fa6a8ecfe94e7ae512e1a8ae41f9ca68ba5e8b9613cea03652ebd72">PHI</a> = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1PHINode.html">PHINode</a>&gt;(User);</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  <span class="keywordflow">if</span> (!PHI)</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="keywordflow">return</span> User;</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *InsertPt = 0;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0, e = PHI-&gt;<a class="code" href="classllvm_1_1PHINode.html#aa45f6c0433576e3858a6209a43750ad4">getNumIncomingValues</a>(); <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != e; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="keywordflow">if</span> (PHI-&gt;<a class="code" href="classllvm_1_1PHINode.html#aba6a4cc4ed6d6fef3664b8d65ef04820">getIncomingValue</a>(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) != <a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5aceb138f68fe183995736614928e3394a">Def</a>)</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *InsertBB = PHI-&gt;<a class="code" href="classllvm_1_1PHINode.html#a4c25b6c00c4867281779c81ab64d2081">getIncomingBlock</a>(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="keywordflow">if</span> (!InsertPt) {</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;      InsertPt = InsertBB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a5cb76a65b6524dba1493dd2b9dc3abbe">getTerminator</a>();</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    }</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    InsertBB = DT-&gt;<a class="code" href="classllvm_1_1DominatorTree.html#a7b8f5876ec15b49abf76ae81cefac1f6">findNearestCommonDominator</a>(InsertPt-&gt;<a class="code" href="classllvm_1_1Instruction.html#a9cd49851904f15060edb782ef4dd1b2d">getParent</a>(), InsertBB);</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    InsertPt = InsertBB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a5cb76a65b6524dba1493dd2b9dc3abbe">getTerminator</a>();</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;  }</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  assert(InsertPt &amp;&amp; <span class="stringliteral">&quot;Missing phi operand&quot;</span>);</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  assert((!isa&lt;Instruction&gt;(Def) ||</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;          DT-&gt;<a class="code" href="classllvm_1_1DominatorTree.html#a6fe9272dc67fe2ff4cafc33b895c4a6c">dominates</a>(cast&lt;Instruction&gt;(Def), InsertPt)) &amp;&amp;</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;         <span class="stringliteral">&quot;def does not dominate all uses&quot;</span>);</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  <span class="keywordflow">return</span> InsertPt;</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;}</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="comment">// RewriteNonIntegerIVs and helpers. Prefer integer IVs.</span></div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="comment">/// ConvertToSInt - Convert APF to an integer, if possible.</span></div><div class="line"><a name="l00221"></a><span class="lineno"><a class="line" href="IndVarSimplify_8cpp.html#af945460922a5750a0d075b6344608e27">  221</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="IndVarSimplify_8cpp.html#af945460922a5750a0d075b6344608e27">ConvertToSInt</a>(<span class="keyword">const</span> <a class="code" href="classllvm_1_1APFloat.html">APFloat</a> &amp;APF, int64_t &amp;<a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5a3a7597ca475c0fcf10856ef36351d1ac">IntVal</a>) {</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  <span class="keywordtype">bool</span> isExact = <span class="keyword">false</span>;</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;  <span class="comment">// See if we can convert this to an int64_t</span></div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  uint64_t UIntVal;</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;  <span class="keywordflow">if</span> (APF.<a class="code" href="classllvm_1_1APFloat.html#a796301cd33da892bb1971f3d03e36cb6">convertToInteger</a>(&amp;UIntVal, 64, <span class="keyword">true</span>, <a class="code" href="classllvm_1_1APFloat.html#a26f3c979ec46a5d2d9bccd300eb606fea4cc5d58ded2d49317f9cc2315a3a09ec">APFloat::rmTowardZero</a>,</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                           &amp;isExact) != <a class="code" href="classllvm_1_1APFloat.html#a42fe920c8131569bb30114d7f294c8f8a527f71be1f3fdab1f3354020d5bec081">APFloat::opOK</a> || !isExact)</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;  IntVal = UIntVal;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;}</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="comment">/// HandleFloatingPointIV - If the loop has floating induction variable</span></div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="comment">/// then insert corresponding integer induction variable if possible.</span></div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment">/// For example,</span></div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="comment">/// for(double i = 0; i &lt; 10000; ++i)</span></div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="comment">///   bar(i)</span></div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="comment">/// is converted into</span></div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="comment">/// for(int i = 0; i &lt; 10000; ++i)</span></div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="comment">///   bar((double)i);</span></div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="comment"></span><span class="keywordtype">void</span> IndVarSimplify::HandleFloatingPointIV(<a class="code" href="classllvm_1_1Loop.html">Loop</a> *L, <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *PN) {</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  <span class="keywordtype">unsigned</span> IncomingEdge = L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a92a38e2e3412bde7fd2b71db212b61aa">contains</a>(PN-&gt;<a class="code" href="classllvm_1_1PHINode.html#a4c25b6c00c4867281779c81ab64d2081">getIncomingBlock</a>(0));</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;  <span class="keywordtype">unsigned</span> BackEdge     = IncomingEdge^1;</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;  <span class="comment">// Check incoming value.</span></div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  <a class="code" href="classllvm_1_1ConstantFP.html">ConstantFP</a> *InitValueVal =</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantFP.html">ConstantFP</a>&gt;(PN-&gt;<a class="code" href="classllvm_1_1PHINode.html#aba6a4cc4ed6d6fef3664b8d65ef04820">getIncomingValue</a>(IncomingEdge));</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  int64_t InitValue;</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;  <span class="keywordflow">if</span> (!InitValueVal || !<a class="code" href="IndVarSimplify_8cpp.html#af945460922a5750a0d075b6344608e27">ConvertToSInt</a>(InitValueVal-&gt;<a class="code" href="classllvm_1_1ConstantFP.html#a0f839f7633a4709c1d89e128f49b3d43">getValueAPF</a>(), InitValue))</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;  <span class="comment">// Check IV increment. Reject this PN if increment operation is not</span></div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  <span class="comment">// an add or increment value can not be represented by an integer.</span></div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;  <a class="code" href="classllvm_1_1BinaryOperator.html">BinaryOperator</a> *Incr =</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1BinaryOperator.html">BinaryOperator</a>&gt;(PN-&gt;<a class="code" href="classllvm_1_1PHINode.html#aba6a4cc4ed6d6fef3664b8d65ef04820">getIncomingValue</a>(BackEdge));</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;  <span class="keywordflow">if</span> (Incr == 0 || Incr-&gt;<a class="code" href="classllvm_1_1BinaryOperator.html#a88505baf41407782678a5df1702d2d31">getOpcode</a>() != Instruction::FAdd) <span class="keywordflow">return</span>;</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;  <span class="comment">// If this is not an add of the PHI with a constantfp, or if the constant fp</span></div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;  <span class="comment">// is not an integer, bail out.</span></div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;  <a class="code" href="classllvm_1_1ConstantFP.html">ConstantFP</a> *IncValueVal = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantFP.html">ConstantFP</a>&gt;(Incr-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(1));</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;  int64_t IncValue;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;  <span class="keywordflow">if</span> (IncValueVal == 0 || Incr-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0) != PN ||</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;      !<a class="code" href="IndVarSimplify_8cpp.html#af945460922a5750a0d075b6344608e27">ConvertToSInt</a>(IncValueVal-&gt;<a class="code" href="classllvm_1_1ConstantFP.html#a0f839f7633a4709c1d89e128f49b3d43">getValueAPF</a>(), IncValue))</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;  <span class="comment">// Check Incr uses. One user is PN and the other user is an exit condition</span></div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;  <span class="comment">// used by the conditional terminator.</span></div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;  <a class="code" href="classllvm_1_1value__use__iterator.html">Value::use_iterator</a> IncrUse = Incr-&gt;<a class="code" href="classllvm_1_1Value.html#a413abcab8dbc3900fc2fde96a5d8fca6">use_begin</a>();</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *U1 = cast&lt;Instruction&gt;(*IncrUse++);</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  <span class="keywordflow">if</span> (IncrUse == Incr-&gt;<a class="code" href="classllvm_1_1Value.html#ad86469939d2a8bdd4169be9403b89f5a">use_end</a>()) <span class="keywordflow">return</span>;</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *U2 = cast&lt;Instruction&gt;(*IncrUse++);</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  <span class="keywordflow">if</span> (IncrUse != Incr-&gt;<a class="code" href="classllvm_1_1Value.html#ad86469939d2a8bdd4169be9403b89f5a">use_end</a>()) <span class="keywordflow">return</span>;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  <span class="comment">// Find exit condition, which is an fcmp.  If it doesn&#39;t exist, or if it isn&#39;t</span></div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  <span class="comment">// only used by a branch, we can&#39;t transform it.</span></div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;  <a class="code" href="classllvm_1_1FCmpInst.html">FCmpInst</a> *<a class="code" href="namespacellvm_1_1MCID.html#a8035044d40d3758eb45b65dce69dc90ba1328ed43be8173506f59f88c9bfd8b8c">Compare</a> = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1FCmpInst.html">FCmpInst</a>&gt;(U1);</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;  <span class="keywordflow">if</span> (!Compare)</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    Compare = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1FCmpInst.html">FCmpInst</a>&gt;(U2);</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  <span class="keywordflow">if</span> (Compare == 0 || !Compare-&gt;<a class="code" href="classllvm_1_1Value.html#a085b82f074c28030fb8e194377ed2d0c">hasOneUse</a>() ||</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;      !isa&lt;BranchInst&gt;(Compare-&gt;<a class="code" href="classllvm_1_1Instruction.html#a5ac211f24970dea81fa9a7118a8ce36b">use_back</a>()))</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;  <a class="code" href="classllvm_1_1BranchInst.html">BranchInst</a> *TheBr = cast&lt;BranchInst&gt;(Compare-&gt;<a class="code" href="classllvm_1_1Instruction.html#a5ac211f24970dea81fa9a7118a8ce36b">use_back</a>());</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  <span class="comment">// We need to verify that the branch actually controls the iteration count</span></div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;  <span class="comment">// of the loop.  If not, the new IV can overflow and no one will notice.</span></div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;  <span class="comment">// The branch block must be in the loop and one of the successors must be out</span></div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;  <span class="comment">// of the loop.</span></div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  assert(TheBr-&gt;<a class="code" href="classllvm_1_1BranchInst.html#a03cc0dff22b31447f43af97acb76b1a2">isConditional</a>() &amp;&amp; <span class="stringliteral">&quot;Can&#39;t use fcmp if not conditional&quot;</span>);</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  <span class="keywordflow">if</span> (!L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a92a38e2e3412bde7fd2b71db212b61aa">contains</a>(TheBr-&gt;<a class="code" href="classllvm_1_1Instruction.html#a9cd49851904f15060edb782ef4dd1b2d">getParent</a>()) ||</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;      (L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a92a38e2e3412bde7fd2b71db212b61aa">contains</a>(TheBr-&gt;<a class="code" href="classllvm_1_1BranchInst.html#a74e70ecbb79defbbfa6f6c87f76155bf">getSuccessor</a>(0)) &amp;&amp;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;       L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a92a38e2e3412bde7fd2b71db212b61aa">contains</a>(TheBr-&gt;<a class="code" href="classllvm_1_1BranchInst.html#a74e70ecbb79defbbfa6f6c87f76155bf">getSuccessor</a>(1))))</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  <span class="comment">// If it isn&#39;t a comparison with an integer-as-fp (the exit value), we can&#39;t</span></div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;  <span class="comment">// transform it.</span></div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  <a class="code" href="classllvm_1_1ConstantFP.html">ConstantFP</a> *ExitValueVal = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantFP.html">ConstantFP</a>&gt;(Compare-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(1));</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;  int64_t ExitValue;</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;  <span class="keywordflow">if</span> (ExitValueVal == 0 ||</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;      !<a class="code" href="IndVarSimplify_8cpp.html#af945460922a5750a0d075b6344608e27">ConvertToSInt</a>(ExitValueVal-&gt;<a class="code" href="classllvm_1_1ConstantFP.html#a0f839f7633a4709c1d89e128f49b3d43">getValueAPF</a>(), ExitValue))</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;  <span class="comment">// Find new predicate for integer comparison.</span></div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  <a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05">CmpInst::Predicate</a> NewPred = <a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05a07aee43ffb66908a25c55c77ce4c0d05">CmpInst::BAD_ICMP_PREDICATE</a>;</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;  <span class="keywordflow">switch</span> (Compare-&gt;<a class="code" href="classllvm_1_1CmpInst.html#a8afd4995fae596b2c86eeed85b3d388b">getPredicate</a>()) {</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;  <span class="keywordflow">default</span>: <span class="keywordflow">return</span>;  <span class="comment">// Unknown comparison.</span></div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05a024db78a5ed74f64666f3ca4955e6eca">CmpInst::FCMP_OEQ</a>:</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05a919643b83ce3c9af2e4296ed5e413a1f">CmpInst::FCMP_UEQ</a>: NewPred = <a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05aa719225e2de4059f93fd3209e1f48218">CmpInst::ICMP_EQ</a>; <span class="keywordflow">break</span>;</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05a8a80b27ca29fe2076b9bbdee02c65464">CmpInst::FCMP_ONE</a>:</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05ad601460c9371d0f0ada5ae006bdba2bd">CmpInst::FCMP_UNE</a>: NewPred = <a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05ac17897ebf2f6a6986280fc3bdf28a30a">CmpInst::ICMP_NE</a>; <span class="keywordflow">break</span>;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05a4c399f525bbcf03d72af4b303e6eeca8">CmpInst::FCMP_OGT</a>:</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05a959268ceeae23abe5c9ad9e895669d0c">CmpInst::FCMP_UGT</a>: NewPred = <a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05a720a42e85f7e981afd61e28473b0000a">CmpInst::ICMP_SGT</a>; <span class="keywordflow">break</span>;</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05a541533f34077bbbcfb703a90f6d2da9b">CmpInst::FCMP_OGE</a>:</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05ae51609fc6a425f849d37c28cb9bc0344">CmpInst::FCMP_UGE</a>: NewPred = <a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05ac1aa7b798ba11d2e497d5cce6ce6d3dc">CmpInst::ICMP_SGE</a>; <span class="keywordflow">break</span>;</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05a326bee0a4a424cef21c1cf8adb8b8dd8">CmpInst::FCMP_OLT</a>:</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05a75016d5872d90adf89cc1cbf5763f474">CmpInst::FCMP_ULT</a>: NewPred = <a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05a15ae464950ac676919c2f0c7aafc706c">CmpInst::ICMP_SLT</a>; <span class="keywordflow">break</span>;</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05a9835cfe02fb5027680bd7203b024f77a">CmpInst::FCMP_OLE</a>:</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05a396dda2571cd3c575f1d9cb44dc2cc09">CmpInst::FCMP_ULE</a>: NewPred = <a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05a2751d6136a2819749dcef65dc19a4246">CmpInst::ICMP_SLE</a>; <span class="keywordflow">break</span>;</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;  }</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  <span class="comment">// We convert the floating point induction variable to a signed i32 value if</span></div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;  <span class="comment">// we can.  This is only safe if the comparison will not overflow in a way</span></div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;  <span class="comment">// that won&#39;t be trapped by the integer equivalent operations.  Check for this</span></div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;  <span class="comment">// now.</span></div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;  <span class="comment">// TODO: We could use i64 if it is native and the range requires it.</span></div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  <span class="comment">// The start/stride/exit values must all fit in signed i32.</span></div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm.html#a9bf6430c1a0cf078ee3f9f520fa407f0">isInt&lt;32&gt;</a>(InitValue) || !<a class="code" href="namespacellvm.html#a9bf6430c1a0cf078ee3f9f520fa407f0">isInt&lt;32&gt;</a>(IncValue) || !<a class="code" href="namespacellvm.html#a9bf6430c1a0cf078ee3f9f520fa407f0">isInt&lt;32&gt;</a>(ExitValue))</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;  <span class="comment">// If not actually striding (add x, 0.0), avoid touching the code.</span></div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;  <span class="keywordflow">if</span> (IncValue == 0)</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;  <span class="comment">// Positive and negative strides have different safety conditions.</span></div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;  <span class="keywordflow">if</span> (IncValue &gt; 0) {</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <span class="comment">// If we have a positive stride, we require the init to be less than the</span></div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <span class="comment">// exit value.</span></div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <span class="keywordflow">if</span> (InitValue &gt;= ExitValue)</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    uint32_t Range = uint32_t(ExitValue-InitValue);</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    <span class="comment">// Check for infinite loop, either:</span></div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    <span class="comment">// while (i &lt;= Exit) or until (i &gt; Exit)</span></div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    <span class="keywordflow">if</span> (NewPred == <a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05a2751d6136a2819749dcef65dc19a4246">CmpInst::ICMP_SLE</a> || NewPred == <a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05a720a42e85f7e981afd61e28473b0000a">CmpInst::ICMP_SGT</a>) {</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;      <span class="keywordflow">if</span> (++Range == 0) <span class="keywordflow">return</span>;  <span class="comment">// Range overflows.</span></div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    }</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <span class="keywordtype">unsigned</span> Leftover = Range % uint32_t(IncValue);</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    <span class="comment">// If this is an equality comparison, we require that the strided value</span></div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    <span class="comment">// exactly land on the exit value, otherwise the IV condition will wrap</span></div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <span class="comment">// around and do things the fp IV wouldn&#39;t.</span></div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <span class="keywordflow">if</span> ((NewPred == <a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05aa719225e2de4059f93fd3209e1f48218">CmpInst::ICMP_EQ</a> || NewPred == <a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05ac17897ebf2f6a6986280fc3bdf28a30a">CmpInst::ICMP_NE</a>) &amp;&amp;</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;        Leftover != 0)</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    <span class="comment">// If the stride would wrap around the i32 before exiting, we can&#39;t</span></div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    <span class="comment">// transform the IV.</span></div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    <span class="keywordflow">if</span> (Leftover != 0 &amp;&amp; int32_t(ExitValue+IncValue) &lt; ExitValue)</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    <span class="comment">// If we have a negative stride, we require the init to be greater than the</span></div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <span class="comment">// exit value.</span></div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <span class="keywordflow">if</span> (InitValue &lt;= ExitValue)</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    uint32_t Range = uint32_t(InitValue-ExitValue);</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    <span class="comment">// Check for infinite loop, either:</span></div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    <span class="comment">// while (i &gt;= Exit) or until (i &lt; Exit)</span></div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    <span class="keywordflow">if</span> (NewPred == <a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05ac1aa7b798ba11d2e497d5cce6ce6d3dc">CmpInst::ICMP_SGE</a> || NewPred == <a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05a15ae464950ac676919c2f0c7aafc706c">CmpInst::ICMP_SLT</a>) {</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;      <span class="keywordflow">if</span> (++Range == 0) <span class="keywordflow">return</span>;  <span class="comment">// Range overflows.</span></div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    }</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    <span class="keywordtype">unsigned</span> Leftover = Range % uint32_t(-IncValue);</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    <span class="comment">// If this is an equality comparison, we require that the strided value</span></div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    <span class="comment">// exactly land on the exit value, otherwise the IV condition will wrap</span></div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <span class="comment">// around and do things the fp IV wouldn&#39;t.</span></div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    <span class="keywordflow">if</span> ((NewPred == <a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05aa719225e2de4059f93fd3209e1f48218">CmpInst::ICMP_EQ</a> || NewPred == <a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05ac17897ebf2f6a6986280fc3bdf28a30a">CmpInst::ICMP_NE</a>) &amp;&amp;</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;        Leftover != 0)</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <span class="comment">// If the stride would wrap around the i32 before exiting, we can&#39;t</span></div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <span class="comment">// transform the IV.</span></div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    <span class="keywordflow">if</span> (Leftover != 0 &amp;&amp; int32_t(ExitValue+IncValue) &gt; ExitValue)</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;  }</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  <a class="code" href="classllvm_1_1IntegerType.html">IntegerType</a> *Int32Ty = <a class="code" href="classllvm_1_1Type.html#a30dd396c5b40cd86c1591872e574ccdf">Type::getInt32Ty</a>(PN-&gt;<a class="code" href="classllvm_1_1Value.html#af85a4828b6b5a8de7fc0a55cc0e5b52f">getContext</a>());</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;  <span class="comment">// Insert new integer induction variable.</span></div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *NewPHI = <a class="code" href="classllvm_1_1PHINode.html#afb5e83bf5123ff7c51058eb0ebebcdc6">PHINode::Create</a>(Int32Ty, 2, PN-&gt;<a class="code" href="classllvm_1_1Value.html#ad452febc1ac0b394876e640ec03ffa38">getName</a>()+<span class="stringliteral">&quot;.int&quot;</span>, PN);</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;  NewPHI-&gt;<a class="code" href="classllvm_1_1PHINode.html#a089cccb6f231efee72abc76d0f9c695f">addIncoming</a>(<a class="code" href="classllvm_1_1ConstantInt.html#a9105541412dab869e18b3cceebfff07d">ConstantInt::get</a>(Int32Ty, InitValue),</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;                      PN-&gt;<a class="code" href="classllvm_1_1PHINode.html#a4c25b6c00c4867281779c81ab64d2081">getIncomingBlock</a>(IncomingEdge));</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *NewAdd =</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    BinaryOperator::CreateAdd(NewPHI, <a class="code" href="classllvm_1_1ConstantInt.html#a9105541412dab869e18b3cceebfff07d">ConstantInt::get</a>(Int32Ty, IncValue),</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;                              Incr-&gt;<a class="code" href="classllvm_1_1Value.html#ad452febc1ac0b394876e640ec03ffa38">getName</a>()+<span class="stringliteral">&quot;.int&quot;</span>, Incr);</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;  NewPHI-&gt;addIncoming(NewAdd, PN-&gt;<a class="code" href="classllvm_1_1PHINode.html#a4c25b6c00c4867281779c81ab64d2081">getIncomingBlock</a>(BackEdge));</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;  <a class="code" href="classllvm_1_1ICmpInst.html">ICmpInst</a> *NewCompare = <span class="keyword">new</span> <a class="code" href="classllvm_1_1ICmpInst.html">ICmpInst</a>(TheBr, NewPred, NewAdd,</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;                                      <a class="code" href="classllvm_1_1ConstantInt.html#a9105541412dab869e18b3cceebfff07d">ConstantInt::get</a>(Int32Ty, ExitValue),</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;                                      Compare-&gt;<a class="code" href="classllvm_1_1Value.html#ad452febc1ac0b394876e640ec03ffa38">getName</a>());</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;  <span class="comment">// In the following deletions, PN may become dead and may be deleted.</span></div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;  <span class="comment">// Use a WeakVH to observe whether this happens.</span></div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;  <a class="code" href="classllvm_1_1WeakVH.html">WeakVH</a> WeakPH = PN;</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;  <span class="comment">// Delete the old floating point exit comparison.  The branch starts using the</span></div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;  <span class="comment">// new comparison.</span></div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;  NewCompare-&gt;<a class="code" href="classllvm_1_1Value.html#ae855357b6c5e6e7ed1869272708a3a84">takeName</a>(Compare);</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;  Compare-&gt;<a class="code" href="classllvm_1_1Value.html#a3ab5fc45117b450e8bb04e564cb6e5f2">replaceAllUsesWith</a>(NewCompare);</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;  <a class="code" href="namespacellvm.html#a23b3753cc662a87b599913814ccf2444">RecursivelyDeleteTriviallyDeadInstructions</a>(Compare, TLI);</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;  <span class="comment">// Delete the old floating point increment.</span></div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;  Incr-&gt;<a class="code" href="classllvm_1_1Value.html#a3ab5fc45117b450e8bb04e564cb6e5f2">replaceAllUsesWith</a>(<a class="code" href="classllvm_1_1UndefValue.html#a4ae5ff22b700a42bcc5d889233721335">UndefValue::get</a>(Incr-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>()));</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;  <a class="code" href="namespacellvm.html#a23b3753cc662a87b599913814ccf2444">RecursivelyDeleteTriviallyDeadInstructions</a>(Incr, TLI);</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;  <span class="comment">// If the FP induction variable still has uses, this is because something else</span></div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;  <span class="comment">// in the loop uses its value.  In order to canonicalize the induction</span></div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;  <span class="comment">// variable, we chose to eliminate the IV and rewrite it in terms of an</span></div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;  <span class="comment">// int-&gt;fp cast.</span></div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;  <span class="comment">//</span></div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;  <span class="comment">// We give preference to sitofp over uitofp because it is faster on most</span></div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;  <span class="comment">// platforms.</span></div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;  <span class="keywordflow">if</span> (WeakPH) {</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *Conv = <span class="keyword">new</span> <a class="code" href="classllvm_1_1SIToFPInst.html">SIToFPInst</a>(NewPHI, PN-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>(), <span class="stringliteral">&quot;indvar.conv&quot;</span>,</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;                                 PN-&gt;<a class="code" href="classllvm_1_1Instruction.html#a9cd49851904f15060edb782ef4dd1b2d">getParent</a>()-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#ab1cd5a3713b93a33f89a2086d473cf6e">getFirstInsertionPt</a>());</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    PN-&gt;<a class="code" href="classllvm_1_1Value.html#a3ab5fc45117b450e8bb04e564cb6e5f2">replaceAllUsesWith</a>(Conv);</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <a class="code" href="namespacellvm.html#a23b3753cc662a87b599913814ccf2444">RecursivelyDeleteTriviallyDeadInstructions</a>(PN, TLI);</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;  }</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;  Changed = <span class="keyword">true</span>;</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;}</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;<span class="keywordtype">void</span> IndVarSimplify::RewriteNonIntegerIVs(<a class="code" href="classllvm_1_1Loop.html">Loop</a> *L) {</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;  <span class="comment">// First step.  Check to see if there are any floating-point recurrences.</span></div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;  <span class="comment">// If there are, change them into integer recurrences, permitting analysis by</span></div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;  <span class="comment">// the SCEV routines.</span></div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;  <span class="comment">//</span></div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *Header = L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#ac4f141a355e5898255f2cbc57c5b54c3">getHeader</a>();</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;WeakVH, 8&gt;</a> PHIs;</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1ilist__iterator.html">BasicBlock::iterator</a> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = Header-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a0ed5f3ab3c2e4196ee0cffffa080c062">begin</a>();</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;       <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *PN = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1PHINode.html">PHINode</a>&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>); ++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    PHIs.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(PN);</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0, e = PHIs.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#a22a311dfe4c28a897de8a9365a4f0a84">size</a>(); <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != e; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *PN = dyn_cast_or_null&lt;PHINode&gt;(&amp;*PHIs[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>]))</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;      HandleFloatingPointIV(L, PN);</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;  <span class="comment">// If the loop previously had floating-point IV, ScalarEvolution</span></div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;  <span class="comment">// may not have been able to compute a trip count. Now that we&#39;ve done some</span></div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;  <span class="comment">// re-writing, the trip count may be computable.</span></div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;  <span class="keywordflow">if</span> (Changed)</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a592bdd7731b14ff4ff5d646f6f399900">forgetLoop</a>(L);</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;}</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;<span class="comment">// RewriteLoopExitValues - Optimize IV users outside the loop.</span></div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="comment">// As a side effect, reduces the amount of IV processing within the loop.</span></div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;<span class="comment">/// RewriteLoopExitValues - Check to see if this loop has a computable</span></div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;<span class="comment">/// loop-invariant execution count.  If so, this means that we can compute the</span></div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="comment">/// final value of any expressions that are recurrent in the loop, and</span></div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;<span class="comment">/// substitute the exit values from the loop into any instructions outside of</span></div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;<span class="comment">/// the loop that use the final values of the current expressions.</span></div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;<span class="comment">/// This is mostly redundant with the regular IndVarSimplify activities that</span></div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;<span class="comment">/// happen later, except that it&#39;s more powerful in some cases, because it&#39;s</span></div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;<span class="comment">/// able to brute-force evaluate arbitrary instructions as long as they have</span></div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;<span class="comment">/// constant operands at the beginning of the loop.</span></div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;<span class="comment"></span><span class="keywordtype">void</span> IndVarSimplify::RewriteLoopExitValues(<a class="code" href="classllvm_1_1Loop.html">Loop</a> *L, <a class="code" href="classllvm_1_1SCEVExpander.html">SCEVExpander</a> &amp;<a class="code" href="VirtRegMap_8cpp.html#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a>) {</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;  <span class="comment">// Verify the input to the pass in already in LCSSA form.</span></div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;  assert(L-&gt;<a class="code" href="classllvm_1_1Loop.html#a169771e7b8bf22ee06a0ebe655fce069">isLCSSAForm</a>(*DT));</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;BasicBlock*, 8&gt;</a> ExitBlocks;</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;  L-&gt;<a class="code" href="classllvm_1_1Loop.html#a147b421eaf58e18b10664a6f3c5c7f5b">getUniqueExitBlocks</a>(ExitBlocks);</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;  <span class="comment">// Find all values that are computed inside the loop, but used outside of it.</span></div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;  <span class="comment">// Because of LCSSA, these values will only occur in LCSSA PHI Nodes.  Scan</span></div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;  <span class="comment">// the exit blocks of the loop to find them.</span></div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0, e = ExitBlocks.size(); <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != e; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *ExitBB = ExitBlocks[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    <span class="comment">// If there are no PHI nodes in this exit block, then no values defined</span></div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    <span class="comment">// inside the loop are used on this path, skip it.</span></div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *PN = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1PHINode.html">PHINode</a>&gt;(ExitBB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a0ed5f3ab3c2e4196ee0cffffa080c062">begin</a>());</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    <span class="keywordflow">if</span> (!PN) <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    <span class="keywordtype">unsigned</span> NumPreds = PN-&gt;<a class="code" href="classllvm_1_1PHINode.html#aa45f6c0433576e3858a6209a43750ad4">getNumIncomingValues</a>();</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    <span class="comment">// Iterate over all of the PHI nodes.</span></div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    <a class="code" href="classllvm_1_1ilist__iterator.html">BasicBlock::iterator</a> BBI = ExitBB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a0ed5f3ab3c2e4196ee0cffffa080c062">begin</a>();</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    <span class="keywordflow">while</span> ((PN = dyn_cast&lt;PHINode&gt;(BBI++))) {</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;      <span class="keywordflow">if</span> (PN-&gt;<a class="code" href="classllvm_1_1Value.html#ac38c53f76ef532f91f1666c8a87370e9">use_empty</a>())</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;        <span class="keywordflow">continue</span>; <span class="comment">// dead use, don&#39;t replace it</span></div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;      <span class="comment">// SCEV only supports integer expressions for now.</span></div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;      <span class="keywordflow">if</span> (!PN-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a6e328feb83afa5cf1c966d6704e43fc1">isIntegerTy</a>() &amp;&amp; !PN-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a2eba483f5cc876e824aa6c085736086b">isPointerTy</a>())</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;      <span class="comment">// It&#39;s necessary to tell ScalarEvolution about this explicitly so that</span></div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;      <span class="comment">// it can walk the def-use list and forget all SCEVs, as it may not be</span></div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;      <span class="comment">// watching the PHI itself. Once the new exit value is in place, there</span></div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;      <span class="comment">// may not be a def-use connection between the loop and every instruction</span></div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;      <span class="comment">// which got a SCEVAddRecExpr for that loop.</span></div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;      SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a804545e5b568edec8b970da32cd37359">forgetValue</a>(PN);</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;      <span class="comment">// Iterate over all of the values in all the PHI nodes.</span></div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != NumPreds; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;        <span class="comment">// If the value being merged in is not integer or is not defined</span></div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        <span class="comment">// in the loop, skip it.</span></div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;        <a class="code" href="classllvm_1_1Value.html">Value</a> *InVal = PN-&gt;<a class="code" href="classllvm_1_1PHINode.html#aba6a4cc4ed6d6fef3664b8d65ef04820">getIncomingValue</a>(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;        <span class="keywordflow">if</span> (!isa&lt;Instruction&gt;(InVal))</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;          <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;        <span class="comment">// If this pred is for a subloop, not L itself, skip it.</span></div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;        <span class="keywordflow">if</span> (LI-&gt;<a class="code" href="classllvm_1_1LoopInfo.html#a4abca289c73cd09487e05d11d9f7d877">getLoopFor</a>(PN-&gt;<a class="code" href="classllvm_1_1PHINode.html#a4c25b6c00c4867281779c81ab64d2081">getIncomingBlock</a>(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>)) != L)</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;          <span class="keywordflow">continue</span>; <span class="comment">// The Block is in a subloop, skip it.</span></div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;        <span class="comment">// Check that InVal is defined in the loop.</span></div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;        <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *Inst = cast&lt;Instruction&gt;(InVal);</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;        <span class="keywordflow">if</span> (!L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a92a38e2e3412bde7fd2b71db212b61aa">contains</a>(Inst))</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;          <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;        <span class="comment">// Okay, this instruction has a user outside of the current loop</span></div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;        <span class="comment">// and varies predictably *inside* the loop.  Evaluate the value it</span></div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;        <span class="comment">// contains when the loop exits, if possible.</span></div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;        <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *ExitValue = SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a21d6ee82eed29080d911dbb548a8bb68">getSCEVAtScope</a>(Inst, L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a1431766de798501f107d9031821f311e">getParentLoop</a>());</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;        <span class="keywordflow">if</span> (!SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a5a19768af81df7e5fe571bc08dcd48b3">isLoopInvariant</a>(ExitValue, L) ||</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;            !<a class="code" href="namespacellvm.html#aed54a8c39c1f5f066957f1297bd6bd0b">isSafeToExpand</a>(ExitValue, *SE))</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;          <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;        <span class="comment">// Computing the value outside of the loop brings no benefit if :</span></div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;        <span class="comment">//  - it is definitely used inside the loop in a way which can not be</span></div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;        <span class="comment">//    optimized away.</span></div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;        <span class="comment">//  - no use outside of the loop can take advantage of hoisting the</span></div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;        <span class="comment">//    computation out of the loop</span></div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;        <span class="keywordflow">if</span> (ExitValue-&gt;<a class="code" href="classllvm_1_1SCEV.html#ac08c8d9d93b387dc10681b6f156095bf">getSCEVType</a>()&gt;=<a class="code" href="namespacellvm.html#a7ef747666d6938cb47b3c5544011a4e5afd56f054da3d1f9b827ae1003da3a38b">scMulExpr</a>) {</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;          <span class="keywordtype">unsigned</span> NumHardInternalUses = 0;</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;          <span class="keywordtype">unsigned</span> NumSoftExternalUses = 0;</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;          <span class="keywordtype">unsigned</span> NumUses = 0;</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;          <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1value__use__iterator.html">Value::use_iterator</a> IB=Inst-&gt;<a class="code" href="classllvm_1_1Value.html#a413abcab8dbc3900fc2fde96a5d8fca6">use_begin</a>(), <a class="code" href="namespacellvm_1_1ARM__PROC.html#a1add7850fad3f66c140ecee871460ea4ae9d798593a4a6b5cc48486a453a59e5e">IE</a>=Inst-&gt;<a class="code" href="classllvm_1_1Value.html#ad86469939d2a8bdd4169be9403b89f5a">use_end</a>();</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;               IB!=<a class="code" href="namespacellvm_1_1ARM__PROC.html#a1add7850fad3f66c140ecee871460ea4ae9d798593a4a6b5cc48486a453a59e5e">IE</a> &amp;&amp; NumUses&lt;=6 ; ++IB) {</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;            <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *UseInstr = cast&lt;Instruction&gt;(*IB);</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;            <span class="keywordtype">unsigned</span> Opc = UseInstr-&gt;<a class="code" href="classllvm_1_1Instruction.html#a021bb7c9aad6003fe8089f6327356c6c">getOpcode</a>();</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;            NumUses++;</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;            <span class="keywordflow">if</span> (L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a92a38e2e3412bde7fd2b71db212b61aa">contains</a>(UseInstr)) {</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;              <span class="keywordflow">if</span> (Opc == <a class="code" href="namespacellvm.html#af6d6a791770bad2303c4399986979e3eae411369b2f0d8f484fec62c3291b1b51">Instruction::Call</a> || Opc == <a class="code" href="namespacellvm_1_1AArch64ISD.html#a246d89cb58f606179b1435937830bbdca84e96c468affe3b1fd3076b4fc5d063e">Instruction::Ret</a>)</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;                NumHardInternalUses++;</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;              <span class="keywordflow">if</span> (Opc == <a class="code" href="namespacellvm_1_1TargetOpcode.html#a348d4259b5fa6a8ecfe94e7ae512e1a8ae41f9ca68ba5e8b9613cea03652ebd72">Instruction::PHI</a>) {</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;                <span class="comment">// Do not count the Phi as a use. LCSSA may have inserted</span></div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;                <span class="comment">// plenty of trivial ones.</span></div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;                NumUses--;</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;                <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1value__use__iterator.html">Value::use_iterator</a> PB=UseInstr-&gt;<a class="code" href="classllvm_1_1Value.html#a413abcab8dbc3900fc2fde96a5d8fca6">use_begin</a>(),</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;                                         PE=UseInstr-&gt;<a class="code" href="classllvm_1_1Value.html#ad86469939d2a8bdd4169be9403b89f5a">use_end</a>();</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;                     PB!=PE &amp;&amp; NumUses&lt;=6 ; ++PB, ++NumUses) {</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;                  <span class="keywordtype">unsigned</span> PhiOpc = cast&lt;Instruction&gt;(*PB)-&gt;getOpcode();</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;                  <span class="keywordflow">if</span> (PhiOpc != <a class="code" href="namespacellvm.html#af6d6a791770bad2303c4399986979e3eae411369b2f0d8f484fec62c3291b1b51">Instruction::Call</a> &amp;&amp; PhiOpc != <a class="code" href="namespacellvm_1_1AArch64ISD.html#a246d89cb58f606179b1435937830bbdca84e96c468affe3b1fd3076b4fc5d063e">Instruction::Ret</a>)</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;                    NumSoftExternalUses++;</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;                }</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;                <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;              }</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;              <span class="keywordflow">if</span> (Opc != <a class="code" href="namespacellvm.html#af6d6a791770bad2303c4399986979e3eae411369b2f0d8f484fec62c3291b1b51">Instruction::Call</a> &amp;&amp; Opc != <a class="code" href="namespacellvm_1_1AArch64ISD.html#a246d89cb58f606179b1435937830bbdca84e96c468affe3b1fd3076b4fc5d063e">Instruction::Ret</a>)</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;                NumSoftExternalUses++;</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;            }</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;          }</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;          <span class="keywordflow">if</span> (NumUses &lt;= 6 &amp;&amp; NumHardInternalUses &amp;&amp; !NumSoftExternalUses)</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;        }</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;        <a class="code" href="classllvm_1_1Value.html">Value</a> *ExitVal = Rewriter.<a class="code" href="classllvm_1_1SCEVExpander.html#a583d3ca95f83216d632a4d1ae0330dd0">expandCodeFor</a>(ExitValue, PN-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>(), Inst);</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;        <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;INDVARS: RLEV: AfterLoopVal = &quot;</span> &lt;&lt; *ExitVal &lt;&lt; <span class="charliteral">&#39;\n&#39;</span></div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;                     &lt;&lt; <span class="stringliteral">&quot;  LoopVal = &quot;</span> &lt;&lt; *Inst &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;        <span class="keywordflow">if</span> (!isValidRewrite(Inst, ExitVal)) {</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;          DeadInsts.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(ExitVal);</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;          <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;        }</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;        Changed = <span class="keyword">true</span>;</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;        ++NumReplaced;</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;        PN-&gt;<a class="code" href="classllvm_1_1PHINode.html#a88cdefb709309eddc6e5daca0be6a7b4">setIncomingValue</a>(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>, ExitVal);</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;        <span class="comment">// If this instruction is dead now, delete it. Don&#39;t do it now to avoid</span></div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;        <span class="comment">// invalidating iterators.</span></div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#abe283966f269761ee387642061c4451e">isInstructionTriviallyDead</a>(Inst, TLI))</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;          DeadInsts.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(Inst);</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;        <span class="keywordflow">if</span> (NumPreds == 1) {</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;          <span class="comment">// Completely replace a single-pred PHI. This is safe, because the</span></div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;          <span class="comment">// NewVal won&#39;t be variant in the loop, so we don&#39;t need an LCSSA phi</span></div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;          <span class="comment">// node anymore.</span></div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;          PN-&gt;<a class="code" href="classllvm_1_1Value.html#a3ab5fc45117b450e8bb04e564cb6e5f2">replaceAllUsesWith</a>(ExitVal);</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;          PN-&gt;<a class="code" href="classllvm_1_1Instruction.html#a6fe2f06b8a4b2c3d6308afb223a0238a">eraseFromParent</a>();</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;        }</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;      }</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;      <span class="keywordflow">if</span> (NumPreds != 1) {</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;        <span class="comment">// Clone the PHI and delete the original one. This lets IVUsers and</span></div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;        <span class="comment">// any other maps purge the original user from their records.</span></div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;        <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *NewPN = cast&lt;PHINode&gt;(PN-&gt;<a class="code" href="classllvm_1_1Instruction.html#af6aad0c9ba7b8720130235c9621b55b5">clone</a>());</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;        NewPN-&gt;<a class="code" href="classllvm_1_1Value.html#ae855357b6c5e6e7ed1869272708a3a84">takeName</a>(PN);</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;        NewPN-&gt;<a class="code" href="classllvm_1_1Instruction.html#a482498a1c760122fd33c7fc8190dd277">insertBefore</a>(PN);</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;        PN-&gt;<a class="code" href="classllvm_1_1Value.html#a3ab5fc45117b450e8bb04e564cb6e5f2">replaceAllUsesWith</a>(NewPN);</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;        PN-&gt;<a class="code" href="classllvm_1_1Instruction.html#a6fe2f06b8a4b2c3d6308afb223a0238a">eraseFromParent</a>();</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;      }</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    }</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;  }</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;  <span class="comment">// The insertion point instruction may have been deleted; clear it out</span></div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;  <span class="comment">// so that the rewriter doesn&#39;t trip over it later.</span></div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;  Rewriter.<a class="code" href="classllvm_1_1SCEVExpander.html#a647982e2639d56e8f172122bb422aca1">clearInsertPoint</a>();</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;}</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;<span class="comment">//  IV Widening - Extend the width of an IV to cover its widest uses.</span></div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;<span class="keyword">namespace </span>{</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;  <span class="comment">// Collect information about induction variables that are used by sign/zero</span></div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;  <span class="comment">// extend operations. This information is recorded by CollectExtend and</span></div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;  <span class="comment">// provides the input to WidenIV.</span></div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;  <span class="keyword">struct </span>WideIVInfo {</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;    <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *NarrowIV;</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;    <a class="code" href="classllvm_1_1Type.html">Type</a> *WidestNativeType; <span class="comment">// Widest integer type created [sz]ext</span></div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    <span class="keywordtype">bool</span> IsSigned;          <span class="comment">// Was an sext user seen before a zext?</span></div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;    WideIVInfo() : NarrowIV(0), WidestNativeType(0), IsSigned(<span class="keyword">false</span>) {}</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;  };</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;  <span class="keyword">class </span>WideIVVisitor : <span class="keyword">public</span> <a class="code" href="classllvm_1_1IVVisitor.html">IVVisitor</a> {</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;    <a class="code" href="classllvm_1_1ScalarEvolution.html">ScalarEvolution</a> *SE;</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> *TD;</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;  <span class="keyword">public</span>:</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;    WideIVInfo WI;</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    WideIVVisitor(<a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *NarrowIV, <a class="code" href="classllvm_1_1ScalarEvolution.html">ScalarEvolution</a> *<a class="code" href="classllvm_1_1SCEV.html">SCEV</a>,</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;                  <span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> *TData) :</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;      SE(SCEV), TD(TData) { WI.NarrowIV = NarrowIV; }</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    <span class="comment">// Implement the interface used by simplifyUsersOfIV.</span></div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">void</span> visitCast(<a class="code" href="classllvm_1_1CastInst.html">CastInst</a> *Cast);</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;  };</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;}</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;<span class="comment">/// visitCast - Update information about the induction variable that is</span></div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;<span class="comment">/// extended by this sign or zero extend operation. This is used to determine</span></div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;<span class="comment">/// the final width of the IV before actually widening it.</span></div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;<span class="comment"></span><span class="keywordtype">void</span> WideIVVisitor::visitCast(<a class="code" href="classllvm_1_1CastInst.html">CastInst</a> *Cast) {</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;  <span class="keywordtype">bool</span> IsSigned = Cast-&gt;<a class="code" href="classllvm_1_1CastInst.html#adc3489e61d5f37a0e4c5589859fbccc2">getOpcode</a>() == Instruction::SExt;</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;  <span class="keywordflow">if</span> (!IsSigned &amp;&amp; Cast-&gt;<a class="code" href="classllvm_1_1CastInst.html#adc3489e61d5f37a0e4c5589859fbccc2">getOpcode</a>() != Instruction::ZExt)</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *Ty = Cast-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>();</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;  uint64_t Width = SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a983dbdce6af7840357ed33a20c8f30bb">getTypeSizeInBits</a>(Ty);</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;  <span class="keywordflow">if</span> (TD &amp;&amp; !TD-&gt;<a class="code" href="classllvm_1_1DataLayout.html#a96f1e9abd65fef355bd8f15f9360c871">isLegalInteger</a>(Width))</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;  <span class="keywordflow">if</span> (!WI.WidestNativeType) {</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;    WI.WidestNativeType = SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#abb976145b00ae108c1d6b98c4f099d27">getEffectiveSCEVType</a>(Ty);</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    WI.IsSigned = IsSigned;</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;  }</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;  <span class="comment">// We extend the IV to satisfy the sign of its first user, arbitrarily.</span></div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;  <span class="keywordflow">if</span> (WI.IsSigned != IsSigned)</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;  <span class="keywordflow">if</span> (Width &gt; SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a983dbdce6af7840357ed33a20c8f30bb">getTypeSizeInBits</a>(WI.WidestNativeType))</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    WI.WidestNativeType = SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#abb976145b00ae108c1d6b98c4f099d27">getEffectiveSCEVType</a>(Ty);</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;}</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;<span class="keyword">namespace </span>{</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;<span class="comment">/// NarrowIVDefUse - Record a link in the Narrow IV def-use chain along with the</span></div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;<span class="comment">/// WideIV that computes the same value as the Narrow IV def.  This avoids</span></div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;<span class="comment">/// caching Use* pointers.</span></div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;<span class="comment"></span><span class="keyword">struct </span>NarrowIVDefUse {</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *NarrowDef;</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *NarrowUse;</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *WideDef;</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;  NarrowIVDefUse(): NarrowDef(0), NarrowUse(0), WideDef(0) {}</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;  NarrowIVDefUse(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *ND, <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *NU, <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *WD):</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;    NarrowDef(ND), NarrowUse(NU), WideDef(WD) {}</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;};</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;<span class="comment">/// WidenIV - The goal of this transform is to remove sign and zero extends</span></div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;<span class="comment">/// without creating any new induction variables. To do this, it creates a new</span></div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;<span class="comment">/// phi of the wider type and redirects all users, either removing extends or</span></div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;<span class="comment">/// inserting truncs whenever we stop propagating the type.</span></div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;<span class="comment"></span><span class="keyword">class </span>WidenIV {</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;  <span class="comment">// Parameters</span></div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;  <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *OrigPhi;</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *WideType;</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;  <span class="keywordtype">bool</span> IsSigned;</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;  <span class="comment">// Context</span></div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;  <a class="code" href="classllvm_1_1LoopInfo.html">LoopInfo</a>        *LI;</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;  <a class="code" href="classllvm_1_1Loop.html">Loop</a>            *L;</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;  <a class="code" href="classllvm_1_1ScalarEvolution.html">ScalarEvolution</a> *SE;</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;  <a class="code" href="classllvm_1_1DominatorTree.html">DominatorTree</a>   *DT;</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;  <span class="comment">// Result</span></div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;  <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *WidePhi;</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *WideInc;</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *WideIncExpr;</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;  <a class="code" href="classllvm_1_1SmallVectorImpl.html">SmallVectorImpl&lt;WeakVH&gt;</a> &amp;DeadInsts;</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;  <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;Instruction*,16&gt;</a> Widened;</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;NarrowIVDefUse, 8&gt;</a> NarrowIVUsers;</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;  WidenIV(<span class="keyword">const</span> WideIVInfo &amp;WI, <a class="code" href="classllvm_1_1LoopInfo.html">LoopInfo</a> *LInfo,</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;          <a class="code" href="classllvm_1_1ScalarEvolution.html">ScalarEvolution</a> *SEv, <a class="code" href="classllvm_1_1DominatorTree.html">DominatorTree</a> *DTree,</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;          <a class="code" href="classllvm_1_1SmallVectorImpl.html">SmallVectorImpl&lt;WeakVH&gt;</a> &amp;DI) :</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;    OrigPhi(WI.NarrowIV),</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    WideType(WI.WidestNativeType),</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;    IsSigned(WI.IsSigned),</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;    LI(LInfo),</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;    L(LI-&gt;<a class="code" href="classllvm_1_1LoopInfo.html#a4abca289c73cd09487e05d11d9f7d877">getLoopFor</a>(OrigPhi-&gt;<a class="code" href="classllvm_1_1Instruction.html#a9cd49851904f15060edb782ef4dd1b2d">getParent</a>())),</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;    SE(SEv),</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;    DT(DTree),</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;    WidePhi(0),</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;    WideInc(0),</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;    WideIncExpr(0),</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;    DeadInsts(DI) {</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;    assert(L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#ac4f141a355e5898255f2cbc57c5b54c3">getHeader</a>() == OrigPhi-&gt;<a class="code" href="classllvm_1_1Instruction.html#a9cd49851904f15060edb782ef4dd1b2d">getParent</a>() &amp;&amp; <span class="stringliteral">&quot;Phi must be an IV&quot;</span>);</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;  }</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;  <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *CreateWideIV(<a class="code" href="classllvm_1_1SCEVExpander.html">SCEVExpander</a> &amp;Rewriter);</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;<span class="keyword">protected</span>:</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *getExtend(<a class="code" href="classllvm_1_1Value.html">Value</a> *NarrowOper, <a class="code" href="classllvm_1_1Type.html">Type</a> *WideType, <span class="keywordtype">bool</span> IsSigned,</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;                   <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="classllvm_1_1Use.html">Use</a>);</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *CloneIVUser(NarrowIVDefUse DU);</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEVAddRecExpr.html">SCEVAddRecExpr</a> *GetWideRecurrence(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *NarrowUse);</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEVAddRecExpr.html">SCEVAddRecExpr</a>* GetExtendedOperandRecurrence(NarrowIVDefUse DU);</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *WidenIVUse(NarrowIVDefUse DU, <a class="code" href="classllvm_1_1SCEVExpander.html">SCEVExpander</a> &amp;Rewriter);</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;  <span class="keywordtype">void</span> pushNarrowIVUsers(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *NarrowDef, <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *WideDef);</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;};</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;} <span class="comment">// anonymous namespace</span></div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;<span class="comment">/// isLoopInvariant - Perform a quick domtree based check for loop invariance</span></div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;<span class="comment">/// assuming that V is used within the loop. LoopInfo::isLoopInvariant() seems</span></div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;<span class="comment">/// gratuitous for this purpose.</span></div><div class="line"><a name="l00762"></a><span class="lineno"><a class="line" href="IndVarSimplify_8cpp.html#afcaa9ef0e14174b7e78a1ba5e83093d7">  762</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="IndVarSimplify_8cpp.html#afcaa9ef0e14174b7e78a1ba5e83093d7">isLoopInvariant</a>(<a class="code" href="classllvm_1_1Value.html">Value</a> *V, <span class="keyword">const</span> <a class="code" href="classllvm_1_1Loop.html">Loop</a> *L, <span class="keyword">const</span> <a class="code" href="classllvm_1_1DominatorTree.html">DominatorTree</a> *DT) {</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *Inst = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1Instruction.html">Instruction</a>&gt;(V);</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;  <span class="keywordflow">if</span> (!Inst)</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;  <span class="keywordflow">return</span> DT-&gt;<a class="code" href="classllvm_1_1DominatorTree.html#aa094180f7ac0ef9d4b8e1c78f850edd8">properlyDominates</a>(Inst-&gt;<a class="code" href="classllvm_1_1Instruction.html#a9cd49851904f15060edb782ef4dd1b2d">getParent</a>(), L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#ac4f141a355e5898255f2cbc57c5b54c3">getHeader</a>());</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;}</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *WidenIV::getExtend(<a class="code" href="classllvm_1_1Value.html">Value</a> *NarrowOper, <a class="code" href="classllvm_1_1Type.html">Type</a> *WideType, <span class="keywordtype">bool</span> IsSigned,</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;                          <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="classllvm_1_1Use.html">Use</a>) {</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;  <span class="comment">// Set the debug location and conservative insertion point.</span></div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;  <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> Builder(Use);</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;  <span class="comment">// Hoist the insertion point into loop preheaders as far as possible.</span></div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code" href="classllvm_1_1Loop.html">Loop</a> *L = LI-&gt;<a class="code" href="classllvm_1_1LoopInfo.html#a4abca289c73cd09487e05d11d9f7d877">getLoopFor</a>(Use-&gt;<a class="code" href="classllvm_1_1Instruction.html#a9cd49851904f15060edb782ef4dd1b2d">getParent</a>());</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;       L &amp;&amp; L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a1bc74c76b876ad387293ecde0f21ed45">getLoopPreheader</a>() &amp;&amp; <a class="code" href="IndVarSimplify_8cpp.html#afcaa9ef0e14174b7e78a1ba5e83093d7">isLoopInvariant</a>(NarrowOper, L, DT);</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;       L = L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a1431766de798501f107d9031821f311e">getParentLoop</a>())</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;    Builder.<a class="code" href="classllvm_1_1IRBuilderBase.html#ace45cae6925c65e9d6916e09dd5b17cc">SetInsertPoint</a>(L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a1bc74c76b876ad387293ecde0f21ed45">getLoopPreheader</a>()-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a5cb76a65b6524dba1493dd2b9dc3abbe">getTerminator</a>());</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;  <span class="keywordflow">return</span> IsSigned ? Builder.<a class="code" href="classllvm_1_1IRBuilder.html#a2081b822b121723df82782c24314a37e">CreateSExt</a>(NarrowOper, WideType) :</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;                    Builder.<a class="code" href="classllvm_1_1IRBuilder.html#a277dfeaad2a2ada72a6024b0eedc5301">CreateZExt</a>(NarrowOper, WideType);</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;}</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;<span class="comment">/// CloneIVUser - Instantiate a wide operation to replace a narrow</span></div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;<span class="comment">/// operation. This only needs to handle operations that can evaluation to</span></div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;<span class="comment">/// SCEVAddRec. It can safely return 0 for any operation we decide not to clone.</span></div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;<span class="comment"></span><a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *WidenIV::CloneIVUser(NarrowIVDefUse DU) {</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;  <span class="keywordtype">unsigned</span> Opcode = DU.NarrowUse-&gt;getOpcode();</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;  <span class="keywordflow">switch</span> (Opcode) {</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;  <span class="keywordflow">default</span>:</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;  <span class="keywordflow">case</span> Instruction::Add:</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;  <span class="keywordflow">case</span> Instruction::Mul:</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;  <span class="keywordflow">case</span> Instruction::UDiv:</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;  <span class="keywordflow">case</span> Instruction::Sub:</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1APIntOps.html#a684cfe02c582e8d75cd6d457e63e6c25">Instruction::And</a>:</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1APIntOps.html#a22f056804d2b9882f74adc905872bc39">Instruction::Or</a>:</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1APIntOps.html#afc7c4d88d09cba0c5e920f8a3a3ace55">Instruction::Xor</a>:</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;  <span class="keywordflow">case</span> Instruction::Shl:</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;  <span class="keywordflow">case</span> Instruction::LShr:</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;  <span class="keywordflow">case</span> Instruction::AShr:</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;    <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Cloning IVUser: &quot;</span> &lt;&lt; *DU.NarrowUse &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;    <span class="comment">// Replace NarrowDef operands with WideDef. Otherwise, we don&#39;t know</span></div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;    <span class="comment">// anything about the narrow operand yet so must insert a [sz]ext. It is</span></div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;    <span class="comment">// probably loop invariant and will be folded or hoisted. If it actually</span></div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;    <span class="comment">// comes from a widened IV, it should be removed during a future call to</span></div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;    <span class="comment">// WidenIVUse.</span></div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *LHS = (DU.NarrowUse-&gt;getOperand(0) == DU.NarrowDef) ? DU.WideDef :</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;      getExtend(DU.NarrowUse-&gt;getOperand(0), WideType, IsSigned, DU.NarrowUse);</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *RHS = (DU.NarrowUse-&gt;getOperand(1) == DU.NarrowDef) ? DU.WideDef :</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;      getExtend(DU.NarrowUse-&gt;getOperand(1), WideType, IsSigned, DU.NarrowUse);</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;    <a class="code" href="classllvm_1_1BinaryOperator.html">BinaryOperator</a> *NarrowBO = cast&lt;BinaryOperator&gt;(DU.NarrowUse);</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;    <a class="code" href="classllvm_1_1BinaryOperator.html">BinaryOperator</a> *WideBO = <a class="code" href="classllvm_1_1BinaryOperator.html#a4a4628e91a9c6a339fa61105614fac76">BinaryOperator::Create</a>(NarrowBO-&gt;<a class="code" href="classllvm_1_1BinaryOperator.html#a88505baf41407782678a5df1702d2d31">getOpcode</a>(),</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;                                                    LHS, RHS,</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;                                                    NarrowBO-&gt;<a class="code" href="classllvm_1_1Value.html#ad452febc1ac0b394876e640ec03ffa38">getName</a>());</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;    <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> Builder(DU.NarrowUse);</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;    Builder.Insert(WideBO);</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">const</span> <a class="code" href="classllvm_1_1OverflowingBinaryOperator.html">OverflowingBinaryOperator</a> *OBO =</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;        dyn_cast&lt;OverflowingBinaryOperator&gt;(NarrowBO)) {</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;      <span class="keywordflow">if</span> (OBO-&gt;hasNoUnsignedWrap()) WideBO-&gt;setHasNoUnsignedWrap();</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;      <span class="keywordflow">if</span> (OBO-&gt;hasNoSignedWrap()) WideBO-&gt;setHasNoSignedWrap();</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;    }</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;    <span class="keywordflow">return</span> WideBO;</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;  }</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;}</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;<span class="comment">/// No-wrap operations can transfer sign extension of their result to their</span></div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;<span class="comment">/// operands. Generate the SCEV value for the widened operation without</span></div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;<span class="comment">/// actually modifying the IR yet. If the expression after extending the</span></div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;<span class="comment">/// operands is an AddRec for this loop, return it.</span></div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;<span class="comment"></span><span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEVAddRecExpr.html">SCEVAddRecExpr</a>* WidenIV::GetExtendedOperandRecurrence(NarrowIVDefUse DU) {</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;  <span class="comment">// Handle the common case of add&lt;nsw/nuw&gt;</span></div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;  <span class="keywordflow">if</span> (DU.NarrowUse-&gt;getOpcode() != Instruction::Add)</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;  <span class="comment">// One operand (NarrowDef) has already been extended to WideDef. Now determine</span></div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;  <span class="comment">// if extending the other will lead to a recurrence.</span></div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;  <span class="keywordtype">unsigned</span> ExtendOperIdx = DU.NarrowUse-&gt;getOperand(0) == DU.NarrowDef ? 1 : 0;</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;  assert(DU.NarrowUse-&gt;getOperand(1-ExtendOperIdx) == DU.NarrowDef &amp;&amp; <span class="stringliteral">&quot;bad DU&quot;</span>);</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *ExtendOperExpr = 0;</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1OverflowingBinaryOperator.html">OverflowingBinaryOperator</a> *OBO =</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;    cast&lt;OverflowingBinaryOperator&gt;(DU.NarrowUse);</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;  <span class="keywordflow">if</span> (IsSigned &amp;&amp; OBO-&gt;<a class="code" href="classllvm_1_1OverflowingBinaryOperator.html#a5a1ebefdf12a23a94f8a135cdfa0cd90">hasNoSignedWrap</a>())</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;    ExtendOperExpr = SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a63d4f693eb205bb9d556e067464f943c">getSignExtendExpr</a>(</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;      SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a30bd18ac905eacf3601bc6a553a9ff49">getSCEV</a>(DU.NarrowUse-&gt;getOperand(ExtendOperIdx)), WideType);</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!IsSigned &amp;&amp; OBO-&gt;<a class="code" href="classllvm_1_1OverflowingBinaryOperator.html#abe8af726db43885a1178cf75ed0725d9">hasNoUnsignedWrap</a>())</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;    ExtendOperExpr = SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#abfa1a24cb47fd5fedbc7109b905741a3">getZeroExtendExpr</a>(</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;      SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a30bd18ac905eacf3601bc6a553a9ff49">getSCEV</a>(DU.NarrowUse-&gt;getOperand(ExtendOperIdx)), WideType);</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;  <span class="comment">// When creating this AddExpr, don&#39;t apply the current operations NSW or NUW</span></div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;  <span class="comment">// flags. This instruction may be guarded by control flow that the no-wrap</span></div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;  <span class="comment">// behavior depends on. Non-control-equivalent instructions can be mapped to</span></div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;  <span class="comment">// the same SCEV expression, and it would be incorrect to transfer NSW/NUW</span></div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;  <span class="comment">// semantics to those operations.</span></div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEVAddRecExpr.html">SCEVAddRecExpr</a> *AddRec = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1SCEVAddRecExpr.html">SCEVAddRecExpr</a>&gt;(</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;    SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a23541ecba66207184eaf2279a70c5b12">getAddExpr</a>(SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a30bd18ac905eacf3601bc6a553a9ff49">getSCEV</a>(DU.WideDef), ExtendOperExpr));</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;  <span class="keywordflow">if</span> (!AddRec || AddRec-&gt;<a class="code" href="classllvm_1_1SCEVAddRecExpr.html#a7fcbbc51eef313e675a2442bb2053ae9">getLoop</a>() != L)</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;  <span class="keywordflow">return</span> AddRec;</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;}</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;<span class="comment">/// GetWideRecurrence - Is this instruction potentially interesting from</span></div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;<span class="comment">/// IVUsers&#39; perspective after widening it&#39;s type? In other words, can the</span></div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;<span class="comment">/// extend be safely hoisted out of the loop with SCEV reducing the value to a</span></div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;<span class="comment">/// recurrence on the same loop. If so, return the sign or zero extended</span></div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;<span class="comment">/// recurrence. Otherwise return NULL.</span></div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;<span class="comment"></span><span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEVAddRecExpr.html">SCEVAddRecExpr</a> *WidenIV::GetWideRecurrence(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *NarrowUse) {</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;  <span class="keywordflow">if</span> (!SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#ae9623974341419bfd1d185cfdc65bedd">isSCEVable</a>(NarrowUse-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>()))</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *NarrowExpr = SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a30bd18ac905eacf3601bc6a553a9ff49">getSCEV</a>(NarrowUse);</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;  <span class="keywordflow">if</span> (SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a983dbdce6af7840357ed33a20c8f30bb">getTypeSizeInBits</a>(NarrowExpr-&gt;<a class="code" href="classllvm_1_1SCEV.html#a9a16f1241255a605fc8debc1e26eaa4c">getType</a>())</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;      &gt;= SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a983dbdce6af7840357ed33a20c8f30bb">getTypeSizeInBits</a>(WideType)) {</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;    <span class="comment">// NarrowUse implicitly widens its operand. e.g. a gep with a narrow</span></div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;    <span class="comment">// index. So don&#39;t follow this use.</span></div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;  }</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *WideExpr = IsSigned ?</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;    SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a63d4f693eb205bb9d556e067464f943c">getSignExtendExpr</a>(NarrowExpr, WideType) :</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;    SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#abfa1a24cb47fd5fedbc7109b905741a3">getZeroExtendExpr</a>(NarrowExpr, WideType);</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEVAddRecExpr.html">SCEVAddRecExpr</a> *AddRec = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1SCEVAddRecExpr.html">SCEVAddRecExpr</a>&gt;(WideExpr);</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;  <span class="keywordflow">if</span> (!AddRec || AddRec-&gt;<a class="code" href="classllvm_1_1SCEVAddRecExpr.html#a7fcbbc51eef313e675a2442bb2053ae9">getLoop</a>() != L)</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;  <span class="keywordflow">return</span> AddRec;</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;}</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;<span class="comment">/// WidenIVUse - Determine whether an individual user of the narrow IV can be</span></div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;<span class="comment">/// widened. If so, return the wide clone of the user.</span></div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;<span class="comment"></span><a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *WidenIV::WidenIVUse(NarrowIVDefUse DU, <a class="code" href="classllvm_1_1SCEVExpander.html">SCEVExpander</a> &amp;Rewriter) {</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;  <span class="comment">// Stop traversing the def-use chain at inner-loop phis or post-loop phis.</span></div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;  <span class="keywordflow">if</span> (isa&lt;PHINode&gt;(DU.NarrowUse) &amp;&amp;</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;      LI-&gt;<a class="code" href="classllvm_1_1LoopInfo.html#a4abca289c73cd09487e05d11d9f7d877">getLoopFor</a>(DU.NarrowUse-&gt;getParent()) != L)</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;  <span class="comment">// Our raison d&#39;etre! Eliminate sign and zero extension.</span></div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;  <span class="keywordflow">if</span> (IsSigned ? isa&lt;SExtInst&gt;(DU.NarrowUse) : isa&lt;ZExtInst&gt;(DU.NarrowUse)) {</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *NewDef = DU.WideDef;</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;    <span class="keywordflow">if</span> (DU.NarrowUse-&gt;getType() != WideType) {</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;      <span class="keywordtype">unsigned</span> CastWidth = SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a983dbdce6af7840357ed33a20c8f30bb">getTypeSizeInBits</a>(DU.NarrowUse-&gt;getType());</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;      <span class="keywordtype">unsigned</span> IVWidth = SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a983dbdce6af7840357ed33a20c8f30bb">getTypeSizeInBits</a>(WideType);</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;      <span class="keywordflow">if</span> (CastWidth &lt; IVWidth) {</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;        <span class="comment">// The cast isn&#39;t as wide as the IV, so insert a Trunc.</span></div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;        <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> Builder(DU.NarrowUse);</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;        NewDef = Builder.<a class="code" href="classllvm_1_1IRBuilder.html#aa933549689e79685bb67de64dddc9f7c">CreateTrunc</a>(DU.WideDef, DU.NarrowUse-&gt;getType());</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;      }</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;      <span class="keywordflow">else</span> {</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;        <span class="comment">// A wider extend was hidden behind a narrower one. This may induce</span></div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;        <span class="comment">// another round of IV widening in which the intermediate IV becomes</span></div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;        <span class="comment">// dead. It should be very rare.</span></div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;        <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;INDVARS: New IV &quot;</span> &lt;&lt; *WidePhi</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;              &lt;&lt; <span class="stringliteral">&quot; not wide enough to subsume &quot;</span> &lt;&lt; *DU.NarrowUse &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;        DU.NarrowUse-&gt;replaceUsesOfWith(DU.NarrowDef, DU.WideDef);</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;        NewDef = DU.NarrowUse;</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;      }</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;    }</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;    <span class="keywordflow">if</span> (NewDef != DU.NarrowUse) {</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;      <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;INDVARS: eliminating &quot;</span> &lt;&lt; *DU.NarrowUse</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;            &lt;&lt; <span class="stringliteral">&quot; replaced by &quot;</span> &lt;&lt; *DU.WideDef &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;      ++NumElimExt;</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;      DU.NarrowUse-&gt;replaceAllUsesWith(NewDef);</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;      DeadInsts.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(DU.NarrowUse);</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;    }</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;    <span class="comment">// Now that the extend is gone, we want to expose it&#39;s uses for potential</span></div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;    <span class="comment">// further simplification. We don&#39;t need to directly inform SimplifyIVUsers</span></div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;    <span class="comment">// of the new users, because their parent IV will be processed later as a</span></div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;    <span class="comment">// new loop phi. If we preserved IVUsers analysis, we would also want to</span></div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;    <span class="comment">// push the uses of WideDef here.</span></div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;    <span class="comment">// No further widening is needed. The deceased [sz]ext had done it for us.</span></div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;  }</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;  <span class="comment">// Does this user itself evaluate to a recurrence after widening?</span></div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEVAddRecExpr.html">SCEVAddRecExpr</a> *WideAddRec = GetWideRecurrence(DU.NarrowUse);</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;  <span class="keywordflow">if</span> (!WideAddRec) {</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;      WideAddRec = GetExtendedOperandRecurrence(DU);</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;  }</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;  <span class="keywordflow">if</span> (!WideAddRec) {</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;    <span class="comment">// This user does not evaluate to a recurence after widening, so don&#39;t</span></div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;    <span class="comment">// follow it. Instead insert a Trunc to kill off the original use,</span></div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;    <span class="comment">// eventually isolating the original narrow IV so it can be removed.</span></div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;    <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> Builder(<a class="code" href="IndVarSimplify_8cpp.html#a2831ebb1b1d686d2841c7bb2aeed5ade">getInsertPointForUses</a>(DU.NarrowUse, DU.NarrowDef, DT));</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *Trunc = Builder.<a class="code" href="classllvm_1_1IRBuilder.html#aa933549689e79685bb67de64dddc9f7c">CreateTrunc</a>(DU.WideDef, DU.NarrowDef-&gt;getType());</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;    DU.NarrowUse-&gt;replaceUsesOfWith(DU.NarrowDef, Trunc);</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;  }</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;  <span class="comment">// Assume block terminators cannot evaluate to a recurrence. We can&#39;t to</span></div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;  <span class="comment">// insert a Trunc after a terminator if there happens to be a critical edge.</span></div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;  assert(DU.NarrowUse != DU.NarrowUse-&gt;getParent()-&gt;getTerminator() &amp;&amp;</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;         <span class="stringliteral">&quot;SCEV is not expected to evaluate a block terminator&quot;</span>);</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;  <span class="comment">// Reuse the IV increment that SCEVExpander created as long as it dominates</span></div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;  <span class="comment">// NarrowUse.</span></div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *WideUse = 0;</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;  <span class="keywordflow">if</span> (WideAddRec == WideIncExpr</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;      &amp;&amp; Rewriter.<a class="code" href="classllvm_1_1SCEVExpander.html#a9093ff54a20ae387e9643cc4ed615214">hoistIVInc</a>(WideInc, DU.NarrowUse))</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;    WideUse = WideInc;</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;  <span class="keywordflow">else</span> {</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;    WideUse = CloneIVUser(DU);</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;    <span class="keywordflow">if</span> (!WideUse)</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;  }</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;  <span class="comment">// Evaluation of WideAddRec ensured that the narrow expression could be</span></div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;  <span class="comment">// extended outside the loop without overflow. This suggests that the wide use</span></div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;  <span class="comment">// evaluates to the same expression as the extended narrow use, but doesn&#39;t</span></div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;  <span class="comment">// absolutely guarantee it. Hence the following failsafe check. In rare cases</span></div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;  <span class="comment">// where it fails, we simply throw away the newly created wide use.</span></div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;  <span class="keywordflow">if</span> (WideAddRec != SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a30bd18ac905eacf3601bc6a553a9ff49">getSCEV</a>(WideUse)) {</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;    <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Wide use expression mismatch: &quot;</span> &lt;&lt; *WideUse</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;: &quot;</span> &lt;&lt; *SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a30bd18ac905eacf3601bc6a553a9ff49">getSCEV</a>(WideUse) &lt;&lt; <span class="stringliteral">&quot; != &quot;</span> &lt;&lt; *WideAddRec &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;    DeadInsts.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(WideUse);</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;  }</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;  <span class="comment">// Returning WideUse pushes it on the worklist.</span></div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;  <span class="keywordflow">return</span> WideUse;</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;}</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;<span class="comment">/// pushNarrowIVUsers - Add eligible users of NarrowDef to NarrowIVUsers.</span></div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;<span class="comment"></span><span class="keywordtype">void</span> WidenIV::pushNarrowIVUsers(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *NarrowDef, <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *WideDef) {</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1value__use__iterator.html">Value::use_iterator</a> UI = NarrowDef-&gt;<a class="code" href="classllvm_1_1Value.html#a413abcab8dbc3900fc2fde96a5d8fca6">use_begin</a>(),</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;         UE = NarrowDef-&gt;<a class="code" href="classllvm_1_1Value.html#ad86469939d2a8bdd4169be9403b89f5a">use_end</a>(); UI != UE; ++UI) {</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *NarrowUse = cast&lt;Instruction&gt;(*UI);</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;    <span class="comment">// Handle data flow merges and bizarre phi cycles.</span></div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;    <span class="keywordflow">if</span> (!Widened.insert(NarrowUse))</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;    NarrowIVUsers.push_back(NarrowIVDefUse(NarrowDef, NarrowUse, WideDef));</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;  }</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;}</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;<span class="comment">/// CreateWideIV - Process a single induction variable. First use the</span></div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;<span class="comment">/// SCEVExpander to create a wide induction variable that evaluates to the same</span></div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;<span class="comment">/// recurrence as the original narrow IV. Then use a worklist to forward</span></div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;<span class="comment">/// traverse the narrow IV&#39;s def-use chain. After WidenIVUse has processed all</span></div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;<span class="comment">/// interesting IV users, the narrow IV will be isolated for removal by</span></div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;<span class="comment">/// DeleteDeadPHIs.</span></div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;<span class="comment">/// It would be simpler to delete uses as they are processed, but we must avoid</span></div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;<span class="comment">/// invalidating SCEV expressions.</span></div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;<span class="comment"></span><a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *WidenIV::CreateWideIV(<a class="code" href="classllvm_1_1SCEVExpander.html">SCEVExpander</a> &amp;Rewriter) {</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;  <span class="comment">// Is this phi an induction variable?</span></div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEVAddRecExpr.html">SCEVAddRecExpr</a> *AddRec = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1SCEVAddRecExpr.html">SCEVAddRecExpr</a>&gt;(SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a30bd18ac905eacf3601bc6a553a9ff49">getSCEV</a>(OrigPhi));</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;  <span class="keywordflow">if</span> (!AddRec)</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;    <span class="keywordflow">return</span> NULL;</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;  <span class="comment">// Widen the induction variable expression.</span></div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *WideIVExpr = IsSigned ?</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;    SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a63d4f693eb205bb9d556e067464f943c">getSignExtendExpr</a>(AddRec, WideType) :</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;    SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#abfa1a24cb47fd5fedbc7109b905741a3">getZeroExtendExpr</a>(AddRec, WideType);</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;  assert(SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#abb976145b00ae108c1d6b98c4f099d27">getEffectiveSCEVType</a>(WideIVExpr-&gt;<a class="code" href="classllvm_1_1SCEV.html#a9a16f1241255a605fc8debc1e26eaa4c">getType</a>()) == WideType &amp;&amp;</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;         <span class="stringliteral">&quot;Expect the new IV expression to preserve its type&quot;</span>);</div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;  <span class="comment">// Can the IV be extended outside the loop without overflow?</span></div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;  AddRec = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1SCEVAddRecExpr.html">SCEVAddRecExpr</a>&gt;(WideIVExpr);</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;  <span class="keywordflow">if</span> (!AddRec || AddRec-&gt;<a class="code" href="classllvm_1_1SCEVAddRecExpr.html#a7fcbbc51eef313e675a2442bb2053ae9">getLoop</a>() != L)</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;    <span class="keywordflow">return</span> NULL;</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;  <span class="comment">// An AddRec must have loop-invariant operands. Since this AddRec is</span></div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;  <span class="comment">// materialized by a loop header phi, the expression cannot have any post-loop</span></div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;  <span class="comment">// operands, so they must dominate the loop header.</span></div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;  assert(SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#ae0d036af111b8aafe90db0771b8e9ce3">properlyDominates</a>(AddRec-&gt;<a class="code" href="classllvm_1_1SCEVAddRecExpr.html#a0d53a749bd858b270d322b34b8d7e1e5">getStart</a>(), L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#ac4f141a355e5898255f2cbc57c5b54c3">getHeader</a>()) &amp;&amp;</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;         SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#ae0d036af111b8aafe90db0771b8e9ce3">properlyDominates</a>(AddRec-&gt;<a class="code" href="classllvm_1_1SCEVAddRecExpr.html#a443e9130cd9f3e3baaa1b566e6aa5060">getStepRecurrence</a>(*SE), L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#ac4f141a355e5898255f2cbc57c5b54c3">getHeader</a>())</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;         &amp;&amp; <span class="stringliteral">&quot;Loop header phi recurrence inputs do not dominate the loop&quot;</span>);</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;  <span class="comment">// The rewriter provides a value for the desired IV expression. This may</span></div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;  <span class="comment">// either find an existing phi or materialize a new one. Either way, we</span></div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;  <span class="comment">// expect a well-formed cyclic phi-with-increments. i.e. any operand not part</span></div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;  <span class="comment">// of the phi-SCC dominates the loop entry.</span></div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *InsertPt = L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#ac4f141a355e5898255f2cbc57c5b54c3">getHeader</a>()-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a0ed5f3ab3c2e4196ee0cffffa080c062">begin</a>();</div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;  WidePhi = cast&lt;PHINode&gt;(Rewriter.<a class="code" href="classllvm_1_1SCEVExpander.html#a583d3ca95f83216d632a4d1ae0330dd0">expandCodeFor</a>(AddRec, WideType, InsertPt));</div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;</div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;  <span class="comment">// Remembering the WideIV increment generated by SCEVExpander allows</span></div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;  <span class="comment">// WidenIVUse to reuse it when widening the narrow IV&#39;s increment. We don&#39;t</span></div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;  <span class="comment">// employ a general reuse mechanism because the call above is the only call to</span></div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;  <span class="comment">// SCEVExpander. Henceforth, we produce 1-to-1 narrow to wide uses.</span></div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *LatchBlock = L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a8917d359fc92f25eb0117386588c6f1c">getLoopLatch</a>()) {</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;    WideInc =</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;      cast&lt;Instruction&gt;(WidePhi-&gt;getIncomingValueForBlock(LatchBlock));</div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;    WideIncExpr = SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a30bd18ac905eacf3601bc6a553a9ff49">getSCEV</a>(WideInc);</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;  }</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;  <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Wide IV: &quot;</span> &lt;&lt; *WidePhi &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;  ++NumWidened;</div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;</div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;  <span class="comment">// Traverse the def-use chain using a worklist starting at the original IV.</span></div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;  assert(Widened.empty() &amp;&amp; NarrowIVUsers.empty() &amp;&amp; <span class="stringliteral">&quot;expect initial state&quot;</span> );</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;  Widened.insert(OrigPhi);</div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;  pushNarrowIVUsers(OrigPhi, WidePhi);</div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;</div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;  <span class="keywordflow">while</span> (!NarrowIVUsers.empty()) {</div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;    NarrowIVDefUse DU = NarrowIVUsers.pop_back_val();</div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;</div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;    <span class="comment">// Process a def-use edge. This may replace the use, so don&#39;t hold a</span></div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;    <span class="comment">// use_iterator across it.</span></div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *WideUse = WidenIVUse(DU, Rewriter);</div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;</div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;    <span class="comment">// Follow all def-use edges from the previous narrow use.</span></div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;    <span class="keywordflow">if</span> (WideUse)</div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;      pushNarrowIVUsers(DU.NarrowUse, WideUse);</div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;    <span class="comment">// WidenIVUse may have removed the def-use edge.</span></div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;    <span class="keywordflow">if</span> (DU.NarrowDef-&gt;use_empty())</div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;      DeadInsts.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(DU.NarrowDef);</div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;  }</div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;  <span class="keywordflow">return</span> WidePhi;</div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;}</div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;</div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;<span class="comment">//  Simplification of IV users based on SCEV evaluation.</span></div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;</div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;<span class="comment">/// SimplifyAndExtend - Iteratively perform simplification on a worklist of IV</span></div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;<span class="comment">/// users. Each successive simplification may push more users which may</span></div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;<span class="comment">/// themselves be candidates for simplification.</span></div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;<span class="comment">/// Sign/Zero extend elimination is interleaved with IV simplification.</span></div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;<span class="comment"></span><span class="keywordtype">void</span> IndVarSimplify::SimplifyAndExtend(<a class="code" href="classllvm_1_1Loop.html">Loop</a> *L,</div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;                                       <a class="code" href="classllvm_1_1SCEVExpander.html">SCEVExpander</a> &amp;Rewriter,</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;                                       <a class="code" href="classllvm_1_1LPPassManager.html">LPPassManager</a> &amp;LPM) {</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;WideIVInfo, 8&gt;</a> WideIVs;</div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;</div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;PHINode*, 8&gt;</a> LoopPhis;</div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1ilist__iterator.html">BasicBlock::iterator</a> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#ac4f141a355e5898255f2cbc57c5b54c3">getHeader</a>()-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a0ed5f3ab3c2e4196ee0cffffa080c062">begin</a>(); isa&lt;PHINode&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>); ++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;    LoopPhis.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(cast&lt;PHINode&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>));</div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;  }</div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;  <span class="comment">// Each round of simplification iterates through the SimplifyIVUsers worklist</span></div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;  <span class="comment">// for all current phis, then determines whether any IVs can be</span></div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;  <span class="comment">// widened. Widening adds new phis to LoopPhis, inducing another round of</span></div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;  <span class="comment">// simplification on the wide IVs.</span></div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;  <span class="keywordflow">while</span> (!LoopPhis.<a class="code" href="classllvm_1_1SmallVectorBase.html#a8a8df4d85555c7954a95f86080cd3b64">empty</a>()) {</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;    <span class="comment">// Evaluate as many IV expressions as possible before widening any IVs. This</span></div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;    <span class="comment">// forces SCEV to set no-wrap flags before evaluating sign/zero</span></div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;    <span class="comment">// extension. The first time SCEV attempts to normalize sign/zero extension,</span></div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;    <span class="comment">// the result becomes final. So for the most predictable results, we delay</span></div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;    <span class="comment">// evaluation of sign/zero extend evaluation until needed, and avoid running</span></div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;    <span class="comment">// other SCEV based analysis prior to SimplifyAndExtend.</span></div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;    <span class="keywordflow">do</span> {</div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;      <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *CurrIV = LoopPhis.<a class="code" href="classllvm_1_1SmallVectorImpl.html#a400eaca9881c8dcab97e9f42b1ab1815">pop_back_val</a>();</div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;</div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;      <span class="comment">// Information about sign/zero extensions of CurrIV.</span></div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;      WideIVVisitor WIV(CurrIV, SE, TD);</div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;</div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;      Changed |= <a class="code" href="namespacellvm.html#adead3a49058bc795978ec97b9c99e1a2">simplifyUsersOfIV</a>(CurrIV, SE, &amp;LPM, DeadInsts, &amp;WIV);</div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;</div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;      <span class="keywordflow">if</span> (WIV.WI.WidestNativeType) {</div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;        WideIVs.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(WIV.WI);</div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;      }</div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;    } <span class="keywordflow">while</span>(!LoopPhis.<a class="code" href="classllvm_1_1SmallVectorBase.html#a8a8df4d85555c7954a95f86080cd3b64">empty</a>());</div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;</div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;    <span class="keywordflow">for</span> (; !WideIVs.<a class="code" href="classllvm_1_1SmallVectorBase.html#a8a8df4d85555c7954a95f86080cd3b64">empty</a>(); WideIVs.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#a1f2303df9bbee2233c11d61c2f6f7930">pop_back</a>()) {</div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;      WidenIV Widener(WideIVs.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#acd9e771a3296c6b24146955754620557">back</a>(), LI, SE, DT, DeadInsts);</div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *WidePhi = Widener.CreateWideIV(Rewriter)) {</div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;        Changed = <span class="keyword">true</span>;</div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;        LoopPhis.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(WidePhi);</div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;      }</div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;    }</div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;  }</div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;}</div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;</div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;<span class="comment">//  LinearFunctionTestReplace and its kin. Rewrite the loop exit condition.</span></div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;<span class="comment">/// Check for expressions that ScalarEvolution generates to compute</span></div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;<span class="comment">/// BackedgeTakenInfo. If these expressions have not been reduced, then</span></div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;<span class="comment">/// expanding them may incur additional cost (albeit in the loop preheader).</span></div><div class="line"><a name="l01143"></a><span class="lineno"><a class="line" href="IndVarSimplify_8cpp.html#afd69f4b50f751466f1a674b2cf6078c5"> 1143</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="IndVarSimplify_8cpp.html#afd69f4b50f751466f1a674b2cf6078c5">isHighCostExpansion</a>(<span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *<a class="code" href="Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>, <a class="code" href="classllvm_1_1BranchInst.html">BranchInst</a> *BI,</div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;                                <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;const SCEV*, 8&gt;</a> &amp;Processed,</div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;                                <a class="code" href="classllvm_1_1ScalarEvolution.html">ScalarEvolution</a> *SE) {</div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;  <span class="keywordflow">if</span> (!Processed.<a class="code" href="classllvm_1_1SmallPtrSet.html#a9b6dd0fc7a648a939e571246045b673e">insert</a>(S))</div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;</div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;  <span class="comment">// If the backedge-taken count is a UDiv, it&#39;s very likely a UDiv that</span></div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;  <span class="comment">// ScalarEvolution&#39;s HowFarToZero or HowManyLessThans produced to compute a</span></div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;  <span class="comment">// precise expression, rather than a UDiv from the user&#39;s code. If we can&#39;t</span></div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;  <span class="comment">// find a UDiv in the code with some simple searching, assume the former and</span></div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;  <span class="comment">// forego rewriting the loop.</span></div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;  <span class="keywordflow">if</span> (isa&lt;SCEVUDivExpr&gt;(S)) {</div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;    <a class="code" href="classllvm_1_1ICmpInst.html">ICmpInst</a> *OrigCond = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ICmpInst.html">ICmpInst</a>&gt;(BI-&gt;<a class="code" href="classllvm_1_1BranchInst.html#a84309bb8c34c8bc5694ec5d48dd8668f">getCondition</a>());</div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;    <span class="keywordflow">if</span> (!OrigCond) <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *R = SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a30bd18ac905eacf3601bc6a553a9ff49">getSCEV</a>(OrigCond-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(1));</div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;    R = SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#aa888e3661c809163273aca85ded4d846">getMinusSCEV</a>(R, SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a2eb94d079d8416118f4aaed865ab05d7">getConstant</a>(R-&gt;<a class="code" href="classllvm_1_1SCEV.html#a9a16f1241255a605fc8debc1e26eaa4c">getType</a>(), 1));</div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;    <span class="keywordflow">if</span> (R != S) {</div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;      <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *L = SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a30bd18ac905eacf3601bc6a553a9ff49">getSCEV</a>(OrigCond-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0));</div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;      L = SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#aa888e3661c809163273aca85ded4d846">getMinusSCEV</a>(L, SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a2eb94d079d8416118f4aaed865ab05d7">getConstant</a>(L-&gt;<a class="code" href="classllvm_1_1SCEV.html#a9a16f1241255a605fc8debc1e26eaa4c">getType</a>(), 1));</div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;      <span class="keywordflow">if</span> (L != S)</div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;    }</div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;  }</div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;</div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;  <span class="comment">// Recurse past add expressions, which commonly occur in the</span></div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;  <span class="comment">// BackedgeTakenCount. They may already exist in program code, and if not,</span></div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;  <span class="comment">// they are not too expensive rematerialize.</span></div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEVAddExpr.html">SCEVAddExpr</a> *Add = dyn_cast&lt;SCEVAddExpr&gt;(S)) {</div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1SCEVNAryExpr.html#a82ad83d40ce0e57efef84b421c7f805a">SCEVAddExpr::op_iterator</a> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = Add-&gt;op_begin(), E = Add-&gt;op_end();</div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;         <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> != E; ++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="IndVarSimplify_8cpp.html#afd69f4b50f751466f1a674b2cf6078c5">isHighCostExpansion</a>(*<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, BI, Processed, SE))</div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;    }</div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;  }</div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;</div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;  <span class="comment">// HowManyLessThans uses a Max expression whenever the loop is not guarded by</span></div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;  <span class="comment">// the exit condition.</span></div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;  <span class="keywordflow">if</span> (isa&lt;SCEVSMaxExpr&gt;(S) || isa&lt;SCEVUMaxExpr&gt;(<a class="code" href="Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>))</div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;</div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;  <span class="comment">// If we haven&#39;t recognized an expensive SCEV pattern, assume it&#39;s an</span></div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;  <span class="comment">// expression produced by program code.</span></div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;}</div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;<span class="comment">/// canExpandBackedgeTakenCount - Return true if this loop&#39;s backedge taken</span></div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;<span class="comment">/// count expression can be safely and cheaply expanded into an instruction</span></div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;<span class="comment">/// sequence that can be used by LinearFunctionTestReplace.</span></div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;<span class="comment">/// TODO: This fails for pointer-type loop counters with greater than one byte</span></div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;<span class="comment">/// strides, consequently preventing LFTR from running. For the purpose of LFTR</span></div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;<span class="comment">/// we could skip this check in the case that the LFTR loop counter (chosen by</span></div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;<span class="comment">/// FindLoopCounter) is also pointer type. Instead, we could directly convert</span></div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;<span class="comment">/// the loop test to an inequality test by checking the target data&#39;s alignment</span></div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;<span class="comment">/// of element types (given that the initial pointer value originates from or is</span></div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;<span class="comment">/// used by ABI constrained operation, as opposed to inttoptr/ptrtoint).</span></div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;<span class="comment">/// However, we don&#39;t yet have a strong motivation for converting loop tests</span></div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;<span class="comment">/// into inequality tests.</span></div><div class="line"><a name="l01202"></a><span class="lineno"><a class="line" href="IndVarSimplify_8cpp.html#a06d60699222d90683b12445041df2872"> 1202</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="IndVarSimplify_8cpp.html#a06d60699222d90683b12445041df2872">canExpandBackedgeTakenCount</a>(<a class="code" href="classllvm_1_1Loop.html">Loop</a> *L, <a class="code" href="classllvm_1_1ScalarEvolution.html">ScalarEvolution</a> *SE) {</div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *BackedgeTakenCount = SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#aecd7aba4460358813feef37d71d5024e">getBackedgeTakenCount</a>(L);</div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;  <span class="keywordflow">if</span> (isa&lt;SCEVCouldNotCompute&gt;(BackedgeTakenCount) ||</div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;      BackedgeTakenCount-&gt;<a class="code" href="classllvm_1_1SCEV.html#a3f76d2fd4788225548dc36ef9e417030">isZero</a>())</div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;</div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;  <span class="keywordflow">if</span> (!L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#acaec68a759bb05d3be2ed7dd47e25171">getExitingBlock</a>())</div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;</div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;  <span class="comment">// Can&#39;t rewrite non-branch yet.</span></div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;  <a class="code" href="classllvm_1_1BranchInst.html">BranchInst</a> *BI = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1BranchInst.html">BranchInst</a>&gt;(L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#acaec68a759bb05d3be2ed7dd47e25171">getExitingBlock</a>()-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a5cb76a65b6524dba1493dd2b9dc3abbe">getTerminator</a>());</div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;  <span class="keywordflow">if</span> (!BI)</div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;</div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;  <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;const SCEV*, 8&gt;</a> Processed;</div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="IndVarSimplify_8cpp.html#afd69f4b50f751466f1a674b2cf6078c5">isHighCostExpansion</a>(BackedgeTakenCount, BI, Processed, SE))</div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;</div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;}</div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;<span class="comment">/// getLoopPhiForCounter - Return the loop header phi IFF IncV adds a loop</span></div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;<span class="comment">/// invariant value to the phi.</span></div><div class="line"><a name="l01225"></a><span class="lineno"><a class="line" href="IndVarSimplify_8cpp.html#abfd6c95e6ba0f368e0745c65bfe5b6ed"> 1225</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *<a class="code" href="IndVarSimplify_8cpp.html#abfd6c95e6ba0f368e0745c65bfe5b6ed">getLoopPhiForCounter</a>(<a class="code" href="classllvm_1_1Value.html">Value</a> *IncV, <a class="code" href="classllvm_1_1Loop.html">Loop</a> *L, <a class="code" href="classllvm_1_1DominatorTree.html">DominatorTree</a> *DT) {</div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *IncI = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1Instruction.html">Instruction</a>&gt;(IncV);</div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;  <span class="keywordflow">if</span> (!IncI)</div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;</div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;  <span class="keywordflow">switch</span> (IncI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a021bb7c9aad6003fe8089f6327356c6c">getOpcode</a>()) {</div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;  <span class="keywordflow">case</span> Instruction::Add:</div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;  <span class="keywordflow">case</span> Instruction::Sub:</div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;  <span class="keywordflow">case</span> Instruction::GetElementPtr:</div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;    <span class="comment">// An IV counter must preserve its type.</span></div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;    <span class="keywordflow">if</span> (IncI-&gt;<a class="code" href="classllvm_1_1User.html#a2f81e0c1fc6554df7ad2eafabf5fc5a5">getNumOperands</a>() == 2)</div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;  <span class="keywordflow">default</span>:</div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;  }</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;</div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;  <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *Phi = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1PHINode.html">PHINode</a>&gt;(IncI-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0));</div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;  <span class="keywordflow">if</span> (Phi &amp;&amp; Phi-&gt;<a class="code" href="classllvm_1_1Instruction.html#a9cd49851904f15060edb782ef4dd1b2d">getParent</a>() == L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#ac4f141a355e5898255f2cbc57c5b54c3">getHeader</a>()) {</div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="IndVarSimplify_8cpp.html#afcaa9ef0e14174b7e78a1ba5e83093d7">isLoopInvariant</a>(IncI-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(1), L, DT))</div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;      <span class="keywordflow">return</span> Phi;</div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;  }</div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;  <span class="keywordflow">if</span> (IncI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a021bb7c9aad6003fe8089f6327356c6c">getOpcode</a>() == Instruction::GetElementPtr)</div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;</div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;  <span class="comment">// Allow add/sub to be commuted.</span></div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;  Phi = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1PHINode.html">PHINode</a>&gt;(IncI-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(1));</div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;  <span class="keywordflow">if</span> (Phi &amp;&amp; Phi-&gt;<a class="code" href="classllvm_1_1Instruction.html#a9cd49851904f15060edb782ef4dd1b2d">getParent</a>() == L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#ac4f141a355e5898255f2cbc57c5b54c3">getHeader</a>()) {</div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="IndVarSimplify_8cpp.html#afcaa9ef0e14174b7e78a1ba5e83093d7">isLoopInvariant</a>(IncI-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0), L, DT))</div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;      <span class="keywordflow">return</span> Phi;</div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;  }</div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;}</div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;<span class="comment">/// Return the compare guarding the loop latch, or NULL for unrecognized tests.</span></div><div class="line"><a name="l01261"></a><span class="lineno"><a class="line" href="IndVarSimplify_8cpp.html#a8f8c8177d7d5249583164b7f01ce379c"> 1261</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <a class="code" href="classllvm_1_1ICmpInst.html">ICmpInst</a> *<a class="code" href="IndVarSimplify_8cpp.html#a8f8c8177d7d5249583164b7f01ce379c">getLoopTest</a>(<a class="code" href="classllvm_1_1Loop.html">Loop</a> *L) {</div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;  assert(L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#acaec68a759bb05d3be2ed7dd47e25171">getExitingBlock</a>() &amp;&amp; <span class="stringliteral">&quot;expected loop exit&quot;</span>);</div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;</div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *LatchBlock = L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a8917d359fc92f25eb0117386588c6f1c">getLoopLatch</a>();</div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;  <span class="comment">// Don&#39;t bother with LFTR if the loop is not properly simplified.</span></div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;  <span class="keywordflow">if</span> (!LatchBlock)</div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;</div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;  <a class="code" href="classllvm_1_1BranchInst.html">BranchInst</a> *BI = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1BranchInst.html">BranchInst</a>&gt;(L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#acaec68a759bb05d3be2ed7dd47e25171">getExitingBlock</a>()-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a5cb76a65b6524dba1493dd2b9dc3abbe">getTerminator</a>());</div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;  assert(BI &amp;&amp; <span class="stringliteral">&quot;expected exit branch&quot;</span>);</div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;</div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ICmpInst.html">ICmpInst</a>&gt;(BI-&gt;<a class="code" href="classllvm_1_1BranchInst.html#a84309bb8c34c8bc5694ec5d48dd8668f">getCondition</a>());</div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;}</div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;<span class="comment">/// needsLFTR - LinearFunctionTestReplace policy. Return true unless we can show</span></div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;<span class="comment">/// that the current exit test is already sufficiently canonical.</span></div><div class="line"><a name="l01277"></a><span class="lineno"><a class="line" href="IndVarSimplify_8cpp.html#a5a24a27c50a6c4bc285bef2de8a5e908"> 1277</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="IndVarSimplify_8cpp.html#a5a24a27c50a6c4bc285bef2de8a5e908">needsLFTR</a>(<a class="code" href="classllvm_1_1Loop.html">Loop</a> *L, <a class="code" href="classllvm_1_1DominatorTree.html">DominatorTree</a> *DT) {</div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;  <span class="comment">// Do LFTR to simplify the exit condition to an ICMP.</span></div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;  <a class="code" href="classllvm_1_1ICmpInst.html">ICmpInst</a> *Cond = <a class="code" href="IndVarSimplify_8cpp.html#a8f8c8177d7d5249583164b7f01ce379c">getLoopTest</a>(L);</div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;  <span class="keywordflow">if</span> (!Cond)</div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;</div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;  <span class="comment">// Do LFTR to simplify the exit ICMP to EQ/NE</span></div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;  <a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05">ICmpInst::Predicate</a> Pred = Cond-&gt;<a class="code" href="classllvm_1_1CmpInst.html#a8afd4995fae596b2c86eeed85b3d388b">getPredicate</a>();</div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;  <span class="keywordflow">if</span> (Pred != <a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05ac17897ebf2f6a6986280fc3bdf28a30a">ICmpInst::ICMP_NE</a> &amp;&amp; Pred != <a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05aa719225e2de4059f93fd3209e1f48218">ICmpInst::ICMP_EQ</a>)</div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;</div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;  <span class="comment">// Look for a loop invariant RHS</span></div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *LHS = Cond-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0);</div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *RHS = Cond-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(1);</div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="IndVarSimplify_8cpp.html#afcaa9ef0e14174b7e78a1ba5e83093d7">isLoopInvariant</a>(RHS, L, DT)) {</div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="IndVarSimplify_8cpp.html#afcaa9ef0e14174b7e78a1ba5e83093d7">isLoopInvariant</a>(LHS, L, DT))</div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;    <a class="code" href="namespacestd.html#ab8424022895aee3e366fb9a32f2883cb">std::swap</a>(LHS, RHS);</div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;  }</div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;  <span class="comment">// Look for a simple IV counter LHS</span></div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;  <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *Phi = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1PHINode.html">PHINode</a>&gt;(LHS);</div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;  <span class="keywordflow">if</span> (!Phi)</div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;    Phi = <a class="code" href="IndVarSimplify_8cpp.html#abfd6c95e6ba0f368e0745c65bfe5b6ed">getLoopPhiForCounter</a>(LHS, L, DT);</div><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;</div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;  <span class="keywordflow">if</span> (!Phi)</div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;</div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;  <span class="comment">// Do LFTR if PHI node is defined in the loop, but is *not* a counter.</span></div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;  <span class="keywordtype">int</span> Idx = Phi-&gt;<a class="code" href="classllvm_1_1PHINode.html#a5c2b7d7f19aac93b27b845858a7eb73e">getBasicBlockIndex</a>(L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a8917d359fc92f25eb0117386588c6f1c">getLoopLatch</a>());</div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;  <span class="keywordflow">if</span> (Idx &lt; 0)</div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;</div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;  <span class="comment">// Do LFTR if the exit condition&#39;s IV is *not* a simple counter.</span></div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *IncV = Phi-&gt;<a class="code" href="classllvm_1_1PHINode.html#aba6a4cc4ed6d6fef3664b8d65ef04820">getIncomingValue</a>(Idx);</div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;  <span class="keywordflow">return</span> Phi != <a class="code" href="IndVarSimplify_8cpp.html#abfd6c95e6ba0f368e0745c65bfe5b6ed">getLoopPhiForCounter</a>(IncV, L, DT);</div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;}</div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;<span class="comment">/// Recursive helper for hasConcreteDef(). Unfortunately, this currently boils</span></div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;<span class="comment">/// down to checking that all operands are constant and listing instructions</span></div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;<span class="comment">/// that may hide undef.</span></div><div class="line"><a name="l01317"></a><span class="lineno"><a class="line" href="IndVarSimplify_8cpp.html#a27572260ed728be1d7fc7ce1659ea2f6"> 1317</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="IndVarSimplify_8cpp.html#a27572260ed728be1d7fc7ce1659ea2f6">hasConcreteDefImpl</a>(<a class="code" href="classllvm_1_1Value.html">Value</a> *V, <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;Value*, 8&gt;</a> &amp;Visited,</div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;                               <span class="keywordtype">unsigned</span> Depth) {</div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;  <span class="keywordflow">if</span> (isa&lt;Constant&gt;(V))</div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;    <span class="keywordflow">return</span> !isa&lt;UndefValue&gt;(V);</div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;</div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;  <span class="keywordflow">if</span> (Depth &gt;= 6)</div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;</div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;  <span class="comment">// Conservatively handle non-constant non-instructions. For example, Arguments</span></div><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;  <span class="comment">// may be undef.</span></div><div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1Instruction.html">Instruction</a>&gt;(V);</div><div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;  <span class="keywordflow">if</span> (!I)</div><div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;</div><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;  <span class="comment">// Load and return values may be undef.</span></div><div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;  <span class="keywordflow">if</span>(I-&gt;<a class="code" href="classllvm_1_1Instruction.html#a0fd8d3c26bf5cd614b0e6a9b8886a5d0">mayReadFromMemory</a>() || isa&lt;CallInst&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) || isa&lt;InvokeInst&gt;(I))</div><div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;</div><div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;  <span class="comment">// Optimistically handle other instructions.</span></div><div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Use.html">User::op_iterator</a> OI = I-&gt;<a class="code" href="classllvm_1_1User.html#a2eeb1c7ed1cfe403f2ae0470e36c07e2">op_begin</a>(), E = I-&gt;<a class="code" href="classllvm_1_1User.html#af41f58e730804d10b91fcff39b035f74">op_end</a>(); OI != E; ++OI) {</div><div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;    <span class="keywordflow">if</span> (!Visited.<a class="code" href="classllvm_1_1SmallPtrSet.html#a9b6dd0fc7a648a939e571246045b673e">insert</a>(*OI))</div><div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="IndVarSimplify_8cpp.html#a27572260ed728be1d7fc7ce1659ea2f6">hasConcreteDefImpl</a>(*OI, Visited, Depth+1))</div><div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;  }</div><div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;}</div><div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;<span class="comment">/// Return true if the given value is concrete. We must prove that undef can</span></div><div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;<span class="comment">/// never reach it.</span></div><div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;<span class="comment">/// TODO: If we decide that this is a good approach to checking for undef, we</span></div><div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;<span class="comment">/// may factor it into a common location.</span></div><div class="line"><a name="l01350"></a><span class="lineno"><a class="line" href="IndVarSimplify_8cpp.html#a9cc6c5ed9edaa15e526e2a5ad24d1413"> 1350</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="IndVarSimplify_8cpp.html#a9cc6c5ed9edaa15e526e2a5ad24d1413">hasConcreteDef</a>(<a class="code" href="classllvm_1_1Value.html">Value</a> *V) {</div><div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;  <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;Value*, 8&gt;</a> Visited;</div><div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;  Visited.<a class="code" href="classllvm_1_1SmallPtrSet.html#a9b6dd0fc7a648a939e571246045b673e">insert</a>(V);</div><div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="IndVarSimplify_8cpp.html#a27572260ed728be1d7fc7ce1659ea2f6">hasConcreteDefImpl</a>(V, Visited, 0);</div><div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;}</div><div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;<span class="comment">/// AlmostDeadIV - Return true if this IV has any uses other than the (soon to</span></div><div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;<span class="comment">/// be rewritten) loop exit test.</span></div><div class="line"><a name="l01358"></a><span class="lineno"><a class="line" href="IndVarSimplify_8cpp.html#a861b0a771b2125e6e9affb1b6f7a2003"> 1358</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="IndVarSimplify_8cpp.html#a861b0a771b2125e6e9affb1b6f7a2003">AlmostDeadIV</a>(<a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *Phi, <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *LatchBlock, <a class="code" href="classllvm_1_1Value.html">Value</a> *Cond) {</div><div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;  <span class="keywordtype">int</span> LatchIdx = Phi-&gt;<a class="code" href="classllvm_1_1PHINode.html#a5c2b7d7f19aac93b27b845858a7eb73e">getBasicBlockIndex</a>(LatchBlock);</div><div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *IncV = Phi-&gt;<a class="code" href="classllvm_1_1PHINode.html#aba6a4cc4ed6d6fef3664b8d65ef04820">getIncomingValue</a>(LatchIdx);</div><div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;</div><div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1value__use__iterator.html">Value::use_iterator</a> UI = Phi-&gt;<a class="code" href="classllvm_1_1Value.html#a413abcab8dbc3900fc2fde96a5d8fca6">use_begin</a>(), UE = Phi-&gt;<a class="code" href="classllvm_1_1Value.html#ad86469939d2a8bdd4169be9403b89f5a">use_end</a>();</div><div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;       UI != UE; ++UI) {</div><div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;    <span class="keywordflow">if</span> (*UI != Cond &amp;&amp; *UI != IncV) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;  }</div><div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;</div><div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1value__use__iterator.html">Value::use_iterator</a> UI = IncV-&gt;<a class="code" href="classllvm_1_1Value.html#a413abcab8dbc3900fc2fde96a5d8fca6">use_begin</a>(), UE = IncV-&gt;<a class="code" href="classllvm_1_1Value.html#ad86469939d2a8bdd4169be9403b89f5a">use_end</a>();</div><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;       UI != UE; ++UI) {</div><div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;    <span class="keywordflow">if</span> (*UI != Cond &amp;&amp; *UI != Phi) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;  }</div><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;}</div><div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;<span class="comment">/// FindLoopCounter - Find an affine IV in canonical form.</span></div><div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;<span class="comment">/// BECount may be an i8* pointer type. The pointer difference is already</span></div><div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;<span class="comment">/// valid count without scaling the address stride, so it remains a pointer</span></div><div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;<span class="comment">/// expression as far as SCEV is concerned.</span></div><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;<span class="comment">/// Currently only valid for LFTR. See the comments on hasConcreteDef below.</span></div><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;<span class="comment">/// FIXME: Accept -1 stride and set IVLimit = IVInit - BECount</span></div><div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;<span class="comment">/// FIXME: Accept non-unit stride as long as SCEV can reduce BECount * Stride.</span></div><div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;<span class="comment">/// This is difficult in general for SCEV because of potential overflow. But we</span></div><div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;<span class="comment">/// could at least handle constant BECounts.</span></div><div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;<span class="comment"></span><span class="keyword">static</span> <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *</div><div class="line"><a name="l01388"></a><span class="lineno"><a class="line" href="IndVarSimplify_8cpp.html#a0ba22bab67cca4eedc62b66da6f2bbdf"> 1388</a></span>&#160;<a class="code" href="IndVarSimplify_8cpp.html#a0ba22bab67cca4eedc62b66da6f2bbdf">FindLoopCounter</a>(<a class="code" href="classllvm_1_1Loop.html">Loop</a> *L, <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *BECount,</div><div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;                <a class="code" href="classllvm_1_1ScalarEvolution.html">ScalarEvolution</a> *SE, <a class="code" href="classllvm_1_1DominatorTree.html">DominatorTree</a> *DT, <span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> *TD) {</div><div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;  uint64_t BCWidth = SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a983dbdce6af7840357ed33a20c8f30bb">getTypeSizeInBits</a>(BECount-&gt;<a class="code" href="classllvm_1_1SCEV.html#a9a16f1241255a605fc8debc1e26eaa4c">getType</a>());</div><div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;</div><div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Cond =</div><div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;    cast&lt;BranchInst&gt;(L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#acaec68a759bb05d3be2ed7dd47e25171">getExitingBlock</a>()-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a5cb76a65b6524dba1493dd2b9dc3abbe">getTerminator</a>())-&gt;getCondition();</div><div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;</div><div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;  <span class="comment">// Loop over all of the PHI nodes, looking for a simple counter.</span></div><div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;  <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *BestPhi = 0;</div><div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *BestInit = 0;</div><div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *LatchBlock = L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a8917d359fc92f25eb0117386588c6f1c">getLoopLatch</a>();</div><div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;  assert(LatchBlock &amp;&amp; <span class="stringliteral">&quot;needsLFTR should guarantee a loop latch&quot;</span>);</div><div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;</div><div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1ilist__iterator.html">BasicBlock::iterator</a> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#ac4f141a355e5898255f2cbc57c5b54c3">getHeader</a>()-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a0ed5f3ab3c2e4196ee0cffffa080c062">begin</a>(); isa&lt;PHINode&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>); ++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div><div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;    <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *Phi = cast&lt;PHINode&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div><div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;    <span class="keywordflow">if</span> (!SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#ae9623974341419bfd1d185cfdc65bedd">isSCEVable</a>(Phi-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>()))</div><div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;</div><div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;    <span class="comment">// Avoid comparing an integer IV against a pointer Limit.</span></div><div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;    <span class="keywordflow">if</span> (BECount-&gt;<a class="code" href="classllvm_1_1SCEV.html#a9a16f1241255a605fc8debc1e26eaa4c">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a2eba483f5cc876e824aa6c085736086b">isPointerTy</a>() &amp;&amp; !Phi-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a2eba483f5cc876e824aa6c085736086b">isPointerTy</a>())</div><div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;</div><div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEVAddRecExpr.html">SCEVAddRecExpr</a> *AR = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1SCEVAddRecExpr.html">SCEVAddRecExpr</a>&gt;(SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a30bd18ac905eacf3601bc6a553a9ff49">getSCEV</a>(Phi));</div><div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;    <span class="keywordflow">if</span> (!AR || AR-&gt;<a class="code" href="classllvm_1_1SCEVAddRecExpr.html#a7fcbbc51eef313e675a2442bb2053ae9">getLoop</a>() != L || !AR-&gt;<a class="code" href="classllvm_1_1SCEVAddRecExpr.html#a88f514461ddb0af0fc59ac4639f644bc">isAffine</a>())</div><div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;</div><div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;    <span class="comment">// AR may be a pointer type, while BECount is an integer type.</span></div><div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;    <span class="comment">// AR may be wider than BECount. With eq/ne tests overflow is immaterial.</span></div><div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;    <span class="comment">// AR may not be a narrower type, or we may never exit.</span></div><div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;    uint64_t PhiWidth = SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a983dbdce6af7840357ed33a20c8f30bb">getTypeSizeInBits</a>(AR-&gt;<a class="code" href="classllvm_1_1SCEVNAryExpr.html#aed1b1d3b764c76210c67dd1b4a6be2f2">getType</a>());</div><div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;    <span class="keywordflow">if</span> (PhiWidth &lt; BCWidth || (TD &amp;&amp; !TD-&gt;<a class="code" href="classllvm_1_1DataLayout.html#a96f1e9abd65fef355bd8f15f9360c871">isLegalInteger</a>(PhiWidth)))</div><div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;</div><div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *Step = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1SCEVConstant.html">SCEVConstant</a>&gt;(AR-&gt;<a class="code" href="classllvm_1_1SCEVAddRecExpr.html#a443e9130cd9f3e3baaa1b566e6aa5060">getStepRecurrence</a>(*SE));</div><div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;    <span class="keywordflow">if</span> (!Step || !Step-&gt;<a class="code" href="classllvm_1_1SCEV.html#a3935a9de0ebdf3dc625cfb28e35bd009">isOne</a>())</div><div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;</div><div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;    <span class="keywordtype">int</span> LatchIdx = Phi-&gt;<a class="code" href="classllvm_1_1PHINode.html#a5c2b7d7f19aac93b27b845858a7eb73e">getBasicBlockIndex</a>(LatchBlock);</div><div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *IncV = Phi-&gt;<a class="code" href="classllvm_1_1PHINode.html#aba6a4cc4ed6d6fef3664b8d65ef04820">getIncomingValue</a>(LatchIdx);</div><div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="IndVarSimplify_8cpp.html#abfd6c95e6ba0f368e0745c65bfe5b6ed">getLoopPhiForCounter</a>(IncV, L, DT) != Phi)</div><div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;</div><div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;    <span class="comment">// Avoid reusing a potentially undef value to compute other values that may</span></div><div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;    <span class="comment">// have originally had a concrete definition.</span></div><div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="IndVarSimplify_8cpp.html#a9cc6c5ed9edaa15e526e2a5ad24d1413">hasConcreteDef</a>(Phi)) {</div><div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;      <span class="comment">// We explicitly allow unknown phis as long as they are already used by</span></div><div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;      <span class="comment">// the loop test. In this case we assume that performing LFTR could not</span></div><div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;      <span class="comment">// increase the number of undef users.</span></div><div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1ICmpInst.html">ICmpInst</a> *Cond = <a class="code" href="IndVarSimplify_8cpp.html#a8f8c8177d7d5249583164b7f01ce379c">getLoopTest</a>(L)) {</div><div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;        <span class="keywordflow">if</span> (Phi != <a class="code" href="IndVarSimplify_8cpp.html#abfd6c95e6ba0f368e0745c65bfe5b6ed">getLoopPhiForCounter</a>(Cond-&gt;getOperand(0), L, DT)</div><div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;            &amp;&amp; Phi != <a class="code" href="IndVarSimplify_8cpp.html#abfd6c95e6ba0f368e0745c65bfe5b6ed">getLoopPhiForCounter</a>(Cond-&gt;getOperand(1), L, DT)) {</div><div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;          <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;        }</div><div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;      }</div><div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;    }</div><div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *<a class="code" href="classllvm_1_1Init.html">Init</a> = AR-&gt;<a class="code" href="classllvm_1_1SCEVAddRecExpr.html#a0d53a749bd858b270d322b34b8d7e1e5">getStart</a>();</div><div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;</div><div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;    <span class="keywordflow">if</span> (BestPhi &amp;&amp; !<a class="code" href="IndVarSimplify_8cpp.html#a861b0a771b2125e6e9affb1b6f7a2003">AlmostDeadIV</a>(BestPhi, LatchBlock, Cond)) {</div><div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;      <span class="comment">// Don&#39;t force a live loop counter if another IV can be used.</span></div><div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="IndVarSimplify_8cpp.html#a861b0a771b2125e6e9affb1b6f7a2003">AlmostDeadIV</a>(Phi, LatchBlock, Cond))</div><div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;</div><div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;      <span class="comment">// Prefer to count-from-zero. This is a more &quot;canonical&quot; counter form. It</span></div><div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;      <span class="comment">// also prefers integer to pointer IVs.</span></div><div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;      <span class="keywordflow">if</span> (BestInit-&gt;<a class="code" href="classllvm_1_1SCEV.html#a3f76d2fd4788225548dc36ef9e417030">isZero</a>() != Init-&gt;<a class="code" href="classllvm_1_1SCEV.html#a3f76d2fd4788225548dc36ef9e417030">isZero</a>()) {</div><div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;        <span class="keywordflow">if</span> (BestInit-&gt;<a class="code" href="classllvm_1_1SCEV.html#a3f76d2fd4788225548dc36ef9e417030">isZero</a>())</div><div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;          <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;      }</div><div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;      <span class="comment">// If two IVs both count from zero or both count from nonzero then the</span></div><div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;      <span class="comment">// narrower is likely a dead phi that has been widened. Use the wider phi</span></div><div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;      <span class="comment">// to allow the other to be eliminated.</span></div><div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (PhiWidth &lt;= SE-&gt;getTypeSizeInBits(BestPhi-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>()))</div><div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;    }</div><div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;    BestPhi = Phi;</div><div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;    BestInit = Init;</div><div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;  }</div><div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;  <span class="keywordflow">return</span> BestPhi;</div><div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;}</div><div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;<span class="comment">/// genLoopLimit - Help LinearFunctionTestReplace by generating a value that</span></div><div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;<span class="comment">/// holds the RHS of the new loop test.</span></div><div class="line"><a name="l01470"></a><span class="lineno"><a class="line" href="IndVarSimplify_8cpp.html#adf86ad66e16c57783ecd95531fa505d0"> 1470</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="IndVarSimplify_8cpp.html#adf86ad66e16c57783ecd95531fa505d0">genLoopLimit</a>(<a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *IndVar, <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *IVCount, <a class="code" href="classllvm_1_1Loop.html">Loop</a> *L,</div><div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;                           <a class="code" href="classllvm_1_1SCEVExpander.html">SCEVExpander</a> &amp;Rewriter, <a class="code" href="classllvm_1_1ScalarEvolution.html">ScalarEvolution</a> *SE) {</div><div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEVAddRecExpr.html">SCEVAddRecExpr</a> *AR = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1SCEVAddRecExpr.html">SCEVAddRecExpr</a>&gt;(SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a30bd18ac905eacf3601bc6a553a9ff49">getSCEV</a>(IndVar));</div><div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;  assert(AR &amp;&amp; AR-&gt;<a class="code" href="classllvm_1_1SCEVAddRecExpr.html#a7fcbbc51eef313e675a2442bb2053ae9">getLoop</a>() == L &amp;&amp; AR-&gt;<a class="code" href="classllvm_1_1SCEVAddRecExpr.html#a88f514461ddb0af0fc59ac4639f644bc">isAffine</a>() &amp;&amp; <span class="stringliteral">&quot;bad loop counter&quot;</span>);</div><div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *IVInit = AR-&gt;<a class="code" href="classllvm_1_1SCEVAddRecExpr.html#a0d53a749bd858b270d322b34b8d7e1e5">getStart</a>();</div><div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;</div><div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;  <span class="comment">// IVInit may be a pointer while IVCount is an integer when FindLoopCounter</span></div><div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;  <span class="comment">// finds a valid pointer IV. Sign extend BECount in order to materialize a</span></div><div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;  <span class="comment">// GEP. Avoid running SCEVExpander on a new pointer value, instead reusing</span></div><div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;  <span class="comment">// the existing GEPs whenever possible.</span></div><div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;  <span class="keywordflow">if</span> (IndVar-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a2eba483f5cc876e824aa6c085736086b">isPointerTy</a>()</div><div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;      &amp;&amp; !IVCount-&gt;<a class="code" href="classllvm_1_1SCEV.html#a9a16f1241255a605fc8debc1e26eaa4c">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a2eba483f5cc876e824aa6c085736086b">isPointerTy</a>()) {</div><div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;</div><div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;    <span class="comment">// IVOffset will be the new GEP offset that is interpreted by GEP as a</span></div><div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;    <span class="comment">// signed value. IVCount on the other hand represents the loop trip count,</span></div><div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;    <span class="comment">// which is an unsigned value. FindLoopCounter only allows induction</span></div><div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;    <span class="comment">// variables that have a positive unit stride of one. This means we don&#39;t</span></div><div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;    <span class="comment">// have to handle the case of negative offsets (yet) and just need to zero</span></div><div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;    <span class="comment">// extend IVCount.</span></div><div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;    <a class="code" href="classllvm_1_1Type.html">Type</a> *OfsTy = SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#abb976145b00ae108c1d6b98c4f099d27">getEffectiveSCEVType</a>(IVInit-&gt;getType());</div><div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *IVOffset = SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a32dd2633bd4f1c5243c9704a30db22d8">getTruncateOrZeroExtend</a>(IVCount, OfsTy);</div><div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;</div><div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;    <span class="comment">// Expand the code for the iteration count.</span></div><div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;    assert(SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a5a19768af81df7e5fe571bc08dcd48b3">isLoopInvariant</a>(IVOffset, L) &amp;&amp;</div><div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;           <span class="stringliteral">&quot;Computed iteration count is not loop invariant!&quot;</span>);</div><div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;    <a class="code" href="classllvm_1_1BranchInst.html">BranchInst</a> *BI = cast&lt;BranchInst&gt;(L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#acaec68a759bb05d3be2ed7dd47e25171">getExitingBlock</a>()-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a5cb76a65b6524dba1493dd2b9dc3abbe">getTerminator</a>());</div><div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *GEPOffset = Rewriter.<a class="code" href="classllvm_1_1SCEVExpander.html#a583d3ca95f83216d632a4d1ae0330dd0">expandCodeFor</a>(IVOffset, OfsTy, BI);</div><div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;</div><div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *GEPBase = IndVar-&gt;<a class="code" href="classllvm_1_1PHINode.html#a21960167f529265a1cb02ac1e8ad10f6">getIncomingValueForBlock</a>(L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a1bc74c76b876ad387293ecde0f21ed45">getLoopPreheader</a>());</div><div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;    assert(AR-&gt;<a class="code" href="classllvm_1_1SCEVAddRecExpr.html#a0d53a749bd858b270d322b34b8d7e1e5">getStart</a>() == SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a30bd18ac905eacf3601bc6a553a9ff49">getSCEV</a>(GEPBase) &amp;&amp; <span class="stringliteral">&quot;bad loop counter&quot;</span>);</div><div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;    <span class="comment">// We could handle pointer IVs other than i8*, but we need to compensate for</span></div><div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;    <span class="comment">// gep index scaling. See canExpandBackedgeTakenCount comments.</span></div><div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;    assert(SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a5b01f1061607731f6d2953b935649570">getSizeOfExpr</a>(<a class="code" href="classllvm_1_1Type.html#a05186fa23e4d11b9855a9599ba87a4b7">IntegerType::getInt64Ty</a>(IndVar-&gt;<a class="code" href="classllvm_1_1Value.html#af85a4828b6b5a8de7fc0a55cc0e5b52f">getContext</a>()),</div><div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;             cast&lt;PointerType&gt;(GEPBase-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>())-&gt;getElementType())-&gt;isOne()</div><div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;           &amp;&amp; <span class="stringliteral">&quot;unit stride pointer IV must be i8*&quot;</span>);</div><div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;</div><div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;    <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> Builder(L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a1bc74c76b876ad387293ecde0f21ed45">getLoopPreheader</a>()-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a5cb76a65b6524dba1493dd2b9dc3abbe">getTerminator</a>());</div><div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;    <span class="keywordflow">return</span> Builder.<a class="code" href="classllvm_1_1IRBuilder.html#ac46176b523c8a76a9ccdb5683279db94">CreateGEP</a>(GEPBase, GEPOffset, <span class="stringliteral">&quot;lftr.limit&quot;</span>);</div><div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;  }</div><div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;  <span class="keywordflow">else</span> {</div><div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;    <span class="comment">// In any other case, convert both IVInit and IVCount to integers before</span></div><div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;    <span class="comment">// comparing. This may result in SCEV expension of pointers, but in practice</span></div><div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;    <span class="comment">// SCEV will fold the pointer arithmetic away as such:</span></div><div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;    <span class="comment">// BECount = (IVEnd - IVInit - 1) =&gt; IVLimit = IVInit (postinc).</span></div><div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;    <span class="comment">//</span></div><div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;    <span class="comment">// Valid Cases: (1) both integers is most common; (2) both may be pointers</span></div><div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;    <span class="comment">// for simple memset-style loops.</span></div><div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;    <span class="comment">//</span></div><div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;    <span class="comment">// IVInit integer and IVCount pointer would only occur if a canonical IV</span></div><div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;    <span class="comment">// were generated on top of case #2, which is not expected.</span></div><div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;</div><div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *IVLimit = 0;</div><div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;    <span class="comment">// For unit stride, IVCount = Start + BECount with 2&#39;s complement overflow.</span></div><div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;    <span class="comment">// For non-zero Start, compute IVCount here.</span></div><div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;    <span class="keywordflow">if</span> (AR-&gt;<a class="code" href="classllvm_1_1SCEVAddRecExpr.html#a0d53a749bd858b270d322b34b8d7e1e5">getStart</a>()-&gt;<a class="code" href="classllvm_1_1SCEV.html#a3f76d2fd4788225548dc36ef9e417030">isZero</a>())</div><div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;      IVLimit = IVCount;</div><div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;    <span class="keywordflow">else</span> {</div><div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;      assert(AR-&gt;<a class="code" href="classllvm_1_1SCEVAddRecExpr.html#a443e9130cd9f3e3baaa1b566e6aa5060">getStepRecurrence</a>(*SE)-&gt;<a class="code" href="classllvm_1_1SCEV.html#a3935a9de0ebdf3dc625cfb28e35bd009">isOne</a>() &amp;&amp; <span class="stringliteral">&quot;only handles unit stride&quot;</span>);</div><div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;      <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *IVInit = AR-&gt;<a class="code" href="classllvm_1_1SCEVAddRecExpr.html#a0d53a749bd858b270d322b34b8d7e1e5">getStart</a>();</div><div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;</div><div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;      <span class="comment">// For integer IVs, truncate the IV before computing IVInit + BECount.</span></div><div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;      <span class="keywordflow">if</span> (SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a983dbdce6af7840357ed33a20c8f30bb">getTypeSizeInBits</a>(IVInit-&gt;getType())</div><div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;          &gt; SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a983dbdce6af7840357ed33a20c8f30bb">getTypeSizeInBits</a>(IVCount-&gt;<a class="code" href="classllvm_1_1SCEV.html#a9a16f1241255a605fc8debc1e26eaa4c">getType</a>()))</div><div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;        IVInit = SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a8344b86f018c5c78a986fb97e1eaf20b">getTruncateExpr</a>(IVInit, IVCount-&gt;<a class="code" href="classllvm_1_1SCEV.html#a9a16f1241255a605fc8debc1e26eaa4c">getType</a>());</div><div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;</div><div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;      IVLimit = SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a23541ecba66207184eaf2279a70c5b12">getAddExpr</a>(IVInit, IVCount);</div><div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;    }</div><div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;    <span class="comment">// Expand the code for the iteration count.</span></div><div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;    <a class="code" href="classllvm_1_1BranchInst.html">BranchInst</a> *BI = cast&lt;BranchInst&gt;(L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#acaec68a759bb05d3be2ed7dd47e25171">getExitingBlock</a>()-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a5cb76a65b6524dba1493dd2b9dc3abbe">getTerminator</a>());</div><div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;    <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> Builder(BI);</div><div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;    assert(SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a5a19768af81df7e5fe571bc08dcd48b3">isLoopInvariant</a>(IVLimit, L) &amp;&amp;</div><div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;           <span class="stringliteral">&quot;Computed iteration count is not loop invariant!&quot;</span>);</div><div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;    <span class="comment">// Ensure that we generate the same type as IndVar, or a smaller integer</span></div><div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;    <span class="comment">// type. In the presence of null pointer values, we have an integer type</span></div><div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;    <span class="comment">// SCEV expression (IVInit) for a pointer type IV value (IndVar).</span></div><div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;    <a class="code" href="classllvm_1_1Type.html">Type</a> *LimitTy = IVCount-&gt;<a class="code" href="classllvm_1_1SCEV.html#a9a16f1241255a605fc8debc1e26eaa4c">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a2eba483f5cc876e824aa6c085736086b">isPointerTy</a>() ?</div><div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;      IndVar-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>() : IVCount-&gt;<a class="code" href="classllvm_1_1SCEV.html#a9a16f1241255a605fc8debc1e26eaa4c">getType</a>();</div><div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;    <span class="keywordflow">return</span> Rewriter.<a class="code" href="classllvm_1_1SCEVExpander.html#a583d3ca95f83216d632a4d1ae0330dd0">expandCodeFor</a>(IVLimit, LimitTy, BI);</div><div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;  }</div><div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;}</div><div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;<span class="comment">/// LinearFunctionTestReplace - This method rewrites the exit condition of the</span></div><div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;<span class="comment">/// loop to be a canonical != comparison against the incremented loop induction</span></div><div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;<span class="comment">/// variable.  This pass is able to rewrite the exit tests of any loop where the</span></div><div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;<span class="comment">/// SCEV analysis can determine a loop-invariant trip count of the loop, which</span></div><div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;<span class="comment">/// is actually a much broader range than just linear tests.</span></div><div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;<span class="comment"></span><a class="code" href="classllvm_1_1Value.html">Value</a> *IndVarSimplify::</div><div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;LinearFunctionTestReplace(<a class="code" href="classllvm_1_1Loop.html">Loop</a> *L,</div><div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;                          <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *BackedgeTakenCount,</div><div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;                          <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *IndVar,</div><div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;                          <a class="code" href="classllvm_1_1SCEVExpander.html">SCEVExpander</a> &amp;Rewriter) {</div><div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;  assert(<a class="code" href="IndVarSimplify_8cpp.html#a06d60699222d90683b12445041df2872">canExpandBackedgeTakenCount</a>(L, SE) &amp;&amp; <span class="stringliteral">&quot;precondition&quot;</span>);</div><div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;</div><div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;  <span class="comment">// Initialize CmpIndVar and IVCount to their preincremented values.</span></div><div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *CmpIndVar = IndVar;</div><div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *IVCount = BackedgeTakenCount;</div><div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;</div><div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;  <span class="comment">// If the exiting block is the same as the backedge block, we prefer to</span></div><div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;  <span class="comment">// compare against the post-incremented value, otherwise we must compare</span></div><div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;  <span class="comment">// against the preincremented value.</span></div><div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;  <span class="keywordflow">if</span> (L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#acaec68a759bb05d3be2ed7dd47e25171">getExitingBlock</a>() == L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a8917d359fc92f25eb0117386588c6f1c">getLoopLatch</a>()) {</div><div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;    <span class="comment">// Add one to the &quot;backedge-taken&quot; count to get the trip count.</span></div><div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;    <span class="comment">// This addition may overflow, which is valid as long as the comparison is</span></div><div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;    <span class="comment">// truncated to BackedgeTakenCount-&gt;getType().</span></div><div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;    IVCount = SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a23541ecba66207184eaf2279a70c5b12">getAddExpr</a>(BackedgeTakenCount,</div><div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;                             SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a2eb94d079d8416118f4aaed865ab05d7">getConstant</a>(BackedgeTakenCount-&gt;<a class="code" href="classllvm_1_1SCEV.html#a9a16f1241255a605fc8debc1e26eaa4c">getType</a>(), 1));</div><div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;    <span class="comment">// The BackedgeTaken expression contains the number of times that the</span></div><div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;    <span class="comment">// backedge branches to the loop header.  This is one less than the</span></div><div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;    <span class="comment">// number of times the loop executes, so use the incremented indvar.</span></div><div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;    CmpIndVar = IndVar-&gt;<a class="code" href="classllvm_1_1PHINode.html#a21960167f529265a1cb02ac1e8ad10f6">getIncomingValueForBlock</a>(L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#acaec68a759bb05d3be2ed7dd47e25171">getExitingBlock</a>());</div><div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;  }</div><div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;</div><div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *ExitCnt = <a class="code" href="IndVarSimplify_8cpp.html#adf86ad66e16c57783ecd95531fa505d0">genLoopLimit</a>(IndVar, IVCount, L, Rewriter, SE);</div><div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;  assert(ExitCnt-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a2eba483f5cc876e824aa6c085736086b">isPointerTy</a>() == IndVar-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a2eba483f5cc876e824aa6c085736086b">isPointerTy</a>()</div><div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;         &amp;&amp; <span class="stringliteral">&quot;genLoopLimit missed a cast&quot;</span>);</div><div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;</div><div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;  <span class="comment">// Insert a new icmp_ne or icmp_eq instruction before the branch.</span></div><div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;  <a class="code" href="classllvm_1_1BranchInst.html">BranchInst</a> *BI = cast&lt;BranchInst&gt;(L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#acaec68a759bb05d3be2ed7dd47e25171">getExitingBlock</a>()-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a5cb76a65b6524dba1493dd2b9dc3abbe">getTerminator</a>());</div><div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;  <a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05">ICmpInst::Predicate</a> <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>;</div><div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;  <span class="keywordflow">if</span> (L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a92a38e2e3412bde7fd2b71db212b61aa">contains</a>(BI-&gt;getSuccessor(0)))</div><div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;    P = <a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05ac17897ebf2f6a6986280fc3bdf28a30a">ICmpInst::ICMP_NE</a>;</div><div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;    P = <a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05aa719225e2de4059f93fd3209e1f48218">ICmpInst::ICMP_EQ</a>;</div><div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;</div><div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;  <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;INDVARS: Rewriting loop exit condition to:\n&quot;</span></div><div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;               &lt;&lt; <span class="stringliteral">&quot;      LHS:&quot;</span> &lt;&lt; *CmpIndVar &lt;&lt; <span class="charliteral">&#39;\n&#39;</span></div><div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;               &lt;&lt; <span class="stringliteral">&quot;       op:\t&quot;</span></div><div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;               &lt;&lt; (P == <a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05ac17897ebf2f6a6986280fc3bdf28a30a">ICmpInst::ICMP_NE</a> ? <span class="stringliteral">&quot;!=&quot;</span> : <span class="stringliteral">&quot;==&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div><div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;               &lt;&lt; <span class="stringliteral">&quot;      RHS:\t&quot;</span> &lt;&lt; *ExitCnt &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div><div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;               &lt;&lt; <span class="stringliteral">&quot;  IVCount:\t&quot;</span> &lt;&lt; *IVCount &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;</div><div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;  <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> Builder(BI);</div><div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;</div><div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;  <span class="comment">// LFTR can ignore IV overflow and truncate to the width of</span></div><div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;  <span class="comment">// BECount. This avoids materializing the add(zext(add)) expression.</span></div><div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;  <span class="keywordtype">unsigned</span> CmpIndVarSize = SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a983dbdce6af7840357ed33a20c8f30bb">getTypeSizeInBits</a>(CmpIndVar-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>());</div><div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;  <span class="keywordtype">unsigned</span> ExitCntSize = SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a983dbdce6af7840357ed33a20c8f30bb">getTypeSizeInBits</a>(ExitCnt-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>());</div><div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;  <span class="keywordflow">if</span> (CmpIndVarSize &gt; ExitCntSize) {</div><div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEVAddRecExpr.html">SCEVAddRecExpr</a> *AR = cast&lt;SCEVAddRecExpr&gt;(SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a30bd18ac905eacf3601bc6a553a9ff49">getSCEV</a>(IndVar));</div><div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *ARStart = AR-&gt;<a class="code" href="classllvm_1_1SCEVAddRecExpr.html#a0d53a749bd858b270d322b34b8d7e1e5">getStart</a>();</div><div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *ARStep = AR-&gt;<a class="code" href="classllvm_1_1SCEVAddRecExpr.html#a443e9130cd9f3e3baaa1b566e6aa5060">getStepRecurrence</a>(*SE);</div><div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;    <span class="comment">// For constant IVCount, avoid truncation.</span></div><div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;    <span class="keywordflow">if</span> (isa&lt;SCEVConstant&gt;(ARStart) &amp;&amp; isa&lt;SCEVConstant&gt;(IVCount)) {</div><div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;      <span class="keyword">const</span> <a class="code" href="classllvm_1_1APInt.html">APInt</a> &amp;Start = cast&lt;SCEVConstant&gt;(ARStart)-&gt;getValue()-&gt;getValue();</div><div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;      <a class="code" href="classllvm_1_1APInt.html">APInt</a> Count = cast&lt;SCEVConstant&gt;(IVCount)-&gt;getValue()-&gt;getValue();</div><div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;      <span class="comment">// Note that the post-inc value of BackedgeTakenCount may have overflowed</span></div><div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;      <span class="comment">// above such that IVCount is now zero.</span></div><div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;      <span class="keywordflow">if</span> (IVCount != BackedgeTakenCount &amp;&amp; Count == 0) {</div><div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;        Count = <a class="code" href="classllvm_1_1APInt.html#a331d69b5f93e47e7c596062b77dd5913">APInt::getMaxValue</a>(Count.<a class="code" href="classllvm_1_1APInt.html#ad081689e23a8f5dea78dedd623d6a8f8">getBitWidth</a>()).zext(CmpIndVarSize);</div><div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;        ++Count;</div><div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;      }</div><div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;        Count = Count.<a class="code" href="classllvm_1_1APInt.html#a6142fc5662411269a7ca0217f49f338c">zext</a>(CmpIndVarSize);</div><div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;      <a class="code" href="classllvm_1_1APInt.html">APInt</a> NewLimit;</div><div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;      <span class="keywordflow">if</span> (cast&lt;SCEVConstant&gt;(ARStep)-&gt;getValue()-&gt;isNegative())</div><div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;        NewLimit = Start - Count;</div><div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;        NewLimit = Start + Count;</div><div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;      ExitCnt = <a class="code" href="classllvm_1_1ConstantInt.html#a9105541412dab869e18b3cceebfff07d">ConstantInt::get</a>(CmpIndVar-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>(), NewLimit);</div><div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;</div><div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;      <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;  Widen RHS:\t&quot;</span> &lt;&lt; *ExitCnt &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;      CmpIndVar = Builder.<a class="code" href="classllvm_1_1IRBuilder.html#aa933549689e79685bb67de64dddc9f7c">CreateTrunc</a>(CmpIndVar, ExitCnt-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>(),</div><div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;                                      <span class="stringliteral">&quot;lftr.wideiv&quot;</span>);</div><div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;    }</div><div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;  }</div><div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Cond = Builder.<a class="code" href="classllvm_1_1IRBuilder.html#a495d91fb3d2662acbffd0162c56153ed">CreateICmp</a>(P, CmpIndVar, ExitCnt, <span class="stringliteral">&quot;exitcond&quot;</span>);</div><div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *OrigCond = BI-&gt;getCondition();</div><div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;  <span class="comment">// It&#39;s tempting to use replaceAllUsesWith here to fully replace the old</span></div><div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;  <span class="comment">// comparison, but that&#39;s not immediately safe, since users of the old</span></div><div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;  <span class="comment">// comparison may not be dominated by the new comparison. Instead, just</span></div><div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;  <span class="comment">// update the branch to use the new comparison; in the common case this</span></div><div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;  <span class="comment">// will make old comparison dead.</span></div><div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;  BI-&gt;setCondition(Cond);</div><div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;  DeadInsts.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(OrigCond);</div><div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;</div><div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;  ++NumLFTR;</div><div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;  Changed = <span class="keyword">true</span>;</div><div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;  <span class="keywordflow">return</span> Cond;</div><div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;}</div><div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;</div><div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div><div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;<span class="comment">//  SinkUnusedInvariants. A late subpass to cleanup loop preheaders.</span></div><div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div><div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;<span class="comment">/// If there&#39;s a single exit block, sink any loop-invariant values that</span></div><div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;<span class="comment">/// were defined in the preheader but not used inside the loop into the</span></div><div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;<span class="comment">/// exit block to reduce register pressure in the loop.</span></div><div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;<span class="comment"></span><span class="keywordtype">void</span> IndVarSimplify::SinkUnusedInvariants(<a class="code" href="classllvm_1_1Loop.html">Loop</a> *L) {</div><div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *ExitBlock = L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a57432ae698fc4437dc07d23031a0cb02">getExitBlock</a>();</div><div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;  <span class="keywordflow">if</span> (!ExitBlock) <span class="keywordflow">return</span>;</div><div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;</div><div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *Preheader = L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a1bc74c76b876ad387293ecde0f21ed45">getLoopPreheader</a>();</div><div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;  <span class="keywordflow">if</span> (!Preheader) <span class="keywordflow">return</span>;</div><div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;</div><div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *InsertPt = ExitBlock-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#ab1cd5a3713b93a33f89a2086d473cf6e">getFirstInsertionPt</a>();</div><div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;  <a class="code" href="classllvm_1_1ilist__iterator.html">BasicBlock::iterator</a> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = Preheader-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a5cb76a65b6524dba1493dd2b9dc3abbe">getTerminator</a>();</div><div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;  <span class="keywordflow">while</span> (I != Preheader-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a0ed5f3ab3c2e4196ee0cffffa080c062">begin</a>()) {</div><div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;    --<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>;</div><div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;    <span class="comment">// New instructions were inserted at the end of the preheader.</span></div><div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;    <span class="keywordflow">if</span> (isa&lt;PHINode&gt;(I))</div><div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;</div><div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;    <span class="comment">// Don&#39;t move instructions which might have side effects, since the side</span></div><div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;    <span class="comment">// effects need to complete before instructions inside the loop.  Also don&#39;t</span></div><div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;    <span class="comment">// move instructions which might read memory, since the loop may modify</span></div><div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;    <span class="comment">// memory. Note that it&#39;s okay if the instruction might have undefined</span></div><div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;    <span class="comment">// behavior: LoopSimplify guarantees that the preheader dominates the exit</span></div><div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;    <span class="comment">// block.</span></div><div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;    <span class="keywordflow">if</span> (I-&gt;mayHaveSideEffects() || I-&gt;mayReadFromMemory())</div><div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;</div><div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;    <span class="comment">// Skip debug info intrinsics.</span></div><div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;    <span class="keywordflow">if</span> (isa&lt;DbgInfoIntrinsic&gt;(I))</div><div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;</div><div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;    <span class="comment">// Skip landingpad instructions.</span></div><div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;    <span class="keywordflow">if</span> (isa&lt;LandingPadInst&gt;(I))</div><div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;</div><div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;    <span class="comment">// Don&#39;t sink alloca: we never want to sink static alloca&#39;s out of the</span></div><div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;    <span class="comment">// entry block, and correctly sinking dynamic alloca&#39;s requires</span></div><div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;    <span class="comment">// checks for stacksave/stackrestore intrinsics.</span></div><div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;    <span class="comment">// FIXME: Refactor this check somehow?</span></div><div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;    <span class="keywordflow">if</span> (isa&lt;AllocaInst&gt;(I))</div><div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;</div><div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;    <span class="comment">// Determine if there is a use in or before the loop (direct or</span></div><div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;    <span class="comment">// otherwise).</span></div><div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;    <span class="keywordtype">bool</span> UsedInLoop = <span class="keyword">false</span>;</div><div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1value__use__iterator.html">Value::use_iterator</a> UI = I-&gt;use_begin(), UE = I-&gt;use_end();</div><div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;         UI != UE; ++UI) {</div><div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;      <a class="code" href="classllvm_1_1User.html">User</a> *U = *UI;</div><div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;      <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *UseBB = cast&lt;Instruction&gt;(U)-&gt;<a class="code" href="BasicAliasAnalysis_8cpp.html#a2675de1d8479c7b00387979714da43f7">getParent</a>();</div><div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a> = dyn_cast&lt;PHINode&gt;(U)) {</div><div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;        <span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> =</div><div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;          <a class="code" href="classllvm_1_1PHINode.html#aca414c43a6d42c13998208463637a20d">PHINode::getIncomingValueNumForOperand</a>(UI.getOperandNo());</div><div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;        UseBB = <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>-&gt;getIncomingBlock(i);</div><div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;      }</div><div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;      <span class="keywordflow">if</span> (UseBB == Preheader || L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a92a38e2e3412bde7fd2b71db212b61aa">contains</a>(UseBB)) {</div><div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;        UsedInLoop = <span class="keyword">true</span>;</div><div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;      }</div><div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;    }</div><div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;</div><div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;    <span class="comment">// If there is, the def must remain in the preheader.</span></div><div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;    <span class="keywordflow">if</span> (UsedInLoop)</div><div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;</div><div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;    <span class="comment">// Otherwise, sink it to the exit block.</span></div><div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *ToMove = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>;</div><div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;    <span class="keywordtype">bool</span> Done = <span class="keyword">false</span>;</div><div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;</div><div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;    <span class="keywordflow">if</span> (I != Preheader-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a0ed5f3ab3c2e4196ee0cffffa080c062">begin</a>()) {</div><div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;      <span class="comment">// Skip debug info intrinsics.</span></div><div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;      <span class="keywordflow">do</span> {</div><div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;        --<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>;</div><div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;      } <span class="keywordflow">while</span> (isa&lt;DbgInfoIntrinsic&gt;(I) &amp;&amp; I != Preheader-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a0ed5f3ab3c2e4196ee0cffffa080c062">begin</a>());</div><div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;</div><div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;      <span class="keywordflow">if</span> (isa&lt;DbgInfoIntrinsic&gt;(I) &amp;&amp; I == Preheader-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a0ed5f3ab3c2e4196ee0cffffa080c062">begin</a>())</div><div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;        Done = <span class="keyword">true</span>;</div><div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;      Done = <span class="keyword">true</span>;</div><div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;    }</div><div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;</div><div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;    ToMove-&gt;<a class="code" href="classllvm_1_1Instruction.html#af67d1f3a518964d80a109bb3d9d5cf1e">moveBefore</a>(InsertPt);</div><div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;    <span class="keywordflow">if</span> (Done) <span class="keywordflow">break</span>;</div><div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;    InsertPt = ToMove;</div><div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;  }</div><div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;}</div><div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;</div><div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div><div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;<span class="comment">//  IndVarSimplify driver. Manage several subpasses of IV simplification.</span></div><div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div><div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;</div><div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;<span class="keywordtype">bool</span> IndVarSimplify::runOnLoop(<a class="code" href="classllvm_1_1Loop.html">Loop</a> *L, <a class="code" href="classllvm_1_1LPPassManager.html">LPPassManager</a> &amp;LPM) {</div><div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;  <span class="comment">// If LoopSimplify form is not available, stay out of trouble. Some notes:</span></div><div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;  <span class="comment">//  - LSR currently only supports LoopSimplify-form loops. Indvars&#39;</span></div><div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;  <span class="comment">//    canonicalization can be a pessimization without LSR to &quot;clean up&quot;</span></div><div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;  <span class="comment">//    afterwards.</span></div><div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;  <span class="comment">//  - We depend on having a preheader; in particular,</span></div><div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;  <span class="comment">//    Loop::getCanonicalInductionVariable only supports loops with preheaders,</span></div><div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;  <span class="comment">//    and we&#39;re in trouble if we can&#39;t find the induction variable even when</span></div><div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;  <span class="comment">//    we&#39;ve manually inserted one.</span></div><div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;  <span class="keywordflow">if</span> (!L-&gt;<a class="code" href="classllvm_1_1Loop.html#a1d4445ebce66137e57fbaa967a19d7e9">isLoopSimplifyForm</a>())</div><div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;</div><div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;  LI = &amp;getAnalysis&lt;LoopInfo&gt;();</div><div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;  SE = &amp;getAnalysis&lt;ScalarEvolution&gt;();</div><div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;  DT = &amp;getAnalysis&lt;DominatorTree&gt;();</div><div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;  TD = getAnalysisIfAvailable&lt;DataLayout&gt;();</div><div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;  TLI = getAnalysisIfAvailable&lt;TargetLibraryInfo&gt;();</div><div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;</div><div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;  DeadInsts.<a class="code" href="classllvm_1_1SmallVectorImpl.html#aac0ea55010b7b1a301e65a0baea057aa">clear</a>();</div><div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;  Changed = <span class="keyword">false</span>;</div><div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;</div><div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;  <span class="comment">// If there are any floating-point recurrences, attempt to</span></div><div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;  <span class="comment">// transform them to use integer recurrences.</span></div><div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;  RewriteNonIntegerIVs(L);</div><div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;</div><div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *BackedgeTakenCount = SE-&gt;getBackedgeTakenCount(L);</div><div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;</div><div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;  <span class="comment">// Create a rewriter object which we&#39;ll use to transform the code with.</span></div><div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;  <a class="code" href="classllvm_1_1SCEVExpander.html">SCEVExpander</a> <a class="code" href="VirtRegMap_8cpp.html#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a>(*SE, <span class="stringliteral">&quot;indvars&quot;</span>);</div><div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;<span class="preprocessor">#ifndef NDEBUG</span></div><div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;  Rewriter.<a class="code" href="classllvm_1_1SCEVExpander.html#ac3ae3288532d1f9b8b5f4a1445b58697">setDebugType</a>(<a class="code" href="IndVarSimplify_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a>);</div><div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;</div><div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;  <span class="comment">// Eliminate redundant IV users.</span></div><div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;  <span class="comment">//</span></div><div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;  <span class="comment">// Simplification works best when run before other consumers of SCEV. We</span></div><div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;  <span class="comment">// attempt to avoid evaluating SCEVs for sign/zero extend operations until</span></div><div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;  <span class="comment">// other expressions involving loop IVs have been evaluated. This helps SCEV</span></div><div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;  <span class="comment">// set no-wrap flags before normalizing sign/zero extension.</span></div><div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;  Rewriter.<a class="code" href="classllvm_1_1SCEVExpander.html#acfd53cb9ef34b9c9d9428fdaf08e0f0b">disableCanonicalMode</a>();</div><div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;  SimplifyAndExtend(L, Rewriter, LPM);</div><div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;</div><div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;  <span class="comment">// Check to see if this loop has a computable loop-invariant execution count.</span></div><div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;  <span class="comment">// If so, this means that we can compute the final value of any expressions</span></div><div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;  <span class="comment">// that are recurrent in the loop, and substitute the exit values from the</span></div><div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;  <span class="comment">// loop into any instructions outside of the loop that use the final values of</span></div><div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;  <span class="comment">// the current expressions.</span></div><div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;  <span class="comment">//</span></div><div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;  <span class="keywordflow">if</span> (!isa&lt;SCEVCouldNotCompute&gt;(BackedgeTakenCount))</div><div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;    RewriteLoopExitValues(L, Rewriter);</div><div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;</div><div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;  <span class="comment">// Eliminate redundant IV cycles.</span></div><div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;  NumElimIV += Rewriter.<a class="code" href="classllvm_1_1SCEVExpander.html#ab35b69a7c369aadf7ac052ab21ad2ec6">replaceCongruentIVs</a>(L, DT, DeadInsts);</div><div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;</div><div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;  <span class="comment">// If we have a trip count expression, rewrite the loop&#39;s exit condition</span></div><div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;  <span class="comment">// using it.  We can currently only handle loops with a single exit.</span></div><div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="IndVarSimplify_8cpp.html#a06d60699222d90683b12445041df2872">canExpandBackedgeTakenCount</a>(L, SE) &amp;&amp; <a class="code" href="IndVarSimplify_8cpp.html#a5a24a27c50a6c4bc285bef2de8a5e908">needsLFTR</a>(L, DT)) {</div><div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;    <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *IndVar = <a class="code" href="IndVarSimplify_8cpp.html#a0ba22bab67cca4eedc62b66da6f2bbdf">FindLoopCounter</a>(L, BackedgeTakenCount, SE, DT, TD);</div><div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;    <span class="keywordflow">if</span> (IndVar) {</div><div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;      <span class="comment">// Check preconditions for proper SCEVExpander operation. SCEV does not</span></div><div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;      <span class="comment">// express SCEVExpander&#39;s dependencies, such as LoopSimplify. Instead any</span></div><div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;      <span class="comment">// pass that uses the SCEVExpander must do it. This does not work well for</span></div><div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;      <span class="comment">// loop passes because SCEVExpander makes assumptions about all loops, while</span></div><div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;      <span class="comment">// LoopPassManager only forces the current loop to be simplified.</span></div><div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;      <span class="comment">//</span></div><div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;      <span class="comment">// FIXME: SCEV expansion has no way to bail out, so the caller must</span></div><div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;      <span class="comment">// explicitly check any assumptions made by SCEV. Brittle.</span></div><div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;      <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEVAddRecExpr.html">SCEVAddRecExpr</a> *AR = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1SCEVAddRecExpr.html">SCEVAddRecExpr</a>&gt;(BackedgeTakenCount);</div><div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;      <span class="keywordflow">if</span> (!AR || AR-&gt;<a class="code" href="classllvm_1_1SCEVAddRecExpr.html#a7fcbbc51eef313e675a2442bb2053ae9">getLoop</a>()-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a1bc74c76b876ad387293ecde0f21ed45">getLoopPreheader</a>())</div><div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;        (<span class="keywordtype">void</span>)LinearFunctionTestReplace(L, BackedgeTakenCount, IndVar,</div><div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;                                        Rewriter);</div><div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;    }</div><div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;  }</div><div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;  <span class="comment">// Clear the rewriter cache, because values that are in the rewriter&#39;s cache</span></div><div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;  <span class="comment">// can be deleted in the loop below, causing the AssertingVH in the cache to</span></div><div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;  <span class="comment">// trigger.</span></div><div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;  Rewriter.<a class="code" href="classllvm_1_1SCEVExpander.html#aa9bcc84c7b023d3b1321851509110dae">clear</a>();</div><div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;</div><div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;  <span class="comment">// Now that we&#39;re done iterating through lists, clean up any instructions</span></div><div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;  <span class="comment">// which are now dead.</span></div><div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;  <span class="keywordflow">while</span> (!DeadInsts.<a class="code" href="classllvm_1_1SmallVectorBase.html#a8a8df4d85555c7954a95f86080cd3b64">empty</a>())</div><div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *Inst =</div><div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;          dyn_cast_or_null&lt;Instruction&gt;(&amp;*DeadInsts.<a class="code" href="classllvm_1_1SmallVectorImpl.html#a400eaca9881c8dcab97e9f42b1ab1815">pop_back_val</a>()))</div><div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;      <a class="code" href="namespacellvm.html#a23b3753cc662a87b599913814ccf2444">RecursivelyDeleteTriviallyDeadInstructions</a>(Inst, TLI);</div><div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;</div><div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;  <span class="comment">// The Rewriter may not be used from this point on.</span></div><div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;</div><div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;  <span class="comment">// Loop-invariant instructions in the preheader that aren&#39;t used in the</span></div><div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;  <span class="comment">// loop may be sunk below the loop to reduce register pressure.</span></div><div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;  SinkUnusedInvariants(L);</div><div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;</div><div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;  <span class="comment">// Clean up dead instructions.</span></div><div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;  Changed |= <a class="code" href="namespacellvm.html#af44ceebb0726227cf82bd54a0bc286fa">DeleteDeadPHIs</a>(L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#ac4f141a355e5898255f2cbc57c5b54c3">getHeader</a>(), TLI);</div><div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;  <span class="comment">// Check a post-condition.</span></div><div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;  assert(L-&gt;<a class="code" href="classllvm_1_1Loop.html#a169771e7b8bf22ee06a0ebe655fce069">isLCSSAForm</a>(*DT) &amp;&amp;</div><div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;         <span class="stringliteral">&quot;Indvars did not leave the loop in lcssa form!&quot;</span>);</div><div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;</div><div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;  <span class="comment">// Verify that LFTR, and any other change have not interfered with SCEV&#39;s</span></div><div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;  <span class="comment">// ability to compute trip count.</span></div><div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;<span class="preprocessor">#ifndef NDEBUG</span></div><div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="IndVarSimplify_8cpp.html#a7dd1919a4d3379a4810f52ee7bbcd3c8">VerifyIndvars</a> &amp;&amp; !isa&lt;SCEVCouldNotCompute&gt;(BackedgeTakenCount)) {</div><div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;    SE-&gt;forgetLoop(L);</div><div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *NewBECount = SE-&gt;getBackedgeTakenCount(L);</div><div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;    <span class="keywordflow">if</span> (SE-&gt;getTypeSizeInBits(BackedgeTakenCount-&gt;<a class="code" href="classllvm_1_1SCEV.html#a9a16f1241255a605fc8debc1e26eaa4c">getType</a>()) &lt;</div><div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;        SE-&gt;getTypeSizeInBits(NewBECount-&gt;<a class="code" href="classllvm_1_1SCEV.html#a9a16f1241255a605fc8debc1e26eaa4c">getType</a>()))</div><div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;      NewBECount = SE-&gt;getTruncateOrNoop(NewBECount,</div><div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;                                         BackedgeTakenCount-&gt;<a class="code" href="classllvm_1_1SCEV.html#a9a16f1241255a605fc8debc1e26eaa4c">getType</a>());</div><div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;      BackedgeTakenCount = SE-&gt;getTruncateOrNoop(BackedgeTakenCount,</div><div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;                                                 NewBECount-&gt;<a class="code" href="classllvm_1_1SCEV.html#a9a16f1241255a605fc8debc1e26eaa4c">getType</a>());</div><div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;    assert(BackedgeTakenCount == NewBECount &amp;&amp; <span class="stringliteral">&quot;indvars must preserve SCEV&quot;</span>);</div><div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;  }</div><div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;</div><div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;  <span class="keywordflow">return</span> Changed;</div><div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;}</div><div class="ttc" id="namespacellvm_1_1MCID_html_a8035044d40d3758eb45b65dce69dc90ba1328ed43be8173506f59f88c9bfd8b8c"><div class="ttname"><a href="namespacellvm_1_1MCID.html#a8035044d40d3758eb45b65dce69dc90ba1328ed43be8173506f59f88c9bfd8b8c">llvm::MCID::Compare</a></div><div class="ttdef"><b>Definition:</b> <a href="MCInstrDesc_8h_source.html#l00110">MCInstrDesc.h:110</a></div></div>
<div class="ttc" id="namespacellvm_html_a9bf6430c1a0cf078ee3f9f520fa407f0"><div class="ttname"><a href="namespacellvm.html#a9bf6430c1a0cf078ee3f9f520fa407f0">llvm::isInt&lt; 32 &gt;</a></div><div class="ttdeci">bool isInt&lt; 32 &gt;(int64_t x)</div><div class="ttdef"><b>Definition:</b> <a href="MathExtras_8h_source.html#l00276">MathExtras.h:276</a></div></div>
<div class="ttc" id="classllvm_1_1Pass_html"><div class="ttname"><a href="classllvm_1_1Pass.html">llvm::Pass</a></div><div class="ttdef"><b>Definition:</b> <a href="Pass_8h_source.html#l00082">Pass.h:82</a></div></div>
<div class="ttc" id="classllvm_1_1IRBuilder_html_ac46176b523c8a76a9ccdb5683279db94"><div class="ttname"><a href="classllvm_1_1IRBuilder.html#ac46176b523c8a76a9ccdb5683279db94">llvm::IRBuilder::CreateGEP</a></div><div class="ttdeci">Value * CreateGEP(Value *Ptr, ArrayRef&lt; Value * &gt; IdxList, const Twine &amp;Name=&quot;&quot;)</div><div class="ttdef"><b>Definition:</b> <a href="IRBuilder_8h_source.html#l00931">IRBuilder.h:931</a></div></div>
<div class="ttc" id="classllvm_1_1SmallVectorTemplateCommon_html_a22a311dfe4c28a897de8a9365a4f0a84"><div class="ttname"><a href="classllvm_1_1SmallVectorTemplateCommon.html#a22a311dfe4c28a897de8a9365a4f0a84">llvm::SmallVectorTemplateCommon&lt; T &gt;::size</a></div><div class="ttdeci">size_type size() const</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00127">SmallVector.h:127</a></div></div>
<div class="ttc" id="classllvm_1_1SmallVectorTemplateBase_html_ae1a10b90f22c0478960fb5798ff73916"><div class="ttname"><a href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">llvm::SmallVectorTemplateBase&lt; T, isPodLike&lt; T &gt;::value &gt;::push_back</a></div><div class="ttdeci">void push_back(const T &amp;Elt)</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00236">SmallVector.h:236</a></div></div>
<div class="ttc" id="classllvm_1_1Value_html_ad86469939d2a8bdd4169be9403b89f5a"><div class="ttname"><a href="classllvm_1_1Value.html#ad86469939d2a8bdd4169be9403b89f5a">llvm::Value::use_end</a></div><div class="ttdeci">use_iterator use_end()</div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00152">Value.h:152</a></div></div>
<div class="ttc" id="classllvm_1_1DataLayout_html"><div class="ttname"><a href="classllvm_1_1DataLayout.html">llvm::DataLayout</a></div><div class="ttdef"><b>Definition:</b> <a href="DataLayout_8h_source.html#l00098">DataLayout.h:98</a></div></div>
<div class="ttc" id="classllvm_1_1SCEVExpander_html_a9093ff54a20ae387e9643cc4ed615214"><div class="ttname"><a href="classllvm_1_1SCEVExpander.html#a9093ff54a20ae387e9643cc4ed615214">llvm::SCEVExpander::hoistIVInc</a></div><div class="ttdeci">bool hoistIVInc(Instruction *IncV, Instruction *InsertPos)</div><div class="ttdoc">hoistIVInc - Utility for hoisting an IV increment. </div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolutionExpander_8cpp_source.html#l00944">ScalarEvolutionExpander.cpp:944</a></div></div>
<div class="ttc" id="IndVarSimplify_8cpp_html_ab5371a4f4e29460339200c446c423284"><div class="ttname"><a href="IndVarSimplify_8cpp.html#ab5371a4f4e29460339200c446c423284">Simplification</a></div><div class="ttdeci">Induction Variable Simplification</div><div class="ttdef"><b>Definition:</b> <a href="IndVarSimplify_8cpp_source.html#l00127">IndVarSimplify.cpp:127</a></div></div>
<div class="ttc" id="classllvm_1_1CastInst_html_adc3489e61d5f37a0e4c5589859fbccc2"><div class="ttname"><a href="classllvm_1_1CastInst.html#adc3489e61d5f37a0e4c5589859fbccc2">llvm::CastInst::getOpcode</a></div><div class="ttdeci">Instruction::CastOps getOpcode() const </div><div class="ttdoc">Return the opcode of this CastInst. </div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00603">InstrTypes.h:603</a></div></div>
<div class="ttc" id="classllvm_1_1AnalysisUsage_html_a884f90190bca4bd354f2d5c91c264028"><div class="ttname"><a href="classllvm_1_1AnalysisUsage.html#a884f90190bca4bd354f2d5c91c264028">llvm::AnalysisUsage::addPreserved</a></div><div class="ttdeci">AnalysisUsage &amp; addPreserved()</div><div class="ttdef"><b>Definition:</b> <a href="PassAnalysisSupport_8h_source.html#l00081">PassAnalysisSupport.h:81</a></div></div>
<div class="ttc" id="classllvm_1_1PHINode_html_a089cccb6f231efee72abc76d0f9c695f"><div class="ttname"><a href="classllvm_1_1PHINode.html#a089cccb6f231efee72abc76d0f9c695f">llvm::PHINode::addIncoming</a></div><div class="ttdeci">void addIncoming(Value *V, BasicBlock *BB)</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02100">Instructions.h:2100</a></div></div>
<div class="ttc" id="classllvm_1_1PassRegistry_html_a05a729900b76c89e808c6c3094921b2f"><div class="ttname"><a href="classllvm_1_1PassRegistry.html#a05a729900b76c89e808c6c3094921b2f">llvm::PassRegistry::getPassRegistry</a></div><div class="ttdeci">static PassRegistry * getPassRegistry()</div><div class="ttdef"><b>Definition:</b> <a href="PassRegistry_8cpp_source.html#l00035">PassRegistry.cpp:35</a></div></div>
<div class="ttc" id="classllvm_1_1Instruction_html_a6fe2f06b8a4b2c3d6308afb223a0238a"><div class="ttname"><a href="classllvm_1_1Instruction.html#a6fe2f06b8a4b2c3d6308afb223a0238a">llvm::Instruction::eraseFromParent</a></div><div class="ttdeci">void eraseFromParent()</div><div class="ttdef"><b>Definition:</b> <a href="Instruction_8cpp_source.html#l00072">Instruction.cpp:72</a></div></div>
<div class="ttc" id="IndVarSimplify_8cpp_html_afcaa9ef0e14174b7e78a1ba5e83093d7"><div class="ttname"><a href="IndVarSimplify_8cpp.html#afcaa9ef0e14174b7e78a1ba5e83093d7">isLoopInvariant</a></div><div class="ttdeci">static bool isLoopInvariant(Value *V, const Loop *L, const DominatorTree *DT)</div><div class="ttdef"><b>Definition:</b> <a href="IndVarSimplify_8cpp_source.html#l00762">IndVarSimplify.cpp:762</a></div></div>
<div class="ttc" id="Instructions_8h_html"><div class="ttname"><a href="Instructions_8h.html">Instructions.h</a></div></div>
<div class="ttc" id="classllvm_1_1IRBuilder_html_a495d91fb3d2662acbffd0162c56153ed"><div class="ttname"><a href="classllvm_1_1IRBuilder.html#a495d91fb3d2662acbffd0162c56153ed">llvm::IRBuilder::CreateICmp</a></div><div class="ttdeci">Value * CreateICmp(CmpInst::Predicate P, Value *LHS, Value *RHS, const Twine &amp;Name=&quot;&quot;)</div><div class="ttdef"><b>Definition:</b> <a href="IRBuilder_8h_source.html#l01280">IRBuilder.h:1280</a></div></div>
<div class="ttc" id="classllvm_1_1SCEV_html_a3935a9de0ebdf3dc625cfb28e35bd009"><div class="ttname"><a href="classllvm_1_1SCEV.html#a3935a9de0ebdf3dc625cfb28e35bd009">llvm::SCEV::isOne</a></div><div class="ttdeci">bool isOne() const </div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8cpp_source.html#l00281">ScalarEvolution.cpp:281</a></div></div>
<div class="ttc" id="classllvm_1_1ScalarEvolution_html_a2eb94d079d8416118f4aaed865ab05d7"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html#a2eb94d079d8416118f4aaed865ab05d7">llvm::ScalarEvolution::getConstant</a></div><div class="ttdeci">const SCEV * getConstant(ConstantInt *V)</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8cpp_source.html#l00314">ScalarEvolution.cpp:314</a></div></div>
<div class="ttc" id="namespacellvm_html"><div class="ttname"><a href="namespacellvm.html">llvm</a></div><div class="ttdoc">List of target independent CodeGen pass IDs. </div><div class="ttdef"><b>Definition:</b> <a href="APFloat_8h_source.html#l00022">APFloat.h:22</a></div></div>
<div class="ttc" id="Type_8h_html"><div class="ttname"><a href="Type_8h.html">Type.h</a></div></div>
<div class="ttc" id="classllvm_1_1SCEV_html_a3f76d2fd4788225548dc36ef9e417030"><div class="ttname"><a href="classllvm_1_1SCEV.html#a3f76d2fd4788225548dc36ef9e417030">llvm::SCEV::isZero</a></div><div class="ttdeci">bool isZero() const </div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8cpp_source.html#l00275">ScalarEvolution.cpp:275</a></div></div>
<div class="ttc" id="IntrinsicInst_8h_html"><div class="ttname"><a href="IntrinsicInst_8h.html">IntrinsicInst.h</a></div></div>
<div class="ttc" id="namespacellvm_html_a3f2f98c2a67c9e79f58aad9150a62e42"><div class="ttname"><a href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">llvm::dyn_cast</a></div><div class="ttdeci">enable_if_c&lt;!is_simple_type&lt; Y &gt;::value, typename cast_retty&lt; X, const Y &gt;::ret_type &gt;::type dyn_cast(const Y &amp;Val)</div><div class="ttdef"><b>Definition:</b> <a href="Casting_8h_source.html#l00266">Casting.h:266</a></div></div>
<div class="ttc" id="classllvm_1_1User_html_a2f81e0c1fc6554df7ad2eafabf5fc5a5"><div class="ttname"><a href="classllvm_1_1User.html#a2f81e0c1fc6554df7ad2eafabf5fc5a5">llvm::User::getNumOperands</a></div><div class="ttdeci">unsigned getNumOperands() const </div><div class="ttdef"><b>Definition:</b> <a href="User_8h_source.html#l00108">User.h:108</a></div></div>
<div class="ttc" id="classllvm_1_1OverflowingBinaryOperator_html_a5a1ebefdf12a23a94f8a135cdfa0cd90"><div class="ttname"><a href="classllvm_1_1OverflowingBinaryOperator.html#a5a1ebefdf12a23a94f8a135cdfa0cd90">llvm::OverflowingBinaryOperator::hasNoSignedWrap</a></div><div class="ttdeci">bool hasNoSignedWrap() const </div><div class="ttdef"><b>Definition:</b> <a href="Operator_8h_source.html#l00107">Operator.h:107</a></div></div>
<div class="ttc" id="DataLayout_8h_html"><div class="ttname"><a href="DataLayout_8h.html">DataLayout.h</a></div></div>
<div class="ttc" id="classllvm_1_1ScalarEvolution_html_ac276ea1907c780c43d3637ae9bd1989e"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html#ac276ea1907c780c43d3637ae9bd1989e">llvm::ScalarEvolution::getPointerBase</a></div><div class="ttdeci">const SCEV * getPointerBase(const SCEV *V)</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8cpp_source.html#l02935">ScalarEvolution.cpp:2935</a></div></div>
<div class="ttc" id="classllvm_1_1ScalarEvolution_html"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html">llvm::ScalarEvolution</a></div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8h_source.html#l00172">ScalarEvolution.h:172</a></div></div>
<div class="ttc" id="README-SSE_8txt_html_a63d206a063eefcdf8c318ded97b65020"><div class="ttname"><a href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a></div><div class="ttdeci">This currently compiles esp xmm0 movsd esp eax eax esp ret We should use not the dag combiner This is because dagcombine2 needs to be able to see through the X86ISD::Wrapper which DAGCombine can t really do The code for turning x load into a single vector load is target independent and should be moved to the dag combiner The code for turning x load into a vector load can only handle a direct load from a global or a direct load from the stack It should be generalized to handle any load from P</div><div class="ttdef"><b>Definition:</b> <a href="README-SSE_8txt_source.html#l00427">README-SSE.txt:427</a></div></div>
<div class="ttc" id="namespacellvm_html_a7ef747666d6938cb47b3c5544011a4e5afd56f054da3d1f9b827ae1003da3a38b"><div class="ttname"><a href="namespacellvm.html#a7ef747666d6938cb47b3c5544011a4e5afd56f054da3d1f9b827ae1003da3a38b">llvm::scMulExpr</a></div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolutionExpressions_8h_source.html#l00029">ScalarEvolutionExpressions.h:29</a></div></div>
<div class="ttc" id="classllvm_1_1PHINode_html"><div class="ttname"><a href="classllvm_1_1PHINode.html">llvm::PHINode</a></div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l01978">Instructions.h:1978</a></div></div>
<div class="ttc" id="namespacellvm_html_a23b3753cc662a87b599913814ccf2444"><div class="ttname"><a href="namespacellvm.html#a23b3753cc662a87b599913814ccf2444">llvm::RecursivelyDeleteTriviallyDeadInstructions</a></div><div class="ttdeci">bool RecursivelyDeleteTriviallyDeadInstructions(Value *V, const TargetLibraryInfo *TLI=0)</div><div class="ttdef"><b>Definition:</b> <a href="Local_8cpp_source.html#l00316">Local.cpp:316</a></div></div>
<div class="ttc" id="Debug_8h_html"><div class="ttname"><a href="Debug_8h.html">Debug.h</a></div></div>
<div class="ttc" id="classllvm_1_1SmallPtrSet_html_a9b6dd0fc7a648a939e571246045b673e"><div class="ttname"><a href="classllvm_1_1SmallPtrSet.html#a9b6dd0fc7a648a939e571246045b673e">llvm::SmallPtrSet::insert</a></div><div class="ttdeci">bool insert(PtrType Ptr)</div><div class="ttdef"><b>Definition:</b> <a href="SmallPtrSet_8h_source.html#l00253">SmallPtrSet.h:253</a></div></div>
<div class="ttc" id="IndVarSimplify_8cpp_html_a2831ebb1b1d686d2841c7bb2aeed5ade"><div class="ttname"><a href="IndVarSimplify_8cpp.html#a2831ebb1b1d686d2841c7bb2aeed5ade">getInsertPointForUses</a></div><div class="ttdeci">static Instruction * getInsertPointForUses(Instruction *User, Value *Def, DominatorTree *DT)</div><div class="ttdef"><b>Definition:</b> <a href="IndVarSimplify_8cpp_source.html#l00190">IndVarSimplify.cpp:190</a></div></div>
<div class="ttc" id="BasicBlock_8h_html"><div class="ttname"><a href="BasicBlock_8h.html">BasicBlock.h</a></div></div>
<div class="ttc" id="classllvm_1_1CmpInst_html_a283f9a5d4d843d20c40bb4d3e364bb05a326bee0a4a424cef21c1cf8adb8b8dd8"><div class="ttname"><a href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05a326bee0a4a424cef21c1cf8adb8b8dd8">llvm::CmpInst::FCMP_OLT</a></div><div class="ttdoc">0 1 0 0 True if ordered and less than </div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00657">InstrTypes.h:657</a></div></div>
<div class="ttc" id="classllvm_1_1ScalarEvolution_html_ae0d036af111b8aafe90db0771b8e9ce3"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html#ae0d036af111b8aafe90db0771b8e9ce3">llvm::ScalarEvolution::properlyDominates</a></div><div class="ttdeci">bool properlyDominates(const SCEV *S, const BasicBlock *BB)</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8cpp_source.html#l07592">ScalarEvolution.cpp:7592</a></div></div>
<div class="ttc" id="classllvm_1_1DominatorTree_html_aa094180f7ac0ef9d4b8e1c78f850edd8"><div class="ttname"><a href="classllvm_1_1DominatorTree.html#aa094180f7ac0ef9d4b8e1c78f850edd8">llvm::DominatorTree::properlyDominates</a></div><div class="ttdeci">bool properlyDominates(const DomTreeNode *A, const DomTreeNode *B) const </div><div class="ttdef"><b>Definition:</b> <a href="Dominators_8h_source.html#l00818">Dominators.h:818</a></div></div>
<div class="ttc" id="classllvm_1_1SCEVAddRecExpr_html_a443e9130cd9f3e3baaa1b566e6aa5060"><div class="ttname"><a href="classllvm_1_1SCEVAddRecExpr.html#a443e9130cd9f3e3baaa1b566e6aa5060">llvm::SCEVAddRecExpr::getStepRecurrence</a></div><div class="ttdeci">const SCEV * getStepRecurrence(ScalarEvolution &amp;SE) const </div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolutionExpressions_8h_source.html#l00300">ScalarEvolutionExpressions.h:300</a></div></div>
<div class="ttc" id="classllvm_1_1CmpInst_html_a283f9a5d4d843d20c40bb4d3e364bb05ad601460c9371d0f0ada5ae006bdba2bd"><div class="ttname"><a href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05ad601460c9371d0f0ada5ae006bdba2bd">llvm::CmpInst::FCMP_UNE</a></div><div class="ttdoc">1 1 1 0 True if unordered or not equal </div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00667">InstrTypes.h:667</a></div></div>
<div class="ttc" id="classllvm_1_1SCEVExpander_html_ac3ae3288532d1f9b8b5f4a1445b58697"><div class="ttname"><a href="classllvm_1_1SCEVExpander.html#ac3ae3288532d1f9b8b5f4a1445b58697">llvm::SCEVExpander::setDebugType</a></div><div class="ttdeci">void setDebugType(const char *s)</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolutionExpander_8h_source.html#l00104">ScalarEvolutionExpander.h:104</a></div></div>
<div class="ttc" id="classllvm_1_1ScalarEvolution_html_a5a19768af81df7e5fe571bc08dcd48b3"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html#a5a19768af81df7e5fe571bc08dcd48b3">llvm::ScalarEvolution::isLoopInvariant</a></div><div class="ttdeci">bool isLoopInvariant(const SCEV *S, const Loop *L)</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8cpp_source.html#l07497">ScalarEvolution.cpp:7497</a></div></div>
<div class="ttc" id="classllvm_1_1Type_html_a05186fa23e4d11b9855a9599ba87a4b7"><div class="ttname"><a href="classllvm_1_1Type.html#a05186fa23e4d11b9855a9599ba87a4b7">llvm::Type::getInt64Ty</a></div><div class="ttdeci">static IntegerType * getInt64Ty(LLVMContext &amp;C)</div><div class="ttdef"><b>Definition:</b> <a href="Type_8cpp_source.html#l00242">Type.cpp:242</a></div></div>
<div class="ttc" id="classllvm_1_1User_html"><div class="ttname"><a href="classllvm_1_1User.html">llvm::User</a></div><div class="ttdef"><b>Definition:</b> <a href="User_8h_source.html#l00033">User.h:33</a></div></div>
<div class="ttc" id="IndVarSimplify_8cpp_html_a06d60699222d90683b12445041df2872"><div class="ttname"><a href="IndVarSimplify_8cpp.html#a06d60699222d90683b12445041df2872">canExpandBackedgeTakenCount</a></div><div class="ttdeci">static bool canExpandBackedgeTakenCount(Loop *L, ScalarEvolution *SE)</div><div class="ttdef"><b>Definition:</b> <a href="IndVarSimplify_8cpp_source.html#l01202">IndVarSimplify.cpp:1202</a></div></div>
<div class="ttc" id="classllvm_1_1LoopBase_html_a57432ae698fc4437dc07d23031a0cb02"><div class="ttname"><a href="classllvm_1_1LoopBase.html#a57432ae698fc4437dc07d23031a0cb02">llvm::LoopBase::getExitBlock</a></div><div class="ttdeci">BlockT * getExitBlock() const </div><div class="ttdef"><b>Definition:</b> <a href="LoopInfoImpl_8h_source.html#l00076">LoopInfoImpl.h:76</a></div></div>
<div class="ttc" id="Statistic_8h_html"><div class="ttname"><a href="Statistic_8h.html">Statistic.h</a></div></div>
<div class="ttc" id="IndVarSimplify_8cpp_html_a9cc6c5ed9edaa15e526e2a5ad24d1413"><div class="ttname"><a href="IndVarSimplify_8cpp.html#a9cc6c5ed9edaa15e526e2a5ad24d1413">hasConcreteDef</a></div><div class="ttdeci">static bool hasConcreteDef(Value *V)</div><div class="ttdef"><b>Definition:</b> <a href="IndVarSimplify_8cpp_source.html#l01350">IndVarSimplify.cpp:1350</a></div></div>
<div class="ttc" id="classllvm_1_1User_html_a2eeb1c7ed1cfe403f2ae0470e36c07e2"><div class="ttname"><a href="classllvm_1_1User.html#a2eeb1c7ed1cfe403f2ae0470e36c07e2">llvm::User::op_begin</a></div><div class="ttdeci">op_iterator op_begin()</div><div class="ttdef"><b>Definition:</b> <a href="User_8h_source.html#l00116">User.h:116</a></div></div>
<div class="ttc" id="IndVarSimplify_8cpp_html_a27572260ed728be1d7fc7ce1659ea2f6"><div class="ttname"><a href="IndVarSimplify_8cpp.html#a27572260ed728be1d7fc7ce1659ea2f6">hasConcreteDefImpl</a></div><div class="ttdeci">static bool hasConcreteDefImpl(Value *V, SmallPtrSet&lt; Value *, 8 &gt; &amp;Visited, unsigned Depth)</div><div class="ttdef"><b>Definition:</b> <a href="IndVarSimplify_8cpp_source.html#l01317">IndVarSimplify.cpp:1317</a></div></div>
<div class="ttc" id="namespacellvm_1_1ARM__PROC_html_a1add7850fad3f66c140ecee871460ea4ae9d798593a4a6b5cc48486a453a59e5e"><div class="ttname"><a href="namespacellvm_1_1ARM__PROC.html#a1add7850fad3f66c140ecee871460ea4ae9d798593a4a6b5cc48486a453a59e5e">llvm::ARM_PROC::IE</a></div><div class="ttdef"><b>Definition:</b> <a href="ARMBaseInfo_8h_source.html#l00091">ARMBaseInfo.h:91</a></div></div>
<div class="ttc" id="namespacellvm_1_1cl_html_a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6"><div class="ttname"><a href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">llvm::cl::Hidden</a></div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l00109">CommandLine.h:109</a></div></div>
<div class="ttc" id="classllvm_1_1SCEVAddRecExpr_html_a0d53a749bd858b270d322b34b8d7e1e5"><div class="ttname"><a href="classllvm_1_1SCEVAddRecExpr.html#a0d53a749bd858b270d322b34b8d7e1e5">llvm::SCEVAddRecExpr::getStart</a></div><div class="ttdeci">const SCEV * getStart() const </div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolutionExpressions_8h_source.html#l00293">ScalarEvolutionExpressions.h:293</a></div></div>
<div class="ttc" id="classllvm_1_1Value_html_ad452febc1ac0b394876e640ec03ffa38"><div class="ttname"><a href="classllvm_1_1Value.html#ad452febc1ac0b394876e640ec03ffa38">llvm::Value::getName</a></div><div class="ttdeci">StringRef getName() const </div><div class="ttdef"><b>Definition:</b> <a href="Value_8cpp_source.html#l00167">Value.cpp:167</a></div></div>
<div class="ttc" id="classllvm_1_1LoopBase_html_a8917d359fc92f25eb0117386588c6f1c"><div class="ttname"><a href="classllvm_1_1LoopBase.html#a8917d359fc92f25eb0117386588c6f1c">llvm::LoopBase::getLoopLatch</a></div><div class="ttdeci">BlockT * getLoopLatch() const </div><div class="ttdef"><b>Definition:</b> <a href="LoopInfoImpl_8h_source.html#l00154">LoopInfoImpl.h:154</a></div></div>
<div class="ttc" id="classllvm_1_1BasicBlock_html_a0ed5f3ab3c2e4196ee0cffffa080c062"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a0ed5f3ab3c2e4196ee0cffffa080c062">llvm::BasicBlock::begin</a></div><div class="ttdeci">iterator begin()</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00193">BasicBlock.h:193</a></div></div>
<div class="ttc" id="ScalarEvolutionExpander_8h_html"><div class="ttname"><a href="ScalarEvolutionExpander_8h.html">ScalarEvolutionExpander.h</a></div></div>
<div class="ttc" id="classllvm_1_1CmpInst_html_a283f9a5d4d843d20c40bb4d3e364bb05a919643b83ce3c9af2e4296ed5e413a1f"><div class="ttname"><a href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05a919643b83ce3c9af2e4296ed5e413a1f">llvm::CmpInst::FCMP_UEQ</a></div><div class="ttdoc">1 0 0 1 True if unordered or equal </div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00662">InstrTypes.h:662</a></div></div>
<div class="ttc" id="IndVarSimplify_8cpp_html_adf86ad66e16c57783ecd95531fa505d0"><div class="ttname"><a href="IndVarSimplify_8cpp.html#adf86ad66e16c57783ecd95531fa505d0">genLoopLimit</a></div><div class="ttdeci">static Value * genLoopLimit(PHINode *IndVar, const SCEV *IVCount, Loop *L, SCEVExpander &amp;Rewriter, ScalarEvolution *SE)</div><div class="ttdef"><b>Definition:</b> <a href="IndVarSimplify_8cpp_source.html#l01470">IndVarSimplify.cpp:1470</a></div></div>
<div class="ttc" id="classllvm_1_1IVVisitor_html"><div class="ttname"><a href="classllvm_1_1IVVisitor.html">llvm::IVVisitor</a></div><div class="ttdef"><b>Definition:</b> <a href="SimplifyIndVar_8h_source.html#l00033">SimplifyIndVar.h:33</a></div></div>
<div class="ttc" id="classllvm_1_1AnalysisUsage_html_ae5c60fd282ee894c87ea02c3f0fcb6d0"><div class="ttname"><a href="classllvm_1_1AnalysisUsage.html#ae5c60fd282ee894c87ea02c3f0fcb6d0">llvm::AnalysisUsage::addRequired</a></div><div class="ttdeci">AnalysisUsage &amp; addRequired()</div><div class="ttdef"><b>Definition:</b> <a href="PassAnalysisSupport_8h_source.html#l00055">PassAnalysisSupport.h:55</a></div></div>
<div class="ttc" id="PassSupport_8h_html_a14724f1ccf528e73bb29bc9230737967"><div class="ttname"><a href="PassSupport_8h.html#a14724f1ccf528e73bb29bc9230737967">INITIALIZE_PASS_DEPENDENCY</a></div><div class="ttdeci">#define INITIALIZE_PASS_DEPENDENCY(depName)</div><div class="ttdef"><b>Definition:</b> <a href="PassSupport_8h_source.html#l00167">PassSupport.h:167</a></div></div>
<div class="ttc" id="classllvm_1_1value__use__iterator_html"><div class="ttname"><a href="classllvm_1_1value__use__iterator.html">llvm::value_use_iterator</a></div><div class="ttdef"><b>Definition:</b> <a href="Use_8h_source.html#l00168">Use.h:168</a></div></div>
<div class="ttc" id="classllvm_1_1CastInst_html"><div class="ttname"><a href="classllvm_1_1CastInst.html">llvm::CastInst</a></div><div class="ttdoc">Base class of casting instructions. </div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00387">InstrTypes.h:387</a></div></div>
<div class="ttc" id="LoopInfo_8h_html"><div class="ttname"><a href="LoopInfo_8h.html">LoopInfo.h</a></div></div>
<div class="ttc" id="classllvm_1_1CmpInst_html_a283f9a5d4d843d20c40bb4d3e364bb05ac17897ebf2f6a6986280fc3bdf28a30a"><div class="ttname"><a href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05ac17897ebf2f6a6986280fc3bdf28a30a">llvm::CmpInst::ICMP_NE</a></div><div class="ttdoc">not equal </div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00673">InstrTypes.h:673</a></div></div>
<div class="ttc" id="classllvm_1_1SmallVectorImpl_html_a400eaca9881c8dcab97e9f42b1ab1815"><div class="ttname"><a href="classllvm_1_1SmallVectorImpl.html#a400eaca9881c8dcab97e9f42b1ab1815">llvm::SmallVectorImpl::pop_back_val</a></div><div class="ttdeci">T LLVM_ATTRIBUTE_UNUSED_RESULT pop_back_val()</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00430">SmallVector.h:430</a></div></div>
<div class="ttc" id="classllvm_1_1APFloat_html_a796301cd33da892bb1971f3d03e36cb6"><div class="ttname"><a href="classllvm_1_1APFloat.html#a796301cd33da892bb1971f3d03e36cb6">llvm::APFloat::convertToInteger</a></div><div class="ttdeci">opStatus convertToInteger(integerPart *, unsigned int, bool, roundingMode, bool *) const </div><div class="ttdef"><b>Definition:</b> <a href="APFloat_8cpp_source.html#l02157">APFloat.cpp:2157</a></div></div>
<div class="ttc" id="classllvm_1_1Use_html"><div class="ttname"><a href="classllvm_1_1Use.html">llvm::Use</a></div><div class="ttdef"><b>Definition:</b> <a href="Use_8h_source.html#l00060">Use.h:60</a></div></div>
<div class="ttc" id="IndVarSimplify_8cpp_html_af945460922a5750a0d075b6344608e27"><div class="ttname"><a href="IndVarSimplify_8cpp.html#af945460922a5750a0d075b6344608e27">ConvertToSInt</a></div><div class="ttdeci">static bool ConvertToSInt(const APFloat &amp;APF, int64_t &amp;IntVal)</div><div class="ttdoc">ConvertToSInt - Convert APF to an integer, if possible. </div><div class="ttdef"><b>Definition:</b> <a href="IndVarSimplify_8cpp_source.html#l00221">IndVarSimplify.cpp:221</a></div></div>
<div class="ttc" id="classllvm_1_1SCEVNAryExpr_html_a82ad83d40ce0e57efef84b421c7f805a"><div class="ttname"><a href="classllvm_1_1SCEVNAryExpr.html#a82ad83d40ce0e57efef84b421c7f805a">llvm::SCEVNAryExpr::op_iterator</a></div><div class="ttdeci">const SCEV *const * op_iterator</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolutionExpressions_8h_source.html#l00153">ScalarEvolutionExpressions.h:153</a></div></div>
<div class="ttc" id="classllvm_1_1SmallVectorImpl_html"><div class="ttname"><a href="classllvm_1_1SmallVectorImpl.html">llvm::SmallVectorImpl</a></div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l00035">APInt.h:35</a></div></div>
<div class="ttc" id="PassSupport_8h_html_a74ce8276b89067e806f67c45a6d92575"><div class="ttname"><a href="PassSupport_8h.html#a74ce8276b89067e806f67c45a6d92575">INITIALIZE_PASS_END</a></div><div class="ttdeci">#define INITIALIZE_PASS_END(passName, arg, name, cfg, analysis)</div><div class="ttdef"><b>Definition:</b> <a href="PassSupport_8h_source.html#l00172">PassSupport.h:172</a></div></div>
<div class="ttc" id="classllvm_1_1IRBuilder_html"><div class="ttname"><a href="classllvm_1_1IRBuilder.html">llvm::IRBuilder</a></div><div class="ttdoc">This provides a uniform API for creating instructions and inserting them into a basic block: either a...</div><div class="ttdef"><b>Definition:</b> <a href="IRBuilder_8h_source.html#l00421">IRBuilder.h:421</a></div></div>
<div class="ttc" id="IndVarSimplify_8cpp_html_afd69f4b50f751466f1a674b2cf6078c5"><div class="ttname"><a href="IndVarSimplify_8cpp.html#afd69f4b50f751466f1a674b2cf6078c5">isHighCostExpansion</a></div><div class="ttdeci">static bool isHighCostExpansion(const SCEV *S, BranchInst *BI, SmallPtrSet&lt; const SCEV *, 8 &gt; &amp;Processed, ScalarEvolution *SE)</div><div class="ttdef"><b>Definition:</b> <a href="IndVarSimplify_8cpp_source.html#l01143">IndVarSimplify.cpp:1143</a></div></div>
<div class="ttc" id="classllvm_1_1CmpInst_html_a283f9a5d4d843d20c40bb4d3e364bb05a9835cfe02fb5027680bd7203b024f77a"><div class="ttname"><a href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05a9835cfe02fb5027680bd7203b024f77a">llvm::CmpInst::FCMP_OLE</a></div><div class="ttdoc">0 1 0 1 True if ordered and less than or equal </div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00658">InstrTypes.h:658</a></div></div>
<div class="ttc" id="classllvm_1_1ScalarEvolution_html_a983dbdce6af7840357ed33a20c8f30bb"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html#a983dbdce6af7840357ed33a20c8f30bb">llvm::ScalarEvolution::getTypeSizeInBits</a></div><div class="ttdeci">uint64_t getTypeSizeInBits(Type *Ty) const </div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8cpp_source.html#l02666">ScalarEvolution.cpp:2666</a></div></div>
<div class="ttc" id="namespacefalse_html"><div class="ttname"><a href="namespacefalse.html">false</a></div><div class="ttdef"><b>Definition:</b> <a href="StackSlotColoring_8cpp_source.html#l00126">StackSlotColoring.cpp:126</a></div></div>
<div class="ttc" id="namespacellvm_1_1CallingConv_html_a4f861731fc6dbfdccc05af5968d98974"><div class="ttname"><a href="namespacellvm_1_1CallingConv.html#a4f861731fc6dbfdccc05af5968d98974">llvm::CallingConv::ID</a></div><div class="ttdeci">ID</div><div class="ttdoc">LLVM Calling Convention Representation. </div><div class="ttdef"><b>Definition:</b> <a href="CallingConv_8h_source.html#l00026">CallingConv.h:26</a></div></div>
<div class="ttc" id="classllvm_1_1Instruction_html_af6aad0c9ba7b8720130235c9621b55b5"><div class="ttname"><a href="classllvm_1_1Instruction.html#af6aad0c9ba7b8720130235c9621b55b5">llvm::Instruction::clone</a></div><div class="ttdeci">Instruction * clone() const </div><div class="ttdef"><b>Definition:</b> <a href="Instruction_8cpp_source.html#l00541">Instruction.cpp:541</a></div></div>
<div class="ttc" id="classllvm_1_1Instruction_html"><div class="ttname"><a href="classllvm_1_1Instruction.html">llvm::Instruction</a></div><div class="ttdef"><b>Definition:</b> <a href="Instruction_8h_source.html#l00031">Instruction.h:31</a></div></div>
<div class="ttc" id="TargetLibraryInfo_8h_html"><div class="ttname"><a href="TargetLibraryInfo_8h.html">TargetLibraryInfo.h</a></div></div>
<div class="ttc" id="classllvm_1_1Loop_html_a1d4445ebce66137e57fbaa967a19d7e9"><div class="ttname"><a href="classllvm_1_1Loop.html#a1d4445ebce66137e57fbaa967a19d7e9">llvm::Loop::isLoopSimplifyForm</a></div><div class="ttdeci">bool isLoopSimplifyForm() const </div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8cpp_source.html#l00207">LoopInfo.cpp:207</a></div></div>
<div class="ttc" id="Dominators_8h_html"><div class="ttname"><a href="Dominators_8h.html">Dominators.h</a></div></div>
<div class="ttc" id="SimplifyIndVar_8h_html"><div class="ttname"><a href="SimplifyIndVar_8h.html">SimplifyIndVar.h</a></div></div>
<div class="ttc" id="namespacellvm_html_adead3a49058bc795978ec97b9c99e1a2"><div class="ttname"><a href="namespacellvm.html#adead3a49058bc795978ec97b9c99e1a2">llvm::simplifyUsersOfIV</a></div><div class="ttdeci">bool simplifyUsersOfIV(PHINode *CurrIV, ScalarEvolution *SE, LPPassManager *LPM, SmallVectorImpl&lt; WeakVH &gt; &amp;Dead, IVVisitor *V=NULL)</div><div class="ttdef"><b>Definition:</b> <a href="SimplifyIndVar_8cpp_source.html#l00373">SimplifyIndVar.cpp:373</a></div></div>
<div class="ttc" id="classllvm_1_1Instruction_html_a0fd8d3c26bf5cd614b0e6a9b8886a5d0"><div class="ttname"><a href="classllvm_1_1Instruction.html#a0fd8d3c26bf5cd614b0e6a9b8886a5d0">llvm::Instruction::mayReadFromMemory</a></div><div class="ttdeci">bool mayReadFromMemory() const </div><div class="ttdef"><b>Definition:</b> <a href="Instruction_8cpp_source.html#l00421">Instruction.cpp:421</a></div></div>
<div class="ttc" id="classllvm_1_1SCEVAddRecExpr_html"><div class="ttname"><a href="classllvm_1_1SCEVAddRecExpr.html">llvm::SCEVAddRecExpr</a></div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolutionExpressions_8h_source.html#l00283">ScalarEvolutionExpressions.h:283</a></div></div>
<div class="ttc" id="classllvm_1_1SmallVectorBase_html_a8a8df4d85555c7954a95f86080cd3b64"><div class="ttname"><a href="classllvm_1_1SmallVectorBase.html#a8a8df4d85555c7954a95f86080cd3b64">llvm::SmallVectorBase::empty</a></div><div class="ttdeci">bool LLVM_ATTRIBUTE_UNUSED_RESULT empty() const </div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00056">SmallVector.h:56</a></div></div>
<div class="ttc" id="classllvm_1_1WeakVH_html"><div class="ttname"><a href="classllvm_1_1WeakVH.html">llvm::WeakVH</a></div><div class="ttdef"><b>Definition:</b> <a href="ValueHandle_8h_source.html#l00145">ValueHandle.h:145</a></div></div>
<div class="ttc" id="classllvm_1_1SCEVNAryExpr_html_aed1b1d3b764c76210c67dd1b4a6be2f2"><div class="ttname"><a href="classllvm_1_1SCEVNAryExpr.html#aed1b1d3b764c76210c67dd1b4a6be2f2">llvm::SCEVNAryExpr::getType</a></div><div class="ttdeci">Type * getType() const </div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolutionExpressions_8h_source.html#l00157">ScalarEvolutionExpressions.h:157</a></div></div>
<div class="ttc" id="classllvm_1_1FCmpInst_html"><div class="ttname"><a href="classllvm_1_1FCmpInst.html">llvm::FCmpInst</a></div><div class="ttdoc">Represents a floating point comparison operator. </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l01055">Instructions.h:1055</a></div></div>
<div class="ttc" id="IndVarSimplify_8cpp_html_a7dd1919a4d3379a4810f52ee7bbcd3c8"><div class="ttname"><a href="IndVarSimplify_8cpp.html#a7dd1919a4d3379a4810f52ee7bbcd3c8">VerifyIndvars</a></div><div class="ttdeci">static cl::opt&lt; bool &gt; VerifyIndvars(&quot;verify-indvars&quot;, cl::Hidden, cl::desc(&quot;Verify the ScalarEvolution result after running indvars&quot;))</div></div>
<div class="ttc" id="classllvm_1_1BranchInst_html_a74e70ecbb79defbbfa6f6c87f76155bf"><div class="ttname"><a href="classllvm_1_1BranchInst.html#a74e70ecbb79defbbfa6f6c87f76155bf">llvm::BranchInst::getSuccessor</a></div><div class="ttdeci">BasicBlock * getSuccessor(unsigned i) const </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02406">Instructions.h:2406</a></div></div>
<div class="ttc" id="classllvm_1_1ScalarEvolution_html_a5b01f1061607731f6d2953b935649570"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html#a5b01f1061607731f6d2953b935649570">llvm::ScalarEvolution::getSizeOfExpr</a></div><div class="ttdeci">const SCEV * getSizeOfExpr(Type *IntTy, Type *AllocTy)</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8cpp_source.html#l02593">ScalarEvolution.cpp:2593</a></div></div>
<div class="ttc" id="namespacellvm_html_af6d6a791770bad2303c4399986979e3eae411369b2f0d8f484fec62c3291b1b51"><div class="ttname"><a href="namespacellvm.html#af6d6a791770bad2303c4399986979e3eae411369b2f0d8f484fec62c3291b1b51">llvm::Call</a></div><div class="ttdef"><b>Definition:</b> <a href="CallingConvLower_8h_source.html#l00149">CallingConvLower.h:149</a></div></div>
<div class="ttc" id="classllvm_1_1AnalysisUsage_html_a40970e5d42646fb2d9aa5f7a2c879516"><div class="ttname"><a href="classllvm_1_1AnalysisUsage.html#a40970e5d42646fb2d9aa5f7a2c879516">llvm::AnalysisUsage::addPreservedID</a></div><div class="ttdeci">AnalysisUsage &amp; addPreservedID(const void *ID)</div><div class="ttdef"><b>Definition:</b> <a href="PassAnalysisSupport_8h_source.html#l00068">PassAnalysisSupport.h:68</a></div></div>
<div class="ttc" id="classllvm_1_1LoopInfo_html_a4abca289c73cd09487e05d11d9f7d877"><div class="ttname"><a href="classllvm_1_1LoopInfo.html#a4abca289c73cd09487e05d11d9f7d877">llvm::LoopInfo::getLoopFor</a></div><div class="ttdeci">Loop * getLoopFor(const BasicBlock *BB) const </div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l00618">LoopInfo.h:618</a></div></div>
<div class="ttc" id="classllvm_1_1Value_html_a3ab5fc45117b450e8bb04e564cb6e5f2"><div class="ttname"><a href="classllvm_1_1Value.html#a3ab5fc45117b450e8bb04e564cb6e5f2">llvm::Value::replaceAllUsesWith</a></div><div class="ttdeci">void replaceAllUsesWith(Value *V)</div><div class="ttdef"><b>Definition:</b> <a href="Value_8cpp_source.html#l00303">Value.cpp:303</a></div></div>
<div class="ttc" id="classllvm_1_1ScalarEvolution_html_abb976145b00ae108c1d6b98c4f099d27"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html#abb976145b00ae108c1d6b98c4f099d27">llvm::ScalarEvolution::getEffectiveSCEVType</a></div><div class="ttdeci">Type * getEffectiveSCEVType(Type *Ty) const </div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8cpp_source.html#l02687">ScalarEvolution.cpp:2687</a></div></div>
<div class="ttc" id="classllvm_1_1Value_html_ae855357b6c5e6e7ed1869272708a3a84"><div class="ttname"><a href="classllvm_1_1Value.html#ae855357b6c5e6e7ed1869272708a3a84">llvm::Value::takeName</a></div><div class="ttdeci">void takeName(Value *V)</div><div class="ttdef"><b>Definition:</b> <a href="Value_8cpp_source.html#l00239">Value.cpp:239</a></div></div>
<div class="ttc" id="classllvm_1_1DominatorTree_html"><div class="ttname"><a href="classllvm_1_1DominatorTree.html">llvm::DominatorTree</a></div><div class="ttdef"><b>Definition:</b> <a href="Dominators_8h_source.html#l00740">Dominators.h:740</a></div></div>
<div class="ttc" id="classllvm_1_1IRBuilderBase_html_ace45cae6925c65e9d6916e09dd5b17cc"><div class="ttname"><a href="classllvm_1_1IRBuilderBase.html#ace45cae6925c65e9d6916e09dd5b17cc">llvm::IRBuilderBase::SetInsertPoint</a></div><div class="ttdeci">void SetInsertPoint(BasicBlock *TheBB)</div><div class="ttdoc">This specifies that created instructions should be appended to the end of the specified block...</div><div class="ttdef"><b>Definition:</b> <a href="IRBuilder_8h_source.html#l00083">IRBuilder.h:83</a></div></div>
<div class="ttc" id="classllvm_1_1PHINode_html_aa45f6c0433576e3858a6209a43750ad4"><div class="ttname"><a href="classllvm_1_1PHINode.html#aa45f6c0433576e3858a6209a43750ad4">llvm::PHINode::getNumIncomingValues</a></div><div class="ttdeci">unsigned getNumIncomingValues() const </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02055">Instructions.h:2055</a></div></div>
<div class="ttc" id="classllvm_1_1SCEVExpander_html_a647982e2639d56e8f172122bb422aca1"><div class="ttname"><a href="classllvm_1_1SCEVExpander.html#a647982e2639d56e8f172122bb422aca1">llvm::SCEVExpander::clearInsertPoint</a></div><div class="ttdeci">void clearInsertPoint()</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolutionExpander_8h_source.html#l00177">ScalarEvolutionExpander.h:177</a></div></div>
<div class="ttc" id="classllvm_1_1SCEVExpander_html_aa9bcc84c7b023d3b1321851509110dae"><div class="ttname"><a href="classllvm_1_1SCEVExpander.html#aa9bcc84c7b023d3b1321851509110dae">llvm::SCEVExpander::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolutionExpander_8h_source.html#l00110">ScalarEvolutionExpander.h:110</a></div></div>
<div class="ttc" id="IndVarSimplify_8cpp_html_aba556f596da7fa80d6e9bb43b7d2c1f5"><div class="ttname"><a href="IndVarSimplify_8cpp.html#aba556f596da7fa80d6e9bb43b7d2c1f5">STATISTIC</a></div><div class="ttdeci">STATISTIC(NumWidened,&quot;Number of indvars widened&quot;)</div></div>
<div class="ttc" id="classllvm_1_1APFloat_html"><div class="ttname"><a href="classllvm_1_1APFloat.html">llvm::APFloat</a></div><div class="ttdoc">A self-contained host- and target-independent arbitrary-precision floating-point software implementat...</div><div class="ttdef"><b>Definition:</b> <a href="APFloat_8h_source.html#l00122">APFloat.h:122</a></div></div>
<div class="ttc" id="CommandLine_8h_html"><div class="ttname"><a href="CommandLine_8h.html">CommandLine.h</a></div></div>
<div class="ttc" id="namespacellvm_1_1AArch64ISD_html_a246d89cb58f606179b1435937830bbdca84e96c468affe3b1fd3076b4fc5d063e"><div class="ttname"><a href="namespacellvm_1_1AArch64ISD.html#a246d89cb58f606179b1435937830bbdca84e96c468affe3b1fd3076b4fc5d063e">llvm::AArch64ISD::Ret</a></div><div class="ttdef"><b>Definition:</b> <a href="AArch64ISelLowering_8h_source.html#l00060">AArch64ISelLowering.h:60</a></div></div>
<div class="ttc" id="classllvm_1_1SCEVAddRecExpr_html_a88f514461ddb0af0fc59ac4639f644bc"><div class="ttname"><a href="classllvm_1_1SCEVAddRecExpr.html#a88f514461ddb0af0fc59ac4639f644bc">llvm::SCEVAddRecExpr::isAffine</a></div><div class="ttdeci">bool isAffine() const </div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolutionExpressions_8h_source.html#l00309">ScalarEvolutionExpressions.h:309</a></div></div>
<div class="ttc" id="classllvm_1_1ScalarEvolution_html_ae9623974341419bfd1d185cfdc65bedd"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html#ae9623974341419bfd1d185cfdc65bedd">llvm::ScalarEvolution::isSCEVable</a></div><div class="ttdeci">bool isSCEVable(Type *Ty) const </div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8cpp_source.html#l02659">ScalarEvolution.cpp:2659</a></div></div>
<div class="ttc" id="LoopPass_8h_html"><div class="ttname"><a href="LoopPass_8h.html">LoopPass.h</a></div></div>
<div class="ttc" id="classllvm_1_1LoopBase_html_a1bc74c76b876ad387293ecde0f21ed45"><div class="ttname"><a href="classllvm_1_1LoopBase.html#a1bc74c76b876ad387293ecde0f21ed45">llvm::LoopBase::getLoopPreheader</a></div><div class="ttdeci">BlockT * getLoopPreheader() const </div><div class="ttdef"><b>Definition:</b> <a href="LoopInfoImpl_8h_source.html#l00106">LoopInfoImpl.h:106</a></div></div>
<div class="ttc" id="classllvm_1_1SmallVectorTemplateCommon_html_acd9e771a3296c6b24146955754620557"><div class="ttname"><a href="classllvm_1_1SmallVectorTemplateCommon.html#acd9e771a3296c6b24146955754620557">llvm::SmallVectorTemplateCommon&lt; T &gt;::back</a></div><div class="ttdeci">reference back()</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00157">SmallVector.h:157</a></div></div>
<div class="ttc" id="classllvm_1_1Instruction_html_a482498a1c760122fd33c7fc8190dd277"><div class="ttname"><a href="classllvm_1_1Instruction.html#a482498a1c760122fd33c7fc8190dd277">llvm::Instruction::insertBefore</a></div><div class="ttdeci">void insertBefore(Instruction *InsertPos)</div><div class="ttdef"><b>Definition:</b> <a href="Instruction_8cpp_source.html#l00078">Instruction.cpp:78</a></div></div>
<div class="ttc" id="classllvm_1_1SmallVectorImpl_html_aac0ea55010b7b1a301e65a0baea057aa"><div class="ttname"><a href="classllvm_1_1SmallVectorImpl.html#aac0ea55010b7b1a301e65a0baea057aa">llvm::SmallVectorImpl::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00396">SmallVector.h:396</a></div></div>
<div class="ttc" id="classllvm_1_1BasicBlock_html"><div class="ttname"><a href="classllvm_1_1BasicBlock.html">llvm::BasicBlock</a></div><div class="ttdoc">LLVM Basic Block Representation. </div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00072">BasicBlock.h:72</a></div></div>
<div class="ttc" id="classllvm_1_1Type_html"><div class="ttname"><a href="classllvm_1_1Type.html">llvm::Type</a></div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00044">Type.h:44</a></div></div>
<div class="ttc" id="classllvm_1_1SCEV_html_a9a16f1241255a605fc8debc1e26eaa4c"><div class="ttname"><a href="classllvm_1_1SCEV.html#a9a16f1241255a605fc8debc1e26eaa4c">llvm::SCEV::getType</a></div><div class="ttdeci">Type * getType() const </div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8cpp_source.html#l00249">ScalarEvolution.cpp:249</a></div></div>
<div class="ttc" id="namespacellvm_1_1tgtok_html_abbc5259d649363016626e2529fabe0c5aceb138f68fe183995736614928e3394a"><div class="ttname"><a href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5aceb138f68fe183995736614928e3394a">llvm::tgtok::Def</a></div><div class="ttdef"><b>Definition:</b> <a href="TGLexer_8h_source.html#l00046">TGLexer.h:46</a></div></div>
<div class="ttc" id="classllvm_1_1BranchInst_html"><div class="ttname"><a href="classllvm_1_1BranchInst.html">llvm::BranchInst</a></div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02350">Instructions.h:2350</a></div></div>
<div class="ttc" id="namespacellvm_1_1tgtok_html_abbc5259d649363016626e2529fabe0c5a3a7597ca475c0fcf10856ef36351d1ac"><div class="ttname"><a href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5a3a7597ca475c0fcf10856ef36351d1ac">llvm::tgtok::IntVal</a></div><div class="ttdef"><b>Definition:</b> <a href="TGLexer_8h_source.html#l00054">TGLexer.h:54</a></div></div>
<div class="ttc" id="Support_2CFG_8h_html"><div class="ttname"><a href="Support_2CFG_8h.html">CFG.h</a></div></div>
<div class="ttc" id="Constants_8h_html"><div class="ttname"><a href="Constants_8h.html">Constants.h</a></div></div>
<div class="ttc" id="namespacellvm_1_1APIntOps_html_a22f056804d2b9882f74adc905872bc39"><div class="ttname"><a href="namespacellvm_1_1APIntOps.html#a22f056804d2b9882f74adc905872bc39">llvm::APIntOps::Or</a></div><div class="ttdeci">APInt Or(const APInt &amp;LHS, const APInt &amp;RHS)</div><div class="ttdoc">Bitwise OR function for APInt. </div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l01845">APInt.h:1845</a></div></div>
<div class="ttc" id="namespacellvm_html_abe283966f269761ee387642061c4451e"><div class="ttname"><a href="namespacellvm.html#abe283966f269761ee387642061c4451e">llvm::isInstructionTriviallyDead</a></div><div class="ttdeci">bool isInstructionTriviallyDead(Instruction *I, const TargetLibraryInfo *TLI=0)</div><div class="ttdef"><b>Definition:</b> <a href="Local_8cpp_source.html#l00266">Local.cpp:266</a></div></div>
<div class="ttc" id="classllvm_1_1ConstantFP_html"><div class="ttname"><a href="classllvm_1_1ConstantFP.html">llvm::ConstantFP</a></div><div class="ttdef"><b>Definition:</b> <a href="Constants_8h_source.html#l00232">Constants.h:232</a></div></div>
<div class="ttc" id="namespacellvm_html_a3e3d3c6d4e33a4f5ca579ee7939f0349"><div class="ttname"><a href="namespacellvm.html#a3e3d3c6d4e33a4f5ca579ee7939f0349">llvm::LCSSAID</a></div><div class="ttdeci">char &amp; LCSSAID</div><div class="ttdef"><b>Definition:</b> <a href="LCSSA_8cpp_source.html#l00094">LCSSA.cpp:94</a></div></div>
<div class="ttc" id="structllvm_1_1cl_1_1desc_html"><div class="ttname"><a href="structllvm_1_1cl_1_1desc.html">llvm::cl::desc</a></div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l00286">CommandLine.h:286</a></div></div>
<div class="ttc" id="namespacellvm_1_1APIntOps_html_afc7c4d88d09cba0c5e920f8a3a3ace55"><div class="ttname"><a href="namespacellvm_1_1APIntOps.html#afc7c4d88d09cba0c5e920f8a3a3ace55">llvm::APIntOps::Xor</a></div><div class="ttdeci">APInt Xor(const APInt &amp;LHS, const APInt &amp;RHS)</div><div class="ttdoc">Bitwise XOR function for APInt. </div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l01850">APInt.h:1850</a></div></div>
<div class="ttc" id="classllvm_1_1ScalarEvolution_html_a21d6ee82eed29080d911dbb548a8bb68"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html#a21d6ee82eed29080d911dbb548a8bb68">llvm::ScalarEvolution::getSCEVAtScope</a></div><div class="ttdeci">const SCEV * getSCEVAtScope(const SCEV *S, const Loop *L)</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8cpp_source.html#l05060">ScalarEvolution.cpp:5060</a></div></div>
<div class="ttc" id="classllvm_1_1AnalysisUsage_html"><div class="ttname"><a href="classllvm_1_1AnalysisUsage.html">llvm::AnalysisUsage</a></div><div class="ttdef"><b>Definition:</b> <a href="PassAnalysisSupport_8h_source.html#l00037">PassAnalysisSupport.h:37</a></div></div>
<div class="ttc" id="classllvm_1_1User_html_af41f58e730804d10b91fcff39b035f74"><div class="ttname"><a href="classllvm_1_1User.html#af41f58e730804d10b91fcff39b035f74">llvm::User::op_end</a></div><div class="ttdeci">op_iterator op_end()</div><div class="ttdef"><b>Definition:</b> <a href="User_8h_source.html#l00118">User.h:118</a></div></div>
<div class="ttc" id="classllvm_1_1PHINode_html_afb5e83bf5123ff7c51058eb0ebebcdc6"><div class="ttname"><a href="classllvm_1_1PHINode.html#afb5e83bf5123ff7c51058eb0ebebcdc6">llvm::PHINode::Create</a></div><div class="ttdeci">static PHINode * Create(Type *Ty, unsigned NumReservedValues, const Twine &amp;NameStr=&quot;&quot;, Instruction *InsertBefore=0)</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02013">Instructions.h:2013</a></div></div>
<div class="ttc" id="classllvm_1_1LoopBase_html_ac4f141a355e5898255f2cbc57c5b54c3"><div class="ttname"><a href="classllvm_1_1LoopBase.html#ac4f141a355e5898255f2cbc57c5b54c3">llvm::LoopBase::getHeader</a></div><div class="ttdeci">BlockT * getHeader() const </div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l00095">LoopInfo.h:95</a></div></div>
<div class="ttc" id="classllvm_1_1PHINode_html_a4c25b6c00c4867281779c81ab64d2081"><div class="ttname"><a href="classllvm_1_1PHINode.html#a4c25b6c00c4867281779c81ab64d2081">llvm::PHINode::getIncomingBlock</a></div><div class="ttdeci">BasicBlock * getIncomingBlock(unsigned i) const </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02074">Instructions.h:2074</a></div></div>
<div class="ttc" id="classllvm_1_1ICmpInst_html"><div class="ttname"><a href="classllvm_1_1ICmpInst.html">llvm::ICmpInst</a></div><div class="ttdoc">Represent an integer comparison operator. </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00911">Instructions.h:911</a></div></div>
<div class="ttc" id="classllvm_1_1ScalarEvolution_html_aa888e3661c809163273aca85ded4d846"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html#aa888e3661c809163273aca85ded4d846">llvm::ScalarEvolution::getMinusSCEV</a></div><div class="ttdeci">const SCEV * getMinusSCEV(const SCEV *LHS, const SCEV *RHS, SCEV::NoWrapFlags Flags=SCEV::FlagAnyWrap)</div><div class="ttdoc">getMinusSCEV - Return LHS-RHS. Minus is represented in SCEV as A+B*-1. </div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8cpp_source.html#l02790">ScalarEvolution.cpp:2790</a></div></div>
<div class="ttc" id="classllvm_1_1CmpInst_html_a283f9a5d4d843d20c40bb4d3e364bb05"><div class="ttname"><a href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05">llvm::CmpInst::Predicate</a></div><div class="ttdeci">Predicate</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00651">InstrTypes.h:651</a></div></div>
<div class="ttc" id="classllvm_1_1OverflowingBinaryOperator_html"><div class="ttname"><a href="classllvm_1_1OverflowingBinaryOperator.html">llvm::OverflowingBinaryOperator</a></div><div class="ttdef"><b>Definition:</b> <a href="Operator_8h_source.html#l00079">Operator.h:79</a></div></div>
<div class="ttc" id="classllvm_1_1APFloat_html_a42fe920c8131569bb30114d7f294c8f8a527f71be1f3fdab1f3354020d5bec081"><div class="ttname"><a href="classllvm_1_1APFloat.html#a42fe920c8131569bb30114d7f294c8f8a527f71be1f3fdab1f3354020d5bec081">llvm::APFloat::opOK</a></div><div class="ttdef"><b>Definition:</b> <a href="APFloat_8h_source.html#l00167">APFloat.h:167</a></div></div>
<div class="ttc" id="classllvm_1_1APInt_html_ad081689e23a8f5dea78dedd623d6a8f8"><div class="ttname"><a href="classllvm_1_1APInt.html#ad081689e23a8f5dea78dedd623d6a8f8">llvm::APInt::getBitWidth</a></div><div class="ttdeci">unsigned getBitWidth() const </div><div class="ttdoc">Return the number of bits in the APInt. </div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l01252">APInt.h:1252</a></div></div>
<div class="ttc" id="classllvm_1_1SCEVExpander_html_a583d3ca95f83216d632a4d1ae0330dd0"><div class="ttname"><a href="classllvm_1_1SCEVExpander.html#a583d3ca95f83216d632a4d1ae0330dd0">llvm::SCEVExpander::expandCodeFor</a></div><div class="ttdeci">Value * expandCodeFor(const SCEV *SH, Type *Ty, Instruction *I)</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolutionExpander_8cpp_source.html#l01468">ScalarEvolutionExpander.cpp:1468</a></div></div>
<div class="ttc" id="classllvm_1_1LoopBase_html_acaec68a759bb05d3be2ed7dd47e25171"><div class="ttname"><a href="classllvm_1_1LoopBase.html#acaec68a759bb05d3be2ed7dd47e25171">llvm::LoopBase::getExitingBlock</a></div><div class="ttdeci">BlockT * getExitingBlock() const </div><div class="ttdef"><b>Definition:</b> <a href="LoopInfoImpl_8h_source.html#l00049">LoopInfoImpl.h:49</a></div></div>
<div class="ttc" id="classllvm_1_1User_html_a997ff6a1758bf732b9b263fc61011644"><div class="ttname"><a href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">llvm::User::getOperand</a></div><div class="ttdeci">Value * getOperand(unsigned i) const </div><div class="ttdef"><b>Definition:</b> <a href="User_8h_source.html#l00088">User.h:88</a></div></div>
<div class="ttc" id="classllvm_1_1LoopBase_html_a92a38e2e3412bde7fd2b71db212b61aa"><div class="ttname"><a href="classllvm_1_1LoopBase.html#a92a38e2e3412bde7fd2b71db212b61aa">llvm::LoopBase::contains</a></div><div class="ttdeci">bool contains(const LoopT *L) const </div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l00104">LoopInfo.h:104</a></div></div>
<div class="ttc" id="classllvm_1_1IntegerType_html"><div class="ttname"><a href="classllvm_1_1IntegerType.html">llvm::IntegerType</a></div><div class="ttdoc">Integer representation type. </div><div class="ttdef"><b>Definition:</b> <a href="DerivedTypes_8h_source.html#l00037">DerivedTypes.h:37</a></div></div>
<div class="ttc" id="classllvm_1_1CmpInst_html_a8afd4995fae596b2c86eeed85b3d388b"><div class="ttname"><a href="classllvm_1_1CmpInst.html#a8afd4995fae596b2c86eeed85b3d388b">llvm::CmpInst::getPredicate</a></div><div class="ttdeci">Predicate getPredicate() const </div><div class="ttdoc">Return the predicate for this instruction. </div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00714">InstrTypes.h:714</a></div></div>
<div class="ttc" id="classllvm_1_1ScalarEvolution_html_a804545e5b568edec8b970da32cd37359"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html#a804545e5b568edec8b970da32cd37359">llvm::ScalarEvolution::forgetValue</a></div><div class="ttdeci">void forgetValue(Value *V)</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8cpp_source.html#l04201">ScalarEvolution.cpp:4201</a></div></div>
<div class="ttc" id="DenseMap_8h_html"><div class="ttname"><a href="DenseMap_8h.html">DenseMap.h</a></div></div>
<div class="ttc" id="classllvm_1_1DominatorTree_html_a6fe9272dc67fe2ff4cafc33b895c4a6c"><div class="ttname"><a href="classllvm_1_1DominatorTree.html#a6fe9272dc67fe2ff4cafc33b895c4a6c">llvm::DominatorTree::dominates</a></div><div class="ttdeci">bool dominates(const DomTreeNode *A, const DomTreeNode *B) const </div><div class="ttdef"><b>Definition:</b> <a href="Dominators_8h_source.html#l00801">Dominators.h:801</a></div></div>
<div class="ttc" id="classllvm_1_1Type_html_a2eba483f5cc876e824aa6c085736086b"><div class="ttname"><a href="classllvm_1_1Type.html#a2eba483f5cc876e824aa6c085736086b">llvm::Type::isPointerTy</a></div><div class="ttdeci">bool isPointerTy() const </div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00220">Type.h:220</a></div></div>
<div class="ttc" id="classllvm_1_1UndefValue_html_a4ae5ff22b700a42bcc5d889233721335"><div class="ttname"><a href="classllvm_1_1UndefValue.html#a4ae5ff22b700a42bcc5d889233721335">llvm::UndefValue::get</a></div><div class="ttdeci">static UndefValue * get(Type *T)</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l01334">Constants.cpp:1334</a></div></div>
<div class="ttc" id="classllvm_1_1Loop_html_a147b421eaf58e18b10664a6f3c5c7f5b"><div class="ttname"><a href="classllvm_1_1Loop.html#a147b421eaf58e18b10664a6f3c5c7f5b">llvm::Loop::getUniqueExitBlocks</a></div><div class="ttdeci">void getUniqueExitBlocks(SmallVectorImpl&lt; BasicBlock * &gt; &amp;ExitBlocks) const </div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8cpp_source.html#l00354">LoopInfo.cpp:354</a></div></div>
<div class="ttc" id="classllvm_1_1Value_html_af85a4828b6b5a8de7fc0a55cc0e5b52f"><div class="ttname"><a href="classllvm_1_1Value.html#af85a4828b6b5a8de7fc0a55cc0e5b52f">llvm::Value::getContext</a></div><div class="ttdeci">LLVMContext &amp; getContext() const </div><div class="ttdoc">All values hold a context through their type. </div><div class="ttdef"><b>Definition:</b> <a href="Value_8cpp_source.html#l00517">Value.cpp:517</a></div></div>
<div class="ttc" id="classllvm_1_1PHINode_html_aca414c43a6d42c13998208463637a20d"><div class="ttname"><a href="classllvm_1_1PHINode.html#aca414c43a6d42c13998208463637a20d">llvm::PHINode::getIncomingValueNumForOperand</a></div><div class="ttdeci">static unsigned getIncomingValueNumForOperand(unsigned i)</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02068">Instructions.h:2068</a></div></div>
<div class="ttc" id="IndVarSimplify_8cpp_html_a8f8c8177d7d5249583164b7f01ce379c"><div class="ttname"><a href="IndVarSimplify_8cpp.html#a8f8c8177d7d5249583164b7f01ce379c">getLoopTest</a></div><div class="ttdeci">static ICmpInst * getLoopTest(Loop *L)</div><div class="ttdoc">Return the compare guarding the loop latch, or NULL for unrecognized tests. </div><div class="ttdef"><b>Definition:</b> <a href="IndVarSimplify_8cpp_source.html#l01261">IndVarSimplify.cpp:1261</a></div></div>
<div class="ttc" id="classllvm_1_1CmpInst_html_a283f9a5d4d843d20c40bb4d3e364bb05a396dda2571cd3c575f1d9cb44dc2cc09"><div class="ttname"><a href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05a396dda2571cd3c575f1d9cb44dc2cc09">llvm::CmpInst::FCMP_ULE</a></div><div class="ttdoc">1 1 0 1 True if unordered, less than, or equal </div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00666">InstrTypes.h:666</a></div></div>
<div class="ttc" id="classllvm_1_1SCEVExpander_html_ab35b69a7c369aadf7ac052ab21ad2ec6"><div class="ttname"><a href="classllvm_1_1SCEVExpander.html#ab35b69a7c369aadf7ac052ab21ad2ec6">llvm::SCEVExpander::replaceCongruentIVs</a></div><div class="ttdeci">unsigned replaceCongruentIVs(Loop *L, const DominatorTree *DT, SmallVectorImpl&lt; WeakVH &gt; &amp;DeadInsts, const TargetTransformInfo *TTI=NULL)</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolutionExpander_8cpp_source.html#l01580">ScalarEvolutionExpander.cpp:1580</a></div></div>
<div class="ttc" id="classllvm_1_1CmpInst_html_a283f9a5d4d843d20c40bb4d3e364bb05a720a42e85f7e981afd61e28473b0000a"><div class="ttname"><a href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05a720a42e85f7e981afd61e28473b0000a">llvm::CmpInst::ICMP_SGT</a></div><div class="ttdoc">signed greater than </div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00678">InstrTypes.h:678</a></div></div>
<div class="ttc" id="IndVarSimplify_8cpp_html_ad78e062f62e0d6e453941fb4ca843e4d"><div class="ttname"><a href="IndVarSimplify_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a></div><div class="ttdeci">#define DEBUG_TYPE</div><div class="ttdef"><b>Definition:</b> <a href="IndVarSimplify_8cpp_source.html#l00027">IndVarSimplify.cpp:27</a></div></div>
<div class="ttc" id="namespacellvm_html_a472515fc67a5fb572afeb00aa2609cca"><div class="ttname"><a href="namespacellvm.html#a472515fc67a5fb572afeb00aa2609cca">llvm::LoopSimplifyID</a></div><div class="ttdeci">char &amp; LoopSimplifyID</div><div class="ttdef"><b>Definition:</b> <a href="LoopSimplify_8cpp_source.html#l00123">LoopSimplify.cpp:123</a></div></div>
<div class="ttc" id="classllvm_1_1BranchInst_html_a03cc0dff22b31447f43af97acb76b1a2"><div class="ttname"><a href="classllvm_1_1BranchInst.html#a03cc0dff22b31447f43af97acb76b1a2">llvm::BranchInst::isConditional</a></div><div class="ttdeci">bool isConditional() const </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02392">Instructions.h:2392</a></div></div>
<div class="ttc" id="classllvm_1_1CmpInst_html_a283f9a5d4d843d20c40bb4d3e364bb05a4c399f525bbcf03d72af4b303e6eeca8"><div class="ttname"><a href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05a4c399f525bbcf03d72af4b303e6eeca8">llvm::CmpInst::FCMP_OGT</a></div><div class="ttdoc">0 0 1 0 True if ordered and greater than </div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00655">InstrTypes.h:655</a></div></div>
<div class="ttc" id="IndVarSimplify_8cpp_html_ace9625ac60c2f0bcc7b6aadbb73f57b6"><div class="ttname"><a href="IndVarSimplify_8cpp.html#ace9625ac60c2f0bcc7b6aadbb73f57b6">INITIALIZE_PASS_BEGIN</a></div><div class="ttdeci">INITIALIZE_PASS_BEGIN(IndVarSimplify,&quot;indvars&quot;,&quot;Induction Variable Simplification&quot;, false, false) INITIALIZE_PASS_END(IndVarSimplify</div></div>
<div class="ttc" id="classllvm_1_1BinaryOperator_html_a88505baf41407782678a5df1702d2d31"><div class="ttname"><a href="classllvm_1_1BinaryOperator.html#a88505baf41407782678a5df1702d2d31">llvm::BinaryOperator::getOpcode</a></div><div class="ttdeci">BinaryOps getOpcode() const </div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00326">InstrTypes.h:326</a></div></div>
<div class="ttc" id="namespacellvm_1_1TargetOpcode_html_a348d4259b5fa6a8ecfe94e7ae512e1a8ae41f9ca68ba5e8b9613cea03652ebd72"><div class="ttname"><a href="namespacellvm_1_1TargetOpcode.html#a348d4259b5fa6a8ecfe94e7ae512e1a8ae41f9ca68ba5e8b9613cea03652ebd72">llvm::TargetOpcode::PHI</a></div><div class="ttdef"><b>Definition:</b> <a href="TargetOpcodes_8h_source.html#l00026">TargetOpcodes.h:26</a></div></div>
<div class="ttc" id="classllvm_1_1ilist__iterator_html"><div class="ttname"><a href="classllvm_1_1ilist__iterator.html">llvm::ilist_iterator</a></div><div class="ttdef"><b>Definition:</b> <a href="ilist_8h_source.html#l00050">ilist.h:50</a></div></div>
<div class="ttc" id="Target_2ARM_2README_8txt_html_a1b45f45820a60c09244a87eb59824aec"><div class="ttname"><a href="Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a></div><div class="ttdeci">add sub stmia L5 ldr r0 bl L_printf $stub Instead of a and a wouldn t it be better to do three moves *Return an aggregate type is even return S</div><div class="ttdef"><b>Definition:</b> <a href="Target_2ARM_2README_8txt_source.html#l00197">Target/ARM/README.txt:197</a></div></div>
<div class="ttc" id="classllvm_1_1SmallPtrSet_html"><div class="ttname"><a href="classllvm_1_1SmallPtrSet.html">llvm::SmallPtrSet</a></div><div class="ttdef"><b>Definition:</b> <a href="SmallPtrSet_8h_source.html#l00236">SmallPtrSet.h:236</a></div></div>
<div class="ttc" id="classllvm_1_1IRBuilder_html_a277dfeaad2a2ada72a6024b0eedc5301"><div class="ttname"><a href="classllvm_1_1IRBuilder.html#a277dfeaad2a2ada72a6024b0eedc5301">llvm::IRBuilder::CreateZExt</a></div><div class="ttdeci">Value * CreateZExt(Value *V, Type *DestTy, const Twine &amp;Name=&quot;&quot;)</div><div class="ttdef"><b>Definition:</b> <a href="IRBuilder_8h_source.html#l01071">IRBuilder.h:1071</a></div></div>
<div class="ttc" id="classllvm_1_1PHINode_html_aba6a4cc4ed6d6fef3664b8d65ef04820"><div class="ttname"><a href="classllvm_1_1PHINode.html#aba6a4cc4ed6d6fef3664b8d65ef04820">llvm::PHINode::getIncomingValue</a></div><div class="ttdeci">Value * getIncomingValue(unsigned i) const </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02059">Instructions.h:2059</a></div></div>
<div class="ttc" id="classllvm_1_1ScalarEvolution_html_a8344b86f018c5c78a986fb97e1eaf20b"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html#a8344b86f018c5c78a986fb97e1eaf20b">llvm::ScalarEvolution::getTruncateExpr</a></div><div class="ttdeci">const SCEV * getTruncateExpr(const SCEV *Op, Type *Ty)</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8cpp_source.html#l00822">ScalarEvolution.cpp:822</a></div></div>
<div class="ttc" id="Target_2README_8txt_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">i</div><div class="ttdef"><b>Definition:</b> <a href="Target_2README_8txt_source.html#l00029">Target/README.txt:29</a></div></div>
<div class="ttc" id="classllvm_1_1AnalysisUsage_html_a053677ebc731b47a534f841b11b5cf0c"><div class="ttname"><a href="classllvm_1_1AnalysisUsage.html#a053677ebc731b47a534f841b11b5cf0c">llvm::AnalysisUsage::addRequiredID</a></div><div class="ttdeci">AnalysisUsage &amp; addRequiredID(const void *ID)</div><div class="ttdef"><b>Definition:</b> <a href="Pass_8cpp_source.html#l00262">Pass.cpp:262</a></div></div>
<div class="ttc" id="classllvm_1_1Loop_html_a169771e7b8bf22ee06a0ebe655fce069"><div class="ttname"><a href="classllvm_1_1Loop.html#a169771e7b8bf22ee06a0ebe655fce069">llvm::Loop::isLCSSAForm</a></div><div class="ttdeci">bool isLCSSAForm(DominatorTree &amp;DT) const </div><div class="ttdoc">isLCSSAForm - Return true if the Loop is in LCSSA form </div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8cpp_source.html#l00179">LoopInfo.cpp:179</a></div></div>
<div class="ttc" id="classllvm_1_1CmpInst_html_a283f9a5d4d843d20c40bb4d3e364bb05a75016d5872d90adf89cc1cbf5763f474"><div class="ttname"><a href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05a75016d5872d90adf89cc1cbf5763f474">llvm::CmpInst::FCMP_ULT</a></div><div class="ttdoc">1 1 0 0 True if unordered or less than </div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00665">InstrTypes.h:665</a></div></div>
<div class="ttc" id="classllvm_1_1SmallVector_html"><div class="ttname"><a href="classllvm_1_1SmallVector.html">llvm::SmallVector</a></div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00880">SmallVector.h:880</a></div></div>
<div class="ttc" id="classllvm_1_1Value_html_a0cf3748dba54f931bb1241ae4adc76bc"><div class="ttname"><a href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">llvm::Value::getType</a></div><div class="ttdeci">Type * getType() const </div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00111">Value.h:111</a></div></div>
<div class="ttc" id="classllvm_1_1TargetLibraryInfo_html"><div class="ttname"><a href="classllvm_1_1TargetLibraryInfo.html">llvm::TargetLibraryInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="TargetLibraryInfo_8h_source.html#l00657">TargetLibraryInfo.h:657</a></div></div>
<div class="ttc" id="classllvm_1_1LoopInfo_html"><div class="ttname"><a href="classllvm_1_1LoopInfo.html">llvm::LoopInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l00589">LoopInfo.h:589</a></div></div>
<div class="ttc" id="classllvm_1_1LoopBase_html_a1431766de798501f107d9031821f311e"><div class="ttname"><a href="classllvm_1_1LoopBase.html#a1431766de798501f107d9031821f311e">llvm::LoopBase::getParentLoop</a></div><div class="ttdeci">LoopT * getParentLoop() const </div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l00096">LoopInfo.h:96</a></div></div>
<div class="ttc" id="classllvm_1_1BinaryOperator_html"><div class="ttname"><a href="classllvm_1_1BinaryOperator.html">llvm::BinaryOperator</a></div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00138">InstrTypes.h:138</a></div></div>
<div class="ttc" id="classllvm_1_1CmpInst_html_a283f9a5d4d843d20c40bb4d3e364bb05a15ae464950ac676919c2f0c7aafc706c"><div class="ttname"><a href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05a15ae464950ac676919c2f0c7aafc706c">llvm::CmpInst::ICMP_SLT</a></div><div class="ttdoc">signed less than </div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00680">InstrTypes.h:680</a></div></div>
<div class="ttc" id="classllvm_1_1LoopPass_html"><div class="ttname"><a href="classllvm_1_1LoopPass.html">llvm::LoopPass</a></div><div class="ttdef"><b>Definition:</b> <a href="LoopPass_8h_source.html#l00029">LoopPass.h:29</a></div></div>
<div class="ttc" id="classllvm_1_1ConstantInt_html_a9105541412dab869e18b3cceebfff07d"><div class="ttname"><a href="classllvm_1_1ConstantInt.html#a9105541412dab869e18b3cceebfff07d">llvm::ConstantInt::get</a></div><div class="ttdeci">static Constant * get(Type *Ty, uint64_t V, bool isSigned=false)</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l00492">Constants.cpp:492</a></div></div>
<div class="ttc" id="IndVarSimplify_8cpp_html_abfd6c95e6ba0f368e0745c65bfe5b6ed"><div class="ttname"><a href="IndVarSimplify_8cpp.html#abfd6c95e6ba0f368e0745c65bfe5b6ed">getLoopPhiForCounter</a></div><div class="ttdeci">static PHINode * getLoopPhiForCounter(Value *IncV, Loop *L, DominatorTree *DT)</div><div class="ttdef"><b>Definition:</b> <a href="IndVarSimplify_8cpp_source.html#l01225">IndVarSimplify.cpp:1225</a></div></div>
<div class="ttc" id="classllvm_1_1AnalysisUsage_html_af11a6ebf7ab3c388234cb6d5378439a3"><div class="ttname"><a href="classllvm_1_1AnalysisUsage.html#af11a6ebf7ab3c388234cb6d5378439a3">llvm::AnalysisUsage::setPreservesCFG</a></div><div class="ttdeci">void setPreservesCFG()</div><div class="ttdef"><b>Definition:</b> <a href="Pass_8cpp_source.html#l00249">Pass.cpp:249</a></div></div>
<div class="ttc" id="namespacellvm_html_a7c46c742c31be54870e2038048e6b391"><div class="ttname"><a href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">llvm::dbgs</a></div><div class="ttdeci">raw_ostream &amp; dbgs()</div><div class="ttdoc">dbgs - Return a circular-buffered debug stream. </div><div class="ttdef"><b>Definition:</b> <a href="Debug_8cpp_source.html#l00101">Debug.cpp:101</a></div></div>
<div class="ttc" id="classllvm_1_1GEPOperator_html"><div class="ttname"><a href="classllvm_1_1GEPOperator.html">llvm::GEPOperator</a></div><div class="ttdef"><b>Definition:</b> <a href="Operator_8h_source.html#l00357">Operator.h:357</a></div></div>
<div class="ttc" id="namespacestd_html_ab8424022895aee3e366fb9a32f2883cb"><div class="ttname"><a href="namespacestd.html#ab8424022895aee3e366fb9a32f2883cb">std::swap</a></div><div class="ttdeci">void swap(llvm::BitVector &amp;LHS, llvm::BitVector &amp;RHS)</div><div class="ttdoc">Implement std::swap in terms of BitVector swap. </div><div class="ttdef"><b>Definition:</b> <a href="BitVector_8h_source.html#l00591">BitVector.h:591</a></div></div>
<div class="ttc" id="classllvm_1_1CmpInst_html_a283f9a5d4d843d20c40bb4d3e364bb05a2751d6136a2819749dcef65dc19a4246"><div class="ttname"><a href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05a2751d6136a2819749dcef65dc19a4246">llvm::CmpInst::ICMP_SLE</a></div><div class="ttdoc">signed less or equal </div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00681">InstrTypes.h:681</a></div></div>
<div class="ttc" id="classllvm_1_1APInt_html"><div class="ttname"><a href="classllvm_1_1APInt.html">llvm::APInt</a></div><div class="ttdoc">Class for arbitrary precision integers. </div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l00075">APInt.h:75</a></div></div>
<div class="ttc" id="classllvm_1_1SCEVAddExpr_html"><div class="ttname"><a href="classllvm_1_1SCEVAddExpr.html">llvm::SCEVAddExpr</a></div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolutionExpressions_8h_source.html#l00202">ScalarEvolutionExpressions.h:202</a></div></div>
<div class="ttc" id="classllvm_1_1ScalarEvolution_html_a63d4f693eb205bb9d556e067464f943c"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html#a63d4f693eb205bb9d556e067464f943c">llvm::ScalarEvolution::getSignExtendExpr</a></div><div class="ttdeci">const SCEV * getSignExtendExpr(const SCEV *Op, Type *Ty)</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8cpp_source.html#l01159">ScalarEvolution.cpp:1159</a></div></div>
<div class="ttc" id="classllvm_1_1PHINode_html_a21960167f529265a1cb02ac1e8ad10f6"><div class="ttname"><a href="classllvm_1_1PHINode.html#a21960167f529265a1cb02ac1e8ad10f6">llvm::PHINode::getIncomingValueForBlock</a></div><div class="ttdeci">Value * getIncomingValueForBlock(const BasicBlock *BB) const </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02139">Instructions.h:2139</a></div></div>
<div class="ttc" id="classllvm_1_1Type_html_a6e328feb83afa5cf1c966d6704e43fc1"><div class="ttname"><a href="classllvm_1_1Type.html#a6e328feb83afa5cf1c966d6704e43fc1">llvm::Type::isIntegerTy</a></div><div class="ttdeci">bool isIntegerTy() const </div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00196">Type.h:196</a></div></div>
<div class="ttc" id="classllvm_1_1Instruction_html_a5ac211f24970dea81fa9a7118a8ce36b"><div class="ttname"><a href="classllvm_1_1Instruction.html#a5ac211f24970dea81fa9a7118a8ce36b">llvm::Instruction::use_back</a></div><div class="ttdeci">Instruction * use_back()</div><div class="ttdef"><b>Definition:</b> <a href="Instruction_8h_source.html#l00049">Instruction.h:49</a></div></div>
<div class="ttc" id="namespacellvm_html_affe1d140e344b6ab0c607f6310ad8ac3"><div class="ttname"><a href="namespacellvm.html#affe1d140e344b6ab0c607f6310ad8ac3">llvm::initializeIndVarSimplifyPass</a></div><div class="ttdeci">void initializeIndVarSimplifyPass(PassRegistry &amp;)</div></div>
<div class="ttc" id="classllvm_1_1SCEVExpander_html"><div class="ttname"><a href="classllvm_1_1SCEVExpander.html">llvm::SCEVExpander</a></div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolutionExpander_8h_source.html#l00037">ScalarEvolutionExpander.h:37</a></div></div>
<div class="ttc" id="classllvm_1_1ScalarEvolution_html_a23541ecba66207184eaf2279a70c5b12"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html#a23541ecba66207184eaf2279a70c5b12">llvm::ScalarEvolution::getAddExpr</a></div><div class="ttdeci">const SCEV * getAddExpr(SmallVectorImpl&lt; const SCEV * &gt; &amp;Ops, SCEV::NoWrapFlags Flags=SCEV::FlagAnyWrap)</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8cpp_source.html#l01461">ScalarEvolution.cpp:1461</a></div></div>
<div class="ttc" id="classllvm_1_1APInt_html_a331d69b5f93e47e7c596062b77dd5913"><div class="ttname"><a href="classllvm_1_1APInt.html#a331d69b5f93e47e7c596062b77dd5913">llvm::APInt::getMaxValue</a></div><div class="ttdeci">static APInt getMaxValue(unsigned numBits)</div><div class="ttdoc">Gets maximum unsigned value of APInt for specific bit width. </div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l00418">APInt.h:418</a></div></div>
<div class="ttc" id="namespacellvm_1_1APIntOps_html_a684cfe02c582e8d75cd6d457e63e6c25"><div class="ttname"><a href="namespacellvm_1_1APIntOps.html#a684cfe02c582e8d75cd6d457e63e6c25">llvm::APIntOps::And</a></div><div class="ttdeci">APInt And(const APInt &amp;LHS, const APInt &amp;RHS)</div><div class="ttdoc">Bitwise AND function for APInt. </div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l01840">APInt.h:1840</a></div></div>
<div class="ttc" id="VirtRegMap_8cpp_html_a1ad52109a2ff430460c8776286b97b2e"><div class="ttname"><a href="VirtRegMap_8cpp.html#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a></div><div class="ttdeci">Virtual Register Rewriter</div><div class="ttdef"><b>Definition:</b> <a href="VirtRegMap_8cpp_source.html#l00185">VirtRegMap.cpp:185</a></div></div>
<div class="ttc" id="classllvm_1_1Value_html_a413abcab8dbc3900fc2fde96a5d8fca6"><div class="ttname"><a href="classllvm_1_1Value.html#a413abcab8dbc3900fc2fde96a5d8fca6">llvm::Value::use_begin</a></div><div class="ttdeci">use_iterator use_begin()</div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00150">Value.h:150</a></div></div>
<div class="ttc" id="IndVarSimplify_8cpp_html_a0ba22bab67cca4eedc62b66da6f2bbdf"><div class="ttname"><a href="IndVarSimplify_8cpp.html#a0ba22bab67cca4eedc62b66da6f2bbdf">FindLoopCounter</a></div><div class="ttdeci">static PHINode * FindLoopCounter(Loop *L, const SCEV *BECount, ScalarEvolution *SE, DominatorTree *DT, const DataLayout *TD)</div><div class="ttdef"><b>Definition:</b> <a href="IndVarSimplify_8cpp_source.html#l01388">IndVarSimplify.cpp:1388</a></div></div>
<div class="ttc" id="Transforms_2Scalar_8h_html"><div class="ttname"><a href="Transforms_2Scalar_8h.html">Scalar.h</a></div></div>
<div class="ttc" id="classllvm_1_1BranchInst_html_a84309bb8c34c8bc5694ec5d48dd8668f"><div class="ttname"><a href="classllvm_1_1BranchInst.html#a84309bb8c34c8bc5694ec5d48dd8668f">llvm::BranchInst::getCondition</a></div><div class="ttdeci">Value * getCondition() const </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02394">Instructions.h:2394</a></div></div>
<div class="ttc" id="classllvm_1_1cl_1_1opt_html"><div class="ttname"><a href="classllvm_1_1cl_1_1opt.html">llvm::cl::opt</a></div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l01149">CommandLine.h:1149</a></div></div>
<div class="ttc" id="classllvm_1_1ScalarEvolution_html_a592bdd7731b14ff4ff5d646f6f399900"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html#a592bdd7731b14ff4ff5d646f6f399900">llvm::ScalarEvolution::forgetLoop</a></div><div class="ttdeci">void forgetLoop(const Loop *L)</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8cpp_source.html#l04162">ScalarEvolution.cpp:4162</a></div></div>
<div class="ttc" id="classllvm_1_1SCEV_html"><div class="ttname"><a href="classllvm_1_1SCEV.html">llvm::SCEV</a></div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8h_source.html#l00057">ScalarEvolution.h:57</a></div></div>
<div class="ttc" id="classllvm_1_1Type_html_a30dd396c5b40cd86c1591872e574ccdf"><div class="ttname"><a href="classllvm_1_1Type.html#a30dd396c5b40cd86c1591872e574ccdf">llvm::Type::getInt32Ty</a></div><div class="ttdeci">static IntegerType * getInt32Ty(LLVMContext &amp;C)</div><div class="ttdef"><b>Definition:</b> <a href="Type_8cpp_source.html#l00241">Type.cpp:241</a></div></div>
<div class="ttc" id="classllvm_1_1DataLayout_html_a96f1e9abd65fef355bd8f15f9360c871"><div class="ttname"><a href="classllvm_1_1DataLayout.html#a96f1e9abd65fef355bd8f15f9360c871">llvm::DataLayout::isLegalInteger</a></div><div class="ttdeci">bool isLegalInteger(unsigned Width) const </div><div class="ttdef"><b>Definition:</b> <a href="DataLayout_8h_source.html#l00210">DataLayout.h:210</a></div></div>
<div class="ttc" id="classllvm_1_1Loop_html"><div class="ttname"><a href="classllvm_1_1Loop.html">llvm::Loop</a></div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l00338">LoopInfo.h:338</a></div></div>
<div class="ttc" id="classllvm_1_1IRBuilder_html_a2081b822b121723df82782c24314a37e"><div class="ttname"><a href="classllvm_1_1IRBuilder.html#a2081b822b121723df82782c24314a37e">llvm::IRBuilder::CreateSExt</a></div><div class="ttdeci">Value * CreateSExt(Value *V, Type *DestTy, const Twine &amp;Name=&quot;&quot;)</div><div class="ttdef"><b>Definition:</b> <a href="IRBuilder_8h_source.html#l01074">IRBuilder.h:1074</a></div></div>
<div class="ttc" id="MD5_8cpp_html_ac0eafdc9ee161b71e7af98af736952fd"><div class="ttname"><a href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a></div><div class="ttdeci">#define I(x, y, z)</div><div class="ttdef"><b>Definition:</b> <a href="MD5_8cpp_source.html#l00054">MD5.cpp:54</a></div></div>
<div class="ttc" id="classllvm_1_1BasicBlock_html_a5cb76a65b6524dba1493dd2b9dc3abbe"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a5cb76a65b6524dba1493dd2b9dc3abbe">llvm::BasicBlock::getTerminator</a></div><div class="ttdeci">TerminatorInst * getTerminator()</div><div class="ttdoc">Returns the terminator instruction if the block is well formed or null if the block is not well forme...</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8cpp_source.html#l00120">BasicBlock.cpp:120</a></div></div>
<div class="ttc" id="classllvm_1_1Value_html_a085b82f074c28030fb8e194377ed2d0c"><div class="ttname"><a href="classllvm_1_1Value.html#a085b82f074c28030fb8e194377ed2d0c">llvm::Value::hasOneUse</a></div><div class="ttdeci">bool hasOneUse() const </div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00161">Value.h:161</a></div></div>
<div class="ttc" id="classllvm_1_1CmpInst_html_a283f9a5d4d843d20c40bb4d3e364bb05a8a80b27ca29fe2076b9bbdee02c65464"><div class="ttname"><a href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05a8a80b27ca29fe2076b9bbdee02c65464">llvm::CmpInst::FCMP_ONE</a></div><div class="ttdoc">0 1 1 0 True if ordered and operands are unequal </div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00659">InstrTypes.h:659</a></div></div>
<div class="ttc" id="IndVarSimplify_8cpp_html_a5a24a27c50a6c4bc285bef2de8a5e908"><div class="ttname"><a href="IndVarSimplify_8cpp.html#a5a24a27c50a6c4bc285bef2de8a5e908">needsLFTR</a></div><div class="ttdeci">static bool needsLFTR(Loop *L, DominatorTree *DT)</div><div class="ttdef"><b>Definition:</b> <a href="IndVarSimplify_8cpp_source.html#l01277">IndVarSimplify.cpp:1277</a></div></div>
<div class="ttc" id="BasicBlockUtils_8h_html"><div class="ttname"><a href="BasicBlockUtils_8h.html">BasicBlockUtils.h</a></div></div>
<div class="ttc" id="classllvm_1_1DominatorTree_html_a7b8f5876ec15b49abf76ae81cefac1f6"><div class="ttname"><a href="classllvm_1_1DominatorTree.html#a7b8f5876ec15b49abf76ae81cefac1f6">llvm::DominatorTree::findNearestCommonDominator</a></div><div class="ttdeci">BasicBlock * findNearestCommonDominator(BasicBlock *A, BasicBlock *B)</div><div class="ttdef"><b>Definition:</b> <a href="Dominators_8h_source.html#l00828">Dominators.h:828</a></div></div>
<div class="ttc" id="classllvm_1_1SmallVectorTemplateBase_html_a1f2303df9bbee2233c11d61c2f6f7930"><div class="ttname"><a href="classllvm_1_1SmallVectorTemplateBase.html#a1f2303df9bbee2233c11d61c2f6f7930">llvm::SmallVectorTemplateBase&lt; T, isPodLike&lt; T &gt;::value &gt;::pop_back</a></div><div class="ttdeci">void pop_back()</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00260">SmallVector.h:260</a></div></div>
<div class="ttc" id="classllvm_1_1BinaryOperator_html_a4a4628e91a9c6a339fa61105614fac76"><div class="ttname"><a href="classllvm_1_1BinaryOperator.html#a4a4628e91a9c6a339fa61105614fac76">llvm::BinaryOperator::Create</a></div><div class="ttdeci">static BinaryOperator * Create(BinaryOps Op, Value *S1, Value *S2, const Twine &amp;Name=Twine(), Instruction *InsertBefore=0)</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8cpp_source.html#l01834">Instructions.cpp:1834</a></div></div>
<div class="ttc" id="classllvm_1_1SCEVAddRecExpr_html_a7fcbbc51eef313e675a2442bb2053ae9"><div class="ttname"><a href="classllvm_1_1SCEVAddRecExpr.html#a7fcbbc51eef313e675a2442bb2053ae9">llvm::SCEVAddRecExpr::getLoop</a></div><div class="ttdeci">const Loop * getLoop() const </div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolutionExpressions_8h_source.html#l00294">ScalarEvolutionExpressions.h:294</a></div></div>
<div class="ttc" id="classllvm_1_1CmpInst_html_a283f9a5d4d843d20c40bb4d3e364bb05a959268ceeae23abe5c9ad9e895669d0c"><div class="ttname"><a href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05a959268ceeae23abe5c9ad9e895669d0c">llvm::CmpInst::FCMP_UGT</a></div><div class="ttdoc">1 0 1 0 True if unordered or greater than </div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00663">InstrTypes.h:663</a></div></div>
<div class="ttc" id="classllvm_1_1ConstantFP_html_a0f839f7633a4709c1d89e128f49b3d43"><div class="ttname"><a href="classllvm_1_1ConstantFP.html#a0f839f7633a4709c1d89e128f49b3d43">llvm::ConstantFP::getValueAPF</a></div><div class="ttdeci">const APFloat &amp; getValueAPF() const </div><div class="ttdef"><b>Definition:</b> <a href="Constants_8h_source.html#l00263">Constants.h:263</a></div></div>
<div class="ttc" id="classllvm_1_1CmpInst_html_a283f9a5d4d843d20c40bb4d3e364bb05aa719225e2de4059f93fd3209e1f48218"><div class="ttname"><a href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05aa719225e2de4059f93fd3209e1f48218">llvm::CmpInst::ICMP_EQ</a></div><div class="ttdoc">equal </div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00672">InstrTypes.h:672</a></div></div>
<div class="ttc" id="LLVMContext_8h_html"><div class="ttname"><a href="LLVMContext_8h.html">LLVMContext.h</a></div></div>
<div class="ttc" id="classllvm_1_1ScalarEvolution_html_aecd7aba4460358813feef37d71d5024e"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html#aecd7aba4460358813feef37d71d5024e">llvm::ScalarEvolution::getBackedgeTakenCount</a></div><div class="ttdeci">const SCEV * getBackedgeTakenCount(const Loop *L)</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8cpp_source.html#l04062">ScalarEvolution.cpp:4062</a></div></div>
<div class="ttc" id="classllvm_1_1Value_html_ac38c53f76ef532f91f1666c8a87370e9"><div class="ttname"><a href="classllvm_1_1Value.html#ac38c53f76ef532f91f1666c8a87370e9">llvm::Value::use_empty</a></div><div class="ttdeci">bool use_empty() const </div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00149">Value.h:149</a></div></div>
<div class="ttc" id="classllvm_1_1SIToFPInst_html"><div class="ttname"><a href="classllvm_1_1SIToFPInst.html">llvm::SIToFPInst</a></div><div class="ttdoc">This class represents a cast from signed integer to floating point. </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l03391">Instructions.h:3391</a></div></div>
<div class="ttc" id="classllvm_1_1Init_html"><div class="ttname"><a href="classllvm_1_1Init.html">llvm::Init</a></div><div class="ttdef"><b>Definition:</b> <a href="Record_8h_source.html#l00415">Record.h:415</a></div></div>
<div class="ttc" id="Local_8h_html"><div class="ttname"><a href="Local_8h.html">Local.h</a></div></div>
<div class="ttc" id="classllvm_1_1SCEV_html_ac08c8d9d93b387dc10681b6f156095bf"><div class="ttname"><a href="classllvm_1_1SCEV.html#ac08c8d9d93b387dc10681b6f156095bf">llvm::SCEV::getSCEVType</a></div><div class="ttdeci">unsigned getSCEVType() const </div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8h_source.html#l00103">ScalarEvolution.h:103</a></div></div>
<div class="ttc" id="classllvm_1_1CmpInst_html_a283f9a5d4d843d20c40bb4d3e364bb05a024db78a5ed74f64666f3ca4955e6eca"><div class="ttname"><a href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05a024db78a5ed74f64666f3ca4955e6eca">llvm::CmpInst::FCMP_OEQ</a></div><div class="ttdoc">0 0 0 1 True if ordered and equal </div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00654">InstrTypes.h:654</a></div></div>
<div class="ttc" id="classllvm_1_1IRBuilder_html_aa933549689e79685bb67de64dddc9f7c"><div class="ttname"><a href="classllvm_1_1IRBuilder.html#aa933549689e79685bb67de64dddc9f7c">llvm::IRBuilder::CreateTrunc</a></div><div class="ttdeci">Value * CreateTrunc(Value *V, Type *DestTy, const Twine &amp;Name=&quot;&quot;)</div><div class="ttdef"><b>Definition:</b> <a href="IRBuilder_8h_source.html#l01068">IRBuilder.h:1068</a></div></div>
<div class="ttc" id="classllvm_1_1Value_html"><div class="ttname"><a href="classllvm_1_1Value.html">llvm::Value</a></div><div class="ttdoc">LLVM Value Representation. </div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00066">Value.h:66</a></div></div>
<div class="ttc" id="classllvm_1_1CmpInst_html_a283f9a5d4d843d20c40bb4d3e364bb05ae51609fc6a425f849d37c28cb9bc0344"><div class="ttname"><a href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05ae51609fc6a425f849d37c28cb9bc0344">llvm::CmpInst::FCMP_UGE</a></div><div class="ttdoc">1 0 1 1 True if unordered, greater than, or equal </div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00664">InstrTypes.h:664</a></div></div>
<div class="ttc" id="classllvm_1_1ScalarEvolution_html_a30bd18ac905eacf3601bc6a553a9ff49"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html#a30bd18ac905eacf3601bc6a553a9ff49">llvm::ScalarEvolution::getSCEV</a></div><div class="ttdeci">const SCEV * getSCEV(Value *V)</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8cpp_source.html#l02742">ScalarEvolution.cpp:2742</a></div></div>
<div class="ttc" id="classllvm_1_1Instruction_html_a021bb7c9aad6003fe8089f6327356c6c"><div class="ttname"><a href="classllvm_1_1Instruction.html#a021bb7c9aad6003fe8089f6327356c6c">llvm::Instruction::getOpcode</a></div><div class="ttdeci">unsigned getOpcode() const </div><div class="ttdoc">getOpcode() returns a member of one of the enums like Instruction::Add. </div><div class="ttdef"><b>Definition:</b> <a href="Instruction_8h_source.html#l00083">Instruction.h:83</a></div></div>
<div class="ttc" id="SmallVector_8h_html"><div class="ttname"><a href="SmallVector_8h.html">SmallVector.h</a></div></div>
<div class="ttc" id="classllvm_1_1APFloat_html_a26f3c979ec46a5d2d9bccd300eb606fea4cc5d58ded2d49317f9cc2315a3a09ec"><div class="ttname"><a href="classllvm_1_1APFloat.html#a26f3c979ec46a5d2d9bccd300eb606fea4cc5d58ded2d49317f9cc2315a3a09ec">llvm::APFloat::rmTowardZero</a></div><div class="ttdef"><b>Definition:</b> <a href="APFloat_8h_source.html#l00159">APFloat.h:159</a></div></div>
<div class="ttc" id="IndVarSimplify_8cpp_html_a861b0a771b2125e6e9affb1b6f7a2003"><div class="ttname"><a href="IndVarSimplify_8cpp.html#a861b0a771b2125e6e9affb1b6f7a2003">AlmostDeadIV</a></div><div class="ttdeci">static bool AlmostDeadIV(PHINode *Phi, BasicBlock *LatchBlock, Value *Cond)</div><div class="ttdef"><b>Definition:</b> <a href="IndVarSimplify_8cpp_source.html#l01358">IndVarSimplify.cpp:1358</a></div></div>
<div class="ttc" id="BasicAliasAnalysis_8cpp_html_a2675de1d8479c7b00387979714da43f7"><div class="ttname"><a href="BasicAliasAnalysis_8cpp.html#a2675de1d8479c7b00387979714da43f7">getParent</a></div><div class="ttdeci">static const Function * getParent(const Value *V)</div><div class="ttdef"><b>Definition:</b> <a href="BasicAliasAnalysis_8cpp_source.html#l00447">BasicAliasAnalysis.cpp:447</a></div></div>
<div class="ttc" id="classllvm_1_1Instruction_html_af67d1f3a518964d80a109bb3d9d5cf1e"><div class="ttname"><a href="classllvm_1_1Instruction.html#af67d1f3a518964d80a109bb3d9d5cf1e">llvm::Instruction::moveBefore</a></div><div class="ttdeci">void moveBefore(Instruction *MovePos)</div><div class="ttdef"><b>Definition:</b> <a href="Instruction_8cpp_source.html#l00091">Instruction.cpp:91</a></div></div>
<div class="ttc" id="namespacellvm_html_af44ceebb0726227cf82bd54a0bc286fa"><div class="ttname"><a href="namespacellvm.html#af44ceebb0726227cf82bd54a0bc286fa">llvm::DeleteDeadPHIs</a></div><div class="ttdeci">bool DeleteDeadPHIs(BasicBlock *BB, const TargetLibraryInfo *TLI=0)</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlockUtils_8cpp_source.html#l00098">BasicBlockUtils.cpp:98</a></div></div>
<div class="ttc" id="Debug_8h_html_aef41e8aaf4c60819b30faf396cdf4978"><div class="ttname"><a href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a></div><div class="ttdeci">#define DEBUG(X)</div><div class="ttdef"><b>Definition:</b> <a href="Debug_8h_source.html#l00097">Debug.h:97</a></div></div>
<div class="ttc" id="classllvm_1_1SCEVExpander_html_acfd53cb9ef34b9c9d9428fdaf08e0f0b"><div class="ttname"><a href="classllvm_1_1SCEVExpander.html#acfd53cb9ef34b9c9d9428fdaf08e0f0b">llvm::SCEVExpander::disableCanonicalMode</a></div><div class="ttdeci">void disableCanonicalMode()</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolutionExpander_8h_source.html#l00170">ScalarEvolutionExpander.h:170</a></div></div>
<div class="ttc" id="classllvm_1_1APInt_html_a6142fc5662411269a7ca0217f49f338c"><div class="ttname"><a href="classllvm_1_1APInt.html#a6142fc5662411269a7ca0217f49f338c">llvm::APInt::zext</a></div><div class="ttdeci">APInt LLVM_ATTRIBUTE_UNUSED_RESULT zext(unsigned width) const </div><div class="ttdoc">Zero extend to a new width. </div><div class="ttdef"><b>Definition:</b> <a href="APInt_8cpp_source.html#l00983">APInt.cpp:983</a></div></div>
<div class="ttc" id="classllvm_1_1ScalarEvolution_html_a32dd2633bd4f1c5243c9704a30db22d8"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html#a32dd2633bd4f1c5243c9704a30db22d8">llvm::ScalarEvolution::getTruncateOrZeroExtend</a></div><div class="ttdeci">const SCEV * getTruncateOrZeroExtend(const SCEV *V, Type *Ty)</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8cpp_source.html#l02806">ScalarEvolution.cpp:2806</a></div></div>
<div class="ttc" id="raw__ostream_8h_html"><div class="ttname"><a href="raw__ostream_8h.html">raw_ostream.h</a></div></div>
<div class="ttc" id="classllvm_1_1BasicBlock_html_ab1cd5a3713b93a33f89a2086d473cf6e"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#ab1cd5a3713b93a33f89a2086d473cf6e">llvm::BasicBlock::getFirstInsertionPt</a></div><div class="ttdeci">iterator getFirstInsertionPt()</div><div class="ttdoc">Returns an iterator to the first instruction in this block that is suitable for inserting a non-PHI i...</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8cpp_source.html#l00170">BasicBlock.cpp:170</a></div></div>
<div class="ttc" id="classllvm_1_1ScalarEvolution_html_abfa1a24cb47fd5fedbc7109b905741a3"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html#abfa1a24cb47fd5fedbc7109b905741a3">llvm::ScalarEvolution::getZeroExtendExpr</a></div><div class="ttdeci">const SCEV * getZeroExtendExpr(const SCEV *Op, Type *Ty)</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8cpp_source.html#l00901">ScalarEvolution.cpp:901</a></div></div>
<div class="ttc" id="classllvm_1_1PHINode_html_a88cdefb709309eddc6e5daca0be6a7b4"><div class="ttname"><a href="classllvm_1_1PHINode.html#a88cdefb709309eddc6e5daca0be6a7b4">llvm::PHINode::setIncomingValue</a></div><div class="ttdeci">void setIncomingValue(unsigned i, Value *V)</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02062">Instructions.h:2062</a></div></div>
<div class="ttc" id="namespacellvm_html_aed54a8c39c1f5f066957f1297bd6bd0b"><div class="ttname"><a href="namespacellvm.html#aed54a8c39c1f5f066957f1297bd6bd0b">llvm::isSafeToExpand</a></div><div class="ttdeci">bool isSafeToExpand(const SCEV *S, ScalarEvolution &amp;SE)</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolutionExpander_8cpp_source.html#l01743">ScalarEvolutionExpander.cpp:1743</a></div></div>
<div class="ttc" id="classllvm_1_1CmpInst_html_a283f9a5d4d843d20c40bb4d3e364bb05a541533f34077bbbcfb703a90f6d2da9b"><div class="ttname"><a href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05a541533f34077bbbcfb703a90f6d2da9b">llvm::CmpInst::FCMP_OGE</a></div><div class="ttdoc">0 0 1 1 True if ordered and greater than or equal </div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00656">InstrTypes.h:656</a></div></div>
<div class="ttc" id="classllvm_1_1CmpInst_html_a283f9a5d4d843d20c40bb4d3e364bb05a07aee43ffb66908a25c55c77ce4c0d05"><div class="ttname"><a href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05a07aee43ffb66908a25c55c77ce4c0d05">llvm::CmpInst::BAD_ICMP_PREDICATE</a></div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00684">InstrTypes.h:684</a></div></div>
<div class="ttc" id="classllvm_1_1PHINode_html_a5c2b7d7f19aac93b27b845858a7eb73e"><div class="ttname"><a href="classllvm_1_1PHINode.html#a5c2b7d7f19aac93b27b845858a7eb73e">llvm::PHINode::getBasicBlockIndex</a></div><div class="ttdeci">int getBasicBlockIndex(const BasicBlock *BB) const </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02132">Instructions.h:2132</a></div></div>
<div class="ttc" id="classllvm_1_1Instruction_html_a9cd49851904f15060edb782ef4dd1b2d"><div class="ttname"><a href="classllvm_1_1Instruction.html#a9cd49851904f15060edb782ef4dd1b2d">llvm::Instruction::getParent</a></div><div class="ttdeci">const BasicBlock * getParent() const </div><div class="ttdef"><b>Definition:</b> <a href="Instruction_8h_source.html#l00052">Instruction.h:52</a></div></div>
<div class="ttc" id="namespacellvm_html_adcea5fcebbb3724d8b561ce175e8e65c"><div class="ttname"><a href="namespacellvm.html#adcea5fcebbb3724d8b561ce175e8e65c">llvm::createIndVarSimplifyPass</a></div><div class="ttdeci">Pass * createIndVarSimplifyPass()</div><div class="ttdef"><b>Definition:</b> <a href="IndVarSimplify_8cpp_source.html#l00130">IndVarSimplify.cpp:130</a></div></div>
<div class="ttc" id="classllvm_1_1OverflowingBinaryOperator_html_abe8af726db43885a1178cf75ed0725d9"><div class="ttname"><a href="classllvm_1_1OverflowingBinaryOperator.html#abe8af726db43885a1178cf75ed0725d9">llvm::OverflowingBinaryOperator::hasNoUnsignedWrap</a></div><div class="ttdeci">bool hasNoUnsignedWrap() const </div><div class="ttdef"><b>Definition:</b> <a href="Operator_8h_source.html#l00101">Operator.h:101</a></div></div>
<div class="ttc" id="classllvm_1_1LPPassManager_html"><div class="ttname"><a href="classllvm_1_1LPPassManager.html">llvm::LPPassManager</a></div><div class="ttdef"><b>Definition:</b> <a href="LoopPass_8h_source.html#l00086">LoopPass.h:86</a></div></div>
<div class="ttc" id="classllvm_1_1CmpInst_html_a283f9a5d4d843d20c40bb4d3e364bb05ac1aa7b798ba11d2e497d5cce6ce6d3dc"><div class="ttname"><a href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05ac1aa7b798ba11d2e497d5cce6ce6d3dc">llvm::CmpInst::ICMP_SGE</a></div><div class="ttdoc">signed greater or equal </div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00679">InstrTypes.h:679</a></div></div>
<div class="ttc" id="IndVarSimplify_8cpp_html_a566d8ea0c046e39ce95437e5c8390b8f"><div class="ttname"><a href="IndVarSimplify_8cpp.html#a566d8ea0c046e39ce95437e5c8390b8f">indvars</a></div><div class="ttdeci">indvars</div><div class="ttdef"><b>Definition:</b> <a href="IndVarSimplify_8cpp_source.html#l00127">IndVarSimplify.cpp:127</a></div></div>
<div class="ttc" id="classllvm_1_1SCEVConstant_html"><div class="ttname"><a href="classllvm_1_1SCEVConstant.html">llvm::SCEVConstant</a></div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolutionExpressions_8h_source.html#l00037">ScalarEvolutionExpressions.h:37</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<hr>
<p class="footer">
Generated on Sat Nov 10 2018 22:58:56 for <a href="http://llvm.org/">LLVM</a> by
<a href="http://www.doxygen.org"><img src="doxygen.png" alt="Doxygen"
align="middle" border="0"/>1.8.11</a><br>
Copyright &copy; 2003-2013 University of Illinois at Urbana-Champaign.
All Rights Reserved.</p>
<hr>
<!--#include virtual="/attrib.incl" -->
</body>
</html>
