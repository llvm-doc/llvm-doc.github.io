<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head>
<meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1"/>
<meta name="keywords" content="LLVM,Low Level Virtual Machine,C++,doxygen,API,documentation"/>
<meta name="description" content="C++ source code API documentation for LLVM."/>
<title>LLVM: JITMemoryManager.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head><body>
<p class="title">LLVM API Documentation</p>
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('JITMemoryManager_8cpp_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">JITMemoryManager.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="JITMemoryManager_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//===-- JITMemoryManager.cpp - Memory Allocator for JIT&#39;d code ------------===//</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">//                     The LLVM Compiler Infrastructure</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// This file is distributed under the University of Illinois Open Source</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">// License. See LICENSE.TXT for details.</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">// This file defines the DefaultJITMemoryManager class.</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;</div><div class="line"><a name="l00014"></a><span class="lineno"><a class="line" href="JITMemoryManager_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">   14</a></span>&#160;<span class="preprocessor">#define DEBUG_TYPE &quot;jit&quot;</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="JITMemoryManager_8h.html">llvm/ExecutionEngine/JITMemoryManager.h</a>&quot;</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="SmallPtrSet_8h.html">llvm/ADT/SmallPtrSet.h</a>&quot;</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Statistic_8h.html">llvm/ADT/Statistic.h</a>&quot;</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Twine_8h.html">llvm/ADT/Twine.h</a>&quot;</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &quot;llvm/Config/config.h&quot;</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="GlobalValue_8h.html">llvm/IR/GlobalValue.h</a>&quot;</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Allocator_8h.html">llvm/Support/Allocator.h</a>&quot;</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Compiler_8h.html">llvm/Support/Compiler.h</a>&quot;</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Debug_8h.html">llvm/Support/Debug.h</a>&quot;</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="DynamicLibrary_8h.html">llvm/Support/DynamicLibrary.h</a>&quot;</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ErrorHandling_8h.html">llvm/Support/ErrorHandling.h</a>&quot;</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Memory_8h.html">llvm/Support/Memory.h</a>&quot;</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="raw__ostream_8h.html">llvm/Support/raw_ostream.h</a>&quot;</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &lt;cassert&gt;</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &lt;climits&gt;</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &lt;cstring&gt;</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &lt;vector&gt;</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#if defined(__linux__)</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#if defined(HAVE_SYS_STAT_H)</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &lt;sys/stat.h&gt;</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#include &lt;fcntl.h&gt;</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#include &lt;unistd.h&gt;</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespacellvm.html">llvm</a>;</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<a class="code" href="JITMemoryManager_8cpp.html#a6368a8b73265b5b4877897f7f95d24d4">STATISTIC</a>(NumSlabs, <span class="stringliteral">&quot;Number of slabs of memory allocated by the JIT&quot;</span>);</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;</div><div class="line"><a name="l00045"></a><span class="lineno"><a class="line" href="classllvm_1_1JITMemoryManager.html#a83a5bf651c95359c4c13ad3849fb585a">   45</a></span>&#160;<a class="code" href="classllvm_1_1JITMemoryManager.html#a83a5bf651c95359c4c13ad3849fb585a">JITMemoryManager::~JITMemoryManager</a>() {}</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">// Memory Block Implementation.</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="keyword">namespace </span>{<span class="comment"></span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">  /// MemoryRangeHeader - For a range of memory, this is the header that we put</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">  /// on the block of memory.  It is carefully crafted to be one word of memory.</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">  /// Allocated blocks have just this header, free&#39;d blocks have FreeRangeHeader</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">  /// which starts with this.</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment"></span>  <span class="keyword">struct </span>FreeRangeHeader;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  <span class="keyword">struct </span>MemoryRangeHeader {<span class="comment"></span></div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">    /// ThisAllocated - This is true if this block is currently allocated.  If</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">    /// not, this can be converted to a FreeRangeHeader.</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment"></span>    <span class="keywordtype">unsigned</span> ThisAllocated : 1;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">    /// PrevAllocated - Keep track of whether the block immediately before us is</span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">    /// allocated.  If not, the word immediately before this header is the size</span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment">    /// of the previous block.</span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment"></span>    <span class="keywordtype">unsigned</span> PrevAllocated : 1;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">    /// BlockSize - This is the size in bytes of this memory block,</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">    /// including this header.</span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment"></span>    uintptr_t BlockSize : (<span class="keyword">sizeof</span>(<a class="code" href="classintptr__t.html">intptr_t</a>)*CHAR_BIT - 2);</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment">    /// getBlockAfter - Return the memory block immediately after this one.</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">    ///</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment"></span>    MemoryRangeHeader &amp;getBlockAfter()<span class="keyword"> const </span>{</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;      <span class="keywordflow">return</span> *<span class="keyword">reinterpret_cast&lt;</span>MemoryRangeHeader *<span class="keyword">&gt;</span>(</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;                <span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;                  <span class="keyword">const_cast&lt;</span>MemoryRangeHeader *<span class="keyword">&gt;</span>(<span class="keyword">this</span>))+BlockSize);</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    }</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">    /// getFreeBlockBefore - If the block before this one is free, return it,</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">    /// otherwise return null.</span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment"></span>    FreeRangeHeader *getFreeBlockBefore()<span class="keyword"> const </span>{</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;      <span class="keywordflow">if</span> (PrevAllocated) <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;      <a class="code" href="classintptr__t.html">intptr_t</a> PrevSize = <span class="keyword">reinterpret_cast&lt;</span><a class="code" href="classintptr__t.html">intptr_t</a> *<span class="keyword">&gt;</span>(</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;                            <span class="keyword">const_cast&lt;</span>MemoryRangeHeader *<span class="keyword">&gt;</span>(<span class="keyword">this</span>))[-1];</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">reinterpret_cast&lt;</span>FreeRangeHeader *<span class="keyword">&gt;</span>(</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;               <span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;                 <span class="keyword">const_cast&lt;</span>MemoryRangeHeader *<span class="keyword">&gt;</span>(<span class="keyword">this</span>))-PrevSize);</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    }</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment">    /// FreeBlock - Turn an allocated block into a free block, adjusting</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment">    /// bits in the object headers, and adding an end of region memory block.</span></div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment"></span>    FreeRangeHeader *FreeBlock(FreeRangeHeader *FreeList);</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment">    /// TrimAllocationToSize - If this allocated block is significantly larger</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment">    /// than NewSize, split it into two pieces (where the former is NewSize</span></div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment">    /// bytes, including the header), and add the new block to the free list.</span></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment"></span>    FreeRangeHeader *TrimAllocationToSize(FreeRangeHeader *FreeList,</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;                                          uint64_t NewSize);</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  };</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment">  /// FreeRangeHeader - For a memory block that isn&#39;t already allocated, this</span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment">  /// keeps track of the current block and has a pointer to the next free block.</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">  /// Free blocks are kept on a circularly linked list.</span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment"></span>  <span class="keyword">struct </span>FreeRangeHeader : <span class="keyword">public</span> MemoryRangeHeader {</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    FreeRangeHeader *Prev;</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    FreeRangeHeader *Next;</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment">    /// getMinBlockSize - Get the minimum size for a memory block.  Blocks</span></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment">    /// smaller than this size cannot be created.</span></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment"></span>    <span class="keyword">static</span> <span class="keywordtype">unsigned</span> getMinBlockSize() {</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">sizeof</span>(FreeRangeHeader)+<span class="keyword">sizeof</span>(<a class="code" href="classintptr__t.html">intptr_t</a>);</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    }</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment">    /// SetEndOfBlockSizeMarker - The word at the end of every free block is</span></div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment">    /// known to be the size of the free block.  Set it for this block.</span></div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> SetEndOfBlockSizeMarker() {</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;      <span class="keywordtype">void</span> *EndOfBlock = (<span class="keywordtype">char</span>*)<span class="keyword">this</span> + BlockSize;</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;      ((<a class="code" href="classintptr__t.html">intptr_t</a> *)EndOfBlock)[-1] = BlockSize;</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    }</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    FreeRangeHeader *RemoveFromFreeList() {</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;      assert(Next-&gt;Prev == <span class="keyword">this</span> &amp;&amp; Prev-&gt;Next == <span class="keyword">this</span> &amp;&amp; <span class="stringliteral">&quot;Freelist broken!&quot;</span>);</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;      Next-&gt;Prev = Prev;</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;      <span class="keywordflow">return</span> Prev-&gt;Next = Next;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    }</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <span class="keywordtype">void</span> AddToFreeList(FreeRangeHeader *FreeList) {</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;      Next = FreeList;</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;      Prev = FreeList-&gt;Prev;</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;      Prev-&gt;Next = <span class="keyword">this</span>;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;      Next-&gt;Prev = <span class="keyword">this</span>;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    }</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment">    /// GrowBlock - The block after this block just got deallocated.  Merge it</span></div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment">    /// into the current block.</span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> GrowBlock(uintptr_t NewSize);</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment">    /// AllocateBlock - Mark this entire block allocated, updating freelists</span></div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment">    /// etc.  This returns a pointer to the circular free-list.</span></div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment"></span>    FreeRangeHeader *AllocateBlock();</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  };</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;}</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment">/// AllocateBlock - Mark this entire block allocated, updating freelists</span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment">/// etc.  This returns a pointer to the circular free-list.</span></div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment"></span>FreeRangeHeader *FreeRangeHeader::AllocateBlock() {</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  assert(!ThisAllocated &amp;&amp; !getBlockAfter().PrevAllocated &amp;&amp;</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;         <span class="stringliteral">&quot;Cannot allocate an allocated block!&quot;</span>);</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  <span class="comment">// Mark this block allocated.</span></div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  ThisAllocated = 1;</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  getBlockAfter().PrevAllocated = 1;</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  <span class="comment">// Remove it from the free list.</span></div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  <span class="keywordflow">return</span> RemoveFromFreeList();</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;}</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment">/// FreeBlock - Turn an allocated block into a free block, adjusting</span></div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="comment">/// bits in the object headers, and adding an end of region memory block.</span></div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="comment">/// If possible, coalesce this block with neighboring blocks.  Return the</span></div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="comment">/// FreeRangeHeader to allocate from.</span></div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="comment"></span>FreeRangeHeader *MemoryRangeHeader::FreeBlock(FreeRangeHeader *FreeList) {</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  MemoryRangeHeader *FollowingBlock = &amp;getBlockAfter();</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  assert(ThisAllocated &amp;&amp; <span class="stringliteral">&quot;This block is already free!&quot;</span>);</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  assert(FollowingBlock-&gt;PrevAllocated &amp;&amp; <span class="stringliteral">&quot;Flags out of sync!&quot;</span>);</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  FreeRangeHeader *FreeListToReturn = FreeList;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  <span class="comment">// If the block after this one is free, merge it into this block.</span></div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  <span class="keywordflow">if</span> (!FollowingBlock-&gt;ThisAllocated) {</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    FreeRangeHeader &amp;FollowingFreeBlock = *(FreeRangeHeader *)FollowingBlock;</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <span class="comment">// &quot;FreeList&quot; always needs to be a valid free block.  If we&#39;re about to</span></div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <span class="comment">// coalesce with it, update our notion of what the free list is.</span></div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="keywordflow">if</span> (&amp;FollowingFreeBlock == FreeList) {</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;      FreeList = FollowingFreeBlock.Next;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;      FreeListToReturn = 0;</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;      assert(&amp;FollowingFreeBlock != FreeList &amp;&amp; <span class="stringliteral">&quot;No tombstone block?&quot;</span>);</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    }</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    FollowingFreeBlock.RemoveFromFreeList();</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="comment">// Include the following block into this one.</span></div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    BlockSize += FollowingFreeBlock.BlockSize;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    FollowingBlock = &amp;FollowingFreeBlock.getBlockAfter();</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <span class="comment">// Tell the block after the block we are coalescing that this block is</span></div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="comment">// allocated.</span></div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    FollowingBlock-&gt;PrevAllocated = 1;</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  }</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  assert(FollowingBlock-&gt;ThisAllocated &amp;&amp; <span class="stringliteral">&quot;Missed coalescing?&quot;</span>);</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  <span class="keywordflow">if</span> (FreeRangeHeader *PrevFreeBlock = getFreeBlockBefore()) {</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    PrevFreeBlock-&gt;GrowBlock(PrevFreeBlock-&gt;BlockSize + BlockSize);</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="keywordflow">return</span> FreeListToReturn ? FreeListToReturn : PrevFreeBlock;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  }</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  <span class="comment">// Otherwise, mark this block free.</span></div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  FreeRangeHeader &amp;FreeBlock = *(FreeRangeHeader*)<span class="keyword">this</span>;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;  FollowingBlock-&gt;PrevAllocated = 0;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  FreeBlock.ThisAllocated = 0;</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  <span class="comment">// Link this into the linked list of free blocks.</span></div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  FreeBlock.AddToFreeList(FreeList);</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  <span class="comment">// Add a marker at the end of the block, indicating the size of this free</span></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  <span class="comment">// block.</span></div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;  FreeBlock.SetEndOfBlockSizeMarker();</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  <span class="keywordflow">return</span> FreeListToReturn ? FreeListToReturn : &amp;FreeBlock;</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;}</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="comment">/// GrowBlock - The block after this block just got deallocated.  Merge it</span></div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="comment">/// into the current block.</span></div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="comment"></span><span class="keywordtype">void</span> FreeRangeHeader::GrowBlock(uintptr_t NewSize) {</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  assert(NewSize &gt; BlockSize &amp;&amp; <span class="stringliteral">&quot;Not growing block?&quot;</span>);</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  BlockSize = NewSize;</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;  SetEndOfBlockSizeMarker();</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;  getBlockAfter().PrevAllocated = 0;</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;}</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="comment">/// TrimAllocationToSize - If this allocated block is significantly larger</span></div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="comment">/// than NewSize, split it into two pieces (where the former is NewSize</span></div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="comment">/// bytes, including the header), and add the new block to the free list.</span></div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="comment"></span>FreeRangeHeader *MemoryRangeHeader::</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;TrimAllocationToSize(FreeRangeHeader *FreeList, uint64_t NewSize) {</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;  assert(ThisAllocated &amp;&amp; getBlockAfter().PrevAllocated &amp;&amp;</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;         <span class="stringliteral">&quot;Cannot deallocate part of an allocated block!&quot;</span>);</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  <span class="comment">// Don&#39;t allow blocks to be trimmed below minimum required size</span></div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  NewSize = std::max&lt;uint64_t&gt;(FreeRangeHeader::getMinBlockSize(), NewSize);</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  <span class="comment">// Round up size for alignment of header.</span></div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  <span class="keywordtype">unsigned</span> HeaderAlign = __alignof(FreeRangeHeader);</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  NewSize = (NewSize+ (HeaderAlign-1)) &amp; ~(HeaderAlign-1);</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  <span class="comment">// Size is now the size of the block we will remove from the start of the</span></div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  <span class="comment">// current block.</span></div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  assert(NewSize &lt;= BlockSize &amp;&amp;</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;         <span class="stringliteral">&quot;Allocating more space from this block than exists!&quot;</span>);</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  <span class="comment">// If splitting this block will cause the remainder to be too small, do not</span></div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  <span class="comment">// split the block.</span></div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;  <span class="keywordflow">if</span> (BlockSize &lt;= NewSize+FreeRangeHeader::getMinBlockSize())</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <span class="keywordflow">return</span> FreeList;</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  <span class="comment">// Otherwise, we splice the required number of bytes out of this block, form</span></div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  <span class="comment">// a new block immediately after it, then mark this block allocated.</span></div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  MemoryRangeHeader &amp;FormerNextBlock = getBlockAfter();</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;  <span class="comment">// Change the size of this block.</span></div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  BlockSize = NewSize;</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;  <span class="comment">// Get the new block we just sliced out and turn it into a free block.</span></div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  FreeRangeHeader &amp;NewNextBlock = (FreeRangeHeader &amp;)getBlockAfter();</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;  NewNextBlock.BlockSize = (<span class="keywordtype">char</span>*)&amp;FormerNextBlock - (<span class="keywordtype">char</span>*)&amp;NewNextBlock;</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;  NewNextBlock.ThisAllocated = 0;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;  NewNextBlock.PrevAllocated = 1;</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;  NewNextBlock.SetEndOfBlockSizeMarker();</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;  FormerNextBlock.PrevAllocated = 0;</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;  NewNextBlock.AddToFreeList(FreeList);</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;  <span class="keywordflow">return</span> &amp;NewNextBlock;</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;}</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment">// Memory Block Implementation.</span></div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="keyword">namespace </span>{</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  <span class="keyword">class </span>DefaultJITMemoryManager;</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  <span class="keyword">class </span>JITSlabAllocator : <span class="keyword">public</span> <a class="code" href="classllvm_1_1SlabAllocator.html">SlabAllocator</a> {</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    DefaultJITMemoryManager &amp;JMM;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;  <span class="keyword">public</span>:</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    JITSlabAllocator(DefaultJITMemoryManager &amp;jmm) : JMM(jmm) { }</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <span class="keyword">virtual</span> ~JITSlabAllocator() { }</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <span class="keyword">virtual</span> <a class="code" href="classllvm_1_1MemSlab.html">MemSlab</a> *Allocate(<span class="keywordtype">size_t</span> Size);</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">void</span> Deallocate(<a class="code" href="classllvm_1_1MemSlab.html">MemSlab</a> *Slab);</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  };</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="comment">  /// DefaultJITMemoryManager - Manage memory for the JIT code generation.</span></div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="comment">  /// This splits a large block of MAP_NORESERVE&#39;d memory into two</span></div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="comment">  /// sections, one for function stubs, one for the functions themselves.  We</span></div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="comment">  /// have to do this because we may need to emit a function stub while in the</span></div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="comment">  /// middle of emitting a function, and we don&#39;t know how large the function we</span></div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="comment">  /// are emitting is.</span></div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="comment"></span>  <span class="keyword">class </span>DefaultJITMemoryManager : <span class="keyword">public</span> <a class="code" href="classllvm_1_1JITMemoryManager.html">JITMemoryManager</a> {</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <span class="comment">// Whether to poison freed memory.</span></div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <span class="keywordtype">bool</span> PoisonMemory;</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="comment">    /// LastSlab - This points to the last slab allocated and is used as the</span></div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="comment">    /// NearBlock parameter to AllocateRWX so that we can attempt to lay out all</span></div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="comment">    /// stubs, data, and code contiguously in memory.  In general, however, this</span></div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="comment">    /// is not possible because the NearBlock parameter is ignored on Windows</span></div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment">    /// platforms and even on Unix it works on a best-effort pasis.</span></div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="comment"></span>    <a class="code" href="classllvm_1_1sys_1_1MemoryBlock.html">sys::MemoryBlock</a> LastSlab;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <span class="comment">// Memory slabs allocated by the JIT.  We refer to them as slabs so we don&#39;t</span></div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <span class="comment">// confuse them with the blocks of memory described above.</span></div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    std::vector&lt;sys::MemoryBlock&gt; CodeSlabs;</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    JITSlabAllocator BumpSlabAllocator;</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <a class="code" href="classllvm_1_1BumpPtrAllocator.html">BumpPtrAllocator</a> StubAllocator;</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <a class="code" href="classllvm_1_1BumpPtrAllocator.html">BumpPtrAllocator</a> DataAllocator;</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    <span class="comment">// Circular list of free blocks.</span></div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    FreeRangeHeader *FreeMemoryList;</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <span class="comment">// When emitting code into a memory block, this is the block.</span></div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    MemoryRangeHeader *CurBlock;</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    uint8_t *GOTBase;     <span class="comment">// Target Specific reserved memory</span></div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;  <span class="keyword">public</span>:</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    DefaultJITMemoryManager();</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    ~DefaultJITMemoryManager();</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment">    /// allocateNewSlab - Allocates a new MemoryBlock and remembers it as the</span></div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="comment">    /// last slab it allocated, so that subsequent allocations follow it.</span></div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="comment"></span>    <a class="code" href="classllvm_1_1sys_1_1MemoryBlock.html">sys::MemoryBlock</a> allocateNewSlab(<span class="keywordtype">size_t</span> <a class="code" href="Target_2README_8txt.html#a02def7c594e9f19ff247ed0bf33d1c30">size</a>);</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="comment">    /// DefaultCodeSlabSize - When we have to go map more memory, we allocate at</span></div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="comment">    /// least this much unless more is requested.</span></div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="comment"></span>    <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">size_t</span> DefaultCodeSlabSize;</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="comment">    /// DefaultSlabSize - Allocate data into slabs of this size unless we get</span></div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="comment">    /// an allocation above SizeThreshold.</span></div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="comment"></span>    <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">size_t</span> DefaultSlabSize;</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="comment">    /// DefaultSizeThreshold - For any allocation larger than this threshold, we</span></div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="comment">    /// should allocate a separate slab.</span></div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="comment"></span>    <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">size_t</span> DefaultSizeThreshold;</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="comment">    /// getPointerToNamedFunction - This method returns the address of the</span></div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment">    /// specified function by using the dlsym function call.</span></div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="comment"></span>    <span class="keyword">virtual</span> <span class="keywordtype">void</span> *<a class="code" href="classllvm_1_1RTDyldMemoryManager.html#a4e5d745e695dc62ebaec15f537af9fed">getPointerToNamedFunction</a>(<span class="keyword">const</span> std::string &amp;<a class="code" href="namespacellvm_1_1GraphProgram.html#a0ad4685976f8c4d4a697a53fbe05d10b">Name</a>,</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;                                            <span class="keywordtype">bool</span> AbortOnFailure = <span class="keyword">true</span>);</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classllvm_1_1JITMemoryManager.html#a4cf108ee8b6c664303499668c46f0f49">AllocateGOT</a>();</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <span class="comment">// Testing methods.</span></div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="classllvm_1_1JITMemoryManager.html#a860ddc8e1ceb0bcc49c2a6828bd88922">CheckInvariants</a>(std::string &amp;ErrorStr);</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="classllvm_1_1JITMemoryManager.html#a450d074b4c791654d971cfc25ab080eb">GetDefaultCodeSlabSize</a>() { <span class="keywordflow">return</span> DefaultCodeSlabSize; }</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="classllvm_1_1JITMemoryManager.html#ab339f6b5a3613daac95898e6979dc83e">GetDefaultDataSlabSize</a>() { <span class="keywordflow">return</span> DefaultSlabSize; }</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="classllvm_1_1JITMemoryManager.html#a8c46139571f57b67e393f445486f8898">GetDefaultStubSlabSize</a>() { <span class="keywordflow">return</span> DefaultSlabSize; }</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    <span class="keywordtype">unsigned</span> <a class="code" href="classllvm_1_1JITMemoryManager.html#a8c65e53d44ba3e8a8e9c2a7ad144ae17">GetNumCodeSlabs</a>() { <span class="keywordflow">return</span> CodeSlabs.size(); }</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    <span class="keywordtype">unsigned</span> <a class="code" href="classllvm_1_1JITMemoryManager.html#a6e22cda5944b162cfb671e242894fa54">GetNumDataSlabs</a>() { <span class="keywordflow">return</span> DataAllocator.<a class="code" href="classllvm_1_1BumpPtrAllocator.html#a1aa523db85a27032377186d5d8c2ccd5">GetNumSlabs</a>(); }</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    <span class="keywordtype">unsigned</span> <a class="code" href="classllvm_1_1JITMemoryManager.html#a9996a30064d40feeb4e23991ef2e5fb6">GetNumStubSlabs</a>() { <span class="keywordflow">return</span> StubAllocator.<a class="code" href="classllvm_1_1BumpPtrAllocator.html#a1aa523db85a27032377186d5d8c2ccd5">GetNumSlabs</a>(); }</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="comment">    /// startFunctionBody - When a function starts, allocate a block of free</span></div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="comment">    /// executable memory, returning a pointer to it and its actual size.</span></div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="comment"></span>    uint8_t *<a class="code" href="classllvm_1_1JITMemoryManager.html#a3f99e7db9b54b646c744e1842ae34be0">startFunctionBody</a>(<span class="keyword">const</span> <a class="code" href="classllvm_1_1Function.html">Function</a> *<a class="code" href="LLParser_8cpp.html#a33ece1ef8074506a15d7f86eb76dbae6">F</a>, uintptr_t &amp;ActualSize) {</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;      FreeRangeHeader* candidateBlock = FreeMemoryList;</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;      FreeRangeHeader* head = FreeMemoryList;</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;      FreeRangeHeader* iter = head-&gt;Next;</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;      uintptr_t largest = candidateBlock-&gt;BlockSize;</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;      <span class="comment">// Search for the largest free block</span></div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;      <span class="keywordflow">while</span> (iter != head) {</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        <span class="keywordflow">if</span> (iter-&gt;BlockSize &gt; largest) {</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;          largest = iter-&gt;BlockSize;</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;          candidateBlock = iter;</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;        }</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;        iter = iter-&gt;Next;</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;      }</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;      largest = largest - <span class="keyword">sizeof</span>(MemoryRangeHeader);</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;      <span class="comment">// If this block isn&#39;t big enough for the allocation desired, allocate</span></div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;      <span class="comment">// another block of memory and add it to the free list.</span></div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;      <span class="keywordflow">if</span> (largest &lt; ActualSize ||</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;          largest &lt;= FreeRangeHeader::getMinBlockSize()) {</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;        <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;JIT: Allocating another slab of memory for function.&quot;</span>);</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        candidateBlock = allocateNewCodeSlab((<span class="keywordtype">size_t</span>)ActualSize);</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;      }</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;      <span class="comment">// Select this candidate block for allocation</span></div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;      CurBlock = candidateBlock;</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;      <span class="comment">// Allocate the entire memory block.</span></div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;      FreeMemoryList = candidateBlock-&gt;AllocateBlock();</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;      ActualSize = CurBlock-&gt;BlockSize - <span class="keyword">sizeof</span>(MemoryRangeHeader);</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;      <span class="keywordflow">return</span> (uint8_t *)(CurBlock + 1);</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    }</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="comment">    /// allocateNewCodeSlab - Helper method to allocate a new slab of code</span></div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="comment">    /// memory from the OS and add it to the free list.  Returns the new</span></div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="comment">    /// FreeRangeHeader at the base of the slab.</span></div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="comment"></span>    FreeRangeHeader *allocateNewCodeSlab(<span class="keywordtype">size_t</span> MinSize) {</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;      <span class="comment">// If the user needs at least MinSize free memory, then we account for</span></div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;      <span class="comment">// two MemoryRangeHeaders: the one in the user&#39;s block, and the one at the</span></div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;      <span class="comment">// end of the slab.</span></div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;      <span class="keywordtype">size_t</span> PaddedMin = MinSize + 2 * <span class="keyword">sizeof</span>(MemoryRangeHeader);</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;      <span class="keywordtype">size_t</span> SlabSize = std::max(DefaultCodeSlabSize, PaddedMin);</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;      <a class="code" href="classllvm_1_1sys_1_1MemoryBlock.html">sys::MemoryBlock</a> <a class="code" href="Target_2ARM_2README_8txt.html#a90cca76dd78688687e0d697679dbc799">B</a> = allocateNewSlab(SlabSize);</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;      CodeSlabs.push_back(B);</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;      <span class="keywordtype">char</span> *MemBase = (<span class="keywordtype">char</span>*)(B.<a class="code" href="classllvm_1_1sys_1_1MemoryBlock.html#adf2f5548b7f0d0f6a86f2578581d8380">base</a>());</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;      <span class="comment">// Put a tiny allocated block at the end of the memory chunk, so when</span></div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;      <span class="comment">// FreeBlock calls getBlockAfter it doesn&#39;t fall off the end.</span></div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;      MemoryRangeHeader *EndBlock =</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;          (MemoryRangeHeader*)(MemBase + B.<a class="code" href="classllvm_1_1sys_1_1MemoryBlock.html#a5f95acd45968a93a9b1935a71dbbb344">size</a>()) - 1;</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;      EndBlock-&gt;ThisAllocated = 1;</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;      EndBlock-&gt;PrevAllocated = 0;</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;      EndBlock-&gt;BlockSize = <span class="keyword">sizeof</span>(MemoryRangeHeader);</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;      <span class="comment">// Start out with a vast new block of free memory.</span></div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;      FreeRangeHeader *NewBlock = (FreeRangeHeader*)MemBase;</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;      NewBlock-&gt;ThisAllocated = 0;</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;      <span class="comment">// Make sure getFreeBlockBefore doesn&#39;t look into unmapped memory.</span></div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;      NewBlock-&gt;PrevAllocated = 1;</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;      NewBlock-&gt;BlockSize = (uintptr_t)EndBlock - (uintptr_t)NewBlock;</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;      NewBlock-&gt;SetEndOfBlockSizeMarker();</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;      NewBlock-&gt;AddToFreeList(FreeMemoryList);</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;      assert(NewBlock-&gt;BlockSize - <span class="keyword">sizeof</span>(MemoryRangeHeader) &gt;= MinSize &amp;&amp;</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;             <span class="stringliteral">&quot;The block was too small!&quot;</span>);</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;      <span class="keywordflow">return</span> NewBlock;</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    }</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="comment">    /// endFunctionBody - The function F is now allocated, and takes the memory</span></div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="comment">    /// in the range [FunctionStart,FunctionEnd).</span></div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classllvm_1_1JITMemoryManager.html#a696d95930a3fb254452065e122ec5cda">endFunctionBody</a>(<span class="keyword">const</span> <a class="code" href="classllvm_1_1Function.html">Function</a> *F, uint8_t *FunctionStart,</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;                         uint8_t *FunctionEnd) {</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;      assert(FunctionEnd &gt; FunctionStart);</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;      assert(FunctionStart == (uint8_t *)(CurBlock+1) &amp;&amp;</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;             <span class="stringliteral">&quot;Mismatched function start/end!&quot;</span>);</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;      uintptr_t BlockSize = FunctionEnd - (uint8_t *)CurBlock;</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;      <span class="comment">// Release the memory at the end of this block that isn&#39;t needed.</span></div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;      FreeMemoryList =CurBlock-&gt;TrimAllocationToSize(FreeMemoryList, BlockSize);</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    }</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;<span class="comment">    /// allocateSpace - Allocate a memory block of the given size.  This method</span></div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="comment">    /// cannot be called between calls to startFunctionBody and endFunctionBody.</span></div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;<span class="comment"></span>    uint8_t *<a class="code" href="classllvm_1_1JITMemoryManager.html#a36b4c538f45ef891a3cb54a1bf2e2e38">allocateSpace</a>(<a class="code" href="classintptr__t.html">intptr_t</a> Size, <span class="keywordtype">unsigned</span> Alignment) {</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;      CurBlock = FreeMemoryList;</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;      FreeMemoryList = FreeMemoryList-&gt;AllocateBlock();</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;      uint8_t *<a class="code" href="Target_2README_8txt.html#aae67c508d4f0716516f5c412c5592556">result</a> = (uint8_t *)(CurBlock + 1);</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;      <span class="keywordflow">if</span> (Alignment == 0) Alignment = 1;</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;      result = (uint8_t*)(((<a class="code" href="classintptr__t.html">intptr_t</a>)result+Alignment-1) &amp;</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;               ~(<a class="code" href="classintptr__t.html">intptr_t</a>)(Alignment-1));</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;      uintptr_t BlockSize = result + Size - (uint8_t *)CurBlock;</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;      FreeMemoryList =CurBlock-&gt;TrimAllocationToSize(FreeMemoryList, BlockSize);</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="Target_2README_8txt.html#aae67c508d4f0716516f5c412c5592556">result</a>;</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    }</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="comment">    /// allocateStub - Allocate memory for a function stub.</span></div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;<span class="comment"></span>    uint8_t *<a class="code" href="classllvm_1_1JITMemoryManager.html#aae9ef3b68b5c03764756faf7f1de7f03">allocateStub</a>(<span class="keyword">const</span> <a class="code" href="classllvm_1_1GlobalValue.html">GlobalValue</a>* F, <span class="keywordtype">unsigned</span> StubSize,</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;                          <span class="keywordtype">unsigned</span> Alignment) {</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;      <span class="keywordflow">return</span> (uint8_t*)StubAllocator.<a class="code" href="classllvm_1_1BumpPtrAllocator.html#a77df739db3a1603903dfa595e214a84b">Allocate</a>(StubSize, Alignment);</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    }</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;<span class="comment">    /// allocateGlobal - Allocate memory for a global.</span></div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;<span class="comment"></span>    uint8_t *<a class="code" href="classllvm_1_1JITMemoryManager.html#ad4ed966cba0cd68c00126e597077eb53">allocateGlobal</a>(uintptr_t Size, <span class="keywordtype">unsigned</span> Alignment) {</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;      <span class="keywordflow">return</span> (uint8_t*)DataAllocator.<a class="code" href="classllvm_1_1BumpPtrAllocator.html#a77df739db3a1603903dfa595e214a84b">Allocate</a>(Size, Alignment);</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    }</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;<span class="comment">    /// allocateCodeSection - Allocate memory for a code section.</span></div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;<span class="comment"></span>    uint8_t *<a class="code" href="classllvm_1_1RTDyldMemoryManager.html#a80b0a71d3687c9acc13f021de0cc891a">allocateCodeSection</a>(uintptr_t Size, <span class="keywordtype">unsigned</span> Alignment,</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;                                 <span class="keywordtype">unsigned</span> SectionID, <a class="code" href="classllvm_1_1StringRef.html">StringRef</a> SectionName) {</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;      <span class="comment">// Grow the required block size to account for the block header</span></div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;      Size += <span class="keyword">sizeof</span>(*CurBlock);</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;      <span class="comment">// Alignment handling.</span></div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;      <span class="keywordflow">if</span> (!Alignment)</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;        Alignment = 16;</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;      Size += Alignment - 1;</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;      FreeRangeHeader* candidateBlock = FreeMemoryList;</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;      FreeRangeHeader* head = FreeMemoryList;</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;      FreeRangeHeader* iter = head-&gt;Next;</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;      uintptr_t largest = candidateBlock-&gt;BlockSize;</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;      <span class="comment">// Search for the largest free block.</span></div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;      <span class="keywordflow">while</span> (iter != head) {</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;        <span class="keywordflow">if</span> (iter-&gt;BlockSize &gt; largest) {</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;          largest = iter-&gt;BlockSize;</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;          candidateBlock = iter;</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;        }</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;        iter = iter-&gt;Next;</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;      }</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;      largest = largest - <span class="keyword">sizeof</span>(MemoryRangeHeader);</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;      <span class="comment">// If this block isn&#39;t big enough for the allocation desired, allocate</span></div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;      <span class="comment">// another block of memory and add it to the free list.</span></div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;      <span class="keywordflow">if</span> (largest &lt; Size || largest &lt;= FreeRangeHeader::getMinBlockSize()) {</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;        <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;JIT: Allocating another slab of memory for function.&quot;</span>);</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;        candidateBlock = allocateNewCodeSlab((<span class="keywordtype">size_t</span>)Size);</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;      }</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;      <span class="comment">// Select this candidate block for allocation</span></div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;      CurBlock = candidateBlock;</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;      <span class="comment">// Allocate the entire memory block.</span></div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;      FreeMemoryList = candidateBlock-&gt;AllocateBlock();</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;      <span class="comment">// Release the memory at the end of this block that isn&#39;t needed.</span></div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;      FreeMemoryList = CurBlock-&gt;TrimAllocationToSize(FreeMemoryList, Size);</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;      uintptr_t unalignedAddr = (uintptr_t)CurBlock + <span class="keyword">sizeof</span>(*CurBlock);</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;      <span class="keywordflow">return</span> (uint8_t*)<a class="code" href="namespacellvm.html#aadf66db071227857a2ae14e078d6b4cd">RoundUpToAlignment</a>((uint64_t)unalignedAddr, Alignment);</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    }</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;<span class="comment">    /// allocateDataSection - Allocate memory for a data section.</span></div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;<span class="comment"></span>    uint8_t *<a class="code" href="classllvm_1_1RTDyldMemoryManager.html#aa4182acc7b4bf02dbec44bf67eb7e57f">allocateDataSection</a>(uintptr_t Size, <span class="keywordtype">unsigned</span> Alignment,</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;                                 <span class="keywordtype">unsigned</span> SectionID, <a class="code" href="classllvm_1_1StringRef.html">StringRef</a> SectionName,</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;                                 <span class="keywordtype">bool</span> IsReadOnly) {</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;      <span class="keywordflow">return</span> (uint8_t*)DataAllocator.<a class="code" href="classllvm_1_1BumpPtrAllocator.html#a77df739db3a1603903dfa595e214a84b">Allocate</a>(Size, Alignment);</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    }</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classllvm_1_1RTDyldMemoryManager.html#ac5196188a3a422dafd7a965232ccedb4">finalizeMemory</a>(std::string *ErrMsg) {</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    }</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    uint8_t *<a class="code" href="classllvm_1_1JITMemoryManager.html#a4d0c4f1849d0def5539950c047a2ce7f">getGOTBase</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;      <span class="keywordflow">return</span> GOTBase;</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    }</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    <span class="keywordtype">void</span> deallocateBlock(<span class="keywordtype">void</span> *Block) {</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;      <span class="comment">// Find the block that is allocated for this function.</span></div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;      MemoryRangeHeader *MemRange = <span class="keyword">static_cast&lt;</span>MemoryRangeHeader*<span class="keyword">&gt;</span>(Block) - 1;</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;      assert(MemRange-&gt;ThisAllocated &amp;&amp; <span class="stringliteral">&quot;Block isn&#39;t allocated!&quot;</span>);</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;      <span class="comment">// Fill the buffer with garbage!</span></div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;      <span class="keywordflow">if</span> (PoisonMemory) {</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;        <a class="code" href="namespacellvm_1_1Intrinsic.html#a73349916f7e54a6b988a3646c7a02e90ae857cbc5cf8c5a980f0bd245ad5ec61a">memset</a>(MemRange+1, 0xCD, MemRange-&gt;BlockSize-<span class="keyword">sizeof</span>(*MemRange));</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;      }</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;      <span class="comment">// Free the memory.</span></div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;      FreeMemoryList = MemRange-&gt;FreeBlock(FreeMemoryList);</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    }</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;<span class="comment">    /// deallocateFunctionBody - Deallocate all memory for the specified</span></div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;<span class="comment">    /// function body.</span></div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classllvm_1_1JITMemoryManager.html#afef9813bbed59c0d02d96e40c754b642">deallocateFunctionBody</a>(<span class="keywordtype">void</span> *Body) {</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;      <span class="keywordflow">if</span> (Body) deallocateBlock(Body);</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    }</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;<span class="comment">    /// setMemoryWritable - When code generation is in progress,</span></div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;<span class="comment">    /// the code pages may need permissions changed.</span></div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classllvm_1_1JITMemoryManager.html#a9add3e0d5a4e9ec4677f6a705094487f">setMemoryWritable</a>()</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    {</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0, e = CodeSlabs.size(); <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != e; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;        <a class="code" href="classllvm_1_1sys_1_1Memory.html#a9dee85d92a958b5b82049e9ed3afbd20">sys::Memory::setWritable</a>(CodeSlabs[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    }<span class="comment"></span></div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;<span class="comment">    /// setMemoryExecutable - When code generation is done and we&#39;re ready to</span></div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;<span class="comment">    /// start execution, the code pages may need permissions changed.</span></div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classllvm_1_1JITMemoryManager.html#a69db17a07690214a7455a102af15bae0">setMemoryExecutable</a>()</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    {</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0, e = CodeSlabs.size(); <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != e; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;        <a class="code" href="classllvm_1_1sys_1_1Memory.html#acf4d418979406a99e7230468647b4035">sys::Memory::setExecutable</a>(CodeSlabs[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    }</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;<span class="comment">    /// setPoisonMemory - Controls whether we write garbage over freed memory.</span></div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;<span class="comment">    ///</span></div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classllvm_1_1JITMemoryManager.html#a2badd0f16f40fb1b5cfe1e570170cc53">setPoisonMemory</a>(<span class="keywordtype">bool</span> poison) {</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;      PoisonMemory = poison;</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    }</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;  };</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;}</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;<a class="code" href="classllvm_1_1MemSlab.html">MemSlab</a> *JITSlabAllocator::Allocate(<span class="keywordtype">size_t</span> Size) {</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;  <a class="code" href="classllvm_1_1sys_1_1MemoryBlock.html">sys::MemoryBlock</a> <a class="code" href="Target_2ARM_2README_8txt.html#a90cca76dd78688687e0d697679dbc799">B</a> = JMM.allocateNewSlab(Size);</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;  <a class="code" href="classllvm_1_1MemSlab.html">MemSlab</a> *Slab = (<a class="code" href="classllvm_1_1MemSlab.html">MemSlab</a>*)B.<a class="code" href="classllvm_1_1sys_1_1MemoryBlock.html#adf2f5548b7f0d0f6a86f2578581d8380">base</a>();</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;  Slab-&gt;<a class="code" href="classllvm_1_1MemSlab.html#a84121cd853754d825060f630b4a68c61">Size</a> = B.<a class="code" href="classllvm_1_1sys_1_1MemoryBlock.html#a5f95acd45968a93a9b1935a71dbbb344">size</a>();</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;  Slab-&gt;<a class="code" href="classllvm_1_1MemSlab.html#aa3f124d77412e50860638f073ca25a2f">NextPtr</a> = 0;</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;  <span class="keywordflow">return</span> Slab;</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;}</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;<span class="keywordtype">void</span> JITSlabAllocator::Deallocate(<a class="code" href="classllvm_1_1MemSlab.html">MemSlab</a> *Slab) {</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;  <a class="code" href="classllvm_1_1sys_1_1MemoryBlock.html">sys::MemoryBlock</a> <a class="code" href="Target_2ARM_2README_8txt.html#a90cca76dd78688687e0d697679dbc799">B</a>(Slab, Slab-&gt;<a class="code" href="classllvm_1_1MemSlab.html#a84121cd853754d825060f630b4a68c61">Size</a>);</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;  <a class="code" href="classllvm_1_1sys_1_1Memory.html#ae7de707667a8c7de391ab5cab789b5eb">sys::Memory::ReleaseRWX</a>(B);</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;}</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;DefaultJITMemoryManager::DefaultJITMemoryManager()</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;  :</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;<span class="preprocessor">#ifdef NDEBUG</span></div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    PoisonMemory(<span class="keyword">false</span>),</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    PoisonMemory(<span class="keyword">true</span>),</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    LastSlab(0, 0),</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    BumpSlabAllocator(*<span class="keyword">this</span>),</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    StubAllocator(DefaultSlabSize, DefaultSizeThreshold, BumpSlabAllocator),</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    DataAllocator(DefaultSlabSize, DefaultSizeThreshold, BumpSlabAllocator) {</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;  <span class="comment">// Allocate space for code.</span></div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;  <a class="code" href="classllvm_1_1sys_1_1MemoryBlock.html">sys::MemoryBlock</a> MemBlock = allocateNewSlab(DefaultCodeSlabSize);</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;  CodeSlabs.push_back(MemBlock);</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;  uint8_t *MemBase = (uint8_t*)MemBlock.<a class="code" href="classllvm_1_1sys_1_1MemoryBlock.html#adf2f5548b7f0d0f6a86f2578581d8380">base</a>();</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;  <span class="comment">// We set up the memory chunk with 4 mem regions, like this:</span></div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;  <span class="comment">//  [ START</span></div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;  <span class="comment">//    [ Free      #0 ] -&gt; Large space to allocate functions from.</span></div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;  <span class="comment">//    [ Allocated #1 ] -&gt; Tiny space to separate regions.</span></div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;  <span class="comment">//    [ Free      #2 ] -&gt; Tiny space so there is always at least 1 free block.</span></div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;  <span class="comment">//    [ Allocated #3 ] -&gt; Tiny space to prevent looking past end of block.</span></div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;  <span class="comment">//  END ]</span></div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;  <span class="comment">//</span></div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;  <span class="comment">// The last three blocks are never deallocated or touched.</span></div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;  <span class="comment">// Add MemoryRangeHeader to the end of the memory region, indicating that</span></div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;  <span class="comment">// the space after the block of memory is allocated.  This is block #3.</span></div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;  MemoryRangeHeader *Mem3 = (MemoryRangeHeader*)(MemBase+MemBlock.<a class="code" href="classllvm_1_1sys_1_1MemoryBlock.html#a5f95acd45968a93a9b1935a71dbbb344">size</a>())-1;</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;  Mem3-&gt;ThisAllocated = 1;</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;  Mem3-&gt;PrevAllocated = 0;</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;  Mem3-&gt;BlockSize     = <span class="keyword">sizeof</span>(MemoryRangeHeader);</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;<span class="comment">  /// Add a tiny free region so that the free list always has one entry.</span></div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;<span class="comment"></span>  FreeRangeHeader *Mem2 =</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    (FreeRangeHeader *)(((<span class="keywordtype">char</span>*)Mem3)-FreeRangeHeader::getMinBlockSize());</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;  Mem2-&gt;ThisAllocated = 0;</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;  Mem2-&gt;PrevAllocated = 1;</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;  Mem2-&gt;BlockSize     = FreeRangeHeader::getMinBlockSize();</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;  Mem2-&gt;SetEndOfBlockSizeMarker();</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;  Mem2-&gt;Prev = Mem2;   <span class="comment">// Mem2 *is* the free list for now.</span></div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;  Mem2-&gt;Next = Mem2;</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;<span class="comment">  /// Add a tiny allocated region so that Mem2 is never coalesced away.</span></div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;<span class="comment"></span>  MemoryRangeHeader *Mem1 = (MemoryRangeHeader*)Mem2-1;</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;  Mem1-&gt;ThisAllocated = 1;</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;  Mem1-&gt;PrevAllocated = 0;</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;  Mem1-&gt;BlockSize     = <span class="keyword">sizeof</span>(MemoryRangeHeader);</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;  <span class="comment">// Add a FreeRangeHeader to the start of the function body region, indicating</span></div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;  <span class="comment">// that the space is free.  Mark the previous block allocated so we never look</span></div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;  <span class="comment">// at it.</span></div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;  FreeRangeHeader *Mem0 = (FreeRangeHeader*)MemBase;</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;  Mem0-&gt;ThisAllocated = 0;</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;  Mem0-&gt;PrevAllocated = 1;</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;  Mem0-&gt;BlockSize = (<span class="keywordtype">char</span>*)Mem1-(<span class="keywordtype">char</span>*)Mem0;</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;  Mem0-&gt;SetEndOfBlockSizeMarker();</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;  Mem0-&gt;AddToFreeList(Mem2);</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;  <span class="comment">// Start out with the freelist pointing to Mem0.</span></div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;  FreeMemoryList = Mem0;</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;  GOTBase = NULL;</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;}</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;<span class="keywordtype">void</span> DefaultJITMemoryManager::AllocateGOT() {</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;  assert(GOTBase == 0 &amp;&amp; <span class="stringliteral">&quot;Cannot allocate the got multiple times&quot;</span>);</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;  GOTBase = <span class="keyword">new</span> uint8_t[<span class="keyword">sizeof</span>(<span class="keywordtype">void</span>*) * 8192];</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;  <a class="code" href="classllvm_1_1JITMemoryManager.html#a51caf6559ad9e00c474073680db08f22">HasGOT</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;}</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;DefaultJITMemoryManager::~DefaultJITMemoryManager() {</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0, e = CodeSlabs.size(); <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != e; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;    <a class="code" href="classllvm_1_1sys_1_1Memory.html#ae7de707667a8c7de391ab5cab789b5eb">sys::Memory::ReleaseRWX</a>(CodeSlabs[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;  <span class="keyword">delete</span>[] GOTBase;</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;}</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;<a class="code" href="classllvm_1_1sys_1_1MemoryBlock.html">sys::MemoryBlock</a> DefaultJITMemoryManager::allocateNewSlab(<span class="keywordtype">size_t</span> <a class="code" href="Target_2README_8txt.html#a02def7c594e9f19ff247ed0bf33d1c30">size</a>) {</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;  <span class="comment">// Allocate a new block close to the last one.</span></div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;  std::string ErrMsg;</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;  <a class="code" href="classllvm_1_1sys_1_1MemoryBlock.html">sys::MemoryBlock</a> *LastSlabPtr = LastSlab.<a class="code" href="classllvm_1_1sys_1_1MemoryBlock.html#adf2f5548b7f0d0f6a86f2578581d8380">base</a>() ? &amp;LastSlab : 0;</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;  <a class="code" href="classllvm_1_1sys_1_1MemoryBlock.html">sys::MemoryBlock</a> <a class="code" href="Target_2ARM_2README_8txt.html#a90cca76dd78688687e0d697679dbc799">B</a> = <a class="code" href="classllvm_1_1sys_1_1Memory.html#ae0f15a67f97c9432ee4170820360aab5">sys::Memory::AllocateRWX</a>(size, LastSlabPtr, &amp;ErrMsg);</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;  <span class="keywordflow">if</span> (B.<a class="code" href="classllvm_1_1sys_1_1MemoryBlock.html#adf2f5548b7f0d0f6a86f2578581d8380">base</a>() == 0) {</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    <a class="code" href="namespacellvm.html#a1f6978055dbb761b380de39070e34bd3">report_fatal_error</a>(<span class="stringliteral">&quot;Allocation failed when allocating new memory in the&quot;</span></div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;                       <span class="stringliteral">&quot; JIT\n&quot;</span> + <a class="code" href="classllvm_1_1Twine.html">Twine</a>(ErrMsg));</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;  }</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;  LastSlab = <a class="code" href="Target_2ARM_2README_8txt.html#a90cca76dd78688687e0d697679dbc799">B</a>;</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;  ++NumSlabs;</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;  <span class="comment">// Initialize the slab to garbage when debugging.</span></div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;  <span class="keywordflow">if</span> (PoisonMemory) {</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;    <a class="code" href="namespacellvm_1_1Intrinsic.html#a73349916f7e54a6b988a3646c7a02e90ae857cbc5cf8c5a980f0bd245ad5ec61a">memset</a>(B.<a class="code" href="classllvm_1_1sys_1_1MemoryBlock.html#adf2f5548b7f0d0f6a86f2578581d8380">base</a>(), 0xCD, B.<a class="code" href="classllvm_1_1sys_1_1MemoryBlock.html#a5f95acd45968a93a9b1935a71dbbb344">size</a>());</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;  }</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="Target_2ARM_2README_8txt.html#a90cca76dd78688687e0d697679dbc799">B</a>;</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;}</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;<span class="comment">/// CheckInvariants - For testing only.  Return &quot;&quot; if all internal invariants</span></div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;<span class="comment">/// are preserved, and a helpful error message otherwise.  For free and</span></div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;<span class="comment">/// allocated blocks, make sure that adding BlockSize gives a valid block.</span></div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;<span class="comment">/// For free blocks, make sure they&#39;re in the free list and that their end of</span></div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;<span class="comment">/// block size marker is correct.  This function should return an error before</span></div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;<span class="comment">/// accessing bad memory.  This function is defined here instead of in</span></div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;<span class="comment">/// JITMemoryManagerTest.cpp so that we don&#39;t have to expose all of the</span></div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;<span class="comment">/// implementation details of DefaultJITMemoryManager.</span></div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;<span class="comment"></span><span class="keywordtype">bool</span> DefaultJITMemoryManager::CheckInvariants(std::string &amp;ErrorStr) {</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;  <a class="code" href="classllvm_1_1raw__string__ostream.html">raw_string_ostream</a> Err(ErrorStr);</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;  <span class="comment">// Construct a the set of FreeRangeHeader pointers so we can query it</span></div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;  <span class="comment">// efficiently.</span></div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;  <a class="code" href="classllvm_1_1SmallPtrSet.html">llvm::SmallPtrSet&lt;MemoryRangeHeader*, 16&gt;</a> FreeHdrSet;</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;  FreeRangeHeader* FreeHead = FreeMemoryList;</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;  FreeRangeHeader* FreeRange = FreeHead;</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;  <span class="keywordflow">do</span> {</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;    <span class="comment">// Check that the free range pointer is in the blocks we&#39;ve allocated.</span></div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;    <span class="keywordtype">bool</span> Found = <span class="keyword">false</span>;</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;    <span class="keywordflow">for</span> (std::vector&lt;sys::MemoryBlock&gt;::iterator <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = CodeSlabs.begin(),</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;         E = CodeSlabs.end(); <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> != E &amp;&amp; !Found; ++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;      <span class="keywordtype">char</span> *Start = (<span class="keywordtype">char</span>*)<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;base();</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;      <span class="keywordtype">char</span> *End = Start + <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;size();</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;      Found = (Start &lt;= (<span class="keywordtype">char</span>*)FreeRange &amp;&amp; (<span class="keywordtype">char</span>*)FreeRange &lt; End);</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;    }</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;    <span class="keywordflow">if</span> (!Found) {</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;      Err &lt;&lt; <span class="stringliteral">&quot;Corrupt free list; points to &quot;</span> &lt;&lt; FreeRange;</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    }</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;    <span class="keywordflow">if</span> (FreeRange-&gt;Next-&gt;Prev != FreeRange) {</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;      Err &lt;&lt; <span class="stringliteral">&quot;Next and Prev pointers do not match.&quot;</span>;</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;    }</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;    <span class="comment">// Otherwise, add it to the set.</span></div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    FreeHdrSet.<a class="code" href="classllvm_1_1SmallPtrSet.html#a9b6dd0fc7a648a939e571246045b673e">insert</a>(FreeRange);</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;    FreeRange = FreeRange-&gt;Next;</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;  } <span class="keywordflow">while</span> (FreeRange != FreeHead);</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;  <span class="comment">// Go over each block, and look at each MemoryRangeHeader.</span></div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;  <span class="keywordflow">for</span> (std::vector&lt;sys::MemoryBlock&gt;::iterator <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = CodeSlabs.begin(),</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;       E = CodeSlabs.end(); <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> != E; ++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;    <span class="keywordtype">char</span> *Start = (<span class="keywordtype">char</span>*)<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;base();</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;    <span class="keywordtype">char</span> *End = Start + <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;size();</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;    <span class="comment">// Check each memory range.</span></div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;    <span class="keywordflow">for</span> (MemoryRangeHeader *Hdr = (MemoryRangeHeader*)Start, *LastHdr = NULL;</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;         Start &lt;= (<span class="keywordtype">char</span>*)Hdr &amp;&amp; (<span class="keywordtype">char</span>*)Hdr &lt; End;</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;         Hdr = &amp;Hdr-&gt;getBlockAfter()) {</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;      <span class="keywordflow">if</span> (Hdr-&gt;ThisAllocated == 0) {</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;        <span class="comment">// Check that this range is in the free list.</span></div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;        <span class="keywordflow">if</span> (!FreeHdrSet.<a class="code" href="classllvm_1_1SmallPtrSet.html#a2ced6343b8ad006a757059554bbf9f37">count</a>(Hdr)) {</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;          Err &lt;&lt; <span class="stringliteral">&quot;Found free header at &quot;</span> &lt;&lt; Hdr &lt;&lt; <span class="stringliteral">&quot; that is not in free list.&quot;</span>;</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;        }</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;        <span class="comment">// Now make sure the size marker at the end of the block is correct.</span></div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;        uintptr_t *Marker = ((uintptr_t*)&amp;Hdr-&gt;getBlockAfter()) - 1;</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;        <span class="keywordflow">if</span> (!(Start &lt;= (<span class="keywordtype">char</span>*)Marker &amp;&amp; (<span class="keywordtype">char</span>*)Marker &lt; End)) {</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;          Err &lt;&lt; <span class="stringliteral">&quot;Block size in header points out of current MemoryBlock.&quot;</span>;</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;        }</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;        <span class="keywordflow">if</span> (Hdr-&gt;BlockSize != *Marker) {</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;          Err &lt;&lt; <span class="stringliteral">&quot;End of block size marker (&quot;</span> &lt;&lt; *Marker &lt;&lt; <span class="stringliteral">&quot;) &quot;</span></div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;and BlockSize (&quot;</span> &lt;&lt; Hdr-&gt;BlockSize &lt;&lt; <span class="stringliteral">&quot;) don&#39;t match.&quot;</span>;</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;        }</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;      }</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;      <span class="keywordflow">if</span> (LastHdr &amp;&amp; LastHdr-&gt;ThisAllocated != Hdr-&gt;PrevAllocated) {</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;        Err &lt;&lt; <span class="stringliteral">&quot;Hdr-&gt;PrevAllocated (&quot;</span> &lt;&lt; Hdr-&gt;PrevAllocated &lt;&lt; <span class="stringliteral">&quot;) != &quot;</span></div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;LastHdr-&gt;ThisAllocated (&quot;</span> &lt;&lt; LastHdr-&gt;ThisAllocated &lt;&lt; <span class="stringliteral">&quot;)&quot;</span>;</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!LastHdr &amp;&amp; !Hdr-&gt;PrevAllocated) {</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;        Err &lt;&lt; <span class="stringliteral">&quot;The first header should have PrevAllocated true.&quot;</span>;</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;      }</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;      <span class="comment">// Remember the last header.</span></div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;      LastHdr = Hdr;</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;    }</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;  }</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;  <span class="comment">// All invariants are preserved.</span></div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;}</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;<span class="comment">// getPointerToNamedFunction() implementation.</span></div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;<span class="comment">// AtExitHandlers - List of functions to call when the program exits,</span></div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;<span class="comment">// registered with the atexit() library function.</span></div><div class="line"><a name="l00774"></a><span class="lineno"><a class="line" href="JITMemoryManager_8cpp.html#a55b3b17cf51aefc68f0c1be6fa1ddcf3">  774</a></span>&#160;<span class="keyword">static</span> std::vector&lt;void (*)()&gt; <a class="code" href="JITMemoryManager_8cpp.html#a55b3b17cf51aefc68f0c1be6fa1ddcf3">AtExitHandlers</a>;</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;<span class="comment">/// runAtExitHandlers - Run any functions registered by the program&#39;s</span></div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;<span class="comment">/// calls to atexit(3), which we intercept and store in</span></div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;<span class="comment">/// AtExitHandlers.</span></div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00780"></a><span class="lineno"><a class="line" href="JITMemoryManager_8cpp.html#abd3dbeb5c744baaa3cd17a81ffffc8ef">  780</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="JITMemoryManager_8cpp.html#abd3dbeb5c744baaa3cd17a81ffffc8ef">runAtExitHandlers</a>() {</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;  <span class="keywordflow">while</span> (!<a class="code" href="JITMemoryManager_8cpp.html#a55b3b17cf51aefc68f0c1be6fa1ddcf3">AtExitHandlers</a>.empty()) {</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;    void (*Fn)() = <a class="code" href="JITMemoryManager_8cpp.html#a55b3b17cf51aefc68f0c1be6fa1ddcf3">AtExitHandlers</a>.back();</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;    <a class="code" href="JITMemoryManager_8cpp.html#a55b3b17cf51aefc68f0c1be6fa1ddcf3">AtExitHandlers</a>.pop_back();</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;    Fn();</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;  }</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;}</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;<span class="comment">// Function stubs that are invoked instead of certain library calls</span></div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;<span class="comment">// Force the following functions to be linked in to anything that uses the</span></div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;<span class="comment">// JIT. This is a hack designed to work around the all-too-clever Glibc</span></div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;<span class="comment">// strategy of making these functions work differently when inlined vs. when</span></div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;<span class="comment">// not inlined, and hiding their real definitions in a separate archive file</span></div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;<span class="comment">// that the dynamic linker can&#39;t see. For more info, search for</span></div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;<span class="comment">// &#39;libc_nonshared.a&#39; on Google, or read http://llvm.org/PR274.</span></div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;<span class="preprocessor">#if defined(__linux__) &amp;&amp; defined(__GLIBC__)</span></div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;<span class="comment">/* stat functions are redirecting to __xstat with a version number.  On x86-64</span></div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;<span class="comment"> * linking with libc_nonshared.a and -Wl,--export-dynamic doesn&#39;t make &#39;stat&#39;</span></div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;<span class="comment"> * available as an exported symbol, so we have to add it explicitly.</span></div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;<span class="keyword">namespace </span>{</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;<span class="keyword">class </span>StatSymbols {</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;  StatSymbols() {</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;    <a class="code" href="classllvm_1_1sys_1_1DynamicLibrary.html#a23e96ab4a94c80cf9c108cd482b06cda">sys::DynamicLibrary::AddSymbol</a>(<span class="stringliteral">&quot;stat&quot;</span>, (<span class="keywordtype">void</span>*)(<a class="code" href="classintptr__t.html">intptr_t</a>)<a class="code" href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6faff518838aa199dc9140e90252480ed0c">stat</a>);</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;    <a class="code" href="classllvm_1_1sys_1_1DynamicLibrary.html#a23e96ab4a94c80cf9c108cd482b06cda">sys::DynamicLibrary::AddSymbol</a>(<span class="stringliteral">&quot;fstat&quot;</span>, (<span class="keywordtype">void</span>*)(<a class="code" href="classintptr__t.html">intptr_t</a>)<a class="code" href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fa8fb88969436ad743b0f5eb7a75f5db78">fstat</a>);</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;    <a class="code" href="classllvm_1_1sys_1_1DynamicLibrary.html#a23e96ab4a94c80cf9c108cd482b06cda">sys::DynamicLibrary::AddSymbol</a>(<span class="stringliteral">&quot;lstat&quot;</span>, (<span class="keywordtype">void</span>*)(<a class="code" href="classintptr__t.html">intptr_t</a>)<a class="code" href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6faee6a673971ee7cda9dcd77a633c2f0ce">lstat</a>);</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;    <a class="code" href="classllvm_1_1sys_1_1DynamicLibrary.html#a23e96ab4a94c80cf9c108cd482b06cda">sys::DynamicLibrary::AddSymbol</a>(<span class="stringliteral">&quot;stat64&quot;</span>, (<span class="keywordtype">void</span>*)(<a class="code" href="classintptr__t.html">intptr_t</a>)<a class="code" href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fa333cc84eaa08c88ec337e3ecea2a6b71">stat64</a>);</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;    <a class="code" href="classllvm_1_1sys_1_1DynamicLibrary.html#a23e96ab4a94c80cf9c108cd482b06cda">sys::DynamicLibrary::AddSymbol</a>(<span class="stringliteral">&quot;\x1stat64&quot;</span>, (<span class="keywordtype">void</span>*)(<a class="code" href="classintptr__t.html">intptr_t</a>)stat64);</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;    <a class="code" href="classllvm_1_1sys_1_1DynamicLibrary.html#a23e96ab4a94c80cf9c108cd482b06cda">sys::DynamicLibrary::AddSymbol</a>(<span class="stringliteral">&quot;\x1open64&quot;</span>, (<span class="keywordtype">void</span>*)(<a class="code" href="classintptr__t.html">intptr_t</a>)<a class="code" href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fa11dbcf5da98a98d48b40c2ed14ff044f">open64</a>);</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;    <a class="code" href="classllvm_1_1sys_1_1DynamicLibrary.html#a23e96ab4a94c80cf9c108cd482b06cda">sys::DynamicLibrary::AddSymbol</a>(<span class="stringliteral">&quot;\x1lseek64&quot;</span>, (<span class="keywordtype">void</span>*)(<a class="code" href="classintptr__t.html">intptr_t</a>)lseek64);</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;    <a class="code" href="classllvm_1_1sys_1_1DynamicLibrary.html#a23e96ab4a94c80cf9c108cd482b06cda">sys::DynamicLibrary::AddSymbol</a>(<span class="stringliteral">&quot;fstat64&quot;</span>, (<span class="keywordtype">void</span>*)(<a class="code" href="classintptr__t.html">intptr_t</a>)<a class="code" href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fa87a4917b0b5fd590cede41607a9c33c9">fstat64</a>);</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;    <a class="code" href="classllvm_1_1sys_1_1DynamicLibrary.html#a23e96ab4a94c80cf9c108cd482b06cda">sys::DynamicLibrary::AddSymbol</a>(<span class="stringliteral">&quot;lstat64&quot;</span>, (<span class="keywordtype">void</span>*)(<a class="code" href="classintptr__t.html">intptr_t</a>)<a class="code" href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fa7e6c227370d9b8f0f9cf48b9a998ab0b">lstat64</a>);</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;    <a class="code" href="classllvm_1_1sys_1_1DynamicLibrary.html#a23e96ab4a94c80cf9c108cd482b06cda">sys::DynamicLibrary::AddSymbol</a>(<span class="stringliteral">&quot;atexit&quot;</span>, (<span class="keywordtype">void</span>*)(<a class="code" href="classintptr__t.html">intptr_t</a>)atexit);</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;    <a class="code" href="classllvm_1_1sys_1_1DynamicLibrary.html#a23e96ab4a94c80cf9c108cd482b06cda">sys::DynamicLibrary::AddSymbol</a>(<span class="stringliteral">&quot;mknod&quot;</span>, (<span class="keywordtype">void</span>*)(<a class="code" href="classintptr__t.html">intptr_t</a>)mknod);</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;  }</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;};</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;}</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;<span class="keyword">static</span> StatSymbols initStatSymbols;</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;<span class="preprocessor">#endif // __linux__</span></div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;<span class="comment">// jit_exit - Used to intercept the &quot;exit&quot; library call.</span></div><div class="line"><a name="l00824"></a><span class="lineno"><a class="line" href="JITMemoryManager_8cpp.html#a98dae8c006269a03f92cd10d67250b8d">  824</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="JITMemoryManager_8cpp.html#a98dae8c006269a03f92cd10d67250b8d">jit_exit</a>(<span class="keywordtype">int</span> <a class="code" href="namespacellvm_1_1zlib.html#ae682ea6618e32d6e5365418a2e07424d">Status</a>) {</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;  <a class="code" href="JITMemoryManager_8cpp.html#abd3dbeb5c744baaa3cd17a81ffffc8ef">runAtExitHandlers</a>();   <span class="comment">// Run atexit handlers...</span></div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;  <a class="code" href="Target_2X86_2README_8txt.html#a809aa08f1d799a5ed298e68bd3fac0c7">exit</a>(Status);</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;}</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;<span class="comment">// jit_atexit - Used to intercept the &quot;atexit&quot; library call.</span></div><div class="line"><a name="l00830"></a><span class="lineno"><a class="line" href="JITMemoryManager_8cpp.html#ab12275fe3726188c7cecf2162bf2d1a4">  830</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="JITMemoryManager_8cpp.html#ab12275fe3726188c7cecf2162bf2d1a4">jit_atexit</a>(<span class="keywordtype">void</span> (*Fn)()) {</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;  <a class="code" href="JITMemoryManager_8cpp.html#a55b3b17cf51aefc68f0c1be6fa1ddcf3">AtExitHandlers</a>.push_back(Fn);    <span class="comment">// Take note of atexit handler...</span></div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;  <span class="keywordflow">return</span> 0;  <span class="comment">// Always successful</span></div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;}</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;</div><div class="line"><a name="l00835"></a><span class="lineno"><a class="line" href="JITMemoryManager_8cpp.html#a6f15e8be8d888389767fe4e71ab626c7">  835</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="namespacellvm.html#a24b4a0b3fd7a9932de5e733fe042c753">jit_noop</a>() {</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;}</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;<span class="comment">//</span><span class="comment"></span></div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;<span class="comment">/// getPointerToNamedFunction - This method returns the address of the specified</span></div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;<span class="comment">/// function by using the dynamic loader interface.  As such it is only useful</span></div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;<span class="comment">/// for resolving library symbols, not code generated symbols.</span></div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;<span class="comment"></span><span class="keywordtype">void</span> *<a class="code" href="JIT_8cpp.html#a3972a06550c629a9a489fd3e3f91bcb6">DefaultJITMemoryManager::getPointerToNamedFunction</a>(<span class="keyword">const</span> std::string &amp;<a class="code" href="namespacellvm_1_1GraphProgram.html#a0ad4685976f8c4d4a697a53fbe05d10b">Name</a>,</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;                                                         <span class="keywordtype">bool</span> AbortOnFailure) {</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;  <span class="comment">// Check to see if this is one of the functions we want to intercept.  Note,</span></div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;  <span class="comment">// we cast to intptr_t here to silence a -pedantic warning that complains</span></div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;  <span class="comment">// about casting a function pointer to a normal pointer.</span></div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;  <span class="keywordflow">if</span> (Name == <span class="stringliteral">&quot;exit&quot;</span>) <span class="keywordflow">return</span> (<span class="keywordtype">void</span>*)(<a class="code" href="classintptr__t.html">intptr_t</a>)&amp;<a class="code" href="JITMemoryManager_8cpp.html#a98dae8c006269a03f92cd10d67250b8d">jit_exit</a>;</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;  <span class="keywordflow">if</span> (Name == <span class="stringliteral">&quot;atexit&quot;</span>) <span class="keywordflow">return</span> (<span class="keywordtype">void</span>*)(<a class="code" href="classintptr__t.html">intptr_t</a>)&amp;<a class="code" href="JITMemoryManager_8cpp.html#ab12275fe3726188c7cecf2162bf2d1a4">jit_atexit</a>;</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;  <span class="comment">// We should not invoke parent&#39;s ctors/dtors from generated main()!</span></div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;  <span class="comment">// On Mingw and Cygwin, the symbol __main is resolved to</span></div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;  <span class="comment">// callee&#39;s(eg. tools/lli) one, to invoke wrong duplicated ctors</span></div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;  <span class="comment">// (and register wrong callee&#39;s dtors with atexit(3)).</span></div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;  <span class="comment">// We expect ExecutionEngine::runStaticConstructorsDestructors()</span></div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;  <span class="comment">// is called before ExecutionEngine::runFunctionAsMain() is called.</span></div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;  <span class="keywordflow">if</span> (Name == <span class="stringliteral">&quot;__main&quot;</span>) <span class="keywordflow">return</span> (<span class="keywordtype">void</span>*)(<a class="code" href="classintptr__t.html">intptr_t</a>)&amp;<a class="code" href="namespacellvm.html#a24b4a0b3fd7a9932de5e733fe042c753">jit_noop</a>;</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *NameStr = Name.c_str();</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;  <span class="comment">// If this is an asm specifier, skip the sentinal.</span></div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;  <span class="keywordflow">if</span> (NameStr[0] == 1) ++NameStr;</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;  <span class="comment">// If it&#39;s an external function, look it up in the process image...</span></div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;  <span class="keywordtype">void</span> *Ptr = <a class="code" href="classllvm_1_1sys_1_1DynamicLibrary.html#ae003d16a33e81b88943d3e3aa179fcc4">sys::DynamicLibrary::SearchForAddressOfSymbol</a>(NameStr);</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;  <span class="keywordflow">if</span> (Ptr) <span class="keywordflow">return</span> Ptr;</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;  <span class="comment">// If it wasn&#39;t found and if it starts with an underscore (&#39;_&#39;) character,</span></div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;  <span class="comment">// try again without the underscore.</span></div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;  <span class="keywordflow">if</span> (NameStr[0] == <span class="charliteral">&#39;_&#39;</span>) {</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;    Ptr = <a class="code" href="classllvm_1_1sys_1_1DynamicLibrary.html#ae003d16a33e81b88943d3e3aa179fcc4">sys::DynamicLibrary::SearchForAddressOfSymbol</a>(NameStr+1);</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;    <span class="keywordflow">if</span> (Ptr) <span class="keywordflow">return</span> Ptr;</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;  }</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;  <span class="comment">// Darwin/PPC adds $LDBLStub suffixes to various symbols like printf.  These</span></div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;  <span class="comment">// are references to hidden visibility symbols that dlsym cannot resolve.</span></div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;  <span class="comment">// If we have one of these, strip off $LDBLStub and try again.</span></div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;<span class="preprocessor">#if defined(__APPLE__) &amp;&amp; defined(__ppc__)</span></div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;  <span class="keywordflow">if</span> (Name.size() &gt; 9 &amp;&amp; Name[Name.size()-9] == <span class="charliteral">&#39;$&#39;</span> &amp;&amp;</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;      <a class="code" href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fa3ac509b06abcd9a75f6676d6a65b0251">memcmp</a>(&amp;Name[Name.size()-8], <span class="stringliteral">&quot;LDBLStub&quot;</span>, 8) == 0) {</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;    <span class="comment">// First try turning $LDBLStub into $LDBL128. If that fails, strip it off.</span></div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;    <span class="comment">// This mirrors logic in libSystemStubs.a.</span></div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;    std::string <a class="code" href="namespacellvm_1_1cl.html#afcbd4ecc474e2d218391d6d3027b086aa7861ef1db44eac8ea7a373cd7c53a7c5">Prefix</a> = std::string(Name.begin(), Name.end()-9);</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;    <span class="keywordflow">if</span> (<span class="keywordtype">void</span> *Ptr = <a class="code" href="classllvm_1_1RTDyldMemoryManager.html#a4e5d745e695dc62ebaec15f537af9fed">getPointerToNamedFunction</a>(Prefix+<span class="stringliteral">&quot;$LDBL128&quot;</span>, <span class="keyword">false</span>))</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;      <span class="keywordflow">return</span> Ptr;</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;    <span class="keywordflow">if</span> (<span class="keywordtype">void</span> *Ptr = <a class="code" href="classllvm_1_1RTDyldMemoryManager.html#a4e5d745e695dc62ebaec15f537af9fed">getPointerToNamedFunction</a>(Prefix, <span class="keyword">false</span>))</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;      <span class="keywordflow">return</span> Ptr;</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;  }</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;  <span class="keywordflow">if</span> (AbortOnFailure) {</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;    <a class="code" href="namespacellvm.html#a1f6978055dbb761b380de39070e34bd3">report_fatal_error</a>(<span class="stringliteral">&quot;Program used external function &#39;&quot;</span>+Name+</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;                      <span class="stringliteral">&quot;&#39; which could not be resolved!&quot;</span>);</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;  }</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;}</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;</div><div class="line"><a name="l00901"></a><span class="lineno"><a class="line" href="classllvm_1_1JITMemoryManager.html#a38a94276e787acd0cda0f1a0b7d58463">  901</a></span>&#160;<a class="code" href="classllvm_1_1JITMemoryManager.html">JITMemoryManager</a> *<a class="code" href="classllvm_1_1JITMemoryManager.html#a38a94276e787acd0cda0f1a0b7d58463">JITMemoryManager::CreateDefaultMemManager</a>() {</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">new</span> DefaultJITMemoryManager();</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;}</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;<span class="comment">// Allocate memory for code in 512K slabs.</span></div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;<span class="keyword">const</span> <span class="keywordtype">size_t</span> DefaultJITMemoryManager::DefaultCodeSlabSize = 512 * 1024;</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;<span class="comment">// Allocate globals and stubs in slabs of 64K.  (probably 16 pages)</span></div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;<span class="keyword">const</span> <span class="keywordtype">size_t</span> DefaultJITMemoryManager::DefaultSlabSize = 64 * 1024;</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;<span class="comment">// Waste at most 16K at the end of each bump slab.  (probably 4 pages)</span></div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;<span class="keyword">const</span> <span class="keywordtype">size_t</span> DefaultJITMemoryManager::DefaultSizeThreshold = 16 * 1024;</div><div class="ttc" id="classllvm_1_1JITMemoryManager_html_a8c65e53d44ba3e8a8e9c2a7ad144ae17"><div class="ttname"><a href="classllvm_1_1JITMemoryManager.html#a8c65e53d44ba3e8a8e9c2a7ad144ae17">llvm::JITMemoryManager::GetNumCodeSlabs</a></div><div class="ttdeci">virtual unsigned GetNumCodeSlabs()</div><div class="ttdef"><b>Definition:</b> <a href="JITMemoryManager_8h_source.html#l00145">JITMemoryManager.h:145</a></div></div>
<div class="ttc" id="classllvm_1_1sys_1_1DynamicLibrary_html_ae003d16a33e81b88943d3e3aa179fcc4"><div class="ttname"><a href="classllvm_1_1sys_1_1DynamicLibrary.html#ae003d16a33e81b88943d3e3aa179fcc4">llvm::sys::DynamicLibrary::SearchForAddressOfSymbol</a></div><div class="ttdeci">static void * SearchForAddressOfSymbol(const char *symbolName)</div><div class="ttdoc">Search through libraries for address of a symbol. </div><div class="ttdef"><b>Definition:</b> <a href="DynamicLibrary_8cpp_source.html#l00111">DynamicLibrary.cpp:111</a></div></div>
<div class="ttc" id="namespacellvm_html"><div class="ttname"><a href="namespacellvm.html">llvm</a></div><div class="ttdoc">List of target independent CodeGen pass IDs. </div><div class="ttdef"><b>Definition:</b> <a href="APFloat_8h_source.html#l00022">APFloat.h:22</a></div></div>
<div class="ttc" id="namespacellvm_1_1LibFunc_html_abf8f6830387f338fed0bce2e65108c6fa8fb88969436ad743b0f5eb7a75f5db78"><div class="ttname"><a href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fa8fb88969436ad743b0f5eb7a75f5db78">llvm::LibFunc::fstat</a></div><div class="ttdoc">int fstat(int fildes, struct stat *buf); </div><div class="ttdef"><b>Definition:</b> <a href="TargetLibraryInfo_8h_source.html#l00291">TargetLibraryInfo.h:291</a></div></div>
<div class="ttc" id="Target_2README_8txt_html_a02def7c594e9f19ff247ed0bf33d1c30"><div class="ttname"><a href="Target_2README_8txt.html#a02def7c594e9f19ff247ed0bf33d1c30">size</a></div><div class="ttdeci">i&lt; reg-&gt; size</div><div class="ttdef"><b>Definition:</b> <a href="Target_2README_8txt_source.html#l00204">Target/README.txt:204</a></div></div>
<div class="ttc" id="namespacellvm_1_1LibFunc_html_abf8f6830387f338fed0bce2e65108c6fa87a4917b0b5fd590cede41607a9c33c9"><div class="ttname"><a href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fa87a4917b0b5fd590cede41607a9c33c9">llvm::LibFunc::fstat64</a></div><div class="ttdoc">int fstat64(int filedes, struct stat64 *buf) </div><div class="ttdef"><b>Definition:</b> <a href="TargetLibraryInfo_8h_source.html#l00293">TargetLibraryInfo.h:293</a></div></div>
<div class="ttc" id="JITMemoryManager_8cpp_html_ab12275fe3726188c7cecf2162bf2d1a4"><div class="ttname"><a href="JITMemoryManager_8cpp.html#ab12275fe3726188c7cecf2162bf2d1a4">jit_atexit</a></div><div class="ttdeci">static int jit_atexit(void(*Fn)())</div><div class="ttdef"><b>Definition:</b> <a href="JITMemoryManager_8cpp_source.html#l00830">JITMemoryManager.cpp:830</a></div></div>
<div class="ttc" id="classllvm_1_1JITMemoryManager_html_a69db17a07690214a7455a102af15bae0"><div class="ttname"><a href="classllvm_1_1JITMemoryManager.html#a69db17a07690214a7455a102af15bae0">llvm::JITMemoryManager::setMemoryExecutable</a></div><div class="ttdeci">virtual void setMemoryExecutable()=0</div></div>
<div class="ttc" id="classintptr__t_html"><div class="ttname"><a href="classintptr__t.html">intptr_t</a></div></div>
<div class="ttc" id="Debug_8h_html"><div class="ttname"><a href="Debug_8h.html">Debug.h</a></div></div>
<div class="ttc" id="namespacellvm_1_1LibFunc_html_abf8f6830387f338fed0bce2e65108c6fa7e6c227370d9b8f0f9cf48b9a998ab0b"><div class="ttname"><a href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fa7e6c227370d9b8f0f9cf48b9a998ab0b">llvm::LibFunc::lstat64</a></div><div class="ttdoc">int lstat64(const char *path, struct stat64 *buf); </div><div class="ttdef"><b>Definition:</b> <a href="TargetLibraryInfo_8h_source.html#l00378">TargetLibraryInfo.h:378</a></div></div>
<div class="ttc" id="classllvm_1_1JITMemoryManager_html_a8c46139571f57b67e393f445486f8898"><div class="ttname"><a href="classllvm_1_1JITMemoryManager.html#a8c46139571f57b67e393f445486f8898">llvm::JITMemoryManager::GetDefaultStubSlabSize</a></div><div class="ttdeci">virtual size_t GetDefaultStubSlabSize()</div><div class="ttdef"><b>Definition:</b> <a href="JITMemoryManager_8h_source.html#l00139">JITMemoryManager.h:139</a></div></div>
<div class="ttc" id="namespacellvm_1_1cl_html_afcbd4ecc474e2d218391d6d3027b086aa7861ef1db44eac8ea7a373cd7c53a7c5"><div class="ttname"><a href="namespacellvm_1_1cl.html#afcbd4ecc474e2d218391d6d3027b086aa7861ef1db44eac8ea7a373cd7c53a7c5">llvm::cl::Prefix</a></div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l00131">CommandLine.h:131</a></div></div>
<div class="ttc" id="classllvm_1_1SmallPtrSet_html_a9b6dd0fc7a648a939e571246045b673e"><div class="ttname"><a href="classllvm_1_1SmallPtrSet.html#a9b6dd0fc7a648a939e571246045b673e">llvm::SmallPtrSet::insert</a></div><div class="ttdeci">bool insert(PtrType Ptr)</div><div class="ttdef"><b>Definition:</b> <a href="SmallPtrSet_8h_source.html#l00253">SmallPtrSet.h:253</a></div></div>
<div class="ttc" id="classllvm_1_1JITMemoryManager_html_aae9ef3b68b5c03764756faf7f1de7f03"><div class="ttname"><a href="classllvm_1_1JITMemoryManager.html#aae9ef3b68b5c03764756faf7f1de7f03">llvm::JITMemoryManager::allocateStub</a></div><div class="ttdeci">virtual uint8_t * allocateStub(const GlobalValue *F, unsigned StubSize, unsigned Alignment)=0</div></div>
<div class="ttc" id="LLParser_8cpp_html_a33ece1ef8074506a15d7f86eb76dbae6"><div class="ttname"><a href="LLParser_8cpp.html#a33ece1ef8074506a15d7f86eb76dbae6">F</a></div><div class="ttdeci">F(f)</div></div>
<div class="ttc" id="classllvm_1_1Function_html"><div class="ttname"><a href="classllvm_1_1Function.html">llvm::Function</a></div><div class="ttdef"><b>Definition:</b> <a href="Function_8h_source.html#l00070">Function.h:70</a></div></div>
<div class="ttc" id="classllvm_1_1JITMemoryManager_html_a2badd0f16f40fb1b5cfe1e570170cc53"><div class="ttname"><a href="classllvm_1_1JITMemoryManager.html#a2badd0f16f40fb1b5cfe1e570170cc53">llvm::JITMemoryManager::setPoisonMemory</a></div><div class="ttdeci">virtual void setPoisonMemory(bool poison)=0</div></div>
<div class="ttc" id="classllvm_1_1JITMemoryManager_html_a4d0c4f1849d0def5539950c047a2ce7f"><div class="ttname"><a href="classllvm_1_1JITMemoryManager.html#a4d0c4f1849d0def5539950c047a2ce7f">llvm::JITMemoryManager::getGOTBase</a></div><div class="ttdeci">virtual uint8_t * getGOTBase() const =0</div></div>
<div class="ttc" id="Twine_8h_html"><div class="ttname"><a href="Twine_8h.html">Twine.h</a></div></div>
<div class="ttc" id="Statistic_8h_html"><div class="ttname"><a href="Statistic_8h.html">Statistic.h</a></div></div>
<div class="ttc" id="classllvm_1_1JITMemoryManager_html"><div class="ttname"><a href="classllvm_1_1JITMemoryManager.html">llvm::JITMemoryManager</a></div><div class="ttdef"><b>Definition:</b> <a href="JITMemoryManager_8h_source.html#l00026">JITMemoryManager.h:26</a></div></div>
<div class="ttc" id="Allocator_8h_html"><div class="ttname"><a href="Allocator_8h.html">Allocator.h</a></div></div>
<div class="ttc" id="namespacellvm_html_a1f6978055dbb761b380de39070e34bd3"><div class="ttname"><a href="namespacellvm.html#a1f6978055dbb761b380de39070e34bd3">llvm::report_fatal_error</a></div><div class="ttdeci">LLVM_ATTRIBUTE_NORETURN void report_fatal_error(const char *reason, bool gen_crash_diag=true)</div><div class="ttdef"><b>Definition:</b> <a href="ErrorHandling_8cpp_source.html#l00053">ErrorHandling.cpp:53</a></div></div>
<div class="ttc" id="classllvm_1_1MemSlab_html_a84121cd853754d825060f630b4a68c61"><div class="ttname"><a href="classllvm_1_1MemSlab.html#a84121cd853754d825060f630b4a68c61">llvm::MemSlab::Size</a></div><div class="ttdeci">size_t Size</div><div class="ttdef"><b>Definition:</b> <a href="Allocator_8h_source.html#l00055">Allocator.h:55</a></div></div>
<div class="ttc" id="Memory_8h_html"><div class="ttname"><a href="Memory_8h.html">Memory.h</a></div></div>
<div class="ttc" id="Target_2README_8txt_html_aae67c508d4f0716516f5c412c5592556"><div class="ttname"><a href="Target_2README_8txt.html#aae67c508d4f0716516f5c412c5592556">result</a></div><div class="ttdeci">then result</div><div class="ttdef"><b>Definition:</b> <a href="Target_2README_8txt_source.html#l00393">Target/README.txt:393</a></div></div>
<div class="ttc" id="JITMemoryManager_8h_html"><div class="ttname"><a href="JITMemoryManager_8h.html">JITMemoryManager.h</a></div></div>
<div class="ttc" id="namespacellvm_1_1GraphProgram_html_a0ad4685976f8c4d4a697a53fbe05d10b"><div class="ttname"><a href="namespacellvm_1_1GraphProgram.html#a0ad4685976f8c4d4a697a53fbe05d10b">llvm::GraphProgram::Name</a></div><div class="ttdeci">Name</div><div class="ttdef"><b>Definition:</b> <a href="GraphWriter_8h_source.html#l00044">GraphWriter.h:44</a></div></div>
<div class="ttc" id="classllvm_1_1Twine_html"><div class="ttname"><a href="classllvm_1_1Twine.html">llvm::Twine</a></div><div class="ttdef"><b>Definition:</b> <a href="Twine_8h_source.html#l00081">Twine.h:81</a></div></div>
<div class="ttc" id="classllvm_1_1JITMemoryManager_html_a38a94276e787acd0cda0f1a0b7d58463"><div class="ttname"><a href="classllvm_1_1JITMemoryManager.html#a38a94276e787acd0cda0f1a0b7d58463">llvm::JITMemoryManager::CreateDefaultMemManager</a></div><div class="ttdeci">static JITMemoryManager * CreateDefaultMemManager()</div><div class="ttdef"><b>Definition:</b> <a href="JITMemoryManager_8cpp_source.html#l00901">JITMemoryManager.cpp:901</a></div></div>
<div class="ttc" id="ErrorHandling_8h_html"><div class="ttname"><a href="ErrorHandling_8h.html">ErrorHandling.h</a></div></div>
<div class="ttc" id="classllvm_1_1JITMemoryManager_html_a860ddc8e1ceb0bcc49c2a6828bd88922"><div class="ttname"><a href="classllvm_1_1JITMemoryManager.html#a860ddc8e1ceb0bcc49c2a6828bd88922">llvm::JITMemoryManager::CheckInvariants</a></div><div class="ttdeci">virtual bool CheckInvariants(std::string &amp;)</div><div class="ttdef"><b>Definition:</b> <a href="JITMemoryManager_8h_source.html#l00121">JITMemoryManager.h:121</a></div></div>
<div class="ttc" id="DynamicLibrary_8h_html"><div class="ttname"><a href="DynamicLibrary_8h.html">DynamicLibrary.h</a></div></div>
<div class="ttc" id="classllvm_1_1JITMemoryManager_html_a51caf6559ad9e00c474073680db08f22"><div class="ttname"><a href="classllvm_1_1JITMemoryManager.html#a51caf6559ad9e00c474073680db08f22">llvm::JITMemoryManager::HasGOT</a></div><div class="ttdeci">bool HasGOT</div><div class="ttdef"><b>Definition:</b> <a href="JITMemoryManager_8h_source.html#l00028">JITMemoryManager.h:28</a></div></div>
<div class="ttc" id="classllvm_1_1SmallPtrSet_html_a2ced6343b8ad006a757059554bbf9f37"><div class="ttname"><a href="classllvm_1_1SmallPtrSet.html#a2ced6343b8ad006a757059554bbf9f37">llvm::SmallPtrSet::count</a></div><div class="ttdeci">bool count(PtrType Ptr) const </div><div class="ttdoc">count - Return true if the specified pointer is in the set. </div><div class="ttdef"><b>Definition:</b> <a href="SmallPtrSet_8h_source.html#l00264">SmallPtrSet.h:264</a></div></div>
<div class="ttc" id="classllvm_1_1JITMemoryManager_html_afef9813bbed59c0d02d96e40c754b642"><div class="ttname"><a href="classllvm_1_1JITMemoryManager.html#afef9813bbed59c0d02d96e40c754b642">llvm::JITMemoryManager::deallocateFunctionBody</a></div><div class="ttdeci">virtual void deallocateFunctionBody(void *Body)=0</div></div>
<div class="ttc" id="classllvm_1_1JITMemoryManager_html_ad4ed966cba0cd68c00126e597077eb53"><div class="ttname"><a href="classllvm_1_1JITMemoryManager.html#ad4ed966cba0cd68c00126e597077eb53">llvm::JITMemoryManager::allocateGlobal</a></div><div class="ttdeci">virtual uint8_t * allocateGlobal(uintptr_t Size, unsigned Alignment)=0</div><div class="ttdoc">allocateGlobal - Allocate memory for a global. </div></div>
<div class="ttc" id="namespacellvm_1_1Intrinsic_html_a73349916f7e54a6b988a3646c7a02e90ae857cbc5cf8c5a980f0bd245ad5ec61a"><div class="ttname"><a href="namespacellvm_1_1Intrinsic.html#a73349916f7e54a6b988a3646c7a02e90ae857cbc5cf8c5a980f0bd245ad5ec61a">llvm::Intrinsic::memset</a></div><div class="ttdef"><b>Definition:</b> <a href="Intrinsics_8h_source.html#l01262">Intrinsics.h:1262</a></div></div>
<div class="ttc" id="namespacellvm_1_1zlib_html_ae682ea6618e32d6e5365418a2e07424d"><div class="ttname"><a href="namespacellvm_1_1zlib.html#ae682ea6618e32d6e5365418a2e07424d">llvm::zlib::Status</a></div><div class="ttdeci">Status</div><div class="ttdef"><b>Definition:</b> <a href="Compression_8h_source.html#l00034">Compression.h:34</a></div></div>
<div class="ttc" id="classllvm_1_1JITMemoryManager_html_a696d95930a3fb254452065e122ec5cda"><div class="ttname"><a href="classllvm_1_1JITMemoryManager.html#a696d95930a3fb254452065e122ec5cda">llvm::JITMemoryManager::endFunctionBody</a></div><div class="ttdeci">virtual void endFunctionBody(const Function *F, uint8_t *FunctionStart, uint8_t *FunctionEnd)=0</div></div>
<div class="ttc" id="classllvm_1_1JITMemoryManager_html_a9996a30064d40feeb4e23991ef2e5fb6"><div class="ttname"><a href="classllvm_1_1JITMemoryManager.html#a9996a30064d40feeb4e23991ef2e5fb6">llvm::JITMemoryManager::GetNumStubSlabs</a></div><div class="ttdeci">virtual unsigned GetNumStubSlabs()</div><div class="ttdef"><b>Definition:</b> <a href="JITMemoryManager_8h_source.html#l00157">JITMemoryManager.h:157</a></div></div>
<div class="ttc" id="SmallPtrSet_8h_html"><div class="ttname"><a href="SmallPtrSet_8h.html">SmallPtrSet.h</a></div></div>
<div class="ttc" id="classllvm_1_1sys_1_1Memory_html_ae7de707667a8c7de391ab5cab789b5eb"><div class="ttname"><a href="classllvm_1_1sys_1_1Memory.html#ae7de707667a8c7de391ab5cab789b5eb">llvm::sys::Memory::ReleaseRWX</a></div><div class="ttdeci">static bool ReleaseRWX(MemoryBlock &amp;block, std::string *ErrMsg=0)</div><div class="ttdoc">Release Read/Write/Execute memory. </div></div>
<div class="ttc" id="classllvm_1_1sys_1_1Memory_html_acf4d418979406a99e7230468647b4035"><div class="ttname"><a href="classllvm_1_1sys_1_1Memory.html#acf4d418979406a99e7230468647b4035">llvm::sys::Memory::setExecutable</a></div><div class="ttdeci">static bool setExecutable(MemoryBlock &amp;M, std::string *ErrMsg=0)</div></div>
<div class="ttc" id="JITMemoryManager_8cpp_html_a55b3b17cf51aefc68f0c1be6fa1ddcf3"><div class="ttname"><a href="JITMemoryManager_8cpp.html#a55b3b17cf51aefc68f0c1be6fa1ddcf3">AtExitHandlers</a></div><div class="ttdeci">static std::vector&lt; void(*)()&gt; AtExitHandlers</div><div class="ttdef"><b>Definition:</b> <a href="JITMemoryManager_8cpp_source.html#l00774">JITMemoryManager.cpp:774</a></div></div>
<div class="ttc" id="classllvm_1_1JITMemoryManager_html_a4cf108ee8b6c664303499668c46f0f49"><div class="ttname"><a href="classllvm_1_1JITMemoryManager.html#a4cf108ee8b6c664303499668c46f0f49">llvm::JITMemoryManager::AllocateGOT</a></div><div class="ttdeci">virtual void AllocateGOT()=0</div></div>
<div class="ttc" id="classllvm_1_1RTDyldMemoryManager_html_ac5196188a3a422dafd7a965232ccedb4"><div class="ttname"><a href="classllvm_1_1RTDyldMemoryManager.html#ac5196188a3a422dafd7a965232ccedb4">llvm::RTDyldMemoryManager::finalizeMemory</a></div><div class="ttdeci">virtual bool finalizeMemory(std::string *ErrMsg=0)=0</div></div>
<div class="ttc" id="namespacellvm_1_1LibFunc_html_abf8f6830387f338fed0bce2e65108c6fa3ac509b06abcd9a75f6676d6a65b0251"><div class="ttname"><a href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fa3ac509b06abcd9a75f6676d6a65b0251">llvm::LibFunc::memcmp</a></div><div class="ttdoc">int memcmp(const void *s1, const void *s2, size_t n); </div><div class="ttdef"><b>Definition:</b> <a href="TargetLibraryInfo_8h_source.html#l00388">TargetLibraryInfo.h:388</a></div></div>
<div class="ttc" id="GlobalValue_8h_html"><div class="ttname"><a href="GlobalValue_8h.html">GlobalValue.h</a></div></div>
<div class="ttc" id="namespacellvm_1_1LibFunc_html_abf8f6830387f338fed0bce2e65108c6faee6a673971ee7cda9dcd77a633c2f0ce"><div class="ttname"><a href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6faee6a673971ee7cda9dcd77a633c2f0ce">llvm::LibFunc::lstat</a></div><div class="ttdoc">int lstat(const char *path, struct stat *buf); </div><div class="ttdef"><b>Definition:</b> <a href="TargetLibraryInfo_8h_source.html#l00376">TargetLibraryInfo.h:376</a></div></div>
<div class="ttc" id="classllvm_1_1RTDyldMemoryManager_html_aa4182acc7b4bf02dbec44bf67eb7e57f"><div class="ttname"><a href="classllvm_1_1RTDyldMemoryManager.html#aa4182acc7b4bf02dbec44bf67eb7e57f">llvm::RTDyldMemoryManager::allocateDataSection</a></div><div class="ttdeci">virtual uint8_t * allocateDataSection(uintptr_t Size, unsigned Alignment, unsigned SectionID, StringRef SectionName, bool IsReadOnly)=0</div></div>
<div class="ttc" id="Compiler_8h_html"><div class="ttname"><a href="Compiler_8h.html">Compiler.h</a></div></div>
<div class="ttc" id="classllvm_1_1sys_1_1DynamicLibrary_html_a23e96ab4a94c80cf9c108cd482b06cda"><div class="ttname"><a href="classllvm_1_1sys_1_1DynamicLibrary.html#a23e96ab4a94c80cf9c108cd482b06cda">llvm::sys::DynamicLibrary::AddSymbol</a></div><div class="ttdeci">static void AddSymbol(StringRef symbolName, void *symbolValue)</div><div class="ttdoc">Add searchable symbol/value pair. </div><div class="ttdef"><b>Definition:</b> <a href="DynamicLibrary_8cpp_source.html#l00030">DynamicLibrary.cpp:30</a></div></div>
<div class="ttc" id="Target_2X86_2README_8txt_html_a809aa08f1d799a5ed298e68bd3fac0c7"><div class="ttname"><a href="Target_2X86_2README_8txt.html#a809aa08f1d799a5ed298e68bd3fac0c7">exit</a></div><div class="ttdeci">declare void exit(i32) noreturn nounwind This compiles into</div><div class="ttdef"><b>Definition:</b> <a href="Target_2X86_2README_8txt_source.html#l01235">Target/X86/README.txt:1235</a></div></div>
<div class="ttc" id="JITMemoryManager_8cpp_html_abd3dbeb5c744baaa3cd17a81ffffc8ef"><div class="ttname"><a href="JITMemoryManager_8cpp.html#abd3dbeb5c744baaa3cd17a81ffffc8ef">runAtExitHandlers</a></div><div class="ttdeci">static void runAtExitHandlers()</div><div class="ttdef"><b>Definition:</b> <a href="JITMemoryManager_8cpp_source.html#l00780">JITMemoryManager.cpp:780</a></div></div>
<div class="ttc" id="classllvm_1_1MemSlab_html"><div class="ttname"><a href="classllvm_1_1MemSlab.html">llvm::MemSlab</a></div><div class="ttdef"><b>Definition:</b> <a href="Allocator_8h_source.html#l00053">Allocator.h:53</a></div></div>
<div class="ttc" id="classllvm_1_1RTDyldMemoryManager_html_a80b0a71d3687c9acc13f021de0cc891a"><div class="ttname"><a href="classllvm_1_1RTDyldMemoryManager.html#a80b0a71d3687c9acc13f021de0cc891a">llvm::RTDyldMemoryManager::allocateCodeSection</a></div><div class="ttdeci">virtual uint8_t * allocateCodeSection(uintptr_t Size, unsigned Alignment, unsigned SectionID, StringRef SectionName)=0</div></div>
<div class="ttc" id="namespacellvm_1_1LibFunc_html_abf8f6830387f338fed0bce2e65108c6faff518838aa199dc9140e90252480ed0c"><div class="ttname"><a href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6faff518838aa199dc9140e90252480ed0c">llvm::LibFunc::stat</a></div><div class="ttdoc">int stat(const char *path, struct stat *buf); </div><div class="ttdef"><b>Definition:</b> <a href="TargetLibraryInfo_8h_source.html#l00521">TargetLibraryInfo.h:521</a></div></div>
<div class="ttc" id="namespacellvm_1_1LibFunc_html_abf8f6830387f338fed0bce2e65108c6fa333cc84eaa08c88ec337e3ecea2a6b71"><div class="ttname"><a href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fa333cc84eaa08c88ec337e3ecea2a6b71">llvm::LibFunc::stat64</a></div><div class="ttdoc">int stat64(const char *path, struct stat64 *buf); </div><div class="ttdef"><b>Definition:</b> <a href="TargetLibraryInfo_8h_source.html#l00523">TargetLibraryInfo.h:523</a></div></div>
<div class="ttc" id="classllvm_1_1sys_1_1MemoryBlock_html_a5f95acd45968a93a9b1935a71dbbb344"><div class="ttname"><a href="classllvm_1_1sys_1_1MemoryBlock.html#a5f95acd45968a93a9b1935a71dbbb344">llvm::sys::MemoryBlock::size</a></div><div class="ttdeci">size_t size() const </div><div class="ttdef"><b>Definition:</b> <a href="Memory_8h_source.html#l00034">Memory.h:34</a></div></div>
<div class="ttc" id="classllvm_1_1GlobalValue_html"><div class="ttname"><a href="classllvm_1_1GlobalValue.html">llvm::GlobalValue</a></div><div class="ttdef"><b>Definition:</b> <a href="GlobalValue_8h_source.html#l00029">GlobalValue.h:29</a></div></div>
<div class="ttc" id="classllvm_1_1sys_1_1Memory_html_ae0f15a67f97c9432ee4170820360aab5"><div class="ttname"><a href="classllvm_1_1sys_1_1Memory.html#ae0f15a67f97c9432ee4170820360aab5">llvm::sys::Memory::AllocateRWX</a></div><div class="ttdeci">static MemoryBlock AllocateRWX(size_t NumBytes, const MemoryBlock *NearBlock, std::string *ErrMsg=0)</div><div class="ttdoc">Allocate Read/Write/Execute memory. </div></div>
<div class="ttc" id="JITMemoryManager_8cpp_html_a98dae8c006269a03f92cd10d67250b8d"><div class="ttname"><a href="JITMemoryManager_8cpp.html#a98dae8c006269a03f92cd10d67250b8d">jit_exit</a></div><div class="ttdeci">static void jit_exit(int Status)</div><div class="ttdef"><b>Definition:</b> <a href="JITMemoryManager_8cpp_source.html#l00824">JITMemoryManager.cpp:824</a></div></div>
<div class="ttc" id="classllvm_1_1BumpPtrAllocator_html"><div class="ttname"><a href="classllvm_1_1BumpPtrAllocator.html">llvm::BumpPtrAllocator</a></div><div class="ttdef"><b>Definition:</b> <a href="Allocator_8h_source.html#l00090">Allocator.h:90</a></div></div>
<div class="ttc" id="classllvm_1_1SmallPtrSet_html"><div class="ttname"><a href="classllvm_1_1SmallPtrSet.html">llvm::SmallPtrSet</a></div><div class="ttdef"><b>Definition:</b> <a href="SmallPtrSet_8h_source.html#l00236">SmallPtrSet.h:236</a></div></div>
<div class="ttc" id="Target_2README_8txt_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">i</div><div class="ttdef"><b>Definition:</b> <a href="Target_2README_8txt_source.html#l00029">Target/README.txt:29</a></div></div>
<div class="ttc" id="classllvm_1_1sys_1_1MemoryBlock_html"><div class="ttname"><a href="classllvm_1_1sys_1_1MemoryBlock.html">llvm::sys::MemoryBlock</a></div><div class="ttdoc">Memory block abstraction. </div><div class="ttdef"><b>Definition:</b> <a href="Memory_8h_source.html#l00029">Memory.h:29</a></div></div>
<div class="ttc" id="JITMemoryManager_8cpp_html_a6368a8b73265b5b4877897f7f95d24d4"><div class="ttname"><a href="JITMemoryManager_8cpp.html#a6368a8b73265b5b4877897f7f95d24d4">STATISTIC</a></div><div class="ttdeci">STATISTIC(NumSlabs,&quot;Number of slabs of memory allocated by the JIT&quot;)</div></div>
<div class="ttc" id="classllvm_1_1sys_1_1Memory_html_a9dee85d92a958b5b82049e9ed3afbd20"><div class="ttname"><a href="classllvm_1_1sys_1_1Memory.html#a9dee85d92a958b5b82049e9ed3afbd20">llvm::sys::Memory::setWritable</a></div><div class="ttdeci">static bool setWritable(MemoryBlock &amp;M, std::string *ErrMsg=0)</div></div>
<div class="ttc" id="classllvm_1_1BumpPtrAllocator_html_a1aa523db85a27032377186d5d8c2ccd5"><div class="ttname"><a href="classllvm_1_1BumpPtrAllocator.html#a1aa523db85a27032377186d5d8c2ccd5">llvm::BumpPtrAllocator::GetNumSlabs</a></div><div class="ttdeci">unsigned GetNumSlabs() const </div><div class="ttdef"><b>Definition:</b> <a href="Allocator_8cpp_source.html#l00143">Allocator.cpp:143</a></div></div>
<div class="ttc" id="namespacellvm_html_a7c46c742c31be54870e2038048e6b391"><div class="ttname"><a href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">llvm::dbgs</a></div><div class="ttdeci">raw_ostream &amp; dbgs()</div><div class="ttdoc">dbgs - Return a circular-buffered debug stream. </div><div class="ttdef"><b>Definition:</b> <a href="Debug_8cpp_source.html#l00101">Debug.cpp:101</a></div></div>
<div class="ttc" id="classllvm_1_1BumpPtrAllocator_html_a77df739db3a1603903dfa595e214a84b"><div class="ttname"><a href="classllvm_1_1BumpPtrAllocator.html#a77df739db3a1603903dfa595e214a84b">llvm::BumpPtrAllocator::Allocate</a></div><div class="ttdeci">void * Allocate(size_t Size, size_t Alignment)</div><div class="ttdef"><b>Definition:</b> <a href="Allocator_8cpp_source.html#l00095">Allocator.cpp:95</a></div></div>
<div class="ttc" id="namespacellvm_1_1LibFunc_html_abf8f6830387f338fed0bce2e65108c6fa11dbcf5da98a98d48b40c2ed14ff044f"><div class="ttname"><a href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fa11dbcf5da98a98d48b40c2ed14ff044f">llvm::LibFunc::open64</a></div><div class="ttdoc">int open64(const char *filename, int flags[, mode_t mode]) </div><div class="ttdef"><b>Definition:</b> <a href="TargetLibraryInfo_8h_source.html#l00422">TargetLibraryInfo.h:422</a></div></div>
<div class="ttc" id="namespacellvm_html_aadf66db071227857a2ae14e078d6b4cd"><div class="ttname"><a href="namespacellvm.html#aadf66db071227857a2ae14e078d6b4cd">llvm::RoundUpToAlignment</a></div><div class="ttdeci">uint64_t RoundUpToAlignment(uint64_t Value, uint64_t Align)</div><div class="ttdef"><b>Definition:</b> <a href="MathExtras_8h_source.html#l00565">MathExtras.h:565</a></div></div>
<div class="ttc" id="classllvm_1_1sys_1_1MemoryBlock_html_adf2f5548b7f0d0f6a86f2578581d8380"><div class="ttname"><a href="classllvm_1_1sys_1_1MemoryBlock.html#adf2f5548b7f0d0f6a86f2578581d8380">llvm::sys::MemoryBlock::base</a></div><div class="ttdeci">void * base() const </div><div class="ttdef"><b>Definition:</b> <a href="Memory_8h_source.html#l00033">Memory.h:33</a></div></div>
<div class="ttc" id="classllvm_1_1JITMemoryManager_html_a83a5bf651c95359c4c13ad3849fb585a"><div class="ttname"><a href="classllvm_1_1JITMemoryManager.html#a83a5bf651c95359c4c13ad3849fb585a">llvm::JITMemoryManager::~JITMemoryManager</a></div><div class="ttdeci">virtual ~JITMemoryManager()</div><div class="ttdef"><b>Definition:</b> <a href="JITMemoryManager_8cpp_source.html#l00045">JITMemoryManager.cpp:45</a></div></div>
<div class="ttc" id="classllvm_1_1JITMemoryManager_html_a6e22cda5944b162cfb671e242894fa54"><div class="ttname"><a href="classllvm_1_1JITMemoryManager.html#a6e22cda5944b162cfb671e242894fa54">llvm::JITMemoryManager::GetNumDataSlabs</a></div><div class="ttdeci">virtual unsigned GetNumDataSlabs()</div><div class="ttdef"><b>Definition:</b> <a href="JITMemoryManager_8h_source.html#l00151">JITMemoryManager.h:151</a></div></div>
<div class="ttc" id="classllvm_1_1MemSlab_html_aa3f124d77412e50860638f073ca25a2f"><div class="ttname"><a href="classllvm_1_1MemSlab.html#aa3f124d77412e50860638f073ca25a2f">llvm::MemSlab::NextPtr</a></div><div class="ttdeci">MemSlab * NextPtr</div><div class="ttdef"><b>Definition:</b> <a href="Allocator_8h_source.html#l00056">Allocator.h:56</a></div></div>
<div class="ttc" id="classllvm_1_1JITMemoryManager_html_a3f99e7db9b54b646c744e1842ae34be0"><div class="ttname"><a href="classllvm_1_1JITMemoryManager.html#a3f99e7db9b54b646c744e1842ae34be0">llvm::JITMemoryManager::startFunctionBody</a></div><div class="ttdeci">virtual uint8_t * startFunctionBody(const Function *F, uintptr_t &amp;ActualSize)=0</div></div>
<div class="ttc" id="MD5_8cpp_html_ac0eafdc9ee161b71e7af98af736952fd"><div class="ttname"><a href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a></div><div class="ttdeci">#define I(x, y, z)</div><div class="ttdef"><b>Definition:</b> <a href="MD5_8cpp_source.html#l00054">MD5.cpp:54</a></div></div>
<div class="ttc" id="classllvm_1_1JITMemoryManager_html_a9add3e0d5a4e9ec4677f6a705094487f"><div class="ttname"><a href="classllvm_1_1JITMemoryManager.html#a9add3e0d5a4e9ec4677f6a705094487f">llvm::JITMemoryManager::setMemoryWritable</a></div><div class="ttdeci">virtual void setMemoryWritable()=0</div></div>
<div class="ttc" id="classllvm_1_1JITMemoryManager_html_a36b4c538f45ef891a3cb54a1bf2e2e38"><div class="ttname"><a href="classllvm_1_1JITMemoryManager.html#a36b4c538f45ef891a3cb54a1bf2e2e38">llvm::JITMemoryManager::allocateSpace</a></div><div class="ttdeci">virtual uint8_t * allocateSpace(intptr_t Size, unsigned Alignment)=0</div></div>
<div class="ttc" id="classllvm_1_1SlabAllocator_html"><div class="ttname"><a href="classllvm_1_1SlabAllocator.html">llvm::SlabAllocator</a></div><div class="ttdef"><b>Definition:</b> <a href="Allocator_8h_source.html#l00064">Allocator.h:64</a></div></div>
<div class="ttc" id="classllvm_1_1raw__string__ostream_html"><div class="ttname"><a href="classllvm_1_1raw__string__ostream.html">llvm::raw_string_ostream</a></div><div class="ttdef"><b>Definition:</b> <a href="raw__ostream_8h_source.html#l00426">raw_ostream.h:426</a></div></div>
<div class="ttc" id="Debug_8h_html_aef41e8aaf4c60819b30faf396cdf4978"><div class="ttname"><a href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a></div><div class="ttdeci">#define DEBUG(X)</div><div class="ttdef"><b>Definition:</b> <a href="Debug_8h_source.html#l00097">Debug.h:97</a></div></div>
<div class="ttc" id="classllvm_1_1RTDyldMemoryManager_html_a4e5d745e695dc62ebaec15f537af9fed"><div class="ttname"><a href="classllvm_1_1RTDyldMemoryManager.html#a4e5d745e695dc62ebaec15f537af9fed">llvm::RTDyldMemoryManager::getPointerToNamedFunction</a></div><div class="ttdeci">virtual void * getPointerToNamedFunction(const std::string &amp;Name, bool AbortOnFailure=true)</div><div class="ttdef"><b>Definition:</b> <a href="RTDyldMemoryManager_8cpp_source.html#l00272">RTDyldMemoryManager.cpp:272</a></div></div>
<div class="ttc" id="classllvm_1_1JITMemoryManager_html_ab339f6b5a3613daac95898e6979dc83e"><div class="ttname"><a href="classllvm_1_1JITMemoryManager.html#ab339f6b5a3613daac95898e6979dc83e">llvm::JITMemoryManager::GetDefaultDataSlabSize</a></div><div class="ttdeci">virtual size_t GetDefaultDataSlabSize()</div><div class="ttdef"><b>Definition:</b> <a href="JITMemoryManager_8h_source.html#l00133">JITMemoryManager.h:133</a></div></div>
<div class="ttc" id="classllvm_1_1StringRef_html"><div class="ttname"><a href="classllvm_1_1StringRef.html">llvm::StringRef</a></div><div class="ttdef"><b>Definition:</b> <a href="StringRef_8h_source.html#l00041">StringRef.h:41</a></div></div>
<div class="ttc" id="namespacellvm_html_a24b4a0b3fd7a9932de5e733fe042c753"><div class="ttname"><a href="namespacellvm.html#a24b4a0b3fd7a9932de5e733fe042c753">llvm::jit_noop</a></div><div class="ttdeci">static int jit_noop()</div><div class="ttdef"><b>Definition:</b> <a href="RTDyldMemoryManager_8cpp_source.html#l00140">RTDyldMemoryManager.cpp:140</a></div></div>
<div class="ttc" id="raw__ostream_8h_html"><div class="ttname"><a href="raw__ostream_8h.html">raw_ostream.h</a></div></div>
<div class="ttc" id="Target_2ARM_2README_8txt_html_a90cca76dd78688687e0d697679dbc799"><div class="ttname"><a href="Target_2ARM_2README_8txt.html#a90cca76dd78688687e0d697679dbc799">B</a></div><div class="ttdeci">compiles ldr LCPI1_0 ldr ldr mov lsr tst moveq r1 ldr LCPI1_1 and r0 bx lr It would be better to do something like to fold the shift into the conditional ldr LCPI1_0 ldr ldr tst movne lsr ldr LCPI1_1 and r0 bx lr it saves an instruction and a register It might be profitable to cse MOVi16 if there are lots of bit immediates with the same bottom half Robert Muth started working on an alternate jump table implementation that does not put the tables in line in the text This is more like the llvm default jump table implementation This might be useful sometime Several revisions of patches are on the mailing beginning while CMP sets them like a subtract Therefore to be able to use CMN for comparisons other than the Z we ll need additional logic to reverse the conditionals associated with the comparison Perhaps a pseudo instruction for the with a post codegen pass to clean up and handle the condition codes See PR5694 for testcase Given the following on int B</div><div class="ttdef"><b>Definition:</b> <a href="Target_2ARM_2README_8txt_source.html#l00592">Target/ARM/README.txt:592</a></div></div>
<div class="ttc" id="JIT_8cpp_html_a3972a06550c629a9a489fd3e3f91bcb6"><div class="ttname"><a href="JIT_8cpp.html#a3972a06550c629a9a489fd3e3f91bcb6">getPointerToNamedFunction</a></div><div class="ttdeci">void * getPointerToNamedFunction(const char *Name)</div><div class="ttdef"><b>Definition:</b> <a href="JIT_8cpp_source.html#l00131">JIT.cpp:131</a></div></div>
<div class="ttc" id="classllvm_1_1JITMemoryManager_html_a450d074b4c791654d971cfc25ab080eb"><div class="ttname"><a href="classllvm_1_1JITMemoryManager.html#a450d074b4c791654d971cfc25ab080eb">llvm::JITMemoryManager::GetDefaultCodeSlabSize</a></div><div class="ttdeci">virtual size_t GetDefaultCodeSlabSize()</div><div class="ttdef"><b>Definition:</b> <a href="JITMemoryManager_8h_source.html#l00127">JITMemoryManager.h:127</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<hr>
<p class="footer">
Generated on Sat Nov 10 2018 22:59:08 for <a href="http://llvm.org/">LLVM</a> by
<a href="http://www.doxygen.org"><img src="doxygen.png" alt="Doxygen"
align="middle" border="0"/>1.8.11</a><br>
Copyright &copy; 2003-2013 University of Illinois at Urbana-Champaign.
All Rights Reserved.</p>
<hr>
<!--#include virtual="/attrib.incl" -->
</body>
</html>
