<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head>
<meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1"/>
<meta name="keywords" content="LLVM,Low Level Virtual Machine,C++,doxygen,API,documentation"/>
<meta name="description" content="C++ source code API documentation for LLVM."/>
<title>LLVM: InstCombineSelect.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head><body>
<p class="title">LLVM API Documentation</p>
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('InstCombineSelect_8cpp_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">InstCombineSelect.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="InstCombineSelect_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//===- InstCombineSelect.cpp ----------------------------------------------===//</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">//                     The LLVM Compiler Infrastructure</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// This file is distributed under the University of Illinois Open Source</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">// License. See LICENSE.TXT for details.</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">// This file implements the visitSelect function.</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="InstCombine_8h.html">InstCombine.h</a>&quot;</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ConstantFolding_8h.html">llvm/Analysis/ConstantFolding.h</a>&quot;</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="InstructionSimplify_8h.html">llvm/Analysis/InstructionSimplify.h</a>&quot;</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="PatternMatch_8h.html">llvm/Support/PatternMatch.h</a>&quot;</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespacellvm.html">llvm</a>;</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="keyword">using namespace </span>PatternMatch;</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">/// MatchSelectPattern - Pattern match integer [SU]MIN, [SU]MAX, and ABS idioms,</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">/// returning the kind and providing the out parameter results if we</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">/// successfully match.</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment"></span><span class="keyword">static</span> <a class="code" href="namespacellvm.html#a6bf471c1030973649c2e426afc212097">SelectPatternFlavor</a></div><div class="line"><a name="l00025"></a><span class="lineno"><a class="line" href="InstCombineSelect_8cpp.html#adf9a8f7fa74378ffb19874970d772398">   25</a></span>&#160;<a class="code" href="InstCombineSelect_8cpp.html#adf9a8f7fa74378ffb19874970d772398">MatchSelectPattern</a>(<a class="code" href="classllvm_1_1Value.html">Value</a> *V, <a class="code" href="classllvm_1_1Value.html">Value</a> *&amp;LHS, <a class="code" href="classllvm_1_1Value.html">Value</a> *&amp;RHS) {</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;  <a class="code" href="classllvm_1_1SelectInst.html">SelectInst</a> *SI = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1SelectInst.html">SelectInst</a>&gt;(V);</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;  <span class="keywordflow">if</span> (SI == 0) <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#a6bf471c1030973649c2e426afc212097aee3dafa9fac8f6fa1e1110ef463cc452">SPF_UNKNOWN</a>;</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;  <a class="code" href="classllvm_1_1ICmpInst.html">ICmpInst</a> *ICI = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ICmpInst.html">ICmpInst</a>&gt;(SI-&gt;<a class="code" href="classllvm_1_1SelectInst.html#ad285a69e32ddeee367fed93b5f392801">getCondition</a>());</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  <span class="keywordflow">if</span> (ICI == 0) <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#a6bf471c1030973649c2e426afc212097aee3dafa9fac8f6fa1e1110ef463cc452">SPF_UNKNOWN</a>;</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  LHS = ICI-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0);</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  RHS = ICI-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(1);</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  <span class="comment">// (icmp X, Y) ? X : Y</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  <span class="keywordflow">if</span> (SI-&gt;<a class="code" href="classllvm_1_1SelectInst.html#a67bf091383cd61e1225445e78b61d9f9">getTrueValue</a>() == ICI-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0) &amp;&amp;</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;      SI-&gt;<a class="code" href="classllvm_1_1SelectInst.html#a29a16f32075ee4f23cd769701463952c">getFalseValue</a>() == ICI-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(1)) {</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <span class="keywordflow">switch</span> (ICI-&gt;<a class="code" href="classllvm_1_1CmpInst.html#a8afd4995fae596b2c86eeed85b3d388b">getPredicate</a>()) {</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <span class="keywordflow">default</span>: <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#a6bf471c1030973649c2e426afc212097aee3dafa9fac8f6fa1e1110ef463cc452">SPF_UNKNOWN</a>; <span class="comment">// Equality.</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05a607cecdc5172814382033e001ed11fad">ICmpInst::ICMP_UGT</a>:</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05a573bcd571c938fce863525330bbfc4b8">ICmpInst::ICMP_UGE</a>: <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#a6bf471c1030973649c2e426afc212097a7d51d0dcfc2cc79738c77f8f5fa37138">SPF_UMAX</a>;</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05a720a42e85f7e981afd61e28473b0000a">ICmpInst::ICMP_SGT</a>:</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05ac1aa7b798ba11d2e497d5cce6ce6d3dc">ICmpInst::ICMP_SGE</a>: <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#a6bf471c1030973649c2e426afc212097ac8062350ff8114c3ffe79a339f2a1ece">SPF_SMAX</a>;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05a91d86a4753c8bd7624e01bf565d87f8e">ICmpInst::ICMP_ULT</a>:</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05ad92f160316221fd4090520bb2b3cefc5">ICmpInst::ICMP_ULE</a>: <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#a6bf471c1030973649c2e426afc212097a6afb3549f5028760be1bbf8ae7c04d73">SPF_UMIN</a>;</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05a15ae464950ac676919c2f0c7aafc706c">ICmpInst::ICMP_SLT</a>:</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05a2751d6136a2819749dcef65dc19a4246">ICmpInst::ICMP_SLE</a>: <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#a6bf471c1030973649c2e426afc212097abfed1bd97e2e6b014cbe76e02930d54b">SPF_SMIN</a>;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    }</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  }</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  <span class="comment">// (icmp X, Y) ? Y : X</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  <span class="keywordflow">if</span> (SI-&gt;<a class="code" href="classllvm_1_1SelectInst.html#a67bf091383cd61e1225445e78b61d9f9">getTrueValue</a>() == ICI-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(1) &amp;&amp;</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;      SI-&gt;<a class="code" href="classllvm_1_1SelectInst.html#a29a16f32075ee4f23cd769701463952c">getFalseValue</a>() == ICI-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0)) {</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <span class="keywordflow">switch</span> (ICI-&gt;<a class="code" href="classllvm_1_1CmpInst.html#a8afd4995fae596b2c86eeed85b3d388b">getPredicate</a>()) {</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;      <span class="keywordflow">default</span>: <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#a6bf471c1030973649c2e426afc212097aee3dafa9fac8f6fa1e1110ef463cc452">SPF_UNKNOWN</a>; <span class="comment">// Equality.</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05a607cecdc5172814382033e001ed11fad">ICmpInst::ICMP_UGT</a>:</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05a573bcd571c938fce863525330bbfc4b8">ICmpInst::ICMP_UGE</a>: <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#a6bf471c1030973649c2e426afc212097a6afb3549f5028760be1bbf8ae7c04d73">SPF_UMIN</a>;</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05a720a42e85f7e981afd61e28473b0000a">ICmpInst::ICMP_SGT</a>:</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05ac1aa7b798ba11d2e497d5cce6ce6d3dc">ICmpInst::ICMP_SGE</a>: <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#a6bf471c1030973649c2e426afc212097abfed1bd97e2e6b014cbe76e02930d54b">SPF_SMIN</a>;</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05a91d86a4753c8bd7624e01bf565d87f8e">ICmpInst::ICMP_ULT</a>:</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05ad92f160316221fd4090520bb2b3cefc5">ICmpInst::ICMP_ULE</a>: <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#a6bf471c1030973649c2e426afc212097a7d51d0dcfc2cc79738c77f8f5fa37138">SPF_UMAX</a>;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05a15ae464950ac676919c2f0c7aafc706c">ICmpInst::ICMP_SLT</a>:</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05a2751d6136a2819749dcef65dc19a4246">ICmpInst::ICMP_SLE</a>: <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#a6bf471c1030973649c2e426afc212097ac8062350ff8114c3ffe79a339f2a1ece">SPF_SMAX</a>;</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    }</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  }</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  <span class="comment">// TODO: (X &gt; 4) ? X : 5   --&gt;  (X &gt;= 5) ? X : 5  --&gt;  MAX(X, 5)</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#a6bf471c1030973649c2e426afc212097aee3dafa9fac8f6fa1e1110ef463cc452">SPF_UNKNOWN</a>;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;}</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">/// GetSelectFoldableOperands - We want to turn code that looks like this:</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment">///   %C = or %A, %B</span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment">///   %D = select %cond, %C, %A</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment">/// into:</span></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment">///   %C = select %cond, %B, 0</span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment">///   %D = or %A, %C</span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">/// Assuming that the specified instruction is an operand to the select, return</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">/// a bitmask indicating which operands of this instruction are foldable if they</span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">/// equal the other incoming value of the select.</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00084"></a><span class="lineno"><a class="line" href="InstCombineSelect_8cpp.html#af1ae9636acb04dd1a88afcb1e78d8f10">   84</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">unsigned</span> <a class="code" href="InstCombineSelect_8cpp.html#af1ae9636acb04dd1a88afcb1e78d8f10">GetSelectFoldableOperands</a>(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <span class="keywordflow">switch</span> (I-&gt;<a class="code" href="classllvm_1_1Instruction.html#a021bb7c9aad6003fe8089f6327356c6c">getOpcode</a>()) {</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  <span class="keywordflow">case</span> Instruction::Add:</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  <span class="keywordflow">case</span> Instruction::Mul:</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1APIntOps.html#a684cfe02c582e8d75cd6d457e63e6c25">Instruction::And</a>:</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1APIntOps.html#a22f056804d2b9882f74adc905872bc39">Instruction::Or</a>:</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1APIntOps.html#afc7c4d88d09cba0c5e920f8a3a3ace55">Instruction::Xor</a>:</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="keywordflow">return</span> 3;              <span class="comment">// Can fold through either operand.</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  <span class="keywordflow">case</span> Instruction::Sub:   <span class="comment">// Can only fold on the amount subtracted.</span></div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  <span class="keywordflow">case</span> Instruction::Shl:   <span class="comment">// Can only fold on the shift amount.</span></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  <span class="keywordflow">case</span> Instruction::LShr:</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  <span class="keywordflow">case</span> Instruction::AShr:</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <span class="keywordflow">default</span>:</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="keywordflow">return</span> 0;              <span class="comment">// Cannot fold</span></div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  }</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;}</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment">/// GetSelectFoldableConstant - For the same transformation as the previous</span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment">/// function, return the identity constant that goes into the select.</span></div><div class="line"><a name="l00104"></a><span class="lineno"><a class="line" href="InstCombineSelect_8cpp.html#a63f86caeedd50d73f6d31bb5340804a9">  104</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <a class="code" href="classllvm_1_1Constant.html">Constant</a> *<a class="code" href="InstCombineSelect_8cpp.html#a63f86caeedd50d73f6d31bb5340804a9">GetSelectFoldableConstant</a>(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  <span class="keywordflow">switch</span> (I-&gt;<a class="code" href="classllvm_1_1Instruction.html#a021bb7c9aad6003fe8089f6327356c6c">getOpcode</a>()) {</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  <span class="keywordflow">default</span>: <a class="code" href="ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a>(<span class="stringliteral">&quot;This cannot happen!&quot;</span>);</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  <span class="keywordflow">case</span> Instruction::Add:</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  <span class="keywordflow">case</span> Instruction::Sub:</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1APIntOps.html#a22f056804d2b9882f74adc905872bc39">Instruction::Or</a>:</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1APIntOps.html#afc7c4d88d09cba0c5e920f8a3a3ace55">Instruction::Xor</a>:</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  <span class="keywordflow">case</span> Instruction::Shl:</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  <span class="keywordflow">case</span> Instruction::LShr:</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <span class="keywordflow">case</span> Instruction::AShr:</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1Constant.html#aa6574d526b3e38a28f688a7bb4325c2c">Constant::getNullValue</a>(I-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>());</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1APIntOps.html#a684cfe02c582e8d75cd6d457e63e6c25">Instruction::And</a>:</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1Constant.html#a4d51384de6e1798bb6aa875aebeea9f0">Constant::getAllOnesValue</a>(I-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>());</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  <span class="keywordflow">case</span> Instruction::Mul:</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1ConstantInt.html#a9105541412dab869e18b3cceebfff07d">ConstantInt::get</a>(I-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>(), 1);</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  }</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;}</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment">/// FoldSelectOpOp - Here we have (select c, TI, FI), and we know that TI and FI</span></div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment">/// have the same opcode and only one use each.  Try to simplify this.</span></div><div class="line"><a name="l00124"></a><span class="lineno"><a class="line" href="classllvm_1_1InstCombiner.html#a4f28a80b49223e037dfd0f89dd83cb1a">  124</a></span>&#160;<span class="comment"></span><a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="classllvm_1_1InstCombiner.html#a4f28a80b49223e037dfd0f89dd83cb1a">InstCombiner::FoldSelectOpOp</a>(<a class="code" href="classllvm_1_1SelectInst.html">SelectInst</a> &amp;SI, <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *TI,</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;                                          <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *FI) {</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  <span class="keywordflow">if</span> (TI-&gt;<a class="code" href="classllvm_1_1User.html#a2f81e0c1fc6554df7ad2eafabf5fc5a5">getNumOperands</a>() == 1) {</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="comment">// If this is a non-volatile load or a cast from the same type,</span></div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <span class="comment">// merge.</span></div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="keywordflow">if</span> (TI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a0cb60bdee4006424b8fd957f2c38b11b">isCast</a>()) {</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;      <a class="code" href="classllvm_1_1Type.html">Type</a> *FIOpndTy = FI-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0)-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>();</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;      <span class="keywordflow">if</span> (TI-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0)-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>() != FIOpndTy)</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;      <span class="comment">// The select condition may be a vector. We may only change the operand</span></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;      <span class="comment">// type if the vector width remains the same (and matches the condition).</span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;      <a class="code" href="classllvm_1_1Type.html">Type</a> *CondTy = SI.<a class="code" href="classllvm_1_1SelectInst.html#ad285a69e32ddeee367fed93b5f392801">getCondition</a>()-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>();</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;      <span class="keywordflow">if</span> (CondTy-&gt;<a class="code" href="classllvm_1_1Type.html#a6f725580f7834e2ca90762965866dad4">isVectorTy</a>() &amp;&amp; (!FIOpndTy-&gt;<a class="code" href="classllvm_1_1Type.html#a6f725580f7834e2ca90762965866dad4">isVectorTy</a>() ||</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;          CondTy-&gt;<a class="code" href="classllvm_1_1Type.html#ad8f27f0b94a56abcd296b8461737a3af">getVectorNumElements</a>() != FIOpndTy-&gt;<a class="code" href="classllvm_1_1Type.html#ad8f27f0b94a56abcd296b8461737a3af">getVectorNumElements</a>()))</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;      <span class="keywordflow">return</span> 0;  <span class="comment">// unknown unary op.</span></div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    }</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <span class="comment">// Fold this by inserting a select from the input values.</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *NewSI = Builder-&gt;CreateSelect(SI.<a class="code" href="classllvm_1_1SelectInst.html#ad285a69e32ddeee367fed93b5f392801">getCondition</a>(), TI-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0),</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;                                         FI-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0), SI.<a class="code" href="classllvm_1_1Value.html#ad452febc1ac0b394876e640ec03ffa38">getName</a>()+<span class="stringliteral">&quot;.v&quot;</span>);</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1CastInst.html#a0f7dea9550778374905e12da6d6ba8a8">CastInst::Create</a>(<a class="code" href="classllvm_1_1Instruction.html#afa0b2fa29ba074f2b6ec9ac11163f2d9">Instruction::CastOps</a>(TI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a021bb7c9aad6003fe8089f6327356c6c">getOpcode</a>()), NewSI,</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;                            TI-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>());</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  }</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  <span class="comment">// Only handle binary operators here.</span></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  <span class="keywordflow">if</span> (!isa&lt;BinaryOperator&gt;(TI))</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  <span class="comment">// Figure out if the operations have any operands in common.</span></div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *MatchOp, *OtherOpT, *OtherOpF;</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  <span class="keywordtype">bool</span> MatchIsOpZero;</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  <span class="keywordflow">if</span> (TI-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0) == FI-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0)) {</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    MatchOp  = TI-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0);</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    OtherOpT = TI-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(1);</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    OtherOpF = FI-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(1);</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    MatchIsOpZero = <span class="keyword">true</span>;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (TI-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(1) == FI-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(1)) {</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    MatchOp  = TI-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(1);</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    OtherOpT = TI-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0);</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    OtherOpF = FI-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0);</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    MatchIsOpZero = <span class="keyword">false</span>;</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!TI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a1c2048f254df730c4de1643ec791ddf9">isCommutative</a>()) {</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (TI-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0) == FI-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(1)) {</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    MatchOp  = TI-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0);</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    OtherOpT = TI-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(1);</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    OtherOpF = FI-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0);</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    MatchIsOpZero = <span class="keyword">true</span>;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (TI-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(1) == FI-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0)) {</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    MatchOp  = TI-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(1);</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    OtherOpT = TI-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0);</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    OtherOpF = FI-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(1);</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    MatchIsOpZero = <span class="keyword">true</span>;</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  }</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  <span class="comment">// If we reach here, they do have operations in common.</span></div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *NewSI = Builder-&gt;CreateSelect(SI.<a class="code" href="classllvm_1_1SelectInst.html#ad285a69e32ddeee367fed93b5f392801">getCondition</a>(), OtherOpT,</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                                       OtherOpF, SI.<a class="code" href="classllvm_1_1Value.html#ad452febc1ac0b394876e640ec03ffa38">getName</a>()+<span class="stringliteral">&quot;.v&quot;</span>);</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1BinaryOperator.html">BinaryOperator</a> *BO = dyn_cast&lt;BinaryOperator&gt;(TI)) {</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="keywordflow">if</span> (MatchIsOpZero)</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1BinaryOperator.html#a4a4628e91a9c6a339fa61105614fac76">BinaryOperator::Create</a>(BO-&gt;getOpcode(), MatchOp, NewSI);</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1BinaryOperator.html#a4a4628e91a9c6a339fa61105614fac76">BinaryOperator::Create</a>(BO-&gt;getOpcode(), NewSI, MatchOp);</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;  }</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  <a class="code" href="ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a>(<span class="stringliteral">&quot;Shouldn&#39;t get here&quot;</span>);</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;}</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;</div><div class="line"><a name="l00196"></a><span class="lineno"><a class="line" href="InstCombineSelect_8cpp.html#a2914e94cd5aa888f57945589a7c2e1d0">  196</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="InstCombineSelect_8cpp.html#a2914e94cd5aa888f57945589a7c2e1d0">isSelect01</a>(<a class="code" href="classllvm_1_1Constant.html">Constant</a> *<a class="code" href="Target_2README_8txt.html#a2a2df5a25b9c703e74e82b48a75d0c3d">C1</a>, <a class="code" href="classllvm_1_1Constant.html">Constant</a> *C2) {</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  <a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *C1I = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a>&gt;(<a class="code" href="Target_2README_8txt.html#a2a2df5a25b9c703e74e82b48a75d0c3d">C1</a>);</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  <span class="keywordflow">if</span> (!C1I)</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;  <a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *C2I = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a>&gt;(C2);</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  <span class="keywordflow">if</span> (!C2I)</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  <span class="keywordflow">if</span> (!C1I-&gt;<a class="code" href="classllvm_1_1ConstantInt.html#ad4ea4748170f687710a54c919dde5625">isZero</a>() &amp;&amp; !C2I-&gt;<a class="code" href="classllvm_1_1ConstantInt.html#ad4ea4748170f687710a54c919dde5625">isZero</a>()) <span class="comment">// One side must be zero.</span></div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  <span class="keywordflow">return</span> C1I-&gt;<a class="code" href="classllvm_1_1ConstantInt.html#aa96ca2cf0bb1e924523900fb911b0a45">isOne</a>() || C1I-&gt;<a class="code" href="classllvm_1_1Constant.html#ac8ddb745480a7e75a3862ddf0be3a298">isAllOnesValue</a>() ||</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;         C2I-&gt;<a class="code" href="classllvm_1_1ConstantInt.html#aa96ca2cf0bb1e924523900fb911b0a45">isOne</a>() || C2I-&gt;<a class="code" href="classllvm_1_1Constant.html#ac8ddb745480a7e75a3862ddf0be3a298">isAllOnesValue</a>();</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;}</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment">/// FoldSelectIntoOp - Try fold the select into one of the operands to</span></div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment">/// facilitate further optimization.</span></div><div class="line"><a name="l00211"></a><span class="lineno"><a class="line" href="classllvm_1_1InstCombiner.html#a056dec8cb050799ce28ff561df7a10c8">  211</a></span>&#160;<span class="comment"></span><a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="classllvm_1_1InstCombiner.html#a056dec8cb050799ce28ff561df7a10c8">InstCombiner::FoldSelectIntoOp</a>(<a class="code" href="classllvm_1_1SelectInst.html">SelectInst</a> &amp;SI, <a class="code" href="classllvm_1_1Value.html">Value</a> *TrueVal,</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                                            <a class="code" href="classllvm_1_1Value.html">Value</a> *FalseVal) {</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  <span class="comment">// See the comment above GetSelectFoldableOperands for a description of the</span></div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  <span class="comment">// transformation we are doing here.</span></div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *TVI = dyn_cast&lt;Instruction&gt;(TrueVal)) {</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <span class="keywordflow">if</span> (TVI-&gt;hasOneUse() &amp;&amp; TVI-&gt;getNumOperands() == 2 &amp;&amp;</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        !isa&lt;Constant&gt;(FalseVal)) {</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;      <span class="keywordflow">if</span> (<span class="keywordtype">unsigned</span> SFO = <a class="code" href="InstCombineSelect_8cpp.html#af1ae9636acb04dd1a88afcb1e78d8f10">GetSelectFoldableOperands</a>(TVI)) {</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        <span class="keywordtype">unsigned</span> OpToFold = 0;</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        <span class="keywordflow">if</span> ((SFO &amp; 1) &amp;&amp; FalseVal == TVI-&gt;getOperand(0)) {</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;          OpToFold = 1;</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((SFO &amp; 2) &amp;&amp; FalseVal == TVI-&gt;getOperand(1)) {</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;          OpToFold = 2;</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        }</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        <span class="keywordflow">if</span> (OpToFold) {</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;          <a class="code" href="classllvm_1_1Constant.html">Constant</a> *<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = <a class="code" href="InstCombineSelect_8cpp.html#a63f86caeedd50d73f6d31bb5340804a9">GetSelectFoldableConstant</a>(TVI);</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;          <a class="code" href="classllvm_1_1Value.html">Value</a> *OOp = TVI-&gt;getOperand(2-OpToFold);</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;          <span class="comment">// Avoid creating select between 2 constants unless it&#39;s selecting</span></div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;          <span class="comment">// between 0, 1 and -1.</span></div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;          <span class="keywordflow">if</span> (!isa&lt;Constant&gt;(OOp) || <a class="code" href="InstCombineSelect_8cpp.html#a2914e94cd5aa888f57945589a7c2e1d0">isSelect01</a>(C, cast&lt;Constant&gt;(OOp))) {</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;            <a class="code" href="classllvm_1_1Value.html">Value</a> *NewSel = Builder-&gt;CreateSelect(SI.<a class="code" href="classllvm_1_1SelectInst.html#ad285a69e32ddeee367fed93b5f392801">getCondition</a>(), OOp, <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>);</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;            NewSel-&gt;<a class="code" href="classllvm_1_1Value.html#ae855357b6c5e6e7ed1869272708a3a84">takeName</a>(TVI);</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;            <a class="code" href="classllvm_1_1BinaryOperator.html">BinaryOperator</a> *TVI_BO = cast&lt;BinaryOperator&gt;(TVI);</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;            <a class="code" href="classllvm_1_1BinaryOperator.html">BinaryOperator</a> *BO = <a class="code" href="classllvm_1_1BinaryOperator.html#a4a4628e91a9c6a339fa61105614fac76">BinaryOperator::Create</a>(TVI_BO-&gt;<a class="code" href="classllvm_1_1BinaryOperator.html#a88505baf41407782678a5df1702d2d31">getOpcode</a>(),</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;                                                        FalseVal, NewSel);</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;            <span class="keywordflow">if</span> (isa&lt;PossiblyExactOperator&gt;(BO))</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;              BO-&gt;<a class="code" href="classllvm_1_1BinaryOperator.html#aac502d7d65e2996cf6b819b14e17499c">setIsExact</a>(TVI_BO-&gt;<a class="code" href="classllvm_1_1BinaryOperator.html#a0f67e7208255f5088f0d515185109174">isExact</a>());</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;            <span class="keywordflow">if</span> (isa&lt;OverflowingBinaryOperator&gt;(BO)) {</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;              BO-&gt;setHasNoUnsignedWrap(TVI_BO-&gt;<a class="code" href="classllvm_1_1BinaryOperator.html#a5b6cd6c043f54b40899aff62e6e40488">hasNoUnsignedWrap</a>());</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;              BO-&gt;setHasNoSignedWrap(TVI_BO-&gt;<a class="code" href="classllvm_1_1BinaryOperator.html#a07783e6f39803037259a1ebe376c2b1e">hasNoSignedWrap</a>());</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;            }</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;            <span class="keywordflow">return</span> BO;</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;          }</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;        }</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;      }</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    }</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  }</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *FVI = dyn_cast&lt;Instruction&gt;(FalseVal)) {</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <span class="keywordflow">if</span> (FVI-&gt;hasOneUse() &amp;&amp; FVI-&gt;getNumOperands() == 2 &amp;&amp;</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        !isa&lt;Constant&gt;(TrueVal)) {</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;      <span class="keywordflow">if</span> (<span class="keywordtype">unsigned</span> SFO = <a class="code" href="InstCombineSelect_8cpp.html#af1ae9636acb04dd1a88afcb1e78d8f10">GetSelectFoldableOperands</a>(FVI)) {</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        <span class="keywordtype">unsigned</span> OpToFold = 0;</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;        <span class="keywordflow">if</span> ((SFO &amp; 1) &amp;&amp; TrueVal == FVI-&gt;getOperand(0)) {</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;          OpToFold = 1;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((SFO &amp; 2) &amp;&amp; TrueVal == FVI-&gt;getOperand(1)) {</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;          OpToFold = 2;</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        }</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        <span class="keywordflow">if</span> (OpToFold) {</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;          <a class="code" href="classllvm_1_1Constant.html">Constant</a> *<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = <a class="code" href="InstCombineSelect_8cpp.html#a63f86caeedd50d73f6d31bb5340804a9">GetSelectFoldableConstant</a>(FVI);</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;          <a class="code" href="classllvm_1_1Value.html">Value</a> *OOp = FVI-&gt;getOperand(2-OpToFold);</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;          <span class="comment">// Avoid creating select between 2 constants unless it&#39;s selecting</span></div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;          <span class="comment">// between 0, 1 and -1.</span></div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;          <span class="keywordflow">if</span> (!isa&lt;Constant&gt;(OOp) || <a class="code" href="InstCombineSelect_8cpp.html#a2914e94cd5aa888f57945589a7c2e1d0">isSelect01</a>(C, cast&lt;Constant&gt;(OOp))) {</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;            <a class="code" href="classllvm_1_1Value.html">Value</a> *NewSel = Builder-&gt;CreateSelect(SI.<a class="code" href="classllvm_1_1SelectInst.html#ad285a69e32ddeee367fed93b5f392801">getCondition</a>(), <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>, OOp);</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;            NewSel-&gt;<a class="code" href="classllvm_1_1Value.html#ae855357b6c5e6e7ed1869272708a3a84">takeName</a>(FVI);</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;            <a class="code" href="classllvm_1_1BinaryOperator.html">BinaryOperator</a> *FVI_BO = cast&lt;BinaryOperator&gt;(FVI);</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;            <a class="code" href="classllvm_1_1BinaryOperator.html">BinaryOperator</a> *BO = <a class="code" href="classllvm_1_1BinaryOperator.html#a4a4628e91a9c6a339fa61105614fac76">BinaryOperator::Create</a>(FVI_BO-&gt;<a class="code" href="classllvm_1_1BinaryOperator.html#a88505baf41407782678a5df1702d2d31">getOpcode</a>(),</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;                                                        TrueVal, NewSel);</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;            <span class="keywordflow">if</span> (isa&lt;PossiblyExactOperator&gt;(BO))</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;              BO-&gt;<a class="code" href="classllvm_1_1BinaryOperator.html#aac502d7d65e2996cf6b819b14e17499c">setIsExact</a>(FVI_BO-&gt;<a class="code" href="classllvm_1_1BinaryOperator.html#a0f67e7208255f5088f0d515185109174">isExact</a>());</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;            <span class="keywordflow">if</span> (isa&lt;OverflowingBinaryOperator&gt;(BO)) {</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;              BO-&gt;setHasNoUnsignedWrap(FVI_BO-&gt;<a class="code" href="classllvm_1_1BinaryOperator.html#a5b6cd6c043f54b40899aff62e6e40488">hasNoUnsignedWrap</a>());</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;              BO-&gt;setHasNoSignedWrap(FVI_BO-&gt;<a class="code" href="classllvm_1_1BinaryOperator.html#a07783e6f39803037259a1ebe376c2b1e">hasNoSignedWrap</a>());</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;            }</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;            <span class="keywordflow">return</span> BO;</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;          }</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        }</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;      }</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    }</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;  }</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;}</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="comment">/// SimplifyWithOpReplaced - See if V simplifies when its operand Op is</span></div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="comment">/// replaced with RepOp.</span></div><div class="line"><a name="l00290"></a><span class="lineno"><a class="line" href="InstCombineSelect_8cpp.html#add57cb1fef9cdd2cac6778e76cf9540f">  290</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="InstCombineSelect_8cpp.html#add57cb1fef9cdd2cac6778e76cf9540f">SimplifyWithOpReplaced</a>(<a class="code" href="classllvm_1_1Value.html">Value</a> *V, <a class="code" href="classllvm_1_1Value.html">Value</a> *Op, <a class="code" href="classllvm_1_1Value.html">Value</a> *RepOp,</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;                                     <span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> *TD,</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                                     <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetLibraryInfo.html">TargetLibraryInfo</a> *TLI) {</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  <span class="comment">// Trivial replacement.</span></div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;  <span class="keywordflow">if</span> (V == Op)</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <span class="keywordflow">return</span> RepOp;</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1Instruction.html">Instruction</a>&gt;(V);</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;  <span class="keywordflow">if</span> (!I)</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;  <span class="comment">// If this is a binary operator, try to simplify it with the replaced op.</span></div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1BinaryOperator.html">BinaryOperator</a> *<a class="code" href="Target_2ARM_2README_8txt.html#a90cca76dd78688687e0d697679dbc799">B</a> = dyn_cast&lt;BinaryOperator&gt;(I)) {</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="Target_2ARM_2README_8txt.html#a90cca76dd78688687e0d697679dbc799">B</a>-&gt;getOperand(0) == Op)</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#a9a0b7acac205af164daef4017f9d193d">SimplifyBinOp</a>(<a class="code" href="Target_2ARM_2README_8txt.html#a90cca76dd78688687e0d697679dbc799">B</a>-&gt;getOpcode(), RepOp, <a class="code" href="Target_2ARM_2README_8txt.html#a90cca76dd78688687e0d697679dbc799">B</a>-&gt;getOperand(1), TD, TLI);</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="Target_2ARM_2README_8txt.html#a90cca76dd78688687e0d697679dbc799">B</a>-&gt;getOperand(1) == Op)</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#a9a0b7acac205af164daef4017f9d193d">SimplifyBinOp</a>(<a class="code" href="Target_2ARM_2README_8txt.html#a90cca76dd78688687e0d697679dbc799">B</a>-&gt;getOpcode(), <a class="code" href="Target_2ARM_2README_8txt.html#a90cca76dd78688687e0d697679dbc799">B</a>-&gt;getOperand(0), RepOp, TD, TLI);</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;  }</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;  <span class="comment">// Same for CmpInsts.</span></div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1CmpInst.html">CmpInst</a> *<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = dyn_cast&lt;CmpInst&gt;(I)) {</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>-&gt;getOperand(0) == Op)</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#a842dbe70b763270b02de0473c3cc890d">SimplifyCmpInst</a>(<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>-&gt;getPredicate(), RepOp, <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>-&gt;getOperand(1), TD,</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;                             TLI);</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>-&gt;getOperand(1) == Op)</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#a842dbe70b763270b02de0473c3cc890d">SimplifyCmpInst</a>(<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>-&gt;getPredicate(), <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>-&gt;getOperand(0), RepOp, TD,</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;                             TLI);</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  }</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  <span class="comment">// TODO: We could hand off more cases to instsimplify here.</span></div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;  <span class="comment">// If all operands are constant after substituting Op for RepOp then we can</span></div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;  <span class="comment">// constant fold the instruction.</span></div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Constant.html">Constant</a> *CRepOp = dyn_cast&lt;Constant&gt;(RepOp)) {</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <span class="comment">// Build a list of all constant operands.</span></div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Constant*, 8&gt;</a> ConstOps;</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0, e = I-&gt;<a class="code" href="classllvm_1_1User.html#a2f81e0c1fc6554df7ad2eafabf5fc5a5">getNumOperands</a>(); <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != e; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;      <span class="keywordflow">if</span> (I-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) == Op)</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;        ConstOps.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(CRepOp);</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Constant.html">Constant</a> *COp = dyn_cast&lt;Constant&gt;(I-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>)))</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;        ConstOps.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(COp);</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    }</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    <span class="comment">// All operands were constants, fold it.</span></div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <span class="keywordflow">if</span> (ConstOps.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#a22a311dfe4c28a897de8a9365a4f0a84">size</a>() == I-&gt;<a class="code" href="classllvm_1_1User.html#a2f81e0c1fc6554df7ad2eafabf5fc5a5">getNumOperands</a>()) {</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1CmpInst.html">CmpInst</a> *<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = dyn_cast&lt;CmpInst&gt;(I))</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#aa61b351a455e9229d3dc58e0883b6cef">ConstantFoldCompareInstOperands</a>(<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>-&gt;getPredicate(), ConstOps[0],</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;                                               ConstOps[1], TD, TLI);</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1LoadInst.html">LoadInst</a> *LI = dyn_cast&lt;LoadInst&gt;(I))</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;        <span class="keywordflow">if</span> (!LI-&gt;isVolatile())</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;          <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#acf81840e57f5d7beb1d5983f4dac772f">ConstantFoldLoadFromConstPtr</a>(ConstOps[0], TD);</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#a3e98ee8971fbf32f7f84f5a7399b5b67">ConstantFoldInstOperands</a>(I-&gt;<a class="code" href="classllvm_1_1Instruction.html#a021bb7c9aad6003fe8089f6327356c6c">getOpcode</a>(), I-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>(),</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;                                      ConstOps, TD, TLI);</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    }</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;  }</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;}</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="comment">/// foldSelectICmpAndOr - We want to turn:</span></div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="comment">///   (select (icmp eq (and X, C1), 0), Y, (or Y, C2))</span></div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="comment">/// into:</span></div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="comment">///   (or (shl (and X, C1), C3), y)</span></div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="comment">/// iff:</span></div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="comment">///   C1 and C2 are both powers of 2</span></div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="comment">/// where:</span></div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="comment">///   C3 = Log(C2) - Log(C1)</span></div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="comment">/// This transform handles cases where:</span></div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="comment">/// 1. The icmp predicate is inverted</span></div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="comment">/// 2. The select operands are reversed</span></div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="comment">/// 3. The magnitude of C2 and C1 are flipped</span></div><div class="line"><a name="l00366"></a><span class="lineno"><a class="line" href="InstCombineSelect_8cpp.html#ac42fa1f09c238d941de002a5d3e835ef">  366</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="InstCombineSelect_8cpp.html#ac42fa1f09c238d941de002a5d3e835ef">foldSelectICmpAndOr</a>(<span class="keyword">const</span> <a class="code" href="classllvm_1_1SelectInst.html">SelectInst</a> &amp;SI, <a class="code" href="classllvm_1_1Value.html">Value</a> *TrueVal,</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;                                  <a class="code" href="classllvm_1_1Value.html">Value</a> *FalseVal,</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;                                  <a class="code" href="classllvm_1_1IRBuilder.html">InstCombiner::BuilderTy</a> *Builder) {</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1ICmpInst.html">ICmpInst</a> *IC = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ICmpInst.html">ICmpInst</a>&gt;(SI.<a class="code" href="classllvm_1_1SelectInst.html#ad285a69e32ddeee367fed93b5f392801">getCondition</a>());</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;  <span class="keywordflow">if</span> (!IC || !IC-&gt;<a class="code" href="classllvm_1_1ICmpInst.html#abe8988eef2e6fc2baba032cb22afedd7">isEquality</a>() || !SI.<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a6e328feb83afa5cf1c966d6704e43fc1">isIntegerTy</a>())</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *CmpLHS = IC-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0);</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *CmpRHS = IC-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(1);</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">match</a>(CmpRHS, <a class="code" href="namespacellvm_1_1PatternMatch.html#ab3b5beca3a0dedd21adac813123a2ae6">m_Zero</a>()))</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm.html#a6569d00d31a5d74e563e2f39f82271ab">X</a>;</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1APInt.html">APInt</a> *<a class="code" href="Target_2README_8txt.html#a2a2df5a25b9c703e74e82b48a75d0c3d">C1</a>;</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">match</a>(CmpLHS, <a class="code" href="namespacellvm_1_1PatternMatch.html#a427435d4da769ae680a8e77ef89520aa">m_And</a>(<a class="code" href="namespacellvm_1_1PatternMatch.html#a24bca8838396aa81b87de8e7ac774b19">m_Value</a>(X), <a class="code" href="namespacellvm_1_1PatternMatch.html#ad5e60756e331a97669d11b5c9d8691a2">m_Power2</a>(C1))))</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1APInt.html">APInt</a> *C2;</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;  <span class="keywordtype">bool</span> OrOnTrueVal = <span class="keyword">false</span>;</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;  <span class="keywordtype">bool</span> OrOnFalseVal = <a class="code" href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">match</a>(FalseVal, <a class="code" href="namespacellvm_1_1PatternMatch.html#a42569041ddafba7d40243e126af07f42">m_Or</a>(<a class="code" href="namespacellvm_1_1PatternMatch.html#a2d9861feadd3a09792967a012559e7b2">m_Specific</a>(TrueVal), <a class="code" href="namespacellvm_1_1PatternMatch.html#ad5e60756e331a97669d11b5c9d8691a2">m_Power2</a>(C2)));</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;  <span class="keywordflow">if</span> (!OrOnFalseVal)</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    OrOnTrueVal = <a class="code" href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">match</a>(TrueVal, <a class="code" href="namespacellvm_1_1PatternMatch.html#a42569041ddafba7d40243e126af07f42">m_Or</a>(<a class="code" href="namespacellvm_1_1PatternMatch.html#a2d9861feadd3a09792967a012559e7b2">m_Specific</a>(FalseVal), <a class="code" href="namespacellvm_1_1PatternMatch.html#ad5e60756e331a97669d11b5c9d8691a2">m_Power2</a>(C2)));</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;  <span class="keywordflow">if</span> (!OrOnFalseVal &amp;&amp; !OrOnTrueVal)</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *V = CmpLHS;</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="OcamlGCPrinter_8cpp.html#a1bdbcdc4205781eefd549946d40ff378">Y</a> = OrOnFalseVal ? TrueVal : FalseVal;</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  <span class="keywordtype">unsigned</span> C1Log = C1-&gt;<a class="code" href="classllvm_1_1APInt.html#a474f562a4871689af74b0fd1ae42daa1">logBase2</a>();</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;  <span class="keywordtype">unsigned</span> C2Log = C2-&gt;<a class="code" href="classllvm_1_1APInt.html#a474f562a4871689af74b0fd1ae42daa1">logBase2</a>();</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;  <span class="keywordflow">if</span> (C2Log &gt; C1Log) {</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    V = Builder-&gt;<a class="code" href="classllvm_1_1IRBuilder.html#a7cca116ba5ef3fe3dfc9872b1600d11d">CreateZExtOrTrunc</a>(V, Y-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>());</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    V = Builder-&gt;<a class="code" href="classllvm_1_1IRBuilder.html#a4d49fd9a4cc4f2a74d4555bd08b13910">CreateShl</a>(V, C2Log - C1Log);</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (C1Log &gt; C2Log) {</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    V = Builder-&gt;<a class="code" href="classllvm_1_1IRBuilder.html#a3f8c45ea10c393433221a508b750dcd5">CreateLShr</a>(V, C1Log - C2Log);</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    V = Builder-&gt;<a class="code" href="classllvm_1_1IRBuilder.html#a7cca116ba5ef3fe3dfc9872b1600d11d">CreateZExtOrTrunc</a>(V, Y-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>());</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    V = Builder-&gt;<a class="code" href="classllvm_1_1IRBuilder.html#a7cca116ba5ef3fe3dfc9872b1600d11d">CreateZExtOrTrunc</a>(V, Y-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>());</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;  <a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05">ICmpInst::Predicate</a> Pred = IC-&gt;<a class="code" href="classllvm_1_1CmpInst.html#a8afd4995fae596b2c86eeed85b3d388b">getPredicate</a>();</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;  <span class="keywordflow">if</span> ((Pred == <a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05ac17897ebf2f6a6986280fc3bdf28a30a">ICmpInst::ICMP_NE</a> &amp;&amp; OrOnFalseVal) ||</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;      (Pred == <a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05aa719225e2de4059f93fd3209e1f48218">ICmpInst::ICMP_EQ</a> &amp;&amp; OrOnTrueVal))</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    V = Builder-&gt;<a class="code" href="classllvm_1_1IRBuilder.html#a9b057429c5a047d0ee274074b6885acf">CreateXor</a>(V, *C2);</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;  <span class="keywordflow">return</span> Builder-&gt;<a class="code" href="classllvm_1_1IRBuilder.html#a8f55dd4237be6778517ddd752ca8b76a">CreateOr</a>(V, Y);</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;}</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;<span class="comment">/// visitSelectInstWithICmp - Visit a SelectInst that has an</span></div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;<span class="comment">/// ICmpInst as its first operand.</span></div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00418"></a><span class="lineno"><a class="line" href="classllvm_1_1InstCombiner.html#aaca290b85da72e895db359c37df8f0ab">  418</a></span>&#160;<span class="comment"></span><a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="classllvm_1_1InstCombiner.html#aaca290b85da72e895db359c37df8f0ab">InstCombiner::visitSelectInstWithICmp</a>(<a class="code" href="classllvm_1_1SelectInst.html">SelectInst</a> &amp;SI,</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;                                                   <a class="code" href="classllvm_1_1ICmpInst.html">ICmpInst</a> *ICI) {</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;  <span class="keywordtype">bool</span> Changed = <span class="keyword">false</span>;</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;  <a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05">ICmpInst::Predicate</a> Pred = ICI-&gt;<a class="code" href="classllvm_1_1CmpInst.html#a8afd4995fae596b2c86eeed85b3d388b">getPredicate</a>();</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *CmpLHS = ICI-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0);</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *CmpRHS = ICI-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(1);</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *TrueVal = SI.<a class="code" href="classllvm_1_1SelectInst.html#a67bf091383cd61e1225445e78b61d9f9">getTrueValue</a>();</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *FalseVal = SI.<a class="code" href="classllvm_1_1SelectInst.html#a29a16f32075ee4f23cd769701463952c">getFalseValue</a>();</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;  <span class="comment">// Check cases where the comparison is with a constant that</span></div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;  <span class="comment">// can be adjusted to fit the min/max idiom. We may move or edit ICI</span></div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;  <span class="comment">// here, so make sure the select is the only user.</span></div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;  <span class="keywordflow">if</span> (ICI-&gt;<a class="code" href="classllvm_1_1Value.html#a085b82f074c28030fb8e194377ed2d0c">hasOneUse</a>())</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *CI = dyn_cast&lt;ConstantInt&gt;(CmpRHS)) {</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;      <span class="comment">// X &lt; MIN ? T : F  --&gt;  F</span></div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;      <span class="keywordflow">if</span> ((Pred == <a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05a15ae464950ac676919c2f0c7aafc706c">ICmpInst::ICMP_SLT</a> || Pred == <a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05a91d86a4753c8bd7624e01bf565d87f8e">ICmpInst::ICMP_ULT</a>)</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;          &amp;&amp; CI-&gt;isMinValue(Pred == <a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05a15ae464950ac676919c2f0c7aafc706c">ICmpInst::ICMP_SLT</a>))</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;        <span class="keywordflow">return</span> ReplaceInstUsesWith(SI, FalseVal);</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;      <span class="comment">// X &gt; MAX ? T : F  --&gt;  F</span></div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((Pred == <a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05a720a42e85f7e981afd61e28473b0000a">ICmpInst::ICMP_SGT</a> || Pred == <a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05a607cecdc5172814382033e001ed11fad">ICmpInst::ICMP_UGT</a>)</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;               &amp;&amp; CI-&gt;isMaxValue(Pred == <a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05a720a42e85f7e981afd61e28473b0000a">ICmpInst::ICMP_SGT</a>))</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;        <span class="keywordflow">return</span> ReplaceInstUsesWith(SI, FalseVal);</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;      <span class="keywordflow">switch</span> (Pred) {</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;      <span class="keywordflow">default</span>: <span class="keywordflow">break</span>;</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05a91d86a4753c8bd7624e01bf565d87f8e">ICmpInst::ICMP_ULT</a>:</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05a15ae464950ac676919c2f0c7aafc706c">ICmpInst::ICMP_SLT</a>:</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05a607cecdc5172814382033e001ed11fad">ICmpInst::ICMP_UGT</a>:</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05a720a42e85f7e981afd61e28473b0000a">ICmpInst::ICMP_SGT</a>: {</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;        <span class="comment">// These transformations only work for selects over integers.</span></div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;        <a class="code" href="classllvm_1_1IntegerType.html">IntegerType</a> *SelectTy = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1IntegerType.html">IntegerType</a>&gt;(SI.<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>());</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;        <span class="keywordflow">if</span> (!SelectTy)</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;          <span class="keywordflow">break</span>;</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;        <a class="code" href="classllvm_1_1Constant.html">Constant</a> *AdjustedRHS;</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;        <span class="keywordflow">if</span> (Pred == <a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05a607cecdc5172814382033e001ed11fad">ICmpInst::ICMP_UGT</a> || Pred == <a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05a720a42e85f7e981afd61e28473b0000a">ICmpInst::ICMP_SGT</a>)</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;          AdjustedRHS = <a class="code" href="classllvm_1_1ConstantInt.html#a9105541412dab869e18b3cceebfff07d">ConstantInt::get</a>(CI-&gt;getContext(), CI-&gt;getValue() + 1);</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;        <span class="keywordflow">else</span> <span class="comment">// (Pred == ICmpInst::ICMP_ULT || Pred == ICmpInst::ICMP_SLT)</span></div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;          AdjustedRHS = <a class="code" href="classllvm_1_1ConstantInt.html#a9105541412dab869e18b3cceebfff07d">ConstantInt::get</a>(CI-&gt;getContext(), CI-&gt;getValue() - 1);</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;        <span class="comment">// X &gt; C ? X : C+1  --&gt;  X &lt; C+1 ? C+1 : X</span></div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;        <span class="comment">// X &lt; C ? X : C-1  --&gt;  X &gt; C-1 ? C-1 : X</span></div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;        <span class="keywordflow">if</span> ((CmpLHS == TrueVal &amp;&amp; AdjustedRHS == FalseVal) ||</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;            (CmpLHS == FalseVal &amp;&amp; AdjustedRHS == TrueVal))</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;          ; <span class="comment">// Nothing to do here. Values match without any sign/zero extension.</span></div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;        <span class="comment">// Types do not match. Instead of calculating this with mixed types</span></div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;        <span class="comment">// promote all to the larger type. This enables scalar evolution to</span></div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;        <span class="comment">// analyze this expression.</span></div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (CmpRHS-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#ad979b3c1bc975ee23810e3018ffe951b">getScalarSizeInBits</a>()</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;                 &lt; SelectTy-&gt;<a class="code" href="classllvm_1_1IntegerType.html#a6f603ab84f6f7c79985036f58cca9d48">getBitWidth</a>()) {</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;          <a class="code" href="classllvm_1_1Constant.html">Constant</a> *sextRHS = <a class="code" href="classllvm_1_1ConstantExpr.html#a365628d9f62e7a281d493d15bdb13b27">ConstantExpr::getSExt</a>(AdjustedRHS, SelectTy);</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;          <span class="comment">// X = sext x; x &gt;s c ? X : C+1 --&gt; X = sext x; X &lt;s C+1 ? C+1 : X</span></div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;          <span class="comment">// X = sext x; x &lt;s c ? X : C-1 --&gt; X = sext x; X &gt;s C-1 ? C-1 : X</span></div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;          <span class="comment">// X = sext x; x &gt;u c ? X : C+1 --&gt; X = sext x; X &lt;u C+1 ? C+1 : X</span></div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;          <span class="comment">// X = sext x; x &lt;u c ? X : C-1 --&gt; X = sext x; X &gt;u C-1 ? C-1 : X</span></div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">match</a>(TrueVal, <a class="code" href="namespacellvm_1_1PatternMatch.html#aaab494a433fbb23bc68393ee8bcfc5ac">m_SExt</a>(<a class="code" href="namespacellvm_1_1PatternMatch.html#a2d9861feadd3a09792967a012559e7b2">m_Specific</a>(CmpLHS))) &amp;&amp;</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;                sextRHS == FalseVal) {</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;            CmpLHS = TrueVal;</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;            AdjustedRHS = sextRHS;</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;          } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">match</a>(FalseVal, <a class="code" href="namespacellvm_1_1PatternMatch.html#aaab494a433fbb23bc68393ee8bcfc5ac">m_SExt</a>(<a class="code" href="namespacellvm_1_1PatternMatch.html#a2d9861feadd3a09792967a012559e7b2">m_Specific</a>(CmpLHS))) &amp;&amp;</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;                     sextRHS == TrueVal) {</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;            CmpLHS = FalseVal;</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;            AdjustedRHS = sextRHS;</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;          } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ICI-&gt;<a class="code" href="classllvm_1_1CmpInst.html#acc4aad24e3e9f04088c9b7802a7a5718">isUnsigned</a>()) {</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;            <a class="code" href="classllvm_1_1Constant.html">Constant</a> *zextRHS = <a class="code" href="classllvm_1_1ConstantExpr.html#a80e82791d4d7f4d1d23d68ca0a2b1f64">ConstantExpr::getZExt</a>(AdjustedRHS, SelectTy);</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;            <span class="comment">// X = zext x; x &gt;u c ? X : C+1 --&gt; X = zext x; X &lt;u C+1 ? C+1 : X</span></div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;            <span class="comment">// X = zext x; x &lt;u c ? X : C-1 --&gt; X = zext x; X &gt;u C-1 ? C-1 : X</span></div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;            <span class="comment">// zext + signed compare cannot be changed:</span></div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;            <span class="comment">//    0xff &lt;s 0x00, but 0x00ff &gt;s 0x0000</span></div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">match</a>(TrueVal, <a class="code" href="namespacellvm_1_1PatternMatch.html#a2cbdca7c8267aac6914d674f8e81841b">m_ZExt</a>(<a class="code" href="namespacellvm_1_1PatternMatch.html#a2d9861feadd3a09792967a012559e7b2">m_Specific</a>(CmpLHS))) &amp;&amp;</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;                zextRHS == FalseVal) {</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;              CmpLHS = TrueVal;</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;              AdjustedRHS = zextRHS;</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">match</a>(FalseVal, <a class="code" href="namespacellvm_1_1PatternMatch.html#a2cbdca7c8267aac6914d674f8e81841b">m_ZExt</a>(<a class="code" href="namespacellvm_1_1PatternMatch.html#a2d9861feadd3a09792967a012559e7b2">m_Specific</a>(CmpLHS))) &amp;&amp;</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;                       zextRHS == TrueVal) {</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;              CmpLHS = FalseVal;</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;              AdjustedRHS = zextRHS;</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;            } <span class="keywordflow">else</span></div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;              <span class="keywordflow">break</span>;</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;          } <span class="keywordflow">else</span></div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;        } <span class="keywordflow">else</span></div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;          <span class="keywordflow">break</span>;</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;        Pred = <a class="code" href="classllvm_1_1CmpInst.html#ab5d3f9900a0284e85ee7a1520a4eeb60">ICmpInst::getSwappedPredicate</a>(Pred);</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;        CmpRHS = AdjustedRHS;</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;        <a class="code" href="namespacestd.html#ab8424022895aee3e366fb9a32f2883cb">std::swap</a>(FalseVal, TrueVal);</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;        ICI-&gt;<a class="code" href="classllvm_1_1CmpInst.html#a126a12b67fa620ad28ec0c919ca7a3e8">setPredicate</a>(Pred);</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;        ICI-&gt;<a class="code" href="classllvm_1_1User.html#a5fa9b8e1842b354f64c1ba6be0a4a17f">setOperand</a>(0, CmpLHS);</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;        ICI-&gt;<a class="code" href="classllvm_1_1User.html#a5fa9b8e1842b354f64c1ba6be0a4a17f">setOperand</a>(1, CmpRHS);</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;        SI.<a class="code" href="classllvm_1_1User.html#a5fa9b8e1842b354f64c1ba6be0a4a17f">setOperand</a>(1, TrueVal);</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;        SI.<a class="code" href="classllvm_1_1User.html#a5fa9b8e1842b354f64c1ba6be0a4a17f">setOperand</a>(2, FalseVal);</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;        <span class="comment">// Move ICI instruction right before the select instruction. Otherwise</span></div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;        <span class="comment">// the sext/zext value may be defined after the ICI instruction uses it.</span></div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;        ICI-&gt;<a class="code" href="classllvm_1_1Instruction.html#af67d1f3a518964d80a109bb3d9d5cf1e">moveBefore</a>(&amp;SI);</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;        Changed = <span class="keyword">true</span>;</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;      }</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;      }</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    }</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;  <span class="comment">// Transform (X &gt;s -1) ? C1 : C2 --&gt; ((X &gt;&gt;s 31) &amp; (C2 - C1)) + C1</span></div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;  <span class="comment">// and       (X &lt;s  0) ? C2 : C1 --&gt; ((X &gt;&gt;s 31) &amp; (C2 - C1)) + C1</span></div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;  <span class="comment">// FIXME: Type and constness constraints could be lifted, but we have to</span></div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;  <span class="comment">//        watch code size carefully. We should consider xor instead of</span></div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;  <span class="comment">//        sub/add when we decide to do that.</span></div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1IntegerType.html">IntegerType</a> *Ty = dyn_cast&lt;IntegerType&gt;(CmpLHS-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>())) {</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    <span class="keywordflow">if</span> (TrueVal-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>() == Ty) {</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *Cmp = dyn_cast&lt;ConstantInt&gt;(CmpRHS)) {</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;        <a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *<a class="code" href="Target_2README_8txt.html#a2a2df5a25b9c703e74e82b48a75d0c3d">C1</a> = NULL, *C2 = NULL;</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;        <span class="keywordflow">if</span> (Pred == <a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05a720a42e85f7e981afd61e28473b0000a">ICmpInst::ICMP_SGT</a> &amp;&amp; Cmp-&gt;isAllOnesValue()) {</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;          C1 = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a>&gt;(TrueVal);</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;          C2 = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a>&gt;(FalseVal);</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Pred == <a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05a15ae464950ac676919c2f0c7aafc706c">ICmpInst::ICMP_SLT</a> &amp;&amp; Cmp-&gt;isNullValue()) {</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;          C1 = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a>&gt;(FalseVal);</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;          C2 = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a>&gt;(TrueVal);</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;        }</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;        <span class="keywordflow">if</span> (C1 &amp;&amp; C2) {</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;          <span class="comment">// This shift results in either -1 or 0.</span></div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;          <a class="code" href="classllvm_1_1Value.html">Value</a> *AShr = Builder-&gt;CreateAShr(CmpLHS, Ty-&gt;getBitWidth()-1);</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;          <span class="comment">// Check if we can express the operation with a single or.</span></div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;          <span class="keywordflow">if</span> (C2-&gt;isAllOnesValue())</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;            <span class="keywordflow">return</span> ReplaceInstUsesWith(SI, Builder-&gt;CreateOr(AShr, C1));</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;          <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1APIntOps.html#a684cfe02c582e8d75cd6d457e63e6c25">And</a> = Builder-&gt;CreateAnd(AShr, C2-&gt;getValue()-C1-&gt;<a class="code" href="classllvm_1_1ConstantInt.html#af8dde13a97efce293a7b04daf1e208fb">getValue</a>());</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;          <span class="keywordflow">return</span> ReplaceInstUsesWith(SI, Builder-&gt;CreateAdd(And, C1));</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;        }</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;      }</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    }</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;  }</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;  <span class="comment">// If we have an equality comparison then we know the value in one of the</span></div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;  <span class="comment">// arms of the select. See if substituting this value into the arm and</span></div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;  <span class="comment">// simplifying the result yields the same value as the other arm.</span></div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;  <span class="keywordflow">if</span> (Pred == <a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05aa719225e2de4059f93fd3209e1f48218">ICmpInst::ICMP_EQ</a>) {</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="InstCombineSelect_8cpp.html#add57cb1fef9cdd2cac6778e76cf9540f">SimplifyWithOpReplaced</a>(FalseVal, CmpLHS, CmpRHS, TD, TLI) == TrueVal ||</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;        <a class="code" href="InstCombineSelect_8cpp.html#add57cb1fef9cdd2cac6778e76cf9540f">SimplifyWithOpReplaced</a>(FalseVal, CmpRHS, CmpLHS, TD, TLI) == TrueVal)</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;      <span class="keywordflow">return</span> ReplaceInstUsesWith(SI, FalseVal);</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="InstCombineSelect_8cpp.html#add57cb1fef9cdd2cac6778e76cf9540f">SimplifyWithOpReplaced</a>(TrueVal, CmpLHS, CmpRHS, TD, TLI) == FalseVal ||</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;        <a class="code" href="InstCombineSelect_8cpp.html#add57cb1fef9cdd2cac6778e76cf9540f">SimplifyWithOpReplaced</a>(TrueVal, CmpRHS, CmpLHS, TD, TLI) == FalseVal)</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;      <span class="keywordflow">return</span> ReplaceInstUsesWith(SI, FalseVal);</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Pred == <a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05ac17897ebf2f6a6986280fc3bdf28a30a">ICmpInst::ICMP_NE</a>) {</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="InstCombineSelect_8cpp.html#add57cb1fef9cdd2cac6778e76cf9540f">SimplifyWithOpReplaced</a>(TrueVal, CmpLHS, CmpRHS, TD, TLI) == FalseVal ||</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;        <a class="code" href="InstCombineSelect_8cpp.html#add57cb1fef9cdd2cac6778e76cf9540f">SimplifyWithOpReplaced</a>(TrueVal, CmpRHS, CmpLHS, TD, TLI) == FalseVal)</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;      <span class="keywordflow">return</span> ReplaceInstUsesWith(SI, TrueVal);</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="InstCombineSelect_8cpp.html#add57cb1fef9cdd2cac6778e76cf9540f">SimplifyWithOpReplaced</a>(FalseVal, CmpLHS, CmpRHS, TD, TLI) == TrueVal ||</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;        <a class="code" href="InstCombineSelect_8cpp.html#add57cb1fef9cdd2cac6778e76cf9540f">SimplifyWithOpReplaced</a>(FalseVal, CmpRHS, CmpLHS, TD, TLI) == TrueVal)</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;      <span class="keywordflow">return</span> ReplaceInstUsesWith(SI, TrueVal);</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;  }</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;  <span class="comment">// NOTE: if we wanted to, this is where to detect integer MIN/MAX</span></div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;  <span class="keywordflow">if</span> (CmpRHS != CmpLHS &amp;&amp; isa&lt;Constant&gt;(CmpRHS)) {</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    <span class="keywordflow">if</span> (CmpLHS == TrueVal &amp;&amp; Pred == <a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05aa719225e2de4059f93fd3209e1f48218">ICmpInst::ICMP_EQ</a>) {</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;      <span class="comment">// Transform (X == C) ? X : Y -&gt; (X == C) ? C : Y</span></div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;      SI.<a class="code" href="classllvm_1_1User.html#a5fa9b8e1842b354f64c1ba6be0a4a17f">setOperand</a>(1, CmpRHS);</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;      Changed = <span class="keyword">true</span>;</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (CmpLHS == FalseVal &amp;&amp; Pred == <a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05ac17897ebf2f6a6986280fc3bdf28a30a">ICmpInst::ICMP_NE</a>) {</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;      <span class="comment">// Transform (X != C) ? Y : X -&gt; (X != C) ? Y : C</span></div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;      SI.<a class="code" href="classllvm_1_1User.html#a5fa9b8e1842b354f64c1ba6be0a4a17f">setOperand</a>(2, CmpRHS);</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;      Changed = <span class="keyword">true</span>;</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    }</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;  }</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *V = <a class="code" href="InstCombineSelect_8cpp.html#ac42fa1f09c238d941de002a5d3e835ef">foldSelectICmpAndOr</a>(SI, TrueVal, FalseVal, Builder))</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    <span class="keywordflow">return</span> ReplaceInstUsesWith(SI, V);</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;  <span class="keywordflow">return</span> Changed ? &amp;SI : 0;</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;}</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;<span class="comment">/// CanSelectOperandBeMappingIntoPredBlock - SI is a select whose condition is a</span></div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;<span class="comment">/// PHI node (but the two may be in different blocks).  See if the true/false</span></div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;<span class="comment">/// values (V) are live in all of the predecessor blocks of the PHI.  For</span></div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;<span class="comment">/// example, cases like this cannot be mapped:</span></div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;<span class="comment">///   X = phi [ C1, BB1], [C2, BB2]</span></div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;<span class="comment">///   Y = add</span></div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;<span class="comment">///   Z = select X, Y, 0</span></div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;<span class="comment">/// because Y is not live in BB1/BB2.</span></div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00604"></a><span class="lineno"><a class="line" href="InstCombineSelect_8cpp.html#aa44d9732ae3e717d005e9a79edf9a948">  604</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="InstCombineSelect_8cpp.html#aa44d9732ae3e717d005e9a79edf9a948">CanSelectOperandBeMappingIntoPredBlock</a>(<span class="keyword">const</span> <a class="code" href="classllvm_1_1Value.html">Value</a> *V,</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;                                                   <span class="keyword">const</span> <a class="code" href="classllvm_1_1SelectInst.html">SelectInst</a> &amp;SI) {</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;  <span class="comment">// If the value is a non-instruction value like a constant or argument, it</span></div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;  <span class="comment">// can always be mapped.</span></div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1Instruction.html">Instruction</a>&gt;(V);</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;  <span class="keywordflow">if</span> (I == 0) <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;  <span class="comment">// If V is a PHI node defined in the same block as the condition PHI, we can</span></div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;  <span class="comment">// map the arguments.</span></div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *CondPHI = cast&lt;PHINode&gt;(SI.<a class="code" href="classllvm_1_1SelectInst.html#ad285a69e32ddeee367fed93b5f392801">getCondition</a>());</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">const</span> <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *VP = dyn_cast&lt;PHINode&gt;(I))</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;    <span class="keywordflow">if</span> (VP-&gt;getParent() == CondPHI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a9cd49851904f15060edb782ef4dd1b2d">getParent</a>())</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;  <span class="comment">// Otherwise, if the PHI and select are defined in the same block and if V is</span></div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;  <span class="comment">// defined in a different block, then we can transform it.</span></div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;  <span class="keywordflow">if</span> (SI.<a class="code" href="classllvm_1_1Instruction.html#a9cd49851904f15060edb782ef4dd1b2d">getParent</a>() == CondPHI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a9cd49851904f15060edb782ef4dd1b2d">getParent</a>() &amp;&amp;</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;      I-&gt;<a class="code" href="classllvm_1_1Instruction.html#a9cd49851904f15060edb782ef4dd1b2d">getParent</a>() != CondPHI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a9cd49851904f15060edb782ef4dd1b2d">getParent</a>())</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;  <span class="comment">// Otherwise we have a &#39;hard&#39; case and we can&#39;t tell without doing more</span></div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;  <span class="comment">// detailed dominator based analysis, punt.</span></div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;}</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;<span class="comment">/// FoldSPFofSPF - We have an SPF (e.g. a min or max) of an SPF of the form:</span></div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;<span class="comment">///   SPF2(SPF1(A, B), C)</span></div><div class="line"><a name="l00632"></a><span class="lineno"><a class="line" href="classllvm_1_1InstCombiner.html#a108efa5410724e253fbb00946614de5c">  632</a></span>&#160;<span class="comment"></span><a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="classllvm_1_1InstCombiner.html#a108efa5410724e253fbb00946614de5c">InstCombiner::FoldSPFofSPF</a>(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *Inner,</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;                                        <a class="code" href="namespacellvm.html#a6bf471c1030973649c2e426afc212097">SelectPatternFlavor</a> SPF1,</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;                                        <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>, <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="Target_2ARM_2README_8txt.html#a90cca76dd78688687e0d697679dbc799">B</a>,</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;                                        <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;Outer,</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;                                        <a class="code" href="namespacellvm.html#a6bf471c1030973649c2e426afc212097">SelectPatternFlavor</a> SPF2, <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>) {</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;  <span class="keywordflow">if</span> (C == A || C == B) {</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    <span class="comment">// MAX(MAX(A, B), B) -&gt; MAX(A, B)</span></div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;    <span class="comment">// MIN(MIN(a, b), a) -&gt; MIN(a, b)</span></div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;    <span class="keywordflow">if</span> (SPF1 == SPF2)</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;      <span class="keywordflow">return</span> ReplaceInstUsesWith(Outer, Inner);</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;    <span class="comment">// MAX(MIN(a, b), a) -&gt; a</span></div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;    <span class="comment">// MIN(MAX(a, b), a) -&gt; a</span></div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    <span class="keywordflow">if</span> ((SPF1 == <a class="code" href="namespacellvm.html#a6bf471c1030973649c2e426afc212097abfed1bd97e2e6b014cbe76e02930d54b">SPF_SMIN</a> &amp;&amp; SPF2 == <a class="code" href="namespacellvm.html#a6bf471c1030973649c2e426afc212097ac8062350ff8114c3ffe79a339f2a1ece">SPF_SMAX</a>) ||</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;        (SPF1 == <a class="code" href="namespacellvm.html#a6bf471c1030973649c2e426afc212097ac8062350ff8114c3ffe79a339f2a1ece">SPF_SMAX</a> &amp;&amp; SPF2 == <a class="code" href="namespacellvm.html#a6bf471c1030973649c2e426afc212097abfed1bd97e2e6b014cbe76e02930d54b">SPF_SMIN</a>) ||</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;        (SPF1 == <a class="code" href="namespacellvm.html#a6bf471c1030973649c2e426afc212097a6afb3549f5028760be1bbf8ae7c04d73">SPF_UMIN</a> &amp;&amp; SPF2 == <a class="code" href="namespacellvm.html#a6bf471c1030973649c2e426afc212097a7d51d0dcfc2cc79738c77f8f5fa37138">SPF_UMAX</a>) ||</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;        (SPF1 == <a class="code" href="namespacellvm.html#a6bf471c1030973649c2e426afc212097a7d51d0dcfc2cc79738c77f8f5fa37138">SPF_UMAX</a> &amp;&amp; SPF2 == <a class="code" href="namespacellvm.html#a6bf471c1030973649c2e426afc212097a6afb3549f5028760be1bbf8ae7c04d73">SPF_UMIN</a>))</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;      <span class="keywordflow">return</span> ReplaceInstUsesWith(Outer, C);</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;  }</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;  <span class="comment">// TODO: MIN(MIN(A, 23), 97)</span></div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;}</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;<span class="comment">/// foldSelectICmpAnd - If one of the constants is zero (we know they can&#39;t</span></div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;<span class="comment">/// both be) and we have an icmp instruction with zero, and we have an &#39;and&#39;</span></div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;<span class="comment">/// with the non-constant value and a power of two we can turn the select</span></div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;<span class="comment">/// into a shift on the result of the &#39;and&#39;.</span></div><div class="line"><a name="l00661"></a><span class="lineno"><a class="line" href="InstCombineSelect_8cpp.html#a5ad21857b3f9989f31380cfd4a70184f">  661</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="InstCombineSelect_8cpp.html#a5ad21857b3f9989f31380cfd4a70184f">foldSelectICmpAnd</a>(<span class="keyword">const</span> <a class="code" href="classllvm_1_1SelectInst.html">SelectInst</a> &amp;SI, <a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *TrueVal,</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;                                <a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *FalseVal,</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;                                <a class="code" href="classllvm_1_1IRBuilder.html">InstCombiner::BuilderTy</a> *Builder) {</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1ICmpInst.html">ICmpInst</a> *IC = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ICmpInst.html">ICmpInst</a>&gt;(SI.<a class="code" href="classllvm_1_1SelectInst.html#ad285a69e32ddeee367fed93b5f392801">getCondition</a>());</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;  <span class="keywordflow">if</span> (!IC || !IC-&gt;<a class="code" href="classllvm_1_1ICmpInst.html#abe8988eef2e6fc2baba032cb22afedd7">isEquality</a>() || !SI.<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a6e328feb83afa5cf1c966d6704e43fc1">isIntegerTy</a>())</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">match</a>(IC-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(1), <a class="code" href="namespacellvm_1_1PatternMatch.html#ab3b5beca3a0dedd21adac813123a2ae6">m_Zero</a>()))</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;  <a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *AndRHS;</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *LHS = IC-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0);</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">match</a>(LHS, <a class="code" href="namespacellvm_1_1PatternMatch.html#a427435d4da769ae680a8e77ef89520aa">m_And</a>(<a class="code" href="namespacellvm_1_1PatternMatch.html#a24bca8838396aa81b87de8e7ac774b19">m_Value</a>(), <a class="code" href="namespacellvm_1_1PatternMatch.html#a34a92072122412c6020d4afb43725bf4">m_ConstantInt</a>(AndRHS))))</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;  <span class="comment">// If both select arms are non-zero see if we have a select of the form</span></div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;  <span class="comment">// &#39;x ? 2^n + C : C&#39;. Then we can offset both arms by C, use the logic</span></div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;  <span class="comment">// for &#39;x ? 2^n : 0&#39; and fix the thing up at the end.</span></div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;  <a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *Offset = 0;</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;  <span class="keywordflow">if</span> (!TrueVal-&gt;<a class="code" href="classllvm_1_1ConstantInt.html#ad4ea4748170f687710a54c919dde5625">isZero</a>() &amp;&amp; !FalseVal-&gt;<a class="code" href="classllvm_1_1ConstantInt.html#ad4ea4748170f687710a54c919dde5625">isZero</a>()) {</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;    <span class="keywordflow">if</span> ((TrueVal-&gt;<a class="code" href="classllvm_1_1ConstantInt.html#af8dde13a97efce293a7b04daf1e208fb">getValue</a>() - FalseVal-&gt;<a class="code" href="classllvm_1_1ConstantInt.html#af8dde13a97efce293a7b04daf1e208fb">getValue</a>()).isPowerOf2())</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;      Offset = FalseVal;</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((FalseVal-&gt;<a class="code" href="classllvm_1_1ConstantInt.html#af8dde13a97efce293a7b04daf1e208fb">getValue</a>() - TrueVal-&gt;<a class="code" href="classllvm_1_1ConstantInt.html#af8dde13a97efce293a7b04daf1e208fb">getValue</a>()).isPowerOf2())</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;      Offset = TrueVal;</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    <span class="comment">// Adjust TrueVal and FalseVal to the offset.</span></div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;    TrueVal = <a class="code" href="classllvm_1_1ConstantInt.html#a9105541412dab869e18b3cceebfff07d">ConstantInt::get</a>(Builder-&gt;<a class="code" href="classllvm_1_1IRBuilderBase.html#a66e16f68f09053c6fd906a228b5240bb">getContext</a>(),</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;                               TrueVal-&gt;<a class="code" href="classllvm_1_1ConstantInt.html#af8dde13a97efce293a7b04daf1e208fb">getValue</a>() - Offset-&gt;<a class="code" href="classllvm_1_1ConstantInt.html#af8dde13a97efce293a7b04daf1e208fb">getValue</a>());</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;    FalseVal = <a class="code" href="classllvm_1_1ConstantInt.html#a9105541412dab869e18b3cceebfff07d">ConstantInt::get</a>(Builder-&gt;<a class="code" href="classllvm_1_1IRBuilderBase.html#a66e16f68f09053c6fd906a228b5240bb">getContext</a>(),</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;                                FalseVal-&gt;getValue() - Offset-&gt;<a class="code" href="classllvm_1_1ConstantInt.html#af8dde13a97efce293a7b04daf1e208fb">getValue</a>());</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;  }</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;  <span class="comment">// Make sure the mask in the &#39;and&#39; and one of the select arms is a power of 2.</span></div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;  <span class="keywordflow">if</span> (!AndRHS-&gt;<a class="code" href="classllvm_1_1ConstantInt.html#af8dde13a97efce293a7b04daf1e208fb">getValue</a>().<a class="code" href="classllvm_1_1APInt.html#af3deb6522c4fe2043fe07af2ec90190c">isPowerOf2</a>() ||</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;      (!TrueVal-&gt;<a class="code" href="classllvm_1_1ConstantInt.html#af8dde13a97efce293a7b04daf1e208fb">getValue</a>().<a class="code" href="classllvm_1_1APInt.html#af3deb6522c4fe2043fe07af2ec90190c">isPowerOf2</a>() &amp;&amp;</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;       !FalseVal-&gt;<a class="code" href="classllvm_1_1ConstantInt.html#af8dde13a97efce293a7b04daf1e208fb">getValue</a>().<a class="code" href="classllvm_1_1APInt.html#af3deb6522c4fe2043fe07af2ec90190c">isPowerOf2</a>()))</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;  <span class="comment">// Determine which shift is needed to transform result of the &#39;and&#39; into the</span></div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;  <span class="comment">// desired result.</span></div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;  <a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *ValC = !TrueVal-&gt;<a class="code" href="classllvm_1_1ConstantInt.html#ad4ea4748170f687710a54c919dde5625">isZero</a>() ? TrueVal : FalseVal;</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;  <span class="keywordtype">unsigned</span> ValZeros = ValC-&gt;<a class="code" href="classllvm_1_1ConstantInt.html#af8dde13a97efce293a7b04daf1e208fb">getValue</a>().<a class="code" href="classllvm_1_1APInt.html#a474f562a4871689af74b0fd1ae42daa1">logBase2</a>();</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;  <span class="keywordtype">unsigned</span> AndZeros = AndRHS-&gt;<a class="code" href="classllvm_1_1ConstantInt.html#af8dde13a97efce293a7b04daf1e208fb">getValue</a>().<a class="code" href="classllvm_1_1APInt.html#a474f562a4871689af74b0fd1ae42daa1">logBase2</a>();</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;  <span class="comment">// If types don&#39;t match we can still convert the select by introducing a zext</span></div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;  <span class="comment">// or a trunc of the &#39;and&#39;. The trunc case requires that all of the truncated</span></div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;  <span class="comment">// bits are zero, we can figure that out by looking at the &#39;and&#39; mask.</span></div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;  <span class="keywordflow">if</span> (AndZeros &gt;= ValC-&gt;<a class="code" href="classllvm_1_1ConstantInt.html#a58f423c78837f9854278b6026b34714a">getBitWidth</a>())</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *V = Builder-&gt;<a class="code" href="classllvm_1_1IRBuilder.html#a7cca116ba5ef3fe3dfc9872b1600d11d">CreateZExtOrTrunc</a>(LHS, SI.<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>());</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;  <span class="keywordflow">if</span> (ValZeros &gt; AndZeros)</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;    V = Builder-&gt;<a class="code" href="classllvm_1_1IRBuilder.html#a4d49fd9a4cc4f2a74d4555bd08b13910">CreateShl</a>(V, ValZeros - AndZeros);</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ValZeros &lt; AndZeros)</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;    V = Builder-&gt;<a class="code" href="classllvm_1_1IRBuilder.html#a3f8c45ea10c393433221a508b750dcd5">CreateLShr</a>(V, AndZeros - ValZeros);</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;  <span class="comment">// Okay, now we know that everything is set up, we just don&#39;t know whether we</span></div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;  <span class="comment">// have a icmp_ne or icmp_eq and whether the true or false val is the zero.</span></div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;  <span class="keywordtype">bool</span> ShouldNotVal = !TrueVal-&gt;<a class="code" href="classllvm_1_1ConstantInt.html#ad4ea4748170f687710a54c919dde5625">isZero</a>();</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;  ShouldNotVal ^= IC-&gt;<a class="code" href="classllvm_1_1CmpInst.html#a8afd4995fae596b2c86eeed85b3d388b">getPredicate</a>() == <a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05ac17897ebf2f6a6986280fc3bdf28a30a">ICmpInst::ICMP_NE</a>;</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;  <span class="keywordflow">if</span> (ShouldNotVal)</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;    V = Builder-&gt;<a class="code" href="classllvm_1_1IRBuilder.html#a9b057429c5a047d0ee274074b6885acf">CreateXor</a>(V, ValC);</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;  <span class="comment">// Apply an offset if needed.</span></div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;  <span class="keywordflow">if</span> (Offset)</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    V = Builder-&gt;<a class="code" href="classllvm_1_1IRBuilder.html#a112f87f5844b5d94c07940f3d47f1e99">CreateAdd</a>(V, Offset);</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;  <span class="keywordflow">return</span> V;</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;}</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;</div><div class="line"><a name="l00732"></a><span class="lineno"><a class="line" href="classllvm_1_1InstCombiner.html#a51d306d70ed9cc82558a236d978545f4">  732</a></span>&#160;<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="classllvm_1_1InstCombiner.html#a51d306d70ed9cc82558a236d978545f4">InstCombiner::visitSelectInst</a>(<a class="code" href="classllvm_1_1SelectInst.html">SelectInst</a> &amp;SI) {</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *CondVal = SI.<a class="code" href="classllvm_1_1SelectInst.html#ad285a69e32ddeee367fed93b5f392801">getCondition</a>();</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *TrueVal = SI.<a class="code" href="classllvm_1_1SelectInst.html#a67bf091383cd61e1225445e78b61d9f9">getTrueValue</a>();</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *FalseVal = SI.<a class="code" href="classllvm_1_1SelectInst.html#a29a16f32075ee4f23cd769701463952c">getFalseValue</a>();</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *V = <a class="code" href="namespacellvm.html#ab5ee1b3d80978be1bf429bb2f15d4954">SimplifySelectInst</a>(CondVal, TrueVal, FalseVal, TD))</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;    <span class="keywordflow">return</span> ReplaceInstUsesWith(SI, V);</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;  <span class="keywordflow">if</span> (SI.<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a6e328feb83afa5cf1c966d6704e43fc1">isIntegerTy</a>(1)) {</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = dyn_cast&lt;ConstantInt&gt;(TrueVal)) {</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>-&gt;getZExtValue()) {</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;        <span class="comment">// Change: A = select B, true, C --&gt; A = or B, C</span></div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;        <span class="keywordflow">return</span> BinaryOperator::CreateOr(CondVal, FalseVal);</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;      }</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;      <span class="comment">// Change: A = select B, false, C --&gt; A = and !B, C</span></div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *NotCond = Builder-&gt;CreateNot(CondVal, <span class="stringliteral">&quot;not.&quot;</span>+CondVal-&gt;<a class="code" href="classllvm_1_1Value.html#ad452febc1ac0b394876e640ec03ffa38">getName</a>());</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;      <span class="keywordflow">return</span> BinaryOperator::CreateAnd(NotCond, FalseVal);</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;    }</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = dyn_cast&lt;ConstantInt&gt;(FalseVal)) {</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>-&gt;getZExtValue() == <span class="keyword">false</span>) {</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;        <span class="comment">// Change: A = select B, C, false --&gt; A = and B, C</span></div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;        <span class="keywordflow">return</span> BinaryOperator::CreateAnd(CondVal, TrueVal);</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;      }</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;      <span class="comment">// Change: A = select B, C, true --&gt; A = or !B, C</span></div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *NotCond = Builder-&gt;CreateNot(CondVal, <span class="stringliteral">&quot;not.&quot;</span>+CondVal-&gt;<a class="code" href="classllvm_1_1Value.html#ad452febc1ac0b394876e640ec03ffa38">getName</a>());</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;      <span class="keywordflow">return</span> BinaryOperator::CreateOr(NotCond, TrueVal);</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;    }</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;    <span class="comment">// select a, b, a  -&gt; a&amp;b</span></div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;    <span class="comment">// select a, a, b  -&gt; a|b</span></div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;    <span class="keywordflow">if</span> (CondVal == TrueVal)</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;      <span class="keywordflow">return</span> BinaryOperator::CreateOr(CondVal, FalseVal);</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;    <span class="keywordflow">if</span> (CondVal == FalseVal)</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;      <span class="keywordflow">return</span> BinaryOperator::CreateAnd(CondVal, TrueVal);</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;    <span class="comment">// select a, ~a, b -&gt; (~a)&amp;b</span></div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;    <span class="comment">// select a, b, ~a -&gt; (~a)|b</span></div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">match</a>(TrueVal, <a class="code" href="namespacellvm_1_1PatternMatch.html#a4cfd328368353696e64a4d1b15a7cbfa">m_Not</a>(<a class="code" href="namespacellvm_1_1PatternMatch.html#a2d9861feadd3a09792967a012559e7b2">m_Specific</a>(CondVal))))</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;      <span class="keywordflow">return</span> BinaryOperator::CreateAnd(TrueVal, FalseVal);</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">match</a>(FalseVal, <a class="code" href="namespacellvm_1_1PatternMatch.html#a4cfd328368353696e64a4d1b15a7cbfa">m_Not</a>(<a class="code" href="namespacellvm_1_1PatternMatch.html#a2d9861feadd3a09792967a012559e7b2">m_Specific</a>(CondVal))))</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;      <span class="keywordflow">return</span> BinaryOperator::CreateOr(TrueVal, FalseVal);</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;  }</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;  <span class="comment">// Selecting between two integer constants?</span></div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *TrueValC = dyn_cast&lt;ConstantInt&gt;(TrueVal))</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *FalseValC = dyn_cast&lt;ConstantInt&gt;(FalseVal)) {</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;      <span class="comment">// select C, 1, 0 -&gt; zext C to int</span></div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;      <span class="keywordflow">if</span> (FalseValC-&gt;isZero() &amp;&amp; TrueValC-&gt;getValue() == 1)</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="classllvm_1_1ZExtInst.html">ZExtInst</a>(CondVal, SI.<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>());</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;      <span class="comment">// select C, -1, 0 -&gt; sext C to int</span></div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;      <span class="keywordflow">if</span> (FalseValC-&gt;isZero() &amp;&amp; TrueValC-&gt;isAllOnesValue())</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="classllvm_1_1SExtInst.html">SExtInst</a>(CondVal, SI.<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>());</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;      <span class="comment">// select C, 0, 1 -&gt; zext !C to int</span></div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;      <span class="keywordflow">if</span> (TrueValC-&gt;isZero() &amp;&amp; FalseValC-&gt;getValue() == 1) {</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;        <a class="code" href="classllvm_1_1Value.html">Value</a> *NotCond = Builder-&gt;CreateNot(CondVal, <span class="stringliteral">&quot;not.&quot;</span>+CondVal-&gt;<a class="code" href="classllvm_1_1Value.html#ad452febc1ac0b394876e640ec03ffa38">getName</a>());</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="classllvm_1_1ZExtInst.html">ZExtInst</a>(NotCond, SI.<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>());</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;      }</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;      <span class="comment">// select C, 0, -1 -&gt; sext !C to int</span></div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;      <span class="keywordflow">if</span> (TrueValC-&gt;isZero() &amp;&amp; FalseValC-&gt;isAllOnesValue()) {</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;        <a class="code" href="classllvm_1_1Value.html">Value</a> *NotCond = Builder-&gt;CreateNot(CondVal, <span class="stringliteral">&quot;not.&quot;</span>+CondVal-&gt;<a class="code" href="classllvm_1_1Value.html#ad452febc1ac0b394876e640ec03ffa38">getName</a>());</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="classllvm_1_1SExtInst.html">SExtInst</a>(NotCond, SI.<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>());</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;      }</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *V = <a class="code" href="InstCombineSelect_8cpp.html#a5ad21857b3f9989f31380cfd4a70184f">foldSelectICmpAnd</a>(SI, TrueValC, FalseValC, Builder))</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;        <span class="keywordflow">return</span> ReplaceInstUsesWith(SI, V);</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;    }</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;  <span class="comment">// See if we are selecting two values based on a comparison of the two values.</span></div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1FCmpInst.html">FCmpInst</a> *FCI = dyn_cast&lt;FCmpInst&gt;(CondVal)) {</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;    <span class="keywordflow">if</span> (FCI-&gt;getOperand(0) == TrueVal &amp;&amp; FCI-&gt;getOperand(1) == FalseVal) {</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;      <span class="comment">// Transform (X == Y) ? X : Y  -&gt; Y</span></div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;      <span class="keywordflow">if</span> (FCI-&gt;getPredicate() == <a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05a024db78a5ed74f64666f3ca4955e6eca">FCmpInst::FCMP_OEQ</a>) {</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;        <span class="comment">// This is not safe in general for floating point:</span></div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;        <span class="comment">// consider X== -0, Y== +0.</span></div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;        <span class="comment">// It becomes safe if either operand is a nonzero constant.</span></div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;        <a class="code" href="classllvm_1_1ConstantFP.html">ConstantFP</a> *CFPt, *CFPf;</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;        <span class="keywordflow">if</span> (((CFPt = dyn_cast&lt;ConstantFP&gt;(TrueVal)) &amp;&amp;</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;              !CFPt-&gt;<a class="code" href="classllvm_1_1ConstantFP.html#a0f839f7633a4709c1d89e128f49b3d43">getValueAPF</a>().<a class="code" href="classllvm_1_1APFloat.html#a30b29f2be19eb73f6225de032a1fafb3">isZero</a>()) ||</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;            ((CFPf = dyn_cast&lt;ConstantFP&gt;(FalseVal)) &amp;&amp;</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;             !CFPf-&gt;<a class="code" href="classllvm_1_1ConstantFP.html#a0f839f7633a4709c1d89e128f49b3d43">getValueAPF</a>().<a class="code" href="classllvm_1_1APFloat.html#a30b29f2be19eb73f6225de032a1fafb3">isZero</a>()))</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;        <span class="keywordflow">return</span> ReplaceInstUsesWith(SI, FalseVal);</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;      }</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;      <span class="comment">// Transform (X une Y) ? X : Y  -&gt; X</span></div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;      <span class="keywordflow">if</span> (FCI-&gt;getPredicate() == <a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05ad601460c9371d0f0ada5ae006bdba2bd">FCmpInst::FCMP_UNE</a>) {</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;        <span class="comment">// This is not safe in general for floating point:</span></div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;        <span class="comment">// consider X== -0, Y== +0.</span></div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;        <span class="comment">// It becomes safe if either operand is a nonzero constant.</span></div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;        <a class="code" href="classllvm_1_1ConstantFP.html">ConstantFP</a> *CFPt, *CFPf;</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;        <span class="keywordflow">if</span> (((CFPt = dyn_cast&lt;ConstantFP&gt;(TrueVal)) &amp;&amp;</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;              !CFPt-&gt;<a class="code" href="classllvm_1_1ConstantFP.html#a0f839f7633a4709c1d89e128f49b3d43">getValueAPF</a>().<a class="code" href="classllvm_1_1APFloat.html#a30b29f2be19eb73f6225de032a1fafb3">isZero</a>()) ||</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;            ((CFPf = dyn_cast&lt;ConstantFP&gt;(FalseVal)) &amp;&amp;</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;             !CFPf-&gt;<a class="code" href="classllvm_1_1ConstantFP.html#a0f839f7633a4709c1d89e128f49b3d43">getValueAPF</a>().<a class="code" href="classllvm_1_1APFloat.html#a30b29f2be19eb73f6225de032a1fafb3">isZero</a>()))</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;        <span class="keywordflow">return</span> ReplaceInstUsesWith(SI, TrueVal);</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;      }</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;      <span class="comment">// NOTE: if we wanted to, this is where to detect MIN/MAX</span></div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (FCI-&gt;getOperand(0) == FalseVal &amp;&amp; FCI-&gt;getOperand(1) == TrueVal){</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;      <span class="comment">// Transform (X == Y) ? Y : X  -&gt; X</span></div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;      <span class="keywordflow">if</span> (FCI-&gt;getPredicate() == <a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05a024db78a5ed74f64666f3ca4955e6eca">FCmpInst::FCMP_OEQ</a>) {</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;        <span class="comment">// This is not safe in general for floating point:</span></div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;        <span class="comment">// consider X== -0, Y== +0.</span></div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;        <span class="comment">// It becomes safe if either operand is a nonzero constant.</span></div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;        <a class="code" href="classllvm_1_1ConstantFP.html">ConstantFP</a> *CFPt, *CFPf;</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;        <span class="keywordflow">if</span> (((CFPt = dyn_cast&lt;ConstantFP&gt;(TrueVal)) &amp;&amp;</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;              !CFPt-&gt;<a class="code" href="classllvm_1_1ConstantFP.html#a0f839f7633a4709c1d89e128f49b3d43">getValueAPF</a>().<a class="code" href="classllvm_1_1APFloat.html#a30b29f2be19eb73f6225de032a1fafb3">isZero</a>()) ||</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;            ((CFPf = dyn_cast&lt;ConstantFP&gt;(FalseVal)) &amp;&amp;</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;             !CFPf-&gt;<a class="code" href="classllvm_1_1ConstantFP.html#a0f839f7633a4709c1d89e128f49b3d43">getValueAPF</a>().<a class="code" href="classllvm_1_1APFloat.html#a30b29f2be19eb73f6225de032a1fafb3">isZero</a>()))</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;          <span class="keywordflow">return</span> ReplaceInstUsesWith(SI, FalseVal);</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;      }</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;      <span class="comment">// Transform (X une Y) ? Y : X  -&gt; Y</span></div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;      <span class="keywordflow">if</span> (FCI-&gt;getPredicate() == <a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05ad601460c9371d0f0ada5ae006bdba2bd">FCmpInst::FCMP_UNE</a>) {</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;        <span class="comment">// This is not safe in general for floating point:</span></div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;        <span class="comment">// consider X== -0, Y== +0.</span></div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;        <span class="comment">// It becomes safe if either operand is a nonzero constant.</span></div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;        <a class="code" href="classllvm_1_1ConstantFP.html">ConstantFP</a> *CFPt, *CFPf;</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;        <span class="keywordflow">if</span> (((CFPt = dyn_cast&lt;ConstantFP&gt;(TrueVal)) &amp;&amp;</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;              !CFPt-&gt;<a class="code" href="classllvm_1_1ConstantFP.html#a0f839f7633a4709c1d89e128f49b3d43">getValueAPF</a>().<a class="code" href="classllvm_1_1APFloat.html#a30b29f2be19eb73f6225de032a1fafb3">isZero</a>()) ||</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;            ((CFPf = dyn_cast&lt;ConstantFP&gt;(FalseVal)) &amp;&amp;</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;             !CFPf-&gt;<a class="code" href="classllvm_1_1ConstantFP.html#a0f839f7633a4709c1d89e128f49b3d43">getValueAPF</a>().<a class="code" href="classllvm_1_1APFloat.html#a30b29f2be19eb73f6225de032a1fafb3">isZero</a>()))</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;          <span class="keywordflow">return</span> ReplaceInstUsesWith(SI, TrueVal);</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;      }</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;      <span class="comment">// NOTE: if we wanted to, this is where to detect MIN/MAX</span></div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;    }</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;    <span class="comment">// NOTE: if we wanted to, this is where to detect ABS</span></div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;  }</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;  <span class="comment">// See if we are selecting two values based on a comparison of the two values.</span></div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1ICmpInst.html">ICmpInst</a> *ICI = dyn_cast&lt;ICmpInst&gt;(CondVal))</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *Result = visitSelectInstWithICmp(SI, ICI))</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;      <span class="keywordflow">return</span> Result;</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *TI = dyn_cast&lt;Instruction&gt;(TrueVal))</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *FI = dyn_cast&lt;Instruction&gt;(FalseVal))</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;      <span class="keywordflow">if</span> (TI-&gt;hasOneUse() &amp;&amp; FI-&gt;hasOneUse()) {</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;        <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *AddOp = 0, *SubOp = 0;</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;        <span class="comment">// Turn (select C, (op X, Y), (op X, Z)) -&gt; (op X, (select C, Y, Z))</span></div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;        <span class="keywordflow">if</span> (TI-&gt;getOpcode() == FI-&gt;getOpcode())</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *IV = FoldSelectOpOp(SI, TI, FI))</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;            <span class="keywordflow">return</span> IV;</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;        <span class="comment">// Turn select C, (X+Y), (X-Y) --&gt; (X+(select C, Y, (-Y))).  This is</span></div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;        <span class="comment">// even legal for FP.</span></div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;        <span class="keywordflow">if</span> ((TI-&gt;getOpcode() == Instruction::Sub &amp;&amp;</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;             FI-&gt;getOpcode() == Instruction::Add) ||</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;            (TI-&gt;getOpcode() == Instruction::FSub &amp;&amp;</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;             FI-&gt;getOpcode() == Instruction::FAdd)) {</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;          AddOp = FI; SubOp = TI;</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((FI-&gt;getOpcode() == Instruction::Sub &amp;&amp;</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;                    TI-&gt;getOpcode() == Instruction::Add) ||</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;                   (FI-&gt;getOpcode() == Instruction::FSub &amp;&amp;</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;                    TI-&gt;getOpcode() == Instruction::FAdd)) {</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;          AddOp = TI; SubOp = FI;</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;        }</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;        <span class="keywordflow">if</span> (AddOp) {</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;          <a class="code" href="classllvm_1_1Value.html">Value</a> *OtherAddOp = 0;</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;          <span class="keywordflow">if</span> (SubOp-&gt;getOperand(0) == AddOp-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0)) {</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;            OtherAddOp = AddOp-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(1);</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;          } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (SubOp-&gt;getOperand(0) == AddOp-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(1)) {</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;            OtherAddOp = AddOp-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0);</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;          }</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;          <span class="keywordflow">if</span> (OtherAddOp) {</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;            <span class="comment">// So at this point we know we have (Y -&gt; OtherAddOp):</span></div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;            <span class="comment">//        select C, (add X, Y), (sub X, Z)</span></div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;            <a class="code" href="classllvm_1_1Value.html">Value</a> *NegVal;  <span class="comment">// Compute -Z</span></div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;            <span class="keywordflow">if</span> (SI.<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a35a540d6e55bff813e9b195ebdb3da9f">isFPOrFPVectorTy</a>()) {</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;              NegVal = Builder-&gt;CreateFNeg(SubOp-&gt;getOperand(1));</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;              NegVal = Builder-&gt;CreateNeg(SubOp-&gt;getOperand(1));</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;            }</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;            <a class="code" href="classllvm_1_1Value.html">Value</a> *NewTrueOp = OtherAddOp;</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;            <a class="code" href="classllvm_1_1Value.html">Value</a> *NewFalseOp = NegVal;</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;            <span class="keywordflow">if</span> (AddOp != TI)</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;              <a class="code" href="namespacestd.html#ab8424022895aee3e366fb9a32f2883cb">std::swap</a>(NewTrueOp, NewFalseOp);</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;            <a class="code" href="classllvm_1_1Value.html">Value</a> *NewSel =</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;              Builder-&gt;CreateSelect(CondVal, NewTrueOp,</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;                                    NewFalseOp, SI.<a class="code" href="classllvm_1_1Value.html#ad452febc1ac0b394876e640ec03ffa38">getName</a>() + <span class="stringliteral">&quot;.p&quot;</span>);</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;            <span class="keywordflow">if</span> (SI.<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a35a540d6e55bff813e9b195ebdb3da9f">isFPOrFPVectorTy</a>())</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;              <span class="keywordflow">return</span> BinaryOperator::CreateFAdd(SubOp-&gt;getOperand(0), NewSel);</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;              <span class="keywordflow">return</span> BinaryOperator::CreateAdd(SubOp-&gt;getOperand(0), NewSel);</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;          }</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;        }</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;      }</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;  <span class="comment">// See if we can fold the select into one of our operands.</span></div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;  <span class="keywordflow">if</span> (SI.<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a6e328feb83afa5cf1c966d6704e43fc1">isIntegerTy</a>()) {</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *FoldI = FoldSelectIntoOp(SI, TrueVal, FalseVal))</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;      <span class="keywordflow">return</span> FoldI;</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;    <span class="comment">// MAX(MAX(a, b), a) -&gt; MAX(a, b)</span></div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;    <span class="comment">// MIN(MIN(a, b), a) -&gt; MIN(a, b)</span></div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;    <span class="comment">// MAX(MIN(a, b), a) -&gt; a</span></div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;    <span class="comment">// MIN(MAX(a, b), a) -&gt; a</span></div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *LHS, *RHS, *LHS2, *RHS2;</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#a6bf471c1030973649c2e426afc212097">SelectPatternFlavor</a> SPF = <a class="code" href="InstCombineSelect_8cpp.html#adf9a8f7fa74378ffb19874970d772398">MatchSelectPattern</a>(&amp;SI, LHS, RHS)) {</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#a6bf471c1030973649c2e426afc212097">SelectPatternFlavor</a> SPF2 = <a class="code" href="InstCombineSelect_8cpp.html#adf9a8f7fa74378ffb19874970d772398">MatchSelectPattern</a>(LHS, LHS2, RHS2))</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *R = FoldSPFofSPF(cast&lt;Instruction&gt;(LHS),SPF2,LHS2,RHS2,</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;                                          SI, SPF, RHS))</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;          <span class="keywordflow">return</span> R;</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#a6bf471c1030973649c2e426afc212097">SelectPatternFlavor</a> SPF2 = <a class="code" href="InstCombineSelect_8cpp.html#adf9a8f7fa74378ffb19874970d772398">MatchSelectPattern</a>(RHS, LHS2, RHS2))</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *R = FoldSPFofSPF(cast&lt;Instruction&gt;(RHS),SPF2,LHS2,RHS2,</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;                                          SI, SPF, LHS))</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;          <span class="keywordflow">return</span> R;</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;    }</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;    <span class="comment">// TODO.</span></div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;    <span class="comment">// ABS(-X) -&gt; ABS(X)</span></div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;    <span class="comment">// ABS(ABS(X)) -&gt; ABS(X)</span></div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;  }</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;  <span class="comment">// See if we can fold the select into a phi node if the condition is a select.</span></div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;  <span class="keywordflow">if</span> (isa&lt;PHINode&gt;(SI.<a class="code" href="classllvm_1_1SelectInst.html#ad285a69e32ddeee367fed93b5f392801">getCondition</a>()))</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;    <span class="comment">// The true/false values have to be live in the PHI predecessor&#39;s blocks.</span></div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="InstCombineSelect_8cpp.html#aa44d9732ae3e717d005e9a79edf9a948">CanSelectOperandBeMappingIntoPredBlock</a>(TrueVal, SI) &amp;&amp;</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;        <a class="code" href="InstCombineSelect_8cpp.html#aa44d9732ae3e717d005e9a79edf9a948">CanSelectOperandBeMappingIntoPredBlock</a>(FalseVal, SI))</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="namespacellvm_1_1A64CC.html#af5804bc0518be9568f73db566e4d6f46a2a6c4724226f9ccea96d35fd4c131af8">NV</a> = FoldOpIntoPhi(SI))</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1A64CC.html#af5804bc0518be9568f73db566e4d6f46a2a6c4724226f9ccea96d35fd4c131af8">NV</a>;</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1SelectInst.html">SelectInst</a> *TrueSI = dyn_cast&lt;SelectInst&gt;(TrueVal)) {</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;    <span class="keywordflow">if</span> (TrueSI-&gt;getCondition() == CondVal) {</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;      <span class="keywordflow">if</span> (SI.<a class="code" href="classllvm_1_1SelectInst.html#a67bf091383cd61e1225445e78b61d9f9">getTrueValue</a>() == TrueSI-&gt;getTrueValue())</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;        <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;      SI.<a class="code" href="classllvm_1_1User.html#a5fa9b8e1842b354f64c1ba6be0a4a17f">setOperand</a>(1, TrueSI-&gt;getTrueValue());</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;      <span class="keywordflow">return</span> &amp;SI;</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;    }</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;  }</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1SelectInst.html">SelectInst</a> *FalseSI = dyn_cast&lt;SelectInst&gt;(FalseVal)) {</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;    <span class="keywordflow">if</span> (FalseSI-&gt;getCondition() == CondVal) {</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;      <span class="keywordflow">if</span> (SI.<a class="code" href="classllvm_1_1SelectInst.html#a29a16f32075ee4f23cd769701463952c">getFalseValue</a>() == FalseSI-&gt;getFalseValue())</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;        <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;      SI.<a class="code" href="classllvm_1_1User.html#a5fa9b8e1842b354f64c1ba6be0a4a17f">setOperand</a>(2, FalseSI-&gt;getFalseValue());</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;      <span class="keywordflow">return</span> &amp;SI;</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;    }</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;  }</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1BinaryOperator.html#a454128b3938d8b6c6305e9c74204cc53">BinaryOperator::isNot</a>(CondVal)) {</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;    SI.<a class="code" href="classllvm_1_1User.html#a5fa9b8e1842b354f64c1ba6be0a4a17f">setOperand</a>(0, <a class="code" href="classllvm_1_1BinaryOperator.html#a57781e19c89adc7ec1a5da6d156aced0">BinaryOperator::getNotArgument</a>(CondVal));</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;    SI.<a class="code" href="classllvm_1_1User.html#a5fa9b8e1842b354f64c1ba6be0a4a17f">setOperand</a>(1, FalseVal);</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;    SI.<a class="code" href="classllvm_1_1User.html#a5fa9b8e1842b354f64c1ba6be0a4a17f">setOperand</a>(2, TrueVal);</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;    <span class="keywordflow">return</span> &amp;SI;</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;  }</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1VectorType.html">VectorType</a>* VecTy = dyn_cast&lt;VectorType&gt;(SI.<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>())) {</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;    <span class="keywordtype">unsigned</span> VWidth = VecTy-&gt;getNumElements();</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;    <a class="code" href="classllvm_1_1APInt.html">APInt</a> UndefElts(VWidth, 0);</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;    <a class="code" href="classllvm_1_1APInt.html">APInt</a> AllOnesEltMask(<a class="code" href="classllvm_1_1APInt.html#a539bdb4fdbf46e0bfcefebf5ac6d21dd">APInt::getAllOnesValue</a>(VWidth));</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *V = SimplifyDemandedVectorElts(&amp;SI, AllOnesEltMask, UndefElts)) {</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;      <span class="keywordflow">if</span> (V != &amp;SI)</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;        <span class="keywordflow">return</span> ReplaceInstUsesWith(SI, V);</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;      <span class="keywordflow">return</span> &amp;SI;</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;    }</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;    <span class="keywordflow">if</span> (isa&lt;ConstantAggregateZero&gt;(CondVal)) {</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;      <span class="keywordflow">return</span> ReplaceInstUsesWith(SI, FalseVal);</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;    }</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;  }</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;}</div><div class="ttc" id="classllvm_1_1IRBuilder_html_a3f8c45ea10c393433221a508b750dcd5"><div class="ttname"><a href="classllvm_1_1IRBuilder.html#a3f8c45ea10c393433221a508b750dcd5">llvm::IRBuilder::CreateLShr</a></div><div class="ttdeci">Value * CreateLShr(Value *LHS, Value *RHS, const Twine &amp;Name=&quot;&quot;, bool isExact=false)</div><div class="ttdef"><b>Definition:</b> <a href="IRBuilder_8h_source.html#l00753">IRBuilder.h:753</a></div></div>
<div class="ttc" id="namespacellvm_1_1PatternMatch_html_a427435d4da769ae680a8e77ef89520aa"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#a427435d4da769ae680a8e77ef89520aa">llvm::PatternMatch::m_And</a></div><div class="ttdeci">BinaryOp_match&lt; LHS, RHS, Instruction::And &gt; m_And(const LHS &amp;L, const RHS &amp;R)</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l00467">PatternMatch.h:467</a></div></div>
<div class="ttc" id="classllvm_1_1SmallVectorTemplateCommon_html_a22a311dfe4c28a897de8a9365a4f0a84"><div class="ttname"><a href="classllvm_1_1SmallVectorTemplateCommon.html#a22a311dfe4c28a897de8a9365a4f0a84">llvm::SmallVectorTemplateCommon&lt; T &gt;::size</a></div><div class="ttdeci">size_type size() const</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00127">SmallVector.h:127</a></div></div>
<div class="ttc" id="classllvm_1_1SmallVectorTemplateBase_html_ae1a10b90f22c0478960fb5798ff73916"><div class="ttname"><a href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">llvm::SmallVectorTemplateBase&lt; T, isPodLike&lt; T &gt;::value &gt;::push_back</a></div><div class="ttdeci">void push_back(const T &amp;Elt)</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00236">SmallVector.h:236</a></div></div>
<div class="ttc" id="classllvm_1_1DataLayout_html"><div class="ttname"><a href="classllvm_1_1DataLayout.html">llvm::DataLayout</a></div><div class="ttdef"><b>Definition:</b> <a href="DataLayout_8h_source.html#l00098">DataLayout.h:98</a></div></div>
<div class="ttc" id="namespacellvm_1_1PatternMatch_html_a24bca8838396aa81b87de8e7ac774b19"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#a24bca8838396aa81b87de8e7ac774b19">llvm::PatternMatch::m_Value</a></div><div class="ttdeci">class_match&lt; Value &gt; m_Value()</div><div class="ttdoc">m_Value() - Match an arbitrary value and ignore it. </div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l00070">PatternMatch.h:70</a></div></div>
<div class="ttc" id="classllvm_1_1CmpInst_html"><div class="ttname"><a href="classllvm_1_1CmpInst.html">llvm::CmpInst</a></div><div class="ttdoc">Abstract base class of comparison instructions. </div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00633">InstrTypes.h:633</a></div></div>
<div class="ttc" id="namespacellvm_1_1ARM__PROC_html_aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5"><div class="ttname"><a href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">llvm::ARM_PROC::A</a></div><div class="ttdef"><b>Definition:</b> <a href="ARMBaseInfo_8h_source.html#l00098">ARMBaseInfo.h:98</a></div></div>
<div class="ttc" id="classllvm_1_1APInt_html_a539bdb4fdbf46e0bfcefebf5ac6d21dd"><div class="ttname"><a href="classllvm_1_1APInt.html#a539bdb4fdbf46e0bfcefebf5ac6d21dd">llvm::APInt::getAllOnesValue</a></div><div class="ttdeci">static APInt getAllOnesValue(unsigned numBits)</div><div class="ttdoc">Get the all-ones value. </div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l00450">APInt.h:450</a></div></div>
<div class="ttc" id="namespacellvm_html_a6bf471c1030973649c2e426afc212097ac8062350ff8114c3ffe79a339f2a1ece"><div class="ttname"><a href="namespacellvm.html#a6bf471c1030973649c2e426afc212097ac8062350ff8114c3ffe79a339f2a1ece">llvm::SPF_SMAX</a></div><div class="ttdef"><b>Definition:</b> <a href="InstCombine_8h_source.html#l00036">InstCombine.h:36</a></div></div>
<div class="ttc" id="namespacellvm_html"><div class="ttname"><a href="namespacellvm.html">llvm</a></div><div class="ttdoc">List of target independent CodeGen pass IDs. </div><div class="ttdef"><b>Definition:</b> <a href="APFloat_8h_source.html#l00022">APFloat.h:22</a></div></div>
<div class="ttc" id="classllvm_1_1Type_html_ad979b3c1bc975ee23810e3018ffe951b"><div class="ttname"><a href="classllvm_1_1Type.html#ad979b3c1bc975ee23810e3018ffe951b">llvm::Type::getScalarSizeInBits</a></div><div class="ttdeci">unsigned getScalarSizeInBits()</div><div class="ttdef"><b>Definition:</b> <a href="Type_8cpp_source.html#l00135">Type.cpp:135</a></div></div>
<div class="ttc" id="namespacellvm_1_1PatternMatch_html_ab3b5beca3a0dedd21adac813123a2ae6"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#ab3b5beca3a0dedd21adac813123a2ae6">llvm::PatternMatch::m_Zero</a></div><div class="ttdeci">match_zero m_Zero()</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l00137">PatternMatch.h:137</a></div></div>
<div class="ttc" id="InstCombine_8h_html"><div class="ttname"><a href="InstCombine_8h.html">InstCombine.h</a></div></div>
<div class="ttc" id="namespacellvm_html_a3f2f98c2a67c9e79f58aad9150a62e42"><div class="ttname"><a href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">llvm::dyn_cast</a></div><div class="ttdeci">enable_if_c&lt;!is_simple_type&lt; Y &gt;::value, typename cast_retty&lt; X, const Y &gt;::ret_type &gt;::type dyn_cast(const Y &amp;Val)</div><div class="ttdef"><b>Definition:</b> <a href="Casting_8h_source.html#l00266">Casting.h:266</a></div></div>
<div class="ttc" id="classllvm_1_1ConstantInt_html_a58f423c78837f9854278b6026b34714a"><div class="ttname"><a href="classllvm_1_1ConstantInt.html#a58f423c78837f9854278b6026b34714a">llvm::ConstantInt::getBitWidth</a></div><div class="ttdeci">unsigned getBitWidth() const </div><div class="ttdoc">getBitWidth - Return the bitwidth of this constant. </div><div class="ttdef"><b>Definition:</b> <a href="Constants_8h_source.html#l00110">Constants.h:110</a></div></div>
<div class="ttc" id="classllvm_1_1ZExtInst_html"><div class="ttname"><a href="classllvm_1_1ZExtInst.html">llvm::ZExtInst</a></div><div class="ttdoc">This class represents zero extension of integer types. </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l03211">Instructions.h:3211</a></div></div>
<div class="ttc" id="classllvm_1_1User_html_a2f81e0c1fc6554df7ad2eafabf5fc5a5"><div class="ttname"><a href="classllvm_1_1User.html#a2f81e0c1fc6554df7ad2eafabf5fc5a5">llvm::User::getNumOperands</a></div><div class="ttdeci">unsigned getNumOperands() const </div><div class="ttdef"><b>Definition:</b> <a href="User_8h_source.html#l00108">User.h:108</a></div></div>
<div class="ttc" id="InstCombineSelect_8cpp_html_a63f86caeedd50d73f6d31bb5340804a9"><div class="ttname"><a href="InstCombineSelect_8cpp.html#a63f86caeedd50d73f6d31bb5340804a9">GetSelectFoldableConstant</a></div><div class="ttdeci">static Constant * GetSelectFoldableConstant(Instruction *I)</div><div class="ttdef"><b>Definition:</b> <a href="InstCombineSelect_8cpp_source.html#l00104">InstCombineSelect.cpp:104</a></div></div>
<div class="ttc" id="classllvm_1_1PHINode_html"><div class="ttname"><a href="classllvm_1_1PHINode.html">llvm::PHINode</a></div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l01978">Instructions.h:1978</a></div></div>
<div class="ttc" id="classllvm_1_1CmpInst_html_a283f9a5d4d843d20c40bb4d3e364bb05ad92f160316221fd4090520bb2b3cefc5"><div class="ttname"><a href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05ad92f160316221fd4090520bb2b3cefc5">llvm::CmpInst::ICMP_ULE</a></div><div class="ttdoc">unsigned less or equal </div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00677">InstrTypes.h:677</a></div></div>
<div class="ttc" id="classllvm_1_1CmpInst_html_a283f9a5d4d843d20c40bb4d3e364bb05a91d86a4753c8bd7624e01bf565d87f8e"><div class="ttname"><a href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05a91d86a4753c8bd7624e01bf565d87f8e">llvm::CmpInst::ICMP_ULT</a></div><div class="ttdoc">unsigned less than </div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00676">InstrTypes.h:676</a></div></div>
<div class="ttc" id="classllvm_1_1CmpInst_html_a283f9a5d4d843d20c40bb4d3e364bb05ad601460c9371d0f0ada5ae006bdba2bd"><div class="ttname"><a href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05ad601460c9371d0f0ada5ae006bdba2bd">llvm::CmpInst::FCMP_UNE</a></div><div class="ttdoc">1 1 1 0 True if unordered or not equal </div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00667">InstrTypes.h:667</a></div></div>
<div class="ttc" id="classllvm_1_1ICmpInst_html_abe8988eef2e6fc2baba032cb22afedd7"><div class="ttname"><a href="classllvm_1_1ICmpInst.html#abe8988eef2e6fc2baba032cb22afedd7">llvm::ICmpInst::isEquality</a></div><div class="ttdeci">static bool isEquality(Predicate P)</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00997">Instructions.h:997</a></div></div>
<div class="ttc" id="classllvm_1_1SExtInst_html"><div class="ttname"><a href="classllvm_1_1SExtInst.html">llvm::SExtInst</a></div><div class="ttdoc">This class represents a sign extension of integer types. </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l03247">Instructions.h:3247</a></div></div>
<div class="ttc" id="classllvm_1_1LoadInst_html"><div class="ttname"><a href="classllvm_1_1LoadInst.html">llvm::LoadInst</a></div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00136">Instructions.h:136</a></div></div>
<div class="ttc" id="InstructionSimplify_8h_html"><div class="ttname"><a href="InstructionSimplify_8h.html">InstructionSimplify.h</a></div></div>
<div class="ttc" id="classllvm_1_1IntegerType_html_a6f603ab84f6f7c79985036f58cca9d48"><div class="ttname"><a href="classllvm_1_1IntegerType.html#a6f603ab84f6f7c79985036f58cca9d48">llvm::IntegerType::getBitWidth</a></div><div class="ttdeci">unsigned getBitWidth() const </div><div class="ttdoc">Get the number of bits in this IntegerType. </div><div class="ttdef"><b>Definition:</b> <a href="DerivedTypes_8h_source.html#l00061">DerivedTypes.h:61</a></div></div>
<div class="ttc" id="namespacellvm_html_a6bf471c1030973649c2e426afc212097a7d51d0dcfc2cc79738c77f8f5fa37138"><div class="ttname"><a href="namespacellvm.html#a6bf471c1030973649c2e426afc212097a7d51d0dcfc2cc79738c77f8f5fa37138">llvm::SPF_UMAX</a></div><div class="ttdef"><b>Definition:</b> <a href="InstCombine_8h_source.html#l00036">InstCombine.h:36</a></div></div>
<div class="ttc" id="classllvm_1_1Constant_html_aa6574d526b3e38a28f688a7bb4325c2c"><div class="ttname"><a href="classllvm_1_1Constant.html#aa6574d526b3e38a28f688a7bb4325c2c">llvm::Constant::getNullValue</a></div><div class="ttdeci">static Constant * getNullValue(Type *Ty)</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l00111">Constants.cpp:111</a></div></div>
<div class="ttc" id="classllvm_1_1Value_html_ad452febc1ac0b394876e640ec03ffa38"><div class="ttname"><a href="classllvm_1_1Value.html#ad452febc1ac0b394876e640ec03ffa38">llvm::Value::getName</a></div><div class="ttdeci">StringRef getName() const </div><div class="ttdef"><b>Definition:</b> <a href="Value_8cpp_source.html#l00167">Value.cpp:167</a></div></div>
<div class="ttc" id="classllvm_1_1Instruction_html_a0cb60bdee4006424b8fd957f2c38b11b"><div class="ttname"><a href="classllvm_1_1Instruction.html#a0cb60bdee4006424b8fd957f2c38b11b">llvm::Instruction::isCast</a></div><div class="ttdeci">bool isCast() const </div><div class="ttdef"><b>Definition:</b> <a href="Instruction_8h_source.html#l00089">Instruction.h:89</a></div></div>
<div class="ttc" id="namespacellvm_1_1PatternMatch_html_a25d956d9e0beadd47ce4bc255dfa811d"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">llvm::PatternMatch::match</a></div><div class="ttdeci">bool match(Val *V, const Pattern &amp;P)</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l00042">PatternMatch.h:42</a></div></div>
<div class="ttc" id="classllvm_1_1IRBuilder_html_a9b057429c5a047d0ee274074b6885acf"><div class="ttname"><a href="classllvm_1_1IRBuilder.html#a9b057429c5a047d0ee274074b6885acf">llvm::IRBuilder::CreateXor</a></div><div class="ttdeci">Value * CreateXor(Value *LHS, Value *RHS, const Twine &amp;Name=&quot;&quot;)</div><div class="ttdef"><b>Definition:</b> <a href="IRBuilder_8h_source.html#l00821">IRBuilder.h:821</a></div></div>
<div class="ttc" id="classllvm_1_1SelectInst_html"><div class="ttname"><a href="classllvm_1_1SelectInst.html">llvm::SelectInst</a></div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l01430">Instructions.h:1430</a></div></div>
<div class="ttc" id="classllvm_1_1InstCombiner_html_a51d306d70ed9cc82558a236d978545f4"><div class="ttname"><a href="classllvm_1_1InstCombiner.html#a51d306d70ed9cc82558a236d978545f4">llvm::InstCombiner::visitSelectInst</a></div><div class="ttdeci">Instruction * visitSelectInst(SelectInst &amp;SI)</div><div class="ttdef"><b>Definition:</b> <a href="InstCombineSelect_8cpp_source.html#l00732">InstCombineSelect.cpp:732</a></div></div>
<div class="ttc" id="classllvm_1_1ConstantInt_html_af8dde13a97efce293a7b04daf1e208fb"><div class="ttname"><a href="classllvm_1_1ConstantInt.html#af8dde13a97efce293a7b04daf1e208fb">llvm::ConstantInt::getValue</a></div><div class="ttdeci">const APInt &amp; getValue() const </div><div class="ttdoc">Return the constant&amp;#39;s value. </div><div class="ttdef"><b>Definition:</b> <a href="Constants_8h_source.html#l00105">Constants.h:105</a></div></div>
<div class="ttc" id="classllvm_1_1CmpInst_html_a283f9a5d4d843d20c40bb4d3e364bb05ac17897ebf2f6a6986280fc3bdf28a30a"><div class="ttname"><a href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05ac17897ebf2f6a6986280fc3bdf28a30a">llvm::CmpInst::ICMP_NE</a></div><div class="ttdoc">not equal </div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00673">InstrTypes.h:673</a></div></div>
<div class="ttc" id="ErrorHandling_8h_html_ace243f5c25697a1107cce46626b3dc94"><div class="ttname"><a href="ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a></div><div class="ttdeci">#define llvm_unreachable(msg)</div><div class="ttdef"><b>Definition:</b> <a href="ErrorHandling_8h_source.html#l00103">ErrorHandling.h:103</a></div></div>
<div class="ttc" id="namespacellvm_html_a6bf471c1030973649c2e426afc212097aee3dafa9fac8f6fa1e1110ef463cc452"><div class="ttname"><a href="namespacellvm.html#a6bf471c1030973649c2e426afc212097aee3dafa9fac8f6fa1e1110ef463cc452">llvm::SPF_UNKNOWN</a></div><div class="ttdef"><b>Definition:</b> <a href="InstCombine_8h_source.html#l00034">InstCombine.h:34</a></div></div>
<div class="ttc" id="classllvm_1_1IRBuilder_html"><div class="ttname"><a href="classllvm_1_1IRBuilder.html">llvm::IRBuilder</a></div><div class="ttdoc">This provides a uniform API for creating instructions and inserting them into a basic block: either a...</div><div class="ttdef"><b>Definition:</b> <a href="IRBuilder_8h_source.html#l00421">IRBuilder.h:421</a></div></div>
<div class="ttc" id="InstCombineSelect_8cpp_html_a5ad21857b3f9989f31380cfd4a70184f"><div class="ttname"><a href="InstCombineSelect_8cpp.html#a5ad21857b3f9989f31380cfd4a70184f">foldSelectICmpAnd</a></div><div class="ttdeci">static Value * foldSelectICmpAnd(const SelectInst &amp;SI, ConstantInt *TrueVal, ConstantInt *FalseVal, InstCombiner::BuilderTy *Builder)</div><div class="ttdef"><b>Definition:</b> <a href="InstCombineSelect_8cpp_source.html#l00661">InstCombineSelect.cpp:661</a></div></div>
<div class="ttc" id="classllvm_1_1Instruction_html_afa0b2fa29ba074f2b6ec9ac11163f2d9"><div class="ttname"><a href="classllvm_1_1Instruction.html#afa0b2fa29ba074f2b6ec9ac11163f2d9">llvm::Instruction::CastOps</a></div><div class="ttdeci">CastOps</div><div class="ttdef"><b>Definition:</b> <a href="Instruction_8h_source.html#l00401">Instruction.h:401</a></div></div>
<div class="ttc" id="classllvm_1_1Instruction_html"><div class="ttname"><a href="classllvm_1_1Instruction.html">llvm::Instruction</a></div><div class="ttdef"><b>Definition:</b> <a href="Instruction_8h_source.html#l00031">Instruction.h:31</a></div></div>
<div class="ttc" id="namespacellvm_1_1PatternMatch_html_a4cfd328368353696e64a4d1b15a7cbfa"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#a4cfd328368353696e64a4d1b15a7cbfa">llvm::PatternMatch::m_Not</a></div><div class="ttdeci">not_match&lt; LHS &gt; m_Not(const LHS &amp;L)</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l00738">PatternMatch.h:738</a></div></div>
<div class="ttc" id="InstCombineSelect_8cpp_html_add57cb1fef9cdd2cac6778e76cf9540f"><div class="ttname"><a href="InstCombineSelect_8cpp.html#add57cb1fef9cdd2cac6778e76cf9540f">SimplifyWithOpReplaced</a></div><div class="ttdeci">static Value * SimplifyWithOpReplaced(Value *V, Value *Op, Value *RepOp, const DataLayout *TD, const TargetLibraryInfo *TLI)</div><div class="ttdef"><b>Definition:</b> <a href="InstCombineSelect_8cpp_source.html#l00290">InstCombineSelect.cpp:290</a></div></div>
<div class="ttc" id="classllvm_1_1IRBuilder_html_a8f55dd4237be6778517ddd752ca8b76a"><div class="ttname"><a href="classllvm_1_1IRBuilder.html#a8f55dd4237be6778517ddd752ca8b76a">llvm::IRBuilder::CreateOr</a></div><div class="ttdeci">Value * CreateOr(Value *LHS, Value *RHS, const Twine &amp;Name=&quot;&quot;)</div><div class="ttdef"><b>Definition:</b> <a href="IRBuilder_8h_source.html#l00805">IRBuilder.h:805</a></div></div>
<div class="ttc" id="namespacellvm_1_1PatternMatch_html_a2cbdca7c8267aac6914d674f8e81841b"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#a2cbdca7c8267aac6914d674f8e81841b">llvm::PatternMatch::m_ZExt</a></div><div class="ttdeci">CastClass_match&lt; OpTy, Instruction::ZExt &gt; m_ZExt(const OpTy &amp;Op)</div><div class="ttdoc">m_ZExt </div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l00692">PatternMatch.h:692</a></div></div>
<div class="ttc" id="classllvm_1_1FCmpInst_html"><div class="ttname"><a href="classllvm_1_1FCmpInst.html">llvm::FCmpInst</a></div><div class="ttdoc">Represents a floating point comparison operator. </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l01055">Instructions.h:1055</a></div></div>
<div class="ttc" id="namespacellvm_1_1PatternMatch_html_a34a92072122412c6020d4afb43725bf4"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#a34a92072122412c6020d4afb43725bf4">llvm::PatternMatch::m_ConstantInt</a></div><div class="ttdeci">class_match&lt; ConstantInt &gt; m_ConstantInt()</div><div class="ttdoc">m_ConstantInt() - Match an arbitrary ConstantInt and ignore it. </div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l00072">PatternMatch.h:72</a></div></div>
<div class="ttc" id="namespacellvm_1_1PatternMatch_html_ad5e60756e331a97669d11b5c9d8691a2"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#ad5e60756e331a97669d11b5c9d8691a2">llvm::PatternMatch::m_Power2</a></div><div class="ttdeci">cst_pred_ty&lt; is_power2 &gt; m_Power2()</div><div class="ttdoc">m_Power2() - Match an integer or vector power of 2. </div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l00281">PatternMatch.h:281</a></div></div>
<div class="ttc" id="classllvm_1_1Value_html_ae855357b6c5e6e7ed1869272708a3a84"><div class="ttname"><a href="classllvm_1_1Value.html#ae855357b6c5e6e7ed1869272708a3a84">llvm::Value::takeName</a></div><div class="ttdeci">void takeName(Value *V)</div><div class="ttdef"><b>Definition:</b> <a href="Value_8cpp_source.html#l00239">Value.cpp:239</a></div></div>
<div class="ttc" id="classllvm_1_1BinaryOperator_html_a57781e19c89adc7ec1a5da6d156aced0"><div class="ttname"><a href="classllvm_1_1BinaryOperator.html#a57781e19c89adc7ec1a5da6d156aced0">llvm::BinaryOperator::getNotArgument</a></div><div class="ttdeci">static const Value * getNotArgument(const Value *BinOp)</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8cpp_source.html#l01980">Instructions.cpp:1980</a></div></div>
<div class="ttc" id="namespacellvm_html_a6bf471c1030973649c2e426afc212097abfed1bd97e2e6b014cbe76e02930d54b"><div class="ttname"><a href="namespacellvm.html#a6bf471c1030973649c2e426afc212097abfed1bd97e2e6b014cbe76e02930d54b">llvm::SPF_SMIN</a></div><div class="ttdef"><b>Definition:</b> <a href="InstCombine_8h_source.html#l00035">InstCombine.h:35</a></div></div>
<div class="ttc" id="classllvm_1_1CastInst_html_a0f7dea9550778374905e12da6d6ba8a8"><div class="ttname"><a href="classllvm_1_1CastInst.html#a0f7dea9550778374905e12da6d6ba8a8">llvm::CastInst::Create</a></div><div class="ttdeci">static CastInst * Create(Instruction::CastOps, Value *S, Type *Ty, const Twine &amp;Name=&quot;&quot;, Instruction *InsertBefore=0)</div><div class="ttdoc">Construct any of the CastInst subclasses. </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8cpp_source.html#l02350">Instructions.cpp:2350</a></div></div>
<div class="ttc" id="README__ALTIVEC_8txt_html_a9aacd9146afe44bf656cd664e2a88c8c"><div class="ttname"><a href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a></div><div class="ttdeci">(vector float) vec_cmpeq(*A,*B) C</div><div class="ttdef"><b>Definition:</b> <a href="README__ALTIVEC_8txt_source.html#l00091">README_ALTIVEC.txt:91</a></div></div>
<div class="ttc" id="classllvm_1_1Type_html"><div class="ttname"><a href="classllvm_1_1Type.html">llvm::Type</a></div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00044">Type.h:44</a></div></div>
<div class="ttc" id="namespacellvm_1_1PatternMatch_html_a42569041ddafba7d40243e126af07f42"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#a42569041ddafba7d40243e126af07f42">llvm::PatternMatch::m_Or</a></div><div class="ttdeci">BinaryOp_match&lt; LHS, RHS, Instruction::Or &gt; m_Or(const LHS &amp;L, const RHS &amp;R)</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l00473">PatternMatch.h:473</a></div></div>
<div class="ttc" id="classllvm_1_1Type_html_a6f725580f7834e2ca90762965866dad4"><div class="ttname"><a href="classllvm_1_1Type.html#a6f725580f7834e2ca90762965866dad4">llvm::Type::isVectorTy</a></div><div class="ttdeci">bool isVectorTy() const </div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00229">Type.h:229</a></div></div>
<div class="ttc" id="classllvm_1_1IRBuilder_html_a112f87f5844b5d94c07940f3d47f1e99"><div class="ttname"><a href="classllvm_1_1IRBuilder.html#a112f87f5844b5d94c07940f3d47f1e99">llvm::IRBuilder::CreateAdd</a></div><div class="ttdeci">Value * CreateAdd(Value *LHS, Value *RHS, const Twine &amp;Name=&quot;&quot;, bool HasNUW=false, bool HasNSW=false)</div><div class="ttdef"><b>Definition:</b> <a href="IRBuilder_8h_source.html#l00615">IRBuilder.h:615</a></div></div>
<div class="ttc" id="classllvm_1_1Constant_html"><div class="ttname"><a href="classllvm_1_1Constant.html">llvm::Constant</a></div><div class="ttdoc">LLVM Constant Representation. </div><div class="ttdef"><b>Definition:</b> <a href="Constant_8h_source.html#l00041">Constant.h:41</a></div></div>
<div class="ttc" id="classllvm_1_1SelectInst_html_ad285a69e32ddeee367fed93b5f392801"><div class="ttname"><a href="classllvm_1_1SelectInst.html#ad285a69e32ddeee367fed93b5f392801">llvm::SelectInst::getCondition</a></div><div class="ttdeci">const Value * getCondition() const </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l01466">Instructions.h:1466</a></div></div>
<div class="ttc" id="namespacellvm_1_1APIntOps_html_a22f056804d2b9882f74adc905872bc39"><div class="ttname"><a href="namespacellvm_1_1APIntOps.html#a22f056804d2b9882f74adc905872bc39">llvm::APIntOps::Or</a></div><div class="ttdeci">APInt Or(const APInt &amp;LHS, const APInt &amp;RHS)</div><div class="ttdoc">Bitwise OR function for APInt. </div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l01845">APInt.h:1845</a></div></div>
<div class="ttc" id="classllvm_1_1ConstantFP_html"><div class="ttname"><a href="classllvm_1_1ConstantFP.html">llvm::ConstantFP</a></div><div class="ttdef"><b>Definition:</b> <a href="Constants_8h_source.html#l00232">Constants.h:232</a></div></div>
<div class="ttc" id="namespacellvm_1_1APIntOps_html_afc7c4d88d09cba0c5e920f8a3a3ace55"><div class="ttname"><a href="namespacellvm_1_1APIntOps.html#afc7c4d88d09cba0c5e920f8a3a3ace55">llvm::APIntOps::Xor</a></div><div class="ttdeci">APInt Xor(const APInt &amp;LHS, const APInt &amp;RHS)</div><div class="ttdoc">Bitwise XOR function for APInt. </div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l01850">APInt.h:1850</a></div></div>
<div class="ttc" id="namespacellvm_1_1PatternMatch_html_a2d9861feadd3a09792967a012559e7b2"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#a2d9861feadd3a09792967a012559e7b2">llvm::PatternMatch::m_Specific</a></div><div class="ttdeci">specificval_ty m_Specific(const Value *V)</div><div class="ttdoc">m_Specific - Match if we have a specific specified value. </div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l00323">PatternMatch.h:323</a></div></div>
<div class="ttc" id="classllvm_1_1ICmpInst_html"><div class="ttname"><a href="classllvm_1_1ICmpInst.html">llvm::ICmpInst</a></div><div class="ttdoc">Represent an integer comparison operator. </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00911">Instructions.h:911</a></div></div>
<div class="ttc" id="classllvm_1_1CmpInst_html_a283f9a5d4d843d20c40bb4d3e364bb05"><div class="ttname"><a href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05">llvm::CmpInst::Predicate</a></div><div class="ttdeci">Predicate</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00651">InstrTypes.h:651</a></div></div>
<div class="ttc" id="classllvm_1_1InstCombiner_html_a056dec8cb050799ce28ff561df7a10c8"><div class="ttname"><a href="classllvm_1_1InstCombiner.html#a056dec8cb050799ce28ff561df7a10c8">llvm::InstCombiner::FoldSelectIntoOp</a></div><div class="ttdeci">Instruction * FoldSelectIntoOp(SelectInst &amp;SI, Value *, Value *)</div><div class="ttdef"><b>Definition:</b> <a href="InstCombineSelect_8cpp_source.html#l00211">InstCombineSelect.cpp:211</a></div></div>
<div class="ttc" id="classllvm_1_1User_html_a997ff6a1758bf732b9b263fc61011644"><div class="ttname"><a href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">llvm::User::getOperand</a></div><div class="ttdeci">Value * getOperand(unsigned i) const </div><div class="ttdef"><b>Definition:</b> <a href="User_8h_source.html#l00088">User.h:88</a></div></div>
<div class="ttc" id="classllvm_1_1Instruction_html_a1c2048f254df730c4de1643ec791ddf9"><div class="ttname"><a href="classllvm_1_1Instruction.html#a1c2048f254df730c4de1643ec791ddf9">llvm::Instruction::isCommutative</a></div><div class="ttdeci">bool isCommutative() const </div><div class="ttdef"><b>Definition:</b> <a href="Instruction_8h_source.html#l00269">Instruction.h:269</a></div></div>
<div class="ttc" id="classllvm_1_1BinaryOperator_html_a454128b3938d8b6c6305e9c74204cc53"><div class="ttname"><a href="classllvm_1_1BinaryOperator.html#a454128b3938d8b6c6305e9c74204cc53">llvm::BinaryOperator::isNot</a></div><div class="ttdeci">static bool isNot(const Value *V)</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8cpp_source.html#l01945">Instructions.cpp:1945</a></div></div>
<div class="ttc" id="InstCombineSelect_8cpp_html_ac42fa1f09c238d941de002a5d3e835ef"><div class="ttname"><a href="InstCombineSelect_8cpp.html#ac42fa1f09c238d941de002a5d3e835ef">foldSelectICmpAndOr</a></div><div class="ttdeci">static Value * foldSelectICmpAndOr(const SelectInst &amp;SI, Value *TrueVal, Value *FalseVal, InstCombiner::BuilderTy *Builder)</div><div class="ttdef"><b>Definition:</b> <a href="InstCombineSelect_8cpp_source.html#l00366">InstCombineSelect.cpp:366</a></div></div>
<div class="ttc" id="namespacellvm_html_aa61b351a455e9229d3dc58e0883b6cef"><div class="ttname"><a href="namespacellvm.html#aa61b351a455e9229d3dc58e0883b6cef">llvm::ConstantFoldCompareInstOperands</a></div><div class="ttdeci">Constant * ConstantFoldCompareInstOperands(unsigned Predicate, Constant *LHS, Constant *RHS, const DataLayout *TD=0, const TargetLibraryInfo *TLI=0)</div><div class="ttdef"><b>Definition:</b> <a href="ConstantFolding_8cpp_source.html#l01053">ConstantFolding.cpp:1053</a></div></div>
<div class="ttc" id="classllvm_1_1IntegerType_html"><div class="ttname"><a href="classllvm_1_1IntegerType.html">llvm::IntegerType</a></div><div class="ttdoc">Integer representation type. </div><div class="ttdef"><b>Definition:</b> <a href="DerivedTypes_8h_source.html#l00037">DerivedTypes.h:37</a></div></div>
<div class="ttc" id="classllvm_1_1CmpInst_html_a8afd4995fae596b2c86eeed85b3d388b"><div class="ttname"><a href="classllvm_1_1CmpInst.html#a8afd4995fae596b2c86eeed85b3d388b">llvm::CmpInst::getPredicate</a></div><div class="ttdeci">Predicate getPredicate() const </div><div class="ttdoc">Return the predicate for this instruction. </div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00714">InstrTypes.h:714</a></div></div>
<div class="ttc" id="classllvm_1_1InstCombiner_html_a4f28a80b49223e037dfd0f89dd83cb1a"><div class="ttname"><a href="classllvm_1_1InstCombiner.html#a4f28a80b49223e037dfd0f89dd83cb1a">llvm::InstCombiner::FoldSelectOpOp</a></div><div class="ttdeci">Instruction * FoldSelectOpOp(SelectInst &amp;SI, Instruction *TI, Instruction *FI)</div><div class="ttdef"><b>Definition:</b> <a href="InstCombineSelect_8cpp_source.html#l00124">InstCombineSelect.cpp:124</a></div></div>
<div class="ttc" id="namespacellvm_html_acf81840e57f5d7beb1d5983f4dac772f"><div class="ttname"><a href="namespacellvm.html#acf81840e57f5d7beb1d5983f4dac772f">llvm::ConstantFoldLoadFromConstPtr</a></div><div class="ttdeci">Constant * ConstantFoldLoadFromConstPtr(Constant *C, const DataLayout *TD=0)</div><div class="ttdef"><b>Definition:</b> <a href="ConstantFolding_8cpp_source.html#l00472">ConstantFolding.cpp:472</a></div></div>
<div class="ttc" id="classllvm_1_1Constant_html_a4d51384de6e1798bb6aa875aebeea9f0"><div class="ttname"><a href="classllvm_1_1Constant.html#a4d51384de6e1798bb6aa875aebeea9f0">llvm::Constant::getAllOnesValue</a></div><div class="ttdeci">static Constant * getAllOnesValue(Type *Ty)</div><div class="ttdoc">Get the all ones value. </div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l00163">Constants.cpp:163</a></div></div>
<div class="ttc" id="classllvm_1_1IRBuilderBase_html_a66e16f68f09053c6fd906a228b5240bb"><div class="ttname"><a href="classllvm_1_1IRBuilderBase.html#a66e16f68f09053c6fd906a228b5240bb">llvm::IRBuilderBase::getContext</a></div><div class="ttdeci">LLVMContext &amp; getContext() const </div><div class="ttdef"><b>Definition:</b> <a href="IRBuilder_8h_source.html#l00079">IRBuilder.h:79</a></div></div>
<div class="ttc" id="classllvm_1_1Type_html_a35a540d6e55bff813e9b195ebdb3da9f"><div class="ttname"><a href="classllvm_1_1Type.html#a35a540d6e55bff813e9b195ebdb3da9f">llvm::Type::isFPOrFPVectorTy</a></div><div class="ttdeci">bool isFPOrFPVectorTy() const </div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00186">Type.h:186</a></div></div>
<div class="ttc" id="classllvm_1_1BinaryOperator_html_a07783e6f39803037259a1ebe376c2b1e"><div class="ttname"><a href="classllvm_1_1BinaryOperator.html#a07783e6f39803037259a1ebe376c2b1e">llvm::BinaryOperator::hasNoSignedWrap</a></div><div class="ttdeci">bool hasNoSignedWrap() const </div><div class="ttdoc">hasNoSignedWrap - Determine whether the no signed wrap flag is set. </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8cpp_source.html#l02013">Instructions.cpp:2013</a></div></div>
<div class="ttc" id="classllvm_1_1SelectInst_html_a67bf091383cd61e1225445e78b61d9f9"><div class="ttname"><a href="classllvm_1_1SelectInst.html#a67bf091383cd61e1225445e78b61d9f9">llvm::SelectInst::getTrueValue</a></div><div class="ttdeci">const Value * getTrueValue() const </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l01467">Instructions.h:1467</a></div></div>
<div class="ttc" id="classllvm_1_1APInt_html_af3deb6522c4fe2043fe07af2ec90190c"><div class="ttname"><a href="classllvm_1_1APInt.html#af3deb6522c4fe2043fe07af2ec90190c">llvm::APInt::isPowerOf2</a></div><div class="ttdeci">bool isPowerOf2() const </div><div class="ttdoc">Check if this APInt&amp;#39;s value is a power of two greater than zero. </div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l00390">APInt.h:390</a></div></div>
<div class="ttc" id="namespacellvm_html_a9a0b7acac205af164daef4017f9d193d"><div class="ttname"><a href="namespacellvm.html#a9a0b7acac205af164daef4017f9d193d">llvm::SimplifyBinOp</a></div><div class="ttdeci">Value * SimplifyBinOp(unsigned Opcode, Value *LHS, Value *RHS, const DataLayout *TD=0, const TargetLibraryInfo *TLI=0, const DominatorTree *DT=0)</div><div class="ttdef"><b>Definition:</b> <a href="InstructionSimplify_8cpp_source.html#l02929">InstructionSimplify.cpp:2929</a></div></div>
<div class="ttc" id="classllvm_1_1CmpInst_html_a283f9a5d4d843d20c40bb4d3e364bb05a720a42e85f7e981afd61e28473b0000a"><div class="ttname"><a href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05a720a42e85f7e981afd61e28473b0000a">llvm::CmpInst::ICMP_SGT</a></div><div class="ttdoc">signed greater than </div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00678">InstrTypes.h:678</a></div></div>
<div class="ttc" id="classllvm_1_1BinaryOperator_html_aac502d7d65e2996cf6b819b14e17499c"><div class="ttname"><a href="classllvm_1_1BinaryOperator.html#aac502d7d65e2996cf6b819b14e17499c">llvm::BinaryOperator::setIsExact</a></div><div class="ttdeci">void setIsExact(bool b=true)</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8cpp_source.html#l02005">Instructions.cpp:2005</a></div></div>
<div class="ttc" id="namespacellvm_1_1PatternMatch_html_aaab494a433fbb23bc68393ee8bcfc5ac"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#aaab494a433fbb23bc68393ee8bcfc5ac">llvm::PatternMatch::m_SExt</a></div><div class="ttdeci">CastClass_match&lt; OpTy, Instruction::SExt &gt; m_SExt(const OpTy &amp;Op)</div><div class="ttdoc">m_SExt </div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l00685">PatternMatch.h:685</a></div></div>
<div class="ttc" id="classllvm_1_1BinaryOperator_html_a88505baf41407782678a5df1702d2d31"><div class="ttname"><a href="classllvm_1_1BinaryOperator.html#a88505baf41407782678a5df1702d2d31">llvm::BinaryOperator::getOpcode</a></div><div class="ttdeci">BinaryOps getOpcode() const </div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00326">InstrTypes.h:326</a></div></div>
<div class="ttc" id="InstCombineSelect_8cpp_html_adf9a8f7fa74378ffb19874970d772398"><div class="ttname"><a href="InstCombineSelect_8cpp.html#adf9a8f7fa74378ffb19874970d772398">MatchSelectPattern</a></div><div class="ttdeci">static SelectPatternFlavor MatchSelectPattern(Value *V, Value *&amp;LHS, Value *&amp;RHS)</div><div class="ttdef"><b>Definition:</b> <a href="InstCombineSelect_8cpp_source.html#l00025">InstCombineSelect.cpp:25</a></div></div>
<div class="ttc" id="classllvm_1_1ConstantInt_html"><div class="ttname"><a href="classllvm_1_1ConstantInt.html">llvm::ConstantInt</a></div><div class="ttdoc">Class for constant integers. </div><div class="ttdef"><b>Definition:</b> <a href="Constants_8h_source.html#l00051">Constants.h:51</a></div></div>
<div class="ttc" id="classllvm_1_1Type_html_ad8f27f0b94a56abcd296b8461737a3af"><div class="ttname"><a href="classllvm_1_1Type.html#ad8f27f0b94a56abcd296b8461737a3af">llvm::Type::getVectorNumElements</a></div><div class="ttdeci">unsigned getVectorNumElements() const </div><div class="ttdef"><b>Definition:</b> <a href="Type_8cpp_source.html#l00214">Type.cpp:214</a></div></div>
<div class="ttc" id="Target_2README_8txt_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">i</div><div class="ttdef"><b>Definition:</b> <a href="Target_2README_8txt_source.html#l00029">Target/README.txt:29</a></div></div>
<div class="ttc" id="Target_2README_8txt_html_a2a2df5a25b9c703e74e82b48a75d0c3d"><div class="ttname"><a href="Target_2README_8txt.html#a2a2df5a25b9c703e74e82b48a75d0c3d">C1</a></div><div class="ttdeci">instcombine should handle this C2 when C1</div><div class="ttdef"><b>Definition:</b> <a href="Target_2README_8txt_source.html#l00300">Target/README.txt:300</a></div></div>
<div class="ttc" id="classllvm_1_1APInt_html_a474f562a4871689af74b0fd1ae42daa1"><div class="ttname"><a href="classllvm_1_1APInt.html#a474f562a4871689af74b0fd1ae42daa1">llvm::APInt::logBase2</a></div><div class="ttdeci">unsigned logBase2() const </div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l01500">APInt.h:1500</a></div></div>
<div class="ttc" id="classllvm_1_1SmallVector_html"><div class="ttname"><a href="classllvm_1_1SmallVector.html">llvm::SmallVector</a></div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00880">SmallVector.h:880</a></div></div>
<div class="ttc" id="classllvm_1_1Value_html_a0cf3748dba54f931bb1241ae4adc76bc"><div class="ttname"><a href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">llvm::Value::getType</a></div><div class="ttdeci">Type * getType() const </div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00111">Value.h:111</a></div></div>
<div class="ttc" id="namespacellvm_html_a6bf471c1030973649c2e426afc212097"><div class="ttname"><a href="namespacellvm.html#a6bf471c1030973649c2e426afc212097">llvm::SelectPatternFlavor</a></div><div class="ttdeci">SelectPatternFlavor</div><div class="ttdef"><b>Definition:</b> <a href="InstCombine_8h_source.html#l00033">InstCombine.h:33</a></div></div>
<div class="ttc" id="classllvm_1_1TargetLibraryInfo_html"><div class="ttname"><a href="classllvm_1_1TargetLibraryInfo.html">llvm::TargetLibraryInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="TargetLibraryInfo_8h_source.html#l00657">TargetLibraryInfo.h:657</a></div></div>
<div class="ttc" id="classllvm_1_1BinaryOperator_html"><div class="ttname"><a href="classllvm_1_1BinaryOperator.html">llvm::BinaryOperator</a></div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00138">InstrTypes.h:138</a></div></div>
<div class="ttc" id="classllvm_1_1CmpInst_html_a283f9a5d4d843d20c40bb4d3e364bb05a15ae464950ac676919c2f0c7aafc706c"><div class="ttname"><a href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05a15ae464950ac676919c2f0c7aafc706c">llvm::CmpInst::ICMP_SLT</a></div><div class="ttdoc">signed less than </div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00680">InstrTypes.h:680</a></div></div>
<div class="ttc" id="classllvm_1_1CmpInst_html_ab5d3f9900a0284e85ee7a1520a4eeb60"><div class="ttname"><a href="classllvm_1_1CmpInst.html#ab5d3f9900a0284e85ee7a1520a4eeb60">llvm::CmpInst::getSwappedPredicate</a></div><div class="ttdeci">Predicate getSwappedPredicate() const </div><div class="ttdoc">Return the predicate as if the operands were swapped. </div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00753">InstrTypes.h:753</a></div></div>
<div class="ttc" id="classllvm_1_1ConstantInt_html_a9105541412dab869e18b3cceebfff07d"><div class="ttname"><a href="classllvm_1_1ConstantInt.html#a9105541412dab869e18b3cceebfff07d">llvm::ConstantInt::get</a></div><div class="ttdeci">static Constant * get(Type *Ty, uint64_t V, bool isSigned=false)</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l00492">Constants.cpp:492</a></div></div>
<div class="ttc" id="classllvm_1_1ConstantInt_html_ad4ea4748170f687710a54c919dde5625"><div class="ttname"><a href="classllvm_1_1ConstantInt.html#ad4ea4748170f687710a54c919dde5625">llvm::ConstantInt::isZero</a></div><div class="ttdeci">bool isZero() const </div><div class="ttdef"><b>Definition:</b> <a href="Constants_8h_source.html#l00160">Constants.h:160</a></div></div>
<div class="ttc" id="namespacellvm_html_a842dbe70b763270b02de0473c3cc890d"><div class="ttname"><a href="namespacellvm.html#a842dbe70b763270b02de0473c3cc890d">llvm::SimplifyCmpInst</a></div><div class="ttdeci">Value * SimplifyCmpInst(unsigned Predicate, Value *LHS, Value *RHS, const DataLayout *TD=0, const TargetLibraryInfo *TLI=0, const DominatorTree *DT=0)</div><div class="ttdef"><b>Definition:</b> <a href="InstructionSimplify_8cpp_source.html#l02944">InstructionSimplify.cpp:2944</a></div></div>
<div class="ttc" id="classllvm_1_1BinaryOperator_html_a0f67e7208255f5088f0d515185109174"><div class="ttname"><a href="classllvm_1_1BinaryOperator.html#a0f67e7208255f5088f0d515185109174">llvm::BinaryOperator::isExact</a></div><div class="ttdeci">bool isExact() const </div><div class="ttdoc">isExact - Determine whether the exact flag is set. </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8cpp_source.html#l02017">Instructions.cpp:2017</a></div></div>
<div class="ttc" id="classllvm_1_1CmpInst_html_a126a12b67fa620ad28ec0c919ca7a3e8"><div class="ttname"><a href="classllvm_1_1CmpInst.html#a126a12b67fa620ad28ec0c919ca7a3e8">llvm::CmpInst::setPredicate</a></div><div class="ttdeci">void setPredicate(Predicate P)</div><div class="ttdoc">Set the predicate for this instruction to the specified value. </div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00719">InstrTypes.h:719</a></div></div>
<div class="ttc" id="classllvm_1_1User_html_a5fa9b8e1842b354f64c1ba6be0a4a17f"><div class="ttname"><a href="classllvm_1_1User.html#a5fa9b8e1842b354f64c1ba6be0a4a17f">llvm::User::setOperand</a></div><div class="ttdeci">void setOperand(unsigned i, Value *Val)</div><div class="ttdef"><b>Definition:</b> <a href="User_8h_source.html#l00092">User.h:92</a></div></div>
<div class="ttc" id="classllvm_1_1Constant_html_ac8ddb745480a7e75a3862ddf0be3a298"><div class="ttname"><a href="classllvm_1_1Constant.html#ac8ddb745480a7e75a3862ddf0be3a298">llvm::Constant::isAllOnesValue</a></div><div class="ttdeci">bool isAllOnesValue() const </div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l00088">Constants.cpp:88</a></div></div>
<div class="ttc" id="classllvm_1_1InstCombiner_html_a108efa5410724e253fbb00946614de5c"><div class="ttname"><a href="classllvm_1_1InstCombiner.html#a108efa5410724e253fbb00946614de5c">llvm::InstCombiner::FoldSPFofSPF</a></div><div class="ttdeci">Instruction * FoldSPFofSPF(Instruction *Inner, SelectPatternFlavor SPF1, Value *A, Value *B, Instruction &amp;Outer, SelectPatternFlavor SPF2, Value *C)</div><div class="ttdef"><b>Definition:</b> <a href="InstCombineSelect_8cpp_source.html#l00632">InstCombineSelect.cpp:632</a></div></div>
<div class="ttc" id="namespacestd_html_ab8424022895aee3e366fb9a32f2883cb"><div class="ttname"><a href="namespacestd.html#ab8424022895aee3e366fb9a32f2883cb">std::swap</a></div><div class="ttdeci">void swap(llvm::BitVector &amp;LHS, llvm::BitVector &amp;RHS)</div><div class="ttdoc">Implement std::swap in terms of BitVector swap. </div><div class="ttdef"><b>Definition:</b> <a href="BitVector_8h_source.html#l00591">BitVector.h:591</a></div></div>
<div class="ttc" id="classllvm_1_1CmpInst_html_a283f9a5d4d843d20c40bb4d3e364bb05a2751d6136a2819749dcef65dc19a4246"><div class="ttname"><a href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05a2751d6136a2819749dcef65dc19a4246">llvm::CmpInst::ICMP_SLE</a></div><div class="ttdoc">signed less or equal </div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00681">InstrTypes.h:681</a></div></div>
<div class="ttc" id="classllvm_1_1VectorType_html"><div class="ttname"><a href="classllvm_1_1VectorType.html">llvm::VectorType</a></div><div class="ttdef"><b>Definition:</b> <a href="DerivedTypes_8h_source.html#l00358">DerivedTypes.h:358</a></div></div>
<div class="ttc" id="classllvm_1_1APInt_html"><div class="ttname"><a href="classllvm_1_1APInt.html">llvm::APInt</a></div><div class="ttdoc">Class for arbitrary precision integers. </div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l00075">APInt.h:75</a></div></div>
<div class="ttc" id="classllvm_1_1Type_html_a6e328feb83afa5cf1c966d6704e43fc1"><div class="ttname"><a href="classllvm_1_1Type.html#a6e328feb83afa5cf1c966d6704e43fc1">llvm::Type::isIntegerTy</a></div><div class="ttdeci">bool isIntegerTy() const </div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00196">Type.h:196</a></div></div>
<div class="ttc" id="PatternMatch_8h_html"><div class="ttname"><a href="PatternMatch_8h.html">PatternMatch.h</a></div></div>
<div class="ttc" id="ConstantFolding_8h_html"><div class="ttname"><a href="ConstantFolding_8h.html">ConstantFolding.h</a></div></div>
<div class="ttc" id="namespacellvm_1_1APIntOps_html_a684cfe02c582e8d75cd6d457e63e6c25"><div class="ttname"><a href="namespacellvm_1_1APIntOps.html#a684cfe02c582e8d75cd6d457e63e6c25">llvm::APIntOps::And</a></div><div class="ttdeci">APInt And(const APInt &amp;LHS, const APInt &amp;RHS)</div><div class="ttdoc">Bitwise AND function for APInt. </div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l01840">APInt.h:1840</a></div></div>
<div class="ttc" id="classllvm_1_1IRBuilder_html_a4d49fd9a4cc4f2a74d4555bd08b13910"><div class="ttname"><a href="classllvm_1_1IRBuilder.html#a4d49fd9a4cc4f2a74d4555bd08b13910">llvm::IRBuilder::CreateShl</a></div><div class="ttdeci">Value * CreateShl(Value *LHS, Value *RHS, const Twine &amp;Name=&quot;&quot;, bool HasNUW=false, bool HasNSW=false)</div><div class="ttdef"><b>Definition:</b> <a href="IRBuilder_8h_source.html#l00734">IRBuilder.h:734</a></div></div>
<div class="ttc" id="classllvm_1_1IRBuilder_html_a7cca116ba5ef3fe3dfc9872b1600d11d"><div class="ttname"><a href="classllvm_1_1IRBuilder.html#a7cca116ba5ef3fe3dfc9872b1600d11d">llvm::IRBuilder::CreateZExtOrTrunc</a></div><div class="ttdeci">Value * CreateZExtOrTrunc(Value *V, Type *DestTy, const Twine &amp;Name=&quot;&quot;)</div><div class="ttdoc">Create a ZExt or Trunc from the integer value V to DestTy. Return the value untouched if the type of ...</div><div class="ttdef"><b>Definition:</b> <a href="IRBuilder_8h_source.html#l01079">IRBuilder.h:1079</a></div></div>
<div class="ttc" id="namespacellvm_html_ab5ee1b3d80978be1bf429bb2f15d4954"><div class="ttname"><a href="namespacellvm.html#ab5ee1b3d80978be1bf429bb2f15d4954">llvm::SimplifySelectInst</a></div><div class="ttdeci">Value * SimplifySelectInst(Value *Cond, Value *TrueVal, Value *FalseVal, const DataLayout *TD=0, const TargetLibraryInfo *TLI=0, const DominatorTree *DT=0)</div><div class="ttdef"><b>Definition:</b> <a href="InstructionSimplify_8cpp_source.html#l02722">InstructionSimplify.cpp:2722</a></div></div>
<div class="ttc" id="classllvm_1_1ConstantExpr_html_a365628d9f62e7a281d493d15bdb13b27"><div class="ttname"><a href="classllvm_1_1ConstantExpr.html#a365628d9f62e7a281d493d15bdb13b27">llvm::ConstantExpr::getSExt</a></div><div class="ttdeci">static Constant * getSExt(Constant *C, Type *Ty)</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l01552">Constants.cpp:1552</a></div></div>
<div class="ttc" id="classllvm_1_1ConstantExpr_html_a80e82791d4d7f4d1d23d68ca0a2b1f64"><div class="ttname"><a href="classllvm_1_1ConstantExpr.html#a80e82791d4d7f4d1d23d68ca0a2b1f64">llvm::ConstantExpr::getZExt</a></div><div class="ttdeci">static Constant * getZExt(Constant *C, Type *Ty)</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l01566">Constants.cpp:1566</a></div></div>
<div class="ttc" id="classllvm_1_1CmpInst_html_a283f9a5d4d843d20c40bb4d3e364bb05a573bcd571c938fce863525330bbfc4b8"><div class="ttname"><a href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05a573bcd571c938fce863525330bbfc4b8">llvm::CmpInst::ICMP_UGE</a></div><div class="ttdoc">unsigned greater or equal </div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00675">InstrTypes.h:675</a></div></div>
<div class="ttc" id="MD5_8cpp_html_ac0eafdc9ee161b71e7af98af736952fd"><div class="ttname"><a href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a></div><div class="ttdeci">#define I(x, y, z)</div><div class="ttdef"><b>Definition:</b> <a href="MD5_8cpp_source.html#l00054">MD5.cpp:54</a></div></div>
<div class="ttc" id="InstCombineSelect_8cpp_html_aa44d9732ae3e717d005e9a79edf9a948"><div class="ttname"><a href="InstCombineSelect_8cpp.html#aa44d9732ae3e717d005e9a79edf9a948">CanSelectOperandBeMappingIntoPredBlock</a></div><div class="ttdeci">static bool CanSelectOperandBeMappingIntoPredBlock(const Value *V, const SelectInst &amp;SI)</div><div class="ttdef"><b>Definition:</b> <a href="InstCombineSelect_8cpp_source.html#l00604">InstCombineSelect.cpp:604</a></div></div>
<div class="ttc" id="classllvm_1_1Value_html_a085b82f074c28030fb8e194377ed2d0c"><div class="ttname"><a href="classllvm_1_1Value.html#a085b82f074c28030fb8e194377ed2d0c">llvm::Value::hasOneUse</a></div><div class="ttdeci">bool hasOneUse() const </div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00161">Value.h:161</a></div></div>
<div class="ttc" id="classllvm_1_1BinaryOperator_html_a4a4628e91a9c6a339fa61105614fac76"><div class="ttname"><a href="classllvm_1_1BinaryOperator.html#a4a4628e91a9c6a339fa61105614fac76">llvm::BinaryOperator::Create</a></div><div class="ttdeci">static BinaryOperator * Create(BinaryOps Op, Value *S1, Value *S2, const Twine &amp;Name=Twine(), Instruction *InsertBefore=0)</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8cpp_source.html#l01834">Instructions.cpp:1834</a></div></div>
<div class="ttc" id="namespacellvm_1_1A64CC_html_af5804bc0518be9568f73db566e4d6f46a2a6c4724226f9ccea96d35fd4c131af8"><div class="ttname"><a href="namespacellvm_1_1A64CC.html#af5804bc0518be9568f73db566e4d6f46a2a6c4724226f9ccea96d35fd4c131af8">llvm::A64CC::NV</a></div><div class="ttdef"><b>Definition:</b> <a href="AArch64BaseInfo_8h_source.html#l00046">AArch64BaseInfo.h:46</a></div></div>
<div class="ttc" id="namespacellvm_html_a6bf471c1030973649c2e426afc212097a6afb3549f5028760be1bbf8ae7c04d73"><div class="ttname"><a href="namespacellvm.html#a6bf471c1030973649c2e426afc212097a6afb3549f5028760be1bbf8ae7c04d73">llvm::SPF_UMIN</a></div><div class="ttdef"><b>Definition:</b> <a href="InstCombine_8h_source.html#l00035">InstCombine.h:35</a></div></div>
<div class="ttc" id="classllvm_1_1ConstantFP_html_a0f839f7633a4709c1d89e128f49b3d43"><div class="ttname"><a href="classllvm_1_1ConstantFP.html#a0f839f7633a4709c1d89e128f49b3d43">llvm::ConstantFP::getValueAPF</a></div><div class="ttdeci">const APFloat &amp; getValueAPF() const </div><div class="ttdef"><b>Definition:</b> <a href="Constants_8h_source.html#l00263">Constants.h:263</a></div></div>
<div class="ttc" id="classllvm_1_1CmpInst_html_a283f9a5d4d843d20c40bb4d3e364bb05aa719225e2de4059f93fd3209e1f48218"><div class="ttname"><a href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05aa719225e2de4059f93fd3209e1f48218">llvm::CmpInst::ICMP_EQ</a></div><div class="ttdoc">equal </div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00672">InstrTypes.h:672</a></div></div>
<div class="ttc" id="classllvm_1_1CmpInst_html_acc4aad24e3e9f04088c9b7802a7a5718"><div class="ttname"><a href="classllvm_1_1CmpInst.html#acc4aad24e3e9f04088c9b7802a7a5718">llvm::CmpInst::isUnsigned</a></div><div class="ttdeci">bool isUnsigned() const </div><div class="ttdoc">Determine if this instruction is using an unsigned comparison. </div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00786">InstrTypes.h:786</a></div></div>
<div class="ttc" id="classllvm_1_1CmpInst_html_a283f9a5d4d843d20c40bb4d3e364bb05a024db78a5ed74f64666f3ca4955e6eca"><div class="ttname"><a href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05a024db78a5ed74f64666f3ca4955e6eca">llvm::CmpInst::FCMP_OEQ</a></div><div class="ttdoc">0 0 0 1 True if ordered and equal </div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00654">InstrTypes.h:654</a></div></div>
<div class="ttc" id="classllvm_1_1Value_html"><div class="ttname"><a href="classllvm_1_1Value.html">llvm::Value</a></div><div class="ttdoc">LLVM Value Representation. </div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00066">Value.h:66</a></div></div>
<div class="ttc" id="classllvm_1_1BinaryOperator_html_a5b6cd6c043f54b40899aff62e6e40488"><div class="ttname"><a href="classllvm_1_1BinaryOperator.html#a5b6cd6c043f54b40899aff62e6e40488">llvm::BinaryOperator::hasNoUnsignedWrap</a></div><div class="ttdeci">bool hasNoUnsignedWrap() const </div><div class="ttdoc">hasNoUnsignedWrap - Determine whether the no unsigned wrap flag is set. </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8cpp_source.html#l02009">Instructions.cpp:2009</a></div></div>
<div class="ttc" id="classllvm_1_1Instruction_html_a021bb7c9aad6003fe8089f6327356c6c"><div class="ttname"><a href="classllvm_1_1Instruction.html#a021bb7c9aad6003fe8089f6327356c6c">llvm::Instruction::getOpcode</a></div><div class="ttdeci">unsigned getOpcode() const </div><div class="ttdoc">getOpcode() returns a member of one of the enums like Instruction::Add. </div><div class="ttdef"><b>Definition:</b> <a href="Instruction_8h_source.html#l00083">Instruction.h:83</a></div></div>
<div class="ttc" id="classllvm_1_1APFloat_html_a30b29f2be19eb73f6225de032a1fafb3"><div class="ttname"><a href="classllvm_1_1APFloat.html#a30b29f2be19eb73f6225de032a1fafb3">llvm::APFloat::isZero</a></div><div class="ttdeci">bool isZero() const </div><div class="ttdoc">Returns true if and only if the float is plus or minus zero. </div><div class="ttdef"><b>Definition:</b> <a href="APFloat_8h_source.html#l00376">APFloat.h:376</a></div></div>
<div class="ttc" id="classllvm_1_1Instruction_html_af67d1f3a518964d80a109bb3d9d5cf1e"><div class="ttname"><a href="classllvm_1_1Instruction.html#af67d1f3a518964d80a109bb3d9d5cf1e">llvm::Instruction::moveBefore</a></div><div class="ttdeci">void moveBefore(Instruction *MovePos)</div><div class="ttdef"><b>Definition:</b> <a href="Instruction_8cpp_source.html#l00091">Instruction.cpp:91</a></div></div>
<div class="ttc" id="namespacellvm_html_a3e98ee8971fbf32f7f84f5a7399b5b67"><div class="ttname"><a href="namespacellvm.html#a3e98ee8971fbf32f7f84f5a7399b5b67">llvm::ConstantFoldInstOperands</a></div><div class="ttdeci">Constant * ConstantFoldInstOperands(unsigned Opcode, Type *DestTy, ArrayRef&lt; Constant * &gt; Ops, const DataLayout *TD=0, const TargetLibraryInfo *TLI=0)</div><div class="ttdef"><b>Definition:</b> <a href="ConstantFolding_8cpp_source.html#l00954">ConstantFolding.cpp:954</a></div></div>
<div class="ttc" id="InstCombineSelect_8cpp_html_a2914e94cd5aa888f57945589a7c2e1d0"><div class="ttname"><a href="InstCombineSelect_8cpp.html#a2914e94cd5aa888f57945589a7c2e1d0">isSelect01</a></div><div class="ttdeci">static bool isSelect01(Constant *C1, Constant *C2)</div><div class="ttdef"><b>Definition:</b> <a href="InstCombineSelect_8cpp_source.html#l00196">InstCombineSelect.cpp:196</a></div></div>
<div class="ttc" id="InstCombineSelect_8cpp_html_af1ae9636acb04dd1a88afcb1e78d8f10"><div class="ttname"><a href="InstCombineSelect_8cpp.html#af1ae9636acb04dd1a88afcb1e78d8f10">GetSelectFoldableOperands</a></div><div class="ttdeci">static unsigned GetSelectFoldableOperands(Instruction *I)</div><div class="ttdef"><b>Definition:</b> <a href="InstCombineSelect_8cpp_source.html#l00084">InstCombineSelect.cpp:84</a></div></div>
<div class="ttc" id="classllvm_1_1SelectInst_html_a29a16f32075ee4f23cd769701463952c"><div class="ttname"><a href="classllvm_1_1SelectInst.html#a29a16f32075ee4f23cd769701463952c">llvm::SelectInst::getFalseValue</a></div><div class="ttdeci">const Value * getFalseValue() const </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l01468">Instructions.h:1468</a></div></div>
<div class="ttc" id="classllvm_1_1CmpInst_html_a283f9a5d4d843d20c40bb4d3e364bb05a607cecdc5172814382033e001ed11fad"><div class="ttname"><a href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05a607cecdc5172814382033e001ed11fad">llvm::CmpInst::ICMP_UGT</a></div><div class="ttdoc">unsigned greater than </div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00674">InstrTypes.h:674</a></div></div>
<div class="ttc" id="OcamlGCPrinter_8cpp_html_a1bdbcdc4205781eefd549946d40ff378"><div class="ttname"><a href="OcamlGCPrinter_8cpp.html#a1bdbcdc4205781eefd549946d40ff378">Y</a></div><div class="ttdeci">static GCMetadataPrinterRegistry::Add&lt; OcamlGCMetadataPrinter &gt; Y(&quot;ocaml&quot;,&quot;ocaml 3.10-compatible collector&quot;)</div></div>
<div class="ttc" id="classllvm_1_1InstCombiner_html_aaca290b85da72e895db359c37df8f0ab"><div class="ttname"><a href="classllvm_1_1InstCombiner.html#aaca290b85da72e895db359c37df8f0ab">llvm::InstCombiner::visitSelectInstWithICmp</a></div><div class="ttdeci">Instruction * visitSelectInstWithICmp(SelectInst &amp;SI, ICmpInst *ICI)</div><div class="ttdef"><b>Definition:</b> <a href="InstCombineSelect_8cpp_source.html#l00418">InstCombineSelect.cpp:418</a></div></div>
<div class="ttc" id="Target_2ARM_2README_8txt_html_a90cca76dd78688687e0d697679dbc799"><div class="ttname"><a href="Target_2ARM_2README_8txt.html#a90cca76dd78688687e0d697679dbc799">B</a></div><div class="ttdeci">compiles ldr LCPI1_0 ldr ldr mov lsr tst moveq r1 ldr LCPI1_1 and r0 bx lr It would be better to do something like to fold the shift into the conditional ldr LCPI1_0 ldr ldr tst movne lsr ldr LCPI1_1 and r0 bx lr it saves an instruction and a register It might be profitable to cse MOVi16 if there are lots of bit immediates with the same bottom half Robert Muth started working on an alternate jump table implementation that does not put the tables in line in the text This is more like the llvm default jump table implementation This might be useful sometime Several revisions of patches are on the mailing beginning while CMP sets them like a subtract Therefore to be able to use CMN for comparisons other than the Z we ll need additional logic to reverse the conditionals associated with the comparison Perhaps a pseudo instruction for the with a post codegen pass to clean up and handle the condition codes See PR5694 for testcase Given the following on int B</div><div class="ttdef"><b>Definition:</b> <a href="Target_2ARM_2README_8txt_source.html#l00592">Target/ARM/README.txt:592</a></div></div>
<div class="ttc" id="namespacellvm_html_a6569d00d31a5d74e563e2f39f82271ab"><div class="ttname"><a href="namespacellvm.html#a6569d00d31a5d74e563e2f39f82271ab">llvm::X</a></div><div class="ttdeci">static RegisterPass&lt; NVPTXAllocaHoisting &gt; X(&quot;alloca-hoisting&quot;,&quot;Hoisting alloca instructions in non-entry &quot;&quot;blocks to the entry block&quot;)</div></div>
<div class="ttc" id="classllvm_1_1Instruction_html_a9cd49851904f15060edb782ef4dd1b2d"><div class="ttname"><a href="classllvm_1_1Instruction.html#a9cd49851904f15060edb782ef4dd1b2d">llvm::Instruction::getParent</a></div><div class="ttdeci">const BasicBlock * getParent() const </div><div class="ttdef"><b>Definition:</b> <a href="Instruction_8h_source.html#l00052">Instruction.h:52</a></div></div>
<div class="ttc" id="classllvm_1_1ConstantInt_html_aa96ca2cf0bb1e924523900fb911b0a45"><div class="ttname"><a href="classllvm_1_1ConstantInt.html#aa96ca2cf0bb1e924523900fb911b0a45">llvm::ConstantInt::isOne</a></div><div class="ttdeci">bool isOne() const </div><div class="ttdoc">Determine if the value is one. </div><div class="ttdef"><b>Definition:</b> <a href="Constants_8h_source.html#l00168">Constants.h:168</a></div></div>
<div class="ttc" id="classllvm_1_1CmpInst_html_a283f9a5d4d843d20c40bb4d3e364bb05ac1aa7b798ba11d2e497d5cce6ce6d3dc"><div class="ttname"><a href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05ac1aa7b798ba11d2e497d5cce6ce6d3dc">llvm::CmpInst::ICMP_SGE</a></div><div class="ttdoc">signed greater or equal </div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00679">InstrTypes.h:679</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<hr>
<p class="footer">
Generated on Sat Nov 10 2018 22:59:02 for <a href="http://llvm.org/">LLVM</a> by
<a href="http://www.doxygen.org"><img src="doxygen.png" alt="Doxygen"
align="middle" border="0"/>1.8.11</a><br>
Copyright &copy; 2003-2013 University of Illinois at Urbana-Champaign.
All Rights Reserved.</p>
<hr>
<!--#include virtual="/attrib.incl" -->
</body>
</html>
