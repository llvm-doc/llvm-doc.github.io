<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head>
<meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1"/>
<meta name="keywords" content="LLVM,Low Level Virtual Machine,C++,doxygen,API,documentation"/>
<meta name="description" content="C++ source code API documentation for LLVM."/>
<title>LLVM: BranchFolding.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head><body>
<p class="title">LLVM API Documentation</p>
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('BranchFolding_8cpp_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">BranchFolding.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="BranchFolding_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//===-- BranchFolding.cpp - Fold machine code branch instructions ---------===//</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">//                     The LLVM Compiler Infrastructure</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// This file is distributed under the University of Illinois Open Source</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">// License. See LICENSE.TXT for details.</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">// This pass forwards branches to unconditional branches to make them branch</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">// directly to the target block.  This pass often results in dead MBB&#39;s, which</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">// it then removes.</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">// Note that this pass must be run after register allocation, it cannot handle</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">// SSA form.</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;</div><div class="line"><a name="l00019"></a><span class="lineno"><a class="line" href="BranchFolding_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">   19</a></span>&#160;<span class="preprocessor">#define DEBUG_TYPE &quot;branchfolding&quot;</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="BranchFolding_8h.html">BranchFolding.h</a>&quot;</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="STLExtras_8h.html">llvm/ADT/STLExtras.h</a>&quot;</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="SmallSet_8h.html">llvm/ADT/SmallSet.h</a>&quot;</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Statistic_8h.html">llvm/ADT/Statistic.h</a>&quot;</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="MachineFunctionPass_8h.html">llvm/CodeGen/MachineFunctionPass.h</a>&quot;</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="MachineJumpTableInfo_8h.html">llvm/CodeGen/MachineJumpTableInfo.h</a>&quot;</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="MachineModuleInfo_8h.html">llvm/CodeGen/MachineModuleInfo.h</a>&quot;</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="MachineRegisterInfo_8h.html">llvm/CodeGen/MachineRegisterInfo.h</a>&quot;</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="CodeGen_2Passes_8h.html">llvm/CodeGen/Passes.h</a>&quot;</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="RegisterScavenging_8h.html">llvm/CodeGen/RegisterScavenging.h</a>&quot;</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Function_8h.html">llvm/IR/Function.h</a>&quot;</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="CommandLine_8h.html">llvm/Support/CommandLine.h</a>&quot;</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Debug_8h.html">llvm/Support/Debug.h</a>&quot;</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ErrorHandling_8h.html">llvm/Support/ErrorHandling.h</a>&quot;</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="raw__ostream_8h.html">llvm/Support/raw_ostream.h</a>&quot;</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TargetInstrInfo_8h.html">llvm/Target/TargetInstrInfo.h</a>&quot;</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Target_2TargetMachine_8h.html">llvm/Target/TargetMachine.h</a>&quot;</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TargetRegisterInfo_8h.html">llvm/Target/TargetRegisterInfo.h</a>&quot;</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#include &lt;algorithm&gt;</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespacellvm.html">llvm</a>;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<a class="code" href="BranchFolding_8cpp.html#a7fc12fa408f3c5a5e8c205a77ee5c667">STATISTIC</a>(NumDeadBlocks, <span class="stringliteral">&quot;Number of dead blocks removed&quot;</span>);</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<a class="code" href="BranchFolding_8cpp.html#a7fc12fa408f3c5a5e8c205a77ee5c667">STATISTIC</a>(NumBranchOpts, <span class="stringliteral">&quot;Number of branches optimized&quot;</span>);</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<a class="code" href="BranchFolding_8cpp.html#a7fc12fa408f3c5a5e8c205a77ee5c667">STATISTIC</a>(NumTailMerge , <span class="stringliteral">&quot;Number of block tails merged&quot;</span>);</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<a class="code" href="BranchFolding_8cpp.html#a7fc12fa408f3c5a5e8c205a77ee5c667">STATISTIC</a>(NumHoist     , <span class="stringliteral">&quot;Number of times common instructions are hoisted&quot;</span>);</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;cl::boolOrDefault&gt;</a> <a class="code" href="BranchFolding_8cpp.html#ae07ef8db7162ea7ac8f04e13f75a3580">FlagEnableTailMerge</a>(<span class="stringliteral">&quot;enable-tail-merge&quot;</span>,</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;                              <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(<a class="code" href="namespacellvm_1_1cl.html#a9241f2e42b7587b123c885d7a659ad44aa5bd521ebe67ddf0e90f1a9e540a6d43">cl::BOU_UNSET</a>), <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>);</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">// Throttle for huge numbers of predecessors (compile speed problems)</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;unsigned&gt;</a></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<a class="code" href="BranchFolding_8cpp.html#a02dc8f03ab0fbd643e0015ca91923d33">TailMergeThreshold</a>(<span class="stringliteral">&quot;tail-merge-threshold&quot;</span>,</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;          <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Max number of predecessors to consider tail merging&quot;</span>),</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;          <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(150), <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>);</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">// Heuristic for tail merging (and, inversely, tail duplication).</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">// TODO: This should be replaced with a target query.</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;unsigned&gt;</a></div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<a class="code" href="BranchFolding_8cpp.html#a287825ab3d1df2312dfb4c694a70cf43">TailMergeSize</a>(<span class="stringliteral">&quot;tail-merge-size&quot;</span>,</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;          <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Min number of instructions to consider tail merging&quot;</span>),</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;                              <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(3), <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>);</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="keyword">namespace </span>{<span class="comment"></span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">  /// BranchFolderPass - Wrap branch folder in a machine function pass.</span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment"></span>  <span class="keyword">class </span>BranchFolderPass : <span class="keyword">public</span> <a class="code" href="classllvm_1_1MachineFunctionPass.html">MachineFunctionPass</a> {</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  <span class="keyword">public</span>:</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="keyword">static</span> <span class="keywordtype">char</span> <a class="code" href="namespacellvm_1_1CallingConv.html#a4f861731fc6dbfdccc05af5968d98974">ID</a>;</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <span class="keyword">explicit</span> BranchFolderPass(): <a class="code" href="classllvm_1_1MachineFunctionPass.html">MachineFunctionPass</a>(ID) {}</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">bool</span> runOnMachineFunction(<a class="code" href="classllvm_1_1MachineFunction.html">MachineFunction</a> &amp;MF);</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">void</span> getAnalysisUsage(<a class="code" href="classllvm_1_1AnalysisUsage.html">AnalysisUsage</a> &amp;AU)<span class="keyword"> const </span>{</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;      AU.<a class="code" href="classllvm_1_1AnalysisUsage.html#ae5c60fd282ee894c87ea02c3f0fcb6d0">addRequired</a>&lt;<a class="code" href="classllvm_1_1TargetPassConfig.html">TargetPassConfig</a>&gt;();</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;      <a class="code" href="classllvm_1_1MachineFunctionPass.html#aa1eece37d175f86a6f4808c0c167f13b">MachineFunctionPass::getAnalysisUsage</a>(AU);</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    }</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  };</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;}</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="keywordtype">char</span> <a class="code" href="namespacellvm_1_1CallingConv.html#a4f861731fc6dbfdccc05af5968d98974">BranchFolderPass::ID</a> = 0;</div><div class="line"><a name="l00079"></a><span class="lineno"><a class="line" href="namespacellvm.html#ae39ec6579da91ce8fa292f0a7205d98d">   79</a></span>&#160;<span class="keywordtype">char</span> &amp;<a class="code" href="namespacellvm.html#ae39ec6579da91ce8fa292f0a7205d98d">llvm::BranchFolderPassID</a> = <a class="code" href="namespacellvm_1_1CallingConv.html#a4f861731fc6dbfdccc05af5968d98974">BranchFolderPass::ID</a>;</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;</div><div class="line"><a name="l00081"></a><span class="lineno"><a class="line" href="BranchFolding_8cpp.html#a82220ff274d037282208b6b3d75975c5">   81</a></span>&#160;<a class="code" href="BranchFolding_8cpp.html#a82220ff274d037282208b6b3d75975c5">INITIALIZE_PASS</a>(BranchFolderPass, <span class="stringliteral">&quot;branch-folder&quot;</span>,</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;                <span class="stringliteral">&quot;Control Flow Optimizer&quot;</span>, <span class="keyword">false</span>, <span class="keyword">false</span>)</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;bool BranchFolderPass::runOnMachineFunction(<a class="code" href="classllvm_1_1MachineFunction.html">MachineFunction</a> &amp;MF) {</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <a class="code" href="classllvm_1_1TargetPassConfig.html">TargetPassConfig</a> *PassConfig = &amp;getAnalysis&lt;TargetPassConfig&gt;();</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  <a class="code" href="classllvm_1_1BranchFolder.html">BranchFolder</a> Folder(PassConfig-&gt;<a class="code" href="classllvm_1_1TargetPassConfig.html#a0e23643ef5185f324c3214f72f821953">getEnableTailMerge</a>(), <span class="comment">/*CommonHoist=*/</span><span class="keyword">true</span>);</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  <span class="keywordflow">return</span> Folder.<a class="code" href="classllvm_1_1BranchFolder.html#a79c0c5340d25122d14d264f3281bdfe4">OptimizeFunction</a>(MF,</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;                                 MF.getTarget().getInstrInfo(),</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;                                 MF.getTarget().getRegisterInfo(),</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;                                 getAnalysisIfAvailable&lt;MachineModuleInfo&gt;());</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;}</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;</div><div class="line"><a name="l00094"></a><span class="lineno"><a class="line" href="classllvm_1_1BranchFolder.html#a3c040a6585de941fbc6f26336f9ea9a6">   94</a></span>&#160;<a class="code" href="classllvm_1_1BranchFolder.html#a3c040a6585de941fbc6f26336f9ea9a6">BranchFolder::BranchFolder</a>(<span class="keywordtype">bool</span> defaultEnableTailMerge, <span class="keywordtype">bool</span> CommonHoist) {</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  <span class="keywordflow">switch</span> (<a class="code" href="BranchFolding_8cpp.html#ae07ef8db7162ea7ac8f04e13f75a3580">FlagEnableTailMerge</a>) {</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1cl.html#a9241f2e42b7587b123c885d7a659ad44aa5bd521ebe67ddf0e90f1a9e540a6d43">cl::BOU_UNSET</a>: EnableTailMerge = defaultEnableTailMerge; <span class="keywordflow">break</span>;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1cl.html#a9241f2e42b7587b123c885d7a659ad44ad7c4bd83c337c86d34f6c2d8eba1e736">cl::BOU_TRUE</a>: EnableTailMerge = <span class="keyword">true</span>; <span class="keywordflow">break</span>;</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1cl.html#a9241f2e42b7587b123c885d7a659ad44a4e55599a5b5277382b14e6e8eb1f63ef">cl::BOU_FALSE</a>: EnableTailMerge = <span class="keyword">false</span>; <span class="keywordflow">break</span>;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  }</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  EnableHoistCommonCode = CommonHoist;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;}</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">/// RemoveDeadBlock - Remove the specified dead machine basic block from the</span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment">/// function, updating the CFG.</span></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment"></span><span class="keywordtype">void</span> BranchFolder::RemoveDeadBlock(<a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> *MBB) {</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  assert(MBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#ae1612b06274368fe13b574cbd9c4f768">pred_empty</a>() &amp;&amp; <span class="stringliteral">&quot;MBB must be dead!&quot;</span>);</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;\nRemoving MBB: &quot;</span> &lt;&lt; *MBB);</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  <a class="code" href="classllvm_1_1MachineFunction.html">MachineFunction</a> *MF = MBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#af2e482ff2a9253ec6bc2285491496bd6">getParent</a>();</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  <span class="comment">// drop all successors.</span></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  <span class="keywordflow">while</span> (!MBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#a1570dd3a2568ba5e52073cdf6d904ee9">succ_empty</a>())</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    MBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#aabc149950316b323f9cdac2122ff0131">removeSuccessor</a>(MBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#a3ddd708642d60c1661992ff8ba1b215d">succ_end</a>()-1);</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  <span class="comment">// Avoid matching if this pointer gets reused.</span></div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  TriedMerging.erase(MBB);</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  <span class="comment">// Remove the block.</span></div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  MF-&gt;<a class="code" href="classllvm_1_1MachineFunction.html#ae986afe2285d3980b27aa9763f3203e9">erase</a>(MBB);</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;}</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment">/// OptimizeImpDefsBlock - If a basic block is just a bunch of implicit_def</span></div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment">/// followed by terminators, and if the implicitly defined registers are not</span></div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment">/// used by the terminators, remove those implicit_def&#39;s. e.g.</span></div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment">/// BB1:</span></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment">///   r0 = implicit_def</span></div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment">///   r1 = implicit_def</span></div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment">///   br</span></div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment">/// This block can be optimized away later if the implicit instructions are</span></div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment">/// removed.</span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment"></span><span class="keywordtype">bool</span> BranchFolder::OptimizeImpDefsBlock(<a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> *MBB) {</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  <a class="code" href="classllvm_1_1SmallSet.html">SmallSet&lt;unsigned, 4&gt;</a> ImpDefRegs;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  <a class="code" href="classllvm_1_1MachineBasicBlock.html#ac51be7ff80fe8d6ae5e8c0acb194908a">MachineBasicBlock::iterator</a> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = MBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#ab2d91e7bec944efcbc39d8e30644f111">begin</a>();</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  <span class="keywordflow">while</span> (I != MBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#acbc921830578e2741be6549db716c0ce">end</a>()) {</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <span class="keywordflow">if</span> (!I-&gt;isImplicitDef())</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="keywordtype">unsigned</span> <a class="code" href="X86DisassemblerDecoder_8h.html#a546839a5c4bcf9f9450967155f48de41">Reg</a> = I-&gt;getOperand(0).getReg();</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1MCSubRegIterator.html">MCSubRegIterator</a> SubRegs(Reg, TRI, <span class="comment">/*IncludeSelf=*/</span><span class="keyword">true</span>);</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;         SubRegs.<a class="code" href="classllvm_1_1MCRegisterInfo_1_1DiffListIterator.html#abccd358b92366e5284e7e674e86b241f">isValid</a>(); ++SubRegs)</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;      ImpDefRegs.<a class="code" href="classllvm_1_1SmallSet.html#a8d8348060ccdeeba13fb8bc651dfbf82">insert</a>(*SubRegs);</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    ++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>;</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  }</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  <span class="keywordflow">if</span> (ImpDefRegs.<a class="code" href="classllvm_1_1SmallSet.html#afd57abe5a6e10c8b282b6549432ec851">empty</a>())</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  <a class="code" href="classllvm_1_1MachineBasicBlock.html#ac51be7ff80fe8d6ae5e8c0acb194908a">MachineBasicBlock::iterator</a> FirstTerm = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>;</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  <span class="keywordflow">while</span> (I != MBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#acbc921830578e2741be6549db716c0ce">end</a>()) {</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>-&gt;isUnpredicatedTerminator(I))</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <span class="comment">// See if it uses any of the implicitly defined registers.</span></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0, e = I-&gt;getNumOperands(); <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != e; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;      <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;MO = I-&gt;getOperand(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;      <span class="keywordflow">if</span> (!MO.<a class="code" href="classllvm_1_1MachineOperand.html#ad8198d6d83af9410d867136e33fbf4b2">isReg</a>() || !MO.<a class="code" href="classllvm_1_1MachineOperand.html#a57bf9ee7219097ff0f98da23a3b3b782">isUse</a>())</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;      <span class="keywordtype">unsigned</span> <a class="code" href="X86DisassemblerDecoder_8h.html#a546839a5c4bcf9f9450967155f48de41">Reg</a> = MO.<a class="code" href="classllvm_1_1MachineOperand.html#ab75f703d251cc0ce0206fe00a999db86">getReg</a>();</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;      <span class="keywordflow">if</span> (ImpDefRegs.<a class="code" href="classllvm_1_1SmallSet.html#ab28aa342862f6d16361be514fd98c22e">count</a>(Reg))</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    }</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    ++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>;</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  }</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  I = MBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#ab2d91e7bec944efcbc39d8e30644f111">begin</a>();</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  <span class="keywordflow">while</span> (I != FirstTerm) {</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *ImpDefMI = &amp;*<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    ++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>;</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    MBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#a537a9265c55392ab47d44954f27db538">erase</a>(ImpDefMI);</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  }</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;}</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment">/// OptimizeFunction - Perhaps branch folding, tail merging and other</span></div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="comment">/// CFG optimizations on the given function.</span></div><div class="line"><a name="l00174"></a><span class="lineno"><a class="line" href="classllvm_1_1BranchFolder.html#a79c0c5340d25122d14d264f3281bdfe4">  174</a></span>&#160;<span class="comment"></span><span class="keywordtype">bool</span> <a class="code" href="classllvm_1_1BranchFolder.html#a79c0c5340d25122d14d264f3281bdfe4">BranchFolder::OptimizeFunction</a>(<a class="code" href="classllvm_1_1MachineFunction.html">MachineFunction</a> &amp;MF,</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;                                    <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetInstrInfo.html">TargetInstrInfo</a> *tii,</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;                                    <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetRegisterInfo.html">TargetRegisterInfo</a> *tri,</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;                                    <a class="code" href="classllvm_1_1MachineModuleInfo.html">MachineModuleInfo</a> *mmi) {</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  <span class="keywordflow">if</span> (!tii) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  TriedMerging.clear();</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a> = tii;</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  TRI = tri;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  MMI = mmi;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  RS = NULL;</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  <span class="comment">// Use a RegScavenger to help update liveness when required.</span></div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="MCModuleYAML_8cpp.html#a5e410df3f6875c5af4a7f2be284f235d">MRI</a> = MF.<a class="code" href="classllvm_1_1MachineFunction.html#ab4a6ca428289b667dd691a00e9f7e334">getRegInfo</a>();</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  <span class="keywordflow">if</span> (MRI.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#aab02e22a5eb05431890303cdeb8d0479">tracksLiveness</a>() &amp;&amp; TRI-&gt;trackLivenessAfterRegAlloc(MF))</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    RS = <span class="keyword">new</span> <a class="code" href="classllvm_1_1RegScavenger.html">RegScavenger</a>();</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    MRI.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a721b3ae1a20e295cc4f1143958ad3884">invalidateLiveness</a>();</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  <span class="comment">// Fix CFG.  The later algorithms expect it to be right.</span></div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  <span class="keywordtype">bool</span> MadeChange = <span class="keyword">false</span>;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1MachineFunction.html#a340712de3e78fec11c338735cab17df7">MachineFunction::iterator</a> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = MF.<a class="code" href="classllvm_1_1MachineFunction.html#ab0789854909cf47f640a85fa2bac29c7">begin</a>(), E = MF.<a class="code" href="classllvm_1_1MachineFunction.html#a9d017af749f76484cb9aec9ff6e4330c">end</a>(); <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> != E; <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>++) {</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> *MBB = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, *TBB = 0, *FBB = 0;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;MachineOperand, 4&gt;</a> Cond;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>-&gt;<a class="code" href="classllvm_1_1HexagonInstrInfo.html#a6f9cdb0ade88e5375e97bb0905925c5d">AnalyzeBranch</a>(*MBB, TBB, FBB, Cond, <span class="keyword">true</span>))</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;      MadeChange |= MBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#aa20773d21c44eb6e0e330d96636cc4b0">CorrectExtraCFGEdges</a>(TBB, FBB, !Cond.<a class="code" href="classllvm_1_1SmallVectorBase.html#a8a8df4d85555c7954a95f86080cd3b64">empty</a>());</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    MadeChange |= OptimizeImpDefsBlock(MBB);</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  }</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  <span class="keywordtype">bool</span> MadeChangeThisIteration = <span class="keyword">true</span>;</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  <span class="keywordflow">while</span> (MadeChangeThisIteration) {</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    MadeChangeThisIteration    = TailMergeBlocks(MF);</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    MadeChangeThisIteration   |= OptimizeBranches(MF);</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="keywordflow">if</span> (EnableHoistCommonCode)</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;      MadeChangeThisIteration |= HoistCommonCode(MF);</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    MadeChange |= MadeChangeThisIteration;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  }</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  <span class="comment">// See if any jump tables have become dead as the code generator</span></div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  <span class="comment">// did its thing.</span></div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  <a class="code" href="classllvm_1_1MachineJumpTableInfo.html">MachineJumpTableInfo</a> *JTI = MF.<a class="code" href="classllvm_1_1MachineFunction.html#a99e93c9b5c2f41b3d601d129a6f60a6e">getJumpTableInfo</a>();</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  <span class="keywordflow">if</span> (JTI == 0) {</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <span class="keyword">delete</span> RS;</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <span class="keywordflow">return</span> MadeChange;</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  }</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  <span class="comment">// Walk the function to find jump tables that are live.</span></div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  <a class="code" href="classllvm_1_1BitVector.html">BitVector</a> JTIsLive(JTI-&gt;<a class="code" href="classllvm_1_1MachineJumpTableInfo.html#adebd965803507068e86d6d3d454338e9">getJumpTables</a>().size());</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1MachineFunction.html#a340712de3e78fec11c338735cab17df7">MachineFunction::iterator</a> <a class="code" href="CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> = MF.<a class="code" href="classllvm_1_1MachineFunction.html#ab0789854909cf47f640a85fa2bac29c7">begin</a>(), E = MF.<a class="code" href="classllvm_1_1MachineFunction.html#a9d017af749f76484cb9aec9ff6e4330c">end</a>();</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;       <a class="code" href="CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> != E; ++<a class="code" href="CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>) {</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1MachineBasicBlock.html#ac51be7ff80fe8d6ae5e8c0acb194908a">MachineBasicBlock::iterator</a> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = <a class="code" href="CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>-&gt;begin(), E = <a class="code" href="CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>-&gt;end();</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;         <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> != E; ++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> op = 0, e = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getNumOperands(); op != e; ++op) {</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;Op = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getOperand(op);</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        <span class="keywordflow">if</span> (!Op.<a class="code" href="classllvm_1_1MachineOperand.html#af19a512f40c1e9247796ad8cee70884b">isJTI</a>()) <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        <span class="comment">// Remember that this JT is live.</span></div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        JTIsLive.set(Op.<a class="code" href="classllvm_1_1MachineOperand.html#ac9485ae7d6fedd71ad4460f72c799c98">getIndex</a>());</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;      }</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  }</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  <span class="comment">// Finally, remove dead jump tables.  This happens when the</span></div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  <span class="comment">// indirect jump was unreachable (and thus deleted).</span></div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0, e = JTIsLive.size(); <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != e; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="keywordflow">if</span> (!JTIsLive.test(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>)) {</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;      JTI-&gt;<a class="code" href="classllvm_1_1MachineJumpTableInfo.html#a4884f00bcde9528a64e1c18adc789641">RemoveJumpTable</a>(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;      MadeChange = <span class="keyword">true</span>;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    }</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;  <span class="keyword">delete</span> RS;</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;  <span class="keywordflow">return</span> MadeChange;</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;}</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="comment">//  Tail Merging of Blocks</span></div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="comment">/// HashMachineInstr - Compute a hash value for MI and its operands.</span></div><div class="line"><a name="l00253"></a><span class="lineno"><a class="line" href="BranchFolding_8cpp.html#a27436de2b027bf7b58f23547b654603d">  253</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">unsigned</span> <a class="code" href="BranchFolding_8cpp.html#a27436de2b027bf7b58f23547b654603d">HashMachineInstr</a>(<span class="keyword">const</span> <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *<a class="code" href="namespacellvm_1_1A64CC.html#af5804bc0518be9568f73db566e4d6f46a2db5e7546f960277ff98f96cd5624442">MI</a>) {</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  <span class="keywordtype">unsigned</span> Hash = MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a242314c0ae0147d1a7ef54c9bc312616">getOpcode</a>();</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0, e = MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a7b5fe96d88954efc855e6c466207e535">getNumOperands</a>(); <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != e; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;Op = MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a302e45878c6dc1714334c7ce96d56846">getOperand</a>(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <span class="comment">// Merge in bits from the operand if easy.</span></div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <span class="keywordtype">unsigned</span> OperandHash = 0;</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <span class="keywordflow">switch</span> (Op.<a class="code" href="classllvm_1_1MachineOperand.html#a1b63a086907e5b144612bb4266b713d6">getType</a>()) {</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="classllvm_1_1MachineOperand.html#a4da580aaf3300fdcf306f17e4a864f6da99b874c6560305fd292d20f6a06da166">MachineOperand::MO_Register</a>:          OperandHash = Op.<a class="code" href="classllvm_1_1MachineOperand.html#ab75f703d251cc0ce0206fe00a999db86">getReg</a>(); <span class="keywordflow">break</span>;</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="classllvm_1_1MachineOperand.html#a4da580aaf3300fdcf306f17e4a864f6da066f84460d9f7b61d54b187555756ef6">MachineOperand::MO_Immediate</a>:         OperandHash = Op.<a class="code" href="classllvm_1_1MachineOperand.html#a7059d68a29d5ecfb37623ab45cdb4e8d">getImm</a>(); <span class="keywordflow">break</span>;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="classllvm_1_1MachineOperand.html#a4da580aaf3300fdcf306f17e4a864f6da95566cb4525dab82db8cbbed3d634c23">MachineOperand::MO_MachineBasicBlock</a>:</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;      OperandHash = Op.<a class="code" href="classllvm_1_1MachineOperand.html#a3350f7760c4eec67ea7d8f3063c3d748">getMBB</a>()-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#a6acda287e5c19ffb173b0bf8f1dd9c5e">getNumber</a>();</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="classllvm_1_1MachineOperand.html#a4da580aaf3300fdcf306f17e4a864f6da97561985119c4a774e3ec6439240fa80">MachineOperand::MO_FrameIndex</a>:</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="classllvm_1_1MachineOperand.html#a4da580aaf3300fdcf306f17e4a864f6da0d4fd3b1a2d5d46d77b66d5a35783580">MachineOperand::MO_ConstantPoolIndex</a>:</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="classllvm_1_1MachineOperand.html#a4da580aaf3300fdcf306f17e4a864f6daa1741ad7465d81fb3020b84c390ee49d">MachineOperand::MO_JumpTableIndex</a>:</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;      OperandHash = Op.<a class="code" href="classllvm_1_1MachineOperand.html#ac9485ae7d6fedd71ad4460f72c799c98">getIndex</a>();</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="classllvm_1_1MachineOperand.html#a4da580aaf3300fdcf306f17e4a864f6da3f1f6bfc5aa57cf388201bf6b8fee7d3">MachineOperand::MO_GlobalAddress</a>:</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="classllvm_1_1MachineOperand.html#a4da580aaf3300fdcf306f17e4a864f6da9d22ed12eec3e14283ed6a3617d12119">MachineOperand::MO_ExternalSymbol</a>:</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;      <span class="comment">// Global address / external symbol are too hard, don&#39;t bother, but do</span></div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;      <span class="comment">// pull in the offset.</span></div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;      OperandHash = Op.<a class="code" href="classllvm_1_1MachineOperand.html#ae73de4f077ea9862af9611652396202b">getOffset</a>();</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <span class="keywordflow">default</span>: <span class="keywordflow">break</span>;</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    }</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    Hash += ((OperandHash &lt;&lt; 3) | Op.<a class="code" href="classllvm_1_1MachineOperand.html#a1b63a086907e5b144612bb4266b713d6">getType</a>()) &lt;&lt; (<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>&amp;31);</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  }</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;  <span class="keywordflow">return</span> Hash;</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;}</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="comment">/// HashEndOfMBB - Hash the last instruction in the MBB.</span></div><div class="line"><a name="l00286"></a><span class="lineno"><a class="line" href="BranchFolding_8cpp.html#a23f0fe5fd9bac0df47092cb480fbe136">  286</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">unsigned</span> <a class="code" href="BranchFolding_8cpp.html#a23f0fe5fd9bac0df47092cb480fbe136">HashEndOfMBB</a>(<span class="keyword">const</span> <a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> *MBB) {</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;  <a class="code" href="classllvm_1_1MachineBasicBlock.html#a654b11787ac7c4344084d98bea7cf626">MachineBasicBlock::const_iterator</a> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = MBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#acbc921830578e2741be6549db716c0ce">end</a>();</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;  <span class="keywordflow">if</span> (I == MBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#ab2d91e7bec944efcbc39d8e30644f111">begin</a>())</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <span class="keywordflow">return</span> 0;   <span class="comment">// Empty MBB.</span></div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  --<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>;</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;  <span class="comment">// Skip debug info so it will not affect codegen.</span></div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  <span class="keywordflow">while</span> (I-&gt;isDebugValue()) {</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <span class="keywordflow">if</span> (I==MBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#ab2d91e7bec944efcbc39d8e30644f111">begin</a>())</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;      <span class="keywordflow">return</span> 0;      <span class="comment">// MBB empty except for debug info.</span></div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    --<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>;</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  }</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="BranchFolding_8cpp.html#a27436de2b027bf7b58f23547b654603d">HashMachineInstr</a>(I);</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;}</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="comment">/// ComputeCommonTailLength - Given two machine basic blocks, compute the number</span></div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="comment">/// of instructions they actually have in common together at their end.  Return</span></div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="comment">/// iterators for the first shared instruction in each block.</span></div><div class="line"><a name="l00305"></a><span class="lineno"><a class="line" href="BranchFolding_8cpp.html#a0ff8a27be1a6683026280a4611628562">  305</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">unsigned</span> <a class="code" href="BranchFolding_8cpp.html#a0ff8a27be1a6683026280a4611628562">ComputeCommonTailLength</a>(<a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> *MBB1,</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                                        <a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> *MBB2,</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                                        <a class="code" href="classllvm_1_1MachineBasicBlock.html#ac51be7ff80fe8d6ae5e8c0acb194908a">MachineBasicBlock::iterator</a> &amp;I1,</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;                                        <a class="code" href="classllvm_1_1MachineBasicBlock.html#ac51be7ff80fe8d6ae5e8c0acb194908a">MachineBasicBlock::iterator</a> &amp;I2) {</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;  I1 = MBB1-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#acbc921830578e2741be6549db716c0ce">end</a>();</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  I2 = MBB2-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#acbc921830578e2741be6549db716c0ce">end</a>();</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;  <span class="keywordtype">unsigned</span> TailLen = 0;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;  <span class="keywordflow">while</span> (I1 != MBB1-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#ab2d91e7bec944efcbc39d8e30644f111">begin</a>() &amp;&amp; I2 != MBB2-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#ab2d91e7bec944efcbc39d8e30644f111">begin</a>()) {</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    --I1; --I2;</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    <span class="comment">// Skip debugging pseudos; necessary to avoid changing the code.</span></div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    <span class="keywordflow">while</span> (I1-&gt;isDebugValue()) {</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;      <span class="keywordflow">if</span> (I1==MBB1-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#ab2d91e7bec944efcbc39d8e30644f111">begin</a>()) {</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;        <span class="keywordflow">while</span> (I2-&gt;isDebugValue()) {</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;          <span class="keywordflow">if</span> (I2==MBB2-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#ab2d91e7bec944efcbc39d8e30644f111">begin</a>())</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;            <span class="comment">// I1==DBG at begin; I2==DBG at begin</span></div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;            <span class="keywordflow">return</span> TailLen;</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;          --I2;</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;        }</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;        ++I2;</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        <span class="comment">// I1==DBG at begin; I2==non-DBG, or first of DBGs not at begin</span></div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        <span class="keywordflow">return</span> TailLen;</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;      }</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;      --I1;</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    }</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <span class="comment">// I1==first (untested) non-DBG preceding known match</span></div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <span class="keywordflow">while</span> (I2-&gt;isDebugValue()) {</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;      <span class="keywordflow">if</span> (I2==MBB2-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#ab2d91e7bec944efcbc39d8e30644f111">begin</a>()) {</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        ++I1;</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;        <span class="comment">// I1==non-DBG, or first of DBGs not at begin; I2==DBG at begin</span></div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;        <span class="keywordflow">return</span> TailLen;</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;      }</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;      --I2;</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    }</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <span class="comment">// I1, I2==first (untested) non-DBGs preceding known match</span></div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <span class="keywordflow">if</span> (!I1-&gt;isIdenticalTo(I2) ||</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        <span class="comment">// FIXME: This check is dubious. It&#39;s used to get around a problem where</span></div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;        <span class="comment">// people incorrectly expect inline asm directives to remain in the same</span></div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;        <span class="comment">// relative order. This is untenable because normal compiler</span></div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;        <span class="comment">// optimizations (like this one) may reorder and/or merge these</span></div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        <span class="comment">// directives.</span></div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;        I1-&gt;isInlineAsm()) {</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;      ++I1; ++I2;</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    }</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    ++TailLen;</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;  }</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;  <span class="comment">// Back past possible debugging pseudos at beginning of block.  This matters</span></div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;  <span class="comment">// when one block differs from the other only by whether debugging pseudos</span></div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;  <span class="comment">// are present at the beginning.  (This way, the various checks later for</span></div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;  <span class="comment">// I1==MBB1-&gt;begin() work as expected.)</span></div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;  <span class="keywordflow">if</span> (I1 == MBB1-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#ab2d91e7bec944efcbc39d8e30644f111">begin</a>() &amp;&amp; I2 != MBB2-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#ab2d91e7bec944efcbc39d8e30644f111">begin</a>()) {</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    --I2;</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <span class="keywordflow">while</span> (I2-&gt;isDebugValue()) {</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;      <span class="keywordflow">if</span> (I2 == MBB2-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#ab2d91e7bec944efcbc39d8e30644f111">begin</a>())</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;        <span class="keywordflow">return</span> TailLen;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;      --I2;</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    }</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    ++I2;</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;  }</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;  <span class="keywordflow">if</span> (I2 == MBB2-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#ab2d91e7bec944efcbc39d8e30644f111">begin</a>() &amp;&amp; I1 != MBB1-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#ab2d91e7bec944efcbc39d8e30644f111">begin</a>()) {</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    --I1;</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <span class="keywordflow">while</span> (I1-&gt;isDebugValue()) {</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;      <span class="keywordflow">if</span> (I1 == MBB1-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#ab2d91e7bec944efcbc39d8e30644f111">begin</a>())</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;        <span class="keywordflow">return</span> TailLen;</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;      --I1;</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    }</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    ++I1;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;  }</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;  <span class="keywordflow">return</span> TailLen;</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;}</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="keywordtype">void</span> BranchFolder::MaintainLiveIns(<a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> *CurMBB,</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;                                   <a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> *NewMBB) {</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;  <span class="keywordflow">if</span> (RS) {</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    RS-&gt;enterBasicBlock(CurMBB);</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    <span class="keywordflow">if</span> (!CurMBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#aa37d95a1d7bc824da0c596d8334c4ceb">empty</a>())</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;      RS-&gt;forward(<a class="code" href="namespacellvm.html#a7923e3e207de8bc1d0d6a5091316ddde">prior</a>(CurMBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#acbc921830578e2741be6549db716c0ce">end</a>()));</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    <a class="code" href="classllvm_1_1BitVector.html">BitVector</a> RegsLiveAtExit(TRI-&gt;getNumRegs());</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    RS-&gt;getRegsUsed(RegsLiveAtExit, <span class="keyword">false</span>);</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0, e = TRI-&gt;getNumRegs(); <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != e; <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;      <span class="keywordflow">if</span> (RegsLiveAtExit[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>])</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;        NewMBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#ae26efdb76d5c56388c65dc5b02a2ae6f">addLiveIn</a>(i);</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;  }</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;}</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="comment">/// ReplaceTailWithBranchTo - Delete the instruction OldInst and everything</span></div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="comment">/// after it, replacing it with an unconditional branch to NewDest.</span></div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="comment"></span><span class="keywordtype">void</span> BranchFolder::ReplaceTailWithBranchTo(<a class="code" href="classllvm_1_1MachineBasicBlock.html#ac51be7ff80fe8d6ae5e8c0acb194908a">MachineBasicBlock::iterator</a> OldInst,</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;                                           <a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> *NewDest) {</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;  <a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> *CurMBB = OldInst-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#af2e482ff2a9253ec6bc2285491496bd6">getParent</a>();</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;  <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>-&gt;ReplaceTailWithBranchTo(OldInst, NewDest);</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;  <span class="comment">// For targets that use the register scavenger, we must maintain LiveIns.</span></div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;  MaintainLiveIns(CurMBB, NewDest);</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;  ++NumTailMerge;</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;}</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;<span class="comment">/// SplitMBBAt - Given a machine basic block and an iterator into it, split the</span></div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;<span class="comment">/// MBB so that the part before the iterator falls into the part starting at the</span></div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="comment">/// iterator.  This returns the new MBB.</span></div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;<span class="comment"></span><a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> *BranchFolder::SplitMBBAt(<a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> &amp;CurMBB,</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;                                            <a class="code" href="classllvm_1_1MachineBasicBlock.html#ac51be7ff80fe8d6ae5e8c0acb194908a">MachineBasicBlock::iterator</a> BBI1,</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;                                            <span class="keyword">const</span> <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>) {</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>-&gt;isLegalToSplitMBBAt(CurMBB, BBI1))</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;  <a class="code" href="classllvm_1_1MachineFunction.html">MachineFunction</a> &amp;MF = *CurMBB.<a class="code" href="classllvm_1_1MachineBasicBlock.html#af2e482ff2a9253ec6bc2285491496bd6">getParent</a>();</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;  <span class="comment">// Create the fall-through block.</span></div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;  <a class="code" href="classllvm_1_1MachineFunction.html#a340712de3e78fec11c338735cab17df7">MachineFunction::iterator</a> MBBI = &amp;CurMBB;</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;  <a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> *NewMBB =MF.<a class="code" href="classllvm_1_1MachineFunction.html#ab2a56feb4fe943ae2362d61f3a43acca">CreateMachineBasicBlock</a>(BB);</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;  CurMBB.<a class="code" href="classllvm_1_1MachineBasicBlock.html#af2e482ff2a9253ec6bc2285491496bd6">getParent</a>()-&gt;<a class="code" href="classllvm_1_1MachineFunction.html#af4c0db6d503e0ba3b8e44067023ffbba">insert</a>(++MBBI, NewMBB);</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;  <span class="comment">// Move all the successors of this block to the specified block.</span></div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;  NewMBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#a3c5c3bd0c015f3134dc19fe194f635dd">transferSuccessors</a>(&amp;CurMBB);</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;  <span class="comment">// Add an edge from CurMBB to NewMBB for the fall-through.</span></div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;  CurMBB.<a class="code" href="classllvm_1_1MachineBasicBlock.html#a3fcc360e6de146a370e8b0deecfa877f">addSuccessor</a>(NewMBB);</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;  <span class="comment">// Splice the code over.</span></div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;  NewMBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#adf0023bdc4f05a7849c35b1c859580d8">splice</a>(NewMBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#acbc921830578e2741be6549db716c0ce">end</a>(), &amp;CurMBB, BBI1, CurMBB.<a class="code" href="classllvm_1_1MachineBasicBlock.html#acbc921830578e2741be6549db716c0ce">end</a>());</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;  <span class="comment">// For targets that use the register scavenger, we must maintain LiveIns.</span></div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;  MaintainLiveIns(&amp;CurMBB, NewMBB);</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;  <span class="keywordflow">return</span> NewMBB;</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;}</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;<span class="comment">/// EstimateRuntime - Make a rough estimate for how long it will take to run</span></div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="comment">/// the specified code.</span></div><div class="line"><a name="l00438"></a><span class="lineno"><a class="line" href="BranchFolding_8cpp.html#a0df528512b8aed2e9f70a3f9b3128507">  438</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">unsigned</span> <a class="code" href="BranchFolding_8cpp.html#a0df528512b8aed2e9f70a3f9b3128507">EstimateRuntime</a>(<a class="code" href="classllvm_1_1MachineBasicBlock.html#ac51be7ff80fe8d6ae5e8c0acb194908a">MachineBasicBlock::iterator</a> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>,</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;                                <a class="code" href="classllvm_1_1MachineBasicBlock.html#ac51be7ff80fe8d6ae5e8c0acb194908a">MachineBasicBlock::iterator</a> E) {</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;  <span class="keywordtype">unsigned</span> Time = 0;</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;  <span class="keywordflow">for</span> (; I != E; ++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    <span class="keywordflow">if</span> (I-&gt;isDebugValue())</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    <span class="keywordflow">if</span> (I-&gt;isCall())</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;      Time += 10;</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (I-&gt;mayLoad() || I-&gt;mayStore())</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;      Time += 2;</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;      ++Time;</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;  }</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;  <span class="keywordflow">return</span> Time;</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;}</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="comment">// CurMBB needs to add an unconditional branch to SuccMBB (we removed these</span></div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;<span class="comment">// branches temporarily for tail merging).  In the case where CurMBB ends</span></div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;<span class="comment">// with a conditional branch to the next block, optimize by reversing the</span></div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;<span class="comment">// test and conditionally branching to SuccMBB instead.</span></div><div class="line"><a name="l00458"></a><span class="lineno"><a class="line" href="BranchFolding_8cpp.html#a653145c23a36602493bb8dae8ef3d73b">  458</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="BranchFolding_8cpp.html#a653145c23a36602493bb8dae8ef3d73b">FixTail</a>(<a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> *CurMBB, <a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> *SuccBB,</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;                    <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetInstrInfo.html">TargetInstrInfo</a> *<a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>) {</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;  <a class="code" href="classllvm_1_1MachineFunction.html">MachineFunction</a> *MF = CurMBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#af2e482ff2a9253ec6bc2285491496bd6">getParent</a>();</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;  <a class="code" href="classllvm_1_1MachineFunction.html#a340712de3e78fec11c338735cab17df7">MachineFunction::iterator</a> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = <a class="code" href="namespacellvm.html#aa1704159f75e6eacd595962ea6d93ffe">llvm::next</a>(<a class="code" href="classllvm_1_1MachineFunction.html#a340712de3e78fec11c338735cab17df7">MachineFunction::iterator</a>(CurMBB));</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;  <a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> *TBB = 0, *FBB = 0;</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;MachineOperand, 4&gt;</a> Cond;</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;  <a class="code" href="classllvm_1_1DebugLoc.html">DebugLoc</a> dl;  <span class="comment">// FIXME: this is nowhere</span></div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;  <span class="keywordflow">if</span> (I != MF-&gt;<a class="code" href="classllvm_1_1MachineFunction.html#a9d017af749f76484cb9aec9ff6e4330c">end</a>() &amp;&amp;</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;      !TII-&gt;<a class="code" href="classllvm_1_1TargetInstrInfo.html#a641441a84a88e01223f3c091dfb50694">AnalyzeBranch</a>(*CurMBB, TBB, FBB, Cond, <span class="keyword">true</span>)) {</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    <a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> *NextBB = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>;</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    <span class="keywordflow">if</span> (TBB == NextBB &amp;&amp; !Cond.<a class="code" href="classllvm_1_1SmallVectorBase.html#a8a8df4d85555c7954a95f86080cd3b64">empty</a>() &amp;&amp; !FBB) {</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;      <span class="keywordflow">if</span> (!TII-&gt;<a class="code" href="classllvm_1_1TargetInstrInfo.html#a051d866f5c8c28d14ebe529a33f5f7b1">ReverseBranchCondition</a>(Cond)) {</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;        TII-&gt;<a class="code" href="classllvm_1_1TargetInstrInfo.html#abce62a681f245fc78059890e4ca83210">RemoveBranch</a>(*CurMBB);</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;        TII-&gt;<a class="code" href="classllvm_1_1TargetInstrInfo.html#a8afe41bda071ea77c815f7bd436fdd82">InsertBranch</a>(*CurMBB, SuccBB, NULL, Cond, dl);</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;      }</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    }</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;  }</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;  TII-&gt;<a class="code" href="classllvm_1_1TargetInstrInfo.html#a8afe41bda071ea77c815f7bd436fdd82">InsertBranch</a>(*CurMBB, SuccBB, NULL,</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;                    <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;MachineOperand, 0&gt;</a>(), dl);</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;}</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;<span class="keywordtype">bool</span></div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;<a class="code" href="namespacellvm.html#a7c469a194119a14e5a018ebb9b847cf0">BranchFolder::MergePotentialsElt::operator&lt;</a>(<span class="keyword">const</span> MergePotentialsElt &amp;o)<span class="keyword"> const </span>{</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="EarlyCSE_8cpp.html#ad83feaec7dc68d46074ce2a1b69ceb9a">getHash</a>() &lt; o.getHash())</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="EarlyCSE_8cpp.html#ad83feaec7dc68d46074ce2a1b69ceb9a">getHash</a>() &gt; o.getHash())</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;  <span class="keywordflow">if</span> (getBlock()-&gt;getNumber() &lt; o.getBlock()-&gt;getNumber())</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;  <span class="keywordflow">if</span> (getBlock()-&gt;getNumber() &gt; o.getBlock()-&gt;getNumber())</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;  <span class="comment">// _GLIBCXX_DEBUG checks strict weak ordering, which involves comparing</span></div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;  <span class="comment">// an object with itself.</span></div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;<span class="preprocessor">#ifndef _GLIBCXX_DEBUG</span></div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;  <a class="code" href="ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a>(<span class="stringliteral">&quot;Predecessor appears twice&quot;</span>);</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;}</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;<span class="comment">/// CountTerminators - Count the number of terminators in the given</span></div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;<span class="comment">/// block and set I to the position of the first non-terminator, if there</span></div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;<span class="comment">/// is one, or MBB-&gt;end() otherwise.</span></div><div class="line"><a name="l00502"></a><span class="lineno"><a class="line" href="BranchFolding_8cpp.html#a3a41d2e125b5d09248ee68674761fb14">  502</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">unsigned</span> <a class="code" href="BranchFolding_8cpp.html#a3a41d2e125b5d09248ee68674761fb14">CountTerminators</a>(<a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> *MBB,</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;                                 <a class="code" href="classllvm_1_1MachineBasicBlock.html#ac51be7ff80fe8d6ae5e8c0acb194908a">MachineBasicBlock::iterator</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;  I = MBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#acbc921830578e2741be6549db716c0ce">end</a>();</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;  <span class="keywordtype">unsigned</span> NumTerms = 0;</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;  <span class="keywordflow">for</span> (;;) {</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    <span class="keywordflow">if</span> (I == MBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#ab2d91e7bec944efcbc39d8e30644f111">begin</a>()) {</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;      I = MBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#acbc921830578e2741be6549db716c0ce">end</a>();</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    }</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    --<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>;</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    <span class="keywordflow">if</span> (!I-&gt;isTerminator()) <span class="keywordflow">break</span>;</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    ++NumTerms;</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;  }</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;  <span class="keywordflow">return</span> NumTerms;</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;}</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<span class="comment">/// ProfitableToMerge - Check if two machine basic blocks have a common tail</span></div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;<span class="comment">/// and decide if it would be profitable to merge those tails.  Return the</span></div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;<span class="comment">/// length of the common tail and iterators to the first common instruction</span></div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;<span class="comment">/// in each block.</span></div><div class="line"><a name="l00522"></a><span class="lineno"><a class="line" href="BranchFolding_8cpp.html#a0a05cc04c5d50a14920721da5f53e1fe">  522</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="BranchFolding_8cpp.html#a0a05cc04c5d50a14920721da5f53e1fe">ProfitableToMerge</a>(<a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> *MBB1,</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;                              <a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> *MBB2,</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;                              <span class="keywordtype">unsigned</span> minCommonTailLength,</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;                              <span class="keywordtype">unsigned</span> &amp;CommonTailLen,</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;                              <a class="code" href="classllvm_1_1MachineBasicBlock.html#ac51be7ff80fe8d6ae5e8c0acb194908a">MachineBasicBlock::iterator</a> &amp;I1,</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;                              <a class="code" href="classllvm_1_1MachineBasicBlock.html#ac51be7ff80fe8d6ae5e8c0acb194908a">MachineBasicBlock::iterator</a> &amp;I2,</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;                              <a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> *SuccBB,</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;                              <a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> *PredBB) {</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;  CommonTailLen = <a class="code" href="BranchFolding_8cpp.html#a0ff8a27be1a6683026280a4611628562">ComputeCommonTailLength</a>(MBB1, MBB2, I1, I2);</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;  <span class="keywordflow">if</span> (CommonTailLen == 0)</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;  <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Common tail length of BB#&quot;</span> &lt;&lt; MBB1-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#a6acda287e5c19ffb173b0bf8f1dd9c5e">getNumber</a>()</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;               &lt;&lt; <span class="stringliteral">&quot; and BB#&quot;</span> &lt;&lt; MBB2-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#a6acda287e5c19ffb173b0bf8f1dd9c5e">getNumber</a>() &lt;&lt; <span class="stringliteral">&quot; is &quot;</span> &lt;&lt; CommonTailLen</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;               &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>);</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;  <span class="comment">// It&#39;s almost always profitable to merge any number of non-terminator</span></div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;  <span class="comment">// instructions with the block that falls through into the common successor.</span></div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;  <span class="keywordflow">if</span> (MBB1 == PredBB || MBB2 == PredBB) {</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    <a class="code" href="classllvm_1_1MachineBasicBlock.html#ac51be7ff80fe8d6ae5e8c0acb194908a">MachineBasicBlock::iterator</a> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>;</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    <span class="keywordtype">unsigned</span> NumTerms = <a class="code" href="BranchFolding_8cpp.html#a3a41d2e125b5d09248ee68674761fb14">CountTerminators</a>(MBB1 == PredBB ? MBB2 : MBB1, I);</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    <span class="keywordflow">if</span> (CommonTailLen &gt; NumTerms)</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;  }</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;  <span class="comment">// If one of the blocks can be completely merged and happens to be in</span></div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;  <span class="comment">// a position where the other could fall through into it, merge any number</span></div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;  <span class="comment">// of instructions, because it can be done without a branch.</span></div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;  <span class="comment">// TODO: If the blocks are not adjacent, move one of them so that they are?</span></div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;  <span class="keywordflow">if</span> (MBB1-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#a0fc7a349a4ab737607def6cb461791fd">isLayoutSuccessor</a>(MBB2) &amp;&amp; I2 == MBB2-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#ab2d91e7bec944efcbc39d8e30644f111">begin</a>())</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;  <span class="keywordflow">if</span> (MBB2-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#a0fc7a349a4ab737607def6cb461791fd">isLayoutSuccessor</a>(MBB1) &amp;&amp; I1 == MBB1-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#ab2d91e7bec944efcbc39d8e30644f111">begin</a>())</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;  <span class="comment">// If both blocks have an unconditional branch temporarily stripped out,</span></div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;  <span class="comment">// count that as an additional common instruction for the following</span></div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;  <span class="comment">// heuristics.</span></div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;  <span class="keywordtype">unsigned</span> EffectiveTailLen = CommonTailLen;</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;  <span class="keywordflow">if</span> (SuccBB &amp;&amp; MBB1 != PredBB &amp;&amp; MBB2 != PredBB &amp;&amp;</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;      !MBB1-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#ace3ed0412f841777b7de55d47883890e">back</a>().<a class="code" href="classllvm_1_1MachineInstr.html#a5ca4eb718a8caedcad900fd7cd937cac">isBarrier</a>() &amp;&amp;</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;      !MBB2-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#ace3ed0412f841777b7de55d47883890e">back</a>().<a class="code" href="classllvm_1_1MachineInstr.html#a5ca4eb718a8caedcad900fd7cd937cac">isBarrier</a>())</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    ++EffectiveTailLen;</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;  <span class="comment">// Check if the common tail is long enough to be worthwhile.</span></div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;  <span class="keywordflow">if</span> (EffectiveTailLen &gt;= minCommonTailLength)</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;  <span class="comment">// If we are optimizing for code size, 2 instructions in common is enough if</span></div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;  <span class="comment">// we don&#39;t have to split a block.  At worst we will be introducing 1 new</span></div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;  <span class="comment">// branch instruction, which is likely to be smaller than the 2</span></div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;  <span class="comment">// instructions that would be deleted in the merge.</span></div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;  <a class="code" href="classllvm_1_1MachineFunction.html">MachineFunction</a> *MF = MBB1-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#af2e482ff2a9253ec6bc2285491496bd6">getParent</a>();</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;  <span class="keywordflow">if</span> (EffectiveTailLen &gt;= 2 &amp;&amp;</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;      MF-&gt;<a class="code" href="classllvm_1_1MachineFunction.html#ad784a6594990530bffb2018aeeed56f3">getFunction</a>()-&gt;<a class="code" href="classllvm_1_1Function.html#a72873ed64b7be01507a2248b8e756ec8">getAttributes</a>().</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;        hasAttribute(AttributeSet::FunctionIndex, <a class="code" href="classllvm_1_1Attribute.html#aab7ee4b8fd1d3e7e4cea87868855e60ea2ac83e0612ce8f8d69651cd529061feb">Attribute::OptimizeForSize</a>) &amp;&amp;</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;      (I1 == MBB1-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#ab2d91e7bec944efcbc39d8e30644f111">begin</a>() || I2 == MBB2-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#ab2d91e7bec944efcbc39d8e30644f111">begin</a>()))</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;}</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;<span class="comment">/// ComputeSameTails - Look through all the blocks in MergePotentials that have</span></div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;<span class="comment">/// hash CurHash (guaranteed to match the last element).  Build the vector</span></div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;<span class="comment">/// SameTails of all those that have the (same) largest number of instructions</span></div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;<span class="comment">/// in common of any pair of these blocks.  SameTails entries contain an</span></div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;<span class="comment">/// iterator into MergePotentials (from which the MachineBasicBlock can be</span></div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;<span class="comment">/// found) and a MachineBasicBlock::iterator into that MBB indicating the</span></div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;<span class="comment">/// instruction where the matching code sequence begins.</span></div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;<span class="comment">/// Order of elements in SameTails is the reverse of the order in which</span></div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;<span class="comment">/// those blocks appear in MergePotentials (where they are not necessarily</span></div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;<span class="comment">/// consecutive).</span></div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;<span class="comment"></span><span class="keywordtype">unsigned</span> BranchFolder::ComputeSameTails(<span class="keywordtype">unsigned</span> CurHash,</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;                                        <span class="keywordtype">unsigned</span> minCommonTailLength,</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;                                        <a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> *SuccBB,</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;                                        <a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> *PredBB) {</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;  <span class="keywordtype">unsigned</span> maxCommonTailLength = 0U;</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;  SameTails.clear();</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;  <a class="code" href="classllvm_1_1MachineBasicBlock.html#ac51be7ff80fe8d6ae5e8c0acb194908a">MachineBasicBlock::iterator</a> TrialBBI1, TrialBBI2;</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;  MPIterator HighestMPIter = <a class="code" href="namespacellvm.html#a7923e3e207de8bc1d0d6a5091316ddde">prior</a>(MergePotentials.end());</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;  <span class="keywordflow">for</span> (MPIterator CurMPIter = <a class="code" href="namespacellvm.html#a7923e3e207de8bc1d0d6a5091316ddde">prior</a>(MergePotentials.end()),</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;                  <a class="code" href="Target_2ARM_2README_8txt.html#a90cca76dd78688687e0d697679dbc799">B</a> = MergePotentials.begin();</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;       CurMPIter != <a class="code" href="Target_2ARM_2README_8txt.html#a90cca76dd78688687e0d697679dbc799">B</a> &amp;&amp; CurMPIter-&gt;getHash() == CurHash;</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;       --CurMPIter) {</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;    <span class="keywordflow">for</span> (MPIterator <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = <a class="code" href="namespacellvm.html#a7923e3e207de8bc1d0d6a5091316ddde">prior</a>(CurMPIter); <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getHash() == CurHash ; --<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;      <span class="keywordtype">unsigned</span> CommonTailLen;</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="BranchFolding_8cpp.html#a0a05cc04c5d50a14920721da5f53e1fe">ProfitableToMerge</a>(CurMPIter-&gt;getBlock(), <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getBlock(),</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;                            minCommonTailLength,</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;                            CommonTailLen, TrialBBI1, TrialBBI2,</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;                            SuccBB, PredBB)) {</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;        <span class="keywordflow">if</span> (CommonTailLen &gt; maxCommonTailLength) {</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;          SameTails.clear();</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;          maxCommonTailLength = CommonTailLen;</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;          HighestMPIter = CurMPIter;</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;          SameTails.push_back(SameTailElt(CurMPIter, TrialBBI1));</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;        }</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;        <span class="keywordflow">if</span> (HighestMPIter == CurMPIter &amp;&amp;</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;            CommonTailLen == maxCommonTailLength)</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;          SameTails.push_back(SameTailElt(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, TrialBBI2));</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;      }</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> == <a class="code" href="Target_2ARM_2README_8txt.html#a90cca76dd78688687e0d697679dbc799">B</a>)</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    }</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;  }</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;  <span class="keywordflow">return</span> maxCommonTailLength;</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;}</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;<span class="comment">/// RemoveBlocksWithHash - Remove all blocks with hash CurHash from</span></div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;<span class="comment">/// MergePotentials, restoring branches at ends of blocks as appropriate.</span></div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;<span class="comment"></span><span class="keywordtype">void</span> BranchFolder::RemoveBlocksWithHash(<span class="keywordtype">unsigned</span> CurHash,</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;                                        <a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> *SuccBB,</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;                                        <a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> *PredBB) {</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;  MPIterator CurMPIter, <a class="code" href="Target_2ARM_2README_8txt.html#a90cca76dd78688687e0d697679dbc799">B</a>;</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;  <span class="keywordflow">for</span> (CurMPIter = <a class="code" href="namespacellvm.html#a7923e3e207de8bc1d0d6a5091316ddde">prior</a>(MergePotentials.end()), B = MergePotentials.begin();</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;       CurMPIter-&gt;getHash() == CurHash;</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;       --CurMPIter) {</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    <span class="comment">// Put the unconditional branch back, if we need one.</span></div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    <a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> *CurMBB = CurMPIter-&gt;getBlock();</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    <span class="keywordflow">if</span> (SuccBB &amp;&amp; CurMBB != PredBB)</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;      <a class="code" href="BranchFolding_8cpp.html#a653145c23a36602493bb8dae8ef3d73b">FixTail</a>(CurMBB, SuccBB, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>);</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;    <span class="keywordflow">if</span> (CurMPIter == B)</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;  }</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;  <span class="keywordflow">if</span> (CurMPIter-&gt;getHash() != CurHash)</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;    CurMPIter++;</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;  MergePotentials.erase(CurMPIter, MergePotentials.end());</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;}</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;<span class="comment">/// CreateCommonTailOnlyBlock - None of the blocks to be tail-merged consist</span></div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;<span class="comment">/// only of the common tail.  Create a block that does by splitting one.</span></div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;<span class="comment"></span><span class="keywordtype">bool</span> BranchFolder::CreateCommonTailOnlyBlock(<a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> *&amp;PredBB,</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;                                             <a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> *SuccBB,</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;                                             <span class="keywordtype">unsigned</span> maxCommonTailLength,</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;                                             <span class="keywordtype">unsigned</span> &amp;commonTailIndex) {</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;  commonTailIndex = 0;</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;  <span class="keywordtype">unsigned</span> TimeEstimate = ~0U;</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0, e = SameTails.size(); <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != e; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;    <span class="comment">// Use PredBB if possible; that doesn&#39;t require a new branch.</span></div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;    <span class="keywordflow">if</span> (SameTails[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>].getBlock() == PredBB) {</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;      commonTailIndex = <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;    }</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;    <span class="comment">// Otherwise, make a (fairly bogus) choice based on estimate of</span></div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    <span class="comment">// how long it will take the various blocks to execute.</span></div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    <span class="keywordtype">unsigned</span> <a class="code" href="Target_2X86_2README_8txt.html#a544ce2b7de50b042a2d052c3d2831598">t</a> = <a class="code" href="BranchFolding_8cpp.html#a0df528512b8aed2e9f70a3f9b3128507">EstimateRuntime</a>(SameTails[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>].getBlock()-&gt;<a class="code" href="namespacellvm_1_1sys_1_1path.html#a33706aab89e700b8f79e1fa6f4f0e3ee">begin</a>(),</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;                                 SameTails[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>].getTailStartPos());</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;    <span class="keywordflow">if</span> (t &lt;= TimeEstimate) {</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;      TimeEstimate = <a class="code" href="Target_2X86_2README_8txt.html#a544ce2b7de50b042a2d052c3d2831598">t</a>;</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;      commonTailIndex = <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    }</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;  }</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;  <a class="code" href="classllvm_1_1MachineBasicBlock.html#ac51be7ff80fe8d6ae5e8c0acb194908a">MachineBasicBlock::iterator</a> BBI =</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;    SameTails[commonTailIndex].getTailStartPos();</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;  <a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> *MBB = SameTails[commonTailIndex].getBlock();</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;  <span class="comment">// If the common tail includes any debug info we will take it pretty</span></div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;  <span class="comment">// randomly from one of the inputs.  Might be better to remove it?</span></div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;  <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;\nSplitting BB#&quot;</span> &lt;&lt; MBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#a6acda287e5c19ffb173b0bf8f1dd9c5e">getNumber</a>() &lt;&lt; <span class="stringliteral">&quot;, size &quot;</span></div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;               &lt;&lt; maxCommonTailLength);</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;  <span class="comment">// If the split block unconditionally falls-thru to SuccBB, it will be</span></div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;  <span class="comment">// merged. In control flow terms it should then take SuccBB&#39;s name. e.g. If</span></div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;  <span class="comment">// SuccBB is an inner loop, the common tail is still part of the inner loop.</span></div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *BB = (SuccBB &amp;&amp; MBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#a9ac05913a143322136efcad10ed7548c">succ_size</a>() == 1) ?</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    SuccBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#a2961c31b29db17a4f2964899c8569a64">getBasicBlock</a>() : MBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#a2961c31b29db17a4f2964899c8569a64">getBasicBlock</a>();</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;  <a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> *newMBB = SplitMBBAt(*MBB, BBI, BB);</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;  <span class="keywordflow">if</span> (!newMBB) {</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;... failed!&quot;</span>);</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;  }</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;  SameTails[commonTailIndex].setBlock(newMBB);</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;  SameTails[commonTailIndex].setTailStartPos(newMBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#ab2d91e7bec944efcbc39d8e30644f111">begin</a>());</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;  <span class="comment">// If we split PredBB, newMBB is the new predecessor.</span></div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;  <span class="keywordflow">if</span> (PredBB == MBB)</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;    PredBB = newMBB;</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;}</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;<span class="comment">// See if any of the blocks in MergePotentials (which all have a common single</span></div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;<span class="comment">// successor, or all have no successor) can be tail-merged.  If there is a</span></div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;<span class="comment">// successor, any blocks in MergePotentials that are not tail-merged and</span></div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;<span class="comment">// are not immediately before Succ must have an unconditional branch to</span></div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;<span class="comment">// Succ added (but the predecessor/successor lists need no adjustment).</span></div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;<span class="comment">// The lone predecessor of Succ that falls through into Succ,</span></div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;<span class="comment">// if any, is given in PredBB.</span></div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;<span class="keywordtype">bool</span> BranchFolder::TryTailMergeBlocks(<a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> *SuccBB,</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;                                      <a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> *PredBB) {</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;  <span class="keywordtype">bool</span> MadeChange = <span class="keyword">false</span>;</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;  <span class="comment">// Except for the special cases below, tail-merge if there are at least</span></div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;  <span class="comment">// this many instructions in common.</span></div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;  <span class="keywordtype">unsigned</span> minCommonTailLength = <a class="code" href="BranchFolding_8cpp.html#a287825ab3d1df2312dfb4c694a70cf43">TailMergeSize</a>;</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;  <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;\nTryTailMergeBlocks: &quot;</span>;</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0, e = MergePotentials.size(); <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != e; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;          <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;BB#&quot;</span> &lt;&lt; MergePotentials[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>].getBlock()-&gt;getNumber()</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;                 &lt;&lt; (<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> == e-1 ? <span class="stringliteral">&quot;&quot;</span> : <span class="stringliteral">&quot;, &quot;</span>);</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;        <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;        <span class="keywordflow">if</span> (SuccBB) {</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;          <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;  with successor BB#&quot;</span> &lt;&lt; SuccBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#a6acda287e5c19ffb173b0bf8f1dd9c5e">getNumber</a>() &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;          <span class="keywordflow">if</span> (PredBB)</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;            <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;  which has fall-through from BB#&quot;</span></div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;                   &lt;&lt; PredBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#a6acda287e5c19ffb173b0bf8f1dd9c5e">getNumber</a>() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;        }</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;        <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Looking for common tails of at least &quot;</span></div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;               &lt;&lt; minCommonTailLength &lt;&lt; <span class="stringliteral">&quot; instruction&quot;</span></div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;               &lt;&lt; (minCommonTailLength == 1 ? <span class="stringliteral">&quot;&quot;</span> : <span class="stringliteral">&quot;s&quot;</span>) &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;       );</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;  <span class="comment">// Sort by hash value so that blocks with identical end sequences sort</span></div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;  <span class="comment">// together.</span></div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;  std::stable_sort(MergePotentials.begin(), MergePotentials.end());</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;  <span class="comment">// Walk through equivalence sets looking for actual exact matches.</span></div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;  <span class="keywordflow">while</span> (MergePotentials.size() &gt; 1) {</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;    <span class="keywordtype">unsigned</span> CurHash = MergePotentials.back().getHash();</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;    <span class="comment">// Build SameTails, identifying the set of blocks with this hash code</span></div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;    <span class="comment">// and with the maximum number of instructions in common.</span></div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;    <span class="keywordtype">unsigned</span> maxCommonTailLength = ComputeSameTails(CurHash,</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;                                                    minCommonTailLength,</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;                                                    SuccBB, PredBB);</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;    <span class="comment">// If we didn&#39;t find any pair that has at least minCommonTailLength</span></div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;    <span class="comment">// instructions in common, remove all blocks with this hash code and retry.</span></div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;    <span class="keywordflow">if</span> (SameTails.empty()) {</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;      RemoveBlocksWithHash(CurHash, SuccBB, PredBB);</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;    }</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;    <span class="comment">// If one of the blocks is the entire common tail (and not the entry</span></div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;    <span class="comment">// block, which we can&#39;t jump to), we can treat all blocks with this same</span></div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;    <span class="comment">// tail at once.  Use PredBB if that is one of the possibilities, as that</span></div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;    <span class="comment">// will not introduce any extra branches.</span></div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;    <a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> *EntryBB = MergePotentials.<a class="code" href="classllvm_1_1MachineBasicBlock.html#ab2d91e7bec944efcbc39d8e30644f111">begin</a>()-&gt;getBlock()-&gt;</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;                                 <a class="code" href="BasicAliasAnalysis_8cpp.html#a2675de1d8479c7b00387979714da43f7">getParent</a>()-&gt;<a class="code" href="classllvm_1_1Function.html#a88a5e60837674780a9d812d661897ac5">begin</a>();</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;    <span class="keywordtype">unsigned</span> commonTailIndex = SameTails.size();</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;    <span class="comment">// If there are two blocks, check to see if one can be made to fall through</span></div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;    <span class="comment">// into the other.</span></div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;    <span class="keywordflow">if</span> (SameTails.size() == 2 &amp;&amp;</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;        SameTails[0].getBlock()-&gt;isLayoutSuccessor(SameTails[1].getBlock()) &amp;&amp;</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;        SameTails[1].tailIsWholeBlock())</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;      commonTailIndex = 1;</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (SameTails.size() == 2 &amp;&amp;</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;             SameTails[1].getBlock()-&gt;isLayoutSuccessor(</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;                                                     SameTails[0].getBlock()) &amp;&amp;</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;             SameTails[0].tailIsWholeBlock())</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;      commonTailIndex = 0;</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;    <span class="keywordflow">else</span> {</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;      <span class="comment">// Otherwise just pick one, favoring the fall-through predecessor if</span></div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;      <span class="comment">// there is one.</span></div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0, e = SameTails.size(); <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != e; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;        <a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> *MBB = SameTails[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>].getBlock();</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;        <span class="keywordflow">if</span> (MBB == EntryBB &amp;&amp; SameTails[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>].tailIsWholeBlock())</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;          <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;        <span class="keywordflow">if</span> (MBB == PredBB) {</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;          commonTailIndex = <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;          <span class="keywordflow">break</span>;</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;        }</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;        <span class="keywordflow">if</span> (SameTails[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>].tailIsWholeBlock())</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;          commonTailIndex = <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;      }</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;    }</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;    <span class="keywordflow">if</span> (commonTailIndex == SameTails.size() ||</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;        (SameTails[commonTailIndex].getBlock() == PredBB &amp;&amp;</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;         !SameTails[commonTailIndex].tailIsWholeBlock())) {</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;      <span class="comment">// None of the blocks consist entirely of the common tail.</span></div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;      <span class="comment">// Split a block so that one does.</span></div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;      <span class="keywordflow">if</span> (!CreateCommonTailOnlyBlock(PredBB, SuccBB,</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;                                     maxCommonTailLength, commonTailIndex)) {</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;        RemoveBlocksWithHash(CurHash, SuccBB, PredBB);</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;      }</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;    }</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;    <a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> *MBB = SameTails[commonTailIndex].getBlock();</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;    <span class="comment">// MBB is common tail.  Adjust all other BB&#39;s to jump to this one.</span></div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;    <span class="comment">// Traversal must be forwards so erases work.</span></div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;    <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;\nUsing common tail in BB#&quot;</span> &lt;&lt; MBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#a6acda287e5c19ffb173b0bf8f1dd9c5e">getNumber</a>()</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot; for &quot;</span>);</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>=0, e = SameTails.size(); <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != e; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;      <span class="keywordflow">if</span> (commonTailIndex == <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;      <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;BB#&quot;</span> &lt;&lt; SameTails[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>].getBlock()-&gt;getNumber()</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;                   &lt;&lt; (<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> == e-1 ? <span class="stringliteral">&quot;&quot;</span> : <span class="stringliteral">&quot;, &quot;</span>));</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;      <span class="comment">// Hack the end off BB i, making it jump to BB commonTailIndex instead.</span></div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;      ReplaceTailWithBranchTo(SameTails[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>].getTailStartPos(), MBB);</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;      <span class="comment">// BB i is no longer a predecessor of SuccBB; remove it from the worklist.</span></div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;      MergePotentials.erase(SameTails[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>].getMPIter());</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;    }</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;    <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;    <span class="comment">// We leave commonTailIndex in the worklist in case there are other blocks</span></div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;    <span class="comment">// that match it with a smaller number of instructions.</span></div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;    MadeChange = <span class="keyword">true</span>;</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;  }</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;  <span class="keywordflow">return</span> MadeChange;</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;}</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;<span class="keywordtype">bool</span> BranchFolder::TailMergeBlocks(<a class="code" href="classllvm_1_1MachineFunction.html">MachineFunction</a> &amp;MF) {</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;  <span class="keywordtype">bool</span> MadeChange = <span class="keyword">false</span>;</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;  <span class="keywordflow">if</span> (!EnableTailMerge) <span class="keywordflow">return</span> MadeChange;</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;  <span class="comment">// First find blocks with no successors.</span></div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;  MergePotentials.clear();</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1MachineFunction.html#a340712de3e78fec11c338735cab17df7">MachineFunction::iterator</a> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = MF.<a class="code" href="classllvm_1_1MachineFunction.html#ab0789854909cf47f640a85fa2bac29c7">begin</a>(), E = MF.<a class="code" href="classllvm_1_1MachineFunction.html#a9d017af749f76484cb9aec9ff6e4330c">end</a>();</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;       <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> != E &amp;&amp; MergePotentials.size() &lt; <a class="code" href="BranchFolding_8cpp.html#a02dc8f03ab0fbd643e0015ca91923d33">TailMergeThreshold</a>; ++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;    <span class="keywordflow">if</span> (TriedMerging.count(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>))</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;succ_empty())</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;      MergePotentials.push_back(MergePotentialsElt(<a class="code" href="BranchFolding_8cpp.html#a23f0fe5fd9bac0df47092cb480fbe136">HashEndOfMBB</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>), <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>));</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;  }</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;  <span class="comment">// If this is a large problem, avoid visiting the same basic blocks</span></div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;  <span class="comment">// multiple times.</span></div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;  <span class="keywordflow">if</span> (MergePotentials.size() == <a class="code" href="BranchFolding_8cpp.html#a02dc8f03ab0fbd643e0015ca91923d33">TailMergeThreshold</a>)</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0, e = MergePotentials.size(); <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != e; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;      TriedMerging.insert(MergePotentials[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>].getBlock());</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;  <span class="comment">// See if we can do any tail merging on those.</span></div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;  <span class="keywordflow">if</span> (MergePotentials.size() &gt;= 2)</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;    MadeChange |= TryTailMergeBlocks(NULL, NULL);</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;  <span class="comment">// Look at blocks (IBB) with multiple predecessors (PBB).</span></div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;  <span class="comment">// We change each predecessor to a canonical form, by</span></div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;  <span class="comment">// (1) temporarily removing any unconditional branch from the predecessor</span></div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;  <span class="comment">// to IBB, and</span></div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;  <span class="comment">// (2) alter conditional branches so they branch to the other block</span></div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;  <span class="comment">// not IBB; this may require adding back an unconditional branch to IBB</span></div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;  <span class="comment">// later, where there wasn&#39;t one coming in.  E.g.</span></div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;  <span class="comment">//   Bcc IBB</span></div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;  <span class="comment">//   fallthrough to QBB</span></div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;  <span class="comment">// here becomes</span></div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;  <span class="comment">//   Bncc QBB</span></div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;  <span class="comment">// with a conceptual B to IBB after that, which never actually exists.</span></div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;  <span class="comment">// With those changes, we see whether the predecessors&#39; tails match,</span></div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;  <span class="comment">// and merge them if so.  We change things out of canonical form and</span></div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;  <span class="comment">// back to the way they were later in the process.  (OptimizeBranches</span></div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;  <span class="comment">// would undo some of this, but we can&#39;t use it, because we&#39;d get into</span></div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;  <span class="comment">// a compile-time infinite loop repeatedly doing and undoing the same</span></div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;  <span class="comment">// transformations.)</span></div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1MachineFunction.html#a340712de3e78fec11c338735cab17df7">MachineFunction::iterator</a> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = <a class="code" href="namespacellvm.html#aa1704159f75e6eacd595962ea6d93ffe">llvm::next</a>(MF.<a class="code" href="classllvm_1_1MachineFunction.html#ab0789854909cf47f640a85fa2bac29c7">begin</a>()), E = MF.<a class="code" href="classllvm_1_1MachineFunction.html#a9d017af749f76484cb9aec9ff6e4330c">end</a>();</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;       <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> != E; ++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;pred_size() &lt; 2) <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;    <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;MachineBasicBlock *, 8&gt;</a> UniquePreds;</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;    <a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> *IBB = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>;</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;    <a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> *PredBB = <a class="code" href="namespacellvm.html#a7923e3e207de8bc1d0d6a5091316ddde">prior</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;    MergePotentials.clear();</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1MachineBasicBlock.html#a7e7a1a247b7725a24fe19a91f90782cc">MachineBasicBlock::pred_iterator</a> <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a> = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;pred_begin(),</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;           E2 = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;pred_end();</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;         <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a> != E2 &amp;&amp; MergePotentials.size() &lt; <a class="code" href="BranchFolding_8cpp.html#a02dc8f03ab0fbd643e0015ca91923d33">TailMergeThreshold</a>; ++<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>) {</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;      <a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> *PBB = *<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>;</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;      <span class="keywordflow">if</span> (TriedMerging.count(PBB))</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;      <span class="comment">// Skip blocks that loop to themselves, can&#39;t tail merge these.</span></div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;      <span class="keywordflow">if</span> (PBB == IBB)</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;      <span class="comment">// Visit each predecessor only once.</span></div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;      <span class="keywordflow">if</span> (!UniquePreds.<a class="code" href="classllvm_1_1SmallPtrSet.html#a9b6dd0fc7a648a939e571246045b673e">insert</a>(PBB))</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;      <span class="comment">// Skip blocks which may jump to a landing pad. Can&#39;t tail merge these.</span></div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;      <span class="keywordflow">if</span> (PBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#ae89347d3f5dfc901e42b9ec61c46766a">getLandingPadSuccessor</a>())</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;      <a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> *TBB = 0, *FBB = 0;</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;      <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;MachineOperand, 4&gt;</a> Cond;</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>-&gt;<a class="code" href="classllvm_1_1HexagonInstrInfo.html#a6f9cdb0ade88e5375e97bb0905925c5d">AnalyzeBranch</a>(*PBB, TBB, FBB, Cond, <span class="keyword">true</span>)) {</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;        <span class="comment">// Failing case: IBB is the target of a cbr, and we cannot reverse the</span></div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;        <span class="comment">// branch.</span></div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;        <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;MachineOperand, 4&gt;</a> NewCond(Cond);</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;        <span class="keywordflow">if</span> (!Cond.<a class="code" href="classllvm_1_1SmallVectorBase.html#a8a8df4d85555c7954a95f86080cd3b64">empty</a>() &amp;&amp; TBB == IBB) {</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>-&gt;<a class="code" href="classllvm_1_1HexagonInstrInfo.html#ad6aff542dc74ce9024d0de5427339f7c">ReverseBranchCondition</a>(NewCond))</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;          <span class="comment">// This is the QBB case described above</span></div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;          <span class="keywordflow">if</span> (!FBB)</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;            FBB = <a class="code" href="namespacellvm.html#aa1704159f75e6eacd595962ea6d93ffe">llvm::next</a>(<a class="code" href="classllvm_1_1MachineFunction.html#a340712de3e78fec11c338735cab17df7">MachineFunction::iterator</a>(PBB));</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;        }</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;        <span class="comment">// Failing case: the only way IBB can be reached from PBB is via</span></div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;        <span class="comment">// exception handling.  Happens for landing pads.  Would be nice to have</span></div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;        <span class="comment">// a bit in the edge so we didn&#39;t have to do all this.</span></div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;        <span class="keywordflow">if</span> (IBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#a3f522ae33859d693fb5781efe690e9e6">isLandingPad</a>()) {</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;          <a class="code" href="classllvm_1_1MachineFunction.html#a340712de3e78fec11c338735cab17df7">MachineFunction::iterator</a> IP = PBB;  IP++;</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;          <a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> *PredNextBB = NULL;</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;          <span class="keywordflow">if</span> (IP != MF.<a class="code" href="classllvm_1_1MachineFunction.html#a9d017af749f76484cb9aec9ff6e4330c">end</a>())</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;            PredNextBB = IP;</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;          <span class="keywordflow">if</span> (TBB == NULL) {</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;            <span class="keywordflow">if</span> (IBB != PredNextBB)      <span class="comment">// fallthrough</span></div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;              <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;          } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (FBB) {</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;            <span class="keywordflow">if</span> (TBB != IBB &amp;&amp; FBB != IBB)   <span class="comment">// cbr then ubr</span></div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;              <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;          } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Cond.<a class="code" href="classllvm_1_1SmallVectorBase.html#a8a8df4d85555c7954a95f86080cd3b64">empty</a>()) {</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;            <span class="keywordflow">if</span> (TBB != IBB)               <span class="comment">// ubr</span></div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;              <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;          } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;            <span class="keywordflow">if</span> (TBB != IBB &amp;&amp; IBB != PredNextBB)  <span class="comment">// cbr</span></div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;              <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;          }</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;        }</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;        <span class="comment">// Remove the unconditional branch at the end, if any.</span></div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;        <span class="keywordflow">if</span> (TBB &amp;&amp; (Cond.<a class="code" href="classllvm_1_1SmallVectorBase.html#a8a8df4d85555c7954a95f86080cd3b64">empty</a>() || FBB)) {</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;          <a class="code" href="classllvm_1_1DebugLoc.html">DebugLoc</a> dl;  <span class="comment">// FIXME: this is nowhere</span></div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;          <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>-&gt;<a class="code" href="classllvm_1_1HexagonInstrInfo.html#a4a753587c7751fc7804429aec5453c2d">RemoveBranch</a>(*PBB);</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;          <span class="keywordflow">if</span> (!Cond.<a class="code" href="classllvm_1_1SmallVectorBase.html#a8a8df4d85555c7954a95f86080cd3b64">empty</a>())</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;            <span class="comment">// reinsert conditional branch only, for now</span></div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;            <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>-&gt;<a class="code" href="classllvm_1_1HexagonInstrInfo.html#a95f554978b4efc4c1ca8b0ed5e017ff6">InsertBranch</a>(*PBB, (TBB == IBB) ? FBB : TBB, 0, NewCond, dl);</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;        }</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;        MergePotentials.push_back(MergePotentialsElt(<a class="code" href="BranchFolding_8cpp.html#a23f0fe5fd9bac0df47092cb480fbe136">HashEndOfMBB</a>(PBB), *<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>));</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;      }</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;    }</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;    <span class="comment">// If this is a large problem, avoid visiting the same basic blocks multiple</span></div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;    <span class="comment">// times.</span></div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;    <span class="keywordflow">if</span> (MergePotentials.size() == <a class="code" href="BranchFolding_8cpp.html#a02dc8f03ab0fbd643e0015ca91923d33">TailMergeThreshold</a>)</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0, e = MergePotentials.size(); <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != e; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;        TriedMerging.insert(MergePotentials[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>].getBlock());</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;    <span class="keywordflow">if</span> (MergePotentials.size() &gt;= 2)</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;      MadeChange |= TryTailMergeBlocks(IBB, PredBB);</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;    <span class="comment">// Reinsert an unconditional branch if needed. The 1 below can occur as a</span></div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;    <span class="comment">// result of removing blocks in TryTailMergeBlocks.</span></div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;    PredBB = <a class="code" href="namespacellvm.html#a7923e3e207de8bc1d0d6a5091316ddde">prior</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);     <span class="comment">// this may have been changed in TryTailMergeBlocks</span></div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;    <span class="keywordflow">if</span> (MergePotentials.size() == 1 &amp;&amp;</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;        MergePotentials.begin()-&gt;getBlock() != PredBB)</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;      <a class="code" href="BranchFolding_8cpp.html#a653145c23a36602493bb8dae8ef3d73b">FixTail</a>(MergePotentials.begin()-&gt;getBlock(), IBB, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>);</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;  }</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;  <span class="keywordflow">return</span> MadeChange;</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;}</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;<span class="comment">//  Branch Optimization</span></div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;<span class="keywordtype">bool</span> BranchFolder::OptimizeBranches(<a class="code" href="classllvm_1_1MachineFunction.html">MachineFunction</a> &amp;MF) {</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;  <span class="keywordtype">bool</span> MadeChange = <span class="keyword">false</span>;</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;  <span class="comment">// Make sure blocks are numbered in order</span></div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;  MF.<a class="code" href="classllvm_1_1MachineFunction.html#a73ef91cc71d405f55dd5a77ff8ba56ba">RenumberBlocks</a>();</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1MachineFunction.html#a340712de3e78fec11c338735cab17df7">MachineFunction::iterator</a> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = <a class="code" href="namespacellvm.html#aa1704159f75e6eacd595962ea6d93ffe">llvm::next</a>(MF.<a class="code" href="classllvm_1_1MachineFunction.html#ab0789854909cf47f640a85fa2bac29c7">begin</a>()), E = MF.<a class="code" href="classllvm_1_1MachineFunction.html#a9d017af749f76484cb9aec9ff6e4330c">end</a>();</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;       <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> != E; ) {</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;    <a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> *MBB = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>++;</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;    MadeChange |= OptimizeBlock(MBB);</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;    <span class="comment">// If it is dead, remove it.</span></div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;    <span class="keywordflow">if</span> (MBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#ae1612b06274368fe13b574cbd9c4f768">pred_empty</a>()) {</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;      RemoveDeadBlock(MBB);</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;      MadeChange = <span class="keyword">true</span>;</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;      ++NumDeadBlocks;</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;    }</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;  }</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;  <span class="keywordflow">return</span> MadeChange;</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;}</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;<span class="comment">// Blocks should be considered empty if they contain only debug info;</span></div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;<span class="comment">// else the debug info would affect codegen.</span></div><div class="line"><a name="l00990"></a><span class="lineno"><a class="line" href="BranchFolding_8cpp.html#a87d0fbdabd17122a3febe35d7fbefb60">  990</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="BranchFolding_8cpp.html#a87d0fbdabd17122a3febe35d7fbefb60">IsEmptyBlock</a>(<a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> *MBB) {</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;  <span class="keywordflow">if</span> (MBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#aa37d95a1d7bc824da0c596d8334c4ceb">empty</a>())</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1MachineBasicBlock.html#ac51be7ff80fe8d6ae5e8c0acb194908a">MachineBasicBlock::iterator</a> MBBI = MBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#ab2d91e7bec944efcbc39d8e30644f111">begin</a>(), MBBE = MBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#acbc921830578e2741be6549db716c0ce">end</a>();</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;       MBBI!=MBBE; ++MBBI) {</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;    <span class="keywordflow">if</span> (!MBBI-&gt;isDebugValue())</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;  }</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;}</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;<span class="comment">// Blocks with only debug info and branches should be considered the same</span></div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;<span class="comment">// as blocks with only branches.</span></div><div class="line"><a name="l01003"></a><span class="lineno"><a class="line" href="BranchFolding_8cpp.html#ab17cea834a55a63f670e77230917423e"> 1003</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="BranchFolding_8cpp.html#ab17cea834a55a63f670e77230917423e">IsBranchOnlyBlock</a>(<a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> *MBB) {</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;  <a class="code" href="classllvm_1_1MachineBasicBlock.html#ac51be7ff80fe8d6ae5e8c0acb194908a">MachineBasicBlock::iterator</a> MBBI, MBBE;</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;  <span class="keywordflow">for</span> (MBBI = MBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#ab2d91e7bec944efcbc39d8e30644f111">begin</a>(), MBBE = MBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#acbc921830578e2741be6549db716c0ce">end</a>(); MBBI!=MBBE; ++MBBI) {</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;    <span class="keywordflow">if</span> (!MBBI-&gt;isDebugValue())</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;  }</div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;  <span class="keywordflow">return</span> (MBBI-&gt;isBranch());</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;}</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;<span class="comment">/// IsBetterFallthrough - Return true if it would be clearly better to</span></div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;<span class="comment">/// fall-through to MBB1 than to fall through into MBB2.  This has to return</span></div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;<span class="comment">/// a strict ordering, returning true for both (MBB1,MBB2) and (MBB2,MBB1) will</span></div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;<span class="comment">/// result in infinite loops.</span></div><div class="line"><a name="l01016"></a><span class="lineno"><a class="line" href="BranchFolding_8cpp.html#acda790896623fd894c71bf79f1bbcfea"> 1016</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="BranchFolding_8cpp.html#acda790896623fd894c71bf79f1bbcfea">IsBetterFallthrough</a>(<a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> *MBB1,</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;                                <a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> *MBB2) {</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;  <span class="comment">// Right now, we use a simple heuristic.  If MBB2 ends with a call, and</span></div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;  <span class="comment">// MBB1 doesn&#39;t, we prefer to fall through into MBB1.  This allows us to</span></div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;  <span class="comment">// optimize branches that branch to either a return block or an assert block</span></div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;  <span class="comment">// into a fallthrough to the return.</span></div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="BranchFolding_8cpp.html#a87d0fbdabd17122a3febe35d7fbefb60">IsEmptyBlock</a>(MBB1) || <a class="code" href="BranchFolding_8cpp.html#a87d0fbdabd17122a3febe35d7fbefb60">IsEmptyBlock</a>(MBB2)) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;  <span class="comment">// If there is a clear successor ordering we make sure that one block</span></div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;  <span class="comment">// will fall through to the next</span></div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;  <span class="keywordflow">if</span> (MBB1-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#a57f25804288bc580d7b2e4016a38aec9">isSuccessor</a>(MBB2)) <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;  <span class="keywordflow">if</span> (MBB2-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#a57f25804288bc580d7b2e4016a38aec9">isSuccessor</a>(MBB1)) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;  <span class="comment">// Neither block consists entirely of debug info (per IsEmptyBlock check),</span></div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;  <span class="comment">// so we needn&#39;t test for falling off the beginning here.</span></div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;  <a class="code" href="classllvm_1_1MachineBasicBlock.html#ac51be7ff80fe8d6ae5e8c0acb194908a">MachineBasicBlock::iterator</a> MBB1I = --MBB1-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#acbc921830578e2741be6549db716c0ce">end</a>();</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;  <span class="keywordflow">while</span> (MBB1I-&gt;isDebugValue())</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;    --MBB1I;</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;  <a class="code" href="classllvm_1_1MachineBasicBlock.html#ac51be7ff80fe8d6ae5e8c0acb194908a">MachineBasicBlock::iterator</a> MBB2I = --MBB2-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#acbc921830578e2741be6549db716c0ce">end</a>();</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;  <span class="keywordflow">while</span> (MBB2I-&gt;isDebugValue())</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;    --MBB2I;</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;  <span class="keywordflow">return</span> MBB2I-&gt;isCall() &amp;&amp; !MBB1I-&gt;isCall();</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;}</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;<span class="comment">/// getBranchDebugLoc - Find and return, if any, the DebugLoc of the branch</span></div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;<span class="comment">/// instructions on the block. Always use the DebugLoc of the first</span></div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;<span class="comment">/// branching instruction found unless its absent, in which case use the</span></div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;<span class="comment">/// DebugLoc of the second if present.</span></div><div class="line"><a name="l01044"></a><span class="lineno"><a class="line" href="BranchFolding_8cpp.html#aebca59e55e33781db69d5909a2b2bc49"> 1044</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <a class="code" href="classllvm_1_1DebugLoc.html">DebugLoc</a> <a class="code" href="BranchFolding_8cpp.html#aebca59e55e33781db69d5909a2b2bc49">getBranchDebugLoc</a>(<a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> &amp;MBB) {</div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;  <a class="code" href="classllvm_1_1MachineBasicBlock.html#ac51be7ff80fe8d6ae5e8c0acb194908a">MachineBasicBlock::iterator</a> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = MBB.<a class="code" href="classllvm_1_1MachineBasicBlock.html#acbc921830578e2741be6549db716c0ce">end</a>();</div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;  <span class="keywordflow">if</span> (I == MBB.<a class="code" href="classllvm_1_1MachineBasicBlock.html#ab2d91e7bec944efcbc39d8e30644f111">begin</a>())</div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1DebugLoc.html">DebugLoc</a>();</div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;  --<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>;</div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;  <span class="keywordflow">while</span> (I-&gt;isDebugValue() &amp;&amp; I != MBB.<a class="code" href="classllvm_1_1MachineBasicBlock.html#ab2d91e7bec944efcbc39d8e30644f111">begin</a>())</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;    --I;</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;  <span class="keywordflow">if</span> (I-&gt;isBranch())</div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;    <span class="keywordflow">return</span> I-&gt;getDebugLoc();</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1DebugLoc.html">DebugLoc</a>();</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;}</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;<span class="comment">/// OptimizeBlock - Analyze and optimize control flow related to the specified</span></div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;<span class="comment">/// block.  This is never called on the entry block.</span></div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;<span class="comment"></span><span class="keywordtype">bool</span> BranchFolder::OptimizeBlock(<a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> *MBB) {</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;  <span class="keywordtype">bool</span> MadeChange = <span class="keyword">false</span>;</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;  <a class="code" href="classllvm_1_1MachineFunction.html">MachineFunction</a> &amp;MF = *MBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#af2e482ff2a9253ec6bc2285491496bd6">getParent</a>();</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;ReoptimizeBlock:</div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;</div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;  <a class="code" href="classllvm_1_1MachineFunction.html#a340712de3e78fec11c338735cab17df7">MachineFunction::iterator</a> FallThrough = MBB;</div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;  ++FallThrough;</div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;</div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;  <span class="comment">// If this block is empty, make everyone use its fall-through, not the block</span></div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;  <span class="comment">// explicitly.  Landing pads should not do this since the landing-pad table</span></div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;  <span class="comment">// points to this block.  Blocks with their addresses taken shouldn&#39;t be</span></div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;  <span class="comment">// optimized away.</span></div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="BranchFolding_8cpp.html#a87d0fbdabd17122a3febe35d7fbefb60">IsEmptyBlock</a>(MBB) &amp;&amp; !MBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#a3f522ae33859d693fb5781efe690e9e6">isLandingPad</a>() &amp;&amp; !MBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#a9832fb14c5aeb2277bc66d72cc99d105">hasAddressTaken</a>()) {</div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;    <span class="comment">// Dead block?  Leave for cleanup later.</span></div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;    <span class="keywordflow">if</span> (MBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#ae1612b06274368fe13b574cbd9c4f768">pred_empty</a>()) <span class="keywordflow">return</span> MadeChange;</div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;</div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;    <span class="keywordflow">if</span> (FallThrough == MF.<a class="code" href="classllvm_1_1MachineFunction.html#a9d017af749f76484cb9aec9ff6e4330c">end</a>()) {</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;      <span class="comment">// TODO: Simplify preds to not branch here if possible!</span></div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;      <span class="comment">// Rewrite all predecessors of the old block to go to the fallthrough</span></div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;      <span class="comment">// instead.</span></div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;      <span class="keywordflow">while</span> (!MBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#ae1612b06274368fe13b574cbd9c4f768">pred_empty</a>()) {</div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;        <a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> *Pred = *(MBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#a0359a738e0412c5a7ea55d61175e0661">pred_end</a>()-1);</div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;        Pred-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#ab9a54fdc7456ee97cb54ff30d625b6b7">ReplaceUsesOfBlockWith</a>(MBB, FallThrough);</div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;      }</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;      <span class="comment">// If MBB was the target of a jump table, update jump tables to go to the</span></div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;      <span class="comment">// fallthrough instead.</span></div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1MachineJumpTableInfo.html">MachineJumpTableInfo</a> *MJTI = MF.<a class="code" href="classllvm_1_1MachineFunction.html#a99e93c9b5c2f41b3d601d129a6f60a6e">getJumpTableInfo</a>())</div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;        MJTI-&gt;ReplaceMBBInJumpTables(MBB, FallThrough);</div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;      MadeChange = <span class="keyword">true</span>;</div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;    }</div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;    <span class="keywordflow">return</span> MadeChange;</div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;  }</div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;</div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;  <span class="comment">// Check to see if we can simplify the terminator of the block before this</span></div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;  <span class="comment">// one.</span></div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;  <a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> &amp;PrevBB = *<a class="code" href="namespacellvm.html#a7923e3e207de8bc1d0d6a5091316ddde">prior</a>(<a class="code" href="classllvm_1_1MachineFunction.html#a340712de3e78fec11c338735cab17df7">MachineFunction::iterator</a>(MBB));</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;  <a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> *PriorTBB = 0, *PriorFBB = 0;</div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;MachineOperand, 4&gt;</a> PriorCond;</div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;  <span class="keywordtype">bool</span> PriorUnAnalyzable =</div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;    <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>-&gt;<a class="code" href="classllvm_1_1HexagonInstrInfo.html#a6f9cdb0ade88e5375e97bb0905925c5d">AnalyzeBranch</a>(PrevBB, PriorTBB, PriorFBB, PriorCond, <span class="keyword">true</span>);</div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;  <span class="keywordflow">if</span> (!PriorUnAnalyzable) {</div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;    <span class="comment">// If the CFG for the prior block has extra edges, remove them.</span></div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;    MadeChange |= PrevBB.<a class="code" href="classllvm_1_1MachineBasicBlock.html#aa20773d21c44eb6e0e330d96636cc4b0">CorrectExtraCFGEdges</a>(PriorTBB, PriorFBB,</div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;                                              !PriorCond.<a class="code" href="classllvm_1_1SmallVectorBase.html#a8a8df4d85555c7954a95f86080cd3b64">empty</a>());</div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;</div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;    <span class="comment">// If the previous branch is conditional and both conditions go to the same</span></div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;    <span class="comment">// destination, remove the branch, replacing it with an unconditional one or</span></div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;    <span class="comment">// a fall-through.</span></div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;    <span class="keywordflow">if</span> (PriorTBB &amp;&amp; PriorTBB == PriorFBB) {</div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;      <a class="code" href="classllvm_1_1DebugLoc.html">DebugLoc</a> dl = <a class="code" href="BranchFolding_8cpp.html#aebca59e55e33781db69d5909a2b2bc49">getBranchDebugLoc</a>(PrevBB);</div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;      <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>-&gt;<a class="code" href="classllvm_1_1HexagonInstrInfo.html#a4a753587c7751fc7804429aec5453c2d">RemoveBranch</a>(PrevBB);</div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;      PriorCond.<a class="code" href="classllvm_1_1SmallVectorImpl.html#aac0ea55010b7b1a301e65a0baea057aa">clear</a>();</div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;      <span class="keywordflow">if</span> (PriorTBB != MBB)</div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;        <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>-&gt;<a class="code" href="classllvm_1_1HexagonInstrInfo.html#a95f554978b4efc4c1ca8b0ed5e017ff6">InsertBranch</a>(PrevBB, PriorTBB, 0, PriorCond, dl);</div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;      MadeChange = <span class="keyword">true</span>;</div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;      ++NumBranchOpts;</div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;      <span class="keywordflow">goto</span> ReoptimizeBlock;</div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;    }</div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;</div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;    <span class="comment">// If the previous block unconditionally falls through to this block and</span></div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;    <span class="comment">// this block has no other predecessors, move the contents of this block</span></div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;    <span class="comment">// into the prior block. This doesn&#39;t usually happen when SimplifyCFG</span></div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;    <span class="comment">// has been used, but it can happen if tail merging splits a fall-through</span></div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;    <span class="comment">// predecessor of a block.</span></div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;    <span class="comment">// This has to check PrevBB-&gt;succ_size() because EH edges are ignored by</span></div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;    <span class="comment">// AnalyzeBranch.</span></div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;    <span class="keywordflow">if</span> (PriorCond.<a class="code" href="classllvm_1_1SmallVectorBase.html#a8a8df4d85555c7954a95f86080cd3b64">empty</a>() &amp;&amp; !PriorTBB &amp;&amp; MBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#ac9786455bc217ebd35377bb5d5ec8f20">pred_size</a>() == 1 &amp;&amp;</div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;        PrevBB.<a class="code" href="classllvm_1_1MachineBasicBlock.html#a9ac05913a143322136efcad10ed7548c">succ_size</a>() == 1 &amp;&amp;</div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;        !MBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#a9832fb14c5aeb2277bc66d72cc99d105">hasAddressTaken</a>() &amp;&amp; !MBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#a3f522ae33859d693fb5781efe690e9e6">isLandingPad</a>()) {</div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;      <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;\nMerging into block: &quot;</span> &lt;&lt; PrevBB</div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot;From MBB: &quot;</span> &lt;&lt; *MBB);</div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;      <span class="comment">// Remove redundant DBG_VALUEs first.</span></div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;      <span class="keywordflow">if</span> (PrevBB.<a class="code" href="classllvm_1_1MachineBasicBlock.html#ab2d91e7bec944efcbc39d8e30644f111">begin</a>() != PrevBB.<a class="code" href="classllvm_1_1MachineBasicBlock.html#acbc921830578e2741be6549db716c0ce">end</a>()) {</div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;        <a class="code" href="classllvm_1_1MachineBasicBlock.html#ac51be7ff80fe8d6ae5e8c0acb194908a">MachineBasicBlock::iterator</a> PrevBBIter = PrevBB.<a class="code" href="classllvm_1_1MachineBasicBlock.html#acbc921830578e2741be6549db716c0ce">end</a>();</div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;        --PrevBBIter;</div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;        <a class="code" href="classllvm_1_1MachineBasicBlock.html#ac51be7ff80fe8d6ae5e8c0acb194908a">MachineBasicBlock::iterator</a> MBBIter = MBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#ab2d91e7bec944efcbc39d8e30644f111">begin</a>();</div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;        <span class="comment">// Check if DBG_VALUE at the end of PrevBB is identical to the</span></div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;        <span class="comment">// DBG_VALUE at the beginning of MBB.</span></div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;        <span class="keywordflow">while</span> (PrevBBIter != PrevBB.<a class="code" href="classllvm_1_1MachineBasicBlock.html#ab2d91e7bec944efcbc39d8e30644f111">begin</a>() &amp;&amp; MBBIter != MBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#acbc921830578e2741be6549db716c0ce">end</a>()</div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;               &amp;&amp; PrevBBIter-&gt;isDebugValue() &amp;&amp; MBBIter-&gt;isDebugValue()) {</div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;          <span class="keywordflow">if</span> (!MBBIter-&gt;isIdenticalTo(PrevBBIter))</div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;          <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *DuplicateDbg = MBBIter;</div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;          ++MBBIter; -- PrevBBIter;</div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;          DuplicateDbg-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#ac2421adbb9996e1b15f03a8abb6c70a8">eraseFromParent</a>();</div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;        }</div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;      }</div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;      PrevBB.<a class="code" href="classllvm_1_1MachineBasicBlock.html#adf0023bdc4f05a7849c35b1c859580d8">splice</a>(PrevBB.<a class="code" href="classllvm_1_1MachineBasicBlock.html#acbc921830578e2741be6549db716c0ce">end</a>(), MBB, MBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#ab2d91e7bec944efcbc39d8e30644f111">begin</a>(), MBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#acbc921830578e2741be6549db716c0ce">end</a>());</div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;      PrevBB.<a class="code" href="classllvm_1_1MachineBasicBlock.html#aabc149950316b323f9cdac2122ff0131">removeSuccessor</a>(PrevBB.<a class="code" href="classllvm_1_1MachineBasicBlock.html#a6321b189ea8fd5058663f8a87d6c23e9">succ_begin</a>());</div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;      assert(PrevBB.<a class="code" href="classllvm_1_1MachineBasicBlock.html#a1570dd3a2568ba5e52073cdf6d904ee9">succ_empty</a>());</div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;      PrevBB.<a class="code" href="classllvm_1_1MachineBasicBlock.html#a3c5c3bd0c015f3134dc19fe194f635dd">transferSuccessors</a>(MBB);</div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;      MadeChange = <span class="keyword">true</span>;</div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;      <span class="keywordflow">return</span> MadeChange;</div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;    }</div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;</div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;    <span class="comment">// If the previous branch *only* branches to *this* block (conditional or</span></div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;    <span class="comment">// not) remove the branch.</span></div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;    <span class="keywordflow">if</span> (PriorTBB == MBB &amp;&amp; PriorFBB == 0) {</div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;      <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>-&gt;<a class="code" href="classllvm_1_1HexagonInstrInfo.html#a4a753587c7751fc7804429aec5453c2d">RemoveBranch</a>(PrevBB);</div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;      MadeChange = <span class="keyword">true</span>;</div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;      ++NumBranchOpts;</div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;      <span class="keywordflow">goto</span> ReoptimizeBlock;</div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;    }</div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;</div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;    <span class="comment">// If the prior block branches somewhere else on the condition and here if</span></div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;    <span class="comment">// the condition is false, remove the uncond second branch.</span></div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;    <span class="keywordflow">if</span> (PriorFBB == MBB) {</div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;      <a class="code" href="classllvm_1_1DebugLoc.html">DebugLoc</a> dl = <a class="code" href="BranchFolding_8cpp.html#aebca59e55e33781db69d5909a2b2bc49">getBranchDebugLoc</a>(PrevBB);</div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;      <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>-&gt;<a class="code" href="classllvm_1_1HexagonInstrInfo.html#a4a753587c7751fc7804429aec5453c2d">RemoveBranch</a>(PrevBB);</div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;      <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>-&gt;<a class="code" href="classllvm_1_1HexagonInstrInfo.html#a95f554978b4efc4c1ca8b0ed5e017ff6">InsertBranch</a>(PrevBB, PriorTBB, 0, PriorCond, dl);</div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;      MadeChange = <span class="keyword">true</span>;</div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;      ++NumBranchOpts;</div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;      <span class="keywordflow">goto</span> ReoptimizeBlock;</div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;    }</div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;</div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;    <span class="comment">// If the prior block branches here on true and somewhere else on false, and</span></div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;    <span class="comment">// if the branch condition is reversible, reverse the branch to create a</span></div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;    <span class="comment">// fall-through.</span></div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;    <span class="keywordflow">if</span> (PriorTBB == MBB) {</div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;      <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;MachineOperand, 4&gt;</a> NewPriorCond(PriorCond);</div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>-&gt;<a class="code" href="classllvm_1_1HexagonInstrInfo.html#ad6aff542dc74ce9024d0de5427339f7c">ReverseBranchCondition</a>(NewPriorCond)) {</div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;        <a class="code" href="classllvm_1_1DebugLoc.html">DebugLoc</a> dl = <a class="code" href="BranchFolding_8cpp.html#aebca59e55e33781db69d5909a2b2bc49">getBranchDebugLoc</a>(PrevBB);</div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;        <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>-&gt;<a class="code" href="classllvm_1_1HexagonInstrInfo.html#a4a753587c7751fc7804429aec5453c2d">RemoveBranch</a>(PrevBB);</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;        <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>-&gt;<a class="code" href="classllvm_1_1HexagonInstrInfo.html#a95f554978b4efc4c1ca8b0ed5e017ff6">InsertBranch</a>(PrevBB, PriorFBB, 0, NewPriorCond, dl);</div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;        MadeChange = <span class="keyword">true</span>;</div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;        ++NumBranchOpts;</div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;        <span class="keywordflow">goto</span> ReoptimizeBlock;</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;      }</div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;    }</div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;</div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;    <span class="comment">// If this block has no successors (e.g. it is a return block or ends with</span></div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;    <span class="comment">// a call to a no-return function like abort or __cxa_throw) and if the pred</span></div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;    <span class="comment">// falls through into this block, and if it would otherwise fall through</span></div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;    <span class="comment">// into the block after this, move this block to the end of the function.</span></div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;    <span class="comment">//</span></div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;    <span class="comment">// We consider it more likely that execution will stay in the function (e.g.</span></div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;    <span class="comment">// due to loops) than it is to exit it.  This asserts in loops etc, moving</span></div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;    <span class="comment">// the assert condition out of the loop body.</span></div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;    <span class="keywordflow">if</span> (MBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#a1570dd3a2568ba5e52073cdf6d904ee9">succ_empty</a>() &amp;&amp; !PriorCond.<a class="code" href="classllvm_1_1SmallVectorBase.html#a8a8df4d85555c7954a95f86080cd3b64">empty</a>() &amp;&amp; PriorFBB == 0 &amp;&amp;</div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;        <a class="code" href="classllvm_1_1MachineFunction.html#a340712de3e78fec11c338735cab17df7">MachineFunction::iterator</a>(PriorTBB) == FallThrough &amp;&amp;</div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;        !MBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#a5ffb77c69d69a5beff906caaecfd7be4">canFallThrough</a>()) {</div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;      <span class="keywordtype">bool</span> DoTransform = <span class="keyword">true</span>;</div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;</div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;      <span class="comment">// We have to be careful that the succs of PredBB aren&#39;t both no-successor</span></div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;      <span class="comment">// blocks.  If neither have successors and if PredBB is the second from</span></div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;      <span class="comment">// last block in the function, we&#39;d just keep swapping the two blocks for</span></div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;      <span class="comment">// last.  Only do the swap if one is clearly better to fall through than</span></div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;      <span class="comment">// the other.</span></div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;      <span class="keywordflow">if</span> (FallThrough == --MF.<a class="code" href="classllvm_1_1MachineFunction.html#a9d017af749f76484cb9aec9ff6e4330c">end</a>() &amp;&amp;</div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;          !<a class="code" href="BranchFolding_8cpp.html#acda790896623fd894c71bf79f1bbcfea">IsBetterFallthrough</a>(PriorTBB, MBB))</div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;        DoTransform = <span class="keyword">false</span>;</div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;</div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;      <span class="keywordflow">if</span> (DoTransform) {</div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;        <span class="comment">// Reverse the branch so we will fall through on the previous true cond.</span></div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;        <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;MachineOperand, 4&gt;</a> NewPriorCond(PriorCond);</div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>-&gt;<a class="code" href="classllvm_1_1HexagonInstrInfo.html#ad6aff542dc74ce9024d0de5427339f7c">ReverseBranchCondition</a>(NewPriorCond)) {</div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;          <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;\nMoving MBB: &quot;</span> &lt;&lt; *MBB</div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;                       &lt;&lt; <span class="stringliteral">&quot;To make fallthrough to: &quot;</span> &lt;&lt; *PriorTBB &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;</div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;          <a class="code" href="classllvm_1_1DebugLoc.html">DebugLoc</a> dl = <a class="code" href="BranchFolding_8cpp.html#aebca59e55e33781db69d5909a2b2bc49">getBranchDebugLoc</a>(PrevBB);</div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;          <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>-&gt;<a class="code" href="classllvm_1_1HexagonInstrInfo.html#a4a753587c7751fc7804429aec5453c2d">RemoveBranch</a>(PrevBB);</div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;          <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>-&gt;<a class="code" href="classllvm_1_1HexagonInstrInfo.html#a95f554978b4efc4c1ca8b0ed5e017ff6">InsertBranch</a>(PrevBB, MBB, 0, NewPriorCond, dl);</div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;</div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;          <span class="comment">// Move this block to the end of the function.</span></div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;          MBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#af3c2dc75190645b72eee3c416cd14885">moveAfter</a>(--MF.<a class="code" href="classllvm_1_1MachineFunction.html#a9d017af749f76484cb9aec9ff6e4330c">end</a>());</div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;          MadeChange = <span class="keyword">true</span>;</div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;          ++NumBranchOpts;</div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;          <span class="keywordflow">return</span> MadeChange;</div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;        }</div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;      }</div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;    }</div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;  }</div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;</div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;  <span class="comment">// Analyze the branch in the current block.</span></div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;  <a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> *CurTBB = 0, *CurFBB = 0;</div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;MachineOperand, 4&gt;</a> CurCond;</div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;  <span class="keywordtype">bool</span> CurUnAnalyzable= <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>-&gt;<a class="code" href="classllvm_1_1HexagonInstrInfo.html#a6f9cdb0ade88e5375e97bb0905925c5d">AnalyzeBranch</a>(*MBB, CurTBB, CurFBB, CurCond, <span class="keyword">true</span>);</div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;  <span class="keywordflow">if</span> (!CurUnAnalyzable) {</div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;    <span class="comment">// If the CFG for the prior block has extra edges, remove them.</span></div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;    MadeChange |= MBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#aa20773d21c44eb6e0e330d96636cc4b0">CorrectExtraCFGEdges</a>(CurTBB, CurFBB, !CurCond.<a class="code" href="classllvm_1_1SmallVectorBase.html#a8a8df4d85555c7954a95f86080cd3b64">empty</a>());</div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;    <span class="comment">// If this is a two-way branch, and the FBB branches to this block, reverse</span></div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;    <span class="comment">// the condition so the single-basic-block loop is faster.  Instead of:</span></div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;    <span class="comment">//    Loop: xxx; jcc Out; jmp Loop</span></div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;    <span class="comment">// we want:</span></div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;    <span class="comment">//    Loop: xxx; jncc Loop; jmp Out</span></div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;    <span class="keywordflow">if</span> (CurTBB &amp;&amp; CurFBB &amp;&amp; CurFBB == MBB &amp;&amp; CurTBB != MBB) {</div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;      <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;MachineOperand, 4&gt;</a> NewCond(CurCond);</div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>-&gt;<a class="code" href="classllvm_1_1HexagonInstrInfo.html#ad6aff542dc74ce9024d0de5427339f7c">ReverseBranchCondition</a>(NewCond)) {</div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;        <a class="code" href="classllvm_1_1DebugLoc.html">DebugLoc</a> dl = <a class="code" href="BranchFolding_8cpp.html#aebca59e55e33781db69d5909a2b2bc49">getBranchDebugLoc</a>(*MBB);</div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;        <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>-&gt;<a class="code" href="classllvm_1_1HexagonInstrInfo.html#a4a753587c7751fc7804429aec5453c2d">RemoveBranch</a>(*MBB);</div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;        <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>-&gt;<a class="code" href="classllvm_1_1HexagonInstrInfo.html#a95f554978b4efc4c1ca8b0ed5e017ff6">InsertBranch</a>(*MBB, CurFBB, CurTBB, NewCond, dl);</div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;        MadeChange = <span class="keyword">true</span>;</div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;        ++NumBranchOpts;</div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;        <span class="keywordflow">goto</span> ReoptimizeBlock;</div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;      }</div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;    }</div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;</div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;    <span class="comment">// If this branch is the only thing in its block, see if we can forward</span></div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;    <span class="comment">// other blocks across it.</span></div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;    <span class="keywordflow">if</span> (CurTBB &amp;&amp; CurCond.<a class="code" href="classllvm_1_1SmallVectorBase.html#a8a8df4d85555c7954a95f86080cd3b64">empty</a>() &amp;&amp; CurFBB == 0 &amp;&amp;</div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;        <a class="code" href="BranchFolding_8cpp.html#ab17cea834a55a63f670e77230917423e">IsBranchOnlyBlock</a>(MBB) &amp;&amp; CurTBB != MBB &amp;&amp;</div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;        !MBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#a9832fb14c5aeb2277bc66d72cc99d105">hasAddressTaken</a>()) {</div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;      <a class="code" href="classllvm_1_1DebugLoc.html">DebugLoc</a> dl = <a class="code" href="BranchFolding_8cpp.html#aebca59e55e33781db69d5909a2b2bc49">getBranchDebugLoc</a>(*MBB);</div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;      <span class="comment">// This block may contain just an unconditional branch.  Because there can</span></div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;      <span class="comment">// be &#39;non-branch terminators&#39; in the block, try removing the branch and</span></div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;      <span class="comment">// then seeing if the block is empty.</span></div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;      <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>-&gt;<a class="code" href="classllvm_1_1HexagonInstrInfo.html#a4a753587c7751fc7804429aec5453c2d">RemoveBranch</a>(*MBB);</div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;      <span class="comment">// If the only things remaining in the block are debug info, remove these</span></div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;      <span class="comment">// as well, so this will behave the same as an empty block in non-debug</span></div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;      <span class="comment">// mode.</span></div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;      <span class="keywordflow">if</span> (!MBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#aa37d95a1d7bc824da0c596d8334c4ceb">empty</a>()) {</div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;        <span class="keywordtype">bool</span> NonDebugInfoFound = <span class="keyword">false</span>;</div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1MachineBasicBlock.html#ac51be7ff80fe8d6ae5e8c0acb194908a">MachineBasicBlock::iterator</a> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = MBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#ab2d91e7bec944efcbc39d8e30644f111">begin</a>(), E = MBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#acbc921830578e2741be6549db716c0ce">end</a>();</div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;             <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> != E; ++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;          <span class="keywordflow">if</span> (!<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;isDebugValue()) {</div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;            NonDebugInfoFound = <span class="keyword">true</span>;</div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;          }</div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;        }</div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;        <span class="keywordflow">if</span> (!NonDebugInfoFound)</div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;          <span class="comment">// Make the block empty, losing the debug info (we could probably</span></div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;          <span class="comment">// improve this in some cases.)</span></div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;          MBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#a537a9265c55392ab47d44954f27db538">erase</a>(MBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#ab2d91e7bec944efcbc39d8e30644f111">begin</a>(), MBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#acbc921830578e2741be6549db716c0ce">end</a>());</div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;      }</div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;      <span class="comment">// If this block is just an unconditional branch to CurTBB, we can</span></div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;      <span class="comment">// usually completely eliminate the block.  The only case we cannot</span></div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;      <span class="comment">// completely eliminate the block is when the block before this one</span></div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;      <span class="comment">// falls through into MBB and we can&#39;t understand the prior block&#39;s branch</span></div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;      <span class="comment">// condition.</span></div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;      <span class="keywordflow">if</span> (MBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#aa37d95a1d7bc824da0c596d8334c4ceb">empty</a>()) {</div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;        <span class="keywordtype">bool</span> PredHasNoFallThrough = !PrevBB.<a class="code" href="classllvm_1_1MachineBasicBlock.html#a5ffb77c69d69a5beff906caaecfd7be4">canFallThrough</a>();</div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;        <span class="keywordflow">if</span> (PredHasNoFallThrough || !PriorUnAnalyzable ||</div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;            !PrevBB.<a class="code" href="classllvm_1_1MachineBasicBlock.html#a57f25804288bc580d7b2e4016a38aec9">isSuccessor</a>(MBB)) {</div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;          <span class="comment">// If the prior block falls through into us, turn it into an</span></div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;          <span class="comment">// explicit branch to us to make updates simpler.</span></div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;          <span class="keywordflow">if</span> (!PredHasNoFallThrough &amp;&amp; PrevBB.<a class="code" href="classllvm_1_1MachineBasicBlock.html#a57f25804288bc580d7b2e4016a38aec9">isSuccessor</a>(MBB) &amp;&amp;</div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;              PriorTBB != MBB &amp;&amp; PriorFBB != MBB) {</div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;            <span class="keywordflow">if</span> (PriorTBB == 0) {</div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;              assert(PriorCond.<a class="code" href="classllvm_1_1SmallVectorBase.html#a8a8df4d85555c7954a95f86080cd3b64">empty</a>() &amp;&amp; PriorFBB == 0 &amp;&amp;</div><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;                     <span class="stringliteral">&quot;Bad branch analysis&quot;</span>);</div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;              PriorTBB = MBB;</div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;              assert(PriorFBB == 0 &amp;&amp; <span class="stringliteral">&quot;Machine CFG out of date!&quot;</span>);</div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;              PriorFBB = MBB;</div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;            }</div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;            <a class="code" href="classllvm_1_1DebugLoc.html">DebugLoc</a> pdl = <a class="code" href="BranchFolding_8cpp.html#aebca59e55e33781db69d5909a2b2bc49">getBranchDebugLoc</a>(PrevBB);</div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;            <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>-&gt;<a class="code" href="classllvm_1_1HexagonInstrInfo.html#a4a753587c7751fc7804429aec5453c2d">RemoveBranch</a>(PrevBB);</div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;            <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>-&gt;<a class="code" href="classllvm_1_1HexagonInstrInfo.html#a95f554978b4efc4c1ca8b0ed5e017ff6">InsertBranch</a>(PrevBB, PriorTBB, PriorFBB, PriorCond, pdl);</div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;          }</div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;</div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;          <span class="comment">// Iterate through all the predecessors, revectoring each in-turn.</span></div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;          <span class="keywordtype">size_t</span> PI = 0;</div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;          <span class="keywordtype">bool</span> DidChange = <span class="keyword">false</span>;</div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;          <span class="keywordtype">bool</span> HasBranchToSelf = <span class="keyword">false</span>;</div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;          <span class="keywordflow">while</span>(PI != MBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#ac9786455bc217ebd35377bb5d5ec8f20">pred_size</a>()) {</div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;            <a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> *PMBB = *(MBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#ab644fcf07a4c2708333cf66276282357">pred_begin</a>() + PI);</div><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;            <span class="keywordflow">if</span> (PMBB == MBB) {</div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;              <span class="comment">// If this block has an uncond branch to itself, leave it.</span></div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;              ++PI;</div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;              HasBranchToSelf = <span class="keyword">true</span>;</div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;              DidChange = <span class="keyword">true</span>;</div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;              PMBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#ab9a54fdc7456ee97cb54ff30d625b6b7">ReplaceUsesOfBlockWith</a>(MBB, CurTBB);</div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;              <span class="comment">// If this change resulted in PMBB ending in a conditional</span></div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;              <span class="comment">// branch where both conditions go to the same destination,</span></div><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;              <span class="comment">// change this to an unconditional branch (and fix the CFG).</span></div><div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;              <a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> *NewCurTBB = 0, *NewCurFBB = 0;</div><div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;              <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;MachineOperand, 4&gt;</a> NewCurCond;</div><div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;              <span class="keywordtype">bool</span> NewCurUnAnalyzable = <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>-&gt;<a class="code" href="classllvm_1_1HexagonInstrInfo.html#a6f9cdb0ade88e5375e97bb0905925c5d">AnalyzeBranch</a>(*PMBB, NewCurTBB,</div><div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;                      NewCurFBB, NewCurCond, <span class="keyword">true</span>);</div><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;              <span class="keywordflow">if</span> (!NewCurUnAnalyzable &amp;&amp; NewCurTBB &amp;&amp; NewCurTBB == NewCurFBB) {</div><div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;                <a class="code" href="classllvm_1_1DebugLoc.html">DebugLoc</a> pdl = <a class="code" href="BranchFolding_8cpp.html#aebca59e55e33781db69d5909a2b2bc49">getBranchDebugLoc</a>(*PMBB);</div><div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;                <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>-&gt;<a class="code" href="classllvm_1_1HexagonInstrInfo.html#a4a753587c7751fc7804429aec5453c2d">RemoveBranch</a>(*PMBB);</div><div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;                NewCurCond.<a class="code" href="classllvm_1_1SmallVectorImpl.html#aac0ea55010b7b1a301e65a0baea057aa">clear</a>();</div><div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;                <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>-&gt;<a class="code" href="classllvm_1_1HexagonInstrInfo.html#a95f554978b4efc4c1ca8b0ed5e017ff6">InsertBranch</a>(*PMBB, NewCurTBB, 0, NewCurCond, pdl);</div><div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;                MadeChange = <span class="keyword">true</span>;</div><div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;                ++NumBranchOpts;</div><div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;                PMBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#aa20773d21c44eb6e0e330d96636cc4b0">CorrectExtraCFGEdges</a>(NewCurTBB, 0, <span class="keyword">false</span>);</div><div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;              }</div><div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;            }</div><div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;          }</div><div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;</div><div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;          <span class="comment">// Change any jumptables to go to the new MBB.</span></div><div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1MachineJumpTableInfo.html">MachineJumpTableInfo</a> *MJTI = MF.<a class="code" href="classllvm_1_1MachineFunction.html#a99e93c9b5c2f41b3d601d129a6f60a6e">getJumpTableInfo</a>())</div><div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;            MJTI-&gt;ReplaceMBBInJumpTables(MBB, CurTBB);</div><div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;          <span class="keywordflow">if</span> (DidChange) {</div><div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;            ++NumBranchOpts;</div><div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;            MadeChange = <span class="keyword">true</span>;</div><div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;            <span class="keywordflow">if</span> (!HasBranchToSelf) <span class="keywordflow">return</span> MadeChange;</div><div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;          }</div><div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;        }</div><div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;      }</div><div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;</div><div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;      <span class="comment">// Add the branch back if the block is more than just an uncond branch.</span></div><div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;      <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>-&gt;<a class="code" href="classllvm_1_1HexagonInstrInfo.html#a95f554978b4efc4c1ca8b0ed5e017ff6">InsertBranch</a>(*MBB, CurTBB, 0, CurCond, dl);</div><div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;    }</div><div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;  }</div><div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;</div><div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;  <span class="comment">// If the prior block doesn&#39;t fall through into this block, and if this</span></div><div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;  <span class="comment">// block doesn&#39;t fall through into some other block, see if we can find a</span></div><div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;  <span class="comment">// place to move this block where a fall-through will happen.</span></div><div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;  <span class="keywordflow">if</span> (!PrevBB.<a class="code" href="classllvm_1_1MachineBasicBlock.html#a5ffb77c69d69a5beff906caaecfd7be4">canFallThrough</a>()) {</div><div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;</div><div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;    <span class="comment">// Now we know that there was no fall-through into this block, check to</span></div><div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;    <span class="comment">// see if it has a fall-through into its successor.</span></div><div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;    <span class="keywordtype">bool</span> CurFallsThru = MBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#a5ffb77c69d69a5beff906caaecfd7be4">canFallThrough</a>();</div><div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;</div><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;    <span class="keywordflow">if</span> (!MBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#a3f522ae33859d693fb5781efe690e9e6">isLandingPad</a>()) {</div><div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;      <span class="comment">// Check all the predecessors of this block.  If one of them has no fall</span></div><div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;      <span class="comment">// throughs, move this block right after it.</span></div><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1MachineBasicBlock.html#a7e7a1a247b7725a24fe19a91f90782cc">MachineBasicBlock::pred_iterator</a> PI = MBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#ab644fcf07a4c2708333cf66276282357">pred_begin</a>(),</div><div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;           E = MBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#a0359a738e0412c5a7ea55d61175e0661">pred_end</a>(); PI != E; ++PI) {</div><div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;        <span class="comment">// Analyze the branch at the end of the pred.</span></div><div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;        <a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> *PredBB = *PI;</div><div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;        <a class="code" href="classllvm_1_1MachineFunction.html#a340712de3e78fec11c338735cab17df7">MachineFunction::iterator</a> PredFallthrough = PredBB; ++PredFallthrough;</div><div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;        <a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> *PredTBB = 0, *PredFBB = 0;</div><div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;        <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;MachineOperand, 4&gt;</a> PredCond;</div><div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;        <span class="keywordflow">if</span> (PredBB != MBB &amp;&amp; !PredBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#a5ffb77c69d69a5beff906caaecfd7be4">canFallThrough</a>() &amp;&amp;</div><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;            !<a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>-&gt;<a class="code" href="classllvm_1_1HexagonInstrInfo.html#a6f9cdb0ade88e5375e97bb0905925c5d">AnalyzeBranch</a>(*PredBB, PredTBB, PredFBB, PredCond, <span class="keyword">true</span>)</div><div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;            &amp;&amp; (!CurFallsThru || !CurTBB || !CurFBB)</div><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;            &amp;&amp; (!CurFallsThru || MBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#a6acda287e5c19ffb173b0bf8f1dd9c5e">getNumber</a>() &gt;= PredBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#a6acda287e5c19ffb173b0bf8f1dd9c5e">getNumber</a>())) {</div><div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;          <span class="comment">// If the current block doesn&#39;t fall through, just move it.</span></div><div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;          <span class="comment">// If the current block can fall through and does not end with a</span></div><div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;          <span class="comment">// conditional branch, we need to append an unconditional jump to</span></div><div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;          <span class="comment">// the (current) next block.  To avoid a possible compile-time</span></div><div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;          <span class="comment">// infinite loop, move blocks only backward in this case.</span></div><div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;          <span class="comment">// Also, if there are already 2 branches here, we cannot add a third;</span></div><div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;          <span class="comment">// this means we have the case</span></div><div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;          <span class="comment">// Bcc next</span></div><div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;          <span class="comment">// B elsewhere</span></div><div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;          <span class="comment">// next:</span></div><div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;          <span class="keywordflow">if</span> (CurFallsThru) {</div><div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;            <a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> *NextBB = <a class="code" href="namespacellvm.html#aa1704159f75e6eacd595962ea6d93ffe">llvm::next</a>(<a class="code" href="classllvm_1_1MachineFunction.html#a340712de3e78fec11c338735cab17df7">MachineFunction::iterator</a>(MBB));</div><div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;            CurCond.<a class="code" href="classllvm_1_1SmallVectorImpl.html#aac0ea55010b7b1a301e65a0baea057aa">clear</a>();</div><div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;            <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>-&gt;<a class="code" href="classllvm_1_1HexagonInstrInfo.html#a95f554978b4efc4c1ca8b0ed5e017ff6">InsertBranch</a>(*MBB, NextBB, 0, CurCond, <a class="code" href="classllvm_1_1DebugLoc.html">DebugLoc</a>());</div><div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;          }</div><div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;          MBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#af3c2dc75190645b72eee3c416cd14885">moveAfter</a>(PredBB);</div><div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;          MadeChange = <span class="keyword">true</span>;</div><div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;          <span class="keywordflow">goto</span> ReoptimizeBlock;</div><div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;        }</div><div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;      }</div><div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;    }</div><div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;</div><div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;    <span class="keywordflow">if</span> (!CurFallsThru) {</div><div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;      <span class="comment">// Check all successors to see if we can move this block before it.</span></div><div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1MachineBasicBlock.html#aefba5f2af370add1bc8aaceedf7878ef">MachineBasicBlock::succ_iterator</a> SI = MBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#a6321b189ea8fd5058663f8a87d6c23e9">succ_begin</a>(),</div><div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;           E = MBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#a3ddd708642d60c1661992ff8ba1b215d">succ_end</a>(); SI != E; ++SI) {</div><div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;        <span class="comment">// Analyze the branch at the end of the block before the succ.</span></div><div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;        <a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> *SuccBB = *SI;</div><div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;        <a class="code" href="classllvm_1_1MachineFunction.html#a340712de3e78fec11c338735cab17df7">MachineFunction::iterator</a> SuccPrev = SuccBB; --SuccPrev;</div><div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;</div><div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;        <span class="comment">// If this block doesn&#39;t already fall-through to that successor, and if</span></div><div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;        <span class="comment">// the succ doesn&#39;t already have a block that can fall through into it,</span></div><div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;        <span class="comment">// and if the successor isn&#39;t an EH destination, we can arrange for the</span></div><div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;        <span class="comment">// fallthrough to happen.</span></div><div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;        <span class="keywordflow">if</span> (SuccBB != MBB &amp;&amp; &amp;*SuccPrev != MBB &amp;&amp;</div><div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;            !SuccPrev-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#a5ffb77c69d69a5beff906caaecfd7be4">canFallThrough</a>() &amp;&amp; !CurUnAnalyzable &amp;&amp;</div><div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;            !SuccBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#a3f522ae33859d693fb5781efe690e9e6">isLandingPad</a>()) {</div><div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;          MBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#a25c2a6ee39d0d97dac2184e8bd942300">moveBefore</a>(SuccBB);</div><div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;          MadeChange = <span class="keyword">true</span>;</div><div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;          <span class="keywordflow">goto</span> ReoptimizeBlock;</div><div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;        }</div><div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;      }</div><div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;</div><div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;      <span class="comment">// Okay, there is no really great place to put this block.  If, however,</span></div><div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;      <span class="comment">// the block before this one would be a fall-through if this block were</span></div><div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;      <span class="comment">// removed, move this block to the end of the function.</span></div><div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;      <a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> *PrevTBB = 0, *PrevFBB = 0;</div><div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;      <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;MachineOperand, 4&gt;</a> PrevCond;</div><div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;      <span class="keywordflow">if</span> (FallThrough != MF.<a class="code" href="classllvm_1_1MachineFunction.html#a9d017af749f76484cb9aec9ff6e4330c">end</a>() &amp;&amp;</div><div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;          !<a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>-&gt;<a class="code" href="classllvm_1_1HexagonInstrInfo.html#a6f9cdb0ade88e5375e97bb0905925c5d">AnalyzeBranch</a>(PrevBB, PrevTBB, PrevFBB, PrevCond, <span class="keyword">true</span>) &amp;&amp;</div><div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;          PrevBB.<a class="code" href="classllvm_1_1MachineBasicBlock.html#a57f25804288bc580d7b2e4016a38aec9">isSuccessor</a>(FallThrough)) {</div><div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;        MBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#af3c2dc75190645b72eee3c416cd14885">moveAfter</a>(--MF.<a class="code" href="classllvm_1_1MachineFunction.html#a9d017af749f76484cb9aec9ff6e4330c">end</a>());</div><div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;        MadeChange = <span class="keyword">true</span>;</div><div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;        <span class="keywordflow">return</span> MadeChange;</div><div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;      }</div><div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;    }</div><div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;  }</div><div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;</div><div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;  <span class="keywordflow">return</span> MadeChange;</div><div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;}</div><div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;</div><div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div><div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;<span class="comment">//  Hoist Common Code</span></div><div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div><div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;<span class="comment">/// HoistCommonCode - Hoist common instruction sequences at the start of basic</span></div><div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;<span class="comment">/// blocks to their common predecessor.</span></div><div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;<span class="comment"></span><span class="keywordtype">bool</span> BranchFolder::HoistCommonCode(<a class="code" href="classllvm_1_1MachineFunction.html">MachineFunction</a> &amp;MF) {</div><div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;  <span class="keywordtype">bool</span> MadeChange = <span class="keyword">false</span>;</div><div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1MachineFunction.html#a340712de3e78fec11c338735cab17df7">MachineFunction::iterator</a> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = MF.<a class="code" href="classllvm_1_1MachineFunction.html#ab0789854909cf47f640a85fa2bac29c7">begin</a>(), E = MF.<a class="code" href="classllvm_1_1MachineFunction.html#a9d017af749f76484cb9aec9ff6e4330c">end</a>(); <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> != E; ) {</div><div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;    <a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> *MBB = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>++;</div><div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;    MadeChange |= HoistCommonCodeInSuccs(MBB);</div><div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;  }</div><div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;</div><div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;  <span class="keywordflow">return</span> MadeChange;</div><div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;}</div><div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;<span class="comment">/// findFalseBlock - BB has a fallthrough. Find its &#39;false&#39; successor given</span></div><div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;<span class="comment">/// its &#39;true&#39; successor.</span></div><div class="line"><a name="l01461"></a><span class="lineno"><a class="line" href="BranchFolding_8cpp.html#ac3ecfd2e4efef37daed6d6fdea800a28"> 1461</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> *<a class="code" href="BranchFolding_8cpp.html#ac3ecfd2e4efef37daed6d6fdea800a28">findFalseBlock</a>(<a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> *BB,</div><div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;                                         <a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> *TrueBB) {</div><div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1MachineBasicBlock.html#aefba5f2af370add1bc8aaceedf7878ef">MachineBasicBlock::succ_iterator</a> SI = BB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#a6321b189ea8fd5058663f8a87d6c23e9">succ_begin</a>(),</div><div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;         E = BB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#a3ddd708642d60c1661992ff8ba1b215d">succ_end</a>(); SI != E; ++SI) {</div><div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;    <a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> *SuccBB = *SI;</div><div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;    <span class="keywordflow">if</span> (SuccBB != TrueBB)</div><div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;      <span class="keywordflow">return</span> SuccBB;</div><div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;  }</div><div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;  <span class="keywordflow">return</span> NULL;</div><div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;}</div><div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;<span class="comment">/// findHoistingInsertPosAndDeps - Find the location to move common instructions</span></div><div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;<span class="comment">/// in successors to. The location is usually just before the terminator,</span></div><div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;<span class="comment">/// however if the terminator is a conditional branch and its previous</span></div><div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;<span class="comment">/// instruction is the flag setting instruction, the previous instruction is</span></div><div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;<span class="comment">/// the preferred location. This function also gathers uses and defs of the</span></div><div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;<span class="comment">/// instructions from the insertion point to the end of the block. The data is</span></div><div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;<span class="comment">/// used by HoistCommonCodeInSuccs to ensure safety.</span></div><div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;<span class="comment"></span><span class="keyword">static</span></div><div class="line"><a name="l01480"></a><span class="lineno"><a class="line" href="BranchFolding_8cpp.html#aeaa3cf4dae61117e2ed40085d8b119bb"> 1480</a></span>&#160;<a class="code" href="classllvm_1_1MachineBasicBlock.html#ac51be7ff80fe8d6ae5e8c0acb194908a">MachineBasicBlock::iterator</a> <a class="code" href="BranchFolding_8cpp.html#aeaa3cf4dae61117e2ed40085d8b119bb">findHoistingInsertPosAndDeps</a>(<a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> *MBB,</div><div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;                                                  <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetInstrInfo.html">TargetInstrInfo</a> *<a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>,</div><div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;                                                  <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetRegisterInfo.html">TargetRegisterInfo</a> *TRI,</div><div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;                                                  <a class="code" href="classllvm_1_1SmallSet.html">SmallSet&lt;unsigned,4&gt;</a> &amp;Uses,</div><div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;                                                  <a class="code" href="classllvm_1_1SmallSet.html">SmallSet&lt;unsigned,4&gt;</a> &amp;Defs) {</div><div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;  <a class="code" href="classllvm_1_1MachineBasicBlock.html#ac51be7ff80fe8d6ae5e8c0acb194908a">MachineBasicBlock::iterator</a> Loc = MBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#a7f0521fa2de44271fd4b909ea7351ef3">getFirstTerminator</a>();</div><div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;  <span class="keywordflow">if</span> (!TII-&gt;<a class="code" href="classllvm_1_1TargetInstrInfo.html#aad7e5ed58daa51de3466752823b2f76e">isUnpredicatedTerminator</a>(Loc))</div><div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;    <span class="keywordflow">return</span> MBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#acbc921830578e2741be6549db716c0ce">end</a>();</div><div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;</div><div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0, e = Loc-&gt;getNumOperands(); <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != e; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;MO = Loc-&gt;getOperand(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;    <span class="keywordflow">if</span> (!MO.<a class="code" href="classllvm_1_1MachineOperand.html#ad8198d6d83af9410d867136e33fbf4b2">isReg</a>())</div><div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;    <span class="keywordtype">unsigned</span> <a class="code" href="X86DisassemblerDecoder_8h.html#a546839a5c4bcf9f9450967155f48de41">Reg</a> = MO.<a class="code" href="classllvm_1_1MachineOperand.html#ab75f703d251cc0ce0206fe00a999db86">getReg</a>();</div><div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;    <span class="keywordflow">if</span> (!Reg)</div><div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;    <span class="keywordflow">if</span> (MO.<a class="code" href="classllvm_1_1MachineOperand.html#a57bf9ee7219097ff0f98da23a3b3b782">isUse</a>()) {</div><div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1MCRegAliasIterator.html">MCRegAliasIterator</a> AI(Reg, TRI, <span class="keyword">true</span>); AI.<a class="code" href="classllvm_1_1MCRegAliasIterator.html#abf2eadac3ea84e2e2739444c40421eac">isValid</a>(); ++AI)</div><div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;        Uses.<a class="code" href="classllvm_1_1SmallSet.html#a8d8348060ccdeeba13fb8bc651dfbf82">insert</a>(*AI);</div><div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!MO.<a class="code" href="classllvm_1_1MachineOperand.html#a196420aa839c2b21f42c4bf5c36df437">isDead</a>())</div><div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;      <span class="comment">// Don&#39;t try to hoist code in the rare case the terminator defines a</span></div><div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;      <span class="comment">// register that is later used.</span></div><div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;      <span class="keywordflow">return</span> MBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#acbc921830578e2741be6549db716c0ce">end</a>();</div><div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;  }</div><div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;</div><div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;  <span class="keywordflow">if</span> (Uses.<a class="code" href="classllvm_1_1SmallSet.html#afd57abe5a6e10c8b282b6549432ec851">empty</a>())</div><div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;    <span class="keywordflow">return</span> Loc;</div><div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;  <span class="keywordflow">if</span> (Loc == MBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#ab2d91e7bec944efcbc39d8e30644f111">begin</a>())</div><div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;    <span class="keywordflow">return</span> MBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#acbc921830578e2741be6549db716c0ce">end</a>();</div><div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;</div><div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;  <span class="comment">// The terminator is probably a conditional branch, try not to separate the</span></div><div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;  <span class="comment">// branch from condition setting instruction.</span></div><div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;  <a class="code" href="classllvm_1_1MachineBasicBlock.html#ac51be7ff80fe8d6ae5e8c0acb194908a">MachineBasicBlock::iterator</a> PI = Loc;</div><div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;  --PI;</div><div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;  <span class="keywordflow">while</span> (PI != MBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#ab2d91e7bec944efcbc39d8e30644f111">begin</a>() &amp;&amp; Loc-&gt;isDebugValue())</div><div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;    --PI;</div><div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;</div><div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;  <span class="keywordtype">bool</span> IsDef = <span class="keyword">false</span>;</div><div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0, e = PI-&gt;getNumOperands(); !IsDef &amp;&amp; <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != e; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;MO = PI-&gt;getOperand(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;    <span class="comment">// If PI has a regmask operand, it is probably a call. Separate away.</span></div><div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;    <span class="keywordflow">if</span> (MO.<a class="code" href="classllvm_1_1MachineOperand.html#a2c5eddfba64e7a44deba1b5a0d45a017">isRegMask</a>())</div><div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;      <span class="keywordflow">return</span> Loc;</div><div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;    <span class="keywordflow">if</span> (!MO.<a class="code" href="classllvm_1_1MachineOperand.html#ad8198d6d83af9410d867136e33fbf4b2">isReg</a>() || MO.<a class="code" href="classllvm_1_1MachineOperand.html#a57bf9ee7219097ff0f98da23a3b3b782">isUse</a>())</div><div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;    <span class="keywordtype">unsigned</span> <a class="code" href="X86DisassemblerDecoder_8h.html#a546839a5c4bcf9f9450967155f48de41">Reg</a> = MO.<a class="code" href="classllvm_1_1MachineOperand.html#ab75f703d251cc0ce0206fe00a999db86">getReg</a>();</div><div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;    <span class="keywordflow">if</span> (!Reg)</div><div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;    <span class="keywordflow">if</span> (Uses.<a class="code" href="classllvm_1_1SmallSet.html#ab28aa342862f6d16361be514fd98c22e">count</a>(Reg))</div><div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;      IsDef = <span class="keyword">true</span>;</div><div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;  }</div><div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;  <span class="keywordflow">if</span> (!IsDef)</div><div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;    <span class="comment">// The condition setting instruction is not just before the conditional</span></div><div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;    <span class="comment">// branch.</span></div><div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;    <span class="keywordflow">return</span> Loc;</div><div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;</div><div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;  <span class="comment">// Be conservative, don&#39;t insert instruction above something that may have</span></div><div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;  <span class="comment">// side-effects. And since it&#39;s potentially bad to separate flag setting</span></div><div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;  <span class="comment">// instruction from the conditional branch, just abort the optimization</span></div><div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;  <span class="comment">// completely.</span></div><div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;  <span class="comment">// Also avoid moving code above predicated instruction since it&#39;s hard to</span></div><div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;  <span class="comment">// reason about register liveness with predicated instruction.</span></div><div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;  <span class="keywordtype">bool</span> DontMoveAcrossStore = <span class="keyword">true</span>;</div><div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;  <span class="keywordflow">if</span> (!PI-&gt;isSafeToMove(TII, 0, DontMoveAcrossStore) ||</div><div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;      TII-&gt;<a class="code" href="classllvm_1_1TargetInstrInfo.html#a2a69dd402cbc7f6282c93c32161395bc">isPredicated</a>(PI))</div><div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;    <span class="keywordflow">return</span> MBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#acbc921830578e2741be6549db716c0ce">end</a>();</div><div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;</div><div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;</div><div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;  <span class="comment">// Find out what registers are live. Note this routine is ignoring other live</span></div><div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;  <span class="comment">// registers which are only used by instructions in successor blocks.</span></div><div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0, e = PI-&gt;getNumOperands(); <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != e; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;MO = PI-&gt;getOperand(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;    <span class="keywordflow">if</span> (!MO.<a class="code" href="classllvm_1_1MachineOperand.html#ad8198d6d83af9410d867136e33fbf4b2">isReg</a>())</div><div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;    <span class="keywordtype">unsigned</span> <a class="code" href="X86DisassemblerDecoder_8h.html#a546839a5c4bcf9f9450967155f48de41">Reg</a> = MO.<a class="code" href="classllvm_1_1MachineOperand.html#ab75f703d251cc0ce0206fe00a999db86">getReg</a>();</div><div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;    <span class="keywordflow">if</span> (!Reg)</div><div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;    <span class="keywordflow">if</span> (MO.<a class="code" href="classllvm_1_1MachineOperand.html#a57bf9ee7219097ff0f98da23a3b3b782">isUse</a>()) {</div><div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1MCRegAliasIterator.html">MCRegAliasIterator</a> AI(Reg, TRI, <span class="keyword">true</span>); AI.<a class="code" href="classllvm_1_1MCRegAliasIterator.html#abf2eadac3ea84e2e2739444c40421eac">isValid</a>(); ++AI)</div><div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;        Uses.<a class="code" href="classllvm_1_1SmallSet.html#a8d8348060ccdeeba13fb8bc651dfbf82">insert</a>(*AI);</div><div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;      <span class="keywordflow">if</span> (Uses.<a class="code" href="classllvm_1_1SmallSet.html#a75a2d2ad3b3dce6702750d570ee8f343">erase</a>(Reg)) {</div><div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1MCSubRegIterator.html">MCSubRegIterator</a> SubRegs(Reg, TRI); SubRegs.<a class="code" href="classllvm_1_1MCRegisterInfo_1_1DiffListIterator.html#abccd358b92366e5284e7e674e86b241f">isValid</a>(); ++SubRegs)</div><div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;          Uses.<a class="code" href="classllvm_1_1SmallSet.html#a75a2d2ad3b3dce6702750d570ee8f343">erase</a>(*SubRegs); <span class="comment">// Use sub-registers to be conservative</span></div><div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;      }</div><div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1MCRegAliasIterator.html">MCRegAliasIterator</a> AI(Reg, TRI, <span class="keyword">true</span>); AI.<a class="code" href="classllvm_1_1MCRegAliasIterator.html#abf2eadac3ea84e2e2739444c40421eac">isValid</a>(); ++AI)</div><div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;        Defs.<a class="code" href="classllvm_1_1SmallSet.html#a8d8348060ccdeeba13fb8bc651dfbf82">insert</a>(*AI);</div><div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;    }</div><div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;  }</div><div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;</div><div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;  <span class="keywordflow">return</span> PI;</div><div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;}</div><div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;<span class="comment">/// HoistCommonCodeInSuccs - If the successors of MBB has common instruction</span></div><div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;<span class="comment">/// sequence at the start of the function, move the instructions before MBB</span></div><div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;<span class="comment">/// terminator if it&#39;s legal.</span></div><div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;<span class="comment"></span><span class="keywordtype">bool</span> BranchFolder::HoistCommonCodeInSuccs(<a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> *MBB) {</div><div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;  <a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> *TBB = 0, *FBB = 0;</div><div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;MachineOperand, 4&gt;</a> Cond;</div><div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>-&gt;<a class="code" href="classllvm_1_1HexagonInstrInfo.html#a6f9cdb0ade88e5375e97bb0905925c5d">AnalyzeBranch</a>(*MBB, TBB, FBB, Cond, <span class="keyword">true</span>) || !TBB || Cond.<a class="code" href="classllvm_1_1SmallVectorBase.html#a8a8df4d85555c7954a95f86080cd3b64">empty</a>())</div><div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;</div><div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;  <span class="keywordflow">if</span> (!FBB) FBB = <a class="code" href="BranchFolding_8cpp.html#ac3ecfd2e4efef37daed6d6fdea800a28">findFalseBlock</a>(MBB, TBB);</div><div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;  <span class="keywordflow">if</span> (!FBB)</div><div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;    <span class="comment">// Malformed bcc? True and false blocks are the same?</span></div><div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;</div><div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;  <span class="comment">// Restrict the optimization to cases where MBB is the only predecessor,</span></div><div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;  <span class="comment">// it is an obvious win.</span></div><div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;  <span class="keywordflow">if</span> (TBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#ac9786455bc217ebd35377bb5d5ec8f20">pred_size</a>() &gt; 1 || FBB-&gt;pred_size() &gt; 1)</div><div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;</div><div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;  <span class="comment">// Find a suitable position to hoist the common instructions to. Also figure</span></div><div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;  <span class="comment">// out which registers are used or defined by instructions from the insertion</span></div><div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;  <span class="comment">// point to the end of the block.</span></div><div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;  <a class="code" href="classllvm_1_1SmallSet.html">SmallSet&lt;unsigned, 4&gt;</a> Uses, Defs;</div><div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;  <a class="code" href="classllvm_1_1MachineBasicBlock.html#ac51be7ff80fe8d6ae5e8c0acb194908a">MachineBasicBlock::iterator</a> Loc =</div><div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;    <a class="code" href="BranchFolding_8cpp.html#aeaa3cf4dae61117e2ed40085d8b119bb">findHoistingInsertPosAndDeps</a>(MBB, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>, TRI, Uses, Defs);</div><div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;  <span class="keywordflow">if</span> (Loc == MBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#acbc921830578e2741be6549db716c0ce">end</a>())</div><div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;</div><div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;  <span class="keywordtype">bool</span> HasDups = <span class="keyword">false</span>;</div><div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;unsigned, 4&gt;</a> LocalDefs;</div><div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;  <a class="code" href="classllvm_1_1SmallSet.html">SmallSet&lt;unsigned, 4&gt;</a> LocalDefsSet;</div><div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;  <a class="code" href="classllvm_1_1MachineBasicBlock.html#ac51be7ff80fe8d6ae5e8c0acb194908a">MachineBasicBlock::iterator</a> TIB = TBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#ab2d91e7bec944efcbc39d8e30644f111">begin</a>();</div><div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;  <a class="code" href="classllvm_1_1MachineBasicBlock.html#ac51be7ff80fe8d6ae5e8c0acb194908a">MachineBasicBlock::iterator</a> FIB = FBB-&gt;begin();</div><div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;  <a class="code" href="classllvm_1_1MachineBasicBlock.html#ac51be7ff80fe8d6ae5e8c0acb194908a">MachineBasicBlock::iterator</a> TIE = TBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#acbc921830578e2741be6549db716c0ce">end</a>();</div><div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;  <a class="code" href="classllvm_1_1MachineBasicBlock.html#ac51be7ff80fe8d6ae5e8c0acb194908a">MachineBasicBlock::iterator</a> FIE = FBB-&gt;end();</div><div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;  <span class="keywordflow">while</span> (TIB != TIE &amp;&amp; FIB != FIE) {</div><div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;    <span class="comment">// Skip dbg_value instructions. These do not count.</span></div><div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;    <span class="keywordflow">if</span> (TIB-&gt;isDebugValue()) {</div><div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;      <span class="keywordflow">while</span> (TIB != TIE &amp;&amp; TIB-&gt;isDebugValue())</div><div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;        ++TIB;</div><div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;      <span class="keywordflow">if</span> (TIB == TIE)</div><div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;    }</div><div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;    <span class="keywordflow">if</span> (FIB-&gt;isDebugValue()) {</div><div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;      <span class="keywordflow">while</span> (FIB != FIE &amp;&amp; FIB-&gt;isDebugValue())</div><div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;        ++FIB;</div><div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;      <span class="keywordflow">if</span> (FIB == FIE)</div><div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;    }</div><div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;    <span class="keywordflow">if</span> (!TIB-&gt;isIdenticalTo(FIB, <a class="code" href="classllvm_1_1MachineInstr.html#ab7650f958c093f7c5faf8c69dbc8c462ad84865ceeee6b326942a3ed2ad37f815">MachineInstr::CheckKillDead</a>))</div><div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;</div><div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>-&gt;<a class="code" href="classllvm_1_1HexagonInstrInfo.html#ab4e9f5b80f8a3ab31f3dbddf5247c67e">isPredicated</a>(TIB))</div><div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;      <span class="comment">// Hard to reason about register liveness with predicated instruction.</span></div><div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;</div><div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;    <span class="keywordtype">bool</span> IsSafe = <span class="keyword">true</span>;</div><div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0, e = TIB-&gt;getNumOperands(); <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != e; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;      <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;MO = TIB-&gt;getOperand(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;      <span class="comment">// Don&#39;t attempt to hoist instructions with register masks.</span></div><div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;      <span class="keywordflow">if</span> (MO.<a class="code" href="classllvm_1_1MachineOperand.html#a2c5eddfba64e7a44deba1b5a0d45a017">isRegMask</a>()) {</div><div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;        IsSafe = <span class="keyword">false</span>;</div><div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;      }</div><div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;      <span class="keywordflow">if</span> (!MO.<a class="code" href="classllvm_1_1MachineOperand.html#ad8198d6d83af9410d867136e33fbf4b2">isReg</a>())</div><div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;      <span class="keywordtype">unsigned</span> <a class="code" href="X86DisassemblerDecoder_8h.html#a546839a5c4bcf9f9450967155f48de41">Reg</a> = MO.<a class="code" href="classllvm_1_1MachineOperand.html#ab75f703d251cc0ce0206fe00a999db86">getReg</a>();</div><div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;      <span class="keywordflow">if</span> (!Reg)</div><div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;      <span class="keywordflow">if</span> (MO.<a class="code" href="classllvm_1_1MachineOperand.html#a8de7d5cf38939044471c6ee60a01a3df">isDef</a>()) {</div><div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;        <span class="keywordflow">if</span> (Uses.<a class="code" href="classllvm_1_1SmallSet.html#ab28aa342862f6d16361be514fd98c22e">count</a>(Reg)) {</div><div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;          <span class="comment">// Avoid clobbering a register that&#39;s used by the instruction at</span></div><div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;          <span class="comment">// the point of insertion.</span></div><div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;          IsSafe = <span class="keyword">false</span>;</div><div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;          <span class="keywordflow">break</span>;</div><div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;        }</div><div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;</div><div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;        <span class="keywordflow">if</span> (Defs.<a class="code" href="classllvm_1_1SmallSet.html#ab28aa342862f6d16361be514fd98c22e">count</a>(Reg) &amp;&amp; !MO.<a class="code" href="classllvm_1_1MachineOperand.html#a196420aa839c2b21f42c4bf5c36df437">isDead</a>()) {</div><div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;          <span class="comment">// Don&#39;t hoist the instruction if the def would be clobber by the</span></div><div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;          <span class="comment">// instruction at the point insertion. FIXME: This is overly</span></div><div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;          <span class="comment">// conservative. It should be possible to hoist the instructions</span></div><div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;          <span class="comment">// in BB2 in the following example:</span></div><div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;          <span class="comment">// BB1:</span></div><div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;          <span class="comment">// r1, eflag = op1 r2, r3</span></div><div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;          <span class="comment">// brcc eflag</span></div><div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;          <span class="comment">//</span></div><div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;          <span class="comment">// BB2:</span></div><div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;          <span class="comment">// r1 = op2, ...</span></div><div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;          <span class="comment">//    = op3, r1&lt;kill&gt;</span></div><div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;          IsSafe = <span class="keyword">false</span>;</div><div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;          <span class="keywordflow">break</span>;</div><div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;        }</div><div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!LocalDefsSet.<a class="code" href="classllvm_1_1SmallSet.html#ab28aa342862f6d16361be514fd98c22e">count</a>(Reg)) {</div><div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;        <span class="keywordflow">if</span> (Defs.<a class="code" href="classllvm_1_1SmallSet.html#ab28aa342862f6d16361be514fd98c22e">count</a>(Reg)) {</div><div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;          <span class="comment">// Use is defined by the instruction at the point of insertion.</span></div><div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;          IsSafe = <span class="keyword">false</span>;</div><div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;          <span class="keywordflow">break</span>;</div><div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;        }</div><div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;</div><div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;        <span class="keywordflow">if</span> (MO.<a class="code" href="classllvm_1_1MachineOperand.html#aa21b508be8c212bdb0b28d734ab0ddb8">isKill</a>() &amp;&amp; Uses.<a class="code" href="classllvm_1_1SmallSet.html#ab28aa342862f6d16361be514fd98c22e">count</a>(Reg))</div><div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;          <span class="comment">// Kills a register that&#39;s read by the instruction at the point of</span></div><div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;          <span class="comment">// insertion. Remove the kill marker.</span></div><div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;          MO.<a class="code" href="classllvm_1_1MachineOperand.html#a8a82683fccdef8a5ef772ef03277aee7">setIsKill</a>(<span class="keyword">false</span>);</div><div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;      }</div><div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;    }</div><div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;    <span class="keywordflow">if</span> (!IsSafe)</div><div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;</div><div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;    <span class="keywordtype">bool</span> DontMoveAcrossStore = <span class="keyword">true</span>;</div><div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;    <span class="keywordflow">if</span> (!TIB-&gt;isSafeToMove(<a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>, 0, DontMoveAcrossStore))</div><div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;</div><div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;    <span class="comment">// Remove kills from LocalDefsSet, these registers had short live ranges.</span></div><div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0, e = TIB-&gt;getNumOperands(); <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != e; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;      <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;MO = TIB-&gt;getOperand(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;      <span class="keywordflow">if</span> (!MO.<a class="code" href="classllvm_1_1MachineOperand.html#ad8198d6d83af9410d867136e33fbf4b2">isReg</a>() || !MO.<a class="code" href="classllvm_1_1MachineOperand.html#a57bf9ee7219097ff0f98da23a3b3b782">isUse</a>() || !MO.<a class="code" href="classllvm_1_1MachineOperand.html#aa21b508be8c212bdb0b28d734ab0ddb8">isKill</a>())</div><div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;      <span class="keywordtype">unsigned</span> <a class="code" href="X86DisassemblerDecoder_8h.html#a546839a5c4bcf9f9450967155f48de41">Reg</a> = MO.<a class="code" href="classllvm_1_1MachineOperand.html#ab75f703d251cc0ce0206fe00a999db86">getReg</a>();</div><div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;      <span class="keywordflow">if</span> (!Reg || !LocalDefsSet.<a class="code" href="classllvm_1_1SmallSet.html#ab28aa342862f6d16361be514fd98c22e">count</a>(Reg))</div><div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1MCRegAliasIterator.html">MCRegAliasIterator</a> AI(Reg, TRI, <span class="keyword">true</span>); AI.<a class="code" href="classllvm_1_1MCRegAliasIterator.html#abf2eadac3ea84e2e2739444c40421eac">isValid</a>(); ++AI)</div><div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;        LocalDefsSet.<a class="code" href="classllvm_1_1SmallSet.html#a75a2d2ad3b3dce6702750d570ee8f343">erase</a>(*AI);</div><div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;    }</div><div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;</div><div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;    <span class="comment">// Track local defs so we can update liveins.</span></div><div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0, e = TIB-&gt;getNumOperands(); <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != e; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;      <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;MO = TIB-&gt;getOperand(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;      <span class="keywordflow">if</span> (!MO.<a class="code" href="classllvm_1_1MachineOperand.html#ad8198d6d83af9410d867136e33fbf4b2">isReg</a>() || !MO.<a class="code" href="classllvm_1_1MachineOperand.html#a8de7d5cf38939044471c6ee60a01a3df">isDef</a>() || MO.<a class="code" href="classllvm_1_1MachineOperand.html#a196420aa839c2b21f42c4bf5c36df437">isDead</a>())</div><div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;      <span class="keywordtype">unsigned</span> <a class="code" href="X86DisassemblerDecoder_8h.html#a546839a5c4bcf9f9450967155f48de41">Reg</a> = MO.<a class="code" href="classllvm_1_1MachineOperand.html#ab75f703d251cc0ce0206fe00a999db86">getReg</a>();</div><div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;      <span class="keywordflow">if</span> (!Reg)</div><div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;      LocalDefs.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(Reg);</div><div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1MCRegAliasIterator.html">MCRegAliasIterator</a> AI(Reg, TRI, <span class="keyword">true</span>); AI.<a class="code" href="classllvm_1_1MCRegAliasIterator.html#abf2eadac3ea84e2e2739444c40421eac">isValid</a>(); ++AI)</div><div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;        LocalDefsSet.<a class="code" href="classllvm_1_1SmallSet.html#a8d8348060ccdeeba13fb8bc651dfbf82">insert</a>(*AI);</div><div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;    }</div><div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;</div><div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;    HasDups = <span class="keyword">true</span>;</div><div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;    ++TIB;</div><div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;    ++FIB;</div><div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;  }</div><div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;</div><div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;  <span class="keywordflow">if</span> (!HasDups)</div><div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;</div><div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;  MBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#adf0023bdc4f05a7849c35b1c859580d8">splice</a>(Loc, TBB, TBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#ab2d91e7bec944efcbc39d8e30644f111">begin</a>(), TIB);</div><div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;  FBB-&gt;erase(FBB-&gt;begin(), FIB);</div><div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;</div><div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;  <span class="comment">// Update livein&#39;s.</span></div><div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0, e = LocalDefs.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#a22a311dfe4c28a897de8a9365a4f0a84">size</a>(); <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != e; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;    <span class="keywordtype">unsigned</span> <a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5aceb138f68fe183995736614928e3394a">Def</a> = LocalDefs[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div><div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;    <span class="keywordflow">if</span> (LocalDefsSet.<a class="code" href="classllvm_1_1SmallSet.html#ab28aa342862f6d16361be514fd98c22e">count</a>(Def)) {</div><div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;      TBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#ae26efdb76d5c56388c65dc5b02a2ae6f">addLiveIn</a>(Def);</div><div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;      FBB-&gt;addLiveIn(Def);</div><div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;    }</div><div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;  }</div><div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;</div><div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;  ++NumHoist;</div><div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;}</div><div class="ttc" id="classllvm_1_1HexagonInstrInfo_html_ad6aff542dc74ce9024d0de5427339f7c"><div class="ttname"><a href="classllvm_1_1HexagonInstrInfo.html#ad6aff542dc74ce9024d0de5427339f7c">llvm::HexagonInstrInfo::ReverseBranchCondition</a></div><div class="ttdeci">virtual bool ReverseBranchCondition(SmallVectorImpl&lt; MachineOperand &gt; &amp;Cond) const </div><div class="ttdef"><b>Definition:</b> <a href="HexagonInstrInfo_8cpp_source.html#l01063">HexagonInstrInfo.cpp:1063</a></div></div>
<div class="ttc" id="classllvm_1_1SmallVectorTemplateCommon_html_a22a311dfe4c28a897de8a9365a4f0a84"><div class="ttname"><a href="classllvm_1_1SmallVectorTemplateCommon.html#a22a311dfe4c28a897de8a9365a4f0a84">llvm::SmallVectorTemplateCommon::size</a></div><div class="ttdeci">size_type size() const </div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00127">SmallVector.h:127</a></div></div>
<div class="ttc" id="SmallSet_8h_html"><div class="ttname"><a href="SmallSet_8h.html">SmallSet.h</a></div></div>
<div class="ttc" id="classllvm_1_1MachineBasicBlock_html_a9ac05913a143322136efcad10ed7548c"><div class="ttname"><a href="classllvm_1_1MachineBasicBlock.html#a9ac05913a143322136efcad10ed7548c">llvm::MachineBasicBlock::succ_size</a></div><div class="ttdeci">unsigned succ_size() const </div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8h_source.html#l00288">MachineBasicBlock.h:288</a></div></div>
<div class="ttc" id="BranchFolding_8cpp_html_a0df528512b8aed2e9f70a3f9b3128507"><div class="ttname"><a href="BranchFolding_8cpp.html#a0df528512b8aed2e9f70a3f9b3128507">EstimateRuntime</a></div><div class="ttdeci">static unsigned EstimateRuntime(MachineBasicBlock::iterator I, MachineBasicBlock::iterator E)</div><div class="ttdef"><b>Definition:</b> <a href="BranchFolding_8cpp_source.html#l00438">BranchFolding.cpp:438</a></div></div>
<div class="ttc" id="classllvm_1_1SmallVectorTemplateBase_html_ae1a10b90f22c0478960fb5798ff73916"><div class="ttname"><a href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">llvm::SmallVectorTemplateBase::push_back</a></div><div class="ttdeci">void push_back(const T &amp;Elt)</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00236">SmallVector.h:236</a></div></div>
<div class="ttc" id="classllvm_1_1MachineBasicBlock_html_af2e482ff2a9253ec6bc2285491496bd6"><div class="ttname"><a href="classllvm_1_1MachineBasicBlock.html#af2e482ff2a9253ec6bc2285491496bd6">llvm::MachineBasicBlock::getParent</a></div><div class="ttdeci">const MachineFunction * getParent() const </div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8h_source.html#l00137">MachineBasicBlock.h:137</a></div></div>
<div class="ttc" id="classllvm_1_1HexagonInstrInfo_html_a4a753587c7751fc7804429aec5453c2d"><div class="ttname"><a href="classllvm_1_1HexagonInstrInfo.html#a4a753587c7751fc7804429aec5453c2d">llvm::HexagonInstrInfo::RemoveBranch</a></div><div class="ttdeci">virtual unsigned RemoveBranch(MachineBasicBlock &amp;MBB) const </div><div class="ttdef"><b>Definition:</b> <a href="HexagonInstrInfo_8cpp_source.html#l00307">HexagonInstrInfo.cpp:307</a></div></div>
<div class="ttc" id="classllvm_1_1MachineBasicBlock_html_a537a9265c55392ab47d44954f27db538"><div class="ttname"><a href="classllvm_1_1MachineBasicBlock.html#a537a9265c55392ab47d44954f27db538">llvm::MachineBasicBlock::erase</a></div><div class="ttdeci">instr_iterator erase(instr_iterator I)</div></div>
<div class="ttc" id="BranchFolding_8cpp_html_a02dc8f03ab0fbd643e0015ca91923d33"><div class="ttname"><a href="BranchFolding_8cpp.html#a02dc8f03ab0fbd643e0015ca91923d33">TailMergeThreshold</a></div><div class="ttdeci">static cl::opt&lt; unsigned &gt; TailMergeThreshold(&quot;tail-merge-threshold&quot;, cl::desc(&quot;Max number of predecessors to consider tail merging&quot;), cl::init(150), cl::Hidden)</div></div>
<div class="ttc" id="namespacellvm_1_1cl_html_a9241f2e42b7587b123c885d7a659ad44a4e55599a5b5277382b14e6e8eb1f63ef"><div class="ttname"><a href="namespacellvm_1_1cl.html#a9241f2e42b7587b123c885d7a659ad44a4e55599a5b5277382b14e6e8eb1f63ef">llvm::cl::BOU_FALSE</a></div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l00432">CommandLine.h:432</a></div></div>
<div class="ttc" id="classllvm_1_1HexagonInstrInfo_html_a6f9cdb0ade88e5375e97bb0905925c5d"><div class="ttname"><a href="classllvm_1_1HexagonInstrInfo.html#a6f9cdb0ade88e5375e97bb0905925c5d">llvm::HexagonInstrInfo::AnalyzeBranch</a></div><div class="ttdeci">virtual bool AnalyzeBranch(MachineBasicBlock &amp;MBB, MachineBasicBlock *&amp;TBB, MachineBasicBlock *&amp;FBB, SmallVectorImpl&lt; MachineOperand &gt; &amp;Cond, bool AllowModify) const </div><div class="ttdef"><b>Definition:</b> <a href="HexagonInstrInfo_8cpp_source.html#l00172">HexagonInstrInfo.cpp:172</a></div></div>
<div class="ttc" id="namespacellvm_html"><div class="ttname"><a href="namespacellvm.html">llvm</a></div><div class="ttdoc">List of target independent CodeGen pass IDs. </div><div class="ttdef"><b>Definition:</b> <a href="APFloat_8h_source.html#l00022">APFloat.h:22</a></div></div>
<div class="ttc" id="classllvm_1_1MCRegisterInfo_1_1DiffListIterator_html_abccd358b92366e5284e7e674e86b241f"><div class="ttname"><a href="classllvm_1_1MCRegisterInfo_1_1DiffListIterator.html#abccd358b92366e5284e7e674e86b241f">llvm::MCRegisterInfo::DiffListIterator::isValid</a></div><div class="ttdeci">bool isValid() const </div><div class="ttdoc">isValid - returns true if this iterator is not yet at the end. </div><div class="ttdef"><b>Definition:</b> <a href="MCRegisterInfo_8h_source.html#l00217">MCRegisterInfo.h:217</a></div></div>
<div class="ttc" id="classllvm_1_1MachineOperand_html_a3350f7760c4eec67ea7d8f3063c3d748"><div class="ttname"><a href="classllvm_1_1MachineOperand.html#a3350f7760c4eec67ea7d8f3063c3d748">llvm::MachineOperand::getMBB</a></div><div class="ttdeci">MachineBasicBlock * getMBB() const </div><div class="ttdef"><b>Definition:</b> <a href="MachineOperand_8h_source.html#l00417">MachineOperand.h:417</a></div></div>
<div class="ttc" id="classllvm_1_1MachineFunction_html_a9d017af749f76484cb9aec9ff6e4330c"><div class="ttname"><a href="classllvm_1_1MachineFunction.html#a9d017af749f76484cb9aec9ff6e4330c">llvm::MachineFunction::end</a></div><div class="ttdeci">iterator end()</div><div class="ttdef"><b>Definition:</b> <a href="MachineFunction_8h_source.html#l00317">MachineFunction.h:317</a></div></div>
<div class="ttc" id="classllvm_1_1MachineOperand_html_a4da580aaf3300fdcf306f17e4a864f6da066f84460d9f7b61d54b187555756ef6"><div class="ttname"><a href="classllvm_1_1MachineOperand.html#a4da580aaf3300fdcf306f17e4a864f6da066f84460d9f7b61d54b187555756ef6">llvm::MachineOperand::MO_Immediate</a></div><div class="ttdoc">Immediate operand. </div><div class="ttdef"><b>Definition:</b> <a href="MachineOperand_8h_source.html#l00047">MachineOperand.h:47</a></div></div>
<div class="ttc" id="classllvm_1_1MachineFunction_html"><div class="ttname"><a href="classllvm_1_1MachineFunction.html">llvm::MachineFunction</a></div><div class="ttdef"><b>Definition:</b> <a href="MachineFunction_8h_source.html#l00075">MachineFunction.h:75</a></div></div>
<div class="ttc" id="classllvm_1_1MachineBasicBlock_html_a6acda287e5c19ffb173b0bf8f1dd9c5e"><div class="ttname"><a href="classllvm_1_1MachineBasicBlock.html#a6acda287e5c19ffb173b0bf8f1dd9c5e">llvm::MachineBasicBlock::getNumber</a></div><div class="ttdeci">int getNumber() const </div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8h_source.html#l00615">MachineBasicBlock.h:615</a></div></div>
<div class="ttc" id="classllvm_1_1MachineFunction_html_ab0789854909cf47f640a85fa2bac29c7"><div class="ttname"><a href="classllvm_1_1MachineFunction.html#ab0789854909cf47f640a85fa2bac29c7">llvm::MachineFunction::begin</a></div><div class="ttdeci">iterator begin()</div><div class="ttdef"><b>Definition:</b> <a href="MachineFunction_8h_source.html#l00315">MachineFunction.h:315</a></div></div>
<div class="ttc" id="classllvm_1_1RegScavenger_html"><div class="ttname"><a href="classllvm_1_1RegScavenger.html">llvm::RegScavenger</a></div><div class="ttdef"><b>Definition:</b> <a href="RegisterScavenging_8h_source.html#l00031">RegisterScavenging.h:31</a></div></div>
<div class="ttc" id="classllvm_1_1MachineBasicBlock_html_a7f0521fa2de44271fd4b909ea7351ef3"><div class="ttname"><a href="classllvm_1_1MachineBasicBlock.html#a7f0521fa2de44271fd4b909ea7351ef3">llvm::MachineBasicBlock::getFirstTerminator</a></div><div class="ttdeci">iterator getFirstTerminator()</div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8cpp_source.html#l00172">MachineBasicBlock.cpp:172</a></div></div>
<div class="ttc" id="classllvm_1_1MachineOperand_html_a196420aa839c2b21f42c4bf5c36df437"><div class="ttname"><a href="classllvm_1_1MachineOperand.html#a196420aa839c2b21f42c4bf5c36df437">llvm::MachineOperand::isDead</a></div><div class="ttdeci">bool isDead() const </div><div class="ttdef"><b>Definition:</b> <a href="MachineOperand_8h_source.html#l00284">MachineOperand.h:284</a></div></div>
<div class="ttc" id="README-SSE_8txt_html_a63d206a063eefcdf8c318ded97b65020"><div class="ttname"><a href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a></div><div class="ttdeci">This currently compiles esp xmm0 movsd esp eax eax esp ret We should use not the dag combiner This is because dagcombine2 needs to be able to see through the X86ISD::Wrapper which DAGCombine can t really do The code for turning x load into a single vector load is target independent and should be moved to the dag combiner The code for turning x load into a vector load can only handle a direct load from a global or a direct load from the stack It should be generalized to handle any load from P</div><div class="ttdef"><b>Definition:</b> <a href="README-SSE_8txt_source.html#l00427">README-SSE.txt:427</a></div></div>
<div class="ttc" id="classllvm_1_1MachineOperand_html_a4da580aaf3300fdcf306f17e4a864f6da99b874c6560305fd292d20f6a06da166"><div class="ttname"><a href="classllvm_1_1MachineOperand.html#a4da580aaf3300fdcf306f17e4a864f6da99b874c6560305fd292d20f6a06da166">llvm::MachineOperand::MO_Register</a></div><div class="ttdoc">Register operand. </div><div class="ttdef"><b>Definition:</b> <a href="MachineOperand_8h_source.html#l00046">MachineOperand.h:46</a></div></div>
<div class="ttc" id="Debug_8h_html"><div class="ttname"><a href="Debug_8h.html">Debug.h</a></div></div>
<div class="ttc" id="classllvm_1_1TargetInstrInfo_html_a641441a84a88e01223f3c091dfb50694"><div class="ttname"><a href="classllvm_1_1TargetInstrInfo.html#a641441a84a88e01223f3c091dfb50694">llvm::TargetInstrInfo::AnalyzeBranch</a></div><div class="ttdeci">virtual bool AnalyzeBranch(MachineBasicBlock &amp;MBB, MachineBasicBlock *&amp;TBB, MachineBasicBlock *&amp;FBB, SmallVectorImpl&lt; MachineOperand &gt; &amp;Cond, bool AllowModify=false) const </div><div class="ttdef"><b>Definition:</b> <a href="TargetInstrInfo_8h_source.html#l00287">TargetInstrInfo.h:287</a></div></div>
<div class="ttc" id="classllvm_1_1MachineBasicBlock_html_a3ddd708642d60c1661992ff8ba1b215d"><div class="ttname"><a href="classllvm_1_1MachineBasicBlock.html#a3ddd708642d60c1661992ff8ba1b215d">llvm::MachineBasicBlock::succ_end</a></div><div class="ttdeci">succ_iterator succ_end()</div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8h_source.html#l00278">MachineBasicBlock.h:278</a></div></div>
<div class="ttc" id="classllvm_1_1SmallPtrSet_html_a9b6dd0fc7a648a939e571246045b673e"><div class="ttname"><a href="classllvm_1_1SmallPtrSet.html#a9b6dd0fc7a648a939e571246045b673e">llvm::SmallPtrSet::insert</a></div><div class="ttdeci">bool insert(PtrType Ptr)</div><div class="ttdef"><b>Definition:</b> <a href="SmallPtrSet_8h_source.html#l00253">SmallPtrSet.h:253</a></div></div>
<div class="ttc" id="Target_2TargetMachine_8h_html"><div class="ttname"><a href="Target_2TargetMachine_8h.html">TargetMachine.h</a></div></div>
<div class="ttc" id="classllvm_1_1MachineJumpTableInfo_html_a4884f00bcde9528a64e1c18adc789641"><div class="ttname"><a href="classllvm_1_1MachineJumpTableInfo.html#a4884f00bcde9528a64e1c18adc789641">llvm::MachineJumpTableInfo::RemoveJumpTable</a></div><div class="ttdeci">void RemoveJumpTable(unsigned Idx)</div><div class="ttdef"><b>Definition:</b> <a href="MachineJumpTableInfo_8h_source.html#l00105">MachineJumpTableInfo.h:105</a></div></div>
<div class="ttc" id="classllvm_1_1MachineBasicBlock_html_ae26efdb76d5c56388c65dc5b02a2ae6f"><div class="ttname"><a href="classllvm_1_1MachineBasicBlock.html#ae26efdb76d5c56388c65dc5b02a2ae6f">llvm::MachineBasicBlock::addLiveIn</a></div><div class="ttdeci">void addLiveIn(unsigned Reg)</div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8h_source.html#l00297">MachineBasicBlock.h:297</a></div></div>
<div class="ttc" id="namespacellvm_html_a7c469a194119a14e5a018ebb9b847cf0"><div class="ttname"><a href="namespacellvm.html#a7c469a194119a14e5a018ebb9b847cf0">llvm::operator&lt;</a></div><div class="ttdeci">void operator&lt;(const Optional&lt; T &gt; &amp;X, const Optional&lt; U &gt; &amp;Y)</div><div class="ttdoc">Poison comparison between two Optional objects. Clients needs to explicitly compare the underlying va...</div></div>
<div class="ttc" id="namespacellvm_1_1sys_1_1path_html_a33706aab89e700b8f79e1fa6f4f0e3ee"><div class="ttname"><a href="namespacellvm_1_1sys_1_1path.html#a33706aab89e700b8f79e1fa6f4f0e3ee">llvm::sys::path::begin</a></div><div class="ttdeci">const_iterator begin(StringRef path)</div><div class="ttdoc">Get begin iterator over path. </div><div class="ttdef"><b>Definition:</b> <a href="Path_8cpp_source.html#l00173">Path.cpp:173</a></div></div>
<div class="ttc" id="classllvm_1_1HexagonInstrInfo_html_ab4e9f5b80f8a3ab31f3dbddf5247c67e"><div class="ttname"><a href="classllvm_1_1HexagonInstrInfo.html#ab4e9f5b80f8a3ab31f3dbddf5247c67e">llvm::HexagonInstrInfo::isPredicated</a></div><div class="ttdeci">virtual bool isPredicated(const MachineInstr *MI) const </div><div class="ttdef"><b>Definition:</b> <a href="HexagonInstrInfo_8cpp_source.html#l00979">HexagonInstrInfo.cpp:979</a></div></div>
<div class="ttc" id="classllvm_1_1MachineBasicBlock_html_af3c2dc75190645b72eee3c416cd14885"><div class="ttname"><a href="classllvm_1_1MachineBasicBlock.html#af3c2dc75190645b72eee3c416cd14885">llvm::MachineBasicBlock::moveAfter</a></div><div class="ttdeci">void moveAfter(MachineBasicBlock *NewBefore)</div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8cpp_source.html#l00381">MachineBasicBlock.cpp:381</a></div></div>
<div class="ttc" id="classllvm_1_1DebugLoc_html"><div class="ttname"><a href="classllvm_1_1DebugLoc.html">llvm::DebugLoc</a></div><div class="ttdef"><b>Definition:</b> <a href="DebugLoc_8h_source.html#l00028">DebugLoc.h:28</a></div></div>
<div class="ttc" id="classllvm_1_1MachineFunction_html_ad784a6594990530bffb2018aeeed56f3"><div class="ttname"><a href="classllvm_1_1MachineFunction.html#ad784a6594990530bffb2018aeeed56f3">llvm::MachineFunction::getFunction</a></div><div class="ttdeci">const Function * getFunction() const </div><div class="ttdef"><b>Definition:</b> <a href="MachineFunction_8h_source.html#l00151">MachineFunction.h:151</a></div></div>
<div class="ttc" id="classllvm_1_1BranchFolder_html_a3c040a6585de941fbc6f26336f9ea9a6"><div class="ttname"><a href="classllvm_1_1BranchFolder.html#a3c040a6585de941fbc6f26336f9ea9a6">llvm::BranchFolder::BranchFolder</a></div><div class="ttdeci">BranchFolder(bool defaultEnableTailMerge, bool CommonHoist)</div><div class="ttdef"><b>Definition:</b> <a href="BranchFolding_8cpp_source.html#l00094">BranchFolding.cpp:94</a></div></div>
<div class="ttc" id="classllvm_1_1TargetInstrInfo_html_abce62a681f245fc78059890e4ca83210"><div class="ttname"><a href="classllvm_1_1TargetInstrInfo.html#abce62a681f245fc78059890e4ca83210">llvm::TargetInstrInfo::RemoveBranch</a></div><div class="ttdeci">virtual unsigned RemoveBranch(MachineBasicBlock &amp;MBB) const </div><div class="ttdef"><b>Definition:</b> <a href="TargetInstrInfo_8h_source.html#l00297">TargetInstrInfo.h:297</a></div></div>
<div class="ttc" id="BranchFolding_8cpp_html_aebca59e55e33781db69d5909a2b2bc49"><div class="ttname"><a href="BranchFolding_8cpp.html#aebca59e55e33781db69d5909a2b2bc49">getBranchDebugLoc</a></div><div class="ttdeci">static DebugLoc getBranchDebugLoc(MachineBasicBlock &amp;MBB)</div><div class="ttdef"><b>Definition:</b> <a href="BranchFolding_8cpp_source.html#l01044">BranchFolding.cpp:1044</a></div></div>
<div class="ttc" id="classllvm_1_1MachineBasicBlock_html_acbc921830578e2741be6549db716c0ce"><div class="ttname"><a href="classllvm_1_1MachineBasicBlock.html#acbc921830578e2741be6549db716c0ce">llvm::MachineBasicBlock::end</a></div><div class="ttdeci">iterator end()</div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8h_source.html#l00238">MachineBasicBlock.h:238</a></div></div>
<div class="ttc" id="Statistic_8h_html"><div class="ttname"><a href="Statistic_8h.html">Statistic.h</a></div></div>
<div class="ttc" id="classllvm_1_1SmallSet_html_a75a2d2ad3b3dce6702750d570ee8f343"><div class="ttname"><a href="classllvm_1_1SmallSet.html#a75a2d2ad3b3dce6702750d570ee8f343">llvm::SmallSet::erase</a></div><div class="ttdeci">bool erase(const T &amp;V)</div><div class="ttdef"><b>Definition:</b> <a href="SmallSet_8h_source.html#l00086">SmallSet.h:86</a></div></div>
<div class="ttc" id="classllvm_1_1MachineBasicBlock_html_ace3ed0412f841777b7de55d47883890e"><div class="ttname"><a href="classllvm_1_1MachineBasicBlock.html#ace3ed0412f841777b7de55d47883890e">llvm::MachineBasicBlock::back</a></div><div class="ttdeci">MachineInstr &amp; back()</div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8h_source.html#l00223">MachineBasicBlock.h:223</a></div></div>
<div class="ttc" id="namespacellvm_1_1cl_html_a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6"><div class="ttname"><a href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">llvm::cl::Hidden</a></div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l00109">CommandLine.h:109</a></div></div>
<div class="ttc" id="classllvm_1_1MachineOperand_html_a4da580aaf3300fdcf306f17e4a864f6daa1741ad7465d81fb3020b84c390ee49d"><div class="ttname"><a href="classllvm_1_1MachineOperand.html#a4da580aaf3300fdcf306f17e4a864f6daa1741ad7465d81fb3020b84c390ee49d">llvm::MachineOperand::MO_JumpTableIndex</a></div><div class="ttdoc">Address of indexed Jump Table for switch. </div><div class="ttdef"><b>Definition:</b> <a href="MachineOperand_8h_source.html#l00054">MachineOperand.h:54</a></div></div>
<div class="ttc" id="X86DisassemblerDecoder_8h_html_a546839a5c4bcf9f9450967155f48de41"><div class="ttname"><a href="X86DisassemblerDecoder_8h.html#a546839a5c4bcf9f9450967155f48de41">Reg</a></div><div class="ttdeci">Reg</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00428">X86DisassemblerDecoder.h:428</a></div></div>
<div class="ttc" id="classllvm_1_1MachineJumpTableInfo_html_adebd965803507068e86d6d3d454338e9"><div class="ttname"><a href="classllvm_1_1MachineJumpTableInfo.html#adebd965803507068e86d6d3d454338e9">llvm::MachineJumpTableInfo::getJumpTables</a></div><div class="ttdeci">const std::vector&lt; MachineJumpTableEntry &gt; &amp; getJumpTables() const </div><div class="ttdef"><b>Definition:</b> <a href="MachineJumpTableInfo_8h_source.html#l00099">MachineJumpTableInfo.h:99</a></div></div>
<div class="ttc" id="classllvm_1_1MachineOperand_html_af19a512f40c1e9247796ad8cee70884b"><div class="ttname"><a href="classllvm_1_1MachineOperand.html#af19a512f40c1e9247796ad8cee70884b">llvm::MachineOperand::isJTI</a></div><div class="ttdeci">bool isJTI() const </div><div class="ttdoc">isJTI - Tests if this is a MO_JumpTableIndex operand. </div><div class="ttdef"><b>Definition:</b> <a href="MachineOperand_8h_source.html#l00240">MachineOperand.h:240</a></div></div>
<div class="ttc" id="classllvm_1_1AnalysisUsage_html_ae5c60fd282ee894c87ea02c3f0fcb6d0"><div class="ttname"><a href="classllvm_1_1AnalysisUsage.html#ae5c60fd282ee894c87ea02c3f0fcb6d0">llvm::AnalysisUsage::addRequired</a></div><div class="ttdeci">AnalysisUsage &amp; addRequired()</div><div class="ttdef"><b>Definition:</b> <a href="PassAnalysisSupport_8h_source.html#l00055">PassAnalysisSupport.h:55</a></div></div>
<div class="ttc" id="classllvm_1_1MachineBasicBlock_html_ae1612b06274368fe13b574cbd9c4f768"><div class="ttname"><a href="classllvm_1_1MachineBasicBlock.html#ae1612b06274368fe13b574cbd9c4f768">llvm::MachineBasicBlock::pred_empty</a></div><div class="ttdeci">bool pred_empty() const </div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8h_source.html#l00275">MachineBasicBlock.h:275</a></div></div>
<div class="ttc" id="classllvm_1_1MachineBasicBlock_html_ab9a54fdc7456ee97cb54ff30d625b6b7"><div class="ttname"><a href="classllvm_1_1MachineBasicBlock.html#ab9a54fdc7456ee97cb54ff30d625b6b7">llvm::MachineBasicBlock::ReplaceUsesOfBlockWith</a></div><div class="ttdeci">void ReplaceUsesOfBlockWith(MachineBasicBlock *Old, MachineBasicBlock *New)</div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8cpp_source.html#l01008">MachineBasicBlock.cpp:1008</a></div></div>
<div class="ttc" id="classllvm_1_1MachineFunctionPass_html"><div class="ttname"><a href="classllvm_1_1MachineFunctionPass.html">llvm::MachineFunctionPass</a></div><div class="ttdef"><b>Definition:</b> <a href="MachineFunctionPass_8h_source.html#l00032">MachineFunctionPass.h:32</a></div></div>
<div class="ttc" id="HexagonCopyToCombine_8cpp_html_a1d40004718218dbdf06b496766299101"><div class="ttname"><a href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a></div><div class="ttdeci">const HexagonInstrInfo * TII</div><div class="ttdef"><b>Definition:</b> <a href="HexagonCopyToCombine_8cpp_source.html#l00115">HexagonCopyToCombine.cpp:115</a></div></div>
<div class="ttc" id="ErrorHandling_8h_html_ace243f5c25697a1107cce46626b3dc94"><div class="ttname"><a href="ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a></div><div class="ttdeci">#define llvm_unreachable(msg)</div><div class="ttdef"><b>Definition:</b> <a href="ErrorHandling_8h_source.html#l00103">ErrorHandling.h:103</a></div></div>
<div class="ttc" id="classllvm_1_1MachineOperand_html_ad8198d6d83af9410d867136e33fbf4b2"><div class="ttname"><a href="classllvm_1_1MachineOperand.html#ad8198d6d83af9410d867136e33fbf4b2">llvm::MachineOperand::isReg</a></div><div class="ttdeci">bool isReg() const </div><div class="ttdoc">isReg - Tests if this is a MO_Register operand. </div><div class="ttdef"><b>Definition:</b> <a href="MachineOperand_8h_source.html#l00224">MachineOperand.h:224</a></div></div>
<div class="ttc" id="classllvm_1_1MachineInstr_html_ac2421adbb9996e1b15f03a8abb6c70a8"><div class="ttname"><a href="classllvm_1_1MachineInstr.html#ac2421adbb9996e1b15f03a8abb6c70a8">llvm::MachineInstr::eraseFromParent</a></div><div class="ttdeci">void eraseFromParent()</div><div class="ttdef"><b>Definition:</b> <a href="MachineInstr_8cpp_source.html#l00846">MachineInstr.cpp:846</a></div></div>
<div class="ttc" id="STLExtras_8h_html"><div class="ttname"><a href="STLExtras_8h.html">STLExtras.h</a></div></div>
<div class="ttc" id="classllvm_1_1MachineBasicBlock_html_aefba5f2af370add1bc8aaceedf7878ef"><div class="ttname"><a href="classllvm_1_1MachineBasicBlock.html#aefba5f2af370add1bc8aaceedf7878ef">llvm::MachineBasicBlock::succ_iterator</a></div><div class="ttdeci">std::vector&lt; MachineBasicBlock * &gt;::iterator succ_iterator</div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8h_source.html#l00249">MachineBasicBlock.h:249</a></div></div>
<div class="ttc" id="ErrorHandling_8h_html"><div class="ttname"><a href="ErrorHandling_8h.html">ErrorHandling.h</a></div></div>
<div class="ttc" id="BranchFolding_8cpp_html_a87d0fbdabd17122a3febe35d7fbefb60"><div class="ttname"><a href="BranchFolding_8cpp.html#a87d0fbdabd17122a3febe35d7fbefb60">IsEmptyBlock</a></div><div class="ttdeci">static bool IsEmptyBlock(MachineBasicBlock *MBB)</div><div class="ttdef"><b>Definition:</b> <a href="BranchFolding_8cpp_source.html#l00990">BranchFolding.cpp:990</a></div></div>
<div class="ttc" id="BranchFolding_8cpp_html_a82220ff274d037282208b6b3d75975c5"><div class="ttname"><a href="BranchFolding_8cpp.html#a82220ff274d037282208b6b3d75975c5">INITIALIZE_PASS</a></div><div class="ttdeci">INITIALIZE_PASS(BranchFolderPass,&quot;branch-folder&quot;,&quot;Control Flow Optimizer&quot;, false, false) bool BranchFolderPass</div><div class="ttdef"><b>Definition:</b> <a href="BranchFolding_8cpp_source.html#l00081">BranchFolding.cpp:81</a></div></div>
<div class="ttc" id="classllvm_1_1MachineBasicBlock_html_aa37d95a1d7bc824da0c596d8334c4ceb"><div class="ttname"><a href="classllvm_1_1MachineBasicBlock.html#aa37d95a1d7bc824da0c596d8334c4ceb">llvm::MachineBasicBlock::empty</a></div><div class="ttdeci">bool empty() const </div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8h_source.html#l00220">MachineBasicBlock.h:220</a></div></div>
<div class="ttc" id="classllvm_1_1MCRegAliasIterator_html_abf2eadac3ea84e2e2739444c40421eac"><div class="ttname"><a href="classllvm_1_1MCRegAliasIterator.html#abf2eadac3ea84e2e2739444c40421eac">llvm::MCRegAliasIterator::isValid</a></div><div class="ttdeci">bool isValid() const </div><div class="ttdef"><b>Definition:</b> <a href="MCRegisterInfo_8h_source.html#l00580">MCRegisterInfo.h:580</a></div></div>
<div class="ttc" id="namespacellvm_1_1CallingConv_html_a4f861731fc6dbfdccc05af5968d98974"><div class="ttname"><a href="namespacellvm_1_1CallingConv.html#a4f861731fc6dbfdccc05af5968d98974">llvm::CallingConv::ID</a></div><div class="ttdeci">ID</div><div class="ttdoc">LLVM Calling Convention Representation. </div><div class="ttdef"><b>Definition:</b> <a href="CallingConv_8h_source.html#l00026">CallingConv.h:26</a></div></div>
<div class="ttc" id="classllvm_1_1TargetPassConfig_html"><div class="ttname"><a href="classllvm_1_1TargetPassConfig.html">llvm::TargetPassConfig</a></div><div class="ttdef"><b>Definition:</b> <a href="CodeGen_2Passes_8h_source.html#l00087">CodeGen/Passes.h:87</a></div></div>
<div class="ttc" id="classllvm_1_1MachineInstr_html_a7b5fe96d88954efc855e6c466207e535"><div class="ttname"><a href="classllvm_1_1MachineInstr.html#a7b5fe96d88954efc855e6c466207e535">llvm::MachineInstr::getNumOperands</a></div><div class="ttdeci">unsigned getNumOperands() const </div><div class="ttdef"><b>Definition:</b> <a href="MachineInstr_8h_source.html#l00265">MachineInstr.h:265</a></div></div>
<div class="ttc" id="classllvm_1_1MachineOperand_html_aa21b508be8c212bdb0b28d734ab0ddb8"><div class="ttname"><a href="classllvm_1_1MachineOperand.html#aa21b508be8c212bdb0b28d734ab0ddb8">llvm::MachineOperand::isKill</a></div><div class="ttdeci">bool isKill() const </div><div class="ttdef"><b>Definition:</b> <a href="MachineOperand_8h_source.html#l00289">MachineOperand.h:289</a></div></div>
<div class="ttc" id="classllvm_1_1MachineBasicBlock_html_a3c5c3bd0c015f3134dc19fe194f635dd"><div class="ttname"><a href="classllvm_1_1MachineBasicBlock.html#a3c5c3bd0c015f3134dc19fe194f635dd">llvm::MachineBasicBlock::transferSuccessors</a></div><div class="ttdeci">void transferSuccessors(MachineBasicBlock *fromMBB)</div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8cpp_source.html#l00574">MachineBasicBlock.cpp:574</a></div></div>
<div class="ttc" id="BranchFolding_8cpp_html_ae07ef8db7162ea7ac8f04e13f75a3580"><div class="ttname"><a href="BranchFolding_8cpp.html#ae07ef8db7162ea7ac8f04e13f75a3580">FlagEnableTailMerge</a></div><div class="ttdeci">static cl::opt&lt; cl::boolOrDefault &gt; FlagEnableTailMerge(&quot;enable-tail-merge&quot;, cl::init(cl::BOU_UNSET), cl::Hidden)</div></div>
<div class="ttc" id="BranchFolding_8cpp_html_a653145c23a36602493bb8dae8ef3d73b"><div class="ttname"><a href="BranchFolding_8cpp.html#a653145c23a36602493bb8dae8ef3d73b">FixTail</a></div><div class="ttdeci">static void FixTail(MachineBasicBlock *CurMBB, MachineBasicBlock *SuccBB, const TargetInstrInfo *TII)</div><div class="ttdef"><b>Definition:</b> <a href="BranchFolding_8cpp_source.html#l00458">BranchFolding.cpp:458</a></div></div>
<div class="ttc" id="classllvm_1_1SmallVectorBase_html_a8a8df4d85555c7954a95f86080cd3b64"><div class="ttname"><a href="classllvm_1_1SmallVectorBase.html#a8a8df4d85555c7954a95f86080cd3b64">llvm::SmallVectorBase::empty</a></div><div class="ttdeci">bool LLVM_ATTRIBUTE_UNUSED_RESULT empty() const </div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00056">SmallVector.h:56</a></div></div>
<div class="ttc" id="classllvm_1_1MachineInstr_html_a242314c0ae0147d1a7ef54c9bc312616"><div class="ttname"><a href="classllvm_1_1MachineInstr.html#a242314c0ae0147d1a7ef54c9bc312616">llvm::MachineInstr::getOpcode</a></div><div class="ttdeci">int getOpcode() const </div><div class="ttdef"><b>Definition:</b> <a href="MachineInstr_8h_source.html#l00261">MachineInstr.h:261</a></div></div>
<div class="ttc" id="classllvm_1_1MachineBasicBlock_html_a5ffb77c69d69a5beff906caaecfd7be4"><div class="ttname"><a href="classllvm_1_1MachineBasicBlock.html#a5ffb77c69d69a5beff906caaecfd7be4">llvm::MachineBasicBlock::canFallThrough</a></div><div class="ttdeci">bool canFallThrough()</div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8cpp_source.html#l00628">MachineBasicBlock.cpp:628</a></div></div>
<div class="ttc" id="classllvm_1_1MachineFunction_html_a73ef91cc71d405f55dd5a77ff8ba56ba"><div class="ttname"><a href="classllvm_1_1MachineFunction.html#a73ef91cc71d405f55dd5a77ff8ba56ba">llvm::MachineFunction::RenumberBlocks</a></div><div class="ttdeci">void RenumberBlocks(MachineBasicBlock *MBBFrom=0)</div><div class="ttdef"><b>Definition:</b> <a href="MachineFunction_8cpp_source.html#l00132">MachineFunction.cpp:132</a></div></div>
<div class="ttc" id="classllvm_1_1MachineFunction_html_a99e93c9b5c2f41b3d601d129a6f60a6e"><div class="ttname"><a href="classllvm_1_1MachineFunction.html#a99e93c9b5c2f41b3d601d129a6f60a6e">llvm::MachineFunction::getJumpTableInfo</a></div><div class="ttdeci">const MachineJumpTableInfo * getJumpTableInfo() const </div><div class="ttdef"><b>Definition:</b> <a href="MachineFunction_8h_source.html#l00181">MachineFunction.h:181</a></div></div>
<div class="ttc" id="classllvm_1_1BitVector_html"><div class="ttname"><a href="classllvm_1_1BitVector.html">llvm::BitVector</a></div><div class="ttdef"><b>Definition:</b> <a href="BitVector_8h_source.html#l00027">BitVector.h:27</a></div></div>
<div class="ttc" id="classllvm_1_1SmallSet_html_a8d8348060ccdeeba13fb8bc651dfbf82"><div class="ttname"><a href="classllvm_1_1SmallSet.html#a8d8348060ccdeeba13fb8bc651dfbf82">llvm::SmallSet::insert</a></div><div class="ttdeci">bool insert(const T &amp;V)</div><div class="ttdef"><b>Definition:</b> <a href="SmallSet_8h_source.html#l00059">SmallSet.h:59</a></div></div>
<div class="ttc" id="classllvm_1_1TargetInstrInfo_html_a051d866f5c8c28d14ebe529a33f5f7b1"><div class="ttname"><a href="classllvm_1_1TargetInstrInfo.html#a051d866f5c8c28d14ebe529a33f5f7b1">llvm::TargetInstrInfo::ReverseBranchCondition</a></div><div class="ttdeci">virtual bool ReverseBranchCondition(SmallVectorImpl&lt; MachineOperand &gt; &amp;Cond) const </div><div class="ttdef"><b>Definition:</b> <a href="TargetInstrInfo_8h_source.html#l00654">TargetInstrInfo.h:654</a></div></div>
<div class="ttc" id="classllvm_1_1MachineBasicBlock_html_a7e7a1a247b7725a24fe19a91f90782cc"><div class="ttname"><a href="classllvm_1_1MachineBasicBlock.html#a7e7a1a247b7725a24fe19a91f90782cc">llvm::MachineBasicBlock::pred_iterator</a></div><div class="ttdeci">std::vector&lt; MachineBasicBlock * &gt;::iterator pred_iterator</div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8h_source.html#l00247">MachineBasicBlock.h:247</a></div></div>
<div class="ttc" id="BranchFolding_8cpp_html_aeaa3cf4dae61117e2ed40085d8b119bb"><div class="ttname"><a href="BranchFolding_8cpp.html#aeaa3cf4dae61117e2ed40085d8b119bb">findHoistingInsertPosAndDeps</a></div><div class="ttdeci">static MachineBasicBlock::iterator findHoistingInsertPosAndDeps(MachineBasicBlock *MBB, const TargetInstrInfo *TII, const TargetRegisterInfo *TRI, SmallSet&lt; unsigned, 4 &gt; &amp;Uses, SmallSet&lt; unsigned, 4 &gt; &amp;Defs)</div><div class="ttdef"><b>Definition:</b> <a href="BranchFolding_8cpp_source.html#l01480">BranchFolding.cpp:1480</a></div></div>
<div class="ttc" id="classllvm_1_1MachineOperand_html_a7059d68a29d5ecfb37623ab45cdb4e8d"><div class="ttname"><a href="classllvm_1_1MachineOperand.html#a7059d68a29d5ecfb37623ab45cdb4e8d">llvm::MachineOperand::getImm</a></div><div class="ttdeci">int64_t getImm() const </div><div class="ttdef"><b>Definition:</b> <a href="MachineOperand_8h_source.html#l00402">MachineOperand.h:402</a></div></div>
<div class="ttc" id="classllvm_1_1Function_html_a88a5e60837674780a9d812d661897ac5"><div class="ttname"><a href="classllvm_1_1Function.html#a88a5e60837674780a9d812d661897ac5">llvm::Function::begin</a></div><div class="ttdeci">iterator begin()</div><div class="ttdef"><b>Definition:</b> <a href="Function_8h_source.html#l00395">Function.h:395</a></div></div>
<div class="ttc" id="classllvm_1_1MachineOperand_html_a4da580aaf3300fdcf306f17e4a864f6da0d4fd3b1a2d5d46d77b66d5a35783580"><div class="ttname"><a href="classllvm_1_1MachineOperand.html#a4da580aaf3300fdcf306f17e4a864f6da0d4fd3b1a2d5d46d77b66d5a35783580">llvm::MachineOperand::MO_ConstantPoolIndex</a></div><div class="ttdoc">Address of indexed Constant in Constant Pool. </div><div class="ttdef"><b>Definition:</b> <a href="MachineOperand_8h_source.html#l00052">MachineOperand.h:52</a></div></div>
<div class="ttc" id="classllvm_1_1MachineBasicBlock_html_a2961c31b29db17a4f2964899c8569a64"><div class="ttname"><a href="classllvm_1_1MachineBasicBlock.html#a2961c31b29db17a4f2964899c8569a64">llvm::MachineBasicBlock::getBasicBlock</a></div><div class="ttdeci">const BasicBlock * getBasicBlock() const </div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8h_source.html#l00117">MachineBasicBlock.h:117</a></div></div>
<div class="ttc" id="classllvm_1_1MachineJumpTableInfo_html"><div class="ttname"><a href="classllvm_1_1MachineJumpTableInfo.html">llvm::MachineJumpTableInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="MachineJumpTableInfo_8h_source.html#l00042">MachineJumpTableInfo.h:42</a></div></div>
<div class="ttc" id="classllvm_1_1TargetInstrInfo_html"><div class="ttname"><a href="classllvm_1_1TargetInstrInfo.html">llvm::TargetInstrInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="TargetInstrInfo_8h_source.html#l00047">TargetInstrInfo.h:47</a></div></div>
<div class="ttc" id="classllvm_1_1MachineBasicBlock_html_ac51be7ff80fe8d6ae5e8c0acb194908a"><div class="ttname"><a href="classllvm_1_1MachineBasicBlock.html#ac51be7ff80fe8d6ae5e8c0acb194908a">llvm::MachineBasicBlock::iterator</a></div><div class="ttdeci">bundle_iterator&lt; MachineInstr, instr_iterator &gt; iterator</div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8h_source.html#l00212">MachineBasicBlock.h:212</a></div></div>
<div class="ttc" id="CommandLine_8h_html"><div class="ttname"><a href="CommandLine_8h.html">CommandLine.h</a></div></div>
<div class="ttc" id="namespacellvm_1_1cl_html_a10a041239ae1870cfcc064bfaa79fb65"><div class="ttname"><a href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">llvm::cl::init</a></div><div class="ttdeci">initializer&lt; Ty &gt; init(const Ty &amp;Val)</div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l00314">CommandLine.h:314</a></div></div>
<div class="ttc" id="RegisterScavenging_8h_html"><div class="ttname"><a href="RegisterScavenging_8h.html">RegisterScavenging.h</a></div></div>
<div class="ttc" id="classllvm_1_1MachineFunction_html_ab2a56feb4fe943ae2362d61f3a43acca"><div class="ttname"><a href="classllvm_1_1MachineFunction.html#ab2a56feb4fe943ae2362d61f3a43acca">llvm::MachineFunction::CreateMachineBasicBlock</a></div><div class="ttdeci">MachineBasicBlock * CreateMachineBasicBlock(const BasicBlock *bb=0)</div><div class="ttdef"><b>Definition:</b> <a href="MachineFunction_8cpp_source.html#l00209">MachineFunction.cpp:209</a></div></div>
<div class="ttc" id="classllvm_1_1MachineBasicBlock_html_a0359a738e0412c5a7ea55d61175e0661"><div class="ttname"><a href="classllvm_1_1MachineBasicBlock.html#a0359a738e0412c5a7ea55d61175e0661">llvm::MachineBasicBlock::pred_end</a></div><div class="ttdeci">pred_iterator pred_end()</div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8h_source.html#l00262">MachineBasicBlock.h:262</a></div></div>
<div class="ttc" id="classllvm_1_1SmallVectorImpl_html_aac0ea55010b7b1a301e65a0baea057aa"><div class="ttname"><a href="classllvm_1_1SmallVectorImpl.html#aac0ea55010b7b1a301e65a0baea057aa">llvm::SmallVectorImpl::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00396">SmallVector.h:396</a></div></div>
<div class="ttc" id="classllvm_1_1BasicBlock_html"><div class="ttname"><a href="classllvm_1_1BasicBlock.html">llvm::BasicBlock</a></div><div class="ttdoc">LLVM Basic Block Representation. </div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00072">BasicBlock.h:72</a></div></div>
<div class="ttc" id="MachineJumpTableInfo_8h_html"><div class="ttname"><a href="MachineJumpTableInfo_8h.html">MachineJumpTableInfo.h</a></div></div>
<div class="ttc" id="classllvm_1_1MachineBasicBlock_html_a1570dd3a2568ba5e52073cdf6d904ee9"><div class="ttname"><a href="classllvm_1_1MachineBasicBlock.html#a1570dd3a2568ba5e52073cdf6d904ee9">llvm::MachineBasicBlock::succ_empty</a></div><div class="ttdeci">bool succ_empty() const </div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8h_source.html#l00291">MachineBasicBlock.h:291</a></div></div>
<div class="ttc" id="namespacellvm_1_1tgtok_html_abbc5259d649363016626e2529fabe0c5aceb138f68fe183995736614928e3394a"><div class="ttname"><a href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5aceb138f68fe183995736614928e3394a">llvm::tgtok::Def</a></div><div class="ttdef"><b>Definition:</b> <a href="TGLexer_8h_source.html#l00046">TGLexer.h:46</a></div></div>
<div class="ttc" id="BranchFolding_8cpp_html_a7fc12fa408f3c5a5e8c205a77ee5c667"><div class="ttname"><a href="BranchFolding_8cpp.html#a7fc12fa408f3c5a5e8c205a77ee5c667">STATISTIC</a></div><div class="ttdeci">STATISTIC(NumDeadBlocks,&quot;Number of dead blocks removed&quot;)</div></div>
<div class="ttc" id="classllvm_1_1SmallSet_html"><div class="ttname"><a href="classllvm_1_1SmallSet.html">llvm::SmallSet</a></div><div class="ttdef"><b>Definition:</b> <a href="SmallSet_8h_source.html#l00031">SmallSet.h:31</a></div></div>
<div class="ttc" id="TargetInstrInfo_8h_html"><div class="ttname"><a href="TargetInstrInfo_8h.html">TargetInstrInfo.h</a></div></div>
<div class="ttc" id="classllvm_1_1MachineInstr_html_a302e45878c6dc1714334c7ce96d56846"><div class="ttname"><a href="classllvm_1_1MachineInstr.html#a302e45878c6dc1714334c7ce96d56846">llvm::MachineInstr::getOperand</a></div><div class="ttdeci">const MachineOperand &amp; getOperand(unsigned i) const </div><div class="ttdef"><b>Definition:</b> <a href="MachineInstr_8h_source.html#l00267">MachineInstr.h:267</a></div></div>
<div class="ttc" id="structllvm_1_1cl_1_1desc_html"><div class="ttname"><a href="structllvm_1_1cl_1_1desc.html">llvm::cl::desc</a></div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l00286">CommandLine.h:286</a></div></div>
<div class="ttc" id="classllvm_1_1MachineOperand_html_a4da580aaf3300fdcf306f17e4a864f6da97561985119c4a774e3ec6439240fa80"><div class="ttname"><a href="classllvm_1_1MachineOperand.html#a4da580aaf3300fdcf306f17e4a864f6da97561985119c4a774e3ec6439240fa80">llvm::MachineOperand::MO_FrameIndex</a></div><div class="ttdoc">Abstract Stack Frame Index. </div><div class="ttdef"><b>Definition:</b> <a href="MachineOperand_8h_source.html#l00051">MachineOperand.h:51</a></div></div>
<div class="ttc" id="classllvm_1_1MachineRegisterInfo_html_aab02e22a5eb05431890303cdeb8d0479"><div class="ttname"><a href="classllvm_1_1MachineRegisterInfo.html#aab02e22a5eb05431890303cdeb8d0479">llvm::MachineRegisterInfo::tracksLiveness</a></div><div class="ttdeci">bool tracksLiveness() const </div><div class="ttdef"><b>Definition:</b> <a href="MachineRegisterInfo_8h_source.html#l00172">MachineRegisterInfo.h:172</a></div></div>
<div class="ttc" id="classllvm_1_1MachineBasicBlock_html"><div class="ttname"><a href="classllvm_1_1MachineBasicBlock.html">llvm::MachineBasicBlock</a></div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8h_source.html#l00062">MachineBasicBlock.h:62</a></div></div>
<div class="ttc" id="classllvm_1_1MCRegAliasIterator_html"><div class="ttname"><a href="classllvm_1_1MCRegAliasIterator.html">llvm::MCRegAliasIterator</a></div><div class="ttdef"><b>Definition:</b> <a href="MCRegisterInfo_8h_source.html#l00555">MCRegisterInfo.h:555</a></div></div>
<div class="ttc" id="classllvm_1_1AnalysisUsage_html"><div class="ttname"><a href="classllvm_1_1AnalysisUsage.html">llvm::AnalysisUsage</a></div><div class="ttdef"><b>Definition:</b> <a href="PassAnalysisSupport_8h_source.html#l00037">PassAnalysisSupport.h:37</a></div></div>
<div class="ttc" id="namespacellvm_html_aa1704159f75e6eacd595962ea6d93ffe"><div class="ttname"><a href="namespacellvm.html#aa1704159f75e6eacd595962ea6d93ffe">llvm::next</a></div><div class="ttdeci">ItTy next(ItTy it, Dist n)</div><div class="ttdef"><b>Definition:</b> <a href="STLExtras_8h_source.html#l00154">STLExtras.h:154</a></div></div>
<div class="ttc" id="classllvm_1_1HexagonInstrInfo_html_a95f554978b4efc4c1ca8b0ed5e017ff6"><div class="ttname"><a href="classllvm_1_1HexagonInstrInfo.html#a95f554978b4efc4c1ca8b0ed5e017ff6">llvm::HexagonInstrInfo::InsertBranch</a></div><div class="ttdeci">virtual unsigned InsertBranch(MachineBasicBlock &amp;MBB, MachineBasicBlock *TBB, MachineBasicBlock *FBB, const SmallVectorImpl&lt; MachineOperand &gt; &amp;Cond, DebugLoc DL) const </div><div class="ttdef"><b>Definition:</b> <a href="HexagonInstrInfo_8cpp_source.html#l00119">HexagonInstrInfo.cpp:119</a></div></div>
<div class="ttc" id="classllvm_1_1TargetPassConfig_html_a0e23643ef5185f324c3214f72f821953"><div class="ttname"><a href="classllvm_1_1TargetPassConfig.html#a0e23643ef5185f324c3214f72f821953">llvm::TargetPassConfig::getEnableTailMerge</a></div><div class="ttdeci">bool getEnableTailMerge() const </div><div class="ttdef"><b>Definition:</b> <a href="CodeGen_2Passes_8h_source.html#l00159">CodeGen/Passes.h:159</a></div></div>
<div class="ttc" id="classllvm_1_1MachineBasicBlock_html_ae89347d3f5dfc901e42b9ec61c46766a"><div class="ttname"><a href="classllvm_1_1MachineBasicBlock.html#ae89347d3f5dfc901e42b9ec61c46766a">llvm::MachineBasicBlock::getLandingPadSuccessor</a></div><div class="ttdeci">const MachineBasicBlock * getLandingPadSuccessor() const </div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8cpp_source.html#l00229">MachineBasicBlock.cpp:229</a></div></div>
<div class="ttc" id="classllvm_1_1MachineOperand_html_ae73de4f077ea9862af9611652396202b"><div class="ttname"><a href="classllvm_1_1MachineOperand.html#ae73de4f077ea9862af9611652396202b">llvm::MachineOperand::getOffset</a></div><div class="ttdeci">int64_t getOffset() const </div><div class="ttdef"><b>Definition:</b> <a href="MachineOperand_8h_source.html#l00445">MachineOperand.h:445</a></div></div>
<div class="ttc" id="BranchFolding_8cpp_html_acda790896623fd894c71bf79f1bbcfea"><div class="ttname"><a href="BranchFolding_8cpp.html#acda790896623fd894c71bf79f1bbcfea">IsBetterFallthrough</a></div><div class="ttdeci">static bool IsBetterFallthrough(MachineBasicBlock *MBB1, MachineBasicBlock *MBB2)</div><div class="ttdef"><b>Definition:</b> <a href="BranchFolding_8cpp_source.html#l01016">BranchFolding.cpp:1016</a></div></div>
<div class="ttc" id="EarlyCSE_8cpp_html_ad83feaec7dc68d46074ce2a1b69ceb9a"><div class="ttname"><a href="EarlyCSE_8cpp.html#ad83feaec7dc68d46074ce2a1b69ceb9a">getHash</a></div><div class="ttdeci">static unsigned getHash(const void *V)</div><div class="ttdef"><b>Definition:</b> <a href="EarlyCSE_8cpp_source.html#l00038">EarlyCSE.cpp:38</a></div></div>
<div class="ttc" id="namespacellvm_1_1cl_html_a9241f2e42b7587b123c885d7a659ad44aa5bd521ebe67ddf0e90f1a9e540a6d43"><div class="ttname"><a href="namespacellvm_1_1cl.html#a9241f2e42b7587b123c885d7a659ad44aa5bd521ebe67ddf0e90f1a9e540a6d43">llvm::cl::BOU_UNSET</a></div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l00432">CommandLine.h:432</a></div></div>
<div class="ttc" id="classllvm_1_1MachineBasicBlock_html_a6321b189ea8fd5058663f8a87d6c23e9"><div class="ttname"><a href="classllvm_1_1MachineBasicBlock.html#a6321b189ea8fd5058663f8a87d6c23e9">llvm::MachineBasicBlock::succ_begin</a></div><div class="ttdeci">succ_iterator succ_begin()</div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8h_source.html#l00276">MachineBasicBlock.h:276</a></div></div>
<div class="ttc" id="classllvm_1_1MachineBasicBlock_html_aabc149950316b323f9cdac2122ff0131"><div class="ttname"><a href="classllvm_1_1MachineBasicBlock.html#aabc149950316b323f9cdac2122ff0131">llvm::MachineBasicBlock::removeSuccessor</a></div><div class="ttdeci">void removeSuccessor(MachineBasicBlock *succ)</div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8cpp_source.html#l00496">MachineBasicBlock.cpp:496</a></div></div>
<div class="ttc" id="classllvm_1_1MachineBasicBlock_html_a25c2a6ee39d0d97dac2184e8bd942300"><div class="ttname"><a href="classllvm_1_1MachineBasicBlock.html#a25c2a6ee39d0d97dac2184e8bd942300">llvm::MachineBasicBlock::moveBefore</a></div><div class="ttdeci">void moveBefore(MachineBasicBlock *NewAfter)</div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8cpp_source.html#l00377">MachineBasicBlock.cpp:377</a></div></div>
<div class="ttc" id="classllvm_1_1TargetRegisterInfo_html"><div class="ttname"><a href="classllvm_1_1TargetRegisterInfo.html">llvm::TargetRegisterInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="TargetRegisterInfo_8h_source.html#l00219">TargetRegisterInfo.h:219</a></div></div>
<div class="ttc" id="classllvm_1_1MachineBasicBlock_html_ab644fcf07a4c2708333cf66276282357"><div class="ttname"><a href="classllvm_1_1MachineBasicBlock.html#ab644fcf07a4c2708333cf66276282357">llvm::MachineBasicBlock::pred_begin</a></div><div class="ttdeci">pred_iterator pred_begin()</div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8h_source.html#l00260">MachineBasicBlock.h:260</a></div></div>
<div class="ttc" id="classllvm_1_1MCSubRegIterator_html"><div class="ttname"><a href="classllvm_1_1MCSubRegIterator.html">llvm::MCSubRegIterator</a></div><div class="ttdef"><b>Definition:</b> <a href="MCRegisterInfo_8h_source.html#l00441">MCRegisterInfo.h:441</a></div></div>
<div class="ttc" id="BranchFolding_8cpp_html_a3a41d2e125b5d09248ee68674761fb14"><div class="ttname"><a href="BranchFolding_8cpp.html#a3a41d2e125b5d09248ee68674761fb14">CountTerminators</a></div><div class="ttdeci">static unsigned CountTerminators(MachineBasicBlock *MBB, MachineBasicBlock::iterator &amp;I)</div><div class="ttdef"><b>Definition:</b> <a href="BranchFolding_8cpp_source.html#l00502">BranchFolding.cpp:502</a></div></div>
<div class="ttc" id="BranchFolding_8cpp_html_a287825ab3d1df2312dfb4c694a70cf43"><div class="ttname"><a href="BranchFolding_8cpp.html#a287825ab3d1df2312dfb4c694a70cf43">TailMergeSize</a></div><div class="ttdeci">static cl::opt&lt; unsigned &gt; TailMergeSize(&quot;tail-merge-size&quot;, cl::desc(&quot;Min number of instructions to consider tail merging&quot;), cl::init(3), cl::Hidden)</div></div>
<div class="ttc" id="classllvm_1_1MachineOperand_html_a8a82683fccdef8a5ef772ef03277aee7"><div class="ttname"><a href="classllvm_1_1MachineOperand.html#a8a82683fccdef8a5ef772ef03277aee7">llvm::MachineOperand::setIsKill</a></div><div class="ttdeci">void setIsKill(bool Val=true)</div><div class="ttdef"><b>Definition:</b> <a href="MachineOperand_8h_source.html#l00367">MachineOperand.h:367</a></div></div>
<div class="ttc" id="classllvm_1_1MachineOperand_html_a2c5eddfba64e7a44deba1b5a0d45a017"><div class="ttname"><a href="classllvm_1_1MachineOperand.html#a2c5eddfba64e7a44deba1b5a0d45a017">llvm::MachineOperand::isRegMask</a></div><div class="ttdeci">bool isRegMask() const </div><div class="ttdoc">isRegMask - Tests if this is a MO_RegisterMask operand. </div><div class="ttdef"><b>Definition:</b> <a href="MachineOperand_8h_source.html#l00248">MachineOperand.h:248</a></div></div>
<div class="ttc" id="classllvm_1_1BranchFolder_html"><div class="ttname"><a href="classllvm_1_1BranchFolder.html">llvm::BranchFolder</a></div><div class="ttdef"><b>Definition:</b> <a href="BranchFolding_8h_source.html#l00024">BranchFolding.h:24</a></div></div>
<div class="ttc" id="Target_2X86_2README_8txt_html_a544ce2b7de50b042a2d052c3d2831598"><div class="ttname"><a href="Target_2X86_2README_8txt.html#a544ce2b7de50b042a2d052c3d2831598">t</a></div><div class="ttdeci">We currently generate a but we really shouldn t</div><div class="ttdef"><b>Definition:</b> <a href="Target_2X86_2README_8txt_source.html#l01384">Target/X86/README.txt:1384</a></div></div>
<div class="ttc" id="classllvm_1_1SmallPtrSet_html"><div class="ttname"><a href="classllvm_1_1SmallPtrSet.html">llvm::SmallPtrSet</a></div><div class="ttdef"><b>Definition:</b> <a href="SmallPtrSet_8h_source.html#l00236">SmallPtrSet.h:236</a></div></div>
<div class="ttc" id="Target_2README_8txt_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">i</div><div class="ttdef"><b>Definition:</b> <a href="Target_2README_8txt_source.html#l00029">Target/README.txt:29</a></div></div>
<div class="ttc" id="classllvm_1_1MachineOperand_html"><div class="ttname"><a href="classllvm_1_1MachineOperand.html">llvm::MachineOperand</a></div><div class="ttdef"><b>Definition:</b> <a href="MachineOperand_8h_source.html#l00043">MachineOperand.h:43</a></div></div>
<div class="ttc" id="classllvm_1_1SmallVector_html"><div class="ttname"><a href="classllvm_1_1SmallVector.html">llvm::SmallVector</a></div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00880">SmallVector.h:880</a></div></div>
<div class="ttc" id="classllvm_1_1Attribute_html_aab7ee4b8fd1d3e7e4cea87868855e60ea2ac83e0612ce8f8d69651cd529061feb"><div class="ttname"><a href="classllvm_1_1Attribute.html#aab7ee4b8fd1d3e7e4cea87868855e60ea2ac83e0612ce8f8d69651cd529061feb">llvm::Attribute::OptimizeForSize</a></div><div class="ttdoc">opt_size </div><div class="ttdef"><b>Definition:</b> <a href="Attributes_8h_source.html#l00091">Attributes.h:91</a></div></div>
<div class="ttc" id="BranchFolding_8cpp_html_a0a05cc04c5d50a14920721da5f53e1fe"><div class="ttname"><a href="BranchFolding_8cpp.html#a0a05cc04c5d50a14920721da5f53e1fe">ProfitableToMerge</a></div><div class="ttdeci">static bool ProfitableToMerge(MachineBasicBlock *MBB1, MachineBasicBlock *MBB2, unsigned minCommonTailLength, unsigned &amp;CommonTailLen, MachineBasicBlock::iterator &amp;I1, MachineBasicBlock::iterator &amp;I2, MachineBasicBlock *SuccBB, MachineBasicBlock *PredBB)</div><div class="ttdef"><b>Definition:</b> <a href="BranchFolding_8cpp_source.html#l00522">BranchFolding.cpp:522</a></div></div>
<div class="ttc" id="classllvm_1_1MachineOperand_html_a8de7d5cf38939044471c6ee60a01a3df"><div class="ttname"><a href="classllvm_1_1MachineOperand.html#a8de7d5cf38939044471c6ee60a01a3df">llvm::MachineOperand::isDef</a></div><div class="ttdeci">bool isDef() const </div><div class="ttdef"><b>Definition:</b> <a href="MachineOperand_8h_source.html#l00274">MachineOperand.h:274</a></div></div>
<div class="ttc" id="classllvm_1_1MachineBasicBlock_html_a57f25804288bc580d7b2e4016a38aec9"><div class="ttname"><a href="classllvm_1_1MachineBasicBlock.html#a57f25804288bc580d7b2e4016a38aec9">llvm::MachineBasicBlock::isSuccessor</a></div><div class="ttdeci">bool isSuccessor(const MachineBasicBlock *MBB) const </div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8cpp_source.html#l00619">MachineBasicBlock.cpp:619</a></div></div>
<div class="ttc" id="classllvm_1_1TargetInstrInfo_html_aad7e5ed58daa51de3466752823b2f76e"><div class="ttname"><a href="classllvm_1_1TargetInstrInfo.html#aad7e5ed58daa51de3466752823b2f76e">llvm::TargetInstrInfo::isUnpredicatedTerminator</a></div><div class="ttdeci">virtual bool isUnpredicatedTerminator(const MachineInstr *MI) const </div><div class="ttdef"><b>Definition:</b> <a href="TargetInstrInfo_8cpp_source.html#l00202">TargetInstrInfo.cpp:202</a></div></div>
<div class="ttc" id="classllvm_1_1MachineRegisterInfo_html_a721b3ae1a20e295cc4f1143958ad3884"><div class="ttname"><a href="classllvm_1_1MachineRegisterInfo.html#a721b3ae1a20e295cc4f1143958ad3884">llvm::MachineRegisterInfo::invalidateLiveness</a></div><div class="ttdeci">void invalidateLiveness()</div><div class="ttdef"><b>Definition:</b> <a href="MachineRegisterInfo_8h_source.html#l00179">MachineRegisterInfo.h:179</a></div></div>
<div class="ttc" id="classllvm_1_1TargetInstrInfo_html_a8afe41bda071ea77c815f7bd436fdd82"><div class="ttname"><a href="classllvm_1_1TargetInstrInfo.html#a8afe41bda071ea77c815f7bd436fdd82">llvm::TargetInstrInfo::InsertBranch</a></div><div class="ttdeci">virtual unsigned InsertBranch(MachineBasicBlock &amp;MBB, MachineBasicBlock *TBB, MachineBasicBlock *FBB, const SmallVectorImpl&lt; MachineOperand &gt; &amp;Cond, DebugLoc DL) const </div><div class="ttdef"><b>Definition:</b> <a href="TargetInstrInfo_8h_source.html#l00311">TargetInstrInfo.h:311</a></div></div>
<div class="ttc" id="namespacellvm_html_a7c46c742c31be54870e2038048e6b391"><div class="ttname"><a href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">llvm::dbgs</a></div><div class="ttdeci">raw_ostream &amp; dbgs()</div><div class="ttdoc">dbgs - Return a circular-buffered debug stream. </div><div class="ttdef"><b>Definition:</b> <a href="Debug_8cpp_source.html#l00101">Debug.cpp:101</a></div></div>
<div class="ttc" id="classllvm_1_1Function_html_a72873ed64b7be01507a2248b8e756ec8"><div class="ttname"><a href="classllvm_1_1Function.html#a72873ed64b7be01507a2248b8e756ec8">llvm::Function::getAttributes</a></div><div class="ttdeci">AttributeSet getAttributes() const </div><div class="ttdoc">Return the attribute list for this Function. </div><div class="ttdef"><b>Definition:</b> <a href="Function_8h_source.html#l00170">Function.h:170</a></div></div>
<div class="ttc" id="CodeGen_2README_8txt_html_a09776db24cf586ec9f1e18f3bae14099"><div class="ttname"><a href="CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a></div><div class="ttdeci">Common register allocation spilling lr str ldr sxth r3 ldr mla r4 can lr mov lr str ldr sxth r3 mla r4 and then merge mul and lr str ldr sxth r3 mla r4 It also increase the likelihood the store may become dead bb27 Successors according to LLVM BB</div><div class="ttdef"><b>Definition:</b> <a href="CodeGen_2README_8txt_source.html#l00036">CodeGen/README.txt:36</a></div></div>
<div class="ttc" id="BranchFolding_8h_html"><div class="ttname"><a href="BranchFolding_8h.html">BranchFolding.h</a></div></div>
<div class="ttc" id="classllvm_1_1MachineInstr_html_ab7650f958c093f7c5faf8c69dbc8c462ad84865ceeee6b326942a3ed2ad37f815"><div class="ttname"><a href="classllvm_1_1MachineInstr.html#ab7650f958c093f7c5faf8c69dbc8c462ad84865ceeee6b326942a3ed2ad37f815">llvm::MachineInstr::CheckKillDead</a></div><div class="ttdef"><b>Definition:</b> <a href="MachineInstr_8h_source.html#l00589">MachineInstr.h:589</a></div></div>
<div class="ttc" id="Function_8h_html"><div class="ttname"><a href="Function_8h.html">Function.h</a></div></div>
<div class="ttc" id="classllvm_1_1MachineRegisterInfo_html"><div class="ttname"><a href="classllvm_1_1MachineRegisterInfo.html">llvm::MachineRegisterInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="MachineRegisterInfo_8h_source.html#l00030">MachineRegisterInfo.h:30</a></div></div>
<div class="ttc" id="classllvm_1_1SmallSet_html_ab28aa342862f6d16361be514fd98c22e"><div class="ttname"><a href="classllvm_1_1SmallSet.html#ab28aa342862f6d16361be514fd98c22e">llvm::SmallSet::count</a></div><div class="ttdeci">bool count(const T &amp;V) const </div><div class="ttdoc">count - Return true if the element is in the set. </div><div class="ttdef"><b>Definition:</b> <a href="SmallSet_8h_source.html#l00048">SmallSet.h:48</a></div></div>
<div class="ttc" id="MachineRegisterInfo_8h_html"><div class="ttname"><a href="MachineRegisterInfo_8h.html">MachineRegisterInfo.h</a></div></div>
<div class="ttc" id="classllvm_1_1MachineInstr_html"><div class="ttname"><a href="classllvm_1_1MachineInstr.html">llvm::MachineInstr</a></div><div class="ttdef"><b>Definition:</b> <a href="MachineInstr_8h_source.html#l00050">MachineInstr.h:50</a></div></div>
<div class="ttc" id="classllvm_1_1MachineOperand_html_a1b63a086907e5b144612bb4266b713d6"><div class="ttname"><a href="classllvm_1_1MachineOperand.html#a1b63a086907e5b144612bb4266b713d6">llvm::MachineOperand::getType</a></div><div class="ttdeci">MachineOperandType getType() const </div><div class="ttdef"><b>Definition:</b> <a href="MachineOperand_8h_source.html#l00185">MachineOperand.h:185</a></div></div>
<div class="ttc" id="classllvm_1_1MachineBasicBlock_html_a654b11787ac7c4344084d98bea7cf626"><div class="ttname"><a href="classllvm_1_1MachineBasicBlock.html#a654b11787ac7c4344084d98bea7cf626">llvm::MachineBasicBlock::const_iterator</a></div><div class="ttdeci">bundle_iterator&lt; const MachineInstr, const_instr_iterator &gt; const_iterator</div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8h_source.html#l00214">MachineBasicBlock.h:214</a></div></div>
<div class="ttc" id="MachineModuleInfo_8h_html"><div class="ttname"><a href="MachineModuleInfo_8h.html">MachineModuleInfo.h</a></div></div>
<div class="ttc" id="classllvm_1_1MachineBasicBlock_html_a9832fb14c5aeb2277bc66d72cc99d105"><div class="ttname"><a href="classllvm_1_1MachineBasicBlock.html#a9832fb14c5aeb2277bc66d72cc99d105">llvm::MachineBasicBlock::hasAddressTaken</a></div><div class="ttdeci">bool hasAddressTaken() const </div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8h_source.html#l00129">MachineBasicBlock.h:129</a></div></div>
<div class="ttc" id="classllvm_1_1MachineBasicBlock_html_a3f522ae33859d693fb5781efe690e9e6"><div class="ttname"><a href="classllvm_1_1MachineBasicBlock.html#a3f522ae33859d693fb5781efe690e9e6">llvm::MachineBasicBlock::isLandingPad</a></div><div class="ttdeci">bool isLandingPad() const </div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8h_source.html#l00331">MachineBasicBlock.h:331</a></div></div>
<div class="ttc" id="classllvm_1_1cl_1_1opt_html"><div class="ttname"><a href="classllvm_1_1cl_1_1opt.html">llvm::cl::opt</a></div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l01149">CommandLine.h:1149</a></div></div>
<div class="ttc" id="classllvm_1_1MachineOperand_html_ac9485ae7d6fedd71ad4460f72c799c98"><div class="ttname"><a href="classllvm_1_1MachineOperand.html#ac9485ae7d6fedd71ad4460f72c799c98">llvm::MachineOperand::getIndex</a></div><div class="ttdeci">int getIndex() const </div><div class="ttdef"><b>Definition:</b> <a href="MachineOperand_8h_source.html#l00422">MachineOperand.h:422</a></div></div>
<div class="ttc" id="classllvm_1_1MachineBasicBlock_html_adf0023bdc4f05a7849c35b1c859580d8"><div class="ttname"><a href="classllvm_1_1MachineBasicBlock.html#adf0023bdc4f05a7849c35b1c859580d8">llvm::MachineBasicBlock::splice</a></div><div class="ttdeci">void splice(iterator Where, MachineBasicBlock *Other, iterator From)</div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8h_source.html#l00539">MachineBasicBlock.h:539</a></div></div>
<div class="ttc" id="classllvm_1_1MachineFunction_html_ab4a6ca428289b667dd691a00e9f7e334"><div class="ttname"><a href="classllvm_1_1MachineFunction.html#ab4a6ca428289b667dd691a00e9f7e334">llvm::MachineFunction::getRegInfo</a></div><div class="ttdeci">MachineRegisterInfo &amp; getRegInfo()</div><div class="ttdef"><b>Definition:</b> <a href="MachineFunction_8h_source.html#l00167">MachineFunction.h:167</a></div></div>
<div class="ttc" id="namespacellvm_1_1cl_html_a9241f2e42b7587b123c885d7a659ad44ad7c4bd83c337c86d34f6c2d8eba1e736"><div class="ttname"><a href="namespacellvm_1_1cl.html#a9241f2e42b7587b123c885d7a659ad44ad7c4bd83c337c86d34f6c2d8eba1e736">llvm::cl::BOU_TRUE</a></div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l00432">CommandLine.h:432</a></div></div>
<div class="ttc" id="classllvm_1_1MachineFunctionPass_html_aa1eece37d175f86a6f4808c0c167f13b"><div class="ttname"><a href="classllvm_1_1MachineFunctionPass.html#aa1eece37d175f86a6f4808c0c167f13b">llvm::MachineFunctionPass::getAnalysisUsage</a></div><div class="ttdeci">virtual void getAnalysisUsage(AnalysisUsage &amp;AU) const </div><div class="ttdef"><b>Definition:</b> <a href="MachineFunctionPass_8cpp_source.html#l00036">MachineFunctionPass.cpp:36</a></div></div>
<div class="ttc" id="classllvm_1_1MachineOperand_html_a57bf9ee7219097ff0f98da23a3b3b782"><div class="ttname"><a href="classllvm_1_1MachineOperand.html#a57bf9ee7219097ff0f98da23a3b3b782">llvm::MachineOperand::isUse</a></div><div class="ttdeci">bool isUse() const </div><div class="ttdef"><b>Definition:</b> <a href="MachineOperand_8h_source.html#l00269">MachineOperand.h:269</a></div></div>
<div class="ttc" id="TargetRegisterInfo_8h_html"><div class="ttname"><a href="TargetRegisterInfo_8h.html">TargetRegisterInfo.h</a></div></div>
<div class="ttc" id="MD5_8cpp_html_ac0eafdc9ee161b71e7af98af736952fd"><div class="ttname"><a href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a></div><div class="ttdeci">#define I(x, y, z)</div><div class="ttdef"><b>Definition:</b> <a href="MD5_8cpp_source.html#l00054">MD5.cpp:54</a></div></div>
<div class="ttc" id="BranchFolding_8cpp_html_ab17cea834a55a63f670e77230917423e"><div class="ttname"><a href="BranchFolding_8cpp.html#ab17cea834a55a63f670e77230917423e">IsBranchOnlyBlock</a></div><div class="ttdeci">static bool IsBranchOnlyBlock(MachineBasicBlock *MBB)</div><div class="ttdef"><b>Definition:</b> <a href="BranchFolding_8cpp_source.html#l01003">BranchFolding.cpp:1003</a></div></div>
<div class="ttc" id="classllvm_1_1MachineBasicBlock_html_ab2d91e7bec944efcbc39d8e30644f111"><div class="ttname"><a href="classllvm_1_1MachineBasicBlock.html#ab2d91e7bec944efcbc39d8e30644f111">llvm::MachineBasicBlock::begin</a></div><div class="ttdeci">iterator begin()</div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8h_source.html#l00236">MachineBasicBlock.h:236</a></div></div>
<div class="ttc" id="BranchFolding_8cpp_html_ac3ecfd2e4efef37daed6d6fdea800a28"><div class="ttname"><a href="BranchFolding_8cpp.html#ac3ecfd2e4efef37daed6d6fdea800a28">findFalseBlock</a></div><div class="ttdeci">static MachineBasicBlock * findFalseBlock(MachineBasicBlock *BB, MachineBasicBlock *TrueBB)</div><div class="ttdef"><b>Definition:</b> <a href="BranchFolding_8cpp_source.html#l01461">BranchFolding.cpp:1461</a></div></div>
<div class="ttc" id="classllvm_1_1MachineOperand_html_ab75f703d251cc0ce0206fe00a999db86"><div class="ttname"><a href="classllvm_1_1MachineOperand.html#ab75f703d251cc0ce0206fe00a999db86">llvm::MachineOperand::getReg</a></div><div class="ttdeci">unsigned getReg() const </div><div class="ttdoc">getReg - Returns the register number. </div><div class="ttdef"><b>Definition:</b> <a href="MachineOperand_8h_source.html#l00259">MachineOperand.h:259</a></div></div>
<div class="ttc" id="classllvm_1_1MachineFunction_html_ae986afe2285d3980b27aa9763f3203e9"><div class="ttname"><a href="classllvm_1_1MachineFunction.html#ae986afe2285d3980b27aa9763f3203e9">llvm::MachineFunction::erase</a></div><div class="ttdeci">void erase(iterator MBBI)</div><div class="ttdef"><b>Definition:</b> <a href="MachineFunction_8h_source.html#l00347">MachineFunction.h:347</a></div></div>
<div class="ttc" id="classllvm_1_1MachineFunction_html_af4c0db6d503e0ba3b8e44067023ffbba"><div class="ttname"><a href="classllvm_1_1MachineFunction.html#af4c0db6d503e0ba3b8e44067023ffbba">llvm::MachineFunction::insert</a></div><div class="ttdeci">void insert(iterator MBBI, MachineBasicBlock *MBB)</div><div class="ttdef"><b>Definition:</b> <a href="MachineFunction_8h_source.html#l00334">MachineFunction.h:334</a></div></div>
<div class="ttc" id="BasicAliasAnalysis_8cpp_html_a2675de1d8479c7b00387979714da43f7"><div class="ttname"><a href="BasicAliasAnalysis_8cpp.html#a2675de1d8479c7b00387979714da43f7">getParent</a></div><div class="ttdeci">static const Function * getParent(const Value *V)</div><div class="ttdef"><b>Definition:</b> <a href="BasicAliasAnalysis_8cpp_source.html#l00447">BasicAliasAnalysis.cpp:447</a></div></div>
<div class="ttc" id="MachineFunctionPass_8h_html"><div class="ttname"><a href="MachineFunctionPass_8h.html">MachineFunctionPass.h</a></div></div>
<div class="ttc" id="namespacellvm_1_1A64CC_html_af5804bc0518be9568f73db566e4d6f46a2db5e7546f960277ff98f96cd5624442"><div class="ttname"><a href="namespacellvm_1_1A64CC.html#af5804bc0518be9568f73db566e4d6f46a2db5e7546f960277ff98f96cd5624442">llvm::A64CC::MI</a></div><div class="ttdef"><b>Definition:</b> <a href="AArch64BaseInfo_8h_source.html#l00035">AArch64BaseInfo.h:35</a></div></div>
<div class="ttc" id="classllvm_1_1MachineFunction_html_a340712de3e78fec11c338735cab17df7"><div class="ttname"><a href="classllvm_1_1MachineFunction.html#a340712de3e78fec11c338735cab17df7">llvm::MachineFunction::iterator</a></div><div class="ttdeci">BasicBlockListType::iterator iterator</div><div class="ttdef"><b>Definition:</b> <a href="MachineFunction_8h_source.html#l00303">MachineFunction.h:303</a></div></div>
<div class="ttc" id="namespacellvm_html_a7923e3e207de8bc1d0d6a5091316ddde"><div class="ttname"><a href="namespacellvm.html#a7923e3e207de8bc1d0d6a5091316ddde">llvm::prior</a></div><div class="ttdeci">ItTy prior(ItTy it, Dist n)</div><div class="ttdef"><b>Definition:</b> <a href="STLExtras_8h_source.html#l00167">STLExtras.h:167</a></div></div>
<div class="ttc" id="namespacellvm_html_ae39ec6579da91ce8fa292f0a7205d98d"><div class="ttname"><a href="namespacellvm.html#ae39ec6579da91ce8fa292f0a7205d98d">llvm::BranchFolderPassID</a></div><div class="ttdeci">char &amp; BranchFolderPassID</div><div class="ttdef"><b>Definition:</b> <a href="BranchFolding_8cpp_source.html#l00079">BranchFolding.cpp:79</a></div></div>
<div class="ttc" id="Debug_8h_html_aef41e8aaf4c60819b30faf396cdf4978"><div class="ttname"><a href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a></div><div class="ttdeci">#define DEBUG(X)</div><div class="ttdef"><b>Definition:</b> <a href="Debug_8h_source.html#l00097">Debug.h:97</a></div></div>
<div class="ttc" id="BranchFolding_8cpp_html_a27436de2b027bf7b58f23547b654603d"><div class="ttname"><a href="BranchFolding_8cpp.html#a27436de2b027bf7b58f23547b654603d">HashMachineInstr</a></div><div class="ttdeci">static unsigned HashMachineInstr(const MachineInstr *MI)</div><div class="ttdoc">HashMachineInstr - Compute a hash value for MI and its operands. </div><div class="ttdef"><b>Definition:</b> <a href="BranchFolding_8cpp_source.html#l00253">BranchFolding.cpp:253</a></div></div>
<div class="ttc" id="classllvm_1_1TargetInstrInfo_html_a2a69dd402cbc7f6282c93c32161395bc"><div class="ttname"><a href="classllvm_1_1TargetInstrInfo.html#a2a69dd402cbc7f6282c93c32161395bc">llvm::TargetInstrInfo::isPredicated</a></div><div class="ttdeci">virtual bool isPredicated(const MachineInstr *MI) const </div><div class="ttdef"><b>Definition:</b> <a href="TargetInstrInfo_8h_source.html#l00672">TargetInstrInfo.h:672</a></div></div>
<div class="ttc" id="MCModuleYAML_8cpp_html_a5e410df3f6875c5af4a7f2be284f235d"><div class="ttname"><a href="MCModuleYAML_8cpp.html#a5e410df3f6875c5af4a7f2be284f235d">MRI</a></div><div class="ttdeci">const MCRegisterInfo &amp; MRI</div><div class="ttdef"><b>Definition:</b> <a href="MCModuleYAML_8cpp_source.html#l00056">MCModuleYAML.cpp:56</a></div></div>
<div class="ttc" id="raw__ostream_8h_html"><div class="ttname"><a href="raw__ostream_8h.html">raw_ostream.h</a></div></div>
<div class="ttc" id="classllvm_1_1BranchFolder_html_a79c0c5340d25122d14d264f3281bdfe4"><div class="ttname"><a href="classllvm_1_1BranchFolder.html#a79c0c5340d25122d14d264f3281bdfe4">llvm::BranchFolder::OptimizeFunction</a></div><div class="ttdeci">bool OptimizeFunction(MachineFunction &amp;MF, const TargetInstrInfo *tii, const TargetRegisterInfo *tri, MachineModuleInfo *mmi)</div><div class="ttdef"><b>Definition:</b> <a href="BranchFolding_8cpp_source.html#l00174">BranchFolding.cpp:174</a></div></div>
<div class="ttc" id="BranchFolding_8cpp_html_a23f0fe5fd9bac0df47092cb480fbe136"><div class="ttname"><a href="BranchFolding_8cpp.html#a23f0fe5fd9bac0df47092cb480fbe136">HashEndOfMBB</a></div><div class="ttdeci">static unsigned HashEndOfMBB(const MachineBasicBlock *MBB)</div><div class="ttdoc">HashEndOfMBB - Hash the last instruction in the MBB. </div><div class="ttdef"><b>Definition:</b> <a href="BranchFolding_8cpp_source.html#l00286">BranchFolding.cpp:286</a></div></div>
<div class="ttc" id="classllvm_1_1SmallSet_html_afd57abe5a6e10c8b282b6549432ec851"><div class="ttname"><a href="classllvm_1_1SmallSet.html#afd57abe5a6e10c8b282b6549432ec851">llvm::SmallSet::empty</a></div><div class="ttdeci">bool empty() const </div><div class="ttdef"><b>Definition:</b> <a href="SmallSet_8h_source.html#l00042">SmallSet.h:42</a></div></div>
<div class="ttc" id="CodeGen_2Passes_8h_html"><div class="ttname"><a href="CodeGen_2Passes_8h.html">Passes.h</a></div></div>
<div class="ttc" id="classllvm_1_1MachineBasicBlock_html_a0fc7a349a4ab737607def6cb461791fd"><div class="ttname"><a href="classllvm_1_1MachineBasicBlock.html#a0fc7a349a4ab737607def6cb461791fd">llvm::MachineBasicBlock::isLayoutSuccessor</a></div><div class="ttdeci">bool isLayoutSuccessor(const MachineBasicBlock *MBB) const </div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8cpp_source.html#l00623">MachineBasicBlock.cpp:623</a></div></div>
<div class="ttc" id="Target_2ARM_2README_8txt_html_a90cca76dd78688687e0d697679dbc799"><div class="ttname"><a href="Target_2ARM_2README_8txt.html#a90cca76dd78688687e0d697679dbc799">B</a></div><div class="ttdeci">compiles ldr LCPI1_0 ldr ldr mov lsr tst moveq r1 ldr LCPI1_1 and r0 bx lr It would be better to do something like to fold the shift into the conditional ldr LCPI1_0 ldr ldr tst movne lsr ldr LCPI1_1 and r0 bx lr it saves an instruction and a register It might be profitable to cse MOVi16 if there are lots of bit immediates with the same bottom half Robert Muth started working on an alternate jump table implementation that does not put the tables in line in the text This is more like the llvm default jump table implementation This might be useful sometime Several revisions of patches are on the mailing beginning while CMP sets them like a subtract Therefore to be able to use CMN for comparisons other than the Z we ll need additional logic to reverse the conditionals associated with the comparison Perhaps a pseudo instruction for the with a post codegen pass to clean up and handle the condition codes See PR5694 for testcase Given the following on int B</div><div class="ttdef"><b>Definition:</b> <a href="Target_2ARM_2README_8txt_source.html#l00592">Target/ARM/README.txt:592</a></div></div>
<div class="ttc" id="classllvm_1_1MachineBasicBlock_html_a3fcc360e6de146a370e8b0deecfa877f"><div class="ttname"><a href="classllvm_1_1MachineBasicBlock.html#a3fcc360e6de146a370e8b0deecfa877f">llvm::MachineBasicBlock::addSuccessor</a></div><div class="ttdeci">void addSuccessor(MachineBasicBlock *succ, uint32_t weight=0)</div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8cpp_source.html#l00482">MachineBasicBlock.cpp:482</a></div></div>
<div class="ttc" id="classllvm_1_1MachineBasicBlock_html_ac9786455bc217ebd35377bb5d5ec8f20"><div class="ttname"><a href="classllvm_1_1MachineBasicBlock.html#ac9786455bc217ebd35377bb5d5ec8f20">llvm::MachineBasicBlock::pred_size</a></div><div class="ttdeci">unsigned pred_size() const </div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8h_source.html#l00272">MachineBasicBlock.h:272</a></div></div>
<div class="ttc" id="classllvm_1_1MachineBasicBlock_html_aa20773d21c44eb6e0e330d96636cc4b0"><div class="ttname"><a href="classllvm_1_1MachineBasicBlock.html#aa20773d21c44eb6e0e330d96636cc4b0">llvm::MachineBasicBlock::CorrectExtraCFGEdges</a></div><div class="ttdeci">bool CorrectExtraCFGEdges(MachineBasicBlock *DestA, MachineBasicBlock *DestB, bool isCond)</div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8cpp_source.html#l01037">MachineBasicBlock.cpp:1037</a></div></div>
<div class="ttc" id="classllvm_1_1MachineInstr_html_a5ca4eb718a8caedcad900fd7cd937cac"><div class="ttname"><a href="classllvm_1_1MachineInstr.html#a5ca4eb718a8caedcad900fd7cd937cac">llvm::MachineInstr::isBarrier</a></div><div class="ttdeci">bool isBarrier(QueryType Type=AnyInBundle) const </div><div class="ttdef"><b>Definition:</b> <a href="MachineInstr_8h_source.html#l00356">MachineInstr.h:356</a></div></div>
<div class="ttc" id="classllvm_1_1MachineOperand_html_a4da580aaf3300fdcf306f17e4a864f6da95566cb4525dab82db8cbbed3d634c23"><div class="ttname"><a href="classllvm_1_1MachineOperand.html#a4da580aaf3300fdcf306f17e4a864f6da95566cb4525dab82db8cbbed3d634c23">llvm::MachineOperand::MO_MachineBasicBlock</a></div><div class="ttdoc">MachineBasicBlock reference. </div><div class="ttdef"><b>Definition:</b> <a href="MachineOperand_8h_source.html#l00050">MachineOperand.h:50</a></div></div>
<div class="ttc" id="classllvm_1_1MachineModuleInfo_html"><div class="ttname"><a href="classllvm_1_1MachineModuleInfo.html">llvm::MachineModuleInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="MachineModuleInfo_8h_source.html#l00097">MachineModuleInfo.h:97</a></div></div>
<div class="ttc" id="BranchFolding_8cpp_html_a0ff8a27be1a6683026280a4611628562"><div class="ttname"><a href="BranchFolding_8cpp.html#a0ff8a27be1a6683026280a4611628562">ComputeCommonTailLength</a></div><div class="ttdeci">static unsigned ComputeCommonTailLength(MachineBasicBlock *MBB1, MachineBasicBlock *MBB2, MachineBasicBlock::iterator &amp;I1, MachineBasicBlock::iterator &amp;I2)</div><div class="ttdef"><b>Definition:</b> <a href="BranchFolding_8cpp_source.html#l00305">BranchFolding.cpp:305</a></div></div>
<div class="ttc" id="classllvm_1_1MachineOperand_html_a4da580aaf3300fdcf306f17e4a864f6da3f1f6bfc5aa57cf388201bf6b8fee7d3"><div class="ttname"><a href="classllvm_1_1MachineOperand.html#a4da580aaf3300fdcf306f17e4a864f6da3f1f6bfc5aa57cf388201bf6b8fee7d3">llvm::MachineOperand::MO_GlobalAddress</a></div><div class="ttdoc">Address of a global value. </div><div class="ttdef"><b>Definition:</b> <a href="MachineOperand_8h_source.html#l00056">MachineOperand.h:56</a></div></div>
<div class="ttc" id="classllvm_1_1MachineOperand_html_a4da580aaf3300fdcf306f17e4a864f6da9d22ed12eec3e14283ed6a3617d12119"><div class="ttname"><a href="classllvm_1_1MachineOperand.html#a4da580aaf3300fdcf306f17e4a864f6da9d22ed12eec3e14283ed6a3617d12119">llvm::MachineOperand::MO_ExternalSymbol</a></div><div class="ttdoc">Name of external global symbol. </div><div class="ttdef"><b>Definition:</b> <a href="MachineOperand_8h_source.html#l00055">MachineOperand.h:55</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<hr>
<p class="footer">
Generated on Sat Nov 10 2018 22:58:16 for <a href="http://llvm.org/">LLVM</a> by
<a href="http://www.doxygen.org"><img src="doxygen.png" alt="Doxygen"
align="middle" border="0"/>1.8.11</a><br>
Copyright &copy; 2003-2013 University of Illinois at Urbana-Champaign.
All Rights Reserved.</p>
<hr>
<!--#include virtual="/attrib.incl" -->
</body>
</html>
