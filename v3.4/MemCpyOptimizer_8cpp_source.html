<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head>
<meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1"/>
<meta name="keywords" content="LLVM,Low Level Virtual Machine,C++,doxygen,API,documentation"/>
<meta name="description" content="C++ source code API documentation for LLVM."/>
<title>LLVM: MemCpyOptimizer.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head><body>
<p class="title">LLVM API Documentation</p>
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('MemCpyOptimizer_8cpp_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">MemCpyOptimizer.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="MemCpyOptimizer_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//===- MemCpyOptimizer.cpp - Optimize use of memcpy and friends -----------===//</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">//                     The LLVM Compiler Infrastructure</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// This file is distributed under the University of Illinois Open Source</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">// License. See LICENSE.TXT for details.</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">// This pass performs various transformations related to eliminating memcpy</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">// calls, or transforming sets of stores into memset&#39;s.</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;</div><div class="line"><a name="l00015"></a><span class="lineno"><a class="line" href="MemCpyOptimizer_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">   15</a></span>&#160;<span class="preprocessor">#define DEBUG_TYPE &quot;memcpyopt&quot;</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Transforms_2Scalar_8h.html">llvm/Transforms/Scalar.h</a>&quot;</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="SmallVector_8h.html">llvm/ADT/SmallVector.h</a>&quot;</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Statistic_8h.html">llvm/ADT/Statistic.h</a>&quot;</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="AliasAnalysis_8h.html">llvm/Analysis/AliasAnalysis.h</a>&quot;</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Dominators_8h.html">llvm/Analysis/Dominators.h</a>&quot;</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="MemoryDependenceAnalysis_8h.html">llvm/Analysis/MemoryDependenceAnalysis.h</a>&quot;</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ValueTracking_8h.html">llvm/Analysis/ValueTracking.h</a>&quot;</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="DataLayout_8h.html">llvm/IR/DataLayout.h</a>&quot;</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="GlobalVariable_8h.html">llvm/IR/GlobalVariable.h</a>&quot;</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="IRBuilder_8h.html">llvm/IR/IRBuilder.h</a>&quot;</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Instructions_8h.html">llvm/IR/Instructions.h</a>&quot;</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="IntrinsicInst_8h.html">llvm/IR/IntrinsicInst.h</a>&quot;</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Debug_8h.html">llvm/Support/Debug.h</a>&quot;</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="GetElementPtrTypeIterator_8h.html">llvm/Support/GetElementPtrTypeIterator.h</a>&quot;</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="raw__ostream_8h.html">llvm/Support/raw_ostream.h</a>&quot;</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TargetLibraryInfo_8h.html">llvm/Target/TargetLibraryInfo.h</a>&quot;</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Local_8h.html">llvm/Transforms/Utils/Local.h</a>&quot;</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &lt;list&gt;</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespacellvm.html">llvm</a>;</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<a class="code" href="MemCpyOptimizer_8cpp.html#ae52446f66e9897ccb698024fadedcdbb">STATISTIC</a>(NumMemCpyInstr, <span class="stringliteral">&quot;Number of memcpy instructions deleted&quot;</span>);</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<a class="code" href="MemCpyOptimizer_8cpp.html#ae52446f66e9897ccb698024fadedcdbb">STATISTIC</a>(NumMemSetInfer, <span class="stringliteral">&quot;Number of memsets inferred&quot;</span>);</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<a class="code" href="MemCpyOptimizer_8cpp.html#ae52446f66e9897ccb698024fadedcdbb">STATISTIC</a>(NumMoveToCpy,   <span class="stringliteral">&quot;Number of memmoves converted to memcpy&quot;</span>);</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<a class="code" href="MemCpyOptimizer_8cpp.html#ae52446f66e9897ccb698024fadedcdbb">STATISTIC</a>(NumCpyToSet,    <span class="stringliteral">&quot;Number of memcpys converted to memset&quot;</span>);</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;</div><div class="line"><a name="l00041"></a><span class="lineno"><a class="line" href="MemCpyOptimizer_8cpp.html#a550b438e70324776ea328ac8248dc268">   41</a></span>&#160;<span class="keyword">static</span> int64_t <a class="code" href="MemCpyOptimizer_8cpp.html#a550b438e70324776ea328ac8248dc268">GetOffsetFromIndex</a>(<span class="keyword">const</span> <a class="code" href="classllvm_1_1GEPOperator.html">GEPOperator</a> *GEP, <span class="keywordtype">unsigned</span> Idx,</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;                                  <span class="keywordtype">bool</span> &amp;VariableIdxFound, <span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> &amp;TD){</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  <span class="comment">// Skip over the first indices.</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  <a class="code" href="classllvm_1_1generic__gep__type__iterator.html">gep_type_iterator</a> GTI = <a class="code" href="namespacellvm.html#ac828b9b52935f87659a4adf237f820a3">gep_type_begin</a>(GEP);</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 1; <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != Idx; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>, ++GTI)</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <span class="comment">/*skip along*/</span>;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  <span class="comment">// Compute the offset implied by the rest of the indices.</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  int64_t Offset = 0;</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = Idx, e = GEP-&gt;<a class="code" href="classllvm_1_1User.html#a2f81e0c1fc6554df7ad2eafabf5fc5a5">getNumOperands</a>(); <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != e; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>, ++GTI) {</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *OpC = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a>&gt;(GEP-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>));</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="keywordflow">if</span> (OpC == 0)</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;      <span class="keywordflow">return</span> VariableIdxFound = <span class="keyword">true</span>;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <span class="keywordflow">if</span> (OpC-&gt;<a class="code" href="classllvm_1_1ConstantInt.html#ad4ea4748170f687710a54c919dde5625">isZero</a>()) <span class="keywordflow">continue</span>;  <span class="comment">// No offset.</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <span class="comment">// Handle struct indices, which add their field offset to the pointer.</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1StructType.html">StructType</a> *STy = dyn_cast&lt;StructType&gt;(*GTI)) {</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;      Offset += TD.<a class="code" href="classllvm_1_1DataLayout.html#a35c840104f32575e0d91422cf1ef3ce4">getStructLayout</a>(STy)-&gt;<a class="code" href="classllvm_1_1StructLayout.html#ae10c4483372a357a0d3411b3d64be10c">getElementOffset</a>(OpC-&gt;<a class="code" href="classllvm_1_1ConstantInt.html#a6edd823ba5e4e1effc8280ca8a1194ef">getZExtValue</a>());</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    }</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="comment">// Otherwise, we have a sequential type like an array or vector.  Multiply</span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <span class="comment">// the index by the ElementSize.</span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    uint64_t Size = TD.<a class="code" href="classllvm_1_1DataLayout.html#a1d6fcc02e91ba24510aba42660c90e29">getTypeAllocSize</a>(GTI.<a class="code" href="classllvm_1_1generic__gep__type__iterator.html#aa9576aea404b156a949122affc839777">getIndexedType</a>());</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    Offset += Size*OpC-&gt;<a class="code" href="classllvm_1_1ConstantInt.html#a097c2d42e4deffabe6d54b007ad83367">getSExtValue</a>();</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  }</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  <span class="keywordflow">return</span> Offset;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;}</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment">/// IsPointerOffset - Return true if Ptr1 is provably equal to Ptr2 plus a</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment">/// constant offset, and return that constant offset.  For example, Ptr1 might</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">/// be &amp;A[42], and Ptr2 might be &amp;A[40].  In this case offset would be -8.</span></div><div class="line"><a name="l00074"></a><span class="lineno"><a class="line" href="MemCpyOptimizer_8cpp.html#a6ee1a66b9681fb20cdc5f8ec6b59bef5">   74</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="MemCpyOptimizer_8cpp.html#a6ee1a66b9681fb20cdc5f8ec6b59bef5">IsPointerOffset</a>(<a class="code" href="classllvm_1_1Value.html">Value</a> *Ptr1, <a class="code" href="classllvm_1_1Value.html">Value</a> *Ptr2, int64_t &amp;Offset,</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;                            <span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> &amp;TD) {</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  Ptr1 = Ptr1-&gt;<a class="code" href="classllvm_1_1Value.html#a38ea12c04523d63adda732b9c5d6da0a">stripPointerCasts</a>();</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  Ptr2 = Ptr2-&gt;<a class="code" href="classllvm_1_1Value.html#a38ea12c04523d63adda732b9c5d6da0a">stripPointerCasts</a>();</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  <a class="code" href="classllvm_1_1GEPOperator.html">GEPOperator</a> *GEP1 = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1GEPOperator.html">GEPOperator</a>&gt;(Ptr1);</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  <a class="code" href="classllvm_1_1GEPOperator.html">GEPOperator</a> *GEP2 = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1GEPOperator.html">GEPOperator</a>&gt;(Ptr2);</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  <span class="keywordtype">bool</span> VariableIdxFound = <span class="keyword">false</span>;</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  <span class="comment">// If one pointer is a GEP and the other isn&#39;t, then see if the GEP is a</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  <span class="comment">// constant offset from the base, as in &quot;P&quot; and &quot;gep P, 1&quot;.</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <span class="keywordflow">if</span> (GEP1 &amp;&amp; GEP2 == 0 &amp;&amp; GEP1-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0)-&gt;<a class="code" href="classllvm_1_1Value.html#a38ea12c04523d63adda732b9c5d6da0a">stripPointerCasts</a>() == Ptr2) {</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    Offset = -<a class="code" href="MemCpyOptimizer_8cpp.html#a550b438e70324776ea328ac8248dc268">GetOffsetFromIndex</a>(GEP1, 1, VariableIdxFound, TD);</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <span class="keywordflow">return</span> !VariableIdxFound;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  }</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <span class="keywordflow">if</span> (GEP2 &amp;&amp; GEP1 == 0 &amp;&amp; GEP2-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0)-&gt;<a class="code" href="classllvm_1_1Value.html#a38ea12c04523d63adda732b9c5d6da0a">stripPointerCasts</a>() == Ptr1) {</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    Offset = <a class="code" href="MemCpyOptimizer_8cpp.html#a550b438e70324776ea328ac8248dc268">GetOffsetFromIndex</a>(GEP2, 1, VariableIdxFound, TD);</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="keywordflow">return</span> !VariableIdxFound;</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  }</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  <span class="comment">// Right now we handle the case when Ptr1/Ptr2 are both GEPs with an identical</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  <span class="comment">// base.  After that base, they may have some number of common (and</span></div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <span class="comment">// potentially variable) indices.  After that they handle some constant</span></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  <span class="comment">// offset, which determines their offset from each other.  At this point, we</span></div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  <span class="comment">// handle no other case.</span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  <span class="keywordflow">if</span> (!GEP1 || !GEP2 || GEP1-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0) != GEP2-&gt;getOperand(0))</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  <span class="comment">// Skip any common indices and track the GEP types.</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  <span class="keywordtype">unsigned</span> Idx = 1;</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  <span class="keywordflow">for</span> (; Idx != GEP1-&gt;<a class="code" href="classllvm_1_1User.html#a2f81e0c1fc6554df7ad2eafabf5fc5a5">getNumOperands</a>() &amp;&amp; Idx != GEP2-&gt;getNumOperands(); ++Idx)</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="keywordflow">if</span> (GEP1-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(Idx) != GEP2-&gt;getOperand(Idx))</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  int64_t Offset1 = <a class="code" href="MemCpyOptimizer_8cpp.html#a550b438e70324776ea328ac8248dc268">GetOffsetFromIndex</a>(GEP1, Idx, VariableIdxFound, TD);</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  int64_t Offset2 = <a class="code" href="MemCpyOptimizer_8cpp.html#a550b438e70324776ea328ac8248dc268">GetOffsetFromIndex</a>(GEP2, Idx, VariableIdxFound, TD);</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  <span class="keywordflow">if</span> (VariableIdxFound) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  Offset = Offset2-Offset1;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;}</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment">/// MemsetRange - Represents a range of memset&#39;d bytes with the ByteVal value.</span></div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment">/// This allows us to analyze stores like:</span></div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment">///   store 0 -&gt; P+1</span></div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment">///   store 0 -&gt; P+0</span></div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment">///   store 0 -&gt; P+3</span></div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment">///   store 0 -&gt; P+2</span></div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment">/// which sometimes happens with stores to arrays of structs etc.  When we see</span></div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment">/// the first store, we make a range [1, 2).  The second store extends the range</span></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment">/// to [0, 2).  The third makes a new range [2, 3).  The fourth store joins the</span></div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment">/// two ranges into [0, 3) which is memset&#39;able.</span></div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment"></span><span class="keyword">namespace </span>{</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="keyword">struct </span>MemsetRange {</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  <span class="comment">// Start/End - A semi range that describes the span that this range covers.</span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  <span class="comment">// The range is closed at the start and open at the end: [Start, End).</span></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  int64_t Start, End;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment">  /// StartPtr - The getelementptr instruction that points to the start of the</span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment">  /// range.</span></div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1Value.html">Value</a> *StartPtr;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment">  /// Alignment - The known alignment of the first store.</span></div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment"></span>  <span class="keywordtype">unsigned</span> Alignment;</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment">  /// TheStores - The actual stores that make up this range.</span></div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Instruction*, 16&gt;</a> TheStores;</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  <span class="keywordtype">bool</span> isProfitableToUseMemset(<span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> &amp;TD) <span class="keyword">const</span>;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;};</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;} <span class="comment">// end anon namespace</span></div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="keywordtype">bool</span> MemsetRange::isProfitableToUseMemset(<span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> &amp;TD)<span class="keyword"> const </span>{</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  <span class="comment">// If we found more than 4 stores to merge or 16 bytes, use memset.</span></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  <span class="keywordflow">if</span> (TheStores.size() &gt;= 4 || End-Start &gt;= 16) <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  <span class="comment">// If there is nothing to merge, don&#39;t do anything.</span></div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  <span class="keywordflow">if</span> (TheStores.size() &lt; 2) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  <span class="comment">// If any of the stores are a memset, then it is always good to extend the</span></div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  <span class="comment">// memset.</span></div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0, e = TheStores.size(); <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != e; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <span class="keywordflow">if</span> (!isa&lt;StoreInst&gt;(TheStores[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>]))</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  <span class="comment">// Assume that the code generator is capable of merging pairs of stores</span></div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  <span class="comment">// together if it wants to.</span></div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  <span class="keywordflow">if</span> (TheStores.size() == 2) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  <span class="comment">// If we have fewer than 8 stores, it can still be worthwhile to do this.</span></div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  <span class="comment">// For example, merging 4 i8 stores into an i32 store is useful almost always.</span></div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  <span class="comment">// However, merging 2 32-bit stores isn&#39;t useful on a 32-bit architecture (the</span></div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  <span class="comment">// memset will be split into 2 32-bit stores anyway) and doing so can</span></div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  <span class="comment">// pessimize the llvm optimizer.</span></div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  <span class="comment">//</span></div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  <span class="comment">// Since we don&#39;t have perfect knowledge here, make some assumptions: assume</span></div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  <span class="comment">// the maximum GPR width is the same size as the largest legal integer</span></div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  <span class="comment">// size. If so, check to see whether we will end up actually reducing the</span></div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  <span class="comment">// number of stores used.</span></div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  <span class="keywordtype">unsigned</span> Bytes = unsigned(End-Start);</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  <span class="keywordtype">unsigned</span> MaxIntSize = TD.<a class="code" href="classllvm_1_1DataLayout.html#ac57ff4f484955ce8b36168c3dd29494b">getLargestLegalIntTypeSize</a>();</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  <span class="keywordflow">if</span> (MaxIntSize == 0)</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    MaxIntSize = 1;</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  <span class="keywordtype">unsigned</span> NumPointerStores = Bytes / MaxIntSize;</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  <span class="comment">// Assume the remaining bytes if any are done a byte at a time.</span></div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  <span class="keywordtype">unsigned</span> NumByteStores = Bytes - NumPointerStores * MaxIntSize;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  <span class="comment">// If we will reduce the # stores (according to this heuristic), do the</span></div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  <span class="comment">// transformation.  This encourages merging 4 x i8 -&gt; i32 and 2 x i16 -&gt; i32</span></div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  <span class="comment">// etc.</span></div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  <span class="keywordflow">return</span> TheStores.size() &gt; NumPointerStores+NumByteStores;</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;}</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="keyword">namespace </span>{</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="keyword">class </span>MemsetRanges {<span class="comment"></span></div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment">  /// Ranges - A sorted list of the memset ranges.  We use std::list here</span></div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="comment">  /// because each element is relatively large and expensive to copy.</span></div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment"></span>  std::list&lt;MemsetRange&gt; Ranges;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  <span class="keyword">typedef</span> std::list&lt;MemsetRange&gt;::iterator range_iterator;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> &amp;TD;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;  MemsetRanges(<span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> &amp;<a class="code" href="Target_2X86_2README_8txt.html#a1b0f9b510ec52cc3cbaa14e6e6211168">td</a>) : TD(td) {}</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  <span class="keyword">typedef</span> std::list&lt;MemsetRange&gt;::const_iterator const_iterator;</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  const_iterator <a class="code" href="namespacellvm_1_1sys_1_1path.html#a33706aab89e700b8f79e1fa6f4f0e3ee">begin</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> Ranges.<a class="code" href="classllvm_1_1sys_1_1path_1_1const__iterator.html#a79fe46db1f88832bc90447c6ec541cf2">begin</a>(); }</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  const_iterator <a class="code" href="namespacellvm_1_1sys_1_1path.html#a214ec2f04ffd92636ed4bd2717607a1d">end</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> Ranges.<a class="code" href="classllvm_1_1sys_1_1path_1_1const__iterator.html#a8a503d1cbee10d1b8c8f5ac2a03b90df">end</a>(); }</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  <span class="keywordtype">bool</span> empty()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> Ranges.empty(); }</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  <span class="keywordtype">void</span> addInst(int64_t OffsetFromFirst, <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *Inst) {</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1StoreInst.html">StoreInst</a> *SI = dyn_cast&lt;StoreInst&gt;(Inst))</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;      addStore(OffsetFromFirst, SI);</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;      addMemSet(OffsetFromFirst, cast&lt;MemSetInst&gt;(Inst));</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  }</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  <span class="keywordtype">void</span> addStore(int64_t OffsetFromFirst, <a class="code" href="classllvm_1_1StoreInst.html">StoreInst</a> *SI) {</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    int64_t StoreSize = TD.<a class="code" href="classllvm_1_1DataLayout.html#a4b979cd93852fd44c48851c94ee00758">getTypeStoreSize</a>(SI-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0)-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>());</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <a class="code" href="Metadata_8cpp.html#a08f662c95a7832a8687ba787e0fdf672">addRange</a>(OffsetFromFirst, StoreSize,</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;             SI-&gt;<a class="code" href="classllvm_1_1StoreInst.html#ac03c1c093059ea000216af8dd6f2dbf4">getPointerOperand</a>(), SI-&gt;<a class="code" href="classllvm_1_1StoreInst.html#a3084f1dd69d67e1965fd1fe721a69f2e">getAlignment</a>(), SI);</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  }</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  <span class="keywordtype">void</span> addMemSet(int64_t OffsetFromFirst, <a class="code" href="classllvm_1_1MemSetInst.html">MemSetInst</a> *MSI) {</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    int64_t Size = cast&lt;ConstantInt&gt;(MSI-&gt;<a class="code" href="classllvm_1_1MemIntrinsic.html#abad10f74789466601c7a025540c1c072">getLength</a>())-&gt;getZExtValue();</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <a class="code" href="Metadata_8cpp.html#a08f662c95a7832a8687ba787e0fdf672">addRange</a>(OffsetFromFirst, Size, MSI-&gt;<a class="code" href="classllvm_1_1MemIntrinsic.html#ad8bf46d46e8f14bc23bd30df57cc9a77">getDest</a>(), MSI-&gt;<a class="code" href="classllvm_1_1MemIntrinsic.html#a42dd65db3521498f10afb8c6f66e1bb5">getAlignment</a>(), MSI);</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  }</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="Metadata_8cpp.html#a08f662c95a7832a8687ba787e0fdf672">addRange</a>(int64_t Start, int64_t Size, <a class="code" href="classllvm_1_1Value.html">Value</a> *Ptr,</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;                <span class="keywordtype">unsigned</span> Alignment, <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *Inst);</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;};</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;} <span class="comment">// end anon namespace</span></div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment">/// addRange - Add a new store to the MemsetRanges data structure.  This adds a</span></div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="comment">/// new range for the specified store at the specified offset, merging into</span></div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="comment">/// existing ranges as appropriate.</span></div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="comment">/// Do a linear search of the ranges to see if this can be joined and/or to</span></div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="comment">/// find the insertion point in the list.  We keep the ranges sorted for</span></div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="comment">/// simplicity here.  This is a linear search of a linked list, which is ugly,</span></div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="comment">/// however the number of ranges is limited, so this won&#39;t get crazy slow.</span></div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="Metadata_8cpp.html#a08f662c95a7832a8687ba787e0fdf672">MemsetRanges::addRange</a>(int64_t Start, int64_t Size, <a class="code" href="classllvm_1_1Value.html">Value</a> *Ptr,</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;                            <span class="keywordtype">unsigned</span> Alignment, <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *Inst) {</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;  int64_t End = Start+Size;</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;  range_iterator <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = Ranges.begin(), E = Ranges.end();</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  <span class="keywordflow">while</span> (I != E &amp;&amp; Start &gt; I-&gt;End)</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    ++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>;</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;  <span class="comment">// We now know that I == E, in which case we didn&#39;t find anything to merge</span></div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  <span class="comment">// with, or that Start &lt;= I-&gt;End.  If End &lt; I-&gt;Start or I == E, then we need</span></div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  <span class="comment">// to insert a new range.  Handle this now.</span></div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;  <span class="keywordflow">if</span> (I == E || End &lt; I-&gt;Start) {</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    MemsetRange &amp;R = *Ranges.insert(I, MemsetRange());</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    R.Start        = Start;</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    R.End          = End;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    R.StartPtr     = Ptr;</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    R.Alignment    = Alignment;</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    R.TheStores.push_back(Inst);</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;  }</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;  <span class="comment">// This store overlaps with I, add it.</span></div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;  I-&gt;TheStores.push_back(Inst);</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;  <span class="comment">// At this point, we may have an interval that completely contains our store.</span></div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;  <span class="comment">// If so, just add it to the interval and return.</span></div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;  <span class="keywordflow">if</span> (I-&gt;Start &lt;= Start &amp;&amp; I-&gt;End &gt;= End)</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  <span class="comment">// Now we know that Start &lt;= I-&gt;End and End &gt;= I-&gt;Start so the range overlaps</span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  <span class="comment">// but is not entirely contained within the range.</span></div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;  <span class="comment">// See if the range extends the start of the range.  In this case, it couldn&#39;t</span></div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  <span class="comment">// possibly cause it to join the prior range, because otherwise we would have</span></div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  <span class="comment">// stopped on *it*.</span></div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;  <span class="keywordflow">if</span> (Start &lt; I-&gt;Start) {</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    I-&gt;Start = Start;</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    I-&gt;StartPtr = Ptr;</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    I-&gt;Alignment = Alignment;</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  }</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;  <span class="comment">// Now we know that Start &lt;= I-&gt;End and Start &gt;= I-&gt;Start (so the startpoint</span></div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;  <span class="comment">// is in or right at the end of I), and that End &gt;= I-&gt;Start.  Extend I out to</span></div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;  <span class="comment">// End.</span></div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  <span class="keywordflow">if</span> (End &gt; I-&gt;End) {</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    I-&gt;End = End;</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    range_iterator NextI = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>;</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <span class="keywordflow">while</span> (++NextI != E &amp;&amp; End &gt;= NextI-&gt;Start) {</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;      <span class="comment">// Merge the range in.</span></div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;      I-&gt;TheStores.append(NextI-&gt;TheStores.begin(), NextI-&gt;TheStores.end());</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;      <span class="keywordflow">if</span> (NextI-&gt;End &gt; I-&gt;End)</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        I-&gt;End = NextI-&gt;End;</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;      Ranges.erase(NextI);</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;      NextI = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>;</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    }</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  }</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;}</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="comment">//                         MemCpyOpt Pass</span></div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="keyword">namespace </span>{</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;  <span class="keyword">class </span>MemCpyOpt : <span class="keyword">public</span> <a class="code" href="classllvm_1_1FunctionPass.html">FunctionPass</a> {</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    <a class="code" href="classllvm_1_1MemoryDependenceAnalysis.html">MemoryDependenceAnalysis</a> *MD;</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <a class="code" href="classllvm_1_1TargetLibraryInfo.html">TargetLibraryInfo</a> *TLI;</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> *TD;</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;  <span class="keyword">public</span>:</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <span class="keyword">static</span> <span class="keywordtype">char</span> <a class="code" href="namespacellvm_1_1CallingConv.html#a4f861731fc6dbfdccc05af5968d98974">ID</a>; <span class="comment">// Pass identification, replacement for typeid</span></div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    MemCpyOpt() : <a class="code" href="classllvm_1_1FunctionPass.html">FunctionPass</a>(ID) {</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;      <a class="code" href="namespacellvm.html#ad2abfd9d12d19ae450d3db0b6ecadc08">initializeMemCpyOptPass</a>(*<a class="code" href="classllvm_1_1PassRegistry.html#a05a729900b76c89e808c6c3094921b2f">PassRegistry::getPassRegistry</a>());</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;      MD = 0;</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;      TLI = 0;</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;      TD = 0;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    }</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    <span class="keywordtype">bool</span> runOnFunction(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="LLParser_8cpp.html#a33ece1ef8074506a15d7f86eb76dbae6">F</a>);</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;  <span class="keyword">private</span>:</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <span class="comment">// This transformation requires dominator postdominator info</span></div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">void</span> getAnalysisUsage(<a class="code" href="classllvm_1_1AnalysisUsage.html">AnalysisUsage</a> &amp;AU)<span class="keyword"> const </span>{</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;      AU.<a class="code" href="classllvm_1_1AnalysisUsage.html#af11a6ebf7ab3c388234cb6d5378439a3">setPreservesCFG</a>();</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;      AU.<a class="code" href="classllvm_1_1AnalysisUsage.html#ae5c60fd282ee894c87ea02c3f0fcb6d0">addRequired</a>&lt;<a class="code" href="classllvm_1_1DominatorTree.html">DominatorTree</a>&gt;();</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;      AU.<a class="code" href="classllvm_1_1AnalysisUsage.html#ae5c60fd282ee894c87ea02c3f0fcb6d0">addRequired</a>&lt;<a class="code" href="classllvm_1_1MemoryDependenceAnalysis.html">MemoryDependenceAnalysis</a>&gt;();</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;      AU.<a class="code" href="classllvm_1_1AnalysisUsage.html#ae5c60fd282ee894c87ea02c3f0fcb6d0">addRequired</a>&lt;<a class="code" href="classllvm_1_1AliasAnalysis.html">AliasAnalysis</a>&gt;();</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;      AU.<a class="code" href="classllvm_1_1AnalysisUsage.html#ae5c60fd282ee894c87ea02c3f0fcb6d0">addRequired</a>&lt;<a class="code" href="classllvm_1_1TargetLibraryInfo.html">TargetLibraryInfo</a>&gt;();</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;      AU.<a class="code" href="classllvm_1_1AnalysisUsage.html#a884f90190bca4bd354f2d5c91c264028">addPreserved</a>&lt;<a class="code" href="classllvm_1_1AliasAnalysis.html">AliasAnalysis</a>&gt;();</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;      AU.<a class="code" href="classllvm_1_1AnalysisUsage.html#a884f90190bca4bd354f2d5c91c264028">addPreserved</a>&lt;<a class="code" href="classllvm_1_1MemoryDependenceAnalysis.html">MemoryDependenceAnalysis</a>&gt;();</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    }</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <span class="comment">// Helper fuctions</span></div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    <span class="keywordtype">bool</span> processStore(<a class="code" href="classllvm_1_1StoreInst.html">StoreInst</a> *SI, <a class="code" href="classllvm_1_1ilist__iterator.html">BasicBlock::iterator</a> &amp;BBI);</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    <span class="keywordtype">bool</span> processMemSet(<a class="code" href="classllvm_1_1MemSetInst.html">MemSetInst</a> *SI, <a class="code" href="classllvm_1_1ilist__iterator.html">BasicBlock::iterator</a> &amp;BBI);</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    <span class="keywordtype">bool</span> processMemCpy(<a class="code" href="classllvm_1_1MemCpyInst.html">MemCpyInst</a> *<a class="code" href="Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>);</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <span class="keywordtype">bool</span> processMemMove(<a class="code" href="classllvm_1_1MemMoveInst.html">MemMoveInst</a> *M);</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <span class="keywordtype">bool</span> performCallSlotOptzn(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="Target_2ARM_2README_8txt.html#a86bd01c89bf19da5edcd8fd83325d6f6">cpy</a>, <a class="code" href="classllvm_1_1Value.html">Value</a> *cpyDst, <a class="code" href="classllvm_1_1Value.html">Value</a> *cpySrc,</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;                              uint64_t cpyLen, <span class="keywordtype">unsigned</span> cpyAlign, <a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>);</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <span class="keywordtype">bool</span> processMemCpyMemCpyDependence(<a class="code" href="classllvm_1_1MemCpyInst.html">MemCpyInst</a> *M, <a class="code" href="classllvm_1_1MemCpyInst.html">MemCpyInst</a> *MDep,</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;                                       uint64_t MSize);</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <span class="keywordtype">bool</span> processByValArgument(<a class="code" href="classllvm_1_1CallSite.html">CallSite</a> CS, <span class="keywordtype">unsigned</span> ArgNo);</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *tryMergingIntoMemset(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="classllvm_1_1Value.html">Value</a> *StartPtr,</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;                                      <a class="code" href="classllvm_1_1Value.html">Value</a> *ByteVal);</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    <span class="keywordtype">bool</span> iterateOnFunction(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;F);</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;  };</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;  <span class="keywordtype">char</span> <a class="code" href="namespacellvm_1_1CallingConv.html#a4f861731fc6dbfdccc05af5968d98974">MemCpyOpt::ID</a> = 0;</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;}</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="comment">// createMemCpyOptPass - The public interface to this file...</span></div><div class="line"><a name="l00352"></a><span class="lineno"><a class="line" href="namespacellvm.html#a493e8685b388eb24064e2eb6c90e88d6">  352</a></span>&#160;<a class="code" href="classllvm_1_1FunctionPass.html">FunctionPass</a> *<a class="code" href="namespacellvm.html#a493e8685b388eb24064e2eb6c90e88d6">llvm::createMemCpyOptPass</a>() { <span class="keywordflow">return</span> <span class="keyword">new</span> MemCpyOpt(); }</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<a class="code" href="MemCpyOptimizer_8cpp.html#a66eab13a579e3333b0ab115781f01a0d">INITIALIZE_PASS_BEGIN</a>(MemCpyOpt, <span class="stringliteral">&quot;memcpyopt&quot;</span>, <span class="stringliteral">&quot;MemCpy Optimization&quot;</span>,</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;                      <span class="keyword">false</span>, <span class="keyword">false</span>)</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<a class="code" href="PassSupport_8h.html#a14724f1ccf528e73bb29bc9230737967">INITIALIZE_PASS_DEPENDENCY</a>(<a class="code" href="classllvm_1_1DominatorTree.html">DominatorTree</a>)</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<a class="code" href="PassSupport_8h.html#a14724f1ccf528e73bb29bc9230737967">INITIALIZE_PASS_DEPENDENCY</a>(<a class="code" href="classllvm_1_1MemoryDependenceAnalysis.html">MemoryDependenceAnalysis</a>)</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<a class="code" href="PassSupport_8h.html#a14724f1ccf528e73bb29bc9230737967">INITIALIZE_PASS_DEPENDENCY</a>(<a class="code" href="classllvm_1_1TargetLibraryInfo.html">TargetLibraryInfo</a>)</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<a class="code" href="PassSupport_8h.html#af0564bcdde2dd4400c670ca278c6035f">INITIALIZE_AG_DEPENDENCY</a>(<a class="code" href="classllvm_1_1AliasAnalysis.html">AliasAnalysis</a>)</div><div class="line"><a name="l00360"></a><span class="lineno"><a class="line" href="MemCpyOptimizer_8cpp.html#a4c36a0753cd006d97b1aee018fe423bc">  360</a></span>&#160;<a class="code" href="PassSupport_8h.html#a74ce8276b89067e806f67c45a6d92575">INITIALIZE_PASS_END</a>(MemCpyOpt, &quot;<a class="code" href="MemCpyOptimizer_8cpp.html#a7530261f1f6c8e08347b485f8ffe90b4">memcpyopt</a>&quot;, &quot;<a class="code" href="namespacellvm.html#aa5df040b72433a3c103527073f092624">MemCpy</a> <a class="code" href="MemCpyOptimizer_8cpp.html#a4c36a0753cd006d97b1aee018fe423bc">Optimization</a>&quot;,</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;                    <a class="code" href="namespacefalse.html">false</a>, <a class="code" href="namespacefalse.html">false</a>)</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="comment">/// tryMergingIntoMemset - When scanning forward over instructions, we look for</span></div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="comment">/// some other patterns to fold away.  In particular, this looks for stores to</span></div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="comment">/// neighboring locations of memory.  If it sees enough consecutive ones, it</span></div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="comment">/// attempts to merge them together into a memcpy/memset.</span></div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="comment"></span><a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *MemCpyOpt::tryMergingIntoMemset(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *StartInst,</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;                                             <a class="code" href="classllvm_1_1Value.html">Value</a> *StartPtr, <a class="code" href="classllvm_1_1Value.html">Value</a> *ByteVal) {</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;  <span class="keywordflow">if</span> (TD == 0) <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;  <span class="comment">// Okay, so we now have a single store that can be splatable.  Scan to find</span></div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;  <span class="comment">// all subsequent stores of the same value to offset from the same pointer.</span></div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;  <span class="comment">// Join these together into ranges, so we can decide whether contiguous blocks</span></div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;  <span class="comment">// are stored.</span></div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;  MemsetRanges Ranges(*TD);</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;  <a class="code" href="classllvm_1_1ilist__iterator.html">BasicBlock::iterator</a> BI = StartInst;</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;  <span class="keywordflow">for</span> (++BI; !isa&lt;TerminatorInst&gt;(BI); ++BI) {</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    <span class="keywordflow">if</span> (!isa&lt;StoreInst&gt;(BI) &amp;&amp; !isa&lt;MemSetInst&gt;(BI)) {</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;      <span class="comment">// If the instruction is readnone, ignore it, otherwise bail out.  We</span></div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;      <span class="comment">// don&#39;t even allow readonly here because we don&#39;t want something like:</span></div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;      <span class="comment">// A[1] = 2; strlen(A); A[2] = 2; -&gt; memcpy(A, ...); strlen(A).</span></div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;      <span class="keywordflow">if</span> (BI-&gt;mayWriteToMemory() || BI-&gt;mayReadFromMemory())</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    }</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1StoreInst.html">StoreInst</a> *NextStore = dyn_cast&lt;StoreInst&gt;(BI)) {</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;      <span class="comment">// If this is a store, see if we can merge it in.</span></div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;      <span class="keywordflow">if</span> (!NextStore-&gt;isSimple()) <span class="keywordflow">break</span>;</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;      <span class="comment">// Check to see if this stored value is of the same byte-splattable value.</span></div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;      <span class="keywordflow">if</span> (ByteVal != <a class="code" href="namespacellvm.html#a9945de214e3ba2b16f664bcdc953f0e0">isBytewiseValue</a>(NextStore-&gt;getOperand(0)))</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;      <span class="comment">// Check to see if this store is to a constant offset from the start ptr.</span></div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;      int64_t Offset;</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="MemCpyOptimizer_8cpp.html#a6ee1a66b9681fb20cdc5f8ec6b59bef5">IsPointerOffset</a>(StartPtr, NextStore-&gt;getPointerOperand(),</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;                           Offset, *TD))</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;      Ranges.addStore(Offset, NextStore);</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;      <a class="code" href="classllvm_1_1MemSetInst.html">MemSetInst</a> *MSI = cast&lt;MemSetInst&gt;(BI);</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;      <span class="keywordflow">if</span> (MSI-&gt;<a class="code" href="classllvm_1_1MemIntrinsic.html#a9558faebdbb62c072aed98e33604889d">isVolatile</a>() || ByteVal != MSI-&gt;<a class="code" href="classllvm_1_1MemSetInst.html#a357f35c4ac1c01e84d73a4a9e26f6aac">getValue</a>() ||</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;          !isa&lt;ConstantInt&gt;(MSI-&gt;<a class="code" href="classllvm_1_1MemIntrinsic.html#abad10f74789466601c7a025540c1c072">getLength</a>()))</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;      <span class="comment">// Check to see if this store is to a constant offset from the start ptr.</span></div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;      int64_t Offset;</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="MemCpyOptimizer_8cpp.html#a6ee1a66b9681fb20cdc5f8ec6b59bef5">IsPointerOffset</a>(StartPtr, MSI-&gt;<a class="code" href="classllvm_1_1MemIntrinsic.html#ad8bf46d46e8f14bc23bd30df57cc9a77">getDest</a>(), Offset, *TD))</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;      Ranges.addMemSet(Offset, MSI);</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    }</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;  }</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;  <span class="comment">// If we have no ranges, then we just had a single store with nothing that</span></div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;  <span class="comment">// could be merged in.  This is a very common case of course.</span></div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;  <span class="keywordflow">if</span> (Ranges.empty())</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;  <span class="comment">// If we had at least one store that could be merged in, add the starting</span></div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;  <span class="comment">// store as well.  We try to avoid this unless there is at least something</span></div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;  <span class="comment">// interesting as a small compile-time optimization.</span></div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;  Ranges.addInst(0, StartInst);</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;  <span class="comment">// If we create any memsets, we put it right before the first instruction that</span></div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;  <span class="comment">// isn&#39;t part of the memset block.  This ensure that the memset is dominated</span></div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;  <span class="comment">// by any addressing instruction needed by the start of the block.</span></div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;  <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> Builder(BI);</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;  <span class="comment">// Now that we have full information about ranges, loop over the ranges and</span></div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;  <span class="comment">// emit memset&#39;s for anything big enough to be worthwhile.</span></div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *AMemSet = 0;</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;  <span class="keywordflow">for</span> (MemsetRanges::const_iterator <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = Ranges.begin(), E = Ranges.end();</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;       <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> != E; ++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    <span class="keyword">const</span> MemsetRange &amp;Range = *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>;</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    <span class="keywordflow">if</span> (Range.TheStores.size() == 1) <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    <span class="comment">// If it is profitable to lower this range to memset, do so now.</span></div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    <span class="keywordflow">if</span> (!Range.isProfitableToUseMemset(*TD))</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    <span class="comment">// Otherwise, we do want to transform this!  Create a new memset.</span></div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    <span class="comment">// Get the starting pointer of the block.</span></div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    StartPtr = Range.StartPtr;</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    <span class="comment">// Determine alignment</span></div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    <span class="keywordtype">unsigned</span> Alignment = Range.Alignment;</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    <span class="keywordflow">if</span> (Alignment == 0) {</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;      <a class="code" href="classllvm_1_1Type.html">Type</a> *EltType =</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;        cast&lt;PointerType&gt;(StartPtr-&gt;getType())-&gt;getElementType();</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;      Alignment = TD-&gt;<a class="code" href="classllvm_1_1DataLayout.html#abb381519d34dcb9ccf673bf7689d0721">getABITypeAlignment</a>(EltType);</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    }</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    AMemSet =</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;      Builder.<a class="code" href="classllvm_1_1IRBuilderBase.html#a58f62481bd3a4bfc5d07102fe857741a">CreateMemSet</a>(StartPtr, ByteVal, Range.End-Range.Start, Alignment);</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Replace stores:\n&quot;</span>;</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0, e = Range.TheStores.size(); <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != e; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;            <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; *Range.TheStores[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>] &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;          <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;With: &quot;</span> &lt;&lt; *AMemSet &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>);</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    <span class="keywordflow">if</span> (!Range.TheStores.empty())</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;      AMemSet-&gt;<a class="code" href="classllvm_1_1Instruction.html#a7bd545769621a0a9d2cfb074f86f4295">setDebugLoc</a>(Range.TheStores[0]-&gt;getDebugLoc());</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    <span class="comment">// Zap all the stores.</span></div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1SmallVectorImpl.html">SmallVectorImpl&lt;Instruction *&gt;::const_iterator</a></div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;         SI = Range.TheStores.begin(),</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;         SE = Range.TheStores.end(); SI != SE; ++SI) {</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;      MD-&gt;removeInstruction(*SI);</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;      (*SI)-&gt;eraseFromParent();</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    }</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    ++NumMemSetInfer;</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;  }</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;  <span class="keywordflow">return</span> AMemSet;</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;}</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;<span class="keywordtype">bool</span> MemCpyOpt::processStore(<a class="code" href="classllvm_1_1StoreInst.html">StoreInst</a> *SI, <a class="code" href="classllvm_1_1ilist__iterator.html">BasicBlock::iterator</a> &amp;BBI) {</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;  <span class="keywordflow">if</span> (!SI-&gt;<a class="code" href="classllvm_1_1StoreInst.html#a1149c7eeefca671ac2685bca13843568">isSimple</a>()) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;  <span class="keywordflow">if</span> (TD == 0) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;  <span class="comment">// Detect cases where we&#39;re performing call slot forwarding, but</span></div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;  <span class="comment">// happen to be using a load-store pair to implement it, rather than</span></div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;  <span class="comment">// a memcpy.</span></div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1LoadInst.html">LoadInst</a> *LI = dyn_cast&lt;LoadInst&gt;(SI-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0))) {</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    <span class="keywordflow">if</span> (LI-&gt;isSimple() &amp;&amp; LI-&gt;hasOneUse() &amp;&amp;</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;        LI-&gt;getParent() == SI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a9cd49851904f15060edb782ef4dd1b2d">getParent</a>()) {</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;      <a class="code" href="classllvm_1_1MemDepResult.html">MemDepResult</a> ldep = MD-&gt;getDependency(LI);</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;      <a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = 0;</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;      <span class="keywordflow">if</span> (ldep.<a class="code" href="classllvm_1_1MemDepResult.html#ae409b288c7f70a6c57586535abed3808">isClobber</a>() &amp;&amp; !isa&lt;MemCpyInst&gt;(ldep.<a class="code" href="classllvm_1_1MemDepResult.html#a8452eb6508c00e2b6d56926bebc79f57">getInst</a>()))</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;        C = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1CallInst.html">CallInst</a>&gt;(ldep.<a class="code" href="classllvm_1_1MemDepResult.html#a8452eb6508c00e2b6d56926bebc79f57">getInst</a>());</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;      <span class="keywordflow">if</span> (C) {</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;        <span class="comment">// Check that nothing touches the dest of the &quot;copy&quot; between</span></div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;        <span class="comment">// the call and the store.</span></div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;        <a class="code" href="classllvm_1_1AliasAnalysis.html">AliasAnalysis</a> &amp;AA = getAnalysis&lt;AliasAnalysis&gt;();</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;        <a class="code" href="structllvm_1_1AliasAnalysis_1_1Location.html">AliasAnalysis::Location</a> StoreLoc = AA.<a class="code" href="classllvm_1_1AliasAnalysis.html#aec9dbab832cd8052f85cd2a9dbb3816e">getLocation</a>(SI);</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1ilist__iterator.html">BasicBlock::iterator</a> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = --<a class="code" href="classllvm_1_1ilist__iterator.html">BasicBlock::iterator</a>(SI),</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;                                  E = C; <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> != E; --<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;          <span class="keywordflow">if</span> (AA.<a class="code" href="classllvm_1_1AliasAnalysis.html#a3f09a65a9c9d7bfff6c6271976d1baba">getModRefInfo</a>(&amp;*<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, StoreLoc) != <a class="code" href="classllvm_1_1AliasAnalysis.html#a83d29c51155787c607268c2659559460a52fc7f344e74f168cb4b4c808dcfde1c">AliasAnalysis::NoModRef</a>) {</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;            C = 0;</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;          }</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;        }</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;      }</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;      <span class="keywordflow">if</span> (C) {</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;        <span class="keywordtype">unsigned</span> storeAlign = SI-&gt;<a class="code" href="classllvm_1_1StoreInst.html#a3084f1dd69d67e1965fd1fe721a69f2e">getAlignment</a>();</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;        <span class="keywordflow">if</span> (!storeAlign)</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;          storeAlign = TD-&gt;<a class="code" href="classllvm_1_1DataLayout.html#abb381519d34dcb9ccf673bf7689d0721">getABITypeAlignment</a>(SI-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0)-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>());</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;        <span class="keywordtype">unsigned</span> loadAlign = LI-&gt;getAlignment();</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;        <span class="keywordflow">if</span> (!loadAlign)</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;          loadAlign = TD-&gt;<a class="code" href="classllvm_1_1DataLayout.html#abb381519d34dcb9ccf673bf7689d0721">getABITypeAlignment</a>(LI-&gt;getType());</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;        <span class="keywordtype">bool</span> changed = performCallSlotOptzn(LI,</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;                        SI-&gt;<a class="code" href="classllvm_1_1StoreInst.html#ac03c1c093059ea000216af8dd6f2dbf4">getPointerOperand</a>()-&gt;<a class="code" href="classllvm_1_1Value.html#a38ea12c04523d63adda732b9c5d6da0a">stripPointerCasts</a>(),</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;                        LI-&gt;getPointerOperand()-&gt;stripPointerCasts(),</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;                        TD-&gt;<a class="code" href="classllvm_1_1DataLayout.html#a4b979cd93852fd44c48851c94ee00758">getTypeStoreSize</a>(SI-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0)-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>()),</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;                        std::min(storeAlign, loadAlign), <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>);</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;        <span class="keywordflow">if</span> (changed) {</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;          MD-&gt;removeInstruction(SI);</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;          SI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a6fe2f06b8a4b2c3d6308afb223a0238a">eraseFromParent</a>();</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;          MD-&gt;removeInstruction(LI);</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;          LI-&gt;eraseFromParent();</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;          ++NumMemCpyInstr;</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;        }</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;      }</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    }</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;  }</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;  <span class="comment">// There are two cases that are interesting for this code to handle: memcpy</span></div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;  <span class="comment">// and memset.  Right now we only handle memset.</span></div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;  <span class="comment">// Ensure that the value being stored is something that can be memset&#39;able a</span></div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;  <span class="comment">// byte at a time like &quot;0&quot; or &quot;-1&quot; or any width, as well as things like</span></div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;  <span class="comment">// 0xA0A0A0A0 and 0.0.</span></div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *ByteVal = <a class="code" href="namespacellvm.html#a9945de214e3ba2b16f664bcdc953f0e0">isBytewiseValue</a>(SI-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0)))</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = tryMergingIntoMemset(SI, SI-&gt;<a class="code" href="classllvm_1_1StoreInst.html#ac03c1c093059ea000216af8dd6f2dbf4">getPointerOperand</a>(),</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;                                              ByteVal)) {</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;      BBI = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>;  <span class="comment">// Don&#39;t invalidate iterator.</span></div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    }</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;}</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;<span class="keywordtype">bool</span> MemCpyOpt::processMemSet(<a class="code" href="classllvm_1_1MemSetInst.html">MemSetInst</a> *MSI, <a class="code" href="classllvm_1_1ilist__iterator.html">BasicBlock::iterator</a> &amp;BBI) {</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;  <span class="comment">// See if there is another memset or store neighboring this memset which</span></div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;  <span class="comment">// allows us to widen out the memset to do a single larger store.</span></div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;  <span class="keywordflow">if</span> (isa&lt;ConstantInt&gt;(MSI-&gt;<a class="code" href="classllvm_1_1MemIntrinsic.html#abad10f74789466601c7a025540c1c072">getLength</a>()) &amp;&amp; !MSI-&gt;<a class="code" href="classllvm_1_1MemIntrinsic.html#a9558faebdbb62c072aed98e33604889d">isVolatile</a>())</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = tryMergingIntoMemset(MSI, MSI-&gt;<a class="code" href="classllvm_1_1MemIntrinsic.html#ad8bf46d46e8f14bc23bd30df57cc9a77">getDest</a>(),</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;                                              MSI-&gt;<a class="code" href="classllvm_1_1MemSetInst.html#a357f35c4ac1c01e84d73a4a9e26f6aac">getValue</a>())) {</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;      BBI = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>;  <span class="comment">// Don&#39;t invalidate iterator.</span></div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    }</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;}</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;<span class="comment">/// performCallSlotOptzn - takes a memcpy and a call that it depends on,</span></div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;<span class="comment">/// and checks for the possibility of a call slot optimization by having</span></div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;<span class="comment">/// the call write its result directly into the destination of the memcpy.</span></div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<span class="comment"></span><span class="keywordtype">bool</span> MemCpyOpt::performCallSlotOptzn(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="Target_2ARM_2README_8txt.html#a86bd01c89bf19da5edcd8fd83325d6f6">cpy</a>,</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;                                     <a class="code" href="classllvm_1_1Value.html">Value</a> *cpyDest, <a class="code" href="classllvm_1_1Value.html">Value</a> *cpySrc,</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;                                     uint64_t cpyLen, <span class="keywordtype">unsigned</span> cpyAlign,</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;                                     <a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>) {</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;  <span class="comment">// The general transformation to keep in mind is</span></div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;  <span class="comment">//</span></div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;  <span class="comment">//   call @func(..., src, ...)</span></div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;  <span class="comment">//   memcpy(dest, src, ...)</span></div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;  <span class="comment">//</span></div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;  <span class="comment">// -&gt;</span></div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;  <span class="comment">//</span></div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;  <span class="comment">//   memcpy(dest, src, ...)</span></div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;  <span class="comment">//   call @func(..., dest, ...)</span></div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;  <span class="comment">//</span></div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;  <span class="comment">// Since moving the memcpy is technically awkward, we additionally check that</span></div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;  <span class="comment">// src only holds uninitialized values at the moment of the call, meaning that</span></div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;  <span class="comment">// the memcpy can be discarded rather than moved.</span></div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;  <span class="comment">// Deliberately get the source and destination with bitcasts stripped away,</span></div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;  <span class="comment">// because we&#39;ll need to do type comparisons based on the underlying type.</span></div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;  <a class="code" href="classllvm_1_1CallSite.html">CallSite</a> CS(C);</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;  <span class="comment">// Require that src be an alloca.  This simplifies the reasoning considerably.</span></div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;  <a class="code" href="classllvm_1_1AllocaInst.html">AllocaInst</a> *srcAlloca = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1AllocaInst.html">AllocaInst</a>&gt;(cpySrc);</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;  <span class="keywordflow">if</span> (!srcAlloca)</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;  <span class="comment">// Check that all of src is copied to dest.</span></div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;  <span class="keywordflow">if</span> (TD == 0) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;  <a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *srcArraySize = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a>&gt;(srcAlloca-&gt;<a class="code" href="classllvm_1_1AllocaInst.html#a642f52c0f081ad0de10258c1d8d67b23">getArraySize</a>());</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;  <span class="keywordflow">if</span> (!srcArraySize)</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;  uint64_t srcSize = TD-&gt;<a class="code" href="classllvm_1_1DataLayout.html#a1d6fcc02e91ba24510aba42660c90e29">getTypeAllocSize</a>(srcAlloca-&gt;<a class="code" href="classllvm_1_1AllocaInst.html#a214c60dbb4f1ed467e5a3420db6eefd6">getAllocatedType</a>()) *</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    srcArraySize-&gt;<a class="code" href="classllvm_1_1ConstantInt.html#a6edd823ba5e4e1effc8280ca8a1194ef">getZExtValue</a>();</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;  <span class="keywordflow">if</span> (cpyLen &lt; srcSize)</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;  <span class="comment">// Check that accessing the first srcSize bytes of dest will not cause a</span></div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;  <span class="comment">// trap.  Otherwise the transform is invalid since it might cause a trap</span></div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;  <span class="comment">// to occur earlier than it otherwise would.</span></div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1AllocaInst.html">AllocaInst</a> *<a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a> = dyn_cast&lt;AllocaInst&gt;(cpyDest)) {</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;    <span class="comment">// The destination is an alloca.  Check it is larger than srcSize.</span></div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;    <a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *destArraySize = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a>&gt;(<a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>-&gt;getArraySize());</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    <span class="keywordflow">if</span> (!destArraySize)</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;    uint64_t destSize = TD-&gt;<a class="code" href="classllvm_1_1DataLayout.html#a1d6fcc02e91ba24510aba42660c90e29">getTypeAllocSize</a>(<a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>-&gt;getAllocatedType()) *</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;      destArraySize-&gt;<a class="code" href="classllvm_1_1ConstantInt.html#a6edd823ba5e4e1effc8280ca8a1194ef">getZExtValue</a>();</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    <span class="keywordflow">if</span> (destSize &lt; srcSize)</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Argument.html">Argument</a> *<a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a> = dyn_cast&lt;Argument&gt;(cpyDest)) {</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    <span class="comment">// If the destination is an sret parameter then only accesses that are</span></div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    <span class="comment">// outside of the returned struct type can trap.</span></div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>-&gt;hasStructRetAttr())</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;    <a class="code" href="classllvm_1_1Type.html">Type</a> *StructTy = cast&lt;PointerType&gt;(<a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>-&gt;getType())-&gt;getElementType();</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;    <span class="keywordflow">if</span> (!StructTy-&gt;<a class="code" href="classllvm_1_1Type.html#a9dc5111b1a9b1d5c4652d50f74fe850b">isSized</a>()) {</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;      <span class="comment">// The call may never return and hence the copy-instruction may never</span></div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;      <span class="comment">// be executed, and therefore it&#39;s not safe to say &quot;the destination</span></div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;      <span class="comment">// has at least &lt;cpyLen&gt; bytes, as implied by the copy-instruction&quot;,</span></div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    }</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;    uint64_t destSize = TD-&gt;<a class="code" href="classllvm_1_1DataLayout.html#a1d6fcc02e91ba24510aba42660c90e29">getTypeAllocSize</a>(StructTy);</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;    <span class="keywordflow">if</span> (destSize &lt; srcSize)</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;  }</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;  <span class="comment">// Check that dest points to memory that is at least as aligned as src.</span></div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;  <span class="keywordtype">unsigned</span> srcAlign = srcAlloca-&gt;<a class="code" href="classllvm_1_1AllocaInst.html#ad441932c20e5b9ba36c8c72a6c7f5ec3">getAlignment</a>();</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;  <span class="keywordflow">if</span> (!srcAlign)</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    srcAlign = TD-&gt;<a class="code" href="classllvm_1_1DataLayout.html#abb381519d34dcb9ccf673bf7689d0721">getABITypeAlignment</a>(srcAlloca-&gt;<a class="code" href="classllvm_1_1AllocaInst.html#a214c60dbb4f1ed467e5a3420db6eefd6">getAllocatedType</a>());</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;  <span class="keywordtype">bool</span> isDestSufficientlyAligned = srcAlign &lt;= cpyAlign;</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;  <span class="comment">// If dest is not aligned enough and we can&#39;t increase its alignment then</span></div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;  <span class="comment">// bail out.</span></div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;  <span class="keywordflow">if</span> (!isDestSufficientlyAligned &amp;&amp; !isa&lt;AllocaInst&gt;(cpyDest))</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;  <span class="comment">// Check that src is not accessed except via the call and the memcpy.  This</span></div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;  <span class="comment">// guarantees that it holds only undefined values when passed in (so the final</span></div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;  <span class="comment">// memcpy can be dropped), that it is not read or written between the call and</span></div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;  <span class="comment">// the memcpy, and that writing beyond the end of it is undefined.</span></div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;User*, 8&gt;</a> srcUseList(srcAlloca-&gt;<a class="code" href="classllvm_1_1Value.html#a413abcab8dbc3900fc2fde96a5d8fca6">use_begin</a>(),</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;                                   srcAlloca-&gt;<a class="code" href="classllvm_1_1Value.html#ad86469939d2a8bdd4169be9403b89f5a">use_end</a>());</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;  <span class="keywordflow">while</span> (!srcUseList.empty()) {</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    <a class="code" href="classllvm_1_1User.html">User</a> *UI = srcUseList.pop_back_val();</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    <span class="keywordflow">if</span> (isa&lt;BitCastInst&gt;(UI)) {</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Value.html#ac33c7ecbf1c0f1e8bf93403522e6976b">User::use_iterator</a> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = UI-&gt;<a class="code" href="classllvm_1_1Value.html#a413abcab8dbc3900fc2fde96a5d8fca6">use_begin</a>(), E = UI-&gt;<a class="code" href="classllvm_1_1Value.html#ad86469939d2a8bdd4169be9403b89f5a">use_end</a>();</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;           <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> != E; ++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;        srcUseList.push_back(*<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1GetElementPtrInst.html">GetElementPtrInst</a> *<a class="code" href="MD5_8cpp.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a> = dyn_cast&lt;GetElementPtrInst&gt;(UI)) {</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="MD5_8cpp.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>-&gt;hasAllZeroIndices())</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Value.html#ac33c7ecbf1c0f1e8bf93403522e6976b">User::use_iterator</a> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = UI-&gt;<a class="code" href="classllvm_1_1Value.html#a413abcab8dbc3900fc2fde96a5d8fca6">use_begin</a>(), E = UI-&gt;<a class="code" href="classllvm_1_1Value.html#ad86469939d2a8bdd4169be9403b89f5a">use_end</a>();</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;             <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> != E; ++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;          srcUseList.push_back(*<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (UI != C &amp;&amp; UI != cpy) {</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    }</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;  }</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;  <span class="comment">// Since we&#39;re changing the parameter to the callsite, we need to make sure</span></div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;  <span class="comment">// that what would be the new parameter dominates the callsite.</span></div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;  <a class="code" href="classllvm_1_1DominatorTree.html">DominatorTree</a> &amp;DT = getAnalysis&lt;DominatorTree&gt;();</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *cpyDestInst = dyn_cast&lt;Instruction&gt;(cpyDest))</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    <span class="keywordflow">if</span> (!DT.<a class="code" href="classllvm_1_1DominatorTree.html#a6fe9272dc67fe2ff4cafc33b895c4a6c">dominates</a>(cpyDestInst, C))</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;  <span class="comment">// In addition to knowing that the call does not access src in some</span></div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;  <span class="comment">// unexpected manner, for example via a global, which we deduce from</span></div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;  <span class="comment">// the use analysis, we also need to know that it does not sneakily</span></div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;  <span class="comment">// access dest.  We rely on AA to figure this out for us.</span></div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;  <a class="code" href="classllvm_1_1AliasAnalysis.html">AliasAnalysis</a> &amp;AA = getAnalysis&lt;AliasAnalysis&gt;();</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;  <a class="code" href="classllvm_1_1AliasAnalysis.html#a83d29c51155787c607268c2659559460">AliasAnalysis::ModRefResult</a> MR = AA.<a class="code" href="classllvm_1_1AliasAnalysis.html#a3f09a65a9c9d7bfff6c6271976d1baba">getModRefInfo</a>(C, cpyDest, srcSize);</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;  <span class="comment">// If necessary, perform additional analysis.</span></div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;  <span class="keywordflow">if</span> (MR != <a class="code" href="classllvm_1_1AliasAnalysis.html#a83d29c51155787c607268c2659559460a52fc7f344e74f168cb4b4c808dcfde1c">AliasAnalysis::NoModRef</a>)</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;    MR = AA.<a class="code" href="classllvm_1_1AliasAnalysis.html#a650241dcf00905f4085c878ec988e27f">callCapturesBefore</a>(C, cpyDest, srcSize, &amp;DT);</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;  <span class="keywordflow">if</span> (MR != <a class="code" href="classllvm_1_1AliasAnalysis.html#a83d29c51155787c607268c2659559460a52fc7f344e74f168cb4b4c808dcfde1c">AliasAnalysis::NoModRef</a>)</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;  <span class="comment">// All the checks have passed, so do the transformation.</span></div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;  <span class="keywordtype">bool</span> changedArgument = <span class="keyword">false</span>;</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; CS.<a class="code" href="classllvm_1_1CallSiteBase.html#a13ce8cb4c50c5b3505915467e14ad95a">arg_size</a>(); ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;    <span class="keywordflow">if</span> (CS.<a class="code" href="classllvm_1_1CallSiteBase.html#a65a550af73bd99c96abea847916aa4e9">getArgument</a>(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>)-&gt;<a class="code" href="classllvm_1_1Value.html#a38ea12c04523d63adda732b9c5d6da0a">stripPointerCasts</a>() == cpySrc) {</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *Dest = cpySrc-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>() == cpyDest-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>() ?  cpyDest</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;        : <a class="code" href="classllvm_1_1CastInst.html#acd347d07162a5a80dac61e5bdea9616c">CastInst::CreatePointerCast</a>(cpyDest, cpySrc-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>(),</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;                                      cpyDest-&gt;<a class="code" href="classllvm_1_1Value.html#ad452febc1ac0b394876e640ec03ffa38">getName</a>(), <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>);</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;      changedArgument = <span class="keyword">true</span>;</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;      <span class="keywordflow">if</span> (CS.<a class="code" href="classllvm_1_1CallSiteBase.html#a65a550af73bd99c96abea847916aa4e9">getArgument</a>(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>)-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>() == Dest-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>())</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;        CS.<a class="code" href="classllvm_1_1CallSiteBase.html#addab854f674836e5497dcfafff324e27">setArgument</a>(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>, Dest);</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;        CS.<a class="code" href="classllvm_1_1CallSiteBase.html#addab854f674836e5497dcfafff324e27">setArgument</a>(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="classllvm_1_1CastInst.html#acd347d07162a5a80dac61e5bdea9616c">CastInst::CreatePointerCast</a>(Dest,</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;                          CS.<a class="code" href="classllvm_1_1CallSiteBase.html#a65a550af73bd99c96abea847916aa4e9">getArgument</a>(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>)-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>(), Dest-&gt;<a class="code" href="classllvm_1_1Value.html#ad452febc1ac0b394876e640ec03ffa38">getName</a>(), <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>));</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;    }</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;  <span class="keywordflow">if</span> (!changedArgument)</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;  <span class="comment">// If the destination wasn&#39;t sufficiently aligned then increase its alignment.</span></div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;  <span class="keywordflow">if</span> (!isDestSufficientlyAligned) {</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;    assert(isa&lt;AllocaInst&gt;(cpyDest) &amp;&amp; <span class="stringliteral">&quot;Can only increase alloca alignment!&quot;</span>);</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;    cast&lt;AllocaInst&gt;(cpyDest)-&gt;setAlignment(srcAlign);</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;  }</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;  <span class="comment">// Drop any cached information about the call, because we may have changed</span></div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;  <span class="comment">// its dependence information by changing its parameter.</span></div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;  MD-&gt;removeInstruction(C);</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;  <span class="comment">// Remove the memcpy.</span></div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;  MD-&gt;removeInstruction(cpy);</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;  ++NumMemCpyInstr;</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;}</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;<span class="comment">/// processMemCpyMemCpyDependence - We&#39;ve found that the (upward scanning)</span></div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;<span class="comment">/// memory dependence of memcpy &#39;M&#39; is the memcpy &#39;MDep&#39;.  Try to simplify M to</span></div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;<span class="comment">/// copy from MDep&#39;s input if we can.  MSize is the size of M&#39;s copy.</span></div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;<span class="comment"></span><span class="keywordtype">bool</span> MemCpyOpt::processMemCpyMemCpyDependence(<a class="code" href="classllvm_1_1MemCpyInst.html">MemCpyInst</a> *<a class="code" href="Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>, <a class="code" href="classllvm_1_1MemCpyInst.html">MemCpyInst</a> *MDep,</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;                                              uint64_t MSize) {</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;  <span class="comment">// We can only transforms memcpy&#39;s where the dest of one is the source of the</span></div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;  <span class="comment">// other.</span></div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;  <span class="keywordflow">if</span> (M-&gt;<a class="code" href="classllvm_1_1MemTransferInst.html#a1d23e59237a8e4a61f4af0deb7320104">getSource</a>() != MDep-&gt;<a class="code" href="classllvm_1_1MemIntrinsic.html#ad8bf46d46e8f14bc23bd30df57cc9a77">getDest</a>() || MDep-&gt;<a class="code" href="classllvm_1_1MemIntrinsic.html#a9558faebdbb62c072aed98e33604889d">isVolatile</a>())</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;  <span class="comment">// If dep instruction is reading from our current input, then it is a noop</span></div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;  <span class="comment">// transfer and substituting the input won&#39;t change this instruction.  Just</span></div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;  <span class="comment">// ignore the input and let someone else zap MDep.  This handles cases like:</span></div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;  <span class="comment">//    memcpy(a &lt;- a)</span></div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;  <span class="comment">//    memcpy(b &lt;- a)</span></div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;  <span class="keywordflow">if</span> (M-&gt;<a class="code" href="classllvm_1_1MemTransferInst.html#a1d23e59237a8e4a61f4af0deb7320104">getSource</a>() == MDep-&gt;<a class="code" href="classllvm_1_1MemTransferInst.html#a1d23e59237a8e4a61f4af0deb7320104">getSource</a>())</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;  <span class="comment">// Second, the length of the memcpy&#39;s must be the same, or the preceding one</span></div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;  <span class="comment">// must be larger than the following one.</span></div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;  <a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *MDepLen = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a>&gt;(MDep-&gt;<a class="code" href="classllvm_1_1MemIntrinsic.html#abad10f74789466601c7a025540c1c072">getLength</a>());</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;  <a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *MLen = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a>&gt;(M-&gt;<a class="code" href="classllvm_1_1MemIntrinsic.html#abad10f74789466601c7a025540c1c072">getLength</a>());</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;  <span class="keywordflow">if</span> (!MDepLen || !MLen || MDepLen-&gt;<a class="code" href="classllvm_1_1ConstantInt.html#a6edd823ba5e4e1effc8280ca8a1194ef">getZExtValue</a>() &lt; MLen-&gt;getZExtValue())</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;  <a class="code" href="classllvm_1_1AliasAnalysis.html">AliasAnalysis</a> &amp;AA = getAnalysis&lt;AliasAnalysis&gt;();</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;  <span class="comment">// Verify that the copied-from memory doesn&#39;t change in between the two</span></div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;  <span class="comment">// transfers.  For example, in:</span></div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;  <span class="comment">//    memcpy(a &lt;- b)</span></div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;  <span class="comment">//    *b = 42;</span></div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;  <span class="comment">//    memcpy(c &lt;- a)</span></div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;  <span class="comment">// It would be invalid to transform the second memcpy into memcpy(c &lt;- b).</span></div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;  <span class="comment">//</span></div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;  <span class="comment">// TODO: If the code between M and MDep is transparent to the destination &quot;c&quot;,</span></div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;  <span class="comment">// then we could still perform the xform by moving M up to the first memcpy.</span></div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;  <span class="comment">//</span></div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;  <span class="comment">// NOTE: This is conservative, it will stop on any read from the source loc,</span></div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;  <span class="comment">// not just the defining memcpy.</span></div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;  <a class="code" href="classllvm_1_1MemDepResult.html">MemDepResult</a> SourceDep =</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;    MD-&gt;getPointerDependencyFrom(AA.<a class="code" href="classllvm_1_1AliasAnalysis.html#a7130fcc16699c8bad067d00ccc5a8c95">getLocationForSource</a>(MDep),</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;                                 <span class="keyword">false</span>, <a class="code" href="Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>, M-&gt;<a class="code" href="classllvm_1_1Instruction.html#a9cd49851904f15060edb782ef4dd1b2d">getParent</a>());</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;  <span class="keywordflow">if</span> (!SourceDep.isClobber() || SourceDep.getInst() != MDep)</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;  <span class="comment">// If the dest of the second might alias the source of the first, then the</span></div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;  <span class="comment">// source and dest might overlap.  We still want to eliminate the intermediate</span></div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;  <span class="comment">// value, but we have to generate a memmove instead of memcpy.</span></div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;  <span class="keywordtype">bool</span> UseMemMove = <span class="keyword">false</span>;</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;  <span class="keywordflow">if</span> (!AA.<a class="code" href="classllvm_1_1AliasAnalysis.html#a18afcc2fefe15651254db4a92c29f5c4">isNoAlias</a>(AA.<a class="code" href="classllvm_1_1AliasAnalysis.html#af02eef65834a820ff7a4f05a831d39ea">getLocationForDest</a>(M), AA.<a class="code" href="classllvm_1_1AliasAnalysis.html#a7130fcc16699c8bad067d00ccc5a8c95">getLocationForSource</a>(MDep)))</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;    UseMemMove = <span class="keyword">true</span>;</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;  <span class="comment">// If all checks passed, then we can transform M.</span></div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;  <span class="comment">// Make sure to use the lesser of the alignment of the source and the dest</span></div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;  <span class="comment">// since we&#39;re changing where we&#39;re reading from, but don&#39;t want to increase</span></div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;  <span class="comment">// the alignment past what can be read from or written to.</span></div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;  <span class="comment">// TODO: Is this worth it if we&#39;re creating a less aligned memcpy? For</span></div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;  <span class="comment">// example we could be moving from movaps -&gt; movq on x86.</span></div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;  <span class="keywordtype">unsigned</span> <a class="code" href="ARMSubtarget_8cpp.html#a4bd80d4e433d9f72af26b364036900dc">Align</a> = std::min(MDep-&gt;<a class="code" href="classllvm_1_1MemIntrinsic.html#a42dd65db3521498f10afb8c6f66e1bb5">getAlignment</a>(), M-&gt;<a class="code" href="classllvm_1_1MemIntrinsic.html#a42dd65db3521498f10afb8c6f66e1bb5">getAlignment</a>());</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;  <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> Builder(M);</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;  <span class="keywordflow">if</span> (UseMemMove)</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;    Builder.CreateMemMove(M-&gt;<a class="code" href="classllvm_1_1MemIntrinsic.html#a3ec0c47a5532e568d54c8d452dfb58df">getRawDest</a>(), MDep-&gt;<a class="code" href="classllvm_1_1MemTransferInst.html#a26bfca1607622229a625f2db73aed2ba">getRawSource</a>(), M-&gt;<a class="code" href="classllvm_1_1MemIntrinsic.html#abad10f74789466601c7a025540c1c072">getLength</a>(),</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;                          <a class="code" href="ARMSubtarget_8cpp.html#a4bd80d4e433d9f72af26b364036900dc">Align</a>, M-&gt;<a class="code" href="classllvm_1_1MemIntrinsic.html#a9558faebdbb62c072aed98e33604889d">isVolatile</a>());</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;    Builder.CreateMemCpy(M-&gt;<a class="code" href="classllvm_1_1MemIntrinsic.html#a3ec0c47a5532e568d54c8d452dfb58df">getRawDest</a>(), MDep-&gt;<a class="code" href="classllvm_1_1MemTransferInst.html#a26bfca1607622229a625f2db73aed2ba">getRawSource</a>(), M-&gt;<a class="code" href="classllvm_1_1MemIntrinsic.html#abad10f74789466601c7a025540c1c072">getLength</a>(),</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;                         <a class="code" href="ARMSubtarget_8cpp.html#a4bd80d4e433d9f72af26b364036900dc">Align</a>, M-&gt;<a class="code" href="classllvm_1_1MemIntrinsic.html#a9558faebdbb62c072aed98e33604889d">isVolatile</a>());</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;  <span class="comment">// Remove the instruction we&#39;re replacing.</span></div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;  MD-&gt;removeInstruction(M);</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;  M-&gt;<a class="code" href="classllvm_1_1Instruction.html#a6fe2f06b8a4b2c3d6308afb223a0238a">eraseFromParent</a>();</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;  ++NumMemCpyInstr;</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;}</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;<span class="comment">/// processMemCpy - perform simplification of memcpy&#39;s.  If we have memcpy A</span></div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;<span class="comment">/// which copies X to Y, and memcpy B which copies Y to Z, then we can rewrite</span></div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;<span class="comment">/// B to be a memcpy from X to Z (or potentially a memmove, depending on</span></div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;<span class="comment">/// circumstances). This allows later passes to remove the first memcpy</span></div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;<span class="comment">/// altogether.</span></div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;<span class="comment"></span><span class="keywordtype">bool</span> MemCpyOpt::processMemCpy(<a class="code" href="classllvm_1_1MemCpyInst.html">MemCpyInst</a> *M) {</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;  <span class="comment">// We can only optimize statically-sized memcpy&#39;s that are non-volatile.</span></div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;  <a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *CopySize = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a>&gt;(M-&gt;<a class="code" href="classllvm_1_1MemIntrinsic.html#abad10f74789466601c7a025540c1c072">getLength</a>());</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;  <span class="keywordflow">if</span> (CopySize == 0 || M-&gt;<a class="code" href="classllvm_1_1MemIntrinsic.html#a9558faebdbb62c072aed98e33604889d">isVolatile</a>()) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;  <span class="comment">// If the source and destination of the memcpy are the same, then zap it.</span></div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;  <span class="keywordflow">if</span> (M-&gt;<a class="code" href="classllvm_1_1MemTransferInst.html#a1d23e59237a8e4a61f4af0deb7320104">getSource</a>() == M-&gt;<a class="code" href="classllvm_1_1MemIntrinsic.html#ad8bf46d46e8f14bc23bd30df57cc9a77">getDest</a>()) {</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;    MD-&gt;removeInstruction(M);</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;    M-&gt;<a class="code" href="classllvm_1_1Instruction.html#a6fe2f06b8a4b2c3d6308afb223a0238a">eraseFromParent</a>();</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;  }</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;  <span class="comment">// If copying from a constant, try to turn the memcpy into a memset.</span></div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1GlobalVariable.html">GlobalVariable</a> *GV = dyn_cast&lt;GlobalVariable&gt;(M-&gt;<a class="code" href="classllvm_1_1MemTransferInst.html#a1d23e59237a8e4a61f4af0deb7320104">getSource</a>()))</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;    <span class="keywordflow">if</span> (GV-&gt;isConstant() &amp;&amp; GV-&gt;hasDefinitiveInitializer())</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *ByteVal = <a class="code" href="namespacellvm.html#a9945de214e3ba2b16f664bcdc953f0e0">isBytewiseValue</a>(GV-&gt;getInitializer())) {</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;        <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> Builder(M);</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;        Builder.<a class="code" href="classllvm_1_1IRBuilderBase.html#a58f62481bd3a4bfc5d07102fe857741a">CreateMemSet</a>(M-&gt;<a class="code" href="classllvm_1_1MemIntrinsic.html#a3ec0c47a5532e568d54c8d452dfb58df">getRawDest</a>(), ByteVal, CopySize,</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;                             M-&gt;<a class="code" href="classllvm_1_1MemIntrinsic.html#a42dd65db3521498f10afb8c6f66e1bb5">getAlignment</a>(), <span class="keyword">false</span>);</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;        MD-&gt;removeInstruction(M);</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;        M-&gt;<a class="code" href="classllvm_1_1Instruction.html#a6fe2f06b8a4b2c3d6308afb223a0238a">eraseFromParent</a>();</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;        ++NumCpyToSet;</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;      }</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;  <span class="comment">// The are two possible optimizations we can do for memcpy:</span></div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;  <span class="comment">//   a) memcpy-memcpy xform which exposes redundance for DSE.</span></div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;  <span class="comment">//   b) call-memcpy xform for return slot optimization.</span></div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;  <a class="code" href="classllvm_1_1MemDepResult.html">MemDepResult</a> DepInfo = MD-&gt;getDependency(M);</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;  <span class="keywordflow">if</span> (DepInfo.<a class="code" href="classllvm_1_1MemDepResult.html#ae409b288c7f70a6c57586535abed3808">isClobber</a>()) {</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *C = dyn_cast&lt;CallInst&gt;(DepInfo.<a class="code" href="classllvm_1_1MemDepResult.html#a8452eb6508c00e2b6d56926bebc79f57">getInst</a>())) {</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;      <span class="keywordflow">if</span> (performCallSlotOptzn(M, M-&gt;<a class="code" href="classllvm_1_1MemIntrinsic.html#ad8bf46d46e8f14bc23bd30df57cc9a77">getDest</a>(), M-&gt;<a class="code" href="classllvm_1_1MemTransferInst.html#a1d23e59237a8e4a61f4af0deb7320104">getSource</a>(),</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;                               CopySize-&gt;<a class="code" href="classllvm_1_1ConstantInt.html#a6edd823ba5e4e1effc8280ca8a1194ef">getZExtValue</a>(), M-&gt;<a class="code" href="classllvm_1_1MemIntrinsic.html#a42dd65db3521498f10afb8c6f66e1bb5">getAlignment</a>(),</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;                               <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>)) {</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;        MD-&gt;removeInstruction(M);</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;        M-&gt;<a class="code" href="classllvm_1_1Instruction.html#a6fe2f06b8a4b2c3d6308afb223a0238a">eraseFromParent</a>();</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;      }</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;    }</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;  }</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;  <a class="code" href="structllvm_1_1AliasAnalysis_1_1Location.html">AliasAnalysis::Location</a> SrcLoc = <a class="code" href="classllvm_1_1AliasAnalysis.html#a7130fcc16699c8bad067d00ccc5a8c95">AliasAnalysis::getLocationForSource</a>(M);</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;  <a class="code" href="classllvm_1_1MemDepResult.html">MemDepResult</a> SrcDepInfo = MD-&gt;getPointerDependencyFrom(SrcLoc, <span class="keyword">true</span>,</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;                                                         M, M-&gt;<a class="code" href="classllvm_1_1Instruction.html#a9cd49851904f15060edb782ef4dd1b2d">getParent</a>());</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;  <span class="keywordflow">if</span> (SrcDepInfo.<a class="code" href="classllvm_1_1MemDepResult.html#ae409b288c7f70a6c57586535abed3808">isClobber</a>()) {</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1MemCpyInst.html">MemCpyInst</a> *MDep = dyn_cast&lt;MemCpyInst&gt;(SrcDepInfo.<a class="code" href="classllvm_1_1MemDepResult.html#a8452eb6508c00e2b6d56926bebc79f57">getInst</a>()))</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;      <span class="keywordflow">return</span> processMemCpyMemCpyDependence(M, MDep, CopySize-&gt;<a class="code" href="classllvm_1_1ConstantInt.html#a6edd823ba5e4e1effc8280ca8a1194ef">getZExtValue</a>());</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;  }</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;}</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;<span class="comment">/// processMemMove - Transforms memmove calls to memcpy calls when the src/dst</span></div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;<span class="comment">/// are guaranteed not to alias.</span></div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;<span class="comment"></span><span class="keywordtype">bool</span> MemCpyOpt::processMemMove(<a class="code" href="classllvm_1_1MemMoveInst.html">MemMoveInst</a> *M) {</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;  <a class="code" href="classllvm_1_1AliasAnalysis.html">AliasAnalysis</a> &amp;AA = getAnalysis&lt;AliasAnalysis&gt;();</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;  <span class="keywordflow">if</span> (!TLI-&gt;has(<a class="code" href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fa9e02525b88a00a1d0e8dcded032acbee">LibFunc::memmove</a>))</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;  <span class="comment">// See if the pointers alias.</span></div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;  <span class="keywordflow">if</span> (!AA.<a class="code" href="classllvm_1_1AliasAnalysis.html#a18afcc2fefe15651254db4a92c29f5c4">isNoAlias</a>(AA.<a class="code" href="classllvm_1_1AliasAnalysis.html#af02eef65834a820ff7a4f05a831d39ea">getLocationForDest</a>(M), AA.<a class="code" href="classllvm_1_1AliasAnalysis.html#a7130fcc16699c8bad067d00ccc5a8c95">getLocationForSource</a>(M)))</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;  <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;MemCpyOpt: Optimizing memmove -&gt; memcpy: &quot;</span> &lt;&lt; *M &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;  <span class="comment">// If not, then we know we can transform this.</span></div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;  <a class="code" href="classllvm_1_1Module.html">Module</a> *Mod = M-&gt;<a class="code" href="classllvm_1_1Instruction.html#a9cd49851904f15060edb782ef4dd1b2d">getParent</a>()-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#aca229503e4f5c83a187a6a921c625fa8">getParent</a>()-&gt;<a class="code" href="classllvm_1_1GlobalValue.html#a9e1fc23a17e97d2d1732e753ae9251ac">getParent</a>();</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *ArgTys[3] = { M-&gt;<a class="code" href="classllvm_1_1MemIntrinsic.html#a3ec0c47a5532e568d54c8d452dfb58df">getRawDest</a>()-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>(),</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;                      M-&gt;<a class="code" href="classllvm_1_1MemTransferInst.html#a26bfca1607622229a625f2db73aed2ba">getRawSource</a>()-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>(),</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;                      M-&gt;<a class="code" href="classllvm_1_1MemIntrinsic.html#abad10f74789466601c7a025540c1c072">getLength</a>()-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>() };</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;  M-&gt;<a class="code" href="classllvm_1_1CallInst.html#a61f747edd1ca001427e02e02a320b709">setCalledFunction</a>(<a class="code" href="namespacellvm_1_1Intrinsic.html#a842176a2c8c60a94bc788454b0828ea2">Intrinsic::getDeclaration</a>(Mod, <a class="code" href="namespacellvm_1_1Intrinsic.html#a73349916f7e54a6b988a3646c7a02e90ab20709bfc1ed1765cd3b43f69bf11edc">Intrinsic::memcpy</a>,</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;                                                 ArgTys));</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;  <span class="comment">// MemDep may have over conservative information about this instruction, just</span></div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;  <span class="comment">// conservatively flush it from the cache.</span></div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;  MD-&gt;removeInstruction(M);</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;  ++NumMoveToCpy;</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;}</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;<span class="comment">/// processByValArgument - This is called on every byval argument in call sites.</span></div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;<span class="comment"></span><span class="keywordtype">bool</span> MemCpyOpt::processByValArgument(<a class="code" href="classllvm_1_1CallSite.html">CallSite</a> CS, <span class="keywordtype">unsigned</span> ArgNo) {</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;  <span class="keywordflow">if</span> (TD == 0) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;  <span class="comment">// Find out what feeds this byval argument.</span></div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *ByValArg = CS.<a class="code" href="classllvm_1_1CallSiteBase.html#a65a550af73bd99c96abea847916aa4e9">getArgument</a>(ArgNo);</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *ByValTy = cast&lt;PointerType&gt;(ByValArg-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>())-&gt;getElementType();</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;  uint64_t ByValSize = TD-&gt;<a class="code" href="classllvm_1_1DataLayout.html#a1d6fcc02e91ba24510aba42660c90e29">getTypeAllocSize</a>(ByValTy);</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;  <a class="code" href="classllvm_1_1MemDepResult.html">MemDepResult</a> DepInfo =</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;    MD-&gt;getPointerDependencyFrom(<a class="code" href="structllvm_1_1AliasAnalysis_1_1Location.html">AliasAnalysis::Location</a>(ByValArg, ByValSize),</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;                                 <span class="keyword">true</span>, CS.<a class="code" href="classllvm_1_1CallSiteBase.html#ae4c67f835911559821939fb23a2e7aff">getInstruction</a>(),</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;                                 CS.<a class="code" href="classllvm_1_1CallSiteBase.html#ae4c67f835911559821939fb23a2e7aff">getInstruction</a>()-&gt;<a class="code" href="classllvm_1_1Instruction.html#a9cd49851904f15060edb782ef4dd1b2d">getParent</a>());</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;  <span class="keywordflow">if</span> (!DepInfo.<a class="code" href="classllvm_1_1MemDepResult.html#ae409b288c7f70a6c57586535abed3808">isClobber</a>())</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;  <span class="comment">// If the byval argument isn&#39;t fed by a memcpy, ignore it.  If it is fed by</span></div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;  <span class="comment">// a memcpy, see if we can byval from the source of the memcpy instead of the</span></div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;  <span class="comment">// result.</span></div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;  <a class="code" href="classllvm_1_1MemCpyInst.html">MemCpyInst</a> *MDep = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1MemCpyInst.html">MemCpyInst</a>&gt;(DepInfo.<a class="code" href="classllvm_1_1MemDepResult.html#a8452eb6508c00e2b6d56926bebc79f57">getInst</a>());</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;  <span class="keywordflow">if</span> (MDep == 0 || MDep-&gt;<a class="code" href="classllvm_1_1MemIntrinsic.html#a9558faebdbb62c072aed98e33604889d">isVolatile</a>() ||</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;      ByValArg-&gt;<a class="code" href="classllvm_1_1Value.html#a38ea12c04523d63adda732b9c5d6da0a">stripPointerCasts</a>() != MDep-&gt;<a class="code" href="classllvm_1_1MemIntrinsic.html#ad8bf46d46e8f14bc23bd30df57cc9a77">getDest</a>())</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;  <span class="comment">// The length of the memcpy must be larger or equal to the size of the byval.</span></div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;  <a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *<a class="code" href="Target_2README_8txt.html#a2a2df5a25b9c703e74e82b48a75d0c3d">C1</a> = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a>&gt;(MDep-&gt;<a class="code" href="classllvm_1_1MemIntrinsic.html#abad10f74789466601c7a025540c1c072">getLength</a>());</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;  <span class="keywordflow">if</span> (C1 == 0 || C1-&gt;<a class="code" href="classllvm_1_1ConstantInt.html#af8dde13a97efce293a7b04daf1e208fb">getValue</a>().<a class="code" href="classllvm_1_1APInt.html#a7dc983ebf0eb2d255fa90a67063c72e2">getZExtValue</a>() &lt; ByValSize)</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;  <span class="comment">// Get the alignment of the byval.  If the call doesn&#39;t specify the alignment,</span></div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;  <span class="comment">// then it is some target specific value that we can&#39;t know.</span></div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;  <span class="keywordtype">unsigned</span> ByValAlign = CS.<a class="code" href="classllvm_1_1CallSiteBase.html#af23ecc474bd52056428ee09ebe9f044f">getParamAlignment</a>(ArgNo+1);</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;  <span class="keywordflow">if</span> (ByValAlign == 0) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;  <span class="comment">// If it is greater than the memcpy, then we check to see if we can force the</span></div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;  <span class="comment">// source of the memcpy to the alignment we need.  If we fail, we bail out.</span></div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;  <span class="keywordflow">if</span> (MDep-&gt;<a class="code" href="classllvm_1_1MemIntrinsic.html#a42dd65db3521498f10afb8c6f66e1bb5">getAlignment</a>() &lt; ByValAlign &amp;&amp;</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;      <a class="code" href="namespacellvm.html#a3dd948f1535b4b28f2a7d45a5c11a34a">getOrEnforceKnownAlignment</a>(MDep-&gt;<a class="code" href="classllvm_1_1MemTransferInst.html#a1d23e59237a8e4a61f4af0deb7320104">getSource</a>(),ByValAlign, TD) &lt; ByValAlign)</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;  <span class="comment">// Verify that the copied-from memory doesn&#39;t change in between the memcpy and</span></div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;  <span class="comment">// the byval call.</span></div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;  <span class="comment">//    memcpy(a &lt;- b)</span></div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;  <span class="comment">//    *b = 42;</span></div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;  <span class="comment">//    foo(*a)</span></div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;  <span class="comment">// It would be invalid to transform the second memcpy into foo(*b).</span></div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;  <span class="comment">//</span></div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;  <span class="comment">// NOTE: This is conservative, it will stop on any read from the source loc,</span></div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;  <span class="comment">// not just the defining memcpy.</span></div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;  <a class="code" href="classllvm_1_1MemDepResult.html">MemDepResult</a> SourceDep =</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;    MD-&gt;getPointerDependencyFrom(<a class="code" href="classllvm_1_1AliasAnalysis.html#a7130fcc16699c8bad067d00ccc5a8c95">AliasAnalysis::getLocationForSource</a>(MDep),</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;                                 <span class="keyword">false</span>, CS.<a class="code" href="classllvm_1_1CallSiteBase.html#ae4c67f835911559821939fb23a2e7aff">getInstruction</a>(), MDep-&gt;<a class="code" href="classllvm_1_1Instruction.html#a9cd49851904f15060edb782ef4dd1b2d">getParent</a>());</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;  <span class="keywordflow">if</span> (!SourceDep.<a class="code" href="classllvm_1_1MemDepResult.html#ae409b288c7f70a6c57586535abed3808">isClobber</a>() || SourceDep.<a class="code" href="classllvm_1_1MemDepResult.html#a8452eb6508c00e2b6d56926bebc79f57">getInst</a>() != MDep)</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *TmpCast = MDep-&gt;<a class="code" href="classllvm_1_1MemTransferInst.html#a1d23e59237a8e4a61f4af0deb7320104">getSource</a>();</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;  <span class="keywordflow">if</span> (MDep-&gt;<a class="code" href="classllvm_1_1MemTransferInst.html#a1d23e59237a8e4a61f4af0deb7320104">getSource</a>()-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>() != ByValArg-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>())</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;    TmpCast = <span class="keyword">new</span> <a class="code" href="classllvm_1_1BitCastInst.html">BitCastInst</a>(MDep-&gt;<a class="code" href="classllvm_1_1MemTransferInst.html#a1d23e59237a8e4a61f4af0deb7320104">getSource</a>(), ByValArg-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>(),</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;                              <span class="stringliteral">&quot;tmpcast&quot;</span>, CS.<a class="code" href="classllvm_1_1CallSiteBase.html#ae4c67f835911559821939fb23a2e7aff">getInstruction</a>());</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;  <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;MemCpyOpt: Forwarding memcpy to byval:\n&quot;</span></div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;               &lt;&lt; <span class="stringliteral">&quot;  &quot;</span> &lt;&lt; *MDep &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;               &lt;&lt; <span class="stringliteral">&quot;  &quot;</span> &lt;&lt; *CS.<a class="code" href="classllvm_1_1CallSiteBase.html#ae4c67f835911559821939fb23a2e7aff">getInstruction</a>() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;  <span class="comment">// Otherwise we&#39;re good!  Update the byval argument.</span></div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;  CS.<a class="code" href="classllvm_1_1CallSiteBase.html#addab854f674836e5497dcfafff324e27">setArgument</a>(ArgNo, TmpCast);</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;  ++NumMemCpyInstr;</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;}</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;<span class="comment">/// iterateOnFunction - Executes one iteration of MemCpyOpt.</span></div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;<span class="comment"></span><span class="keywordtype">bool</span> MemCpyOpt::iterateOnFunction(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="LLParser_8cpp.html#a33ece1ef8074506a15d7f86eb76dbae6">F</a>) {</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;  <span class="keywordtype">bool</span> MadeChange = <span class="keyword">false</span>;</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;  <span class="comment">// Walk all instruction in the function.</span></div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1ilist__iterator.html">Function::iterator</a> <a class="code" href="CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> = F.<a class="code" href="classllvm_1_1Function.html#a88a5e60837674780a9d812d661897ac5">begin</a>(), BBE = F.<a class="code" href="classllvm_1_1Function.html#ae4ca2261b8b901e415fda7feac5051ea">end</a>(); <a class="code" href="CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> != BBE; ++<a class="code" href="CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>) {</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1ilist__iterator.html">BasicBlock::iterator</a> BI = <a class="code" href="CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>-&gt;begin(), BE = <a class="code" href="CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>-&gt;end(); BI != BE;) {</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;      <span class="comment">// Avoid invalidating the iterator.</span></div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;      <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = BI++;</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;      <span class="keywordtype">bool</span> RepeatInstruction = <span class="keyword">false</span>;</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1StoreInst.html">StoreInst</a> *SI = dyn_cast&lt;StoreInst&gt;(I))</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;        MadeChange |= processStore(SI, BI);</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1MemSetInst.html">MemSetInst</a> *M = dyn_cast&lt;MemSetInst&gt;(I))</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;        RepeatInstruction = processMemSet(M, BI);</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1MemCpyInst.html">MemCpyInst</a> *M = dyn_cast&lt;MemCpyInst&gt;(I))</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;        RepeatInstruction = processMemCpy(M);</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1MemMoveInst.html">MemMoveInst</a> *M = dyn_cast&lt;MemMoveInst&gt;(I))</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;        RepeatInstruction = processMemMove(M);</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1CallSite.html">CallSite</a> CS = (<a class="code" href="classllvm_1_1Value.html">Value</a>*)<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0, e = CS.<a class="code" href="classllvm_1_1CallSiteBase.html#a13ce8cb4c50c5b3505915467e14ad95a">arg_size</a>(); <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != e; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;          <span class="keywordflow">if</span> (CS.<a class="code" href="classllvm_1_1CallSiteBase.html#a2b51df7c4694230be653c4b5a3186029">isByValArgument</a>(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>))</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;            MadeChange |= processByValArgument(CS, <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;      }</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;      <span class="comment">// Reprocess the instruction if desired.</span></div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;      <span class="keywordflow">if</span> (RepeatInstruction) {</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;        <span class="keywordflow">if</span> (BI != <a class="code" href="CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>-&gt;begin()) --BI;</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;        MadeChange = <span class="keyword">true</span>;</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;      }</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;    }</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;  }</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;</div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;  <span class="keywordflow">return</span> MadeChange;</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;}</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;<span class="comment">// MemCpyOpt::runOnFunction - This is the main transformation entry point for a</span></div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;<span class="comment">// function.</span></div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;<span class="keywordtype">bool</span> MemCpyOpt::runOnFunction(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;F) {</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;  <span class="keywordtype">bool</span> MadeChange = <span class="keyword">false</span>;</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;  MD = &amp;getAnalysis&lt;MemoryDependenceAnalysis&gt;();</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;  TD = getAnalysisIfAvailable&lt;DataLayout&gt;();</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;  TLI = &amp;getAnalysis&lt;TargetLibraryInfo&gt;();</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;  <span class="comment">// If we don&#39;t have at least memset and memcpy, there is little point of doing</span></div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;  <span class="comment">// anything here.  These are required by a freestanding implementation, so if</span></div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;  <span class="comment">// even they are disabled, there is no point in trying hard.</span></div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;  <span class="keywordflow">if</span> (!TLI-&gt;has(<a class="code" href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fa9f7f1b6be1144152902121f2463d0368">LibFunc::memset</a>) || !TLI-&gt;has(<a class="code" href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fad5203242bc89eaa644dc7b7ba2371c1d">LibFunc::memcpy</a>))</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;  <span class="keywordflow">while</span> (1) {</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;    <span class="keywordflow">if</span> (!iterateOnFunction(F))</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;    MadeChange = <span class="keyword">true</span>;</div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;  }</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;  MD = 0;</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;  <span class="keywordflow">return</span> MadeChange;</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;}</div><div class="ttc" id="Target_2X86_2README_8txt_html_a1b0f9b510ec52cc3cbaa14e6e6211168"><div class="ttname"><a href="Target_2X86_2README_8txt.html#a1b0f9b510ec52cc3cbaa14e6e6211168">td</a></div><div class="ttdeci">gets compiled into this on rsp movaps rsp movaps rsp movaps rsp movaps rsp movaps rsp movaps rsp movaps rsp movaps rsp movq rsp movq rsp movq rsp movq rsp movq rsp rax movq rsp rax movq rsp rsp rsp eax eax jbe LBB1_3 rcx rax movq rsp eax rsp ret ecx eax rcx movl rsp jmp LBB1_2 gcc rsp rax movq rsp rsp movq rsp rax movq rsp eax eax jb L6 rdx eax rsp ret p2align edx rdx eax movl rsp eax rsp ret and it gets compiled into this on ebp esp eax movl ebp eax movl ebp eax esp popl ebp ret gcc ebp eax popl ebp ret Teach tblgen not to check bitconvert source type in some cases This allows us to consolidate the following patterns in X86InstrMMX td</div><div class="ttdef"><b>Definition:</b> <a href="Target_2X86_2README_8txt_source.html#l01367">Target/X86/README.txt:1367</a></div></div>
<div class="ttc" id="classllvm_1_1MemIntrinsic_html_a42dd65db3521498f10afb8c6f66e1bb5"><div class="ttname"><a href="classllvm_1_1MemIntrinsic.html#a42dd65db3521498f10afb8c6f66e1bb5">llvm::MemIntrinsic::getAlignment</a></div><div class="ttdeci">unsigned getAlignment() const </div><div class="ttdef"><b>Definition:</b> <a href="IntrinsicInst_8h_source.html#l00127">IntrinsicInst.h:127</a></div></div>
<div class="ttc" id="classllvm_1_1Value_html_ad86469939d2a8bdd4169be9403b89f5a"><div class="ttname"><a href="classllvm_1_1Value.html#ad86469939d2a8bdd4169be9403b89f5a">llvm::Value::use_end</a></div><div class="ttdeci">use_iterator use_end()</div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00152">Value.h:152</a></div></div>
<div class="ttc" id="classllvm_1_1DataLayout_html"><div class="ttname"><a href="classllvm_1_1DataLayout.html">llvm::DataLayout</a></div><div class="ttdef"><b>Definition:</b> <a href="DataLayout_8h_source.html#l00098">DataLayout.h:98</a></div></div>
<div class="ttc" id="classllvm_1_1generic__gep__type__iterator_html_aa9576aea404b156a949122affc839777"><div class="ttname"><a href="classllvm_1_1generic__gep__type__iterator.html#aa9576aea404b156a949122affc839777">llvm::generic_gep_type_iterator::getIndexedType</a></div><div class="ttdeci">Type * getIndexedType() const </div><div class="ttdef"><b>Definition:</b> <a href="GetElementPtrTypeIterator_8h_source.html#l00057">GetElementPtrTypeIterator.h:57</a></div></div>
<div class="ttc" id="namespacellvm_1_1sys_1_1path_html_a214ec2f04ffd92636ed4bd2717607a1d"><div class="ttname"><a href="namespacellvm_1_1sys_1_1path.html#a214ec2f04ffd92636ed4bd2717607a1d">llvm::sys::path::end</a></div><div class="ttdeci">const_iterator end(StringRef path)</div><div class="ttdoc">Get end iterator over path. </div><div class="ttdef"><b>Definition:</b> <a href="Path_8cpp_source.html#l00181">Path.cpp:181</a></div></div>
<div class="ttc" id="namespacellvm_1_1ARM__PROC_html_aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5"><div class="ttname"><a href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">llvm::ARM_PROC::A</a></div><div class="ttdef"><b>Definition:</b> <a href="ARMBaseInfo_8h_source.html#l00098">ARMBaseInfo.h:98</a></div></div>
<div class="ttc" id="classllvm_1_1AnalysisUsage_html_a884f90190bca4bd354f2d5c91c264028"><div class="ttname"><a href="classllvm_1_1AnalysisUsage.html#a884f90190bca4bd354f2d5c91c264028">llvm::AnalysisUsage::addPreserved</a></div><div class="ttdeci">AnalysisUsage &amp; addPreserved()</div><div class="ttdef"><b>Definition:</b> <a href="PassAnalysisSupport_8h_source.html#l00081">PassAnalysisSupport.h:81</a></div></div>
<div class="ttc" id="classllvm_1_1PassRegistry_html_a05a729900b76c89e808c6c3094921b2f"><div class="ttname"><a href="classllvm_1_1PassRegistry.html#a05a729900b76c89e808c6c3094921b2f">llvm::PassRegistry::getPassRegistry</a></div><div class="ttdeci">static PassRegistry * getPassRegistry()</div><div class="ttdef"><b>Definition:</b> <a href="PassRegistry_8cpp_source.html#l00035">PassRegistry.cpp:35</a></div></div>
<div class="ttc" id="classllvm_1_1Instruction_html_a6fe2f06b8a4b2c3d6308afb223a0238a"><div class="ttname"><a href="classllvm_1_1Instruction.html#a6fe2f06b8a4b2c3d6308afb223a0238a">llvm::Instruction::eraseFromParent</a></div><div class="ttdeci">void eraseFromParent()</div><div class="ttdef"><b>Definition:</b> <a href="Instruction_8cpp_source.html#l00072">Instruction.cpp:72</a></div></div>
<div class="ttc" id="classllvm_1_1Argument_html"><div class="ttname"><a href="classllvm_1_1Argument.html">llvm::Argument</a></div><div class="ttdoc">LLVM Argument representation. </div><div class="ttdef"><b>Definition:</b> <a href="Argument_8h_source.html#l00035">Argument.h:35</a></div></div>
<div class="ttc" id="classllvm_1_1APInt_html_a7dc983ebf0eb2d255fa90a67063c72e2"><div class="ttname"><a href="classllvm_1_1APInt.html#a7dc983ebf0eb2d255fa90a67063c72e2">llvm::APInt::getZExtValue</a></div><div class="ttdeci">uint64_t getZExtValue() const </div><div class="ttdoc">Get zero extended value. </div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l01306">APInt.h:1306</a></div></div>
<div class="ttc" id="namespacellvm_1_1LibFunc_html_abf8f6830387f338fed0bce2e65108c6fad5203242bc89eaa644dc7b7ba2371c1d"><div class="ttname"><a href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fad5203242bc89eaa644dc7b7ba2371c1d">llvm::LibFunc::memcpy</a></div><div class="ttdoc">void *memcpy(void *s1, const void *s2, size_t n); </div><div class="ttdef"><b>Definition:</b> <a href="TargetLibraryInfo_8h_source.html#l00390">TargetLibraryInfo.h:390</a></div></div>
<div class="ttc" id="Instructions_8h_html"><div class="ttname"><a href="Instructions_8h.html">Instructions.h</a></div></div>
<div class="ttc" id="namespacellvm_html"><div class="ttname"><a href="namespacellvm.html">llvm</a></div><div class="ttdoc">List of target independent CodeGen pass IDs. </div><div class="ttdef"><b>Definition:</b> <a href="APFloat_8h_source.html#l00022">APFloat.h:22</a></div></div>
<div class="ttc" id="namespacellvm_html_a9945de214e3ba2b16f664bcdc953f0e0"><div class="ttname"><a href="namespacellvm.html#a9945de214e3ba2b16f664bcdc953f0e0">llvm::isBytewiseValue</a></div><div class="ttdeci">Value * isBytewiseValue(Value *V)</div><div class="ttdef"><b>Definition:</b> <a href="ValueTracking_8cpp_source.html#l01479">ValueTracking.cpp:1479</a></div></div>
<div class="ttc" id="MemoryDependenceAnalysis_8h_html"><div class="ttname"><a href="MemoryDependenceAnalysis_8h.html">MemoryDependenceAnalysis.h</a></div></div>
<div class="ttc" id="classllvm_1_1AliasAnalysis_html_a3f09a65a9c9d7bfff6c6271976d1baba"><div class="ttname"><a href="classllvm_1_1AliasAnalysis.html#a3f09a65a9c9d7bfff6c6271976d1baba">llvm::AliasAnalysis::getModRefInfo</a></div><div class="ttdeci">ModRefResult getModRefInfo(const Instruction *I, const Location &amp;Loc)</div><div class="ttdef"><b>Definition:</b> <a href="AliasAnalysis_8h_source.html#l00353">AliasAnalysis.h:353</a></div></div>
<div class="ttc" id="classllvm_1_1MemIntrinsic_html_a9558faebdbb62c072aed98e33604889d"><div class="ttname"><a href="classllvm_1_1MemIntrinsic.html#a9558faebdbb62c072aed98e33604889d">llvm::MemIntrinsic::isVolatile</a></div><div class="ttdeci">bool isVolatile() const </div><div class="ttdef"><b>Definition:</b> <a href="IntrinsicInst_8h_source.html#l00134">IntrinsicInst.h:134</a></div></div>
<div class="ttc" id="classllvm_1_1Module_html"><div class="ttname"><a href="classllvm_1_1Module.html">llvm::Module</a></div><div class="ttdoc">The main container class for the LLVM Intermediate Representation. </div><div class="ttdef"><b>Definition:</b> <a href="Module_8h_source.html#l00112">Module.h:112</a></div></div>
<div class="ttc" id="classllvm_1_1Function_html_ae4ca2261b8b901e415fda7feac5051ea"><div class="ttname"><a href="classllvm_1_1Function.html#ae4ca2261b8b901e415fda7feac5051ea">llvm::Function::end</a></div><div class="ttdeci">iterator end()</div><div class="ttdef"><b>Definition:</b> <a href="Function_8h_source.html#l00397">Function.h:397</a></div></div>
<div class="ttc" id="IntrinsicInst_8h_html"><div class="ttname"><a href="IntrinsicInst_8h.html">IntrinsicInst.h</a></div></div>
<div class="ttc" id="classllvm_1_1CallSiteBase_html_a13ce8cb4c50c5b3505915467e14ad95a"><div class="ttname"><a href="classllvm_1_1CallSiteBase.html#a13ce8cb4c50c5b3505915467e14ad95a">llvm::CallSiteBase::arg_size</a></div><div class="ttdeci">unsigned arg_size() const </div><div class="ttdef"><b>Definition:</b> <a href="CallSite_8h_source.html#l00145">CallSite.h:145</a></div></div>
<div class="ttc" id="classllvm_1_1MemSetInst_html_a357f35c4ac1c01e84d73a4a9e26f6aac"><div class="ttname"><a href="classllvm_1_1MemSetInst.html#a357f35c4ac1c01e84d73a4a9e26f6aac">llvm::MemSetInst::getValue</a></div><div class="ttdeci">Value * getValue() const </div><div class="ttdef"><b>Definition:</b> <a href="IntrinsicInst_8h_source.html#l00194">IntrinsicInst.h:194</a></div></div>
<div class="ttc" id="namespacellvm_html_a3f2f98c2a67c9e79f58aad9150a62e42"><div class="ttname"><a href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">llvm::dyn_cast</a></div><div class="ttdeci">enable_if_c&lt;!is_simple_type&lt; Y &gt;::value, typename cast_retty&lt; X, const Y &gt;::ret_type &gt;::type dyn_cast(const Y &amp;Val)</div><div class="ttdef"><b>Definition:</b> <a href="Casting_8h_source.html#l00266">Casting.h:266</a></div></div>
<div class="ttc" id="classllvm_1_1User_html_a2f81e0c1fc6554df7ad2eafabf5fc5a5"><div class="ttname"><a href="classllvm_1_1User.html#a2f81e0c1fc6554df7ad2eafabf5fc5a5">llvm::User::getNumOperands</a></div><div class="ttdeci">unsigned getNumOperands() const </div><div class="ttdef"><b>Definition:</b> <a href="User_8h_source.html#l00108">User.h:108</a></div></div>
<div class="ttc" id="DataLayout_8h_html"><div class="ttname"><a href="DataLayout_8h.html">DataLayout.h</a></div></div>
<div class="ttc" id="classllvm_1_1AliasAnalysis_html_a7130fcc16699c8bad067d00ccc5a8c95"><div class="ttname"><a href="classllvm_1_1AliasAnalysis.html#a7130fcc16699c8bad067d00ccc5a8c95">llvm::AliasAnalysis::getLocationForSource</a></div><div class="ttdeci">static Location getLocationForSource(const MemTransferInst *MTI)</div><div class="ttdef"><b>Definition:</b> <a href="AliasAnalysis_8cpp_source.html#l00260">AliasAnalysis.cpp:260</a></div></div>
<div class="ttc" id="classllvm_1_1StoreInst_html_a1149c7eeefca671ac2685bca13843568"><div class="ttname"><a href="classllvm_1_1StoreInst.html#a1149c7eeefca671ac2685bca13843568">llvm::StoreInst::isSimple</a></div><div class="ttdeci">bool isSimple() const </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00338">Instructions.h:338</a></div></div>
<div class="ttc" id="Debug_8h_html"><div class="ttname"><a href="Debug_8h.html">Debug.h</a></div></div>
<div class="ttc" id="classllvm_1_1CallInst_html"><div class="ttname"><a href="classllvm_1_1CallInst.html">llvm::CallInst</a></div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l01161">Instructions.h:1161</a></div></div>
<div class="ttc" id="classllvm_1_1CallSiteBase_html_addab854f674836e5497dcfafff324e27"><div class="ttname"><a href="classllvm_1_1CallSiteBase.html#addab854f674836e5497dcfafff324e27">llvm::CallSiteBase::setArgument</a></div><div class="ttdeci">void setArgument(unsigned ArgNo, Value *newVal)</div><div class="ttdef"><b>Definition:</b> <a href="CallSite_8h_source.html#l00116">CallSite.h:116</a></div></div>
<div class="ttc" id="namespacellvm_1_1sys_1_1path_html_a33706aab89e700b8f79e1fa6f4f0e3ee"><div class="ttname"><a href="namespacellvm_1_1sys_1_1path.html#a33706aab89e700b8f79e1fa6f4f0e3ee">llvm::sys::path::begin</a></div><div class="ttdeci">const_iterator begin(StringRef path)</div><div class="ttdoc">Get begin iterator over path. </div><div class="ttdef"><b>Definition:</b> <a href="Path_8cpp_source.html#l00173">Path.cpp:173</a></div></div>
<div class="ttc" id="classllvm_1_1MemSetInst_html"><div class="ttname"><a href="classllvm_1_1MemSetInst.html">llvm::MemSetInst</a></div><div class="ttdef"><b>Definition:</b> <a href="IntrinsicInst_8h_source.html#l00190">IntrinsicInst.h:190</a></div></div>
<div class="ttc" id="classllvm_1_1BasicBlock_html_aca229503e4f5c83a187a6a921c625fa8"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#aca229503e4f5c83a187a6a921c625fa8">llvm::BasicBlock::getParent</a></div><div class="ttdeci">const Function * getParent() const </div><div class="ttdoc">Return the enclosing method, or null if none. </div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00116">BasicBlock.h:116</a></div></div>
<div class="ttc" id="LLParser_8cpp_html_a33ece1ef8074506a15d7f86eb76dbae6"><div class="ttname"><a href="LLParser_8cpp.html#a33ece1ef8074506a15d7f86eb76dbae6">F</a></div><div class="ttdeci">F(f)</div></div>
<div class="ttc" id="classllvm_1_1Function_html"><div class="ttname"><a href="classllvm_1_1Function.html">llvm::Function</a></div><div class="ttdef"><b>Definition:</b> <a href="Function_8h_source.html#l00070">Function.h:70</a></div></div>
<div class="ttc" id="classllvm_1_1LoadInst_html"><div class="ttname"><a href="classllvm_1_1LoadInst.html">llvm::LoadInst</a></div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00136">Instructions.h:136</a></div></div>
<div class="ttc" id="classllvm_1_1User_html"><div class="ttname"><a href="classllvm_1_1User.html">llvm::User</a></div><div class="ttdef"><b>Definition:</b> <a href="User_8h_source.html#l00033">User.h:33</a></div></div>
<div class="ttc" id="Statistic_8h_html"><div class="ttname"><a href="Statistic_8h.html">Statistic.h</a></div></div>
<div class="ttc" id="namespacellvm_1_1Intrinsic_html_a73349916f7e54a6b988a3646c7a02e90ab20709bfc1ed1765cd3b43f69bf11edc"><div class="ttname"><a href="namespacellvm_1_1Intrinsic.html#a73349916f7e54a6b988a3646c7a02e90ab20709bfc1ed1765cd3b43f69bf11edc">llvm::Intrinsic::memcpy</a></div><div class="ttdef"><b>Definition:</b> <a href="Intrinsics_8h_source.html#l01260">Intrinsics.h:1260</a></div></div>
<div class="ttc" id="classllvm_1_1Instruction_html_a7bd545769621a0a9d2cfb074f86f4295"><div class="ttname"><a href="classllvm_1_1Instruction.html#a7bd545769621a0a9d2cfb074f86f4295">llvm::Instruction::setDebugLoc</a></div><div class="ttdeci">void setDebugLoc(const DebugLoc &amp;Loc)</div><div class="ttdoc">setDebugLoc - Set the debug location information for this instruction. </div><div class="ttdef"><b>Definition:</b> <a href="Instruction_8h_source.html#l00175">Instruction.h:175</a></div></div>
<div class="ttc" id="classllvm_1_1MemDepResult_html_ae409b288c7f70a6c57586535abed3808"><div class="ttname"><a href="classllvm_1_1MemDepResult.html#ae409b288c7f70a6c57586535abed3808">llvm::MemDepResult::isClobber</a></div><div class="ttdeci">bool isClobber() const </div><div class="ttdef"><b>Definition:</b> <a href="MemoryDependenceAnalysis_8h_source.html#l00128">MemoryDependenceAnalysis.h:128</a></div></div>
<div class="ttc" id="classllvm_1_1CallSiteBase_html_a65a550af73bd99c96abea847916aa4e9"><div class="ttname"><a href="classllvm_1_1CallSiteBase.html#a65a550af73bd99c96abea847916aa4e9">llvm::CallSiteBase::getArgument</a></div><div class="ttdeci">ValTy * getArgument(unsigned ArgNo) const </div><div class="ttdef"><b>Definition:</b> <a href="CallSite_8h_source.html#l00111">CallSite.h:111</a></div></div>
<div class="ttc" id="classllvm_1_1generic__gep__type__iterator_html"><div class="ttname"><a href="classllvm_1_1generic__gep__type__iterator.html">llvm::generic_gep_type_iterator</a></div><div class="ttdef"><b>Definition:</b> <a href="GetElementPtrTypeIterator_8h_source.html#l00023">GetElementPtrTypeIterator.h:23</a></div></div>
<div class="ttc" id="classllvm_1_1Value_html_ad452febc1ac0b394876e640ec03ffa38"><div class="ttname"><a href="classllvm_1_1Value.html#ad452febc1ac0b394876e640ec03ffa38">llvm::Value::getName</a></div><div class="ttdeci">StringRef getName() const </div><div class="ttdef"><b>Definition:</b> <a href="Value_8cpp_source.html#l00167">Value.cpp:167</a></div></div>
<div class="ttc" id="classllvm_1_1AnalysisUsage_html_ae5c60fd282ee894c87ea02c3f0fcb6d0"><div class="ttname"><a href="classllvm_1_1AnalysisUsage.html#ae5c60fd282ee894c87ea02c3f0fcb6d0">llvm::AnalysisUsage::addRequired</a></div><div class="ttdeci">AnalysisUsage &amp; addRequired()</div><div class="ttdef"><b>Definition:</b> <a href="PassAnalysisSupport_8h_source.html#l00055">PassAnalysisSupport.h:55</a></div></div>
<div class="ttc" id="classllvm_1_1AliasAnalysis_html_a18afcc2fefe15651254db4a92c29f5c4"><div class="ttname"><a href="classllvm_1_1AliasAnalysis.html#a18afcc2fefe15651254db4a92c29f5c4">llvm::AliasAnalysis::isNoAlias</a></div><div class="ttdeci">bool isNoAlias(const Location &amp;LocA, const Location &amp;LocB)</div><div class="ttdef"><b>Definition:</b> <a href="AliasAnalysis_8h_source.html#l00187">AliasAnalysis.h:187</a></div></div>
<div class="ttc" id="PassSupport_8h_html_a14724f1ccf528e73bb29bc9230737967"><div class="ttname"><a href="PassSupport_8h.html#a14724f1ccf528e73bb29bc9230737967">INITIALIZE_PASS_DEPENDENCY</a></div><div class="ttdeci">#define INITIALIZE_PASS_DEPENDENCY(depName)</div><div class="ttdef"><b>Definition:</b> <a href="PassSupport_8h_source.html#l00167">PassSupport.h:167</a></div></div>
<div class="ttc" id="classllvm_1_1DataLayout_html_a35c840104f32575e0d91422cf1ef3ce4"><div class="ttname"><a href="classllvm_1_1DataLayout.html#a35c840104f32575e0d91422cf1ef3ce4">llvm::DataLayout::getStructLayout</a></div><div class="ttdeci">const StructLayout * getStructLayout(StructType *Ty) const </div><div class="ttdef"><b>Definition:</b> <a href="DataLayout_8cpp_source.html#l00445">DataLayout.cpp:445</a></div></div>
<div class="ttc" id="classllvm_1_1ConstantInt_html_af8dde13a97efce293a7b04daf1e208fb"><div class="ttname"><a href="classllvm_1_1ConstantInt.html#af8dde13a97efce293a7b04daf1e208fb">llvm::ConstantInt::getValue</a></div><div class="ttdeci">const APInt &amp; getValue() const </div><div class="ttdoc">Return the constant&amp;#39;s value. </div><div class="ttdef"><b>Definition:</b> <a href="Constants_8h_source.html#l00105">Constants.h:105</a></div></div>
<div class="ttc" id="classllvm_1_1MemMoveInst_html"><div class="ttname"><a href="classllvm_1_1MemMoveInst.html">llvm::MemMoveInst</a></div><div class="ttdef"><b>Definition:</b> <a href="IntrinsicInst_8h_source.html#l00260">IntrinsicInst.h:260</a></div></div>
<div class="ttc" id="classllvm_1_1StructType_html"><div class="ttname"><a href="classllvm_1_1StructType.html">llvm::StructType</a></div><div class="ttdef"><b>Definition:</b> <a href="DerivedTypes_8h_source.html#l00187">DerivedTypes.h:187</a></div></div>
<div class="ttc" id="classllvm_1_1SmallVectorImpl_html"><div class="ttname"><a href="classllvm_1_1SmallVectorImpl.html">llvm::SmallVectorImpl</a></div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l00035">APInt.h:35</a></div></div>
<div class="ttc" id="PassSupport_8h_html_a74ce8276b89067e806f67c45a6d92575"><div class="ttname"><a href="PassSupport_8h.html#a74ce8276b89067e806f67c45a6d92575">INITIALIZE_PASS_END</a></div><div class="ttdeci">#define INITIALIZE_PASS_END(passName, arg, name, cfg, analysis)</div><div class="ttdef"><b>Definition:</b> <a href="PassSupport_8h_source.html#l00172">PassSupport.h:172</a></div></div>
<div class="ttc" id="classllvm_1_1IRBuilder_html"><div class="ttname"><a href="classllvm_1_1IRBuilder.html">llvm::IRBuilder</a></div><div class="ttdoc">This provides a uniform API for creating instructions and inserting them into a basic block: either a...</div><div class="ttdef"><b>Definition:</b> <a href="IRBuilder_8h_source.html#l00421">IRBuilder.h:421</a></div></div>
<div class="ttc" id="classllvm_1_1AliasAnalysis_html"><div class="ttname"><a href="classllvm_1_1AliasAnalysis.html">llvm::AliasAnalysis</a></div><div class="ttdef"><b>Definition:</b> <a href="AliasAnalysis_8h_source.html#l00056">AliasAnalysis.h:56</a></div></div>
<div class="ttc" id="classllvm_1_1MemoryDependenceAnalysis_html"><div class="ttname"><a href="classllvm_1_1MemoryDependenceAnalysis.html">llvm::MemoryDependenceAnalysis</a></div><div class="ttdef"><b>Definition:</b> <a href="MemoryDependenceAnalysis_8h_source.html#l00257">MemoryDependenceAnalysis.h:257</a></div></div>
<div class="ttc" id="namespacefalse_html"><div class="ttname"><a href="namespacefalse.html">false</a></div><div class="ttdef"><b>Definition:</b> <a href="StackSlotColoring_8cpp_source.html#l00126">StackSlotColoring.cpp:126</a></div></div>
<div class="ttc" id="classllvm_1_1AllocaInst_html_a214c60dbb4f1ed467e5a3420db6eefd6"><div class="ttname"><a href="classllvm_1_1AllocaInst.html#a214c60dbb4f1ed467e5a3420db6eefd6">llvm::AllocaInst::getAllocatedType</a></div><div class="ttdeci">Type * getAllocatedType() const </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8cpp_source.html#l00906">Instructions.cpp:906</a></div></div>
<div class="ttc" id="namespacellvm_1_1CallingConv_html_a4f861731fc6dbfdccc05af5968d98974"><div class="ttname"><a href="namespacellvm_1_1CallingConv.html#a4f861731fc6dbfdccc05af5968d98974">llvm::CallingConv::ID</a></div><div class="ttdeci">ID</div><div class="ttdoc">LLVM Calling Convention Representation. </div><div class="ttdef"><b>Definition:</b> <a href="CallingConv_8h_source.html#l00026">CallingConv.h:26</a></div></div>
<div class="ttc" id="classllvm_1_1Instruction_html"><div class="ttname"><a href="classllvm_1_1Instruction.html">llvm::Instruction</a></div><div class="ttdef"><b>Definition:</b> <a href="Instruction_8h_source.html#l00031">Instruction.h:31</a></div></div>
<div class="ttc" id="TargetLibraryInfo_8h_html"><div class="ttname"><a href="TargetLibraryInfo_8h.html">TargetLibraryInfo.h</a></div></div>
<div class="ttc" id="MD5_8cpp_html_ad96b7cf3182ce2ba85e5a7a93b12c441"><div class="ttname"><a href="MD5_8cpp.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a></div><div class="ttdeci">#define G(x, y, z)</div><div class="ttdef"><b>Definition:</b> <a href="MD5_8cpp_source.html#l00052">MD5.cpp:52</a></div></div>
<div class="ttc" id="Dominators_8h_html"><div class="ttname"><a href="Dominators_8h.html">Dominators.h</a></div></div>
<div class="ttc" id="classllvm_1_1ConstantInt_html_a6edd823ba5e4e1effc8280ca8a1194ef"><div class="ttname"><a href="classllvm_1_1ConstantInt.html#a6edd823ba5e4e1effc8280ca8a1194ef">llvm::ConstantInt::getZExtValue</a></div><div class="ttdeci">uint64_t getZExtValue() const </div><div class="ttdoc">Return the zero extended value. </div><div class="ttdef"><b>Definition:</b> <a href="Constants_8h_source.html#l00116">Constants.h:116</a></div></div>
<div class="ttc" id="classllvm_1_1BitCastInst_html"><div class="ttname"><a href="classllvm_1_1BitCastInst.html">llvm::BitCastInst</a></div><div class="ttdoc">This class represents a no-op cast from one type to another. </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l03587">Instructions.h:3587</a></div></div>
<div class="ttc" id="classllvm_1_1AliasAnalysis_html_a83d29c51155787c607268c2659559460a52fc7f344e74f168cb4b4c808dcfde1c"><div class="ttname"><a href="classllvm_1_1AliasAnalysis.html#a83d29c51155787c607268c2659559460a52fc7f344e74f168cb4b4c808dcfde1c">llvm::AliasAnalysis::NoModRef</a></div><div class="ttdef"><b>Definition:</b> <a href="AliasAnalysis_8h_source.html#l00231">AliasAnalysis.h:231</a></div></div>
<div class="ttc" id="namespacellvm_1_1Intrinsic_html_a842176a2c8c60a94bc788454b0828ea2"><div class="ttname"><a href="namespacellvm_1_1Intrinsic.html#a842176a2c8c60a94bc788454b0828ea2">llvm::Intrinsic::getDeclaration</a></div><div class="ttdeci">Function * getDeclaration(Module *M, ID id, ArrayRef&lt; Type * &gt; Tys=None)</div><div class="ttdef"><b>Definition:</b> <a href="Function_8cpp_source.html#l00683">Function.cpp:683</a></div></div>
<div class="ttc" id="classllvm_1_1StoreInst_html"><div class="ttname"><a href="classllvm_1_1StoreInst.html">llvm::StoreInst</a></div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00255">Instructions.h:255</a></div></div>
<div class="ttc" id="classllvm_1_1CallSiteBase_html_af23ecc474bd52056428ee09ebe9f044f"><div class="ttname"><a href="classllvm_1_1CallSiteBase.html#af23ecc474bd52056428ee09ebe9f044f">llvm::CallSiteBase::getParamAlignment</a></div><div class="ttdeci">uint16_t getParamAlignment(uint16_t i) const </div><div class="ttdoc">Extract the alignment for a call or parameter (0=unknown). </div><div class="ttdef"><b>Definition:</b> <a href="CallSite_8h_source.html#l00197">CallSite.h:197</a></div></div>
<div class="ttc" id="classllvm_1_1Function_html_a88a5e60837674780a9d812d661897ac5"><div class="ttname"><a href="classllvm_1_1Function.html#a88a5e60837674780a9d812d661897ac5">llvm::Function::begin</a></div><div class="ttdeci">iterator begin()</div><div class="ttdef"><b>Definition:</b> <a href="Function_8h_source.html#l00395">Function.h:395</a></div></div>
<div class="ttc" id="classllvm_1_1DominatorTree_html"><div class="ttname"><a href="classllvm_1_1DominatorTree.html">llvm::DominatorTree</a></div><div class="ttdef"><b>Definition:</b> <a href="Dominators_8h_source.html#l00740">Dominators.h:740</a></div></div>
<div class="ttc" id="Target_2ARM_2README_8txt_html_a86bd01c89bf19da5edcd8fd83325d6f6"><div class="ttname"><a href="Target_2ARM_2README_8txt.html#a86bd01c89bf19da5edcd8fd83325d6f6">cpy</a></div><div class="ttdeci">void cpy(struct foo *a, struct foo *b)</div><div class="ttdef"><b>Definition:</b> <a href="Target_2ARM_2README_8txt_source.html#l00122">Target/ARM/README.txt:122</a></div></div>
<div class="ttc" id="classllvm_1_1StructLayout_html_ae10c4483372a357a0d3411b3d64be10c"><div class="ttname"><a href="classllvm_1_1StructLayout.html#ae10c4483372a357a0d3411b3d64be10c">llvm::StructLayout::getElementOffset</a></div><div class="ttdeci">uint64_t getElementOffset(unsigned Idx) const </div><div class="ttdef"><b>Definition:</b> <a href="DataLayout_8h_source.html#l00442">DataLayout.h:442</a></div></div>
<div class="ttc" id="classllvm_1_1GetElementPtrInst_html"><div class="ttname"><a href="classllvm_1_1GetElementPtrInst.html">llvm::GetElementPtrInst</a></div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00709">Instructions.h:709</a></div></div>
<div class="ttc" id="README__ALTIVEC_8txt_html_a9aacd9146afe44bf656cd664e2a88c8c"><div class="ttname"><a href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a></div><div class="ttdeci">(vector float) vec_cmpeq(*A,*B) C</div><div class="ttdef"><b>Definition:</b> <a href="README__ALTIVEC_8txt_source.html#l00091">README_ALTIVEC.txt:91</a></div></div>
<div class="ttc" id="classllvm_1_1sys_1_1path_1_1const__iterator_html_a8a503d1cbee10d1b8c8f5ac2a03b90df"><div class="ttname"><a href="classllvm_1_1sys_1_1path_1_1const__iterator.html#a8a503d1cbee10d1b8c8f5ac2a03b90df">llvm::sys::path::const_iterator::end</a></div><div class="ttdeci">friend const_iterator end(StringRef path)</div><div class="ttdoc">Get end iterator over path. </div><div class="ttdef"><b>Definition:</b> <a href="Path_8cpp_source.html#l00181">Path.cpp:181</a></div></div>
<div class="ttc" id="classllvm_1_1StoreInst_html_a3084f1dd69d67e1965fd1fe721a69f2e"><div class="ttname"><a href="classllvm_1_1StoreInst.html#a3084f1dd69d67e1965fd1fe721a69f2e">llvm::StoreInst::getAlignment</a></div><div class="ttdeci">unsigned getAlignment() const </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00301">Instructions.h:301</a></div></div>
<div class="ttc" id="MemCpyOptimizer_8cpp_html_ae52446f66e9897ccb698024fadedcdbb"><div class="ttname"><a href="MemCpyOptimizer_8cpp.html#ae52446f66e9897ccb698024fadedcdbb">STATISTIC</a></div><div class="ttdeci">STATISTIC(NumMemCpyInstr,&quot;Number of memcpy instructions deleted&quot;)</div></div>
<div class="ttc" id="classllvm_1_1Value_html_ac33c7ecbf1c0f1e8bf93403522e6976b"><div class="ttname"><a href="classllvm_1_1Value.html#ac33c7ecbf1c0f1e8bf93403522e6976b">llvm::Value::use_iterator</a></div><div class="ttdeci">value_use_iterator&lt; User &gt; use_iterator</div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00146">Value.h:146</a></div></div>
<div class="ttc" id="classllvm_1_1Type_html"><div class="ttname"><a href="classllvm_1_1Type.html">llvm::Type</a></div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00044">Type.h:44</a></div></div>
<div class="ttc" id="classllvm_1_1CallSiteBase_html_ae4c67f835911559821939fb23a2e7aff"><div class="ttname"><a href="classllvm_1_1CallSiteBase.html#ae4c67f835911559821939fb23a2e7aff">llvm::CallSiteBase::getInstruction</a></div><div class="ttdeci">InstrTy * getInstruction() const </div><div class="ttdef"><b>Definition:</b> <a href="CallSite_8h_source.html#l00079">CallSite.h:79</a></div></div>
<div class="ttc" id="MemCpyOptimizer_8cpp_html_a6ee1a66b9681fb20cdc5f8ec6b59bef5"><div class="ttname"><a href="MemCpyOptimizer_8cpp.html#a6ee1a66b9681fb20cdc5f8ec6b59bef5">IsPointerOffset</a></div><div class="ttdeci">static bool IsPointerOffset(Value *Ptr1, Value *Ptr2, int64_t &amp;Offset, const DataLayout &amp;TD)</div><div class="ttdef"><b>Definition:</b> <a href="MemCpyOptimizer_8cpp_source.html#l00074">MemCpyOptimizer.cpp:74</a></div></div>
<div class="ttc" id="classllvm_1_1AllocaInst_html_ad441932c20e5b9ba36c8c72a6c7f5ec3"><div class="ttname"><a href="classllvm_1_1AllocaInst.html#ad441932c20e5b9ba36c8c72a6c7f5ec3">llvm::AllocaInst::getAlignment</a></div><div class="ttdeci">unsigned getAlignment() const </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00103">Instructions.h:103</a></div></div>
<div class="ttc" id="classllvm_1_1MemIntrinsic_html_a3ec0c47a5532e568d54c8d452dfb58df"><div class="ttname"><a href="classllvm_1_1MemIntrinsic.html#a3ec0c47a5532e568d54c8d452dfb58df">llvm::MemIntrinsic::getRawDest</a></div><div class="ttdeci">Value * getRawDest() const </div><div class="ttdef"><b>Definition:</b> <a href="IntrinsicInst_8h_source.html#l00120">IntrinsicInst.h:120</a></div></div>
<div class="ttc" id="Metadata_8cpp_html_a08f662c95a7832a8687ba787e0fdf672"><div class="ttname"><a href="Metadata_8cpp.html#a08f662c95a7832a8687ba787e0fdf672">addRange</a></div><div class="ttdeci">static void addRange(SmallVectorImpl&lt; Value * &gt; &amp;EndPoints, ConstantInt *Low, ConstantInt *High)</div><div class="ttdef"><b>Definition:</b> <a href="Metadata_8cpp_source.html#l00444">Metadata.cpp:444</a></div></div>
<div class="ttc" id="classllvm_1_1AnalysisUsage_html"><div class="ttname"><a href="classllvm_1_1AnalysisUsage.html">llvm::AnalysisUsage</a></div><div class="ttdef"><b>Definition:</b> <a href="PassAnalysisSupport_8h_source.html#l00037">PassAnalysisSupport.h:37</a></div></div>
<div class="ttc" id="namespacellvm_html_a493e8685b388eb24064e2eb6c90e88d6"><div class="ttname"><a href="namespacellvm.html#a493e8685b388eb24064e2eb6c90e88d6">llvm::createMemCpyOptPass</a></div><div class="ttdeci">FunctionPass * createMemCpyOptPass()</div><div class="ttdef"><b>Definition:</b> <a href="MemCpyOptimizer_8cpp_source.html#l00352">MemCpyOptimizer.cpp:352</a></div></div>
<div class="ttc" id="classllvm_1_1AliasAnalysis_html_af02eef65834a820ff7a4f05a831d39ea"><div class="ttname"><a href="classllvm_1_1AliasAnalysis.html#af02eef65834a820ff7a4f05a831d39ea">llvm::AliasAnalysis::getLocationForDest</a></div><div class="ttdeci">static Location getLocationForDest(const MemIntrinsic *MI)</div><div class="ttdef"><b>Definition:</b> <a href="AliasAnalysis_8cpp_source.html#l00273">AliasAnalysis.cpp:273</a></div></div>
<div class="ttc" id="classllvm_1_1FunctionPass_html"><div class="ttname"><a href="classllvm_1_1FunctionPass.html">llvm::FunctionPass</a></div><div class="ttdef"><b>Definition:</b> <a href="Pass_8h_source.html#l00293">Pass.h:293</a></div></div>
<div class="ttc" id="namespacellvm_html_aa5df040b72433a3c103527073f092624"><div class="ttname"><a href="namespacellvm.html#aa5df040b72433a3c103527073f092624">llvm::MemCpy</a></div><div class="ttdeci">static MemCpyOpt MemCpy</div><div class="ttdef"><b>Definition:</b> <a href="SimplifyLibCalls_8cpp_source.html#l01972">SimplifyLibCalls.cpp:1972</a></div></div>
<div class="ttc" id="classllvm_1_1User_html_a997ff6a1758bf732b9b263fc61011644"><div class="ttname"><a href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">llvm::User::getOperand</a></div><div class="ttdeci">Value * getOperand(unsigned i) const </div><div class="ttdef"><b>Definition:</b> <a href="User_8h_source.html#l00088">User.h:88</a></div></div>
<div class="ttc" id="classllvm_1_1CastInst_html_acd347d07162a5a80dac61e5bdea9616c"><div class="ttname"><a href="classllvm_1_1CastInst.html#acd347d07162a5a80dac61e5bdea9616c">llvm::CastInst::CreatePointerCast</a></div><div class="ttdeci">static CastInst * CreatePointerCast(Value *S, Type *Ty, const Twine &amp;Name, BasicBlock *InsertAtEnd)</div><div class="ttdoc">Create a BitCast or a PtrToInt cast instruction. </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8cpp_source.html#l02442">Instructions.cpp:2442</a></div></div>
<div class="ttc" id="namespacellvm_1_1LibFunc_html_abf8f6830387f338fed0bce2e65108c6fa9e02525b88a00a1d0e8dcded032acbee"><div class="ttname"><a href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fa9e02525b88a00a1d0e8dcded032acbee">llvm::LibFunc::memmove</a></div><div class="ttdoc">void *memmove(void *s1, const void *s2, size_t n); </div><div class="ttdef"><b>Definition:</b> <a href="TargetLibraryInfo_8h_source.html#l00392">TargetLibraryInfo.h:392</a></div></div>
<div class="ttc" id="structllvm_1_1AliasAnalysis_1_1Location_html"><div class="ttname"><a href="structllvm_1_1AliasAnalysis_1_1Location.html">llvm::AliasAnalysis::Location</a></div><div class="ttdoc">Location - A description of a memory location. </div><div class="ttdef"><b>Definition:</b> <a href="AliasAnalysis_8h_source.html#l00106">AliasAnalysis.h:106</a></div></div>
<div class="ttc" id="classllvm_1_1DominatorTree_html_a6fe9272dc67fe2ff4cafc33b895c4a6c"><div class="ttname"><a href="classllvm_1_1DominatorTree.html#a6fe9272dc67fe2ff4cafc33b895c4a6c">llvm::DominatorTree::dominates</a></div><div class="ttdeci">bool dominates(const DomTreeNode *A, const DomTreeNode *B) const </div><div class="ttdef"><b>Definition:</b> <a href="Dominators_8h_source.html#l00801">Dominators.h:801</a></div></div>
<div class="ttc" id="PassSupport_8h_html_af0564bcdde2dd4400c670ca278c6035f"><div class="ttname"><a href="PassSupport_8h.html#af0564bcdde2dd4400c670ca278c6035f">INITIALIZE_AG_DEPENDENCY</a></div><div class="ttdeci">#define INITIALIZE_AG_DEPENDENCY(depName)</div><div class="ttdef"><b>Definition:</b> <a href="PassSupport_8h_source.html#l00169">PassSupport.h:169</a></div></div>
<div class="ttc" id="classllvm_1_1GlobalVariable_html"><div class="ttname"><a href="classllvm_1_1GlobalVariable.html">llvm::GlobalVariable</a></div><div class="ttdef"><b>Definition:</b> <a href="GlobalVariable_8h_source.html#l00035">GlobalVariable.h:35</a></div></div>
<div class="ttc" id="MemCpyOptimizer_8cpp_html_a66eab13a579e3333b0ab115781f01a0d"><div class="ttname"><a href="MemCpyOptimizer_8cpp.html#a66eab13a579e3333b0ab115781f01a0d">INITIALIZE_PASS_BEGIN</a></div><div class="ttdeci">INITIALIZE_PASS_BEGIN(MemCpyOpt,&quot;memcpyopt&quot;,&quot;MemCpy Optimization&quot;, false, false) INITIALIZE_PASS_END(MemCpyOpt</div></div>
<div class="ttc" id="classllvm_1_1MemDepResult_html"><div class="ttname"><a href="classllvm_1_1MemDepResult.html">llvm::MemDepResult</a></div><div class="ttdef"><b>Definition:</b> <a href="MemoryDependenceAnalysis_8h_source.html#l00040">MemoryDependenceAnalysis.h:40</a></div></div>
<div class="ttc" id="MemCpyOptimizer_8cpp_html_a7530261f1f6c8e08347b485f8ffe90b4"><div class="ttname"><a href="MemCpyOptimizer_8cpp.html#a7530261f1f6c8e08347b485f8ffe90b4">memcpyopt</a></div><div class="ttdeci">memcpyopt</div><div class="ttdef"><b>Definition:</b> <a href="MemCpyOptimizer_8cpp_source.html#l00360">MemCpyOptimizer.cpp:360</a></div></div>
<div class="ttc" id="classllvm_1_1DataLayout_html_abb381519d34dcb9ccf673bf7689d0721"><div class="ttname"><a href="classllvm_1_1DataLayout.html#abb381519d34dcb9ccf673bf7689d0721">llvm::DataLayout::getABITypeAlignment</a></div><div class="ttdeci">unsigned getABITypeAlignment(Type *Ty) const </div><div class="ttdef"><b>Definition:</b> <a href="DataLayout_8cpp_source.html#l00582">DataLayout.cpp:582</a></div></div>
<div class="ttc" id="classllvm_1_1ilist__iterator_html"><div class="ttname"><a href="classllvm_1_1ilist__iterator.html">llvm::ilist_iterator</a></div><div class="ttdef"><b>Definition:</b> <a href="ilist_8h_source.html#l00050">ilist.h:50</a></div></div>
<div class="ttc" id="classllvm_1_1ConstantInt_html"><div class="ttname"><a href="classllvm_1_1ConstantInt.html">llvm::ConstantInt</a></div><div class="ttdoc">Class for constant integers. </div><div class="ttdef"><b>Definition:</b> <a href="Constants_8h_source.html#l00051">Constants.h:51</a></div></div>
<div class="ttc" id="classllvm_1_1CallSiteBase_html_a2b51df7c4694230be653c4b5a3186029"><div class="ttname"><a href="classllvm_1_1CallSiteBase.html#a2b51df7c4694230be653c4b5a3186029">llvm::CallSiteBase::isByValArgument</a></div><div class="ttdeci">bool isByValArgument(unsigned ArgNo) const </div><div class="ttdoc">Determine whether this argument is passed by value. </div><div class="ttdef"><b>Definition:</b> <a href="CallSite_8h_source.html#l00256">CallSite.h:256</a></div></div>
<div class="ttc" id="classllvm_1_1DataLayout_html_a1d6fcc02e91ba24510aba42660c90e29"><div class="ttname"><a href="classllvm_1_1DataLayout.html#a1d6fcc02e91ba24510aba42660c90e29">llvm::DataLayout::getTypeAllocSize</a></div><div class="ttdeci">uint64_t getTypeAllocSize(Type *Ty) const </div><div class="ttdef"><b>Definition:</b> <a href="DataLayout_8h_source.html#l00326">DataLayout.h:326</a></div></div>
<div class="ttc" id="Target_2README_8txt_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">i</div><div class="ttdef"><b>Definition:</b> <a href="Target_2README_8txt_source.html#l00029">Target/README.txt:29</a></div></div>
<div class="ttc" id="classllvm_1_1MemIntrinsic_html_ad8bf46d46e8f14bc23bd30df57cc9a77"><div class="ttname"><a href="classllvm_1_1MemIntrinsic.html#ad8bf46d46e8f14bc23bd30df57cc9a77">llvm::MemIntrinsic::getDest</a></div><div class="ttdeci">Value * getDest() const </div><div class="ttdef"><b>Definition:</b> <a href="IntrinsicInst_8h_source.html#l00145">IntrinsicInst.h:145</a></div></div>
<div class="ttc" id="classllvm_1_1sys_1_1path_1_1const__iterator_html_a79fe46db1f88832bc90447c6ec541cf2"><div class="ttname"><a href="classllvm_1_1sys_1_1path_1_1const__iterator.html#a79fe46db1f88832bc90447c6ec541cf2">llvm::sys::path::const_iterator::begin</a></div><div class="ttdeci">friend const_iterator begin(StringRef path)</div><div class="ttdoc">Get begin iterator over path. </div><div class="ttdef"><b>Definition:</b> <a href="Path_8cpp_source.html#l00173">Path.cpp:173</a></div></div>
<div class="ttc" id="Target_2README_8txt_html_a2a2df5a25b9c703e74e82b48a75d0c3d"><div class="ttname"><a href="Target_2README_8txt.html#a2a2df5a25b9c703e74e82b48a75d0c3d">C1</a></div><div class="ttdeci">instcombine should handle this C2 when C1</div><div class="ttdef"><b>Definition:</b> <a href="Target_2README_8txt_source.html#l00300">Target/README.txt:300</a></div></div>
<div class="ttc" id="classllvm_1_1SmallVector_html"><div class="ttname"><a href="classllvm_1_1SmallVector.html">llvm::SmallVector</a></div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00880">SmallVector.h:880</a></div></div>
<div class="ttc" id="classllvm_1_1Value_html_a0cf3748dba54f931bb1241ae4adc76bc"><div class="ttname"><a href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">llvm::Value::getType</a></div><div class="ttdeci">Type * getType() const </div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00111">Value.h:111</a></div></div>
<div class="ttc" id="classllvm_1_1TargetLibraryInfo_html"><div class="ttname"><a href="classllvm_1_1TargetLibraryInfo.html">llvm::TargetLibraryInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="TargetLibraryInfo_8h_source.html#l00657">TargetLibraryInfo.h:657</a></div></div>
<div class="ttc" id="classllvm_1_1MemIntrinsic_html_abad10f74789466601c7a025540c1c072"><div class="ttname"><a href="classllvm_1_1MemIntrinsic.html#abad10f74789466601c7a025540c1c072">llvm::MemIntrinsic::getLength</a></div><div class="ttdeci">Value * getLength() const </div><div class="ttdef"><b>Definition:</b> <a href="IntrinsicInst_8h_source.html#l00122">IntrinsicInst.h:122</a></div></div>
<div class="ttc" id="classllvm_1_1Value_html_a38ea12c04523d63adda732b9c5d6da0a"><div class="ttname"><a href="classllvm_1_1Value.html#a38ea12c04523d63adda732b9c5d6da0a">llvm::Value::stripPointerCasts</a></div><div class="ttdeci">Value * stripPointerCasts()</div><div class="ttdoc">Strips off any unneeded pointer casts, all-zero GEPs and aliases from the specified value...</div><div class="ttdef"><b>Definition:</b> <a href="Value_8cpp_source.html#l00385">Value.cpp:385</a></div></div>
<div class="ttc" id="namespacellvm_1_1LibFunc_html_abf8f6830387f338fed0bce2e65108c6fa9f7f1b6be1144152902121f2463d0368"><div class="ttname"><a href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fa9f7f1b6be1144152902121f2463d0368">llvm::LibFunc::memset</a></div><div class="ttdoc">void *memset(void *b, int c, size_t len); </div><div class="ttdef"><b>Definition:</b> <a href="TargetLibraryInfo_8h_source.html#l00396">TargetLibraryInfo.h:396</a></div></div>
<div class="ttc" id="classllvm_1_1MemCpyInst_html"><div class="ttname"><a href="classllvm_1_1MemCpyInst.html">llvm::MemCpyInst</a></div><div class="ttdef"><b>Definition:</b> <a href="IntrinsicInst_8h_source.html#l00247">IntrinsicInst.h:247</a></div></div>
<div class="ttc" id="classllvm_1_1ConstantInt_html_ad4ea4748170f687710a54c919dde5625"><div class="ttname"><a href="classllvm_1_1ConstantInt.html#ad4ea4748170f687710a54c919dde5625">llvm::ConstantInt::isZero</a></div><div class="ttdeci">bool isZero() const </div><div class="ttdef"><b>Definition:</b> <a href="Constants_8h_source.html#l00160">Constants.h:160</a></div></div>
<div class="ttc" id="classllvm_1_1AnalysisUsage_html_af11a6ebf7ab3c388234cb6d5378439a3"><div class="ttname"><a href="classllvm_1_1AnalysisUsage.html#af11a6ebf7ab3c388234cb6d5378439a3">llvm::AnalysisUsage::setPreservesCFG</a></div><div class="ttdeci">void setPreservesCFG()</div><div class="ttdef"><b>Definition:</b> <a href="Pass_8cpp_source.html#l00249">Pass.cpp:249</a></div></div>
<div class="ttc" id="namespacellvm_html_a7c46c742c31be54870e2038048e6b391"><div class="ttname"><a href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">llvm::dbgs</a></div><div class="ttdeci">raw_ostream &amp; dbgs()</div><div class="ttdoc">dbgs - Return a circular-buffered debug stream. </div><div class="ttdef"><b>Definition:</b> <a href="Debug_8cpp_source.html#l00101">Debug.cpp:101</a></div></div>
<div class="ttc" id="classllvm_1_1GEPOperator_html"><div class="ttname"><a href="classllvm_1_1GEPOperator.html">llvm::GEPOperator</a></div><div class="ttdef"><b>Definition:</b> <a href="Operator_8h_source.html#l00357">Operator.h:357</a></div></div>
<div class="ttc" id="GlobalVariable_8h_html"><div class="ttname"><a href="GlobalVariable_8h.html">GlobalVariable.h</a></div></div>
<div class="ttc" id="CodeGen_2README_8txt_html_a09776db24cf586ec9f1e18f3bae14099"><div class="ttname"><a href="CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a></div><div class="ttdeci">Common register allocation spilling lr str ldr sxth r3 ldr mla r4 can lr mov lr str ldr sxth r3 mla r4 and then merge mul and lr str ldr sxth r3 mla r4 It also increase the likelihood the store may become dead bb27 Successors according to LLVM BB</div><div class="ttdef"><b>Definition:</b> <a href="CodeGen_2README_8txt_source.html#l00036">CodeGen/README.txt:36</a></div></div>
<div class="ttc" id="classllvm_1_1DataLayout_html_ac57ff4f484955ce8b36168c3dd29494b"><div class="ttname"><a href="classllvm_1_1DataLayout.html#ac57ff4f484955ce8b36168c3dd29494b">llvm::DataLayout::getLargestLegalIntTypeSize</a></div><div class="ttdeci">unsigned getLargestLegalIntTypeSize() const </div><div class="ttdef"><b>Definition:</b> <a href="DataLayout_8cpp_source.html#l00632">DataLayout.cpp:632</a></div></div>
<div class="ttc" id="MemCpyOptimizer_8cpp_html_a550b438e70324776ea328ac8248dc268"><div class="ttname"><a href="MemCpyOptimizer_8cpp.html#a550b438e70324776ea328ac8248dc268">GetOffsetFromIndex</a></div><div class="ttdeci">static int64_t GetOffsetFromIndex(const GEPOperator *GEP, unsigned Idx, bool &amp;VariableIdxFound, const DataLayout &amp;TD)</div><div class="ttdef"><b>Definition:</b> <a href="MemCpyOptimizer_8cpp_source.html#l00041">MemCpyOptimizer.cpp:41</a></div></div>
<div class="ttc" id="MemCpyOptimizer_8cpp_html_a4c36a0753cd006d97b1aee018fe423bc"><div class="ttname"><a href="MemCpyOptimizer_8cpp.html#a4c36a0753cd006d97b1aee018fe423bc">Optimization</a></div><div class="ttdeci">MemCpy Optimization</div><div class="ttdef"><b>Definition:</b> <a href="MemCpyOptimizer_8cpp_source.html#l00360">MemCpyOptimizer.cpp:360</a></div></div>
<div class="ttc" id="classllvm_1_1AliasAnalysis_html_aec9dbab832cd8052f85cd2a9dbb3816e"><div class="ttname"><a href="classllvm_1_1AliasAnalysis.html#aec9dbab832cd8052f85cd2a9dbb3816e">llvm::AliasAnalysis::getLocation</a></div><div class="ttdeci">Location getLocation(const LoadInst *LI)</div><div class="ttdef"><b>Definition:</b> <a href="AliasAnalysis_8cpp_source.html#l00227">AliasAnalysis.cpp:227</a></div></div>
<div class="ttc" id="classllvm_1_1Value_html_a413abcab8dbc3900fc2fde96a5d8fca6"><div class="ttname"><a href="classllvm_1_1Value.html#a413abcab8dbc3900fc2fde96a5d8fca6">llvm::Value::use_begin</a></div><div class="ttdeci">use_iterator use_begin()</div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00150">Value.h:150</a></div></div>
<div class="ttc" id="GetElementPtrTypeIterator_8h_html"><div class="ttname"><a href="GetElementPtrTypeIterator_8h.html">GetElementPtrTypeIterator.h</a></div></div>
<div class="ttc" id="classllvm_1_1MemTransferInst_html_a1d23e59237a8e4a61f4af0deb7320104"><div class="ttname"><a href="classllvm_1_1MemTransferInst.html#a1d23e59237a8e4a61f4af0deb7320104">llvm::MemTransferInst::getSource</a></div><div class="ttdeci">Value * getSource() const </div><div class="ttdef"><b>Definition:</b> <a href="IntrinsicInst_8h_source.html#l00222">IntrinsicInst.h:222</a></div></div>
<div class="ttc" id="AliasAnalysis_8h_html"><div class="ttname"><a href="AliasAnalysis_8h.html">AliasAnalysis.h</a></div></div>
<div class="ttc" id="namespacellvm_html_a3dd948f1535b4b28f2a7d45a5c11a34a"><div class="ttname"><a href="namespacellvm.html#a3dd948f1535b4b28f2a7d45a5c11a34a">llvm::getOrEnforceKnownAlignment</a></div><div class="ttdeci">unsigned getOrEnforceKnownAlignment(Value *V, unsigned PrefAlign, const DataLayout *TD=0)</div><div class="ttdef"><b>Definition:</b> <a href="Local_8cpp_source.html#l00922">Local.cpp:922</a></div></div>
<div class="ttc" id="classllvm_1_1CallInst_html_a61f747edd1ca001427e02e02a320b709"><div class="ttname"><a href="classllvm_1_1CallInst.html#a61f747edd1ca001427e02e02a320b709">llvm::CallInst::setCalledFunction</a></div><div class="ttdeci">void setCalledFunction(Value *Fn)</div><div class="ttdoc">setCalledFunction - Set the function called. </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l01367">Instructions.h:1367</a></div></div>
<div class="ttc" id="Transforms_2Scalar_8h_html"><div class="ttname"><a href="Transforms_2Scalar_8h.html">Scalar.h</a></div></div>
<div class="ttc" id="classllvm_1_1MemDepResult_html_a8452eb6508c00e2b6d56926bebc79f57"><div class="ttname"><a href="classllvm_1_1MemDepResult.html#a8452eb6508c00e2b6d56926bebc79f57">llvm::MemDepResult::getInst</a></div><div class="ttdeci">Instruction * getInst() const </div><div class="ttdef"><b>Definition:</b> <a href="MemoryDependenceAnalysis_8h_source.html#l00158">MemoryDependenceAnalysis.h:158</a></div></div>
<div class="ttc" id="MD5_8cpp_html_ac0eafdc9ee161b71e7af98af736952fd"><div class="ttname"><a href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a></div><div class="ttdeci">#define I(x, y, z)</div><div class="ttdef"><b>Definition:</b> <a href="MD5_8cpp_source.html#l00054">MD5.cpp:54</a></div></div>
<div class="ttc" id="classllvm_1_1IRBuilderBase_html_a58f62481bd3a4bfc5d07102fe857741a"><div class="ttname"><a href="classllvm_1_1IRBuilderBase.html#a58f62481bd3a4bfc5d07102fe857741a">llvm::IRBuilderBase::CreateMemSet</a></div><div class="ttdeci">CallInst * CreateMemSet(Value *Ptr, Value *Val, uint64_t Size, unsigned Align, bool isVolatile=false, MDNode *TBAATag=0)</div><div class="ttdoc">Create and insert a memset to the specified pointer and the specified value. </div><div class="ttdef"><b>Definition:</b> <a href="IRBuilder_8h_source.html#l00353">IRBuilder.h:353</a></div></div>
<div class="ttc" id="ValueTracking_8h_html"><div class="ttname"><a href="ValueTracking_8h.html">ValueTracking.h</a></div></div>
<div class="ttc" id="classllvm_1_1DataLayout_html_a4b979cd93852fd44c48851c94ee00758"><div class="ttname"><a href="classllvm_1_1DataLayout.html#a4b979cd93852fd44c48851c94ee00758">llvm::DataLayout::getTypeStoreSize</a></div><div class="ttdeci">uint64_t getTypeStoreSize(Type *Ty) const </div><div class="ttdef"><b>Definition:</b> <a href="DataLayout_8h_source.html#l00311">DataLayout.h:311</a></div></div>
<div class="ttc" id="IRBuilder_8h_html"><div class="ttname"><a href="IRBuilder_8h.html">IRBuilder.h</a></div></div>
<div class="ttc" id="classllvm_1_1MemTransferInst_html_a26bfca1607622229a625f2db73aed2ba"><div class="ttname"><a href="classllvm_1_1MemTransferInst.html#a26bfca1607622229a625f2db73aed2ba">llvm::MemTransferInst::getRawSource</a></div><div class="ttdeci">Value * getRawSource() const </div><div class="ttdef"><b>Definition:</b> <a href="IntrinsicInst_8h_source.html#l00217">IntrinsicInst.h:217</a></div></div>
<div class="ttc" id="ARMSubtarget_8cpp_html_a4bd80d4e433d9f72af26b364036900dc"><div class="ttname"><a href="ARMSubtarget_8cpp.html#a4bd80d4e433d9f72af26b364036900dc">Align</a></div><div class="ttdeci">static cl::opt&lt; AlignMode &gt; Align(cl::desc(&quot;Load/store alignment support&quot;), cl::Hidden, cl::init(DefaultAlign), cl::values(clEnumValN(DefaultAlign,&quot;arm-default-align&quot;,&quot;Generate unaligned accesses only on hardware/OS &quot;&quot;combinations that are known to support them&quot;), clEnumValN(StrictAlign,&quot;arm-strict-align&quot;,&quot;Disallow all unaligned memory accesses&quot;), clEnumValN(NoStrictAlign,&quot;arm-no-strict-align&quot;,&quot;Allow unaligned memory accesses&quot;), clEnumValEnd))</div></div>
<div class="ttc" id="Local_8h_html"><div class="ttname"><a href="Local_8h.html">Local.h</a></div></div>
<div class="ttc" id="namespacellvm_html_ad2abfd9d12d19ae450d3db0b6ecadc08"><div class="ttname"><a href="namespacellvm.html#ad2abfd9d12d19ae450d3db0b6ecadc08">llvm::initializeMemCpyOptPass</a></div><div class="ttdeci">void initializeMemCpyOptPass(PassRegistry &amp;)</div></div>
<div class="ttc" id="classllvm_1_1GlobalValue_html_a9e1fc23a17e97d2d1732e753ae9251ac"><div class="ttname"><a href="classllvm_1_1GlobalValue.html#a9e1fc23a17e97d2d1732e753ae9251ac">llvm::GlobalValue::getParent</a></div><div class="ttdeci">Module * getParent()</div><div class="ttdef"><b>Definition:</b> <a href="GlobalValue_8h_source.html#l00286">GlobalValue.h:286</a></div></div>
<div class="ttc" id="classllvm_1_1Value_html"><div class="ttname"><a href="classllvm_1_1Value.html">llvm::Value</a></div><div class="ttdoc">LLVM Value Representation. </div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00066">Value.h:66</a></div></div>
<div class="ttc" id="classllvm_1_1AliasAnalysis_html_a83d29c51155787c607268c2659559460"><div class="ttname"><a href="classllvm_1_1AliasAnalysis.html#a83d29c51155787c607268c2659559460">llvm::AliasAnalysis::ModRefResult</a></div><div class="ttdeci">ModRefResult</div><div class="ttdef"><b>Definition:</b> <a href="AliasAnalysis_8h_source.html#l00231">AliasAnalysis.h:231</a></div></div>
<div class="ttc" id="Target_2X86_2README_8txt_html_ac88fe1d3a61b056a4f64fbbb156a62ff"><div class="ttname"><a href="Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a></div><div class="ttdeci">We currently emits eax Perhaps this is what we really should generate is Is imull three or four cycles eax eax The current instruction priority is based on pattern complexity The former is more complex because it folds a load so the latter will not be emitted Perhaps we should use AddedComplexity to give LEA32r a higher priority We should always try to match LEA first since the LEA matching code does some estimate to determine whether the match is profitable if we care more about code then imull is better It s two bytes shorter than movl leal On a Pentium M</div><div class="ttdef"><b>Definition:</b> <a href="Target_2X86_2README_8txt_source.html#l00297">Target/X86/README.txt:297</a></div></div>
<div class="ttc" id="SmallVector_8h_html"><div class="ttname"><a href="SmallVector_8h.html">SmallVector.h</a></div></div>
<div class="ttc" id="classllvm_1_1AllocaInst_html_a642f52c0f081ad0de10258c1d8d67b23"><div class="ttname"><a href="classllvm_1_1AllocaInst.html#a642f52c0f081ad0de10258c1d8d67b23">llvm::AllocaInst::getArraySize</a></div><div class="ttdeci">const Value * getArraySize() const </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00086">Instructions.h:86</a></div></div>
<div class="ttc" id="classllvm_1_1Type_html_a9dc5111b1a9b1d5c4652d50f74fe850b"><div class="ttname"><a href="classllvm_1_1Type.html#a9dc5111b1a9b1d5c4652d50f74fe850b">llvm::Type::isSized</a></div><div class="ttdeci">bool isSized() const </div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00278">Type.h:278</a></div></div>
<div class="ttc" id="Debug_8h_html_aef41e8aaf4c60819b30faf396cdf4978"><div class="ttname"><a href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a></div><div class="ttdeci">#define DEBUG(X)</div><div class="ttdef"><b>Definition:</b> <a href="Debug_8h_source.html#l00097">Debug.h:97</a></div></div>
<div class="ttc" id="raw__ostream_8h_html"><div class="ttname"><a href="raw__ostream_8h.html">raw_ostream.h</a></div></div>
<div class="ttc" id="classllvm_1_1AliasAnalysis_html_a650241dcf00905f4085c878ec988e27f"><div class="ttname"><a href="classllvm_1_1AliasAnalysis.html#a650241dcf00905f4085c878ec988e27f">llvm::AliasAnalysis::callCapturesBefore</a></div><div class="ttdeci">ModRefResult callCapturesBefore(const Instruction *I, const AliasAnalysis::Location &amp;MemLoc, DominatorTree *DT)</div><div class="ttdef"><b>Definition:</b> <a href="AliasAnalysis_8cpp_source.html#l00416">AliasAnalysis.cpp:416</a></div></div>
<div class="ttc" id="classllvm_1_1CallSite_html"><div class="ttname"><a href="classllvm_1_1CallSite.html">llvm::CallSite</a></div><div class="ttdef"><b>Definition:</b> <a href="CallSite_8h_source.html#l00295">CallSite.h:295</a></div></div>
<div class="ttc" id="classllvm_1_1ConstantInt_html_a097c2d42e4deffabe6d54b007ad83367"><div class="ttname"><a href="classllvm_1_1ConstantInt.html#a097c2d42e4deffabe6d54b007ad83367">llvm::ConstantInt::getSExtValue</a></div><div class="ttdeci">int64_t getSExtValue() const </div><div class="ttdoc">Return the sign extended value. </div><div class="ttdef"><b>Definition:</b> <a href="Constants_8h_source.html#l00124">Constants.h:124</a></div></div>
<div class="ttc" id="classllvm_1_1StoreInst_html_ac03c1c093059ea000216af8dd6f2dbf4"><div class="ttname"><a href="classllvm_1_1StoreInst.html#ac03c1c093059ea000216af8dd6f2dbf4">llvm::StoreInst::getPointerOperand</a></div><div class="ttdeci">Value * getPointerOperand()</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00346">Instructions.h:346</a></div></div>
<div class="ttc" id="classllvm_1_1Instruction_html_a9cd49851904f15060edb782ef4dd1b2d"><div class="ttname"><a href="classllvm_1_1Instruction.html#a9cd49851904f15060edb782ef4dd1b2d">llvm::Instruction::getParent</a></div><div class="ttdeci">const BasicBlock * getParent() const </div><div class="ttdef"><b>Definition:</b> <a href="Instruction_8h_source.html#l00052">Instruction.h:52</a></div></div>
<div class="ttc" id="classllvm_1_1AllocaInst_html"><div class="ttname"><a href="classllvm_1_1AllocaInst.html">llvm::AllocaInst</a></div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00058">Instructions.h:58</a></div></div>
<div class="ttc" id="namespacellvm_html_ac828b9b52935f87659a4adf237f820a3"><div class="ttname"><a href="namespacellvm.html#ac828b9b52935f87659a4adf237f820a3">llvm::gep_type_begin</a></div><div class="ttdeci">gep_type_iterator gep_type_begin(const User *GEP)</div><div class="ttdef"><b>Definition:</b> <a href="GetElementPtrTypeIterator_8h_source.html#l00085">GetElementPtrTypeIterator.h:85</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<hr>
<p class="footer">
Generated on Sat Nov 10 2018 23:00:03 for <a href="http://llvm.org/">LLVM</a> by
<a href="http://www.doxygen.org"><img src="doxygen.png" alt="Doxygen"
align="middle" border="0"/>1.8.11</a><br>
Copyright &copy; 2003-2013 University of Illinois at Urbana-Champaign.
All Rights Reserved.</p>
<hr>
<!--#include virtual="/attrib.incl" -->
</body>
</html>
