<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head>
<meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1"/>
<meta name="keywords" content="LLVM,Low Level Virtual Machine,C++,doxygen,API,documentation"/>
<meta name="description" content="C++ source code API documentation for LLVM."/>
<title>LLVM: InstCombineCasts.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head><body>
<p class="title">LLVM API Documentation</p>
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('InstCombineCasts_8cpp_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">InstCombineCasts.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="InstCombineCasts_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//===- InstCombineCasts.cpp -----------------------------------------------===//</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">//                     The LLVM Compiler Infrastructure</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// This file is distributed under the University of Illinois Open Source</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">// License. See LICENSE.TXT for details.</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">// This file implements the visit functions for cast operations.</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="InstCombine_8h.html">InstCombine.h</a>&quot;</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ConstantFolding_8h.html">llvm/Analysis/ConstantFolding.h</a>&quot;</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="DataLayout_8h.html">llvm/IR/DataLayout.h</a>&quot;</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="PatternMatch_8h.html">llvm/Support/PatternMatch.h</a>&quot;</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TargetLibraryInfo_8h.html">llvm/Target/TargetLibraryInfo.h</a>&quot;</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespacellvm.html">llvm</a>;</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="keyword">using namespace </span>PatternMatch;</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">/// DecomposeSimpleLinearExpr - Analyze &#39;Val&#39;, seeing if it is a simple linear</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">/// expression.  If so, decompose it, returning some value X, such that Val is</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">/// X*Scale+Offset.</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00026"></a><span class="lineno"><a class="line" href="InstCombineCasts_8cpp.html#a865e260a33c703d12c88d6fa42f1afb9">   26</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="InstCombineCasts_8cpp.html#a865e260a33c703d12c88d6fa42f1afb9">DecomposeSimpleLinearExpr</a>(<a class="code" href="classllvm_1_1Value.html">Value</a> *Val, <span class="keywordtype">unsigned</span> &amp;Scale,</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;                                        uint64_t &amp;Offset) {</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *CI = dyn_cast&lt;ConstantInt&gt;(Val)) {</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    Offset = CI-&gt;getZExtValue();</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    Scale  = 0;</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1ConstantInt.html#a9105541412dab869e18b3cceebfff07d">ConstantInt::get</a>(Val-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>(), 0);</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  }</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1BinaryOperator.html">BinaryOperator</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = dyn_cast&lt;BinaryOperator&gt;(Val)) {</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <span class="comment">// Cannot look past anything that might overflow.</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <a class="code" href="classllvm_1_1OverflowingBinaryOperator.html">OverflowingBinaryOperator</a> *OBI = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1OverflowingBinaryOperator.html">OverflowingBinaryOperator</a>&gt;(Val);</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <span class="keywordflow">if</span> (OBI &amp;&amp; !OBI-&gt;<a class="code" href="classllvm_1_1OverflowingBinaryOperator.html#abe8af726db43885a1178cf75ed0725d9">hasNoUnsignedWrap</a>() &amp;&amp; !OBI-&gt;<a class="code" href="classllvm_1_1OverflowingBinaryOperator.html#a5a1ebefdf12a23a94f8a135cdfa0cd90">hasNoSignedWrap</a>()) {</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;      Scale = 1;</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;      Offset = 0;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;      <span class="keywordflow">return</span> Val;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    }</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *RHS = dyn_cast&lt;ConstantInt&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getOperand(1))) {</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getOpcode() == Instruction::Shl) {</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;        <span class="comment">// This is a value scaled by &#39;1 &lt;&lt; the shift amt&#39;.</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;        Scale = UINT64_C(1) &lt;&lt; RHS-&gt;getZExtValue();</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;        Offset = 0;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getOperand(0);</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;      }</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getOpcode() == Instruction::Mul) {</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;        <span class="comment">// This value is scaled by &#39;RHS&#39;.</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        Scale = RHS-&gt;getZExtValue();</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        Offset = 0;</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getOperand(0);</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;      }</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getOpcode() == Instruction::Add) {</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        <span class="comment">// We have X+C.  Check to see if we really have (X*C2)+C1,</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        <span class="comment">// where C1 is divisible by C2.</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        <span class="keywordtype">unsigned</span> SubScale;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        <a class="code" href="classllvm_1_1Value.html">Value</a> *SubVal =</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;          <a class="code" href="InstCombineCasts_8cpp.html#a865e260a33c703d12c88d6fa42f1afb9">DecomposeSimpleLinearExpr</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getOperand(0), SubScale, Offset);</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        Offset += RHS-&gt;getZExtValue();</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        Scale = SubScale;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        <span class="keywordflow">return</span> SubVal;</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;      }</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    }</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  }</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  <span class="comment">// Otherwise, we can&#39;t look past this.</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  Scale = 1;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  Offset = 0;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <span class="keywordflow">return</span> Val;</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;}</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment">/// PromoteCastOfAllocation - If we find a cast of an allocation instruction,</span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment">/// try to eliminate the cast by moving the type information into the alloc.</span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment"></span><a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *InstCombiner::PromoteCastOfAllocation(<a class="code" href="classllvm_1_1BitCastInst.html">BitCastInst</a> &amp;CI,</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;                                                   <a class="code" href="classllvm_1_1AllocaInst.html">AllocaInst</a> &amp;AI) {</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  <span class="comment">// This requires DataLayout to get the alloca alignment and size information.</span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  <span class="keywordflow">if</span> (!TD) <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  <a class="code" href="classllvm_1_1PointerType.html">PointerType</a> *PTy = cast&lt;PointerType&gt;(CI.<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>());</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  <a class="code" href="classllvm_1_1IRBuilder.html">BuilderTy</a> AllocaBuilder(*Builder);</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  AllocaBuilder.SetInsertPoint(AI.<a class="code" href="classllvm_1_1Instruction.html#a9cd49851904f15060edb782ef4dd1b2d">getParent</a>(), &amp;AI);</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <span class="comment">// Get the type really allocated and the type casted to.</span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *AllocElTy = AI.<a class="code" href="classllvm_1_1AllocaInst.html#a214c60dbb4f1ed467e5a3420db6eefd6">getAllocatedType</a>();</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *CastElTy = PTy-&gt;<a class="code" href="classllvm_1_1SequentialType.html#a39f2c3a62f293faf11ac28b15bc53359">getElementType</a>();</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  <span class="keywordflow">if</span> (!AllocElTy-&gt;<a class="code" href="classllvm_1_1Type.html#a9dc5111b1a9b1d5c4652d50f74fe850b">isSized</a>() || !CastElTy-&gt;<a class="code" href="classllvm_1_1Type.html#a9dc5111b1a9b1d5c4652d50f74fe850b">isSized</a>()) <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  <span class="keywordtype">unsigned</span> AllocElTyAlign = TD-&gt;getABITypeAlignment(AllocElTy);</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  <span class="keywordtype">unsigned</span> CastElTyAlign = TD-&gt;getABITypeAlignment(CastElTy);</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  <span class="keywordflow">if</span> (CastElTyAlign &lt; AllocElTyAlign) <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  <span class="comment">// If the allocation has multiple uses, only promote it if we are strictly</span></div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  <span class="comment">// increasing the alignment of the resultant allocation.  If we keep it the</span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  <span class="comment">// same, we open the door to infinite loops of various kinds.</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  <span class="keywordflow">if</span> (!AI.<a class="code" href="classllvm_1_1Value.html#a085b82f074c28030fb8e194377ed2d0c">hasOneUse</a>() &amp;&amp; CastElTyAlign == AllocElTyAlign) <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  uint64_t AllocElTySize = TD-&gt;getTypeAllocSize(AllocElTy);</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  uint64_t CastElTySize = TD-&gt;getTypeAllocSize(CastElTy);</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  <span class="keywordflow">if</span> (CastElTySize == 0 || AllocElTySize == 0) <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  <span class="comment">// If the allocation has multiple uses, only promote it if we&#39;re not</span></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  <span class="comment">// shrinking the amount of memory being allocated.</span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  uint64_t AllocElTyStoreSize = TD-&gt;getTypeStoreSize(AllocElTy);</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  uint64_t CastElTyStoreSize = TD-&gt;getTypeStoreSize(CastElTy);</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  <span class="keywordflow">if</span> (!AI.<a class="code" href="classllvm_1_1Value.html#a085b82f074c28030fb8e194377ed2d0c">hasOneUse</a>() &amp;&amp; CastElTyStoreSize &lt; AllocElTyStoreSize) <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <span class="comment">// See if we can satisfy the modulus by pulling a scale out of the array</span></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  <span class="comment">// size argument.</span></div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  <span class="keywordtype">unsigned</span> ArraySizeScale;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  uint64_t ArrayOffset;</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *NumElements = <span class="comment">// See if the array size is a decomposable linear expr.</span></div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <a class="code" href="InstCombineCasts_8cpp.html#a865e260a33c703d12c88d6fa42f1afb9">DecomposeSimpleLinearExpr</a>(AI.<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0), ArraySizeScale, ArrayOffset);</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  <span class="comment">// If we can now satisfy the modulus, by using a non-1 scale, we really can</span></div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  <span class="comment">// do the xform.</span></div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  <span class="keywordflow">if</span> ((AllocElTySize*ArraySizeScale) % CastElTySize != 0 ||</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;      (AllocElTySize*ArrayOffset   ) % CastElTySize != 0) <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  <span class="keywordtype">unsigned</span> Scale = (AllocElTySize*ArraySizeScale)/CastElTySize;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Amt = 0;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  <span class="keywordflow">if</span> (Scale == 1) {</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    Amt = NumElements;</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    Amt = <a class="code" href="classllvm_1_1ConstantInt.html#a9105541412dab869e18b3cceebfff07d">ConstantInt::get</a>(AI.<a class="code" href="classllvm_1_1AllocaInst.html#a642f52c0f081ad0de10258c1d8d67b23">getArraySize</a>()-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>(), Scale);</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="comment">// Insert before the alloca, not before the cast.</span></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    Amt = AllocaBuilder.CreateMul(Amt, NumElements);</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  }</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  <span class="keywordflow">if</span> (uint64_t Offset = (AllocElTySize*ArrayOffset)/CastElTySize) {</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *Off = <a class="code" href="classllvm_1_1ConstantInt.html#a9105541412dab869e18b3cceebfff07d">ConstantInt::get</a>(AI.<a class="code" href="classllvm_1_1AllocaInst.html#a642f52c0f081ad0de10258c1d8d67b23">getArraySize</a>()-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>(),</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                                  Offset, <span class="keyword">true</span>);</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    Amt = AllocaBuilder.CreateAdd(Amt, Off);</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  }</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  <a class="code" href="classllvm_1_1AllocaInst.html">AllocaInst</a> *New = AllocaBuilder.CreateAlloca(CastElTy, Amt);</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  New-&gt;<a class="code" href="classllvm_1_1AllocaInst.html#a42defc71631bc55fcb48421784b276c9">setAlignment</a>(AI.<a class="code" href="classllvm_1_1AllocaInst.html#ad441932c20e5b9ba36c8c72a6c7f5ec3">getAlignment</a>());</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  New-&gt;<a class="code" href="classllvm_1_1Value.html#ae855357b6c5e6e7ed1869272708a3a84">takeName</a>(&amp;AI);</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  <span class="comment">// If the allocation has multiple real uses, insert a cast and change all</span></div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  <span class="comment">// things that used it to use the new cast.  This will also hack on CI, but it</span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  <span class="comment">// will die soon.</span></div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  <span class="keywordflow">if</span> (!AI.<a class="code" href="classllvm_1_1Value.html#a085b82f074c28030fb8e194377ed2d0c">hasOneUse</a>()) {</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="comment">// New is the allocation instruction, pointer typed. AI is the original</span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <span class="comment">// allocation instruction, also pointer typed. Thus, cast to use is BitCast.</span></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *NewCast = AllocaBuilder.CreateBitCast(New, AI.<a class="code" href="classllvm_1_1AllocaInst.html#a597c918a615f26a0cea7adb84f06fc3f">getType</a>(), <span class="stringliteral">&quot;tmpcast&quot;</span>);</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    ReplaceInstUsesWith(AI, NewCast);</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  }</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  <span class="keywordflow">return</span> ReplaceInstUsesWith(CI, New);</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;}</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment">/// EvaluateInDifferentType - Given an expression that</span></div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment">/// CanEvaluateTruncated or CanEvaluateSExtd returns true for, actually</span></div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment">/// insert the code to evaluate the expression.</span></div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="comment"></span><a class="code" href="classllvm_1_1Value.html">Value</a> *InstCombiner::EvaluateInDifferentType(<a class="code" href="classllvm_1_1Value.html">Value</a> *V, <a class="code" href="classllvm_1_1Type.html">Type</a> *Ty,</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;                                             <span class="keywordtype">bool</span> isSigned) {</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Constant.html">Constant</a> *<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = dyn_cast&lt;Constant&gt;(V)) {</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = <a class="code" href="classllvm_1_1ConstantExpr.html#a81ad2fffd14e2df92cad4f631ae76480">ConstantExpr::getIntegerCast</a>(<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>, Ty, isSigned <span class="comment">/*Sext or ZExt*/</span>);</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <span class="comment">// If we got a constantexpr back, try to simplify it with TD info.</span></div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1ConstantExpr.html">ConstantExpr</a> *CE = dyn_cast&lt;ConstantExpr&gt;(<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>))</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;      <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = <a class="code" href="namespacellvm.html#a8891be7c27326c20a6dba7d98e9030b5">ConstantFoldConstantExpression</a>(CE, TD, TLI);</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>;</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  }</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  <span class="comment">// Otherwise, it must be an instruction.</span></div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = cast&lt;Instruction&gt;(V);</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *Res = 0;</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  <span class="keywordtype">unsigned</span> Opc = I-&gt;<a class="code" href="classllvm_1_1Instruction.html#a021bb7c9aad6003fe8089f6327356c6c">getOpcode</a>();</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  <span class="keywordflow">switch</span> (Opc) {</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  <span class="keywordflow">case</span> Instruction::Add:</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  <span class="keywordflow">case</span> Instruction::Sub:</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  <span class="keywordflow">case</span> Instruction::Mul:</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1APIntOps.html#a684cfe02c582e8d75cd6d457e63e6c25">Instruction::And</a>:</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1APIntOps.html#a22f056804d2b9882f74adc905872bc39">Instruction::Or</a>:</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1APIntOps.html#afc7c4d88d09cba0c5e920f8a3a3ace55">Instruction::Xor</a>:</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  <span class="keywordflow">case</span> Instruction::AShr:</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  <span class="keywordflow">case</span> Instruction::LShr:</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  <span class="keywordflow">case</span> Instruction::Shl:</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  <span class="keywordflow">case</span> Instruction::UDiv:</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  <span class="keywordflow">case</span> Instruction::URem: {</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *LHS = EvaluateInDifferentType(I-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0), Ty, isSigned);</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *RHS = EvaluateInDifferentType(I-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(1), Ty, isSigned);</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    Res = <a class="code" href="classllvm_1_1BinaryOperator.html#a4a4628e91a9c6a339fa61105614fac76">BinaryOperator::Create</a>((<a class="code" href="classllvm_1_1Instruction.html#ac26154a24f393f523c87cc5f8239f36c">Instruction::BinaryOps</a>)Opc, LHS, RHS);</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  }</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  <span class="keywordflow">case</span> Instruction::Trunc:</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;  <span class="keywordflow">case</span> Instruction::ZExt:</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  <span class="keywordflow">case</span> Instruction::SExt:</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="comment">// If the source type of the cast is the type we&#39;re trying for then we can</span></div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="comment">// just return the source.  There&#39;s no need to insert it because it is not</span></div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <span class="comment">// new.</span></div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <span class="keywordflow">if</span> (I-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0)-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>() == Ty)</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;      <span class="keywordflow">return</span> I-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0);</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="comment">// Otherwise, must be the same type of cast, so just reinsert a new one.</span></div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <span class="comment">// This also handles the case of zext(trunc(x)) -&gt; zext(x).</span></div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    Res = <a class="code" href="classllvm_1_1CastInst.html#ae96aa53c0b7c0eb9ec680db6a43abaa7">CastInst::CreateIntegerCast</a>(I-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0), Ty,</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;                                      Opc == Instruction::SExt);</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1MCID.html#a8035044d40d3758eb45b65dce69dc90ba32dbd2c72a98eaee90e3ad5ef7b5af16">Instruction::Select</a>: {</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *True = EvaluateInDifferentType(I-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(1), Ty, isSigned);</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *False = EvaluateInDifferentType(I-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(2), Ty, isSigned);</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    Res = <a class="code" href="classllvm_1_1SelectInst.html#a8bce457e977f23507c48c9dfd7052990">SelectInst::Create</a>(I-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0), True, False);</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  }</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1TargetOpcode.html#a348d4259b5fa6a8ecfe94e7ae512e1a8ae41f9ca68ba5e8b9613cea03652ebd72">Instruction::PHI</a>: {</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *OPN = cast&lt;PHINode&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *NPN = <a class="code" href="classllvm_1_1PHINode.html#afb5e83bf5123ff7c51058eb0ebebcdc6">PHINode::Create</a>(Ty, OPN-&gt;<a class="code" href="classllvm_1_1PHINode.html#aa45f6c0433576e3858a6209a43750ad4">getNumIncomingValues</a>());</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0, e = OPN-&gt;<a class="code" href="classllvm_1_1PHINode.html#aa45f6c0433576e3858a6209a43750ad4">getNumIncomingValues</a>(); <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != e; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *V =EvaluateInDifferentType(OPN-&gt;<a class="code" href="classllvm_1_1PHINode.html#aba6a4cc4ed6d6fef3664b8d65ef04820">getIncomingValue</a>(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>), Ty, isSigned);</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;      NPN-&gt;addIncoming(V, OPN-&gt;<a class="code" href="classllvm_1_1PHINode.html#a4c25b6c00c4867281779c81ab64d2081">getIncomingBlock</a>(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>));</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    }</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    Res = NPN;</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  }</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  <span class="keywordflow">default</span>:</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <span class="comment">// TODO: Can handle more cases here.</span></div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <a class="code" href="ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a>(<span class="stringliteral">&quot;Unreachable!&quot;</span>);</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  }</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;  Res-&gt;takeName(I);</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  <span class="keywordflow">return</span> InsertNewInstWith(Res, *I);</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;}</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="comment">/// This function is a wrapper around CastInst::isEliminableCastPair. It</span></div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="comment">/// simply extracts arguments and returns what that function returns.</span></div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="comment"></span><span class="keyword">static</span> <a class="code" href="classllvm_1_1Instruction.html#afa0b2fa29ba074f2b6ec9ac11163f2d9">Instruction::CastOps</a></div><div class="line"><a name="l00234"></a><span class="lineno"><a class="line" href="InstCombineCasts_8cpp.html#a33121ab9b3810edb043d2c6c144cc4aa">  234</a></span>&#160;<a class="code" href="InstCombineCasts_8cpp.html#a33121ab9b3810edb043d2c6c144cc4aa">isEliminableCastPair</a>(</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1CastInst.html">CastInst</a> *CI, <span class="comment">///&lt; The first cast instruction</span></div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="comment"></span>  <span class="keywordtype">unsigned</span> opcode,       <span class="comment">///&lt; The opcode of the second cast instruction</span></div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1Type.html">Type</a> *DstTy,     <span class="comment">///&lt; The target type for the second cast instruction</span></div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> *TD         <span class="comment">///&lt; The target data for pointer size</span></div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="comment"></span>) {</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *SrcTy = CI-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0)-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>();   <span class="comment">// A from above</span></div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *MidTy = CI-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>();                  <span class="comment">// B from above</span></div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;  <span class="comment">// Get the opcodes of the two Cast instructions</span></div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html#afa0b2fa29ba074f2b6ec9ac11163f2d9">Instruction::CastOps</a> firstOp = <a class="code" href="classllvm_1_1Instruction.html#afa0b2fa29ba074f2b6ec9ac11163f2d9">Instruction::CastOps</a>(CI-&gt;<a class="code" href="classllvm_1_1CastInst.html#adc3489e61d5f37a0e4c5589859fbccc2">getOpcode</a>());</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html#afa0b2fa29ba074f2b6ec9ac11163f2d9">Instruction::CastOps</a> secondOp = <a class="code" href="classllvm_1_1Instruction.html#afa0b2fa29ba074f2b6ec9ac11163f2d9">Instruction::CastOps</a>(opcode);</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *SrcIntPtrTy = TD &amp;&amp; SrcTy-&gt;<a class="code" href="classllvm_1_1Type.html#ac830a02a025d9d5a5dc53c444cf625ee">isPtrOrPtrVectorTy</a>() ?</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    TD-&gt;<a class="code" href="classllvm_1_1DataLayout.html#ae84bb2408dfffa4e8b5fe2ce0714a3bd">getIntPtrType</a>(SrcTy) : 0;</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *MidIntPtrTy = TD &amp;&amp; MidTy-&gt;<a class="code" href="classllvm_1_1Type.html#ac830a02a025d9d5a5dc53c444cf625ee">isPtrOrPtrVectorTy</a>() ?</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    TD-&gt;<a class="code" href="classllvm_1_1DataLayout.html#ae84bb2408dfffa4e8b5fe2ce0714a3bd">getIntPtrType</a>(MidTy) : 0;</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *DstIntPtrTy = TD &amp;&amp; DstTy-&gt;<a class="code" href="classllvm_1_1Type.html#ac830a02a025d9d5a5dc53c444cf625ee">isPtrOrPtrVectorTy</a>() ?</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    TD-&gt;<a class="code" href="classllvm_1_1DataLayout.html#ae84bb2408dfffa4e8b5fe2ce0714a3bd">getIntPtrType</a>(DstTy) : 0;</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;  <span class="keywordtype">unsigned</span> Res = <a class="code" href="classllvm_1_1CastInst.html#a8b805c54dc1ead67b711a4b1cb72f492">CastInst::isEliminableCastPair</a>(firstOp, secondOp, SrcTy, MidTy,</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;                                                DstTy, SrcIntPtrTy, MidIntPtrTy,</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;                                                DstIntPtrTy);</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;  <span class="comment">// We don&#39;t want to form an inttoptr or ptrtoint that converts to an integer</span></div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;  <span class="comment">// type that differs from the pointer size.</span></div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;  <span class="keywordflow">if</span> ((Res == Instruction::IntToPtr &amp;&amp; SrcTy != DstIntPtrTy) ||</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;      (Res == Instruction::PtrToInt &amp;&amp; DstTy != SrcIntPtrTy))</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    Res = 0;</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1Instruction.html#afa0b2fa29ba074f2b6ec9ac11163f2d9">Instruction::CastOps</a>(Res);</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;}</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment">/// ShouldOptimizeCast - Return true if the cast from &quot;V to Ty&quot; actually</span></div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="comment">/// results in any code being generated and is interesting to optimize out. If</span></div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="comment">/// the cast can be eliminated by some other simple transformation, we prefer</span></div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="comment">/// to do the simplification first.</span></div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="comment"></span><span class="keywordtype">bool</span> InstCombiner::ShouldOptimizeCast(<a class="code" href="classllvm_1_1Instruction.html#afa0b2fa29ba074f2b6ec9ac11163f2d9">Instruction::CastOps</a> opc, <span class="keyword">const</span> <a class="code" href="classllvm_1_1Value.html">Value</a> *V,</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;                                      <a class="code" href="classllvm_1_1Type.html">Type</a> *Ty) {</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  <span class="comment">// Noop casts and casts of constants should be eliminated trivially.</span></div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  <span class="keywordflow">if</span> (V-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>() == Ty || isa&lt;Constant&gt;(V)) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  <span class="comment">// If this is another cast that can be eliminated, we prefer to have it</span></div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  <span class="comment">// eliminated.</span></div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">const</span> <a class="code" href="classllvm_1_1CastInst.html">CastInst</a> *CI = dyn_cast&lt;CastInst&gt;(V))</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="InstCombineCasts_8cpp.html#a33121ab9b3810edb043d2c6c144cc4aa">isEliminableCastPair</a>(CI, opc, Ty, TD))</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  <span class="comment">// If this is a vector sext from a compare, then we don&#39;t want to break the</span></div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;  <span class="comment">// idiom where each element of the extended vector is either zero or all ones.</span></div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;  <span class="keywordflow">if</span> (opc == Instruction::SExt &amp;&amp; isa&lt;CmpInst&gt;(V) &amp;&amp; Ty-&gt;<a class="code" href="classllvm_1_1Type.html#a6f725580f7834e2ca90762965866dad4">isVectorTy</a>())</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;}</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="comment">/// @brief Implement the transforms common to all CastInst visitors.</span></div><div class="line"><a name="l00291"></a><span class="lineno"><a class="line" href="classllvm_1_1InstCombiner.html#a2c93f6e9c56faa4bf4f18cdca680c9ff">  291</a></span>&#160;<span class="comment"></span><a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="classllvm_1_1InstCombiner.html#a2c93f6e9c56faa4bf4f18cdca680c9ff">InstCombiner::commonCastTransforms</a>(<a class="code" href="classllvm_1_1CastInst.html">CastInst</a> &amp;CI) {</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Src = CI.<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0);</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;  <span class="comment">// Many cases of &quot;cast of a cast&quot; are eliminable. If it&#39;s eliminable we just</span></div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  <span class="comment">// eliminate it now.</span></div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1CastInst.html">CastInst</a> *CSrc = dyn_cast&lt;CastInst&gt;(Src)) {   <span class="comment">// A-&gt;B-&gt;C cast</span></div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Instruction.html#afa0b2fa29ba074f2b6ec9ac11163f2d9">Instruction::CastOps</a> opc =</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        <a class="code" href="InstCombineCasts_8cpp.html#a33121ab9b3810edb043d2c6c144cc4aa">isEliminableCastPair</a>(CSrc, CI.<a class="code" href="classllvm_1_1CastInst.html#adc3489e61d5f37a0e4c5589859fbccc2">getOpcode</a>(), CI.<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>(), TD)) {</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;      <span class="comment">// The first cast (CSrc) is eliminable so we need to fix up or replace</span></div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;      <span class="comment">// the second cast (CI). CSrc will then have a good chance of being dead.</span></div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1CastInst.html#a0f7dea9550778374905e12da6d6ba8a8">CastInst::Create</a>(opc, CSrc-&gt;getOperand(0), CI.<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>());</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    }</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;  }</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;  <span class="comment">// If we are casting a select then fold the cast into the select</span></div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1SelectInst.html">SelectInst</a> *SI = dyn_cast&lt;SelectInst&gt;(Src))</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="namespacellvm_1_1A64CC.html#af5804bc0518be9568f73db566e4d6f46a2a6c4724226f9ccea96d35fd4c131af8">NV</a> = FoldOpIntoSelect(CI, SI))</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1A64CC.html#af5804bc0518be9568f73db566e4d6f46a2a6c4724226f9ccea96d35fd4c131af8">NV</a>;</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  <span class="comment">// If we are casting a PHI then fold the cast into the PHI</span></div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;  <span class="keywordflow">if</span> (isa&lt;PHINode&gt;(Src)) {</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <span class="comment">// We don&#39;t do this if this would create a PHI node with an illegal type if</span></div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <span class="comment">// it is currently legal.</span></div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <span class="keywordflow">if</span> (!Src-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a6e328feb83afa5cf1c966d6704e43fc1">isIntegerTy</a>() ||</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        !CI.<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a6e328feb83afa5cf1c966d6704e43fc1">isIntegerTy</a>() ||</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;        ShouldChangeType(CI.<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>(), Src-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>()))</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="namespacellvm_1_1A64CC.html#af5804bc0518be9568f73db566e4d6f46a2a6c4724226f9ccea96d35fd4c131af8">NV</a> = FoldOpIntoPhi(CI))</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1A64CC.html#af5804bc0518be9568f73db566e4d6f46a2a6c4724226f9ccea96d35fd4c131af8">NV</a>;</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  }</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;}</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="comment">/// CanEvaluateTruncated - Return true if we can evaluate the specified</span></div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="comment">/// expression tree as type Ty instead of its larger type, and arrive with the</span></div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="comment">/// same value.  This is used by code that tries to eliminate truncates.</span></div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="comment">/// Ty will always be a type smaller than V.  We should return true if trunc(V)</span></div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="comment">/// can be computed by computing V in the smaller type.  If V is an instruction,</span></div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="comment">/// then trunc(inst(x,y)) can be computed as inst(trunc(x),trunc(y)), which only</span></div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="comment">/// makes sense if x and y can be efficiently truncated.</span></div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="comment">/// This function works on both vectors and scalars.</span></div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00335"></a><span class="lineno"><a class="line" href="InstCombineCasts_8cpp.html#a6fd17099ed520f179e5b481db961e0e1">  335</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="InstCombineCasts_8cpp.html#a6fd17099ed520f179e5b481db961e0e1">CanEvaluateTruncated</a>(<a class="code" href="classllvm_1_1Value.html">Value</a> *V, <a class="code" href="classllvm_1_1Type.html">Type</a> *Ty) {</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;  <span class="comment">// We can always evaluate constants in another type.</span></div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;  <span class="keywordflow">if</span> (isa&lt;Constant&gt;(V))</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1Instruction.html">Instruction</a>&gt;(V);</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;  <span class="keywordflow">if</span> (!I) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *OrigTy = V-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>();</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;  <span class="comment">// If this is an extension from the dest type, we can eliminate it, even if it</span></div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;  <span class="comment">// has multiple uses.</span></div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;  <span class="keywordflow">if</span> ((isa&lt;ZExtInst&gt;(I) || isa&lt;SExtInst&gt;(I)) &amp;&amp;</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;      I-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0)-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>() == Ty)</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;  <span class="comment">// We can&#39;t extend or shrink something that has multiple uses: doing so would</span></div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;  <span class="comment">// require duplicating the instruction in general, which isn&#39;t profitable.</span></div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;  <span class="keywordflow">if</span> (!I-&gt;<a class="code" href="classllvm_1_1Value.html#a085b82f074c28030fb8e194377ed2d0c">hasOneUse</a>()) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;  <span class="keywordtype">unsigned</span> Opc = I-&gt;<a class="code" href="classllvm_1_1Instruction.html#a021bb7c9aad6003fe8089f6327356c6c">getOpcode</a>();</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;  <span class="keywordflow">switch</span> (Opc) {</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;  <span class="keywordflow">case</span> Instruction::Add:</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;  <span class="keywordflow">case</span> Instruction::Sub:</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;  <span class="keywordflow">case</span> Instruction::Mul:</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1APIntOps.html#a684cfe02c582e8d75cd6d457e63e6c25">Instruction::And</a>:</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1APIntOps.html#a22f056804d2b9882f74adc905872bc39">Instruction::Or</a>:</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1APIntOps.html#afc7c4d88d09cba0c5e920f8a3a3ace55">Instruction::Xor</a>:</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    <span class="comment">// These operators can all arbitrarily be extended or truncated.</span></div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="InstCombineCasts_8cpp.html#a6fd17099ed520f179e5b481db961e0e1">CanEvaluateTruncated</a>(I-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0), Ty) &amp;&amp;</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;           <a class="code" href="InstCombineCasts_8cpp.html#a6fd17099ed520f179e5b481db961e0e1">CanEvaluateTruncated</a>(I-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(1), Ty);</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;  <span class="keywordflow">case</span> Instruction::UDiv:</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;  <span class="keywordflow">case</span> Instruction::URem: {</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    <span class="comment">// UDiv and URem can be truncated if all the truncated bits are zero.</span></div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    uint32_t OrigBitWidth = OrigTy-&gt;<a class="code" href="classllvm_1_1Type.html#ad979b3c1bc975ee23810e3018ffe951b">getScalarSizeInBits</a>();</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    uint32_t BitWidth = Ty-&gt;<a class="code" href="classllvm_1_1Type.html#ad979b3c1bc975ee23810e3018ffe951b">getScalarSizeInBits</a>();</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    <span class="keywordflow">if</span> (BitWidth &lt; OrigBitWidth) {</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;      <a class="code" href="classllvm_1_1APInt.html">APInt</a> Mask = <a class="code" href="classllvm_1_1APInt.html#adcb96bd09d7c75c7669fa5f9d1190899">APInt::getHighBitsSet</a>(OrigBitWidth, OrigBitWidth-BitWidth);</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#a8bc4c3e77e6f3d6c54b8b4504393dfa7">MaskedValueIsZero</a>(I-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0), Mask) &amp;&amp;</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;          <a class="code" href="namespacellvm.html#a8bc4c3e77e6f3d6c54b8b4504393dfa7">MaskedValueIsZero</a>(I-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(1), Mask)) {</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="InstCombineCasts_8cpp.html#a6fd17099ed520f179e5b481db961e0e1">CanEvaluateTruncated</a>(I-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0), Ty) &amp;&amp;</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;               <a class="code" href="InstCombineCasts_8cpp.html#a6fd17099ed520f179e5b481db961e0e1">CanEvaluateTruncated</a>(I-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(1), Ty);</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;      }</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    }</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;  }</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;  <span class="keywordflow">case</span> Instruction::Shl:</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    <span class="comment">// If we are truncating the result of this SHL, and if it&#39;s a shift of a</span></div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <span class="comment">// constant amount, we can always perform a SHL in a smaller type.</span></div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *CI = dyn_cast&lt;ConstantInt&gt;(I-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(1))) {</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;      uint32_t BitWidth = Ty-&gt;<a class="code" href="classllvm_1_1Type.html#ad979b3c1bc975ee23810e3018ffe951b">getScalarSizeInBits</a>();</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;      <span class="keywordflow">if</span> (CI-&gt;getLimitedValue(BitWidth) &lt; BitWidth)</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="InstCombineCasts_8cpp.html#a6fd17099ed520f179e5b481db961e0e1">CanEvaluateTruncated</a>(I-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0), Ty);</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    }</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;  <span class="keywordflow">case</span> Instruction::LShr:</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    <span class="comment">// If this is a truncate of a logical shr, we can truncate it to a smaller</span></div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    <span class="comment">// lshr iff we know that the bits we would otherwise be shifting in are</span></div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    <span class="comment">// already zeros.</span></div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *CI = dyn_cast&lt;ConstantInt&gt;(I-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(1))) {</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;      uint32_t OrigBitWidth = OrigTy-&gt;<a class="code" href="classllvm_1_1Type.html#ad979b3c1bc975ee23810e3018ffe951b">getScalarSizeInBits</a>();</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;      uint32_t BitWidth = Ty-&gt;<a class="code" href="classllvm_1_1Type.html#ad979b3c1bc975ee23810e3018ffe951b">getScalarSizeInBits</a>();</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#a8bc4c3e77e6f3d6c54b8b4504393dfa7">MaskedValueIsZero</a>(I-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0),</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;            <a class="code" href="classllvm_1_1APInt.html#adcb96bd09d7c75c7669fa5f9d1190899">APInt::getHighBitsSet</a>(OrigBitWidth, OrigBitWidth-BitWidth)) &amp;&amp;</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;          CI-&gt;getLimitedValue(BitWidth) &lt; BitWidth) {</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="InstCombineCasts_8cpp.html#a6fd17099ed520f179e5b481db961e0e1">CanEvaluateTruncated</a>(I-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0), Ty);</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;      }</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    }</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;  <span class="keywordflow">case</span> Instruction::Trunc:</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <span class="comment">// trunc(trunc(x)) -&gt; trunc(x)</span></div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;  <span class="keywordflow">case</span> Instruction::ZExt:</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;  <span class="keywordflow">case</span> Instruction::SExt:</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    <span class="comment">// trunc(ext(x)) -&gt; ext(x) if the source type is smaller than the new dest</span></div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    <span class="comment">// trunc(ext(x)) -&gt; trunc(x) if the source type is larger than the new dest</span></div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1MCID.html#a8035044d40d3758eb45b65dce69dc90ba32dbd2c72a98eaee90e3ad5ef7b5af16">Instruction::Select</a>: {</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    <a class="code" href="classllvm_1_1SelectInst.html">SelectInst</a> *SI = cast&lt;SelectInst&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="InstCombineCasts_8cpp.html#a6fd17099ed520f179e5b481db961e0e1">CanEvaluateTruncated</a>(SI-&gt;<a class="code" href="classllvm_1_1SelectInst.html#a67bf091383cd61e1225445e78b61d9f9">getTrueValue</a>(), Ty) &amp;&amp;</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;           <a class="code" href="InstCombineCasts_8cpp.html#a6fd17099ed520f179e5b481db961e0e1">CanEvaluateTruncated</a>(SI-&gt;<a class="code" href="classllvm_1_1SelectInst.html#a29a16f32075ee4f23cd769701463952c">getFalseValue</a>(), Ty);</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;  }</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1TargetOpcode.html#a348d4259b5fa6a8ecfe94e7ae512e1a8ae41f9ca68ba5e8b9613cea03652ebd72">Instruction::PHI</a>: {</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <span class="comment">// We can change a phi if we can change all operands.  Note that we never</span></div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    <span class="comment">// get into trouble with cyclic PHIs here because we only consider</span></div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <span class="comment">// instructions with a single use.</span></div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *PN = cast&lt;PHINode&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0, e = PN-&gt;<a class="code" href="classllvm_1_1PHINode.html#aa45f6c0433576e3858a6209a43750ad4">getNumIncomingValues</a>(); <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != e; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="InstCombineCasts_8cpp.html#a6fd17099ed520f179e5b481db961e0e1">CanEvaluateTruncated</a>(PN-&gt;<a class="code" href="classllvm_1_1PHINode.html#aba6a4cc4ed6d6fef3664b8d65ef04820">getIncomingValue</a>(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>), Ty))</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;  }</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;  <span class="keywordflow">default</span>:</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    <span class="comment">// TODO: Can handle more cases here.</span></div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;  }</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;}</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;</div><div class="line"><a name="l00436"></a><span class="lineno"><a class="line" href="classllvm_1_1InstCombiner.html#a7d92fd2831240f33fba5b54ec91df58d">  436</a></span>&#160;<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="classllvm_1_1InstCombiner.html#a7d92fd2831240f33fba5b54ec91df58d">InstCombiner::visitTrunc</a>(<a class="code" href="classllvm_1_1TruncInst.html">TruncInst</a> &amp;CI) {</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *Result = commonCastTransforms(CI))</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    <span class="keywordflow">return</span> Result;</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;  <span class="comment">// See if we can simplify any instructions used by the input whose sole</span></div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;  <span class="comment">// purpose is to compute bits we don&#39;t care about.</span></div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;  <span class="keywordflow">if</span> (SimplifyDemandedInstructionBits(CI))</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    <span class="keywordflow">return</span> &amp;CI;</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Src = CI.<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0);</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *DestTy = CI.<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>(), *SrcTy = Src-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>();</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;  <span class="comment">// Attempt to truncate the entire input expression tree to the destination</span></div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;  <span class="comment">// type.   Only do this if the dest type is a simple type, don&#39;t convert the</span></div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;  <span class="comment">// expression tree to something weird like i93 unless the source is also</span></div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;  <span class="comment">// strange.</span></div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;  <span class="keywordflow">if</span> ((DestTy-&gt;<a class="code" href="classllvm_1_1Type.html#a6f725580f7834e2ca90762965866dad4">isVectorTy</a>() || ShouldChangeType(SrcTy, DestTy)) &amp;&amp;</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;      <a class="code" href="InstCombineCasts_8cpp.html#a6fd17099ed520f179e5b481db961e0e1">CanEvaluateTruncated</a>(Src, DestTy)) {</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    <span class="comment">// If this cast is a truncate, evaluting in a different type always</span></div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    <span class="comment">// eliminates the cast, so it is always a win.</span></div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;ICE: EvaluateInDifferentType converting expression type&quot;</span></div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;          <span class="stringliteral">&quot; to avoid cast: &quot;</span> &lt;&lt; CI &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>);</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *Res = EvaluateInDifferentType(Src, DestTy, <span class="keyword">false</span>);</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    assert(Res-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>() == DestTy);</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    <span class="keywordflow">return</span> ReplaceInstUsesWith(CI, Res);</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;  }</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;  <span class="comment">// Canonicalize trunc x to i1 -&gt; (icmp ne (and x, 1), 0), likewise for vector.</span></div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;  <span class="keywordflow">if</span> (DestTy-&gt;<a class="code" href="classllvm_1_1Type.html#ad979b3c1bc975ee23810e3018ffe951b">getScalarSizeInBits</a>() == 1) {</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    <a class="code" href="classllvm_1_1Constant.html">Constant</a> *One = <a class="code" href="classllvm_1_1ConstantInt.html#a9105541412dab869e18b3cceebfff07d">ConstantInt::get</a>(Src-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>(), 1);</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    Src = Builder-&gt;CreateAnd(Src, One);</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *Zero = <a class="code" href="classllvm_1_1Constant.html#aa6574d526b3e38a28f688a7bb4325c2c">Constant::getNullValue</a>(Src-&gt;getType());</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="classllvm_1_1ICmpInst.html">ICmpInst</a>(<a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05ac17897ebf2f6a6986280fc3bdf28a30a">ICmpInst::ICMP_NE</a>, Src, Zero);</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;  }</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;  <span class="comment">// Transform trunc(lshr (zext A), Cst) to eliminate one type conversion.</span></div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a> = 0; <a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *Cst = 0;</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;  <span class="keywordflow">if</span> (Src-&gt;<a class="code" href="classllvm_1_1Value.html#a085b82f074c28030fb8e194377ed2d0c">hasOneUse</a>() &amp;&amp;</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;      <a class="code" href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">match</a>(Src, <a class="code" href="namespacellvm_1_1PatternMatch.html#aa08fee11e8a5ec10c0cc2a7abbbd799a">m_LShr</a>(<a class="code" href="namespacellvm_1_1PatternMatch.html#a2cbdca7c8267aac6914d674f8e81841b">m_ZExt</a>(<a class="code" href="namespacellvm_1_1PatternMatch.html#a24bca8838396aa81b87de8e7ac774b19">m_Value</a>(A)), <a class="code" href="namespacellvm_1_1PatternMatch.html#a34a92072122412c6020d4afb43725bf4">m_ConstantInt</a>(Cst)))) {</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    <span class="comment">// We have three types to worry about here, the type of A, the source of</span></div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    <span class="comment">// the truncate (MidSize), and the destination of the truncate. We know that</span></div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    <span class="comment">// ASize &lt; MidSize   and MidSize &gt; ResultSize, but don&#39;t know the relation</span></div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    <span class="comment">// between ASize and ResultSize.</span></div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    <span class="keywordtype">unsigned</span> ASize = A-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a5a7cfa245af120b44ac8a86143bb9e57">getPrimitiveSizeInBits</a>();</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    <span class="comment">// If the shift amount is larger than the size of A, then the result is</span></div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    <span class="comment">// known to be zero because all the input bits got shifted out.</span></div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    <span class="keywordflow">if</span> (Cst-&gt;<a class="code" href="classllvm_1_1ConstantInt.html#a6edd823ba5e4e1effc8280ca8a1194ef">getZExtValue</a>() &gt;= ASize)</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;      <span class="keywordflow">return</span> ReplaceInstUsesWith(CI, <a class="code" href="classllvm_1_1Constant.html#aa6574d526b3e38a28f688a7bb4325c2c">Constant::getNullValue</a>(CI.<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>()));</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    <span class="comment">// Since we&#39;re doing an lshr and a zero extend, and know that the shift</span></div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    <span class="comment">// amount is smaller than ASize, it is always safe to do the shift in A&#39;s</span></div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    <span class="comment">// type, then zero extend or truncate to the result.</span></div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="Target_2README_8txt.html#a8db36c82f32d6f6a4d35a00e55be03a8">Shift</a> = Builder-&gt;CreateLShr(A, Cst-&gt;<a class="code" href="classllvm_1_1ConstantInt.html#a6edd823ba5e4e1effc8280ca8a1194ef">getZExtValue</a>());</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    Shift-&gt;<a class="code" href="classllvm_1_1Value.html#ae855357b6c5e6e7ed1869272708a3a84">takeName</a>(Src);</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1CastInst.html#ae96aa53c0b7c0eb9ec680db6a43abaa7">CastInst::CreateIntegerCast</a>(Shift, CI.<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>(), <span class="keyword">false</span>);</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;  }</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;  <span class="comment">// Transform &quot;trunc (and X, cst)&quot; -&gt; &quot;and (trunc X), cst&quot; so long as the dest</span></div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;  <span class="comment">// type isn&#39;t non-native.</span></div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;  <span class="keywordflow">if</span> (Src-&gt;<a class="code" href="classllvm_1_1Value.html#a085b82f074c28030fb8e194377ed2d0c">hasOneUse</a>() &amp;&amp; isa&lt;IntegerType&gt;(Src-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>()) &amp;&amp;</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;      ShouldChangeType(Src-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>(), CI.<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>()) &amp;&amp;</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;      <a class="code" href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">match</a>(Src, <a class="code" href="namespacellvm_1_1PatternMatch.html#a427435d4da769ae680a8e77ef89520aa">m_And</a>(<a class="code" href="namespacellvm_1_1PatternMatch.html#a24bca8838396aa81b87de8e7ac774b19">m_Value</a>(A), <a class="code" href="namespacellvm_1_1PatternMatch.html#a34a92072122412c6020d4afb43725bf4">m_ConstantInt</a>(Cst)))) {</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *NewTrunc = Builder-&gt;CreateTrunc(A, CI.<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>(), A-&gt;<a class="code" href="classllvm_1_1Value.html#ad452febc1ac0b394876e640ec03ffa38">getName</a>()+<span class="stringliteral">&quot;.tr&quot;</span>);</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    <span class="keywordflow">return</span> BinaryOperator::CreateAnd(NewTrunc,</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;                                     <a class="code" href="classllvm_1_1ConstantExpr.html#aca5cab6b8d2be24d0c857cc4a831feec">ConstantExpr::getTrunc</a>(Cst, CI.<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>()));</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;  }</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;}</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;<span class="comment">/// transformZExtICmp - Transform (zext icmp) to bitwise / integer operations</span></div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;<span class="comment">/// in order to eliminate the icmp.</span></div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;<span class="comment"></span><a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *InstCombiner::transformZExtICmp(<a class="code" href="classllvm_1_1ICmpInst.html">ICmpInst</a> *ICI, <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;CI,</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;                                             <span class="keywordtype">bool</span> DoXform) {</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;  <span class="comment">// If we are just checking for a icmp eq of a single bit and zext&#39;ing it</span></div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;  <span class="comment">// to an integer, then shift the bit to the appropriate place and then</span></div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;  <span class="comment">// cast to integer to avoid the comparison.</span></div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *Op1C = dyn_cast&lt;ConstantInt&gt;(ICI-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(1))) {</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1APInt.html">APInt</a> &amp;Op1CV = Op1C-&gt;getValue();</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    <span class="comment">// zext (x &lt;s  0) to i32 --&gt; x&gt;&gt;u31      true if signbit set.</span></div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    <span class="comment">// zext (x &gt;s -1) to i32 --&gt; (x&gt;&gt;u31)^1  true if signbit clear.</span></div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    <span class="keywordflow">if</span> ((ICI-&gt;<a class="code" href="classllvm_1_1CmpInst.html#a8afd4995fae596b2c86eeed85b3d388b">getPredicate</a>() == <a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05a15ae464950ac676919c2f0c7aafc706c">ICmpInst::ICMP_SLT</a> &amp;&amp; Op1CV == 0) ||</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;        (ICI-&gt;<a class="code" href="classllvm_1_1CmpInst.html#a8afd4995fae596b2c86eeed85b3d388b">getPredicate</a>() == <a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05a720a42e85f7e981afd61e28473b0000a">ICmpInst::ICMP_SGT</a> &amp;&amp;Op1CV.isAllOnesValue())) {</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;      <span class="keywordflow">if</span> (!DoXform) <span class="keywordflow">return</span> ICI;</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5a5fa7b4069ef3bd1ceb9f2caa315cf5ac">In</a> = ICI-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0);</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *Sh = <a class="code" href="classllvm_1_1ConstantInt.html#a9105541412dab869e18b3cceebfff07d">ConstantInt::get</a>(In-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>(),</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;                                   In-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#ad979b3c1bc975ee23810e3018ffe951b">getScalarSizeInBits</a>()-1);</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;      In = Builder-&gt;CreateLShr(In, Sh, In-&gt;<a class="code" href="classllvm_1_1Value.html#ad452febc1ac0b394876e640ec03ffa38">getName</a>()+<span class="stringliteral">&quot;.lobit&quot;</span>);</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;      <span class="keywordflow">if</span> (In-&gt;getType() != CI.<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>())</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;        In = Builder-&gt;CreateIntCast(In, CI.<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>(), <span class="keyword">false</span><span class="comment">/*ZExt*/</span>);</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;      <span class="keywordflow">if</span> (ICI-&gt;<a class="code" href="classllvm_1_1CmpInst.html#a8afd4995fae596b2c86eeed85b3d388b">getPredicate</a>() == <a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05a720a42e85f7e981afd61e28473b0000a">ICmpInst::ICMP_SGT</a>) {</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;        <a class="code" href="classllvm_1_1Constant.html">Constant</a> *One = <a class="code" href="classllvm_1_1ConstantInt.html#a9105541412dab869e18b3cceebfff07d">ConstantInt::get</a>(In-&gt;getType(), 1);</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;        In = Builder-&gt;CreateXor(In, One, In-&gt;<a class="code" href="classllvm_1_1Value.html#ad452febc1ac0b394876e640ec03ffa38">getName</a>()+<span class="stringliteral">&quot;.not&quot;</span>);</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;      }</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;      <span class="keywordflow">return</span> ReplaceInstUsesWith(CI, In);</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    }</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    <span class="comment">// zext (X == 0) to i32 --&gt; X^1      iff X has only the low bit set.</span></div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    <span class="comment">// zext (X == 0) to i32 --&gt; (X&gt;&gt;1)^1 iff X has only the 2nd bit set.</span></div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    <span class="comment">// zext (X == 1) to i32 --&gt; X        iff X has only the low bit set.</span></div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    <span class="comment">// zext (X == 2) to i32 --&gt; X&gt;&gt;1     iff X has only the 2nd bit set.</span></div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    <span class="comment">// zext (X != 0) to i32 --&gt; X        iff X has only the low bit set.</span></div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    <span class="comment">// zext (X != 0) to i32 --&gt; X&gt;&gt;1     iff X has only the 2nd bit set.</span></div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    <span class="comment">// zext (X != 1) to i32 --&gt; X^1      iff X has only the low bit set.</span></div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    <span class="comment">// zext (X != 2) to i32 --&gt; (X&gt;&gt;1)^1 iff X has only the 2nd bit set.</span></div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    <span class="keywordflow">if</span> ((Op1CV == 0 || Op1CV.isPowerOf2()) &amp;&amp;</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;        <span class="comment">// This only works for EQ and NE</span></div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;        ICI-&gt;<a class="code" href="classllvm_1_1ICmpInst.html#abe8988eef2e6fc2baba032cb22afedd7">isEquality</a>()) {</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;      <span class="comment">// If Op1C some other power of two, convert:</span></div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;      uint32_t BitWidth = Op1C-&gt;getType()-&gt;getBitWidth();</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;      <a class="code" href="classllvm_1_1APInt.html">APInt</a> KnownZero(BitWidth, 0), KnownOne(BitWidth, 0);</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;      <a class="code" href="namespacellvm.html#a7985318bedfe5c2040025ef13db9c57b">ComputeMaskedBits</a>(ICI-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0), KnownZero, KnownOne);</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;      <a class="code" href="classllvm_1_1APInt.html">APInt</a> KnownZeroMask(~KnownZero);</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;      <span class="keywordflow">if</span> (KnownZeroMask.isPowerOf2()) { <span class="comment">// Exactly 1 possible 1?</span></div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;        <span class="keywordflow">if</span> (!DoXform) <span class="keywordflow">return</span> ICI;</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;        <span class="keywordtype">bool</span> isNE = ICI-&gt;<a class="code" href="classllvm_1_1CmpInst.html#a8afd4995fae596b2c86eeed85b3d388b">getPredicate</a>() == <a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05ac17897ebf2f6a6986280fc3bdf28a30a">ICmpInst::ICMP_NE</a>;</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;        <span class="keywordflow">if</span> (Op1CV != 0 &amp;&amp; (Op1CV != KnownZeroMask)) {</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;          <span class="comment">// (X&amp;4) == 2 --&gt; false</span></div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;          <span class="comment">// (X&amp;4) != 2 --&gt; true</span></div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;          <a class="code" href="classllvm_1_1Constant.html">Constant</a> *Res = <a class="code" href="classllvm_1_1ConstantInt.html#a9105541412dab869e18b3cceebfff07d">ConstantInt::get</a>(<a class="code" href="classllvm_1_1Type.html#aa75984a442f2379de0c66018201fa628">Type::getInt1Ty</a>(CI.<a class="code" href="classllvm_1_1Value.html#af85a4828b6b5a8de7fc0a55cc0e5b52f">getContext</a>()),</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;                                           isNE);</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;          Res = <a class="code" href="classllvm_1_1ConstantExpr.html#a80e82791d4d7f4d1d23d68ca0a2b1f64">ConstantExpr::getZExt</a>(Res, CI.<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>());</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;          <span class="keywordflow">return</span> ReplaceInstUsesWith(CI, Res);</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;        }</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;        uint32_t ShiftAmt = KnownZeroMask.logBase2();</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;        <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5a5fa7b4069ef3bd1ceb9f2caa315cf5ac">In</a> = ICI-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0);</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;        <span class="keywordflow">if</span> (ShiftAmt) {</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;          <span class="comment">// Perform a logical shr by shiftamt.</span></div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;          <span class="comment">// Insert the shift to put the result in the low bit.</span></div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;          In = Builder-&gt;CreateLShr(In, <a class="code" href="classllvm_1_1ConstantInt.html#a9105541412dab869e18b3cceebfff07d">ConstantInt::get</a>(In-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>(),ShiftAmt),</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;                                   In-&gt;<a class="code" href="classllvm_1_1Value.html#ad452febc1ac0b394876e640ec03ffa38">getName</a>()+<span class="stringliteral">&quot;.lobit&quot;</span>);</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;        }</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;        <span class="keywordflow">if</span> ((Op1CV != 0) == isNE) { <span class="comment">// Toggle the low bit.</span></div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;          <a class="code" href="classllvm_1_1Constant.html">Constant</a> *One = <a class="code" href="classllvm_1_1ConstantInt.html#a9105541412dab869e18b3cceebfff07d">ConstantInt::get</a>(In-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>(), 1);</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;          In = Builder-&gt;CreateXor(In, One);</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;        }</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;        <span class="keywordflow">if</span> (CI.<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>() == In-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>())</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;          <span class="keywordflow">return</span> ReplaceInstUsesWith(CI, In);</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1CastInst.html#ae96aa53c0b7c0eb9ec680db6a43abaa7">CastInst::CreateIntegerCast</a>(In, CI.<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>(), <span class="keyword">false</span><span class="comment">/*ZExt*/</span>);</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;      }</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    }</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;  }</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;  <span class="comment">// icmp ne A, B is equal to xor A, B when A and B only really have one bit.</span></div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;  <span class="comment">// It is also profitable to transform icmp eq into not(xor(A, B)) because that</span></div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;  <span class="comment">// may lead to additional simplifications.</span></div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;  <span class="keywordflow">if</span> (ICI-&gt;<a class="code" href="classllvm_1_1ICmpInst.html#abe8988eef2e6fc2baba032cb22afedd7">isEquality</a>() &amp;&amp; CI.<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>() == ICI-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0)-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>()) {</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1IntegerType.html">IntegerType</a> *ITy = dyn_cast&lt;IntegerType&gt;(CI.<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>())) {</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;      uint32_t BitWidth = ITy-&gt;getBitWidth();</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *LHS = ICI-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0);</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *RHS = ICI-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(1);</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;      <a class="code" href="classllvm_1_1APInt.html">APInt</a> KnownZeroLHS(BitWidth, 0), KnownOneLHS(BitWidth, 0);</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;      <a class="code" href="classllvm_1_1APInt.html">APInt</a> KnownZeroRHS(BitWidth, 0), KnownOneRHS(BitWidth, 0);</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;      <a class="code" href="namespacellvm.html#a7985318bedfe5c2040025ef13db9c57b">ComputeMaskedBits</a>(LHS, KnownZeroLHS, KnownOneLHS);</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;      <a class="code" href="namespacellvm.html#a7985318bedfe5c2040025ef13db9c57b">ComputeMaskedBits</a>(RHS, KnownZeroRHS, KnownOneRHS);</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;      <span class="keywordflow">if</span> (KnownZeroLHS == KnownZeroRHS &amp;&amp; KnownOneLHS == KnownOneRHS) {</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;        <a class="code" href="classllvm_1_1APInt.html">APInt</a> KnownBits = KnownZeroLHS | KnownOneLHS;</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;        <a class="code" href="classllvm_1_1APInt.html">APInt</a> UnknownBit = ~KnownBits;</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;        <span class="keywordflow">if</span> (UnknownBit.<a class="code" href="classllvm_1_1APInt.html#ac9d5eb700dcdf604653d12d8caf4a0fb">countPopulation</a>() == 1) {</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;          <span class="keywordflow">if</span> (!DoXform) <span class="keywordflow">return</span> ICI;</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;          <a class="code" href="classllvm_1_1Value.html">Value</a> *Result = Builder-&gt;CreateXor(LHS, RHS);</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;          <span class="comment">// Mask off any bits that are set and won&#39;t be shifted away.</span></div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;          <span class="keywordflow">if</span> (KnownOneLHS.<a class="code" href="classllvm_1_1APInt.html#a0229ff3a1d7432810a86c8efab115c33">uge</a>(UnknownBit))</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;            Result = Builder-&gt;CreateAnd(Result,</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;                                        <a class="code" href="classllvm_1_1ConstantInt.html#a9105541412dab869e18b3cceebfff07d">ConstantInt::get</a>(ITy, UnknownBit));</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;          <span class="comment">// Shift the bit we&#39;re testing down to the lsb.</span></div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;          Result = Builder-&gt;CreateLShr(</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;               Result, <a class="code" href="classllvm_1_1ConstantInt.html#a9105541412dab869e18b3cceebfff07d">ConstantInt::get</a>(ITy, UnknownBit.<a class="code" href="classllvm_1_1APInt.html#aac277496191547e487eea07f09dffd4b">countTrailingZeros</a>()));</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;          <span class="keywordflow">if</span> (ICI-&gt;<a class="code" href="classllvm_1_1CmpInst.html#a8afd4995fae596b2c86eeed85b3d388b">getPredicate</a>() == <a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05aa719225e2de4059f93fd3209e1f48218">ICmpInst::ICMP_EQ</a>)</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;            Result = Builder-&gt;CreateXor(Result, <a class="code" href="classllvm_1_1ConstantInt.html#a9105541412dab869e18b3cceebfff07d">ConstantInt::get</a>(ITy, 1));</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;          Result-&gt;<a class="code" href="classllvm_1_1Value.html#ae855357b6c5e6e7ed1869272708a3a84">takeName</a>(ICI);</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;          <span class="keywordflow">return</span> ReplaceInstUsesWith(CI, Result);</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;        }</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;      }</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    }</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;  }</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;}</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;<span class="comment">/// CanEvaluateZExtd - Determine if the specified value can be computed in the</span></div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;<span class="comment">/// specified wider type and produce the same low bits.  If not, return false.</span></div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;<span class="comment">/// If this function returns true, it can also return a non-zero number of bits</span></div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;<span class="comment">/// (in BitsToClear) which indicates that the value it computes is correct for</span></div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;<span class="comment">/// the zero extend, but that the additional BitsToClear bits need to be zero&#39;d</span></div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;<span class="comment">/// out.  For example, to promote something like:</span></div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;<span class="comment">///   %B = trunc i64 %A to i32</span></div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;<span class="comment">///   %C = lshr i32 %B, 8</span></div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;<span class="comment">///   %E = zext i32 %C to i64</span></div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;<span class="comment">/// CanEvaluateZExtd for the &#39;lshr&#39; will return true, and BitsToClear will be</span></div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;<span class="comment">/// set to 8 to indicate that the promoted value needs to have bits 24-31</span></div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;<span class="comment">/// cleared in addition to bits 32-63.  Since an &#39;and&#39; will be generated to</span></div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;<span class="comment">/// clear the top bits anyway, doing this has no extra cost.</span></div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;<span class="comment">/// This function works on both vectors and scalars.</span></div><div class="line"><a name="l00651"></a><span class="lineno"><a class="line" href="InstCombineCasts_8cpp.html#a39b384f8e288556dc7732b655b848692">  651</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="InstCombineCasts_8cpp.html#a39b384f8e288556dc7732b655b848692">CanEvaluateZExtd</a>(<a class="code" href="classllvm_1_1Value.html">Value</a> *V, <a class="code" href="classllvm_1_1Type.html">Type</a> *Ty, <span class="keywordtype">unsigned</span> &amp;BitsToClear) {</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;  BitsToClear = 0;</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;  <span class="keywordflow">if</span> (isa&lt;Constant&gt;(V))</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1Instruction.html">Instruction</a>&gt;(V);</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;  <span class="keywordflow">if</span> (!I) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;  <span class="comment">// If the input is a truncate from the destination type, we can trivially</span></div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;  <span class="comment">// eliminate it.</span></div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;  <span class="keywordflow">if</span> (isa&lt;TruncInst&gt;(I) &amp;&amp; I-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0)-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>() == Ty)</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;  <span class="comment">// We can&#39;t extend or shrink something that has multiple uses: doing so would</span></div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;  <span class="comment">// require duplicating the instruction in general, which isn&#39;t profitable.</span></div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;  <span class="keywordflow">if</span> (!I-&gt;<a class="code" href="classllvm_1_1Value.html#a085b82f074c28030fb8e194377ed2d0c">hasOneUse</a>()) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;  <span class="keywordtype">unsigned</span> Opc = I-&gt;<a class="code" href="classllvm_1_1Instruction.html#a021bb7c9aad6003fe8089f6327356c6c">getOpcode</a>(), Tmp;</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;  <span class="keywordflow">switch</span> (Opc) {</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;  <span class="keywordflow">case</span> Instruction::ZExt:  <span class="comment">// zext(zext(x)) -&gt; zext(x).</span></div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;  <span class="keywordflow">case</span> Instruction::SExt:  <span class="comment">// zext(sext(x)) -&gt; sext(x).</span></div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;  <span class="keywordflow">case</span> Instruction::Trunc: <span class="comment">// zext(trunc(x)) -&gt; trunc(x) or zext(x)</span></div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1APIntOps.html#a684cfe02c582e8d75cd6d457e63e6c25">Instruction::And</a>:</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1APIntOps.html#a22f056804d2b9882f74adc905872bc39">Instruction::Or</a>:</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1APIntOps.html#afc7c4d88d09cba0c5e920f8a3a3ace55">Instruction::Xor</a>:</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;  <span class="keywordflow">case</span> Instruction::Add:</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;  <span class="keywordflow">case</span> Instruction::Sub:</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;  <span class="keywordflow">case</span> Instruction::Mul:</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="InstCombineCasts_8cpp.html#a39b384f8e288556dc7732b655b848692">CanEvaluateZExtd</a>(I-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0), Ty, BitsToClear) ||</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;        !<a class="code" href="InstCombineCasts_8cpp.html#a39b384f8e288556dc7732b655b848692">CanEvaluateZExtd</a>(I-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(1), Ty, Tmp))</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;    <span class="comment">// These can all be promoted if neither operand has &#39;bits to clear&#39;.</span></div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;    <span class="keywordflow">if</span> (BitsToClear == 0 &amp;&amp; Tmp == 0)</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    <span class="comment">// If the operation is an AND/OR/XOR and the bits to clear are zero in the</span></div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    <span class="comment">// other side, BitsToClear is ok.</span></div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;    <span class="keywordflow">if</span> (Tmp == 0 &amp;&amp;</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;        (Opc == <a class="code" href="namespacellvm_1_1APIntOps.html#a684cfe02c582e8d75cd6d457e63e6c25">Instruction::And</a> || Opc == <a class="code" href="namespacellvm_1_1APIntOps.html#a22f056804d2b9882f74adc905872bc39">Instruction::Or</a> ||</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;         Opc == <a class="code" href="namespacellvm_1_1APIntOps.html#afc7c4d88d09cba0c5e920f8a3a3ace55">Instruction::Xor</a>)) {</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;      <span class="comment">// We use MaskedValueIsZero here for generality, but the case we care</span></div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;      <span class="comment">// about the most is constant RHS.</span></div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;      <span class="keywordtype">unsigned</span> VSize = V-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#ad979b3c1bc975ee23810e3018ffe951b">getScalarSizeInBits</a>();</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#a8bc4c3e77e6f3d6c54b8b4504393dfa7">MaskedValueIsZero</a>(I-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(1),</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;                            <a class="code" href="classllvm_1_1APInt.html#adcb96bd09d7c75c7669fa5f9d1190899">APInt::getHighBitsSet</a>(VSize, BitsToClear)))</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;    }</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    <span class="comment">// Otherwise, we don&#39;t know how to analyze this BitsToClear case yet.</span></div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;  <span class="keywordflow">case</span> Instruction::Shl:</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;    <span class="comment">// We can promote shl(x, cst) if we can promote x.  Since shl overwrites the</span></div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;    <span class="comment">// upper bits we can reduce BitsToClear by the shift amount.</span></div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *Amt = dyn_cast&lt;ConstantInt&gt;(I-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(1))) {</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="InstCombineCasts_8cpp.html#a39b384f8e288556dc7732b655b848692">CanEvaluateZExtd</a>(I-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0), Ty, BitsToClear))</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;      uint64_t ShiftAmt = Amt-&gt;getZExtValue();</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;      BitsToClear = ShiftAmt &lt; BitsToClear ? BitsToClear - ShiftAmt : 0;</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    }</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;  <span class="keywordflow">case</span> Instruction::LShr:</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;    <span class="comment">// We can promote lshr(x, cst) if we can promote x.  This requires the</span></div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    <span class="comment">// ultimate &#39;and&#39; to clear out the high zero bits we&#39;re clearing out though.</span></div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *Amt = dyn_cast&lt;ConstantInt&gt;(I-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(1))) {</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="InstCombineCasts_8cpp.html#a39b384f8e288556dc7732b655b848692">CanEvaluateZExtd</a>(I-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0), Ty, BitsToClear))</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;      BitsToClear += Amt-&gt;getZExtValue();</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;      <span class="keywordflow">if</span> (BitsToClear &gt; V-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#ad979b3c1bc975ee23810e3018ffe951b">getScalarSizeInBits</a>())</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;        BitsToClear = V-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#ad979b3c1bc975ee23810e3018ffe951b">getScalarSizeInBits</a>();</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;    }</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;    <span class="comment">// Cannot promote variable LSHR.</span></div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1MCID.html#a8035044d40d3758eb45b65dce69dc90ba32dbd2c72a98eaee90e3ad5ef7b5af16">Instruction::Select</a>:</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="InstCombineCasts_8cpp.html#a39b384f8e288556dc7732b655b848692">CanEvaluateZExtd</a>(I-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(1), Ty, Tmp) ||</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;        !<a class="code" href="InstCombineCasts_8cpp.html#a39b384f8e288556dc7732b655b848692">CanEvaluateZExtd</a>(I-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(2), Ty, BitsToClear) ||</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;        <span class="comment">// TODO: If important, we could handle the case when the BitsToClear are</span></div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;        <span class="comment">// known zero in the disagreeing side.</span></div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;        Tmp != BitsToClear)</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1TargetOpcode.html#a348d4259b5fa6a8ecfe94e7ae512e1a8ae41f9ca68ba5e8b9613cea03652ebd72">Instruction::PHI</a>: {</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;    <span class="comment">// We can change a phi if we can change all operands.  Note that we never</span></div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;    <span class="comment">// get into trouble with cyclic PHIs here because we only consider</span></div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;    <span class="comment">// instructions with a single use.</span></div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;    <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *PN = cast&lt;PHINode&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="InstCombineCasts_8cpp.html#a39b384f8e288556dc7732b655b848692">CanEvaluateZExtd</a>(PN-&gt;<a class="code" href="classllvm_1_1PHINode.html#aba6a4cc4ed6d6fef3664b8d65ef04820">getIncomingValue</a>(0), Ty, BitsToClear))</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 1, e = PN-&gt;<a class="code" href="classllvm_1_1PHINode.html#aa45f6c0433576e3858a6209a43750ad4">getNumIncomingValues</a>(); <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != e; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="InstCombineCasts_8cpp.html#a39b384f8e288556dc7732b655b848692">CanEvaluateZExtd</a>(PN-&gt;<a class="code" href="classllvm_1_1PHINode.html#aba6a4cc4ed6d6fef3664b8d65ef04820">getIncomingValue</a>(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>), Ty, Tmp) ||</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;          <span class="comment">// TODO: If important, we could handle the case when the BitsToClear</span></div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;          <span class="comment">// are known zero in the disagreeing input.</span></div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;          Tmp != BitsToClear)</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;  }</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;  <span class="keywordflow">default</span>:</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;    <span class="comment">// TODO: Can handle more cases here.</span></div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;  }</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;}</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;</div><div class="line"><a name="l00757"></a><span class="lineno"><a class="line" href="classllvm_1_1InstCombiner.html#acab69d70075956abdfb5ccbdbdbb9e15">  757</a></span>&#160;<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="classllvm_1_1InstCombiner.html#acab69d70075956abdfb5ccbdbdbb9e15">InstCombiner::visitZExt</a>(<a class="code" href="classllvm_1_1ZExtInst.html">ZExtInst</a> &amp;CI) {</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;  <span class="comment">// If this zero extend is only used by a truncate, let the truncate be</span></div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;  <span class="comment">// eliminated before we try to optimize this zext.</span></div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;  <span class="keywordflow">if</span> (CI.<a class="code" href="classllvm_1_1Value.html#a085b82f074c28030fb8e194377ed2d0c">hasOneUse</a>() &amp;&amp; isa&lt;TruncInst&gt;(CI.<a class="code" href="classllvm_1_1Instruction.html#a5ac211f24970dea81fa9a7118a8ce36b">use_back</a>()))</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;  <span class="comment">// If one of the common conversion will work, do it.</span></div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *Result = commonCastTransforms(CI))</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;    <span class="keywordflow">return</span> Result;</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;  <span class="comment">// See if we can simplify any instructions used by the input whose sole</span></div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;  <span class="comment">// purpose is to compute bits we don&#39;t care about.</span></div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;  <span class="keywordflow">if</span> (SimplifyDemandedInstructionBits(CI))</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;    <span class="keywordflow">return</span> &amp;CI;</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Src = CI.<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0);</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *SrcTy = Src-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>(), *DestTy = CI.<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>();</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;  <span class="comment">// Attempt to extend the entire input expression tree to the destination</span></div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;  <span class="comment">// type.   Only do this if the dest type is a simple type, don&#39;t convert the</span></div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;  <span class="comment">// expression tree to something weird like i93 unless the source is also</span></div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;  <span class="comment">// strange.</span></div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;  <span class="keywordtype">unsigned</span> BitsToClear;</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;  <span class="keywordflow">if</span> ((DestTy-&gt;isVectorTy() || ShouldChangeType(SrcTy, DestTy)) &amp;&amp;</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;      <a class="code" href="InstCombineCasts_8cpp.html#a39b384f8e288556dc7732b655b848692">CanEvaluateZExtd</a>(Src, DestTy, BitsToClear)) {</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;    assert(BitsToClear &lt; SrcTy-&gt;getScalarSizeInBits() &amp;&amp;</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;           <span class="stringliteral">&quot;Unreasonable BitsToClear&quot;</span>);</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;    <span class="comment">// Okay, we can transform this!  Insert the new expression now.</span></div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;    <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;ICE: EvaluateInDifferentType converting expression type&quot;</span></div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;          <span class="stringliteral">&quot; to avoid zero extend: &quot;</span> &lt;&lt; CI);</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *Res = EvaluateInDifferentType(Src, DestTy, <span class="keyword">false</span>);</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;    assert(Res-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>() == DestTy);</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;    uint32_t SrcBitsKept = SrcTy-&gt;<a class="code" href="classllvm_1_1Type.html#ad979b3c1bc975ee23810e3018ffe951b">getScalarSizeInBits</a>()-BitsToClear;</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;    uint32_t DestBitSize = DestTy-&gt;getScalarSizeInBits();</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;    <span class="comment">// If the high bits are already filled with zeros, just replace this</span></div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;    <span class="comment">// cast with the result.</span></div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#a8bc4c3e77e6f3d6c54b8b4504393dfa7">MaskedValueIsZero</a>(Res, <a class="code" href="classllvm_1_1APInt.html#adcb96bd09d7c75c7669fa5f9d1190899">APInt::getHighBitsSet</a>(DestBitSize,</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;                                                     DestBitSize-SrcBitsKept)))</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;      <span class="keywordflow">return</span> ReplaceInstUsesWith(CI, Res);</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;    <span class="comment">// We need to emit an AND to clear the high bits.</span></div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;    <a class="code" href="classllvm_1_1Constant.html">Constant</a> *<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = <a class="code" href="classllvm_1_1ConstantInt.html#a9105541412dab869e18b3cceebfff07d">ConstantInt::get</a>(Res-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>(),</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;                               <a class="code" href="classllvm_1_1APInt.html#ad960e1ff48d25c382b6d28e7961f074e">APInt::getLowBitsSet</a>(DestBitSize, SrcBitsKept));</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;    <span class="keywordflow">return</span> BinaryOperator::CreateAnd(Res, C);</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;  }</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;  <span class="comment">// If this is a TRUNC followed by a ZEXT then we are dealing with integral</span></div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;  <span class="comment">// types and if the sizes are just right we can convert this into a logical</span></div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;  <span class="comment">// &#39;and&#39; which will be much cheaper than the pair of casts.</span></div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1TruncInst.html">TruncInst</a> *CSrc = dyn_cast&lt;TruncInst&gt;(Src)) {   <span class="comment">// A-&gt;B-&gt;C cast</span></div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;    <span class="comment">// TODO: Subsume this into EvaluateInDifferentType.</span></div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;    <span class="comment">// Get the sizes of the types involved.  We know that the intermediate type</span></div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;    <span class="comment">// will be smaller than A or C, but don&#39;t know the relation between A and C.</span></div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a> = CSrc-&gt;getOperand(0);</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;    <span class="keywordtype">unsigned</span> SrcSize = A-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#ad979b3c1bc975ee23810e3018ffe951b">getScalarSizeInBits</a>();</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;    <span class="keywordtype">unsigned</span> MidSize = CSrc-&gt;getType()-&gt;getScalarSizeInBits();</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;    <span class="keywordtype">unsigned</span> DstSize = CI.<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#ad979b3c1bc975ee23810e3018ffe951b">getScalarSizeInBits</a>();</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;    <span class="comment">// If we&#39;re actually extending zero bits, then if</span></div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;    <span class="comment">// SrcSize &lt;  DstSize: zext(a &amp; mask)</span></div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;    <span class="comment">// SrcSize == DstSize: a &amp; mask</span></div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;    <span class="comment">// SrcSize  &gt; DstSize: trunc(a) &amp; mask</span></div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;    <span class="keywordflow">if</span> (SrcSize &lt; DstSize) {</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;      <a class="code" href="classllvm_1_1APInt.html">APInt</a> AndValue(<a class="code" href="classllvm_1_1APInt.html#ad960e1ff48d25c382b6d28e7961f074e">APInt::getLowBitsSet</a>(SrcSize, MidSize));</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;      <a class="code" href="classllvm_1_1Constant.html">Constant</a> *AndConst = <a class="code" href="classllvm_1_1ConstantInt.html#a9105541412dab869e18b3cceebfff07d">ConstantInt::get</a>(A-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>(), AndValue);</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1APIntOps.html#a684cfe02c582e8d75cd6d457e63e6c25">And</a> = Builder-&gt;CreateAnd(A, AndConst, CSrc-&gt;<a class="code" href="classllvm_1_1Value.html#ad452febc1ac0b394876e640ec03ffa38">getName</a>()+<span class="stringliteral">&quot;.mask&quot;</span>);</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="classllvm_1_1ZExtInst.html">ZExtInst</a>(And, CI.<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>());</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;    }</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;    <span class="keywordflow">if</span> (SrcSize == DstSize) {</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;      <a class="code" href="classllvm_1_1APInt.html">APInt</a> AndValue(<a class="code" href="classllvm_1_1APInt.html#ad960e1ff48d25c382b6d28e7961f074e">APInt::getLowBitsSet</a>(SrcSize, MidSize));</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;      <span class="keywordflow">return</span> BinaryOperator::CreateAnd(A, <a class="code" href="classllvm_1_1ConstantInt.html#a9105541412dab869e18b3cceebfff07d">ConstantInt::get</a>(A-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>(),</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;                                                           AndValue));</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;    }</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;    <span class="keywordflow">if</span> (SrcSize &gt; DstSize) {</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *Trunc = Builder-&gt;CreateTrunc(A, CI.<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>());</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;      <a class="code" href="classllvm_1_1APInt.html">APInt</a> AndValue(<a class="code" href="classllvm_1_1APInt.html#ad960e1ff48d25c382b6d28e7961f074e">APInt::getLowBitsSet</a>(DstSize, MidSize));</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;      <span class="keywordflow">return</span> BinaryOperator::CreateAnd(Trunc,</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;                                       <a class="code" href="classllvm_1_1ConstantInt.html#a9105541412dab869e18b3cceebfff07d">ConstantInt::get</a>(Trunc-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>(),</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;                                                        AndValue));</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;    }</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;  }</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1ICmpInst.html">ICmpInst</a> *ICI = dyn_cast&lt;ICmpInst&gt;(Src))</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;    <span class="keywordflow">return</span> transformZExtICmp(ICI, CI);</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;  <a class="code" href="classllvm_1_1BinaryOperator.html">BinaryOperator</a> *SrcI = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1BinaryOperator.html">BinaryOperator</a>&gt;(Src);</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;  <span class="keywordflow">if</span> (SrcI &amp;&amp; SrcI-&gt;<a class="code" href="classllvm_1_1BinaryOperator.html#a88505baf41407782678a5df1702d2d31">getOpcode</a>() == <a class="code" href="namespacellvm_1_1APIntOps.html#a22f056804d2b9882f74adc905872bc39">Instruction::Or</a>) {</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;    <span class="comment">// zext (or icmp, icmp) --&gt; or (zext icmp), (zext icmp) if at least one</span></div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;    <span class="comment">// of the (zext icmp) will be transformed.</span></div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;    <a class="code" href="classllvm_1_1ICmpInst.html">ICmpInst</a> *LHS = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ICmpInst.html">ICmpInst</a>&gt;(SrcI-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0));</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;    <a class="code" href="classllvm_1_1ICmpInst.html">ICmpInst</a> *RHS = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ICmpInst.html">ICmpInst</a>&gt;(SrcI-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(1));</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;    <span class="keywordflow">if</span> (LHS &amp;&amp; RHS &amp;&amp; LHS-&gt;<a class="code" href="classllvm_1_1Value.html#a085b82f074c28030fb8e194377ed2d0c">hasOneUse</a>() &amp;&amp; RHS-&gt;hasOneUse() &amp;&amp;</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;        (transformZExtICmp(LHS, CI, <span class="keyword">false</span>) ||</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;         transformZExtICmp(RHS, CI, <span class="keyword">false</span>))) {</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *LCast = Builder-&gt;CreateZExt(LHS, CI.<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>(), LHS-&gt;<a class="code" href="classllvm_1_1Value.html#ad452febc1ac0b394876e640ec03ffa38">getName</a>());</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *RCast = Builder-&gt;CreateZExt(RHS, CI.<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>(), RHS-&gt;getName());</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1BinaryOperator.html#a4a4628e91a9c6a339fa61105614fac76">BinaryOperator::Create</a>(<a class="code" href="namespacellvm_1_1APIntOps.html#a22f056804d2b9882f74adc905872bc39">Instruction::Or</a>, LCast, RCast);</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;    }</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;  }</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;  <span class="comment">// zext(trunc(t) &amp; C) -&gt; (t &amp; zext(C)).</span></div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;  <span class="keywordflow">if</span> (SrcI &amp;&amp; SrcI-&gt;<a class="code" href="classllvm_1_1BinaryOperator.html#a88505baf41407782678a5df1702d2d31">getOpcode</a>() == <a class="code" href="namespacellvm_1_1APIntOps.html#a684cfe02c582e8d75cd6d457e63e6c25">Instruction::And</a> &amp;&amp; SrcI-&gt;<a class="code" href="classllvm_1_1Value.html#a085b82f074c28030fb8e194377ed2d0c">hasOneUse</a>())</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = dyn_cast&lt;ConstantInt&gt;(SrcI-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(1)))</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1TruncInst.html">TruncInst</a> *TI = dyn_cast&lt;TruncInst&gt;(SrcI-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0))) {</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;        <a class="code" href="classllvm_1_1Value.html">Value</a> *TI0 = TI-&gt;getOperand(0);</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;        <span class="keywordflow">if</span> (TI0-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>() == CI.<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>())</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;          <span class="keywordflow">return</span></div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;            BinaryOperator::CreateAnd(TI0,</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;                                <a class="code" href="classllvm_1_1ConstantExpr.html#a80e82791d4d7f4d1d23d68ca0a2b1f64">ConstantExpr::getZExt</a>(<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>, CI.<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>()));</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;      }</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;  <span class="comment">// zext((trunc(t) &amp; C) ^ C) -&gt; ((t &amp; zext(C)) ^ zext(C)).</span></div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;  <span class="keywordflow">if</span> (SrcI &amp;&amp; SrcI-&gt;<a class="code" href="classllvm_1_1BinaryOperator.html#a88505baf41407782678a5df1702d2d31">getOpcode</a>() == <a class="code" href="namespacellvm_1_1APIntOps.html#afc7c4d88d09cba0c5e920f8a3a3ace55">Instruction::Xor</a> &amp;&amp; SrcI-&gt;<a class="code" href="classllvm_1_1Value.html#a085b82f074c28030fb8e194377ed2d0c">hasOneUse</a>())</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = dyn_cast&lt;ConstantInt&gt;(SrcI-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(1)))</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1BinaryOperator.html">BinaryOperator</a> *<a class="code" href="namespacellvm_1_1APIntOps.html#a684cfe02c582e8d75cd6d457e63e6c25">And</a> = dyn_cast&lt;BinaryOperator&gt;(SrcI-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0)))</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1APIntOps.html#a684cfe02c582e8d75cd6d457e63e6c25">And</a>-&gt;getOpcode() == <a class="code" href="namespacellvm_1_1APIntOps.html#a684cfe02c582e8d75cd6d457e63e6c25">Instruction::And</a> &amp;&amp; <a class="code" href="namespacellvm_1_1APIntOps.html#a684cfe02c582e8d75cd6d457e63e6c25">And</a>-&gt;hasOneUse() &amp;&amp;</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;            <a class="code" href="namespacellvm_1_1APIntOps.html#a684cfe02c582e8d75cd6d457e63e6c25">And</a>-&gt;getOperand(1) == <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>)</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1TruncInst.html">TruncInst</a> *TI = dyn_cast&lt;TruncInst&gt;(<a class="code" href="namespacellvm_1_1APIntOps.html#a684cfe02c582e8d75cd6d457e63e6c25">And</a>-&gt;getOperand(0))) {</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;            <a class="code" href="classllvm_1_1Value.html">Value</a> *TI0 = TI-&gt;getOperand(0);</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;            <span class="keywordflow">if</span> (TI0-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>() == CI.<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>()) {</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;              <a class="code" href="classllvm_1_1Constant.html">Constant</a> *ZC = <a class="code" href="classllvm_1_1ConstantExpr.html#a80e82791d4d7f4d1d23d68ca0a2b1f64">ConstantExpr::getZExt</a>(<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>, CI.<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>());</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;              <a class="code" href="classllvm_1_1Value.html">Value</a> *NewAnd = Builder-&gt;CreateAnd(TI0, ZC);</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;              <span class="keywordflow">return</span> BinaryOperator::CreateXor(NewAnd, ZC);</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;            }</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;          }</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;  <span class="comment">// zext (xor i1 X, true) to i32  --&gt; xor (zext i1 X to i32), 1</span></div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm.html#a6569d00d31a5d74e563e2f39f82271ab">X</a>;</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;  <span class="keywordflow">if</span> (SrcI &amp;&amp; SrcI-&gt;<a class="code" href="classllvm_1_1Value.html#a085b82f074c28030fb8e194377ed2d0c">hasOneUse</a>() &amp;&amp; SrcI-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a6e328feb83afa5cf1c966d6704e43fc1">isIntegerTy</a>(1) &amp;&amp;</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;      <a class="code" href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">match</a>(SrcI, <a class="code" href="namespacellvm_1_1PatternMatch.html#a4cfd328368353696e64a4d1b15a7cbfa">m_Not</a>(<a class="code" href="namespacellvm_1_1PatternMatch.html#a24bca8838396aa81b87de8e7ac774b19">m_Value</a>(X))) &amp;&amp;</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;      (!X-&gt;<a class="code" href="classllvm_1_1Value.html#a085b82f074c28030fb8e194377ed2d0c">hasOneUse</a>() || !isa&lt;CmpInst&gt;(<a class="code" href="namespacellvm.html#a6569d00d31a5d74e563e2f39f82271ab">X</a>))) {</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *New = Builder-&gt;CreateZExt(X, CI.<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>());</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;    <span class="keywordflow">return</span> BinaryOperator::CreateXor(New, <a class="code" href="classllvm_1_1ConstantInt.html#a9105541412dab869e18b3cceebfff07d">ConstantInt::get</a>(CI.<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>(), 1));</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;  }</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;}</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;<span class="comment">/// transformSExtICmp - Transform (sext icmp) to bitwise / integer operations</span></div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;<span class="comment">/// in order to eliminate the icmp.</span></div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;<span class="comment"></span><a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *InstCombiner::transformSExtICmp(<a class="code" href="classllvm_1_1ICmpInst.html">ICmpInst</a> *ICI, <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;CI) {</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Op0 = ICI-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0), *Op1 = ICI-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(1);</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;  <a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05">ICmpInst::Predicate</a> Pred = ICI-&gt;<a class="code" href="classllvm_1_1CmpInst.html#a8afd4995fae596b2c86eeed85b3d388b">getPredicate</a>();</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *Op1C = dyn_cast&lt;ConstantInt&gt;(Op1)) {</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;    <span class="comment">// (x &lt;s  0) ? -1 : 0 -&gt; ashr x, 31        -&gt; all ones if negative</span></div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;    <span class="comment">// (x &gt;s -1) ? -1 : 0 -&gt; not (ashr x, 31)  -&gt; all ones if positive</span></div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;    <span class="keywordflow">if</span> ((Pred == <a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05a15ae464950ac676919c2f0c7aafc706c">ICmpInst::ICMP_SLT</a> &amp;&amp; Op1C-&gt;isZero()) ||</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;        (Pred == <a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05a720a42e85f7e981afd61e28473b0000a">ICmpInst::ICMP_SGT</a> &amp;&amp; Op1C-&gt;isAllOnesValue())) {</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *Sh = <a class="code" href="classllvm_1_1ConstantInt.html#a9105541412dab869e18b3cceebfff07d">ConstantInt::get</a>(Op0-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>(),</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;                                   Op0-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#ad979b3c1bc975ee23810e3018ffe951b">getScalarSizeInBits</a>()-1);</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5a5fa7b4069ef3bd1ceb9f2caa315cf5ac">In</a> = Builder-&gt;CreateAShr(Op0, Sh, Op0-&gt;<a class="code" href="classllvm_1_1Value.html#ad452febc1ac0b394876e640ec03ffa38">getName</a>()+<span class="stringliteral">&quot;.lobit&quot;</span>);</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;      <span class="keywordflow">if</span> (In-&gt;getType() != CI.<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>())</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;        In = Builder-&gt;CreateIntCast(In, CI.<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>(), <span class="keyword">true</span><span class="comment">/*SExt*/</span>);</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;      <span class="keywordflow">if</span> (Pred == <a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05a720a42e85f7e981afd61e28473b0000a">ICmpInst::ICMP_SGT</a>)</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;        In = Builder-&gt;CreateNot(In, In-&gt;getName()+<span class="stringliteral">&quot;.not&quot;</span>);</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;      <span class="keywordflow">return</span> ReplaceInstUsesWith(CI, In);</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;    }</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;    <span class="comment">// If we know that only one bit of the LHS of the icmp can be set and we</span></div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;    <span class="comment">// have an equality comparison with zero or a power of 2, we can transform</span></div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;    <span class="comment">// the icmp and sext into bitwise/integer operations.</span></div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;    <span class="keywordflow">if</span> (ICI-&gt;<a class="code" href="classllvm_1_1Value.html#a085b82f074c28030fb8e194377ed2d0c">hasOneUse</a>() &amp;&amp;</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;        ICI-&gt;<a class="code" href="classllvm_1_1ICmpInst.html#abe8988eef2e6fc2baba032cb22afedd7">isEquality</a>() &amp;&amp; (Op1C-&gt;isZero() || Op1C-&gt;getValue().isPowerOf2())){</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;      <span class="keywordtype">unsigned</span> BitWidth = Op1C-&gt;getType()-&gt;getBitWidth();</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;      <a class="code" href="classllvm_1_1APInt.html">APInt</a> KnownZero(BitWidth, 0), KnownOne(BitWidth, 0);</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;      <a class="code" href="namespacellvm.html#a7985318bedfe5c2040025ef13db9c57b">ComputeMaskedBits</a>(Op0, KnownZero, KnownOne);</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;      <a class="code" href="classllvm_1_1APInt.html">APInt</a> KnownZeroMask(~KnownZero);</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;      <span class="keywordflow">if</span> (KnownZeroMask.<a class="code" href="classllvm_1_1APInt.html#af3deb6522c4fe2043fe07af2ec90190c">isPowerOf2</a>()) {</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;        <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5a5fa7b4069ef3bd1ceb9f2caa315cf5ac">In</a> = ICI-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0);</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;        <span class="comment">// If the icmp tests for a known zero bit we can constant fold it.</span></div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;        <span class="keywordflow">if</span> (!Op1C-&gt;isZero() &amp;&amp; Op1C-&gt;getValue() != KnownZeroMask) {</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;          <a class="code" href="classllvm_1_1Value.html">Value</a> *V = Pred == <a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05ac17897ebf2f6a6986280fc3bdf28a30a">ICmpInst::ICMP_NE</a> ?</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;                       <a class="code" href="classllvm_1_1Constant.html#a4d51384de6e1798bb6aa875aebeea9f0">ConstantInt::getAllOnesValue</a>(CI.<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>()) :</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;                       <a class="code" href="classllvm_1_1Constant.html#aa6574d526b3e38a28f688a7bb4325c2c">ConstantInt::getNullValue</a>(CI.<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>());</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;          <span class="keywordflow">return</span> ReplaceInstUsesWith(CI, V);</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;        }</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;        <span class="keywordflow">if</span> (!Op1C-&gt;isZero() == (Pred == <a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05ac17897ebf2f6a6986280fc3bdf28a30a">ICmpInst::ICMP_NE</a>)) {</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;          <span class="comment">// sext ((x &amp; 2^n) == 0)   -&gt; (x &gt;&gt; n) - 1</span></div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;          <span class="comment">// sext ((x &amp; 2^n) != 2^n) -&gt; (x &gt;&gt; n) - 1</span></div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;          <span class="keywordtype">unsigned</span> ShiftAmt = KnownZeroMask.<a class="code" href="classllvm_1_1APInt.html#aac277496191547e487eea07f09dffd4b">countTrailingZeros</a>();</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;          <span class="comment">// Perform a right shift to place the desired bit in the LSB.</span></div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;          <span class="keywordflow">if</span> (ShiftAmt)</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;            In = Builder-&gt;CreateLShr(In,</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;                                     <a class="code" href="classllvm_1_1ConstantInt.html#a9105541412dab869e18b3cceebfff07d">ConstantInt::get</a>(In-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>(), ShiftAmt));</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;          <span class="comment">// At this point &quot;In&quot; is either 1 or 0. Subtract 1 to turn</span></div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;          <span class="comment">// {1, 0} -&gt; {0, -1}.</span></div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;          In = Builder-&gt;CreateAdd(In,</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;                                  <a class="code" href="classllvm_1_1Constant.html#a4d51384de6e1798bb6aa875aebeea9f0">ConstantInt::getAllOnesValue</a>(In-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>()),</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;                                  <span class="stringliteral">&quot;sext&quot;</span>);</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;          <span class="comment">// sext ((x &amp; 2^n) != 0)   -&gt; (x &lt;&lt; bitwidth-n) a&gt;&gt; bitwidth-1</span></div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;          <span class="comment">// sext ((x &amp; 2^n) == 2^n) -&gt; (x &lt;&lt; bitwidth-n) a&gt;&gt; bitwidth-1</span></div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;          <span class="keywordtype">unsigned</span> ShiftAmt = KnownZeroMask.<a class="code" href="classllvm_1_1APInt.html#af0336ea4c7f7f56354b2ca7c8859c1f9">countLeadingZeros</a>();</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;          <span class="comment">// Perform a left shift to place the desired bit in the MSB.</span></div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;          <span class="keywordflow">if</span> (ShiftAmt)</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;            In = Builder-&gt;CreateShl(In,</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;                                    <a class="code" href="classllvm_1_1ConstantInt.html#a9105541412dab869e18b3cceebfff07d">ConstantInt::get</a>(In-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>(), ShiftAmt));</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;          <span class="comment">// Distribute the bit over the whole bit width.</span></div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;          In = Builder-&gt;CreateAShr(In, <a class="code" href="classllvm_1_1ConstantInt.html#a9105541412dab869e18b3cceebfff07d">ConstantInt::get</a>(In-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>(),</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;                                                        BitWidth - 1), <span class="stringliteral">&quot;sext&quot;</span>);</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;        }</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;        <span class="keywordflow">if</span> (CI.<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>() == In-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>())</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;          <span class="keywordflow">return</span> ReplaceInstUsesWith(CI, In);</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1CastInst.html#ae96aa53c0b7c0eb9ec680db6a43abaa7">CastInst::CreateIntegerCast</a>(In, CI.<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>(), <span class="keyword">true</span><span class="comment">/*SExt*/</span>);</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;      }</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;    }</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;  }</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;  <span class="comment">// vector (x &lt;s 0) ? -1 : 0 -&gt; ashr x, 31   -&gt; all ones if signed.</span></div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1VectorType.html">VectorType</a> *VTy = dyn_cast&lt;VectorType&gt;(CI.<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>())) {</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;    <span class="keywordflow">if</span> (Pred == <a class="code" href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05a15ae464950ac676919c2f0c7aafc706c">ICmpInst::ICMP_SLT</a> &amp;&amp; <a class="code" href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">match</a>(Op1, <a class="code" href="namespacellvm_1_1PatternMatch.html#ab3b5beca3a0dedd21adac813123a2ae6">m_Zero</a>()) &amp;&amp;</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;        Op0-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>() == CI.<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>()) {</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;      <a class="code" href="classllvm_1_1Type.html">Type</a> *EltTy = VTy-&gt;getElementType();</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;      <span class="comment">// splat the shift constant to a constant vector.</span></div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;      <a class="code" href="classllvm_1_1Constant.html">Constant</a> *VSh = <a class="code" href="classllvm_1_1ConstantInt.html#a9105541412dab869e18b3cceebfff07d">ConstantInt::get</a>(VTy, EltTy-&gt;<a class="code" href="classllvm_1_1Type.html#ad979b3c1bc975ee23810e3018ffe951b">getScalarSizeInBits</a>()-1);</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5a5fa7b4069ef3bd1ceb9f2caa315cf5ac">In</a> = Builder-&gt;CreateAShr(Op0, VSh, Op0-&gt;<a class="code" href="classllvm_1_1Value.html#ad452febc1ac0b394876e640ec03ffa38">getName</a>()+<span class="stringliteral">&quot;.lobit&quot;</span>);</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;      <span class="keywordflow">return</span> ReplaceInstUsesWith(CI, In);</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;    }</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;  }</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;}</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;<span class="comment">/// CanEvaluateSExtd - Return true if we can take the specified value</span></div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;<span class="comment">/// and return it as type Ty without inserting any new casts and without</span></div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;<span class="comment">/// changing the value of the common low bits.  This is used by code that tries</span></div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;<span class="comment">/// to promote integer operations to a wider types will allow us to eliminate</span></div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;<span class="comment">/// the extension.</span></div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;<span class="comment">/// This function works on both vectors and scalars.</span></div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l01002"></a><span class="lineno"><a class="line" href="InstCombineCasts_8cpp.html#a0001ad4269d3a92e51c5f8371b38364e"> 1002</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="InstCombineCasts_8cpp.html#a0001ad4269d3a92e51c5f8371b38364e">CanEvaluateSExtd</a>(<a class="code" href="classllvm_1_1Value.html">Value</a> *V, <a class="code" href="classllvm_1_1Type.html">Type</a> *Ty) {</div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;  assert(V-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#ad979b3c1bc975ee23810e3018ffe951b">getScalarSizeInBits</a>() &lt; Ty-&gt;<a class="code" href="classllvm_1_1Type.html#ad979b3c1bc975ee23810e3018ffe951b">getScalarSizeInBits</a>() &amp;&amp;</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;         <span class="stringliteral">&quot;Can&#39;t sign extend type to a smaller type&quot;</span>);</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;  <span class="comment">// If this is a constant, it can be trivially promoted.</span></div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;  <span class="keywordflow">if</span> (isa&lt;Constant&gt;(V))</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;</div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1Instruction.html">Instruction</a>&gt;(V);</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;  <span class="keywordflow">if</span> (!I) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;  <span class="comment">// If this is a truncate from the dest type, we can trivially eliminate it.</span></div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;  <span class="keywordflow">if</span> (isa&lt;TruncInst&gt;(I) &amp;&amp; I-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0)-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>() == Ty)</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;  <span class="comment">// We can&#39;t extend or shrink something that has multiple uses: doing so would</span></div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;  <span class="comment">// require duplicating the instruction in general, which isn&#39;t profitable.</span></div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;  <span class="keywordflow">if</span> (!I-&gt;<a class="code" href="classllvm_1_1Value.html#a085b82f074c28030fb8e194377ed2d0c">hasOneUse</a>()) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;  <span class="keywordflow">switch</span> (I-&gt;<a class="code" href="classllvm_1_1Instruction.html#a021bb7c9aad6003fe8089f6327356c6c">getOpcode</a>()) {</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;  <span class="keywordflow">case</span> Instruction::SExt:  <span class="comment">// sext(sext(x)) -&gt; sext(x)</span></div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;  <span class="keywordflow">case</span> Instruction::ZExt:  <span class="comment">// sext(zext(x)) -&gt; zext(x)</span></div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;  <span class="keywordflow">case</span> Instruction::Trunc: <span class="comment">// sext(trunc(x)) -&gt; trunc(x) or sext(x)</span></div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1APIntOps.html#a684cfe02c582e8d75cd6d457e63e6c25">Instruction::And</a>:</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1APIntOps.html#a22f056804d2b9882f74adc905872bc39">Instruction::Or</a>:</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1APIntOps.html#afc7c4d88d09cba0c5e920f8a3a3ace55">Instruction::Xor</a>:</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;  <span class="keywordflow">case</span> Instruction::Add:</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;  <span class="keywordflow">case</span> Instruction::Sub:</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;  <span class="keywordflow">case</span> Instruction::Mul:</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;    <span class="comment">// These operators can all arbitrarily be extended if their inputs can.</span></div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="InstCombineCasts_8cpp.html#a0001ad4269d3a92e51c5f8371b38364e">CanEvaluateSExtd</a>(I-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0), Ty) &amp;&amp;</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;           <a class="code" href="InstCombineCasts_8cpp.html#a0001ad4269d3a92e51c5f8371b38364e">CanEvaluateSExtd</a>(I-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(1), Ty);</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;  <span class="comment">//case Instruction::Shl:   TODO</span></div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;  <span class="comment">//case Instruction::LShr:  TODO</span></div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1MCID.html#a8035044d40d3758eb45b65dce69dc90ba32dbd2c72a98eaee90e3ad5ef7b5af16">Instruction::Select</a>:</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="InstCombineCasts_8cpp.html#a0001ad4269d3a92e51c5f8371b38364e">CanEvaluateSExtd</a>(I-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(1), Ty) &amp;&amp;</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;           <a class="code" href="InstCombineCasts_8cpp.html#a0001ad4269d3a92e51c5f8371b38364e">CanEvaluateSExtd</a>(I-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(2), Ty);</div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;</div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1TargetOpcode.html#a348d4259b5fa6a8ecfe94e7ae512e1a8ae41f9ca68ba5e8b9613cea03652ebd72">Instruction::PHI</a>: {</div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;    <span class="comment">// We can change a phi if we can change all operands.  Note that we never</span></div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;    <span class="comment">// get into trouble with cyclic PHIs here because we only consider</span></div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;    <span class="comment">// instructions with a single use.</span></div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;    <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *PN = cast&lt;PHINode&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0, e = PN-&gt;<a class="code" href="classllvm_1_1PHINode.html#aa45f6c0433576e3858a6209a43750ad4">getNumIncomingValues</a>(); <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != e; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="InstCombineCasts_8cpp.html#a0001ad4269d3a92e51c5f8371b38364e">CanEvaluateSExtd</a>(PN-&gt;<a class="code" href="classllvm_1_1PHINode.html#aba6a4cc4ed6d6fef3664b8d65ef04820">getIncomingValue</a>(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>), Ty)) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;  }</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;  <span class="keywordflow">default</span>:</div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;    <span class="comment">// TODO: Can handle more cases here.</span></div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;  }</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;}</div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;</div><div class="line"><a name="l01059"></a><span class="lineno"><a class="line" href="classllvm_1_1InstCombiner.html#a5ea211ef2e2bd3fb26510e2e76ada538"> 1059</a></span>&#160;<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="classllvm_1_1InstCombiner.html#a5ea211ef2e2bd3fb26510e2e76ada538">InstCombiner::visitSExt</a>(<a class="code" href="classllvm_1_1SExtInst.html">SExtInst</a> &amp;CI) {</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;  <span class="comment">// If this sign extend is only used by a truncate, let the truncate be</span></div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;  <span class="comment">// eliminated before we try to optimize this sext.</span></div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;  <span class="keywordflow">if</span> (CI.<a class="code" href="classllvm_1_1Value.html#a085b82f074c28030fb8e194377ed2d0c">hasOneUse</a>() &amp;&amp; isa&lt;TruncInst&gt;(CI.<a class="code" href="classllvm_1_1Instruction.html#a5ac211f24970dea81fa9a7118a8ce36b">use_back</a>()))</div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;</div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = commonCastTransforms(CI))</div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>;</div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;</div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;  <span class="comment">// See if we can simplify any instructions used by the input whose sole</span></div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;  <span class="comment">// purpose is to compute bits we don&#39;t care about.</span></div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;  <span class="keywordflow">if</span> (SimplifyDemandedInstructionBits(CI))</div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;    <span class="keywordflow">return</span> &amp;CI;</div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;</div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Src = CI.<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0);</div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *SrcTy = Src-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>(), *DestTy = CI.<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>();</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;</div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;  <span class="comment">// Attempt to extend the entire input expression tree to the destination</span></div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;  <span class="comment">// type.   Only do this if the dest type is a simple type, don&#39;t convert the</span></div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;  <span class="comment">// expression tree to something weird like i93 unless the source is also</span></div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;  <span class="comment">// strange.</span></div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;  <span class="keywordflow">if</span> ((DestTy-&gt;isVectorTy() || ShouldChangeType(SrcTy, DestTy)) &amp;&amp;</div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;      <a class="code" href="InstCombineCasts_8cpp.html#a0001ad4269d3a92e51c5f8371b38364e">CanEvaluateSExtd</a>(Src, DestTy)) {</div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;    <span class="comment">// Okay, we can transform this!  Insert the new expression now.</span></div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;    <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;ICE: EvaluateInDifferentType converting expression type&quot;</span></div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;          <span class="stringliteral">&quot; to avoid sign extend: &quot;</span> &lt;&lt; CI);</div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *Res = EvaluateInDifferentType(Src, DestTy, <span class="keyword">true</span>);</div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;    assert(Res-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>() == DestTy);</div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;</div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;    uint32_t SrcBitSize = SrcTy-&gt;<a class="code" href="classllvm_1_1Type.html#ad979b3c1bc975ee23810e3018ffe951b">getScalarSizeInBits</a>();</div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;    uint32_t DestBitSize = DestTy-&gt;getScalarSizeInBits();</div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;</div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;    <span class="comment">// If the high bits are already filled with sign bit, just replace this</span></div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;    <span class="comment">// cast with the result.</span></div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#a26072ee56129fc3220771cda9f053ecb">ComputeNumSignBits</a>(Res) &gt; DestBitSize - SrcBitSize)</div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;      <span class="keywordflow">return</span> ReplaceInstUsesWith(CI, Res);</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;    <span class="comment">// We need to emit a shl + ashr to do the sign extend.</span></div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *ShAmt = <a class="code" href="classllvm_1_1ConstantInt.html#a9105541412dab869e18b3cceebfff07d">ConstantInt::get</a>(DestTy, DestBitSize-SrcBitSize);</div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;    <span class="keywordflow">return</span> BinaryOperator::CreateAShr(Builder-&gt;CreateShl(Res, ShAmt, <span class="stringliteral">&quot;sext&quot;</span>),</div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;                                      ShAmt);</div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;  }</div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;</div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;  <span class="comment">// If this input is a trunc from our destination, then turn sext(trunc(x))</span></div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;  <span class="comment">// into shifts.</span></div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1TruncInst.html">TruncInst</a> *TI = dyn_cast&lt;TruncInst&gt;(Src))</div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;    <span class="keywordflow">if</span> (TI-&gt;hasOneUse() &amp;&amp; TI-&gt;getOperand(0)-&gt;getType() == DestTy) {</div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;      uint32_t SrcBitSize = SrcTy-&gt;<a class="code" href="classllvm_1_1Type.html#ad979b3c1bc975ee23810e3018ffe951b">getScalarSizeInBits</a>();</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;      uint32_t DestBitSize = DestTy-&gt;getScalarSizeInBits();</div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;</div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;      <span class="comment">// We need to emit a shl + ashr to do the sign extend.</span></div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *ShAmt = <a class="code" href="classllvm_1_1ConstantInt.html#a9105541412dab869e18b3cceebfff07d">ConstantInt::get</a>(DestTy, DestBitSize-SrcBitSize);</div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *Res = Builder-&gt;CreateShl(TI-&gt;getOperand(0), ShAmt, <span class="stringliteral">&quot;sext&quot;</span>);</div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;      <span class="keywordflow">return</span> BinaryOperator::CreateAShr(Res, ShAmt);</div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;    }</div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;</div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1ICmpInst.html">ICmpInst</a> *ICI = dyn_cast&lt;ICmpInst&gt;(Src))</div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;    <span class="keywordflow">return</span> transformSExtICmp(ICI, CI);</div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;</div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;  <span class="comment">// If the input is a shl/ashr pair of a same constant, then this is a sign</span></div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;  <span class="comment">// extension from a smaller value.  If we could trust arbitrary bitwidth</span></div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;  <span class="comment">// integers, we could turn this into a truncate to the smaller bit and then</span></div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;  <span class="comment">// use a sext for the whole extension.  Since we don&#39;t, look deeper and check</span></div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;  <span class="comment">// for a truncate.  If the source and dest are the same type, eliminate the</span></div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;  <span class="comment">// trunc and extend and just do shifts.  For example, turn:</span></div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;  <span class="comment">//   %a = trunc i32 %i to i8</span></div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;  <span class="comment">//   %b = shl i8 %a, 6</span></div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;  <span class="comment">//   %c = ashr i8 %b, 6</span></div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;  <span class="comment">//   %d = sext i8 %c to i32</span></div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;  <span class="comment">// into:</span></div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;  <span class="comment">//   %a = shl i32 %i, 30</span></div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;  <span class="comment">//   %d = ashr i32 %a, 30</span></div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a> = 0;</div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;  <span class="comment">// TODO: Eventually this could be subsumed by EvaluateInDifferentType.</span></div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;  <a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *BA = 0, *CA = 0;</div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">match</a>(Src, <a class="code" href="namespacellvm_1_1PatternMatch.html#a64153676e101a130bbbaaf91635d253a">m_AShr</a>(<a class="code" href="namespacellvm_1_1PatternMatch.html#a37668d9884c78ac77254cf9fb8a4276a">m_Shl</a>(<a class="code" href="namespacellvm_1_1PatternMatch.html#a5b844aada27c4c6fdb87146ac458c0d8">m_Trunc</a>(<a class="code" href="namespacellvm_1_1PatternMatch.html#a24bca8838396aa81b87de8e7ac774b19">m_Value</a>(A)), <a class="code" href="namespacellvm_1_1PatternMatch.html#a34a92072122412c6020d4afb43725bf4">m_ConstantInt</a>(BA)),</div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;                        <a class="code" href="namespacellvm_1_1PatternMatch.html#a34a92072122412c6020d4afb43725bf4">m_ConstantInt</a>(CA))) &amp;&amp;</div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;      BA == CA &amp;&amp; A-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>() == CI.<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>()) {</div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;    <span class="keywordtype">unsigned</span> MidSize = Src-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#ad979b3c1bc975ee23810e3018ffe951b">getScalarSizeInBits</a>();</div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;    <span class="keywordtype">unsigned</span> SrcDstSize = CI.<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#ad979b3c1bc975ee23810e3018ffe951b">getScalarSizeInBits</a>();</div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;    <span class="keywordtype">unsigned</span> ShAmt = CA-&gt;getZExtValue()+SrcDstSize-MidSize;</div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;    <a class="code" href="classllvm_1_1Constant.html">Constant</a> *ShAmtV = <a class="code" href="classllvm_1_1ConstantInt.html#a9105541412dab869e18b3cceebfff07d">ConstantInt::get</a>(CI.<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>(), ShAmt);</div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;    A = Builder-&gt;CreateShl(A, ShAmtV, CI.<a class="code" href="classllvm_1_1Value.html#ad452febc1ac0b394876e640ec03ffa38">getName</a>());</div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;    <span class="keywordflow">return</span> BinaryOperator::CreateAShr(A, ShAmtV);</div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;  }</div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;</div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;}</div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;</div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;<span class="comment">/// FitsInFPType - Return a Constant* for the specified FP constant if it fits</span></div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;<span class="comment">/// in the specified FP type without changing its value.</span></div><div class="line"><a name="l01151"></a><span class="lineno"><a class="line" href="InstCombineCasts_8cpp.html#ad7805b3730b5c1e081569451763e93ae"> 1151</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <a class="code" href="classllvm_1_1Constant.html">Constant</a> *<a class="code" href="InstCombineCasts_8cpp.html#ad7805b3730b5c1e081569451763e93ae">FitsInFPType</a>(<a class="code" href="classllvm_1_1ConstantFP.html">ConstantFP</a> *CFP, <span class="keyword">const</span> <a class="code" href="structllvm_1_1fltSemantics.html">fltSemantics</a> &amp;Sem) {</div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;  <span class="keywordtype">bool</span> losesInfo;</div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;  <a class="code" href="classllvm_1_1APFloat.html">APFloat</a> <a class="code" href="LLParser_8cpp.html#a33ece1ef8074506a15d7f86eb76dbae6">F</a> = CFP-&gt;<a class="code" href="classllvm_1_1ConstantFP.html#a0f839f7633a4709c1d89e128f49b3d43">getValueAPF</a>();</div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;  (void)F.<a class="code" href="classllvm_1_1APFloat.html#a4fa2f1464bb4f645082d8aa0e0a9bc0e">convert</a>(Sem, <a class="code" href="classllvm_1_1APFloat.html#a26f3c979ec46a5d2d9bccd300eb606fea3a561d1750cb3c30d5deb1193c8e1ec5">APFloat::rmNearestTiesToEven</a>, &amp;losesInfo);</div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;  <span class="keywordflow">if</span> (!losesInfo)</div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1ConstantFP.html#a5eb8f7a5d3cfdd127ad9db2e425e14eb">ConstantFP::get</a>(CFP-&gt;<a class="code" href="classllvm_1_1Value.html#af85a4828b6b5a8de7fc0a55cc0e5b52f">getContext</a>(), <a class="code" href="LLParser_8cpp.html#a33ece1ef8074506a15d7f86eb76dbae6">F</a>);</div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;}</div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;<span class="comment">/// LookThroughFPExtensions - If this is an fp extension instruction, look</span></div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;<span class="comment">/// through it until we get the source value.</span></div><div class="line"><a name="l01162"></a><span class="lineno"><a class="line" href="InstCombineCasts_8cpp.html#add636d783011465334249e1e4c64d09b"> 1162</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="InstCombineCasts_8cpp.html#add636d783011465334249e1e4c64d09b">LookThroughFPExtensions</a>(<a class="code" href="classllvm_1_1Value.html">Value</a> *V) {</div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = dyn_cast&lt;Instruction&gt;(V))</div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getOpcode() == Instruction::FPExt)</div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="InstCombineCasts_8cpp.html#add636d783011465334249e1e4c64d09b">LookThroughFPExtensions</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getOperand(0));</div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;</div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;  <span class="comment">// If this value is a constant, return the constant in the smallest FP type</span></div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;  <span class="comment">// that can accurately represent it.  This allows us to turn</span></div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;  <span class="comment">// (float)((double)X+2.0) into x+2.0f.</span></div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1ConstantFP.html">ConstantFP</a> *CFP = dyn_cast&lt;ConstantFP&gt;(V)) {</div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;    <span class="keywordflow">if</span> (CFP-&gt;getType() == <a class="code" href="classllvm_1_1Type.html#a489d14cb1d049f4bcc5e3e9cdaf9c54d">Type::getPPC_FP128Ty</a>(V-&gt;<a class="code" href="classllvm_1_1Value.html#af85a4828b6b5a8de7fc0a55cc0e5b52f">getContext</a>()))</div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;      <span class="keywordflow">return</span> V;  <span class="comment">// No constant folding of this.</span></div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;    <span class="comment">// See if the value can be truncated to half and then reextended.</span></div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *V = <a class="code" href="InstCombineCasts_8cpp.html#ad7805b3730b5c1e081569451763e93ae">FitsInFPType</a>(CFP, <a class="code" href="classllvm_1_1APFloat.html#acd77961b2028e148c829b18ceaef81c4">APFloat::IEEEhalf</a>))</div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;      <span class="keywordflow">return</span> V;</div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;    <span class="comment">// See if the value can be truncated to float and then reextended.</span></div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *V = <a class="code" href="InstCombineCasts_8cpp.html#ad7805b3730b5c1e081569451763e93ae">FitsInFPType</a>(CFP, <a class="code" href="classllvm_1_1APFloat.html#a43f6e79227388f373628e8ddd27df965">APFloat::IEEEsingle</a>))</div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;      <span class="keywordflow">return</span> V;</div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;    <span class="keywordflow">if</span> (CFP-&gt;getType()-&gt;isDoubleTy())</div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;      <span class="keywordflow">return</span> V;  <span class="comment">// Won&#39;t shrink.</span></div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *V = <a class="code" href="InstCombineCasts_8cpp.html#ad7805b3730b5c1e081569451763e93ae">FitsInFPType</a>(CFP, <a class="code" href="classllvm_1_1APFloat.html#aac03c2635e359347d396ddf4d7963b89">APFloat::IEEEdouble</a>))</div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;      <span class="keywordflow">return</span> V;</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;    <span class="comment">// Don&#39;t try to shrink to various long double types.</span></div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;  }</div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;</div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;  <span class="keywordflow">return</span> V;</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;}</div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;</div><div class="line"><a name="l01189"></a><span class="lineno"><a class="line" href="classllvm_1_1InstCombiner.html#aa27131edaba17609df527a66357c31ee"> 1189</a></span>&#160;<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="classllvm_1_1InstCombiner.html#aa27131edaba17609df527a66357c31ee">InstCombiner::visitFPTrunc</a>(<a class="code" href="classllvm_1_1FPTruncInst.html">FPTruncInst</a> &amp;CI) {</div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = commonCastTransforms(CI))</div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>;</div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;</div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;  <span class="comment">// If we have fptrunc(fadd (fpextend x), (fpextend y)), where x and y are</span></div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;  <span class="comment">// smaller than the destination type, we can eliminate the truncate by doing</span></div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;  <span class="comment">// the add as the smaller type.  This applies to fadd/fsub/fmul/fdiv as well</span></div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;  <span class="comment">// as many builtins (sqrt, etc).</span></div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;  <a class="code" href="classllvm_1_1BinaryOperator.html">BinaryOperator</a> *OpI = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1BinaryOperator.html">BinaryOperator</a>&gt;(CI.<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0));</div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;  <span class="keywordflow">if</span> (OpI &amp;&amp; OpI-&gt;<a class="code" href="classllvm_1_1Value.html#a085b82f074c28030fb8e194377ed2d0c">hasOneUse</a>()) {</div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;    <span class="keywordflow">switch</span> (OpI-&gt;<a class="code" href="classllvm_1_1BinaryOperator.html#a88505baf41407782678a5df1702d2d31">getOpcode</a>()) {</div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;    <span class="keywordflow">default</span>: <span class="keywordflow">break</span>;</div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;    <span class="keywordflow">case</span> Instruction::FAdd:</div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;    <span class="keywordflow">case</span> Instruction::FSub:</div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;    <span class="keywordflow">case</span> Instruction::FMul:</div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;    <span class="keywordflow">case</span> Instruction::FDiv:</div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;    <span class="keywordflow">case</span> Instruction::FRem:</div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;      <a class="code" href="classllvm_1_1Type.html">Type</a> *SrcTy = OpI-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>();</div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *LHSTrunc = <a class="code" href="InstCombineCasts_8cpp.html#add636d783011465334249e1e4c64d09b">LookThroughFPExtensions</a>(OpI-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0));</div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *RHSTrunc = <a class="code" href="InstCombineCasts_8cpp.html#add636d783011465334249e1e4c64d09b">LookThroughFPExtensions</a>(OpI-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(1));</div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;      <span class="keywordflow">if</span> (LHSTrunc-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>() != SrcTy &amp;&amp;</div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;          RHSTrunc-&gt;getType() != SrcTy) {</div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;        <span class="keywordtype">unsigned</span> DstSize = CI.<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#ad979b3c1bc975ee23810e3018ffe951b">getScalarSizeInBits</a>();</div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;        <span class="comment">// If the source types were both smaller than the destination type of</span></div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;        <span class="comment">// the cast, do this xform.</span></div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;        <span class="keywordflow">if</span> (LHSTrunc-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#ad979b3c1bc975ee23810e3018ffe951b">getScalarSizeInBits</a>() &lt;= DstSize &amp;&amp;</div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;            RHSTrunc-&gt;getType()-&gt;getScalarSizeInBits() &lt;= DstSize) {</div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;          LHSTrunc = Builder-&gt;CreateFPExt(LHSTrunc, CI.<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>());</div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;          RHSTrunc = Builder-&gt;CreateFPExt(RHSTrunc, CI.<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>());</div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;          <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1BinaryOperator.html#a4a4628e91a9c6a339fa61105614fac76">BinaryOperator::Create</a>(OpI-&gt;<a class="code" href="classllvm_1_1BinaryOperator.html#a88505baf41407782678a5df1702d2d31">getOpcode</a>(), LHSTrunc, RHSTrunc);</div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;        }</div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;      }</div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;    }</div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;</div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;    <span class="comment">// (fptrunc (fneg x)) -&gt; (fneg (fptrunc x))</span></div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1BinaryOperator.html#ab87cae7de3df7420fff131c5305d5b6f">BinaryOperator::isFNeg</a>(OpI)) {</div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *InnerTrunc = Builder-&gt;CreateFPTrunc(OpI-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(1),</div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;                                                 CI.<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>());</div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1BinaryOperator.html#aaf59c6e50e9bb32e189b24c864ac1dad">BinaryOperator::CreateFNeg</a>(InnerTrunc);</div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;    }</div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;  }</div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;</div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;  <span class="comment">// (fptrunc (select cond, R1, Cst)) --&gt;</span></div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;  <span class="comment">// (select cond, (fptrunc R1), (fptrunc Cst))</span></div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;  <a class="code" href="classllvm_1_1SelectInst.html">SelectInst</a> *SI = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1SelectInst.html">SelectInst</a>&gt;(CI.<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0));</div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;  <span class="keywordflow">if</span> (SI &amp;&amp;</div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;      (isa&lt;ConstantFP&gt;(SI-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(1)) ||</div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;       isa&lt;ConstantFP&gt;(SI-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(2)))) {</div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *LHSTrunc = Builder-&gt;CreateFPTrunc(SI-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(1),</div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;                                             CI.<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>());</div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *RHSTrunc = Builder-&gt;CreateFPTrunc(SI-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(2),</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;                                             CI.<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>());</div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SelectInst.html#a8bce457e977f23507c48c9dfd7052990">SelectInst::Create</a>(SI-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0), LHSTrunc, RHSTrunc);</div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;  }</div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;</div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;  <a class="code" href="classllvm_1_1IntrinsicInst.html">IntrinsicInst</a> *II = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1IntrinsicInst.html">IntrinsicInst</a>&gt;(CI.<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0));</div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;  <span class="keywordflow">if</span> (II) {</div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;    <span class="keywordflow">switch</span> (II-&gt;getIntrinsicID()) {</div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;      <span class="keywordflow">default</span>: <span class="keywordflow">break</span>;</div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1Intrinsic.html#a73349916f7e54a6b988a3646c7a02e90ae5cfc8e1a94b46b64a26f1a6cb4e6ba0">Intrinsic::fabs</a>: {</div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;        <span class="comment">// (fptrunc (fabs x)) -&gt; (fabs (fptrunc x))</span></div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;        <a class="code" href="classllvm_1_1Value.html">Value</a> *InnerTrunc = Builder-&gt;CreateFPTrunc(II-&gt;getArgOperand(0),</div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;                                                   CI.<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>());</div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;        <a class="code" href="classllvm_1_1Type.html">Type</a> *IntrinsicType[] = { CI.<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>() };</div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;        <a class="code" href="classllvm_1_1Function.html">Function</a> *Overload =</div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;          <a class="code" href="namespacellvm_1_1Intrinsic.html#a842176a2c8c60a94bc788454b0828ea2">Intrinsic::getDeclaration</a>(CI.<a class="code" href="classllvm_1_1Instruction.html#a9cd49851904f15060edb782ef4dd1b2d">getParent</a>()-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#aca229503e4f5c83a187a6a921c625fa8">getParent</a>()-&gt;<a class="code" href="classllvm_1_1GlobalValue.html#a9e1fc23a17e97d2d1732e753ae9251ac">getParent</a>(),</div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;                                    II-&gt;getIntrinsicID(), IntrinsicType);</div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;</div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;        <a class="code" href="classllvm_1_1Value.html">Value</a> *Args[] = { InnerTrunc };</div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1CallInst.html#a861226dd056dd2438da26760b8e7a9a0">CallInst::Create</a>(Overload, Args, II-&gt;<a class="code" href="classllvm_1_1Value.html#ad452febc1ac0b394876e640ec03ffa38">getName</a>());</div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;      }</div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;    }</div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;  }</div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;</div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;  <span class="comment">// Fold (fptrunc (sqrt (fpext x))) -&gt; (sqrtf x)</span></div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;  <span class="comment">// Note that we restrict this transformation based on</span></div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;  <span class="comment">// TLI-&gt;has(LibFunc::sqrtf), even for the sqrt intrinsic, because</span></div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;  <span class="comment">// TLI-&gt;has(LibFunc::sqrtf) is sufficient to guarantee that the</span></div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;  <span class="comment">// single-precision intrinsic can be expanded in the backend.</span></div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;  <a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *<a class="code" href="namespacellvm.html#af6d6a791770bad2303c4399986979e3eae411369b2f0d8f484fec62c3291b1b51">Call</a> = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1CallInst.html">CallInst</a>&gt;(CI.<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0));</div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;  <span class="keywordflow">if</span> (Call &amp;&amp; Call-&gt;getCalledFunction() &amp;&amp; TLI-&gt;has(<a class="code" href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fa5fe293a4388b5441e4c698d9ce6b0fdf">LibFunc::sqrtf</a>) &amp;&amp;</div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;      (Call-&gt;getCalledFunction()-&gt;getName() == TLI-&gt;getName(<a class="code" href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fac68935baf041f4139079dbd9ddc76698">LibFunc::sqrt</a>) ||</div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;       Call-&gt;getCalledFunction()-&gt;getIntrinsicID() == <a class="code" href="namespacellvm_1_1Intrinsic.html#a73349916f7e54a6b988a3646c7a02e90a2282198fc9635210d0f678fd0b92e5ce">Intrinsic::sqrt</a>) &amp;&amp;</div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;      Call-&gt;getNumArgOperands() == 1 &amp;&amp;</div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;      Call-&gt;hasOneUse()) {</div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;    <a class="code" href="classllvm_1_1CastInst.html">CastInst</a> *Arg = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1CastInst.html">CastInst</a>&gt;(Call-&gt;getArgOperand(0));</div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;    <span class="keywordflow">if</span> (Arg &amp;&amp; Arg-&gt;<a class="code" href="classllvm_1_1CastInst.html#adc3489e61d5f37a0e4c5589859fbccc2">getOpcode</a>() == Instruction::FPExt &amp;&amp;</div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;        CI.<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#aeb06cf0f813f643b62d8dd98db0bc249">isFloatTy</a>() &amp;&amp;</div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;        Call-&gt;getType()-&gt;isDoubleTy() &amp;&amp;</div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;        Arg-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#ac67ad08d36c989a872a887caa72803c6">isDoubleTy</a>() &amp;&amp;</div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;        Arg-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0)-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#aeb06cf0f813f643b62d8dd98db0bc249">isFloatTy</a>()) {</div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;      <a class="code" href="classllvm_1_1Function.html">Function</a> *Callee = Call-&gt;getCalledFunction();</div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;      <a class="code" href="classllvm_1_1Module.html">Module</a> *<a class="code" href="Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a> = CI.<a class="code" href="classllvm_1_1Instruction.html#a9cd49851904f15060edb782ef4dd1b2d">getParent</a>()-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#aca229503e4f5c83a187a6a921c625fa8">getParent</a>()-&gt;<a class="code" href="classllvm_1_1GlobalValue.html#a9e1fc23a17e97d2d1732e753ae9251ac">getParent</a>();</div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;      <a class="code" href="classllvm_1_1Constant.html">Constant</a> *SqrtfFunc = (Callee-&gt;<a class="code" href="classllvm_1_1Function.html#a7e47131185becc5c96731a2e28441b77">getIntrinsicID</a>() == <a class="code" href="namespacellvm_1_1Intrinsic.html#a73349916f7e54a6b988a3646c7a02e90a2282198fc9635210d0f678fd0b92e5ce">Intrinsic::sqrt</a>) ?</div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;        <a class="code" href="namespacellvm_1_1Intrinsic.html#a842176a2c8c60a94bc788454b0828ea2">Intrinsic::getDeclaration</a>(M, <a class="code" href="namespacellvm_1_1Intrinsic.html#a73349916f7e54a6b988a3646c7a02e90a2282198fc9635210d0f678fd0b92e5ce">Intrinsic::sqrt</a>, Builder-&gt;getFloatTy()) :</div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;        M-&gt;<a class="code" href="classllvm_1_1Module.html#a96581205e1149f5d70b56f9a83bc841a">getOrInsertFunction</a>(<span class="stringliteral">&quot;sqrtf&quot;</span>, Callee-&gt;<a class="code" href="classllvm_1_1Function.html#a72873ed64b7be01507a2248b8e756ec8">getAttributes</a>(),</div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;                               Builder-&gt;getFloatTy(), Builder-&gt;getFloatTy(),</div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;                               NULL);</div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;      <a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *<a class="code" href="Target_2X86_2README_8txt.html#a8ef54f27fddd11cc461b2b231fc2d23c">ret</a> = <a class="code" href="classllvm_1_1CallInst.html#a861226dd056dd2438da26760b8e7a9a0">CallInst::Create</a>(SqrtfFunc, Arg-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0),</div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;                                       <span class="stringliteral">&quot;sqrtfcall&quot;</span>);</div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;      ret-&gt;<a class="code" href="classllvm_1_1CallInst.html#a179ef4c643fb35a8dc364e4ae63950f9">setAttributes</a>(Callee-&gt;<a class="code" href="classllvm_1_1Function.html#a72873ed64b7be01507a2248b8e756ec8">getAttributes</a>());</div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;</div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;</div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;      <span class="comment">// Remove the old Call.  With -fmath-errno, it won&#39;t get marked readnone.</span></div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;      ReplaceInstUsesWith(*Call, <a class="code" href="classllvm_1_1UndefValue.html#a4ae5ff22b700a42bcc5d889233721335">UndefValue::get</a>(Call-&gt;getType()));</div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;      EraseInstFromFunction(*Call);</div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="Target_2X86_2README_8txt.html#a8ef54f27fddd11cc461b2b231fc2d23c">ret</a>;</div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;    }</div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;  }</div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;</div><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;}</div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;</div><div class="line"><a name="l01303"></a><span class="lineno"><a class="line" href="classllvm_1_1InstCombiner.html#ae52ecb2fe536b5b853902e15db3c8062"> 1303</a></span>&#160;<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="classllvm_1_1InstCombiner.html#ae52ecb2fe536b5b853902e15db3c8062">InstCombiner::visitFPExt</a>(<a class="code" href="classllvm_1_1CastInst.html">CastInst</a> &amp;CI) {</div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;  <span class="keywordflow">return</span> commonCastTransforms(CI);</div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;}</div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;</div><div class="line"><a name="l01307"></a><span class="lineno"><a class="line" href="classllvm_1_1InstCombiner.html#af1fe6944d91c157469e8f5529e835b17"> 1307</a></span>&#160;<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="classllvm_1_1InstCombiner.html#af1fe6944d91c157469e8f5529e835b17">InstCombiner::visitFPToUI</a>(<a class="code" href="classllvm_1_1FPToUIInst.html">FPToUIInst</a> &amp;FI) {</div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *OpI = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1Instruction.html">Instruction</a>&gt;(FI.<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0));</div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;  <span class="keywordflow">if</span> (OpI == 0)</div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;    <span class="keywordflow">return</span> commonCastTransforms(FI);</div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;</div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;  <span class="comment">// fptoui(uitofp(X)) --&gt; X</span></div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;  <span class="comment">// fptoui(sitofp(X)) --&gt; X</span></div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;  <span class="comment">// This is safe if the intermediate type has enough bits in its mantissa to</span></div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;  <span class="comment">// accurately represent all values of X.  For example, do not do this with</span></div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;  <span class="comment">// i64-&gt;float-&gt;i64.  This is also safe for sitofp case, because any negative</span></div><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;  <span class="comment">// &#39;X&#39; value would cause an undefined result for the fptoui.</span></div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;  <span class="keywordflow">if</span> ((isa&lt;UIToFPInst&gt;(OpI) || isa&lt;SIToFPInst&gt;(OpI)) &amp;&amp;</div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;      OpI-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0)-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>() == FI.<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>() &amp;&amp;</div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;      (<a class="code" href="Target_2README_8txt.html#a3217063f680fa8e35dea3c59b6e52b18">int</a>)FI.<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#ad979b3c1bc975ee23810e3018ffe951b">getScalarSizeInBits</a>() &lt; <span class="comment">/*extra bit for sign */</span></div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;                    OpI-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#afd69a04ba20c2085dec90d69fb9abe64">getFPMantissaWidth</a>())</div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;    <span class="keywordflow">return</span> ReplaceInstUsesWith(FI, OpI-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0));</div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;</div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;  <span class="keywordflow">return</span> commonCastTransforms(FI);</div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;}</div><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;</div><div class="line"><a name="l01327"></a><span class="lineno"><a class="line" href="classllvm_1_1InstCombiner.html#a7c7b701b8d17f33120903f28cde461bb"> 1327</a></span>&#160;<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="classllvm_1_1InstCombiner.html#a7c7b701b8d17f33120903f28cde461bb">InstCombiner::visitFPToSI</a>(<a class="code" href="classllvm_1_1FPToSIInst.html">FPToSIInst</a> &amp;FI) {</div><div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *OpI = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1Instruction.html">Instruction</a>&gt;(FI.<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0));</div><div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;  <span class="keywordflow">if</span> (OpI == 0)</div><div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;    <span class="keywordflow">return</span> commonCastTransforms(FI);</div><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;</div><div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;  <span class="comment">// fptosi(sitofp(X)) --&gt; X</span></div><div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;  <span class="comment">// fptosi(uitofp(X)) --&gt; X</span></div><div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;  <span class="comment">// This is safe if the intermediate type has enough bits in its mantissa to</span></div><div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;  <span class="comment">// accurately represent all values of X.  For example, do not do this with</span></div><div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;  <span class="comment">// i64-&gt;float-&gt;i64.  This is also safe for sitofp case, because any negative</span></div><div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;  <span class="comment">// &#39;X&#39; value would cause an undefined result for the fptoui.</span></div><div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;  <span class="keywordflow">if</span> ((isa&lt;UIToFPInst&gt;(OpI) || isa&lt;SIToFPInst&gt;(OpI)) &amp;&amp;</div><div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;      OpI-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0)-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>() == FI.<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>() &amp;&amp;</div><div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;      (<a class="code" href="Target_2README_8txt.html#a3217063f680fa8e35dea3c59b6e52b18">int</a>)FI.<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#ad979b3c1bc975ee23810e3018ffe951b">getScalarSizeInBits</a>() &lt;=</div><div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;                    OpI-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#afd69a04ba20c2085dec90d69fb9abe64">getFPMantissaWidth</a>())</div><div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;    <span class="keywordflow">return</span> ReplaceInstUsesWith(FI, OpI-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0));</div><div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;</div><div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;  <span class="keywordflow">return</span> commonCastTransforms(FI);</div><div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;}</div><div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;</div><div class="line"><a name="l01347"></a><span class="lineno"><a class="line" href="classllvm_1_1InstCombiner.html#a72c98985ea3821c7d288bc79717cfeb6"> 1347</a></span>&#160;<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="classllvm_1_1InstCombiner.html#a72c98985ea3821c7d288bc79717cfeb6">InstCombiner::visitUIToFP</a>(<a class="code" href="classllvm_1_1CastInst.html">CastInst</a> &amp;CI) {</div><div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;  <span class="keywordflow">return</span> commonCastTransforms(CI);</div><div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;}</div><div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;</div><div class="line"><a name="l01351"></a><span class="lineno"><a class="line" href="classllvm_1_1InstCombiner.html#a1a9b04d6f6ffde1d4e58e48848d4178a"> 1351</a></span>&#160;<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="classllvm_1_1InstCombiner.html#a1a9b04d6f6ffde1d4e58e48848d4178a">InstCombiner::visitSIToFP</a>(<a class="code" href="classllvm_1_1CastInst.html">CastInst</a> &amp;CI) {</div><div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;  <span class="keywordflow">return</span> commonCastTransforms(CI);</div><div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;}</div><div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;</div><div class="line"><a name="l01355"></a><span class="lineno"><a class="line" href="classllvm_1_1InstCombiner.html#a0a4568129d1dec583a22775432df4717"> 1355</a></span>&#160;<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="classllvm_1_1InstCombiner.html#a0a4568129d1dec583a22775432df4717">InstCombiner::visitIntToPtr</a>(<a class="code" href="classllvm_1_1IntToPtrInst.html">IntToPtrInst</a> &amp;CI) {</div><div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;  <span class="comment">// If the source integer type is not the intptr_t type for this target, do a</span></div><div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;  <span class="comment">// trunc or zext to the intptr_t type, then inttoptr of it.  This allows the</span></div><div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;  <span class="comment">// cast to be exposed to other transforms.</span></div><div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;</div><div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;  <span class="keywordflow">if</span> (TD) {</div><div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;    <span class="keywordtype">unsigned</span> AS = CI.<a class="code" href="classllvm_1_1IntToPtrInst.html#a45c465c99d6bdfdeb42b07d2b06a6444">getAddressSpace</a>();</div><div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;    <span class="keywordflow">if</span> (CI.<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0)-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#ad979b3c1bc975ee23810e3018ffe951b">getScalarSizeInBits</a>() !=</div><div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;        TD-&gt;getPointerSizeInBits(AS)) {</div><div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;      <a class="code" href="classllvm_1_1Type.html">Type</a> *Ty = TD-&gt;getIntPtrType(CI.<a class="code" href="classllvm_1_1Value.html#af85a4828b6b5a8de7fc0a55cc0e5b52f">getContext</a>(), AS);</div><div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;      <span class="keywordflow">if</span> (CI.<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a6f725580f7834e2ca90762965866dad4">isVectorTy</a>()) <span class="comment">// Handle vectors of pointers.</span></div><div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;        Ty = <a class="code" href="classllvm_1_1VectorType.html#ab43657ed1abe2e2ed3a6a394f233ebd0">VectorType::get</a>(Ty, CI.<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#ad8f27f0b94a56abcd296b8461737a3af">getVectorNumElements</a>());</div><div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;</div><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a> = Builder-&gt;CreateZExtOrTrunc(CI.<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0), Ty);</div><div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="classllvm_1_1IntToPtrInst.html">IntToPtrInst</a>(P, CI.<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>());</div><div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;    }</div><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;  }</div><div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;</div><div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = commonCastTransforms(CI))</div><div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>;</div><div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;</div><div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;}</div><div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;<span class="comment">/// @brief Implement the transforms for cast of pointer (bitcast/ptrtoint)</span></div><div class="line"><a name="l01380"></a><span class="lineno"><a class="line" href="classllvm_1_1InstCombiner.html#a659f4270ad408664d68e699bd1e603e3"> 1380</a></span>&#160;<span class="comment"></span><a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="classllvm_1_1InstCombiner.html#a659f4270ad408664d68e699bd1e603e3">InstCombiner::commonPointerCastTransforms</a>(<a class="code" href="classllvm_1_1CastInst.html">CastInst</a> &amp;CI) {</div><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Src = CI.<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0);</div><div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;</div><div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1GetElementPtrInst.html">GetElementPtrInst</a> *GEP = dyn_cast&lt;GetElementPtrInst&gt;(Src)) {</div><div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;    <span class="comment">// If casting the result of a getelementptr instruction with no offset, turn</span></div><div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;    <span class="comment">// this into a cast of the original pointer!</span></div><div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;    <span class="keywordflow">if</span> (GEP-&gt;hasAllZeroIndices()) {</div><div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;      <span class="comment">// Changing the cast operand is usually not a good idea but it is safe</span></div><div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;      <span class="comment">// here because the pointer operand is being replaced with another</span></div><div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;      <span class="comment">// pointer operand so the opcode doesn&#39;t need to change.</span></div><div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;      Worklist.Add(GEP);</div><div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;      CI.<a class="code" href="classllvm_1_1User.html#a5fa9b8e1842b354f64c1ba6be0a4a17f">setOperand</a>(0, GEP-&gt;getOperand(0));</div><div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;      <span class="keywordflow">return</span> &amp;CI;</div><div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;    }</div><div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;</div><div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;    <span class="keywordflow">if</span> (!TD)</div><div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;      <span class="keywordflow">return</span> commonCastTransforms(CI);</div><div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;</div><div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;    <span class="comment">// If the GEP has a single use, and the base pointer is a bitcast, and the</span></div><div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;    <span class="comment">// GEP computes a constant offset, see if we can convert these three</span></div><div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;    <span class="comment">// instructions into fewer.  This typically happens with unions and other</span></div><div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;    <span class="comment">// non-type-safe code.</span></div><div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;    <span class="keywordtype">unsigned</span> AS = GEP-&gt;getPointerAddressSpace();</div><div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;    <span class="keywordtype">unsigned</span> OffsetBits = TD-&gt;getPointerSizeInBits(AS);</div><div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;    <a class="code" href="classllvm_1_1APInt.html">APInt</a> Offset(OffsetBits, 0);</div><div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;    <a class="code" href="classllvm_1_1BitCastInst.html">BitCastInst</a> *BCI = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1BitCastInst.html">BitCastInst</a>&gt;(GEP-&gt;getOperand(0));</div><div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;    <span class="keywordflow">if</span> (GEP-&gt;hasOneUse() &amp;&amp;</div><div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;        BCI &amp;&amp;</div><div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;        GEP-&gt;accumulateConstantOffset(*TD, Offset)) {</div><div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;      <span class="comment">// Get the base pointer input of the bitcast, and the type it points to.</span></div><div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *OrigBase = BCI-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0);</div><div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;      <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Value*, 8&gt;</a> NewIndices;</div><div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;      <span class="keywordflow">if</span> (FindElementAtOffset(OrigBase-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>(),</div><div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;                              Offset.<a class="code" href="classllvm_1_1APInt.html#a7189a37206963029447c31d57771b997">getSExtValue</a>(),</div><div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;                              NewIndices)) {</div><div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;        <span class="comment">// If we were able to index down into an element, create the GEP</span></div><div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;        <span class="comment">// and bitcast the result.  This eliminates one bitcast, potentially</span></div><div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;        <span class="comment">// two.</span></div><div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;        <a class="code" href="classllvm_1_1Value.html">Value</a> *NGEP = cast&lt;GEPOperator&gt;(GEP)-&gt;isInBounds() ?</div><div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;          Builder-&gt;CreateInBoundsGEP(OrigBase, NewIndices) :</div><div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;          Builder-&gt;CreateGEP(OrigBase, NewIndices);</div><div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;        NGEP-&gt;<a class="code" href="classllvm_1_1Value.html#ae855357b6c5e6e7ed1869272708a3a84">takeName</a>(GEP);</div><div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;</div><div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;        <span class="keywordflow">if</span> (isa&lt;BitCastInst&gt;(CI))</div><div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="classllvm_1_1BitCastInst.html">BitCastInst</a>(NGEP, CI.<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>());</div><div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;        assert(isa&lt;PtrToIntInst&gt;(CI));</div><div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="classllvm_1_1PtrToIntInst.html">PtrToIntInst</a>(NGEP, CI.<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>());</div><div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;      }</div><div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;    }</div><div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;  }</div><div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;</div><div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;  <span class="keywordflow">return</span> commonCastTransforms(CI);</div><div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;}</div><div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;</div><div class="line"><a name="l01434"></a><span class="lineno"><a class="line" href="classllvm_1_1InstCombiner.html#adaa3691a486fa468bbbacc7882b8e9dd"> 1434</a></span>&#160;<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="classllvm_1_1InstCombiner.html#adaa3691a486fa468bbbacc7882b8e9dd">InstCombiner::visitPtrToInt</a>(<a class="code" href="classllvm_1_1PtrToIntInst.html">PtrToIntInst</a> &amp;CI) {</div><div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;  <span class="comment">// If the destination integer type is not the intptr_t type for this target,</span></div><div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;  <span class="comment">// do a ptrtoint to intptr_t then do a trunc or zext.  This allows the cast</span></div><div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;  <span class="comment">// to be exposed to other transforms.</span></div><div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;</div><div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;  <span class="keywordflow">if</span> (!TD)</div><div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;    <span class="keywordflow">return</span> commonPointerCastTransforms(CI);</div><div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;</div><div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *Ty = CI.<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>();</div><div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;  <span class="keywordtype">unsigned</span> AS = CI.<a class="code" href="classllvm_1_1PtrToIntInst.html#a8d359742fe9dc58401606784a0d96859">getPointerAddressSpace</a>();</div><div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;</div><div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;  <span class="keywordflow">if</span> (Ty-&gt;<a class="code" href="classllvm_1_1Type.html#ad979b3c1bc975ee23810e3018ffe951b">getScalarSizeInBits</a>() == TD-&gt;getPointerSizeInBits(AS))</div><div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;    <span class="keywordflow">return</span> commonPointerCastTransforms(CI);</div><div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;</div><div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *PtrTy = TD-&gt;getIntPtrType(CI.<a class="code" href="classllvm_1_1Value.html#af85a4828b6b5a8de7fc0a55cc0e5b52f">getContext</a>(), AS);</div><div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;  <span class="keywordflow">if</span> (Ty-&gt;<a class="code" href="classllvm_1_1Type.html#a6f725580f7834e2ca90762965866dad4">isVectorTy</a>()) <span class="comment">// Handle vectors of pointers.</span></div><div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;    PtrTy = <a class="code" href="classllvm_1_1VectorType.html#ab43657ed1abe2e2ed3a6a394f233ebd0">VectorType::get</a>(PtrTy, Ty-&gt;<a class="code" href="classllvm_1_1Type.html#ad8f27f0b94a56abcd296b8461737a3af">getVectorNumElements</a>());</div><div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;</div><div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a> = Builder-&gt;CreatePtrToInt(CI.<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0), PtrTy);</div><div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1CastInst.html#ae96aa53c0b7c0eb9ec680db6a43abaa7">CastInst::CreateIntegerCast</a>(P, Ty, <span class="comment">/*isSigned=*/</span><span class="keyword">false</span>);</div><div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;}</div><div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;<span class="comment">/// OptimizeVectorResize - This input value (which is known to have vector type)</span></div><div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;<span class="comment">/// is being zero extended or truncated to the specified vector type.  Try to</span></div><div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;<span class="comment">/// replace it with a shuffle (and vector/vector bitcast) if possible.</span></div><div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;<span class="comment">/// The source and destination vector types may have different element types.</span></div><div class="line"><a name="l01461"></a><span class="lineno"><a class="line" href="InstCombineCasts_8cpp.html#acb5a7eff32dd4405f0e795ba98bdbc4e"> 1461</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="InstCombineCasts_8cpp.html#acb5a7eff32dd4405f0e795ba98bdbc4e">OptimizeVectorResize</a>(<a class="code" href="classllvm_1_1Value.html">Value</a> *InVal, <a class="code" href="classllvm_1_1VectorType.html">VectorType</a> *DestTy,</div><div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;                                         <a class="code" href="classllvm_1_1InstCombiner.html">InstCombiner</a> &amp;IC) {</div><div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;  <span class="comment">// We can only do this optimization if the output is a multiple of the input</span></div><div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;  <span class="comment">// element size, or the input is a multiple of the output element size.</span></div><div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;  <span class="comment">// Convert the input type to have the same element type as the output.</span></div><div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;  <a class="code" href="classllvm_1_1VectorType.html">VectorType</a> *SrcTy = cast&lt;VectorType&gt;(InVal-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>());</div><div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;</div><div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;  <span class="keywordflow">if</span> (SrcTy-&gt;<a class="code" href="classllvm_1_1SequentialType.html#a39f2c3a62f293faf11ac28b15bc53359">getElementType</a>() != DestTy-&gt;<a class="code" href="classllvm_1_1SequentialType.html#a39f2c3a62f293faf11ac28b15bc53359">getElementType</a>()) {</div><div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;    <span class="comment">// The input types don&#39;t need to be identical, but for now they must be the</span></div><div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;    <span class="comment">// same size.  There is no specific reason we couldn&#39;t handle things like</span></div><div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;    <span class="comment">// &lt;4 x i16&gt; -&gt; &lt;4 x i32&gt; by bitcasting to &lt;2 x i32&gt; but haven&#39;t gotten</span></div><div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;    <span class="comment">// there yet.</span></div><div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;    <span class="keywordflow">if</span> (SrcTy-&gt;<a class="code" href="classllvm_1_1SequentialType.html#a39f2c3a62f293faf11ac28b15bc53359">getElementType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a5a7cfa245af120b44ac8a86143bb9e57">getPrimitiveSizeInBits</a>() !=</div><div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;        DestTy-&gt;<a class="code" href="classllvm_1_1SequentialType.html#a39f2c3a62f293faf11ac28b15bc53359">getElementType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a5a7cfa245af120b44ac8a86143bb9e57">getPrimitiveSizeInBits</a>())</div><div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;</div><div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;    SrcTy = <a class="code" href="classllvm_1_1VectorType.html#ab43657ed1abe2e2ed3a6a394f233ebd0">VectorType::get</a>(DestTy-&gt;<a class="code" href="classllvm_1_1SequentialType.html#a39f2c3a62f293faf11ac28b15bc53359">getElementType</a>(), SrcTy-&gt;<a class="code" href="classllvm_1_1VectorType.html#a580510fa692dccfb26d0e967d8f164e7">getNumElements</a>());</div><div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;    InVal = IC.<a class="code" href="classllvm_1_1InstCombiner.html#a6e33228c0d5bb3b72f357677fa105185">Builder</a>-&gt;<a class="code" href="classllvm_1_1IRBuilder.html#a87b363b9dad9f5040ea7e29ea9e60ff5">CreateBitCast</a>(InVal, SrcTy);</div><div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;  }</div><div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;</div><div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;  <span class="comment">// Now that the element types match, get the shuffle mask and RHS of the</span></div><div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;  <span class="comment">// shuffle to use, which depends on whether we&#39;re increasing or decreasing the</span></div><div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;  <span class="comment">// size of the input.</span></div><div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;uint32_t, 16&gt;</a> ShuffleMask;</div><div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1NVPTX_1_1PTXLdStInstCode.html#a91119cbee2be000c528a690252aee07ca24244a27b634ef3e256ab3c64c6fecd4">V2</a>;</div><div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;</div><div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;  <span class="keywordflow">if</span> (SrcTy-&gt;<a class="code" href="classllvm_1_1VectorType.html#a580510fa692dccfb26d0e967d8f164e7">getNumElements</a>() &gt; DestTy-&gt;<a class="code" href="classllvm_1_1VectorType.html#a580510fa692dccfb26d0e967d8f164e7">getNumElements</a>()) {</div><div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;    <span class="comment">// If we&#39;re shrinking the number of elements, just shuffle in the low</span></div><div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;    <span class="comment">// elements from the input and use undef as the second shuffle input.</span></div><div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;    V2 = <a class="code" href="classllvm_1_1UndefValue.html#a4ae5ff22b700a42bcc5d889233721335">UndefValue::get</a>(SrcTy);</div><div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0, e = DestTy-&gt;<a class="code" href="classllvm_1_1VectorType.html#a580510fa692dccfb26d0e967d8f164e7">getNumElements</a>(); <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != e; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div><div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;      ShuffleMask.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;</div><div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;    <span class="comment">// If we&#39;re increasing the number of elements, shuffle in all of the</span></div><div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;    <span class="comment">// elements from InVal and fill the rest of the result elements with zeros</span></div><div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;    <span class="comment">// from a constant zero.</span></div><div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;    V2 = <a class="code" href="classllvm_1_1Constant.html#aa6574d526b3e38a28f688a7bb4325c2c">Constant::getNullValue</a>(SrcTy);</div><div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;    <span class="keywordtype">unsigned</span> SrcElts = SrcTy-&gt;<a class="code" href="classllvm_1_1VectorType.html#a580510fa692dccfb26d0e967d8f164e7">getNumElements</a>();</div><div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0, e = SrcElts; <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != e; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div><div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;      ShuffleMask.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;</div><div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;    <span class="comment">// The excess elements reference the first element of the zero input.</span></div><div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0, e = DestTy-&gt;<a class="code" href="classllvm_1_1VectorType.html#a580510fa692dccfb26d0e967d8f164e7">getNumElements</a>()-SrcElts; <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != e; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div><div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;      ShuffleMask.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(SrcElts);</div><div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;  }</div><div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;</div><div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="classllvm_1_1ShuffleVectorInst.html">ShuffleVectorInst</a>(InVal, V2,</div><div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;                               <a class="code" href="classllvm_1_1ConstantDataVector.html#ab8b693ee2fbb4c4173fa2725c110021b">ConstantDataVector::get</a>(V2-&gt;<a class="code" href="classllvm_1_1Value.html#af85a4828b6b5a8de7fc0a55cc0e5b52f">getContext</a>(),</div><div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;                                                       ShuffleMask));</div><div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;}</div><div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;</div><div class="line"><a name="l01513"></a><span class="lineno"><a class="line" href="InstCombineCasts_8cpp.html#a8efab72b40fc7836709221d3e97139c6"> 1513</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="InstCombineCasts_8cpp.html#a8efab72b40fc7836709221d3e97139c6">isMultipleOfTypeSize</a>(<span class="keywordtype">unsigned</span> <a class="code" href="classllvm_1_1Value.html">Value</a>, <a class="code" href="classllvm_1_1Type.html">Type</a> *Ty) {</div><div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;  <span class="keywordflow">return</span> Value % Ty-&gt;<a class="code" href="classllvm_1_1Type.html#a5a7cfa245af120b44ac8a86143bb9e57">getPrimitiveSizeInBits</a>() == 0;</div><div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;}</div><div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;</div><div class="line"><a name="l01517"></a><span class="lineno"><a class="line" href="InstCombineCasts_8cpp.html#ac8947451998676abcce5452a1a8f5848"> 1517</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">unsigned</span> <a class="code" href="InstCombineCasts_8cpp.html#ac8947451998676abcce5452a1a8f5848">getTypeSizeIndex</a>(<span class="keywordtype">unsigned</span> <a class="code" href="classllvm_1_1Value.html">Value</a>, <a class="code" href="classllvm_1_1Type.html">Type</a> *Ty) {</div><div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;  <span class="keywordflow">return</span> Value / Ty-&gt;<a class="code" href="classllvm_1_1Type.html#a5a7cfa245af120b44ac8a86143bb9e57">getPrimitiveSizeInBits</a>();</div><div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;}</div><div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;<span class="comment">/// CollectInsertionElements - V is a value which is inserted into a vector of</span></div><div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;<span class="comment">/// VecEltTy.  Look through the value to see if we can decompose it into</span></div><div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;<span class="comment">/// insertions into the vector.  See the example in the comment for</span></div><div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;<span class="comment">/// OptimizeIntegerToVectorInsertions for the pattern this handles.</span></div><div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;<span class="comment">/// The type of V is always a non-zero multiple of VecEltTy&#39;s size.</span></div><div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;<span class="comment">/// Shift is the number of bits between the lsb of V and the lsb of</span></div><div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;<span class="comment">/// the vector.</span></div><div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;<span class="comment">/// This returns false if the pattern can&#39;t be matched or true if it can,</span></div><div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;<span class="comment">/// filling in Elements with the elements found here.</span></div><div class="line"><a name="l01531"></a><span class="lineno"><a class="line" href="InstCombineCasts_8cpp.html#abe93395b9183a889129e0c8158337486"> 1531</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="InstCombineCasts_8cpp.html#abe93395b9183a889129e0c8158337486">CollectInsertionElements</a>(<a class="code" href="classllvm_1_1Value.html">Value</a> *V, <span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#a8db36c82f32d6f6a4d35a00e55be03a8">Shift</a>,</div><div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;                                     <a class="code" href="classllvm_1_1SmallVectorImpl.html">SmallVectorImpl&lt;Value*&gt;</a> &amp;Elements,</div><div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;                                     <a class="code" href="classllvm_1_1Type.html">Type</a> *VecEltTy, <a class="code" href="classllvm_1_1InstCombiner.html">InstCombiner</a> &amp;IC) {</div><div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;  assert(<a class="code" href="InstCombineCasts_8cpp.html#a8efab72b40fc7836709221d3e97139c6">isMultipleOfTypeSize</a>(Shift, VecEltTy) &amp;&amp;</div><div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;         <span class="stringliteral">&quot;Shift should be a multiple of the element type size&quot;</span>);</div><div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;</div><div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;  <span class="comment">// Undef values never contribute useful bits to the result.</span></div><div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;  <span class="keywordflow">if</span> (isa&lt;UndefValue&gt;(V)) <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;</div><div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;  <span class="comment">// If we got down to a value of the right type, we win, try inserting into the</span></div><div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;  <span class="comment">// right element.</span></div><div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;  <span class="keywordflow">if</span> (V-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>() == VecEltTy) {</div><div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;    <span class="comment">// Inserting null doesn&#39;t actually insert any elements.</span></div><div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Constant.html">Constant</a> *<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = dyn_cast&lt;Constant&gt;(V))</div><div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>-&gt;isNullValue())</div><div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;</div><div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;    <span class="keywordtype">unsigned</span> ElementIndex = <a class="code" href="InstCombineCasts_8cpp.html#ac8947451998676abcce5452a1a8f5848">getTypeSizeIndex</a>(Shift, VecEltTy);</div><div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;    <span class="keywordflow">if</span> (IC.<a class="code" href="classllvm_1_1InstCombiner.html#a5acf2a841db50684c87133f36bdd00a1">getDataLayout</a>()-&gt;<a class="code" href="classllvm_1_1DataLayout.html#a9b876cc57d1884621f481b26b0892633">isBigEndian</a>())</div><div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;      ElementIndex = Elements.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#a22a311dfe4c28a897de8a9365a4f0a84">size</a>() - ElementIndex - 1;</div><div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;</div><div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;    <span class="comment">// Fail if multiple elements are inserted into this slot.</span></div><div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;    <span class="keywordflow">if</span> (Elements[ElementIndex] != 0)</div><div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;</div><div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;    Elements[ElementIndex] = V;</div><div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;  }</div><div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;</div><div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Constant.html">Constant</a> *<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = dyn_cast&lt;Constant&gt;(V)) {</div><div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;    <span class="comment">// Figure out the # elements this provides, and bitcast it or slice it up</span></div><div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;    <span class="comment">// as required.</span></div><div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;    <span class="keywordtype">unsigned</span> NumElts = <a class="code" href="InstCombineCasts_8cpp.html#ac8947451998676abcce5452a1a8f5848">getTypeSizeIndex</a>(<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>-&gt;getType()-&gt;getPrimitiveSizeInBits(),</div><div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;                                        VecEltTy);</div><div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;    <span class="comment">// If the constant is the size of a vector element, we just need to bitcast</span></div><div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;    <span class="comment">// it to the right type so it gets properly inserted.</span></div><div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;    <span class="keywordflow">if</span> (NumElts == 1)</div><div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="InstCombineCasts_8cpp.html#abe93395b9183a889129e0c8158337486">CollectInsertionElements</a>(<a class="code" href="classllvm_1_1ConstantExpr.html#aba93ec4079f8d709a1d5b4745310782e">ConstantExpr::getBitCast</a>(<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>, VecEltTy),</div><div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;                                      Shift, Elements, VecEltTy, IC);</div><div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;</div><div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;    <span class="comment">// Okay, this is a constant that covers multiple elements.  Slice it up into</span></div><div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;    <span class="comment">// pieces and insert each element-sized piece into the vector.</span></div><div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;    <span class="keywordflow">if</span> (!isa&lt;IntegerType&gt;(<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>-&gt;getType()))</div><div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;      <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = <a class="code" href="classllvm_1_1ConstantExpr.html#aba93ec4079f8d709a1d5b4745310782e">ConstantExpr::getBitCast</a>(<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>, <a class="code" href="classllvm_1_1IntegerType.html#a14f7b4f1aed38192fb6b7772eb506bdb">IntegerType::get</a>(V-&gt;<a class="code" href="classllvm_1_1Value.html#af85a4828b6b5a8de7fc0a55cc0e5b52f">getContext</a>(),</div><div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;                                       <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>-&gt;getType()-&gt;getPrimitiveSizeInBits()));</div><div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;    <span class="keywordtype">unsigned</span> ElementSize = VecEltTy-&gt;<a class="code" href="classllvm_1_1Type.html#a5a7cfa245af120b44ac8a86143bb9e57">getPrimitiveSizeInBits</a>();</div><div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;    <a class="code" href="classllvm_1_1Type.html">Type</a> *ElementIntTy = <a class="code" href="classllvm_1_1IntegerType.html#a14f7b4f1aed38192fb6b7772eb506bdb">IntegerType::get</a>(<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>-&gt;getContext(), ElementSize);</div><div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;</div><div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != NumElts; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;      <span class="keywordtype">unsigned</span> ShiftI = Shift+<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>*ElementSize;</div><div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;      <a class="code" href="classllvm_1_1Constant.html">Constant</a> *Piece = <a class="code" href="classllvm_1_1ConstantExpr.html#aab1f107496b17acc1bc5fdcdb2903b38">ConstantExpr::getLShr</a>(<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>, <a class="code" href="classllvm_1_1ConstantInt.html#a9105541412dab869e18b3cceebfff07d">ConstantInt::get</a>(<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>-&gt;getType(),</div><div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;                                                                  ShiftI));</div><div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;      Piece = <a class="code" href="classllvm_1_1ConstantExpr.html#aca5cab6b8d2be24d0c857cc4a831feec">ConstantExpr::getTrunc</a>(Piece, ElementIntTy);</div><div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="InstCombineCasts_8cpp.html#abe93395b9183a889129e0c8158337486">CollectInsertionElements</a>(Piece, ShiftI, Elements, VecEltTy, IC))</div><div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;    }</div><div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;  }</div><div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;</div><div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;  <span class="keywordflow">if</span> (!V-&gt;<a class="code" href="classllvm_1_1Value.html#a085b82f074c28030fb8e194377ed2d0c">hasOneUse</a>()) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;</div><div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1Instruction.html">Instruction</a>&gt;(V);</div><div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;  <span class="keywordflow">if</span> (I == 0) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;  <span class="keywordflow">switch</span> (I-&gt;<a class="code" href="classllvm_1_1Instruction.html#a021bb7c9aad6003fe8089f6327356c6c">getOpcode</a>()) {</div><div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;  <span class="keywordflow">default</span>: <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">// Unhandled case.</span></div><div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;  <span class="keywordflow">case</span> Instruction::BitCast:</div><div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="InstCombineCasts_8cpp.html#abe93395b9183a889129e0c8158337486">CollectInsertionElements</a>(I-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0), <a class="code" href="Target_2README_8txt.html#a8db36c82f32d6f6a4d35a00e55be03a8">Shift</a>,</div><div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;                                    Elements, VecEltTy, IC);</div><div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;  <span class="keywordflow">case</span> Instruction::ZExt:</div><div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="InstCombineCasts_8cpp.html#a8efab72b40fc7836709221d3e97139c6">isMultipleOfTypeSize</a>(</div><div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;                          I-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0)-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a5a7cfa245af120b44ac8a86143bb9e57">getPrimitiveSizeInBits</a>(),</div><div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;                              VecEltTy))</div><div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="InstCombineCasts_8cpp.html#abe93395b9183a889129e0c8158337486">CollectInsertionElements</a>(I-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0), <a class="code" href="Target_2README_8txt.html#a8db36c82f32d6f6a4d35a00e55be03a8">Shift</a>,</div><div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;                                    Elements, VecEltTy, IC);</div><div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1APIntOps.html#a22f056804d2b9882f74adc905872bc39">Instruction::Or</a>:</div><div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="InstCombineCasts_8cpp.html#abe93395b9183a889129e0c8158337486">CollectInsertionElements</a>(I-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0), <a class="code" href="Target_2README_8txt.html#a8db36c82f32d6f6a4d35a00e55be03a8">Shift</a>,</div><div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;                                    Elements, VecEltTy, IC) &amp;&amp;</div><div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;           <a class="code" href="InstCombineCasts_8cpp.html#abe93395b9183a889129e0c8158337486">CollectInsertionElements</a>(I-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(1), <a class="code" href="Target_2README_8txt.html#a8db36c82f32d6f6a4d35a00e55be03a8">Shift</a>,</div><div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;                                    Elements, VecEltTy, IC);</div><div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;  <span class="keywordflow">case</span> Instruction::Shl: {</div><div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;    <span class="comment">// Must be shifting by a constant that is a multiple of the element size.</span></div><div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;    <a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *CI = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a>&gt;(I-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(1));</div><div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;    <span class="keywordflow">if</span> (CI == 0) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;    Shift += CI-&gt;<a class="code" href="classllvm_1_1ConstantInt.html#a6edd823ba5e4e1effc8280ca8a1194ef">getZExtValue</a>();</div><div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="InstCombineCasts_8cpp.html#a8efab72b40fc7836709221d3e97139c6">isMultipleOfTypeSize</a>(Shift, VecEltTy)) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="InstCombineCasts_8cpp.html#abe93395b9183a889129e0c8158337486">CollectInsertionElements</a>(I-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0), <a class="code" href="Target_2README_8txt.html#a8db36c82f32d6f6a4d35a00e55be03a8">Shift</a>,</div><div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;                                    Elements, VecEltTy, IC);</div><div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;  }</div><div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;</div><div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;  }</div><div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;}</div><div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;</div><div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;<span class="comment">/// OptimizeIntegerToVectorInsertions - If the input is an &#39;or&#39; instruction, we</span></div><div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;<span class="comment">/// may be doing shifts and ors to assemble the elements of the vector manually.</span></div><div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;<span class="comment">/// Try to rip the code out and replace it with insertelements.  This is to</span></div><div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;<span class="comment">/// optimize code like this:</span></div><div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;<span class="comment">///    %tmp37 = bitcast float %inc to i32</span></div><div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;<span class="comment">///    %tmp38 = zext i32 %tmp37 to i64</span></div><div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;<span class="comment">///    %tmp31 = bitcast float %inc5 to i32</span></div><div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;<span class="comment">///    %tmp32 = zext i32 %tmp31 to i64</span></div><div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;<span class="comment">///    %tmp33 = shl i64 %tmp32, 32</span></div><div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;<span class="comment">///    %ins35 = or i64 %tmp33, %tmp38</span></div><div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;<span class="comment">///    %tmp43 = bitcast i64 %ins35 to &lt;2 x float&gt;</span></div><div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;<span class="comment">/// Into two insertelements that do &quot;buildvector{%inc, %inc5}&quot;.</span></div><div class="line"><a name="l01639"></a><span class="lineno"><a class="line" href="InstCombineCasts_8cpp.html#a534902f6fff593cf4b50232cc58c580a"> 1639</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="InstCombineCasts_8cpp.html#a534902f6fff593cf4b50232cc58c580a">OptimizeIntegerToVectorInsertions</a>(<a class="code" href="classllvm_1_1BitCastInst.html">BitCastInst</a> &amp;CI,</div><div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;                                                <a class="code" href="classllvm_1_1InstCombiner.html">InstCombiner</a> &amp;IC) {</div><div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;  <span class="comment">// We need to know the target byte order to perform this optimization.</span></div><div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;  <span class="keywordflow">if</span> (!IC.<a class="code" href="classllvm_1_1InstCombiner.html#a5acf2a841db50684c87133f36bdd00a1">getDataLayout</a>()) <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;</div><div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;  <a class="code" href="classllvm_1_1VectorType.html">VectorType</a> *DestVecTy = cast&lt;VectorType&gt;(CI.<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>());</div><div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *IntInput = CI.<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0);</div><div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;</div><div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Value*, 8&gt;</a> Elements(DestVecTy-&gt;<a class="code" href="classllvm_1_1VectorType.html#a580510fa692dccfb26d0e967d8f164e7">getNumElements</a>());</div><div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="InstCombineCasts_8cpp.html#abe93395b9183a889129e0c8158337486">CollectInsertionElements</a>(IntInput, 0, Elements,</div><div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;                                DestVecTy-&gt;<a class="code" href="classllvm_1_1SequentialType.html#a39f2c3a62f293faf11ac28b15bc53359">getElementType</a>(), IC))</div><div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;</div><div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;  <span class="comment">// If we succeeded, we know that all of the element are specified by Elements</span></div><div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;  <span class="comment">// or are zero if Elements has a null entry.  Recast this as a set of</span></div><div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;  <span class="comment">// insertions.</span></div><div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Result = <a class="code" href="classllvm_1_1Constant.html#aa6574d526b3e38a28f688a7bb4325c2c">Constant::getNullValue</a>(CI.<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>());</div><div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0, e = Elements.size(); <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != e; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;    <span class="keywordflow">if</span> (Elements[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>] == 0) <span class="keywordflow">continue</span>;  <span class="comment">// Unset element.</span></div><div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;</div><div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;    Result = IC.<a class="code" href="classllvm_1_1InstCombiner.html#a6e33228c0d5bb3b72f357677fa105185">Builder</a>-&gt;<a class="code" href="classllvm_1_1IRBuilder.html#a40e48df9196b3c092096138cd9af8465">CreateInsertElement</a>(Result, Elements[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>],</div><div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;                                             IC.<a class="code" href="classllvm_1_1InstCombiner.html#a6e33228c0d5bb3b72f357677fa105185">Builder</a>-&gt;<a class="code" href="classllvm_1_1IRBuilderBase.html#ac0e8c554bf1c1e117a74d51df89c137d">getInt32</a>(i));</div><div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;  }</div><div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;</div><div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;  <span class="keywordflow">return</span> Result;</div><div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;}</div><div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;</div><div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;<span class="comment">/// OptimizeIntToFloatBitCast - See if we can optimize an integer-&gt;float/double</span></div><div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;<span class="comment">/// bitcast.  The various long double bitcasts can&#39;t get in here.</span></div><div class="line"><a name="l01669"></a><span class="lineno"><a class="line" href="InstCombineCasts_8cpp.html#ac50270ed32cec6a5d8ec24e524846b13"> 1669</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="InstCombineCasts_8cpp.html#ac50270ed32cec6a5d8ec24e524846b13">OptimizeIntToFloatBitCast</a>(<a class="code" href="classllvm_1_1BitCastInst.html">BitCastInst</a> &amp;CI,<a class="code" href="classllvm_1_1InstCombiner.html">InstCombiner</a> &amp;IC){</div><div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;  <span class="comment">// We need to know the target byte order to perform this optimization.</span></div><div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;  <span class="keywordflow">if</span> (!IC.<a class="code" href="classllvm_1_1InstCombiner.html#a5acf2a841db50684c87133f36bdd00a1">getDataLayout</a>()) <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;</div><div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Src = CI.<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0);</div><div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *DestTy = CI.<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>();</div><div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;</div><div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;  <span class="comment">// If this is a bitcast from int to float, check to see if the int is an</span></div><div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;  <span class="comment">// extraction from a vector.</span></div><div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *VecInput = 0;</div><div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;  <span class="comment">// bitcast(trunc(bitcast(somevector)))</span></div><div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">match</a>(Src, <a class="code" href="namespacellvm_1_1PatternMatch.html#a5b844aada27c4c6fdb87146ac458c0d8">m_Trunc</a>(<a class="code" href="namespacellvm_1_1PatternMatch.html#ac0467ca7fad871738b10db95feb40dad">m_BitCast</a>(<a class="code" href="namespacellvm_1_1PatternMatch.html#a24bca8838396aa81b87de8e7ac774b19">m_Value</a>(VecInput)))) &amp;&amp;</div><div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;      isa&lt;VectorType&gt;(VecInput-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>())) {</div><div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;    <a class="code" href="classllvm_1_1VectorType.html">VectorType</a> *VecTy = cast&lt;VectorType&gt;(VecInput-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>());</div><div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;    <span class="keywordtype">unsigned</span> DestWidth = DestTy-&gt;<a class="code" href="classllvm_1_1Type.html#a5a7cfa245af120b44ac8a86143bb9e57">getPrimitiveSizeInBits</a>();</div><div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;</div><div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;    <span class="keywordflow">if</span> (VecTy-&gt;<a class="code" href="classllvm_1_1Type.html#a5a7cfa245af120b44ac8a86143bb9e57">getPrimitiveSizeInBits</a>() % DestWidth == 0) {</div><div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;      <span class="comment">// If the element type of the vector doesn&#39;t match the result type,</span></div><div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;      <span class="comment">// bitcast it to be a vector type we can extract from.</span></div><div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;      <span class="keywordflow">if</span> (VecTy-&gt;<a class="code" href="classllvm_1_1SequentialType.html#a39f2c3a62f293faf11ac28b15bc53359">getElementType</a>() != DestTy) {</div><div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;        VecTy = <a class="code" href="classllvm_1_1VectorType.html#ab43657ed1abe2e2ed3a6a394f233ebd0">VectorType::get</a>(DestTy,</div><div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;                                VecTy-&gt;<a class="code" href="classllvm_1_1Type.html#a5a7cfa245af120b44ac8a86143bb9e57">getPrimitiveSizeInBits</a>() / DestWidth);</div><div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;        VecInput = IC.<a class="code" href="classllvm_1_1InstCombiner.html#a6e33228c0d5bb3b72f357677fa105185">Builder</a>-&gt;<a class="code" href="classllvm_1_1IRBuilder.html#a87b363b9dad9f5040ea7e29ea9e60ff5">CreateBitCast</a>(VecInput, VecTy);</div><div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;      }</div><div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;</div><div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;      <span class="keywordtype">unsigned</span> Elt = 0;</div><div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;      <span class="keywordflow">if</span> (IC.<a class="code" href="classllvm_1_1InstCombiner.html#a5acf2a841db50684c87133f36bdd00a1">getDataLayout</a>()-&gt;<a class="code" href="classllvm_1_1DataLayout.html#a9b876cc57d1884621f481b26b0892633">isBigEndian</a>())</div><div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;        Elt = VecTy-&gt;<a class="code" href="classllvm_1_1Type.html#a5a7cfa245af120b44ac8a86143bb9e57">getPrimitiveSizeInBits</a>() / DestWidth - 1;</div><div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1ExtractElementInst.html#a671ded0c51dd6de0eaf145cde783d81e">ExtractElementInst::Create</a>(VecInput, IC.<a class="code" href="classllvm_1_1InstCombiner.html#a6e33228c0d5bb3b72f357677fa105185">Builder</a>-&gt;<a class="code" href="classllvm_1_1IRBuilderBase.html#ac0e8c554bf1c1e117a74d51df89c137d">getInt32</a>(Elt));</div><div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;    }</div><div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;  }</div><div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;</div><div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;  <span class="comment">// bitcast(trunc(lshr(bitcast(somevector), cst))</span></div><div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;  <a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *ShAmt = 0;</div><div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">match</a>(Src, <a class="code" href="namespacellvm_1_1PatternMatch.html#a5b844aada27c4c6fdb87146ac458c0d8">m_Trunc</a>(<a class="code" href="namespacellvm_1_1PatternMatch.html#aa08fee11e8a5ec10c0cc2a7abbbd799a">m_LShr</a>(<a class="code" href="namespacellvm_1_1PatternMatch.html#ac0467ca7fad871738b10db95feb40dad">m_BitCast</a>(<a class="code" href="namespacellvm_1_1PatternMatch.html#a24bca8838396aa81b87de8e7ac774b19">m_Value</a>(VecInput)),</div><div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;                                <a class="code" href="namespacellvm_1_1PatternMatch.html#a34a92072122412c6020d4afb43725bf4">m_ConstantInt</a>(ShAmt)))) &amp;&amp;</div><div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;      isa&lt;VectorType&gt;(VecInput-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>())) {</div><div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;    <a class="code" href="classllvm_1_1VectorType.html">VectorType</a> *VecTy = cast&lt;VectorType&gt;(VecInput-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>());</div><div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;    <span class="keywordtype">unsigned</span> DestWidth = DestTy-&gt;<a class="code" href="classllvm_1_1Type.html#a5a7cfa245af120b44ac8a86143bb9e57">getPrimitiveSizeInBits</a>();</div><div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;    <span class="keywordflow">if</span> (VecTy-&gt;<a class="code" href="classllvm_1_1Type.html#a5a7cfa245af120b44ac8a86143bb9e57">getPrimitiveSizeInBits</a>() % DestWidth == 0 &amp;&amp;</div><div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;        ShAmt-&gt;getZExtValue() % DestWidth == 0) {</div><div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;      <span class="comment">// If the element type of the vector doesn&#39;t match the result type,</span></div><div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;      <span class="comment">// bitcast it to be a vector type we can extract from.</span></div><div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;      <span class="keywordflow">if</span> (VecTy-&gt;<a class="code" href="classllvm_1_1SequentialType.html#a39f2c3a62f293faf11ac28b15bc53359">getElementType</a>() != DestTy) {</div><div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;        VecTy = <a class="code" href="classllvm_1_1VectorType.html#ab43657ed1abe2e2ed3a6a394f233ebd0">VectorType::get</a>(DestTy,</div><div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;                                VecTy-&gt;<a class="code" href="classllvm_1_1Type.html#a5a7cfa245af120b44ac8a86143bb9e57">getPrimitiveSizeInBits</a>() / DestWidth);</div><div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;        VecInput = IC.<a class="code" href="classllvm_1_1InstCombiner.html#a6e33228c0d5bb3b72f357677fa105185">Builder</a>-&gt;<a class="code" href="classllvm_1_1IRBuilder.html#a87b363b9dad9f5040ea7e29ea9e60ff5">CreateBitCast</a>(VecInput, VecTy);</div><div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;      }</div><div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;</div><div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;      <span class="keywordtype">unsigned</span> Elt = ShAmt-&gt;getZExtValue() / DestWidth;</div><div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;      <span class="keywordflow">if</span> (IC.<a class="code" href="classllvm_1_1InstCombiner.html#a5acf2a841db50684c87133f36bdd00a1">getDataLayout</a>()-&gt;<a class="code" href="classllvm_1_1DataLayout.html#a9b876cc57d1884621f481b26b0892633">isBigEndian</a>())</div><div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;        Elt = VecTy-&gt;<a class="code" href="classllvm_1_1Type.html#a5a7cfa245af120b44ac8a86143bb9e57">getPrimitiveSizeInBits</a>() / DestWidth - 1 - Elt;</div><div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1ExtractElementInst.html#a671ded0c51dd6de0eaf145cde783d81e">ExtractElementInst::Create</a>(VecInput, IC.<a class="code" href="classllvm_1_1InstCombiner.html#a6e33228c0d5bb3b72f357677fa105185">Builder</a>-&gt;<a class="code" href="classllvm_1_1IRBuilderBase.html#ac0e8c554bf1c1e117a74d51df89c137d">getInt32</a>(Elt));</div><div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;    }</div><div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;  }</div><div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;}</div><div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;</div><div class="line"><a name="l01727"></a><span class="lineno"><a class="line" href="classllvm_1_1InstCombiner.html#a5015196ad0cd2548ebeed53069c557fc"> 1727</a></span>&#160;<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="classllvm_1_1InstCombiner.html#a5015196ad0cd2548ebeed53069c557fc">InstCombiner::visitBitCast</a>(<a class="code" href="classllvm_1_1BitCastInst.html">BitCastInst</a> &amp;CI) {</div><div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;  <span class="comment">// If the operands are integer typed then apply the integer transforms,</span></div><div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;  <span class="comment">// otherwise just apply the common ones.</span></div><div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Src = CI.<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0);</div><div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *SrcTy = Src-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>();</div><div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *DestTy = CI.<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>();</div><div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;</div><div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;  <span class="comment">// Get rid of casts from one type to the same type. These are useless and can</span></div><div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;  <span class="comment">// be replaced by the operand.</span></div><div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;  <span class="keywordflow">if</span> (DestTy == Src-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>())</div><div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;    <span class="keywordflow">return</span> ReplaceInstUsesWith(CI, Src);</div><div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;</div><div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1PointerType.html">PointerType</a> *DstPTy = dyn_cast&lt;PointerType&gt;(DestTy)) {</div><div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;    <a class="code" href="classllvm_1_1PointerType.html">PointerType</a> *SrcPTy = cast&lt;PointerType&gt;(SrcTy);</div><div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;    <a class="code" href="classllvm_1_1Type.html">Type</a> *DstElTy = DstPTy-&gt;getElementType();</div><div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;    <a class="code" href="classllvm_1_1Type.html">Type</a> *SrcElTy = SrcPTy-&gt;<a class="code" href="classllvm_1_1SequentialType.html#a39f2c3a62f293faf11ac28b15bc53359">getElementType</a>();</div><div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;</div><div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;    <span class="comment">// If the address spaces don&#39;t match, don&#39;t eliminate the bitcast, which is</span></div><div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;    <span class="comment">// required for changing types.</span></div><div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;    <span class="keywordflow">if</span> (SrcPTy-&gt;<a class="code" href="classllvm_1_1PointerType.html#a921061a57ec3cfbaf6422f09f7d79fc3">getAddressSpace</a>() != DstPTy-&gt;getAddressSpace())</div><div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;</div><div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;    <span class="comment">// If we are casting a alloca to a pointer to a type of the same</span></div><div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;    <span class="comment">// size, rewrite the allocation instruction to allocate the &quot;right&quot; type.</span></div><div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;    <span class="comment">// There is no need to modify malloc calls because it is their bitcast that</span></div><div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;    <span class="comment">// needs to be cleaned up.</span></div><div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1AllocaInst.html">AllocaInst</a> *AI = dyn_cast&lt;AllocaInst&gt;(Src))</div><div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *V = PromoteCastOfAllocation(CI, *AI))</div><div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;        <span class="keywordflow">return</span> V;</div><div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;</div><div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;    <span class="comment">// If the source and destination are pointers, and this cast is equivalent</span></div><div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;    <span class="comment">// to a getelementptr X, 0, 0, 0...  turn it into the appropriate gep.</span></div><div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;    <span class="comment">// This can enhance SROA and other transforms that want type-safe pointers.</span></div><div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;    <a class="code" href="classllvm_1_1Constant.html">Constant</a> *ZeroUInt =</div><div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;      <a class="code" href="classllvm_1_1Constant.html#aa6574d526b3e38a28f688a7bb4325c2c">Constant::getNullValue</a>(<a class="code" href="classllvm_1_1Type.html#a30dd396c5b40cd86c1591872e574ccdf">Type::getInt32Ty</a>(CI.<a class="code" href="classllvm_1_1Value.html#af85a4828b6b5a8de7fc0a55cc0e5b52f">getContext</a>()));</div><div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;    <span class="keywordtype">unsigned</span> NumZeros = 0;</div><div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;    <span class="keywordflow">while</span> (SrcElTy != DstElTy &amp;&amp;</div><div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;           isa&lt;CompositeType&gt;(SrcElTy) &amp;&amp; !SrcElTy-&gt;<a class="code" href="classllvm_1_1Type.html#a2eba483f5cc876e824aa6c085736086b">isPointerTy</a>() &amp;&amp;</div><div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;           SrcElTy-&gt;<a class="code" href="classllvm_1_1Type.html#ad083201ba4e1f8217bdc1f1ab05bd83d">getNumContainedTypes</a>() <span class="comment">/* not &quot;{}&quot; */</span>) {</div><div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;      SrcElTy = cast&lt;CompositeType&gt;(SrcElTy)-&gt;getTypeAtIndex(ZeroUInt);</div><div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;      ++NumZeros;</div><div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;    }</div><div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;</div><div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;    <span class="comment">// If we found a path from the src to dest, create the getelementptr now.</span></div><div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;    <span class="keywordflow">if</span> (SrcElTy == DstElTy) {</div><div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;      <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Value*, 8&gt;</a> Idxs(NumZeros+1, ZeroUInt);</div><div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1GetElementPtrInst.html#a3e10b4db1ded36654416d3aed2bc56ba">GetElementPtrInst::CreateInBounds</a>(Src, Idxs);</div><div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;    }</div><div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;  }</div><div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;</div><div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;  <span class="comment">// Try to optimize int -&gt; float bitcasts.</span></div><div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;  <span class="keywordflow">if</span> ((DestTy-&gt;<a class="code" href="classllvm_1_1Type.html#aeb06cf0f813f643b62d8dd98db0bc249">isFloatTy</a>() || DestTy-&gt;<a class="code" href="classllvm_1_1Type.html#ac67ad08d36c989a872a887caa72803c6">isDoubleTy</a>()) &amp;&amp; isa&lt;IntegerType&gt;(SrcTy))</div><div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = <a class="code" href="InstCombineCasts_8cpp.html#ac50270ed32cec6a5d8ec24e524846b13">OptimizeIntToFloatBitCast</a>(CI, *<span class="keyword">this</span>))</div><div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>;</div><div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;</div><div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1VectorType.html">VectorType</a> *DestVTy = dyn_cast&lt;VectorType&gt;(DestTy)) {</div><div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;    <span class="keywordflow">if</span> (DestVTy-&gt;getNumElements() == 1 &amp;&amp; !SrcTy-&gt;<a class="code" href="classllvm_1_1Type.html#a6f725580f7834e2ca90762965866dad4">isVectorTy</a>()) {</div><div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *Elem = Builder-&gt;CreateBitCast(Src, DestVTy-&gt;getElementType());</div><div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1InsertElementInst.html#a968cd6a1853b174636da54c36ae25425">InsertElementInst::Create</a>(<a class="code" href="classllvm_1_1UndefValue.html#a4ae5ff22b700a42bcc5d889233721335">UndefValue::get</a>(DestTy), Elem,</div><div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;                     <a class="code" href="classllvm_1_1Constant.html#aa6574d526b3e38a28f688a7bb4325c2c">Constant::getNullValue</a>(<a class="code" href="classllvm_1_1Type.html#a30dd396c5b40cd86c1591872e574ccdf">Type::getInt32Ty</a>(CI.<a class="code" href="classllvm_1_1Value.html#af85a4828b6b5a8de7fc0a55cc0e5b52f">getContext</a>())));</div><div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;      <span class="comment">// FIXME: Canonicalize bitcast(insertelement) -&gt; insertelement(bitcast)</span></div><div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;    }</div><div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;</div><div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;    <span class="keywordflow">if</span> (isa&lt;IntegerType&gt;(SrcTy)) {</div><div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;      <span class="comment">// If this is a cast from an integer to vector, check to see if the input</span></div><div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;      <span class="comment">// is a trunc or zext of a bitcast from vector.  If so, we can replace all</span></div><div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;      <span class="comment">// the casts with a shuffle and (potentially) a bitcast.</span></div><div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;      <span class="keywordflow">if</span> (isa&lt;TruncInst&gt;(Src) || isa&lt;ZExtInst&gt;(Src)) {</div><div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;        <a class="code" href="classllvm_1_1CastInst.html">CastInst</a> *SrcCast = cast&lt;CastInst&gt;(Src);</div><div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1BitCastInst.html">BitCastInst</a> *BCIn = dyn_cast&lt;BitCastInst&gt;(SrcCast-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0)))</div><div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;          <span class="keywordflow">if</span> (isa&lt;VectorType&gt;(BCIn-&gt;getOperand(0)-&gt;getType()))</div><div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = <a class="code" href="InstCombineCasts_8cpp.html#acb5a7eff32dd4405f0e795ba98bdbc4e">OptimizeVectorResize</a>(BCIn-&gt;getOperand(0),</div><div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;                                               cast&lt;VectorType&gt;(DestTy), *<span class="keyword">this</span>))</div><div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;              <span class="keywordflow">return</span> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>;</div><div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;      }</div><div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;</div><div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;      <span class="comment">// If the input is an &#39;or&#39; instruction, we may be doing shifts and ors to</span></div><div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;      <span class="comment">// assemble the elements of the vector manually.  Try to rip the code out</span></div><div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;      <span class="comment">// and replace it with insertelements.</span></div><div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *V = <a class="code" href="InstCombineCasts_8cpp.html#a534902f6fff593cf4b50232cc58c580a">OptimizeIntegerToVectorInsertions</a>(CI, *<span class="keyword">this</span>))</div><div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;        <span class="keywordflow">return</span> ReplaceInstUsesWith(CI, V);</div><div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;    }</div><div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;  }</div><div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;</div><div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1VectorType.html">VectorType</a> *SrcVTy = dyn_cast&lt;VectorType&gt;(SrcTy)) {</div><div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;    <span class="keywordflow">if</span> (SrcVTy-&gt;getNumElements() == 1) {</div><div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;      <span class="comment">// If our destination is not a vector, then make this a straight</span></div><div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;      <span class="comment">// scalar-scalar cast.</span></div><div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;      <span class="keywordflow">if</span> (!DestTy-&gt;<a class="code" href="classllvm_1_1Type.html#a6f725580f7834e2ca90762965866dad4">isVectorTy</a>()) {</div><div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;        <a class="code" href="classllvm_1_1Value.html">Value</a> *Elem =</div><div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;          Builder-&gt;CreateExtractElement(Src,</div><div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;                     <a class="code" href="classllvm_1_1Constant.html#aa6574d526b3e38a28f688a7bb4325c2c">Constant::getNullValue</a>(<a class="code" href="classllvm_1_1Type.html#a30dd396c5b40cd86c1591872e574ccdf">Type::getInt32Ty</a>(CI.<a class="code" href="classllvm_1_1Value.html#af85a4828b6b5a8de7fc0a55cc0e5b52f">getContext</a>())));</div><div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1CastInst.html#a0f7dea9550778374905e12da6d6ba8a8">CastInst::Create</a>(Instruction::BitCast, Elem, DestTy);</div><div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;      }</div><div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;</div><div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;      <span class="comment">// Otherwise, see if our source is an insert. If so, then use the scalar</span></div><div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;      <span class="comment">// component directly.</span></div><div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1InsertElementInst.html">InsertElementInst</a> *IEI =</div><div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;            dyn_cast&lt;InsertElementInst&gt;(CI.<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0)))</div><div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1CastInst.html#a0f7dea9550778374905e12da6d6ba8a8">CastInst::Create</a>(Instruction::BitCast, IEI-&gt;getOperand(1),</div><div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;                                DestTy);</div><div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;    }</div><div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;  }</div><div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;</div><div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1ShuffleVectorInst.html">ShuffleVectorInst</a> *SVI = dyn_cast&lt;ShuffleVectorInst&gt;(Src)) {</div><div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;    <span class="comment">// Okay, we have (bitcast (shuffle ..)).  Check to see if this is</span></div><div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;    <span class="comment">// a bitcast to a vector with the same # elts.</span></div><div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;    <span class="keywordflow">if</span> (SVI-&gt;hasOneUse() &amp;&amp; DestTy-&gt;<a class="code" href="classllvm_1_1Type.html#a6f725580f7834e2ca90762965866dad4">isVectorTy</a>() &amp;&amp;</div><div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;        DestTy-&gt;<a class="code" href="classllvm_1_1Type.html#ad8f27f0b94a56abcd296b8461737a3af">getVectorNumElements</a>() == SVI-&gt;getType()-&gt;getNumElements() &amp;&amp;</div><div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;        SVI-&gt;getType()-&gt;getNumElements() ==</div><div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;        SVI-&gt;getOperand(0)-&gt;getType()-&gt;getVectorNumElements()) {</div><div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;      <a class="code" href="classllvm_1_1BitCastInst.html">BitCastInst</a> *Tmp;</div><div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;      <span class="comment">// If either of the operands is a cast from CI.getType(), then</span></div><div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;      <span class="comment">// evaluating the shuffle in the casted destination&#39;s type will allow</span></div><div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;      <span class="comment">// us to eliminate at least one cast.</span></div><div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;      <span class="keywordflow">if</span> (((Tmp = dyn_cast&lt;BitCastInst&gt;(SVI-&gt;getOperand(0))) &amp;&amp;</div><div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;           Tmp-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0)-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>() == DestTy) ||</div><div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;          ((Tmp = dyn_cast&lt;BitCastInst&gt;(SVI-&gt;getOperand(1))) &amp;&amp;</div><div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;           Tmp-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0)-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>() == DestTy)) {</div><div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;        <a class="code" href="classllvm_1_1Value.html">Value</a> *LHS = Builder-&gt;CreateBitCast(SVI-&gt;getOperand(0), DestTy);</div><div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;        <a class="code" href="classllvm_1_1Value.html">Value</a> *RHS = Builder-&gt;CreateBitCast(SVI-&gt;getOperand(1), DestTy);</div><div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;        <span class="comment">// Return a new shuffle vector.  Use the same element ID&#39;s, as we</span></div><div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;        <span class="comment">// know the vector types match #elts.</span></div><div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="classllvm_1_1ShuffleVectorInst.html">ShuffleVectorInst</a>(LHS, RHS, SVI-&gt;getOperand(2));</div><div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;      }</div><div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;    }</div><div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;  }</div><div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;</div><div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;  <span class="keywordflow">if</span> (SrcTy-&gt;<a class="code" href="classllvm_1_1Type.html#a2eba483f5cc876e824aa6c085736086b">isPointerTy</a>())</div><div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;    <span class="keywordflow">return</span> commonPointerCastTransforms(CI);</div><div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;  <span class="keywordflow">return</span> commonCastTransforms(CI);</div><div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;}</div><div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;</div><div class="line"><a name="l01860"></a><span class="lineno"><a class="line" href="classllvm_1_1InstCombiner.html#aaaeb72153a2ba334d852ef923f2b6ade"> 1860</a></span>&#160;<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="classllvm_1_1InstCombiner.html#aaaeb72153a2ba334d852ef923f2b6ade">InstCombiner::visitAddrSpaceCast</a>(<a class="code" href="classllvm_1_1AddrSpaceCastInst.html">AddrSpaceCastInst</a> &amp;CI) {</div><div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;  <span class="keywordflow">return</span> commonCastTransforms(CI);</div><div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;}</div><div class="ttc" id="namespacellvm_1_1PatternMatch_html_a427435d4da769ae680a8e77ef89520aa"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#a427435d4da769ae680a8e77ef89520aa">llvm::PatternMatch::m_And</a></div><div class="ttdeci">BinaryOp_match&lt; LHS, RHS, Instruction::And &gt; m_And(const LHS &amp;L, const RHS &amp;R)</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l00467">PatternMatch.h:467</a></div></div>
<div class="ttc" id="classllvm_1_1SmallVectorTemplateCommon_html_a22a311dfe4c28a897de8a9365a4f0a84"><div class="ttname"><a href="classllvm_1_1SmallVectorTemplateCommon.html#a22a311dfe4c28a897de8a9365a4f0a84">llvm::SmallVectorTemplateCommon&lt; T &gt;::size</a></div><div class="ttdeci">size_type size() const</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00127">SmallVector.h:127</a></div></div>
<div class="ttc" id="InstCombineCasts_8cpp_html_a0001ad4269d3a92e51c5f8371b38364e"><div class="ttname"><a href="InstCombineCasts_8cpp.html#a0001ad4269d3a92e51c5f8371b38364e">CanEvaluateSExtd</a></div><div class="ttdeci">static bool CanEvaluateSExtd(Value *V, Type *Ty)</div><div class="ttdef"><b>Definition:</b> <a href="InstCombineCasts_8cpp_source.html#l01002">InstCombineCasts.cpp:1002</a></div></div>
<div class="ttc" id="classllvm_1_1SmallVectorTemplateBase_html_ae1a10b90f22c0478960fb5798ff73916"><div class="ttname"><a href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">llvm::SmallVectorTemplateBase::push_back</a></div><div class="ttdeci">void push_back(const T &amp;Elt)</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00236">SmallVector.h:236</a></div></div>
<div class="ttc" id="classllvm_1_1DataLayout_html"><div class="ttname"><a href="classllvm_1_1DataLayout.html">llvm::DataLayout</a></div><div class="ttdef"><b>Definition:</b> <a href="DataLayout_8h_source.html#l00098">DataLayout.h:98</a></div></div>
<div class="ttc" id="classllvm_1_1CastInst_html_adc3489e61d5f37a0e4c5589859fbccc2"><div class="ttname"><a href="classllvm_1_1CastInst.html#adc3489e61d5f37a0e4c5589859fbccc2">llvm::CastInst::getOpcode</a></div><div class="ttdeci">Instruction::CastOps getOpcode() const </div><div class="ttdoc">Return the opcode of this CastInst. </div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00603">InstrTypes.h:603</a></div></div>
<div class="ttc" id="namespacellvm_1_1PatternMatch_html_a24bca8838396aa81b87de8e7ac774b19"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#a24bca8838396aa81b87de8e7ac774b19">llvm::PatternMatch::m_Value</a></div><div class="ttdeci">class_match&lt; Value &gt; m_Value()</div><div class="ttdoc">m_Value() - Match an arbitrary value and ignore it. </div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l00070">PatternMatch.h:70</a></div></div>
<div class="ttc" id="namespacellvm_1_1ARM__PROC_html_aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5"><div class="ttname"><a href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">llvm::ARM_PROC::A</a></div><div class="ttdef"><b>Definition:</b> <a href="ARMBaseInfo_8h_source.html#l00098">ARMBaseInfo.h:98</a></div></div>
<div class="ttc" id="namespacellvm_1_1tgtok_html_abbc5259d649363016626e2529fabe0c5a5fa7b4069ef3bd1ceb9f2caa315cf5ac"><div class="ttname"><a href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5a5fa7b4069ef3bd1ceb9f2caa315cf5ac">llvm::tgtok::In</a></div><div class="ttdef"><b>Definition:</b> <a href="TGLexer_8h_source.html#l00046">TGLexer.h:46</a></div></div>
<div class="ttc" id="classllvm_1_1Type_html_aa75984a442f2379de0c66018201fa628"><div class="ttname"><a href="classllvm_1_1Type.html#aa75984a442f2379de0c66018201fa628">llvm::Type::getInt1Ty</a></div><div class="ttdeci">static IntegerType * getInt1Ty(LLVMContext &amp;C)</div><div class="ttdef"><b>Definition:</b> <a href="Type_8cpp_source.html#l00238">Type.cpp:238</a></div></div>
<div class="ttc" id="namespacellvm_html"><div class="ttname"><a href="namespacellvm.html">llvm</a></div><div class="ttdoc">List of target independent CodeGen pass IDs. </div><div class="ttdef"><b>Definition:</b> <a href="APFloat_8h_source.html#l00022">APFloat.h:22</a></div></div>
<div class="ttc" id="classllvm_1_1Type_html_ad979b3c1bc975ee23810e3018ffe951b"><div class="ttname"><a href="classllvm_1_1Type.html#ad979b3c1bc975ee23810e3018ffe951b">llvm::Type::getScalarSizeInBits</a></div><div class="ttdeci">unsigned getScalarSizeInBits()</div><div class="ttdef"><b>Definition:</b> <a href="Type_8cpp_source.html#l00135">Type.cpp:135</a></div></div>
<div class="ttc" id="classllvm_1_1InstCombiner_html_a5015196ad0cd2548ebeed53069c557fc"><div class="ttname"><a href="classllvm_1_1InstCombiner.html#a5015196ad0cd2548ebeed53069c557fc">llvm::InstCombiner::visitBitCast</a></div><div class="ttdeci">Instruction * visitBitCast(BitCastInst &amp;CI)</div><div class="ttdef"><b>Definition:</b> <a href="InstCombineCasts_8cpp_source.html#l01727">InstCombineCasts.cpp:1727</a></div></div>
<div class="ttc" id="classllvm_1_1APFloat_html_aac03c2635e359347d396ddf4d7963b89"><div class="ttname"><a href="classllvm_1_1APFloat.html#aac03c2635e359347d396ddf4d7963b89">llvm::APFloat::IEEEdouble</a></div><div class="ttdeci">static const fltSemantics IEEEdouble</div><div class="ttdef"><b>Definition:</b> <a href="APFloat_8h_source.html#l00133">APFloat.h:133</a></div></div>
<div class="ttc" id="classllvm_1_1Module_html"><div class="ttname"><a href="classllvm_1_1Module.html">llvm::Module</a></div><div class="ttdoc">The main container class for the LLVM Intermediate Representation. </div><div class="ttdef"><b>Definition:</b> <a href="Module_8h_source.html#l00112">Module.h:112</a></div></div>
<div class="ttc" id="classllvm_1_1AllocaInst_html_a42defc71631bc55fcb48421784b276c9"><div class="ttname"><a href="classllvm_1_1AllocaInst.html#a42defc71631bc55fcb48421784b276c9">llvm::AllocaInst::setAlignment</a></div><div class="ttdeci">void setAlignment(unsigned Align)</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8cpp_source.html#l00892">Instructions.cpp:892</a></div></div>
<div class="ttc" id="namespacellvm_1_1PatternMatch_html_ab3b5beca3a0dedd21adac813123a2ae6"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#ab3b5beca3a0dedd21adac813123a2ae6">llvm::PatternMatch::m_Zero</a></div><div class="ttdeci">match_zero m_Zero()</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l00137">PatternMatch.h:137</a></div></div>
<div class="ttc" id="InstCombine_8h_html"><div class="ttname"><a href="InstCombine_8h.html">InstCombine.h</a></div></div>
<div class="ttc" id="classllvm_1_1SelectInst_html_a8bce457e977f23507c48c9dfd7052990"><div class="ttname"><a href="classllvm_1_1SelectInst.html#a8bce457e977f23507c48c9dfd7052990">llvm::SelectInst::Create</a></div><div class="ttdeci">static SelectInst * Create(Value *C, Value *S1, Value *S2, const Twine &amp;NameStr=&quot;&quot;, Instruction *InsertBefore=0)</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l01455">Instructions.h:1455</a></div></div>
<div class="ttc" id="InstCombineCasts_8cpp_html_a33121ab9b3810edb043d2c6c144cc4aa"><div class="ttname"><a href="InstCombineCasts_8cpp.html#a33121ab9b3810edb043d2c6c144cc4aa">isEliminableCastPair</a></div><div class="ttdeci">static Instruction::CastOps isEliminableCastPair(const CastInst *CI, unsigned opcode, Type *DstTy, DataLayout *TD)</div><div class="ttdef"><b>Definition:</b> <a href="InstCombineCasts_8cpp_source.html#l00234">InstCombineCasts.cpp:234</a></div></div>
<div class="ttc" id="namespacellvm_html_a3f2f98c2a67c9e79f58aad9150a62e42"><div class="ttname"><a href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">llvm::dyn_cast</a></div><div class="ttdeci">enable_if_c&lt;!is_simple_type&lt; Y &gt;::value, typename cast_retty&lt; X, const Y &gt;::ret_type &gt;::type dyn_cast(const Y &amp;Val)</div><div class="ttdef"><b>Definition:</b> <a href="Casting_8h_source.html#l00266">Casting.h:266</a></div></div>
<div class="ttc" id="classllvm_1_1ZExtInst_html"><div class="ttname"><a href="classllvm_1_1ZExtInst.html">llvm::ZExtInst</a></div><div class="ttdoc">This class represents zero extension of integer types. </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l03211">Instructions.h:3211</a></div></div>
<div class="ttc" id="classllvm_1_1InstCombiner_html_a2c93f6e9c56faa4bf4f18cdca680c9ff"><div class="ttname"><a href="classllvm_1_1InstCombiner.html#a2c93f6e9c56faa4bf4f18cdca680c9ff">llvm::InstCombiner::commonCastTransforms</a></div><div class="ttdeci">Instruction * commonCastTransforms(CastInst &amp;CI)</div><div class="ttdoc">Implement the transforms common to all CastInst visitors. </div><div class="ttdef"><b>Definition:</b> <a href="InstCombineCasts_8cpp_source.html#l00291">InstCombineCasts.cpp:291</a></div></div>
<div class="ttc" id="classllvm_1_1OverflowingBinaryOperator_html_a5a1ebefdf12a23a94f8a135cdfa0cd90"><div class="ttname"><a href="classllvm_1_1OverflowingBinaryOperator.html#a5a1ebefdf12a23a94f8a135cdfa0cd90">llvm::OverflowingBinaryOperator::hasNoSignedWrap</a></div><div class="ttdeci">bool hasNoSignedWrap() const </div><div class="ttdef"><b>Definition:</b> <a href="Operator_8h_source.html#l00107">Operator.h:107</a></div></div>
<div class="ttc" id="namespacellvm_html_a8bc4c3e77e6f3d6c54b8b4504393dfa7"><div class="ttname"><a href="namespacellvm.html#a8bc4c3e77e6f3d6c54b8b4504393dfa7">llvm::MaskedValueIsZero</a></div><div class="ttdeci">bool MaskedValueIsZero(Value *V, const APInt &amp;Mask, const DataLayout *TD=0, unsigned Depth=0)</div><div class="ttdef"><b>Definition:</b> <a href="ValueTracking_8cpp_source.html#l01115">ValueTracking.cpp:1115</a></div></div>
<div class="ttc" id="namespacellvm_1_1NVPTX_1_1PTXLdStInstCode_html_a91119cbee2be000c528a690252aee07ca24244a27b634ef3e256ab3c64c6fecd4"><div class="ttname"><a href="namespacellvm_1_1NVPTX_1_1PTXLdStInstCode.html#a91119cbee2be000c528a690252aee07ca24244a27b634ef3e256ab3c64c6fecd4">llvm::NVPTX::PTXLdStInstCode::V2</a></div><div class="ttdef"><b>Definition:</b> <a href="NVPTX_8h_source.html#l00127">NVPTX.h:127</a></div></div>
<div class="ttc" id="DataLayout_8h_html"><div class="ttname"><a href="DataLayout_8h.html">DataLayout.h</a></div></div>
<div class="ttc" id="README-SSE_8txt_html_a63d206a063eefcdf8c318ded97b65020"><div class="ttname"><a href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a></div><div class="ttdeci">This currently compiles esp xmm0 movsd esp eax eax esp ret We should use not the dag combiner This is because dagcombine2 needs to be able to see through the X86ISD::Wrapper which DAGCombine can t really do The code for turning x load into a single vector load is target independent and should be moved to the dag combiner The code for turning x load into a vector load can only handle a direct load from a global or a direct load from the stack It should be generalized to handle any load from P</div><div class="ttdef"><b>Definition:</b> <a href="README-SSE_8txt_source.html#l00427">README-SSE.txt:427</a></div></div>
<div class="ttc" id="classllvm_1_1PHINode_html"><div class="ttname"><a href="classllvm_1_1PHINode.html">llvm::PHINode</a></div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l01978">Instructions.h:1978</a></div></div>
<div class="ttc" id="classllvm_1_1CallInst_html"><div class="ttname"><a href="classllvm_1_1CallInst.html">llvm::CallInst</a></div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l01161">Instructions.h:1161</a></div></div>
<div class="ttc" id="classllvm_1_1APInt_html_ad960e1ff48d25c382b6d28e7961f074e"><div class="ttname"><a href="classllvm_1_1APInt.html#ad960e1ff48d25c382b6d28e7961f074e">llvm::APInt::getLowBitsSet</a></div><div class="ttdeci">static APInt getLowBitsSet(unsigned numBits, unsigned loBitsSet)</div><div class="ttdoc">Get a value with low bits set. </div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l00528">APInt.h:528</a></div></div>
<div class="ttc" id="namespacellvm_1_1PatternMatch_html_a64153676e101a130bbbaaf91635d253a"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#a64153676e101a130bbbaaf91635d253a">llvm::PatternMatch::m_AShr</a></div><div class="ttdeci">BinaryOp_match&lt; LHS, RHS, Instruction::AShr &gt; m_AShr(const LHS &amp;L, const RHS &amp;R)</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l00497">PatternMatch.h:497</a></div></div>
<div class="ttc" id="classllvm_1_1ShuffleVectorInst_html"><div class="ttname"><a href="classllvm_1_1ShuffleVectorInst.html">llvm::ShuffleVectorInst</a></div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l01660">Instructions.h:1660</a></div></div>
<div class="ttc" id="classllvm_1_1Type_html_ac67ad08d36c989a872a887caa72803c6"><div class="ttname"><a href="classllvm_1_1Type.html#ac67ad08d36c989a872a887caa72803c6">llvm::Type::isDoubleTy</a></div><div class="ttdeci">bool isDoubleTy() const </div><div class="ttdoc">isDoubleTy - Return true if this is &amp;#39;double&amp;#39;, a 64-bit IEEE fp type. </div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00149">Type.h:149</a></div></div>
<div class="ttc" id="classllvm_1_1Type_html_ac830a02a025d9d5a5dc53c444cf625ee"><div class="ttname"><a href="classllvm_1_1Type.html#ac830a02a025d9d5a5dc53c444cf625ee">llvm::Type::isPtrOrPtrVectorTy</a></div><div class="ttdeci">bool isPtrOrPtrVectorTy() const </div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00225">Type.h:225</a></div></div>
<div class="ttc" id="classllvm_1_1Type_html_afd69a04ba20c2085dec90d69fb9abe64"><div class="ttname"><a href="classllvm_1_1Type.html#afd69a04ba20c2085dec90d69fb9abe64">llvm::Type::getFPMantissaWidth</a></div><div class="ttdeci">int getFPMantissaWidth() const </div><div class="ttdef"><b>Definition:</b> <a href="Type_8cpp_source.html#l00142">Type.cpp:142</a></div></div>
<div class="ttc" id="classllvm_1_1ICmpInst_html_abe8988eef2e6fc2baba032cb22afedd7"><div class="ttname"><a href="classllvm_1_1ICmpInst.html#abe8988eef2e6fc2baba032cb22afedd7">llvm::ICmpInst::isEquality</a></div><div class="ttdeci">static bool isEquality(Predicate P)</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00997">Instructions.h:997</a></div></div>
<div class="ttc" id="classllvm_1_1BasicBlock_html_aca229503e4f5c83a187a6a921c625fa8"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#aca229503e4f5c83a187a6a921c625fa8">llvm::BasicBlock::getParent</a></div><div class="ttdeci">const Function * getParent() const </div><div class="ttdoc">Return the enclosing method, or null if none. </div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00116">BasicBlock.h:116</a></div></div>
<div class="ttc" id="LLParser_8cpp_html_a33ece1ef8074506a15d7f86eb76dbae6"><div class="ttname"><a href="LLParser_8cpp.html#a33ece1ef8074506a15d7f86eb76dbae6">F</a></div><div class="ttdeci">F(f)</div></div>
<div class="ttc" id="classllvm_1_1SExtInst_html"><div class="ttname"><a href="classllvm_1_1SExtInst.html">llvm::SExtInst</a></div><div class="ttdoc">This class represents a sign extension of integer types. </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l03247">Instructions.h:3247</a></div></div>
<div class="ttc" id="classllvm_1_1PointerType_html_a921061a57ec3cfbaf6422f09f7d79fc3"><div class="ttname"><a href="classllvm_1_1PointerType.html#a921061a57ec3cfbaf6422f09f7d79fc3">llvm::PointerType::getAddressSpace</a></div><div class="ttdeci">unsigned getAddressSpace() const </div><div class="ttdoc">Return the address space of the Pointer type. </div><div class="ttdef"><b>Definition:</b> <a href="DerivedTypes_8h_source.html#l00445">DerivedTypes.h:445</a></div></div>
<div class="ttc" id="classllvm_1_1Function_html"><div class="ttname"><a href="classllvm_1_1Function.html">llvm::Function</a></div><div class="ttdef"><b>Definition:</b> <a href="Function_8h_source.html#l00070">Function.h:70</a></div></div>
<div class="ttc" id="InstCombineCasts_8cpp_html_add636d783011465334249e1e4c64d09b"><div class="ttname"><a href="InstCombineCasts_8cpp.html#add636d783011465334249e1e4c64d09b">LookThroughFPExtensions</a></div><div class="ttdeci">static Value * LookThroughFPExtensions(Value *V)</div><div class="ttdef"><b>Definition:</b> <a href="InstCombineCasts_8cpp_source.html#l01162">InstCombineCasts.cpp:1162</a></div></div>
<div class="ttc" id="classllvm_1_1InstCombiner_html_a72c98985ea3821c7d288bc79717cfeb6"><div class="ttname"><a href="classllvm_1_1InstCombiner.html#a72c98985ea3821c7d288bc79717cfeb6">llvm::InstCombiner::visitUIToFP</a></div><div class="ttdeci">Instruction * visitUIToFP(CastInst &amp;CI)</div><div class="ttdef"><b>Definition:</b> <a href="InstCombineCasts_8cpp_source.html#l01347">InstCombineCasts.cpp:1347</a></div></div>
<div class="ttc" id="InstCombineCasts_8cpp_html_a39b384f8e288556dc7732b655b848692"><div class="ttname"><a href="InstCombineCasts_8cpp.html#a39b384f8e288556dc7732b655b848692">CanEvaluateZExtd</a></div><div class="ttdeci">static bool CanEvaluateZExtd(Value *V, Type *Ty, unsigned &amp;BitsToClear)</div><div class="ttdef"><b>Definition:</b> <a href="InstCombineCasts_8cpp_source.html#l00651">InstCombineCasts.cpp:651</a></div></div>
<div class="ttc" id="InstCombineCasts_8cpp_html_ad7805b3730b5c1e081569451763e93ae"><div class="ttname"><a href="InstCombineCasts_8cpp.html#ad7805b3730b5c1e081569451763e93ae">FitsInFPType</a></div><div class="ttdeci">static Constant * FitsInFPType(ConstantFP *CFP, const fltSemantics &amp;Sem)</div><div class="ttdef"><b>Definition:</b> <a href="InstCombineCasts_8cpp_source.html#l01151">InstCombineCasts.cpp:1151</a></div></div>
<div class="ttc" id="classllvm_1_1IRBuilder_html_a40e48df9196b3c092096138cd9af8465"><div class="ttname"><a href="classllvm_1_1IRBuilder.html#a40e48df9196b3c092096138cd9af8465">llvm::IRBuilder::CreateInsertElement</a></div><div class="ttdeci">Value * CreateInsertElement(Value *Vec, Value *NewElt, Value *Idx, const Twine &amp;Name=&quot;&quot;)</div><div class="ttdef"><b>Definition:</b> <a href="IRBuilder_8h_source.html#l01357">IRBuilder.h:1357</a></div></div>
<div class="ttc" id="namespacellvm_1_1LibFunc_html_abf8f6830387f338fed0bce2e65108c6fa5fe293a4388b5441e4c698d9ce6b0fdf"><div class="ttname"><a href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fa5fe293a4388b5441e4c698d9ce6b0fdf">llvm::LibFunc::sqrtf</a></div><div class="ttdoc">float sqrtf(float x); </div><div class="ttdef"><b>Definition:</b> <a href="TargetLibraryInfo_8h_source.html#l00515">TargetLibraryInfo.h:515</a></div></div>
<div class="ttc" id="classllvm_1_1Constant_html_aa6574d526b3e38a28f688a7bb4325c2c"><div class="ttname"><a href="classllvm_1_1Constant.html#aa6574d526b3e38a28f688a7bb4325c2c">llvm::Constant::getNullValue</a></div><div class="ttdeci">static Constant * getNullValue(Type *Ty)</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l00111">Constants.cpp:111</a></div></div>
<div class="ttc" id="classllvm_1_1Value_html_ad452febc1ac0b394876e640ec03ffa38"><div class="ttname"><a href="classllvm_1_1Value.html#ad452febc1ac0b394876e640ec03ffa38">llvm::Value::getName</a></div><div class="ttdeci">StringRef getName() const </div><div class="ttdef"><b>Definition:</b> <a href="Value_8cpp_source.html#l00167">Value.cpp:167</a></div></div>
<div class="ttc" id="classllvm_1_1InstCombiner_html_ae52ecb2fe536b5b853902e15db3c8062"><div class="ttname"><a href="classllvm_1_1InstCombiner.html#ae52ecb2fe536b5b853902e15db3c8062">llvm::InstCombiner::visitFPExt</a></div><div class="ttdeci">Instruction * visitFPExt(CastInst &amp;CI)</div><div class="ttdef"><b>Definition:</b> <a href="InstCombineCasts_8cpp_source.html#l01303">InstCombineCasts.cpp:1303</a></div></div>
<div class="ttc" id="namespacellvm_1_1MCID_html_a8035044d40d3758eb45b65dce69dc90ba32dbd2c72a98eaee90e3ad5ef7b5af16"><div class="ttname"><a href="namespacellvm_1_1MCID.html#a8035044d40d3758eb45b65dce69dc90ba32dbd2c72a98eaee90e3ad5ef7b5af16">llvm::MCID::Select</a></div><div class="ttdef"><b>Definition:</b> <a href="MCInstrDesc_8h_source.html#l00113">MCInstrDesc.h:113</a></div></div>
<div class="ttc" id="namespacellvm_1_1PatternMatch_html_a25d956d9e0beadd47ce4bc255dfa811d"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">llvm::PatternMatch::match</a></div><div class="ttdeci">bool match(Val *V, const Pattern &amp;P)</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l00042">PatternMatch.h:42</a></div></div>
<div class="ttc" id="Target_2README_8txt_html_a3217063f680fa8e35dea3c59b6e52b18"><div class="ttname"><a href="Target_2README_8txt.html#a3217063f680fa8e35dea3c59b6e52b18">int</a></div><div class="ttdeci">Clang compiles this i1 i64 store i64 i64 store i64 i64 store i64 i64 store i64 align Which gets codegen d xmm0 movaps rbp movaps rbp movaps rbp movaps rbp rbp rbp rbp rbp It would be better to have movq s of instead of the movaps s LLVM produces ret int</div><div class="ttdef"><b>Definition:</b> <a href="Target_2README_8txt_source.html#l00549">Target/README.txt:549</a></div></div>
<div class="ttc" id="classllvm_1_1APFloat_html_a26f3c979ec46a5d2d9bccd300eb606fea3a561d1750cb3c30d5deb1193c8e1ec5"><div class="ttname"><a href="classllvm_1_1APFloat.html#a26f3c979ec46a5d2d9bccd300eb606fea3a561d1750cb3c30d5deb1193c8e1ec5">llvm::APFloat::rmNearestTiesToEven</a></div><div class="ttdef"><b>Definition:</b> <a href="APFloat_8h_source.html#l00156">APFloat.h:156</a></div></div>
<div class="ttc" id="classllvm_1_1InstCombiner_html_af1fe6944d91c157469e8f5529e835b17"><div class="ttname"><a href="classllvm_1_1InstCombiner.html#af1fe6944d91c157469e8f5529e835b17">llvm::InstCombiner::visitFPToUI</a></div><div class="ttdeci">Instruction * visitFPToUI(FPToUIInst &amp;FI)</div><div class="ttdef"><b>Definition:</b> <a href="InstCombineCasts_8cpp_source.html#l01307">InstCombineCasts.cpp:1307</a></div></div>
<div class="ttc" id="classllvm_1_1AddrSpaceCastInst_html"><div class="ttname"><a href="classllvm_1_1AddrSpaceCastInst.html">llvm::AddrSpaceCastInst</a></div><div class="ttdoc">This class represents a conversion between pointers from one address space to another. </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l03624">Instructions.h:3624</a></div></div>
<div class="ttc" id="classllvm_1_1ConstantExpr_html_a81ad2fffd14e2df92cad4f631ae76480"><div class="ttname"><a href="classllvm_1_1ConstantExpr.html#a81ad2fffd14e2df92cad4f631ae76480">llvm::ConstantExpr::getIntegerCast</a></div><div class="ttdeci">static Constant * getIntegerCast(Constant *C, Type *Ty, bool isSigned)</div><div class="ttdoc">Create a ZExt, Bitcast or Trunc for integer -&gt; integer casts. </div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l01513">Constants.cpp:1513</a></div></div>
<div class="ttc" id="namespacellvm_1_1Intrinsic_html_a73349916f7e54a6b988a3646c7a02e90a2282198fc9635210d0f678fd0b92e5ce"><div class="ttname"><a href="namespacellvm_1_1Intrinsic.html#a73349916f7e54a6b988a3646c7a02e90a2282198fc9635210d0f678fd0b92e5ce">llvm::Intrinsic::sqrt</a></div><div class="ttdef"><b>Definition:</b> <a href="Intrinsics_8h_source.html#l02437">Intrinsics.h:2437</a></div></div>
<div class="ttc" id="classllvm_1_1InstCombiner_html_a5acf2a841db50684c87133f36bdd00a1"><div class="ttname"><a href="classllvm_1_1InstCombiner.html#a5acf2a841db50684c87133f36bdd00a1">llvm::InstCombiner::getDataLayout</a></div><div class="ttdeci">DataLayout * getDataLayout() const </div><div class="ttdef"><b>Definition:</b> <a href="InstCombine_8h_source.html#l00102">InstCombine.h:102</a></div></div>
<div class="ttc" id="classllvm_1_1SelectInst_html"><div class="ttname"><a href="classllvm_1_1SelectInst.html">llvm::SelectInst</a></div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l01430">Instructions.h:1430</a></div></div>
<div class="ttc" id="classllvm_1_1CastInst_html"><div class="ttname"><a href="classllvm_1_1CastInst.html">llvm::CastInst</a></div><div class="ttdoc">Base class of casting instructions. </div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00387">InstrTypes.h:387</a></div></div>
<div class="ttc" id="classllvm_1_1CmpInst_html_a283f9a5d4d843d20c40bb4d3e364bb05ac17897ebf2f6a6986280fc3bdf28a30a"><div class="ttname"><a href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05ac17897ebf2f6a6986280fc3bdf28a30a">llvm::CmpInst::ICMP_NE</a></div><div class="ttdoc">not equal </div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00673">InstrTypes.h:673</a></div></div>
<div class="ttc" id="ErrorHandling_8h_html_ace243f5c25697a1107cce46626b3dc94"><div class="ttname"><a href="ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a></div><div class="ttdeci">#define llvm_unreachable(msg)</div><div class="ttdef"><b>Definition:</b> <a href="ErrorHandling_8h_source.html#l00103">ErrorHandling.h:103</a></div></div>
<div class="ttc" id="classllvm_1_1ConstantExpr_html_aab1f107496b17acc1bc5fdcdb2903b38"><div class="ttname"><a href="classllvm_1_1ConstantExpr.html#aab1f107496b17acc1bc5fdcdb2903b38">llvm::ConstantExpr::getLShr</a></div><div class="ttdeci">static Constant * getLShr(Constant *C1, Constant *C2, bool isExact=false)</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l02118">Constants.cpp:2118</a></div></div>
<div class="ttc" id="classllvm_1_1SmallVectorImpl_html"><div class="ttname"><a href="classllvm_1_1SmallVectorImpl.html">llvm::SmallVectorImpl</a></div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l00035">APInt.h:35</a></div></div>
<div class="ttc" id="namespacellvm_1_1PatternMatch_html_a5b844aada27c4c6fdb87146ac458c0d8"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#a5b844aada27c4c6fdb87146ac458c0d8">llvm::PatternMatch::m_Trunc</a></div><div class="ttdeci">CastClass_match&lt; OpTy, Instruction::Trunc &gt; m_Trunc(const OpTy &amp;Op)</div><div class="ttdoc">m_Trunc </div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l00678">PatternMatch.h:678</a></div></div>
<div class="ttc" id="classllvm_1_1IRBuilder_html"><div class="ttname"><a href="classllvm_1_1IRBuilder.html">llvm::IRBuilder&lt; true, TargetFolder &gt;</a></div></div>
<div class="ttc" id="classllvm_1_1InstCombiner_html"><div class="ttname"><a href="classllvm_1_1InstCombiner.html">llvm::InstCombiner</a></div><div class="ttdoc">InstCombiner - The -instcombine pass. </div><div class="ttdef"><b>Definition:</b> <a href="InstCombine_8h_source.html#l00072">InstCombine.h:72</a></div></div>
<div class="ttc" id="classllvm_1_1InstCombiner_html_a0a4568129d1dec583a22775432df4717"><div class="ttname"><a href="classllvm_1_1InstCombiner.html#a0a4568129d1dec583a22775432df4717">llvm::InstCombiner::visitIntToPtr</a></div><div class="ttdeci">Instruction * visitIntToPtr(IntToPtrInst &amp;CI)</div><div class="ttdef"><b>Definition:</b> <a href="InstCombineCasts_8cpp_source.html#l01355">InstCombineCasts.cpp:1355</a></div></div>
<div class="ttc" id="classllvm_1_1InstCombiner_html_aaaeb72153a2ba334d852ef923f2b6ade"><div class="ttname"><a href="classllvm_1_1InstCombiner.html#aaaeb72153a2ba334d852ef923f2b6ade">llvm::InstCombiner::visitAddrSpaceCast</a></div><div class="ttdeci">Instruction * visitAddrSpaceCast(AddrSpaceCastInst &amp;CI)</div><div class="ttdef"><b>Definition:</b> <a href="InstCombineCasts_8cpp_source.html#l01860">InstCombineCasts.cpp:1860</a></div></div>
<div class="ttc" id="classllvm_1_1AllocaInst_html_a214c60dbb4f1ed467e5a3420db6eefd6"><div class="ttname"><a href="classllvm_1_1AllocaInst.html#a214c60dbb4f1ed467e5a3420db6eefd6">llvm::AllocaInst::getAllocatedType</a></div><div class="ttdeci">Type * getAllocatedType() const </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8cpp_source.html#l00906">Instructions.cpp:906</a></div></div>
<div class="ttc" id="classllvm_1_1Instruction_html_afa0b2fa29ba074f2b6ec9ac11163f2d9"><div class="ttname"><a href="classllvm_1_1Instruction.html#afa0b2fa29ba074f2b6ec9ac11163f2d9">llvm::Instruction::CastOps</a></div><div class="ttdeci">CastOps</div><div class="ttdef"><b>Definition:</b> <a href="Instruction_8h_source.html#l00401">Instruction.h:401</a></div></div>
<div class="ttc" id="classllvm_1_1Type_html_a489d14cb1d049f4bcc5e3e9cdaf9c54d"><div class="ttname"><a href="classllvm_1_1Type.html#a489d14cb1d049f4bcc5e3e9cdaf9c54d">llvm::Type::getPPC_FP128Ty</a></div><div class="ttdeci">static Type * getPPC_FP128Ty(LLVMContext &amp;C)</div><div class="ttdef"><b>Definition:</b> <a href="Type_8cpp_source.html#l00235">Type.cpp:235</a></div></div>
<div class="ttc" id="classllvm_1_1Instruction_html"><div class="ttname"><a href="classllvm_1_1Instruction.html">llvm::Instruction</a></div><div class="ttdef"><b>Definition:</b> <a href="Instruction_8h_source.html#l00031">Instruction.h:31</a></div></div>
<div class="ttc" id="TargetLibraryInfo_8h_html"><div class="ttname"><a href="TargetLibraryInfo_8h.html">TargetLibraryInfo.h</a></div></div>
<div class="ttc" id="InstCombineCasts_8cpp_html_ac8947451998676abcce5452a1a8f5848"><div class="ttname"><a href="InstCombineCasts_8cpp.html#ac8947451998676abcce5452a1a8f5848">getTypeSizeIndex</a></div><div class="ttdeci">static unsigned getTypeSizeIndex(unsigned Value, Type *Ty)</div><div class="ttdef"><b>Definition:</b> <a href="InstCombineCasts_8cpp_source.html#l01517">InstCombineCasts.cpp:1517</a></div></div>
<div class="ttc" id="namespacellvm_1_1PatternMatch_html_a4cfd328368353696e64a4d1b15a7cbfa"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#a4cfd328368353696e64a4d1b15a7cbfa">llvm::PatternMatch::m_Not</a></div><div class="ttdeci">not_match&lt; LHS &gt; m_Not(const LHS &amp;L)</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l00738">PatternMatch.h:738</a></div></div>
<div class="ttc" id="classllvm_1_1PtrToIntInst_html"><div class="ttname"><a href="classllvm_1_1PtrToIntInst.html">llvm::PtrToIntInst</a></div><div class="ttdoc">This class represents a cast from a pointer to an integer. </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l03539">Instructions.h:3539</a></div></div>
<div class="ttc" id="classllvm_1_1ConstantInt_html_a6edd823ba5e4e1effc8280ca8a1194ef"><div class="ttname"><a href="classllvm_1_1ConstantInt.html#a6edd823ba5e4e1effc8280ca8a1194ef">llvm::ConstantInt::getZExtValue</a></div><div class="ttdeci">uint64_t getZExtValue() const </div><div class="ttdoc">Return the zero extended value. </div><div class="ttdef"><b>Definition:</b> <a href="Constants_8h_source.html#l00116">Constants.h:116</a></div></div>
<div class="ttc" id="classllvm_1_1ConstantExpr_html"><div class="ttname"><a href="classllvm_1_1ConstantExpr.html">llvm::ConstantExpr</a></div><div class="ttdef"><b>Definition:</b> <a href="Constants_8h_source.html#l00790">Constants.h:790</a></div></div>
<div class="ttc" id="InstCombineCasts_8cpp_html_a8efab72b40fc7836709221d3e97139c6"><div class="ttname"><a href="InstCombineCasts_8cpp.html#a8efab72b40fc7836709221d3e97139c6">isMultipleOfTypeSize</a></div><div class="ttdeci">static bool isMultipleOfTypeSize(unsigned Value, Type *Ty)</div><div class="ttdef"><b>Definition:</b> <a href="InstCombineCasts_8cpp_source.html#l01513">InstCombineCasts.cpp:1513</a></div></div>
<div class="ttc" id="InstCombineCasts_8cpp_html_a6fd17099ed520f179e5b481db961e0e1"><div class="ttname"><a href="InstCombineCasts_8cpp.html#a6fd17099ed520f179e5b481db961e0e1">CanEvaluateTruncated</a></div><div class="ttdeci">static bool CanEvaluateTruncated(Value *V, Type *Ty)</div><div class="ttdef"><b>Definition:</b> <a href="InstCombineCasts_8cpp_source.html#l00335">InstCombineCasts.cpp:335</a></div></div>
<div class="ttc" id="Target_2README_8txt_html_a8db36c82f32d6f6a4d35a00e55be03a8"><div class="ttname"><a href="Target_2README_8txt.html#a8db36c82f32d6f6a4d35a00e55be03a8">Shift</a></div><div class="ttdeci">bool Shift</div><div class="ttdef"><b>Definition:</b> <a href="Target_2README_8txt_source.html#l00506">Target/README.txt:506</a></div></div>
<div class="ttc" id="classllvm_1_1Instruction_html_ac26154a24f393f523c87cc5f8239f36c"><div class="ttname"><a href="classllvm_1_1Instruction.html#ac26154a24f393f523c87cc5f8239f36c">llvm::Instruction::BinaryOps</a></div><div class="ttdeci">BinaryOps</div><div class="ttdef"><b>Definition:</b> <a href="Instruction_8h_source.html#l00387">Instruction.h:387</a></div></div>
<div class="ttc" id="namespacellvm_1_1PatternMatch_html_a2cbdca7c8267aac6914d674f8e81841b"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#a2cbdca7c8267aac6914d674f8e81841b">llvm::PatternMatch::m_ZExt</a></div><div class="ttdeci">CastClass_match&lt; OpTy, Instruction::ZExt &gt; m_ZExt(const OpTy &amp;Op)</div><div class="ttdoc">m_ZExt </div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l00692">PatternMatch.h:692</a></div></div>
<div class="ttc" id="namespacellvm_html_a8891be7c27326c20a6dba7d98e9030b5"><div class="ttname"><a href="namespacellvm.html#a8891be7c27326c20a6dba7d98e9030b5">llvm::ConstantFoldConstantExpression</a></div><div class="ttdeci">Constant * ConstantFoldConstantExpression(const ConstantExpr *CE, const DataLayout *TD=0, const TargetLibraryInfo *TLI=0)</div><div class="ttdef"><b>Definition:</b> <a href="ConstantFolding_8cpp_source.html#l00937">ConstantFolding.cpp:937</a></div></div>
<div class="ttc" id="classllvm_1_1BitCastInst_html"><div class="ttname"><a href="classllvm_1_1BitCastInst.html">llvm::BitCastInst</a></div><div class="ttdoc">This class represents a no-op cast from one type to another. </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l03587">Instructions.h:3587</a></div></div>
<div class="ttc" id="namespacellvm_1_1LibFunc_html_abf8f6830387f338fed0bce2e65108c6fac68935baf041f4139079dbd9ddc76698"><div class="ttname"><a href="namespacellvm_1_1LibFunc.html#abf8f6830387f338fed0bce2e65108c6fac68935baf041f4139079dbd9ddc76698">llvm::LibFunc::sqrt</a></div><div class="ttdoc">double sqrt(double x); </div><div class="ttdef"><b>Definition:</b> <a href="TargetLibraryInfo_8h_source.html#l00513">TargetLibraryInfo.h:513</a></div></div>
<div class="ttc" id="namespacellvm_1_1PatternMatch_html_a34a92072122412c6020d4afb43725bf4"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#a34a92072122412c6020d4afb43725bf4">llvm::PatternMatch::m_ConstantInt</a></div><div class="ttdeci">class_match&lt; ConstantInt &gt; m_ConstantInt()</div><div class="ttdoc">m_ConstantInt() - Match an arbitrary ConstantInt and ignore it. </div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l00072">PatternMatch.h:72</a></div></div>
<div class="ttc" id="namespacellvm_html_af6d6a791770bad2303c4399986979e3eae411369b2f0d8f484fec62c3291b1b51"><div class="ttname"><a href="namespacellvm.html#af6d6a791770bad2303c4399986979e3eae411369b2f0d8f484fec62c3291b1b51">llvm::Call</a></div><div class="ttdef"><b>Definition:</b> <a href="CallingConvLower_8h_source.html#l00149">CallingConvLower.h:149</a></div></div>
<div class="ttc" id="namespacellvm_1_1Intrinsic_html_a842176a2c8c60a94bc788454b0828ea2"><div class="ttname"><a href="namespacellvm_1_1Intrinsic.html#a842176a2c8c60a94bc788454b0828ea2">llvm::Intrinsic::getDeclaration</a></div><div class="ttdeci">Function * getDeclaration(Module *M, ID id, ArrayRef&lt; Type * &gt; Tys=None)</div><div class="ttdef"><b>Definition:</b> <a href="Function_8cpp_source.html#l00683">Function.cpp:683</a></div></div>
<div class="ttc" id="classllvm_1_1FPToSIInst_html"><div class="ttname"><a href="classllvm_1_1FPToSIInst.html">llvm::FPToSIInst</a></div><div class="ttdoc">This class represents a cast from floating point to signed integer. </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l03463">Instructions.h:3463</a></div></div>
<div class="ttc" id="classllvm_1_1VectorType_html_a580510fa692dccfb26d0e967d8f164e7"><div class="ttname"><a href="classllvm_1_1VectorType.html#a580510fa692dccfb26d0e967d8f164e7">llvm::VectorType::getNumElements</a></div><div class="ttdeci">unsigned getNumElements() const </div><div class="ttdoc">Return the number of elements in the Vector type. </div><div class="ttdef"><b>Definition:</b> <a href="DerivedTypes_8h_source.html#l00408">DerivedTypes.h:408</a></div></div>
<div class="ttc" id="classllvm_1_1Value_html_ae855357b6c5e6e7ed1869272708a3a84"><div class="ttname"><a href="classllvm_1_1Value.html#ae855357b6c5e6e7ed1869272708a3a84">llvm::Value::takeName</a></div><div class="ttdeci">void takeName(Value *V)</div><div class="ttdef"><b>Definition:</b> <a href="Value_8cpp_source.html#l00239">Value.cpp:239</a></div></div>
<div class="ttc" id="classllvm_1_1TruncInst_html"><div class="ttname"><a href="classllvm_1_1TruncInst.html">llvm::TruncInst</a></div><div class="ttdoc">This class represents a truncation of integer types. </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l03175">Instructions.h:3175</a></div></div>
<div class="ttc" id="classllvm_1_1SequentialType_html_a39f2c3a62f293faf11ac28b15bc53359"><div class="ttname"><a href="classllvm_1_1SequentialType.html#a39f2c3a62f293faf11ac28b15bc53359">llvm::SequentialType::getElementType</a></div><div class="ttdeci">Type * getElementType() const </div><div class="ttdef"><b>Definition:</b> <a href="DerivedTypes_8h_source.html#l00319">DerivedTypes.h:319</a></div></div>
<div class="ttc" id="namespacellvm_html_a7985318bedfe5c2040025ef13db9c57b"><div class="ttname"><a href="namespacellvm.html#a7985318bedfe5c2040025ef13db9c57b">llvm::ComputeMaskedBits</a></div><div class="ttdeci">void ComputeMaskedBits(Value *V, APInt &amp;KnownZero, APInt &amp;KnownOne, const DataLayout *TD=0, unsigned Depth=0)</div><div class="ttdef"><b>Definition:</b> <a href="ValueTracking_8cpp_source.html#l00229">ValueTracking.cpp:229</a></div></div>
<div class="ttc" id="classllvm_1_1PointerType_html"><div class="ttname"><a href="classllvm_1_1PointerType.html">llvm::PointerType</a></div><div class="ttdef"><b>Definition:</b> <a href="DerivedTypes_8h_source.html#l00425">DerivedTypes.h:425</a></div></div>
<div class="ttc" id="classllvm_1_1PHINode_html_aa45f6c0433576e3858a6209a43750ad4"><div class="ttname"><a href="classllvm_1_1PHINode.html#aa45f6c0433576e3858a6209a43750ad4">llvm::PHINode::getNumIncomingValues</a></div><div class="ttdeci">unsigned getNumIncomingValues() const </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02055">Instructions.h:2055</a></div></div>
<div class="ttc" id="classllvm_1_1CastInst_html_a0f7dea9550778374905e12da6d6ba8a8"><div class="ttname"><a href="classllvm_1_1CastInst.html#a0f7dea9550778374905e12da6d6ba8a8">llvm::CastInst::Create</a></div><div class="ttdeci">static CastInst * Create(Instruction::CastOps, Value *S, Type *Ty, const Twine &amp;Name=&quot;&quot;, Instruction *InsertBefore=0)</div><div class="ttdoc">Construct any of the CastInst subclasses. </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8cpp_source.html#l02350">Instructions.cpp:2350</a></div></div>
<div class="ttc" id="classllvm_1_1APInt_html_adcb96bd09d7c75c7669fa5f9d1190899"><div class="ttname"><a href="classllvm_1_1APInt.html#adcb96bd09d7c75c7669fa5f9d1190899">llvm::APInt::getHighBitsSet</a></div><div class="ttdeci">static APInt getHighBitsSet(unsigned numBits, unsigned hiBitsSet)</div><div class="ttdoc">Get a value with high bits set. </div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l00510">APInt.h:510</a></div></div>
<div class="ttc" id="classllvm_1_1GetElementPtrInst_html"><div class="ttname"><a href="classllvm_1_1GetElementPtrInst.html">llvm::GetElementPtrInst</a></div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00709">Instructions.h:709</a></div></div>
<div class="ttc" id="classllvm_1_1APFloat_html"><div class="ttname"><a href="classllvm_1_1APFloat.html">llvm::APFloat</a></div><div class="ttdoc">A self-contained host- and target-independent arbitrary-precision floating-point software implementat...</div><div class="ttdef"><b>Definition:</b> <a href="APFloat_8h_source.html#l00122">APFloat.h:122</a></div></div>
<div class="ttc" id="README__ALTIVEC_8txt_html_a9aacd9146afe44bf656cd664e2a88c8c"><div class="ttname"><a href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a></div><div class="ttdeci">(vector float) vec_cmpeq(*A,*B) C</div><div class="ttdef"><b>Definition:</b> <a href="README__ALTIVEC_8txt_source.html#l00091">README_ALTIVEC.txt:91</a></div></div>
<div class="ttc" id="namespacellvm_1_1PatternMatch_html_aa08fee11e8a5ec10c0cc2a7abbbd799a"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#aa08fee11e8a5ec10c0cc2a7abbbd799a">llvm::PatternMatch::m_LShr</a></div><div class="ttdeci">BinaryOp_match&lt; LHS, RHS, Instruction::LShr &gt; m_LShr(const LHS &amp;L, const RHS &amp;R)</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l00491">PatternMatch.h:491</a></div></div>
<div class="ttc" id="Target_2X86_2README_8txt_html_a8ef54f27fddd11cc461b2b231fc2d23c"><div class="ttname"><a href="Target_2X86_2README_8txt.html#a8ef54f27fddd11cc461b2b231fc2d23c">ret</a></div><div class="ttdeci">to esp esp setne al movzbw ax esp setg cl movzbw cx cmove cx cl jne LBB1_2 esp ret(also really horrible code on ppc).This is due to the expand code for 64-bit compares.GCC produces multiple branches</div></div>
<div class="ttc" id="classllvm_1_1InsertElementInst_html"><div class="ttname"><a href="classllvm_1_1InsertElementInst.html">llvm::InsertElementInst</a></div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l01602">Instructions.h:1602</a></div></div>
<div class="ttc" id="InstCombineCasts_8cpp_html_a865e260a33c703d12c88d6fa42f1afb9"><div class="ttname"><a href="InstCombineCasts_8cpp.html#a865e260a33c703d12c88d6fa42f1afb9">DecomposeSimpleLinearExpr</a></div><div class="ttdeci">static Value * DecomposeSimpleLinearExpr(Value *Val, unsigned &amp;Scale, uint64_t &amp;Offset)</div><div class="ttdef"><b>Definition:</b> <a href="InstCombineCasts_8cpp_source.html#l00026">InstCombineCasts.cpp:26</a></div></div>
<div class="ttc" id="classllvm_1_1InsertElementInst_html_a968cd6a1853b174636da54c36ae25425"><div class="ttname"><a href="classllvm_1_1InsertElementInst.html#a968cd6a1853b174636da54c36ae25425">llvm::InsertElementInst::Create</a></div><div class="ttdeci">static InsertElementInst * Create(Value *Vec, Value *NewElt, Value *Idx, const Twine &amp;NameStr=&quot;&quot;, Instruction *InsertBefore=0)</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l01612">Instructions.h:1612</a></div></div>
<div class="ttc" id="classllvm_1_1Module_html_a96581205e1149f5d70b56f9a83bc841a"><div class="ttname"><a href="classllvm_1_1Module.html#a96581205e1149f5d70b56f9a83bc841a">llvm::Module::getOrInsertFunction</a></div><div class="ttdeci">Constant * getOrInsertFunction(StringRef Name, FunctionType *T, AttributeSet AttributeList)</div><div class="ttdef"><b>Definition:</b> <a href="Module_8cpp_source.html#l00138">Module.cpp:138</a></div></div>
<div class="ttc" id="classllvm_1_1Type_html"><div class="ttname"><a href="classllvm_1_1Type.html">llvm::Type</a></div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00044">Type.h:44</a></div></div>
<div class="ttc" id="classllvm_1_1Type_html_a6f725580f7834e2ca90762965866dad4"><div class="ttname"><a href="classllvm_1_1Type.html#a6f725580f7834e2ca90762965866dad4">llvm::Type::isVectorTy</a></div><div class="ttdeci">bool isVectorTy() const </div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00229">Type.h:229</a></div></div>
<div class="ttc" id="classllvm_1_1Function_html_a7e47131185becc5c96731a2e28441b77"><div class="ttname"><a href="classllvm_1_1Function.html#a7e47131185becc5c96731a2e28441b77">llvm::Function::getIntrinsicID</a></div><div class="ttdeci">unsigned getIntrinsicID() const LLVM_READONLY</div><div class="ttdef"><b>Definition:</b> <a href="Function_8cpp_source.html#l00371">Function.cpp:371</a></div></div>
<div class="ttc" id="namespacellvm_1_1PatternMatch_html_ac0467ca7fad871738b10db95feb40dad"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#ac0467ca7fad871738b10db95feb40dad">llvm::PatternMatch::m_BitCast</a></div><div class="ttdeci">CastClass_match&lt; OpTy, Instruction::BitCast &gt; m_BitCast(const OpTy &amp;Op)</div><div class="ttdoc">m_BitCast </div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l00664">PatternMatch.h:664</a></div></div>
<div class="ttc" id="classllvm_1_1Constant_html"><div class="ttname"><a href="classllvm_1_1Constant.html">llvm::Constant</a></div><div class="ttdoc">LLVM Constant Representation. </div><div class="ttdef"><b>Definition:</b> <a href="Constant_8h_source.html#l00041">Constant.h:41</a></div></div>
<div class="ttc" id="classllvm_1_1AllocaInst_html_a597c918a615f26a0cea7adb84f06fc3f"><div class="ttname"><a href="classllvm_1_1AllocaInst.html#a597c918a615f26a0cea7adb84f06fc3f">llvm::AllocaInst::getType</a></div><div class="ttdeci">PointerType * getType() const </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00091">Instructions.h:91</a></div></div>
<div class="ttc" id="classllvm_1_1APInt_html_a7189a37206963029447c31d57771b997"><div class="ttname"><a href="classllvm_1_1APInt.html#a7189a37206963029447c31d57771b997">llvm::APInt::getSExtValue</a></div><div class="ttdeci">int64_t getSExtValue() const </div><div class="ttdoc">Get sign extended value. </div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l01318">APInt.h:1318</a></div></div>
<div class="ttc" id="classllvm_1_1Type_html_aeb06cf0f813f643b62d8dd98db0bc249"><div class="ttname"><a href="classllvm_1_1Type.html#aeb06cf0f813f643b62d8dd98db0bc249">llvm::Type::isFloatTy</a></div><div class="ttdeci">bool isFloatTy() const </div><div class="ttdoc">isFloatTy - Return true if this is &amp;#39;float&amp;#39;, a 32-bit IEEE fp type. </div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00146">Type.h:146</a></div></div>
<div class="ttc" id="namespacellvm_1_1APIntOps_html_a22f056804d2b9882f74adc905872bc39"><div class="ttname"><a href="namespacellvm_1_1APIntOps.html#a22f056804d2b9882f74adc905872bc39">llvm::APIntOps::Or</a></div><div class="ttdeci">APInt Or(const APInt &amp;LHS, const APInt &amp;RHS)</div><div class="ttdoc">Bitwise OR function for APInt. </div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l01845">APInt.h:1845</a></div></div>
<div class="ttc" id="classllvm_1_1AllocaInst_html_ad441932c20e5b9ba36c8c72a6c7f5ec3"><div class="ttname"><a href="classllvm_1_1AllocaInst.html#ad441932c20e5b9ba36c8c72a6c7f5ec3">llvm::AllocaInst::getAlignment</a></div><div class="ttdeci">unsigned getAlignment() const </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00103">Instructions.h:103</a></div></div>
<div class="ttc" id="classllvm_1_1ConstantFP_html"><div class="ttname"><a href="classllvm_1_1ConstantFP.html">llvm::ConstantFP</a></div><div class="ttdef"><b>Definition:</b> <a href="Constants_8h_source.html#l00232">Constants.h:232</a></div></div>
<div class="ttc" id="namespacellvm_1_1APIntOps_html_afc7c4d88d09cba0c5e920f8a3a3ace55"><div class="ttname"><a href="namespacellvm_1_1APIntOps.html#afc7c4d88d09cba0c5e920f8a3a3ace55">llvm::APIntOps::Xor</a></div><div class="ttdeci">APInt Xor(const APInt &amp;LHS, const APInt &amp;RHS)</div><div class="ttdoc">Bitwise XOR function for APInt. </div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l01850">APInt.h:1850</a></div></div>
<div class="ttc" id="classllvm_1_1ExtractElementInst_html_a671ded0c51dd6de0eaf145cde783d81e"><div class="ttname"><a href="classllvm_1_1ExtractElementInst.html#a671ded0c51dd6de0eaf145cde783d81e">llvm::ExtractElementInst::Create</a></div><div class="ttdeci">static ExtractElementInst * Create(Value *Vec, Value *Idx, const Twine &amp;NameStr=&quot;&quot;, Instruction *InsertBefore=0)</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l01551">Instructions.h:1551</a></div></div>
<div class="ttc" id="classllvm_1_1PtrToIntInst_html_a8d359742fe9dc58401606784a0d96859"><div class="ttname"><a href="classllvm_1_1PtrToIntInst.html#a8d359742fe9dc58401606784a0d96859">llvm::PtrToIntInst::getPointerAddressSpace</a></div><div class="ttdeci">unsigned getPointerAddressSpace() const </div><div class="ttdoc">Returns the address space of the pointer operand. </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l03569">Instructions.h:3569</a></div></div>
<div class="ttc" id="classllvm_1_1PHINode_html_afb5e83bf5123ff7c51058eb0ebebcdc6"><div class="ttname"><a href="classllvm_1_1PHINode.html#afb5e83bf5123ff7c51058eb0ebebcdc6">llvm::PHINode::Create</a></div><div class="ttdeci">static PHINode * Create(Type *Ty, unsigned NumReservedValues, const Twine &amp;NameStr=&quot;&quot;, Instruction *InsertBefore=0)</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02013">Instructions.h:2013</a></div></div>
<div class="ttc" id="classllvm_1_1PHINode_html_a4c25b6c00c4867281779c81ab64d2081"><div class="ttname"><a href="classllvm_1_1PHINode.html#a4c25b6c00c4867281779c81ab64d2081">llvm::PHINode::getIncomingBlock</a></div><div class="ttdeci">BasicBlock * getIncomingBlock(unsigned i) const </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02074">Instructions.h:2074</a></div></div>
<div class="ttc" id="namespacellvm_1_1PatternMatch_html_a37668d9884c78ac77254cf9fb8a4276a"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#a37668d9884c78ac77254cf9fb8a4276a">llvm::PatternMatch::m_Shl</a></div><div class="ttdeci">BinaryOp_match&lt; LHS, RHS, Instruction::Shl &gt; m_Shl(const LHS &amp;L, const RHS &amp;R)</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l00485">PatternMatch.h:485</a></div></div>
<div class="ttc" id="classllvm_1_1ICmpInst_html"><div class="ttname"><a href="classllvm_1_1ICmpInst.html">llvm::ICmpInst</a></div><div class="ttdoc">Represent an integer comparison operator. </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00911">Instructions.h:911</a></div></div>
<div class="ttc" id="classllvm_1_1CmpInst_html_a283f9a5d4d843d20c40bb4d3e364bb05"><div class="ttname"><a href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05">llvm::CmpInst::Predicate</a></div><div class="ttdeci">Predicate</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00651">InstrTypes.h:651</a></div></div>
<div class="ttc" id="classllvm_1_1OverflowingBinaryOperator_html"><div class="ttname"><a href="classllvm_1_1OverflowingBinaryOperator.html">llvm::OverflowingBinaryOperator</a></div><div class="ttdef"><b>Definition:</b> <a href="Operator_8h_source.html#l00079">Operator.h:79</a></div></div>
<div class="ttc" id="classllvm_1_1APFloat_html_a4fa2f1464bb4f645082d8aa0e0a9bc0e"><div class="ttname"><a href="classllvm_1_1APFloat.html#a4fa2f1464bb4f645082d8aa0e0a9bc0e">llvm::APFloat::convert</a></div><div class="ttdeci">opStatus convert(const fltSemantics &amp;, roundingMode, bool *)</div><div class="ttdef"><b>Definition:</b> <a href="APFloat_8cpp_source.html#l01938">APFloat.cpp:1938</a></div></div>
<div class="ttc" id="classllvm_1_1APInt_html_a0229ff3a1d7432810a86c8efab115c33"><div class="ttname"><a href="classllvm_1_1APInt.html#a0229ff3a1d7432810a86c8efab115c33">llvm::APInt::uge</a></div><div class="ttdeci">bool uge(const APInt &amp;RHS) const </div><div class="ttdoc">Unsigned greater or equal comparison. </div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l01116">APInt.h:1116</a></div></div>
<div class="ttc" id="classllvm_1_1User_html_a997ff6a1758bf732b9b263fc61011644"><div class="ttname"><a href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">llvm::User::getOperand</a></div><div class="ttdeci">Value * getOperand(unsigned i) const </div><div class="ttdef"><b>Definition:</b> <a href="User_8h_source.html#l00088">User.h:88</a></div></div>
<div class="ttc" id="classllvm_1_1IntegerType_html"><div class="ttname"><a href="classllvm_1_1IntegerType.html">llvm::IntegerType</a></div><div class="ttdoc">Integer representation type. </div><div class="ttdef"><b>Definition:</b> <a href="DerivedTypes_8h_source.html#l00037">DerivedTypes.h:37</a></div></div>
<div class="ttc" id="classllvm_1_1APInt_html_ac9d5eb700dcdf604653d12d8caf4a0fb"><div class="ttname"><a href="classllvm_1_1APInt.html#ac9d5eb700dcdf604653d12d8caf4a0fb">llvm::APInt::countPopulation</a></div><div class="ttdeci">unsigned countPopulation() const </div><div class="ttdoc">Count the number of bits set. </div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l01394">APInt.h:1394</a></div></div>
<div class="ttc" id="classllvm_1_1CmpInst_html_a8afd4995fae596b2c86eeed85b3d388b"><div class="ttname"><a href="classllvm_1_1CmpInst.html#a8afd4995fae596b2c86eeed85b3d388b">llvm::CmpInst::getPredicate</a></div><div class="ttdeci">Predicate getPredicate() const </div><div class="ttdoc">Return the predicate for this instruction. </div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00714">InstrTypes.h:714</a></div></div>
<div class="ttc" id="InstCombineCasts_8cpp_html_acb5a7eff32dd4405f0e795ba98bdbc4e"><div class="ttname"><a href="InstCombineCasts_8cpp.html#acb5a7eff32dd4405f0e795ba98bdbc4e">OptimizeVectorResize</a></div><div class="ttdeci">static Instruction * OptimizeVectorResize(Value *InVal, VectorType *DestTy, InstCombiner &amp;IC)</div><div class="ttdef"><b>Definition:</b> <a href="InstCombineCasts_8cpp_source.html#l01461">InstCombineCasts.cpp:1461</a></div></div>
<div class="ttc" id="classllvm_1_1IntToPtrInst_html"><div class="ttname"><a href="classllvm_1_1IntToPtrInst.html">llvm::IntToPtrInst</a></div><div class="ttdoc">This class represents a cast from an integer to a pointer. </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l03499">Instructions.h:3499</a></div></div>
<div class="ttc" id="classllvm_1_1Constant_html_a4d51384de6e1798bb6aa875aebeea9f0"><div class="ttname"><a href="classllvm_1_1Constant.html#a4d51384de6e1798bb6aa875aebeea9f0">llvm::Constant::getAllOnesValue</a></div><div class="ttdeci">static Constant * getAllOnesValue(Type *Ty)</div><div class="ttdoc">Get the all ones value. </div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l00163">Constants.cpp:163</a></div></div>
<div class="ttc" id="classllvm_1_1InstCombiner_html_a7c7b701b8d17f33120903f28cde461bb"><div class="ttname"><a href="classllvm_1_1InstCombiner.html#a7c7b701b8d17f33120903f28cde461bb">llvm::InstCombiner::visitFPToSI</a></div><div class="ttdeci">Instruction * visitFPToSI(FPToSIInst &amp;FI)</div><div class="ttdef"><b>Definition:</b> <a href="InstCombineCasts_8cpp_source.html#l01327">InstCombineCasts.cpp:1327</a></div></div>
<div class="ttc" id="classllvm_1_1Type_html_ad083201ba4e1f8217bdc1f1ab05bd83d"><div class="ttname"><a href="classllvm_1_1Type.html#ad083201ba4e1f8217bdc1f1ab05bd83d">llvm::Type::getNumContainedTypes</a></div><div class="ttdeci">unsigned getNumContainedTypes() const </div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00346">Type.h:346</a></div></div>
<div class="ttc" id="classllvm_1_1InstCombiner_html_a6e33228c0d5bb3b72f357677fa105185"><div class="ttname"><a href="classllvm_1_1InstCombiner.html#a6e33228c0d5bb3b72f357677fa105185">llvm::InstCombiner::Builder</a></div><div class="ttdeci">BuilderTy * Builder</div><div class="ttdef"><b>Definition:</b> <a href="InstCombine_8h_source.html#l00087">InstCombine.h:87</a></div></div>
<div class="ttc" id="classllvm_1_1Type_html_a2eba483f5cc876e824aa6c085736086b"><div class="ttname"><a href="classllvm_1_1Type.html#a2eba483f5cc876e824aa6c085736086b">llvm::Type::isPointerTy</a></div><div class="ttdeci">bool isPointerTy() const </div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00220">Type.h:220</a></div></div>
<div class="ttc" id="classllvm_1_1UndefValue_html_a4ae5ff22b700a42bcc5d889233721335"><div class="ttname"><a href="classllvm_1_1UndefValue.html#a4ae5ff22b700a42bcc5d889233721335">llvm::UndefValue::get</a></div><div class="ttdeci">static UndefValue * get(Type *T)</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l01334">Constants.cpp:1334</a></div></div>
<div class="ttc" id="classllvm_1_1Value_html_af85a4828b6b5a8de7fc0a55cc0e5b52f"><div class="ttname"><a href="classllvm_1_1Value.html#af85a4828b6b5a8de7fc0a55cc0e5b52f">llvm::Value::getContext</a></div><div class="ttdeci">LLVMContext &amp; getContext() const </div><div class="ttdoc">All values hold a context through their type. </div><div class="ttdef"><b>Definition:</b> <a href="Value_8cpp_source.html#l00517">Value.cpp:517</a></div></div>
<div class="ttc" id="classllvm_1_1SelectInst_html_a67bf091383cd61e1225445e78b61d9f9"><div class="ttname"><a href="classllvm_1_1SelectInst.html#a67bf091383cd61e1225445e78b61d9f9">llvm::SelectInst::getTrueValue</a></div><div class="ttdeci">const Value * getTrueValue() const </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l01467">Instructions.h:1467</a></div></div>
<div class="ttc" id="classllvm_1_1APInt_html_af3deb6522c4fe2043fe07af2ec90190c"><div class="ttname"><a href="classllvm_1_1APInt.html#af3deb6522c4fe2043fe07af2ec90190c">llvm::APInt::isPowerOf2</a></div><div class="ttdeci">bool isPowerOf2() const </div><div class="ttdoc">Check if this APInt&amp;#39;s value is a power of two greater than zero. </div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l00390">APInt.h:390</a></div></div>
<div class="ttc" id="classllvm_1_1APFloat_html_acd77961b2028e148c829b18ceaef81c4"><div class="ttname"><a href="classllvm_1_1APFloat.html#acd77961b2028e148c829b18ceaef81c4">llvm::APFloat::IEEEhalf</a></div><div class="ttdeci">static const fltSemantics IEEEhalf</div><div class="ttdef"><b>Definition:</b> <a href="APFloat_8h_source.html#l00131">APFloat.h:131</a></div></div>
<div class="ttc" id="classllvm_1_1CmpInst_html_a283f9a5d4d843d20c40bb4d3e364bb05a720a42e85f7e981afd61e28473b0000a"><div class="ttname"><a href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05a720a42e85f7e981afd61e28473b0000a">llvm::CmpInst::ICMP_SGT</a></div><div class="ttdoc">signed greater than </div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00678">InstrTypes.h:678</a></div></div>
<div class="ttc" id="classllvm_1_1CallInst_html_a861226dd056dd2438da26760b8e7a9a0"><div class="ttname"><a href="classllvm_1_1CallInst.html#a861226dd056dd2438da26760b8e7a9a0">llvm::CallInst::Create</a></div><div class="ttdeci">static CallInst * Create(Value *Func, ArrayRef&lt; Value * &gt; Args, const Twine &amp;NameStr=&quot;&quot;, Instruction *InsertBefore=0)</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l01187">Instructions.h:1187</a></div></div>
<div class="ttc" id="classllvm_1_1APInt_html_aac277496191547e487eea07f09dffd4b"><div class="ttname"><a href="classllvm_1_1APInt.html#aac277496191547e487eea07f09dffd4b">llvm::APInt::countTrailingZeros</a></div><div class="ttdeci">unsigned countTrailingZeros() const </div><div class="ttdoc">Count the number of trailing zero bits. </div><div class="ttdef"><b>Definition:</b> <a href="APInt_8cpp_source.html#l00736">APInt.cpp:736</a></div></div>
<div class="ttc" id="classllvm_1_1DataLayout_html_ae84bb2408dfffa4e8b5fe2ce0714a3bd"><div class="ttname"><a href="classllvm_1_1DataLayout.html#ae84bb2408dfffa4e8b5fe2ce0714a3bd">llvm::DataLayout::getIntPtrType</a></div><div class="ttdeci">IntegerType * getIntPtrType(LLVMContext &amp;C, unsigned AddressSpace=0) const </div><div class="ttdef"><b>Definition:</b> <a href="DataLayout_8cpp_source.html#l00610">DataLayout.cpp:610</a></div></div>
<div class="ttc" id="classllvm_1_1BinaryOperator_html_a88505baf41407782678a5df1702d2d31"><div class="ttname"><a href="classllvm_1_1BinaryOperator.html#a88505baf41407782678a5df1702d2d31">llvm::BinaryOperator::getOpcode</a></div><div class="ttdeci">BinaryOps getOpcode() const </div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00326">InstrTypes.h:326</a></div></div>
<div class="ttc" id="classllvm_1_1IntegerType_html_a14f7b4f1aed38192fb6b7772eb506bdb"><div class="ttname"><a href="classllvm_1_1IntegerType.html#a14f7b4f1aed38192fb6b7772eb506bdb">llvm::IntegerType::get</a></div><div class="ttdeci">static IntegerType * get(LLVMContext &amp;C, unsigned NumBits)</div><div class="ttdoc">Get or create an IntegerType instance. </div><div class="ttdef"><b>Definition:</b> <a href="Type_8cpp_source.html#l00305">Type.cpp:305</a></div></div>
<div class="ttc" id="classllvm_1_1ConstantExpr_html_aba93ec4079f8d709a1d5b4745310782e"><div class="ttname"><a href="classllvm_1_1ConstantExpr.html#aba93ec4079f8d709a1d5b4745310782e">llvm::ConstantExpr::getBitCast</a></div><div class="ttdeci">static Constant * getBitCast(Constant *C, Type *Ty)</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l01672">Constants.cpp:1672</a></div></div>
<div class="ttc" id="InstCombineCasts_8cpp_html_a534902f6fff593cf4b50232cc58c580a"><div class="ttname"><a href="InstCombineCasts_8cpp.html#a534902f6fff593cf4b50232cc58c580a">OptimizeIntegerToVectorInsertions</a></div><div class="ttdeci">static Value * OptimizeIntegerToVectorInsertions(BitCastInst &amp;CI, InstCombiner &amp;IC)</div><div class="ttdef"><b>Definition:</b> <a href="InstCombineCasts_8cpp_source.html#l01639">InstCombineCasts.cpp:1639</a></div></div>
<div class="ttc" id="namespacellvm_1_1TargetOpcode_html_a348d4259b5fa6a8ecfe94e7ae512e1a8ae41f9ca68ba5e8b9613cea03652ebd72"><div class="ttname"><a href="namespacellvm_1_1TargetOpcode.html#a348d4259b5fa6a8ecfe94e7ae512e1a8ae41f9ca68ba5e8b9613cea03652ebd72">llvm::TargetOpcode::PHI</a></div><div class="ttdef"><b>Definition:</b> <a href="TargetOpcodes_8h_source.html#l00026">TargetOpcodes.h:26</a></div></div>
<div class="ttc" id="classllvm_1_1ConstantInt_html"><div class="ttname"><a href="classllvm_1_1ConstantInt.html">llvm::ConstantInt</a></div><div class="ttdoc">Class for constant integers. </div><div class="ttdef"><b>Definition:</b> <a href="Constants_8h_source.html#l00051">Constants.h:51</a></div></div>
<div class="ttc" id="structllvm_1_1fltSemantics_html"><div class="ttname"><a href="structllvm_1_1fltSemantics.html">llvm::fltSemantics</a></div><div class="ttdef"><b>Definition:</b> <a href="APFloat_8cpp_source.html#l00044">APFloat.cpp:44</a></div></div>
<div class="ttc" id="classllvm_1_1PHINode_html_aba6a4cc4ed6d6fef3664b8d65ef04820"><div class="ttname"><a href="classllvm_1_1PHINode.html#aba6a4cc4ed6d6fef3664b8d65ef04820">llvm::PHINode::getIncomingValue</a></div><div class="ttdeci">Value * getIncomingValue(unsigned i) const </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02059">Instructions.h:2059</a></div></div>
<div class="ttc" id="classllvm_1_1Type_html_ad8f27f0b94a56abcd296b8461737a3af"><div class="ttname"><a href="classllvm_1_1Type.html#ad8f27f0b94a56abcd296b8461737a3af">llvm::Type::getVectorNumElements</a></div><div class="ttdeci">unsigned getVectorNumElements() const </div><div class="ttdef"><b>Definition:</b> <a href="Type_8cpp_source.html#l00214">Type.cpp:214</a></div></div>
<div class="ttc" id="Target_2README_8txt_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">i</div><div class="ttdef"><b>Definition:</b> <a href="Target_2README_8txt_source.html#l00029">Target/README.txt:29</a></div></div>
<div class="ttc" id="classllvm_1_1IRBuilder_html_a87b363b9dad9f5040ea7e29ea9e60ff5"><div class="ttname"><a href="classllvm_1_1IRBuilder.html#a87b363b9dad9f5040ea7e29ea9e60ff5">llvm::IRBuilder::CreateBitCast</a></div><div class="ttdeci">Value * CreateBitCast(Value *V, Type *DestTy, const Twine &amp;Name=&quot;&quot;)</div><div class="ttdef"><b>Definition:</b> <a href="IRBuilder_8h_source.html#l01132">IRBuilder.h:1132</a></div></div>
<div class="ttc" id="classllvm_1_1SmallVector_html"><div class="ttname"><a href="classllvm_1_1SmallVector.html">llvm::SmallVector</a></div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00880">SmallVector.h:880</a></div></div>
<div class="ttc" id="classllvm_1_1Value_html_a0cf3748dba54f931bb1241ae4adc76bc"><div class="ttname"><a href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">llvm::Value::getType</a></div><div class="ttdeci">Type * getType() const </div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00111">Value.h:111</a></div></div>
<div class="ttc" id="classllvm_1_1BinaryOperator_html"><div class="ttname"><a href="classllvm_1_1BinaryOperator.html">llvm::BinaryOperator</a></div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00138">InstrTypes.h:138</a></div></div>
<div class="ttc" id="classllvm_1_1InstCombiner_html_a5ea211ef2e2bd3fb26510e2e76ada538"><div class="ttname"><a href="classllvm_1_1InstCombiner.html#a5ea211ef2e2bd3fb26510e2e76ada538">llvm::InstCombiner::visitSExt</a></div><div class="ttdeci">Instruction * visitSExt(SExtInst &amp;CI)</div><div class="ttdef"><b>Definition:</b> <a href="InstCombineCasts_8cpp_source.html#l01059">InstCombineCasts.cpp:1059</a></div></div>
<div class="ttc" id="classllvm_1_1CmpInst_html_a283f9a5d4d843d20c40bb4d3e364bb05a15ae464950ac676919c2f0c7aafc706c"><div class="ttname"><a href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05a15ae464950ac676919c2f0c7aafc706c">llvm::CmpInst::ICMP_SLT</a></div><div class="ttdoc">signed less than </div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00680">InstrTypes.h:680</a></div></div>
<div class="ttc" id="classllvm_1_1FPToUIInst_html"><div class="ttname"><a href="classllvm_1_1FPToUIInst.html">llvm::FPToUIInst</a></div><div class="ttdoc">This class represents a cast from floating point to unsigned integer. </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l03427">Instructions.h:3427</a></div></div>
<div class="ttc" id="classllvm_1_1InstCombiner_html_acab69d70075956abdfb5ccbdbdbb9e15"><div class="ttname"><a href="classllvm_1_1InstCombiner.html#acab69d70075956abdfb5ccbdbdbb9e15">llvm::InstCombiner::visitZExt</a></div><div class="ttdeci">Instruction * visitZExt(ZExtInst &amp;CI)</div><div class="ttdef"><b>Definition:</b> <a href="InstCombineCasts_8cpp_source.html#l00757">InstCombineCasts.cpp:757</a></div></div>
<div class="ttc" id="classllvm_1_1IRBuilderBase_html_ac0e8c554bf1c1e117a74d51df89c137d"><div class="ttname"><a href="classllvm_1_1IRBuilderBase.html#ac0e8c554bf1c1e117a74d51df89c137d">llvm::IRBuilderBase::getInt32</a></div><div class="ttdeci">ConstantInt * getInt32(uint32_t C)</div><div class="ttdoc">Get a constant 32-bit value. </div><div class="ttdef"><b>Definition:</b> <a href="IRBuilder_8h_source.html#l00276">IRBuilder.h:276</a></div></div>
<div class="ttc" id="classllvm_1_1CastInst_html_a8b805c54dc1ead67b711a4b1cb72f492"><div class="ttname"><a href="classllvm_1_1CastInst.html#a8b805c54dc1ead67b711a4b1cb72f492">llvm::CastInst::isEliminableCastPair</a></div><div class="ttdeci">static unsigned isEliminableCastPair(Instruction::CastOps firstOpcode, Instruction::CastOps secondOpcode, Type *SrcTy, Type *MidTy, Type *DstTy, Type *SrcIntPtrTy, Type *MidIntPtrTy, Type *DstIntPtrTy)</div><div class="ttdoc">Determine if a cast pair is eliminable. </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8cpp_source.html#l02125">Instructions.cpp:2125</a></div></div>
<div class="ttc" id="classllvm_1_1ConstantInt_html_a9105541412dab869e18b3cceebfff07d"><div class="ttname"><a href="classllvm_1_1ConstantInt.html#a9105541412dab869e18b3cceebfff07d">llvm::ConstantInt::get</a></div><div class="ttdeci">static Constant * get(Type *Ty, uint64_t V, bool isSigned=false)</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l00492">Constants.cpp:492</a></div></div>
<div class="ttc" id="classllvm_1_1ConstantExpr_html_aca5cab6b8d2be24d0c857cc4a831feec"><div class="ttname"><a href="classllvm_1_1ConstantExpr.html#aca5cab6b8d2be24d0c857cc4a831feec">llvm::ConstantExpr::getTrunc</a></div><div class="ttdeci">static Constant * getTrunc(Constant *C, Type *Ty)</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l01538">Constants.cpp:1538</a></div></div>
<div class="ttc" id="classllvm_1_1ConstantFP_html_a5eb8f7a5d3cfdd127ad9db2e425e14eb"><div class="ttname"><a href="classllvm_1_1ConstantFP.html#a5eb8f7a5d3cfdd127ad9db2e425e14eb">llvm::ConstantFP::get</a></div><div class="ttdeci">static Constant * get(Type *Ty, double V)</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l00557">Constants.cpp:557</a></div></div>
<div class="ttc" id="classllvm_1_1IntToPtrInst_html_a45c465c99d6bdfdeb42b07d2b06a6444"><div class="ttname"><a href="classllvm_1_1IntToPtrInst.html#a45c465c99d6bdfdeb42b07d2b06a6444">llvm::IntToPtrInst::getAddressSpace</a></div><div class="ttdeci">unsigned getAddressSpace() const </div><div class="ttdoc">Returns the address space of this instruction&amp;#39;s pointer type. </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l03521">Instructions.h:3521</a></div></div>
<div class="ttc" id="classllvm_1_1User_html_a5fa9b8e1842b354f64c1ba6be0a4a17f"><div class="ttname"><a href="classllvm_1_1User.html#a5fa9b8e1842b354f64c1ba6be0a4a17f">llvm::User::setOperand</a></div><div class="ttdeci">void setOperand(unsigned i, Value *Val)</div><div class="ttdef"><b>Definition:</b> <a href="User_8h_source.html#l00092">User.h:92</a></div></div>
<div class="ttc" id="namespacellvm_html_a7c46c742c31be54870e2038048e6b391"><div class="ttname"><a href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">llvm::dbgs</a></div><div class="ttdeci">raw_ostream &amp; dbgs()</div><div class="ttdoc">dbgs - Return a circular-buffered debug stream. </div><div class="ttdef"><b>Definition:</b> <a href="Debug_8cpp_source.html#l00101">Debug.cpp:101</a></div></div>
<div class="ttc" id="classllvm_1_1Function_html_a72873ed64b7be01507a2248b8e756ec8"><div class="ttname"><a href="classllvm_1_1Function.html#a72873ed64b7be01507a2248b8e756ec8">llvm::Function::getAttributes</a></div><div class="ttdeci">AttributeSet getAttributes() const </div><div class="ttdoc">Return the attribute list for this Function. </div><div class="ttdef"><b>Definition:</b> <a href="Function_8h_source.html#l00170">Function.h:170</a></div></div>
<div class="ttc" id="classllvm_1_1VectorType_html"><div class="ttname"><a href="classllvm_1_1VectorType.html">llvm::VectorType</a></div><div class="ttdef"><b>Definition:</b> <a href="DerivedTypes_8h_source.html#l00358">DerivedTypes.h:358</a></div></div>
<div class="ttc" id="classllvm_1_1APInt_html"><div class="ttname"><a href="classllvm_1_1APInt.html">llvm::APInt</a></div><div class="ttdoc">Class for arbitrary precision integers. </div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l00075">APInt.h:75</a></div></div>
<div class="ttc" id="classllvm_1_1Type_html_a6e328feb83afa5cf1c966d6704e43fc1"><div class="ttname"><a href="classllvm_1_1Type.html#a6e328feb83afa5cf1c966d6704e43fc1">llvm::Type::isIntegerTy</a></div><div class="ttdeci">bool isIntegerTy() const </div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00196">Type.h:196</a></div></div>
<div class="ttc" id="classllvm_1_1Instruction_html_a5ac211f24970dea81fa9a7118a8ce36b"><div class="ttname"><a href="classllvm_1_1Instruction.html#a5ac211f24970dea81fa9a7118a8ce36b">llvm::Instruction::use_back</a></div><div class="ttdeci">Instruction * use_back()</div><div class="ttdef"><b>Definition:</b> <a href="Instruction_8h_source.html#l00049">Instruction.h:49</a></div></div>
<div class="ttc" id="PatternMatch_8h_html"><div class="ttname"><a href="PatternMatch_8h.html">PatternMatch.h</a></div></div>
<div class="ttc" id="classllvm_1_1CastInst_html_ae96aa53c0b7c0eb9ec680db6a43abaa7"><div class="ttname"><a href="classllvm_1_1CastInst.html#ae96aa53c0b7c0eb9ec680db6a43abaa7">llvm::CastInst::CreateIntegerCast</a></div><div class="ttdeci">static CastInst * CreateIntegerCast(Value *S, Type *Ty, bool isSigned, const Twine &amp;Name=&quot;&quot;, Instruction *InsertBefore=0)</div><div class="ttdoc">Create a ZExt, BitCast, or Trunc for int -&gt; int casts. </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8cpp_source.html#l02485">Instructions.cpp:2485</a></div></div>
<div class="ttc" id="InstCombineCasts_8cpp_html_ac50270ed32cec6a5d8ec24e524846b13"><div class="ttname"><a href="InstCombineCasts_8cpp.html#ac50270ed32cec6a5d8ec24e524846b13">OptimizeIntToFloatBitCast</a></div><div class="ttdeci">static Instruction * OptimizeIntToFloatBitCast(BitCastInst &amp;CI, InstCombiner &amp;IC)</div><div class="ttdef"><b>Definition:</b> <a href="InstCombineCasts_8cpp_source.html#l01669">InstCombineCasts.cpp:1669</a></div></div>
<div class="ttc" id="ConstantFolding_8h_html"><div class="ttname"><a href="ConstantFolding_8h.html">ConstantFolding.h</a></div></div>
<div class="ttc" id="namespacellvm_1_1APIntOps_html_a684cfe02c582e8d75cd6d457e63e6c25"><div class="ttname"><a href="namespacellvm_1_1APIntOps.html#a684cfe02c582e8d75cd6d457e63e6c25">llvm::APIntOps::And</a></div><div class="ttdeci">APInt And(const APInt &amp;LHS, const APInt &amp;RHS)</div><div class="ttdoc">Bitwise AND function for APInt. </div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l01840">APInt.h:1840</a></div></div>
<div class="ttc" id="classllvm_1_1InstCombiner_html_a7d92fd2831240f33fba5b54ec91df58d"><div class="ttname"><a href="classllvm_1_1InstCombiner.html#a7d92fd2831240f33fba5b54ec91df58d">llvm::InstCombiner::visitTrunc</a></div><div class="ttdeci">Instruction * visitTrunc(TruncInst &amp;CI)</div><div class="ttdef"><b>Definition:</b> <a href="InstCombineCasts_8cpp_source.html#l00436">InstCombineCasts.cpp:436</a></div></div>
<div class="ttc" id="classllvm_1_1APFloat_html_a43f6e79227388f373628e8ddd27df965"><div class="ttname"><a href="classllvm_1_1APFloat.html#a43f6e79227388f373628e8ddd27df965">llvm::APFloat::IEEEsingle</a></div><div class="ttdeci">static const fltSemantics IEEEsingle</div><div class="ttdef"><b>Definition:</b> <a href="APFloat_8h_source.html#l00132">APFloat.h:132</a></div></div>
<div class="ttc" id="classllvm_1_1Type_html_a30dd396c5b40cd86c1591872e574ccdf"><div class="ttname"><a href="classllvm_1_1Type.html#a30dd396c5b40cd86c1591872e574ccdf">llvm::Type::getInt32Ty</a></div><div class="ttdeci">static IntegerType * getInt32Ty(LLVMContext &amp;C)</div><div class="ttdef"><b>Definition:</b> <a href="Type_8cpp_source.html#l00241">Type.cpp:241</a></div></div>
<div class="ttc" id="classllvm_1_1ConstantExpr_html_a80e82791d4d7f4d1d23d68ca0a2b1f64"><div class="ttname"><a href="classllvm_1_1ConstantExpr.html#a80e82791d4d7f4d1d23d68ca0a2b1f64">llvm::ConstantExpr::getZExt</a></div><div class="ttdeci">static Constant * getZExt(Constant *C, Type *Ty)</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l01566">Constants.cpp:1566</a></div></div>
<div class="ttc" id="classllvm_1_1InstCombiner_html_a1a9b04d6f6ffde1d4e58e48848d4178a"><div class="ttname"><a href="classllvm_1_1InstCombiner.html#a1a9b04d6f6ffde1d4e58e48848d4178a">llvm::InstCombiner::visitSIToFP</a></div><div class="ttdeci">Instruction * visitSIToFP(CastInst &amp;CI)</div><div class="ttdef"><b>Definition:</b> <a href="InstCombineCasts_8cpp_source.html#l01351">InstCombineCasts.cpp:1351</a></div></div>
<div class="ttc" id="namespacellvm_1_1Intrinsic_html_a73349916f7e54a6b988a3646c7a02e90ae5cfc8e1a94b46b64a26f1a6cb4e6ba0"><div class="ttname"><a href="namespacellvm_1_1Intrinsic.html#a73349916f7e54a6b988a3646c7a02e90ae5cfc8e1a94b46b64a26f1a6cb4e6ba0">llvm::Intrinsic::fabs</a></div><div class="ttdef"><b>Definition:</b> <a href="Intrinsics_8h_source.html#l00389">Intrinsics.h:389</a></div></div>
<div class="ttc" id="classllvm_1_1BinaryOperator_html_ab87cae7de3df7420fff131c5305d5b6f"><div class="ttname"><a href="classllvm_1_1BinaryOperator.html#ab87cae7de3df7420fff131c5305d5b6f">llvm::BinaryOperator::isFNeg</a></div><div class="ttdeci">static bool isFNeg(const Value *V, bool IgnoreZeroSign=false)</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8cpp_source.html#l01934">Instructions.cpp:1934</a></div></div>
<div class="ttc" id="MD5_8cpp_html_ac0eafdc9ee161b71e7af98af736952fd"><div class="ttname"><a href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a></div><div class="ttdeci">#define I(x, y, z)</div><div class="ttdef"><b>Definition:</b> <a href="MD5_8cpp_source.html#l00054">MD5.cpp:54</a></div></div>
<div class="ttc" id="classllvm_1_1Value_html_a085b82f074c28030fb8e194377ed2d0c"><div class="ttname"><a href="classllvm_1_1Value.html#a085b82f074c28030fb8e194377ed2d0c">llvm::Value::hasOneUse</a></div><div class="ttdeci">bool hasOneUse() const </div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00161">Value.h:161</a></div></div>
<div class="ttc" id="classllvm_1_1BinaryOperator_html_a4a4628e91a9c6a339fa61105614fac76"><div class="ttname"><a href="classllvm_1_1BinaryOperator.html#a4a4628e91a9c6a339fa61105614fac76">llvm::BinaryOperator::Create</a></div><div class="ttdeci">static BinaryOperator * Create(BinaryOps Op, Value *S1, Value *S2, const Twine &amp;Name=Twine(), Instruction *InsertBefore=0)</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8cpp_source.html#l01834">Instructions.cpp:1834</a></div></div>
<div class="ttc" id="namespacellvm_1_1A64CC_html_af5804bc0518be9568f73db566e4d6f46a2a6c4724226f9ccea96d35fd4c131af8"><div class="ttname"><a href="namespacellvm_1_1A64CC.html#af5804bc0518be9568f73db566e4d6f46a2a6c4724226f9ccea96d35fd4c131af8">llvm::A64CC::NV</a></div><div class="ttdef"><b>Definition:</b> <a href="AArch64BaseInfo_8h_source.html#l00046">AArch64BaseInfo.h:46</a></div></div>
<div class="ttc" id="classllvm_1_1Type_html_a5a7cfa245af120b44ac8a86143bb9e57"><div class="ttname"><a href="classllvm_1_1Type.html#a5a7cfa245af120b44ac8a86143bb9e57">llvm::Type::getPrimitiveSizeInBits</a></div><div class="ttdeci">unsigned getPrimitiveSizeInBits() const </div><div class="ttdef"><b>Definition:</b> <a href="Type_8cpp_source.html#l00117">Type.cpp:117</a></div></div>
<div class="ttc" id="namespacellvm_html_a26072ee56129fc3220771cda9f053ecb"><div class="ttname"><a href="namespacellvm.html#a26072ee56129fc3220771cda9f053ecb">llvm::ComputeNumSignBits</a></div><div class="ttdeci">unsigned ComputeNumSignBits(Value *Op, const DataLayout *TD=0, unsigned Depth=0)</div><div class="ttdef"><b>Definition:</b> <a href="ValueTracking_8cpp_source.html#l01133">ValueTracking.cpp:1133</a></div></div>
<div class="ttc" id="classllvm_1_1ConstantFP_html_a0f839f7633a4709c1d89e128f49b3d43"><div class="ttname"><a href="classllvm_1_1ConstantFP.html#a0f839f7633a4709c1d89e128f49b3d43">llvm::ConstantFP::getValueAPF</a></div><div class="ttdeci">const APFloat &amp; getValueAPF() const </div><div class="ttdef"><b>Definition:</b> <a href="Constants_8h_source.html#l00263">Constants.h:263</a></div></div>
<div class="ttc" id="classllvm_1_1CmpInst_html_a283f9a5d4d843d20c40bb4d3e364bb05aa719225e2de4059f93fd3209e1f48218"><div class="ttname"><a href="classllvm_1_1CmpInst.html#a283f9a5d4d843d20c40bb4d3e364bb05aa719225e2de4059f93fd3209e1f48218">llvm::CmpInst::ICMP_EQ</a></div><div class="ttdoc">equal </div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00672">InstrTypes.h:672</a></div></div>
<div class="ttc" id="classllvm_1_1CallInst_html_a179ef4c643fb35a8dc364e4ae63950f9"><div class="ttname"><a href="classllvm_1_1CallInst.html#a179ef4c643fb35a8dc364e4ae63950f9">llvm::CallInst::setAttributes</a></div><div class="ttdeci">void setAttributes(const AttributeSet &amp;Attrs)</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l01264">Instructions.h:1264</a></div></div>
<div class="ttc" id="classllvm_1_1FPTruncInst_html"><div class="ttname"><a href="classllvm_1_1FPTruncInst.html">llvm::FPTruncInst</a></div><div class="ttdoc">This class represents a truncation of floating point types. </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l03283">Instructions.h:3283</a></div></div>
<div class="ttc" id="classllvm_1_1GlobalValue_html_a9e1fc23a17e97d2d1732e753ae9251ac"><div class="ttname"><a href="classllvm_1_1GlobalValue.html#a9e1fc23a17e97d2d1732e753ae9251ac">llvm::GlobalValue::getParent</a></div><div class="ttdeci">Module * getParent()</div><div class="ttdef"><b>Definition:</b> <a href="GlobalValue_8h_source.html#l00286">GlobalValue.h:286</a></div></div>
<div class="ttc" id="classllvm_1_1Value_html"><div class="ttname"><a href="classllvm_1_1Value.html">llvm::Value</a></div><div class="ttdoc">LLVM Value Representation. </div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00066">Value.h:66</a></div></div>
<div class="ttc" id="classllvm_1_1Instruction_html_a021bb7c9aad6003fe8089f6327356c6c"><div class="ttname"><a href="classllvm_1_1Instruction.html#a021bb7c9aad6003fe8089f6327356c6c">llvm::Instruction::getOpcode</a></div><div class="ttdeci">unsigned getOpcode() const </div><div class="ttdoc">getOpcode() returns a member of one of the enums like Instruction::Add. </div><div class="ttdef"><b>Definition:</b> <a href="Instruction_8h_source.html#l00083">Instruction.h:83</a></div></div>
<div class="ttc" id="Target_2X86_2README_8txt_html_ac88fe1d3a61b056a4f64fbbb156a62ff"><div class="ttname"><a href="Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a></div><div class="ttdeci">We currently emits eax Perhaps this is what we really should generate is Is imull three or four cycles eax eax The current instruction priority is based on pattern complexity The former is more complex because it folds a load so the latter will not be emitted Perhaps we should use AddedComplexity to give LEA32r a higher priority We should always try to match LEA first since the LEA matching code does some estimate to determine whether the match is profitable if we care more about code then imull is better It s two bytes shorter than movl leal On a Pentium M</div><div class="ttdef"><b>Definition:</b> <a href="Target_2X86_2README_8txt_source.html#l00297">Target/X86/README.txt:297</a></div></div>
<div class="ttc" id="classllvm_1_1VectorType_html_ab43657ed1abe2e2ed3a6a394f233ebd0"><div class="ttname"><a href="classllvm_1_1VectorType.html#ab43657ed1abe2e2ed3a6a394f233ebd0">llvm::VectorType::get</a></div><div class="ttdeci">static VectorType * get(Type *ElementType, unsigned NumElements)</div><div class="ttdef"><b>Definition:</b> <a href="Type_8cpp_source.html#l00706">Type.cpp:706</a></div></div>
<div class="ttc" id="classllvm_1_1AllocaInst_html_a642f52c0f081ad0de10258c1d8d67b23"><div class="ttname"><a href="classllvm_1_1AllocaInst.html#a642f52c0f081ad0de10258c1d8d67b23">llvm::AllocaInst::getArraySize</a></div><div class="ttdeci">const Value * getArraySize() const </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00086">Instructions.h:86</a></div></div>
<div class="ttc" id="classllvm_1_1InstCombiner_html_a659f4270ad408664d68e699bd1e603e3"><div class="ttname"><a href="classllvm_1_1InstCombiner.html#a659f4270ad408664d68e699bd1e603e3">llvm::InstCombiner::commonPointerCastTransforms</a></div><div class="ttdeci">Instruction * commonPointerCastTransforms(CastInst &amp;CI)</div><div class="ttdoc">Implement the transforms for cast of pointer (bitcast/ptrtoint) </div><div class="ttdef"><b>Definition:</b> <a href="InstCombineCasts_8cpp_source.html#l01380">InstCombineCasts.cpp:1380</a></div></div>
<div class="ttc" id="classllvm_1_1Type_html_a9dc5111b1a9b1d5c4652d50f74fe850b"><div class="ttname"><a href="classllvm_1_1Type.html#a9dc5111b1a9b1d5c4652d50f74fe850b">llvm::Type::isSized</a></div><div class="ttdeci">bool isSized() const </div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00278">Type.h:278</a></div></div>
<div class="ttc" id="Debug_8h_html_aef41e8aaf4c60819b30faf396cdf4978"><div class="ttname"><a href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a></div><div class="ttdeci">#define DEBUG(X)</div><div class="ttdef"><b>Definition:</b> <a href="Debug_8h_source.html#l00097">Debug.h:97</a></div></div>
<div class="ttc" id="classllvm_1_1APInt_html_af0336ea4c7f7f56354b2ca7c8859c1f9"><div class="ttname"><a href="classllvm_1_1APInt.html#af0336ea4c7f7f56354b2ca7c8859c1f9">llvm::APInt::countLeadingZeros</a></div><div class="ttdeci">unsigned countLeadingZeros() const </div><div class="ttdoc">The APInt version of the countLeadingZeros functions in MathExtras.h. </div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l01340">APInt.h:1340</a></div></div>
<div class="ttc" id="classllvm_1_1SelectInst_html_a29a16f32075ee4f23cd769701463952c"><div class="ttname"><a href="classllvm_1_1SelectInst.html#a29a16f32075ee4f23cd769701463952c">llvm::SelectInst::getFalseValue</a></div><div class="ttdeci">const Value * getFalseValue() const </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l01468">Instructions.h:1468</a></div></div>
<div class="ttc" id="classllvm_1_1BinaryOperator_html_aaf59c6e50e9bb32e189b24c864ac1dad"><div class="ttname"><a href="classllvm_1_1BinaryOperator.html#aaf59c6e50e9bb32e189b24c864ac1dad">llvm::BinaryOperator::CreateFNeg</a></div><div class="ttdeci">static BinaryOperator * CreateFNeg(Value *Op, const Twine &amp;Name=&quot;&quot;, Instruction *InsertBefore=0)</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8cpp_source.html#l01890">Instructions.cpp:1890</a></div></div>
<div class="ttc" id="classllvm_1_1GetElementPtrInst_html_a3e10b4db1ded36654416d3aed2bc56ba"><div class="ttname"><a href="classllvm_1_1GetElementPtrInst.html#a3e10b4db1ded36654416d3aed2bc56ba">llvm::GetElementPtrInst::CreateInBounds</a></div><div class="ttdeci">static GetElementPtrInst * CreateInBounds(Value *Ptr, ArrayRef&lt; Value * &gt; IdxList, const Twine &amp;NameStr=&quot;&quot;, Instruction *InsertBefore=0)</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00743">Instructions.h:743</a></div></div>
<div class="ttc" id="classllvm_1_1ConstantDataVector_html_ab8b693ee2fbb4c4173fa2725c110021b"><div class="ttname"><a href="classllvm_1_1ConstantDataVector.html#ab8b693ee2fbb4c4173fa2725c110021b">llvm::ConstantDataVector::get</a></div><div class="ttdeci">static Constant * get(LLVMContext &amp;Context, ArrayRef&lt; uint8_t &gt; Elts)</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l02385">Constants.cpp:2385</a></div></div>
<div class="ttc" id="classllvm_1_1InstCombiner_html_adaa3691a486fa468bbbacc7882b8e9dd"><div class="ttname"><a href="classllvm_1_1InstCombiner.html#adaa3691a486fa468bbbacc7882b8e9dd">llvm::InstCombiner::visitPtrToInt</a></div><div class="ttdeci">Instruction * visitPtrToInt(PtrToIntInst &amp;CI)</div><div class="ttdef"><b>Definition:</b> <a href="InstCombineCasts_8cpp_source.html#l01434">InstCombineCasts.cpp:1434</a></div></div>
<div class="ttc" id="classllvm_1_1DataLayout_html_a9b876cc57d1884621f481b26b0892633"><div class="ttname"><a href="classllvm_1_1DataLayout.html#a9b876cc57d1884621f481b26b0892633">llvm::DataLayout::isBigEndian</a></div><div class="ttdeci">bool isBigEndian() const </div><div class="ttdef"><b>Definition:</b> <a href="DataLayout_8h_source.html#l00196">DataLayout.h:196</a></div></div>
<div class="ttc" id="namespacellvm_html_a6569d00d31a5d74e563e2f39f82271ab"><div class="ttname"><a href="namespacellvm.html#a6569d00d31a5d74e563e2f39f82271ab">llvm::X</a></div><div class="ttdeci">static RegisterPass&lt; NVPTXAllocaHoisting &gt; X(&quot;alloca-hoisting&quot;,&quot;Hoisting alloca instructions in non-entry &quot;&quot;blocks to the entry block&quot;)</div></div>
<div class="ttc" id="classllvm_1_1Instruction_html_a9cd49851904f15060edb782ef4dd1b2d"><div class="ttname"><a href="classllvm_1_1Instruction.html#a9cd49851904f15060edb782ef4dd1b2d">llvm::Instruction::getParent</a></div><div class="ttdeci">const BasicBlock * getParent() const </div><div class="ttdef"><b>Definition:</b> <a href="Instruction_8h_source.html#l00052">Instruction.h:52</a></div></div>
<div class="ttc" id="classllvm_1_1OverflowingBinaryOperator_html_abe8af726db43885a1178cf75ed0725d9"><div class="ttname"><a href="classllvm_1_1OverflowingBinaryOperator.html#abe8af726db43885a1178cf75ed0725d9">llvm::OverflowingBinaryOperator::hasNoUnsignedWrap</a></div><div class="ttdeci">bool hasNoUnsignedWrap() const </div><div class="ttdef"><b>Definition:</b> <a href="Operator_8h_source.html#l00101">Operator.h:101</a></div></div>
<div class="ttc" id="classllvm_1_1IntrinsicInst_html"><div class="ttname"><a href="classllvm_1_1IntrinsicInst.html">llvm::IntrinsicInst</a></div><div class="ttdef"><b>Definition:</b> <a href="IntrinsicInst_8h_source.html#l00036">IntrinsicInst.h:36</a></div></div>
<div class="ttc" id="classllvm_1_1AllocaInst_html"><div class="ttname"><a href="classllvm_1_1AllocaInst.html">llvm::AllocaInst</a></div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00058">Instructions.h:58</a></div></div>
<div class="ttc" id="InstCombineCasts_8cpp_html_abe93395b9183a889129e0c8158337486"><div class="ttname"><a href="InstCombineCasts_8cpp.html#abe93395b9183a889129e0c8158337486">CollectInsertionElements</a></div><div class="ttdeci">static bool CollectInsertionElements(Value *V, unsigned Shift, SmallVectorImpl&lt; Value * &gt; &amp;Elements, Type *VecEltTy, InstCombiner &amp;IC)</div><div class="ttdef"><b>Definition:</b> <a href="InstCombineCasts_8cpp_source.html#l01531">InstCombineCasts.cpp:1531</a></div></div>
<div class="ttc" id="classllvm_1_1InstCombiner_html_aa27131edaba17609df527a66357c31ee"><div class="ttname"><a href="classllvm_1_1InstCombiner.html#aa27131edaba17609df527a66357c31ee">llvm::InstCombiner::visitFPTrunc</a></div><div class="ttdeci">Instruction * visitFPTrunc(FPTruncInst &amp;CI)</div><div class="ttdef"><b>Definition:</b> <a href="InstCombineCasts_8cpp_source.html#l01189">InstCombineCasts.cpp:1189</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<hr>
<p class="footer">
Generated on Sat Nov 10 2018 22:59:00 for <a href="http://llvm.org/">LLVM</a> by
<a href="http://www.doxygen.org"><img src="doxygen.png" alt="Doxygen"
align="middle" border="0"/>1.8.11</a><br>
Copyright &copy; 2003-2013 University of Illinois at Urbana-Champaign.
All Rights Reserved.</p>
<hr>
<!--#include virtual="/attrib.incl" -->
</body>
</html>
