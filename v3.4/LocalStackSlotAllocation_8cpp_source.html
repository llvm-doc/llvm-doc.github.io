<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head>
<meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1"/>
<meta name="keywords" content="LLVM,Low Level Virtual Machine,C++,doxygen,API,documentation"/>
<meta name="description" content="C++ source code API documentation for LLVM."/>
<title>LLVM: LocalStackSlotAllocation.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head><body>
<p class="title">LLVM API Documentation</p>
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('LocalStackSlotAllocation_8cpp_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">LocalStackSlotAllocation.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="LocalStackSlotAllocation_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//===- LocalStackSlotAllocation.cpp - Pre-allocate locals to stack slots --===//</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">//                     The LLVM Compiler Infrastructure</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// This file is distributed under the University of Illinois Open Source</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">// License. See LICENSE.TXT for details.</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">// This pass assigns local frame indices to stack slots relative to one another</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">// and allocates additional base registers to access them when the target</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">// estimates they are likely to be out of range of stack pointer and frame</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">// pointer relative addressing.</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;</div><div class="line"><a name="l00017"></a><span class="lineno"><a class="line" href="LocalStackSlotAllocation_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">   17</a></span>&#160;<span class="preprocessor">#define DEBUG_TYPE &quot;localstackalloc&quot;</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="CodeGen_2Passes_8h.html">llvm/CodeGen/Passes.h</a>&quot;</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="STLExtras_8h.html">llvm/ADT/STLExtras.h</a>&quot;</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="SmallSet_8h.html">llvm/ADT/SmallSet.h</a>&quot;</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Statistic_8h.html">llvm/ADT/Statistic.h</a>&quot;</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="MachineFrameInfo_8h.html">llvm/CodeGen/MachineFrameInfo.h</a>&quot;</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="MachineFunction_8h.html">llvm/CodeGen/MachineFunction.h</a>&quot;</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="MachineFunctionPass_8h.html">llvm/CodeGen/MachineFunctionPass.h</a>&quot;</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="MachineRegisterInfo_8h.html">llvm/CodeGen/MachineRegisterInfo.h</a>&quot;</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Constants_8h.html">llvm/IR/Constants.h</a>&quot;</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="DerivedTypes_8h.html">llvm/IR/DerivedTypes.h</a>&quot;</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Instructions_8h.html">llvm/IR/Instructions.h</a>&quot;</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Intrinsics_8h.html">llvm/IR/Intrinsics.h</a>&quot;</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="LLVMContext_8h.html">llvm/IR/LLVMContext.h</a>&quot;</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Module_8h.html">llvm/IR/Module.h</a>&quot;</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Pass_8h.html">llvm/Pass.h</a>&quot;</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Debug_8h.html">llvm/Support/Debug.h</a>&quot;</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ErrorHandling_8h.html">llvm/Support/ErrorHandling.h</a>&quot;</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="raw__ostream_8h.html">llvm/Support/raw_ostream.h</a>&quot;</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TargetFrameLowering_8h.html">llvm/Target/TargetFrameLowering.h</a>&quot;</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TargetRegisterInfo_8h.html">llvm/Target/TargetRegisterInfo.h</a>&quot;</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespacellvm.html">llvm</a>;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<a class="code" href="LocalStackSlotAllocation_8cpp.html#a90e3b74662af606d65b5b25ab1a01734">STATISTIC</a>(NumAllocations, <span class="stringliteral">&quot;Number of frame indices allocated into local block&quot;</span>);</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<a class="code" href="LocalStackSlotAllocation_8cpp.html#a90e3b74662af606d65b5b25ab1a01734">STATISTIC</a>(NumBaseRegisters, <span class="stringliteral">&quot;Number of virtual frame base registers allocated&quot;</span>);</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<a class="code" href="LocalStackSlotAllocation_8cpp.html#a90e3b74662af606d65b5b25ab1a01734">STATISTIC</a>(NumReplacements, <span class="stringliteral">&quot;Number of frame indices references replaced&quot;</span>);</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="keyword">namespace </span>{</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <span class="keyword">class </span>FrameRef {</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <a class="code" href="classllvm_1_1MachineBasicBlock.html#ac51be7ff80fe8d6ae5e8c0acb194908a">MachineBasicBlock::iterator</a> <a class="code" href="namespacellvm_1_1A64CC.html#af5804bc0518be9568f73db566e4d6f46a2db5e7546f960277ff98f96cd5624442">MI</a>; <span class="comment">// Instr referencing the frame</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    int64_t LocalOffset;            <span class="comment">// Local offset of the frame idx referenced</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <span class="keywordtype">int</span> FrameIdx;                   <span class="comment">// The frame index</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  <span class="keyword">public</span>:</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    FrameRef(<a class="code" href="classllvm_1_1MachineBasicBlock.html#ac51be7ff80fe8d6ae5e8c0acb194908a">MachineBasicBlock::iterator</a> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, int64_t Offset, <span class="keywordtype">int</span> Idx) :</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;      MI(I), LocalOffset(Offset), FrameIdx(Idx) {}</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="namespacellvm.html#a7c469a194119a14e5a018ebb9b847cf0">operator&lt;</a>(<span class="keyword">const</span> FrameRef &amp;RHS)<span class="keyword"> const </span>{</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;      <span class="keywordflow">return</span> LocalOffset &lt; RHS.LocalOffset;</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    }</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <a class="code" href="classllvm_1_1MachineBasicBlock.html#ac51be7ff80fe8d6ae5e8c0acb194908a">MachineBasicBlock::iterator</a> getMachineInstr()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1A64CC.html#af5804bc0518be9568f73db566e4d6f46a2db5e7546f960277ff98f96cd5624442">MI</a>; }</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    int64_t getLocalOffset()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> LocalOffset; }</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <span class="keywordtype">int</span> getFrameIndex()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> FrameIdx; }</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  };</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  <span class="keyword">class </span>LocalStackSlotPass: <span class="keyword">public</span> <a class="code" href="classllvm_1_1MachineFunctionPass.html">MachineFunctionPass</a> {</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;int64_t,16&gt;</a> LocalOffsets;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="PrologEpilogInserter_8cpp.html#a1ab21d9615f20889f7e34e7eae8a2ea1">AdjustStackOffset</a>(<a class="code" href="classllvm_1_1MachineFrameInfo.html">MachineFrameInfo</a> *MFI, <span class="keywordtype">int</span> FrameIdx, int64_t &amp;Offset,</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;                           <span class="keywordtype">bool</span> StackGrowsDown, <span class="keywordtype">unsigned</span> &amp;MaxAlign);</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="keywordtype">void</span> calculateFrameObjectOffsets(<a class="code" href="classllvm_1_1MachineFunction.html">MachineFunction</a> &amp;Fn);</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <span class="keywordtype">bool</span> insertFrameReferenceRegisters(<a class="code" href="classllvm_1_1MachineFunction.html">MachineFunction</a> &amp;Fn);</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  <span class="keyword">public</span>:</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="keyword">static</span> <span class="keywordtype">char</span> <a class="code" href="namespacellvm_1_1CallingConv.html#a4f861731fc6dbfdccc05af5968d98974">ID</a>; <span class="comment">// Pass identification, replacement for typeid</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <span class="keyword">explicit</span> LocalStackSlotPass() : <a class="code" href="classllvm_1_1MachineFunctionPass.html">MachineFunctionPass</a>(ID) { }</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="keywordtype">bool</span> runOnMachineFunction(<a class="code" href="classllvm_1_1MachineFunction.html">MachineFunction</a> &amp;MF);</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">void</span> getAnalysisUsage(<a class="code" href="classllvm_1_1AnalysisUsage.html">AnalysisUsage</a> &amp;AU)<span class="keyword"> const </span>{</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;      AU.<a class="code" href="classllvm_1_1AnalysisUsage.html#af11a6ebf7ab3c388234cb6d5378439a3">setPreservesCFG</a>();</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;      <a class="code" href="classllvm_1_1MachineFunctionPass.html#aa1eece37d175f86a6f4808c0c167f13b">MachineFunctionPass::getAnalysisUsage</a>(AU);</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    }</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  <span class="keyword">private</span>:</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  };</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;} <span class="comment">// end anonymous namespace</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="keywordtype">char</span> <a class="code" href="namespacellvm_1_1CallingConv.html#a4f861731fc6dbfdccc05af5968d98974">LocalStackSlotPass::ID</a> = 0;</div><div class="line"><a name="l00083"></a><span class="lineno"><a class="line" href="namespacellvm.html#adfe6b8951666ab7bb35ee3ca5a078937">   83</a></span>&#160;<span class="keywordtype">char</span> &amp;<a class="code" href="namespacellvm.html#adfe6b8951666ab7bb35ee3ca5a078937">llvm::LocalStackSlotAllocationID</a> = <a class="code" href="namespacellvm_1_1CallingConv.html#a4f861731fc6dbfdccc05af5968d98974">LocalStackSlotPass::ID</a>;</div><div class="line"><a name="l00084"></a><span class="lineno"><a class="line" href="LocalStackSlotAllocation_8cpp.html#afb4b62415b1d83637f8bfa8343e4a384">   84</a></span>&#160;<a class="code" href="LocalStackSlotAllocation_8cpp.html#afb4b62415b1d83637f8bfa8343e4a384">INITIALIZE_PASS</a>(LocalStackSlotPass, <span class="stringliteral">&quot;localstackalloc&quot;</span>,</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;                <span class="stringliteral">&quot;Local Stack Slot Allocation&quot;</span>, <span class="keyword">false</span>, <span class="keyword">false</span>)</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;bool LocalStackSlotPass::runOnMachineFunction(<a class="code" href="classllvm_1_1MachineFunction.html">MachineFunction</a> &amp;MF) {</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  <a class="code" href="classllvm_1_1MachineFrameInfo.html">MachineFrameInfo</a> *MFI = MF.getFrameInfo();</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetRegisterInfo.html">TargetRegisterInfo</a> *TRI = MF.getTarget().getRegisterInfo();</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <span class="keywordtype">unsigned</span> LocalObjectCount = MFI-&gt;<a class="code" href="classllvm_1_1MachineFrameInfo.html#ab127d56f832dc4400f58707a37ed5c6b">getObjectIndexEnd</a>();</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  <span class="comment">// If the target doesn&#39;t want/need this pass, or if there are no locals</span></div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  <span class="comment">// to consider, early exit.</span></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  <span class="keywordflow">if</span> (!TRI-&gt;<a class="code" href="classllvm_1_1TargetRegisterInfo.html#ab1b80d824b4e3c38846e4d7b2b463867">requiresVirtualBaseRegisters</a>(MF) || LocalObjectCount == 0)</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <span class="comment">// Make sure we have enough space to store the local offsets.</span></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  LocalOffsets.resize(MFI-&gt;<a class="code" href="classllvm_1_1MachineFrameInfo.html#ab127d56f832dc4400f58707a37ed5c6b">getObjectIndexEnd</a>());</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  <span class="comment">// Lay out the local blob.</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  calculateFrameObjectOffsets(MF);</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  <span class="comment">// Insert virtual base registers to resolve frame index references.</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  <span class="keywordtype">bool</span> UsedBaseRegs = insertFrameReferenceRegisters(MF);</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  <span class="comment">// Tell MFI whether any base registers were allocated. PEI will only</span></div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  <span class="comment">// want to use the local block allocations from this pass if there were any.</span></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  <span class="comment">// Otherwise, PEI can do a bit better job of getting the alignment right</span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  <span class="comment">// without a hole at the start since it knows the alignment of the stack</span></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  <span class="comment">// at the start of local allocation, and this pass doesn&#39;t.</span></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  MFI-&gt;<a class="code" href="classllvm_1_1MachineFrameInfo.html#a37cfdca2465d899059663518672882b0">setUseLocalStackAllocationBlock</a>(UsedBaseRegs);</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;}</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment">/// AdjustStackOffset - Helper function used to adjust the stack frame offset.</span></div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="PrologEpilogInserter_8cpp.html#a1ab21d9615f20889f7e34e7eae8a2ea1">LocalStackSlotPass::AdjustStackOffset</a>(<a class="code" href="classllvm_1_1MachineFrameInfo.html">MachineFrameInfo</a> *MFI,</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                                           <span class="keywordtype">int</span> FrameIdx, int64_t &amp;Offset,</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                                           <span class="keywordtype">bool</span> StackGrowsDown,</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;                                           <span class="keywordtype">unsigned</span> &amp;MaxAlign) {</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  <span class="comment">// If the stack grows down, add the object size to find the lowest address.</span></div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  <span class="keywordflow">if</span> (StackGrowsDown)</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    Offset += MFI-&gt;<a class="code" href="classllvm_1_1MachineFrameInfo.html#a43386af65581b8de506f3b57ba6c05b0">getObjectSize</a>(FrameIdx);</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  <span class="keywordtype">unsigned</span> <a class="code" href="ARMSubtarget_8cpp.html#a4bd80d4e433d9f72af26b364036900dc">Align</a> = MFI-&gt;<a class="code" href="classllvm_1_1MachineFrameInfo.html#ae146d6827dae2ff77fc65b7fd319dbb8">getObjectAlignment</a>(FrameIdx);</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  <span class="comment">// If the alignment of this object is greater than that of the stack, then</span></div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  <span class="comment">// increase the stack alignment to match.</span></div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  MaxAlign = std::max(MaxAlign, Align);</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  <span class="comment">// Adjust to alignment boundary.</span></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  Offset = (Offset + Align - 1) / Align * Align;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  int64_t LocalOffset = StackGrowsDown ? -Offset : Offset;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Allocate FI(&quot;</span> &lt;&lt; FrameIdx &lt;&lt; <span class="stringliteral">&quot;) to local offset &quot;</span></div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        &lt;&lt; LocalOffset &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  <span class="comment">// Keep the offset available for base register allocation</span></div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  LocalOffsets[FrameIdx] = LocalOffset;</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  <span class="comment">// And tell MFI about it for PEI to use later</span></div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  MFI-&gt;<a class="code" href="classllvm_1_1MachineFrameInfo.html#a853b47f34cdca978a18d7120e64bd4a1">mapLocalFrameObject</a>(FrameIdx, LocalOffset);</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  <span class="keywordflow">if</span> (!StackGrowsDown)</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    Offset += MFI-&gt;<a class="code" href="classllvm_1_1MachineFrameInfo.html#a43386af65581b8de506f3b57ba6c05b0">getObjectSize</a>(FrameIdx);</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  ++NumAllocations;</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;}</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment">/// calculateFrameObjectOffsets - Calculate actual frame offsets for all of the</span></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment">/// abstract stack objects.</span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment"></span><span class="keywordtype">void</span> LocalStackSlotPass::calculateFrameObjectOffsets(<a class="code" href="classllvm_1_1MachineFunction.html">MachineFunction</a> &amp;Fn) {</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  <span class="comment">// Loop over all of the stack objects, assigning sequential addresses...</span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  <a class="code" href="classllvm_1_1MachineFrameInfo.html">MachineFrameInfo</a> *MFI = Fn.<a class="code" href="classllvm_1_1MachineFunction.html#a4ad4295a88187ea1ae12ecfcfa18a70f">getFrameInfo</a>();</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetFrameLowering.html">TargetFrameLowering</a> &amp;TFI = *Fn.<a class="code" href="classllvm_1_1MachineFunction.html#a6745c3bfdfc5b0643b078b96df2db252">getTarget</a>().<a class="code" href="classllvm_1_1TargetMachine.html#a02aa9d4cbd6ffcc70dfe1143ec0995ef">getFrameLowering</a>();</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  <span class="keywordtype">bool</span> StackGrowsDown =</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    TFI.<a class="code" href="classllvm_1_1TargetFrameLowering.html#a8859c022d80a9f4ff145bc175481a493">getStackGrowthDirection</a>() == <a class="code" href="classllvm_1_1TargetFrameLowering.html#a453c74e2daac0745b53f8b31c11fc50cad1fc7c9d0bae5bf76a67d2d26ce99c1a">TargetFrameLowering::StackGrowsDown</a>;</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  int64_t Offset = 0;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  <span class="keywordtype">unsigned</span> MaxAlign = 0;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  <span class="comment">// Make sure that the stack protector comes before the local variables on the</span></div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  <span class="comment">// stack.</span></div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  <a class="code" href="classllvm_1_1SmallSet.html">SmallSet&lt;int, 16&gt;</a> LargeStackObjs;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  <span class="keywordflow">if</span> (MFI-&gt;<a class="code" href="classllvm_1_1MachineFrameInfo.html#a6448cb3cdaa64545e60f2c6981dd2ea7">getStackProtectorIndex</a>() &gt;= 0) {</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <a class="code" href="PrologEpilogInserter_8cpp.html#a1ab21d9615f20889f7e34e7eae8a2ea1">AdjustStackOffset</a>(MFI, MFI-&gt;<a class="code" href="classllvm_1_1MachineFrameInfo.html#a6448cb3cdaa64545e60f2c6981dd2ea7">getStackProtectorIndex</a>(), Offset,</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;                      StackGrowsDown, MaxAlign);</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="comment">// Assign large stack objects first.</span></div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0, e = MFI-&gt;<a class="code" href="classllvm_1_1MachineFrameInfo.html#ab127d56f832dc4400f58707a37ed5c6b">getObjectIndexEnd</a>(); <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != e; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;      <span class="keywordflow">if</span> (MFI-&gt;<a class="code" href="classllvm_1_1MachineFrameInfo.html#a639df36670c77819b19f9bdec96634df">isDeadObjectIndex</a>(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>))</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;      <span class="keywordflow">if</span> (MFI-&gt;<a class="code" href="classllvm_1_1MachineFrameInfo.html#a6448cb3cdaa64545e60f2c6981dd2ea7">getStackProtectorIndex</a>() == (<a class="code" href="Target_2README_8txt.html#a3217063f680fa8e35dea3c59b6e52b18">int</a>)<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;      <span class="keywordflow">if</span> (!MFI-&gt;<a class="code" href="classllvm_1_1MachineFrameInfo.html#acc15f1c24b0824ee929a256a61a53423">MayNeedStackProtector</a>(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>))</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;      <a class="code" href="PrologEpilogInserter_8cpp.html#a1ab21d9615f20889f7e34e7eae8a2ea1">AdjustStackOffset</a>(MFI, <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>, Offset, StackGrowsDown, MaxAlign);</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;      LargeStackObjs.<a class="code" href="classllvm_1_1SmallSet.html#a8d8348060ccdeeba13fb8bc651dfbf82">insert</a>(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    }</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  }</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  <span class="comment">// Then assign frame offsets to stack objects that are not used to spill</span></div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  <span class="comment">// callee saved registers.</span></div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0, e = MFI-&gt;<a class="code" href="classllvm_1_1MachineFrameInfo.html#ab127d56f832dc4400f58707a37ed5c6b">getObjectIndexEnd</a>(); <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != e; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="keywordflow">if</span> (MFI-&gt;<a class="code" href="classllvm_1_1MachineFrameInfo.html#a639df36670c77819b19f9bdec96634df">isDeadObjectIndex</a>(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>))</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <span class="keywordflow">if</span> (MFI-&gt;<a class="code" href="classllvm_1_1MachineFrameInfo.html#a6448cb3cdaa64545e60f2c6981dd2ea7">getStackProtectorIndex</a>() == (<a class="code" href="Target_2README_8txt.html#a3217063f680fa8e35dea3c59b6e52b18">int</a>)<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="keywordflow">if</span> (LargeStackObjs.<a class="code" href="classllvm_1_1SmallSet.html#ab28aa342862f6d16361be514fd98c22e">count</a>(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>))</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <a class="code" href="PrologEpilogInserter_8cpp.html#a1ab21d9615f20889f7e34e7eae8a2ea1">AdjustStackOffset</a>(MFI, <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>, Offset, StackGrowsDown, MaxAlign);</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;  }</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  <span class="comment">// Remember how big this blob of stack space is</span></div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  MFI-&gt;<a class="code" href="classllvm_1_1MachineFrameInfo.html#a39e8a5cc0ba7568b8e0584139d97c0cc">setLocalFrameSize</a>(Offset);</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  MFI-&gt;<a class="code" href="classllvm_1_1MachineFrameInfo.html#a69af3c7700039f409a9a36cca11ae19f">setLocalFrameMaxAlign</a>(MaxAlign);</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;}</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">bool</span></div><div class="line"><a name="l00200"></a><span class="lineno"><a class="line" href="LocalStackSlotAllocation_8cpp.html#a664fdb933021bff807f128e5e9b562d3">  200</a></span>&#160;<a class="code" href="LocalStackSlotAllocation_8cpp.html#a664fdb933021bff807f128e5e9b562d3">lookupCandidateBaseReg</a>(int64_t BaseOffset,</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;                       int64_t FrameSizeAdjust,</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                       int64_t LocalFrameOffset,</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;                       <span class="keyword">const</span> <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *<a class="code" href="namespacellvm_1_1A64CC.html#af5804bc0518be9568f73db566e4d6f46a2db5e7546f960277ff98f96cd5624442">MI</a>,</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                       <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetRegisterInfo.html">TargetRegisterInfo</a> *TRI) {</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  <span class="comment">// Check if the relative offset from the where the base register references</span></div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  <span class="comment">// to the target address is in range for the instruction.</span></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  int64_t Offset = FrameSizeAdjust + LocalFrameOffset - BaseOffset;</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;  <span class="keywordflow">return</span> TRI-&gt;<a class="code" href="classllvm_1_1TargetRegisterInfo.html#a24d7d13a35348f2576a8fac1367b8f34">isFrameOffsetLegal</a>(MI, Offset);</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;}</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="keywordtype">bool</span> LocalStackSlotPass::insertFrameReferenceRegisters(<a class="code" href="classllvm_1_1MachineFunction.html">MachineFunction</a> &amp;Fn) {</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  <span class="comment">// Scan the function&#39;s instructions looking for frame index references.</span></div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  <span class="comment">// For each, ask the target if it wants a virtual base register for it</span></div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  <span class="comment">// based on what we can tell it about where the local will end up in the</span></div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  <span class="comment">// stack frame. If it wants one, re-use a suitable one we&#39;ve previously</span></div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  <span class="comment">// allocated, or if there isn&#39;t one that fits the bill, allocate a new one</span></div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;  <span class="comment">// and ask the target to create a defining instruction for it.</span></div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;  <span class="keywordtype">bool</span> UsedBaseReg = <span class="keyword">false</span>;</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  <a class="code" href="classllvm_1_1MachineFrameInfo.html">MachineFrameInfo</a> *MFI = Fn.<a class="code" href="classllvm_1_1MachineFunction.html#a4ad4295a88187ea1ae12ecfcfa18a70f">getFrameInfo</a>();</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetRegisterInfo.html">TargetRegisterInfo</a> *TRI = Fn.<a class="code" href="classllvm_1_1MachineFunction.html#a6745c3bfdfc5b0643b078b96df2db252">getTarget</a>().<a class="code" href="classllvm_1_1TargetMachine.html#a70b47eca6a99c87b81f4c1b1455dc090">getRegisterInfo</a>();</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetFrameLowering.html">TargetFrameLowering</a> &amp;TFI = *Fn.<a class="code" href="classllvm_1_1MachineFunction.html#a6745c3bfdfc5b0643b078b96df2db252">getTarget</a>().<a class="code" href="classllvm_1_1TargetMachine.html#a02aa9d4cbd6ffcc70dfe1143ec0995ef">getFrameLowering</a>();</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;  <span class="keywordtype">bool</span> StackGrowsDown =</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    TFI.<a class="code" href="classllvm_1_1TargetFrameLowering.html#a8859c022d80a9f4ff145bc175481a493">getStackGrowthDirection</a>() == <a class="code" href="classllvm_1_1TargetFrameLowering.html#a453c74e2daac0745b53f8b31c11fc50cad1fc7c9d0bae5bf76a67d2d26ce99c1a">TargetFrameLowering::StackGrowsDown</a>;</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;  <span class="comment">// Collect all of the instructions in the block that reference</span></div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  <span class="comment">// a frame index. Also store the frame index referenced to ease later</span></div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;  <span class="comment">// lookup. (For any insn that has more than one FI reference, we arbitrarily</span></div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  <span class="comment">// choose the first one).</span></div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;FrameRef, 64&gt;</a> FrameReferenceInsns;</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1MachineFunction.html#a340712de3e78fec11c338735cab17df7">MachineFunction::iterator</a> <a class="code" href="CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> = Fn.<a class="code" href="classllvm_1_1MachineFunction.html#ab0789854909cf47f640a85fa2bac29c7">begin</a>(), E = Fn.<a class="code" href="classllvm_1_1MachineFunction.html#a9d017af749f76484cb9aec9ff6e4330c">end</a>(); <a class="code" href="CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> != E; ++<a class="code" href="CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>) {</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1MachineBasicBlock.html#ac51be7ff80fe8d6ae5e8c0acb194908a">MachineBasicBlock::iterator</a> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = <a class="code" href="CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>-&gt;begin(); <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> != <a class="code" href="CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>-&gt;end(); ++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;      <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *<a class="code" href="namespacellvm_1_1A64CC.html#af5804bc0518be9568f73db566e4d6f46a2db5e7546f960277ff98f96cd5624442">MI</a> = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;      <span class="comment">// Debug value instructions can&#39;t be out of range, so they don&#39;t need</span></div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;      <span class="comment">// any updates.</span></div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;      <span class="keywordflow">if</span> (MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a1e1d26226c627cf3dcf3c191b85e7d7d">isDebugValue</a>())</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;      <span class="comment">// For now, allocate the base register(s) within the basic block</span></div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;      <span class="comment">// where they&#39;re used, and don&#39;t try to keep them around outside</span></div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;      <span class="comment">// of that. It may be beneficial to try sharing them more broadly</span></div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;      <span class="comment">// than that, but the increased register pressure makes that a</span></div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;      <span class="comment">// tricky thing to balance. Investigate if re-materializing these</span></div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;      <span class="comment">// becomes an issue.</span></div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0, e = MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a7b5fe96d88954efc855e6c466207e535">getNumOperands</a>(); <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != e; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;        <span class="comment">// Consider replacing all frame index operands that reference</span></div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        <span class="comment">// an object allocated in the local block.</span></div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;        <span class="keywordflow">if</span> (MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a302e45878c6dc1714334c7ce96d56846">getOperand</a>(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>).<a class="code" href="classllvm_1_1MachineOperand.html#ab0d5ec413fa43a1e470dafb6cafda9b5">isFI</a>()) {</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;          <span class="comment">// Don&#39;t try this with values not in the local block.</span></div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;          <span class="keywordflow">if</span> (!MFI-&gt;<a class="code" href="classllvm_1_1MachineFrameInfo.html#a2041238c0cdc2d831eb500a772f074ae">isObjectPreAllocated</a>(MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a302e45878c6dc1714334c7ce96d56846">getOperand</a>(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>).<a class="code" href="classllvm_1_1MachineOperand.html#ac9485ae7d6fedd71ad4460f72c799c98">getIndex</a>()))</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;          <span class="keywordtype">int</span> Idx = MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a302e45878c6dc1714334c7ce96d56846">getOperand</a>(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>).<a class="code" href="classllvm_1_1MachineOperand.html#ac9485ae7d6fedd71ad4460f72c799c98">getIndex</a>();</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;          int64_t LocalOffset = LocalOffsets[Idx];</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;          <span class="keywordflow">if</span> (!TRI-&gt;<a class="code" href="classllvm_1_1TargetRegisterInfo.html#adb2ad0d16e2091a054427ae1c399ad8f">needsFrameBaseReg</a>(MI, LocalOffset))</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;          FrameReferenceInsns.</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;            push_back(FrameRef(MI, LocalOffset, Idx));</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;          <span class="keywordflow">break</span>;</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        }</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;      }</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    }</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;  }</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;  <span class="comment">// Sort the frame references by local offset</span></div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;  <a class="code" href="namespacellvm.html#add1eb5637dd671428b6f138ed3db6428">array_pod_sort</a>(FrameReferenceInsns.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#a8a045d250952c0867382a9840ee18fdf">begin</a>(), FrameReferenceInsns.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#a075e34e98605d0e7c289763a104869ac">end</a>());</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;  <a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> *Entry = Fn.<a class="code" href="classllvm_1_1MachineFunction.html#ab0789854909cf47f640a85fa2bac29c7">begin</a>();</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  <span class="keywordtype">unsigned</span> BaseReg = 0;</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  int64_t BaseOffset = 0;</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;  <span class="comment">// Loop through the frame references and allocate for them as necessary.</span></div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ref = 0, e = FrameReferenceInsns.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#a22a311dfe4c28a897de8a9365a4f0a84">size</a>(); ref &lt; e ; ++ref) {</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    FrameRef &amp;FR = FrameReferenceInsns[ref];</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <a class="code" href="classllvm_1_1MachineBasicBlock.html#ac51be7ff80fe8d6ae5e8c0acb194908a">MachineBasicBlock::iterator</a> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = FR.getMachineInstr();</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *<a class="code" href="namespacellvm_1_1A64CC.html#af5804bc0518be9568f73db566e4d6f46a2db5e7546f960277ff98f96cd5624442">MI</a> = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>;</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    int64_t LocalOffset = FR.getLocalOffset();</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    <span class="keywordtype">int</span> FrameIdx = FR.getFrameIndex();</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    assert(MFI-&gt;<a class="code" href="classllvm_1_1MachineFrameInfo.html#a2041238c0cdc2d831eb500a772f074ae">isObjectPreAllocated</a>(FrameIdx) &amp;&amp;</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;           <span class="stringliteral">&quot;Only pre-allocated locals expected!&quot;</span>);</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Considering: &quot;</span> &lt;&lt; *MI);</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <span class="keywordtype">unsigned</span> idx = 0;</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="README__ALTIVEC_8txt.html#afb354c8aea0150628f8aa06c7f4a4168">f</a> = MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a7b5fe96d88954efc855e6c466207e535">getNumOperands</a>(); idx != <a class="code" href="README__ALTIVEC_8txt.html#afb354c8aea0150628f8aa06c7f4a4168">f</a>; ++idx) {</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;      <span class="keywordflow">if</span> (!MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a302e45878c6dc1714334c7ce96d56846">getOperand</a>(idx).<a class="code" href="classllvm_1_1MachineOperand.html#ab0d5ec413fa43a1e470dafb6cafda9b5">isFI</a>())</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;      <span class="keywordflow">if</span> (FrameIdx == I-&gt;getOperand(idx).getIndex())</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    }</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    assert(idx &lt; MI-&gt;getNumOperands() &amp;&amp; <span class="stringliteral">&quot;Cannot find FI operand&quot;</span>);</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    int64_t Offset = 0;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    int64_t FrameSizeAdjust = StackGrowsDown ? MFI-&gt;<a class="code" href="classllvm_1_1MachineFrameInfo.html#a10e9ecc89983e197d0a06a473fd8831c">getLocalFrameSize</a>() : 0;</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;  Replacing FI in: &quot;</span> &lt;&lt; *MI);</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <span class="comment">// If we have a suitable base register available, use it; otherwise</span></div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <span class="comment">// create a new one. Note that any offset encoded in the</span></div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <span class="comment">// instruction itself will be taken into account by the target,</span></div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <span class="comment">// so we don&#39;t have to adjust for it here when reusing a base</span></div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    <span class="comment">// register.</span></div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <span class="keywordflow">if</span> (UsedBaseReg &amp;&amp; <a class="code" href="LocalStackSlotAllocation_8cpp.html#a664fdb933021bff807f128e5e9b562d3">lookupCandidateBaseReg</a>(BaseOffset, FrameSizeAdjust,</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;                                              LocalOffset, MI, TRI)) {</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;      <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;  Reusing base register &quot;</span> &lt;&lt; BaseReg &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;      <span class="comment">// We found a register to reuse.</span></div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;      Offset = FrameSizeAdjust + LocalOffset - BaseOffset;</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;      <span class="comment">// No previously defined register was in range, so create a // new one.</span></div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160; </div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;      int64_t InstrOffset = TRI-&gt;<a class="code" href="classllvm_1_1TargetRegisterInfo.html#a62c3a08055fda404d8d0ce0f0daf5658">getFrameIndexInstrOffset</a>(MI, idx);</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;      int64_t PrevBaseOffset = BaseOffset;</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;      BaseOffset = FrameSizeAdjust + LocalOffset + InstrOffset;</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;      <span class="comment">// We&#39;d like to avoid creating single-use virtual base registers.</span></div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;      <span class="comment">// Because the FrameRefs are in sorted order, and we&#39;ve already</span></div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;      <span class="comment">// processed all FrameRefs before this one, just check whether or not</span></div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;      <span class="comment">// the next FrameRef will be able to reuse this new register. If not,</span></div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;      <span class="comment">// then don&#39;t bother creating it.</span></div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;      <span class="keywordtype">bool</span> CanReuse = <span class="keyword">false</span>;</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> refn = ref + 1; refn &lt; e; ++refn) {</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        FrameRef &amp;FRN = FrameReferenceInsns[refn];</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;        <a class="code" href="classllvm_1_1MachineBasicBlock.html#ac51be7ff80fe8d6ae5e8c0acb194908a">MachineBasicBlock::iterator</a> J = FRN.getMachineInstr();</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;        <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *MIN = J;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;        CanReuse = <a class="code" href="LocalStackSlotAllocation_8cpp.html#a664fdb933021bff807f128e5e9b562d3">lookupCandidateBaseReg</a>(BaseOffset, FrameSizeAdjust,</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;                                          FRN.getLocalOffset(), MIN, TRI);</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;      }</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;      <span class="keywordflow">if</span> (!CanReuse) {</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        BaseOffset = PrevBaseOffset;</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;      }</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;      <span class="keyword">const</span> <a class="code" href="classllvm_1_1MachineFunction.html">MachineFunction</a> *MF = MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#aabad9b72f6d20d3462efc34020d39f73">getParent</a>()-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#af2e482ff2a9253ec6bc2285491496bd6">getParent</a>();</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;      <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetRegisterClass.html">TargetRegisterClass</a> *RC = TRI-&gt;<a class="code" href="classllvm_1_1TargetRegisterInfo.html#a0b3a814040f5e721a08d8b9b277b3fec">getPointerRegClass</a>(*MF);</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;      BaseReg = Fn.<a class="code" href="classllvm_1_1MachineFunction.html#ab4a6ca428289b667dd691a00e9f7e334">getRegInfo</a>().<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a76c3c7e3d4f11b4cfad37fc0449c9635">createVirtualRegister</a>(RC);</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;      <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;  Materializing base register &quot;</span> &lt;&lt; BaseReg &lt;&lt;</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;            <span class="stringliteral">&quot; at frame local offset &quot;</span> &lt;&lt; LocalOffset + InstrOffset &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;      <span class="comment">// Tell the target to insert the instruction to initialize</span></div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;      <span class="comment">// the base register.</span></div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;      <span class="comment">//            MachineBasicBlock::iterator InsertionPt = Entry-&gt;begin();</span></div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;      TRI-&gt;<a class="code" href="classllvm_1_1TargetRegisterInfo.html#a6ff3defd0102c3138e58d4e28e8e943f">materializeFrameBaseRegister</a>(Entry, BaseReg, FrameIdx,</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;                                        InstrOffset);</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;      <span class="comment">// The base register already includes any offset specified</span></div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;      <span class="comment">// by the instruction, so account for that so it doesn&#39;t get</span></div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;      <span class="comment">// applied twice.</span></div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;      Offset = -InstrOffset;</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;      ++NumBaseRegisters;</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;      UsedBaseReg = <span class="keyword">true</span>;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    }</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    assert(BaseReg != 0 &amp;&amp; <span class="stringliteral">&quot;Unable to allocate virtual base register!&quot;</span>);</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    <span class="comment">// Modify the instruction to use the new base register rather</span></div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    <span class="comment">// than the frame index operand.</span></div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    TRI-&gt;<a class="code" href="classllvm_1_1TargetRegisterInfo.html#aabffd296e83a5d7ecd59255ab234f04f">resolveFrameIndex</a>(I, BaseReg, Offset);</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <a class="code" href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Resolved: &quot;</span> &lt;&lt; *MI);</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    ++NumReplacements;</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;  }</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;  <span class="keywordflow">return</span> UsedBaseReg;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;}</div><div class="ttc" id="classllvm_1_1SmallVectorTemplateCommon_html_a075e34e98605d0e7c289763a104869ac"><div class="ttname"><a href="classllvm_1_1SmallVectorTemplateCommon.html#a075e34e98605d0e7c289763a104869ac">llvm::SmallVectorTemplateCommon&lt; T &gt;::end</a></div><div class="ttdeci">iterator end()</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00114">SmallVector.h:114</a></div></div>
<div class="ttc" id="classllvm_1_1SmallVectorTemplateCommon_html_a22a311dfe4c28a897de8a9365a4f0a84"><div class="ttname"><a href="classllvm_1_1SmallVectorTemplateCommon.html#a22a311dfe4c28a897de8a9365a4f0a84">llvm::SmallVectorTemplateCommon&lt; T &gt;::size</a></div><div class="ttdeci">size_type size() const</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00127">SmallVector.h:127</a></div></div>
<div class="ttc" id="SmallSet_8h_html"><div class="ttname"><a href="SmallSet_8h.html">SmallSet.h</a></div></div>
<div class="ttc" id="classllvm_1_1MachineBasicBlock_html_af2e482ff2a9253ec6bc2285491496bd6"><div class="ttname"><a href="classllvm_1_1MachineBasicBlock.html#af2e482ff2a9253ec6bc2285491496bd6">llvm::MachineBasicBlock::getParent</a></div><div class="ttdeci">const MachineFunction * getParent() const </div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8h_source.html#l00137">MachineBasicBlock.h:137</a></div></div>
<div class="ttc" id="Instructions_8h_html"><div class="ttname"><a href="Instructions_8h.html">Instructions.h</a></div></div>
<div class="ttc" id="classllvm_1_1MachineFrameInfo_html_a853b47f34cdca978a18d7120e64bd4a1"><div class="ttname"><a href="classllvm_1_1MachineFrameInfo.html#a853b47f34cdca978a18d7120e64bd4a1">llvm::MachineFrameInfo::mapLocalFrameObject</a></div><div class="ttdeci">void mapLocalFrameObject(int ObjectIndex, int64_t Offset)</div><div class="ttdoc">mapLocalFrameObject - Map a frame index into the local object block </div><div class="ttdef"><b>Definition:</b> <a href="MachineFrameInfo_8h_source.html#l00295">MachineFrameInfo.h:295</a></div></div>
<div class="ttc" id="namespacellvm_html"><div class="ttname"><a href="namespacellvm.html">llvm</a></div><div class="ttdoc">List of target independent CodeGen pass IDs. </div><div class="ttdef"><b>Definition:</b> <a href="APFloat_8h_source.html#l00022">APFloat.h:22</a></div></div>
<div class="ttc" id="classllvm_1_1MachineFunction_html_a9d017af749f76484cb9aec9ff6e4330c"><div class="ttname"><a href="classllvm_1_1MachineFunction.html#a9d017af749f76484cb9aec9ff6e4330c">llvm::MachineFunction::end</a></div><div class="ttdeci">iterator end()</div><div class="ttdef"><b>Definition:</b> <a href="MachineFunction_8h_source.html#l00317">MachineFunction.h:317</a></div></div>
<div class="ttc" id="DerivedTypes_8h_html"><div class="ttname"><a href="DerivedTypes_8h.html">DerivedTypes.h</a></div></div>
<div class="ttc" id="classllvm_1_1MachineFunction_html"><div class="ttname"><a href="classllvm_1_1MachineFunction.html">llvm::MachineFunction</a></div><div class="ttdef"><b>Definition:</b> <a href="MachineFunction_8h_source.html#l00075">MachineFunction.h:75</a></div></div>
<div class="ttc" id="classllvm_1_1MachineFunction_html_ab0789854909cf47f640a85fa2bac29c7"><div class="ttname"><a href="classllvm_1_1MachineFunction.html#ab0789854909cf47f640a85fa2bac29c7">llvm::MachineFunction::begin</a></div><div class="ttdeci">iterator begin()</div><div class="ttdef"><b>Definition:</b> <a href="MachineFunction_8h_source.html#l00315">MachineFunction.h:315</a></div></div>
<div class="ttc" id="classllvm_1_1MachineRegisterInfo_html_a76c3c7e3d4f11b4cfad37fc0449c9635"><div class="ttname"><a href="classllvm_1_1MachineRegisterInfo.html#a76c3c7e3d4f11b4cfad37fc0449c9635">llvm::MachineRegisterInfo::createVirtualRegister</a></div><div class="ttdeci">unsigned createVirtualRegister(const TargetRegisterClass *RegClass)</div><div class="ttdef"><b>Definition:</b> <a href="MachineRegisterInfo_8cpp_source.html#l00104">MachineRegisterInfo.cpp:104</a></div></div>
<div class="ttc" id="Debug_8h_html"><div class="ttname"><a href="Debug_8h.html">Debug.h</a></div></div>
<div class="ttc" id="namespacellvm_html_a7c469a194119a14e5a018ebb9b847cf0"><div class="ttname"><a href="namespacellvm.html#a7c469a194119a14e5a018ebb9b847cf0">llvm::operator&lt;</a></div><div class="ttdeci">void operator&lt;(const Optional&lt; T &gt; &amp;X, const Optional&lt; U &gt; &amp;Y)</div><div class="ttdoc">Poison comparison between two Optional objects. Clients needs to explicitly compare the underlying va...</div></div>
<div class="ttc" id="LocalStackSlotAllocation_8cpp_html_a664fdb933021bff807f128e5e9b562d3"><div class="ttname"><a href="LocalStackSlotAllocation_8cpp.html#a664fdb933021bff807f128e5e9b562d3">lookupCandidateBaseReg</a></div><div class="ttdeci">static bool lookupCandidateBaseReg(int64_t BaseOffset, int64_t FrameSizeAdjust, int64_t LocalFrameOffset, const MachineInstr *MI, const TargetRegisterInfo *TRI)</div><div class="ttdef"><b>Definition:</b> <a href="LocalStackSlotAllocation_8cpp_source.html#l00200">LocalStackSlotAllocation.cpp:200</a></div></div>
<div class="ttc" id="Statistic_8h_html"><div class="ttname"><a href="Statistic_8h.html">Statistic.h</a></div></div>
<div class="ttc" id="classllvm_1_1MachineFrameInfo_html_a2041238c0cdc2d831eb500a772f074ae"><div class="ttname"><a href="classllvm_1_1MachineFrameInfo.html#a2041238c0cdc2d831eb500a772f074ae">llvm::MachineFrameInfo::isObjectPreAllocated</a></div><div class="ttdeci">bool isObjectPreAllocated(int ObjectIdx) const </div><div class="ttdef"><b>Definition:</b> <a href="MachineFrameInfo_8h_source.html#l00339">MachineFrameInfo.h:339</a></div></div>
<div class="ttc" id="classllvm_1_1MachineFrameInfo_html_a10e9ecc89983e197d0a06a473fd8831c"><div class="ttname"><a href="classllvm_1_1MachineFrameInfo.html#a10e9ecc89983e197d0a06a473fd8831c">llvm::MachineFrameInfo::getLocalFrameSize</a></div><div class="ttdeci">int64_t getLocalFrameSize() const </div><div class="ttdoc">getLocalFrameSize - Get the size of the local object blob. </div><div class="ttdef"><b>Definition:</b> <a href="MachineFrameInfo_8h_source.html#l00315">MachineFrameInfo.h:315</a></div></div>
<div class="ttc" id="Target_2README_8txt_html_a3217063f680fa8e35dea3c59b6e52b18"><div class="ttname"><a href="Target_2README_8txt.html#a3217063f680fa8e35dea3c59b6e52b18">int</a></div><div class="ttdeci">Clang compiles this i1 i64 store i64 i64 store i64 i64 store i64 i64 store i64 align Which gets codegen d xmm0 movaps rbp movaps rbp movaps rbp movaps rbp rbp rbp rbp rbp It would be better to have movq s of instead of the movaps s LLVM produces ret int</div><div class="ttdef"><b>Definition:</b> <a href="Target_2README_8txt_source.html#l00549">Target/README.txt:549</a></div></div>
<div class="ttc" id="classllvm_1_1TargetRegisterInfo_html_a62c3a08055fda404d8d0ce0f0daf5658"><div class="ttname"><a href="classllvm_1_1TargetRegisterInfo.html#a62c3a08055fda404d8d0ce0f0daf5658">llvm::TargetRegisterInfo::getFrameIndexInstrOffset</a></div><div class="ttdeci">virtual int64_t getFrameIndexInstrOffset(const MachineInstr *MI, int Idx) const </div><div class="ttdef"><b>Definition:</b> <a href="TargetRegisterInfo_8h_source.html#l00727">TargetRegisterInfo.h:727</a></div></div>
<div class="ttc" id="MachineFunction_8h_html"><div class="ttname"><a href="MachineFunction_8h.html">MachineFunction.h</a></div></div>
<div class="ttc" id="classllvm_1_1MachineFrameInfo_html_a39e8a5cc0ba7568b8e0584139d97c0cc"><div class="ttname"><a href="classllvm_1_1MachineFrameInfo.html#a39e8a5cc0ba7568b8e0584139d97c0cc">llvm::MachineFrameInfo::setLocalFrameSize</a></div><div class="ttdeci">void setLocalFrameSize(int64_t sz)</div><div class="ttdoc">setLocalFrameSize - Set the size of the local object blob. </div><div class="ttdef"><b>Definition:</b> <a href="MachineFrameInfo_8h_source.html#l00312">MachineFrameInfo.h:312</a></div></div>
<div class="ttc" id="classllvm_1_1MachineFrameInfo_html_a37cfdca2465d899059663518672882b0"><div class="ttname"><a href="classllvm_1_1MachineFrameInfo.html#a37cfdca2465d899059663518672882b0">llvm::MachineFrameInfo::setUseLocalStackAllocationBlock</a></div><div class="ttdeci">void setUseLocalStackAllocationBlock(bool v)</div><div class="ttdef"><b>Definition:</b> <a href="MachineFrameInfo_8h_source.html#l00333">MachineFrameInfo.h:333</a></div></div>
<div class="ttc" id="classllvm_1_1MachineFunctionPass_html"><div class="ttname"><a href="classllvm_1_1MachineFunctionPass.html">llvm::MachineFunctionPass</a></div><div class="ttdef"><b>Definition:</b> <a href="MachineFunctionPass_8h_source.html#l00032">MachineFunctionPass.h:32</a></div></div>
<div class="ttc" id="MachineFrameInfo_8h_html"><div class="ttname"><a href="MachineFrameInfo_8h.html">MachineFrameInfo.h</a></div></div>
<div class="ttc" id="classllvm_1_1TargetRegisterClass_html"><div class="ttname"><a href="classllvm_1_1TargetRegisterClass.html">llvm::TargetRegisterClass</a></div><div class="ttdef"><b>Definition:</b> <a href="TargetRegisterInfo_8h_source.html#l00036">TargetRegisterInfo.h:36</a></div></div>
<div class="ttc" id="STLExtras_8h_html"><div class="ttname"><a href="STLExtras_8h.html">STLExtras.h</a></div></div>
<div class="ttc" id="classllvm_1_1MachineFrameInfo_html"><div class="ttname"><a href="classllvm_1_1MachineFrameInfo.html">llvm::MachineFrameInfo</a></div><div class="ttdoc">Abstract Stack Frame Information. </div><div class="ttdef"><b>Definition:</b> <a href="MachineFrameInfo_8h_source.html#l00080">MachineFrameInfo.h:80</a></div></div>
<div class="ttc" id="ErrorHandling_8h_html"><div class="ttname"><a href="ErrorHandling_8h.html">ErrorHandling.h</a></div></div>
<div class="ttc" id="namespacellvm_1_1CallingConv_html_a4f861731fc6dbfdccc05af5968d98974"><div class="ttname"><a href="namespacellvm_1_1CallingConv.html#a4f861731fc6dbfdccc05af5968d98974">llvm::CallingConv::ID</a></div><div class="ttdeci">ID</div><div class="ttdoc">LLVM Calling Convention Representation. </div><div class="ttdef"><b>Definition:</b> <a href="CallingConv_8h_source.html#l00026">CallingConv.h:26</a></div></div>
<div class="ttc" id="LocalStackSlotAllocation_8cpp_html_a90e3b74662af606d65b5b25ab1a01734"><div class="ttname"><a href="LocalStackSlotAllocation_8cpp.html#a90e3b74662af606d65b5b25ab1a01734">STATISTIC</a></div><div class="ttdeci">STATISTIC(NumAllocations,&quot;Number of frame indices allocated into local block&quot;)</div></div>
<div class="ttc" id="classllvm_1_1MachineInstr_html_a7b5fe96d88954efc855e6c466207e535"><div class="ttname"><a href="classllvm_1_1MachineInstr.html#a7b5fe96d88954efc855e6c466207e535">llvm::MachineInstr::getNumOperands</a></div><div class="ttdeci">unsigned getNumOperands() const </div><div class="ttdef"><b>Definition:</b> <a href="MachineInstr_8h_source.html#l00265">MachineInstr.h:265</a></div></div>
<div class="ttc" id="LocalStackSlotAllocation_8cpp_html_afb4b62415b1d83637f8bfa8343e4a384"><div class="ttname"><a href="LocalStackSlotAllocation_8cpp.html#afb4b62415b1d83637f8bfa8343e4a384">INITIALIZE_PASS</a></div><div class="ttdeci">INITIALIZE_PASS(LocalStackSlotPass,&quot;localstackalloc&quot;,&quot;Local Stack Slot Allocation&quot;, false, false) bool LocalStackSlotPass</div><div class="ttdef"><b>Definition:</b> <a href="LocalStackSlotAllocation_8cpp_source.html#l00084">LocalStackSlotAllocation.cpp:84</a></div></div>
<div class="ttc" id="classllvm_1_1MachineOperand_html_ab0d5ec413fa43a1e470dafb6cafda9b5"><div class="ttname"><a href="classllvm_1_1MachineOperand.html#ab0d5ec413fa43a1e470dafb6cafda9b5">llvm::MachineOperand::isFI</a></div><div class="ttdeci">bool isFI() const </div><div class="ttdoc">isFI - Tests if this is a MO_FrameIndex operand. </div><div class="ttdef"><b>Definition:</b> <a href="MachineOperand_8h_source.html#l00234">MachineOperand.h:234</a></div></div>
<div class="ttc" id="classllvm_1_1MachineFrameInfo_html_a69af3c7700039f409a9a36cca11ae19f"><div class="ttname"><a href="classllvm_1_1MachineFrameInfo.html#a69af3c7700039f409a9a36cca11ae19f">llvm::MachineFrameInfo::setLocalFrameMaxAlign</a></div><div class="ttdeci">void setLocalFrameMaxAlign(unsigned Align)</div><div class="ttdef"><b>Definition:</b> <a href="MachineFrameInfo_8h_source.html#l00319">MachineFrameInfo.h:319</a></div></div>
<div class="ttc" id="classllvm_1_1SmallSet_html_a8d8348060ccdeeba13fb8bc651dfbf82"><div class="ttname"><a href="classllvm_1_1SmallSet.html#a8d8348060ccdeeba13fb8bc651dfbf82">llvm::SmallSet::insert</a></div><div class="ttdeci">bool insert(const T &amp;V)</div><div class="ttdef"><b>Definition:</b> <a href="SmallSet_8h_source.html#l00059">SmallSet.h:59</a></div></div>
<div class="ttc" id="classllvm_1_1TargetRegisterInfo_html_ab1b80d824b4e3c38846e4d7b2b463867"><div class="ttname"><a href="classllvm_1_1TargetRegisterInfo.html#ab1b80d824b4e3c38846e4d7b2b463867">llvm::TargetRegisterInfo::requiresVirtualBaseRegisters</a></div><div class="ttdeci">virtual bool requiresVirtualBaseRegisters(const MachineFunction &amp;MF) const </div><div class="ttdef"><b>Definition:</b> <a href="TargetRegisterInfo_8h_source.html#l00697">TargetRegisterInfo.h:697</a></div></div>
<div class="ttc" id="classllvm_1_1TargetRegisterInfo_html_a6ff3defd0102c3138e58d4e28e8e943f"><div class="ttname"><a href="classllvm_1_1TargetRegisterInfo.html#a6ff3defd0102c3138e58d4e28e8e943f">llvm::TargetRegisterInfo::materializeFrameBaseRegister</a></div><div class="ttdeci">virtual void materializeFrameBaseRegister(MachineBasicBlock *MBB, unsigned BaseReg, int FrameIdx, int64_t Offset) const </div><div class="ttdef"><b>Definition:</b> <a href="TargetRegisterInfo_8h_source.html#l00742">TargetRegisterInfo.h:742</a></div></div>
<div class="ttc" id="classllvm_1_1TargetRegisterInfo_html_aabffd296e83a5d7ecd59255ab234f04f"><div class="ttname"><a href="classllvm_1_1TargetRegisterInfo.html#aabffd296e83a5d7ecd59255ab234f04f">llvm::TargetRegisterInfo::resolveFrameIndex</a></div><div class="ttdeci">virtual void resolveFrameIndex(MachineBasicBlock::iterator I, unsigned BaseReg, int64_t Offset) const </div><div class="ttdef"><b>Definition:</b> <a href="TargetRegisterInfo_8h_source.html#l00751">TargetRegisterInfo.h:751</a></div></div>
<div class="ttc" id="classllvm_1_1MachineInstr_html_aabad9b72f6d20d3462efc34020d39f73"><div class="ttname"><a href="classllvm_1_1MachineInstr.html#aabad9b72f6d20d3462efc34020d39f73">llvm::MachineInstr::getParent</a></div><div class="ttdeci">const MachineBasicBlock * getParent() const </div><div class="ttdef"><b>Definition:</b> <a href="MachineInstr_8h_source.html#l00119">MachineInstr.h:119</a></div></div>
<div class="ttc" id="classllvm_1_1MachineInstr_html_a1e1d26226c627cf3dcf3c191b85e7d7d"><div class="ttname"><a href="classllvm_1_1MachineInstr.html#a1e1d26226c627cf3dcf3c191b85e7d7d">llvm::MachineInstr::isDebugValue</a></div><div class="ttdeci">bool isDebugValue() const </div><div class="ttdef"><b>Definition:</b> <a href="MachineInstr_8h_source.html#l00639">MachineInstr.h:639</a></div></div>
<div class="ttc" id="classllvm_1_1MachineBasicBlock_html_ac51be7ff80fe8d6ae5e8c0acb194908a"><div class="ttname"><a href="classllvm_1_1MachineBasicBlock.html#ac51be7ff80fe8d6ae5e8c0acb194908a">llvm::MachineBasicBlock::iterator</a></div><div class="ttdeci">bundle_iterator&lt; MachineInstr, instr_iterator &gt; iterator</div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8h_source.html#l00212">MachineBasicBlock.h:212</a></div></div>
<div class="ttc" id="namespacellvm_html_add1eb5637dd671428b6f138ed3db6428"><div class="ttname"><a href="namespacellvm.html#add1eb5637dd671428b6f138ed3db6428">llvm::array_pod_sort</a></div><div class="ttdeci">void array_pod_sort(IteratorTy Start, IteratorTy End)</div><div class="ttdef"><b>Definition:</b> <a href="STLExtras_8h_source.html#l00289">STLExtras.h:289</a></div></div>
<div class="ttc" id="classllvm_1_1SmallSet_html"><div class="ttname"><a href="classllvm_1_1SmallSet.html">llvm::SmallSet</a></div><div class="ttdef"><b>Definition:</b> <a href="SmallSet_8h_source.html#l00031">SmallSet.h:31</a></div></div>
<div class="ttc" id="Constants_8h_html"><div class="ttname"><a href="Constants_8h.html">Constants.h</a></div></div>
<div class="ttc" id="classllvm_1_1MachineInstr_html_a302e45878c6dc1714334c7ce96d56846"><div class="ttname"><a href="classllvm_1_1MachineInstr.html#a302e45878c6dc1714334c7ce96d56846">llvm::MachineInstr::getOperand</a></div><div class="ttdeci">const MachineOperand &amp; getOperand(unsigned i) const </div><div class="ttdef"><b>Definition:</b> <a href="MachineInstr_8h_source.html#l00267">MachineInstr.h:267</a></div></div>
<div class="ttc" id="classllvm_1_1MachineBasicBlock_html"><div class="ttname"><a href="classllvm_1_1MachineBasicBlock.html">llvm::MachineBasicBlock</a></div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8h_source.html#l00062">MachineBasicBlock.h:62</a></div></div>
<div class="ttc" id="classllvm_1_1AnalysisUsage_html"><div class="ttname"><a href="classllvm_1_1AnalysisUsage.html">llvm::AnalysisUsage</a></div><div class="ttdef"><b>Definition:</b> <a href="PassAnalysisSupport_8h_source.html#l00037">PassAnalysisSupport.h:37</a></div></div>
<div class="ttc" id="README__ALTIVEC_8txt_html_afb354c8aea0150628f8aa06c7f4a4168"><div class="ttname"><a href="README__ALTIVEC_8txt.html#afb354c8aea0150628f8aa06c7f4a4168">f</a></div><div class="ttdeci">vector float f(vector float a, vector float b)</div><div class="ttdef"><b>Definition:</b> <a href="README__ALTIVEC_8txt_source.html#l00205">README_ALTIVEC.txt:205</a></div></div>
<div class="ttc" id="classllvm_1_1TargetMachine_html_a02aa9d4cbd6ffcc70dfe1143ec0995ef"><div class="ttname"><a href="classllvm_1_1TargetMachine.html#a02aa9d4cbd6ffcc70dfe1143ec0995ef">llvm::TargetMachine::getFrameLowering</a></div><div class="ttdeci">virtual const TargetFrameLowering * getFrameLowering() const </div><div class="ttdef"><b>Definition:</b> <a href="Target_2TargetMachine_8h_source.html#l00120">Target/TargetMachine.h:120</a></div></div>
<div class="ttc" id="classllvm_1_1TargetRegisterInfo_html"><div class="ttname"><a href="classllvm_1_1TargetRegisterInfo.html">llvm::TargetRegisterInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="TargetRegisterInfo_8h_source.html#l00219">TargetRegisterInfo.h:219</a></div></div>
<div class="ttc" id="classllvm_1_1MachineFrameInfo_html_a639df36670c77819b19f9bdec96634df"><div class="ttname"><a href="classllvm_1_1MachineFrameInfo.html#a639df36670c77819b19f9bdec96634df">llvm::MachineFrameInfo::isDeadObjectIndex</a></div><div class="ttdeci">bool isDeadObjectIndex(int ObjectIdx) const </div><div class="ttdef"><b>Definition:</b> <a href="MachineFrameInfo_8h_source.html#l00494">MachineFrameInfo.h:494</a></div></div>
<div class="ttc" id="Target_2README_8txt_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">i</div><div class="ttdef"><b>Definition:</b> <a href="Target_2README_8txt_source.html#l00029">Target/README.txt:29</a></div></div>
<div class="ttc" id="classllvm_1_1SmallVector_html"><div class="ttname"><a href="classllvm_1_1SmallVector.html">llvm::SmallVector</a></div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00880">SmallVector.h:880</a></div></div>
<div class="ttc" id="classllvm_1_1MachineFrameInfo_html_ae146d6827dae2ff77fc65b7fd319dbb8"><div class="ttname"><a href="classllvm_1_1MachineFrameInfo.html#ae146d6827dae2ff77fc65b7fd319dbb8">llvm::MachineFrameInfo::getObjectAlignment</a></div><div class="ttdeci">unsigned getObjectAlignment(int ObjectIdx) const </div><div class="ttdoc">getObjectAlignment - Return the alignment of the specified stack object. </div><div class="ttdef"><b>Definition:</b> <a href="MachineFrameInfo_8h_source.html#l00361">MachineFrameInfo.h:361</a></div></div>
<div class="ttc" id="Module_8h_html"><div class="ttname"><a href="Module_8h.html">Module.h</a></div></div>
<div class="ttc" id="classllvm_1_1TargetFrameLowering_html"><div class="ttname"><a href="classllvm_1_1TargetFrameLowering.html">llvm::TargetFrameLowering</a></div><div class="ttdef"><b>Definition:</b> <a href="TargetFrameLowering_8h_source.html#l00033">TargetFrameLowering.h:33</a></div></div>
<div class="ttc" id="classllvm_1_1MachineFunction_html_a4ad4295a88187ea1ae12ecfcfa18a70f"><div class="ttname"><a href="classllvm_1_1MachineFunction.html#a4ad4295a88187ea1ae12ecfcfa18a70f">llvm::MachineFunction::getFrameInfo</a></div><div class="ttdeci">MachineFrameInfo * getFrameInfo()</div><div class="ttdef"><b>Definition:</b> <a href="MachineFunction_8h_source.html#l00174">MachineFunction.h:174</a></div></div>
<div class="ttc" id="classllvm_1_1AnalysisUsage_html_af11a6ebf7ab3c388234cb6d5378439a3"><div class="ttname"><a href="classllvm_1_1AnalysisUsage.html#af11a6ebf7ab3c388234cb6d5378439a3">llvm::AnalysisUsage::setPreservesCFG</a></div><div class="ttdeci">void setPreservesCFG()</div><div class="ttdef"><b>Definition:</b> <a href="Pass_8cpp_source.html#l00249">Pass.cpp:249</a></div></div>
<div class="ttc" id="namespacellvm_html_a7c46c742c31be54870e2038048e6b391"><div class="ttname"><a href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">llvm::dbgs</a></div><div class="ttdeci">raw_ostream &amp; dbgs()</div><div class="ttdoc">dbgs - Return a circular-buffered debug stream. </div><div class="ttdef"><b>Definition:</b> <a href="Debug_8cpp_source.html#l00101">Debug.cpp:101</a></div></div>
<div class="ttc" id="PrologEpilogInserter_8cpp_html_a1ab21d9615f20889f7e34e7eae8a2ea1"><div class="ttname"><a href="PrologEpilogInserter_8cpp.html#a1ab21d9615f20889f7e34e7eae8a2ea1">AdjustStackOffset</a></div><div class="ttdeci">static void AdjustStackOffset(MachineFrameInfo *MFI, int FrameIdx, bool StackGrowsDown, int64_t &amp;Offset, unsigned &amp;MaxAlign)</div><div class="ttdoc">AdjustStackOffset - Helper function used to adjust the stack frame offset. </div><div class="ttdef"><b>Definition:</b> <a href="PrologEpilogInserter_8cpp_source.html#l00386">PrologEpilogInserter.cpp:386</a></div></div>
<div class="ttc" id="CodeGen_2README_8txt_html_a09776db24cf586ec9f1e18f3bae14099"><div class="ttname"><a href="CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a></div><div class="ttdeci">Common register allocation spilling lr str ldr sxth r3 ldr mla r4 can lr mov lr str ldr sxth r3 mla r4 and then merge mul and lr str ldr sxth r3 mla r4 It also increase the likelihood the store may become dead bb27 Successors according to LLVM BB</div><div class="ttdef"><b>Definition:</b> <a href="CodeGen_2README_8txt_source.html#l00036">CodeGen/README.txt:36</a></div></div>
<div class="ttc" id="Pass_8h_html"><div class="ttname"><a href="Pass_8h.html">Pass.h</a></div></div>
<div class="ttc" id="classllvm_1_1MachineFrameInfo_html_a6448cb3cdaa64545e60f2c6981dd2ea7"><div class="ttname"><a href="classllvm_1_1MachineFrameInfo.html#a6448cb3cdaa64545e60f2c6981dd2ea7">llvm::MachineFrameInfo::getStackProtectorIndex</a></div><div class="ttdeci">int getStackProtectorIndex() const </div><div class="ttdef"><b>Definition:</b> <a href="MachineFrameInfo_8h_source.html#l00259">MachineFrameInfo.h:259</a></div></div>
<div class="ttc" id="TargetFrameLowering_8h_html"><div class="ttname"><a href="TargetFrameLowering_8h.html">TargetFrameLowering.h</a></div></div>
<div class="ttc" id="classllvm_1_1SmallVectorTemplateCommon_html_a8a045d250952c0867382a9840ee18fdf"><div class="ttname"><a href="classllvm_1_1SmallVectorTemplateCommon.html#a8a045d250952c0867382a9840ee18fdf">llvm::SmallVectorTemplateCommon&lt; T &gt;::begin</a></div><div class="ttdeci">iterator begin()</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00112">SmallVector.h:112</a></div></div>
<div class="ttc" id="classllvm_1_1SmallSet_html_ab28aa342862f6d16361be514fd98c22e"><div class="ttname"><a href="classllvm_1_1SmallSet.html#ab28aa342862f6d16361be514fd98c22e">llvm::SmallSet::count</a></div><div class="ttdeci">bool count(const T &amp;V) const </div><div class="ttdoc">count - Return true if the element is in the set. </div><div class="ttdef"><b>Definition:</b> <a href="SmallSet_8h_source.html#l00048">SmallSet.h:48</a></div></div>
<div class="ttc" id="MachineRegisterInfo_8h_html"><div class="ttname"><a href="MachineRegisterInfo_8h.html">MachineRegisterInfo.h</a></div></div>
<div class="ttc" id="classllvm_1_1MachineInstr_html"><div class="ttname"><a href="classllvm_1_1MachineInstr.html">llvm::MachineInstr</a></div><div class="ttdef"><b>Definition:</b> <a href="MachineInstr_8h_source.html#l00050">MachineInstr.h:50</a></div></div>
<div class="ttc" id="classllvm_1_1TargetFrameLowering_html_a8859c022d80a9f4ff145bc175481a493"><div class="ttname"><a href="classllvm_1_1TargetFrameLowering.html#a8859c022d80a9f4ff145bc175481a493">llvm::TargetFrameLowering::getStackGrowthDirection</a></div><div class="ttdeci">StackDirection getStackGrowthDirection() const </div><div class="ttdef"><b>Definition:</b> <a href="TargetFrameLowering_8h_source.html#l00064">TargetFrameLowering.h:64</a></div></div>
<div class="ttc" id="classllvm_1_1MachineOperand_html_ac9485ae7d6fedd71ad4460f72c799c98"><div class="ttname"><a href="classllvm_1_1MachineOperand.html#ac9485ae7d6fedd71ad4460f72c799c98">llvm::MachineOperand::getIndex</a></div><div class="ttdeci">int getIndex() const </div><div class="ttdef"><b>Definition:</b> <a href="MachineOperand_8h_source.html#l00422">MachineOperand.h:422</a></div></div>
<div class="ttc" id="classllvm_1_1TargetRegisterInfo_html_adb2ad0d16e2091a054427ae1c399ad8f"><div class="ttname"><a href="classllvm_1_1TargetRegisterInfo.html#adb2ad0d16e2091a054427ae1c399ad8f">llvm::TargetRegisterInfo::needsFrameBaseReg</a></div><div class="ttdeci">virtual bool needsFrameBaseReg(MachineInstr *MI, int64_t Offset) const </div><div class="ttdef"><b>Definition:</b> <a href="TargetRegisterInfo_8h_source.html#l00736">TargetRegisterInfo.h:736</a></div></div>
<div class="ttc" id="classllvm_1_1TargetRegisterInfo_html_a24d7d13a35348f2576a8fac1367b8f34"><div class="ttname"><a href="classllvm_1_1TargetRegisterInfo.html#a24d7d13a35348f2576a8fac1367b8f34">llvm::TargetRegisterInfo::isFrameOffsetLegal</a></div><div class="ttdeci">virtual bool isFrameOffsetLegal(const MachineInstr *MI, int64_t Offset) const </div><div class="ttdef"><b>Definition:</b> <a href="TargetRegisterInfo_8h_source.html#l00758">TargetRegisterInfo.h:758</a></div></div>
<div class="ttc" id="classllvm_1_1MachineFunction_html_ab4a6ca428289b667dd691a00e9f7e334"><div class="ttname"><a href="classllvm_1_1MachineFunction.html#ab4a6ca428289b667dd691a00e9f7e334">llvm::MachineFunction::getRegInfo</a></div><div class="ttdeci">MachineRegisterInfo &amp; getRegInfo()</div><div class="ttdef"><b>Definition:</b> <a href="MachineFunction_8h_source.html#l00167">MachineFunction.h:167</a></div></div>
<div class="ttc" id="Intrinsics_8h_html"><div class="ttname"><a href="Intrinsics_8h.html">Intrinsics.h</a></div></div>
<div class="ttc" id="classllvm_1_1MachineFunctionPass_html_aa1eece37d175f86a6f4808c0c167f13b"><div class="ttname"><a href="classllvm_1_1MachineFunctionPass.html#aa1eece37d175f86a6f4808c0c167f13b">llvm::MachineFunctionPass::getAnalysisUsage</a></div><div class="ttdeci">virtual void getAnalysisUsage(AnalysisUsage &amp;AU) const </div><div class="ttdef"><b>Definition:</b> <a href="MachineFunctionPass_8cpp_source.html#l00036">MachineFunctionPass.cpp:36</a></div></div>
<div class="ttc" id="TargetRegisterInfo_8h_html"><div class="ttname"><a href="TargetRegisterInfo_8h.html">TargetRegisterInfo.h</a></div></div>
<div class="ttc" id="MD5_8cpp_html_ac0eafdc9ee161b71e7af98af736952fd"><div class="ttname"><a href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a></div><div class="ttdeci">#define I(x, y, z)</div><div class="ttdef"><b>Definition:</b> <a href="MD5_8cpp_source.html#l00054">MD5.cpp:54</a></div></div>
<div class="ttc" id="classllvm_1_1MachineFunction_html_a6745c3bfdfc5b0643b078b96df2db252"><div class="ttname"><a href="classllvm_1_1MachineFunction.html#a6745c3bfdfc5b0643b078b96df2db252">llvm::MachineFunction::getTarget</a></div><div class="ttdeci">const TargetMachine &amp; getTarget() const </div><div class="ttdef"><b>Definition:</b> <a href="MachineFunction_8h_source.html#l00163">MachineFunction.h:163</a></div></div>
<div class="ttc" id="classllvm_1_1TargetMachine_html_a70b47eca6a99c87b81f4c1b1455dc090"><div class="ttname"><a href="classllvm_1_1TargetMachine.html#a70b47eca6a99c87b81f4c1b1455dc090">llvm::TargetMachine::getRegisterInfo</a></div><div class="ttdeci">virtual const TargetRegisterInfo * getRegisterInfo() const </div><div class="ttdef"><b>Definition:</b> <a href="Target_2TargetMachine_8h_source.html#l00140">Target/TargetMachine.h:140</a></div></div>
<div class="ttc" id="LLVMContext_8h_html"><div class="ttname"><a href="LLVMContext_8h.html">LLVMContext.h</a></div></div>
<div class="ttc" id="ARMSubtarget_8cpp_html_a4bd80d4e433d9f72af26b364036900dc"><div class="ttname"><a href="ARMSubtarget_8cpp.html#a4bd80d4e433d9f72af26b364036900dc">Align</a></div><div class="ttdeci">static cl::opt&lt; AlignMode &gt; Align(cl::desc(&quot;Load/store alignment support&quot;), cl::Hidden, cl::init(DefaultAlign), cl::values(clEnumValN(DefaultAlign,&quot;arm-default-align&quot;,&quot;Generate unaligned accesses only on hardware/OS &quot;&quot;combinations that are known to support them&quot;), clEnumValN(StrictAlign,&quot;arm-strict-align&quot;,&quot;Disallow all unaligned memory accesses&quot;), clEnumValN(NoStrictAlign,&quot;arm-no-strict-align&quot;,&quot;Allow unaligned memory accesses&quot;), clEnumValEnd))</div></div>
<div class="ttc" id="MachineFunctionPass_8h_html"><div class="ttname"><a href="MachineFunctionPass_8h.html">MachineFunctionPass.h</a></div></div>
<div class="ttc" id="namespacellvm_1_1A64CC_html_af5804bc0518be9568f73db566e4d6f46a2db5e7546f960277ff98f96cd5624442"><div class="ttname"><a href="namespacellvm_1_1A64CC.html#af5804bc0518be9568f73db566e4d6f46a2db5e7546f960277ff98f96cd5624442">llvm::A64CC::MI</a></div><div class="ttdef"><b>Definition:</b> <a href="AArch64BaseInfo_8h_source.html#l00035">AArch64BaseInfo.h:35</a></div></div>
<div class="ttc" id="classllvm_1_1MachineFunction_html_a340712de3e78fec11c338735cab17df7"><div class="ttname"><a href="classllvm_1_1MachineFunction.html#a340712de3e78fec11c338735cab17df7">llvm::MachineFunction::iterator</a></div><div class="ttdeci">BasicBlockListType::iterator iterator</div><div class="ttdef"><b>Definition:</b> <a href="MachineFunction_8h_source.html#l00303">MachineFunction.h:303</a></div></div>
<div class="ttc" id="Debug_8h_html_aef41e8aaf4c60819b30faf396cdf4978"><div class="ttname"><a href="Debug_8h.html#aef41e8aaf4c60819b30faf396cdf4978">DEBUG</a></div><div class="ttdeci">#define DEBUG(X)</div><div class="ttdef"><b>Definition:</b> <a href="Debug_8h_source.html#l00097">Debug.h:97</a></div></div>
<div class="ttc" id="classllvm_1_1TargetFrameLowering_html_a453c74e2daac0745b53f8b31c11fc50cad1fc7c9d0bae5bf76a67d2d26ce99c1a"><div class="ttname"><a href="classllvm_1_1TargetFrameLowering.html#a453c74e2daac0745b53f8b31c11fc50cad1fc7c9d0bae5bf76a67d2d26ce99c1a">llvm::TargetFrameLowering::StackGrowsDown</a></div><div class="ttdef"><b>Definition:</b> <a href="TargetFrameLowering_8h_source.html#l00037">TargetFrameLowering.h:37</a></div></div>
<div class="ttc" id="raw__ostream_8h_html"><div class="ttname"><a href="raw__ostream_8h.html">raw_ostream.h</a></div></div>
<div class="ttc" id="classllvm_1_1MachineFrameInfo_html_ab127d56f832dc4400f58707a37ed5c6b"><div class="ttname"><a href="classllvm_1_1MachineFrameInfo.html#ab127d56f832dc4400f58707a37ed5c6b">llvm::MachineFrameInfo::getObjectIndexEnd</a></div><div class="ttdeci">int getObjectIndexEnd() const </div><div class="ttdef"><b>Definition:</b> <a href="MachineFrameInfo_8h_source.html#l00285">MachineFrameInfo.h:285</a></div></div>
<div class="ttc" id="CodeGen_2Passes_8h_html"><div class="ttname"><a href="CodeGen_2Passes_8h.html">Passes.h</a></div></div>
<div class="ttc" id="namespacellvm_html_adfe6b8951666ab7bb35ee3ca5a078937"><div class="ttname"><a href="namespacellvm.html#adfe6b8951666ab7bb35ee3ca5a078937">llvm::LocalStackSlotAllocationID</a></div><div class="ttdeci">char &amp; LocalStackSlotAllocationID</div><div class="ttdef"><b>Definition:</b> <a href="LocalStackSlotAllocation_8cpp_source.html#l00083">LocalStackSlotAllocation.cpp:83</a></div></div>
<div class="ttc" id="classllvm_1_1TargetRegisterInfo_html_a0b3a814040f5e721a08d8b9b277b3fec"><div class="ttname"><a href="classllvm_1_1TargetRegisterInfo.html#a0b3a814040f5e721a08d8b9b277b3fec">llvm::TargetRegisterInfo::getPointerRegClass</a></div><div class="ttdeci">virtual const TargetRegisterClass * getPointerRegClass(const MachineFunction &amp;MF, unsigned Kind=0) const </div><div class="ttdef"><b>Definition:</b> <a href="TargetRegisterInfo_8h_source.html#l00574">TargetRegisterInfo.h:574</a></div></div>
<div class="ttc" id="classllvm_1_1MachineFrameInfo_html_a43386af65581b8de506f3b57ba6c05b0"><div class="ttname"><a href="classllvm_1_1MachineFrameInfo.html#a43386af65581b8de506f3b57ba6c05b0">llvm::MachineFrameInfo::getObjectSize</a></div><div class="ttdeci">int64_t getObjectSize(int ObjectIdx) const </div><div class="ttdef"><b>Definition:</b> <a href="MachineFrameInfo_8h_source.html#l00347">MachineFrameInfo.h:347</a></div></div>
<div class="ttc" id="classllvm_1_1MachineFrameInfo_html_acc15f1c24b0824ee929a256a61a53423"><div class="ttname"><a href="classllvm_1_1MachineFrameInfo.html#acc15f1c24b0824ee929a256a61a53423">llvm::MachineFrameInfo::MayNeedStackProtector</a></div><div class="ttdeci">bool MayNeedStackProtector(int ObjectIdx) const </div><div class="ttdef"><b>Definition:</b> <a href="MachineFrameInfo_8h_source.html#l00385">MachineFrameInfo.h:385</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<hr>
<p class="footer">
Generated on Sat Nov 10 2018 22:59:26 for <a href="http://llvm.org/">LLVM</a> by
<a href="http://www.doxygen.org"><img src="doxygen.png" alt="Doxygen"
align="middle" border="0"/>1.8.11</a><br>
Copyright &copy; 2003-2013 University of Illinois at Urbana-Champaign.
All Rights Reserved.</p>
<hr>
<!--#include virtual="/attrib.incl" -->
</body>
</html>
