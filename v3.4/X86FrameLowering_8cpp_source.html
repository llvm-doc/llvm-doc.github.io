<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head>
<meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1"/>
<meta name="keywords" content="LLVM,Low Level Virtual Machine,C++,doxygen,API,documentation"/>
<meta name="description" content="C++ source code API documentation for LLVM."/>
<title>LLVM: X86FrameLowering.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head><body>
<p class="title">LLVM API Documentation</p>
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('X86FrameLowering_8cpp_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">X86FrameLowering.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="X86FrameLowering_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//===-- X86FrameLowering.cpp - X86 Frame Information ----------------------===//</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">//                     The LLVM Compiler Infrastructure</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// This file is distributed under the University of Illinois Open Source</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">// License. See LICENSE.TXT for details.</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">// This file contains the X86 implementation of TargetFrameLowering class.</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="X86FrameLowering_8h.html">X86FrameLowering.h</a>&quot;</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="X86InstrBuilder_8h.html">X86InstrBuilder.h</a>&quot;</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="X86InstrInfo_8h.html">X86InstrInfo.h</a>&quot;</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="X86MachineFunctionInfo_8h.html">X86MachineFunctionInfo.h</a>&quot;</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="X86Subtarget_8h.html">X86Subtarget.h</a>&quot;</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="X86TargetMachine_8h.html">X86TargetMachine.h</a>&quot;</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="SmallSet_8h.html">llvm/ADT/SmallSet.h</a>&quot;</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="MachineFrameInfo_8h.html">llvm/CodeGen/MachineFrameInfo.h</a>&quot;</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="MachineFunction_8h.html">llvm/CodeGen/MachineFunction.h</a>&quot;</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="MachineInstrBuilder_8h.html">llvm/CodeGen/MachineInstrBuilder.h</a>&quot;</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="MachineModuleInfo_8h.html">llvm/CodeGen/MachineModuleInfo.h</a>&quot;</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="MachineRegisterInfo_8h.html">llvm/CodeGen/MachineRegisterInfo.h</a>&quot;</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="DataLayout_8h.html">llvm/IR/DataLayout.h</a>&quot;</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Function_8h.html">llvm/IR/Function.h</a>&quot;</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="MCAsmInfo_8h.html">llvm/MC/MCAsmInfo.h</a>&quot;</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="MCSymbol_8h.html">llvm/MC/MCSymbol.h</a>&quot;</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="CommandLine_8h.html">llvm/Support/CommandLine.h</a>&quot;</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TargetOptions_8h.html">llvm/Target/TargetOptions.h</a>&quot;</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespacellvm.html">llvm</a>;</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">// FIXME: completely move here.</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="keyword">extern</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;bool&gt;</a> <a class="code" href="X86FrameLowering_8cpp.html#a492c99600e7544adc30763004b289a6b">ForceStackAlign</a>;</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;</div><div class="line"><a name="l00038"></a><span class="lineno"><a class="line" href="classllvm_1_1X86FrameLowering.html#a63ad28e4eca30cc88163e78e90974e7e">   38</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classllvm_1_1X86FrameLowering.html#a63ad28e4eca30cc88163e78e90974e7e">X86FrameLowering::hasReservedCallFrame</a>(<span class="keyword">const</span> <a class="code" href="classllvm_1_1MachineFunction.html">MachineFunction</a> &amp;MF)<span class="keyword"> const </span>{</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  <span class="keywordflow">return</span> !MF.<a class="code" href="classllvm_1_1MachineFunction.html#a4ad4295a88187ea1ae12ecfcfa18a70f">getFrameInfo</a>()-&gt;<a class="code" href="classllvm_1_1MachineFrameInfo.html#a5cd76eb2aeed3ae46da1bb1b132f1831">hasVarSizedObjects</a>();</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;}</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">/// hasFP - Return true if the specified function should have a dedicated frame</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">/// pointer register.  This is true if the function has variable sized allocas</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">/// or if frame pointer elimination is disabled.</span></div><div class="line"><a name="l00045"></a><span class="lineno"><a class="line" href="classllvm_1_1X86FrameLowering.html#a649e4f2412bff7a236d44c0c52982640">   45</a></span>&#160;<span class="comment"></span><span class="keywordtype">bool</span> <a class="code" href="classllvm_1_1X86FrameLowering.html#a649e4f2412bff7a236d44c0c52982640">X86FrameLowering::hasFP</a>(<span class="keyword">const</span> <a class="code" href="classllvm_1_1MachineFunction.html">MachineFunction</a> &amp;MF)<span class="keyword"> const </span>{</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1MachineFrameInfo.html">MachineFrameInfo</a> *MFI = MF.<a class="code" href="classllvm_1_1MachineFunction.html#a4ad4295a88187ea1ae12ecfcfa18a70f">getFrameInfo</a>();</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1MachineModuleInfo.html">MachineModuleInfo</a> &amp;MMI = MF.<a class="code" href="classllvm_1_1MachineFunction.html#aaaa58853344cccb2ae6dcecea4ee54ad">getMMI</a>();</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetRegisterInfo.html">TargetRegisterInfo</a> *RegInfo = TM.<a class="code" href="classllvm_1_1X86TargetMachine.html#a350524cf8e1e0e53a6d856188d851ec4">getRegisterInfo</a>();</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  <span class="keywordflow">return</span> (MF.<a class="code" href="classllvm_1_1MachineFunction.html#a6745c3bfdfc5b0643b078b96df2db252">getTarget</a>().<a class="code" href="classllvm_1_1TargetMachine.html#ab1fb67187fc37e569cc5171cbebba873">Options</a>.<a class="code" href="classllvm_1_1TargetOptions.html#a55b913089f1134db4cc1ea6e677c62bd">DisableFramePointerElim</a>(MF) ||</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;          RegInfo-&gt;<a class="code" href="classllvm_1_1TargetRegisterInfo.html#adf8e30b3e759b1283c5fbda668190ee6">needsStackRealignment</a>(MF) ||</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;          MFI-&gt;<a class="code" href="classllvm_1_1MachineFrameInfo.html#a5cd76eb2aeed3ae46da1bb1b132f1831">hasVarSizedObjects</a>() ||</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;          MFI-&gt;<a class="code" href="classllvm_1_1MachineFrameInfo.html#a48b4b361d757d1ab48f783b8875712c1">isFrameAddressTaken</a>() || MF.<a class="code" href="classllvm_1_1MachineFunction.html#ad5910eeb61f9d3942b970d1908375388">hasMSInlineAsm</a>() ||</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;          MF.<a class="code" href="classllvm_1_1MachineFunction.html#ac2dc0fa143c9f2127f0501734577a0a0">getInfo</a>&lt;<a class="code" href="classllvm_1_1X86MachineFunctionInfo.html">X86MachineFunctionInfo</a>&gt;()-&gt;getForceFramePointer() ||</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;          MMI.<a class="code" href="classllvm_1_1MachineModuleInfo.html#a6a7c50253021a755fe344738806e7f32">callsUnwindInit</a>() || MMI.<a class="code" href="classllvm_1_1MachineModuleInfo.html#adde6ff7fd9afa7c46ccc8b2ac4ebd31a">callsEHReturn</a>());</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;}</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;</div><div class="line"><a name="l00058"></a><span class="lineno"><a class="line" href="X86FrameLowering_8cpp.html#a277b1c0324a7229d31f3eeff08311411">   58</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">unsigned</span> <a class="code" href="X86FrameLowering_8cpp.html#a277b1c0324a7229d31f3eeff08311411">getSUBriOpcode</a>(<span class="keywordtype">unsigned</span> IsLP64, int64_t Imm) {</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  <span class="keywordflow">if</span> (IsLP64) {</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#a3e242f3485db990d043f2dcf91106ce7">isInt&lt;8&gt;</a>(Imm))</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;      <span class="keywordflow">return</span> X86::SUB64ri8;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="keywordflow">return</span> X86::SUB64ri32;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#a3e242f3485db990d043f2dcf91106ce7">isInt&lt;8&gt;</a>(Imm))</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;      <span class="keywordflow">return</span> X86::SUB32ri8;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="keywordflow">return</span> X86::SUB32ri;</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  }</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;}</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;</div><div class="line"><a name="l00070"></a><span class="lineno"><a class="line" href="X86FrameLowering_8cpp.html#aa7b08d583ef6aae95b4a2c5d46d96d48">   70</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">unsigned</span> <a class="code" href="X86FrameLowering_8cpp.html#aa7b08d583ef6aae95b4a2c5d46d96d48">getADDriOpcode</a>(<span class="keywordtype">unsigned</span> IsLP64, int64_t Imm) {</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  <span class="keywordflow">if</span> (IsLP64) {</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#a3e242f3485db990d043f2dcf91106ce7">isInt&lt;8&gt;</a>(Imm))</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;      <span class="keywordflow">return</span> X86::ADD64ri8;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <span class="keywordflow">return</span> X86::ADD64ri32;</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#a3e242f3485db990d043f2dcf91106ce7">isInt&lt;8&gt;</a>(Imm))</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;      <span class="keywordflow">return</span> X86::ADD32ri8;</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="keywordflow">return</span> X86::ADD32ri;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  }</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;}</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;</div><div class="line"><a name="l00082"></a><span class="lineno"><a class="line" href="X86FrameLowering_8cpp.html#a343c24d09ffb2fe5a9d302d2c2e5a9c5">   82</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">unsigned</span> <a class="code" href="X86FrameLowering_8cpp.html#a343c24d09ffb2fe5a9d302d2c2e5a9c5">getLEArOpcode</a>(<span class="keywordtype">unsigned</span> IsLP64) {</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  <span class="keywordflow">return</span> IsLP64 ? X86::LEA64r : X86::LEA32r;</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;}</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">/// findDeadCallerSavedReg - Return a caller-saved register that isn&#39;t live</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment">/// when it reaches the &quot;return&quot; instruction. We can then pop a stack object</span></div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment">/// to this register without worry about clobbering it.</span></div><div class="line"><a name="l00089"></a><span class="lineno"><a class="line" href="X86FrameLowering_8cpp.html#a989e9805774ba0c66cd1554a66a7a782">   89</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">unsigned</span> <a class="code" href="X86FrameLowering_8cpp.html#a989e9805774ba0c66cd1554a66a7a782">findDeadCallerSavedReg</a>(<a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> &amp;MBB,</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;                                       <a class="code" href="classllvm_1_1MachineBasicBlock.html#ac51be7ff80fe8d6ae5e8c0acb194908a">MachineBasicBlock::iterator</a> &amp;MBBI,</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;                                       <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetRegisterInfo.html">TargetRegisterInfo</a> &amp;TRI,</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;                                       <span class="keywordtype">bool</span> Is64Bit) {</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1MachineFunction.html">MachineFunction</a> *MF = MBB.<a class="code" href="classllvm_1_1MachineBasicBlock.html#af2e482ff2a9253ec6bc2285491496bd6">getParent</a>();</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1Function.html">Function</a> *<a class="code" href="LLParser_8cpp.html#a33ece1ef8074506a15d7f86eb76dbae6">F</a> = MF-&gt;<a class="code" href="classllvm_1_1MachineFunction.html#ad784a6594990530bffb2018aeeed56f3">getFunction</a>();</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  <span class="keywordflow">if</span> (!F || MF-&gt;<a class="code" href="classllvm_1_1MachineFunction.html#aaaa58853344cccb2ae6dcecea4ee54ad">getMMI</a>().<a class="code" href="classllvm_1_1MachineModuleInfo.html#adde6ff7fd9afa7c46ccc8b2ac4ebd31a">callsEHReturn</a>())</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> uint16_t CallerSavedRegs32Bit[] = {</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <a class="code" href="README-SSE_8txt.html#abd9c765b9afafff59eb14d50c9e9fba1">X86::EAX</a>, <a class="code" href="README-SSE_8txt.html#aafb0a6c62a7cfe1538db1d20d759a34b">X86::EDX</a>, <a class="code" href="namespacellvm_1_1N86.html#a154c9f74eba4608c7d1b656eb025a96da667b758702693d9dfb46e55025fc559d">X86::ECX</a>, 0</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  };</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> uint16_t CallerSavedRegs64Bit[] = {</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    X86::RAX, X86::RDX, X86::RCX, X86::RSI, X86::RDI,</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    X86::R8,  X86::R9,  X86::R10, X86::R11, 0</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  };</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  <span class="keywordtype">unsigned</span> Opc = MBBI-&gt;getOpcode();</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  <span class="keywordflow">switch</span> (Opc) {</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  <span class="keywordflow">default</span>: <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  <span class="keywordflow">case</span> X86::RET:</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  <span class="keywordflow">case</span> X86::RETI:</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  <span class="keywordflow">case</span> X86::TCRETURNdi:</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <span class="keywordflow">case</span> X86::TCRETURNri:</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  <span class="keywordflow">case</span> X86::TCRETURNmi:</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  <span class="keywordflow">case</span> X86::TCRETURNdi64:</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  <span class="keywordflow">case</span> X86::TCRETURNri64:</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  <span class="keywordflow">case</span> X86::TCRETURNmi64:</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a4edf35e2383003ff20057e5a45012a55">X86::EH_RETURN</a>:</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  <span class="keywordflow">case</span> X86::EH_RETURN64: {</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <a class="code" href="classllvm_1_1SmallSet.html">SmallSet&lt;uint16_t, 8&gt;</a> Uses;</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0, e = MBBI-&gt;getNumOperands(); <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != e; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;      <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;MO = MBBI-&gt;getOperand(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;      <span class="keywordflow">if</span> (!MO.<a class="code" href="classllvm_1_1MachineOperand.html#ad8198d6d83af9410d867136e33fbf4b2">isReg</a>() || MO.<a class="code" href="classllvm_1_1MachineOperand.html#a8de7d5cf38939044471c6ee60a01a3df">isDef</a>())</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;      <span class="keywordtype">unsigned</span> <a class="code" href="X86DisassemblerDecoder_8h.html#a546839a5c4bcf9f9450967155f48de41">Reg</a> = MO.<a class="code" href="classllvm_1_1MachineOperand.html#ab75f703d251cc0ce0206fe00a999db86">getReg</a>();</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;      <span class="keywordflow">if</span> (!Reg)</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1MCRegAliasIterator.html">MCRegAliasIterator</a> AI(Reg, &amp;TRI, <span class="keyword">true</span>); AI.<a class="code" href="classllvm_1_1MCRegAliasIterator.html#abf2eadac3ea84e2e2739444c40421eac">isValid</a>(); ++AI)</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        Uses.<a class="code" href="classllvm_1_1SmallSet.html#a8d8348060ccdeeba13fb8bc651dfbf82">insert</a>(*AI);</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    }</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="keyword">const</span> uint16_t *CS = Is64Bit ? CallerSavedRegs64Bit : CallerSavedRegs32Bit;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <span class="keywordflow">for</span> (; *CS; ++CS)</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;      <span class="keywordflow">if</span> (!Uses.<a class="code" href="classllvm_1_1SmallSet.html#ab28aa342862f6d16361be514fd98c22e">count</a>(*CS))</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        <span class="keywordflow">return</span> *CS;</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  }</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  }</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;}</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment">/// emitSPUpdate - Emit a series of instructions to increment / decrement the</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment">/// stack pointer by a constant value.</span></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment"></span><span class="keyword">static</span></div><div class="line"><a name="l00146"></a><span class="lineno"><a class="line" href="X86FrameLowering_8cpp.html#a6c218a8841161755ec267b6a6a3cd0e0">  146</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespacellvm.html#affbfd713b02cc594a29424c8f41b2815">emitSPUpdate</a>(<a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> &amp;MBB, <a class="code" href="classllvm_1_1MachineBasicBlock.html#ac51be7ff80fe8d6ae5e8c0acb194908a">MachineBasicBlock::iterator</a> &amp;MBBI,</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;                  <span class="keywordtype">unsigned</span> StackPtr, int64_t NumBytes,</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                  <span class="keywordtype">bool</span> Is64Bit, <span class="keywordtype">bool</span> IsLP64, <span class="keywordtype">bool</span> UseLEA,</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;                  <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetInstrInfo.html">TargetInstrInfo</a> &amp;<a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>, <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetRegisterInfo.html">TargetRegisterInfo</a> &amp;TRI) {</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  <span class="keywordtype">bool</span> isSub = NumBytes &lt; 0;</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  uint64_t Offset = isSub ? -NumBytes : NumBytes;</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  <span class="keywordtype">unsigned</span> Opc;</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  <span class="keywordflow">if</span> (UseLEA)</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    Opc = <a class="code" href="X86FrameLowering_8cpp.html#a343c24d09ffb2fe5a9d302d2c2e5a9c5">getLEArOpcode</a>(IsLP64);</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    Opc = isSub</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;      ? <a class="code" href="X86FrameLowering_8cpp.html#a277b1c0324a7229d31f3eeff08311411">getSUBriOpcode</a>(IsLP64, Offset)</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;      : <a class="code" href="X86FrameLowering_8cpp.html#aa7b08d583ef6aae95b4a2c5d46d96d48">getADDriOpcode</a>(IsLP64, Offset);</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  uint64_t Chunk = (1LL &lt;&lt; 31) - 1;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  <a class="code" href="classllvm_1_1DebugLoc.html">DebugLoc</a> DL = MBB.<a class="code" href="classllvm_1_1MachineBasicBlock.html#a45028d169700cac71cf6c613a94236ee">findDebugLoc</a>(MBBI);</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  <span class="keywordflow">while</span> (Offset) {</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    uint64_t ThisVal = (Offset &gt; Chunk) ? Chunk : Offset;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="keywordflow">if</span> (ThisVal == (Is64Bit ? 8 : 4)) {</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;      <span class="comment">// Use push / pop instead.</span></div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;      <span class="keywordtype">unsigned</span> <a class="code" href="X86DisassemblerDecoder_8h.html#a546839a5c4bcf9f9450967155f48de41">Reg</a> = isSub</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        ? (unsigned)(Is64Bit ? X86::RAX : <a class="code" href="README-SSE_8txt.html#abd9c765b9afafff59eb14d50c9e9fba1">X86::EAX</a>)</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        : <a class="code" href="X86FrameLowering_8cpp.html#a989e9805774ba0c66cd1554a66a7a782">findDeadCallerSavedReg</a>(MBB, MBBI, TRI, Is64Bit);</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;      <span class="keywordflow">if</span> (Reg) {</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        Opc = isSub</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;          ? (Is64Bit ? X86::PUSH64r : X86::PUSH32r)</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;          : (Is64Bit ? X86::POP64r  : X86::POP32r);</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *<a class="code" href="namespacellvm_1_1A64CC.html#af5804bc0518be9568f73db566e4d6f46a2db5e7546f960277ff98f96cd5624442">MI</a> = <a class="code" href="namespacellvm.html#a980570dc1410d4ef53806f82028ca381">BuildMI</a>(MBB, MBBI, DL, TII.<a class="code" href="classllvm_1_1MCInstrInfo.html#ab16f5a81fccfe4b7f645ba5a74ffad02">get</a>(Opc))</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;          .addReg(Reg, <a class="code" href="namespacellvm.html#aa5e4d7acf58e87826a15b94d37144f2b">getDefRegState</a>(!isSub) | <a class="code" href="namespacellvm.html#aa3a1f79eb5e89f41ad5a3d8e9b2a367a">getUndefRegState</a>(isSub));</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        <span class="keywordflow">if</span> (isSub)</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;          MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#aba86b0738c2ab2a52688b846c45bfe59">setFlag</a>(<a class="code" href="classllvm_1_1MachineInstr.html#aafacf84de1cb994a92dc045f4aa1d518a78f1067d270179dff7915b90a03ce237">MachineInstr::FrameSetup</a>);</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        Offset -= ThisVal;</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;      }</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    }</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *<a class="code" href="namespacellvm_1_1A64CC.html#af5804bc0518be9568f73db566e4d6f46a2db5e7546f960277ff98f96cd5624442">MI</a> = NULL;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="keywordflow">if</span> (UseLEA) {</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;      MI =  <a class="code" href="namespacellvm.html#afad63f3314b8553ee3c26d020b3ce09e">addRegOffset</a>(<a class="code" href="namespacellvm.html#a980570dc1410d4ef53806f82028ca381">BuildMI</a>(MBB, MBBI, DL, TII.<a class="code" href="classllvm_1_1MCInstrInfo.html#ab16f5a81fccfe4b7f645ba5a74ffad02">get</a>(Opc), StackPtr),</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;                          StackPtr, <span class="keyword">false</span>, isSub ? -ThisVal : ThisVal);</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;      MI = <a class="code" href="namespacellvm.html#a980570dc1410d4ef53806f82028ca381">BuildMI</a>(MBB, MBBI, DL, TII.<a class="code" href="classllvm_1_1MCInstrInfo.html#ab16f5a81fccfe4b7f645ba5a74ffad02">get</a>(Opc), StackPtr)</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;            .addReg(StackPtr)</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;            .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a9f1fae6a5dbb6e378ca85df1fded8515">addImm</a>(ThisVal);</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;      MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a302e45878c6dc1714334c7ce96d56846">getOperand</a>(3).<a class="code" href="classllvm_1_1MachineOperand.html#a61a42c85bd86c6ca4554e27d33c3f798">setIsDead</a>(); <span class="comment">// The EFLAGS implicit def is dead.</span></div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    }</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="keywordflow">if</span> (isSub)</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;      MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#aba86b0738c2ab2a52688b846c45bfe59">setFlag</a>(<a class="code" href="classllvm_1_1MachineInstr.html#aafacf84de1cb994a92dc045f4aa1d518a78f1067d270179dff7915b90a03ce237">MachineInstr::FrameSetup</a>);</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    Offset -= ThisVal;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  }</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;}</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment">/// mergeSPUpdatesUp - Merge two stack-manipulating instructions upper iterator.</span></div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment"></span><span class="keyword">static</span></div><div class="line"><a name="l00204"></a><span class="lineno"><a class="line" href="X86FrameLowering_8cpp.html#aa371140d370a73e4d67cf70697b459a3">  204</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="X86FrameLowering_8cpp.html#aa371140d370a73e4d67cf70697b459a3">mergeSPUpdatesUp</a>(<a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> &amp;MBB, <a class="code" href="classllvm_1_1MachineBasicBlock.html#ac51be7ff80fe8d6ae5e8c0acb194908a">MachineBasicBlock::iterator</a> &amp;MBBI,</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                      <span class="keywordtype">unsigned</span> StackPtr, uint64_t *NumBytes = NULL) {</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  <span class="keywordflow">if</span> (MBBI == MBB.<a class="code" href="classllvm_1_1MachineBasicBlock.html#ab2d91e7bec944efcbc39d8e30644f111">begin</a>()) <span class="keywordflow">return</span>;</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;  <a class="code" href="classllvm_1_1MachineBasicBlock.html#ac51be7ff80fe8d6ae5e8c0acb194908a">MachineBasicBlock::iterator</a> PI = <a class="code" href="namespacellvm.html#a7923e3e207de8bc1d0d6a5091316ddde">prior</a>(MBBI);</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  <span class="keywordtype">unsigned</span> Opc = PI-&gt;getOpcode();</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  <span class="keywordflow">if</span> ((Opc == X86::ADD64ri32 || Opc == X86::ADD64ri8 ||</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;       Opc == X86::ADD32ri || Opc == X86::ADD32ri8 ||</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;       Opc == X86::LEA32r || Opc == X86::LEA64_32r) &amp;&amp;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;      PI-&gt;getOperand(0).getReg() == StackPtr) {</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <span class="keywordflow">if</span> (NumBytes)</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;      *NumBytes += PI-&gt;getOperand(2).getImm();</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    MBB.<a class="code" href="classllvm_1_1MachineBasicBlock.html#a537a9265c55392ab47d44954f27db538">erase</a>(PI);</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((Opc == X86::SUB64ri32 || Opc == X86::SUB64ri8 ||</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;              Opc == X86::SUB32ri || Opc == X86::SUB32ri8) &amp;&amp;</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;             PI-&gt;getOperand(0).getReg() == StackPtr) {</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <span class="keywordflow">if</span> (NumBytes)</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;      *NumBytes -= PI-&gt;getOperand(2).getImm();</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    MBB.<a class="code" href="classllvm_1_1MachineBasicBlock.html#a537a9265c55392ab47d44954f27db538">erase</a>(PI);</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;  }</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;}</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="comment">/// mergeSPUpdatesDown - Merge two stack-manipulating instructions lower iterator.</span></div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="comment"></span><span class="keyword">static</span></div><div class="line"><a name="l00228"></a><span class="lineno"><a class="line" href="X86FrameLowering_8cpp.html#a6cc74ec571caa907bb2dfcd0d068297a">  228</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="X86FrameLowering_8cpp.html#a6cc74ec571caa907bb2dfcd0d068297a">mergeSPUpdatesDown</a>(<a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> &amp;MBB,</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;                        <a class="code" href="classllvm_1_1MachineBasicBlock.html#ac51be7ff80fe8d6ae5e8c0acb194908a">MachineBasicBlock::iterator</a> &amp;MBBI,</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                        <span class="keywordtype">unsigned</span> StackPtr, uint64_t *NumBytes = NULL) {</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  <span class="comment">// FIXME:  THIS ISN&#39;T RUN!!!</span></div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  <span class="keywordflow">return</span>;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  <span class="keywordflow">if</span> (MBBI == MBB.<a class="code" href="classllvm_1_1MachineBasicBlock.html#acbc921830578e2741be6549db716c0ce">end</a>()) <span class="keywordflow">return</span>;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  <a class="code" href="classllvm_1_1MachineBasicBlock.html#ac51be7ff80fe8d6ae5e8c0acb194908a">MachineBasicBlock::iterator</a> NI = <a class="code" href="namespacellvm.html#aa1704159f75e6eacd595962ea6d93ffe">llvm::next</a>(MBBI);</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  <span class="keywordflow">if</span> (NI == MBB.<a class="code" href="classllvm_1_1MachineBasicBlock.html#acbc921830578e2741be6549db716c0ce">end</a>()) <span class="keywordflow">return</span>;</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;  <span class="keywordtype">unsigned</span> Opc = NI-&gt;getOpcode();</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  <span class="keywordflow">if</span> ((Opc == X86::ADD64ri32 || Opc == X86::ADD64ri8 ||</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;       Opc == X86::ADD32ri || Opc == X86::ADD32ri8) &amp;&amp;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;      NI-&gt;getOperand(0).getReg() == StackPtr) {</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="keywordflow">if</span> (NumBytes)</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;      *NumBytes -= NI-&gt;getOperand(2).getImm();</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    MBB.<a class="code" href="classllvm_1_1MachineBasicBlock.html#a537a9265c55392ab47d44954f27db538">erase</a>(NI);</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    MBBI = NI;</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((Opc == X86::SUB64ri32 || Opc == X86::SUB64ri8 ||</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;              Opc == X86::SUB32ri || Opc == X86::SUB32ri8) &amp;&amp;</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;             NI-&gt;getOperand(0).getReg() == StackPtr) {</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <span class="keywordflow">if</span> (NumBytes)</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;      *NumBytes += NI-&gt;getOperand(2).getImm();</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    MBB.<a class="code" href="classllvm_1_1MachineBasicBlock.html#a537a9265c55392ab47d44954f27db538">erase</a>(NI);</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    MBBI = NI;</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  }</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;}</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="comment">/// mergeSPUpdates - Checks the instruction before/after the passed</span></div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="comment">/// instruction. If it is an ADD/SUB/LEA instruction it is deleted argument and the</span></div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment">/// stack adjustment is returned as a positive value for ADD/LEA and a negative for</span></div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment">/// SUB.</span></div><div class="line"><a name="l00261"></a><span class="lineno"><a class="line" href="X86FrameLowering_8cpp.html#a9a6b9534fac20f1dbf973afc5caabc3f">  261</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="X86FrameLowering_8cpp.html#a9a6b9534fac20f1dbf973afc5caabc3f">mergeSPUpdates</a>(<a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> &amp;MBB,</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;                           <a class="code" href="classllvm_1_1MachineBasicBlock.html#ac51be7ff80fe8d6ae5e8c0acb194908a">MachineBasicBlock::iterator</a> &amp;MBBI,</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;                           <span class="keywordtype">unsigned</span> StackPtr,</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;                           <span class="keywordtype">bool</span> doMergeWithPrevious) {</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;  <span class="keywordflow">if</span> ((doMergeWithPrevious &amp;&amp; MBBI == MBB.<a class="code" href="classllvm_1_1MachineBasicBlock.html#ab2d91e7bec944efcbc39d8e30644f111">begin</a>()) ||</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;      (!doMergeWithPrevious &amp;&amp; MBBI == MBB.<a class="code" href="classllvm_1_1MachineBasicBlock.html#acbc921830578e2741be6549db716c0ce">end</a>()))</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;  <a class="code" href="classllvm_1_1MachineBasicBlock.html#ac51be7ff80fe8d6ae5e8c0acb194908a">MachineBasicBlock::iterator</a> PI = doMergeWithPrevious ? <a class="code" href="namespacellvm.html#a7923e3e207de8bc1d0d6a5091316ddde">prior</a>(MBBI) : MBBI;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  <a class="code" href="classllvm_1_1MachineBasicBlock.html#ac51be7ff80fe8d6ae5e8c0acb194908a">MachineBasicBlock::iterator</a> NI = doMergeWithPrevious ? 0 : <a class="code" href="namespacellvm.html#aa1704159f75e6eacd595962ea6d93ffe">llvm::next</a>(MBBI);</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  <span class="keywordtype">unsigned</span> Opc = PI-&gt;getOpcode();</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  <span class="keywordtype">int</span> Offset = 0;</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;  <span class="keywordflow">if</span> ((Opc == X86::ADD64ri32 || Opc == X86::ADD64ri8 ||</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;       Opc == X86::ADD32ri || Opc == X86::ADD32ri8 ||</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;       Opc == X86::LEA32r || Opc == X86::LEA64_32r) &amp;&amp;</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;      PI-&gt;getOperand(0).getReg() == StackPtr){</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    Offset += PI-&gt;getOperand(2).getImm();</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    MBB.<a class="code" href="classllvm_1_1MachineBasicBlock.html#a537a9265c55392ab47d44954f27db538">erase</a>(PI);</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    <span class="keywordflow">if</span> (!doMergeWithPrevious) MBBI = NI;</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((Opc == X86::SUB64ri32 || Opc == X86::SUB64ri8 ||</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;              Opc == X86::SUB32ri || Opc == X86::SUB32ri8) &amp;&amp;</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;             PI-&gt;getOperand(0).getReg() == StackPtr) {</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    Offset -= PI-&gt;getOperand(2).getImm();</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    MBB.<a class="code" href="classllvm_1_1MachineBasicBlock.html#a537a9265c55392ab47d44954f27db538">erase</a>(PI);</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <span class="keywordflow">if</span> (!doMergeWithPrevious) MBBI = NI;</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;  }</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;  <span class="keywordflow">return</span> Offset;</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;}</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;</div><div class="line"><a name="l00292"></a><span class="lineno"><a class="line" href="X86FrameLowering_8cpp.html#a7cf542551b4f3cbad42d73ab0e1ddd34">  292</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="X86FrameLowering_8cpp.html#a7cf542551b4f3cbad42d73ab0e1ddd34">isEAXLiveIn</a>(<a class="code" href="classllvm_1_1MachineFunction.html">MachineFunction</a> &amp;MF) {</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a80b58d5afb19164c6199077bf8f8ea1a">MachineRegisterInfo::livein_iterator</a> II = MF.<a class="code" href="classllvm_1_1MachineFunction.html#ab4a6ca428289b667dd691a00e9f7e334">getRegInfo</a>().<a class="code" href="classllvm_1_1MachineRegisterInfo.html#adb8e83c4e03a80fa7d24357b522e25ff">livein_begin</a>(),</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;       EE = MF.<a class="code" href="classllvm_1_1MachineFunction.html#ab4a6ca428289b667dd691a00e9f7e334">getRegInfo</a>().<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a0e18d247091e29fe2c2c3f5bd59843fb">livein_end</a>(); II != EE; ++II) {</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <span class="keywordtype">unsigned</span> <a class="code" href="X86DisassemblerDecoder_8h.html#a546839a5c4bcf9f9450967155f48de41">Reg</a> = II-&gt;first;</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <span class="keywordflow">if</span> (Reg == <a class="code" href="README-SSE_8txt.html#abd9c765b9afafff59eb14d50c9e9fba1">X86::EAX</a> || Reg == X86::AX ||</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        Reg == <a class="code" href="README-X86-64_8txt.html#a9de23273550c17a1957b1b325a01960e">X86::AH</a> || Reg == <a class="code" href="namespacellvm_1_1A64CC.html#af5804bc0518be9568f73db566e4d6f46a802c8408643a0c37e107e7b4b0994c30">X86::AL</a>)</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;  }</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;}</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;</div><div class="line"><a name="l00305"></a><span class="lineno"><a class="line" href="classllvm_1_1X86FrameLowering.html#a439b4e5e61ca54bfd7f11876db933f53">  305</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classllvm_1_1X86FrameLowering.html#a439b4e5e61ca54bfd7f11876db933f53">X86FrameLowering::emitCalleeSavedFrameMoves</a>(<a class="code" href="classllvm_1_1MachineFunction.html">MachineFunction</a> &amp;MF,</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                                                 <a class="code" href="classllvm_1_1MCSymbol.html">MCSymbol</a> *Label,</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                                                 <span class="keywordtype">unsigned</span> FramePtr)<span class="keyword"> const </span>{</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;  <a class="code" href="classllvm_1_1MachineFrameInfo.html">MachineFrameInfo</a> *MFI = MF.<a class="code" href="classllvm_1_1MachineFunction.html#a4ad4295a88187ea1ae12ecfcfa18a70f">getFrameInfo</a>();</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;  <a class="code" href="classllvm_1_1MachineModuleInfo.html">MachineModuleInfo</a> &amp;MMI = MF.<a class="code" href="classllvm_1_1MachineFunction.html#aaaa58853344cccb2ae6dcecea4ee54ad">getMMI</a>();</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1MCRegisterInfo.html">MCRegisterInfo</a> *<a class="code" href="MCModuleYAML_8cpp.html#a5e410df3f6875c5af4a7f2be284f235d">MRI</a> = MMI.<a class="code" href="classllvm_1_1MachineModuleInfo.html#a215f3061b9e7ad1b1ffac03cfc580665">getContext</a>().<a class="code" href="classllvm_1_1MCContext.html#a3fe9c108e3bf910d8d501b4e45b8cdfc">getRegisterInfo</a>();</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;  <span class="comment">// Add callee saved registers to move list.</span></div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;  <span class="keyword">const</span> std::vector&lt;CalleeSavedInfo&gt; &amp;CSI = MFI-&gt;<a class="code" href="classllvm_1_1MachineFrameInfo.html#a5296aac05a8ccceb0d89d449611722d3">getCalleeSavedInfo</a>();</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;  <span class="keywordflow">if</span> (CSI.empty()) <span class="keywordflow">return</span>;</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1X86RegisterInfo.html">X86RegisterInfo</a> *RegInfo = TM.<a class="code" href="classllvm_1_1X86TargetMachine.html#a350524cf8e1e0e53a6d856188d851ec4">getRegisterInfo</a>();</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  <span class="keywordtype">bool</span> HasFP = <a class="code" href="classllvm_1_1X86FrameLowering.html#a649e4f2412bff7a236d44c0c52982640">hasFP</a>(MF);</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  <span class="comment">// Calculate amount of bytes used for return address storing.</span></div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;  <span class="keywordtype">int</span> stackGrowth = -RegInfo-&gt;<a class="code" href="classllvm_1_1X86RegisterInfo.html#a52f78fb379677e9270168daf72a808bd">getSlotSize</a>();</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;  <span class="comment">// FIXME: This is dirty hack. The code itself is pretty mess right now.</span></div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  <span class="comment">// It should be rewritten from scratch and generalized sometimes.</span></div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;  <span class="comment">// Determine maximum offset (minimum due to stack growth).</span></div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;  int64_t MaxOffset = 0;</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;  <span class="keywordflow">for</span> (std::vector&lt;CalleeSavedInfo&gt;::const_iterator</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;         <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = CSI.begin(), E = CSI.end(); <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> != E; ++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    MaxOffset = std::min(MaxOffset,</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;                         MFI-&gt;<a class="code" href="classllvm_1_1MachineFrameInfo.html#aefac52e417d31959e35868879aba672b">getObjectOffset</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getFrameIdx()));</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;  <span class="comment">// Calculate offsets.</span></div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;  int64_t saveAreaOffset = (HasFP ? 3 : 2) * stackGrowth;</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;  <span class="keywordflow">for</span> (std::vector&lt;CalleeSavedInfo&gt;::const_iterator</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;         <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = CSI.begin(), E = CSI.end(); <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> != E; ++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    int64_t Offset = MFI-&gt;<a class="code" href="classllvm_1_1MachineFrameInfo.html#aefac52e417d31959e35868879aba672b">getObjectOffset</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getFrameIdx());</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <span class="keywordtype">unsigned</span> <a class="code" href="X86DisassemblerDecoder_8h.html#a546839a5c4bcf9f9450967155f48de41">Reg</a> = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getReg();</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    Offset = MaxOffset - Offset + saveAreaOffset;</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <span class="comment">// Don&#39;t output a new machine move if we&#39;re re-saving the frame</span></div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <span class="comment">// pointer. This happens when the PrologEpilogInserter has inserted an extra</span></div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <span class="comment">// &quot;PUSH&quot; of the frame pointer -- the &quot;emitPrologue&quot; method automatically</span></div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <span class="comment">// generates one when frame pointers are used. If we generate a &quot;machine</span></div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <span class="comment">// move&quot; for this extra &quot;PUSH&quot;, the linker will lose track of the fact that</span></div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    <span class="comment">// the frame pointer should have the value of the first &quot;PUSH&quot; when it&#39;s</span></div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    <span class="comment">// trying to unwind.</span></div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    <span class="comment">//</span></div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <span class="comment">// FIXME: This looks inelegant. It&#39;s possibly correct, but it&#39;s covering up</span></div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    <span class="comment">//        another bug. I.e., one where we generate a prolog like this:</span></div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <span class="comment">//</span></div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <span class="comment">//          pushl  %ebp</span></div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    <span class="comment">//          movl   %esp, %ebp</span></div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    <span class="comment">//          pushl  %ebp</span></div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    <span class="comment">//          pushl  %esi</span></div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <span class="comment">//           ...</span></div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <span class="comment">//</span></div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <span class="comment">//        The immediate re-push of EBP is unnecessary. At the least, it&#39;s an</span></div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <span class="comment">//        optimization bug. EBP can be used as a scratch register in certain</span></div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <span class="comment">//        cases, but probably not when we have a frame pointer.</span></div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    <span class="keywordflow">if</span> (HasFP &amp;&amp; FramePtr == Reg)</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    <span class="keywordtype">unsigned</span> DwarfReg = MRI-&gt;<a class="code" href="classllvm_1_1MCRegisterInfo.html#ac1d330e923a5138ddb044a6ffb5d5747">getDwarfRegNum</a>(Reg, <span class="keyword">true</span>);</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    MMI.<a class="code" href="classllvm_1_1MachineModuleInfo.html#a5747190c7d1616888ef933167e632953">addFrameInst</a>(<a class="code" href="classllvm_1_1MCCFIInstruction.html#aea2b8a3efd6694a33452ed7e8716300e">MCCFIInstruction::createOffset</a>(Label, DwarfReg, Offset));</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;  }</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;}</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="comment">/// usesTheStack - This function checks if any of the users of EFLAGS</span></div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="comment">/// copies the EFLAGS. We know that the code that lowers COPY of EFLAGS has</span></div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="comment">/// to use the stack, and if we don&#39;t adjust the stack we clobber the first</span></div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="comment">/// frame index.</span></div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="comment">/// See X86InstrInfo::copyPhysReg.</span></div><div class="line"><a name="l00373"></a><span class="lineno"><a class="line" href="X86FrameLowering_8cpp.html#a8b9066231f49c1aee00bbd009b627f80">  373</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="X86FrameLowering_8cpp.html#a8b9066231f49c1aee00bbd009b627f80">usesTheStack</a>(<span class="keyword">const</span> <a class="code" href="classllvm_1_1MachineFunction.html">MachineFunction</a> &amp;MF) {</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="MCModuleYAML_8cpp.html#a5e410df3f6875c5af4a7f2be284f235d">MRI</a> = MF.<a class="code" href="classllvm_1_1MachineFunction.html#ab4a6ca428289b667dd691a00e9f7e334">getRegInfo</a>();</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1MachineRegisterInfo_1_1defusechain__iterator.html">MachineRegisterInfo::reg_iterator</a> ri = MRI.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#adfeaea4e5c82dea47ff9aa1f8367104c">reg_begin</a>(X86::EFLAGS),</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;       re = MRI.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a1d8edf72c1d3e14e4d2396b98e07ad72">reg_end</a>(); ri != re; ++ri)</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    <span class="keywordflow">if</span> (ri-&gt;isCopy())</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;}</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;<span class="comment">/// emitPrologue - Push callee-saved registers onto the stack, which</span></div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="comment">/// automatically adjust the stack pointer. Adjust the stack pointer to allocate</span></div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="comment">/// space for local variables. Also emit labels used by the exception handler to</span></div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="comment">/// generate the exception handling frames.</span></div><div class="line"><a name="l00388"></a><span class="lineno"><a class="line" href="classllvm_1_1X86FrameLowering.html#a6954f39513691bd4cced9a770b200595">  388</a></span>&#160;<span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="classllvm_1_1X86FrameLowering.html#a6954f39513691bd4cced9a770b200595">X86FrameLowering::emitPrologue</a>(<a class="code" href="classllvm_1_1MachineFunction.html">MachineFunction</a> &amp;MF)<span class="keyword"> const </span>{</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;  <a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> &amp;MBB = MF.<a class="code" href="classllvm_1_1MachineFunction.html#af562445435f18637f07676da054ba02c">front</a>(); <span class="comment">// Prologue goes in entry BB.</span></div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;  <a class="code" href="classllvm_1_1MachineBasicBlock.html#ac51be7ff80fe8d6ae5e8c0acb194908a">MachineBasicBlock::iterator</a> MBBI = MBB.<a class="code" href="classllvm_1_1MachineBasicBlock.html#ab2d91e7bec944efcbc39d8e30644f111">begin</a>();</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;  <a class="code" href="classllvm_1_1MachineFrameInfo.html">MachineFrameInfo</a> *MFI = MF.<a class="code" href="classllvm_1_1MachineFunction.html#a4ad4295a88187ea1ae12ecfcfa18a70f">getFrameInfo</a>();</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1Function.html">Function</a> *Fn = MF.<a class="code" href="classllvm_1_1MachineFunction.html#ad784a6594990530bffb2018aeeed56f3">getFunction</a>();</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1X86RegisterInfo.html">X86RegisterInfo</a> *RegInfo = TM.<a class="code" href="classllvm_1_1X86TargetMachine.html#a350524cf8e1e0e53a6d856188d851ec4">getRegisterInfo</a>();</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1X86InstrInfo.html">X86InstrInfo</a> &amp;<a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a> = *TM.<a class="code" href="classllvm_1_1X86TargetMachine.html#a245ed1de411cd3ba114322a573b524f5">getInstrInfo</a>();</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;  <a class="code" href="classllvm_1_1MachineModuleInfo.html">MachineModuleInfo</a> &amp;MMI = MF.<a class="code" href="classllvm_1_1MachineFunction.html#aaaa58853344cccb2ae6dcecea4ee54ad">getMMI</a>();</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  <a class="code" href="classllvm_1_1X86MachineFunctionInfo.html">X86MachineFunctionInfo</a> *X86FI = MF.<a class="code" href="classllvm_1_1MachineFunction.html#ac2dc0fa143c9f2127f0501734577a0a0">getInfo</a>&lt;<a class="code" href="classllvm_1_1X86MachineFunctionInfo.html">X86MachineFunctionInfo</a>&gt;();</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;  <span class="keywordtype">bool</span> needsFrameMoves = MMI.<a class="code" href="classllvm_1_1MachineModuleInfo.html#af1cb1572271c30b402591e2b3d832ca6">hasDebugInfo</a>() ||</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    Fn-&gt;<a class="code" href="classllvm_1_1Function.html#a13935e45a4c19ec182a32e504b25ba15">needsUnwindTableEntry</a>();</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;  uint64_t MaxAlign  = MFI-&gt;<a class="code" href="classllvm_1_1MachineFrameInfo.html#a0af0a11b8eda54e79422c199cb687f5c">getMaxAlignment</a>(); <span class="comment">// Desired stack alignment.</span></div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;  uint64_t StackSize = MFI-&gt;<a class="code" href="classllvm_1_1MachineFrameInfo.html#a34874094b3ba8b56fd68801250f77183">getStackSize</a>();    <span class="comment">// Number of bytes to allocate.</span></div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;  <span class="keywordtype">bool</span> HasFP = <a class="code" href="classllvm_1_1X86FrameLowering.html#a649e4f2412bff7a236d44c0c52982640">hasFP</a>(MF);</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;  <span class="keywordtype">bool</span> Is64Bit = STI.<a class="code" href="classllvm_1_1X86Subtarget.html#a5314399c907d77b514ec837e8527a9de">is64Bit</a>();</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;  <span class="keywordtype">bool</span> IsLP64 = STI.<a class="code" href="classllvm_1_1X86Subtarget.html#ae380c7f0dbea1c8e93b42f1a1708e1a0">isTarget64BitLP64</a>();</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;  <span class="keywordtype">bool</span> IsWin64 = STI.<a class="code" href="classllvm_1_1X86Subtarget.html#ad2e7679750b36379f33281443080869f">isTargetWin64</a>();</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;  <span class="keywordtype">bool</span> UseLEA = STI.<a class="code" href="classllvm_1_1X86Subtarget.html#a9efe6935f37edac03b15a66b138dec8c">useLeaForSP</a>();</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;  <span class="keywordtype">unsigned</span> StackAlign = <a class="code" href="classllvm_1_1TargetFrameLowering.html#a360555ed6db3b28a33fa5449a0335f19">getStackAlignment</a>();</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;  <span class="keywordtype">unsigned</span> SlotSize = RegInfo-&gt;<a class="code" href="classllvm_1_1X86RegisterInfo.html#a52f78fb379677e9270168daf72a808bd">getSlotSize</a>();</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;  <span class="keywordtype">unsigned</span> FramePtr = RegInfo-&gt;<a class="code" href="classllvm_1_1X86RegisterInfo.html#a2883bb621245229de23a6396b1ef81b7">getFrameRegister</a>(MF);</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;  <span class="keywordtype">unsigned</span> StackPtr = RegInfo-&gt;<a class="code" href="classllvm_1_1X86RegisterInfo.html#ac26e69b92e7ee67cfe9766db55b221da">getStackRegister</a>();</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;  <span class="keywordtype">unsigned</span> BasePtr = RegInfo-&gt;<a class="code" href="classllvm_1_1X86RegisterInfo.html#aa9f703a288ef91efae26a538d96037d6">getBaseRegister</a>();</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;  <a class="code" href="classllvm_1_1DebugLoc.html">DebugLoc</a> DL;</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;  <span class="comment">// If we&#39;re forcing a stack realignment we can&#39;t rely on just the frame</span></div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;  <span class="comment">// info, we need to know the ABI stack alignment as well in case we</span></div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;  <span class="comment">// have a call out.  Otherwise just make sure we have some alignment - we&#39;ll</span></div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;  <span class="comment">// go with the minimum SlotSize.</span></div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;  <span class="keywordflow">if</span> (ForceStackAlign) {</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <span class="keywordflow">if</span> (MFI-&gt;<a class="code" href="classllvm_1_1MachineFrameInfo.html#ad104abdabbcb68deacc60c0aea1bca34">hasCalls</a>())</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;      MaxAlign = (StackAlign &gt; MaxAlign) ? StackAlign : MaxAlign;</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (MaxAlign &lt; SlotSize)</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;      MaxAlign = SlotSize;</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;  }</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;  <span class="comment">// Add RETADDR move area to callee saved frame size.</span></div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;  <span class="keywordtype">int</span> TailCallReturnAddrDelta = X86FI-&gt;<a class="code" href="classllvm_1_1X86MachineFunctionInfo.html#ae2a2c9153ec666e20698a5d3956ac2d4">getTCReturnAddrDelta</a>();</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;  <span class="keywordflow">if</span> (TailCallReturnAddrDelta &lt; 0)</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    X86FI-&gt;<a class="code" href="classllvm_1_1X86MachineFunctionInfo.html#af3682a96148f7c1e534dfa7c2726ccec">setCalleeSavedFrameSize</a>(</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;      X86FI-&gt;<a class="code" href="classllvm_1_1X86MachineFunctionInfo.html#a48ab7f9b817ff462e08d8a5858b4c6fc">getCalleeSavedFrameSize</a>() - TailCallReturnAddrDelta);</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;  <span class="comment">// If this is x86-64 and the Red Zone is not disabled, if we are a leaf</span></div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;  <span class="comment">// function, and use up to 128 bytes of stack space, don&#39;t have a frame</span></div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;  <span class="comment">// pointer, calls, or dynamic alloca then we do not need to adjust the</span></div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;  <span class="comment">// stack pointer (we fit in the Red Zone). We also check that we don&#39;t</span></div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;  <span class="comment">// push and pop from the stack.</span></div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;  <span class="keywordflow">if</span> (Is64Bit &amp;&amp; !Fn-&gt;<a class="code" href="classllvm_1_1Function.html#a72873ed64b7be01507a2248b8e756ec8">getAttributes</a>().<a class="code" href="classllvm_1_1AttributeSet.html#a54abbe67d4a53c92652f1666dc19281f">hasAttribute</a>(AttributeSet::FunctionIndex,</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;                                                   <a class="code" href="classllvm_1_1Attribute.html#aab7ee4b8fd1d3e7e4cea87868855e60ea62ad0d9b548303cf2fc7544275e2191e">Attribute::NoRedZone</a>) &amp;&amp;</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;      !RegInfo-&gt;<a class="code" href="classllvm_1_1X86RegisterInfo.html#acfd0722e4669be2f7e16059679406d9f">needsStackRealignment</a>(MF) &amp;&amp;</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;      !MFI-&gt;<a class="code" href="classllvm_1_1MachineFrameInfo.html#a5cd76eb2aeed3ae46da1bb1b132f1831">hasVarSizedObjects</a>() &amp;&amp;                     <span class="comment">// No dynamic alloca.</span></div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;      !MFI-&gt;<a class="code" href="classllvm_1_1MachineFrameInfo.html#a54aab1c41d2657472b4ea7c9935570c7">adjustsStack</a>() &amp;&amp;                           <span class="comment">// No calls.</span></div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;      !IsWin64 &amp;&amp;                                       <span class="comment">// Win64 has no Red Zone</span></div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;      !<a class="code" href="X86FrameLowering_8cpp.html#a8b9066231f49c1aee00bbd009b627f80">usesTheStack</a>(MF) &amp;&amp;                              <span class="comment">// Don&#39;t push and pop.</span></div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;      !MF.<a class="code" href="classllvm_1_1MachineFunction.html#a6745c3bfdfc5b0643b078b96df2db252">getTarget</a>().<a class="code" href="classllvm_1_1TargetMachine.html#ab1fb67187fc37e569cc5171cbebba873">Options</a>.<a class="code" href="classllvm_1_1TargetOptions.html#a0c579d66df87322b3f963638eddc1cf5">EnableSegmentedStacks</a>) {  <span class="comment">// Regular stack</span></div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    uint64_t MinSize = X86FI-&gt;<a class="code" href="classllvm_1_1X86MachineFunctionInfo.html#a48ab7f9b817ff462e08d8a5858b4c6fc">getCalleeSavedFrameSize</a>();</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    <span class="keywordflow">if</span> (HasFP) MinSize += SlotSize;</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    StackSize = std::max(MinSize, StackSize &gt; 128 ? StackSize - 128 : 0);</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    MFI-&gt;<a class="code" href="classllvm_1_1MachineFrameInfo.html#ae4d51e9e70d6a7fb366f2a09d10a0945">setStackSize</a>(StackSize);</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;  }</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;  <span class="comment">// Insert stack pointer adjustment for later moving of return addr.  Only</span></div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;  <span class="comment">// applies to tail call optimized functions where the callee argument stack</span></div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;  <span class="comment">// size is bigger than the callers.</span></div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;  <span class="keywordflow">if</span> (TailCallReturnAddrDelta &lt; 0) {</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *<a class="code" href="namespacellvm_1_1A64CC.html#af5804bc0518be9568f73db566e4d6f46a2db5e7546f960277ff98f96cd5624442">MI</a> =</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;      <a class="code" href="namespacellvm.html#a980570dc1410d4ef53806f82028ca381">BuildMI</a>(MBB, MBBI, DL,</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;              TII.get(<a class="code" href="X86FrameLowering_8cpp.html#a277b1c0324a7229d31f3eeff08311411">getSUBriOpcode</a>(IsLP64, -TailCallReturnAddrDelta)),</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;              StackPtr)</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;        .addReg(StackPtr)</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;        .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a9f1fae6a5dbb6e378ca85df1fded8515">addImm</a>(-TailCallReturnAddrDelta)</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;        .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a66fb0307f35f874cb65deb84eea9553f">setMIFlag</a>(<a class="code" href="classllvm_1_1MachineInstr.html#aafacf84de1cb994a92dc045f4aa1d518a78f1067d270179dff7915b90a03ce237">MachineInstr::FrameSetup</a>);</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a302e45878c6dc1714334c7ce96d56846">getOperand</a>(3).<a class="code" href="classllvm_1_1MachineOperand.html#a61a42c85bd86c6ca4554e27d33c3f798">setIsDead</a>(); <span class="comment">// The EFLAGS implicit def is dead.</span></div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;  }</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;  <span class="comment">// Mapping for machine moves:</span></div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;  <span class="comment">//</span></div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;  <span class="comment">//   DST: VirtualFP AND</span></div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;  <span class="comment">//        SRC: VirtualFP              =&gt; DW_CFA_def_cfa_offset</span></div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;  <span class="comment">//        ELSE                        =&gt; DW_CFA_def_cfa</span></div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;  <span class="comment">//</span></div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;  <span class="comment">//   SRC: VirtualFP AND</span></div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;  <span class="comment">//        DST: Register               =&gt; DW_CFA_def_cfa_register</span></div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;  <span class="comment">//</span></div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;  <span class="comment">//   ELSE</span></div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;  <span class="comment">//        OFFSET &lt; 0                  =&gt; DW_CFA_offset_extended_sf</span></div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;  <span class="comment">//        REG &lt; 64                    =&gt; DW_CFA_offset + Reg</span></div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;  <span class="comment">//        ELSE                        =&gt; DW_CFA_offset_extended</span></div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;  uint64_t NumBytes = 0;</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;  <span class="keywordtype">int</span> stackGrowth = -SlotSize;</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;  <span class="keywordflow">if</span> (HasFP) {</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    <span class="comment">// Calculate required stack adjustment.</span></div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    uint64_t FrameSize = StackSize - SlotSize;</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    <span class="keywordflow">if</span> (RegInfo-&gt;<a class="code" href="classllvm_1_1X86RegisterInfo.html#acfd0722e4669be2f7e16059679406d9f">needsStackRealignment</a>(MF)) {</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;      <span class="comment">// Callee-saved registers are pushed on stack before the stack</span></div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;      <span class="comment">// is realigned.</span></div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;      FrameSize -= X86FI-&gt;<a class="code" href="classllvm_1_1X86MachineFunctionInfo.html#a48ab7f9b817ff462e08d8a5858b4c6fc">getCalleeSavedFrameSize</a>();</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;      NumBytes = (FrameSize + MaxAlign - 1) / MaxAlign * MaxAlign;</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;      NumBytes = FrameSize - X86FI-&gt;<a class="code" href="classllvm_1_1X86MachineFunctionInfo.html#a48ab7f9b817ff462e08d8a5858b4c6fc">getCalleeSavedFrameSize</a>();</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    }</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    <span class="comment">// Get the offset of the stack slot for the EBP register, which is</span></div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    <span class="comment">// guaranteed to be the last slot by processFunctionBeforeFrameFinalized.</span></div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    <span class="comment">// Update the frame offset adjustment.</span></div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    MFI-&gt;<a class="code" href="classllvm_1_1MachineFrameInfo.html#a87a1fe769ec763a9c8f8427a017a45d7">setOffsetAdjustment</a>(-NumBytes);</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    <span class="comment">// Save EBP/RBP into the appropriate stack slot.</span></div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    <a class="code" href="namespacellvm.html#a980570dc1410d4ef53806f82028ca381">BuildMI</a>(MBB, MBBI, DL, TII.get(Is64Bit ? X86::PUSH64r : X86::PUSH32r))</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;      .addReg(FramePtr, <a class="code" href="namespacellvm_1_1RegState.html#a079b254e749130fbe5d740f314ca92daa9ddde91ef09476d28a088fe57f8e2921">RegState::Kill</a>)</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;      .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a66fb0307f35f874cb65deb84eea9553f">setMIFlag</a>(<a class="code" href="classllvm_1_1MachineInstr.html#aafacf84de1cb994a92dc045f4aa1d518a78f1067d270179dff7915b90a03ce237">MachineInstr::FrameSetup</a>);</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    <span class="keywordflow">if</span> (needsFrameMoves) {</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;      <span class="comment">// Mark the place where EBP/RBP was saved.</span></div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;      <a class="code" href="classllvm_1_1MCSymbol.html">MCSymbol</a> *FrameLabel = MMI.<a class="code" href="classllvm_1_1MachineModuleInfo.html#a215f3061b9e7ad1b1ffac03cfc580665">getContext</a>().<a class="code" href="classllvm_1_1MCContext.html#af0efba8326e35ce320f4d2fd346cea3f">CreateTempSymbol</a>();</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;      <a class="code" href="namespacellvm.html#a980570dc1410d4ef53806f82028ca381">BuildMI</a>(MBB, MBBI, DL, TII.get(<a class="code" href="namespacellvm_1_1TargetOpcode.html#a348d4259b5fa6a8ecfe94e7ae512e1a8ac4061808eca922630aa39fc5c6f43896">X86::PROLOG_LABEL</a>))</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;        .addSym(FrameLabel);</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;      <span class="comment">// Define the current CFA rule to use the provided offset.</span></div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;      assert(StackSize);</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;      MMI.<a class="code" href="classllvm_1_1MachineModuleInfo.html#a5747190c7d1616888ef933167e632953">addFrameInst</a>(</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;          <a class="code" href="classllvm_1_1MCCFIInstruction.html#a574f705ef18dd3e6c46c0a6b0ae81b08">MCCFIInstruction::createDefCfaOffset</a>(FrameLabel, 2 * stackGrowth));</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;      <span class="comment">// Change the rule for the FramePtr to be an &quot;offset&quot; rule.</span></div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;      <span class="keywordtype">unsigned</span> DwarfFramePtr = RegInfo-&gt;getDwarfRegNum(FramePtr, <span class="keyword">true</span>);</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;      MMI.<a class="code" href="classllvm_1_1MachineModuleInfo.html#a5747190c7d1616888ef933167e632953">addFrameInst</a>(<a class="code" href="classllvm_1_1MCCFIInstruction.html#aea2b8a3efd6694a33452ed7e8716300e">MCCFIInstruction::createOffset</a>(FrameLabel, DwarfFramePtr,</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;                                                      2 * stackGrowth));</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    }</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    <span class="comment">// Update EBP with the new base value.</span></div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    <a class="code" href="namespacellvm.html#a980570dc1410d4ef53806f82028ca381">BuildMI</a>(MBB, MBBI, DL,</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;            TII.get(Is64Bit ? X86::MOV64rr : X86::MOV32rr), FramePtr)</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;        .addReg(StackPtr)</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;        .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a66fb0307f35f874cb65deb84eea9553f">setMIFlag</a>(<a class="code" href="classllvm_1_1MachineInstr.html#aafacf84de1cb994a92dc045f4aa1d518a78f1067d270179dff7915b90a03ce237">MachineInstr::FrameSetup</a>);</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    <span class="keywordflow">if</span> (needsFrameMoves) {</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;      <span class="comment">// Mark effective beginning of when frame pointer becomes valid.</span></div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;      <a class="code" href="classllvm_1_1MCSymbol.html">MCSymbol</a> *FrameLabel = MMI.<a class="code" href="classllvm_1_1MachineModuleInfo.html#a215f3061b9e7ad1b1ffac03cfc580665">getContext</a>().<a class="code" href="classllvm_1_1MCContext.html#af0efba8326e35ce320f4d2fd346cea3f">CreateTempSymbol</a>();</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;      <a class="code" href="namespacellvm.html#a980570dc1410d4ef53806f82028ca381">BuildMI</a>(MBB, MBBI, DL, TII.get(<a class="code" href="namespacellvm_1_1TargetOpcode.html#a348d4259b5fa6a8ecfe94e7ae512e1a8ac4061808eca922630aa39fc5c6f43896">X86::PROLOG_LABEL</a>))</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;        .addSym(FrameLabel);</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;      <span class="comment">// Define the current CFA to use the EBP/RBP register.</span></div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;      <span class="keywordtype">unsigned</span> DwarfFramePtr = RegInfo-&gt;getDwarfRegNum(FramePtr, <span class="keyword">true</span>);</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;      MMI.<a class="code" href="classllvm_1_1MachineModuleInfo.html#a5747190c7d1616888ef933167e632953">addFrameInst</a>(</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;          <a class="code" href="classllvm_1_1MCCFIInstruction.html#a9babd4ee8fb9fc9bb25eeac8274625d1">MCCFIInstruction::createDefCfaRegister</a>(FrameLabel, DwarfFramePtr));</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    }</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    <span class="comment">// Mark the FramePtr as live-in in every block except the entry.</span></div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1MachineFunction.html#a340712de3e78fec11c338735cab17df7">MachineFunction::iterator</a> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = <a class="code" href="namespacellvm.html#aa1704159f75e6eacd595962ea6d93ffe">llvm::next</a>(MF.<a class="code" href="classllvm_1_1MachineFunction.html#ab0789854909cf47f640a85fa2bac29c7">begin</a>()), E = MF.<a class="code" href="classllvm_1_1MachineFunction.html#a9d017af749f76484cb9aec9ff6e4330c">end</a>();</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;         <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> != E; ++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;      <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;addLiveIn(FramePtr);</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    NumBytes = StackSize - X86FI-&gt;<a class="code" href="classllvm_1_1X86MachineFunctionInfo.html#a48ab7f9b817ff462e08d8a5858b4c6fc">getCalleeSavedFrameSize</a>();</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;  }</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;  <span class="comment">// Skip the callee-saved push instructions.</span></div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;  <span class="keywordtype">bool</span> PushedRegs = <span class="keyword">false</span>;</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;  <span class="keywordtype">int</span> StackOffset = 2 * stackGrowth;</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;  <span class="keywordflow">while</span> (MBBI != MBB.<a class="code" href="classllvm_1_1MachineBasicBlock.html#acbc921830578e2741be6549db716c0ce">end</a>() &amp;&amp;</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;         (MBBI-&gt;getOpcode() == X86::PUSH32r ||</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;          MBBI-&gt;getOpcode() == X86::PUSH64r)) {</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    PushedRegs = <span class="keyword">true</span>;</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    MBBI-&gt;setFlag(<a class="code" href="classllvm_1_1MachineInstr.html#aafacf84de1cb994a92dc045f4aa1d518a78f1067d270179dff7915b90a03ce237">MachineInstr::FrameSetup</a>);</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    ++MBBI;</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    <span class="keywordflow">if</span> (!HasFP &amp;&amp; needsFrameMoves) {</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;      <span class="comment">// Mark callee-saved push instruction.</span></div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;      <a class="code" href="classllvm_1_1MCSymbol.html">MCSymbol</a> *Label = MMI.<a class="code" href="classllvm_1_1MachineModuleInfo.html#a215f3061b9e7ad1b1ffac03cfc580665">getContext</a>().<a class="code" href="classllvm_1_1MCContext.html#af0efba8326e35ce320f4d2fd346cea3f">CreateTempSymbol</a>();</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;      <a class="code" href="namespacellvm.html#a980570dc1410d4ef53806f82028ca381">BuildMI</a>(MBB, MBBI, DL, TII.get(<a class="code" href="namespacellvm_1_1TargetOpcode.html#a348d4259b5fa6a8ecfe94e7ae512e1a8ac4061808eca922630aa39fc5c6f43896">X86::PROLOG_LABEL</a>)).addSym(Label);</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;      <span class="comment">// Define the current CFA rule to use the provided offset.</span></div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;      assert(StackSize);</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;      MMI.<a class="code" href="classllvm_1_1MachineModuleInfo.html#a5747190c7d1616888ef933167e632953">addFrameInst</a>(</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;          <a class="code" href="classllvm_1_1MCCFIInstruction.html#a574f705ef18dd3e6c46c0a6b0ae81b08">MCCFIInstruction::createDefCfaOffset</a>(Label, StackOffset));</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;      StackOffset += stackGrowth;</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    }</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;  }</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;  <span class="comment">// Realign stack after we pushed callee-saved registers (so that we&#39;ll be</span></div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;  <span class="comment">// able to calculate their offsets from the frame pointer).</span></div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;  <span class="comment">// NOTE: We push the registers before realigning the stack, so</span></div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;  <span class="comment">// vector callee-saved (xmm) registers may be saved w/o proper</span></div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;  <span class="comment">// alignment in this way. However, currently these regs are saved in</span></div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;  <span class="comment">// stack slots (see X86FrameLowering::spillCalleeSavedRegisters()), so</span></div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;  <span class="comment">// this shouldn&#39;t be a problem.</span></div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;  <span class="keywordflow">if</span> (RegInfo-&gt;<a class="code" href="classllvm_1_1X86RegisterInfo.html#acfd0722e4669be2f7e16059679406d9f">needsStackRealignment</a>(MF)) {</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    assert(HasFP &amp;&amp; <span class="stringliteral">&quot;There should be a frame pointer if stack is realigned.&quot;</span>);</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *<a class="code" href="namespacellvm_1_1A64CC.html#af5804bc0518be9568f73db566e4d6f46a2db5e7546f960277ff98f96cd5624442">MI</a> =</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;      <a class="code" href="namespacellvm.html#a980570dc1410d4ef53806f82028ca381">BuildMI</a>(MBB, MBBI, DL,</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;              TII.get(Is64Bit ? X86::AND64ri32 : X86::AND32ri), StackPtr)</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;      .addReg(StackPtr)</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;      .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a9f1fae6a5dbb6e378ca85df1fded8515">addImm</a>(-MaxAlign)</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;      .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a66fb0307f35f874cb65deb84eea9553f">setMIFlag</a>(<a class="code" href="classllvm_1_1MachineInstr.html#aafacf84de1cb994a92dc045f4aa1d518a78f1067d270179dff7915b90a03ce237">MachineInstr::FrameSetup</a>);</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    <span class="comment">// The EFLAGS implicit def is dead.</span></div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a302e45878c6dc1714334c7ce96d56846">getOperand</a>(3).<a class="code" href="classllvm_1_1MachineOperand.html#a61a42c85bd86c6ca4554e27d33c3f798">setIsDead</a>();</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;  }</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;  <span class="comment">// If there is an SUB32ri of ESP immediately before this instruction, merge</span></div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;  <span class="comment">// the two. This can be the case when tail call elimination is enabled and</span></div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;  <span class="comment">// the callee has more arguments then the caller.</span></div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;  NumBytes -= <a class="code" href="X86FrameLowering_8cpp.html#a9a6b9534fac20f1dbf973afc5caabc3f">mergeSPUpdates</a>(MBB, MBBI, StackPtr, <span class="keyword">true</span>);</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;  <span class="comment">// If there is an ADD32ri or SUB32ri of ESP immediately after this</span></div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;  <span class="comment">// instruction, merge the two instructions.</span></div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;  <a class="code" href="X86FrameLowering_8cpp.html#a6cc74ec571caa907bb2dfcd0d068297a">mergeSPUpdatesDown</a>(MBB, MBBI, StackPtr, &amp;NumBytes);</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;  <span class="comment">// Adjust stack pointer: ESP -= numbytes.</span></div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;  <span class="comment">// Windows and cygwin/mingw require a prologue helper routine when allocating</span></div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;  <span class="comment">// more than 4K bytes on the stack.  Windows uses __chkstk and cygwin/mingw</span></div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;  <span class="comment">// uses __alloca.  __alloca and the 32-bit version of __chkstk will probe the</span></div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;  <span class="comment">// stack and adjust the stack pointer in one go.  The 64-bit version of</span></div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;  <span class="comment">// __chkstk is only responsible for probing the stack.  The 64-bit prologue is</span></div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;  <span class="comment">// responsible for adjusting the stack pointer.  Touching the stack at 4K</span></div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;  <span class="comment">// increments is necessary to ensure that the guard pages used by the OS</span></div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;  <span class="comment">// virtual memory manager are allocated in correct sequence.</span></div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;  <span class="keywordflow">if</span> (NumBytes &gt;= 4096 &amp;&amp; STI.<a class="code" href="classllvm_1_1X86Subtarget.html#afedf24bb55abe8b8c8d9933b4e01c715">isOSWindows</a>() &amp;&amp; !STI.<a class="code" href="classllvm_1_1X86Subtarget.html#aeb1f5a1a73b6b472424a7a8a08126bb5">isTargetEnvMacho</a>()) {</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *StackProbeSymbol;</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;    <span class="keywordtype">bool</span> isSPUpdateNeeded = <span class="keyword">false</span>;</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;    <span class="keywordflow">if</span> (Is64Bit) {</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;      <span class="keywordflow">if</span> (STI.<a class="code" href="classllvm_1_1X86Subtarget.html#ad1c6e0b2b8cf40bb0c57dad5dbf0ea66">isTargetCygMing</a>())</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;        StackProbeSymbol = <span class="stringliteral">&quot;___chkstk&quot;</span>;</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;      <span class="keywordflow">else</span> {</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;        StackProbeSymbol = <span class="stringliteral">&quot;__chkstk&quot;</span>;</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;        isSPUpdateNeeded = <span class="keyword">true</span>;</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;      }</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (STI.<a class="code" href="classllvm_1_1X86Subtarget.html#ad1c6e0b2b8cf40bb0c57dad5dbf0ea66">isTargetCygMing</a>())</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;      StackProbeSymbol = <span class="stringliteral">&quot;_alloca&quot;</span>;</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;      StackProbeSymbol = <span class="stringliteral">&quot;_chkstk&quot;</span>;</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;    <span class="comment">// Check whether EAX is livein for this function.</span></div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    <span class="keywordtype">bool</span> isEAXAlive = <a class="code" href="X86FrameLowering_8cpp.html#a7cf542551b4f3cbad42d73ab0e1ddd34">isEAXLiveIn</a>(MF);</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    <span class="keywordflow">if</span> (isEAXAlive) {</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;      <span class="comment">// Sanity check that EAX is not livein for this function.</span></div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;      <span class="comment">// It should not be, so throw an assert.</span></div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;      assert(!Is64Bit &amp;&amp; <span class="stringliteral">&quot;EAX is livein in x64 case!&quot;</span>);</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;      <span class="comment">// Save EAX</span></div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;      <a class="code" href="namespacellvm.html#a980570dc1410d4ef53806f82028ca381">BuildMI</a>(MBB, MBBI, DL, TII.get(X86::PUSH32r))</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;        .addReg(<a class="code" href="README-SSE_8txt.html#abd9c765b9afafff59eb14d50c9e9fba1">X86::EAX</a>, <a class="code" href="namespacellvm_1_1RegState.html#a079b254e749130fbe5d740f314ca92daa9ddde91ef09476d28a088fe57f8e2921">RegState::Kill</a>)</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;        .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a66fb0307f35f874cb65deb84eea9553f">setMIFlag</a>(<a class="code" href="classllvm_1_1MachineInstr.html#aafacf84de1cb994a92dc045f4aa1d518a78f1067d270179dff7915b90a03ce237">MachineInstr::FrameSetup</a>);</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    }</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;    <span class="keywordflow">if</span> (Is64Bit) {</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;      <span class="comment">// Handle the 64-bit Windows ABI case where we need to call __chkstk.</span></div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;      <span class="comment">// Function prologue is responsible for adjusting the stack pointer.</span></div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;      <a class="code" href="namespacellvm.html#a980570dc1410d4ef53806f82028ca381">BuildMI</a>(MBB, MBBI, DL, TII.get(X86::MOV64ri), X86::RAX)</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;        .addImm(NumBytes)</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;        .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a66fb0307f35f874cb65deb84eea9553f">setMIFlag</a>(<a class="code" href="classllvm_1_1MachineInstr.html#aafacf84de1cb994a92dc045f4aa1d518a78f1067d270179dff7915b90a03ce237">MachineInstr::FrameSetup</a>);</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;      <span class="comment">// Allocate NumBytes-4 bytes on stack in case of isEAXAlive.</span></div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;      <span class="comment">// We&#39;ll also use 4 already allocated bytes for EAX.</span></div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;      <a class="code" href="namespacellvm.html#a980570dc1410d4ef53806f82028ca381">BuildMI</a>(MBB, MBBI, DL, TII.get(X86::MOV32ri), <a class="code" href="README-SSE_8txt.html#abd9c765b9afafff59eb14d50c9e9fba1">X86::EAX</a>)</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;        .addImm(isEAXAlive ? NumBytes - 4 : NumBytes)</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;        .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a66fb0307f35f874cb65deb84eea9553f">setMIFlag</a>(<a class="code" href="classllvm_1_1MachineInstr.html#aafacf84de1cb994a92dc045f4aa1d518a78f1067d270179dff7915b90a03ce237">MachineInstr::FrameSetup</a>);</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;    }</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;    <a class="code" href="namespacellvm.html#a980570dc1410d4ef53806f82028ca381">BuildMI</a>(MBB, MBBI, DL,</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;            TII.get(Is64Bit ? X86::W64ALLOCA : X86::CALLpcrel32))</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;      .addExternalSymbol(StackProbeSymbol)</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;      .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a5125cce72b214df09ca8f93dcbbf4c3a">addReg</a>(StackPtr,    <a class="code" href="namespacellvm_1_1RegState.html#a079b254e749130fbe5d740f314ca92daa72c17e2ff2d5af62a30e56ac152aa8d5">RegState::Define</a> | <a class="code" href="namespacellvm_1_1RegState.html#a079b254e749130fbe5d740f314ca92daa0fec8ba6f4a4dc758b725205985eee99">RegState::Implicit</a>)</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;      .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a5125cce72b214df09ca8f93dcbbf4c3a">addReg</a>(X86::EFLAGS, <a class="code" href="namespacellvm_1_1RegState.html#a079b254e749130fbe5d740f314ca92daa72c17e2ff2d5af62a30e56ac152aa8d5">RegState::Define</a> | <a class="code" href="namespacellvm_1_1RegState.html#a079b254e749130fbe5d740f314ca92daa0fec8ba6f4a4dc758b725205985eee99">RegState::Implicit</a>)</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;      .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a66fb0307f35f874cb65deb84eea9553f">setMIFlag</a>(<a class="code" href="classllvm_1_1MachineInstr.html#aafacf84de1cb994a92dc045f4aa1d518a78f1067d270179dff7915b90a03ce237">MachineInstr::FrameSetup</a>);</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    <span class="comment">// MSVC x64&#39;s __chkstk does not adjust %rsp itself.</span></div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;    <span class="comment">// It also does not clobber %rax so we can reuse it when adjusting %rsp.</span></div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;    <span class="keywordflow">if</span> (isSPUpdateNeeded) {</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;      <a class="code" href="namespacellvm.html#a980570dc1410d4ef53806f82028ca381">BuildMI</a>(MBB, MBBI, DL, TII.get(X86::SUB64rr), StackPtr)</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;        .addReg(StackPtr)</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;        .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a5125cce72b214df09ca8f93dcbbf4c3a">addReg</a>(X86::RAX)</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;        .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a66fb0307f35f874cb65deb84eea9553f">setMIFlag</a>(<a class="code" href="classllvm_1_1MachineInstr.html#aafacf84de1cb994a92dc045f4aa1d518a78f1067d270179dff7915b90a03ce237">MachineInstr::FrameSetup</a>);</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    }</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    <span class="keywordflow">if</span> (isEAXAlive) {</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;        <span class="comment">// Restore EAX</span></div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;        <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *<a class="code" href="namespacellvm_1_1A64CC.html#af5804bc0518be9568f73db566e4d6f46a2db5e7546f960277ff98f96cd5624442">MI</a> = <a class="code" href="namespacellvm.html#afad63f3314b8553ee3c26d020b3ce09e">addRegOffset</a>(<a class="code" href="namespacellvm.html#a980570dc1410d4ef53806f82028ca381">BuildMI</a>(MF, DL, TII.get(X86::MOV32rm),</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;                                                <a class="code" href="README-SSE_8txt.html#abd9c765b9afafff59eb14d50c9e9fba1">X86::EAX</a>),</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;                                        StackPtr, <span class="keyword">false</span>, NumBytes - 4);</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;        MI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#aba86b0738c2ab2a52688b846c45bfe59">setFlag</a>(<a class="code" href="classllvm_1_1MachineInstr.html#aafacf84de1cb994a92dc045f4aa1d518a78f1067d270179dff7915b90a03ce237">MachineInstr::FrameSetup</a>);</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;        MBB.<a class="code" href="classllvm_1_1MachineBasicBlock.html#a8d02c1e6ef20f42c10d6f4e7234efd61">insert</a>(MBBI, MI);</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    }</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (NumBytes)</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    <a class="code" href="namespacellvm.html#affbfd713b02cc594a29424c8f41b2815">emitSPUpdate</a>(MBB, MBBI, StackPtr, -(int64_t)NumBytes, Is64Bit, IsLP64,</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;                 UseLEA, TII, *RegInfo);</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;  <span class="comment">// If we need a base pointer, set it up here. It&#39;s whatever the value</span></div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;  <span class="comment">// of the stack pointer is at this point. Any variable size objects</span></div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;  <span class="comment">// will be allocated after this, so we can still use the base pointer</span></div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;  <span class="comment">// to reference locals.</span></div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;  <span class="keywordflow">if</span> (RegInfo-&gt;<a class="code" href="classllvm_1_1X86RegisterInfo.html#ad37a65804edd5f913012ea82e22cca33">hasBasePointer</a>(MF)) {</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;    <span class="comment">// Update the frame pointer with the current stack pointer.</span></div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    <span class="keywordtype">unsigned</span> Opc = Is64Bit ? X86::MOV64rr : X86::MOV32rr;</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    <a class="code" href="namespacellvm.html#a980570dc1410d4ef53806f82028ca381">BuildMI</a>(MBB, MBBI, DL, TII.get(Opc), BasePtr)</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;      .addReg(StackPtr)</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;      .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a66fb0307f35f874cb65deb84eea9553f">setMIFlag</a>(<a class="code" href="classllvm_1_1MachineInstr.html#aafacf84de1cb994a92dc045f4aa1d518a78f1067d270179dff7915b90a03ce237">MachineInstr::FrameSetup</a>);</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;  }</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;  <span class="keywordflow">if</span> (( (!HasFP &amp;&amp; NumBytes) || PushedRegs) &amp;&amp; needsFrameMoves) {</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;    <span class="comment">// Mark end of stack pointer adjustment.</span></div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    <a class="code" href="classllvm_1_1MCSymbol.html">MCSymbol</a> *Label = MMI.<a class="code" href="classllvm_1_1MachineModuleInfo.html#a215f3061b9e7ad1b1ffac03cfc580665">getContext</a>().<a class="code" href="classllvm_1_1MCContext.html#af0efba8326e35ce320f4d2fd346cea3f">CreateTempSymbol</a>();</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;    <a class="code" href="namespacellvm.html#a980570dc1410d4ef53806f82028ca381">BuildMI</a>(MBB, MBBI, DL, TII.get(<a class="code" href="namespacellvm_1_1TargetOpcode.html#a348d4259b5fa6a8ecfe94e7ae512e1a8ac4061808eca922630aa39fc5c6f43896">X86::PROLOG_LABEL</a>))</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;      .addSym(Label);</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;    <span class="keywordflow">if</span> (!HasFP &amp;&amp; NumBytes) {</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;      <span class="comment">// Define the current CFA rule to use the provided offset.</span></div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;      assert(StackSize);</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;      MMI.<a class="code" href="classllvm_1_1MachineModuleInfo.html#a5747190c7d1616888ef933167e632953">addFrameInst</a>(<a class="code" href="classllvm_1_1MCCFIInstruction.html#a574f705ef18dd3e6c46c0a6b0ae81b08">MCCFIInstruction::createDefCfaOffset</a>(</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;          Label, -StackSize + stackGrowth));</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;    }</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;    <span class="comment">// Emit DWARF info specifying the offsets of the callee-saved registers.</span></div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;    <span class="keywordflow">if</span> (PushedRegs)</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;      <a class="code" href="classllvm_1_1X86FrameLowering.html#a439b4e5e61ca54bfd7f11876db933f53">emitCalleeSavedFrameMoves</a>(MF, Label, HasFP ? FramePtr : StackPtr);</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;  }</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;}</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;</div><div class="line"><a name="l00712"></a><span class="lineno"><a class="line" href="classllvm_1_1X86FrameLowering.html#a74373af665170dda9817779430b67295">  712</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classllvm_1_1X86FrameLowering.html#a74373af665170dda9817779430b67295">X86FrameLowering::emitEpilogue</a>(<a class="code" href="classllvm_1_1MachineFunction.html">MachineFunction</a> &amp;MF,</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;                                    <a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> &amp;MBB)<span class="keyword"> const </span>{</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1MachineFrameInfo.html">MachineFrameInfo</a> *MFI = MF.<a class="code" href="classllvm_1_1MachineFunction.html#a4ad4295a88187ea1ae12ecfcfa18a70f">getFrameInfo</a>();</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;  <a class="code" href="classllvm_1_1X86MachineFunctionInfo.html">X86MachineFunctionInfo</a> *X86FI = MF.<a class="code" href="classllvm_1_1MachineFunction.html#ac2dc0fa143c9f2127f0501734577a0a0">getInfo</a>&lt;<a class="code" href="classllvm_1_1X86MachineFunctionInfo.html">X86MachineFunctionInfo</a>&gt;();</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1X86RegisterInfo.html">X86RegisterInfo</a> *RegInfo = TM.<a class="code" href="classllvm_1_1X86TargetMachine.html#a350524cf8e1e0e53a6d856188d851ec4">getRegisterInfo</a>();</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1X86InstrInfo.html">X86InstrInfo</a> &amp;<a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a> = *TM.<a class="code" href="classllvm_1_1X86TargetMachine.html#a245ed1de411cd3ba114322a573b524f5">getInstrInfo</a>();</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;  <a class="code" href="classllvm_1_1MachineBasicBlock.html#ac51be7ff80fe8d6ae5e8c0acb194908a">MachineBasicBlock::iterator</a> MBBI = MBB.<a class="code" href="classllvm_1_1MachineBasicBlock.html#a4c711446100d52415f8e142855c223e1">getLastNonDebugInstr</a>();</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;  assert(MBBI != MBB.<a class="code" href="classllvm_1_1MachineBasicBlock.html#acbc921830578e2741be6549db716c0ce">end</a>() &amp;&amp; <span class="stringliteral">&quot;Returning block has no instructions&quot;</span>);</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;  <span class="keywordtype">unsigned</span> RetOpcode = MBBI-&gt;getOpcode();</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;  <a class="code" href="classllvm_1_1DebugLoc.html">DebugLoc</a> DL = MBBI-&gt;getDebugLoc();</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;  <span class="keywordtype">bool</span> Is64Bit = STI.<a class="code" href="classllvm_1_1X86Subtarget.html#a5314399c907d77b514ec837e8527a9de">is64Bit</a>();</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;  <span class="keywordtype">bool</span> IsLP64 = STI.<a class="code" href="classllvm_1_1X86Subtarget.html#ae380c7f0dbea1c8e93b42f1a1708e1a0">isTarget64BitLP64</a>();</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;  <span class="keywordtype">bool</span> UseLEA = STI.<a class="code" href="classllvm_1_1X86Subtarget.html#a9efe6935f37edac03b15a66b138dec8c">useLeaForSP</a>();</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;  <span class="keywordtype">unsigned</span> StackAlign = <a class="code" href="classllvm_1_1TargetFrameLowering.html#a360555ed6db3b28a33fa5449a0335f19">getStackAlignment</a>();</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;  <span class="keywordtype">unsigned</span> SlotSize = RegInfo-&gt;getSlotSize();</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;  <span class="keywordtype">unsigned</span> FramePtr = RegInfo-&gt;getFrameRegister(MF);</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;  <span class="keywordtype">unsigned</span> StackPtr = RegInfo-&gt;getStackRegister();</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;  <span class="keywordflow">switch</span> (RetOpcode) {</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;  <span class="keywordflow">default</span>:</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;    <a class="code" href="ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a>(<span class="stringliteral">&quot;Can only insert epilog into returning blocks&quot;</span>);</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;  <span class="keywordflow">case</span> X86::RET:</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;  <span class="keywordflow">case</span> X86::RETI:</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;  <span class="keywordflow">case</span> X86::TCRETURNdi:</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;  <span class="keywordflow">case</span> X86::TCRETURNri:</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;  <span class="keywordflow">case</span> X86::TCRETURNmi:</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;  <span class="keywordflow">case</span> X86::TCRETURNdi64:</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;  <span class="keywordflow">case</span> X86::TCRETURNri64:</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;  <span class="keywordflow">case</span> X86::TCRETURNmi64:</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a4edf35e2383003ff20057e5a45012a55">X86::EH_RETURN</a>:</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;  <span class="keywordflow">case</span> X86::EH_RETURN64:</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;    <span class="keywordflow">break</span>;  <span class="comment">// These are ok</span></div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;  }</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;  <span class="comment">// Get the number of bytes to allocate from the FrameInfo.</span></div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;  uint64_t StackSize = MFI-&gt;<a class="code" href="classllvm_1_1MachineFrameInfo.html#a34874094b3ba8b56fd68801250f77183">getStackSize</a>();</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;  uint64_t MaxAlign  = MFI-&gt;<a class="code" href="classllvm_1_1MachineFrameInfo.html#a0af0a11b8eda54e79422c199cb687f5c">getMaxAlignment</a>();</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;  <span class="keywordtype">unsigned</span> CSSize = X86FI-&gt;<a class="code" href="classllvm_1_1X86MachineFunctionInfo.html#a48ab7f9b817ff462e08d8a5858b4c6fc">getCalleeSavedFrameSize</a>();</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;  uint64_t NumBytes = 0;</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;  <span class="comment">// If we&#39;re forcing a stack realignment we can&#39;t rely on just the frame</span></div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;  <span class="comment">// info, we need to know the ABI stack alignment as well in case we</span></div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;  <span class="comment">// have a call out.  Otherwise just make sure we have some alignment - we&#39;ll</span></div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;  <span class="comment">// go with the minimum.</span></div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;  <span class="keywordflow">if</span> (ForceStackAlign) {</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;    <span class="keywordflow">if</span> (MFI-&gt;<a class="code" href="classllvm_1_1MachineFrameInfo.html#ad104abdabbcb68deacc60c0aea1bca34">hasCalls</a>())</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;      MaxAlign = (StackAlign &gt; MaxAlign) ? StackAlign : MaxAlign;</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;      MaxAlign = MaxAlign ? MaxAlign : 4;</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;  }</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1X86FrameLowering.html#a649e4f2412bff7a236d44c0c52982640">hasFP</a>(MF)) {</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;    <span class="comment">// Calculate required stack adjustment.</span></div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;    uint64_t FrameSize = StackSize - SlotSize;</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;    <span class="keywordflow">if</span> (RegInfo-&gt;needsStackRealignment(MF)) {</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;      <span class="comment">// Callee-saved registers were pushed on stack before the stack</span></div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;      <span class="comment">// was realigned.</span></div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;      FrameSize -= CSSize;</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;      NumBytes = (FrameSize + MaxAlign - 1) / MaxAlign * MaxAlign;</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;      NumBytes = FrameSize - CSSize;</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;    }</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;    <span class="comment">// Pop EBP.</span></div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;    <a class="code" href="namespacellvm.html#a980570dc1410d4ef53806f82028ca381">BuildMI</a>(MBB, MBBI, DL,</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;            TII.get(Is64Bit ? X86::POP64r : X86::POP32r), FramePtr);</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;    NumBytes = StackSize - CSSize;</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;  }</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;  <span class="comment">// Skip the callee-saved pop instructions.</span></div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;  <span class="keywordflow">while</span> (MBBI != MBB.<a class="code" href="classllvm_1_1MachineBasicBlock.html#ab2d91e7bec944efcbc39d8e30644f111">begin</a>()) {</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;    <a class="code" href="classllvm_1_1MachineBasicBlock.html#ac51be7ff80fe8d6ae5e8c0acb194908a">MachineBasicBlock::iterator</a> PI = <a class="code" href="namespacellvm.html#a7923e3e207de8bc1d0d6a5091316ddde">prior</a>(MBBI);</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;    <span class="keywordtype">unsigned</span> Opc = PI-&gt;getOpcode();</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;    <span class="keywordflow">if</span> (Opc != X86::POP32r &amp;&amp; Opc != X86::POP64r &amp;&amp; Opc != <a class="code" href="namespacellvm_1_1TargetOpcode.html#a348d4259b5fa6a8ecfe94e7ae512e1a8ad3fe1d0d0fe22d208bcd8712b2ea051a">X86::DBG_VALUE</a> &amp;&amp;</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;        !PI-&gt;isTerminator())</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;    --MBBI;</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;  }</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;  <a class="code" href="classllvm_1_1MachineBasicBlock.html#ac51be7ff80fe8d6ae5e8c0acb194908a">MachineBasicBlock::iterator</a> FirstCSPop = MBBI;</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;  DL = MBBI-&gt;getDebugLoc();</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;  <span class="comment">// If there is an ADD32ri or SUB32ri of ESP immediately before this</span></div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;  <span class="comment">// instruction, merge the two instructions.</span></div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;  <span class="keywordflow">if</span> (NumBytes || MFI-&gt;<a class="code" href="classllvm_1_1MachineFrameInfo.html#a5cd76eb2aeed3ae46da1bb1b132f1831">hasVarSizedObjects</a>())</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;    <a class="code" href="X86FrameLowering_8cpp.html#aa371140d370a73e4d67cf70697b459a3">mergeSPUpdatesUp</a>(MBB, MBBI, StackPtr, &amp;NumBytes);</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;  <span class="comment">// If dynamic alloca is used, then reset esp to point to the last callee-saved</span></div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;  <span class="comment">// slot before popping them off! Same applies for the case, when stack was</span></div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;  <span class="comment">// realigned.</span></div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;  <span class="keywordflow">if</span> (RegInfo-&gt;needsStackRealignment(MF) || MFI-&gt;<a class="code" href="classllvm_1_1MachineFrameInfo.html#a5cd76eb2aeed3ae46da1bb1b132f1831">hasVarSizedObjects</a>()) {</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;    <span class="keywordflow">if</span> (RegInfo-&gt;needsStackRealignment(MF))</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;      MBBI = FirstCSPop;</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;    <span class="keywordflow">if</span> (CSSize != 0) {</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;      <span class="keywordtype">unsigned</span> Opc = <a class="code" href="X86FrameLowering_8cpp.html#a343c24d09ffb2fe5a9d302d2c2e5a9c5">getLEArOpcode</a>(IsLP64);</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;      <a class="code" href="namespacellvm.html#afad63f3314b8553ee3c26d020b3ce09e">addRegOffset</a>(<a class="code" href="namespacellvm.html#a980570dc1410d4ef53806f82028ca381">BuildMI</a>(MBB, MBBI, DL, TII.get(Opc), StackPtr),</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;                   FramePtr, <span class="keyword">false</span>, -CSSize);</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;      <span class="keywordtype">unsigned</span> Opc = (Is64Bit ? X86::MOV64rr : X86::MOV32rr);</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;      <a class="code" href="namespacellvm.html#a980570dc1410d4ef53806f82028ca381">BuildMI</a>(MBB, MBBI, DL, TII.get(Opc), StackPtr)</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;        .addReg(FramePtr);</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;    }</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (NumBytes) {</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;    <span class="comment">// Adjust stack pointer back: ESP += numbytes.</span></div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;    <a class="code" href="namespacellvm.html#affbfd713b02cc594a29424c8f41b2815">emitSPUpdate</a>(MBB, MBBI, StackPtr, NumBytes, Is64Bit, IsLP64, UseLEA,</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;                 TII, *RegInfo);</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;  }</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;  <span class="comment">// We&#39;re returning from function via eh_return.</span></div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;  <span class="keywordflow">if</span> (RetOpcode == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a4edf35e2383003ff20057e5a45012a55">X86::EH_RETURN</a> || RetOpcode == X86::EH_RETURN64) {</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;    MBBI = MBB.<a class="code" href="classllvm_1_1MachineBasicBlock.html#a4c711446100d52415f8e142855c223e1">getLastNonDebugInstr</a>();</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;    <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;DestAddr  = MBBI-&gt;getOperand(0);</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;    assert(DestAddr.<a class="code" href="classllvm_1_1MachineOperand.html#ad8198d6d83af9410d867136e33fbf4b2">isReg</a>() &amp;&amp; <span class="stringliteral">&quot;Offset should be in register!&quot;</span>);</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;    <a class="code" href="namespacellvm.html#a980570dc1410d4ef53806f82028ca381">BuildMI</a>(MBB, MBBI, DL,</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;            TII.get(Is64Bit ? X86::MOV64rr : X86::MOV32rr),</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;            StackPtr).addReg(DestAddr.<a class="code" href="classllvm_1_1MachineOperand.html#ab75f703d251cc0ce0206fe00a999db86">getReg</a>());</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (RetOpcode == X86::TCRETURNri || RetOpcode == X86::TCRETURNdi ||</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;             RetOpcode == X86::TCRETURNmi ||</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;             RetOpcode == X86::TCRETURNri64 || RetOpcode == X86::TCRETURNdi64 ||</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;             RetOpcode == X86::TCRETURNmi64) {</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="namespacellvm.html#a4d4191a557764471c0f130506c25e5ef">isMem</a> = RetOpcode == X86::TCRETURNmi || RetOpcode == X86::TCRETURNmi64;</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;    <span class="comment">// Tail call return: adjust the stack pointer and jump to callee.</span></div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;    MBBI = MBB.<a class="code" href="classllvm_1_1MachineBasicBlock.html#a4c711446100d52415f8e142855c223e1">getLastNonDebugInstr</a>();</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;    <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;JumpTarget = MBBI-&gt;getOperand(0);</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;    <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;StackAdjust = MBBI-&gt;getOperand(isMem ? 5 : 1);</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;    assert(StackAdjust.<a class="code" href="classllvm_1_1MachineOperand.html#a2ac18ceda9f2857fea2e5cc4e8bf4ff5">isImm</a>() &amp;&amp; <span class="stringliteral">&quot;Expecting immediate value.&quot;</span>);</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;    <span class="comment">// Adjust stack pointer.</span></div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;    <span class="keywordtype">int</span> StackAdj = StackAdjust.<a class="code" href="classllvm_1_1MachineOperand.html#a7059d68a29d5ecfb37623ab45cdb4e8d">getImm</a>();</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;    <span class="keywordtype">int</span> MaxTCDelta = X86FI-&gt;<a class="code" href="classllvm_1_1X86MachineFunctionInfo.html#ae2a2c9153ec666e20698a5d3956ac2d4">getTCReturnAddrDelta</a>();</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;    <span class="keywordtype">int</span> Offset = 0;</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;    assert(MaxTCDelta &lt;= 0 &amp;&amp; <span class="stringliteral">&quot;MaxTCDelta should never be positive&quot;</span>);</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;    <span class="comment">// Incoporate the retaddr area.</span></div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;    Offset = StackAdj-MaxTCDelta;</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;    assert(Offset &gt;= 0 &amp;&amp; <span class="stringliteral">&quot;Offset should never be negative&quot;</span>);</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;    <span class="keywordflow">if</span> (Offset) {</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;      <span class="comment">// Check for possible merge with preceding ADD instruction.</span></div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;      Offset += <a class="code" href="X86FrameLowering_8cpp.html#a9a6b9534fac20f1dbf973afc5caabc3f">mergeSPUpdates</a>(MBB, MBBI, StackPtr, <span class="keyword">true</span>);</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;      <a class="code" href="namespacellvm.html#affbfd713b02cc594a29424c8f41b2815">emitSPUpdate</a>(MBB, MBBI, StackPtr, Offset, Is64Bit, IsLP64,</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;                   UseLEA, TII, *RegInfo);</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;    }</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;    <span class="comment">// Jump to label or value in register.</span></div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;    <span class="keywordflow">if</span> (RetOpcode == X86::TCRETURNdi || RetOpcode == X86::TCRETURNdi64) {</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;      <a class="code" href="classllvm_1_1MachineInstrBuilder.html">MachineInstrBuilder</a> MIB =</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;        <a class="code" href="namespacellvm.html#a980570dc1410d4ef53806f82028ca381">BuildMI</a>(MBB, MBBI, DL, TII.get((RetOpcode == X86::TCRETURNdi)</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;                                       ? X86::TAILJMPd : X86::TAILJMPd64));</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;      <span class="keywordflow">if</span> (JumpTarget.<a class="code" href="classllvm_1_1MachineOperand.html#a58048141ed81d581f3fb9a797f3186ee">isGlobal</a>())</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;        MIB.<a class="code" href="classllvm_1_1MachineInstrBuilder.html#aec72fc7a6cc79a1ef53e5d5dbccb846c">addGlobalAddress</a>(JumpTarget.<a class="code" href="classllvm_1_1MachineOperand.html#a0c3a2a5a49795f8750ebd02dc0e6e11e">getGlobal</a>(), JumpTarget.<a class="code" href="classllvm_1_1MachineOperand.html#ae73de4f077ea9862af9611652396202b">getOffset</a>(),</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;                             JumpTarget.<a class="code" href="classllvm_1_1MachineOperand.html#a91aa25eac8330cdbab5f7f12fb29359d">getTargetFlags</a>());</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;      <span class="keywordflow">else</span> {</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;        assert(JumpTarget.<a class="code" href="classllvm_1_1MachineOperand.html#a312ddf2fd2162ef0c552d913369cd57f">isSymbol</a>());</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;        MIB.<a class="code" href="classllvm_1_1MachineInstrBuilder.html#ace690c220f3b141bdf98c86635783d8f">addExternalSymbol</a>(JumpTarget.<a class="code" href="classllvm_1_1MachineOperand.html#ad9456ef14a72da4e4def5d8747c41a09">getSymbolName</a>(),</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;                              JumpTarget.<a class="code" href="classllvm_1_1MachineOperand.html#a91aa25eac8330cdbab5f7f12fb29359d">getTargetFlags</a>());</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;      }</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (RetOpcode == X86::TCRETURNmi || RetOpcode == X86::TCRETURNmi64) {</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;      <a class="code" href="classllvm_1_1MachineInstrBuilder.html">MachineInstrBuilder</a> MIB =</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;        <a class="code" href="namespacellvm.html#a980570dc1410d4ef53806f82028ca381">BuildMI</a>(MBB, MBBI, DL, TII.get((RetOpcode == X86::TCRETURNmi)</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;                                       ? X86::TAILJMPm : X86::TAILJMPm64));</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != 5; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;        MIB.<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a34ab07c56acf0fe7f68a6da0d514bec7">addOperand</a>(MBBI-&gt;getOperand(<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>));</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (RetOpcode == X86::TCRETURNri64) {</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;      <a class="code" href="namespacellvm.html#a980570dc1410d4ef53806f82028ca381">BuildMI</a>(MBB, MBBI, DL, TII.get(X86::TAILJMPr64)).</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;        addReg(JumpTarget.<a class="code" href="classllvm_1_1MachineOperand.html#ab75f703d251cc0ce0206fe00a999db86">getReg</a>(), <a class="code" href="namespacellvm_1_1RegState.html#a079b254e749130fbe5d740f314ca92daa9ddde91ef09476d28a088fe57f8e2921">RegState::Kill</a>);</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;      <a class="code" href="namespacellvm.html#a980570dc1410d4ef53806f82028ca381">BuildMI</a>(MBB, MBBI, DL, TII.get(X86::TAILJMPr)).</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;        addReg(JumpTarget.<a class="code" href="classllvm_1_1MachineOperand.html#ab75f703d251cc0ce0206fe00a999db86">getReg</a>(), <a class="code" href="namespacellvm_1_1RegState.html#a079b254e749130fbe5d740f314ca92daa9ddde91ef09476d28a088fe57f8e2921">RegState::Kill</a>);</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;    }</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;    <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *NewMI = <a class="code" href="namespacellvm.html#a7923e3e207de8bc1d0d6a5091316ddde">prior</a>(MBBI);</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;    NewMI-&gt;copyImplicitOps(MF, MBBI);</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;    <span class="comment">// Delete the pseudo instruction TCRETURN.</span></div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;    MBB.<a class="code" href="classllvm_1_1MachineBasicBlock.html#a537a9265c55392ab47d44954f27db538">erase</a>(MBBI);</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((RetOpcode == X86::RET || RetOpcode == X86::RETI) &amp;&amp;</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;             (X86FI-&gt;<a class="code" href="classllvm_1_1X86MachineFunctionInfo.html#ae2a2c9153ec666e20698a5d3956ac2d4">getTCReturnAddrDelta</a>() &lt; 0)) {</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;    <span class="comment">// Add the return addr area delta back since we are not tail calling.</span></div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;    <span class="keywordtype">int</span> delta = -1*X86FI-&gt;<a class="code" href="classllvm_1_1X86MachineFunctionInfo.html#ae2a2c9153ec666e20698a5d3956ac2d4">getTCReturnAddrDelta</a>();</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;    MBBI = MBB.<a class="code" href="classllvm_1_1MachineBasicBlock.html#a4c711446100d52415f8e142855c223e1">getLastNonDebugInstr</a>();</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;    <span class="comment">// Check for possible merge with preceding ADD instruction.</span></div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;    delta += <a class="code" href="X86FrameLowering_8cpp.html#a9a6b9534fac20f1dbf973afc5caabc3f">mergeSPUpdates</a>(MBB, MBBI, StackPtr, <span class="keyword">true</span>);</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;    <a class="code" href="namespacellvm.html#affbfd713b02cc594a29424c8f41b2815">emitSPUpdate</a>(MBB, MBBI, StackPtr, delta, Is64Bit, IsLP64, UseLEA, TII,</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;                 *RegInfo);</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;  }</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;}</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;</div><div class="line"><a name="l00904"></a><span class="lineno"><a class="line" href="classllvm_1_1X86FrameLowering.html#a68c7fcd6845964d09de5e8ec1f4577c1">  904</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classllvm_1_1X86FrameLowering.html#a68c7fcd6845964d09de5e8ec1f4577c1">X86FrameLowering::getFrameIndexOffset</a>(<span class="keyword">const</span> <a class="code" href="classllvm_1_1MachineFunction.html">MachineFunction</a> &amp;MF, <span class="keywordtype">int</span> FI)<span class="keyword"> const </span>{</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1X86RegisterInfo.html">X86RegisterInfo</a> *RegInfo =</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;    <span class="keyword">static_cast&lt;</span><span class="keyword">const </span><a class="code" href="classllvm_1_1X86RegisterInfo.html">X86RegisterInfo</a>*<span class="keyword">&gt;</span>(MF.<a class="code" href="classllvm_1_1MachineFunction.html#a6745c3bfdfc5b0643b078b96df2db252">getTarget</a>().<a class="code" href="classllvm_1_1TargetMachine.html#a70b47eca6a99c87b81f4c1b1455dc090">getRegisterInfo</a>());</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1MachineFrameInfo.html">MachineFrameInfo</a> *MFI = MF.<a class="code" href="classllvm_1_1MachineFunction.html#a4ad4295a88187ea1ae12ecfcfa18a70f">getFrameInfo</a>();</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;  <span class="keywordtype">int</span> Offset = MFI-&gt;<a class="code" href="classllvm_1_1MachineFrameInfo.html#aefac52e417d31959e35868879aba672b">getObjectOffset</a>(FI) - <a class="code" href="classllvm_1_1TargetFrameLowering.html#a32f0831ccaa8dbbbf0f779125e6d5dd8">getOffsetOfLocalArea</a>();</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;  uint64_t StackSize = MFI-&gt;<a class="code" href="classllvm_1_1MachineFrameInfo.html#a34874094b3ba8b56fd68801250f77183">getStackSize</a>();</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;  <span class="keywordflow">if</span> (RegInfo-&gt;<a class="code" href="classllvm_1_1X86RegisterInfo.html#ad37a65804edd5f913012ea82e22cca33">hasBasePointer</a>(MF)) {</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;    assert (<a class="code" href="classllvm_1_1X86FrameLowering.html#a649e4f2412bff7a236d44c0c52982640">hasFP</a>(MF) &amp;&amp; <span class="stringliteral">&quot;VLAs and dynamic stack realign, but no FP?!&quot;</span>);</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;    <span class="keywordflow">if</span> (FI &lt; 0) {</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;      <span class="comment">// Skip the saved EBP.</span></div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;      <span class="keywordflow">return</span> Offset + RegInfo-&gt;<a class="code" href="classllvm_1_1X86RegisterInfo.html#a52f78fb379677e9270168daf72a808bd">getSlotSize</a>();</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;      assert((-(Offset + StackSize)) % MFI-&gt;<a class="code" href="classllvm_1_1MachineFrameInfo.html#ae146d6827dae2ff77fc65b7fd319dbb8">getObjectAlignment</a>(FI) == 0);</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;      <span class="keywordflow">return</span> Offset + StackSize;</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;    }</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (RegInfo-&gt;<a class="code" href="classllvm_1_1X86RegisterInfo.html#acfd0722e4669be2f7e16059679406d9f">needsStackRealignment</a>(MF)) {</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;    <span class="keywordflow">if</span> (FI &lt; 0) {</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;      <span class="comment">// Skip the saved EBP.</span></div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;      <span class="keywordflow">return</span> Offset + RegInfo-&gt;<a class="code" href="classllvm_1_1X86RegisterInfo.html#a52f78fb379677e9270168daf72a808bd">getSlotSize</a>();</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;      assert((-(Offset + StackSize)) % MFI-&gt;<a class="code" href="classllvm_1_1MachineFrameInfo.html#ae146d6827dae2ff77fc65b7fd319dbb8">getObjectAlignment</a>(FI) == 0);</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;      <span class="keywordflow">return</span> Offset + StackSize;</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;    }</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;    <span class="comment">// FIXME: Support tail calls</span></div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classllvm_1_1X86FrameLowering.html#a649e4f2412bff7a236d44c0c52982640">hasFP</a>(MF))</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;      <span class="keywordflow">return</span> Offset + StackSize;</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;    <span class="comment">// Skip the saved EBP.</span></div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;    Offset += RegInfo-&gt;<a class="code" href="classllvm_1_1X86RegisterInfo.html#a52f78fb379677e9270168daf72a808bd">getSlotSize</a>();</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;    <span class="comment">// Skip the RETADDR move area</span></div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1X86MachineFunctionInfo.html">X86MachineFunctionInfo</a> *X86FI = MF.<a class="code" href="classllvm_1_1MachineFunction.html#ac2dc0fa143c9f2127f0501734577a0a0">getInfo</a>&lt;<a class="code" href="classllvm_1_1X86MachineFunctionInfo.html">X86MachineFunctionInfo</a>&gt;();</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;    <span class="keywordtype">int</span> TailCallReturnAddrDelta = X86FI-&gt;<a class="code" href="classllvm_1_1X86MachineFunctionInfo.html#ae2a2c9153ec666e20698a5d3956ac2d4">getTCReturnAddrDelta</a>();</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;    <span class="keywordflow">if</span> (TailCallReturnAddrDelta &lt; 0)</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;      Offset -= TailCallReturnAddrDelta;</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;  }</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;  <span class="keywordflow">return</span> Offset;</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;}</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;</div><div class="line"><a name="l00946"></a><span class="lineno"><a class="line" href="classllvm_1_1X86FrameLowering.html#a1687406681a3072d9725f904f282504d">  946</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classllvm_1_1X86FrameLowering.html#a1687406681a3072d9725f904f282504d">X86FrameLowering::getFrameIndexReference</a>(<span class="keyword">const</span> <a class="code" href="classllvm_1_1MachineFunction.html">MachineFunction</a> &amp;MF, <span class="keywordtype">int</span> FI,</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;                                             <span class="keywordtype">unsigned</span> &amp;FrameReg)<span class="keyword"> const </span>{</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1X86RegisterInfo.html">X86RegisterInfo</a> *RegInfo =</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;      <span class="keyword">static_cast&lt;</span><span class="keyword">const </span><a class="code" href="classllvm_1_1X86RegisterInfo.html">X86RegisterInfo</a>*<span class="keyword">&gt;</span>(MF.<a class="code" href="classllvm_1_1MachineFunction.html#a6745c3bfdfc5b0643b078b96df2db252">getTarget</a>().<a class="code" href="classllvm_1_1TargetMachine.html#a70b47eca6a99c87b81f4c1b1455dc090">getRegisterInfo</a>());</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;  <span class="comment">// We can&#39;t calculate offset from frame pointer if the stack is realigned,</span></div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;  <span class="comment">// so enforce usage of stack/base pointer.  The base pointer is used when we</span></div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;  <span class="comment">// have dynamic allocas in addition to dynamic realignment.</span></div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;  <span class="keywordflow">if</span> (RegInfo-&gt;<a class="code" href="classllvm_1_1X86RegisterInfo.html#ad37a65804edd5f913012ea82e22cca33">hasBasePointer</a>(MF))</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;    FrameReg = RegInfo-&gt;<a class="code" href="classllvm_1_1X86RegisterInfo.html#aa9f703a288ef91efae26a538d96037d6">getBaseRegister</a>();</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (RegInfo-&gt;<a class="code" href="classllvm_1_1X86RegisterInfo.html#acfd0722e4669be2f7e16059679406d9f">needsStackRealignment</a>(MF))</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;    FrameReg = RegInfo-&gt;<a class="code" href="classllvm_1_1X86RegisterInfo.html#ac26e69b92e7ee67cfe9766db55b221da">getStackRegister</a>();</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;    FrameReg = RegInfo-&gt;<a class="code" href="classllvm_1_1X86RegisterInfo.html#a2883bb621245229de23a6396b1ef81b7">getFrameRegister</a>(MF);</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1X86FrameLowering.html#a68c7fcd6845964d09de5e8ec1f4577c1">getFrameIndexOffset</a>(MF, FI);</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;}</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;</div><div class="line"><a name="l00962"></a><span class="lineno"><a class="line" href="classllvm_1_1X86FrameLowering.html#ab28bee10ef6d895aa3271a7c8cae45d7">  962</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classllvm_1_1X86FrameLowering.html#ab28bee10ef6d895aa3271a7c8cae45d7">X86FrameLowering::spillCalleeSavedRegisters</a>(<a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> &amp;MBB,</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;                                             <a class="code" href="classllvm_1_1MachineBasicBlock.html#ac51be7ff80fe8d6ae5e8c0acb194908a">MachineBasicBlock::iterator</a> <a class="code" href="namespacellvm_1_1A64CC.html#af5804bc0518be9568f73db566e4d6f46a2db5e7546f960277ff98f96cd5624442">MI</a>,</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;                                        <span class="keyword">const</span> std::vector&lt;CalleeSavedInfo&gt; &amp;CSI,</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;                                          <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetRegisterInfo.html">TargetRegisterInfo</a> *TRI)<span class="keyword"> const </span>{</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;  <span class="keywordflow">if</span> (CSI.empty())</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;  <a class="code" href="classllvm_1_1DebugLoc.html">DebugLoc</a> DL = MBB.<a class="code" href="classllvm_1_1MachineBasicBlock.html#a45028d169700cac71cf6c613a94236ee">findDebugLoc</a>(MI);</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;  <a class="code" href="classllvm_1_1MachineFunction.html">MachineFunction</a> &amp;MF = *MBB.<a class="code" href="classllvm_1_1MachineBasicBlock.html#af2e482ff2a9253ec6bc2285491496bd6">getParent</a>();</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;  <span class="keywordtype">unsigned</span> SlotSize = STI.<a class="code" href="classllvm_1_1X86Subtarget.html#a5314399c907d77b514ec837e8527a9de">is64Bit</a>() ? 8 : 4;</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;  <span class="keywordtype">unsigned</span> FPReg = TRI-&gt;<a class="code" href="classllvm_1_1TargetRegisterInfo.html#a2a4c228322f39803f16b2f49d18b0efe">getFrameRegister</a>(MF);</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;  <span class="keywordtype">unsigned</span> CalleeFrameSize = 0;</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetInstrInfo.html">TargetInstrInfo</a> &amp;<a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a> = *MF.<a class="code" href="classllvm_1_1MachineFunction.html#a6745c3bfdfc5b0643b078b96df2db252">getTarget</a>().<a class="code" href="classllvm_1_1TargetMachine.html#ac13d0f6f2c915757013b101ef6e8afbc">getInstrInfo</a>();</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;  <a class="code" href="classllvm_1_1X86MachineFunctionInfo.html">X86MachineFunctionInfo</a> *X86FI = MF.<a class="code" href="classllvm_1_1MachineFunction.html#ac2dc0fa143c9f2127f0501734577a0a0">getInfo</a>&lt;<a class="code" href="classllvm_1_1X86MachineFunctionInfo.html">X86MachineFunctionInfo</a>&gt;();</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;  <span class="comment">// Push GPRs. It increases frame size.</span></div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;  <span class="keywordtype">unsigned</span> Opc = STI.<a class="code" href="classllvm_1_1X86Subtarget.html#a5314399c907d77b514ec837e8527a9de">is64Bit</a>() ? X86::PUSH64r : X86::PUSH32r;</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = CSI.size(); <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != 0; --<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;    <span class="keywordtype">unsigned</span> <a class="code" href="X86DisassemblerDecoder_8h.html#a546839a5c4bcf9f9450967155f48de41">Reg</a> = CSI[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>-1].getReg();</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;    <span class="keywordflow">if</span> (!X86::GR64RegClass.contains(Reg) &amp;&amp;</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;        !X86::GR32RegClass.contains(Reg))</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;    <span class="comment">// Add the callee-saved register as live-in. It&#39;s killed at the spill.</span></div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;    MBB.<a class="code" href="classllvm_1_1MachineBasicBlock.html#ae26efdb76d5c56388c65dc5b02a2ae6f">addLiveIn</a>(Reg);</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;    <span class="keywordflow">if</span> (Reg == FPReg)</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;      <span class="comment">// X86RegisterInfo::emitPrologue will handle spilling of frame register.</span></div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;    CalleeFrameSize += SlotSize;</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;    <a class="code" href="namespacellvm.html#a980570dc1410d4ef53806f82028ca381">BuildMI</a>(MBB, MI, DL, TII.<a class="code" href="classllvm_1_1MCInstrInfo.html#ab16f5a81fccfe4b7f645ba5a74ffad02">get</a>(Opc)).addReg(Reg, <a class="code" href="namespacellvm_1_1RegState.html#a079b254e749130fbe5d740f314ca92daa9ddde91ef09476d28a088fe57f8e2921">RegState::Kill</a>)</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;      .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a66fb0307f35f874cb65deb84eea9553f">setMIFlag</a>(<a class="code" href="classllvm_1_1MachineInstr.html#aafacf84de1cb994a92dc045f4aa1d518a78f1067d270179dff7915b90a03ce237">MachineInstr::FrameSetup</a>);</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;  }</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;  X86FI-&gt;<a class="code" href="classllvm_1_1X86MachineFunctionInfo.html#af3682a96148f7c1e534dfa7c2726ccec">setCalleeSavedFrameSize</a>(CalleeFrameSize);</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;  <span class="comment">// Make XMM regs spilled. X86 does not have ability of push/pop XMM.</span></div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;  <span class="comment">// It can be done by spilling XMMs to stack frame.</span></div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;  <span class="comment">// Note that only Win64 ABI might spill XMMs.</span></div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = CSI.size(); <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != 0; --<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;    <span class="keywordtype">unsigned</span> <a class="code" href="X86DisassemblerDecoder_8h.html#a546839a5c4bcf9f9450967155f48de41">Reg</a> = CSI[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>-1].getReg();</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;    <span class="keywordflow">if</span> (X86::GR64RegClass.contains(Reg) ||</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;        X86::GR32RegClass.contains(Reg))</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;    <span class="comment">// Add the callee-saved register as live-in. It&#39;s killed at the spill.</span></div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;    MBB.<a class="code" href="classllvm_1_1MachineBasicBlock.html#ae26efdb76d5c56388c65dc5b02a2ae6f">addLiveIn</a>(Reg);</div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetRegisterClass.html">TargetRegisterClass</a> *RC = TRI-&gt;<a class="code" href="classllvm_1_1TargetRegisterInfo.html#ae9aacd409bfca45edfcd7bb432d3f1fe">getMinimalPhysRegClass</a>(Reg);</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;    TII.<a class="code" href="classllvm_1_1TargetInstrInfo.html#a94d273699f7fdbd1a01477c4ca8014dd">storeRegToStackSlot</a>(MBB, MI, Reg, <span class="keyword">true</span>, CSI[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>-1].getFrameIdx(),</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;                            RC, TRI);</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;  }</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;}</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;</div><div class="line"><a name="l01017"></a><span class="lineno"><a class="line" href="classllvm_1_1X86FrameLowering.html#ace7b01376d98658e0007a19f9ae4b4c7"> 1017</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classllvm_1_1X86FrameLowering.html#ace7b01376d98658e0007a19f9ae4b4c7">X86FrameLowering::restoreCalleeSavedRegisters</a>(<a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> &amp;MBB,</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;                                               <a class="code" href="classllvm_1_1MachineBasicBlock.html#ac51be7ff80fe8d6ae5e8c0acb194908a">MachineBasicBlock::iterator</a> <a class="code" href="namespacellvm_1_1A64CC.html#af5804bc0518be9568f73db566e4d6f46a2db5e7546f960277ff98f96cd5624442">MI</a>,</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;                                        <span class="keyword">const</span> std::vector&lt;CalleeSavedInfo&gt; &amp;CSI,</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;                                          <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetRegisterInfo.html">TargetRegisterInfo</a> *TRI)<span class="keyword"> const </span>{</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;  <span class="keywordflow">if</span> (CSI.empty())</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;  <a class="code" href="classllvm_1_1DebugLoc.html">DebugLoc</a> DL = MBB.<a class="code" href="classllvm_1_1MachineBasicBlock.html#a45028d169700cac71cf6c613a94236ee">findDebugLoc</a>(MI);</div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;  <a class="code" href="classllvm_1_1MachineFunction.html">MachineFunction</a> &amp;MF = *MBB.<a class="code" href="classllvm_1_1MachineBasicBlock.html#af2e482ff2a9253ec6bc2285491496bd6">getParent</a>();</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetInstrInfo.html">TargetInstrInfo</a> &amp;<a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a> = *MF.<a class="code" href="classllvm_1_1MachineFunction.html#a6745c3bfdfc5b0643b078b96df2db252">getTarget</a>().<a class="code" href="classllvm_1_1TargetMachine.html#ac13d0f6f2c915757013b101ef6e8afbc">getInstrInfo</a>();</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;  <span class="comment">// Reload XMMs from stack frame.</span></div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0, e = CSI.size(); <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != e; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;    <span class="keywordtype">unsigned</span> <a class="code" href="X86DisassemblerDecoder_8h.html#a546839a5c4bcf9f9450967155f48de41">Reg</a> = CSI[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>].getReg();</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;    <span class="keywordflow">if</span> (X86::GR64RegClass.contains(Reg) ||</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;        X86::GR32RegClass.contains(Reg))</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetRegisterClass.html">TargetRegisterClass</a> *RC = TRI-&gt;<a class="code" href="classllvm_1_1TargetRegisterInfo.html#ae9aacd409bfca45edfcd7bb432d3f1fe">getMinimalPhysRegClass</a>(Reg);</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;    TII.<a class="code" href="classllvm_1_1TargetInstrInfo.html#a1f16d509bf2e2c2d0e0176f04c253a96">loadRegFromStackSlot</a>(MBB, MI, Reg, CSI[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>].getFrameIdx(),</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;                             RC, TRI);</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;  }</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;  <span class="comment">// POP GPRs.</span></div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;  <span class="keywordtype">unsigned</span> FPReg = TRI-&gt;<a class="code" href="classllvm_1_1TargetRegisterInfo.html#a2a4c228322f39803f16b2f49d18b0efe">getFrameRegister</a>(MF);</div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;  <span class="keywordtype">unsigned</span> Opc = STI.<a class="code" href="classllvm_1_1X86Subtarget.html#a5314399c907d77b514ec837e8527a9de">is64Bit</a>() ? X86::POP64r : X86::POP32r;</div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0, e = CSI.size(); <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != e; ++<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;    <span class="keywordtype">unsigned</span> <a class="code" href="X86DisassemblerDecoder_8h.html#a546839a5c4bcf9f9450967155f48de41">Reg</a> = CSI[<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>].getReg();</div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;    <span class="keywordflow">if</span> (!X86::GR64RegClass.contains(Reg) &amp;&amp;</div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;        !X86::GR32RegClass.contains(Reg))</div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;    <span class="keywordflow">if</span> (Reg == FPReg)</div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;      <span class="comment">// X86RegisterInfo::emitEpilogue will handle restoring of frame register.</span></div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;    <a class="code" href="namespacellvm.html#a980570dc1410d4ef53806f82028ca381">BuildMI</a>(MBB, MI, DL, TII.<a class="code" href="classllvm_1_1MCInstrInfo.html#ab16f5a81fccfe4b7f645ba5a74ffad02">get</a>(Opc), <a class="code" href="X86DisassemblerDecoder_8h.html#a546839a5c4bcf9f9450967155f48de41">Reg</a>);</div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;  }</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;}</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l01057"></a><span class="lineno"><a class="line" href="classllvm_1_1X86FrameLowering.html#a8d86c59cf26f81503a2775ae176f96db"> 1057</a></span>&#160;<a class="code" href="classllvm_1_1X86FrameLowering.html#a8d86c59cf26f81503a2775ae176f96db">X86FrameLowering::processFunctionBeforeCalleeSavedScan</a>(<a class="code" href="classllvm_1_1MachineFunction.html">MachineFunction</a> &amp;MF,</div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;                                                   <a class="code" href="classllvm_1_1RegScavenger.html">RegScavenger</a> *RS)<span class="keyword"> const </span>{</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;  <a class="code" href="classllvm_1_1MachineFrameInfo.html">MachineFrameInfo</a> *MFI = MF.<a class="code" href="classllvm_1_1MachineFunction.html#a4ad4295a88187ea1ae12ecfcfa18a70f">getFrameInfo</a>();</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1X86RegisterInfo.html">X86RegisterInfo</a> *RegInfo = TM.<a class="code" href="classllvm_1_1X86TargetMachine.html#a350524cf8e1e0e53a6d856188d851ec4">getRegisterInfo</a>();</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;  <span class="keywordtype">unsigned</span> SlotSize = RegInfo-&gt;<a class="code" href="classllvm_1_1X86RegisterInfo.html#a52f78fb379677e9270168daf72a808bd">getSlotSize</a>();</div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;</div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;  <a class="code" href="classllvm_1_1X86MachineFunctionInfo.html">X86MachineFunctionInfo</a> *X86FI = MF.<a class="code" href="classllvm_1_1MachineFunction.html#ac2dc0fa143c9f2127f0501734577a0a0">getInfo</a>&lt;<a class="code" href="classllvm_1_1X86MachineFunctionInfo.html">X86MachineFunctionInfo</a>&gt;();</div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;  int64_t TailCallReturnAddrDelta = X86FI-&gt;<a class="code" href="classllvm_1_1X86MachineFunctionInfo.html#ae2a2c9153ec666e20698a5d3956ac2d4">getTCReturnAddrDelta</a>();</div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;</div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;  <span class="keywordflow">if</span> (TailCallReturnAddrDelta &lt; 0) {</div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;    <span class="comment">// create RETURNADDR area</span></div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;    <span class="comment">//   arg</span></div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;    <span class="comment">//   arg</span></div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;    <span class="comment">//   RETADDR</span></div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;    <span class="comment">//   { ...</span></div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;    <span class="comment">//     RETADDR area</span></div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;    <span class="comment">//     ...</span></div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;    <span class="comment">//   }</span></div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;    <span class="comment">//   [EBP]</span></div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;    MFI-&gt;<a class="code" href="classllvm_1_1MachineFrameInfo.html#a511de1ba76de77289749f82883fada4b">CreateFixedObject</a>(-TailCallReturnAddrDelta,</div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;                           TailCallReturnAddrDelta - SlotSize, <span class="keyword">true</span>);</div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;  }</div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;</div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1X86FrameLowering.html#a649e4f2412bff7a236d44c0c52982640">hasFP</a>(MF)) {</div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;    assert((TailCallReturnAddrDelta &lt;= 0) &amp;&amp;</div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;           <span class="stringliteral">&quot;The Delta should always be zero or negative&quot;</span>);</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetFrameLowering.html">TargetFrameLowering</a> &amp;TFI = *MF.<a class="code" href="classllvm_1_1MachineFunction.html#a6745c3bfdfc5b0643b078b96df2db252">getTarget</a>().<a class="code" href="classllvm_1_1TargetMachine.html#a02aa9d4cbd6ffcc70dfe1143ec0995ef">getFrameLowering</a>();</div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;</div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;    <span class="comment">// Create a frame entry for the EBP register that must be saved.</span></div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;    <span class="keywordtype">int</span> FrameIdx = MFI-&gt;<a class="code" href="classllvm_1_1MachineFrameInfo.html#a511de1ba76de77289749f82883fada4b">CreateFixedObject</a>(SlotSize,</div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;                                          -(<span class="keywordtype">int</span>)SlotSize +</div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;                                          TFI.<a class="code" href="classllvm_1_1TargetFrameLowering.html#a32f0831ccaa8dbbbf0f779125e6d5dd8">getOffsetOfLocalArea</a>() +</div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;                                          TailCallReturnAddrDelta,</div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;                                          <span class="keyword">true</span>);</div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;    assert(FrameIdx == MFI-&gt;<a class="code" href="classllvm_1_1MachineFrameInfo.html#aefab860460ca482a381a508d36cd9f01">getObjectIndexBegin</a>() &amp;&amp;</div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;           <span class="stringliteral">&quot;Slot for EBP register must be last in order to be found!&quot;</span>);</div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;    (void)FrameIdx;</div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;  }</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;  <span class="comment">// Spill the BasePtr if it&#39;s used.</span></div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;  <span class="keywordflow">if</span> (RegInfo-&gt;<a class="code" href="classllvm_1_1X86RegisterInfo.html#ad37a65804edd5f913012ea82e22cca33">hasBasePointer</a>(MF))</div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;    MF.<a class="code" href="classllvm_1_1MachineFunction.html#ab4a6ca428289b667dd691a00e9f7e334">getRegInfo</a>().<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a8102e337f77143271ef8ccd4ea2546b3">setPhysRegUsed</a>(RegInfo-&gt;<a class="code" href="classllvm_1_1X86RegisterInfo.html#aa9f703a288ef91efae26a538d96037d6">getBaseRegister</a>());</div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;}</div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;</div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span></div><div class="line"><a name="l01102"></a><span class="lineno"><a class="line" href="X86FrameLowering_8cpp.html#ab29c5668ec7d2b12468b97aa33e5f87b"> 1102</a></span>&#160;<a class="code" href="X86FrameLowering_8cpp.html#ab29c5668ec7d2b12468b97aa33e5f87b">HasNestArgument</a>(<span class="keyword">const</span> <a class="code" href="classllvm_1_1MachineFunction.html">MachineFunction</a> *MF) {</div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1Function.html">Function</a> *<a class="code" href="LLParser_8cpp.html#a33ece1ef8074506a15d7f86eb76dbae6">F</a> = MF-&gt;<a class="code" href="classllvm_1_1MachineFunction.html#ad784a6594990530bffb2018aeeed56f3">getFunction</a>();</div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1ilist__iterator.html">Function::const_arg_iterator</a> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = F-&gt;<a class="code" href="classllvm_1_1Function.html#a8bf193a781a92cae52d7f9216d0824f8">arg_begin</a>(), E = F-&gt;<a class="code" href="classllvm_1_1Function.html#a8300ac1ef141b8a7c63c13fa9369d976">arg_end</a>();</div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;       <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> != E; <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>++) {</div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;hasNestAttr())</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;  }</div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;}</div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;<span class="comment">/// GetScratchRegister - Get a temp register for performing work in the</span></div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;<span class="comment">/// segmented stack and the Erlang/HiPE stack prologue. Depending on platform</span></div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;<span class="comment">/// and the properties of the function either one or two registers will be</span></div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;<span class="comment">/// needed. Set primary to true for the first register, false for the second.</span></div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">unsigned</span></div><div class="line"><a name="l01117"></a><span class="lineno"><a class="line" href="X86FrameLowering_8cpp.html#a38ade45dd7bb38c669a112f7079f9395"> 1117</a></span>&#160;<a class="code" href="X86FrameLowering_8cpp.html#a38ade45dd7bb38c669a112f7079f9395">GetScratchRegister</a>(<span class="keywordtype">bool</span> Is64Bit, <span class="keyword">const</span> <a class="code" href="classllvm_1_1MachineFunction.html">MachineFunction</a> &amp;MF, <span class="keywordtype">bool</span> Primary) {</div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;  <a class="code" href="namespacellvm_1_1CallingConv.html#a4f861731fc6dbfdccc05af5968d98974">CallingConv::ID</a> <a class="code" href="namespacellvm_1_1dwarf.html#a31ace7f9af1edbbe842e91b9edb4a2a1">CallingConvention</a> = MF.<a class="code" href="classllvm_1_1MachineFunction.html#ad784a6594990530bffb2018aeeed56f3">getFunction</a>()-&gt;<a class="code" href="classllvm_1_1Function.html#af4d5ada526cdf057f5f29047e058187d">getCallingConv</a>();</div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;</div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;  <span class="comment">// Erlang stuff.</span></div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;  <span class="keywordflow">if</span> (CallingConvention == <a class="code" href="namespacellvm_1_1CallingConv.html#a4f861731fc6dbfdccc05af5968d98974a20ddc463f96d806f369d56205ea205f5">CallingConv::HiPE</a>) {</div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;    <span class="keywordflow">if</span> (Is64Bit)</div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;      <span class="keywordflow">return</span> Primary ? X86::R14 : X86::R13;</div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;      <span class="keywordflow">return</span> Primary ? <a class="code" href="README-SSE_8txt.html#af63bcf34c820f95f096676adf8358de4">X86::EBX</a> : <a class="code" href="README-SSE_8txt.html#a64d666eb92eff8eb2810814d040a21c1">X86::EDI</a>;</div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;  }</div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;</div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;  <span class="keywordflow">if</span> (Is64Bit)</div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;    <span class="keywordflow">return</span> Primary ? X86::R11 : X86::R12;</div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;</div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;  <span class="keywordtype">bool</span> IsNested = <a class="code" href="X86FrameLowering_8cpp.html#ab29c5668ec7d2b12468b97aa33e5f87b">HasNestArgument</a>(&amp;MF);</div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;</div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;  <span class="keywordflow">if</span> (CallingConvention == <a class="code" href="namespacellvm_1_1CallingConv.html#a4f861731fc6dbfdccc05af5968d98974afde87569738f9e23963e8735f71c33eb">CallingConv::X86_FastCall</a> ||</div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;      CallingConvention == <a class="code" href="namespacellvm_1_1CallingConv.html#a4f861731fc6dbfdccc05af5968d98974abc8e2ee40a84687a9e12fd08784b87ba">CallingConv::Fast</a>) {</div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;    <span class="keywordflow">if</span> (IsNested)</div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;      <a class="code" href="namespacellvm.html#a1f6978055dbb761b380de39070e34bd3">report_fatal_error</a>(<span class="stringliteral">&quot;Segmented stacks does not support fastcall with &quot;</span></div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;                         <span class="stringliteral">&quot;nested function.&quot;</span>);</div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;    <span class="keywordflow">return</span> Primary ? <a class="code" href="README-SSE_8txt.html#abd9c765b9afafff59eb14d50c9e9fba1">X86::EAX</a> : <a class="code" href="namespacellvm_1_1N86.html#a154c9f74eba4608c7d1b656eb025a96da667b758702693d9dfb46e55025fc559d">X86::ECX</a>;</div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;  }</div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;  <span class="keywordflow">if</span> (IsNested)</div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;    <span class="keywordflow">return</span> Primary ? <a class="code" href="README-SSE_8txt.html#aafb0a6c62a7cfe1538db1d20d759a34b">X86::EDX</a> : <a class="code" href="README-SSE_8txt.html#abd9c765b9afafff59eb14d50c9e9fba1">X86::EAX</a>;</div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;  <span class="keywordflow">return</span> Primary ? <a class="code" href="namespacellvm_1_1N86.html#a154c9f74eba4608c7d1b656eb025a96da667b758702693d9dfb46e55025fc559d">X86::ECX</a> : <a class="code" href="README-SSE_8txt.html#abd9c765b9afafff59eb14d50c9e9fba1">X86::EAX</a>;</div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;}</div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;</div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;<span class="comment">// The stack limit in the TCB is set to this many bytes above the actual stack</span></div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;<span class="comment">// limit.</span></div><div class="line"><a name="l01147"></a><span class="lineno"><a class="line" href="X86FrameLowering_8cpp.html#ad6f5455eb7ba6ed74cab551099d0a952"> 1147</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> uint64_t <a class="code" href="X86FrameLowering_8cpp.html#ad6f5455eb7ba6ed74cab551099d0a952">kSplitStackAvailable</a> = 256;</div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;</div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l01150"></a><span class="lineno"><a class="line" href="classllvm_1_1X86FrameLowering.html#abb7c06be7ec779f3ffacfcad59172496"> 1150</a></span>&#160;<a class="code" href="classllvm_1_1X86FrameLowering.html#abb7c06be7ec779f3ffacfcad59172496">X86FrameLowering::adjustForSegmentedStacks</a>(<a class="code" href="classllvm_1_1MachineFunction.html">MachineFunction</a> &amp;MF)<span class="keyword"> const </span>{</div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;  <a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> &amp;prologueMBB = MF.<a class="code" href="classllvm_1_1MachineFunction.html#af562445435f18637f07676da054ba02c">front</a>();</div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;  <a class="code" href="classllvm_1_1MachineFrameInfo.html">MachineFrameInfo</a> *MFI = MF.<a class="code" href="classllvm_1_1MachineFunction.html#a4ad4295a88187ea1ae12ecfcfa18a70f">getFrameInfo</a>();</div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1X86InstrInfo.html">X86InstrInfo</a> &amp;<a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a> = *TM.<a class="code" href="classllvm_1_1X86TargetMachine.html#a245ed1de411cd3ba114322a573b524f5">getInstrInfo</a>();</div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;  uint64_t StackSize;</div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;  <span class="keywordtype">bool</span> Is64Bit = STI.<a class="code" href="classllvm_1_1X86Subtarget.html#a5314399c907d77b514ec837e8527a9de">is64Bit</a>();</div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;  <span class="keywordtype">unsigned</span> TlsReg, TlsOffset;</div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;  <a class="code" href="classllvm_1_1DebugLoc.html">DebugLoc</a> DL;</div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;</div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;  <span class="keywordtype">unsigned</span> ScratchReg = <a class="code" href="X86FrameLowering_8cpp.html#a38ade45dd7bb38c669a112f7079f9395">GetScratchRegister</a>(Is64Bit, MF, <span class="keyword">true</span>);</div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;  assert(!MF.<a class="code" href="classllvm_1_1MachineFunction.html#ab4a6ca428289b667dd691a00e9f7e334">getRegInfo</a>().<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5e4b09e8d0f31b43fd5a912ed288bccb">isLiveIn</a>(ScratchReg) &amp;&amp;</div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;         <span class="stringliteral">&quot;Scratch register is live-in&quot;</span>);</div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;</div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;  <span class="keywordflow">if</span> (MF.<a class="code" href="classllvm_1_1MachineFunction.html#ad784a6594990530bffb2018aeeed56f3">getFunction</a>()-&gt;<a class="code" href="classllvm_1_1Function.html#ae0466120bfdf5b97b25aa06f3015cd51">isVarArg</a>())</div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;    <a class="code" href="namespacellvm.html#a1f6978055dbb761b380de39070e34bd3">report_fatal_error</a>(<span class="stringliteral">&quot;Segmented stacks do not support vararg functions.&quot;</span>);</div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;  <span class="keywordflow">if</span> (!STI.<a class="code" href="classllvm_1_1X86Subtarget.html#a92b94bad0207c5841e67d0ac5bf088ee">isTargetLinux</a>() &amp;&amp; !STI.<a class="code" href="classllvm_1_1X86Subtarget.html#a705e847a3a7363d59a52f8d8d56aeea9">isTargetDarwin</a>() &amp;&amp;</div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;      !STI.<a class="code" href="classllvm_1_1X86Subtarget.html#a18fbbad2cb443b3e451099aab08976eb">isTargetWin32</a>() &amp;&amp; !STI.<a class="code" href="classllvm_1_1X86Subtarget.html#aa82ef59ca68fb0c1af009f46fe59bf0d">isTargetFreeBSD</a>())</div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;    <a class="code" href="namespacellvm.html#a1f6978055dbb761b380de39070e34bd3">report_fatal_error</a>(<span class="stringliteral">&quot;Segmented stacks not supported on this platform.&quot;</span>);</div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;</div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;  <a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> *allocMBB = MF.<a class="code" href="classllvm_1_1MachineFunction.html#ab2a56feb4fe943ae2362d61f3a43acca">CreateMachineBasicBlock</a>();</div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;  <a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> *checkMBB = MF.<a class="code" href="classllvm_1_1MachineFunction.html#ab2a56feb4fe943ae2362d61f3a43acca">CreateMachineBasicBlock</a>();</div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;  <a class="code" href="classllvm_1_1X86MachineFunctionInfo.html">X86MachineFunctionInfo</a> *X86FI = MF.<a class="code" href="classllvm_1_1MachineFunction.html#ac2dc0fa143c9f2127f0501734577a0a0">getInfo</a>&lt;<a class="code" href="classllvm_1_1X86MachineFunctionInfo.html">X86MachineFunctionInfo</a>&gt;();</div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;  <span class="keywordtype">bool</span> IsNested = <span class="keyword">false</span>;</div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;</div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;  <span class="comment">// We need to know if the function has a nest argument only in 64 bit mode.</span></div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;  <span class="keywordflow">if</span> (Is64Bit)</div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;    IsNested = <a class="code" href="X86FrameLowering_8cpp.html#ab29c5668ec7d2b12468b97aa33e5f87b">HasNestArgument</a>(&amp;MF);</div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;</div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;  <span class="comment">// The MOV R10, RAX needs to be in a different block, since the RET we emit in</span></div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;  <span class="comment">// allocMBB needs to be last (terminating) instruction.</span></div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;</div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1MachineBasicBlock.html#a7bab64c02d740522f94f5f45959a22fc">MachineBasicBlock::livein_iterator</a> <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = prologueMBB.<a class="code" href="classllvm_1_1MachineBasicBlock.html#a6833d4f80b7e44f505b2184b04ea2693">livein_begin</a>(),</div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;         e = prologueMBB.<a class="code" href="classllvm_1_1MachineBasicBlock.html#aa314325c7062fd067a3c0b9339aa8ea6">livein_end</a>(); <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != e; <a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;    allocMBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#ae26efdb76d5c56388c65dc5b02a2ae6f">addLiveIn</a>(*<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;    checkMBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#ae26efdb76d5c56388c65dc5b02a2ae6f">addLiveIn</a>(*<a class="code" href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;  }</div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;  <span class="keywordflow">if</span> (IsNested)</div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;    allocMBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#ae26efdb76d5c56388c65dc5b02a2ae6f">addLiveIn</a>(X86::R10);</div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;</div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;  MF.<a class="code" href="classllvm_1_1MachineFunction.html#a6a437bb3c4a44ac328344e5f361c7816">push_front</a>(allocMBB);</div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;  MF.<a class="code" href="classllvm_1_1MachineFunction.html#a6a437bb3c4a44ac328344e5f361c7816">push_front</a>(checkMBB);</div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;</div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;  <span class="comment">// Eventually StackSize will be calculated by a link-time pass; which will</span></div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;  <span class="comment">// also decide whether checking code needs to be injected into this particular</span></div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;  <span class="comment">// prologue.</span></div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;  StackSize = MFI-&gt;<a class="code" href="classllvm_1_1MachineFrameInfo.html#a34874094b3ba8b56fd68801250f77183">getStackSize</a>();</div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;</div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;  <span class="comment">// When the frame size is less than 256 we just compare the stack</span></div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;  <span class="comment">// boundary directly to the value of the stack pointer, per gcc.</span></div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;  <span class="keywordtype">bool</span> CompareStackPointer = StackSize &lt; <a class="code" href="X86FrameLowering_8cpp.html#ad6f5455eb7ba6ed74cab551099d0a952">kSplitStackAvailable</a>;</div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;</div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;  <span class="comment">// Read the limit off the current stacklet off the stack_guard location.</span></div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;  <span class="keywordflow">if</span> (Is64Bit) {</div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;    <span class="keywordflow">if</span> (STI.<a class="code" href="classllvm_1_1X86Subtarget.html#a92b94bad0207c5841e67d0ac5bf088ee">isTargetLinux</a>()) {</div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;      TlsReg = <a class="code" href="namespacellvm_1_1X86II.html#a97dc14052814702ba0e2b14fb14dd02da50aa2061845b3ff4e6e2242d762c6a80">X86::FS</a>;</div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;      TlsOffset = 0x70;</div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (STI.<a class="code" href="classllvm_1_1X86Subtarget.html#a705e847a3a7363d59a52f8d8d56aeea9">isTargetDarwin</a>()) {</div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;      TlsReg = <a class="code" href="namespacellvm_1_1X86II.html#a97dc14052814702ba0e2b14fb14dd02dacdc4d0fa74813b50797e25bab4febe70">X86::GS</a>;</div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;      TlsOffset = 0x60 + 90*8; <span class="comment">// See pthread_machdep.h. Steal TLS slot 90.</span></div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (STI.<a class="code" href="classllvm_1_1X86Subtarget.html#aa82ef59ca68fb0c1af009f46fe59bf0d">isTargetFreeBSD</a>()) {</div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;      TlsReg = <a class="code" href="namespacellvm_1_1X86II.html#a97dc14052814702ba0e2b14fb14dd02da50aa2061845b3ff4e6e2242d762c6a80">X86::FS</a>;</div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;      TlsOffset = 0x18;</div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;      <a class="code" href="namespacellvm.html#a1f6978055dbb761b380de39070e34bd3">report_fatal_error</a>(<span class="stringliteral">&quot;Segmented stacks not supported on this platform.&quot;</span>);</div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;    }</div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;</div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;    <span class="keywordflow">if</span> (CompareStackPointer)</div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;      ScratchReg = X86::RSP;</div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;      <a class="code" href="namespacellvm.html#a980570dc1410d4ef53806f82028ca381">BuildMI</a>(checkMBB, DL, TII.get(X86::LEA64r), ScratchReg).addReg(X86::RSP)</div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;        .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a9f1fae6a5dbb6e378ca85df1fded8515">addImm</a>(1).<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a5125cce72b214df09ca8f93dcbbf4c3a">addReg</a>(0).<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a9f1fae6a5dbb6e378ca85df1fded8515">addImm</a>(-StackSize).<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a5125cce72b214df09ca8f93dcbbf4c3a">addReg</a>(0);</div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;</div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;    <a class="code" href="namespacellvm.html#a980570dc1410d4ef53806f82028ca381">BuildMI</a>(checkMBB, DL, TII.get(X86::CMP64rm)).addReg(ScratchReg)</div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;      .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a5125cce72b214df09ca8f93dcbbf4c3a">addReg</a>(0).<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a9f1fae6a5dbb6e378ca85df1fded8515">addImm</a>(1).<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a5125cce72b214df09ca8f93dcbbf4c3a">addReg</a>(0).<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a9f1fae6a5dbb6e378ca85df1fded8515">addImm</a>(TlsOffset).<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a5125cce72b214df09ca8f93dcbbf4c3a">addReg</a>(TlsReg);</div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;    <span class="keywordflow">if</span> (STI.<a class="code" href="classllvm_1_1X86Subtarget.html#a92b94bad0207c5841e67d0ac5bf088ee">isTargetLinux</a>()) {</div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;      TlsReg = <a class="code" href="namespacellvm_1_1X86II.html#a97dc14052814702ba0e2b14fb14dd02dacdc4d0fa74813b50797e25bab4febe70">X86::GS</a>;</div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;      TlsOffset = 0x30;</div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (STI.<a class="code" href="classllvm_1_1X86Subtarget.html#a705e847a3a7363d59a52f8d8d56aeea9">isTargetDarwin</a>()) {</div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;      TlsReg = <a class="code" href="namespacellvm_1_1X86II.html#a97dc14052814702ba0e2b14fb14dd02dacdc4d0fa74813b50797e25bab4febe70">X86::GS</a>;</div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;      TlsOffset = 0x48 + 90*4;</div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (STI.<a class="code" href="classllvm_1_1X86Subtarget.html#a18fbbad2cb443b3e451099aab08976eb">isTargetWin32</a>()) {</div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;      TlsReg = <a class="code" href="namespacellvm_1_1X86II.html#a97dc14052814702ba0e2b14fb14dd02da50aa2061845b3ff4e6e2242d762c6a80">X86::FS</a>;</div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;      TlsOffset = 0x14; <span class="comment">// pvArbitrary, reserved for application use</span></div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (STI.<a class="code" href="classllvm_1_1X86Subtarget.html#aa82ef59ca68fb0c1af009f46fe59bf0d">isTargetFreeBSD</a>()) {</div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;      <a class="code" href="namespacellvm.html#a1f6978055dbb761b380de39070e34bd3">report_fatal_error</a>(<span class="stringliteral">&quot;Segmented stacks not supported on FreeBSD i386.&quot;</span>);</div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;      <a class="code" href="namespacellvm.html#a1f6978055dbb761b380de39070e34bd3">report_fatal_error</a>(<span class="stringliteral">&quot;Segmented stacks not supported on this platform.&quot;</span>);</div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;    }</div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;    <span class="keywordflow">if</span> (CompareStackPointer)</div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;      ScratchReg = <a class="code" href="namespacellvm_1_1N86.html#a154c9f74eba4608c7d1b656eb025a96da303dfe7256beaf60eaaa93d1c418965b">X86::ESP</a>;</div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;      <a class="code" href="namespacellvm.html#a980570dc1410d4ef53806f82028ca381">BuildMI</a>(checkMBB, DL, TII.get(X86::LEA32r), ScratchReg).addReg(<a class="code" href="namespacellvm_1_1N86.html#a154c9f74eba4608c7d1b656eb025a96da303dfe7256beaf60eaaa93d1c418965b">X86::ESP</a>)</div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;        .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a9f1fae6a5dbb6e378ca85df1fded8515">addImm</a>(1).<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a5125cce72b214df09ca8f93dcbbf4c3a">addReg</a>(0).<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a9f1fae6a5dbb6e378ca85df1fded8515">addImm</a>(-StackSize).<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a5125cce72b214df09ca8f93dcbbf4c3a">addReg</a>(0);</div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;</div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;    <span class="keywordflow">if</span> (STI.<a class="code" href="classllvm_1_1X86Subtarget.html#a92b94bad0207c5841e67d0ac5bf088ee">isTargetLinux</a>() || STI.<a class="code" href="classllvm_1_1X86Subtarget.html#a18fbbad2cb443b3e451099aab08976eb">isTargetWin32</a>()) {</div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;      <a class="code" href="namespacellvm.html#a980570dc1410d4ef53806f82028ca381">BuildMI</a>(checkMBB, DL, TII.get(X86::CMP32rm)).addReg(ScratchReg)</div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;        .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a5125cce72b214df09ca8f93dcbbf4c3a">addReg</a>(0).<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a9f1fae6a5dbb6e378ca85df1fded8515">addImm</a>(0).<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a5125cce72b214df09ca8f93dcbbf4c3a">addReg</a>(0).<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a9f1fae6a5dbb6e378ca85df1fded8515">addImm</a>(TlsOffset).<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a5125cce72b214df09ca8f93dcbbf4c3a">addReg</a>(TlsReg);</div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (STI.<a class="code" href="classllvm_1_1X86Subtarget.html#a705e847a3a7363d59a52f8d8d56aeea9">isTargetDarwin</a>()) {</div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;</div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;      <span class="comment">// TlsOffset doesn&#39;t fit into a mod r/m byte so we need an extra register</span></div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;      <span class="keywordtype">unsigned</span> ScratchReg2;</div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;      <span class="keywordtype">bool</span> SaveScratch2;</div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;      <span class="keywordflow">if</span> (CompareStackPointer) {</div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;        <span class="comment">// The primary scratch register is available for holding the TLS offset</span></div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;        ScratchReg2 = <a class="code" href="X86FrameLowering_8cpp.html#a38ade45dd7bb38c669a112f7079f9395">GetScratchRegister</a>(Is64Bit, MF, <span class="keyword">true</span>);</div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;        SaveScratch2 = <span class="keyword">false</span>;</div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;        <span class="comment">// Need to use a second register to hold the TLS offset</span></div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;        ScratchReg2 = <a class="code" href="X86FrameLowering_8cpp.html#a38ade45dd7bb38c669a112f7079f9395">GetScratchRegister</a>(Is64Bit, MF, <span class="keyword">false</span>);</div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;</div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;        <span class="comment">// Unfortunately, with fastcc the second scratch register may hold an arg</span></div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;        SaveScratch2 = MF.<a class="code" href="classllvm_1_1MachineFunction.html#ab4a6ca428289b667dd691a00e9f7e334">getRegInfo</a>().<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5e4b09e8d0f31b43fd5a912ed288bccb">isLiveIn</a>(ScratchReg2);</div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;      }</div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;</div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;      <span class="comment">// If Scratch2 is live-in then it needs to be saved</span></div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;      assert((!MF.<a class="code" href="classllvm_1_1MachineFunction.html#ab4a6ca428289b667dd691a00e9f7e334">getRegInfo</a>().<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5e4b09e8d0f31b43fd5a912ed288bccb">isLiveIn</a>(ScratchReg2) || SaveScratch2) &amp;&amp;</div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;             <span class="stringliteral">&quot;Scratch register is live-in and not saved&quot;</span>);</div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;</div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;      <span class="keywordflow">if</span> (SaveScratch2)</div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;        <a class="code" href="namespacellvm.html#a980570dc1410d4ef53806f82028ca381">BuildMI</a>(checkMBB, DL, TII.get(X86::PUSH32r))</div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;          .addReg(ScratchReg2, <a class="code" href="namespacellvm_1_1RegState.html#a079b254e749130fbe5d740f314ca92daa9ddde91ef09476d28a088fe57f8e2921">RegState::Kill</a>);</div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;</div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;      <a class="code" href="namespacellvm.html#a980570dc1410d4ef53806f82028ca381">BuildMI</a>(checkMBB, DL, TII.get(X86::MOV32ri), ScratchReg2)</div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;        .addImm(TlsOffset);</div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;      <a class="code" href="namespacellvm.html#a980570dc1410d4ef53806f82028ca381">BuildMI</a>(checkMBB, DL, TII.get(X86::CMP32rm))</div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;        .addReg(ScratchReg)</div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;        .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a5125cce72b214df09ca8f93dcbbf4c3a">addReg</a>(ScratchReg2).<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a9f1fae6a5dbb6e378ca85df1fded8515">addImm</a>(1).<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a5125cce72b214df09ca8f93dcbbf4c3a">addReg</a>(0)</div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;        .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a9f1fae6a5dbb6e378ca85df1fded8515">addImm</a>(0)</div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;        .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a5125cce72b214df09ca8f93dcbbf4c3a">addReg</a>(TlsReg);</div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;</div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;      <span class="keywordflow">if</span> (SaveScratch2)</div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;        <a class="code" href="namespacellvm.html#a980570dc1410d4ef53806f82028ca381">BuildMI</a>(checkMBB, DL, TII.get(X86::POP32r), ScratchReg2);</div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;    }</div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;  }</div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;</div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;  <span class="comment">// This jump is taken if SP &gt;= (Stacklet Limit + Stack Space required).</span></div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;  <span class="comment">// It jumps to normal execution of the function body.</span></div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;  <a class="code" href="namespacellvm.html#a980570dc1410d4ef53806f82028ca381">BuildMI</a>(checkMBB, DL, TII.get(X86::JA_4)).addMBB(&amp;prologueMBB);</div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;</div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;  <span class="comment">// On 32 bit we first push the arguments size and then the frame size. On 64</span></div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;  <span class="comment">// bit, we pass the stack frame size in r10 and the argument size in r11.</span></div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;  <span class="keywordflow">if</span> (Is64Bit) {</div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;    <span class="comment">// Functions with nested arguments use R10, so it needs to be saved across</span></div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;    <span class="comment">// the call to _morestack</span></div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;</div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;    <span class="keywordflow">if</span> (IsNested)</div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;      <a class="code" href="namespacellvm.html#a980570dc1410d4ef53806f82028ca381">BuildMI</a>(allocMBB, DL, TII.get(X86::MOV64rr), X86::RAX).addReg(X86::R10);</div><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;</div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;    <a class="code" href="namespacellvm.html#a980570dc1410d4ef53806f82028ca381">BuildMI</a>(allocMBB, DL, TII.get(X86::MOV64ri), X86::R10)</div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;      .addImm(StackSize);</div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;    <a class="code" href="namespacellvm.html#a980570dc1410d4ef53806f82028ca381">BuildMI</a>(allocMBB, DL, TII.get(X86::MOV64ri), X86::R11)</div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;      .addImm(X86FI-&gt;<a class="code" href="classllvm_1_1X86MachineFunctionInfo.html#a006344bb6086da91383dc8feb4626f68">getArgumentStackSize</a>());</div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;    MF.<a class="code" href="classllvm_1_1MachineFunction.html#ab4a6ca428289b667dd691a00e9f7e334">getRegInfo</a>().<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a8102e337f77143271ef8ccd4ea2546b3">setPhysRegUsed</a>(X86::R10);</div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;    MF.<a class="code" href="classllvm_1_1MachineFunction.html#ab4a6ca428289b667dd691a00e9f7e334">getRegInfo</a>().<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a8102e337f77143271ef8ccd4ea2546b3">setPhysRegUsed</a>(X86::R11);</div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;    <a class="code" href="namespacellvm.html#a980570dc1410d4ef53806f82028ca381">BuildMI</a>(allocMBB, DL, TII.get(X86::PUSHi32))</div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;      .addImm(X86FI-&gt;<a class="code" href="classllvm_1_1X86MachineFunctionInfo.html#a006344bb6086da91383dc8feb4626f68">getArgumentStackSize</a>());</div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;    <a class="code" href="namespacellvm.html#a980570dc1410d4ef53806f82028ca381">BuildMI</a>(allocMBB, DL, TII.get(X86::PUSHi32))</div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;      .addImm(StackSize);</div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;  }</div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;</div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;  <span class="comment">// __morestack is in libgcc</span></div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;  <span class="keywordflow">if</span> (Is64Bit)</div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;    <a class="code" href="namespacellvm.html#a980570dc1410d4ef53806f82028ca381">BuildMI</a>(allocMBB, DL, TII.get(X86::CALL64pcrel32))</div><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;      .addExternalSymbol(<span class="stringliteral">&quot;__morestack&quot;</span>);</div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;    <a class="code" href="namespacellvm.html#a980570dc1410d4ef53806f82028ca381">BuildMI</a>(allocMBB, DL, TII.get(X86::CALLpcrel32))</div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;      .addExternalSymbol(<span class="stringliteral">&quot;__morestack&quot;</span>);</div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;</div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;  <span class="keywordflow">if</span> (IsNested)</div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;    <a class="code" href="namespacellvm.html#a980570dc1410d4ef53806f82028ca381">BuildMI</a>(allocMBB, DL, TII.get(X86::MORESTACK_RET_RESTORE_R10));</div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;    <a class="code" href="namespacellvm.html#a980570dc1410d4ef53806f82028ca381">BuildMI</a>(allocMBB, DL, TII.get(X86::MORESTACK_RET));</div><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;</div><div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;  allocMBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#a3fcc360e6de146a370e8b0deecfa877f">addSuccessor</a>(&amp;prologueMBB);</div><div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;</div><div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;  checkMBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#a3fcc360e6de146a370e8b0deecfa877f">addSuccessor</a>(allocMBB);</div><div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;  checkMBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#a3fcc360e6de146a370e8b0deecfa877f">addSuccessor</a>(&amp;prologueMBB);</div><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;</div><div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;<span class="preprocessor">#ifdef XDEBUG</span></div><div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;  MF.<a class="code" href="classllvm_1_1MachineFunction.html#add0f152096ce3939934fb0be4558b1b0">verify</a>();</div><div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;}</div><div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;<span class="comment">/// Erlang programs may need a special prologue to handle the stack size they</span></div><div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;<span class="comment">/// might need at runtime. That is because Erlang/OTP does not implement a C</span></div><div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;<span class="comment">/// stack but uses a custom implementation of hybrid stack/heap architecture.</span></div><div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;<span class="comment">/// (for more information see Eric Stenman&#39;s Ph.D. thesis:</span></div><div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;<span class="comment">/// http://publications.uu.se/uu/fulltext/nbn_se_uu_diva-2688.pdf)</span></div><div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;<span class="comment">/// CheckStack:</span></div><div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;<span class="comment">///   temp0 = sp - MaxStack</span></div><div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;<span class="comment">///   if( temp0 &lt; SP_LIMIT(P) ) goto IncStack else goto OldStart</span></div><div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;<span class="comment">/// OldStart:</span></div><div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;<span class="comment">///   ...</span></div><div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;<span class="comment">/// IncStack:</span></div><div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;<span class="comment">///   call inc_stack   # doubles the stack space</span></div><div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;<span class="comment">///   temp0 = sp - MaxStack</span></div><div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;<span class="comment">///   if( temp0 &lt; SP_LIMIT(P) ) goto IncStack else goto OldStart</span></div><div class="line"><a name="l01352"></a><span class="lineno"><a class="line" href="classllvm_1_1X86FrameLowering.html#aa6faf9ffe7fe199720c422a2e2b66f21"> 1352</a></span>&#160;<span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="classllvm_1_1X86FrameLowering.html#aa6faf9ffe7fe199720c422a2e2b66f21">X86FrameLowering::adjustForHiPEPrologue</a>(<a class="code" href="classllvm_1_1MachineFunction.html">MachineFunction</a> &amp;MF)<span class="keyword"> const </span>{</div><div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1X86InstrInfo.html">X86InstrInfo</a> &amp;<a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a> = *TM.<a class="code" href="classllvm_1_1X86TargetMachine.html#a245ed1de411cd3ba114322a573b524f5">getInstrInfo</a>();</div><div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;  <a class="code" href="classllvm_1_1MachineFrameInfo.html">MachineFrameInfo</a> *MFI = MF.<a class="code" href="classllvm_1_1MachineFunction.html#a4ad4295a88187ea1ae12ecfcfa18a70f">getFrameInfo</a>();</div><div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> SlotSize = TM.<a class="code" href="classllvm_1_1X86TargetMachine.html#a350524cf8e1e0e53a6d856188d851ec4">getRegisterInfo</a>()-&gt;<a class="code" href="classllvm_1_1X86RegisterInfo.html#a52f78fb379677e9270168daf72a808bd">getSlotSize</a>();</div><div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> Is64Bit = STI.<a class="code" href="classllvm_1_1X86Subtarget.html#a5314399c907d77b514ec837e8527a9de">is64Bit</a>();</div><div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;  <a class="code" href="classllvm_1_1DebugLoc.html">DebugLoc</a> DL;</div><div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;  <span class="comment">// HiPE-specific values</span></div><div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> HipeLeafWords = 24;</div><div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> CCRegisteredArgs = Is64Bit ? 6 : 5;</div><div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> Guaranteed = HipeLeafWords * SlotSize;</div><div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;  <span class="keywordtype">unsigned</span> CallerStkArity = MF.<a class="code" href="classllvm_1_1MachineFunction.html#ad784a6594990530bffb2018aeeed56f3">getFunction</a>()-&gt;<a class="code" href="classllvm_1_1Function.html#aef89c402976e04c0abe4b10a963d35e3">arg_size</a>() &gt; CCRegisteredArgs ?</div><div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;                            MF.<a class="code" href="classllvm_1_1MachineFunction.html#ad784a6594990530bffb2018aeeed56f3">getFunction</a>()-&gt;<a class="code" href="classllvm_1_1Function.html#aef89c402976e04c0abe4b10a963d35e3">arg_size</a>() - CCRegisteredArgs : 0;</div><div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;  <span class="keywordtype">unsigned</span> MaxStack = MFI-&gt;<a class="code" href="classllvm_1_1MachineFrameInfo.html#a34874094b3ba8b56fd68801250f77183">getStackSize</a>() + CallerStkArity*SlotSize + SlotSize;</div><div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;</div><div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;  assert(STI.<a class="code" href="classllvm_1_1X86Subtarget.html#a92b94bad0207c5841e67d0ac5bf088ee">isTargetLinux</a>() &amp;&amp;</div><div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;         <span class="stringliteral">&quot;HiPE prologue is only supported on Linux operating systems.&quot;</span>);</div><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;</div><div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;  <span class="comment">// Compute the largest caller&#39;s frame that is needed to fit the callees&#39;</span></div><div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;  <span class="comment">// frames. This &#39;MaxStack&#39; is computed from:</span></div><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;  <span class="comment">//</span></div><div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;  <span class="comment">// a) the fixed frame size, which is the space needed for all spilled temps,</span></div><div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;  <span class="comment">// b) outgoing on-stack parameter areas, and</span></div><div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;  <span class="comment">// c) the minimum stack space this function needs to make available for the</span></div><div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;  <span class="comment">//    functions it calls (a tunable ABI property).</span></div><div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;  <span class="keywordflow">if</span> (MFI-&gt;<a class="code" href="classllvm_1_1MachineFrameInfo.html#ad104abdabbcb68deacc60c0aea1bca34">hasCalls</a>()) {</div><div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;    <span class="keywordtype">unsigned</span> MoreStackForCalls = 0;</div><div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;</div><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1MachineFunction.html#a340712de3e78fec11c338735cab17df7">MachineFunction::iterator</a> MBBI = MF.<a class="code" href="classllvm_1_1MachineFunction.html#ab0789854909cf47f640a85fa2bac29c7">begin</a>(), MBBE = MF.<a class="code" href="classllvm_1_1MachineFunction.html#a9d017af749f76484cb9aec9ff6e4330c">end</a>();</div><div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;         MBBI != MBBE; ++MBBI)</div><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1MachineBasicBlock.html#ac51be7ff80fe8d6ae5e8c0acb194908a">MachineBasicBlock::iterator</a> <a class="code" href="namespacellvm_1_1A64CC.html#af5804bc0518be9568f73db566e4d6f46a2db5e7546f960277ff98f96cd5624442">MI</a> = MBBI-&gt;begin(), ME = MBBI-&gt;end();</div><div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;           <a class="code" href="namespacellvm_1_1A64CC.html#af5804bc0518be9568f73db566e4d6f46a2db5e7546f960277ff98f96cd5624442">MI</a> != ME; ++<a class="code" href="namespacellvm_1_1A64CC.html#af5804bc0518be9568f73db566e4d6f46a2db5e7546f960277ff98f96cd5624442">MI</a>) {</div><div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm_1_1A64CC.html#af5804bc0518be9568f73db566e4d6f46a2db5e7546f960277ff98f96cd5624442">MI</a>-&gt;isCall())</div><div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;          <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;</div><div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;        <span class="comment">// Get callee operand.</span></div><div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;        <span class="keyword">const</span> <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;MO = <a class="code" href="namespacellvm_1_1A64CC.html#af5804bc0518be9568f73db566e4d6f46a2db5e7546f960277ff98f96cd5624442">MI</a>-&gt;getOperand(0);</div><div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;</div><div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;        <span class="comment">// Only take account of global function calls (no closures etc.).</span></div><div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;        <span class="keywordflow">if</span> (!MO.<a class="code" href="classllvm_1_1MachineOperand.html#a58048141ed81d581f3fb9a797f3186ee">isGlobal</a>())</div><div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;          <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;</div><div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;        <span class="keyword">const</span> <a class="code" href="classllvm_1_1Function.html">Function</a> *<a class="code" href="LLParser_8cpp.html#a33ece1ef8074506a15d7f86eb76dbae6">F</a> = <a class="code" href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1Function.html">Function</a>&gt;(MO.<a class="code" href="classllvm_1_1MachineOperand.html#a0c3a2a5a49795f8750ebd02dc0e6e11e">getGlobal</a>());</div><div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;        <span class="keywordflow">if</span> (!F)</div><div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;          <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;</div><div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;        <span class="comment">// Do not update &#39;MaxStack&#39; for primitive and built-in functions</span></div><div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;        <span class="comment">// (encoded with names either starting with &quot;erlang.&quot;/&quot;bif_&quot; or not</span></div><div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;        <span class="comment">// having a &quot;.&quot;, such as a simple &lt;Module&gt;.&lt;Function&gt;.&lt;Arity&gt;, or an</span></div><div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;        <span class="comment">// &quot;_&quot;, such as the BIF &quot;suspend_0&quot;) as they are executed on another</span></div><div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;        <span class="comment">// stack.</span></div><div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;        <span class="keywordflow">if</span> (F-&gt;<a class="code" href="classllvm_1_1Value.html#ad452febc1ac0b394876e640ec03ffa38">getName</a>().<a class="code" href="classllvm_1_1StringRef.html#a421e16456fe6d7b71fb4af736194165c">find</a>(<span class="stringliteral">&quot;erlang.&quot;</span>) != <a class="code" href="classllvm_1_1StringRef.html#a7414af479a1a88b0631120a4fc681e20">StringRef::npos</a> ||</div><div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;            F-&gt;<a class="code" href="classllvm_1_1Value.html#ad452febc1ac0b394876e640ec03ffa38">getName</a>().<a class="code" href="classllvm_1_1StringRef.html#a421e16456fe6d7b71fb4af736194165c">find</a>(<span class="stringliteral">&quot;bif_&quot;</span>) != <a class="code" href="classllvm_1_1StringRef.html#a7414af479a1a88b0631120a4fc681e20">StringRef::npos</a> ||</div><div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;            F-&gt;<a class="code" href="classllvm_1_1Value.html#ad452febc1ac0b394876e640ec03ffa38">getName</a>().<a class="code" href="classllvm_1_1StringRef.html#a54b5863f31e0a39c204f3460f9ddde75">find_first_of</a>(<span class="stringliteral">&quot;._&quot;</span>) == <a class="code" href="classllvm_1_1StringRef.html#a7414af479a1a88b0631120a4fc681e20">StringRef::npos</a>)</div><div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;          <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;</div><div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;        <span class="keywordtype">unsigned</span> CalleeStkArity =</div><div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;          F-&gt;<a class="code" href="classllvm_1_1Function.html#aef89c402976e04c0abe4b10a963d35e3">arg_size</a>() &gt; CCRegisteredArgs ? F-&gt;<a class="code" href="classllvm_1_1Function.html#aef89c402976e04c0abe4b10a963d35e3">arg_size</a>()-CCRegisteredArgs : 0;</div><div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;        <span class="keywordflow">if</span> (HipeLeafWords - 1 &gt; CalleeStkArity)</div><div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;          MoreStackForCalls = std::max(MoreStackForCalls,</div><div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;                               (HipeLeafWords - 1 - CalleeStkArity) * SlotSize);</div><div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;      }</div><div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;    MaxStack += MoreStackForCalls;</div><div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;  }</div><div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;</div><div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;  <span class="comment">// If the stack frame needed is larger than the guaranteed then runtime checks</span></div><div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;  <span class="comment">// and calls to &quot;inc_stack_0&quot; BIF should be inserted in the assembly prologue.</span></div><div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;  <span class="keywordflow">if</span> (MaxStack &gt; Guaranteed) {</div><div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;    <a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> &amp;prologueMBB = MF.<a class="code" href="classllvm_1_1MachineFunction.html#af562445435f18637f07676da054ba02c">front</a>();</div><div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;    <a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> *stackCheckMBB = MF.<a class="code" href="classllvm_1_1MachineFunction.html#ab2a56feb4fe943ae2362d61f3a43acca">CreateMachineBasicBlock</a>();</div><div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;    <a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> *incStackMBB = MF.<a class="code" href="classllvm_1_1MachineFunction.html#ab2a56feb4fe943ae2362d61f3a43acca">CreateMachineBasicBlock</a>();</div><div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;</div><div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1MachineBasicBlock.html#a7bab64c02d740522f94f5f45959a22fc">MachineBasicBlock::livein_iterator</a> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = prologueMBB.<a class="code" href="classllvm_1_1MachineBasicBlock.html#a6833d4f80b7e44f505b2184b04ea2693">livein_begin</a>(),</div><div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;           E = prologueMBB.<a class="code" href="classllvm_1_1MachineBasicBlock.html#aa314325c7062fd067a3c0b9339aa8ea6">livein_end</a>(); <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> != E; <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>++) {</div><div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;      stackCheckMBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#ae26efdb76d5c56388c65dc5b02a2ae6f">addLiveIn</a>(*<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div><div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;      incStackMBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#ae26efdb76d5c56388c65dc5b02a2ae6f">addLiveIn</a>(*<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div><div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;    }</div><div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;</div><div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;    MF.<a class="code" href="classllvm_1_1MachineFunction.html#a6a437bb3c4a44ac328344e5f361c7816">push_front</a>(incStackMBB);</div><div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;    MF.<a class="code" href="classllvm_1_1MachineFunction.html#a6a437bb3c4a44ac328344e5f361c7816">push_front</a>(stackCheckMBB);</div><div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;</div><div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;    <span class="keywordtype">unsigned</span> ScratchReg, SPReg, PReg, SPLimitOffset;</div><div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;    <span class="keywordtype">unsigned</span> LEAop, CMPop, CALLop;</div><div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;    <span class="keywordflow">if</span> (Is64Bit) {</div><div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;      SPReg = X86::RSP;</div><div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;      PReg  = X86::RBP;</div><div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;      LEAop = X86::LEA64r;</div><div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;      CMPop = X86::CMP64rm;</div><div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;      CALLop = X86::CALL64pcrel32;</div><div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;      SPLimitOffset = 0x90;</div><div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;      SPReg = <a class="code" href="namespacellvm_1_1N86.html#a154c9f74eba4608c7d1b656eb025a96da303dfe7256beaf60eaaa93d1c418965b">X86::ESP</a>;</div><div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;      PReg  = <a class="code" href="namespacellvm_1_1N86.html#a154c9f74eba4608c7d1b656eb025a96da85b6ab9236a61c8ddb3dd0928a8795c6">X86::EBP</a>;</div><div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;      LEAop = X86::LEA32r;</div><div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;      CMPop = X86::CMP32rm;</div><div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;      CALLop = X86::CALLpcrel32;</div><div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;      SPLimitOffset = 0x4c;</div><div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;    }</div><div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;</div><div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;    ScratchReg = <a class="code" href="X86FrameLowering_8cpp.html#a38ade45dd7bb38c669a112f7079f9395">GetScratchRegister</a>(Is64Bit, MF, <span class="keyword">true</span>);</div><div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;    assert(!MF.<a class="code" href="classllvm_1_1MachineFunction.html#ab4a6ca428289b667dd691a00e9f7e334">getRegInfo</a>().<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5e4b09e8d0f31b43fd5a912ed288bccb">isLiveIn</a>(ScratchReg) &amp;&amp;</div><div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;           <span class="stringliteral">&quot;HiPE prologue scratch register is live-in&quot;</span>);</div><div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;</div><div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;    <span class="comment">// Create new MBB for StackCheck:</span></div><div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;    <a class="code" href="namespacellvm.html#afad63f3314b8553ee3c26d020b3ce09e">addRegOffset</a>(<a class="code" href="namespacellvm.html#a980570dc1410d4ef53806f82028ca381">BuildMI</a>(stackCheckMBB, DL, TII.get(LEAop), ScratchReg),</div><div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;                 SPReg, <span class="keyword">false</span>, -MaxStack);</div><div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;    <span class="comment">// SPLimitOffset is in a fixed heap location (pointed by BP).</span></div><div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;    <a class="code" href="namespacellvm.html#afad63f3314b8553ee3c26d020b3ce09e">addRegOffset</a>(<a class="code" href="namespacellvm.html#a980570dc1410d4ef53806f82028ca381">BuildMI</a>(stackCheckMBB, DL, TII.get(CMPop))</div><div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;                 .addReg(ScratchReg), PReg, <span class="keyword">false</span>, SPLimitOffset);</div><div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;    <a class="code" href="namespacellvm.html#a980570dc1410d4ef53806f82028ca381">BuildMI</a>(stackCheckMBB, DL, TII.get(X86::JAE_4)).addMBB(&amp;prologueMBB);</div><div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;</div><div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;    <span class="comment">// Create new MBB for IncStack:</span></div><div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;    <a class="code" href="namespacellvm.html#a980570dc1410d4ef53806f82028ca381">BuildMI</a>(incStackMBB, DL, TII.get(CALLop)).</div><div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;      addExternalSymbol(<span class="stringliteral">&quot;inc_stack_0&quot;</span>);</div><div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;    <a class="code" href="namespacellvm.html#afad63f3314b8553ee3c26d020b3ce09e">addRegOffset</a>(<a class="code" href="namespacellvm.html#a980570dc1410d4ef53806f82028ca381">BuildMI</a>(incStackMBB, DL, TII.get(LEAop), ScratchReg),</div><div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;                 SPReg, <span class="keyword">false</span>, -MaxStack);</div><div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;    <a class="code" href="namespacellvm.html#afad63f3314b8553ee3c26d020b3ce09e">addRegOffset</a>(<a class="code" href="namespacellvm.html#a980570dc1410d4ef53806f82028ca381">BuildMI</a>(incStackMBB, DL, TII.get(CMPop))</div><div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;                 .addReg(ScratchReg), PReg, <span class="keyword">false</span>, SPLimitOffset);</div><div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;    <a class="code" href="namespacellvm.html#a980570dc1410d4ef53806f82028ca381">BuildMI</a>(incStackMBB, DL, TII.get(X86::JLE_4)).addMBB(incStackMBB);</div><div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;</div><div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;    stackCheckMBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#a3fcc360e6de146a370e8b0deecfa877f">addSuccessor</a>(&amp;prologueMBB, 99);</div><div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;    stackCheckMBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#a3fcc360e6de146a370e8b0deecfa877f">addSuccessor</a>(incStackMBB, 1);</div><div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;    incStackMBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#a3fcc360e6de146a370e8b0deecfa877f">addSuccessor</a>(&amp;prologueMBB, 99);</div><div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;    incStackMBB-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#a3fcc360e6de146a370e8b0deecfa877f">addSuccessor</a>(incStackMBB, 1);</div><div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;  }</div><div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;<span class="preprocessor">#ifdef XDEBUG</span></div><div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;  MF.<a class="code" href="classllvm_1_1MachineFunction.html#add0f152096ce3939934fb0be4558b1b0">verify</a>();</div><div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;}</div><div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;</div><div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classllvm_1_1X86FrameLowering.html#a788449e381b20c0c8111a0c43cc4e805">X86FrameLowering::</a></div><div class="line"><a name="l01482"></a><span class="lineno"><a class="line" href="classllvm_1_1X86FrameLowering.html#a788449e381b20c0c8111a0c43cc4e805"> 1482</a></span>&#160;<a class="code" href="classllvm_1_1X86FrameLowering.html#a788449e381b20c0c8111a0c43cc4e805">eliminateCallFramePseudoInstr</a>(<a class="code" href="classllvm_1_1MachineFunction.html">MachineFunction</a> &amp;MF, <a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> &amp;MBB,</div><div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;                              <a class="code" href="classllvm_1_1MachineBasicBlock.html#ac51be7ff80fe8d6ae5e8c0acb194908a">MachineBasicBlock::iterator</a> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)<span class="keyword"> const </span>{</div><div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1X86InstrInfo.html">X86InstrInfo</a> &amp;<a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a> = *TM.<a class="code" href="classllvm_1_1X86TargetMachine.html#a245ed1de411cd3ba114322a573b524f5">getInstrInfo</a>();</div><div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1X86RegisterInfo.html">X86RegisterInfo</a> &amp;RegInfo = *TM.<a class="code" href="classllvm_1_1X86TargetMachine.html#a350524cf8e1e0e53a6d856188d851ec4">getRegisterInfo</a>();</div><div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;  <span class="keywordtype">unsigned</span> StackPtr = RegInfo.<a class="code" href="classllvm_1_1X86RegisterInfo.html#ac26e69b92e7ee67cfe9766db55b221da">getStackRegister</a>();</div><div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;  <span class="keywordtype">bool</span> reseveCallFrame = <a class="code" href="classllvm_1_1X86FrameLowering.html#a63ad28e4eca30cc88163e78e90974e7e">hasReservedCallFrame</a>(MF);</div><div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;  <span class="keywordtype">int</span> Opcode = I-&gt;getOpcode();</div><div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;  <span class="keywordtype">bool</span> isDestroy = Opcode == TII.getCallFrameDestroyOpcode();</div><div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;  <span class="keywordtype">bool</span> IsLP64 = STI.<a class="code" href="classllvm_1_1X86Subtarget.html#ae380c7f0dbea1c8e93b42f1a1708e1a0">isTarget64BitLP64</a>();</div><div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;  <a class="code" href="classllvm_1_1DebugLoc.html">DebugLoc</a> DL = I-&gt;getDebugLoc();</div><div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;  uint64_t Amount = !reseveCallFrame ? I-&gt;getOperand(0).getImm() : 0;</div><div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;  uint64_t CalleeAmt = isDestroy ? I-&gt;getOperand(1).getImm() : 0;</div><div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;  I = MBB.<a class="code" href="classllvm_1_1MachineBasicBlock.html#a537a9265c55392ab47d44954f27db538">erase</a>(I);</div><div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;</div><div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;  <span class="keywordflow">if</span> (!reseveCallFrame) {</div><div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;    <span class="comment">// If the stack pointer can be changed after prologue, turn the</span></div><div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;    <span class="comment">// adjcallstackup instruction into a &#39;sub ESP, &lt;amt&gt;&#39; and the</span></div><div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;    <span class="comment">// adjcallstackdown instruction into &#39;add ESP, &lt;amt&gt;&#39;</span></div><div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;    <span class="comment">// TODO: consider using push / pop instead of sub + store / add</span></div><div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;    <span class="keywordflow">if</span> (Amount == 0)</div><div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;</div><div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;    <span class="comment">// We need to keep the stack aligned properly.  To do this, we round the</span></div><div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;    <span class="comment">// amount of space needed for the outgoing arguments up to the next</span></div><div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;    <span class="comment">// alignment boundary.</span></div><div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;    <span class="keywordtype">unsigned</span> StackAlign = TM.<a class="code" href="classllvm_1_1X86TargetMachine.html#a0f9e3271ccf39f4fdf00eb246e6ef5b3">getFrameLowering</a>()-&gt;<a class="code" href="classllvm_1_1TargetFrameLowering.html#a360555ed6db3b28a33fa5449a0335f19">getStackAlignment</a>();</div><div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;    Amount = (Amount + StackAlign - 1) / StackAlign * StackAlign;</div><div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;</div><div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;    <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *New = 0;</div><div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;    <span class="keywordflow">if</span> (Opcode == TII.getCallFrameSetupOpcode()) {</div><div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;      New = <a class="code" href="namespacellvm.html#a980570dc1410d4ef53806f82028ca381">BuildMI</a>(MF, DL, TII.get(<a class="code" href="X86FrameLowering_8cpp.html#a277b1c0324a7229d31f3eeff08311411">getSUBriOpcode</a>(IsLP64, Amount)),</div><div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;                    StackPtr)</div><div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;        .addReg(StackPtr)</div><div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;        .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a9f1fae6a5dbb6e378ca85df1fded8515">addImm</a>(Amount);</div><div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;      assert(Opcode == TII.getCallFrameDestroyOpcode());</div><div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;</div><div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;      <span class="comment">// Factor out the amount the callee already popped.</span></div><div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;      Amount -= CalleeAmt;</div><div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;</div><div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;      <span class="keywordflow">if</span> (Amount) {</div><div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;        <span class="keywordtype">unsigned</span> Opc = <a class="code" href="X86FrameLowering_8cpp.html#aa7b08d583ef6aae95b4a2c5d46d96d48">getADDriOpcode</a>(IsLP64, Amount);</div><div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;        New = <a class="code" href="namespacellvm.html#a980570dc1410d4ef53806f82028ca381">BuildMI</a>(MF, DL, TII.get(Opc), StackPtr)</div><div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;          .addReg(StackPtr).<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a9f1fae6a5dbb6e378ca85df1fded8515">addImm</a>(Amount);</div><div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;      }</div><div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;    }</div><div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;</div><div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;    <span class="keywordflow">if</span> (New) {</div><div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;      <span class="comment">// The EFLAGS implicit def is dead.</span></div><div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;      New-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a302e45878c6dc1714334c7ce96d56846">getOperand</a>(3).<a class="code" href="classllvm_1_1MachineOperand.html#a61a42c85bd86c6ca4554e27d33c3f798">setIsDead</a>();</div><div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;</div><div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;      <span class="comment">// Replace the pseudo instruction with a new instruction.</span></div><div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;      MBB.<a class="code" href="classllvm_1_1MachineBasicBlock.html#a8d02c1e6ef20f42c10d6f4e7234efd61">insert</a>(I, New);</div><div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;    }</div><div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;</div><div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;  }</div><div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;</div><div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;  <span class="keywordflow">if</span> (Opcode == TII.getCallFrameDestroyOpcode() &amp;&amp; CalleeAmt) {</div><div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;    <span class="comment">// If we are performing frame pointer elimination and if the callee pops</span></div><div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;    <span class="comment">// something off the stack pointer, add it back.  We do this until we have</span></div><div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;    <span class="comment">// more advanced stack pointer tracking ability.</span></div><div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;    <span class="keywordtype">unsigned</span> Opc = <a class="code" href="X86FrameLowering_8cpp.html#a277b1c0324a7229d31f3eeff08311411">getSUBriOpcode</a>(IsLP64, CalleeAmt);</div><div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;    <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *New = <a class="code" href="namespacellvm.html#a980570dc1410d4ef53806f82028ca381">BuildMI</a>(MF, DL, TII.get(Opc), StackPtr)</div><div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;      .addReg(StackPtr).<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a9f1fae6a5dbb6e378ca85df1fded8515">addImm</a>(CalleeAmt);</div><div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;</div><div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;    <span class="comment">// The EFLAGS implicit def is dead.</span></div><div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;    New-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a302e45878c6dc1714334c7ce96d56846">getOperand</a>(3).<a class="code" href="classllvm_1_1MachineOperand.html#a61a42c85bd86c6ca4554e27d33c3f798">setIsDead</a>();</div><div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;</div><div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;    <span class="comment">// We are not tracking the stack pointer adjustment by the callee, so make</span></div><div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;    <span class="comment">// sure we restore the stack pointer immediately after the call, there may</span></div><div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;    <span class="comment">// be spill code inserted between the CALL and ADJCALLSTACKUP instructions.</span></div><div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;    <a class="code" href="classllvm_1_1MachineBasicBlock.html#ac51be7ff80fe8d6ae5e8c0acb194908a">MachineBasicBlock::iterator</a> <a class="code" href="Target_2ARM_2README_8txt.html#a90cca76dd78688687e0d697679dbc799">B</a> = MBB.<a class="code" href="classllvm_1_1MachineBasicBlock.html#ab2d91e7bec944efcbc39d8e30644f111">begin</a>();</div><div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;    <span class="keywordflow">while</span> (I != B &amp;&amp; !<a class="code" href="namespacellvm.html#a7923e3e207de8bc1d0d6a5091316ddde">llvm::prior</a>(I)-&gt;isCall())</div><div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;      --<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>;</div><div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;    MBB.<a class="code" href="classllvm_1_1MachineBasicBlock.html#a8d02c1e6ef20f42c10d6f4e7234efd61">insert</a>(I, New);</div><div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;  }</div><div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;}</div><div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;</div><div class="ttc" id="classllvm_1_1MachineFunction_html_a6a437bb3c4a44ac328344e5f361c7816"><div class="ttname"><a href="classllvm_1_1MachineFunction.html#a6a437bb3c4a44ac328344e5f361c7816">llvm::MachineFunction::push_front</a></div><div class="ttdeci">void push_front(MachineBasicBlock *MBB)</div><div class="ttdef"><b>Definition:</b> <a href="MachineFunction_8h_source.html#l00333">MachineFunction.h:333</a></div></div>
<div class="ttc" id="classllvm_1_1TargetFrameLowering_html_a360555ed6db3b28a33fa5449a0335f19"><div class="ttname"><a href="classllvm_1_1TargetFrameLowering.html#a360555ed6db3b28a33fa5449a0335f19">llvm::TargetFrameLowering::getStackAlignment</a></div><div class="ttdeci">unsigned getStackAlignment() const </div><div class="ttdef"><b>Definition:</b> <a href="TargetFrameLowering_8h_source.html#l00070">TargetFrameLowering.h:70</a></div></div>
<div class="ttc" id="SmallSet_8h_html"><div class="ttname"><a href="SmallSet_8h.html">SmallSet.h</a></div></div>
<div class="ttc" id="classllvm_1_1MachineBasicBlock_html_af2e482ff2a9253ec6bc2285491496bd6"><div class="ttname"><a href="classllvm_1_1MachineBasicBlock.html#af2e482ff2a9253ec6bc2285491496bd6">llvm::MachineBasicBlock::getParent</a></div><div class="ttdeci">const MachineFunction * getParent() const </div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8h_source.html#l00137">MachineBasicBlock.h:137</a></div></div>
<div class="ttc" id="classllvm_1_1X86FrameLowering_html_a1687406681a3072d9725f904f282504d"><div class="ttname"><a href="classllvm_1_1X86FrameLowering.html#a1687406681a3072d9725f904f282504d">llvm::X86FrameLowering::getFrameIndexReference</a></div><div class="ttdeci">int getFrameIndexReference(const MachineFunction &amp;MF, int FI, unsigned &amp;FrameReg) const </div><div class="ttdef"><b>Definition:</b> <a href="X86FrameLowering_8cpp_source.html#l00946">X86FrameLowering.cpp:946</a></div></div>
<div class="ttc" id="classllvm_1_1MachineBasicBlock_html_a537a9265c55392ab47d44954f27db538"><div class="ttname"><a href="classllvm_1_1MachineBasicBlock.html#a537a9265c55392ab47d44954f27db538">llvm::MachineBasicBlock::erase</a></div><div class="ttdeci">instr_iterator erase(instr_iterator I)</div></div>
<div class="ttc" id="classllvm_1_1MachineRegisterInfo_html_a8102e337f77143271ef8ccd4ea2546b3"><div class="ttname"><a href="classllvm_1_1MachineRegisterInfo.html#a8102e337f77143271ef8ccd4ea2546b3">llvm::MachineRegisterInfo::setPhysRegUsed</a></div><div class="ttdeci">void setPhysRegUsed(unsigned Reg)</div><div class="ttdef"><b>Definition:</b> <a href="MachineRegisterInfo_8h_source.html#l00434">MachineRegisterInfo.h:434</a></div></div>
<div class="ttc" id="classllvm_1_1MCRegisterInfo_html_ac1d330e923a5138ddb044a6ffb5d5747"><div class="ttname"><a href="classllvm_1_1MCRegisterInfo.html#ac1d330e923a5138ddb044a6ffb5d5747">llvm::MCRegisterInfo::getDwarfRegNum</a></div><div class="ttdeci">int getDwarfRegNum(unsigned RegNum, bool isEH) const </div><div class="ttdoc">Map a target register to an equivalent dwarf register number. Returns -1 if there is no equivalent va...</div><div class="ttdef"><b>Definition:</b> <a href="MCRegisterInfo_8cpp_source.html#l00061">MCRegisterInfo.cpp:61</a></div></div>
<div class="ttc" id="classllvm_1_1MachineOperand_html_a0c3a2a5a49795f8750ebd02dc0e6e11e"><div class="ttname"><a href="classllvm_1_1MachineOperand.html#a0c3a2a5a49795f8750ebd02dc0e6e11e">llvm::MachineOperand::getGlobal</a></div><div class="ttdeci">const GlobalValue * getGlobal() const </div><div class="ttdef"><b>Definition:</b> <a href="MachineOperand_8h_source.html#l00428">MachineOperand.h:428</a></div></div>
<div class="ttc" id="classllvm_1_1TargetRegisterInfo_html_ae9aacd409bfca45edfcd7bb432d3f1fe"><div class="ttname"><a href="classllvm_1_1TargetRegisterInfo.html#ae9aacd409bfca45edfcd7bb432d3f1fe">llvm::TargetRegisterInfo::getMinimalPhysRegClass</a></div><div class="ttdeci">const TargetRegisterClass * getMinimalPhysRegClass(unsigned Reg, EVT VT=MVT::Other) const </div><div class="ttdef"><b>Definition:</b> <a href="TargetRegisterInfo_8cpp_source.html#l00111">TargetRegisterInfo.cpp:111</a></div></div>
<div class="ttc" id="namespacellvm_html"><div class="ttname"><a href="namespacellvm.html">llvm</a></div><div class="ttdoc">List of target independent CodeGen pass IDs. </div><div class="ttdef"><b>Definition:</b> <a href="APFloat_8h_source.html#l00022">APFloat.h:22</a></div></div>
<div class="ttc" id="classllvm_1_1MachineRegisterInfo_html_a0e18d247091e29fe2c2c3f5bd59843fb"><div class="ttname"><a href="classllvm_1_1MachineRegisterInfo.html#a0e18d247091e29fe2c2c3f5bd59843fb">llvm::MachineRegisterInfo::livein_end</a></div><div class="ttdeci">livein_iterator livein_end() const </div><div class="ttdef"><b>Definition:</b> <a href="MachineRegisterInfo_8h_source.html#l00530">MachineRegisterInfo.h:530</a></div></div>
<div class="ttc" id="classllvm_1_1MachineFunction_html_a9d017af749f76484cb9aec9ff6e4330c"><div class="ttname"><a href="classllvm_1_1MachineFunction.html#a9d017af749f76484cb9aec9ff6e4330c">llvm::MachineFunction::end</a></div><div class="ttdeci">iterator end()</div><div class="ttdef"><b>Definition:</b> <a href="MachineFunction_8h_source.html#l00317">MachineFunction.h:317</a></div></div>
<div class="ttc" id="classllvm_1_1MCSymbol_html"><div class="ttname"><a href="classllvm_1_1MCSymbol.html">llvm::MCSymbol</a></div><div class="ttdef"><b>Definition:</b> <a href="MCSymbol_8h_source.html#l00033">MCSymbol.h:33</a></div></div>
<div class="ttc" id="classllvm_1_1MachineFunction_html"><div class="ttname"><a href="classllvm_1_1MachineFunction.html">llvm::MachineFunction</a></div><div class="ttdef"><b>Definition:</b> <a href="MachineFunction_8h_source.html#l00075">MachineFunction.h:75</a></div></div>
<div class="ttc" id="X86FrameLowering_8cpp_html_a7cf542551b4f3cbad42d73ab0e1ddd34"><div class="ttname"><a href="X86FrameLowering_8cpp.html#a7cf542551b4f3cbad42d73ab0e1ddd34">isEAXLiveIn</a></div><div class="ttdeci">static bool isEAXLiveIn(MachineFunction &amp;MF)</div><div class="ttdef"><b>Definition:</b> <a href="X86FrameLowering_8cpp_source.html#l00292">X86FrameLowering.cpp:292</a></div></div>
<div class="ttc" id="classllvm_1_1X86FrameLowering_html_a8d86c59cf26f81503a2775ae176f96db"><div class="ttname"><a href="classllvm_1_1X86FrameLowering.html#a8d86c59cf26f81503a2775ae176f96db">llvm::X86FrameLowering::processFunctionBeforeCalleeSavedScan</a></div><div class="ttdeci">void processFunctionBeforeCalleeSavedScan(MachineFunction &amp;MF, RegScavenger *RS=NULL) const </div><div class="ttdef"><b>Definition:</b> <a href="X86FrameLowering_8cpp_source.html#l01057">X86FrameLowering.cpp:1057</a></div></div>
<div class="ttc" id="classllvm_1_1MachineFunction_html_ab0789854909cf47f640a85fa2bac29c7"><div class="ttname"><a href="classllvm_1_1MachineFunction.html#ab0789854909cf47f640a85fa2bac29c7">llvm::MachineFunction::begin</a></div><div class="ttdeci">iterator begin()</div><div class="ttdef"><b>Definition:</b> <a href="MachineFunction_8h_source.html#l00315">MachineFunction.h:315</a></div></div>
<div class="ttc" id="classllvm_1_1X86Subtarget_html_ad1c6e0b2b8cf40bb0c57dad5dbf0ea66"><div class="ttname"><a href="classllvm_1_1X86Subtarget.html#ad1c6e0b2b8cf40bb0c57dad5dbf0ea66">llvm::X86Subtarget::isTargetCygMing</a></div><div class="ttdeci">bool isTargetCygMing() const </div><div class="ttdef"><b>Definition:</b> <a href="X86Subtarget_8h_source.html#l00329">X86Subtarget.h:329</a></div></div>
<div class="ttc" id="classllvm_1_1MachineFunction_html_add0f152096ce3939934fb0be4558b1b0"><div class="ttname"><a href="classllvm_1_1MachineFunction.html#add0f152096ce3939934fb0be4558b1b0">llvm::MachineFunction::verify</a></div><div class="ttdeci">void verify(Pass *p=NULL, const char *Banner=NULL) const </div><div class="ttdef"><b>Definition:</b> <a href="MachineVerifier_8cpp_source.html#l00270">MachineVerifier.cpp:270</a></div></div>
<div class="ttc" id="namespacellvm_1_1X86II_html_a97dc14052814702ba0e2b14fb14dd02da50aa2061845b3ff4e6e2242d762c6a80"><div class="ttname"><a href="namespacellvm_1_1X86II.html#a97dc14052814702ba0e2b14fb14dd02da50aa2061845b3ff4e6e2242d762c6a80">llvm::X86II::FS</a></div><div class="ttdef"><b>Definition:</b> <a href="X86BaseInfo_8h_source.html#l00426">X86BaseInfo.h:426</a></div></div>
<div class="ttc" id="classllvm_1_1RegScavenger_html"><div class="ttname"><a href="classllvm_1_1RegScavenger.html">llvm::RegScavenger</a></div><div class="ttdef"><b>Definition:</b> <a href="RegisterScavenging_8h_source.html#l00031">RegisterScavenging.h:31</a></div></div>
<div class="ttc" id="classllvm_1_1X86InstrInfo_html"><div class="ttname"><a href="classllvm_1_1X86InstrInfo.html">llvm::X86InstrInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="X86InstrInfo_8h_source.html#l00130">X86InstrInfo.h:130</a></div></div>
<div class="ttc" id="classllvm_1_1X86RegisterInfo_html_ad37a65804edd5f913012ea82e22cca33"><div class="ttname"><a href="classllvm_1_1X86RegisterInfo.html#ad37a65804edd5f913012ea82e22cca33">llvm::X86RegisterInfo::hasBasePointer</a></div><div class="ttdeci">bool hasBasePointer(const MachineFunction &amp;MF) const </div><div class="ttdef"><b>Definition:</b> <a href="X86RegisterInfo_8cpp_source.html#l00400">X86RegisterInfo.cpp:400</a></div></div>
<div class="ttc" id="namespacellvm_html_a3f2f98c2a67c9e79f58aad9150a62e42"><div class="ttname"><a href="namespacellvm.html#a3f2f98c2a67c9e79f58aad9150a62e42">llvm::dyn_cast</a></div><div class="ttdeci">enable_if_c&lt;!is_simple_type&lt; Y &gt;::value, typename cast_retty&lt; X, const Y &gt;::ret_type &gt;::type dyn_cast(const Y &amp;Val)</div><div class="ttdef"><b>Definition:</b> <a href="Casting_8h_source.html#l00266">Casting.h:266</a></div></div>
<div class="ttc" id="namespacellvm_1_1RegState_html_a079b254e749130fbe5d740f314ca92daa9ddde91ef09476d28a088fe57f8e2921"><div class="ttname"><a href="namespacellvm_1_1RegState.html#a079b254e749130fbe5d740f314ca92daa9ddde91ef09476d28a088fe57f8e2921">llvm::RegState::Kill</a></div><div class="ttdef"><b>Definition:</b> <a href="MachineInstrBuilder_8h_source.html#l00033">MachineInstrBuilder.h:33</a></div></div>
<div class="ttc" id="classllvm_1_1StringRef_html_a421e16456fe6d7b71fb4af736194165c"><div class="ttname"><a href="classllvm_1_1StringRef.html#a421e16456fe6d7b71fb4af736194165c">llvm::StringRef::find</a></div><div class="ttdeci">size_t find(char C, size_t From=0) const </div><div class="ttdef"><b>Definition:</b> <a href="StringRef_8h_source.html#l00233">StringRef.h:233</a></div></div>
<div class="ttc" id="DataLayout_8h_html"><div class="ttname"><a href="DataLayout_8h.html">DataLayout.h</a></div></div>
<div class="ttc" id="classllvm_1_1MachineBasicBlock_html_a7bab64c02d740522f94f5f45959a22fc"><div class="ttname"><a href="classllvm_1_1MachineBasicBlock.html#a7bab64c02d740522f94f5f45959a22fc">llvm::MachineBasicBlock::livein_iterator</a></div><div class="ttdeci">std::vector&lt; unsigned &gt;::const_iterator livein_iterator</div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8h_source.html#l00314">MachineBasicBlock.h:314</a></div></div>
<div class="ttc" id="X86FrameLowering_8cpp_html_a492c99600e7544adc30763004b289a6b"><div class="ttname"><a href="X86FrameLowering_8cpp.html#a492c99600e7544adc30763004b289a6b">ForceStackAlign</a></div><div class="ttdeci">cl::opt&lt; bool &gt; ForceStackAlign</div></div>
<div class="ttc" id="X86FrameLowering_8cpp_html_a343c24d09ffb2fe5a9d302d2c2e5a9c5"><div class="ttname"><a href="X86FrameLowering_8cpp.html#a343c24d09ffb2fe5a9d302d2c2e5a9c5">getLEArOpcode</a></div><div class="ttdeci">static unsigned getLEArOpcode(unsigned IsLP64)</div><div class="ttdef"><b>Definition:</b> <a href="X86FrameLowering_8cpp_source.html#l00082">X86FrameLowering.cpp:82</a></div></div>
<div class="ttc" id="classllvm_1_1MCCFIInstruction_html_aea2b8a3efd6694a33452ed7e8716300e"><div class="ttname"><a href="classllvm_1_1MCCFIInstruction.html#aea2b8a3efd6694a33452ed7e8716300e">llvm::MCCFIInstruction::createOffset</a></div><div class="ttdeci">static MCCFIInstruction createOffset(MCSymbol *L, unsigned Register, int Offset)</div><div class="ttdoc">.cfi_offset Previous value of Register is saved at offset Offset from CFA. </div><div class="ttdef"><b>Definition:</b> <a href="MCDwarf_8h_source.html#l00348">MCDwarf.h:348</a></div></div>
<div class="ttc" id="classllvm_1_1X86MachineFunctionInfo_html_a006344bb6086da91383dc8feb4626f68"><div class="ttname"><a href="classllvm_1_1X86MachineFunctionInfo.html#a006344bb6086da91383dc8feb4626f68">llvm::X86MachineFunctionInfo::getArgumentStackSize</a></div><div class="ttdeci">unsigned getArgumentStackSize() const </div><div class="ttdef"><b>Definition:</b> <a href="X86MachineFunctionInfo_8h_source.html#l00135">X86MachineFunctionInfo.h:135</a></div></div>
<div class="ttc" id="namespacellvm_1_1RegState_html_a079b254e749130fbe5d740f314ca92daa0fec8ba6f4a4dc758b725205985eee99"><div class="ttname"><a href="namespacellvm_1_1RegState.html#a079b254e749130fbe5d740f314ca92daa0fec8ba6f4a4dc758b725205985eee99">llvm::RegState::Implicit</a></div><div class="ttdef"><b>Definition:</b> <a href="MachineInstrBuilder_8h_source.html#l00032">MachineInstrBuilder.h:32</a></div></div>
<div class="ttc" id="classllvm_1_1MachineFrameInfo_html_a54aab1c41d2657472b4ea7c9935570c7"><div class="ttname"><a href="classllvm_1_1MachineFrameInfo.html#a54aab1c41d2657472b4ea7c9935570c7">llvm::MachineFrameInfo::adjustsStack</a></div><div class="ttdeci">bool adjustsStack() const </div><div class="ttdef"><b>Definition:</b> <a href="MachineFrameInfo_8h_source.html#l00447">MachineFrameInfo.h:447</a></div></div>
<div class="ttc" id="classllvm_1_1MachineBasicBlock_html_ae26efdb76d5c56388c65dc5b02a2ae6f"><div class="ttname"><a href="classllvm_1_1MachineBasicBlock.html#ae26efdb76d5c56388c65dc5b02a2ae6f">llvm::MachineBasicBlock::addLiveIn</a></div><div class="ttdeci">void addLiveIn(unsigned Reg)</div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8h_source.html#l00297">MachineBasicBlock.h:297</a></div></div>
<div class="ttc" id="README-SSE_8txt_html_af63bcf34c820f95f096676adf8358de4"><div class="ttname"><a href="README-SSE_8txt.html#af63bcf34c820f95f096676adf8358de4">EBX</a></div><div class="ttdeci">We currently esp xorpd xmm0 xmm0 xmm1 xmm2 xmm1 jb LBB_X_2 xmm2 esp esp ret Lower memcpy memset to a series of SSE bit move instructions when it s feasible Still ok After register LLVM ADD32rm IMUL32rr EDX ESI ADD32rr ESI SHUFPSrr EBX</div><div class="ttdef"><b>Definition:</b> <a href="README-SSE_8txt_source.html#l00222">README-SSE.txt:222</a></div></div>
<div class="ttc" id="classllvm_1_1X86MachineFunctionInfo_html_a48ab7f9b817ff462e08d8a5858b4c6fc"><div class="ttname"><a href="classllvm_1_1X86MachineFunctionInfo.html#a48ab7f9b817ff462e08d8a5858b4c6fc">llvm::X86MachineFunctionInfo::getCalleeSavedFrameSize</a></div><div class="ttdeci">unsigned getCalleeSavedFrameSize() const </div><div class="ttdef"><b>Definition:</b> <a href="X86MachineFunctionInfo_8h_source.html#l00105">X86MachineFunctionInfo.h:105</a></div></div>
<div class="ttc" id="classllvm_1_1X86MachineFunctionInfo_html_af3682a96148f7c1e534dfa7c2726ccec"><div class="ttname"><a href="classllvm_1_1X86MachineFunctionInfo.html#af3682a96148f7c1e534dfa7c2726ccec">llvm::X86MachineFunctionInfo::setCalleeSavedFrameSize</a></div><div class="ttdeci">void setCalleeSavedFrameSize(unsigned bytes)</div><div class="ttdef"><b>Definition:</b> <a href="X86MachineFunctionInfo_8h_source.html#l00106">X86MachineFunctionInfo.h:106</a></div></div>
<div class="ttc" id="classllvm_1_1X86FrameLowering_html_a788449e381b20c0c8111a0c43cc4e805"><div class="ttname"><a href="classllvm_1_1X86FrameLowering.html#a788449e381b20c0c8111a0c43cc4e805">llvm::X86FrameLowering::eliminateCallFramePseudoInstr</a></div><div class="ttdeci">void eliminateCallFramePseudoInstr(MachineFunction &amp;MF, MachineBasicBlock &amp;MBB, MachineBasicBlock::iterator MI) const </div><div class="ttdef"><b>Definition:</b> <a href="X86FrameLowering_8cpp_source.html#l01482">X86FrameLowering.cpp:1482</a></div></div>
<div class="ttc" id="classllvm_1_1Function_html_a8300ac1ef141b8a7c63c13fa9369d976"><div class="ttname"><a href="classllvm_1_1Function.html#a8300ac1ef141b8a7c63c13fa9369d976">llvm::Function::arg_end</a></div><div class="ttdeci">arg_iterator arg_end()</div><div class="ttdef"><b>Definition:</b> <a href="Function_8h_source.html#l00418">Function.h:418</a></div></div>
<div class="ttc" id="classllvm_1_1MachineOperand_html_ad9456ef14a72da4e4def5d8747c41a09"><div class="ttname"><a href="classllvm_1_1MachineOperand.html#ad9456ef14a72da4e4def5d8747c41a09">llvm::MachineOperand::getSymbolName</a></div><div class="ttdeci">const char * getSymbolName() const </div><div class="ttdef"><b>Definition:</b> <a href="MachineOperand_8h_source.html#l00452">MachineOperand.h:452</a></div></div>
<div class="ttc" id="MCAsmInfo_8h_html"><div class="ttname"><a href="MCAsmInfo_8h.html">MCAsmInfo.h</a></div></div>
<div class="ttc" id="classllvm_1_1DebugLoc_html"><div class="ttname"><a href="classllvm_1_1DebugLoc.html">llvm::DebugLoc</a></div><div class="ttdef"><b>Definition:</b> <a href="DebugLoc_8h_source.html#l00028">DebugLoc.h:28</a></div></div>
<div class="ttc" id="classllvm_1_1MachineOperand_html_a61a42c85bd86c6ca4554e27d33c3f798"><div class="ttname"><a href="classllvm_1_1MachineOperand.html#a61a42c85bd86c6ca4554e27d33c3f798">llvm::MachineOperand::setIsDead</a></div><div class="ttdeci">void setIsDead(bool Val=true)</div><div class="ttdef"><b>Definition:</b> <a href="MachineOperand_8h_source.html#l00373">MachineOperand.h:373</a></div></div>
<div class="ttc" id="LLParser_8cpp_html_a33ece1ef8074506a15d7f86eb76dbae6"><div class="ttname"><a href="LLParser_8cpp.html#a33ece1ef8074506a15d7f86eb76dbae6">F</a></div><div class="ttdeci">F(f)</div></div>
<div class="ttc" id="classllvm_1_1MachineFunction_html_ad784a6594990530bffb2018aeeed56f3"><div class="ttname"><a href="classllvm_1_1MachineFunction.html#ad784a6594990530bffb2018aeeed56f3">llvm::MachineFunction::getFunction</a></div><div class="ttdeci">const Function * getFunction() const </div><div class="ttdef"><b>Definition:</b> <a href="MachineFunction_8h_source.html#l00151">MachineFunction.h:151</a></div></div>
<div class="ttc" id="classllvm_1_1Function_html"><div class="ttname"><a href="classllvm_1_1Function.html">llvm::Function</a></div><div class="ttdef"><b>Definition:</b> <a href="Function_8h_source.html#l00070">Function.h:70</a></div></div>
<div class="ttc" id="classllvm_1_1MachineBasicBlock_html_acbc921830578e2741be6549db716c0ce"><div class="ttname"><a href="classllvm_1_1MachineBasicBlock.html#acbc921830578e2741be6549db716c0ce">llvm::MachineBasicBlock::end</a></div><div class="ttdeci">iterator end()</div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8h_source.html#l00238">MachineBasicBlock.h:238</a></div></div>
<div class="ttc" id="X86FrameLowering_8cpp_html_a989e9805774ba0c66cd1554a66a7a782"><div class="ttname"><a href="X86FrameLowering_8cpp.html#a989e9805774ba0c66cd1554a66a7a782">findDeadCallerSavedReg</a></div><div class="ttdeci">static unsigned findDeadCallerSavedReg(MachineBasicBlock &amp;MBB, MachineBasicBlock::iterator &amp;MBBI, const TargetRegisterInfo &amp;TRI, bool Is64Bit)</div><div class="ttdef"><b>Definition:</b> <a href="X86FrameLowering_8cpp_source.html#l00089">X86FrameLowering.cpp:89</a></div></div>
<div class="ttc" id="classllvm_1_1X86RegisterInfo_html_a2883bb621245229de23a6396b1ef81b7"><div class="ttname"><a href="classllvm_1_1X86RegisterInfo.html#a2883bb621245229de23a6396b1ef81b7">llvm::X86RegisterInfo::getFrameRegister</a></div><div class="ttdeci">unsigned getFrameRegister(const MachineFunction &amp;MF) const </div><div class="ttdef"><b>Definition:</b> <a href="X86RegisterInfo_8cpp_source.html#l00517">X86RegisterInfo.cpp:517</a></div></div>
<div class="ttc" id="classllvm_1_1AttributeSet_html_a54abbe67d4a53c92652f1666dc19281f"><div class="ttname"><a href="classllvm_1_1AttributeSet.html#a54abbe67d4a53c92652f1666dc19281f">llvm::AttributeSet::hasAttribute</a></div><div class="ttdeci">bool hasAttribute(unsigned Index, Attribute::AttrKind Kind) const </div><div class="ttdoc">Return true if the attribute exists at the given index. </div><div class="ttdef"><b>Definition:</b> <a href="Attributes_8cpp_source.html#l00818">Attributes.cpp:818</a></div></div>
<div class="ttc" id="classllvm_1_1MCCFIInstruction_html_a574f705ef18dd3e6c46c0a6b0ae81b08"><div class="ttname"><a href="classllvm_1_1MCCFIInstruction.html#a574f705ef18dd3e6c46c0a6b0ae81b08">llvm::MCCFIInstruction::createDefCfaOffset</a></div><div class="ttdeci">static MCCFIInstruction createDefCfaOffset(MCSymbol *L, int Offset)</div><div class="ttdoc">.cfi_def_cfa_offset modifies a rule for computing CFA. Register remains the same, but offset is new...</div><div class="ttdef"><b>Definition:</b> <a href="MCDwarf_8h_source.html#l00335">MCDwarf.h:335</a></div></div>
<div class="ttc" id="namespacellvm_html_a1f6978055dbb761b380de39070e34bd3"><div class="ttname"><a href="namespacellvm.html#a1f6978055dbb761b380de39070e34bd3">llvm::report_fatal_error</a></div><div class="ttdeci">LLVM_ATTRIBUTE_NORETURN void report_fatal_error(const char *reason, bool gen_crash_diag=true)</div><div class="ttdef"><b>Definition:</b> <a href="ErrorHandling_8cpp_source.html#l00053">ErrorHandling.cpp:53</a></div></div>
<div class="ttc" id="classllvm_1_1Function_html_af4d5ada526cdf057f5f29047e058187d"><div class="ttname"><a href="classllvm_1_1Function.html#af4d5ada526cdf057f5f29047e058187d">llvm::Function::getCallingConv</a></div><div class="ttdeci">CallingConv::ID getCallingConv() const </div><div class="ttdef"><b>Definition:</b> <a href="Function_8h_source.html#l00161">Function.h:161</a></div></div>
<div class="ttc" id="classllvm_1_1Function_html_aef89c402976e04c0abe4b10a963d35e3"><div class="ttname"><a href="classllvm_1_1Function.html#aef89c402976e04c0abe4b10a963d35e3">llvm::Function::arg_size</a></div><div class="ttdeci">size_t arg_size() const </div><div class="ttdef"><b>Definition:</b> <a href="Function_8cpp_source.html#l00248">Function.cpp:248</a></div></div>
<div class="ttc" id="classllvm_1_1Value_html_ad452febc1ac0b394876e640ec03ffa38"><div class="ttname"><a href="classllvm_1_1Value.html#ad452febc1ac0b394876e640ec03ffa38">llvm::Value::getName</a></div><div class="ttdeci">StringRef getName() const </div><div class="ttdef"><b>Definition:</b> <a href="Value_8cpp_source.html#l00167">Value.cpp:167</a></div></div>
<div class="ttc" id="classllvm_1_1X86MachineFunctionInfo_html"><div class="ttname"><a href="classllvm_1_1X86MachineFunctionInfo.html">llvm::X86MachineFunctionInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="X86MachineFunctionInfo_8h_source.html#l00023">X86MachineFunctionInfo.h:23</a></div></div>
<div class="ttc" id="classllvm_1_1MachineFrameInfo_html_a0af0a11b8eda54e79422c199cb687f5c"><div class="ttname"><a href="classllvm_1_1MachineFrameInfo.html#a0af0a11b8eda54e79422c199cb687f5c">llvm::MachineFrameInfo::getMaxAlignment</a></div><div class="ttdeci">unsigned getMaxAlignment() const </div><div class="ttdef"><b>Definition:</b> <a href="MachineFrameInfo_8h_source.html#l00438">MachineFrameInfo.h:438</a></div></div>
<div class="ttc" id="classllvm_1_1MachineFrameInfo_html_a5296aac05a8ccceb0d89d449611722d3"><div class="ttname"><a href="classllvm_1_1MachineFrameInfo.html#a5296aac05a8ccceb0d89d449611722d3">llvm::MachineFrameInfo::getCalleeSavedInfo</a></div><div class="ttdeci">const std::vector&lt; CalleeSavedInfo &gt; &amp; getCalleeSavedInfo() const </div><div class="ttdef"><b>Definition:</b> <a href="MachineFrameInfo_8h_source.html#l00528">MachineFrameInfo.h:528</a></div></div>
<div class="ttc" id="classllvm_1_1MachineFrameInfo_html_a34874094b3ba8b56fd68801250f77183"><div class="ttname"><a href="classllvm_1_1MachineFrameInfo.html#a34874094b3ba8b56fd68801250f77183">llvm::MachineFrameInfo::getStackSize</a></div><div class="ttdeci">uint64_t getStackSize() const </div><div class="ttdef"><b>Definition:</b> <a href="MachineFrameInfo_8h_source.html#l00417">MachineFrameInfo.h:417</a></div></div>
<div class="ttc" id="X86DisassemblerDecoder_8h_html_a546839a5c4bcf9f9450967155f48de41"><div class="ttname"><a href="X86DisassemblerDecoder_8h.html#a546839a5c4bcf9f9450967155f48de41">Reg</a></div><div class="ttdeci">Reg</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00428">X86DisassemblerDecoder.h:428</a></div></div>
<div class="ttc" id="classllvm_1_1MachineBasicBlock_html_a6833d4f80b7e44f505b2184b04ea2693"><div class="ttname"><a href="classllvm_1_1MachineBasicBlock.html#a6833d4f80b7e44f505b2184b04ea2693">llvm::MachineBasicBlock::livein_begin</a></div><div class="ttdeci">livein_iterator livein_begin() const </div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8h_source.html#l00315">MachineBasicBlock.h:315</a></div></div>
<div class="ttc" id="classllvm_1_1X86MachineFunctionInfo_html_ae2a2c9153ec666e20698a5d3956ac2d4"><div class="ttname"><a href="classllvm_1_1X86MachineFunctionInfo.html#ae2a2c9153ec666e20698a5d3956ac2d4">llvm::X86MachineFunctionInfo::getTCReturnAddrDelta</a></div><div class="ttdeci">int getTCReturnAddrDelta() const </div><div class="ttdef"><b>Definition:</b> <a href="X86MachineFunctionInfo_8h_source.html#l00114">X86MachineFunctionInfo.h:114</a></div></div>
<div class="ttc" id="MachineFunction_8h_html"><div class="ttname"><a href="MachineFunction_8h.html">MachineFunction.h</a></div></div>
<div class="ttc" id="classllvm_1_1MCContext_html_af0efba8326e35ce320f4d2fd346cea3f"><div class="ttname"><a href="classllvm_1_1MCContext.html#af0efba8326e35ce320f4d2fd346cea3f">llvm::MCContext::CreateTempSymbol</a></div><div class="ttdeci">MCSymbol * CreateTempSymbol()</div><div class="ttdef"><b>Definition:</b> <a href="MCContext_8cpp_source.html#l00164">MCContext.cpp:164</a></div></div>
<div class="ttc" id="HexagonCopyToCombine_8cpp_html_a1d40004718218dbdf06b496766299101"><div class="ttname"><a href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a></div><div class="ttdeci">const HexagonInstrInfo * TII</div><div class="ttdef"><b>Definition:</b> <a href="HexagonCopyToCombine_8cpp_source.html#l00115">HexagonCopyToCombine.cpp:115</a></div></div>
<div class="ttc" id="classllvm_1_1X86Subtarget_html_a705e847a3a7363d59a52f8d8d56aeea9"><div class="ttname"><a href="classllvm_1_1X86Subtarget.html#a705e847a3a7363d59a52f8d8d56aeea9">llvm::X86Subtarget::isTargetDarwin</a></div><div class="ttdeci">bool isTargetDarwin() const </div><div class="ttdef"><b>Definition:</b> <a href="X86Subtarget_8h_source.html#l00311">X86Subtarget.h:311</a></div></div>
<div class="ttc" id="classllvm_1_1MachineModuleInfo_html_a6a7c50253021a755fe344738806e7f32"><div class="ttname"><a href="classllvm_1_1MachineModuleInfo.html#a6a7c50253021a755fe344738806e7f32">llvm::MachineModuleInfo::callsUnwindInit</a></div><div class="ttdeci">bool callsUnwindInit() const </div><div class="ttdef"><b>Definition:</b> <a href="MachineModuleInfo_8h_source.html#l00223">MachineModuleInfo.h:223</a></div></div>
<div class="ttc" id="X86FrameLowering_8cpp_html_a8b9066231f49c1aee00bbd009b627f80"><div class="ttname"><a href="X86FrameLowering_8cpp.html#a8b9066231f49c1aee00bbd009b627f80">usesTheStack</a></div><div class="ttdeci">static bool usesTheStack(const MachineFunction &amp;MF)</div><div class="ttdef"><b>Definition:</b> <a href="X86FrameLowering_8cpp_source.html#l00373">X86FrameLowering.cpp:373</a></div></div>
<div class="ttc" id="classllvm_1_1MachineOperand_html_a2ac18ceda9f2857fea2e5cc4e8bf4ff5"><div class="ttname"><a href="classllvm_1_1MachineOperand.html#a2ac18ceda9f2857fea2e5cc4e8bf4ff5">llvm::MachineOperand::isImm</a></div><div class="ttdeci">bool isImm() const </div><div class="ttdoc">isImm - Tests if this is a MO_Immediate operand. </div><div class="ttdef"><b>Definition:</b> <a href="MachineOperand_8h_source.html#l00226">MachineOperand.h:226</a></div></div>
<div class="ttc" id="ErrorHandling_8h_html_ace243f5c25697a1107cce46626b3dc94"><div class="ttname"><a href="ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a></div><div class="ttdeci">#define llvm_unreachable(msg)</div><div class="ttdef"><b>Definition:</b> <a href="ErrorHandling_8h_source.html#l00103">ErrorHandling.h:103</a></div></div>
<div class="ttc" id="classllvm_1_1TargetOptions_html_a55b913089f1134db4cc1ea6e677c62bd"><div class="ttname"><a href="classllvm_1_1TargetOptions.html#a55b913089f1134db4cc1ea6e677c62bd">llvm::TargetOptions::DisableFramePointerElim</a></div><div class="ttdeci">bool DisableFramePointerElim(const MachineFunction &amp;MF) const </div><div class="ttdef"><b>Definition:</b> <a href="TargetOptionsImpl_8cpp_source.html#l00022">TargetOptionsImpl.cpp:22</a></div></div>
<div class="ttc" id="classllvm_1_1MachineOperand_html_ad8198d6d83af9410d867136e33fbf4b2"><div class="ttname"><a href="classllvm_1_1MachineOperand.html#ad8198d6d83af9410d867136e33fbf4b2">llvm::MachineOperand::isReg</a></div><div class="ttdeci">bool isReg() const </div><div class="ttdoc">isReg - Tests if this is a MO_Register operand. </div><div class="ttdef"><b>Definition:</b> <a href="MachineOperand_8h_source.html#l00224">MachineOperand.h:224</a></div></div>
<div class="ttc" id="namespacellvm_html_a3e242f3485db990d043f2dcf91106ce7"><div class="ttname"><a href="namespacellvm.html#a3e242f3485db990d043f2dcf91106ce7">llvm::isInt&lt; 8 &gt;</a></div><div class="ttdeci">bool isInt&lt; 8 &gt;(int64_t x)</div><div class="ttdef"><b>Definition:</b> <a href="MathExtras_8h_source.html#l00268">MathExtras.h:268</a></div></div>
<div class="ttc" id="MachineFrameInfo_8h_html"><div class="ttname"><a href="MachineFrameInfo_8h.html">MachineFrameInfo.h</a></div></div>
<div class="ttc" id="classllvm_1_1MachineInstr_html_aafacf84de1cb994a92dc045f4aa1d518a78f1067d270179dff7915b90a03ce237"><div class="ttname"><a href="classllvm_1_1MachineInstr.html#aafacf84de1cb994a92dc045f4aa1d518a78f1067d270179dff7915b90a03ce237">llvm::MachineInstr::FrameSetup</a></div><div class="ttdef"><b>Definition:</b> <a href="MachineInstr_8h_source.html#l00064">MachineInstr.h:64</a></div></div>
<div class="ttc" id="classllvm_1_1TargetRegisterClass_html"><div class="ttname"><a href="classllvm_1_1TargetRegisterClass.html">llvm::TargetRegisterClass</a></div><div class="ttdef"><b>Definition:</b> <a href="TargetRegisterInfo_8h_source.html#l00036">TargetRegisterInfo.h:36</a></div></div>
<div class="ttc" id="classllvm_1_1MachineFrameInfo_html"><div class="ttname"><a href="classllvm_1_1MachineFrameInfo.html">llvm::MachineFrameInfo</a></div><div class="ttdoc">Abstract Stack Frame Information. </div><div class="ttdef"><b>Definition:</b> <a href="MachineFrameInfo_8h_source.html#l00080">MachineFrameInfo.h:80</a></div></div>
<div class="ttc" id="X86FrameLowering_8cpp_html_aa371140d370a73e4d67cf70697b459a3"><div class="ttname"><a href="X86FrameLowering_8cpp.html#aa371140d370a73e4d67cf70697b459a3">mergeSPUpdatesUp</a></div><div class="ttdeci">static void mergeSPUpdatesUp(MachineBasicBlock &amp;MBB, MachineBasicBlock::iterator &amp;MBBI, unsigned StackPtr, uint64_t *NumBytes=NULL)</div><div class="ttdoc">mergeSPUpdatesUp - Merge two stack-manipulating instructions upper iterator. </div><div class="ttdef"><b>Definition:</b> <a href="X86FrameLowering_8cpp_source.html#l00204">X86FrameLowering.cpp:204</a></div></div>
<div class="ttc" id="classllvm_1_1MachineFrameInfo_html_a48b4b361d757d1ab48f783b8875712c1"><div class="ttname"><a href="classllvm_1_1MachineFrameInfo.html#a48b4b361d757d1ab48f783b8875712c1">llvm::MachineFrameInfo::isFrameAddressTaken</a></div><div class="ttdeci">bool isFrameAddressTaken() const </div><div class="ttdef"><b>Definition:</b> <a href="MachineFrameInfo_8h_source.html#l00270">MachineFrameInfo.h:270</a></div></div>
<div class="ttc" id="X86FrameLowering_8cpp_html_ad6f5455eb7ba6ed74cab551099d0a952"><div class="ttname"><a href="X86FrameLowering_8cpp.html#ad6f5455eb7ba6ed74cab551099d0a952">kSplitStackAvailable</a></div><div class="ttdeci">static const uint64_t kSplitStackAvailable</div><div class="ttdef"><b>Definition:</b> <a href="X86FrameLowering_8cpp_source.html#l01147">X86FrameLowering.cpp:1147</a></div></div>
<div class="ttc" id="classllvm_1_1MachineModuleInfo_html_af1cb1572271c30b402591e2b3d832ca6"><div class="ttname"><a href="classllvm_1_1MachineModuleInfo.html#af1cb1572271c30b402591e2b3d832ca6">llvm::MachineModuleInfo::hasDebugInfo</a></div><div class="ttdeci">bool hasDebugInfo() const </div><div class="ttdef"><b>Definition:</b> <a href="MachineModuleInfo_8h_source.html#l00217">MachineModuleInfo.h:217</a></div></div>
<div class="ttc" id="classllvm_1_1X86RegisterInfo_html_acfd0722e4669be2f7e16059679406d9f"><div class="ttname"><a href="classllvm_1_1X86RegisterInfo.html#acfd0722e4669be2f7e16059679406d9f">llvm::X86RegisterInfo::needsStackRealignment</a></div><div class="ttdeci">bool needsStackRealignment(const MachineFunction &amp;MF) const </div><div class="ttdef"><b>Definition:</b> <a href="X86RegisterInfo_8cpp_source.html#l00439">X86RegisterInfo.cpp:439</a></div></div>
<div class="ttc" id="classllvm_1_1MCRegAliasIterator_html_abf2eadac3ea84e2e2739444c40421eac"><div class="ttname"><a href="classllvm_1_1MCRegAliasIterator.html#abf2eadac3ea84e2e2739444c40421eac">llvm::MCRegAliasIterator::isValid</a></div><div class="ttdeci">bool isValid() const </div><div class="ttdef"><b>Definition:</b> <a href="MCRegisterInfo_8h_source.html#l00580">MCRegisterInfo.h:580</a></div></div>
<div class="ttc" id="classllvm_1_1TargetRegisterInfo_html_a2a4c228322f39803f16b2f49d18b0efe"><div class="ttname"><a href="classllvm_1_1TargetRegisterInfo.html#a2a4c228322f39803f16b2f49d18b0efe">llvm::TargetRegisterInfo::getFrameRegister</a></div><div class="ttdeci">virtual unsigned getFrameRegister(const MachineFunction &amp;MF) const =0</div><div class="ttdoc">Debug information queries. </div></div>
<div class="ttc" id="namespacellvm_1_1CallingConv_html_a4f861731fc6dbfdccc05af5968d98974"><div class="ttname"><a href="namespacellvm_1_1CallingConv.html#a4f861731fc6dbfdccc05af5968d98974">llvm::CallingConv::ID</a></div><div class="ttdeci">ID</div><div class="ttdoc">LLVM Calling Convention Representation. </div><div class="ttdef"><b>Definition:</b> <a href="CallingConv_8h_source.html#l00026">CallingConv.h:26</a></div></div>
<div class="ttc" id="classllvm_1_1MachineInstrBuilder_html_a9f1fae6a5dbb6e378ca85df1fded8515"><div class="ttname"><a href="classllvm_1_1MachineInstrBuilder.html#a9f1fae6a5dbb6e378ca85df1fded8515">llvm::MachineInstrBuilder::addImm</a></div><div class="ttdeci">const MachineInstrBuilder &amp; addImm(int64_t Val) const </div><div class="ttdef"><b>Definition:</b> <a href="MachineInstrBuilder_8h_source.html#l00083">MachineInstrBuilder.h:83</a></div></div>
<div class="ttc" id="README-SSE_8txt_html_aafb0a6c62a7cfe1538db1d20d759a34b"><div class="ttname"><a href="README-SSE_8txt.html#aafb0a6c62a7cfe1538db1d20d759a34b">EDX</a></div><div class="ttdeci">We currently esp xorpd xmm0 xmm0 xmm1 xmm2 xmm1 jb LBB_X_2 xmm2 esp esp ret Lower memcpy memset to a series of SSE bit move instructions when it s feasible Still ok After register LLVM ADD32rm EDX</div><div class="ttdef"><b>Definition:</b> <a href="README-SSE_8txt_source.html#l00132">README-SSE.txt:132</a></div></div>
<div class="ttc" id="X86TargetMachine_8h_html"><div class="ttname"><a href="X86TargetMachine_8h.html">X86TargetMachine.h</a></div></div>
<div class="ttc" id="classllvm_1_1MachineOperand_html_a58048141ed81d581f3fb9a797f3186ee"><div class="ttname"><a href="classllvm_1_1MachineOperand.html#a58048141ed81d581f3fb9a797f3186ee">llvm::MachineOperand::isGlobal</a></div><div class="ttdeci">bool isGlobal() const </div><div class="ttdoc">isGlobal - Tests if this is a MO_GlobalAddress operand. </div><div class="ttdef"><b>Definition:</b> <a href="MachineOperand_8h_source.html#l00242">MachineOperand.h:242</a></div></div>
<div class="ttc" id="classllvm_1_1MachineFunction_html_af562445435f18637f07676da054ba02c"><div class="ttname"><a href="classllvm_1_1MachineFunction.html#af562445435f18637f07676da054ba02c">llvm::MachineFunction::front</a></div><div class="ttdeci">const MachineBasicBlock &amp; front() const </div><div class="ttdef"><b>Definition:</b> <a href="MachineFunction_8h_source.html#l00327">MachineFunction.h:327</a></div></div>
<div class="ttc" id="classllvm_1_1MachineFrameInfo_html_aefab860460ca482a381a508d36cd9f01"><div class="ttname"><a href="classllvm_1_1MachineFrameInfo.html#aefab860460ca482a381a508d36cd9f01">llvm::MachineFrameInfo::getObjectIndexBegin</a></div><div class="ttdeci">int getObjectIndexBegin() const </div><div class="ttdef"><b>Definition:</b> <a href="MachineFrameInfo_8h_source.html#l00281">MachineFrameInfo.h:281</a></div></div>
<div class="ttc" id="classllvm_1_1MachineRegisterInfo_html_a5e4b09e8d0f31b43fd5a912ed288bccb"><div class="ttname"><a href="classllvm_1_1MachineRegisterInfo.html#a5e4b09e8d0f31b43fd5a912ed288bccb">llvm::MachineRegisterInfo::isLiveIn</a></div><div class="ttdeci">bool isLiveIn(unsigned Reg) const </div><div class="ttdef"><b>Definition:</b> <a href="MachineRegisterInfo_8cpp_source.html#l00343">MachineRegisterInfo.cpp:343</a></div></div>
<div class="ttc" id="MachineInstrBuilder_8h_html"><div class="ttname"><a href="MachineInstrBuilder_8h.html">MachineInstrBuilder.h</a></div></div>
<div class="ttc" id="classllvm_1_1X86Subtarget_html_a5314399c907d77b514ec837e8527a9de"><div class="ttname"><a href="classllvm_1_1X86Subtarget.html#a5314399c907d77b514ec837e8527a9de">llvm::X86Subtarget::is64Bit</a></div><div class="ttdeci">bool is64Bit() const </div><div class="ttdoc">Is this x86_64? (disregarding specific ABI / programming model) </div><div class="ttdef"><b>Definition:</b> <a href="X86Subtarget_8h_source.html#l00240">X86Subtarget.h:240</a></div></div>
<div class="ttc" id="X86FrameLowering_8cpp_html_a9a6b9534fac20f1dbf973afc5caabc3f"><div class="ttname"><a href="X86FrameLowering_8cpp.html#a9a6b9534fac20f1dbf973afc5caabc3f">mergeSPUpdates</a></div><div class="ttdeci">static int mergeSPUpdates(MachineBasicBlock &amp;MBB, MachineBasicBlock::iterator &amp;MBBI, unsigned StackPtr, bool doMergeWithPrevious)</div><div class="ttdef"><b>Definition:</b> <a href="X86FrameLowering_8cpp_source.html#l00261">X86FrameLowering.cpp:261</a></div></div>
<div class="ttc" id="classllvm_1_1MachineBasicBlock_html_a4c711446100d52415f8e142855c223e1"><div class="ttname"><a href="classllvm_1_1MachineBasicBlock.html#a4c711446100d52415f8e142855c223e1">llvm::MachineBasicBlock::getLastNonDebugInstr</a></div><div class="ttdeci">iterator getLastNonDebugInstr()</div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8cpp_source.html#l00200">MachineBasicBlock.cpp:200</a></div></div>
<div class="ttc" id="X86FrameLowering_8cpp_html_a6cc74ec571caa907bb2dfcd0d068297a"><div class="ttname"><a href="X86FrameLowering_8cpp.html#a6cc74ec571caa907bb2dfcd0d068297a">mergeSPUpdatesDown</a></div><div class="ttdeci">static void mergeSPUpdatesDown(MachineBasicBlock &amp;MBB, MachineBasicBlock::iterator &amp;MBBI, unsigned StackPtr, uint64_t *NumBytes=NULL)</div><div class="ttdoc">mergeSPUpdatesDown - Merge two stack-manipulating instructions lower iterator. </div><div class="ttdef"><b>Definition:</b> <a href="X86FrameLowering_8cpp_source.html#l00228">X86FrameLowering.cpp:228</a></div></div>
<div class="ttc" id="classllvm_1_1SmallSet_html_a8d8348060ccdeeba13fb8bc651dfbf82"><div class="ttname"><a href="classllvm_1_1SmallSet.html#a8d8348060ccdeeba13fb8bc651dfbf82">llvm::SmallSet::insert</a></div><div class="ttdeci">bool insert(const T &amp;V)</div><div class="ttdef"><b>Definition:</b> <a href="SmallSet_8h_source.html#l00059">SmallSet.h:59</a></div></div>
<div class="ttc" id="classllvm_1_1MachineOperand_html_a7059d68a29d5ecfb37623ab45cdb4e8d"><div class="ttname"><a href="classllvm_1_1MachineOperand.html#a7059d68a29d5ecfb37623ab45cdb4e8d">llvm::MachineOperand::getImm</a></div><div class="ttdeci">int64_t getImm() const </div><div class="ttdef"><b>Definition:</b> <a href="MachineOperand_8h_source.html#l00402">MachineOperand.h:402</a></div></div>
<div class="ttc" id="classllvm_1_1X86FrameLowering_html_aa6faf9ffe7fe199720c422a2e2b66f21"><div class="ttname"><a href="classllvm_1_1X86FrameLowering.html#aa6faf9ffe7fe199720c422a2e2b66f21">llvm::X86FrameLowering::adjustForHiPEPrologue</a></div><div class="ttdeci">void adjustForHiPEPrologue(MachineFunction &amp;MF) const </div><div class="ttdef"><b>Definition:</b> <a href="X86FrameLowering_8cpp_source.html#l01352">X86FrameLowering.cpp:1352</a></div></div>
<div class="ttc" id="namespacellvm_html_aa3a1f79eb5e89f41ad5a3d8e9b2a367a"><div class="ttname"><a href="namespacellvm.html#aa3a1f79eb5e89f41ad5a3d8e9b2a367a">llvm::getUndefRegState</a></div><div class="ttdeci">unsigned getUndefRegState(bool B)</div><div class="ttdef"><b>Definition:</b> <a href="MachineInstrBuilder_8h_source.html#l00395">MachineInstrBuilder.h:395</a></div></div>
<div class="ttc" id="namespacellvm_1_1X86II_html_a97dc14052814702ba0e2b14fb14dd02dacdc4d0fa74813b50797e25bab4febe70"><div class="ttname"><a href="namespacellvm_1_1X86II.html#a97dc14052814702ba0e2b14fb14dd02dacdc4d0fa74813b50797e25bab4febe70">llvm::X86II::GS</a></div><div class="ttdef"><b>Definition:</b> <a href="X86BaseInfo_8h_source.html#l00427">X86BaseInfo.h:427</a></div></div>
<div class="ttc" id="classllvm_1_1MCRegisterInfo_html"><div class="ttname"><a href="classllvm_1_1MCRegisterInfo.html">llvm::MCRegisterInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="MCRegisterInfo_8h_source.html#l00135">MCRegisterInfo.h:135</a></div></div>
<div class="ttc" id="classllvm_1_1TargetInstrInfo_html"><div class="ttname"><a href="classllvm_1_1TargetInstrInfo.html">llvm::TargetInstrInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="TargetInstrInfo_8h_source.html#l00047">TargetInstrInfo.h:47</a></div></div>
<div class="ttc" id="README-SSE_8txt_html_a64d666eb92eff8eb2810814d040a21c1"><div class="ttname"><a href="README-SSE_8txt.html#a64d666eb92eff8eb2810814d040a21c1">EDI</a></div><div class="ttdeci">We currently esp xorpd xmm0 xmm0 xmm1 xmm2 xmm1 jb LBB_X_2 xmm2 esp esp ret Lower memcpy memset to a series of SSE bit move instructions when it s feasible Still ok After register LLVM ADD32rm IMUL32rr EDX ESI EDI</div><div class="ttdef"><b>Definition:</b> <a href="README-SSE_8txt_source.html#l00211">README-SSE.txt:211</a></div></div>
<div class="ttc" id="classllvm_1_1X86FrameLowering_html_ace7b01376d98658e0007a19f9ae4b4c7"><div class="ttname"><a href="classllvm_1_1X86FrameLowering.html#ace7b01376d98658e0007a19f9ae4b4c7">llvm::X86FrameLowering::restoreCalleeSavedRegisters</a></div><div class="ttdeci">bool restoreCalleeSavedRegisters(MachineBasicBlock &amp;MBB, MachineBasicBlock::iterator MI, const std::vector&lt; CalleeSavedInfo &gt; &amp;CSI, const TargetRegisterInfo *TRI) const </div><div class="ttdef"><b>Definition:</b> <a href="X86FrameLowering_8cpp_source.html#l01017">X86FrameLowering.cpp:1017</a></div></div>
<div class="ttc" id="namespacellvm_html_aa5e4d7acf58e87826a15b94d37144f2b"><div class="ttname"><a href="namespacellvm.html#aa5e4d7acf58e87826a15b94d37144f2b">llvm::getDefRegState</a></div><div class="ttdeci">unsigned getDefRegState(bool B)</div><div class="ttdef"><b>Definition:</b> <a href="MachineInstrBuilder_8h_source.html#l00383">MachineInstrBuilder.h:383</a></div></div>
<div class="ttc" id="classllvm_1_1MachineBasicBlock_html_ac51be7ff80fe8d6ae5e8c0acb194908a"><div class="ttname"><a href="classllvm_1_1MachineBasicBlock.html#ac51be7ff80fe8d6ae5e8c0acb194908a">llvm::MachineBasicBlock::iterator</a></div><div class="ttdeci">bundle_iterator&lt; MachineInstr, instr_iterator &gt; iterator</div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8h_source.html#l00212">MachineBasicBlock.h:212</a></div></div>
<div class="ttc" id="classllvm_1_1X86TargetMachine_html_a350524cf8e1e0e53a6d856188d851ec4"><div class="ttname"><a href="classllvm_1_1X86TargetMachine.html#a350524cf8e1e0e53a6d856188d851ec4">llvm::X86TargetMachine::getRegisterInfo</a></div><div class="ttdeci">virtual const X86RegisterInfo * getRegisterInfo() const </div><div class="ttdef"><b>Definition:</b> <a href="X86TargetMachine_8h_source.html#l00060">X86TargetMachine.h:60</a></div></div>
<div class="ttc" id="namespacellvm_html_affbfd713b02cc594a29424c8f41b2815"><div class="ttname"><a href="namespacellvm.html#affbfd713b02cc594a29424c8f41b2815">llvm::emitSPUpdate</a></div><div class="ttdeci">void emitSPUpdate(MachineBasicBlock &amp;MBB, MachineBasicBlock::iterator MI, DebugLoc dl, const TargetInstrInfo &amp;TII, unsigned ScratchReg, int64_t NumBytes, MachineInstr::MIFlag MIFlags=MachineInstr::NoFlags)</div><div class="ttdef"><b>Definition:</b> <a href="AArch64InstrInfo_8cpp_source.html#l00716">AArch64InstrInfo.cpp:716</a></div></div>
<div class="ttc" id="CommandLine_8h_html"><div class="ttname"><a href="CommandLine_8h.html">CommandLine.h</a></div></div>
<div class="ttc" id="classllvm_1_1X86FrameLowering_html_abb7c06be7ec779f3ffacfcad59172496"><div class="ttname"><a href="classllvm_1_1X86FrameLowering.html#abb7c06be7ec779f3ffacfcad59172496">llvm::X86FrameLowering::adjustForSegmentedStacks</a></div><div class="ttdeci">void adjustForSegmentedStacks(MachineFunction &amp;MF) const </div><div class="ttdef"><b>Definition:</b> <a href="X86FrameLowering_8cpp_source.html#l01150">X86FrameLowering.cpp:1150</a></div></div>
<div class="ttc" id="classllvm_1_1MachineOperand_html_a91aa25eac8330cdbab5f7f12fb29359d"><div class="ttname"><a href="classllvm_1_1MachineOperand.html#a91aa25eac8330cdbab5f7f12fb29359d">llvm::MachineOperand::getTargetFlags</a></div><div class="ttdeci">unsigned getTargetFlags() const </div><div class="ttdef"><b>Definition:</b> <a href="MachineOperand_8h_source.html#l00187">MachineOperand.h:187</a></div></div>
<div class="ttc" id="classllvm_1_1MachineFunction_html_ab2a56feb4fe943ae2362d61f3a43acca"><div class="ttname"><a href="classllvm_1_1MachineFunction.html#ab2a56feb4fe943ae2362d61f3a43acca">llvm::MachineFunction::CreateMachineBasicBlock</a></div><div class="ttdeci">MachineBasicBlock * CreateMachineBasicBlock(const BasicBlock *bb=0)</div><div class="ttdef"><b>Definition:</b> <a href="MachineFunction_8cpp_source.html#l00209">MachineFunction.cpp:209</a></div></div>
<div class="ttc" id="classllvm_1_1TargetRegisterInfo_html_adf8e30b3e759b1283c5fbda668190ee6"><div class="ttname"><a href="classllvm_1_1TargetRegisterInfo.html#adf8e30b3e759b1283c5fbda668190ee6">llvm::TargetRegisterInfo::needsStackRealignment</a></div><div class="ttdeci">virtual bool needsStackRealignment(const MachineFunction &amp;MF) const </div><div class="ttdef"><b>Definition:</b> <a href="TargetRegisterInfo_8h_source.html#l00721">TargetRegisterInfo.h:721</a></div></div>
<div class="ttc" id="README-X86-64_8txt_html_a9de23273550c17a1957b1b325a01960e"><div class="ttname"><a href="README-X86-64_8txt.html#a9de23273550c17a1957b1b325a01960e">AH</a></div><div class="ttdeci">AMD64 Optimization Manual has some nice information about optimizing integer multiplication by a constant How much of it applies to Intel s X86 implementation There are definite trade offs to xmm0 cvttss2siq rdx jb L3 subss xmm0 rax cvttss2siq rdx xorq rdx rax ret instead of xmm1 cvttss2siq rcx movaps xmm2 subss xmm2 cvttss2siq rax rdx xorq rax ucomiss xmm0 cmovb rax ret Seems like the jb branch has high likelihood of being taken It would have saved a few instructions It s not possible to reference AH</div><div class="ttdef"><b>Definition:</b> <a href="README-X86-64_8txt_source.html#l00018">README-X86-64.txt:18</a></div></div>
<div class="ttc" id="classllvm_1_1MCCFIInstruction_html_a9babd4ee8fb9fc9bb25eeac8274625d1"><div class="ttname"><a href="classllvm_1_1MCCFIInstruction.html#a9babd4ee8fb9fc9bb25eeac8274625d1">llvm::MCCFIInstruction::createDefCfaRegister</a></div><div class="ttdeci">static MCCFIInstruction createDefCfaRegister(MCSymbol *L, unsigned Register)</div><div class="ttdoc">.cfi_def_cfa_register modifies a rule for computing CFA. From now on Register will be used instead of...</div><div class="ttdef"><b>Definition:</b> <a href="MCDwarf_8h_source.html#l00328">MCDwarf.h:328</a></div></div>
<div class="ttc" id="X86InstrInfo_8h_html"><div class="ttname"><a href="X86InstrInfo_8h.html">X86InstrInfo.h</a></div></div>
<div class="ttc" id="classllvm_1_1MachineFrameInfo_html_ae4d51e9e70d6a7fb366f2a09d10a0945"><div class="ttname"><a href="classllvm_1_1MachineFrameInfo.html#ae4d51e9e70d6a7fb366f2a09d10a0945">llvm::MachineFrameInfo::setStackSize</a></div><div class="ttdeci">void setStackSize(uint64_t Size)</div><div class="ttdef"><b>Definition:</b> <a href="MachineFrameInfo_8h_source.html#l00421">MachineFrameInfo.h:421</a></div></div>
<div class="ttc" id="classllvm_1_1X86Subtarget_html_a9efe6935f37edac03b15a66b138dec8c"><div class="ttname"><a href="classllvm_1_1X86Subtarget.html#a9efe6935f37edac03b15a66b138dec8c">llvm::X86Subtarget::useLeaForSP</a></div><div class="ttdeci">bool useLeaForSP() const </div><div class="ttdef"><b>Definition:</b> <a href="X86Subtarget_8h_source.html#l00298">X86Subtarget.h:298</a></div></div>
<div class="ttc" id="classllvm_1_1MachineBasicBlock_html_aa314325c7062fd067a3c0b9339aa8ea6"><div class="ttname"><a href="classllvm_1_1MachineBasicBlock.html#aa314325c7062fd067a3c0b9339aa8ea6">llvm::MachineBasicBlock::livein_end</a></div><div class="ttdeci">livein_iterator livein_end() const </div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8h_source.html#l00316">MachineBasicBlock.h:316</a></div></div>
<div class="ttc" id="classllvm_1_1SmallSet_html"><div class="ttname"><a href="classllvm_1_1SmallSet.html">llvm::SmallSet</a></div><div class="ttdef"><b>Definition:</b> <a href="SmallSet_8h_source.html#l00031">SmallSet.h:31</a></div></div>
<div class="ttc" id="classllvm_1_1MachineInstr_html_a302e45878c6dc1714334c7ce96d56846"><div class="ttname"><a href="classllvm_1_1MachineInstr.html#a302e45878c6dc1714334c7ce96d56846">llvm::MachineInstr::getOperand</a></div><div class="ttdeci">const MachineOperand &amp; getOperand(unsigned i) const </div><div class="ttdef"><b>Definition:</b> <a href="MachineInstr_8h_source.html#l00267">MachineInstr.h:267</a></div></div>
<div class="ttc" id="classllvm_1_1X86Subtarget_html_a18fbbad2cb443b3e451099aab08976eb"><div class="ttname"><a href="classllvm_1_1X86Subtarget.html#a18fbbad2cb443b3e451099aab08976eb">llvm::X86Subtarget::isTargetWin32</a></div><div class="ttdeci">bool isTargetWin32() const </div><div class="ttdef"><b>Definition:</b> <a href="X86Subtarget_8h_source.html#l00342">X86Subtarget.h:342</a></div></div>
<div class="ttc" id="classllvm_1_1TargetInstrInfo_html_a1f16d509bf2e2c2d0e0176f04c253a96"><div class="ttname"><a href="classllvm_1_1TargetInstrInfo.html#a1f16d509bf2e2c2d0e0176f04c253a96">llvm::TargetInstrInfo::loadRegFromStackSlot</a></div><div class="ttdeci">virtual void loadRegFromStackSlot(MachineBasicBlock &amp;MBB, MachineBasicBlock::iterator MI, unsigned DestReg, int FrameIndex, const TargetRegisterClass *RC, const TargetRegisterInfo *TRI) const </div><div class="ttdef"><b>Definition:</b> <a href="TargetInstrInfo_8h_source.html#l00514">TargetInstrInfo.h:514</a></div></div>
<div class="ttc" id="classllvm_1_1MachineBasicBlock_html"><div class="ttname"><a href="classllvm_1_1MachineBasicBlock.html">llvm::MachineBasicBlock</a></div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8h_source.html#l00062">MachineBasicBlock.h:62</a></div></div>
<div class="ttc" id="classllvm_1_1MachineInstr_html_aba86b0738c2ab2a52688b846c45bfe59"><div class="ttname"><a href="classllvm_1_1MachineInstr.html#aba86b0738c2ab2a52688b846c45bfe59">llvm::MachineInstr::setFlag</a></div><div class="ttdeci">void setFlag(MIFlag Flag)</div><div class="ttdoc">setFlag - Set a MI flag. </div><div class="ttdef"><b>Definition:</b> <a href="MachineInstr_8h_source.html#l00159">MachineInstr.h:159</a></div></div>
<div class="ttc" id="classllvm_1_1MCRegAliasIterator_html"><div class="ttname"><a href="classllvm_1_1MCRegAliasIterator.html">llvm::MCRegAliasIterator</a></div><div class="ttdef"><b>Definition:</b> <a href="MCRegisterInfo_8h_source.html#l00555">MCRegisterInfo.h:555</a></div></div>
<div class="ttc" id="namespacellvm_html_afad63f3314b8553ee3c26d020b3ce09e"><div class="ttname"><a href="namespacellvm.html#afad63f3314b8553ee3c26d020b3ce09e">llvm::addRegOffset</a></div><div class="ttdeci">static const MachineInstrBuilder &amp; addRegOffset(const MachineInstrBuilder &amp;MIB, unsigned Reg, bool isKill, int Offset)</div><div class="ttdef"><b>Definition:</b> <a href="X86InstrBuilder_8h_source.html#l00107">X86InstrBuilder.h:107</a></div></div>
<div class="ttc" id="namespacellvm_html_aa1704159f75e6eacd595962ea6d93ffe"><div class="ttname"><a href="namespacellvm.html#aa1704159f75e6eacd595962ea6d93ffe">llvm::next</a></div><div class="ttdeci">ItTy next(ItTy it, Dist n)</div><div class="ttdef"><b>Definition:</b> <a href="STLExtras_8h_source.html#l00154">STLExtras.h:154</a></div></div>
<div class="ttc" id="classllvm_1_1MachineOperand_html_a312ddf2fd2162ef0c552d913369cd57f"><div class="ttname"><a href="classllvm_1_1MachineOperand.html#a312ddf2fd2162ef0c552d913369cd57f">llvm::MachineOperand::isSymbol</a></div><div class="ttdeci">bool isSymbol() const </div><div class="ttdoc">isSymbol - Tests if this is a MO_ExternalSymbol operand. </div><div class="ttdef"><b>Definition:</b> <a href="MachineOperand_8h_source.html#l00244">MachineOperand.h:244</a></div></div>
<div class="ttc" id="classllvm_1_1MachineFunction_html_ac2dc0fa143c9f2127f0501734577a0a0"><div class="ttname"><a href="classllvm_1_1MachineFunction.html#ac2dc0fa143c9f2127f0501734577a0a0">llvm::MachineFunction::getInfo</a></div><div class="ttdeci">Ty * getInfo()</div><div class="ttdef"><b>Definition:</b> <a href="MachineFunction_8h_source.html#l00236">MachineFunction.h:236</a></div></div>
<div class="ttc" id="classllvm_1_1MachineOperand_html_ae73de4f077ea9862af9611652396202b"><div class="ttname"><a href="classllvm_1_1MachineOperand.html#ae73de4f077ea9862af9611652396202b">llvm::MachineOperand::getOffset</a></div><div class="ttdeci">int64_t getOffset() const </div><div class="ttdef"><b>Definition:</b> <a href="MachineOperand_8h_source.html#l00445">MachineOperand.h:445</a></div></div>
<div class="ttc" id="README-SSE_8txt_html_abd9c765b9afafff59eb14d50c9e9fba1"><div class="ttname"><a href="README-SSE_8txt.html#abd9c765b9afafff59eb14d50c9e9fba1">EAX</a></div><div class="ttdeci">We currently esp xorpd xmm0 xmm0 xmm1 xmm2 xmm1 jb LBB_X_2 xmm2 esp esp ret Lower memcpy memset to a series of SSE bit move instructions when it s feasible Still ok After register LLVM ADD32rm IMUL32rr EDX ESI EAX</div><div class="ttdef"><b>Definition:</b> <a href="README-SSE_8txt_source.html#l00208">README-SSE.txt:208</a></div></div>
<div class="ttc" id="classllvm_1_1Function_html_a8bf193a781a92cae52d7f9216d0824f8"><div class="ttname"><a href="classllvm_1_1Function.html#a8bf193a781a92cae52d7f9216d0824f8">llvm::Function::arg_begin</a></div><div class="ttdeci">arg_iterator arg_begin()</div><div class="ttdef"><b>Definition:</b> <a href="Function_8h_source.html#l00410">Function.h:410</a></div></div>
<div class="ttc" id="namespacellvm_1_1CallingConv_html_a4f861731fc6dbfdccc05af5968d98974afde87569738f9e23963e8735f71c33eb"><div class="ttname"><a href="namespacellvm_1_1CallingConv.html#a4f861731fc6dbfdccc05af5968d98974afde87569738f9e23963e8735f71c33eb">llvm::CallingConv::X86_FastCall</a></div><div class="ttdef"><b>Definition:</b> <a href="CallingConv_8h_source.html#l00074">CallingConv.h:74</a></div></div>
<div class="ttc" id="namespacellvm_1_1N86_html_a154c9f74eba4608c7d1b656eb025a96da667b758702693d9dfb46e55025fc559d"><div class="ttname"><a href="namespacellvm_1_1N86.html#a154c9f74eba4608c7d1b656eb025a96da667b758702693d9dfb46e55025fc559d">llvm::N86::ECX</a></div><div class="ttdef"><b>Definition:</b> <a href="X86MCTargetDesc_8h_source.html#l00047">X86MCTargetDesc.h:47</a></div></div>
<div class="ttc" id="classllvm_1_1X86Subtarget_html_afedf24bb55abe8b8c8d9933b4e01c715"><div class="ttname"><a href="classllvm_1_1X86Subtarget.html#afedf24bb55abe8b8c8d9933b4e01c715">llvm::X86Subtarget::isOSWindows</a></div><div class="ttdeci">bool isOSWindows() const </div><div class="ttdef"><b>Definition:</b> <a href="X86Subtarget_8h_source.html#l00336">X86Subtarget.h:336</a></div></div>
<div class="ttc" id="namespacellvm_html_a980570dc1410d4ef53806f82028ca381"><div class="ttname"><a href="namespacellvm.html#a980570dc1410d4ef53806f82028ca381">llvm::BuildMI</a></div><div class="ttdeci">MachineInstrBuilder BuildMI(MachineFunction &amp;MF, DebugLoc DL, const MCInstrDesc &amp;MCID)</div><div class="ttdef"><b>Definition:</b> <a href="MachineInstrBuilder_8h_source.html#l00223">MachineInstrBuilder.h:223</a></div></div>
<div class="ttc" id="classllvm_1_1TargetInstrInfo_html_a94d273699f7fdbd1a01477c4ca8014dd"><div class="ttname"><a href="classllvm_1_1TargetInstrInfo.html#a94d273699f7fdbd1a01477c4ca8014dd">llvm::TargetInstrInfo::storeRegToStackSlot</a></div><div class="ttdeci">virtual void storeRegToStackSlot(MachineBasicBlock &amp;MBB, MachineBasicBlock::iterator MI, unsigned SrcReg, bool isKill, int FrameIndex, const TargetRegisterClass *RC, const TargetRegisterInfo *TRI) const </div><div class="ttdef"><b>Definition:</b> <a href="TargetInstrInfo_8h_source.html#l00501">TargetInstrInfo.h:501</a></div></div>
<div class="ttc" id="classllvm_1_1TargetMachine_html_a02aa9d4cbd6ffcc70dfe1143ec0995ef"><div class="ttname"><a href="classllvm_1_1TargetMachine.html#a02aa9d4cbd6ffcc70dfe1143ec0995ef">llvm::TargetMachine::getFrameLowering</a></div><div class="ttdeci">virtual const TargetFrameLowering * getFrameLowering() const </div><div class="ttdef"><b>Definition:</b> <a href="Target_2TargetMachine_8h_source.html#l00120">Target/TargetMachine.h:120</a></div></div>
<div class="ttc" id="classllvm_1_1TargetRegisterInfo_html"><div class="ttname"><a href="classllvm_1_1TargetRegisterInfo.html">llvm::TargetRegisterInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="TargetRegisterInfo_8h_source.html#l00219">TargetRegisterInfo.h:219</a></div></div>
<div class="ttc" id="classllvm_1_1X86RegisterInfo_html_aa9f703a288ef91efae26a538d96037d6"><div class="ttname"><a href="classllvm_1_1X86RegisterInfo.html#aa9f703a288ef91efae26a538d96037d6">llvm::X86RegisterInfo::getBaseRegister</a></div><div class="ttdeci">unsigned getBaseRegister() const </div><div class="ttdef"><b>Definition:</b> <a href="X86RegisterInfo_8h_source.html#l00126">X86RegisterInfo.h:126</a></div></div>
<div class="ttc" id="X86Subtarget_8h_html"><div class="ttname"><a href="X86Subtarget_8h.html">X86Subtarget.h</a></div></div>
<div class="ttc" id="classllvm_1_1MCInstrInfo_html_ab16f5a81fccfe4b7f645ba5a74ffad02"><div class="ttname"><a href="classllvm_1_1MCInstrInfo.html#ab16f5a81fccfe4b7f645ba5a74ffad02">llvm::MCInstrInfo::get</a></div><div class="ttdeci">const MCInstrDesc &amp; get(unsigned Opcode) const </div><div class="ttdef"><b>Definition:</b> <a href="MCInstrInfo_8h_source.html#l00048">MCInstrInfo.h:48</a></div></div>
<div class="ttc" id="classllvm_1_1X86FrameLowering_html_a68c7fcd6845964d09de5e8ec1f4577c1"><div class="ttname"><a href="classllvm_1_1X86FrameLowering.html#a68c7fcd6845964d09de5e8ec1f4577c1">llvm::X86FrameLowering::getFrameIndexOffset</a></div><div class="ttdeci">int getFrameIndexOffset(const MachineFunction &amp;MF, int FI) const </div><div class="ttdef"><b>Definition:</b> <a href="X86FrameLowering_8cpp_source.html#l00904">X86FrameLowering.cpp:904</a></div></div>
<div class="ttc" id="classllvm_1_1X86RegisterInfo_html_ac26e69b92e7ee67cfe9766db55b221da"><div class="ttname"><a href="classllvm_1_1X86RegisterInfo.html#ac26e69b92e7ee67cfe9766db55b221da">llvm::X86RegisterInfo::getStackRegister</a></div><div class="ttdeci">unsigned getStackRegister() const </div><div class="ttdef"><b>Definition:</b> <a href="X86RegisterInfo_8h_source.html#l00125">X86RegisterInfo.h:125</a></div></div>
<div class="ttc" id="X86FrameLowering_8cpp_html_a277b1c0324a7229d31f3eeff08311411"><div class="ttname"><a href="X86FrameLowering_8cpp.html#a277b1c0324a7229d31f3eeff08311411">getSUBriOpcode</a></div><div class="ttdeci">static unsigned getSUBriOpcode(unsigned IsLP64, int64_t Imm)</div><div class="ttdef"><b>Definition:</b> <a href="X86FrameLowering_8cpp_source.html#l00058">X86FrameLowering.cpp:58</a></div></div>
<div class="ttc" id="classllvm_1_1MachineFrameInfo_html_aefac52e417d31959e35868879aba672b"><div class="ttname"><a href="classllvm_1_1MachineFrameInfo.html#aefac52e417d31959e35868879aba672b">llvm::MachineFrameInfo::getObjectOffset</a></div><div class="ttdeci">int64_t getObjectOffset(int ObjectIdx) const </div><div class="ttdef"><b>Definition:</b> <a href="MachineFrameInfo_8h_source.html#l00394">MachineFrameInfo.h:394</a></div></div>
<div class="ttc" id="classllvm_1_1MachineModuleInfo_html_adde6ff7fd9afa7c46ccc8b2ac4ebd31a"><div class="ttname"><a href="classllvm_1_1MachineModuleInfo.html#adde6ff7fd9afa7c46ccc8b2ac4ebd31a">llvm::MachineModuleInfo::callsEHReturn</a></div><div class="ttdeci">bool callsEHReturn() const </div><div class="ttdef"><b>Definition:</b> <a href="MachineModuleInfo_8h_source.html#l00220">MachineModuleInfo.h:220</a></div></div>
<div class="ttc" id="X86FrameLowering_8cpp_html_aa7b08d583ef6aae95b4a2c5d46d96d48"><div class="ttname"><a href="X86FrameLowering_8cpp.html#aa7b08d583ef6aae95b4a2c5d46d96d48">getADDriOpcode</a></div><div class="ttdeci">static unsigned getADDriOpcode(unsigned IsLP64, int64_t Imm)</div><div class="ttdef"><b>Definition:</b> <a href="X86FrameLowering_8cpp_source.html#l00070">X86FrameLowering.cpp:70</a></div></div>
<div class="ttc" id="classllvm_1_1MachineBasicBlock_html_a45028d169700cac71cf6c613a94236ee"><div class="ttname"><a href="classllvm_1_1MachineBasicBlock.html#a45028d169700cac71cf6c613a94236ee">llvm::MachineBasicBlock::findDebugLoc</a></div><div class="ttdeci">DebugLoc findDebugLoc(instr_iterator MBBI)</div></div>
<div class="ttc" id="MCSymbol_8h_html"><div class="ttname"><a href="MCSymbol_8h.html">MCSymbol.h</a></div></div>
<div class="ttc" id="namespacellvm_1_1TargetOpcode_html_a348d4259b5fa6a8ecfe94e7ae512e1a8ac4061808eca922630aa39fc5c6f43896"><div class="ttname"><a href="namespacellvm_1_1TargetOpcode.html#a348d4259b5fa6a8ecfe94e7ae512e1a8ac4061808eca922630aa39fc5c6f43896">llvm::TargetOpcode::PROLOG_LABEL</a></div><div class="ttdef"><b>Definition:</b> <a href="TargetOpcodes_8h_source.html#l00028">TargetOpcodes.h:28</a></div></div>
<div class="ttc" id="classllvm_1_1MachineFrameInfo_html_ad104abdabbcb68deacc60c0aea1bca34"><div class="ttname"><a href="classllvm_1_1MachineFrameInfo.html#ad104abdabbcb68deacc60c0aea1bca34">llvm::MachineFrameInfo::hasCalls</a></div><div class="ttdeci">bool hasCalls() const </div><div class="ttdoc">hasCalls - Return true if the current function has any function calls. </div><div class="ttdef"><b>Definition:</b> <a href="MachineFrameInfo_8h_source.html#l00451">MachineFrameInfo.h:451</a></div></div>
<div class="ttc" id="classllvm_1_1TargetMachine_html_ac13d0f6f2c915757013b101ef6e8afbc"><div class="ttname"><a href="classllvm_1_1TargetMachine.html#ac13d0f6f2c915757013b101ef6e8afbc">llvm::TargetMachine::getInstrInfo</a></div><div class="ttdeci">virtual const TargetInstrInfo * getInstrInfo() const </div><div class="ttdef"><b>Definition:</b> <a href="Target_2TargetMachine_8h_source.html#l00119">Target/TargetMachine.h:119</a></div></div>
<div class="ttc" id="classllvm_1_1ilist__iterator_html"><div class="ttname"><a href="classllvm_1_1ilist__iterator.html">llvm::ilist_iterator</a></div><div class="ttdef"><b>Definition:</b> <a href="ilist_8h_source.html#l00050">ilist.h:50</a></div></div>
<div class="ttc" id="TargetOptions_8h_html"><div class="ttname"><a href="TargetOptions_8h.html">TargetOptions.h</a></div></div>
<div class="ttc" id="Target_2README_8txt_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">i</div><div class="ttdef"><b>Definition:</b> <a href="Target_2README_8txt_source.html#l00029">Target/README.txt:29</a></div></div>
<div class="ttc" id="classllvm_1_1MachineModuleInfo_html_a215f3061b9e7ad1b1ffac03cfc580665"><div class="ttname"><a href="classllvm_1_1MachineModuleInfo.html#a215f3061b9e7ad1b1ffac03cfc580665">llvm::MachineModuleInfo::getContext</a></div><div class="ttdeci">const MCContext &amp; getContext() const </div><div class="ttdef"><b>Definition:</b> <a href="MachineModuleInfo_8h_source.html#l00190">MachineModuleInfo.h:190</a></div></div>
<div class="ttc" id="classllvm_1_1X86FrameLowering_html_a649e4f2412bff7a236d44c0c52982640"><div class="ttname"><a href="classllvm_1_1X86FrameLowering.html#a649e4f2412bff7a236d44c0c52982640">llvm::X86FrameLowering::hasFP</a></div><div class="ttdeci">bool hasFP(const MachineFunction &amp;MF) const </div><div class="ttdef"><b>Definition:</b> <a href="X86FrameLowering_8cpp_source.html#l00045">X86FrameLowering.cpp:45</a></div></div>
<div class="ttc" id="classllvm_1_1MachineOperand_html"><div class="ttname"><a href="classllvm_1_1MachineOperand.html">llvm::MachineOperand</a></div><div class="ttdef"><b>Definition:</b> <a href="MachineOperand_8h_source.html#l00043">MachineOperand.h:43</a></div></div>
<div class="ttc" id="classllvm_1_1MachineFrameInfo_html_ae146d6827dae2ff77fc65b7fd319dbb8"><div class="ttname"><a href="classllvm_1_1MachineFrameInfo.html#ae146d6827dae2ff77fc65b7fd319dbb8">llvm::MachineFrameInfo::getObjectAlignment</a></div><div class="ttdeci">unsigned getObjectAlignment(int ObjectIdx) const </div><div class="ttdoc">getObjectAlignment - Return the alignment of the specified stack object. </div><div class="ttdef"><b>Definition:</b> <a href="MachineFrameInfo_8h_source.html#l00361">MachineFrameInfo.h:361</a></div></div>
<div class="ttc" id="classllvm_1_1X86RegisterInfo_html"><div class="ttname"><a href="classllvm_1_1X86RegisterInfo.html">llvm::X86RegisterInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="X86RegisterInfo_8h_source.html#l00027">X86RegisterInfo.h:27</a></div></div>
<div class="ttc" id="X86MachineFunctionInfo_8h_html"><div class="ttname"><a href="X86MachineFunctionInfo_8h.html">X86MachineFunctionInfo.h</a></div></div>
<div class="ttc" id="classllvm_1_1TargetFrameLowering_html_a32f0831ccaa8dbbbf0f779125e6d5dd8"><div class="ttname"><a href="classllvm_1_1TargetFrameLowering.html#a32f0831ccaa8dbbbf0f779125e6d5dd8">llvm::TargetFrameLowering::getOffsetOfLocalArea</a></div><div class="ttdeci">int getOffsetOfLocalArea() const </div><div class="ttdef"><b>Definition:</b> <a href="TargetFrameLowering_8h_source.html#l00089">TargetFrameLowering.h:89</a></div></div>
<div class="ttc" id="classllvm_1_1TargetFrameLowering_html"><div class="ttname"><a href="classllvm_1_1TargetFrameLowering.html">llvm::TargetFrameLowering</a></div><div class="ttdef"><b>Definition:</b> <a href="TargetFrameLowering_8h_source.html#l00033">TargetFrameLowering.h:33</a></div></div>
<div class="ttc" id="classllvm_1_1X86Subtarget_html_a92b94bad0207c5841e67d0ac5bf088ee"><div class="ttname"><a href="classllvm_1_1X86Subtarget.html#a92b94bad0207c5841e67d0ac5bf088ee">llvm::X86Subtarget::isTargetLinux</a></div><div class="ttdeci">bool isTargetLinux() const </div><div class="ttdef"><b>Definition:</b> <a href="X86Subtarget_8h_source.html#l00322">X86Subtarget.h:322</a></div></div>
<div class="ttc" id="classllvm_1_1MachineOperand_html_a8de7d5cf38939044471c6ee60a01a3df"><div class="ttname"><a href="classllvm_1_1MachineOperand.html#a8de7d5cf38939044471c6ee60a01a3df">llvm::MachineOperand::isDef</a></div><div class="ttdeci">bool isDef() const </div><div class="ttdef"><b>Definition:</b> <a href="MachineOperand_8h_source.html#l00274">MachineOperand.h:274</a></div></div>
<div class="ttc" id="classllvm_1_1Function_html_a13935e45a4c19ec182a32e504b25ba15"><div class="ttname"><a href="classllvm_1_1Function.html#a13935e45a4c19ec182a32e504b25ba15">llvm::Function::needsUnwindTableEntry</a></div><div class="ttdeci">bool needsUnwindTableEntry() const </div><div class="ttdoc">True if this function needs an unwind table. </div><div class="ttdef"><b>Definition:</b> <a href="Function_8h_source.html#l00293">Function.h:293</a></div></div>
<div class="ttc" id="classllvm_1_1MachineRegisterInfo_html_adb8e83c4e03a80fa7d24357b522e25ff"><div class="ttname"><a href="classllvm_1_1MachineRegisterInfo.html#adb8e83c4e03a80fa7d24357b522e25ff">llvm::MachineRegisterInfo::livein_begin</a></div><div class="ttdeci">livein_iterator livein_begin() const </div><div class="ttdef"><b>Definition:</b> <a href="MachineRegisterInfo_8h_source.html#l00529">MachineRegisterInfo.h:529</a></div></div>
<div class="ttc" id="classllvm_1_1MachineFrameInfo_html_a87a1fe769ec763a9c8f8427a017a45d7"><div class="ttname"><a href="classllvm_1_1MachineFrameInfo.html#a87a1fe769ec763a9c8f8427a017a45d7">llvm::MachineFrameInfo::setOffsetAdjustment</a></div><div class="ttdeci">void setOffsetAdjustment(int Adj)</div><div class="ttdef"><b>Definition:</b> <a href="MachineFrameInfo_8h_source.html#l00432">MachineFrameInfo.h:432</a></div></div>
<div class="ttc" id="classllvm_1_1MachineFunction_html_a4ad4295a88187ea1ae12ecfcfa18a70f"><div class="ttname"><a href="classllvm_1_1MachineFunction.html#a4ad4295a88187ea1ae12ecfcfa18a70f">llvm::MachineFunction::getFrameInfo</a></div><div class="ttdeci">MachineFrameInfo * getFrameInfo()</div><div class="ttdef"><b>Definition:</b> <a href="MachineFunction_8h_source.html#l00174">MachineFunction.h:174</a></div></div>
<div class="ttc" id="classllvm_1_1Function_html_a72873ed64b7be01507a2248b8e756ec8"><div class="ttname"><a href="classllvm_1_1Function.html#a72873ed64b7be01507a2248b8e756ec8">llvm::Function::getAttributes</a></div><div class="ttdeci">AttributeSet getAttributes() const </div><div class="ttdoc">Return the attribute list for this Function. </div><div class="ttdef"><b>Definition:</b> <a href="Function_8h_source.html#l00170">Function.h:170</a></div></div>
<div class="ttc" id="X86FrameLowering_8cpp_html_a38ade45dd7bb38c669a112f7079f9395"><div class="ttname"><a href="X86FrameLowering_8cpp.html#a38ade45dd7bb38c669a112f7079f9395">GetScratchRegister</a></div><div class="ttdeci">static unsigned GetScratchRegister(bool Is64Bit, const MachineFunction &amp;MF, bool Primary)</div><div class="ttdef"><b>Definition:</b> <a href="X86FrameLowering_8cpp_source.html#l01117">X86FrameLowering.cpp:1117</a></div></div>
<div class="ttc" id="Function_8h_html"><div class="ttname"><a href="Function_8h.html">Function.h</a></div></div>
<div class="ttc" id="classllvm_1_1MachineInstrBuilder_html_aec72fc7a6cc79a1ef53e5d5dbccb846c"><div class="ttname"><a href="classllvm_1_1MachineInstrBuilder.html#aec72fc7a6cc79a1ef53e5d5dbccb846c">llvm::MachineInstrBuilder::addGlobalAddress</a></div><div class="ttdeci">const MachineInstrBuilder &amp; addGlobalAddress(const GlobalValue *GV, int64_t Offset=0, unsigned char TargetFlags=0) const </div><div class="ttdef"><b>Definition:</b> <a href="MachineInstrBuilder_8h_source.html#l00129">MachineInstrBuilder.h:129</a></div></div>
<div class="ttc" id="namespacellvm_1_1N86_html_a154c9f74eba4608c7d1b656eb025a96da85b6ab9236a61c8ddb3dd0928a8795c6"><div class="ttname"><a href="namespacellvm_1_1N86.html#a154c9f74eba4608c7d1b656eb025a96da85b6ab9236a61c8ddb3dd0928a8795c6">llvm::N86::EBP</a></div><div class="ttdef"><b>Definition:</b> <a href="X86MCTargetDesc_8h_source.html#l00047">X86MCTargetDesc.h:47</a></div></div>
<div class="ttc" id="classllvm_1_1MachineRegisterInfo_html"><div class="ttname"><a href="classllvm_1_1MachineRegisterInfo.html">llvm::MachineRegisterInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="MachineRegisterInfo_8h_source.html#l00030">MachineRegisterInfo.h:30</a></div></div>
<div class="ttc" id="classllvm_1_1MCContext_html_a3fe9c108e3bf910d8d501b4e45b8cdfc"><div class="ttname"><a href="classllvm_1_1MCContext.html#a3fe9c108e3bf910d8d501b4e45b8cdfc">llvm::MCContext::getRegisterInfo</a></div><div class="ttdeci">const MCRegisterInfo * getRegisterInfo() const </div><div class="ttdef"><b>Definition:</b> <a href="MCContext_8h_source.html#l00177">MCContext.h:177</a></div></div>
<div class="ttc" id="classllvm_1_1SmallSet_html_ab28aa342862f6d16361be514fd98c22e"><div class="ttname"><a href="classllvm_1_1SmallSet.html#ab28aa342862f6d16361be514fd98c22e">llvm::SmallSet::count</a></div><div class="ttdeci">bool count(const T &amp;V) const </div><div class="ttdoc">count - Return true if the element is in the set. </div><div class="ttdef"><b>Definition:</b> <a href="SmallSet_8h_source.html#l00048">SmallSet.h:48</a></div></div>
<div class="ttc" id="classllvm_1_1X86TargetMachine_html_a0f9e3271ccf39f4fdf00eb246e6ef5b3"><div class="ttname"><a href="classllvm_1_1X86TargetMachine.html#a0f9e3271ccf39f4fdf00eb246e6ef5b3">llvm::X86TargetMachine::getFrameLowering</a></div><div class="ttdeci">virtual const TargetFrameLowering * getFrameLowering() const </div><div class="ttdef"><b>Definition:</b> <a href="X86TargetMachine_8h_source.html#l00047">X86TargetMachine.h:47</a></div></div>
<div class="ttc" id="classllvm_1_1Attribute_html_aab7ee4b8fd1d3e7e4cea87868855e60ea62ad0d9b548303cf2fc7544275e2191e"><div class="ttname"><a href="classllvm_1_1Attribute.html#aab7ee4b8fd1d3e7e4cea87868855e60ea62ad0d9b548303cf2fc7544275e2191e">llvm::Attribute::NoRedZone</a></div><div class="ttdoc">Disable redzone. </div><div class="ttdef"><b>Definition:</b> <a href="Attributes_8h_source.html#l00088">Attributes.h:88</a></div></div>
<div class="ttc" id="MachineRegisterInfo_8h_html"><div class="ttname"><a href="MachineRegisterInfo_8h.html">MachineRegisterInfo.h</a></div></div>
<div class="ttc" id="classllvm_1_1MachineInstr_html"><div class="ttname"><a href="classllvm_1_1MachineInstr.html">llvm::MachineInstr</a></div><div class="ttdef"><b>Definition:</b> <a href="MachineInstr_8h_source.html#l00050">MachineInstr.h:50</a></div></div>
<div class="ttc" id="MachineModuleInfo_8h_html"><div class="ttname"><a href="MachineModuleInfo_8h.html">MachineModuleInfo.h</a></div></div>
<div class="ttc" id="classllvm_1_1cl_1_1opt_html"><div class="ttname"><a href="classllvm_1_1cl_1_1opt.html">llvm::cl::opt</a></div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l01149">CommandLine.h:1149</a></div></div>
<div class="ttc" id="classllvm_1_1StringRef_html_a7414af479a1a88b0631120a4fc681e20"><div class="ttname"><a href="classllvm_1_1StringRef.html#a7414af479a1a88b0631120a4fc681e20">llvm::StringRef::npos</a></div><div class="ttdeci">static const size_t npos</div><div class="ttdef"><b>Definition:</b> <a href="StringRef_8h_source.html#l00045">StringRef.h:45</a></div></div>
<div class="ttc" id="classllvm_1_1MachineFunction_html_ab4a6ca428289b667dd691a00e9f7e334"><div class="ttname"><a href="classllvm_1_1MachineFunction.html#ab4a6ca428289b667dd691a00e9f7e334">llvm::MachineFunction::getRegInfo</a></div><div class="ttdeci">MachineRegisterInfo &amp; getRegInfo()</div><div class="ttdef"><b>Definition:</b> <a href="MachineFunction_8h_source.html#l00167">MachineFunction.h:167</a></div></div>
<div class="ttc" id="classllvm_1_1MachineInstrBuilder_html_ace690c220f3b141bdf98c86635783d8f"><div class="ttname"><a href="classllvm_1_1MachineInstrBuilder.html#ace690c220f3b141bdf98c86635783d8f">llvm::MachineInstrBuilder::addExternalSymbol</a></div><div class="ttdeci">const MachineInstrBuilder &amp; addExternalSymbol(const char *FnName, unsigned char TargetFlags=0) const </div><div class="ttdef"><b>Definition:</b> <a href="MachineInstrBuilder_8h_source.html#l00136">MachineInstrBuilder.h:136</a></div></div>
<div class="ttc" id="classllvm_1_1TargetMachine_html_ab1fb67187fc37e569cc5171cbebba873"><div class="ttname"><a href="classllvm_1_1TargetMachine.html#ab1fb67187fc37e569cc5171cbebba873">llvm::TargetMachine::Options</a></div><div class="ttdeci">TargetOptions Options</div><div class="ttdef"><b>Definition:</b> <a href="Target_2TargetMachine_8h_source.html#l00105">Target/TargetMachine.h:105</a></div></div>
<div class="ttc" id="classllvm_1_1X86Subtarget_html_ae380c7f0dbea1c8e93b42f1a1708e1a0"><div class="ttname"><a href="classllvm_1_1X86Subtarget.html#ae380c7f0dbea1c8e93b42f1a1708e1a0">llvm::X86Subtarget::isTarget64BitLP64</a></div><div class="ttdeci">bool isTarget64BitLP64() const </div><div class="ttdoc">Is this x86_64 with the LP64 programming model (standard AMD64, no x32)? </div><div class="ttdef"><b>Definition:</b> <a href="X86Subtarget_8h_source.html#l00250">X86Subtarget.h:250</a></div></div>
<div class="ttc" id="namespacellvm_1_1TargetOpcode_html_a348d4259b5fa6a8ecfe94e7ae512e1a8ad3fe1d0d0fe22d208bcd8712b2ea051a"><div class="ttname"><a href="namespacellvm_1_1TargetOpcode.html#a348d4259b5fa6a8ecfe94e7ae512e1a8ad3fe1d0d0fe22d208bcd8712b2ea051a">llvm::TargetOpcode::DBG_VALUE</a></div><div class="ttdoc">DBG_VALUE - a mapping of the llvm.dbg.value intrinsic. </div><div class="ttdef"><b>Definition:</b> <a href="TargetOpcodes_8h_source.html#l00069">TargetOpcodes.h:69</a></div></div>
<div class="ttc" id="classllvm_1_1X86FrameLowering_html_a439b4e5e61ca54bfd7f11876db933f53"><div class="ttname"><a href="classllvm_1_1X86FrameLowering.html#a439b4e5e61ca54bfd7f11876db933f53">llvm::X86FrameLowering::emitCalleeSavedFrameMoves</a></div><div class="ttdeci">void emitCalleeSavedFrameMoves(MachineFunction &amp;MF, MCSymbol *Label, unsigned FramePtr) const </div><div class="ttdef"><b>Definition:</b> <a href="X86FrameLowering_8cpp_source.html#l00305">X86FrameLowering.cpp:305</a></div></div>
<div class="ttc" id="MD5_8cpp_html_ac0eafdc9ee161b71e7af98af736952fd"><div class="ttname"><a href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a></div><div class="ttdeci">#define I(x, y, z)</div><div class="ttdef"><b>Definition:</b> <a href="MD5_8cpp_source.html#l00054">MD5.cpp:54</a></div></div>
<div class="ttc" id="classllvm_1_1MachineFunction_html_ad5910eeb61f9d3942b970d1908375388"><div class="ttname"><a href="classllvm_1_1MachineFunction.html#ad5910eeb61f9d3942b970d1908375388">llvm::MachineFunction::hasMSInlineAsm</a></div><div class="ttdeci">bool hasMSInlineAsm() const </div><div class="ttdoc">Returns true if the function contains any MS-style inline assembly. </div><div class="ttdef"><b>Definition:</b> <a href="MachineFunction_8h_source.html#l00222">MachineFunction.h:222</a></div></div>
<div class="ttc" id="X86FrameLowering_8h_html"><div class="ttname"><a href="X86FrameLowering_8h.html">X86FrameLowering.h</a></div></div>
<div class="ttc" id="classllvm_1_1MachineModuleInfo_html_a5747190c7d1616888ef933167e632953"><div class="ttname"><a href="classllvm_1_1MachineModuleInfo.html#a5747190c7d1616888ef933167e632953">llvm::MachineModuleInfo::addFrameInst</a></div><div class="ttdeci">void addFrameInst(const MCCFIInstruction &amp;Inst)</div><div class="ttdef"><b>Definition:</b> <a href="MachineModuleInfo_8h_source.html#l00241">MachineModuleInfo.h:241</a></div></div>
<div class="ttc" id="classllvm_1_1MachineFunction_html_a6745c3bfdfc5b0643b078b96df2db252"><div class="ttname"><a href="classllvm_1_1MachineFunction.html#a6745c3bfdfc5b0643b078b96df2db252">llvm::MachineFunction::getTarget</a></div><div class="ttdeci">const TargetMachine &amp; getTarget() const </div><div class="ttdef"><b>Definition:</b> <a href="MachineFunction_8h_source.html#l00163">MachineFunction.h:163</a></div></div>
<div class="ttc" id="classllvm_1_1MachineBasicBlock_html_ab2d91e7bec944efcbc39d8e30644f111"><div class="ttname"><a href="classllvm_1_1MachineBasicBlock.html#ab2d91e7bec944efcbc39d8e30644f111">llvm::MachineBasicBlock::begin</a></div><div class="ttdeci">iterator begin()</div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8h_source.html#l00236">MachineBasicBlock.h:236</a></div></div>
<div class="ttc" id="classllvm_1_1X86RegisterInfo_html_a52f78fb379677e9270168daf72a808bd"><div class="ttname"><a href="classllvm_1_1X86RegisterInfo.html#a52f78fb379677e9270168daf72a808bd">llvm::X86RegisterInfo::getSlotSize</a></div><div class="ttdeci">unsigned getSlotSize() const </div><div class="ttdef"><b>Definition:</b> <a href="X86RegisterInfo_8h_source.html#l00128">X86RegisterInfo.h:128</a></div></div>
<div class="ttc" id="classllvm_1_1MachineBasicBlock_html_a8d02c1e6ef20f42c10d6f4e7234efd61"><div class="ttname"><a href="classllvm_1_1MachineBasicBlock.html#a8d02c1e6ef20f42c10d6f4e7234efd61">llvm::MachineBasicBlock::insert</a></div><div class="ttdeci">instr_iterator insert(instr_iterator I, MachineInstr *M)</div></div>
<div class="ttc" id="classllvm_1_1TargetMachine_html_a70b47eca6a99c87b81f4c1b1455dc090"><div class="ttname"><a href="classllvm_1_1TargetMachine.html#a70b47eca6a99c87b81f4c1b1455dc090">llvm::TargetMachine::getRegisterInfo</a></div><div class="ttdeci">virtual const TargetRegisterInfo * getRegisterInfo() const </div><div class="ttdef"><b>Definition:</b> <a href="Target_2TargetMachine_8h_source.html#l00140">Target/TargetMachine.h:140</a></div></div>
<div class="ttc" id="namespacellvm_html_a4d4191a557764471c0f130506c25e5ef"><div class="ttname"><a href="namespacellvm.html#a4d4191a557764471c0f130506c25e5ef">llvm::isMem</a></div><div class="ttdeci">static bool isMem(const MachineInstr *MI, unsigned Op)</div><div class="ttdef"><b>Definition:</b> <a href="X86InstrInfo_8h_source.html#l00123">X86InstrInfo.h:123</a></div></div>
<div class="ttc" id="X86InstrBuilder_8h_html"><div class="ttname"><a href="X86InstrBuilder_8h.html">X86InstrBuilder.h</a></div></div>
<div class="ttc" id="classllvm_1_1MachineFrameInfo_html_a5cd76eb2aeed3ae46da1bb1b132f1831"><div class="ttname"><a href="classllvm_1_1MachineFrameInfo.html#a5cd76eb2aeed3ae46da1bb1b132f1831">llvm::MachineFrameInfo::hasVarSizedObjects</a></div><div class="ttdeci">bool hasVarSizedObjects() const </div><div class="ttdef"><b>Definition:</b> <a href="MachineFrameInfo_8h_source.html#l00254">MachineFrameInfo.h:254</a></div></div>
<div class="ttc" id="classllvm_1_1MachineInstrBuilder_html"><div class="ttname"><a href="classllvm_1_1MachineInstrBuilder.html">llvm::MachineInstrBuilder</a></div><div class="ttdef"><b>Definition:</b> <a href="MachineInstrBuilder_8h_source.html#l00045">MachineInstrBuilder.h:45</a></div></div>
<div class="ttc" id="classllvm_1_1StringRef_html_a54b5863f31e0a39c204f3460f9ddde75"><div class="ttname"><a href="classllvm_1_1StringRef.html#a54b5863f31e0a39c204f3460f9ddde75">llvm::StringRef::find_first_of</a></div><div class="ttdeci">size_t find_first_of(char C, size_t From=0) const </div><div class="ttdef"><b>Definition:</b> <a href="StringRef_8h_source.html#l00269">StringRef.h:269</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110a4edf35e2383003ff20057e5a45012a55"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a4edf35e2383003ff20057e5a45012a55">llvm::ISD::EH_RETURN</a></div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00084">ISDOpcodes.h:84</a></div></div>
<div class="ttc" id="classllvm_1_1MachineRegisterInfo_html_a80b58d5afb19164c6199077bf8f8ea1a"><div class="ttname"><a href="classllvm_1_1MachineRegisterInfo.html#a80b58d5afb19164c6199077bf8f8ea1a">llvm::MachineRegisterInfo::livein_iterator</a></div><div class="ttdeci">std::vector&lt; std::pair&lt; unsigned, unsigned &gt; &gt;::const_iterator livein_iterator</div><div class="ttdef"><b>Definition:</b> <a href="MachineRegisterInfo_8h_source.html#l00528">MachineRegisterInfo.h:528</a></div></div>
<div class="ttc" id="classllvm_1_1TargetOptions_html_a0c579d66df87322b3f963638eddc1cf5"><div class="ttname"><a href="classllvm_1_1TargetOptions.html#a0c579d66df87322b3f963638eddc1cf5">llvm::TargetOptions::EnableSegmentedStacks</a></div><div class="ttdeci">unsigned EnableSegmentedStacks</div><div class="ttdef"><b>Definition:</b> <a href="TargetOptions_8h_source.html#l00155">TargetOptions.h:155</a></div></div>
<div class="ttc" id="classllvm_1_1MachineOperand_html_ab75f703d251cc0ce0206fe00a999db86"><div class="ttname"><a href="classllvm_1_1MachineOperand.html#ab75f703d251cc0ce0206fe00a999db86">llvm::MachineOperand::getReg</a></div><div class="ttdeci">unsigned getReg() const </div><div class="ttdoc">getReg - Returns the register number. </div><div class="ttdef"><b>Definition:</b> <a href="MachineOperand_8h_source.html#l00259">MachineOperand.h:259</a></div></div>
<div class="ttc" id="classllvm_1_1X86FrameLowering_html_a6954f39513691bd4cced9a770b200595"><div class="ttname"><a href="classllvm_1_1X86FrameLowering.html#a6954f39513691bd4cced9a770b200595">llvm::X86FrameLowering::emitPrologue</a></div><div class="ttdeci">void emitPrologue(MachineFunction &amp;MF) const </div><div class="ttdef"><b>Definition:</b> <a href="X86FrameLowering_8cpp_source.html#l00388">X86FrameLowering.cpp:388</a></div></div>
<div class="ttc" id="namespacellvm_1_1dwarf_html_a31ace7f9af1edbbe842e91b9edb4a2a1"><div class="ttname"><a href="namespacellvm_1_1dwarf.html#a31ace7f9af1edbbe842e91b9edb4a2a1">llvm::dwarf::CallingConvention</a></div><div class="ttdeci">CallingConvention</div><div class="ttdef"><b>Definition:</b> <a href="Dwarf_8h_source.html#l00622">Dwarf.h:622</a></div></div>
<div class="ttc" id="classllvm_1_1X86Subtarget_html_ad2e7679750b36379f33281443080869f"><div class="ttname"><a href="classllvm_1_1X86Subtarget.html#ad2e7679750b36379f33281443080869f">llvm::X86Subtarget::isTargetWin64</a></div><div class="ttdeci">bool isTargetWin64() const </div><div class="ttdef"><b>Definition:</b> <a href="X86Subtarget_8h_source.html#l00338">X86Subtarget.h:338</a></div></div>
<div class="ttc" id="namespacellvm_1_1CallingConv_html_a4f861731fc6dbfdccc05af5968d98974abc8e2ee40a84687a9e12fd08784b87ba"><div class="ttname"><a href="namespacellvm_1_1CallingConv.html#a4f861731fc6dbfdccc05af5968d98974abc8e2ee40a84687a9e12fd08784b87ba">llvm::CallingConv::Fast</a></div><div class="ttdef"><b>Definition:</b> <a href="CallingConv_8h_source.html#l00039">CallingConv.h:39</a></div></div>
<div class="ttc" id="namespacellvm_1_1A64CC_html_af5804bc0518be9568f73db566e4d6f46a2db5e7546f960277ff98f96cd5624442"><div class="ttname"><a href="namespacellvm_1_1A64CC.html#af5804bc0518be9568f73db566e4d6f46a2db5e7546f960277ff98f96cd5624442">llvm::A64CC::MI</a></div><div class="ttdef"><b>Definition:</b> <a href="AArch64BaseInfo_8h_source.html#l00035">AArch64BaseInfo.h:35</a></div></div>
<div class="ttc" id="classllvm_1_1X86Subtarget_html_aa82ef59ca68fb0c1af009f46fe59bf0d"><div class="ttname"><a href="classllvm_1_1X86Subtarget.html#aa82ef59ca68fb0c1af009f46fe59bf0d">llvm::X86Subtarget::isTargetFreeBSD</a></div><div class="ttdeci">bool isTargetFreeBSD() const </div><div class="ttdef"><b>Definition:</b> <a href="X86Subtarget_8h_source.html#l00312">X86Subtarget.h:312</a></div></div>
<div class="ttc" id="classllvm_1_1MachineInstrBuilder_html_a34ab07c56acf0fe7f68a6da0d514bec7"><div class="ttname"><a href="classllvm_1_1MachineInstrBuilder.html#a34ab07c56acf0fe7f68a6da0d514bec7">llvm::MachineInstrBuilder::addOperand</a></div><div class="ttdeci">const MachineInstrBuilder &amp; addOperand(const MachineOperand &amp;MO) const </div><div class="ttdef"><b>Definition:</b> <a href="MachineInstrBuilder_8h_source.html#l00166">MachineInstrBuilder.h:166</a></div></div>
<div class="ttc" id="classllvm_1_1MachineFunction_html_a340712de3e78fec11c338735cab17df7"><div class="ttname"><a href="classllvm_1_1MachineFunction.html#a340712de3e78fec11c338735cab17df7">llvm::MachineFunction::iterator</a></div><div class="ttdeci">BasicBlockListType::iterator iterator</div><div class="ttdef"><b>Definition:</b> <a href="MachineFunction_8h_source.html#l00303">MachineFunction.h:303</a></div></div>
<div class="ttc" id="namespacellvm_html_a7923e3e207de8bc1d0d6a5091316ddde"><div class="ttname"><a href="namespacellvm.html#a7923e3e207de8bc1d0d6a5091316ddde">llvm::prior</a></div><div class="ttdeci">ItTy prior(ItTy it, Dist n)</div><div class="ttdef"><b>Definition:</b> <a href="STLExtras_8h_source.html#l00167">STLExtras.h:167</a></div></div>
<div class="ttc" id="classllvm_1_1MachineFunction_html_aaaa58853344cccb2ae6dcecea4ee54ad"><div class="ttname"><a href="classllvm_1_1MachineFunction.html#aaaa58853344cccb2ae6dcecea4ee54ad">llvm::MachineFunction::getMMI</a></div><div class="ttdeci">MachineModuleInfo &amp; getMMI() const </div><div class="ttdef"><b>Definition:</b> <a href="MachineFunction_8h_source.html#l00145">MachineFunction.h:145</a></div></div>
<div class="ttc" id="classllvm_1_1MachineRegisterInfo_html_adfeaea4e5c82dea47ff9aa1f8367104c"><div class="ttname"><a href="classllvm_1_1MachineRegisterInfo.html#adfeaea4e5c82dea47ff9aa1f8367104c">llvm::MachineRegisterInfo::reg_begin</a></div><div class="ttdeci">reg_iterator reg_begin(unsigned RegNo) const </div><div class="ttdef"><b>Definition:</b> <a href="MachineRegisterInfo_8h_source.html#l00212">MachineRegisterInfo.h:212</a></div></div>
<div class="ttc" id="MCModuleYAML_8cpp_html_a5e410df3f6875c5af4a7f2be284f235d"><div class="ttname"><a href="MCModuleYAML_8cpp.html#a5e410df3f6875c5af4a7f2be284f235d">MRI</a></div><div class="ttdeci">const MCRegisterInfo &amp; MRI</div><div class="ttdef"><b>Definition:</b> <a href="MCModuleYAML_8cpp_source.html#l00056">MCModuleYAML.cpp:56</a></div></div>
<div class="ttc" id="classllvm_1_1MachineInstrBuilder_html_a66fb0307f35f874cb65deb84eea9553f"><div class="ttname"><a href="classllvm_1_1MachineInstrBuilder.html#a66fb0307f35f874cb65deb84eea9553f">llvm::MachineInstrBuilder::setMIFlag</a></div><div class="ttdeci">const MachineInstrBuilder &amp; setMIFlag(MachineInstr::MIFlag Flag) const </div><div class="ttdef"><b>Definition:</b> <a href="MachineInstrBuilder_8h_source.html#l00186">MachineInstrBuilder.h:186</a></div></div>
<div class="ttc" id="classllvm_1_1MachineFrameInfo_html_a511de1ba76de77289749f82883fada4b"><div class="ttname"><a href="classllvm_1_1MachineFrameInfo.html#a511de1ba76de77289749f82883fada4b">llvm::MachineFrameInfo::CreateFixedObject</a></div><div class="ttdeci">int CreateFixedObject(uint64_t Size, int64_t SPOffset, bool Immutable)</div><div class="ttdef"><b>Definition:</b> <a href="MachineFunction_8cpp_source.html#l00544">MachineFunction.cpp:544</a></div></div>
<div class="ttc" id="classllvm_1_1X86FrameLowering_html_a74373af665170dda9817779430b67295"><div class="ttname"><a href="classllvm_1_1X86FrameLowering.html#a74373af665170dda9817779430b67295">llvm::X86FrameLowering::emitEpilogue</a></div><div class="ttdeci">void emitEpilogue(MachineFunction &amp;MF, MachineBasicBlock &amp;MBB) const </div><div class="ttdef"><b>Definition:</b> <a href="X86FrameLowering_8cpp_source.html#l00712">X86FrameLowering.cpp:712</a></div></div>
<div class="ttc" id="classllvm_1_1MachineRegisterInfo_html_a1d8edf72c1d3e14e4d2396b98e07ad72"><div class="ttname"><a href="classllvm_1_1MachineRegisterInfo.html#a1d8edf72c1d3e14e4d2396b98e07ad72">llvm::MachineRegisterInfo::reg_end</a></div><div class="ttdeci">static reg_iterator reg_end()</div><div class="ttdef"><b>Definition:</b> <a href="MachineRegisterInfo_8h_source.html#l00215">MachineRegisterInfo.h:215</a></div></div>
<div class="ttc" id="X86FrameLowering_8cpp_html_ab29c5668ec7d2b12468b97aa33e5f87b"><div class="ttname"><a href="X86FrameLowering_8cpp.html#ab29c5668ec7d2b12468b97aa33e5f87b">HasNestArgument</a></div><div class="ttdeci">static bool HasNestArgument(const MachineFunction *MF)</div><div class="ttdef"><b>Definition:</b> <a href="X86FrameLowering_8cpp_source.html#l01102">X86FrameLowering.cpp:1102</a></div></div>
<div class="ttc" id="classllvm_1_1X86FrameLowering_html_a63ad28e4eca30cc88163e78e90974e7e"><div class="ttname"><a href="classllvm_1_1X86FrameLowering.html#a63ad28e4eca30cc88163e78e90974e7e">llvm::X86FrameLowering::hasReservedCallFrame</a></div><div class="ttdeci">bool hasReservedCallFrame(const MachineFunction &amp;MF) const </div><div class="ttdef"><b>Definition:</b> <a href="X86FrameLowering_8cpp_source.html#l00038">X86FrameLowering.cpp:38</a></div></div>
<div class="ttc" id="classllvm_1_1MachineInstrBuilder_html_a5125cce72b214df09ca8f93dcbbf4c3a"><div class="ttname"><a href="classllvm_1_1MachineInstrBuilder.html#a5125cce72b214df09ca8f93dcbbf4c3a">llvm::MachineInstrBuilder::addReg</a></div><div class="ttdeci">const MachineInstrBuilder &amp; addReg(unsigned RegNo, unsigned flags=0, unsigned SubReg=0) const </div><div class="ttdef"><b>Definition:</b> <a href="MachineInstrBuilder_8h_source.html#l00064">MachineInstrBuilder.h:64</a></div></div>
<div class="ttc" id="Target_2ARM_2README_8txt_html_a90cca76dd78688687e0d697679dbc799"><div class="ttname"><a href="Target_2ARM_2README_8txt.html#a90cca76dd78688687e0d697679dbc799">B</a></div><div class="ttdeci">compiles ldr LCPI1_0 ldr ldr mov lsr tst moveq r1 ldr LCPI1_1 and r0 bx lr It would be better to do something like to fold the shift into the conditional ldr LCPI1_0 ldr ldr tst movne lsr ldr LCPI1_1 and r0 bx lr it saves an instruction and a register It might be profitable to cse MOVi16 if there are lots of bit immediates with the same bottom half Robert Muth started working on an alternate jump table implementation that does not put the tables in line in the text This is more like the llvm default jump table implementation This might be useful sometime Several revisions of patches are on the mailing beginning while CMP sets them like a subtract Therefore to be able to use CMN for comparisons other than the Z we ll need additional logic to reverse the conditionals associated with the comparison Perhaps a pseudo instruction for the with a post codegen pass to clean up and handle the condition codes See PR5694 for testcase Given the following on int B</div><div class="ttdef"><b>Definition:</b> <a href="Target_2ARM_2README_8txt_source.html#l00592">Target/ARM/README.txt:592</a></div></div>
<div class="ttc" id="classllvm_1_1MachineRegisterInfo_1_1defusechain__iterator_html"><div class="ttname"><a href="classllvm_1_1MachineRegisterInfo_1_1defusechain__iterator.html">llvm::MachineRegisterInfo::defusechain_iterator</a></div><div class="ttdef"><b>Definition:</b> <a href="MachineRegisterInfo_8h_source.html#l00204">MachineRegisterInfo.h:204</a></div></div>
<div class="ttc" id="namespacellvm_1_1N86_html_a154c9f74eba4608c7d1b656eb025a96da303dfe7256beaf60eaaa93d1c418965b"><div class="ttname"><a href="namespacellvm_1_1N86.html#a154c9f74eba4608c7d1b656eb025a96da303dfe7256beaf60eaaa93d1c418965b">llvm::N86::ESP</a></div><div class="ttdef"><b>Definition:</b> <a href="X86MCTargetDesc_8h_source.html#l00047">X86MCTargetDesc.h:47</a></div></div>
<div class="ttc" id="classllvm_1_1Function_html_ae0466120bfdf5b97b25aa06f3015cd51"><div class="ttname"><a href="classllvm_1_1Function.html#ae0466120bfdf5b97b25aa06f3015cd51">llvm::Function::isVarArg</a></div><div class="ttdeci">bool isVarArg() const </div><div class="ttdef"><b>Definition:</b> <a href="Function_8cpp_source.html#l00175">Function.cpp:175</a></div></div>
<div class="ttc" id="classllvm_1_1MachineBasicBlock_html_a3fcc360e6de146a370e8b0deecfa877f"><div class="ttname"><a href="classllvm_1_1MachineBasicBlock.html#a3fcc360e6de146a370e8b0deecfa877f">llvm::MachineBasicBlock::addSuccessor</a></div><div class="ttdeci">void addSuccessor(MachineBasicBlock *succ, uint32_t weight=0)</div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8cpp_source.html#l00482">MachineBasicBlock.cpp:482</a></div></div>
<div class="ttc" id="namespacellvm_1_1RegState_html_a079b254e749130fbe5d740f314ca92daa72c17e2ff2d5af62a30e56ac152aa8d5"><div class="ttname"><a href="namespacellvm_1_1RegState.html#a079b254e749130fbe5d740f314ca92daa72c17e2ff2d5af62a30e56ac152aa8d5">llvm::RegState::Define</a></div><div class="ttdef"><b>Definition:</b> <a href="MachineInstrBuilder_8h_source.html#l00031">MachineInstrBuilder.h:31</a></div></div>
<div class="ttc" id="namespacellvm_1_1A64CC_html_af5804bc0518be9568f73db566e4d6f46a802c8408643a0c37e107e7b4b0994c30"><div class="ttname"><a href="namespacellvm_1_1A64CC.html#af5804bc0518be9568f73db566e4d6f46a802c8408643a0c37e107e7b4b0994c30">llvm::A64CC::AL</a></div><div class="ttdef"><b>Definition:</b> <a href="AArch64BaseInfo_8h_source.html#l00045">AArch64BaseInfo.h:45</a></div></div>
<div class="ttc" id="classllvm_1_1X86FrameLowering_html_ab28bee10ef6d895aa3271a7c8cae45d7"><div class="ttname"><a href="classllvm_1_1X86FrameLowering.html#ab28bee10ef6d895aa3271a7c8cae45d7">llvm::X86FrameLowering::spillCalleeSavedRegisters</a></div><div class="ttdeci">bool spillCalleeSavedRegisters(MachineBasicBlock &amp;MBB, MachineBasicBlock::iterator MI, const std::vector&lt; CalleeSavedInfo &gt; &amp;CSI, const TargetRegisterInfo *TRI) const </div><div class="ttdef"><b>Definition:</b> <a href="X86FrameLowering_8cpp_source.html#l00962">X86FrameLowering.cpp:962</a></div></div>
<div class="ttc" id="classllvm_1_1X86Subtarget_html_aeb1f5a1a73b6b472424a7a8a08126bb5"><div class="ttname"><a href="classllvm_1_1X86Subtarget.html#aeb1f5a1a73b6b472424a7a8a08126bb5">llvm::X86Subtarget::isTargetEnvMacho</a></div><div class="ttdeci">bool isTargetEnvMacho() const </div><div class="ttdef"><b>Definition:</b> <a href="X86Subtarget_8h_source.html#l00334">X86Subtarget.h:334</a></div></div>
<div class="ttc" id="classllvm_1_1X86TargetMachine_html_a245ed1de411cd3ba114322a573b524f5"><div class="ttname"><a href="classllvm_1_1X86TargetMachine.html#a245ed1de411cd3ba114322a573b524f5">llvm::X86TargetMachine::getInstrInfo</a></div><div class="ttdeci">virtual const X86InstrInfo * getInstrInfo() const </div><div class="ttdef"><b>Definition:</b> <a href="X86TargetMachine_8h_source.html#l00044">X86TargetMachine.h:44</a></div></div>
<div class="ttc" id="classllvm_1_1MachineModuleInfo_html"><div class="ttname"><a href="classllvm_1_1MachineModuleInfo.html">llvm::MachineModuleInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="MachineModuleInfo_8h_source.html#l00097">MachineModuleInfo.h:97</a></div></div>
<div class="ttc" id="namespacellvm_1_1CallingConv_html_a4f861731fc6dbfdccc05af5968d98974a20ddc463f96d806f369d56205ea205f5"><div class="ttname"><a href="namespacellvm_1_1CallingConv.html#a4f861731fc6dbfdccc05af5968d98974a20ddc463f96d806f369d56205ea205f5">llvm::CallingConv::HiPE</a></div><div class="ttdef"><b>Definition:</b> <a href="CallingConv_8h_source.html#l00052">CallingConv.h:52</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<hr>
<p class="footer">
Generated on Sat Nov 10 2018 23:03:11 for <a href="http://llvm.org/">LLVM</a> by
<a href="http://www.doxygen.org"><img src="doxygen.png" alt="Doxygen"
align="middle" border="0"/>1.8.11</a><br>
Copyright &copy; 2003-2013 University of Illinois at Urbana-Champaign.
All Rights Reserved.</p>
<hr>
<!--#include virtual="/attrib.incl" -->
</body>
</html>
